* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   3
* EL050.cbl
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    65
    66 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    67 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    68                                   USAGE POINTER.
    69 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    78                                   USAGE IS POINTER.
    79
    80 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    82                                   USAGE IS POINTER.
    83
    84*    COPY ELC50WS.
    85*****************************************************************
    86*                                                               *
    87*                            ELC50WS.                           *
    88*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    89*                            VMOD=2.061.                        *
    90*                                                               *
    91*   THIS IS THE WORKING STORAGE FOR EL050                       *
    92*                                   EL517                       *
    93*****************************************************************
    94******************************************************************
    95*                   C H A N G E   L O G
    96*
    97* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    98*-----------------------------------------------------------------
    99*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   100* EFFECTIVE    NUMBER
   101*-----------------------------------------------------------------
   102* 123102                   PEMA  ADD DCC PROCESSING
   103* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   104* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   105* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   106* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   107* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   108* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   109* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   110* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   111* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   112* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   113* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   114* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   115* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   116* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   4
* EL050.cbl
   117* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   118* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   119* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   120* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   121* 030309  CR2009021700001  PEMA  ADD ER-2883
   122* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   123* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   124* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   125* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   126* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   127* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   128* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   129* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   130* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   132* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   133* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   134* 061412  CR2011022800001  AJRA  NAPERSOFT
   135* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   136* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   137* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   138* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   139* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   140* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   141* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   142* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   143* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   144* 091114  IR2014091000001  TANA  ADD ERROR 2898
   145*-----------------------------------------------------------------
   146
   147 01  WORK-AREAS.
   148
   149*****************************************************************
   150*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   151*****************************************************************
   152
   153     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   154     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   155     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   156     12  WS-NAME-EDIT-WORK-AREA.
   157         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   158         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   159             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   160         16  WS-WORK-NAME.
   161             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   162             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   163             20  FILLER           PIC X(10)     VALUE SPACES.
   164         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   165             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   166
   167*****************************************************************
   168*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   169*****************************************************************
   170
   171     12  WS-ERRESC-KEY.
   172         16 WS-ERRESC-SEARCH-KEY.
   173             20  WS-ERRESC-COMPANY-CD PIC  X.
   174             20  WS-ERRESC-CARRIER    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   5
* EL050.cbl
   175             20  WS-ERRESC-GROUP      PIC X(6).
   176             20  WS-ERRESC-STATE      PIC XX.
   177             20  WS-ERRESC-ACCOUNT    PIC X(10).
   178         16 WS-ERRESC-RESIDUAL-KEY.
   179             20  WS-ERRESC-AGENT      PIC X(10).
   180             20  WS-ERRESC-RES-STATE  PIC XX.
   181             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   182*                                          YYYYMMDD
   183     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   184     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   185
   186*RESIDENT STATE TAX MASTER(ERRESS)
   187*
   188     12  WS-ERRESS-KEY.
   189         16  WS-ERRESS-COMPANY-CD      PIC  X.
   190         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   191         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   192         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   193*                                          YYYYMMDD
   194
   195     12  WS-CONTRACT-DATE              PIC 9(8).
   196*                                          YYYYMMDD
   197     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   198     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   199         16 WS-YEAR-YY                 PIC   9999.
   200         16 FILLER                     PIC 9(4).
   201*                                          YYYYMMDD
   202     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   203     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   204     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   205     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   206
   207     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   208         88  DPRB-1ST-TIME                      VALUE ' '.
   209
   210*****************************************************************
   211*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   212*****************************************************************
   213
   214     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   215     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   216     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   217     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   219     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   220     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   221     12  ws-st-agent-sig-edit    pic x          value spaces.
   222     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   223     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   224     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   225     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   226         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   227         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   228     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   229         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   230         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   231     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   232
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   6
* EL050.cbl
   233     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   234     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   235
   236     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   237     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   243     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   250     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   251     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   272     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   273     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   274     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   275     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   284     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   285     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   286     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   287     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   288     12  WS-2671-SW               PIC X         VALUE SPACE.
   289     12  WS-2672-SW               PIC X         VALUE SPACE.
   290     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   7
* EL050.cbl
   291         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   292     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   293         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   294     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   295
   296     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   297         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   298         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   299         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   300         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   301
   302     12  WS-CREDIT-EDIT-CONTROLS.
   303         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   304         16  WS-MIN-AGE           PIC 99                VALUE  0.
   305         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   306         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   307         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   308         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   309
   310     12  WS-AGE-FIELDS.
   311         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   312         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   313         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   314         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   315
   316     12  WS-SAVE-ALLOWABLE-BENEFIT.
   317         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   318         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   319         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   320         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   321         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   322         16  FILLER                      PIC XX.
   323
   324     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   325     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   326     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   327     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   328     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   329     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   330     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   331     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   332     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   333     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   334
   335     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   336     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   337     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   338     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   339     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   340     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   341     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   342     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   343         88  WS-REDUCING              VALUE 'R'.
   344         88  WS-LEVEL                 VALUE 'L' 'P'.
   345     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   346
   347     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   348     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   8
* EL050.cbl
   349     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   350     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   351     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   352     12  ws-ah-max-bens           pic 99        value zeros.
   353     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   354     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   355     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   356     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   357
   358     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   359     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   360     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   361     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   362     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   364     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   365     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   366     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   367     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   368     12  WS-ACCT-SIG-SW.
   369         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   370         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   371     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   372     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   373     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   376     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   378     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   379     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-INITIALS.
   381         16  WS-INIT-1            PIC X         VALUE SPACES.
   382         16  WS-INIT-2            PIC X         VALUE SPACES.
   383
   384     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   385     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   386     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   387     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   388     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   389*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   390     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   397     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   398     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   399     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   400     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   401     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   402     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   403     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   404     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   405     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   406     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page   9
* EL050.cbl
   407     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412******** FLA
   413     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   416     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   417     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   418********
   419     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   420     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   421     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   422     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   423     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   424     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   425     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   426     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   427     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   428     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   429
   430     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   431         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   432                                         '0' THRU '9'.
   433
   434     12  NUMBER-OF-MONTHS.
   435         16  SK-MO OCCURS 12 TIMES PIC X.
   436
   437     12  WS-WORK-DATE.
   438         16  WS-YEAR            PIC 99    VALUE 00.
   439         16  WS-MONTH           PIC 99    VALUE 00.
   440         16  WS-DAY             PIC 99    VALUE 00.
   441
   442     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   443     12  WS-WORK-CRIT-DEV       REDEFINES
   444         WS-WORK-LF-CRIT-PER    PIC X(03).
   445
   446     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   447     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   448
   449     12  WS-WORK-DATE-FROM.
   450         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   451         16  FILLER             PIC X  VALUE SPACE.
   452         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   453         16  FILLER             PIC X         VALUE SPACE.
   454         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   455
   456     12  WS-WORK-DATE-THRU.
   457         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X         VALUE SPACE.
   459         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   460         16  FILLER             PIC X         VALUE SPACE.
   461         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   462
   463     12  WS-LF-INPUT-CD.
   464         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  10
* EL050.cbl
   465         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   466
   467     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   468     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   469         16  WS-AH-INPUT-CD-1   PIC X.
   470         16  WS-AH-INPUT-CD-2-3 PIC XX.
   471
   472     12  WS-SWITCHES.
   473         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   474         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   475             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   476         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   477             88  BANK-ACCT-FOUND          VALUE 'Y'.
   478         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   479             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   480         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   481             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   482         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   483             88  COMP-MASTER-FOUND        VALUE 'Y'.
   484         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   485             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   486         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   487             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   488         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   489             88  STAT-MASTER-FOUND        VALUE 'Y'.
   490         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   491             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   492         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   493             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   494         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   495             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   496         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   497             88  FORM-MASTER-FOUND        VALUE 'Y'.
   498         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   499             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   500         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   501             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   502         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   503             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   504         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   505             88  NO-BENEFIT-FOUND         VALUE 'N'.
   506         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   507             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   508         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   509             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   510         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   511             88  AH-BENEFIT-FOUND         VALUE ' '.
   512             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   513         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   514             88  LF-BENEFIT-FOUND         VALUE ' '.
   515             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   516         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   517             88  NO-STATE-RECORD          VALUE '1'.
   518         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   519             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   520         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   521             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   522         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  11
* EL050.cbl
   523             88  CERT-WAS-FOUND           VALUE ' '.
   524             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   525         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   526             88  BROWSE-STARTED           VALUE 'Y'.
   527         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   528             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   529         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   530             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   531         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   532             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   533         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   534             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   535         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   536             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   537         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   538             88  APP-CERT-USED            VALUE 'Y' 'A'.
   539         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   540             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   541             88  FIRST-TIME-THROUGH       VALUE '1'.
   542             88  CTBL-NOT-FOUND           VALUE '2'.
   543
   544         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   545             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   546
   547         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   548             88  DLO-ERROR-FOUND          VALUE 'Y'.
   549
   550********FLA
   551     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   552     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   553********
   554     12  RC-SW-1                  PIC X           VALUE '0'.
   555     12  RC-SW-2                  PIC X           VALUE '0'.
   556     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   557     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   558     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   566     12  LIT-SPACES               PIC X           VALUE SPACES.
   567     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   568     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   569     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   570     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   571     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   572     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   573     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   574         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   575         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   576     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   577         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   578
   579 01  WS-EXTRA-PERIODS-BY-STATE.
   580     12  WS-INT-PERIODS          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  12
* EL050.cbl
   581     12  WS-EXTRA-PMTS           PIC 9.
   582 01  ws-net-only-state           pic x value 'N'.
   583 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   584     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   585     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   586 01  WS-CRI-SSN-WORK-AREA.
   587     05  WS-CRI-SOC-SEC-NO.
   588         10  WS-SS-REPT-CD       PIC X(5).
   589         10  WS-SS-LAST-NAME     PIC X(5).
   590         10  WS-SS-INITIAL       PIC X.
   591
   592     05  WS-CRI-REPORT-CODE.
   593         10  FILLER              PIC X(5).
   594         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   595
   596     05  WS-CRI-LAST-NAME.
   597         10  WS-CRI-NAME-MOVE    PIC X(5).
   598         10  FILLER              PIC X(10).
   599
   600 01  WS-NUM-TABLE                PIC X(26)  VALUE
   601     '12345678012345070923456789'.
   602 01  FILLER REDEFINES WS-NUM-TABLE.
   603     05  WS-NUM OCCURS 26        PIC 9.
   604 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   605 01  V1                          PIC S999 COMP-3.
   606 01  V2                          PIC S999 COMP-3.
   607 01  V3                          PIC S999 COMP-3.
   608 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   609 01  FILLER REDEFINES WS-WORK-VIN.
   610     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   611 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   612 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   613 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   614 01  WS-HEX-WORK.
   615     05  FILLER                  PIC X  VALUE LOW-VALUES.
   616     05  WS-HEX-BYTE             PIC X.
   617 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   618 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   619 01  WS-WORK-HIN-ROW-B.
   620     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   621
   622 01  ws-benefit-cd-chg-sw      pic x value spaces.
   623     88  benefit-code-chg           value 'Y'.
   624 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   625 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   626     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   627 01  WS-ROW-D-TABLE.
   628     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   629
   630 01  WS-HIN-TABLE-B.
   631     05  F                       PIC XX VALUE 'A2'.
   632     05  F                       PIC XX VALUE 'B3'.
   633     05  F                       PIC XX VALUE 'C4'.
   634     05  F                       PIC XX VALUE 'D5'.
   635     05  F                       PIC XX VALUE 'E6'.
   636     05  F                       PIC XX VALUE 'F7'.
   637     05  F                       PIC XX VALUE 'G8'.
   638     05  F                       PIC XX VALUE 'H9'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  13
* EL050.cbl
   639     05  F                       PIC XX VALUE 'I1'.
   640     05  F                       PIC XX VALUE 'J2'.
   641     05  F                       PIC XX VALUE 'K3'.
   642     05  F                       PIC XX VALUE 'L4'.
   643     05  F                       PIC XX VALUE 'M5'.
   644     05  F                       PIC XX VALUE 'N6'.
   645     05  F                       PIC XX VALUE 'O0'.
   646     05  F                       PIC XX VALUE 'P7'.
   647     05  F                       PIC XX VALUE 'Q0'.
   648     05  F                       PIC XX VALUE 'R8'.
   649     05  F                       PIC XX VALUE 'S9'.
   650     05  F                       PIC XX VALUE 'T2'.
   651     05  F                       PIC XX VALUE 'U3'.
   652     05  F                       PIC XX VALUE 'V4'.
   653     05  F                       PIC XX VALUE 'W5'.
   654     05  F                       PIC XX VALUE 'X6'.
   655     05  F                       PIC XX VALUE 'Y7'.
   656     05  F                       PIC XX VALUE 'Z8'.
   657 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   658     05  WS-VAL-IN               PIC X.
   659     05  WS-VAL-OUT              PIC 9.
   660 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   661 01  WS-COMPARE-BINARY-DATES.
   662     05  WS-971231                PIC XX VALUE X'92FF'.
   663     05  WS-931231                PIC XX VALUE X'8CFF'.
   664     05  WS-791231                PIC XX VALUE X'77FF'.
   665     05  WS-771001                PIC XX VALUE X'74A1'.
   666     05  WS-820301                PIC XX VALUE X'7B41'.
   667     05  WS-831031                PIC XX VALUE X'7DBF'.
   668     05  WS-831231                PIC XX VALUE X'7DFF'.
   669     05  WS-810831                PIC XX VALUE X'7A7F'.
   670     05  WS-830901                PIC XX VALUE X'7D81'.
   671
   672 01  FILE-ACCESS-IDS.
   673     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   674     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   675     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   676     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   677     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   678     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   679     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   680     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   681     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   682     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   683     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   684     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   685     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   686     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   687     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   688     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   689     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   690 01  DD-IU-SW                    PIC X   VALUE ' '.
   691     88  DD-IU-PRESENT                 VALUE 'Y'.
   692
   693 01  ACCESS-KEYS.
   694     12  ELMSTR-KEY.
   695         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   696         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  14
* EL050.cbl
   697     12  W-CLAIM-KEY.
   698         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   699         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   700
   701     12  ELCNTL-KEY.
   702         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   703         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   704         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   705         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   706
   707     12  ELCERT-KEY.
   708         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   709         16  CERT-CARRIER         PIC X       VALUE SPACE.
   710         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   711         16  CERT-STATE           PIC XX      VALUE SPACES.
   712         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   713         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   714         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   715
   716     12  ELCERT2-KEY.
   717         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   718         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   719
   720     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   721
   722     12  ELCERT-SAVE.
   723         16  FILLER                      PIC XX    VALUE SPACES.
   724
   725         16  WCS-CONTROL-PRIMARY.
   726             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   727             20  WCS-CARRIER             PIC X     VALUE SPACE.
   728             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   729             20  WCS-STATE               PIC XX    VALUE SPACES.
   730             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   731             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   732             20  WCS-CERT-NO.
   733                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   734                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   735
   736         16  CS-CONTROL-BY-NAME.
   737             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   738             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   739             20  CS-INSURED-INITIALS.
   740                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   741                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   742
   743         16  CS-CONTROL-BY-SSN.
   744             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   745             20  CS-SOC-SEC-NO.
   746                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   747                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   748                 24  CS-SSN-LN3.
   749                     28 CS-INSURED-INITIALS-A2   PIC XX
   750                                     VALUE SPACES.
   751                     28 CS-PART-LAST-NAME-A2     PIC X
   752                                     VALUE SPACE.
   753
   754         16  CS-CONTROL-BY-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  15
* EL050.cbl
   755             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   756             20  CS-CERT-NO-A4           PIC X(11)
   757                                     VALUE SPACES.
   758
   759         16  CS-CONTROL-BY-MEMB.
   760             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   761             20  CS-MEMBER-NO.
   762                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   763                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   764                 24  CS-MEMB-LN4.
   765                     28 CS-INSURED-INITIALS-A5   PIC XX
   766                                      VALUE SPACES.
   767                     28 CS-PART-LAST-NAME-A5     PIC XX
   768                                      VALUE SPACES.
   769
   770         16  FILLER              PIC X(360) VALUE SPACES.
   771
   772     12  ERACCT-KEY.
   773         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   774         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   775         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   776         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   777         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   779
   780     12  ERCOMP-KEY.
   781         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   782         16  COMP-CARRIER         PIC X     VALUE SPACES.
   783         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   784         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   785         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   786         16  COMP-TYPE            PIC X     VALUE SPACES.
   787
   788     12  ERLOFC-KEY.
   789         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   790         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   791         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   792         16  LOFC-STATE           PIC XX    VALUE SPACES.
   793         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   794         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   795
   796     12  WS-ELCRTT-KEY.
   797         16  WS-ELCRTT-PRIMARY       PIC X(33).
   798         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   799
   800     12  ERBXRF-KEY.
   801         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   802         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   803         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   804         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   805
   806     12  ERAGTC-KEY.
   807         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   808         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   809         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   810         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   811         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   812         16  AGTC-TYPE            PIC X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  16
* EL050.cbl
   813
   814     12  ERPLAN-KEY.
   815         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   816         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   817         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   818         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   819         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   820         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   821         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   822         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   823
   824     12  ERFORM-KEY.
   825         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   826         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   827         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   828         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   829
   830     12  ERREIN-KEY.
   831         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   832         16  REIN-TYPE            PIC X     VALUE SPACES.
   833         16  REIN-TABLE-CO.
   834             20  REIN-CODE-1      PIC X     VALUE SPACE.
   835             20  REIN-CODE-2      PIC X     VALUE SPACE.
   836             20  REIN-CODE-3      PIC X     VALUE SPACE.
   837         16  FILLER               PIC X(3)  VALUE SPACES.
   838
   839     12  ERCTBL-KEY.
   840         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   841         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   842         16  CTBL-CNTRL-2.
   843             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   844             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   845
   846     12  ELCRTO-KEY.
   847         16  ELCRTO-COMPANY-CD       PIC X.
   848         16  ELCRTO-CARRIER          PIC X.
   849         16  ELCRTO-GROUPING         PIC X(6).
   850         16  ELCRTO-STATE            PIC XX.
   851         16  ELCRTO-ACCOUNT          PIC X(10).
   852         16  ELCRTO-CERT-EFF-DT      PIC XX.
   853         16  ELCRTO-CERT-NO.
   854             20  ELCRTO-CERT-PRIME   PIC X(10).
   855             20  ELCRTO-CERT-SFX     PIC X.
   856         16  ELCRTO-RECORD-TYPE      PIC X.
   857         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   858
   859
   860     12  WS-ACCESS.
   861         16  FILLER               PIC XX    VALUE SPACES.
   862         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   863
   864     12  WS-CARR-ACCESS.
   865         16  FILLER               PIC X(3)  VALUE SPACES.
   866         16  WS-CARR              PIC X     VALUE SPACE.
   867*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   868*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   869     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   870         88  WS-DMD-LF-RATING   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  17
* EL050.cbl
   871         88  WS-DMD-AH-RATING   VALUE 'Y'.
   872         88  WS-DMD-NO-RATING   VALUE 'N'.
   873
   874     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   875         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   876                                         'NJ' 'NL'
   877                                         'PJ' 'PL'
   878                                         'SJ' 'SL'.
   879     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   880         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   881                                         'NI' 'NJ' 'NL' 'NU'
   882                                         'PJ' 'PL' 'PI' 'PU'
   883                                         'SI' 'SJ' 'SL' 'SU'
   884                                         'MX' 'MY' 'MZ'.
   885 01  ERPDEF-KEY-SAVE             PIC X(18).
   886 01  ERPDEF-KEY.
   887     12  ERPDEF-COMPANY-CD       PIC X.
   888     12  ERPDEF-STATE            PIC XX.
   889     12  ERPDEF-PROD-CD          PIC XXX.
   890     12  F                       PIC X(7).
   891     12  ERPDEF-BEN-TYPE         PIC X.
   892     12  ERPDEF-BEN-CODE         PIC XX.
   893     12  ERPDEF-EXP-DT           PIC XX.
   894
   895 01  ELSTAT-KEY-SAVE             PIC X(20).
   896 01  ELSTAT-KEY.
   897     12  ELSTAT-COMPANY-ID       PIC XXX.
   898     12  ELSTAT-CARRIER          PIC X.
   899     12  ELSTAT-GROUP            PIC X(6).
   900     12  ELSTAT-STATE            PIC XX.
   901     12  ELSTAT-EXP-DT           PIC 9(8).
   902 01  WS-ERROR-VALUES.
   903     12  ER-1570                     PIC S9(4)   VALUE +1570.
   904     12  ER-1571                     PIC S9(4)   VALUE +1571.
   905     12  er-1572                     pic s9(4)   value +1572.
   906     12  er-1573                     pic s9(4)   value +1573.
   907     12  er-1574                     pic s9(4)   value +1574.
   908     12  ER-1575                     PIC S9(4)   VALUE +1575.
   909     12  er-1576                     pic s9(4)   value +1576.
   910     12  er-1743                     pic s9(4)   value +1743.
   911     12  er-1744                     pic s9(4)   value +1744.
   912     12  er-1745                     pic s9(4)   value +1745.
   913     12  er-1746                     pic s9(4)   value +1746.
   914     12  er-1747                     pic s9(4)   value +1747.
   915     12  er-1748                     pic s9(4)   value +1748.
   916     12  ER-1891                     PIC S9(4)   VALUE +1891.
   917     12  ER-1892                     PIC S9(4)   VALUE +1892.
   918     12  ER-1893                     PIC S9(4)   VALUE +1893.
   919     12  ER-1894                     PIC S9(4)   VALUE +1894.
   920     12  ER-1895                     PIC S9(4)   VALUE +1895.
   921     12  ER-1896                     PIC S9(4)   VALUE +1896.
   922     12  ER-1897                     PIC S9(4)   VALUE +1897.
   923     12  ER-1898                     PIC S9(4)   VALUE +1898.
   924     12  ER-1899                     PIC S9(4)   VALUE +1899.
   925     12  ER-1900                     PIC S9(4)   VALUE +1900.
   926     12  ER-1901                     PIC S9(4)   VALUE +1901.
   927     12  ER-1902                     PIC S9(4)   VALUE +1902.
   928     12  ER-1903                     PIC S9(4)   VALUE +1903.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  18
* EL050.cbl
   929     12  ER-1904                     PIC S9(4)   VALUE +1904.
   930     12  ER-1905                     PIC S9(4)   VALUE +1905.
   931     12  ER-1906                     PIC S9(4)   VALUE +1906.
   932     12  ER-1907                     PIC S9(4)   VALUE +1907.
   933     12  ER-1909                     PIC S9(4)   VALUE +1909.
   934     12  ER-1910                     PIC S9(4)   VALUE +1910.
   935     12  ER-1911                     PIC S9(4)   VALUE +1911.
   936     12  ER-1912                     PIC S9(4)   VALUE +1912.
   937     12  ER-1913                     PIC S9(4)   VALUE +1913.
   938     12  ER-1914                     PIC S9(4)   VALUE +1914.
   939     12  ER-1915                     PIC S9(4)   VALUE +1915.
   940     12  ER-1916                     PIC S9(4)   VALUE +1916.
   941     12  ER-1917                     PIC S9(4)   VALUE +1917.
   942     12  ER-1918                     PIC S9(4)   VALUE +1918.
   943     12  ER-1919                     PIC S9(4)   VALUE +1919.
   944     12  ER-1920                     PIC S9(4)   VALUE +1920.
   945     12  ER-1921                     PIC S9(4)   VALUE +1921.
   946     12  ER-1922                     PIC S9(4)   VALUE +1922.
   947     12  ER-1923                     PIC S9(4)   VALUE +1923.
   948     12  ER-1924                     PIC S9(4)   VALUE +1924.
   949     12  ER-1925                     PIC S9(4)   VALUE +1925.
   950     12  ER-1926                     PIC S9(4)   VALUE +1926.
   951     12  ER-1927                     PIC S9(4)   VALUE +1927.
   952     12  ER-2393                     PIC S9(4)   VALUE +2393.
   953     12  ER-2600                     PIC S9(4)   VALUE +2600.
   954     12  ER-2601                     PIC S9(4)   VALUE +2601.
   955     12  ER-2602                     PIC S9(4)   VALUE +2602.
   956     12  ER-2603                     PIC S9(4)   VALUE +2603.
   957     12  ER-2604                     PIC S9(4)   VALUE +2604.
   958     12  ER-2605                     PIC S9(4)   VALUE +2605.
   959     12  ER-2606                     PIC S9(4)   VALUE +2606.
   960     12  ER-2607                     PIC S9(4)   VALUE +2607.
   961     12  ER-2608                     PIC S9(4)   VALUE +2608.
   962     12  ER-2609                     PIC S9(4)   VALUE +2609.
   963     12  ER-2610                     PIC S9(4)   VALUE +2610.
   964     12  ER-2611                     PIC S9(4)   VALUE +2611.
   965     12  ER-2612                     PIC S9(4)   VALUE +2612.
   966     12  ER-2613                     PIC S9(4)   VALUE +2613.
   967     12  ER-2614                     PIC S9(4)   VALUE +2614.
   968     12  ER-2615                     PIC S9(4)   VALUE +2615.
   969     12  ER-2616                     PIC S9(4)   VALUE +2616.
   970     12  ER-2617                     PIC S9(4)   VALUE +2617.
   971     12  ER-2618                     PIC S9(4)   VALUE +2618.
   972     12  ER-2619                     PIC S9(4)   VALUE +2619.
   973     12  ER-2620                     PIC S9(4)   VALUE +2620.
   974     12  ER-2621                     PIC S9(4)   VALUE +2621.
   975     12  ER-2622                     PIC S9(4)   VALUE +2622.
   976     12  ER-2623                     PIC S9(4)   VALUE +2623.
   977     12  ER-2624                     PIC S9(4)   VALUE +2624.
   978     12  ER-2625                     PIC S9(4)   VALUE +2625.
   979     12  ER-2626                     PIC S9(4)   VALUE +2626.
   980     12  ER-2627                     PIC S9(4)   VALUE +2627.
   981     12  ER-2628                     PIC S9(4)   VALUE +2628.
   982     12  ER-2629                     PIC S9(4)   VALUE +2629.
   983     12  ER-2630                     PIC S9(4)   VALUE +2630.
   984     12  ER-2631                     PIC S9(4)   VALUE +2631.
   985     12  ER-2632                     PIC S9(4)   VALUE +2632.
   986     12  ER-2633                     PIC S9(4)   VALUE +2633.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  19
* EL050.cbl
   987     12  ER-2634                     PIC S9(4)   VALUE +2634.
   988     12  ER-2635                     PIC S9(4)   VALUE +2635.
   989     12  ER-2636                     PIC S9(4)   VALUE +2636.
   990     12  ER-2637                     PIC S9(4)   VALUE +2637.
   991     12  ER-2638                     PIC S9(4)   VALUE +2638.
   992     12  ER-2639                     PIC S9(4)   VALUE +2639.
   993     12  ER-2640                     PIC S9(4)   VALUE +2640.
   994     12  ER-2641                     PIC S9(4)   VALUE +2641.
   995     12  ER-2642                     PIC S9(4)   VALUE +2642.
   996     12  ER-2643                     PIC S9(4)   VALUE +2643.
   997     12  ER-2644                     PIC S9(4)   VALUE +2644.
   998     12  ER-2645                     PIC S9(4)   VALUE +2645.
   999     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1000     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1001     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1002     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1003     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1004     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1005     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1006     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1007     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1008     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1009     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1010     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1011     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1012     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1013     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1014     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1015     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1016     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1017     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1018     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1019     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1020     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1021     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1022     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1023     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1024     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1025     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1026     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1027     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1028     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1029     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1030     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1031     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1032     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1033     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1034     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1035     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1036     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1037     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1038     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1039     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1040     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1041     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1042     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1043     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1044     12  ER-2691                     PIC S9(4)   VALUE +2691.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  20
* EL050.cbl
  1045     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1046     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1047     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1048     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1049     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1050     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1051     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1052     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1053     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1054     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1055     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1056     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1057     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1058     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1059     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1060     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1061     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1062     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1063     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1064     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1065     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1066     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1067     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1068     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1069     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1070     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1071     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1072     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1073     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1074     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1075     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1076     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1077     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1078     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1079     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1080     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1081     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1082     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1083     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1084     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1085     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1086     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1087     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1088     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1089     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1090     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1091     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1092     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1093     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1094     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1095     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1096     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1097     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1098     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1099     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1100     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1101     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1102     12  ER-2759                     PIC S9(4)   VALUE +2759.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  21
* EL050.cbl
  1103     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1104     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1105     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1106     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1107     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1108     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1109     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1110     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1111     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1112     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1113     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1114     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1115     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1116     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1117     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1118     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1119     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1120     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1121     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1122     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1123     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1124     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1125     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1126     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1127     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1128     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1129     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1130     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1131     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1132     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1133     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1134     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1135     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1136     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1137     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1138     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1139     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1140     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1141     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1142     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1143     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1144     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1145     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1146     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1147     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1148     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1149     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1150     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1151     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1152     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1153     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1154     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1155     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1156     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1157     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1158     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1159     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1160     12  ER-3049                     PIC S9(4)   VALUE +3049.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  22
* EL050.cbl
  1161     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1162     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1163     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1164     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1165     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1166     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1167     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1168     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1169     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1170     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1171     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1172     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1173     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1174     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1175     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1176     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1177     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1178     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1179     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1180     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1181     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1182     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1183     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1184     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1185     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1186     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1187     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1188     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1189     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1190     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1191     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1192     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1193     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1194     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1195     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1196     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1197     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1198     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1199     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1200     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1201     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1202     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1203     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1204     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1205     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1206     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1207     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1208     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1209     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1210     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1211     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1212     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1213     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1214     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1215     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1216     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1217     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1218     12  ER-8087                     PIC S9(4)   VALUE +8087.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  23
* EL050.cbl
  1219     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1220     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1221     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1222     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1223     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1224     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1225     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1226     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1227     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1228     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1229     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1230     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1231     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1232     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1233     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1234     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1235     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1236     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1237     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1238     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1239     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1240     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1241     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1242     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1243     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1244     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1245     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1246     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1247     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1248     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1249     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1250     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1251     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1252     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1253     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1254     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1255     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1256     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1257     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1258     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1259******************************************************************
  1260***************   END OF ELC50WS     ****************************
  1261******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  24
* EL050.cbl
  1264 01  WORKING-STORAGE-WORK-AREAS.
  1265     12  WS-RESPONSE             PIC S9(8)  COMP.
  1266         88  WS-RESP-NORMAL           VALUE +00.
  1267         88  WS-RESP-ERROR            VALUE +01.
  1268         88  WS-RESP-NOTFND           VALUE +13.
  1269         88  WS-RESP-DUPREC           VALUE +14.
  1270         88  WS-RESP-ENDFILE          VALUE +20.
  1271     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1272     12  WORK-AREAS.
  1273         16  WK-CONV-GREG.
  1274             24  WCG-CENT             PIC XX.
  1275             24  WCG-REST             PIC X(4).
  1276         16  WORK-GREGORIAN-DATE.
  1277             24  WK-GREG-CENT         PIC XX.
  1278             24  WK-GREG-DATE-YYMMDD.
  1279                 28  WK-GREG-YYMM     PIC X(4).
  1280                 28  WK-GREG-DD       PIC XX.
  1281
  1282         16  WORK-SELECT-DATE.
  1283             24  WK-SELECT-CENT            PIC XX.
  1284             24  WK-SELECT-DATE-YYMMDD.
  1285                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1286                 28  FILLER                PIC XX.
  1287
  1288         16  WK-FORM-NO.
  1289             24  WK-FORM-BANK-ID       PIC X(5).
  1290             24  WK-FORM-UNDRWRTR      PIC X(1).
  1291             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1292
  1293         16  WK-MEMBER-NO.
  1294             24  WK-MEMBER-1-6        PIC X(6).
  1295             24  WK-MEMBER-7-12       PIC X(6).
  1296
  1297         16  WK-FULL-CERT-NO.
  1298             24  WK-CERT-POS-1-2      PIC X(2).
  1299             24  WK-CERT-POS-3        PIC X(1).
  1300             24  WK-CERT-POS-4        PIC X(1).
  1301             24  WK-CERT-POS-5-6      PIC X(2).
  1302             24  WK-CERT-POS-7        PIC X(1).
  1303             24  WK-CERT-POS-8-11     PIC X(4).
  1304
  1305         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1306             88  VALID-RATE-CODE        VALUE 'Y'.
  1307             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1308
  1309         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1310         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1311         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1312         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1313         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1314         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1315         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1316         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1317         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1318         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1319
  1320* DLO001
  1321 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  25
* EL050.cbl
  1322     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1323     12  DMPF-RETURN-CODE          PIC XX.
  1324         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1325         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1326         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1327         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1328         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1329         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1330
  1331* DLO002
  1332 01  WS-DLO-INTERNAL-POLICY-FORM.
  1333     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1334     12  DIPF-RETURN-CODE          PIC XX.
  1335         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1336         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1337         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1338         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1339         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1340         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1341
  1342* DLO003
  1343 01  WS-DLO-VALID-BANK-ID.
  1344     12  DVBI-BANK-ID              PIC X(5).
  1345     12  DVBI-BANK-ID-TYPE         PIC X.
  1346         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1347         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1348         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1349         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1350         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1351     12  DVBI-RETURN-CODE          PIC XX.
  1352         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1353         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1354         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1355         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1356         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1357         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1358         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1359         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1360         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1361
  1362* DLO007
  1363 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1364     12  DCUA-RES-STATE            PIC XX.
  1365     12  DCUA-BEN-TYPE             PIC XX.
  1366     12  DCUA-SYS-IDENT            PIC X.
  1367         88  DCUA-CLAIM                        VALUE 'C'.
  1368         88  DCUA-PREMIUM                      VALUE 'P'.
  1369     12  DCUA-COVERAGE-RULE        PIC X.
  1370     12  DCUA-CLIENT-ID            PIC X(10).
  1371     12  DCUA-EFF-DATE             PIC X(8).
  1372     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1373     12  DCUA-RETURN-CODE          PIC XX.
  1374         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1375     12  DCUA-CERT-NUMBER          PIC X(11).
  1376     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1377     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1378
  1379* DLO011
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  26
* EL050.cbl
  1380 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1381     12  DPRB-RATE-CODE            PIC X(4).
  1382     12  DPRB-COVERAGE-CATEG       PIC X.
  1383     12  DPRB-RETURN-CODE          PIC XX.
  1384         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1385         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1386         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1387         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1388         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1389         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1390         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1391         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1392         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1393     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1394     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1395     12  DPRB-BEN-TYPE             PIC XX.
  1396
  1397* DLO017
  1398 01  WS-DLO-VALID-RATE-CODE.
  1399     12  DVRC-RATE-CODE            PIC X(4).
  1400     12  DVRC-RETURN-CODE          PIC XX.
  1401         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1402         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1403         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1404         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1405         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1406         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1407
  1408* DLO019
  1409 01  WS-DLO-ORIG-COV-CAT.
  1410     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1411     12  DOCC-RETURN-CODE          PIC XX.
  1412     12  DOCC-ORIG-COV-CAT         PIC X.
  1413     12  DOCC-UNDERWITER           PIC XX.
  1414     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1415     12  DOCC-FILLER               PIC X(6).
  1416
  1417* DLO021
  1418 01  WS-DLO-VALID-LOAN-OFFICER.
  1419     12  DVLO-LOAN-OFFICER.
  1420         16  DVLO-BILL-TYPE        PIC X.
  1421         16  DVLO-BILL-SOURCE      PIC X.
  1422         16  DVLO-BATCH-TYPE       PIC X.
  1423     12  DVLO-RETURN-CODE          PIC XX.
  1424         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1425         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1426         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1427         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1428         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1429         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1430
  1431* DLO022
  1432 01  WS-DLO-VALID-STATE-CODE.
  1433     12  DVSC-STATE-CODE           PIC XX.
  1434     12  DVSC-RETURN-CODE          PIC XX.
  1435         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1436
  1437* DLO023
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  27
* EL050.cbl
  1438 01  WS-DLO-VALID-CODE-VALUES.
  1439     12  DVCV-SYSTEM-ID            PIC XX.
  1440         88  DVCV-CLAIMS                       VALUE 'CL'.
  1441         88  DVCV-CREDIT                       VALUE 'CR'.
  1442     12  DVCV-RECORD-TYPE          PIC XX.
  1443         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1444         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1445         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1446         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1447         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1448         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1449         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1450         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1451     12  DVCV-RECORD-KEY           PIC X(6).
  1452     12  DVCV-RETURN-CODE          PIC XX.
  1453         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1454         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1455         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1456         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1457         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1458         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1459         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1460     12  DVCV-CODE-DESC            PIC X(60).
  1461     12  DVCV-GEN-DESC-1           PIC X(20).
  1462     12  DVCV-GEN-DESC-2           PIC X(20).
  1463     12  DVCV-GEN-DESC-3           PIC X(20).
  1464
  1465****  this is for aggregate report.
  1466****  Length is erpndb + 100 of passed-key-area
  1467 01  ws-passed-key-length        pic s9(4) comp value +587.
  1468 01  ws-pass-to-pemaggo.
  1469     05  ws-passed-erpndb        pic x(585).
  1470     05  ws-exceed-limit-yn      pic x.
  1471     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  28
* EL050.cbl
  1473*    COPY ERCBXRF.
  1474******************************************************************
  1475*                                                                *
  1476*                                                                *
  1477*                            ERCBXRF                             *
  1478*                                                                *
  1479*   ONLINE CREDIT SYSTEM                                         *
  1480*                                                                *
  1481*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1482*                                                                *
  1483*   FILE TYPE = VSAM,KSDS                                        *
  1484*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1485*                                                                *
  1486*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1487*       ALTERNATE PATH = NONE                                    *
  1488*                                                                *
  1489*   LOG = NO                                                     *
  1490*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1491*                                                                *
  1492******************************************************************
  1493
  1494 01  BANK-CROSS-REFERENCE.
  1495     12  BK-RECORD-ID                PIC XX.
  1496         88  VALID-BK-ID             VALUE 'BK'.
  1497
  1498     12  BK-CONTROL-PRIMARY.
  1499         16  BK-COMPANY-CD           PIC X.
  1500         16  BK-CARRIER              PIC X.
  1501         16  BK-GROUPING             PIC X(6).
  1502         16  BK-BANK-NO              PIC X(10).
  1503
  1504     12  BK-MAINT-INFORMATION.
  1505         16  BK-LAST-MAINT-DT        PIC XX.
  1506         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1507         16  BK-LAST-MAINT-USER      PIC X(4).
  1508         16  FILLER                  PIC X(9).
  1509
  1510     12  FILLER                      PIC X(37).
  1511
  1512     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1513
  1514     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1515                            DEPENDING ON BK-BANK-POINTER-CNT.
  1516         16  BK-AM-ACCOUNT           PIC X(10).
  1517         16  BK-AM-EXP-DT            PIC XX.
  1518         16  BK-AM-EFF-DT            PIC XX.
  1519         16  BK-AM-STATE             PIC XX.
  1520         16  FILLER                  PIC X(20).
  1521
  1522******************************************************************
  1523
  1524*    COPY ERCCOMP.
  1525******************************************************************
  1526*                                                                *
  1527*                                                                *
  1528*                            ERCCOMP                             *
  1529*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1530*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  29
* EL050.cbl
  1531*                                                                *
  1532*   ONLINE CREDIT SYSTEM                                         *
  1533*                                                                *
  1534*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1535*                                                                *
  1536*   FILE TYPE = VSAM,KSDS                                        *
  1537*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1538*                                                                *
  1539*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1540*       ALTERNATE PATH = NONE                                    *
  1541*                                                                *
  1542*   LOG = NO                                                     *
  1543*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1544*                                                                *
  1545******************************************************************
  1546*                   C H A N G E   L O G
  1547*
  1548* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1549*-----------------------------------------------------------------
  1550*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1551* EFFECTIVE    NUMBER
  1552*-----------------------------------------------------------------
  1553* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1554* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1555* 092205    2005050300006  PEMA  ADD LEASE FEE
  1556* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1557* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1558* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1559* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1560* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1561* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1562******************************************************************
  1563
  1564 01  COMPENSATION-MASTER.
  1565     12  CO-RECORD-ID                          PIC XX.
  1566         88  VALID-CO-ID                          VALUE 'CO'.
  1567
  1568     12  CO-CONTROL-PRIMARY.
  1569         16  CO-COMPANY-CD                     PIC X.
  1570         16  CO-CONTROL.
  1571             20  CO-CTL-1.
  1572                 24  CO-CARR-GROUP.
  1573                     28  CO-CARRIER            PIC X.
  1574                     28  CO-GROUPING.
  1575                         32  CO-GROUP-PREFIX   PIC XXX.
  1576                         32  CO-GROUP-PRIME    PIC XXX.
  1577                 24  CO-RESP-NO.
  1578                     28  CO-RESP-PREFIX        PIC X(4).
  1579                     28  CO-RESP-PRIME         PIC X(6).
  1580             20  CO-CTL-2.
  1581                 24  CO-ACCOUNT.
  1582                     28  CO-ACCT-PREFIX        PIC X(4).
  1583                     28  CO-ACCT-PRIME         PIC X(6).
  1584         16  CO-TYPE                           PIC X.
  1585             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1586             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1587             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1588
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  30
* EL050.cbl
  1589     12  CO-MAINT-INFORMATION.
  1590         16  CO-LAST-MAINT-DT                  PIC XX.
  1591         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1592         16  CO-LAST-MAINT-USER                PIC X(4).
  1593     12  FILLER                                PIC XX.
  1594     12  CO-STMT-TYPE                          PIC XXX.
  1595     12  CO-COMP-TYPE                          PIC X.
  1596         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1597     12  CO-STMT-OWNER                         PIC X(4).
  1598     12  CO-BALANCE-CONTROL                    PIC X.
  1599         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1600         88  CO-NO-BALANCE                        VALUE 'N'.
  1601
  1602     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1603         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1604         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1605         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1606
  1607     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1608         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1609         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1610
  1611     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1612     12  CO-GA-DIRECT-DEP                      PIC X.
  1613     12  CO-FUTURE-SPACE                       PIC X.
  1614         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1615
  1616     12  CO-ACCT-NAME                          PIC X(30).
  1617     12  CO-MAIL-NAME                          PIC X(30).
  1618     12  CO-ADDR-1                             PIC X(30).
  1619     12  CO-ADDR-2                             PIC X(30).
  1620     12  CO-ADDR-3.
  1621         16  CO-ADDR-CITY                      PIC X(27).
  1622         16  CO-ADDR-STATE                     PIC XX.
  1623     12  CO-CSO-1099                           PIC X.
  1624     12  CO-ZIP.
  1625         16  CO-ZIP-PRIME.
  1626             20  CO-ZIP-PRI-1ST                PIC X.
  1627                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1628             20  FILLER                        PIC X(4).
  1629         16  CO-ZIP-PLUS4                      PIC X(4).
  1630     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1631         16  CO-CAN-POSTAL-1                   PIC XXX.
  1632         16  CO-CAN-POSTAL-2                   PIC XXX.
  1633         16  FILLER                            PIC XXX.
  1634     12  CO-SOC-SEC                            PIC X(13).
  1635     12  CO-TELEPHONE.
  1636         16  CO-AREA-CODE                      PIC XXX.
  1637         16  CO-PREFIX                         PIC XXX.
  1638         16  CO-PHONE                          PIC X(4).
  1639
  1640     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1641
  1642     12  CO-AR-BAL-LEVEL                       PIC X.
  1643         88  CO-AR-REF-LVL                        VALUE '1'.
  1644         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1645         88  CO-AR-BILL-LVL                       VALUE '2'.
  1646         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  31
* EL050.cbl
  1647         88  CO-AR-FR-LVL                         VALUE '4'.
  1648
  1649     12  CO-AR-NORMAL-PRINT                    PIC X.
  1650         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1651         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1652
  1653     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1654
  1655     12  CO-AR-REPORTING                       PIC X.
  1656         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1657         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1658
  1659     12  CO-AR-PULL-CHECK                      PIC X.
  1660         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1661         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1662
  1663     12  CO-AR-BALANCE-PRINT                   PIC X.
  1664         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1665
  1666     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1667         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1668         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1669         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1670
  1671     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1672
  1673     12  CO-USER-CODE                          PIC X.
  1674     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1675
  1676******************************************************************
  1677*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1678*    THE LAST MONTH END RUN.
  1679******************************************************************
  1680
  1681     12  CO-LAST-ACTIVITY-DATE.
  1682         16  CO-ACT-YEAR                       PIC 99.
  1683         16  CO-ACT-MONTH                      PIC 99.
  1684         16  CO-ACT-DAY                        PIC 99.
  1685
  1686     12  CO-LAST-STMT-DT.
  1687         16  CO-LAST-STMT-YEAR                 PIC 99.
  1688         16  CO-LAST-STMT-MONTH                PIC 99.
  1689         16  CO-LAST-STMT-DAY                  PIC 99.
  1690
  1691     12  CO-MO-END-TOTALS.
  1692         16  CO-MONTHLY-TOTALS.
  1693             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1694             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1695             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1696             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1697             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-AGING-TOTALS.
  1700             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1701             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1702             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1703             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1704
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  32
* EL050.cbl
  1705         16  CO-YTD-TOTALS.
  1706             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1707             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1708
  1709         16  CO-OVER-UNDER-TOTALS.
  1710             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1711             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1712
  1713     12  CO-MISCELLANEOUS-TOTALS.
  1714         16  CO-FICA-TOTALS.
  1715             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1716             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1717
  1718         16  CO-CLAIM-TOTALS.
  1719             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1720             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1721
  1722******************************************************************
  1723*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1724*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1725******************************************************************
  1726
  1727     12  CO-CURRENT-TOTALS.
  1728         16  CO-CURRENT-LAST-STMT-DT.
  1729             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1730             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1731             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1732
  1733         16  CO-CURRENT-MONTHLY-TOTALS.
  1734             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1735             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1736             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1737             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1738             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1739
  1740         16  CO-CURRENT-AGING-TOTALS.
  1741             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1742             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1743             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1745
  1746         16  CO-CURRENT-YTD-TOTALS.
  1747             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1748             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1749
  1750     12  CO-PAID-COMM-TOTALS.
  1751         16  CO-YTD-PAID-COMMS.
  1752             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1753             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1754
  1755     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1756         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1757         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1758
  1759     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1760         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1761         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1762         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  33
* EL050.cbl
  1763         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1764         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1765         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1766         88  CO-FINAL-LETTER                  VALUE 'F'.
  1767         88  CO-RECONCILING                   VALUE 'R'.
  1768         88  CO-PHONE-CALL                    VALUE 'P'.
  1769         88  CO-LEGAL                         VALUE 'L'.
  1770         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1771         88  CO-WRITE-OFF                     VALUE 'W'.
  1772         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1773
  1774     12  CO-CSR-CODE                       PIC X(4).
  1775
  1776     12  CO-GA-STATUS-INFO.
  1777         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1778         16  CO-GA-TERMINATION-DT          PIC XX.
  1779         16  CO-GA-STATUS-CODE             PIC X.
  1780             88  CO-GA-ACTIVE                 VALUE 'A'.
  1781             88  CO-GA-INACTIVE               VALUE 'I'.
  1782             88  CO-GA-PENDING                VALUE 'P'.
  1783         16  CO-GA-COMMENTS.
  1784             20  CO-GA-COMMENT-1           PIC X(40).
  1785             20  CO-GA-COMMENT-2           PIC X(40).
  1786             20  CO-GA-COMMENT-3           PIC X(40).
  1787             20  CO-GA-COMMENT-4           PIC X(40).
  1788
  1789     12  CO-RPTCD2                         PIC X(10).
  1790     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1791         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1792         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1793
  1794     12  CO-TYPE-AGENT                     PIC X(01).
  1795         88  CO-CORPORATION                   VALUE 'C'.
  1796         88  CO-PARTNERSHIP                   VALUE 'P'.
  1797         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1798         88  CO-TRUST                         VALUE 'T'.
  1799         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1800
  1801     12  CO-FAXNO.
  1802         16  CO-FAX-AREA-CODE                  PIC XXX.
  1803         16  CO-FAX-PREFIX                     PIC XXX.
  1804         16  CO-FAX-PHONE                      PIC X(4).
  1805
  1806     12  CO-BANK-INFORMATION.
  1807         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1808         16  CO-BANK-TRANSIT-NON REDEFINES
  1809             CO-BANK-TRANSIT-NO                PIC 9(8).
  1810
  1811         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1812     12  CO-MISC-DEDUCT-INFO REDEFINES
  1813                  CO-BANK-INFORMATION.
  1814         16  CO-MD-GL-ACCT                     PIC X(10).
  1815         16  CO-MD-DIV                         PIC XX.
  1816         16  CO-MD-CENTER                      PIC X(4).
  1817         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1818         16  CO-CREATE-AP-CHECK                PIC X.
  1819         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1820         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  34
* EL050.cbl
  1821     12  CO-ACH-STATUS                         PIC X.
  1822         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1823         88  CO-ACH-PENDING                        VALUE 'P'.
  1824
  1825     12  CO-BILL-SW                            PIC X.
  1826     12  CO-CONTROL-NAME                       PIC X(30).
  1827     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1828     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1829     12  CO-CLP-STATE                          PIC XX.
  1830     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1831     12  CO-SPP-REFUND-EDIT                    PIC X.
  1832
  1833******************************************************************
  1834
  1835*    COPY ERCAGTC.
  1836******************************************************************
  1837*                                                                *
  1838*                                                                *
  1839*                            ERCAGTC                             *
  1840*                            VMOD=2.001                          *
  1841*                                                                *
  1842*   ONLINE CREDIT SYSTEM                                         *
  1843*                                                                *
  1844*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1845*                                                                *
  1846*   FILE TYPE = VSAM,KSDS                                        *
  1847*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1848*                                                                *
  1849*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1850*       ALTERNATE PATH = NONE                                    *
  1851*                                                                *
  1852*   LOG = NO                                                     *
  1853*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1854*                                                                *
  1855******************************************************************
  1856*                   C H A N G E   L O G
  1857*
  1858* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1859*-----------------------------------------------------------------
  1860*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1861* EFFECTIVE    NUMBER
  1862*-----------------------------------------------------------------
  1863* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1864* 111004                         NEW FILE AND COPYBOOK
  1865* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1866******************************************************************
  1867 01  AGENT-COMMISSIONS.
  1868     12  AG-RECORD-ID                          PIC XX.
  1869         88  VALID-CO-ID                          VALUE 'AG'.
  1870     12  AG-CONTROL-PRIMARY.
  1871         16  AG-COMPANY-CD                     PIC X.
  1872         16  AG-CONTROL.
  1873             20  AG-CTL-1.
  1874                 24  AG-CARR-GROUP.
  1875                     28  AG-CARRIER            PIC X.
  1876                     28  AG-GROUPING           PIC X(6).
  1877                 24  AG-BANK                   PIC X(10).
  1878             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  35
* EL050.cbl
  1879                 24  AG-EXP-DT                 PIC XX.
  1880         16  AG-TYPE                           PIC X.
  1881             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1882             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1883     12  AG-MAINT-INFORMATION.
  1884         16  AG-LAST-MAINT-DT                  PIC XX.
  1885         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1886         16  AG-LAST-MAINT-USER                PIC X(4).
  1887         16  FILLER                            PIC X(10).
  1888     12  AG-EFF-DT                             PIC XX.
  1889     12  AG-COMM-STRUCTURE.
  1890         16  AG-AGT-COMMS OCCURS 10.
  1891             20  AG-AGT                PIC X(10).
  1892             20  AG-COM-TYP            PIC X.
  1893             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1894             20  AG-RECALC-LV-INDIC    PIC X.
  1895             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1896             20  AG-LRCALC-LV-INDIC    PIC X.
  1897             20  FILLER                PIC X(05).
  1898     12  FILLER                  PIC X(145).
  1899******************************************************************
  1900*    COPY ERCRESS.
  1901******************************************************************
  1902*                                                                *
  1903*                            ERCRESS                             *
  1904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1905*                            VMOD=2.002                          *
  1906*                                                                *
  1907*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1908*                                                                *
  1909*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1910*   VSAM RESIDENT STATE TAX MASTER                              *
  1911*                                                                *
  1912*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1913*                                                                *
  1914*   FILE TYPE = VSAM,KSDS                                        *
  1915*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1916*                                                                *
  1917*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1918*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1919*                                                                *
  1920*   LOG = NO                                                     *
  1921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1922*                                                                *
  1923*                                                                *
  1924******************************************************************
  1925
  1926 01  RESIDENT-STATE-TAX-MASTER.
  1927
  1928     10  ERRESS-PRIMARY-KEY.
  1929         15  RES-COMPANY-CD        PIC X.
  1930         15  RES-RESIDENT-STATE    PIC XX.
  1931         15  RES-COVERAGE-CATEGORY PIC X.
  1932         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1933*                                      YYYYMMDD
  1934*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1935
  1936     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  36
* EL050.cbl
  1937
  1938         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1939         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1940         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1941         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1942
  1943     10 RES-RECALC-SW              PIC   X.
  1944         88 RECALC                VALUE 'Y'.
  1945         88 NO-RECALC             VALUE 'N'.
  1946     10  RES-MAINT-BY              PIC X(4).
  1947     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1948     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1949*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  37
* EL050.cbl
  1951*    COPY ERCRESC.
  1952******************************************************************
  1953*                                                                *
  1954*                            ERCRESC                             *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.003                          *
  1957*                                                                *
  1958*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1959*                                                                *
  1960*   FILE TYPE = VSAM,KSDS                                        *
  1961*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1962*                                                                *
  1963*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1964*       ALTERNATE PATH1 = NONE                                   *
  1965*                                                                *
  1966*   LOG = NO                                                     *
  1967*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1968*                                                                *
  1969******************************************************************
  1970
  1971 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1972
  1973     10  ERRESC-RECORD-KEY.
  1974         15  RESC-COMPANY-CD           PIC   X.
  1975         15  RESC-CARRIER              PIC   X.
  1976         15  RESC-GROUP                PIC   X(6).
  1977         15  RESC-STATE                PIC   XX.
  1978         15  RESC-ACCOUNT              PIC   X(10).
  1979         15  RESC-AGENT                PIC   X(10).
  1980         15  RESC-RESIDENT-STATE       PIC   XX.
  1981         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1982*                                           YYYYMMDD
  1983     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1984
  1985     10  RESC-COMM-RECORD-DATA.
  1986         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1987             20 RESC-COVERAGE-CAT      PIC    X.
  1988             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1989             20 RESC-COMMISSION-TAB REDEFINES
  1990                RESC-COMMISSION-PER    PIC  XXX.
  1991
  1992     10  RESC-MAINT-BY                 PIC X(4).
  1993     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1994     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1995*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  38
* EL050.cbl
  1997*    COPY ERCPLAN.
  1998******************************************************************
  1999*                                                                *
  2000*                                                                *
  2001*                            ERCPLAN                             *
  2002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2003*                            VMOD=2.003                          *
  2004*                                                                *
  2005*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2006*                                                                *
  2007*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2008*   PLAN MASTER                                                  *
  2009*                                                                *
  2010*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2011*                                                                *
  2012*   FILE TYPE = VSAM,KSDS                                        *
  2013*   RECORD SIZE = 420   RECFORM = FIX                            *
  2014*                                                                *
  2015*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2016*       ALTERNATE PATH1 = N/A                                    *
  2017*                                                                *
  2018*   LOG = NO                                                     *
  2019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2020*                                                                *
  2021*                                                                *
  2022******************************************************************
  2023
  2024 01  PLAN-MASTER.
  2025     12  PL-RECORD-ID                      PIC XX.
  2026         88  VALID-PL-ID                      VALUE 'PL'.
  2027
  2028     12  PL-CONTROL-PRIMARY.
  2029         16  PL-COMPANY-CD                 PIC X.
  2030         16  PL-MSTR-CNTRL.
  2031             20  PL-CONTROL-A.
  2032                 24  PL-CARRIER            PIC X.
  2033                 24  PL-GROUPING           PIC X(6).
  2034                 24  PL-STATE              PIC XX.
  2035                 24  PL-ACCOUNT            PIC X(10).
  2036             20  PL-BENEFIT-TYPE           PIC X.
  2037             20  PL-BENEFIT-CODE           PIC XX.
  2038             20  PL-REVISION-NO            PIC X(3).
  2039
  2040     12  PL-CONTROL-BY-VAR-GRP.
  2041         16  PL-COMPANY-CD-A1              PIC X.
  2042         16  PL-VG-CARRIER                 PIC X.
  2043         16  PL-VG-GROUPING                PIC X(6).
  2044         16  PL-VG-STATE                   PIC XX.
  2045         16  PL-VG-ACCOUNT                 PIC X(10).
  2046         16  PL-BENEFIT-TYPE-A1            PIC X.
  2047         16  PL-BENEFIT-CODE-A1            PIC XX.
  2048         16  PL-REVISION-NO-A1             PIC 999.
  2049
  2050     12  PL-MAINT-INFORMATION.
  2051         16  PL-LAST-MAINT-DT              PIC XX.
  2052         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2053         16  PL-LAST-MAINT-USER            PIC X(4).
  2054         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  39
* EL050.cbl
  2055
  2056     12  PL-LIABILITY-LIMITS.
  2057         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2058         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2059             20  PL-LM-AGE                 PIC S99        COMP-3.
  2060             20  PL-LM-DUR                 PIC S999       COMP-3.
  2061             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2062             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2063
  2064     12  FILLER                            PIC X(30).
  2065
  2066     12  PL-GL-ACCOUNT-NOS.
  2067         16  PL-PREMIUM-GL                 PIC X(8).
  2068         16  PL-COMM-GL                    PIC X(8).
  2069         16  PL-CLAIM-GL                   PIC X(8).
  2070     12  FILLER                            PIC X(24).
  2071     12  PL-TOLERANCES.
  2072         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2073         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2074         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2075         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2076         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2077         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2078     12  PL-OVER-SHORT.
  2079         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2080         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2081     12  FILLER                            PIC X(24).
  2082     12  PLAN-MISC.
  2083         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2084         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2085         16  PL-IG                         PIC X.
  2086         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2087         16  PL-POLICY-FORM                PIC X(12).
  2088         16  PL-EDIT-FOR-FORM              PIC X(01).
  2089         16  PL-DEV-CODE                   PIC XXX.
  2090         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2091         16  PL-CALC-METHOD                PIC X.
  2092         16  PL-BENEFIT-GROUP              PIC X(05).
  2093         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2094
  2095         16  FILLER                        PIC X(99).
  2096******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  40
* EL050.cbl
  2098*    COPY ELCCERT.
  2099******************************************************************
  2100*                                                                *
  2101*                            ELCCERT.                            *
  2102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2103*                            VMOD=2.013                          *
  2104*                                                                *
  2105*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2106*                                                                *
  2107*   FILE TYPE = VSAM,KSDS                                        *
  2108*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2109*                                                                *
  2110*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2111*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2112*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2113*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2114*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2115*                                                                *
  2116*   LOG = YES                                                    *
  2117*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2118******************************************************************
  2119*                   C H A N G E   L O G
  2120*
  2121* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2122*-----------------------------------------------------------------
  2123*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2124* EFFECTIVE    NUMBER
  2125*-----------------------------------------------------------------
  2126* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2127* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2128* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2129* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2130* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2131* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2132* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2133* 032612  CR2011110200001  PEMA  AHL CHANGES
  2134* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2135******************************************************************
  2136
  2137 01  CERTIFICATE-MASTER.
  2138     12  CM-RECORD-ID                      PIC XX.
  2139         88  VALID-CM-ID                      VALUE 'CM'.
  2140
  2141     12  CM-CONTROL-PRIMARY.
  2142         16  CM-COMPANY-CD                 PIC X.
  2143         16  CM-CARRIER                    PIC X.
  2144         16  CM-GROUPING.
  2145             20  CM-GROUPING-PREFIX        PIC X(3).
  2146             20  CM-GROUPING-PRIME         PIC X(3).
  2147         16  CM-STATE                      PIC XX.
  2148         16  CM-ACCOUNT.
  2149             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2150             20  CM-ACCOUNT-PRIME          PIC X(6).
  2151         16  CM-CERT-EFF-DT                PIC XX.
  2152         16  CM-CERT-NO.
  2153             20  CM-CERT-PRIME             PIC X(10).
  2154             20  CM-CERT-SFX               PIC X.
  2155
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  41
* EL050.cbl
  2156     12  CM-CONTROL-BY-NAME.
  2157         16  CM-COMPANY-CD-A1              PIC X.
  2158         16  CM-INSURED-LAST-NAME          PIC X(15).
  2159         16  CM-INSURED-INITIALS.
  2160             20  CM-INSURED-INITIAL1       PIC X.
  2161             20  CM-INSURED-INITIAL2       PIC X.
  2162
  2163     12  CM-CONTROL-BY-SSN.
  2164         16  CM-COMPANY-CD-A2              PIC X.
  2165         16  CM-SOC-SEC-NO.
  2166             20  CM-SSN-STATE              PIC XX.
  2167             20  CM-SSN-ACCOUNT            PIC X(6).
  2168             20  CM-SSN-LN3.
  2169                 25  CM-INSURED-INITIALS-A2.
  2170                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2171                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2172                 25 CM-PART-LAST-NAME-A2         PIC X.
  2173
  2174     12  CM-CONTROL-BY-CERT-NO.
  2175         16  CM-COMPANY-CD-A4              PIC X.
  2176         16  CM-CERT-NO-A4                 PIC X(11).
  2177
  2178     12  CM-CONTROL-BY-MEMB.
  2179         16  CM-COMPANY-CD-A5              PIC X.
  2180         16  CM-MEMBER-NO.
  2181             20  CM-MEMB-STATE             PIC XX.
  2182             20  CM-MEMB-ACCOUNT           PIC X(6).
  2183             20  CM-MEMB-LN4.
  2184                 25  CM-INSURED-INITIALS-A5.
  2185                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2186                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2187                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2188
  2189     12  CM-INSURED-PROFILE-DATA.
  2190         16  CM-INSURED-FIRST-NAME.
  2191             20  CM-INSURED-1ST-INIT       PIC X.
  2192             20  FILLER                    PIC X(9).
  2193         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2194         16  CM-INSURED-SEX                PIC X.
  2195             88  CM-SEX-MALE                  VALUE 'M'.
  2196             88  CM-SEX-FEMAL                 VALUE 'F'.
  2197         16  CM-INSURED-JOINT-AGE          PIC 99.
  2198         16  CM-JOINT-INSURED-NAME.
  2199             20  CM-JT-LAST-NAME           PIC X(15).
  2200             20  CM-JT-FIRST-NAME.
  2201                 24  CM-JT-1ST-INIT        PIC X.
  2202                 24  FILLER                PIC X(9).
  2203             20  CM-JT-INITIAL             PIC X.
  2204
  2205     12  CM-LIFE-DATA.
  2206         16  CM-LF-BENEFIT-CD              PIC XX.
  2207         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2208         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2209         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2210         16  CM-LF-DEV-CODE                PIC XXX.
  2211         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2212         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2213         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  42
* EL050.cbl
  2214         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2215         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2216         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2217         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2218         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2219         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2220         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2221         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2222         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2223         16  cm-temp-epiq                  pic xx.
  2224             88  EPIQ-CLASS                  value 'EQ'.
  2225*        16  FILLER                        PIC XX.
  2226
  2227     12  CM-AH-DATA.
  2228         16  CM-AH-BENEFIT-CD              PIC XX.
  2229         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2230         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2231         16  CM-AH-DEV-CODE                PIC XXX.
  2232         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2233         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2234         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2235         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2236         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2237         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2238         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2239         16  CM-AH-PAID-THRU-DT            PIC XX.
  2240             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2241         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2242         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2243         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2244         16  FILLER                        PIC X.
  2245
  2246     12  CM-LOAN-INFORMATION.
  2247         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2248         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2249                                           PIC S9(5)V99  COMP-3.
  2250         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2251         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2252         16  CM-PAY-FREQUENCY              PIC S99.
  2253         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2254         16  CM-RATE-CLASS                 PIC XX.
  2255         16  CM-BENEFICIARY                PIC X(25).
  2256         16  CM-POLICY-FORM-NO             PIC X(12).
  2257         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2258         16  CM-LAST-ADD-ON-DT             PIC XX.
  2259         16  CM-DEDUCTIBLE-AMOUNTS.
  2260             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2261             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2262         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2263             20  CM-RESIDENT-STATE         PIC XX.
  2264             20  CM-RATE-CODE              PIC X(4).
  2265             20  FILLER                    PIC XX.
  2266         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2267             20  CM-LOAN-OFFICER           PIC X(5).
  2268             20  FILLER                    PIC XXX.
  2269         16  CM-CSR-CODE                   PIC XXX.
  2270         16  CM-UNDERWRITING-CODE          PIC X.
  2271             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  43
* EL050.cbl
  2272         16  CM-POST-CARD-IND              PIC X.
  2273         16  CM-NH-INTERFACE-SW            PIC X.
  2274         16  CM-PREMIUM-TYPE               PIC X.
  2275             88  CM-SING-PRM                  VALUE '1'.
  2276             88  CM-O-B-COVERAGE              VALUE '2'.
  2277             88  CM-OPEN-END                  VALUE '3'.
  2278         16  CM-IND-GRP-TYPE               PIC X.
  2279             88  CM-INDIVIDUAL                VALUE 'I'.
  2280             88  CM-GROUP                     VALUE 'G'.
  2281         16  CM-SKIP-CODE                  PIC X.
  2282             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2283             88  SKIP-JULY                    VALUE '1'.
  2284             88  SKIP-AUGUST                  VALUE '2'.
  2285             88  SKIP-SEPTEMBER               VALUE '3'.
  2286             88  SKIP-JULY-AUG                VALUE '4'.
  2287             88  SKIP-AUG-SEPT                VALUE '5'.
  2288             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2289             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2290             88  SKIP-JUNE                    VALUE '8'.
  2291             88  SKIP-JUNE-JULY               VALUE '9'.
  2292             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2293             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2294         16  CM-PAYMENT-MODE               PIC X.
  2295             88  PAY-MONTHLY                  VALUE SPACE.
  2296             88  PAY-WEEKLY                   VALUE '1'.
  2297             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2298             88  PAY-BI-WEEKLY                VALUE '3'.
  2299             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2300         16  CM-LOAN-NUMBER                PIC X(8).
  2301         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2302         16  CM-OLD-LOF                    PIC XXX.
  2303*        16  CM-LOAN-OFFICER               PIC XXX.
  2304         16  CM-REIN-TABLE                 PIC XXX.
  2305         16  CM-SPECIAL-REIN-CODE          PIC X.
  2306         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2307         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2308         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2309
  2310     12  CM-STATUS-DATA.
  2311         16  CM-ENTRY-STATUS               PIC X.
  2312         16  CM-ENTRY-DT                   PIC XX.
  2313
  2314         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2315         16  CM-LF-CANCEL-DT               PIC XX.
  2316         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2317
  2318         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2319         16  CM-LF-DEATH-DT                PIC XX.
  2320         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2321
  2322         16  CM-LF-CURRENT-STATUS          PIC X.
  2323             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2324                                                'M' '4' '5' '9'.
  2325             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2326             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2327             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2328             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2329             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  44
* EL050.cbl
  2330             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2331             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2332             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2333             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2334             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2335             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2336             88  CM-LF-DECLINED               VALUE 'D'.
  2337             88  CM-LF-VOIDED                 VALUE 'V'.
  2338
  2339         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2340         16  CM-AH-CANCEL-DT               PIC XX.
  2341         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2342
  2343         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2344         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2345         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2346
  2347         16  CM-AH-CURRENT-STATUS          PIC X.
  2348             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2349                                                'M' '4' '5' '9'.
  2350             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2351             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2352             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2353             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2354             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2355             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2356             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2357             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2358             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2359             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2360             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2361             88  CM-AH-DECLINED               VALUE 'D'.
  2362             88  CM-AH-VOIDED                 VALUE 'V'.
  2363
  2364         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2365             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2366             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2367             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2368         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2369
  2370         16  CM-ENTRY-BATCH                PIC X(6).
  2371         16  CM-LF-EXIT-BATCH              PIC X(6).
  2372         16  CM-AH-EXIT-BATCH              PIC X(6).
  2373         16  CM-LAST-MONTH-END             PIC XX.
  2374
  2375     12  CM-NOTE-SW                        PIC X.
  2376         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2377         88  CERT-NOTES-PRESENT               VALUE '1'.
  2378         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2379         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2380         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2381         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2382         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2383         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2384     12  CM-COMP-EXCP-SW                   PIC X.
  2385         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2386         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2387     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  45
* EL050.cbl
  2388         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2389         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2390
  2391*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2392     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2393     12  FILLER                            PIC X.
  2394
  2395*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2396     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2397     12  FILLER                            PIC X.
  2398*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2399     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2400
  2401     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2402         88  CERT-ADDED-BATCH                 VALUE ' '.
  2403         88  CERT-ADDED-ONLINE                VALUE '1'.
  2404         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2405         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2406         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2407     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2408         88  CERT-AS-LOADED                   VALUE ' '.
  2409         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2410         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2411         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2412         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2413         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2414         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2415         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2416
  2417     12  CM-ACCOUNT-COMM-PCTS.
  2418         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2419         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2420
  2421     12  CM-USER-FIELD                     PIC X.
  2422     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2423     12  CM-CLP-STATE                      PIC XX.
  2424     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2425     12  CM-USER-RESERVED                  PIC XXX.
  2426     12  FILLER REDEFINES CM-USER-RESERVED.
  2427         16  CM-AH-CLASS-CD                PIC XX.
  2428         16  F                             PIC X.
  2429******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  46
* EL050.cbl
  2431*    COPY ERCMAIL.
  2432******************************************************************
  2433*                                                                *
  2434*                                                                *
  2435*                            ERCMAIL                             *
  2436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2437*                            VMOD=2.003                          *
  2438*                                                                *
  2439*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2440*                                                                *
  2441*   FILE TYPE = VSAM,KSDS                                        *
  2442*   RECORD SIZE = 374   RECFORM = FIX                            *
  2443*                                                                *
  2444*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2445*   ALTERNATE PATH    = NOT USED                                 *
  2446*                                                                *
  2447*   LOG = YES                                                    *
  2448*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2449******************************************************************
  2450*                   C H A N G E   L O G
  2451*
  2452* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2453*-----------------------------------------------------------------
  2454*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2455* EFFECTIVE    NUMBER
  2456*-----------------------------------------------------------------
  2457* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2458* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2459* 111108                   PEMA  ADD CRED BENE ADDR2
  2460******************************************************************
  2461
  2462 01  MAILING-DATA.
  2463     12  MA-RECORD-ID                      PIC XX.
  2464         88  VALID-MA-ID                       VALUE 'MA'.
  2465
  2466     12  MA-CONTROL-PRIMARY.
  2467         16  MA-COMPANY-CD                 PIC X.
  2468         16  MA-CARRIER                    PIC X.
  2469         16  MA-GROUPING.
  2470             20  MA-GROUPING-PREFIX        PIC XXX.
  2471             20  MA-GROUPING-PRIME         PIC XXX.
  2472         16  MA-STATE                      PIC XX.
  2473         16  MA-ACCOUNT.
  2474             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2475             20  MA-ACCOUNT-PRIME          PIC X(6).
  2476         16  MA-CERT-EFF-DT                PIC XX.
  2477         16  MA-CERT-NO.
  2478             20  MA-CERT-PRIME             PIC X(10).
  2479             20  MA-CERT-SFX               PIC X.
  2480
  2481     12  FILLER                            PIC XX.
  2482
  2483     12  MA-ACCESS-CONTROL.
  2484         16  MA-SOURCE-SYSTEM              PIC XX.
  2485             88  MA-FROM-CREDIT                VALUE 'CR'.
  2486             88  MA-FROM-VSI                   VALUE 'VS'.
  2487             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2488             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  47
* EL050.cbl
  2489         16  MA-RECORD-ADD-DT              PIC XX.
  2490         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2491         16  MA-LAST-MAINT-DT              PIC XX.
  2492         16  MA-LAST-MAINT-BY              PIC XXXX.
  2493         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2494
  2495     12  MA-PROFILE-INFO.
  2496         16  MA-QUALIFY-CODE-1             PIC XX.
  2497         16  MA-QUALIFY-CODE-2             PIC XX.
  2498         16  MA-QUALIFY-CODE-3             PIC XX.
  2499         16  MA-QUALIFY-CODE-4             PIC XX.
  2500         16  MA-QUALIFY-CODE-5             PIC XX.
  2501
  2502         16  MA-INSURED-LAST-NAME          PIC X(15).
  2503         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2504         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2505         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2506         16  MA-INSURED-BIRTH-DT           PIC XX.
  2507         16  MA-INSURED-SEX                PIC X.
  2508             88  MA-SEX-MALE                   VALUE 'M'.
  2509             88  MA-SEX-FEMALE                 VALUE 'F'.
  2510         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2511
  2512         16  MA-ADDRESS-CORRECTED          PIC X.
  2513         16  MA-JOINT-BIRTH-DT             PIC XX.
  2514*        16  FILLER                        PIC X(12).
  2515
  2516         16  MA-ADDRESS-LINE-1             PIC X(30).
  2517         16  MA-ADDRESS-LINE-2             PIC X(30).
  2518         16  MA-CITY-STATE.
  2519             20  MA-CITY                   PIC X(28).
  2520             20  MA-ADDR-STATE             PIC XX.
  2521         16  MA-ZIP.
  2522             20  MA-ZIP-CODE.
  2523                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2524                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2525                 24  FILLER                PIC X(4).
  2526             20  MA-ZIP-PLUS4              PIC X(4).
  2527         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2528             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2529             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2530             20  FILLER                    PIC X(3).
  2531
  2532         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2533
  2534         16  FILLER                        PIC XXX.
  2535*        16  FILLER                        PIC X(10).
  2536
  2537     12  MA-CRED-BENE-INFO.
  2538         16  MA-CRED-BENE-NAME                 PIC X(25).
  2539         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2540         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2541         16  MA-CRED-BENE-CTYST.
  2542             20  MA-CRED-BENE-CITY             PIC X(28).
  2543             20  MA-CRED-BENE-STATE            PIC XX.
  2544         16  MA-CRED-BENE-ZIP.
  2545             20  MA-CB-ZIP-CODE.
  2546                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  48
* EL050.cbl
  2547                     88  MA-CB-CANADIAN-POST-CODE
  2548                                           VALUE 'A' THRU 'Z'.
  2549                 24  FILLER                    PIC X(4).
  2550             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2551         16  MA-CB-CANADIAN-POSTAL-CODE
  2552                            REDEFINES MA-CRED-BENE-ZIP.
  2553             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2554             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2555             20  FILLER                        PIC X(3).
  2556     12  MA-POST-CARD-MAIL-DATA.
  2557         16  MA-MAIL-DATA OCCURS 7.
  2558             20  MA-MAIL-TYPE              PIC X.
  2559                 88  MA-12MO-MAILING           VALUE '1'.
  2560                 88  MA-EXP-MAILING            VALUE '2'.
  2561             20  MA-MAIL-STATUS            PIC X.
  2562                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2563                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2564                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2565             20  MA-MAIL-DATE              PIC XX.
  2566     12  FILLER                            PIC XX.
  2567     12  FILLER                            PIC XX.
  2568*    12  FILLER                            PIC X(30).
  2569******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  49
* EL050.cbl
  2571*    COPY ERCPNDM.
  2572******************************************************************
  2573*                                                                *
  2574*                                                                *
  2575*                            ERCPNDM                             *
  2576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2577*                            VMOD=2.003                          *
  2578*                                                                *
  2579*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2580*                                                                *
  2581*   FILE TYPE = VSAM,KSDS                                        *
  2582*   RECORD SIZE = 374   RECFORM = FIX                            *
  2583*                                                                *
  2584*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2585*   ALTERNATE PATH    = NOT USED                                 *
  2586*                                                                *
  2587*   LOG = YES                                                    *
  2588*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2589******************************************************************
  2590*                   C H A N G E   L O G
  2591*
  2592* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2593*-----------------------------------------------------------------
  2594*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2595* EFFECTIVE    NUMBER
  2596*-----------------------------------------------------------------
  2597* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2598* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2599* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2600******************************************************************
  2601
  2602 01  PENDING-MAILING-DATA.
  2603     12  PM-RECORD-ID                      PIC XX.
  2604         88  VALID-MA-ID                       VALUE 'PM'.
  2605
  2606     12  PM-CONTROL-PRIMARY.
  2607         16  PM-COMPANY-CD                 PIC X.
  2608         16  PM-ENTRY-BATCH                PIC X(6).
  2609         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2610         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2611
  2612     12  FILLER                            PIC X(14).
  2613
  2614     12  PM-ACCESS-CONTROL.
  2615         16  PM-SOURCE-SYSTEM              PIC XX.
  2616             88  PM-FROM-CREDIT                VALUE 'CR'.
  2617             88  PM-FROM-VSI                   VALUE 'VS'.
  2618             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2619             88  PM-FROM-OTHER                 VALUE 'OT'.
  2620         16  PM-RECORD-ADD-DT              PIC XX.
  2621         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2622         16  PM-LAST-MAINT-DT              PIC XX.
  2623         16  PM-LAST-MAINT-BY              PIC XXXX.
  2624         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2625
  2626     12  PM-PROFILE-INFO.
  2627         16  PM-QUALIFY-CODE-1             PIC XX.
  2628         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  50
* EL050.cbl
  2629         16  PM-QUALIFY-CODE-3             PIC XX.
  2630         16  PM-QUALIFY-CODE-4             PIC XX.
  2631         16  PM-QUALIFY-CODE-5             PIC XX.
  2632
  2633         16  PM-INSURED-LAST-NAME          PIC X(15).
  2634         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2635         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2636         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2637         16  PM-INSURED-BIRTH-DT           PIC XX.
  2638         16  PM-INSURED-SEX                PIC X.
  2639             88  PM-SEX-MALE                   VALUE 'M'.
  2640             88  PM-SEX-FEMALE                 VALUE 'F'.
  2641         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2642
  2643         16  PM-ADDRESS-CORRECTED          PIC X.
  2644         16  PM-JOINT-BIRTH-DT             PIC XX.
  2645*        16  FILLER                        PIC X(12).
  2646
  2647         16  PM-ADDRESS-LINE-1             PIC X(30).
  2648         16  PM-ADDRESS-LINE-2             PIC X(30).
  2649         16  PM-CITY-STATE.
  2650             20  PM-CITY                   PIC X(28).
  2651             20  PM-STATE                  PIC XX.
  2652         16  PM-ZIP.
  2653             20  PM-ZIP-CODE.
  2654                 24  PM-ZIP-1              PIC X.
  2655                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2656                 24  FILLER                PIC X(4).
  2657             20  PM-ZIP-PLUS4              PIC X(4).
  2658         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2659             20  PM-CAN-POST1              PIC XXX.
  2660             20  PM-CAN-POST2              PIC XXX.
  2661             20  FILLER                    PIC XXX.
  2662
  2663         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2664
  2665         16  FILLER                        PIC X(03).
  2666
  2667     12  PM-CRED-BENE-INFO.
  2668         16  PM-CRED-BENE-NAME             PIC X(25).
  2669         16  PM-CRED-BENE-ADDR             PIC X(30).
  2670         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2671         16  PM-CRED-BENE-CTYST.
  2672             20  PM-CRED-BENE-CITY         PIC X(28).
  2673             20  PM-CRED-BENE-STATE        PIC XX.
  2674         16  PM-CRED-BENE-ZIP.
  2675             20  PM-CB-ZIP-CODE.
  2676                 24  PM-CB-ZIP-1           PIC X.
  2677                     88  PM-CB-CANADIAN-POST-CODE
  2678                                  VALUE 'A' THRU 'Z'.
  2679                 24  FILLER                PIC X(4).
  2680             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2681         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2682             20  PM-CB-CAN-POST1           PIC XXX.
  2683             20  PM-CB-CAN-POST2           PIC XXX.
  2684             20  FILLER                    PIC XXX.
  2685     12  PM-POST-CARD-MAIL-DATA.
  2686         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  51
* EL050.cbl
  2687             20  PM-MAIL-TYPE              PIC X.
  2688                 88  PM-12MO-MAILING           VALUE '1'.
  2689                 88  PM-EXP-MAILING            VALUE '2'.
  2690             20  PM-MAIL-STATUS            PIC X.
  2691                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2692                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2693                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2694             20  PM-MAIL-DATE              PIC XX.
  2695     12  FILLER                            PIC XX.
  2696     12  FILLER                            PIC X(12).
  2697*    12  FILLER                            PIC X(30).
  2698
  2699******************************************************************
  2700*                                COPY ERCLOFC.
  2701******************************************************************
  2702*                                                                *
  2703*                                                                *
  2704*                            ERCLOFC                             *
  2705*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2706*                            VMOD=2.003                          *
  2707*                                                                *
  2708*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2709*                                                                *
  2710*   FILE TYPE = VSAM,KSDS                                        *
  2711*   RECORD SIZE = 670   RECFORM = FIX                            *
  2712*                                                                *
  2713*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2714*                                                                *
  2715*   LOG = YES                                                    *
  2716*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2717*                                                                *
  2718******************************************************************
  2719
  2720 01  LOAN-OFFICER-MASTER.
  2721     12  LO-RECORD-ID                PIC XX.
  2722         88  VALID-LO-ID                VALUE 'LO'.
  2723
  2724     12  LO-CONTROL-PRIMARY.
  2725         16  LO-COMPANY-CD           PIC X.
  2726         16  LO-CARRIER              PIC X.
  2727         16  LO-GROUPING.
  2728             20  LO-GROUPING-PREFIX  PIC XXX.
  2729             20  LO-GROUPING-PRIME   PIC XXX.
  2730         16  LO-STATE                PIC XX.
  2731         16  LO-ACCOUNT.
  2732             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2733             20  LO-ACCOUNT-PRIME    PIC X(6).
  2734         16  LO-OFFICER-CODE         PIC X(5).
  2735
  2736     12  LO-OFFICER-NAME             PIC X(30).
  2737
  2738     12  LO-LAST-MAINT-DT            PIC XX.
  2739     12  LO-LAST-USER                PIC X(4).
  2740     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2741
  2742     12  LO-COMP-CONTROL             PIC X.
  2743             88  LO-SHOW-COMP           VALUE 'Y'.
  2744             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  52
* EL050.cbl
  2745     12  LO-DETAIL-CONTROL           PIC X.
  2746             88  LO-PRINT-DETAIL        VALUE 'D'.
  2747             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2748
  2749     12  LO-SV-CARRIER               PIC X.
  2750     12  LO-SV-GROUPING              PIC X(6).
  2751     12  LO-SV-STATE                 PIC XX.
  2752
  2753     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2754     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2755
  2756     12  LO-OFFICER-INFO.
  2757         16  FILLER OCCURS 12 TIMES.
  2758             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2759             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2760             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2761             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2762             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2763             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2764             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2765             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2766     12  FILLER                      PIC X(198).
  2767******************************************************************
  2768*                                COPY ERCPDEF.
  2769******************************************************************
  2770*                                                                *
  2771*                                                                *
  2772*                            ERCPDEF.                            *
  2773*                                                                *
  2774*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2775*                                                                *
  2776*    FILE TYPE = VSAM,KSDS                                       *
  2777*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2778*                                                                *
  2779*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2780*                                                                *
  2781*    LOG = YES                                                   *
  2782*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2783******************************************************************
  2784*                   C H A N G E   L O G
  2785*
  2786* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2787*-----------------------------------------------------------------
  2788*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2789* EFFECTIVE    NUMBER
  2790*-----------------------------------------------------------------
  2791* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2792* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2793* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2794******************************************************************
  2795 01  PRODUCT-MASTER.
  2796    12  PD-RECORD-ID                 PIC X(02).
  2797        88  VALID-PD-ID                  VALUE 'PD'.
  2798    12  PD-CONTROL-PRIMARY.
  2799        16  PD-COMPANY-CD            PIC X.
  2800        16  PD-STATE                 PIC XX.
  2801        16  PD-PRODUCT-CD            PIC XXX.
  2802        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  53
* EL050.cbl
  2803        16  PD-BEN-TYPE              PIC X.
  2804        16  PD-BEN-CODE              PIC XX.
  2805        16  PD-PROD-EXP-DT           PIC XX.
  2806    12  FILLER                       PIC X(50).
  2807    12  PD-PRODUCT-DATA OCCURS 8.
  2808        16  PD-PROD-CODE             PIC X.
  2809            88  PD-PROD-LIFE           VALUE 'L'.
  2810            88  PD-PROD-PROP           VALUE 'P'.
  2811            88  PD-PROD-AH             VALUE 'A'.
  2812            88  PD-PROD-IU             VALUE 'I'.
  2813            88  PD-PROD-GAP            VALUE 'G'.
  2814            88  PD-PROD-FAML           VALUE 'F'.
  2815        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2816        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2817        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2818        16  PD-MAX-TERM              PIC S999        COMP-3.
  2819        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2820        16  FILLER                   PIC X.
  2821        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2822        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2823        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2824        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2825        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2826        16  PD-REC-CRIT-PERIOD       PIC 99.
  2827        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2828            20  PD-RECURRING-YN      PIC X.
  2829            20  FILLER               PIC X.
  2830        16  PD-RTW-MOS               PIC 99.
  2831        16  PD-MAX-EXTENSION         PIC 99.
  2832        16  pd-ben-pct               pic sv999 comp-3.
  2833*       16  FILLER                   PIC XX.
  2834    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2835    12  PD-TERM-LIMITS OCCURS 15.
  2836        16  PD-LOW-TERM              PIC S999        COMP-3.
  2837        16  PD-HI-TERM               PIC S999        COMP-3.
  2838*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2839    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2840        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2841        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2842    12  PD-EARN-FACTORS.
  2843        16  FILLER OCCURS 15.
  2844            20  FILLER OCCURS 15.
  2845                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2846    12  PD-PRODUCT-DESC              PIC X(80).
  2847    12  PD-TRUNCATED                 PIC X.
  2848    12  FILLER                       PIC X(59).
  2849    12  PD-MAINT-INFORMATION.
  2850        16  PD-LAST-MAINT-DT         PIC X(02).
  2851        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2852        16  PD-LAST-MAINT-BY         PIC X(04).
  2853*                                COPY ELCSTATE.
  2854******************************************************************
  2855*                                                                *
  2856*                                                                *
  2857*                            ELCSTATE.                           *
  2858*                                                                *
  2859*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2860*                                                                *
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  54
* EL050.cbl
  2861*   FILE TYPE = VSAM,KSDS                                        *
  2862*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2863*                                                                *
  2864*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2865*       ALTERNATE INDEX = NONE                                   *
  2866*                                                                *
  2867*   LOG = YES                                                    *
  2868*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2869******************************************************************
  2870*                   C H A N G E   L O G
  2871*
  2872* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2873*-----------------------------------------------------------------
  2874*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2875* EFFECTIVE    NUMBER
  2876*-----------------------------------------------------------------
  2877* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2878******************************************************************
  2879*
  2880 01  STATE-FILE.
  2881     12  SF-RECORD-ID                       PIC XX.
  2882         88  VALID-CF-ID                        VALUE 'SF'.
  2883     12  SF-CONTROL-PRIMARY.
  2884         16  SF-COMPANY-ID                  PIC XXX.
  2885         16  SF-CARRIER-CODE                PIC X.
  2886         16  SF-GROUPING                    PIC X(6).
  2887         16  SF-STATE-CODE                  PIC XX.
  2888         16  SF-EXPIRE-DATE                 PIC 9(8).
  2889****************************************************************
  2890*             STATE CONTROLS
  2891****************************************************************
  2892     12  SF-LAST-MAINT-DT                   PIC XX.
  2893     12  SF-LAST-MAINT-BY                   PIC X(4).
  2894     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2895     12  SF-STATE-RT-CONTROLS.
  2896         16  SF-ST-RT-CALC                  PIC X.
  2897     12  SF-ST-TAX-CONTROLS.
  2898         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2899         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2900         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2901     12  SF-ST-REFUND-OPTIONS.
  2902         16  SF-ST-RF-LR-CALC               PIC X.
  2903         16  SF-ST-RF-LL-CALC               PIC X.
  2904         16  SF-ST-RF-LN-CALC               PIC X.
  2905         16  SF-ST-RF-AH-CALC               PIC X.
  2906         16  SF-ST-RF-CP-CALC               PIC X.
  2907     12  SF-ST-UNEARN-PREM-OPTIONS.
  2908         16  SF-ST-LUEP-R78                 PIC X.
  2909         16  SF-ST-LUEP-PRO                 PIC X.
  2910         16  SF-ST-LUEP-ST                  PIC X.
  2911         16  SF-ST-LUEP-DOM                 PIC X.
  2912         16  SF-ST-AUEP-R78                 PIC X.
  2913         16  SF-ST-AUEP-PRO                 PIC X.
  2914         16  SF-ST-AUEP-ST                  PIC X.
  2915         16  SF-ST-AUEP-DOM                 PIC X.
  2916         16  SF-ST-CUEP-R78                 PIC X.
  2917         16  SF-ST-CUEP-PRO                 PIC X.
  2918         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  55
* EL050.cbl
  2919         16  SF-ST-CUEP-DOM                 PIC X.
  2920     12  SF-ST-EARN-PREM-OPTIONS.
  2921         16  SF-ST-LEP-R78                  PIC X.
  2922         16  SF-ST-LEP-PRO                  PIC X.
  2923         16  SF-ST-LEP-ST                   PIC X.
  2924         16  SF-ST-LEP-DOM                  PIC X.
  2925         16  SF-ST-AEP-R78                  PIC X.
  2926         16  SF-ST-AEP-PRO                  PIC X.
  2927         16  SF-ST-AEP-ST                   PIC X.
  2928         16  SF-ST-AEP-DOM                  PIC X.
  2929         16  SF-ST-CEP-R78                  PIC X.
  2930         16  SF-ST-CEP-PRO                  PIC X.
  2931         16  SF-ST-CEP-ST                   PIC X.
  2932         16  SF-ST-CEP-DOM                  PIC X.
  2933     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  56
* EL050.cbl
  2935*    COPY ELCCRTT.
  2936******************************************************************
  2937*                                                                *
  2938*                            ELCCRTT.                            *
  2939*                                                                *
  2940*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2941*                                                                *
  2942*   FILE TYPE = VSAM,KSDS                                        *
  2943*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2944*                                                                *
  2945*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2946*                                                                *
  2947*   LOG = YES                                                    *
  2948*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2949******************************************************************
  2950*                   C H A N G E   L O G
  2951*
  2952* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2953*-----------------------------------------------------------------
  2954*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2955* EFFECTIVE    NUMBER
  2956*-----------------------------------------------------------------
  2957* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2958* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2959* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2960* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2961* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2962* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2963* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2964* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2965******************************************************************
  2966
  2967 01  CERTIFICATE-TRAILERS.
  2968     12  CS-RECORD-ID                      PIC XX.
  2969         88  VALID-CS-ID                      VALUE 'CS'.
  2970
  2971     12  CS-CONTROL-PRIMARY.
  2972         16  CS-COMPANY-CD                 PIC X.
  2973         16  CS-CARRIER                    PIC X.
  2974         16  CS-GROUPING                   PIC X(6).
  2975         16  CS-STATE                      PIC XX.
  2976         16  CS-ACCOUNT                    PIC X(10).
  2977         16  CS-CERT-EFF-DT                PIC XX.
  2978         16  CS-CERT-NO.
  2979             20  CS-CERT-PRIME             PIC X(10).
  2980             20  CS-CERT-SFX               PIC X.
  2981         16  CS-TRAILER-TYPE               PIC X.
  2982             88  COMM-TRLR           VALUE 'A'.
  2983             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2984             88  CERT-DATA-TRLR      VALUE 'C'.
  2985
  2986     12  CS-DATA-AREA                      PIC X(516).
  2987
  2988     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2989         16  CS-BANK-COMMISSION-AREA.
  2990             20  CS-BANK-COMMS       OCCURS 10.
  2991                 24  CS-AGT                PIC X(10).
  2992                 24  CS-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  57
* EL050.cbl
  2993                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2994                 24  CS-RECALC-LV-INDIC    PIC X.
  2995                 24  FILLER                PIC X(10).
  2996         16  FILLER                        PIC X(256).
  2997
  2998     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2999****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3000         16  CS-MB-CLAIM-DATA OCCURS 24.
  3001             20  CS-CLAIM-NO               PIC X(7).
  3002             20  CS-CLAIM-TYPE             PIC X.
  3003                 88  CS-AH-CLM               VALUE 'A'.
  3004                 88  CS-IU-CLM               VALUE 'I'.
  3005                 88  CS-GP-CLM               VALUE 'G'.
  3006                 88  CS-LF-CLM               VALUE 'L'.
  3007                 88  CS-PR-CLM               VALUE 'P'.
  3008                 88  CS-FL-CLM               VALUE 'F'.
  3009             20  CS-INSURED-TYPE           PIC X.
  3010                 88  CS-PRIM-INSURED          VALUE 'P'.
  3011                 88  CS-CO-BORROWER           VALUE 'C'.
  3012             20  CS-BENEFIT-PERIOD         PIC 99.
  3013             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3014             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3015             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3016         16  FILLER                        PIC X(12).
  3017     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3018         16  CS-VIN-NUMBER                 PIC X(17).
  3019         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3020         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3021         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3022         16  cs-agent-name.
  3023             20  cs-agent-fname            pic x(20).
  3024             20  cs-agent-mi               pic x.
  3025             20  cs-agent-lname            pic x(25).
  3026         16  cs-license-no                 pic x(15).
  3027         16  cs-npn-number                 pic x(10).
  3028         16  cs-agent-edit-status          pic x.
  3029             88  cs-ae-refer-to-manager      value 'M'.
  3030             88  cs-ae-cover-sheet           value 'C'.
  3031             88  cs-ae-sig-form              value 'S'.
  3032             88  cs-ae-verified              value 'V'.
  3033             88  cs-unidentified-signature   value 'U'.
  3034             88  cs-cert-returned            value 'R'.
  3035             88  cs-accept-no-commission     value 'N'.
  3036         16  FILLER                        PIC X(424).
  3037*        16  FILLER                        PIC X(496).
  3038*    COPY ELCCRTO.
  3039******************************************************************
  3040*                                                                *
  3041*                            ELCCRTO.                            *
  3042*                                                                *
  3043*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3044*                                                                *
  3045*   FILE TYPE = VSAM,KSDS                                        *
  3046*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3047*                                                                *
  3048*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3049*                                                                *
  3050*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  58
* EL050.cbl
  3051*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3052******************************************************************
  3053*                   C H A N G E   L O G
  3054*
  3055* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3056*-----------------------------------------------------------------
  3057*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3058* EFFECTIVE    NUMBER
  3059*-----------------------------------------------------------------
  3060* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3061* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3062* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3063* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3064* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3065******************************************************************
  3066 01  ORIGINAL-CERTIFICATE.
  3067     12  OC-RECORD-ID                      PIC XX.
  3068         88  VALID-OC-ID                      VALUE 'OC'.
  3069     12  OC-CONTROL-PRIMARY.
  3070         16  OC-COMPANY-CD                 PIC X.
  3071         16  OC-CARRIER                    PIC X.
  3072         16  OC-GROUPING                   PIC X(6).
  3073         16  OC-STATE                      PIC XX.
  3074         16  OC-ACCOUNT                    PIC X(10).
  3075         16  OC-CERT-EFF-DT                PIC XX.
  3076         16  OC-CERT-NO.
  3077             20  OC-CERT-PRIME             PIC X(10).
  3078             20  OC-CERT-SFX               PIC X.
  3079         16  OC-RECORD-TYPE                PIC X.
  3080         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3081     12  OC-LAST-MAINT-DT                  PIC XX.
  3082     12  OC-LAST-MAINT-BY                  PIC X(4).
  3083     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3084     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3085     12  FILLER                            PIC X(49).
  3086     12  OC-ORIG-REC.
  3087         16  OC-INS-LAST-NAME              PIC X(15).
  3088         16  OC-INS-FIRST-NAME             PIC X(10).
  3089         16  OC-INS-MIDDLE-INIT            PIC X.
  3090         16  OC-INS-AGE                    PIC S999     COMP-3.
  3091         16  OC-JNT-LAST-NAME              PIC X(15).
  3092         16  OC-JNT-FIRST-NAME             PIC X(10).
  3093         16  OC-JNT-MIDDLE-INIT            PIC X.
  3094         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3095         16  OC-LF-BENCD                   PIC XX.
  3096         16  OC-LF-TERM                    PIC S999      COMP-3.
  3097         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3098         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3099         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3100         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3101         16  OC-LF-EXP-DT                  PIC XX.
  3102         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3103         16  OC-LF-CANCEL-DT               PIC XX.
  3104         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3105         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3106         16  OC-AH-BENCD                   PIC XX.
  3107         16  OC-AH-TERM                    PIC S999      COMP-3.
  3108         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  59
* EL050.cbl
  3109         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3110         16  OC-AH-EXP-DT                  PIC XX.
  3111         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3112         16  OC-AH-CP                      PIC 99.
  3113         16  OC-AH-CANCEL-DT               PIC XX.
  3114         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3115         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3116         16  OC-CRED-BENE-NAME             PIC X(25).
  3117         16  OC-1ST-PMT-DT                 PIC XX.
  3118         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3119         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3120         16  OC-ISSUE-TRAN-IND             PIC X.
  3121         16  OC-CANCEL-TRAN-IND            PIC X.
  3122         16  FILLER                        PIC X(211).
  3123
  3124     12  FILLER                            PIC X(50).
  3125******************************************************************
  3126
  3127*    COPY ELCDATE.
  3128******************************************************************
  3129*                                                                *
  3130*                                                                *
  3131*                            ELCDATE.                            *
  3132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3133*                            VMOD=2.003
  3134*                                                                *
  3135*                                                                *
  3136*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3137*                 LENGTH = 200                                   *
  3138******************************************************************
  3139
  3140 01  DATE-CONVERSION-DATA.
  3141     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3142     12  DC-OPTION-CODE                PIC X.
  3143         88  BIN-TO-GREG                VALUE ' '.
  3144         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3145         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3146         88  YMD-GREG-TO-BIN            VALUE '3'.
  3147         88  MDY-GREG-TO-BIN            VALUE '4'.
  3148         88  JULIAN-TO-BIN              VALUE '5'.
  3149         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3150         88  FIND-CENTURY               VALUE '7'.
  3151         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3152         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3153         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3154         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3155         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3156         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3157         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3158         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3159         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3160         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3161         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3162         88  BIN-3-TO-GREG              VALUE 'I'.
  3163         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3164         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3165         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3166         88  MDCY-GREG-TO-BIN           VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  60
* EL050.cbl
  3167         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3168         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3169         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3170         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3171         88  THREE-CHARACTER-BIN
  3172                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3173         88  GREGORIAN-TO-BIN
  3174                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3175         88  BIN-TO-GREGORIAN
  3176                  VALUES ' ' '1' 'I' '8' 'G'.
  3177         88  JULIAN-TO-BINARY
  3178                  VALUES '5' 'C' 'E' 'F'.
  3179     12  DC-ERROR-CODE                 PIC X.
  3180         88  NO-CONVERSION-ERROR        VALUE ' '.
  3181         88  DATE-CONVERSION-ERROR
  3182                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3183         88  DATE-IS-ZERO               VALUE '1'.
  3184         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3185         88  DATE-IS-INVALID            VALUE '3'.
  3186         88  DATE1-GREATER-DATE2        VALUE '4'.
  3187         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3188         88  DATE-INVALID-OPTION        VALUE '9'.
  3189         88  INVALID-CENTURY            VALUE 'A'.
  3190         88  ONLY-CENTURY               VALUE 'B'.
  3191         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3192         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3193     12  DC-END-OF-MONTH               PIC X.
  3194         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3195     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3196         88  USE-NORMAL-PROCESS         VALUE ' '.
  3197         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3198         88  ADJUST-UP-100-YRS          VALUE '2'.
  3199     12  FILLER                        PIC X.
  3200     12  DC-CONVERSION-DATES.
  3201         16  DC-BIN-DATE-1             PIC XX.
  3202         16  DC-BIN-DATE-2             PIC XX.
  3203         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3204         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3205                       DC-GREG-DATE-1-EDIT.
  3206             20  DC-EDIT1-MONTH        PIC 99.
  3207             20  SLASH1-1              PIC X.
  3208             20  DC-EDIT1-DAY          PIC 99.
  3209             20  SLASH1-2              PIC X.
  3210             20  DC-EDIT1-YEAR         PIC 99.
  3211         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3212         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3213                     DC-GREG-DATE-2-EDIT.
  3214             20  DC-EDIT2-MONTH        PIC 99.
  3215             20  SLASH2-1              PIC X.
  3216             20  DC-EDIT2-DAY          PIC 99.
  3217             20  SLASH2-2              PIC X.
  3218             20  DC-EDIT2-YEAR         PIC 99.
  3219         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3220         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3221                     DC-GREG-DATE-1-YMD.
  3222             20  DC-YMD-YEAR           PIC 99.
  3223             20  DC-YMD-MONTH          PIC 99.
  3224             20  DC-YMD-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  61
* EL050.cbl
  3225         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3226         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3227                      DC-GREG-DATE-1-MDY.
  3228             20  DC-MDY-MONTH          PIC 99.
  3229             20  DC-MDY-DAY            PIC 99.
  3230             20  DC-MDY-YEAR           PIC 99.
  3231         16  DC-GREG-DATE-1-ALPHA.
  3232             20  DC-ALPHA-MONTH        PIC X(10).
  3233             20  DC-ALPHA-DAY          PIC 99.
  3234             20  FILLER                PIC XX.
  3235             20  DC-ALPHA-CENTURY.
  3236                 24 DC-ALPHA-CEN-N     PIC 99.
  3237             20  DC-ALPHA-YEAR         PIC 99.
  3238         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3239         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3240         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3241         16  DC-JULIAN-DATE            PIC 9(05).
  3242         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3243                                       PIC 9(05).
  3244         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3245             20  DC-JULIAN-YEAR        PIC 99.
  3246             20  DC-JULIAN-DAYS        PIC 999.
  3247         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3248         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3249         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3250     12  DATE-CONVERSION-VARIBLES.
  3251         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3252         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3253             20  FILLER                PIC 9(3).
  3254             20  HOLD-CEN-1-CCYY.
  3255                 24  HOLD-CEN-1-CC     PIC 99.
  3256                 24  HOLD-CEN-1-YY     PIC 99.
  3257             20  HOLD-CEN-1-MO         PIC 99.
  3258             20  HOLD-CEN-1-DA         PIC 99.
  3259         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3260             20  HOLD-CEN-1-R-MO       PIC 99.
  3261             20  HOLD-CEN-1-R-DA       PIC 99.
  3262             20  HOLD-CEN-1-R-CCYY.
  3263                 24  HOLD-CEN-1-R-CC   PIC 99.
  3264                 24  HOLD-CEN-1-R-YY   PIC 99.
  3265             20  FILLER                PIC 9(3).
  3266         16  HOLD-CENTURY-1-X.
  3267             20  FILLER                PIC X(3)  VALUE SPACES.
  3268             20  HOLD-CEN-1-X-CCYY.
  3269                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3270                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3271             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3272             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3273         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3274             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3275             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3276             20  HOLD-CEN-1-R-X-CCYY.
  3277                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3278                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3279             20  FILLER                PIC XXX.
  3280         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3281         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3282         16  DC-JULIAN-DATE-1          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  62
* EL050.cbl
  3283         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3284             20  DC-JULIAN-1-CCYY.
  3285                 24  DC-JULIAN-1-CC    PIC 99.
  3286                 24  DC-JULIAN-1-YR    PIC 99.
  3287             20  DC-JULIAN-DA-1        PIC 999.
  3288         16  DC-JULIAN-DATE-2          PIC 9(07).
  3289         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3290             20  DC-JULIAN-2-CCYY.
  3291                 24  DC-JULIAN-2-CC    PIC 99.
  3292                 24  DC-JULIAN-2-YR    PIC 99.
  3293             20  DC-JULIAN-DA-2        PIC 999.
  3294         16  DC-GREG-DATE-A-EDIT.
  3295             20  DC-EDITA-MONTH        PIC 99.
  3296             20  SLASHA-1              PIC X VALUE '/'.
  3297             20  DC-EDITA-DAY          PIC 99.
  3298             20  SLASHA-2              PIC X VALUE '/'.
  3299             20  DC-EDITA-CCYY.
  3300                 24  DC-EDITA-CENT     PIC 99.
  3301                 24  DC-EDITA-YEAR     PIC 99.
  3302         16  DC-GREG-DATE-B-EDIT.
  3303             20  DC-EDITB-MONTH        PIC 99.
  3304             20  SLASHB-1              PIC X VALUE '/'.
  3305             20  DC-EDITB-DAY          PIC 99.
  3306             20  SLASHB-2              PIC X VALUE '/'.
  3307             20  DC-EDITB-CCYY.
  3308                 24  DC-EDITB-CENT     PIC 99.
  3309                 24  DC-EDITB-YEAR     PIC 99.
  3310         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3311         16  DC-GREG-DATE-CYMD-R REDEFINES
  3312                              DC-GREG-DATE-CYMD.
  3313             20  DC-CYMD-CEN           PIC 99.
  3314             20  DC-CYMD-YEAR          PIC 99.
  3315             20  DC-CYMD-MONTH         PIC 99.
  3316             20  DC-CYMD-DAY           PIC 99.
  3317         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3318         16  DC-GREG-DATE-MDCY-R REDEFINES
  3319                              DC-GREG-DATE-MDCY.
  3320             20  DC-MDCY-MONTH         PIC 99.
  3321             20  DC-MDCY-DAY           PIC 99.
  3322             20  DC-MDCY-CEN           PIC 99.
  3323             20  DC-MDCY-YEAR          PIC 99.
  3324    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3325        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3326    12  DC-EL310-DATE                  PIC X(21).
  3327    12  FILLER                         PIC X(28).
  3328
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  63
* EL050.cbl
  3330*    COPY ELCCALC.
  3331******************************************************************
  3332*                                                                *
  3333*                           ELCCALC.                            *
  3334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3335*                            VMOD=2.025                          *
  3336*                                                                *
  3337*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3338*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3339*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3340*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3341*                                                                *
  3342*  PASSED TO ELRTRM                                              *
  3343*  -----------------                                             *
  3344*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3345*  ORIGINAL TERM                                                 *
  3346*  BEGINNING DATE                                                *
  3347*  ENDING DATE                                                   *
  3348*  COMPANY I.D.                                                  *
  3349*  ACCOUNT MASTER USER FIELD                                     *
  3350*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3351*  FREE LOOK DAYS                                                *
  3352*                                                                *
  3353*  RETURNED FROM ELRTRM                                          *
  3354*  ---------------------                                         *
  3355*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3356*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3357*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3358*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3359*----------------------------------------------------------------*
  3360*  PASSED TO ELRAMT                                              *
  3361*  ----------------                                              *
  3362*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3363*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3364*  ORIGINAL AMOUNT                                               *
  3365*  ALTERNATE BENEFIT (BALLON)                                    *
  3366*  A.P.R. - NET PAY ONLY                                         *
  3367*  METHOD
  3368*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3369*  COMPANY I.D.                                                  *
  3370*  BENEFIT TYPE                                                  *
  3371*                                                                *
  3372*  RETURNED FROM ELRAMT                                          *
  3373*  --------------------                                          *
  3374*  REMAINING AMOUNT 1 - CURRENT                                  *
  3375*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3376*  REMAINING AMOUNT FACTOR
  3377*----------------------------------------------------------------*
  3378*  PASSED TO ELRESV                                              *
  3379*  -----------------                                             *
  3380*  CERTIFICATE EFFECTIVE DATE                                    *
  3381*  VALUATION DATE                                                *
  3382*  PAID THRU DATE                                                *
  3383*  BENEFIT                                                       *
  3384*  INCURRED DATE                                                 *
  3385*  REPORTED DATE                                                 *
  3386*  ISSUE AGE                                                     *
  3387*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  64
* EL050.cbl
  3388*  CDT PERCENT                                                   *
  3389*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3390* *CLAIM TYPE (LIFE, A/H)                                        *
  3391* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3392* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3393*                                                                *
  3394*  RETURNED FROM ELRESV                                          *
  3395*  --------------------                                          *
  3396*  CDT TABLE USED                                                *
  3397*  CDT FACTOR USED                                               *
  3398*  PAY TO CURRENT RESERVE                                        *
  3399*  I.B.N.R. - A/H ONLY                                           *
  3400*  FUTURE (ACCRUED) AH ONLY                                      *
  3401*----------------------------------------------------------------*
  3402*  PASSED TO ELRATE                                              *
  3403*  ----------------                                              *
  3404*  CERT ISSUE DATE                                               *
  3405*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3406*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3407*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3408*  STATE CODE (CLIENT DEFINED)                                   *
  3409*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3410*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3411*  DEVIATION CODE                                                *
  3412*  ISSUE AGE                                                     *
  3413*  ORIGINAL BENEFIT AMOUNT                                       *
  3414*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3415*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3416*  BENEFIT KIND (LIFE OR A/H)                                    *
  3417*  A.P.R.                                                        *
  3418*  METHOD
  3419*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3420*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3421*  COMPANY I.D. (3 CHARACTER)                                    *
  3422*  BENEFIT CODE                                                  *
  3423*  BENEFIT OVERRIDE CODE                                         *
  3424*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3425*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3426*  JOINT INDICATOR (CSL ONLY)                                    *
  3427*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3428*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3429*                                                                *
  3430*  RETURNED FROM ELRATE                                          *
  3431*  --------------------                                          *
  3432*  CALCULATED PREMIUM                                            *
  3433*  PREMIUM RATE                                                  *
  3434*  MORTALITY CODE                                                *
  3435*  MAX ATTAINED AGE                                              *
  3436*  MAX AGE                                                       *
  3437*  MAX TERM                                                      *
  3438*  MAX MONTHLY BENEFIT                                           *
  3439*  MAX TOTAL BENIFIT                                             *
  3440*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3441*----------------------------------------------------------------*
  3442*  PASSED TO ELRFND                                              *
  3443*  ----------------                                              *
  3444*  CERT ISSUE DATE                                               *
  3445*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  65
* EL050.cbl
  3446*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3447*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3448*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3449*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3450*  STATE CODE (CLIENT DEFINED)                                   *
  3451*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3452*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3453*  DEVIATION CODE                                                *
  3454*  ISSUE AGE                                                     *
  3455*  ORIGINAL BENEFIT AMOUNT                                       *
  3456*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3457*  PROCESS TYPE (CANCEL)                                         *
  3458*  BENEFIT KIND (LIFE OR A/H)                                    *
  3459*  A.P.R.                                                        *
  3460*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3461*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3462*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3463*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3464*  COMPANY I.D. (3 CHARACTER)                                    *
  3465*  BENEFIT CODE                                                  *
  3466*  BENEFIT OVERRIDE CODE                                         *
  3467*                                                                *
  3468*  RETURNED FROM ELRFND                                          *
  3469*  --------------------                                          *
  3470*  CALCULATED REFUND                                             *
  3471*----------------------------------------------------------------*
  3472*  PASSED TO ELEARN                                              *
  3473*  ----------------                                              *
  3474*  CERT ISSUE DATE                                               *
  3475*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3476*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3477*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3478*  STATE CODE (CLIENT DEFINED)                                   *
  3479*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3480*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3481*  DEVIATION CODE                                                *
  3482*  ISSUE AGE                                                     *
  3483*  ORIGINAL BENEFIT AMOUNT                                       *
  3484*  BENEFIT KIND (LIFE OR A/H)                                    *
  3485*  A.P.R.                                                        *
  3486*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3487*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3488*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3489*  COMPANY I.D. (3 CHARACTER)                                    *
  3490*  BENEFIT CODE                                                  *
  3491*  BENEFIT OVERRIDE CODE                                         *
  3492*                                                                *
  3493*  RETURNED FROM ELEARN                                          *
  3494*  --------------------                                          *
  3495*  INDICATED  EARNINGS                                           *
  3496*----------------------------------------------------------------*
  3497*                 LENGTH = 450                                   *
  3498*                                                                *
  3499******************************************************************
  3500******************************************************************
  3501*                   C H A N G E   L O G
  3502*
  3503* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  66
* EL050.cbl
  3504*-----------------------------------------------------------------
  3505*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3506* EFFECTIVE    NUMBER
  3507*-----------------------------------------------------------------
  3508* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3509* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3510* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3511* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3512* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3513* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3514* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3515* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3516* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3517* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3518******************************************************************
  3519
  3520 01  CALCULATION-PASS-AREA.
  3521     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3522                                     COMP.
  3523
  3524     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3525       88  NO-CP-ERROR                             VALUE ZERO.
  3526       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3527                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3528       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3529       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3530       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3531       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3532       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3533       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3534       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3535       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3536       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3537       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3538       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3539       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3540       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3541       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3542       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3543       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3544       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3545
  3546     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3547       88  NO-CP-ERROR-2                           VALUE ZERO.
  3548***********************  INPUT AREAS ****************************
  3549
  3550     12  CP-CALCULATION-AREA.
  3551         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3552         16  CP-CERT-EFF-DT        PIC XX.
  3553         16  CP-VALUATION-DT       PIC XX.
  3554         16  CP-PAID-THRU-DT       PIC XX.
  3555         16  CP-BENEFIT-TYPE       PIC X.
  3556           88  CP-AH                               VALUE 'A' 'D'
  3557                                                   'I' 'U'.
  3558           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3559           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3560         16  CP-INCURRED-DT        PIC XX.
  3561         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  67
* EL050.cbl
  3562         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3563         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3564         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3565                                     COMP-3.
  3566         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CDT-METHOD         PIC X.
  3569           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3570           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3571           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3572         16  CP-CLAIM-TYPE         PIC X.
  3573           88  CP-AH-CLAIM                         VALUE 'A'.
  3574           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3575         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3576                                     COMP-3.
  3577         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3578                                     COMP-3.
  3579         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3580                                     COMP-3.
  3581         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3586                                     COMP-3.
  3587         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-REM-TERM-METHOD    PIC X.
  3590           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3591           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3592           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3593           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3594           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3595           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3596           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3597         16  CP-EARNING-METHOD     PIC X.
  3598           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3599           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3600           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3601           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3602           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3603           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3604           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3605           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3606           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3607           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3608           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3609           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3610           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3611           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3612         16  CP-PROCESS-TYPE       PIC X.
  3613           88  CP-CLAIM                            VALUE '1'.
  3614           88  CP-CANCEL                           VALUE '2'.
  3615           88  CP-ISSUE                            VALUE '3'.
  3616         16  CP-SPECIAL-CALC-CD    PIC X.
  3617           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3618           88  CP-1-MTH-INTEREST               VALUE ' '.
  3619           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  68
* EL050.cbl
  3620           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3621           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3622           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3623           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3624           88  CP-FARM-PLAN                    VALUE 'F'.
  3625           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3626           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3627           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3628           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3629           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3630           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3631           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3632           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3633           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3634           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3635                                                     'W' 'X'.
  3636           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3637           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3638           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3639           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3640           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3641           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3642           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3643           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3644           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3645           88  CP-CSL-METH-1                   VALUE '5'.
  3646           88  CP-CSL-METH-2                   VALUE '6'.
  3647           88  CP-CSL-METH-3                   VALUE '7'.
  3648           88  CP-CSL-METH-4                   VALUE '8'.
  3649
  3650         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3651                                     COMP-3.
  3652         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3653         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3654         16  CP-STATE              PIC XX          VALUE SPACE.
  3655         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3656         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3657           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3658               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3659         16  CP-R78-OPTION         PIC X.
  3660           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3661           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3662
  3663         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3664         16  CP-IBNR-RESERVE-SW    PIC X.
  3665         16  CP-CLAIM-STATUS       PIC X.
  3666         16  CP-RATE-FILE          PIC X.
  3667         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3668                                     COMP-3.
  3669
  3670         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3671         16  CP-AH-OVERRIDE-CODE   PIC X.
  3672
  3673         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3676                                   PIC S9(5)V99 COMP-3.
  3677         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  69
* EL050.cbl
  3678                                     COMP-3.
  3679         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3680                                     COMP-3.
  3681         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3682                                     COMP-3.
  3683         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3684                                  PIC S9(7)V99 COMP-3.
  3685
  3686         16  CP-PAID-FROM-DATE     PIC X(02).
  3687         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3688         16  CP-EXT-DAYS-CALC      PIC X.
  3689           88  CP-EXT-NO-CHG                   VALUE ' '.
  3690           88  CP-EXT-CHG-LF                   VALUE '1'.
  3691           88  CP-EXT-CHG-AH                   VALUE '2'.
  3692           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3693         16  CP-DOMICILE-STATE     PIC XX.
  3694         16  CP-CARRIER            PIC X.
  3695         16  CP-REIN-FLAG          PIC X.
  3696         16  CP-REM-TRM-CALC-OPTION PIC X.
  3697           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3698                      '2' '3' '4' '5'.
  3699           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3700           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3701           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3702           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3703           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3704           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3705           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3706           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3707         16  CP-SIG-SWITCH         PIC X.
  3708         16  CP-RATING-METHOD      PIC X.
  3709           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3710           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3711           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3712           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3713           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3714           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3715           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3716           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3717           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3718         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3719                                     COMP-3.
  3720         16  CP-BEN-CATEGORY       PIC X.
  3721         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3722         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3723                                   PIC S99V9(5) COMP-3.
  3724         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3725         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3726                                   PIC S99V9(5) COMP-3.
  3727         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3728         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3729         16  CP-EXPIRE-DT          PIC XX.
  3730         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3731         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3732         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3733         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3734         16  CP-DDF-SPEC-CALC      PIC X.
  3735             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  70
* EL050.cbl
  3736             88  CP-CALC-CLP              VALUE 'C'.
  3737         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3738         16  CP-CANCEL-REASON      PIC X.
  3739         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3740         16  CP-PMT-MODE           PIC X.
  3741         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3742         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3743         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3744         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3745         16  FILLER                PIC X.
  3746
  3747***************    OUTPUT FROM ELRESV   ************************
  3748
  3749         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3750
  3751         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3752                                     COMP-3.
  3753         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3754                                     COMP-3.
  3755         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3758                                     COMP-3.
  3759         16  FILLER                PIC X(09).
  3760***************    OUTPUT FROM ELRTRM   *************************
  3761
  3762         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3769                                     COMP-3.
  3770         16  FILLER                PIC X(12).
  3771
  3772***************    OUTPUT FROM ELRAMT   *************************
  3773
  3774         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3775                                     COMP-3.
  3776         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  FILLER                PIC X(12).
  3779
  3780***************    OUTPUT FROM ELRATE   *************************
  3781
  3782         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3785                                     COMP-3.
  3786         16  CP-MORTALITY-CODE     PIC X(4).
  3787         16  CP-RATE-EDIT-FLAG     PIC X.
  3788             88  CP-RATES-NEED-APR                  VALUE '1'.
  3789         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3792         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3793         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  71
* EL050.cbl
  3794                                   PIC S9(7)V99 COMP-3.
  3795         16  FILLER                PIC X(07).
  3796
  3797***************    OUTPUT FROM ELRFND   *************************
  3798
  3799         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-REFUND-TYPE-USED   PIC X.
  3802           88  CP-R-AS-R78                         VALUE '1'.
  3803           88  CP-R-AS-PRORATA                     VALUE '2'.
  3804           88  CP-R-AS-CALIF                       VALUE '3'.
  3805           88  CP-R-AS-TEXAS                       VALUE '4'.
  3806           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3807           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3808           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3809           88  CP-R-AS-MEAN                        VALUE '8'.
  3810           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3811           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3812           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3813           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3814           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3815           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3816         16  FILLER                PIC X(12).
  3817
  3818***************    OUTPUT FROM ELEARN   *************************
  3819
  3820         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-EARNING-TYPE-USED  PIC X.
  3833           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3834           88  CP-E-AS-R78                         VALUE '1'.
  3835           88  CP-E-AS-PRORATA                     VALUE '2'.
  3836           88  CP-E-AS-TEXAS                       VALUE '4'.
  3837           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3838           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3839           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3840           88  CP-E-AS-MEAN                        VALUE '8'.
  3841           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3842         16  FILLER                PIC X(12).
  3843
  3844***************    OUTPUT FROM ELPMNT   *************************
  3845
  3846         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3847                                     COMP-3.
  3848         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3849                                     COMP-3.
  3850         16  FILLER                PIC X(12).
  3851
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  72
* EL050.cbl
  3852***************   MISC WORK AREAS    *****************************
  3853         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3854                                     COMP-3.
  3855         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3858                                     COMP-3.
  3859         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3860                                     COMP-3.
  3861         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3862                                     COMP-3.
  3863         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3866             88  OPEN-RATE-FILE                   VALUE 'O'.
  3867             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3868             88  IO-ERROR                         VALUE 'E'.
  3869
  3870         16  CP-FIRST-PAY-DATE     PIC XX.
  3871
  3872         16  CP-JOINT-INDICATOR    PIC X.
  3873
  3874         16  CP-RESERVE-REMAINING-TERM
  3875                                   PIC S9(4)V9    VALUE ZERO
  3876                                     COMP-3.
  3877
  3878         16  CP-INSURED-BIRTH-DT   PIC XX.
  3879
  3880         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3881                                     COMP-3.
  3882
  3883         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3884                                     COMP-3.
  3885
  3886         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3887                                     COMP-3.
  3888
  3889         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3890                                     COMP-3.
  3891
  3892         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3893                                     COMP-3.
  3894
  3895         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3896                                     COMP-3.
  3897
  3898         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3899                                     COMP-3.
  3900
  3901         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3902             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3903
  3904         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3905                                     COMP-3.
  3906         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3909         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  73
* EL050.cbl
  3910         16  cp-net-only-state     pic x value spaces.
  3911         16  FILLER                PIC X(13).
  3912******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  74
* EL050.cbl
  3914******************************************************************
  3915*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3916*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3917*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3918*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3919*** MODIFICATION.                                              ***
  3920*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3921*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3922******************************************************************
  3923*    COPY ERCPNDB.
  3924******************************************************************
  3925*                                                                *
  3926*                                                                *
  3927*                            ERCPNDB.                            *
  3928*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3929*                            VMOD=2.025                          *
  3930*                                                                *
  3931*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3932*                                                                *
  3933******************************************************************
  3934*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3935*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3936******************************************************************
  3937*                                                                *
  3938*                                                                *
  3939*   FILE TYPE = VSAM,KSDS                                        *
  3940*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3941*                                                                *
  3942*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3943*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3944*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3945*                                                 RKP=13,LEN=36  *
  3946*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3947*                                      AND CHG-SEQ.)             *
  3948*                                                RKP=49,LEN=11   *
  3949*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3950*                                      AND CHG-SEQ.)             *
  3951*                                                RKP=60,LEN=15   *
  3952*                                                                *
  3953*   LOG = NO                                                     *
  3954*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3955******************************************************************
  3956******************************************************************
  3957*                   C H A N G E   L O G
  3958*
  3959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3960*-----------------------------------------------------------------
  3961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3962* EFFECTIVE    NUMBER
  3963*-----------------------------------------------------------------
  3964* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3965* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3966* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3967* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3968* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3969* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3970* 032306                   PEMA  ADD BOW LOAN NUMBER
  3971* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  75
* EL050.cbl
  3972* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3973* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3974* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3975* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3976* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3977* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3978* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3979* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3980******************************************************************
  3981
  3982 01  PENDING-BUSINESS.
  3983     12  PB-RECORD-ID                     PIC XX.
  3984         88  VALID-PB-ID                        VALUE 'PB'.
  3985
  3986     12  PB-CONTROL-PRIMARY.
  3987         16  PB-COMPANY-CD                PIC X.
  3988         16  PB-ENTRY-BATCH               PIC X(6).
  3989         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3990         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3991
  3992     12  PB-CONTROL-BY-ACCOUNT.
  3993         16  PB-COMPANY-CD-A1             PIC X.
  3994         16  PB-CARRIER                   PIC X.
  3995         16  PB-GROUPING.
  3996             20  PB-GROUPING-PREFIX       PIC XXX.
  3997             20  PB-GROUPING-PRIME        PIC XXX.
  3998         16  PB-STATE                     PIC XX.
  3999         16  PB-ACCOUNT.
  4000             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4001             20  PB-ACCOUNT-PRIME         PIC X(6).
  4002         16  PB-CERT-EFF-DT               PIC XX.
  4003         16  PB-CERT-NO.
  4004             20  PB-CERT-PRIME            PIC X(10).
  4005             20  PB-CERT-SFX              PIC X.
  4006         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4007
  4008         16  PB-RECORD-TYPE               PIC X.
  4009             88  PB-MAILING-DATA                VALUE '0'.
  4010             88  PB-ISSUE                       VALUE '1'.
  4011             88  PB-CANCELLATION                VALUE '2'.
  4012             88  PB-BATCH-TRAILER               VALUE '9'.
  4013
  4014     12  PB-CONTROL-BY-ORIG-BATCH.
  4015         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4016         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4017         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4018         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4019
  4020     12  PB-CONTROL-BY-CSR.
  4021         16  PB-CSR-COMPANY-CD            PIC X.
  4022         16  PB-CSR-ID                    PIC X(4).
  4023         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4024         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4025         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4026******************************************************************
  4027*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4028******************************************************************
  4029
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  76
* EL050.cbl
  4030     12  PB-LAST-MAINT-DT                 PIC XX.
  4031     12  PB-LAST-MAINT-BY                 PIC X(4).
  4032     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4033
  4034     12  PB-RECORD-BODY                   PIC X(375).
  4035
  4036     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4037         16  PB-CERT-ORIGIN               PIC X.
  4038             88  CLASIC-CREATED-CERT         VALUE '1'.
  4039         16  PB-I-NAME.
  4040             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4041             20  PB-I-INSURED-FIRST-NAME.
  4042                 24  PB-I-INSURED-1ST-INIT PIC X.
  4043                 24  FILLER                PIC X(9).
  4044             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4045         16  PB-I-AGE                     PIC S99   COMP-3.
  4046         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4047         16  PB-I-BIRTHDAY                PIC XX.
  4048         16  PB-I-INSURED-SEX             PIC X.
  4049             88  PB-SEX-MALE     VALUE 'M'.
  4050             88  PB-SEX-FEMALE   VALUE 'F'.
  4051
  4052         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4053         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4054         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4055         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4056         16  PB-I-SKIP-CODE               PIC X.
  4057             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4058             88  PB-SKIP-JULY              VALUE '1'.
  4059             88  PB-SKIP-AUGUST            VALUE '2'.
  4060             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4061             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4062             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4063             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4064             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4065             88  PB-SKIP-JUNE              VALUE '8'.
  4066             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4067             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4068             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4069         16  PB-I-TERM-TYPE               PIC X.
  4070             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4071             88  PB-PAID-WEEKLY            VALUE 'W'.
  4072             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4073             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4074             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4075         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4076         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4077         16  PB-I-DATA-ENTRY-SW           PIC X.
  4078             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4079             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4080             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4081             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4082         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4083         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4084*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4085         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4086         16  FILLER                       PIC X.
  4087
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  77
* EL050.cbl
  4088         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4089             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4090             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4091                                                   '90' THRU '99'.
  4092         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4093                                          PIC XX.
  4094         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4095         16  PB-I-AMOUNT-FINANCED REDEFINES
  4096                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4097         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4098         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4099                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4100         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4101         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4102         16  PB-I-CLP-AMOUNT REDEFINES
  4103                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4104         16  PB-I-LF-CALC-FLAG            PIC X.
  4105             88 PB-COMP-LF-PREM               VALUE '?'.
  4106         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4107         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4108         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4109         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4110         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4111         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4112         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4113         16  PB-I-LF-ABBR                 PIC XXX.
  4114         16  PB-I-LF-INPUT-CD             PIC XX.
  4115
  4116         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4117             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4118             88  PB-INVALID-AH               VALUE '  ' '00'
  4119                                                   '90' THRU '99'.
  4120         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4121         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4122         16  PB-I-AH-CALC-FLAG            PIC X.
  4123             88 PB-COMP-AH-PREM                  VALUE '?'.
  4124         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4125         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4126         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4127         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4128         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4129         16  PB-I-AH-ABBR                 PIC XXX.
  4130         16  PB-I-AH-INPUT-CD             PIC XXX.
  4131
  4132         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4133         16  PB-I-REIN-TABLE              PIC XXX.
  4134         16  PB-I-BUSINESS-TYPE           PIC 99.
  4135         16  PB-I-INDV-GRP-CD             PIC X.
  4136         16  PB-I-MORT-CODE.
  4137             20  PB-I-TABLE               PIC X.
  4138             20  PB-I-INTEREST            PIC XX.
  4139             20  PB-I-MORT-TYP            PIC X.
  4140         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4141         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4142         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4143         16  PB-I-INDV-GRP-OVRD           PIC X.
  4144         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4145         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  78
* EL050.cbl
  4146             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4147         16  PB-I-RATE-CLASS              PIC XX.
  4148         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4149         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4150         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4151         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4152         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4153         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4154         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4155         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4156         16  PB-I-OB-FLAG                 PIC X.
  4157             88  PB-I-OB                      VALUE 'B'.
  4158             88  PB-I-SUMMARY                 VALUE 'Z'.
  4159         16  PB-I-ENTRY-STATUS            PIC X.
  4160             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4161                                              'M' '5' '9' '2'.
  4162             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4163             88  PB-I-POLICY-PENDING          VALUE '2'.
  4164             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4165             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4166             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4167             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4168             88  PB-I-REIN-ONLY               VALUE '9'.
  4169             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4170             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4171             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4172             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4173         16  PB-I-INT-CODE                PIC X.
  4174             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4175             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4176         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4177         16  PB-I-SOC-SEC-NO              PIC X(11).
  4178         16  PB-I-MEMBER-NO               PIC X(12).
  4179         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4180*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4181         16  PB-I-OLD-LOF                 PIC XXX.
  4182         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4183         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4184         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4185         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4186         16  PB-I-LIFE-INDICATOR          PIC X.
  4187             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4188         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4189         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4190                                          PIC S9(5)V99    COMP-3.
  4191         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4192             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4193             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4194         16  PB-I-1ST-PMT-DT              PIC XX.
  4195         16  PB-I-JOINT-INSURED.
  4196             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4197             20 PB-I-JOINT-FIRST-NAME.
  4198                24  PB-I-JOINT-FIRST-INIT PIC X.
  4199                24  FILLER                PIC X(9).
  4200             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4201*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4202         16  PB-I-BENEFICIARY-NAME.
  4203             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  79
* EL050.cbl
  4204             20  FILLER                   PIC X(15).
  4205         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4206         16  PB-I-REFERENCE               PIC X(12).
  4207         16  FILLER REDEFINES PB-I-REFERENCE.
  4208             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4209             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4210             20  PB-I-CLP-STATE           PIC XX.
  4211         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4212             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4213             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4214             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4215         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4216         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4217         16  PB-I-RESIDENT-STATE          PIC XX.
  4218         16  PB-I-RATE-CODE               PIC X(4).
  4219         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4220         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4221         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4222         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4223         16  PB-I-BANK-NOCHRGB            PIC 99.
  4224         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4225         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4226
  4227     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4228         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4229             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4230         16  PB-C-CANCEL-ORIGIN           PIC X.
  4231             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4232         16  PB-C-LF-CANCEL-DT            PIC XX.
  4233         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4234         16  PB-C-LF-CALC-REQ             PIC X.
  4235             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4236         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4237         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4238         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4239             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4240         16  PB-C-AH-CANCEL-DT            PIC XX.
  4241         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4242         16  PB-C-AH-CALC-REQ             PIC X.
  4243             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4244         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4245         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4246         16  PB-C-LAST-NAME               PIC X(15).
  4247         16  PB-C-REFUND-SW               PIC X.
  4248             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4249             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4250         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4251         16  PB-C-PAYEE-CODE              PIC X(6).
  4252         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4253         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4254         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4255         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4256         16  PB-C-REFERENCE               PIC X(12).
  4257         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4258         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4259         16  PB-C-POST-CARD-IND           PIC X.
  4260         16  PB-C-CANCEL-REASON           PIC X.
  4261         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  80
* EL050.cbl
  4262         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4263         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4264         16  FILLER                       PIC X(01).
  4265*        16  FILLER                       PIC X(18).
  4266         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4267*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4268         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4269         16  PB-CANCELED-CERT-DATA.
  4270             20  PB-CI-INSURED-NAME.
  4271                 24  PB-CI-LAST-NAME      PIC X(15).
  4272                 24  PB-CI-INITIALS       PIC XX.
  4273             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4274             20  PB-CI-INSURED-SEX        PIC X.
  4275             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4276             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4277             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4278             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4279             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4280             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4281             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4282             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4283             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4284             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4285             20  PB-CI-RATE-CLASS         PIC XX.
  4286             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4287             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4288             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4289             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4290             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4291             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4292             20  PB-CI-LF-ABBR            PIC X(3).
  4293             20  PB-CI-AH-ABBR            PIC X(3).
  4294             20  PB-CI-OB-FLAG            PIC X.
  4295                 88  PB-CI-OB                VALUE 'B'.
  4296             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4297                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4298                                           'M' '4' '5' '9' '2'.
  4299                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4300                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4301                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4302                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4303                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4304                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4305                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4306                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4307                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4308                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4309                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4310                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4311                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4312             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4313                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4314                                           'M' '4' '5' '9' '2'.
  4315                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4316                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4317                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4318                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4319                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  81
* EL050.cbl
  4320                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4321                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4322                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4323                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4324                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4325                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4326                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4327                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4328             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4329             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4330             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4331             20  PB-CI-MEMBER-NO          PIC X(12).
  4332             20  PB-CI-INT-CODE           PIC X.
  4333                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4334                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4335             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4336             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4337             20  PB-CI-COMP-EXCP-SW       PIC X.
  4338                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4339                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4340             20  PB-CI-ENTRY-STATUS       PIC X.
  4341             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4342             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4343             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4344             20  PB-CI-DEATH-DT           PIC XX.
  4345             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4346             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4347             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4348             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4349             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4350             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4351             20  PB-CI-ENTRY-DT              PIC XX.
  4352             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4353             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4354             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4355             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4356             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4357             20  PB-CI-OLD-LOF               PIC XXX.
  4358*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4359             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4360             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4361             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4362             20  PB-CI-INDV-GRP-CD           PIC X.
  4363             20  PB-CI-BENEFICIARY-NAME.
  4364                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4365                 24  FILLER                  PIC X(15).
  4366             20  PB-CI-NOTE-SW               PIC X.
  4367             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4368             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4369             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4370             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4371             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4372             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4373             20  PB-CI-FIRST-NAME            PIC X(10).
  4374             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4375
  4376         16  FILLER                       PIC X(13).
  4377*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  82
* EL050.cbl
  4378*        16  FILLER                       PIC X(46).
  4379
  4380     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4381         16  FILLER                       PIC X(10).
  4382         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4383         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4384         16  PB-M-INSURED-MID-INIT        PIC X.
  4385         16  PB-M-INSURED-AGE             PIC 99.
  4386         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4387         16  PB-M-INSURED-SEX             PIC X.
  4388         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4389         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4390         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4391         16  PB-M-INSURED-CITY-STATE.
  4392             20  PB-M-INSURED-CITY        PIC X(28).
  4393             20  PB-M-INSURED-STATE       PIC XX.
  4394         16  PB-M-INSURED-ZIP-CODE.
  4395             20  PB-M-INSURED-ZIP-PRIME.
  4396                 24  PB-M-INSURED-ZIP-1   PIC X.
  4397                     88  PB-M-CANADIAN-POST-CODE
  4398                                             VALUE 'A' THRU 'Z'.
  4399                 24  FILLER               PIC X(4).
  4400             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4401         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4402                                        PB-M-INSURED-ZIP-CODE.
  4403             20  PM-M-INS-CAN-POST1       PIC XXX.
  4404             20  PM-M-INS-CAN-POST2       PIC XXX.
  4405             20  FILLER                   PIC XXX.
  4406         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4407         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4408         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4409         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4410         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4411         16  PB-M-CRED-BENE-CITYST.
  4412             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4413             20  PB-M-CRED-BENE-STATE     PIC XX.
  4414         16  FILLER                       PIC X(92).
  4415
  4416     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4417         16  FILLER                       PIC X(10).
  4418         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4419         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4420         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4421         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4422         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4423         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4424         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4425         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4426         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4427         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4428         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4429         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4430         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4431         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4432         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4433         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4434         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4435         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  83
* EL050.cbl
  4436         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4437         16  PB-REFERENCE                 PIC X(12).
  4438         16  PB-B-RECEIVED-DT             PIC XX.
  4439         16  FILLER                       PIC X(234).
  4440
  4441     12  PB-RECORD-STATUS.
  4442         16  PB-CREDIT-SELECT-DT          PIC XX.
  4443         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4444         16  PB-BILLED-DT                 PIC XX.
  4445         16  PB-BILLING-STATUS            PIC X.
  4446             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4447             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4448             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4449         16  PB-RECORD-BILL               PIC X.
  4450             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4451             88  PB-RECORD-RETURNED           VALUE 'R'.
  4452             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4453             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4454             88  PB-OVERRIDE-AH               VALUE 'A'.
  4455             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4456         16  PB-BATCH-ENTRY               PIC X.
  4457             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4458             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4459             88  PB-REISSUED-CERT             VALUE 'E'.
  4460             88  PB-CASH-CERT                 VALUE 'C'.
  4461             88  PB-MONTHLY-CERT              VALUE 'M'.
  4462             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4463             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4464             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4465         16  PB-FORCE-CODE                PIC X.
  4466             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4467             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4468             88  PB-CANCEL-FORCE              VALUE '8'.
  4469             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4470             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4471             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4472             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4473             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4474             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4475             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4476         16  PB-FATAL-FLAG                PIC X.
  4477             88  PB-FATAL-ERRORS              VALUE 'X'.
  4478         16  PB-FORCE-ER-CD               PIC X.
  4479             88  PB-FORCE-ERRORS              VALUE 'F'.
  4480             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4481         16  PB-WARN-ER-CD                PIC X.
  4482             88  PB-WARNING-ERRORS            VALUE 'W'.
  4483         16  FILLER                       PIC X.
  4484         16  PB-OUT-BAL-CD                PIC X.
  4485             88  PB-OUT-OF-BAL                VALUE 'O'.
  4486         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4487         16  PB-AH-OVERRIDE-L1            PIC X.
  4488         16  PB-INPUT-DT                  PIC XX.
  4489         16  PB-INPUT-BY                  PIC X(4).
  4490         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4491         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4492         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4493         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  84
* EL050.cbl
  4494         16  PB-AH-EARNING-METHOD         PIC X.
  4495         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4496         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4497         16  PB-REIN-CD                   PIC XXX.
  4498         16  PB-LF-REFUND-TYPE            PIC X.
  4499         16  PB-AH-REFUND-TYPE            PIC X.
  4500         16  PB-ACCT-EFF-DT               PIC XX.
  4501         16  PB-ACCT-EXP-DT               PIC XX.
  4502         16  PB-COMPANY-ID                PIC X(3).
  4503         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4504         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4505         16  PB-SV-CARRIER                PIC X.
  4506         16  PB-SV-GROUPING               PIC X(6).
  4507         16  PB-SV-STATE                  PIC XX.
  4508         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4509         16  PB-GA-BILLING-INFO.
  4510             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4511                                          PIC XX.
  4512         16  PB-SV-REMIT-TO  REDEFINES
  4513             PB-GA-BILLING-INFO           PIC X(10).
  4514         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4515         16  PB-I-LOAN-OFFICER            PIC X(5).
  4516         16  PB-I-VIN                     PIC X(17).
  4517
  4518         16  FILLER                       PIC X(04).
  4519         16  IMNET-BYPASS-SW              PIC X.
  4520
  4521******************************************************************
  4522*                COMMON EDIT ERRORS                              *
  4523******************************************************************
  4524
  4525     12  PB-COMMON-ERRORS.
  4526         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4527                                           PIC S9(4)     COMP.
  4528
  4529******************************************************************
  4530
  4531* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4532*    COPY ELC50W1.
  4533******************************************************************
  4534*                                                                *
  4535*                                                                *
  4536*                             ELC50W1                            *
  4537*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4538*                            VMOD=2.004                          *
  4539*                                                                *
  4540*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4541*                                                                *
  4542*                                                                *
  4543******************************************************************
  4544
  4545     12  WK-WORK-AREA.
  4546         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4547         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4548         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4549         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4550         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4551         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  85
* EL050.cbl
  4552         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4553         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4554         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4555         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4556         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4557         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4558         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4559         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4560         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4561         16  WK-CREDIT-EDIT-CONTROLS.
  4562             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4563             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4564             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4565             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4566             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4567             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4568         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4569         16  WK-SAVE-REIN-DATA.
  4570             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4571             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4572             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4573         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4574             88  ENTRY-FROM-EL6311       VALUE '6'.
  4575         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4576         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4577     12  WK-RECORD-ADDRESSES.
  4578         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4579         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4580         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4581         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4582         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4583         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4584         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4585         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4586     12  WK-OVER-SHORT-AREA.
  4587         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4588         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4589         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4590             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4591         16  FILLER                   PIC X(5) VALUE SPACES.
  4592
  4593*    COPY ELCEDITC.
  4594******************************************************************
  4595*                                                                *
  4596*                                                                *
  4597*                            ELCEDITC                            *
  4598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4599*                            VMOD=2.012                          *
  4600*                                                                *
  4601*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4602*                     EL6313, EL050 AND EL517.                   *
  4603*                                                                *
  4604******************************************************************
  4605******************************************************************
  4606*                   C H A N G E   L O G
  4607*
  4608* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4609*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  86
* EL050.cbl
  4610*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4611* EFFECTIVE    NUMBER
  4612*-----------------------------------------------------------------
  4613* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4614******************************************************************
  4615
  4616     12  EDIT-CRITERIA-DATA.
  4617         16  EC-CO-MONTH-END-DT       PIC XX.
  4618         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4619         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4620         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4621         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4622         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4623         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4624         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4625         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4626         16  EC-CO-REM-TERM-CALC      PIC X.
  4627               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4628               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4629               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4630               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4631
  4632         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4633               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4634               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4635               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4636               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4637               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4638               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4639               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4640               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4641               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4642               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4643
  4644         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4645               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4646               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4647               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4648               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4649               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4650               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4651               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4652               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4653
  4654         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4655                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4656                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4657
  4658         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4659                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4660                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4661                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4662                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4663                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4664                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4665                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4666                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4667
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  87
* EL050.cbl
  4668         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4669               88  EC-BR-REDUCING                   VALUE 'R'.
  4670               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4671
  4672         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4673         16  EC-BR-LF-DESC             PIC X(10).
  4674         16  EC-BR-AH-DESC             PIC X(10).
  4675         16  EC-BR-LF-COMMENT          PIC X(10).
  4676         16  EC-BR-AH-COMMENT          PIC X(10).
  4677
  4678         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4679               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4680               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4681               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4682               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4683
  4684         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4685               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4686               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4687               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4688               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4689
  4690         16  EC-BR-LF-REFUND-CALC      PIC X.
  4691                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4692                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4693                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4694                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4695                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4696                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4697                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4698
  4699         16  EC-BR-AH-REFUND-CALC      PIC X.
  4700                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4701                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4702                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4703                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4704                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4705                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4706                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4707                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4708
  4709         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4710                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4711                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4712                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4713
  4714         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4715                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4716                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4717                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4718
  4719         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4720         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4721         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4722         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4723
  4724         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4725         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  88
* EL050.cbl
  4726                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4727                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4728                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4729                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4730
  4731         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4732               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4733               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4734               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4735               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4736               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4737
  4738         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4739               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4740               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4741               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4742               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4743               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4744
  4745         16  EC-ST-LF-REFUND-CALC      PIC X.
  4746                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4747                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4748                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4749                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4750                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4751                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4752                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4753                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4754
  4755         16  EC-ST-AH-REFUND-CALC      PIC X.
  4756                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4757                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4758                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4759                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4760                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4761                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4762                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4763                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4764
  4765         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4766         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4767         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4768         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4769         16  EC-AM-EXPIRATION-DT       PIC XX.
  4770         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4771         16  EC-AM-CLASS-CD            PIC XX.
  4772         16  EC-AM-LF-DEVIATION        PIC XXX.
  4773         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4774         16  EC-AM-AH-DEVIATION        PIC XXX.
  4775         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4776         16  EC-AM-PHONE-NO            PIC X(10).
  4777
  4778         16  EC-AM-LF-REFUND-CALC      PIC X.
  4779                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4780                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4781                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4782                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4783                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  89
* EL050.cbl
  4784                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4785                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4786
  4787         16  EC-AM-AH-REFUND-CALC      PIC X.
  4788                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4789                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4790                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4791                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4792                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4793                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4794                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4795
  4796         16  EC-AM-BEN-I-G-CD          PIC X.
  4797                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4798                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4799                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4800
  4801         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4802         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4803         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4804         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4805         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4806         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4807         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4808         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4809         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4810
  4811         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4812         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4813         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4814         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4815         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4816         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4817         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4818         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4819         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4820         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4821         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4822         16  EC-RT-LF-NSP-ST           PIC XX.
  4823         16  EC-RT-AH-NSP-ST           PIC XX.
  4824         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4825         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4826
  4827         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4828             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4829                                             'M' '5' '9' '2'.
  4830             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4831             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4832             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4833             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4834             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4835             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4836             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4837             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4838             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4839             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4840
  4841         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  90
* EL050.cbl
  4842             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4843                                             'M' '5' '9' '2'.
  4844             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4845             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4846             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4847             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4848             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4849             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4850             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4851             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4852             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4853             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4854
  4855         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4856         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4857         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4858         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4859         16  EC-CM-DEATH-DT            PIC XX.
  4860
  4861*DMD CUSTOM CODING FIELDS BELOW
  4862*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4863         16  EC-BR-DMD-RATING-SW       PIC X.
  4864                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4865                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4866                 88  NO-DMD-RATING               VALUE 'N'.
  4867
  4868         16  EC-NEW-CERT               PIC X(11).
  4869         16  EC-NEW-STATE              PIC XX.
  4870         16  FILLER                    PIC X.
  4871*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4872         16  OVER-SHORT-EDIT-FIELDS.
  4873             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4874             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4875             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4876             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4877             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4878             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4879             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4880             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4881             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4882         16  FILLER                    PIC X(71).
  4883******************************************************************
  4884
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  91
* EL050.cbl
  4886*    COPY ELCDIFRD.
  4887******************************************************************
  4888*                                                                *
  4889*                                                                *
  4890*                            ELCDIFRD.                           *
  4891*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4892*                            VMOD=2.004                          *
  4893*                                                                *
  4894*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4895*                                                                *
  4896******************************************************************
  4897*
  4898  01  WS-DIFFERENCE-CALCULATION.
  4899        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4900        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4901        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4902        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4903        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4904        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4905        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4906        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4907        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4908        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4909        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4910
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  92
* EL050.cbl
  4912****************************************************************
  4913*
  4914* Copyright (c) 2007 by Clerity Solutions, Inc.
  4915* All rights reserved.
  4916*
  4917****************************************************************
  4918 01  DFHEIV.
  4919   02  DFHEIV0               PIC X(35).
  4920   02  DFHEIV1               PIC X(08).
  4921   02  DFHEIV2               PIC X(08).
  4922   02  DFHEIV3               PIC X(08).
  4923   02  DFHEIV4               PIC X(06).
  4924   02  DFHEIV5               PIC X(04).
  4925   02  DFHEIV6               PIC X(04).
  4926   02  DFHEIV7               PIC X(02).
  4927   02  DFHEIV8               PIC X(02).
  4928   02  DFHEIV9               PIC X(01).
  4929   02  DFHEIV10              PIC S9(7) COMP-3.
  4930   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4931   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4932   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4933   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4934   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4935   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4936   02  DFHEIV17              PIC X(04).
  4937   02  DFHEIV18              PIC X(04).
  4938   02  DFHEIV19              PIC X(04).
  4939   02  DFHEIV20              USAGE IS POINTER.
  4940   02  DFHEIV21              USAGE IS POINTER.
  4941   02  DFHEIV22              USAGE IS POINTER.
  4942   02  DFHEIV23              USAGE IS POINTER.
  4943   02  DFHEIV24              USAGE IS POINTER.
  4944   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4945   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4946   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4947   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4948   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4949   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4950   02  FILLER                PIC X(02).
  4951   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4952   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4953   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4954   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4955   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4956 LINKAGE  SECTION.
  4957*****************************************************************
  4958*                                                               *
  4959* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4960* All rights reserved.                                          *
  4961*                                                               *
  4962*****************************************************************
  4963 01  dfheiblk.
  4964     02  eibtime          pic s9(7) comp-3.
  4965     02  eibdate          pic s9(7) comp-3.
  4966     02  eibtrnid         pic x(4).
  4967     02  eibtaskn         pic s9(7) comp-3.
  4968     02  eibtrmid         pic x(4).
  4969     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  93
* EL050.cbl
  4970     02  eibcposn         pic s9(4) comp.
  4971     02  eibcalen         pic s9(4) comp.
  4972     02  eibaid           pic x(1).
  4973     02  eibfiller1       pic x(1).
  4974     02  eibfn            pic x(2).
  4975     02  eibfiller2       pic x(2).
  4976     02  eibrcode         pic x(6).
  4977     02  eibfiller3       pic x(2).
  4978     02  eibds            pic x(8).
  4979     02  eibreqid         pic x(8).
  4980     02  eibrsrce         pic x(8).
  4981     02  eibsync          pic x(1).
  4982     02  eibfree          pic x(1).
  4983     02  eibrecv          pic x(1).
  4984     02  eibsend          pic x(1).
  4985     02  eibatt           pic x(1).
  4986     02  eibeoc           pic x(1).
  4987     02  eibfmh           pic x(1).
  4988     02  eibcompl         pic x(1).
  4989     02  eibsig           pic x(1).
  4990     02  eibconf          pic x(1).
  4991     02  eiberr           pic x(1).
  4992     02  eibrldbk         pic x(1).
  4993     02  eiberrcd         pic x(4).
  4994     02  eibsynrb         pic x(1).
  4995     02  eibnodat         pic x(1).
  4996     02  eibfiller5       pic x(2).
  4997     02  eibresp          pic 9(09) comp.
  4998     02  eibresp2         pic 9(09) comp.
  4999     02  dfheigdj         pic s9(4) comp.
  5000     02  dfheigdk         pic s9(4) comp.
  5001
  5002 01  DFHCOMMAREA                   PIC X(1036).
  5003
  5004*01 PARMLIST .
  5005*    02  FILLER                    PIC S9(8)   COMP.
  5006*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5007*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5008*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5009*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5010*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5011*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5012*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5013
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  94
* EL050.cbl
  5015*    COPY ELCCNTL.
  5016******************************************************************
  5017*                                                                *
  5018*                                                                *
  5019*                            ELCCNTL.                            *
  5020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5021*                            VMOD=2.059                          *
  5022*                                                                *
  5023*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5024*                                                                *
  5025*   FILE TYPE = VSAM,KSDS                                        *
  5026*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5027*                                                                *
  5028*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5029*       ALTERNATE INDEX = NONE                                   *
  5030*                                                                *
  5031*   LOG = YES                                                    *
  5032*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5033******************************************************************
  5034*                   C H A N G E   L O G
  5035*
  5036* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5037*-----------------------------------------------------------------
  5038*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5039* EFFECTIVE    NUMBER
  5040*-----------------------------------------------------------------
  5041* 082503                   PEMA  ADD BENEFIT GROUP
  5042* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5043* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5044* 092705    2005050300006  PEMA  ADD SPP LEASES
  5045* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5046* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5047* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5048* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5049* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5050* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5051* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5052* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5053* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5054* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5055******************************************************************
  5056*
  5057 01  CONTROL-FILE.
  5058     12  CF-RECORD-ID                       PIC XX.
  5059         88  VALID-CF-ID                        VALUE 'CF'.
  5060
  5061     12  CF-CONTROL-PRIMARY.
  5062         16  CF-COMPANY-ID                  PIC XXX.
  5063         16  CF-RECORD-TYPE                 PIC X.
  5064             88  CF-COMPANY-MASTER              VALUE '1'.
  5065             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5066             88  CF-STATE-MASTER                VALUE '3'.
  5067             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5068             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5069             88  CF-CARRIER-MASTER              VALUE '6'.
  5070             88  CF-MORTALITY-MASTER            VALUE '7'.
  5071             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5072             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  95
* EL050.cbl
  5073             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5074             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5075             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5076             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5077             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5078             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5079             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5080             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5081             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5082         16  CF-ACCESS-CD-GENL              PIC X(4).
  5083         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5084             20  CF-PROCESSOR               PIC X(4).
  5085         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5086             20  CF-STATE-CODE              PIC XX.
  5087             20  FILLER                     PIC XX.
  5088         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5089             20  FILLER                     PIC XX.
  5090             20  CF-HI-BEN-IN-REC           PIC XX.
  5091         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5092             20  FILLER                     PIC XXX.
  5093             20  CF-CARRIER-CNTL            PIC X.
  5094         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5095             20  FILLER                     PIC XX.
  5096             20  CF-HI-TYPE-IN-REC          PIC 99.
  5097         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5098             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5099                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5100             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5101             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5102         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5103             20  FILLER                     PIC X.
  5104             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5105         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5106             20  FILLER                     PIC XX.
  5107             20  CF-MORTGAGE-PLAN           PIC XX.
  5108         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5109
  5110     12  CF-LAST-MAINT-DT                   PIC XX.
  5111     12  CF-LAST-MAINT-BY                   PIC X(4).
  5112     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5113
  5114     12  CF-RECORD-BODY                     PIC X(728).
  5115
  5116
  5117****************************************************************
  5118*             COMPANY MASTER RECORD                            *
  5119****************************************************************
  5120
  5121     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5122         16  CF-COMPANY-ADDRESS.
  5123             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5124             20  CF-CL-IN-CARE-OF           PIC X(30).
  5125             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5126             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5127             20  CF-CL-CITY-STATE           PIC X(30).
  5128             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5129             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5130         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  96
* EL050.cbl
  5131         16  CF-COMPANY-PASSWORD            PIC X(8).
  5132         16  CF-SECURITY-OPTION             PIC X.
  5133             88  ALL-SECURITY                   VALUE '1'.
  5134             88  COMPANY-VERIFY                 VALUE '2'.
  5135             88  PROCESSOR-VERIFY               VALUE '3'.
  5136             88  NO-SECURITY                    VALUE '4'.
  5137             88  ALL-BUT-TERM                   VALUE '5'.
  5138         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5139             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5140         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5141             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5142         16  CF-INFORCE-LOCATION            PIC X.
  5143             88  CERTS-ARE-ONLINE               VALUE '1'.
  5144             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5145             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5146         16  CF-LOWER-CASE-LETTERS          PIC X.
  5147         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5148             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5149             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5150             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5151             88  CF-ACCNT-CNTL                  VALUE '3'.
  5152             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5153
  5154         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5155         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5156
  5157         16  CF-LGX-CREDIT-USER             PIC X.
  5158             88  CO-IS-NOT-USER                 VALUE 'N'.
  5159             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5160
  5161         16 CF-CREDIT-CALC-CODES.
  5162             20  CF-CR-REM-TERM-CALC PIC X.
  5163               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5164               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5165               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5166               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5167               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5168               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5169               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5170             20  CF-CR-R78-METHOD           PIC X.
  5171               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5172               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5173
  5174         16  CF-CLAIM-CONTROL-COUNTS.
  5175             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5176                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5177
  5178             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5179                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5180
  5181             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5182                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5183
  5184             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5185                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5186
  5187         16  CF-CURRENT-MONTH-END           PIC XX.
  5188
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  97
* EL050.cbl
  5189         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5190             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5191             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5192             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5193             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5194                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5195                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5196             20  CF-CO-PREM-REJECT-SW       PIC X.
  5197                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5198                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5199             20  CF-CO-REF-REJECT-SW        PIC X.
  5200                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5201                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5202
  5203         16  CF-CO-REPORTING-DT             PIC XX.
  5204         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5205         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5206           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5207           88  CF-CO-MONTH-END                  VALUE '1'.
  5208
  5209         16  CF-LGX-CLAIM-USER              PIC X.
  5210             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5211             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5212
  5213         16  CF-CREDIT-EDIT-CONTROLS.
  5214             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5215             20  CF-MIN-AGE                 PIC 99.
  5216             20  CF-DEFAULT-AGE             PIC 99.
  5217             20  CF-MIN-TERM                PIC S999      COMP-3.
  5218             20  CF-MAX-TERM                PIC S999      COMP-3.
  5219             20  CF-DEFAULT-SEX             PIC X.
  5220             20  CF-JOINT-AGE-INPUT         PIC X.
  5221                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5222             20  CF-BIRTH-DATE-INPUT        PIC X.
  5223                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5224             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5225                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5226                 88  CF-ZERO-CARRIER            VALUE '1'.
  5227                 88  CF-ZERO-GROUPING           VALUE '2'.
  5228                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5229             20  CF-EDIT-SW                 PIC X.
  5230                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5231             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5232             20  CF-CR-PR-METHOD            PIC X.
  5233               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5234               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5235             20  FILLER                     PIC X.
  5236
  5237         16  CF-CREDIT-MISC-CONTROLS.
  5238             20  CF-REIN-TABLE-SW           PIC X.
  5239                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5240             20  CF-COMP-TABLE-SW           PIC X.
  5241                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5242             20  CF-EXPERIENCE-RETENTION-AGE
  5243                                            PIC S9        COMP-3.
  5244             20  CF-CONVERSION-DT           PIC XX.
  5245             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5246             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  98
* EL050.cbl
  5247                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5248                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5249
  5250             20  CF-CR-CHECK-NO-CONTROL.
  5251                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5252                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5253                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5254                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5255                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5256                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5257
  5258                 24  CF-CR-CHECK-COUNT       REDEFINES
  5259                     CF-CR-CHECK-COUNTER      PIC X(4).
  5260
  5261                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5262                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5263
  5264                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5265                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5266                 24  CF-MAIL-PROCESSING       PIC X.
  5267                     88  MAIL-PROCESSING          VALUE 'Y'.
  5268
  5269         16  CF-MISC-SYSTEM-CONTROL.
  5270             20  CF-SYSTEM-C                 PIC X.
  5271                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5272             20  CF-SYSTEM-D                 PIC X.
  5273                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5274             20  CF-SOC-SEC-NO-SW            PIC X.
  5275                 88  SOC-SEC-NO-USED             VALUE '1'.
  5276             20  CF-MEMBER-NO-SW             PIC X.
  5277                 88  MEMBER-NO-USED              VALUE '1'.
  5278             20  CF-TAX-ID-NUMBER            PIC X(11).
  5279             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5280             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5281                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5282                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5283                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5284                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5285             20  CF-SYSTEM-E                 PIC X.
  5286                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5287
  5288         16  CF-LGX-LIFE-USER               PIC X.
  5289             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5290             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5291
  5292         16  CF-CR-MONTH-END-DT             PIC XX.
  5293
  5294         16  CF-FILE-MAINT-DATES.
  5295             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5296                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5297             20  CF-LAST-BATCH       REDEFINES
  5298                 CF-LAST-BATCH-NO               PIC X(4).
  5299             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5300             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5301             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5302             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5303             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5304             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page  99
* EL050.cbl
  5305             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5306             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5307             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5308             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5309
  5310         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5311         16  FILLER                         PIC X.
  5312
  5313         16  CF-ALT-MORT-CODE               PIC X(4).
  5314         16  CF-MEMBER-CAPTION              PIC X(10).
  5315
  5316         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5317             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5318             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5319             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5320             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5321             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5322
  5323         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5324
  5325         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5326         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5327         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5328         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5329
  5330         16  CF-AH-OVERRIDE-L1              PIC X.
  5331         16  CF-AH-OVERRIDE-L2              PIC XX.
  5332         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5333         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5334
  5335         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5336         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5337
  5338         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5339         16  CF-AR-LAST-EL860-DT            PIC XX.
  5340         16  CF-MP-MONTH-END-DT             PIC XX.
  5341
  5342         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5343         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5344             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5345
  5346         16  CF-AR-MONTH-END-DT             PIC XX.
  5347
  5348         16  CF-CRDTCRD-USER                PIC X.
  5349             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5350             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5351
  5352         16  CF-CC-MONTH-END-DT             PIC XX.
  5353
  5354         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5355
  5356         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5357             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5358             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5359             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5360         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5361         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5362         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 100
* EL050.cbl
  5363         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5364             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5365             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5366         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5367         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5368         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5369             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5370         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5371
  5372         16  CF-CL-ZIP-CODE.
  5373             20  CF-CL-ZIP-PRIME.
  5374                 24  CF-CL-ZIP-1ST          PIC X.
  5375                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5376                 24  FILLER                 PIC X(4).
  5377             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5378         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5379             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5380             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5381             20  FILLER                     PIC XXX.
  5382
  5383         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5384         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5385         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5386         16  CF-CO-OPTION-START-DATE        PIC XX.
  5387         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5388           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5389                                                      '3' '4'.
  5390           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5391           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5392           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5393           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5394           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5395           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5396
  5397         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5398
  5399         16  CF-PAYMENT-APPROVAL-LEVELS.
  5400             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5401             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5402             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5403             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5404             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5405             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5406
  5407         16  CF-END-USER-REPORTING-USER     PIC X.
  5408             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5409             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5410
  5411         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5412             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5413             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5414
  5415         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5416
  5417         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5418         16  FILLER                         PIC X.
  5419
  5420         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 101
* EL050.cbl
  5421             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5422             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5423             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5424
  5425         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5426
  5427         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5428             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5429             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5430
  5431         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5432             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5433             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5434
  5435         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5436
  5437         16  CF-CO-ACH-ID-CODE              PIC  X.
  5438             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5439             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5440             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5441         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5442         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5443         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5444         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5445         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5446         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5447         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5448         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5449         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5450                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5451         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5452                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5453
  5454         16  CF-CO-OVER-SHORT.
  5455             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5456             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5457
  5458*         16  FILLER                         PIC X(102).
  5459         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5460             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5461             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5462
  5463         16  CF-AH-APPROVAL-DAYS.
  5464             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5465             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5466             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5467             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5468
  5469         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5470
  5471         16  CF-APPROV-LEV-5.
  5472             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5473             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5474             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5475
  5476         16  FILLER                         PIC X(68).
  5477****************************************************************
  5478*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 102
* EL050.cbl
  5479****************************************************************
  5480
  5481     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5482         16  CF-PROCESSOR-NAME              PIC X(30).
  5483         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5484         16  CF-PROCESSOR-TITLE             PIC X(26).
  5485         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5486                 88  MESSAGE-YES                VALUE 'Y'.
  5487                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5488
  5489*****************************************************
  5490****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5491****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5492****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5493****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5494*****************************************************
  5495
  5496         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5497             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5498             20  CF-APPLICATION-FORCE       PIC X.
  5499             20  CF-INDIVIDUAL-APP.
  5500                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5501                     28  CF-BROWSE-APP      PIC X.
  5502                     28  CF-UPDATE-APP      PIC X.
  5503
  5504         16  CF-CURRENT-TERM-ON             PIC X(4).
  5505         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5506             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5507             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5508             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5509             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5510             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5511             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5512             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5513         16  CF-PROCESSOR-CARRIER           PIC X.
  5514             88  NO-CARRIER-SECURITY            VALUE ' '.
  5515         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5516             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5517         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5518             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5519         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5520             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5521
  5522         16  CF-PROC-SYS-ACCESS-SW.
  5523             20  CF-PROC-CREDIT-CLAIMS-SW.
  5524                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5525                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5526                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5527                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5528             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5529                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5530                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5531             20  CF-PROC-LIFE-GNRLDGR-SW.
  5532                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5533                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5534                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5535                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5536             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 103
* EL050.cbl
  5537                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5538                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5539         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5540             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5541             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5542         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5543
  5544         16  CF-APPROVAL-LEVEL                  PIC X.
  5545             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5546             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5547             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5548             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5549             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5550
  5551         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5552
  5553         16  CF-LANGUAGE-TYPE                   PIC X.
  5554             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5555             88  CF-LANG-IS-FR                      VALUE 'F'.
  5556
  5557         16  CF-CSR-IND                         PIC X.
  5558         16  FILLER                             PIC X(239).
  5559
  5560****************************************************************
  5561*             PROCESSOR/REMINDERS RECORD                       *
  5562****************************************************************
  5563
  5564     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5565         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5566             20  CF-START-REMIND-DT         PIC XX.
  5567             20  CF-END-REMIND-DT           PIC XX.
  5568             20  CF-REMINDER-TEXT           PIC X(50).
  5569         16  FILLER                         PIC X(296).
  5570
  5571
  5572****************************************************************
  5573*             STATE MASTER RECORD                              *
  5574****************************************************************
  5575
  5576     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5577         16  CF-STATE-ABBREVIATION          PIC XX.
  5578         16  CF-STATE-NAME                  PIC X(25).
  5579         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5580         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5581             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5582             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5583             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5584             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5585                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5586                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5587             20  CF-ST-PREM-REJECT-SW       PIC X.
  5588                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5589                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5590             20  CF-ST-REF-REJECT-SW        PIC X.
  5591                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5592                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5593         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5594         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 104
* EL050.cbl
  5595         16  CF-ST-REFUND-RULES.
  5596             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5597             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5598             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5599         16  CF-ST-FST-PMT-EXTENSION.
  5600             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5601             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5602                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5603                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5604                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5605                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5606         16  CF-ST-STATE-CALL.
  5607             20  CF-ST-CALL-UNEARNED        PIC X.
  5608             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5609             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5610         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5611             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5612             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5613         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5614         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5615         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5616         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5617         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5618         16  FILLER                         PIC X.
  5619         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5620             20  CF-ST-BENEFIT-CD           PIC XX.
  5621             20  CF-ST-BENEFIT-KIND         PIC X.
  5622                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5623                 88  CF-ST-AH-KIND              VALUE 'A'.
  5624             20  CF-ST-REM-TERM-CALC        PIC X.
  5625                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5626                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5627                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5628                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5629                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5630                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5631                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5632                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5633
  5634             20  CF-ST-REFUND-CALC          PIC X.
  5635                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5636                 88  ST-REFD-BY-R78             VALUE '1'.
  5637                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5638                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5639                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5640                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5641                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5642                 88  ST-REFD-UTAH               VALUE '7'.
  5643                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5644                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5645                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5646
  5647             20  CF-ST-EARNING-CALC         PIC X.
  5648                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5649                 88  ST-EARN-BY-R78             VALUE '1'.
  5650                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5651                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5652                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 105
* EL050.cbl
  5653                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5654                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5655                 88  ST-EARN-MEAN               VALUE '8'.
  5656                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5657
  5658             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5659                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5660                 88  ST-OVRD-BY-R78             VALUE '1'.
  5661                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5662                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5663                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5664                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5665                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5666                 88  ST-OVRD-MEAN               VALUE '8'.
  5667                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5668             20  cf-st-extra-periods        pic 9.
  5669*            20  FILLER                     PIC X.
  5670
  5671         16  CF-ST-COMMISSION-CAPS.
  5672             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5673             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5674             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5675             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5676         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5677                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5678
  5679         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5680
  5681         16  CF-ST-STATUTORY-INTEREST.
  5682             20  CF-ST-STAT-DATE-FROM       PIC X.
  5683                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5684                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5685             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5686             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5687             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5688             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5689             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5690
  5691         16  CF-ST-OVER-SHORT.
  5692             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5693             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5694
  5695         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5696
  5697         16  CF-ST-RT-CALC                  PIC X.
  5698
  5699         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5700         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5701         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5702         16  CF-ST-RF-LR-CALC               PIC X.
  5703         16  CF-ST-RF-LL-CALC               PIC X.
  5704         16  CF-ST-RF-LN-CALC               PIC X.
  5705         16  CF-ST-RF-AH-CALC               PIC X.
  5706         16  CF-ST-RF-CP-CALC               PIC X.
  5707*        16  FILLER                         PIC X(206).
  5708*CIDMOD         16  FILLER                         PIC X(192).
  5709         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5710             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 106
* EL050.cbl
  5711         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5712         16  CF-ST-VFY-2ND-BENE             PIC X.
  5713         16  CF-ST-CAUSAL-STATE             PIC X.
  5714         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5715         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5716         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5717             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5718         16  CF-ST-NET-ONLY-STATE           PIC X.
  5719             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5720         16  FILLER                         PIC X(181).
  5721
  5722****************************************************************
  5723*             BENEFIT MASTER RECORD                            *
  5724****************************************************************
  5725
  5726     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5727         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5728             20  CF-BENEFIT-CODE            PIC XX.
  5729             20  CF-BENEFIT-NUMERIC  REDEFINES
  5730                 CF-BENEFIT-CODE            PIC XX.
  5731             20  CF-BENEFIT-ALPHA           PIC XXX.
  5732             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5733             20  CF-BENEFIT-COMMENT         PIC X(10).
  5734
  5735             20  CF-LF-COVERAGE-TYPE        PIC X.
  5736                 88  CF-REDUCING                VALUE 'R'.
  5737                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5738
  5739             20  CF-SPECIAL-CALC-CD         PIC X.
  5740                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5741                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5742                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5743                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5744                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5745                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5746                 88  CF-FARM-PLAN               VALUE 'F'.
  5747                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5748                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5749                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5750                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5751                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5752                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5753                 88  CF-PRUDENTIAL              VALUE 'P'.
  5754                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5755                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5756                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5757                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5758                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5759                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5760
  5761             20  CF-JOINT-INDICATOR         PIC X.
  5762                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5763
  5764*            20  FILLER                     PIC X(12).
  5765             20  cf-maximum-benefits        pic s999 comp-3.
  5766             20  FILLER                     PIC X(09).
  5767             20  CF-BENEFIT-CATEGORY        PIC X.
  5768             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 107
* EL050.cbl
  5769
  5770             20  CF-CO-REM-TERM-CALC        PIC X.
  5771                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5772                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5773                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5774                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5775                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5776
  5777             20  CF-CO-EARNINGS-CALC        PIC X.
  5778                 88  CO-EARN-BY-R78             VALUE '1'.
  5779                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5780                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5781                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5782                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5783                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5784                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5785                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5786
  5787             20  CF-CO-REFUND-CALC          PIC X.
  5788                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5789                 88  CO-REFD-BY-R78             VALUE '1'.
  5790                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5791                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5792                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5793                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5794                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5795                 88  CO-REFD-MEAN               VALUE '8'.
  5796                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5797                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5798                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5799
  5800             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5801                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5802                 88  CO-OVRD-BY-R78             VALUE '1'.
  5803                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5804                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5805                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5806                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5807                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5808                 88  CO-OVRD-MEAN               VALUE '8'.
  5809                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5810
  5811             20  CF-CO-BEN-I-G-CD           PIC X.
  5812                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5813                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5814                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5815
  5816         16  FILLER                         PIC X(304).
  5817
  5818
  5819****************************************************************
  5820*             CARRIER MASTER RECORD                            *
  5821****************************************************************
  5822
  5823     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5824         16  CF-ADDRESS-DATA.
  5825             20  CF-MAIL-TO-NAME            PIC X(30).
  5826             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 108
* EL050.cbl
  5827             20  CF-ADDRESS-LINE-1          PIC X(30).
  5828             20  CF-ADDRESS-LINE-2          PIC X(30).
  5829             20  CF-CITY-STATE              PIC X(30).
  5830             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5831             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5832
  5833         16  CF-CLAIM-NO-CONTROL.
  5834             20  CF-CLAIM-NO-METHOD         PIC X.
  5835                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5836                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5837                 88  CLAIM-NO-SEQ               VALUE '3'.
  5838                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5839             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5840                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5841                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5842                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5843
  5844         16  CF-CHECK-NO-CONTROL.
  5845             20  CF-CHECK-NO-METHOD         PIC X.
  5846                 88  CHECK-NO-MANUAL            VALUE '1'.
  5847                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5848                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5849                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5850             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5851                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5852
  5853         16  CF-DOMICILE-STATE              PIC XX.
  5854
  5855         16  CF-EXPENSE-CONTROLS.
  5856             20  CF-EXPENSE-METHOD          PIC X.
  5857                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5858                 88  DOLLARS-PER-PMT            VALUE '2'.
  5859                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5860                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5861             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5862             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5863
  5864         16  CF-CORRESPONDENCE-CONTROL.
  5865             20  CF-LETTER-RESEND-OPT       PIC X.
  5866                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5867                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5868             20  FILLER                     PIC X(4).
  5869
  5870         16  CF-RESERVE-CONTROLS.
  5871             20  CF-MANUAL-SW               PIC X.
  5872                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5873             20  CF-FUTURE-SW               PIC X.
  5874                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5875             20  CF-PTC-SW                  PIC X.
  5876                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5877             20  CF-IBNR-SW                 PIC X.
  5878                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5879             20  CF-PTC-LF-SW               PIC X.
  5880                 88  CF-LF-PTC-USED             VALUE '1'.
  5881             20  CF-CDT-ACCESS-METHOD       PIC X.
  5882                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5883                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5884                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 109
* EL050.cbl
  5885             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5886
  5887         16  CF-CLAIM-CALC-METHOD           PIC X.
  5888             88  360-PLUS-MONTHS                VALUE '1'.
  5889             88  365-PLUS-MONTHS                VALUE '2'.
  5890             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5891             88  360-DAILY                      VALUE '4'.
  5892             88  365-DAILY                      VALUE '5'.
  5893
  5894         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5895         16  FILLER                         PIC X(11).
  5896
  5897         16  CF-LIMIT-AMOUNTS.
  5898             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5899             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5900             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5901             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5902             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5903             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5904             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5905             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5906             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5907             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5908
  5909         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5910         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5911         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5912
  5913         16  CF-ZIP-CODE.
  5914             20  CF-ZIP-PRIME.
  5915                 24  CF-ZIP-1ST             PIC X.
  5916                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5917                 24  FILLER                 PIC X(4).
  5918             20  CF-ZIP-PLUS4               PIC X(4).
  5919         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5920             20  CF-CAN-POSTAL-1            PIC XXX.
  5921             20  CF-CAN-POSTAL-2            PIC XXX.
  5922             20  FILLER                     PIC XXX.
  5923
  5924         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5925         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5926         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5927
  5928         16  CF-RATING-SWITCH               PIC X.
  5929             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5930             88  CF-NO-RATING                   VALUE 'N'.
  5931
  5932         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5933
  5934         16  CF-CARRIER-OVER-SHORT.
  5935             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5936             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5937
  5938         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5939         16  CF-SECPAY-SWITCH               PIC X.
  5940             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5941             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5942         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 110
* EL050.cbl
  5943         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5944         16  FILLER                         PIC X(444).
  5945*        16  FILLER                         PIC X(452).
  5946
  5947
  5948****************************************************************
  5949*             MORTALITY MASTER RECORD                          *
  5950****************************************************************
  5951
  5952     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5953         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5954                                INDEXED BY CF-MORT-NDX.
  5955             20  CF-MORT-TABLE              PIC X(5).
  5956             20  CF-MORT-TABLE-TYPE         PIC X.
  5957                 88  CF-MORT-JOINT              VALUE 'J'.
  5958                 88  CF-MORT-SINGLE             VALUE 'S'.
  5959                 88  CF-MORT-COMBINED           VALUE 'C'.
  5960                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5961                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5962             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5963             20  CF-MORT-AGE-METHOD         PIC XX.
  5964                 88  CF-AGE-LAST                VALUE 'AL'.
  5965                 88  CF-AGE-NEAR                VALUE 'AN'.
  5966             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5967             20  CF-MORT-ADJUSTMENT-DIRECTION
  5968                                            PIC X.
  5969                 88  CF-MINUS                   VALUE '-'.
  5970                 88  CF-PLUS                    VALUE '+'.
  5971             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5972             20  CF-MORT-JOINT-CODE         PIC X.
  5973                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5974             20  CF-MORT-PC-Q               PIC X.
  5975                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5976             20  CF-MORT-TABLE-CODE         PIC X(4).
  5977             20  CF-MORT-COMMENTS           PIC X(15).
  5978             20  FILLER                     PIC X(14).
  5979
  5980         16  FILLER                         PIC X(251).
  5981
  5982
  5983****************************************************************
  5984*             BUSSINESS TYPE MASTER RECORD                     *
  5985****************************************************************
  5986
  5987     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5988* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5989* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5990* AND RECORD 05 IS TYPES 81-99
  5991         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5992             20  CF-BUSINESS-TITLE          PIC  X(19).
  5993             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5994                                            PIC S9V9(4) COMP-3.
  5995             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5996             20  FILLER                     PIC  X.
  5997         16  FILLER                         PIC  X(248).
  5998
  5999
  6000****************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 111
* EL050.cbl
  6001*             TERMINAL MASTER RECORD                           *
  6002****************************************************************
  6003
  6004     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6005
  6006         16  CF-COMPANY-TERMINALS.
  6007             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6008                                  PIC X(4).
  6009         16  FILLER               PIC X(248).
  6010
  6011
  6012****************************************************************
  6013*             LIFE EDIT MASTER RECORD                          *
  6014****************************************************************
  6015
  6016     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6017         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6018             20  CF-LIFE-CODE-IN            PIC XX.
  6019             20  CF-LIFE-CODE-OUT           PIC XX.
  6020         16  FILLER                         PIC X(248).
  6021
  6022
  6023****************************************************************
  6024*             AH EDIT MASTER RECORD                            *
  6025****************************************************************
  6026
  6027     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6028         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6029             20  CF-AH-CODE-IN              PIC XXX.
  6030             20  CF-AH-CODE-OUT             PIC XX.
  6031         16  FILLER                         PIC X(248).
  6032
  6033
  6034****************************************************************
  6035*             CREDIBILITY TABLES                               *
  6036****************************************************************
  6037
  6038     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6039         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6040                             INDEXED BY CF-CRDB-NDX.
  6041             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6042             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6043             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6044         16  FILLER                         PIC  X(332).
  6045
  6046
  6047****************************************************************
  6048*             REPORT CUSTOMIZATION RECORD                      *
  6049****************************************************************
  6050
  6051     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6052         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6053             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6054             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6055             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6056**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6057****       A T-TRANSFER.                                   ****
  6058             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 112
* EL050.cbl
  6059
  6060         16  FILLER                         PIC XX.
  6061
  6062         16  CF-CARRIER-CNTL-OPT.
  6063             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6064                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6065                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6066             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6067                                            PIC X.
  6068         16  CF-GROUP-CNTL-OPT.
  6069             20  CF-GROUP-OPT-SEQ           PIC 9.
  6070                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6071                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6072             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6073                                            PIC X(6).
  6074         16  CF-STATE-CNTL-OPT.
  6075             20  CF-STATE-OPT-SEQ           PIC 9.
  6076                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6077                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6078             20  CF-STATE-SELECT OCCURS 3 TIMES
  6079                                            PIC XX.
  6080         16  CF-ACCOUNT-CNTL-OPT.
  6081             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6082                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6083                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6084             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6085                                            PIC X(10).
  6086         16  CF-BUS-TYP-CNTL-OPT.
  6087             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6088                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6089                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6090             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6091                                            PIC XX.
  6092         16  CF-LF-TYP-CNTL-OPT.
  6093             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6094                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6095                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6096             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6097                                            PIC XX.
  6098         16  CF-AH-TYP-CNTL-OPT.
  6099             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6100                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6101                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6102             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6103                                            PIC XX.
  6104         16  CF-REPTCD1-CNTL-OPT.
  6105             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6106                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6107                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6108             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6109                                            PIC X(10).
  6110         16  CF-REPTCD2-CNTL-OPT.
  6111             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6112                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6113                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6114             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6115                                            PIC X(10).
  6116         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 113
* EL050.cbl
  6117             20  CF-USER1-OPT-SEQ           PIC 9.
  6118                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6119                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6120             20  CF-USER1-SELECT OCCURS 3 TIMES
  6121                                            PIC X(10).
  6122         16  CF-USER2-CNTL-OPT.
  6123             20  CF-USER2-OPT-SEQ           PIC 9.
  6124                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6125                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6126             20  CF-USER2-SELECT OCCURS 3 TIMES
  6127                                            PIC X(10).
  6128         16  CF-USER3-CNTL-OPT.
  6129             20  CF-USER3-OPT-SEQ           PIC 9.
  6130                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6131                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6132             20  CF-USER3-SELECT OCCURS 3 TIMES
  6133                                            PIC X(10).
  6134         16  CF-USER4-CNTL-OPT.
  6135             20  CF-USER4-OPT-SEQ           PIC 9.
  6136                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6137                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6138             20  CF-USER4-SELECT OCCURS 3 TIMES
  6139                                            PIC X(10).
  6140         16  CF-USER5-CNTL-OPT.
  6141             20  CF-USER5-OPT-SEQ           PIC 9.
  6142                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6143                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6144             20  CF-USER5-SELECT OCCURS 3 TIMES
  6145                                            PIC X(10).
  6146         16  CF-REINS-CNTL-OPT.
  6147             20  CF-REINS-OPT-SEQ           PIC 9.
  6148                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6149                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6150             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6151                 24  CF-REINS-PRIME         PIC XXX.
  6152                 24  CF-REINS-SUB           PIC XXX.
  6153
  6154         16  CF-AGENT-CNTL-OPT.
  6155             20  CF-AGENT-OPT-SEQ           PIC 9.
  6156                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6157                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6158             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6159                                            PIC X(10).
  6160
  6161         16  FILLER                         PIC X(43).
  6162
  6163         16  CF-LOSS-RATIO-SELECT.
  6164             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6165             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6166         16  CF-ENTRY-DATE-SELECT.
  6167             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6168             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6169         16  CF-EFFECTIVE-DATE-SELECT.
  6170             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6171             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6172
  6173         16  CF-EXCEPTION-LIST-IND          PIC X.
  6174             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 114
* EL050.cbl
  6175
  6176         16  FILLER                         PIC X(318).
  6177
  6178****************************************************************
  6179*                  EXCEPTION REPORTING RECORD                  *
  6180****************************************************************
  6181
  6182     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6183         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6184             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6185
  6186         16  CF-COMBINED-LIFE-AH-OPT.
  6187             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6188             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6189             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6190             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6191
  6192         16  CF-LIFE-OPT.
  6193             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6194             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6195             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6196             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6197             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6198             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6199             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6200             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6201             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6202             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6203
  6204         16  CF-AH-OPT.
  6205             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6206             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6207             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6208             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6209             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6210             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6211             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6212             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6213             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6214             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6215
  6216         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6217             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6218             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6219             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6220
  6221         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6222
  6223         16  FILLER                         PIC X(673).
  6224
  6225
  6226****************************************************************
  6227*             MORTGAGE SYSTEM PLAN RECORD                      *
  6228****************************************************************
  6229
  6230     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6231         16  CF-PLAN-TYPE                   PIC X.
  6232             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 115
* EL050.cbl
  6233             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6234             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6235         16  CF-PLAN-ABBREV                 PIC XXX.
  6236         16  CF-PLAN-DESCRIPT               PIC X(10).
  6237         16  CF-PLAN-NOTES                  PIC X(20).
  6238         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6239         16  CF-PLAN-UNDERWRITING.
  6240             20  CF-PLAN-TERM-DATA.
  6241                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6242                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6243             20  CF-PLAN-AGE-DATA.
  6244                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6245                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6246                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6247             20  CF-PLAN-BENEFIT-DATA.
  6248                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6249                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6250                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6251                                            PIC S9(7)V99  COMP-3.
  6252         16  CF-PLAN-POLICY-FORMS.
  6253             20  CF-POLICY-FORM             PIC X(12).
  6254             20  CF-MASTER-APPLICATION      PIC X(12).
  6255             20  CF-MASTER-POLICY           PIC X(12).
  6256         16  CF-PLAN-RATING.
  6257             20  CF-RATE-CODE               PIC X(5).
  6258             20  CF-SEX-RATING              PIC X.
  6259                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6260                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6261             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6262             20  CF-SUB-STD-TYPE            PIC X.
  6263                 88  CF-PCT-OF-PREM            VALUE '1'.
  6264                 88  CF-PCT-OF-BENE            VALUE '2'.
  6265         16  CF-PLAN-PREM-TOLERANCES.
  6266             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6267             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6268         16  CF-PLAN-PYMT-TOLERANCES.
  6269             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6270             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6271         16  CF-PLAN-MISC-DATA.
  6272             20  FILLER                     PIC X.
  6273             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6274             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6275         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6276         16  CF-PLAN-IND-GRP                PIC X.
  6277             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6278                                                     '1'.
  6279             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6280                                                     '2'.
  6281         16  CF-MIB-SEARCH-SW               PIC X.
  6282             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6283             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6284             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6285             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6286         16  CF-ALPHA-SEARCH-SW             PIC X.
  6287             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6288             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6289             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6290             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 116
* EL050.cbl
  6291             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6292             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6293             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6294             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6295             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6296             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6297                                                     'A' 'B' 'C'
  6298                                                     'X' 'Y' 'Z'.
  6299         16  CF-EFF-DT-RULE-SW              PIC X.
  6300             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6301             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6302             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6303             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6304             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6305         16  FILLER                         PIC X(4).
  6306         16  CF-HEALTH-QUESTIONS            PIC X.
  6307             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6308         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6309         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6310         16  CF-PLAN-SNGL-JNT               PIC X.
  6311             88  CF-COMBINED-PLAN              VALUE 'C'.
  6312             88  CF-JNT-PLAN                   VALUE 'J'.
  6313             88  CF-SNGL-PLAN                  VALUE 'S'.
  6314         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6315         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6316         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6317         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6318         16  CF-RERATE-CNTL                 PIC  X.
  6319             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6320             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6321             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6322             88  CF-AUTO-RECALC                 VALUE '4'.
  6323         16  CF-BENEFIT-TYPE                PIC  X.
  6324             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6325             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6326         16  CF-POLICY-FEE                  PIC S999V99
  6327                                                    COMP-3.
  6328         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6329         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6330         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6331         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6332         16  FILLER                         PIC  X(32).
  6333         16  CF-TERMINATION-FORM            PIC  X(04).
  6334         16  FILLER                         PIC  X(08).
  6335         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6336                                                       COMP-3.
  6337         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6338         16  CF-ISSUE-LETTER                PIC  X(4).
  6339         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6340         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6341             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6342             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6343         16  CF-MP-REFUND-CALC              PIC X.
  6344             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6345             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6346             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6347             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6348             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 117
* EL050.cbl
  6349             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6350             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6351             88  CF-MP-REFD-MEAN                VALUE '8'.
  6352         16  CF-ALT-RATE-CODE               PIC  X(5).
  6353
  6354
  6355         16  FILLER                         PIC X(498).
  6356****************************************************************
  6357*             MORTGAGE COMPANY MASTER RECORD                   *
  6358****************************************************************
  6359
  6360     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6361         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6362         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6363             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6364             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6365             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6366             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6367             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6368
  6369         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6370         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6371         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6372         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6373         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6374
  6375         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6376             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6377         16  CF-MP-RECON-USE-IND            PIC X(1).
  6378             88  CF-MP-USE-RECON             VALUE 'Y'.
  6379         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6380             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6381         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6382             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6383             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6384         16  FILLER                         PIC X(1).
  6385         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6386             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6387         16  CF-MORTG-MIB-VERSION           PIC X.
  6388             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6389             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6390             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6391         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6392             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6393                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6394             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6395                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6396             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6397                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6398             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6399                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6400             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6401                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6402             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6403                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6404         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6405         16  FILLER                         PIC X(7).
  6406         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 118
* EL050.cbl
  6407             20  CF-MORTG-MIB-COMM          PIC X(5).
  6408             20  CF-MORTG-MIB-TERM          PIC X(5).
  6409         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6410             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6411         16  FILLER                         PIC X(03).
  6412         16  CF-MP-CHECK-NO-CONTROL.
  6413             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6414                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6415                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6416                                                ' ' LOW-VALUES.
  6417                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6418                                               VALUE '3'.
  6419         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6420         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6421         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6422             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6423                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6424             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6425                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6426             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6427                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6428             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6429                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6430             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6431                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6432             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6433                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6434         16  CF-MORTG-BILLING-AREA.
  6435             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6436                                            PIC X.
  6437         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6438         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6439         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6440         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6441             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6442             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6443         16  FILLER                         PIC X.
  6444         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6445             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6446             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6447         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6448         16  FILLER                         PIC X(8).
  6449         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6450         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6451         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6452         16  CF-ACH-COMPANY-ID.
  6453             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6454                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6455                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6456                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6457             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6458         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6459             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6460         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6461             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6462             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6463         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6464         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 119
* EL050.cbl
  6465         16  FILLER                         PIC X(536).
  6466
  6467****************************************************************
  6468*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6469****************************************************************
  6470
  6471     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6472         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6473             20  CF-FEMALE-HEIGHT.
  6474                 24  CF-FEMALE-FT           PIC 99.
  6475                 24  CF-FEMALE-IN           PIC 99.
  6476             20  CF-FEMALE-MIN-WT           PIC 999.
  6477             20  CF-FEMALE-MAX-WT           PIC 999.
  6478         16  FILLER                         PIC X(428).
  6479
  6480     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6481         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6482             20  CF-MALE-HEIGHT.
  6483                 24  CF-MALE-FT             PIC 99.
  6484                 24  CF-MALE-IN             PIC 99.
  6485             20  CF-MALE-MIN-WT             PIC 999.
  6486             20  CF-MALE-MAX-WT             PIC 999.
  6487         16  FILLER                         PIC X(428).
  6488******************************************************************
  6489*             AUTOMATIC ACTIVITY RECORD                          *
  6490******************************************************************
  6491     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6492         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6493             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6494             20  CF-SYS-LETTER-ID           PIC X(04).
  6495             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6496             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6497             20  CF-SYS-RESET-SW            PIC X(01).
  6498             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6499             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6500
  6501         16  FILLER                         PIC X(50).
  6502
  6503         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6504             20  CF-USER-ACTIVE-SW          PIC X(01).
  6505             20  CF-USER-LETTER-ID          PIC X(04).
  6506             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6507             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6508             20  CF-USER-RESET-SW           PIC X(01).
  6509             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6510             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6511             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6512
  6513         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 120
* EL050.cbl
  6515*    COPY ERCACCT.
  6516******************************************************************
  6517*                                                                *
  6518*                                                                *
  6519*                            ERCACCT                             *
  6520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6521*                            VMOD=2.031                          *
  6522*                                                                *
  6523*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6524*                                                                *
  6525*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6526*   VSAM ACCOUNT MASTER FILES.                                   *
  6527*                                                                *
  6528*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6529*                                                                *
  6530*   FILE TYPE = VSAM,KSDS                                        *
  6531*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6532*                                                                *
  6533*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6534*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6535*                                                                *
  6536*   LOG = NO                                                     *
  6537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6538*                                                                *
  6539*                                                                *
  6540******************************************************************
  6541*                   C H A N G E   L O G
  6542*
  6543* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6544*-----------------------------------------------------------------
  6545*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6546* EFFECTIVE    NUMBER
  6547*-----------------------------------------------------------------
  6548* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6549* 092705    2005050300006  PEMA  ADD SPP LEASES
  6550* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6551* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6552* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6553* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6554* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6555******************************************************************
  6556
  6557 01  ACCOUNT-MASTER.
  6558     12  AM-RECORD-ID                      PIC XX.
  6559         88  VALID-AM-ID                      VALUE 'AM'.
  6560
  6561     12  AM-CONTROL-PRIMARY.
  6562         16  AM-COMPANY-CD                 PIC X.
  6563         16  AM-MSTR-CNTRL.
  6564             20  AM-CONTROL-A.
  6565                 24  AM-CARRIER            PIC X.
  6566                 24  AM-GROUPING.
  6567                     28 AM-GROUPING-PREFIX PIC XXX.
  6568                     28 AM-GROUPING-PRIME  PIC XXX.
  6569                 24  AM-STATE              PIC XX.
  6570                 24  AM-ACCOUNT.
  6571                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6572                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 121
* EL050.cbl
  6573             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6574                                           PIC X(19).
  6575             20  AM-CNTRL-B.
  6576                 24  AM-EXPIRATION-DT      PIC XX.
  6577                 24  FILLER                PIC X(4).
  6578             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6579                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6580
  6581     12  AM-CONTROL-BY-VAR-GRP.
  6582         16  AM-COMPANY-CD-A1              PIC X.
  6583         16  AM-VG-CARRIER                 PIC X.
  6584         16  AM-VG-GROUPING                PIC X(6).
  6585         16  AM-VG-STATE                   PIC XX.
  6586         16  AM-VG-ACCOUNT                 PIC X(10).
  6587         16  AM-VG-DATE.
  6588             20  AM-VG-EXPIRATION-DT       PIC XX.
  6589             20  FILLER                    PIC X(4).
  6590         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6591                                           PIC 9(11)      COMP-3.
  6592     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6593         16  FILLER                        PIC X(10).
  6594         16  AM-VG-KEY3.
  6595             20  AM-VG3-ACCOUNT            PIC X(10).
  6596             20  AM-VG3-EXP-DT             PIC XX.
  6597         16  FILLER                        PIC X(4).
  6598     12  AM-MAINT-INFORMATION.
  6599         16  AM-LAST-MAINT-DT              PIC XX.
  6600         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6601         16  AM-LAST-MAINT-USER            PIC X(4).
  6602         16  FILLER                        PIC XX.
  6603
  6604     12  AM-EFFECTIVE-DT                   PIC XX.
  6605     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6606
  6607     12  AM-PREV-DATES  COMP-3.
  6608         16  AM-PREV-EXP-DT                PIC 9(11).
  6609         16  AM-PREV-EFF-DT                PIC 9(11).
  6610
  6611     12  AM-REPORT-CODE-1                  PIC X(10).
  6612     12  AM-REPORT-CODE-2                  PIC X(10).
  6613
  6614     12  AM-CITY-CODE                      PIC X(4).
  6615     12  AM-COUNTY-PARISH                  PIC X(6).
  6616
  6617     12  AM-NAME                           PIC X(30).
  6618     12  AM-PERSON                         PIC X(30).
  6619     12  AM-ADDRS                          PIC X(30).
  6620     12  AM-CITY.
  6621         16  AM-ADDR-CITY                  PIC X(28).
  6622         16  AM-ADDR-STATE                 PIC XX.
  6623     12  AM-ZIP.
  6624         16  AM-ZIP-PRIME.
  6625             20  AM-ZIP-PRI-1ST            PIC X.
  6626                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6627             20  FILLER                    PIC X(4).
  6628         16  AM-ZIP-PLUS4                  PIC X(4).
  6629     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6630         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 122
* EL050.cbl
  6631         16  AM-CAN-POSTAL-2               PIC XXX.
  6632         16  FILLER                        PIC XXX.
  6633     12  AM-TEL-NO.
  6634         16  AM-AREA-CODE                  PIC 999.
  6635         16  AM-TEL-PRE                    PIC 999.
  6636         16  AM-TEL-NBR                    PIC 9(4).
  6637     12  AM-TEL-LOC                        PIC X.
  6638         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6639         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6640
  6641     12  AM-COMM-STRUCTURE.
  6642         16  AM-DEFN-1.
  6643             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6644                 24  AM-AGT.
  6645                     28  AM-AGT-PREFIX     PIC X(4).
  6646                     28  AM-AGT-PRIME      PIC X(6).
  6647                 24  AM-COM-TYP            PIC X.
  6648                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6649                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6650                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6651                 24  AM-RECALC-LV-INDIC    PIC X.
  6652                 24  AM-RETRO-LV-INDIC     PIC X.
  6653                 24  AM-GL-CODES           PIC X.
  6654                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6655                 24  FILLER                PIC X(01).
  6656         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6657             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6658                 24  FILLER                PIC X(11).
  6659                 24  AM-L-COMA             PIC XXX.
  6660                 24  AM-J-COMA             PIC XXX.
  6661                 24  AM-A-COMA             PIC XXX.
  6662                 24  FILLER                PIC X(6).
  6663
  6664     12  AM-COMM-CHANGE-STATUS             PIC X.
  6665         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6666
  6667     12  AM-CSR-CODE                       PIC X(4).
  6668
  6669     12  AM-BILLING-STATUS                 PIC X.
  6670         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6671         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6672     12  AM-AUTO-REFUND-SW                 PIC X.
  6673         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6674         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6675     12  AM-GPCD                           PIC 99.
  6676     12  AM-IG                             PIC X.
  6677         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6678         88  AM-HAS-GROUP                     VALUE '2'.
  6679     12  AM-STATUS                         PIC X.
  6680         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6681         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6682         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6683         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6684         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6685         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6686     12  AM-REMIT-TO                       PIC 99.
  6687     12  AM-ID-NO                          PIC X(11).
  6688
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 123
* EL050.cbl
  6689     12  AM-CAL-TABLE                      PIC XX.
  6690     12  AM-LF-DEVIATION                   PIC XXX.
  6691     12  AM-AH-DEVIATION                   PIC XXX.
  6692     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6693     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6694     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6695     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6696     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6697     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6698
  6699     12  AM-USER-FIELDS.
  6700         16  AM-FLD-1                      PIC XX.
  6701         16  AM-FLD-2                      PIC XX.
  6702         16  AM-FLD-3                      PIC XX.
  6703         16  AM-FLD-4                      PIC XX.
  6704         16  AM-FLD-5                      PIC XX.
  6705
  6706     12  AM-1ST-PROD-DATE.
  6707         16  AM-1ST-PROD-YR                PIC XX.
  6708         16  AM-1ST-PROD-MO                PIC XX.
  6709         16  AM-1ST-PROD-DA                PIC XX.
  6710     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6711     12  AM-CERTS-PURGED-DATE.
  6712         16  AM-PUR-YR                     PIC XX.
  6713         16  AM-PUR-MO                     PIC XX.
  6714         16  AM-PUR-DA                     PIC XX.
  6715     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6716     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6717     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6718     12  AM-INACTIVE-DATE.
  6719         16  AM-INA-MO                     PIC 99.
  6720         16  AM-INA-DA                     PIC 99.
  6721         16  AM-INA-YR                     PIC 99.
  6722     12  AM-AR-HI-CERT-DATE                PIC XX.
  6723
  6724     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6725     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6726
  6727     12  AM-OB-PAYMENT-MODE                PIC X.
  6728         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6729         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6730         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6731         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6732
  6733     12  AM-AH-ONLY-INDICATOR              PIC X.
  6734         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6735         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6736
  6737     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6738
  6739     12  AM-OVER-SHORT.
  6740         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6741         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6742
  6743     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6744     12  AM-DCC-CLP-STATE                  PIC XX.
  6745
  6746     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 124
* EL050.cbl
  6747     12  AM-RECALC-REIN                    PIC X.
  6748
  6749     12  AM-REI-TABLE                      PIC XXX.
  6750     12  AM-REI-ET-LF                      PIC X.
  6751     12  AM-REI-ET-AH                      PIC X.
  6752     12  AM-REI-PE-LF                      PIC X.
  6753     12  AM-REI-PE-AH                      PIC X.
  6754     12  AM-REI-PRT-ST                     PIC X.
  6755     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6756     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6757     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6758     12  AM-REI-GROUP-A                    PIC X(6).
  6759     12  AM-REI-MORT                       PIC X(4).
  6760     12  AM-REI-PRT-OW                     PIC X.
  6761     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6762     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6763     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6764     12  AM-REI-GROUP-B                    PIC X(6).
  6765
  6766     12  AM-TRUST-TYPE                     PIC X(2).
  6767
  6768     12  AM-EMPLOYER-STMT-USED             PIC X.
  6769     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6770
  6771     12  AM-STD-AH-TYPE                    PIC XX.
  6772     12  AM-EARN-METHODS.
  6773         16  AM-EARN-METHOD-R              PIC X.
  6774             88 AM-REF-RL-R78                 VALUE 'R'.
  6775             88 AM-REF-RL-PR                  VALUE 'P'.
  6776             88 AM-REF-RL-MEAN                VALUE 'M'.
  6777             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6778         16  AM-EARN-METHOD-L              PIC X.
  6779             88 AM-REF-LL-R78                 VALUE 'R'.
  6780             88 AM-REF-LL-PR                  VALUE 'P'.
  6781             88 AM-REF-LL-MEAN                VALUE 'M'.
  6782             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6783         16  AM-EARN-METHOD-A              PIC X.
  6784             88 AM-REF-AH-R78                 VALUE 'R'.
  6785             88 AM-REF-AH-PR                  VALUE 'P'.
  6786             88 AM-REF-AH-MEAN                VALUE 'M'.
  6787             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6788             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6789             88 AM-REF-AH-NET                 VALUE 'N'.
  6790
  6791     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6792     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6793     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6794
  6795     12  AM-RET-Y-N                        PIC X.
  6796     12  AM-RET-P-E                        PIC X.
  6797     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6798     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6799     12  AM-RET-GRP                        PIC X(6).
  6800     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6801         16  AM-POOL-PRIME                 PIC XXX.
  6802         16  AM-POOL-SUB                   PIC XXX.
  6803     12  AM-RETRO-EARNINGS.
  6804         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 125
* EL050.cbl
  6805         16  AM-RET-EARN-L                 PIC X.
  6806         16  AM-RET-EARN-A                 PIC X.
  6807     12  AM-RET-ST-TAX-USE                 PIC X.
  6808         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6809         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6810     12  AM-RETRO-BEG-EARNINGS.
  6811         16  AM-RET-BEG-EARN-R             PIC X.
  6812         16  AM-RET-BEG-EARN-L             PIC X.
  6813         16  AM-RET-BEG-EARN-A             PIC X.
  6814     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6815     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6816
  6817     12  AM-USER-SELECT-OPTIONS.
  6818         16  AM-USER-SELECT-1              PIC X(10).
  6819         16  AM-USER-SELECT-2              PIC X(10).
  6820         16  AM-USER-SELECT-3              PIC X(10).
  6821         16  AM-USER-SELECT-4              PIC X(10).
  6822         16  AM-USER-SELECT-5              PIC X(10).
  6823
  6824     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6825
  6826     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6827
  6828     12  AM-RPT045A-SWITCH                 PIC X.
  6829         88  RPT045A-OFF                   VALUE 'N'.
  6830
  6831     12  AM-INSURANCE-LIMITS.
  6832         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6833         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6834
  6835     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6836         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6837
  6838     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6839         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6840         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6841
  6842     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6843
  6844     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6845     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6846     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6847     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6848     12  AM-DCC-UEF-STATE                  PIC XX.
  6849     12  FILLER                            PIC XXX.
  6850     12  AM-REPORT-CODE-3                  PIC X(10).
  6851*    12  FILLER                            PIC X(22).
  6852
  6853     12  AM-RESERVE-DATE.
  6854         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6855         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6856         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6857
  6858     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6859     12  AM-NOTIFICATION-TYPES.
  6860         16  AM-NOTIF-OF-LETTERS           PIC X.
  6861         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6862         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 126
* EL050.cbl
  6863         16  AM-NOTIF-OF-STATUS            PIC X.
  6864
  6865     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6866         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6867         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6868         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6869         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6870
  6871     12  AM-BENEFIT-CONTROLS.
  6872         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6873             20  AM-BENEFIT-CODE           PIC XX.
  6874             20  AM-BENEFIT-TYPE           PIC X.
  6875             20  AM-BENEFIT-REVISION       PIC XXX.
  6876             20  AM-BENEFIT-REM-TERM       PIC X.
  6877             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6878             20  FILLER                    PIC XX.
  6879         16  FILLER                        PIC X(80).
  6880
  6881     12  AM-TRANSFER-DATA.
  6882         16  AM-TRANSFERRED-FROM.
  6883             20  AM-TRNFROM-CARRIER        PIC X.
  6884             20  AM-TRNFROM-GROUPING.
  6885                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6886                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6887             20  AM-TRNFROM-STATE          PIC XX.
  6888             20  AM-TRNFROM-ACCOUNT.
  6889                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6890                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6891             20  AM-TRNFROM-DTE            PIC XX.
  6892         16  AM-TRANSFERRED-TO.
  6893             20  AM-TRNTO-CARRIER          PIC X.
  6894             20  AM-TRNTO-GROUPING.
  6895                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6896                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6897             20  AM-TRNTO-STATE            PIC XX.
  6898             20  AM-TRNTO-ACCOUNT.
  6899                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6900                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6901             20  AM-TRNTO-DTE              PIC XX.
  6902         16  FILLER                        PIC X(10).
  6903
  6904     12  AM-SAVED-REMIT-TO                 PIC 99.
  6905
  6906     12  AM-COMM-STRUCTURE-SAVED.
  6907         16  AM-DEFN-1-SAVED.
  6908             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6909                 24  AM-AGT-SV             PIC X(10).
  6910                 24  AM-COM-TYP-SV         PIC X.
  6911                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6912                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6913                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6914                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6915                 24  FILLER                PIC X.
  6916                 24  AM-GL-CODES-SV        PIC X.
  6917                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6918                 24  FILLER                PIC X.
  6919         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6920             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 127
* EL050.cbl
  6921                 24  FILLER                PIC X(11).
  6922                 24  AM-L-COMA-SV          PIC XXX.
  6923                 24  AM-J-COMA-SV          PIC XXX.
  6924                 24  AM-A-COMA-SV          PIC XXX.
  6925                 24  FILLER                PIC X(6).
  6926
  6927     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6928         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6929            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6930            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6931            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6932
  6933     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6934     12  FILLER                            PIC X(120).
  6935
  6936     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6937         16  AM-CONTROL-NAME               PIC X(30).
  6938         16  AM-EXECUTIVE-ONE.
  6939             20  AM-EXEC1-NAME             PIC X(15).
  6940             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6941                                                          COMP-3.
  6942             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6943                                                          COMP-3.
  6944         16  AM-EXECUTIVE-TWO.
  6945             20  AM-EXEC2-NAME             PIC X(15).
  6946             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6947                                                          COMP-3.
  6948             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6949                                                          COMP-3.
  6950
  6951     12  AM-RETRO-ADDITIONAL-DATA.
  6952         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6953         16  AM-RETRO-PREM-P-E             PIC X.
  6954         16  AM-RETRO-CLMS-P-I             PIC X.
  6955         16  AM-RETRO-RET-BRACKET-LF.
  6956             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6957                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6958                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6959             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6960                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6961                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6962             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6963                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6964                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6965         16  AM-RETRO-RET-BRACKET-AH.
  6966             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6967                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6968                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6969                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6970             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6971                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6972                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6973             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6974                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6975                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6976
  6977     12  AM-COMMENTS.
  6978         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 128
* EL050.cbl
  6979
  6980     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6981         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6982         16  AM-FLI-BILLING-CODE           PIC X.
  6983         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6984         16  AM-FLI-UNITED-IDENT           PIC X.
  6985         16  AM-FLI-INTEREST-LOST-DATA.
  6986             20  AM-FLI-BANK-NO            PIC X(5).
  6987             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6988             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6989             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6990         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6991             20  AM-FLI-AGT                PIC X(9).
  6992             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6993             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6994         16  FILLER                        PIC X(102).
  6995
  6996     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6997         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6998             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6999             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7000             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7001             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7002             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7003         16  FILLER                          PIC X(10).
  7004******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 129
* EL050.cbl
  7006*    COPY ERCREIN.
  7007******************************************************************
  7008*                                                                *
  7009*                            ERCREIN                             *
  7010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7011*                            VMOD=2.010                          *
  7012*                                                                *
  7013*   ONLINE CREDIT SYSTEM                                         *
  7014*                                                                *
  7015*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7016*                                                                *
  7017*   FILE TYPE = VSAM,KSDS                                        *
  7018*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7019*                                                                *
  7020*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7021*       ALTERNATE PATH = NONE                                    *
  7022*                                                                *
  7023*   LOG = NO                                                     *
  7024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7025*                                                                *
  7026******************************************************************
  7027*                   C H A N G E   L O G
  7028*
  7029* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7030*-----------------------------------------------------------------
  7031*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7032* EFFECTIVE    NUMBER
  7033*-----------------------------------------------------------------
  7034* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7035* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7036******************************************************************
  7037 01  REINSURANCE-RECORD.
  7038     12  RE-RECORD-ID                      PIC XX.
  7039         88  VALID-RE-ID                      VALUE 'RE'.
  7040
  7041     12  RE-CONTROL-PRIMARY.
  7042         16  RE-COMPANY-CD                 PIC X.
  7043         16  RE-KEY.
  7044             20  RE-CODE                   PIC X.
  7045                 88  RE-TABLE-RECORD          VALUE 'A'.
  7046                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7047             20  RE-TABLE                  PIC XXX.
  7048             20  FILLER                    PIC XXX.
  7049         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7050             20  FILLER                    PIC X.
  7051             20  RE-COMPANY.
  7052                 24  RE-COMP-PRIME         PIC XXX.
  7053                 24  RE-COMP-SUB           PIC XXX.
  7054
  7055     12  RE-MAINT-INFORMATION.
  7056         16  RE-LAST-MAINT-DT              PIC XX.
  7057         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7058         16  RE-LAST-MAINT-USER            PIC X(4).
  7059         16  FILLER                        PIC X(10).
  7060
  7061     12  RE-TABLE-DATA.
  7062         16  RE-100-COMP                   PIC 99.
  7063
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 130
* EL050.cbl
  7064         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7065             20  RE-REI-COMP-NO.
  7066                 24  RE-REI-COMP           PIC XXX.
  7067                 24  RE-REI-COMP-SUB       PIC XXX.
  7068             20  RE-LF-QC                  PIC X.
  7069             20  RE-AH-QC                  PIC X.
  7070             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7071             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7072             20  RE-LFAGE-LO               PIC 99.
  7073             20  RE-LFAGE-HI               PIC 99.
  7074             20  RE-AHAGE-LO               PIC 99.
  7075             20  RE-AHAGE-HI               PIC 99.
  7076             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7077             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7078             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7079             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7080             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7081             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7082             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7083             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7084             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7085             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7086             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7087             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7088             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7089             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7090             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7091             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7092             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7093             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7094             20  RE-LF-BEN-CODE            PIC X.
  7095             20  RE-AH-BEN-CODE            PIC X.
  7096             20  RE-INTERACTIVE            PIC X.
  7097             20  RE-REMAINING              PIC X.
  7098             20  RE-LF-RUNOFF-SW           PIC X.
  7099             20  RE-AH-RUNOFF-SW           PIC X.
  7100             20  FILLER                    PIC X(19).
  7101
  7102         16  RE-COMP-INFO-END              PIC X(6).
  7103         16  RE-NSP-ST-CD-LF               PIC XX.
  7104         16  RE-NSP-ST-CD-AH               PIC XX.
  7105         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7106             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7107
  7108         16  FILLER                        PIC X(27).
  7109
  7110     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7111         16  RE-NAME                       PIC X(30).
  7112         16  RE-LF-PE                      PIC X.
  7113         16  RE-AH-PE                      PIC X.
  7114         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7115         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7116         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7117         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7118         16  RE-PRT-ST                     PIC X.
  7119         16  RE-PRT-OW                     PIC X.
  7120         16  RE-MORT-CODE                  PIC X(4).
  7121         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 131
* EL050.cbl
  7122         16  RE-ZERO-LF-FEE                PIC X.
  7123         16  RE-ZERO-AH-FEE                PIC X.
  7124         16  RE-CEDE-NAME                  PIC X(30).
  7125         16  RE-LF-COMM                    PIC X.
  7126         16  RE-AH-COMM                    PIC X.
  7127         16  RE-LF-TAX                     PIC X.
  7128         16  RE-AH-TAX                     PIC X.
  7129         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7130         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7131         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7132
  7133         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7134             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7135
  7136         16  RE-LF-CEDING-FEE-BRACKETS.
  7137             20  RE-LF-FEE-METHOD          PIC X.
  7138                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7139                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7140                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7141                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7142             20  RE-LF-FEE-BASIS           PIC X.
  7143                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7144                 88  RE-LF-NET-CEDED               VALUE '2'.
  7145                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7146                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7147                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7148                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7149                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7150                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7151             20  FILLER                    PIC XXX.
  7152             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7153                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7154                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7155
  7156         16  RE-AH-CEDING-FEE-BRACKETS.
  7157             20  RE-AH-FEE-METHOD          PIC X.
  7158                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7159                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7160                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7161                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7162             20  RE-AH-FEE-BASIS           PIC X.
  7163                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7164                 88  RE-AH-NET-CEDED               VALUE '2'.
  7165                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7166                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7167                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7168                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7169                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7170                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7171             20  FILLER                    PIC XXX.
  7172             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7173                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7174                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7175
  7176         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7177
  7178         16  RE-OLD-CEDING-STMT            PIC X.
  7179
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 132
* EL050.cbl
  7180         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7181         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7182         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7183         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7184         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7185         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7186         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7187         16  RE-MORT-SW                    PIC X.
  7188         16  RE-CEDING-TYPE-FLAG           PIC X.
  7189             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7190             88  RE-CEDED                          VALUE 'C'.
  7191             88  RE-ASSUMED                        VALUE 'A'.
  7192             88  RE-PHANTOM                        VALUE 'P'.
  7193
  7194         16  RE-CEDING-STMT-OPT-A          PIC X.
  7195             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7196         16  RE-CEDING-STMT-OPT-B          PIC X.
  7197             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7198         16  RE-CEDING-STMT-OPT-C          PIC X.
  7199             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7200         16  RE-CEDING-STMT-OPT-D          PIC X.
  7201             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7202         16  RE-CEDING-STMT-OPT-E          PIC X.
  7203             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7204
  7205         16  RE-PRT-CRSV                   PIC X.
  7206
  7207         16  RE-GL-CENTER                  PIC X(4).
  7208
  7209         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7210
  7211         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7212
  7213         16  RE-EARN-STOP-CODE             PIC X.
  7214             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7215             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7216
  7217         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7218             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7219
  7220         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7221         16  FILLER                        PIC X(2281).
  7222
  7223         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7224
  7225******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 133
* EL050.cbl
  7227*    COPY ERCCTBL.
  7228******************************************************************
  7229*                                                                *
  7230*                                                                *
  7231*                            ERCCTBL                             *
  7232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7233*                            VMOD=2.003
  7234*                                                                *
  7235*   ONLINE CREDIT SYSTEM                                         *
  7236*                                                                *
  7237*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7238*                                                                *
  7239*   FILE TYPE = VSAM,KSDS                                        *
  7240*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7241*                                                                *
  7242*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7243*       ALTERNATE PATH = NONE                                    *
  7244*                                                                *
  7245*   LOG = NO                                                     *
  7246*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7247*                                                                *
  7248*                                                                *
  7249******************************************************************
  7250
  7251 01  COMM-TABLE-RECORD.
  7252     12  CT-RECORD-ID                      PIC XX.
  7253         88  VALID-CT-ID                      VALUE 'CT'.
  7254
  7255     12  CT-CONTROL-PRIMARY.
  7256         16  CT-COMPANY-CD                 PIC X.
  7257         16  CT-TABLE                      PIC XXX.
  7258         16  CT-CNTRL-2.
  7259             20  CT-BEN-TYPE               PIC X.
  7260             20  CT-BEN-CODE               PIC XX.
  7261
  7262     12  CT-MAINT-INFORMATION.
  7263         16  CT-LAST-MAINT-DT              PIC XX.
  7264         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7265         16  CT-LAST-MAINT-USER            PIC X(4).
  7266         16  FILLER                        PIC X(31).
  7267
  7268     12  CT-LIMITS.
  7269         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7270
  7271         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7272
  7273         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7274
  7275     12  CT-RATES.
  7276         16  CT-RTX          OCCURS 27 TIMES.
  7277             20  CT-RT                     PIC SV9(5)     COMP-3.
  7278             20  CT-RT-R   REDEFINES
  7279                 CT-RT                     PIC XXX.
  7280
  7281     12  FILLER                            PIC  X(42).
  7282
  7283******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 134
* EL050.cbl
  7285*    COPY ERCFORM.
  7286******************************************************************
  7287*                                                                *
  7288*                                                                *
  7289*                            ERCFORM.                            *
  7290*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7291*                            VMOD=2.003                          *
  7292*                                                                *
  7293*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7294*                                                                *
  7295*    FILE TYPE = VSAM,KSDS                                       *
  7296*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7297*                                                                *
  7298*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7299*                                                                *
  7300*    LOG = YES                                                   *
  7301*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7302******************************************************************
  7303 01  FORM-MASTER.
  7304    12  FO-RECORD-ID                 PIC X(02).
  7305        88  VALID-FO-ID                  VALUE 'FO'.
  7306
  7307    12  FO-CONTROL-PRIMARY.
  7308        16  FO-COMPANY-CD            PIC X(01).
  7309        16  FO-STATE                 PIC X(02).
  7310        16  FO-FORM-ID               PIC X(12).
  7311        16  FO-FORM-EXP-DT           PIC X(02).
  7312
  7313    12  FO-POLICY-FORM-DATA.
  7314        16  FO-IND-GRP-CD            PIC X(01).
  7315        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7316        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7317        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7318        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7319        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7320        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7321        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7322        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7323        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7324        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7325        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7326        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7327        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7328        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7329        16  FO-APP-CERT-USE-CD       PIC X(01).
  7330
  7331    12  FILLER                       PIC X(29).
  7332
  7333    12  FO-FORM-PLAN-TABLE.
  7334        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7335            20  FO-PLAN-TYPE         PIC X(01).
  7336            20  FO-PLAN-ID           PIC X(02).
  7337            20  FO-PLAN-TERM         PIC 9(03).
  7338            20  FO-PLAN-REFUND-METHOD
  7339                                     PIC X.
  7340
  7341    12  FILLER                       PIC X(30).
  7342
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 135
* EL050.cbl
  7343    12  FO-COMMENTS-AREA.
  7344        16  FO-COMMENT-LINE-1        PIC X(78).
  7345
  7346    12  FILLER                       PIC X(20).
  7347
  7348    12  FO-MAINT-INFORMATION.
  7349        16  FO-LAST-MAINT-DT         PIC X(02).
  7350        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7351        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 136
* EL050.cbl
  7353*    COPY ELCMSTR.
  7354******************************************************************
  7355*                                                                *
  7356*                            ELCMSTR.                            *
  7357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7358*                            VMOD=2.012                          *
  7359*                                                                *
  7360*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7361*                                                                *
  7362*   FILE TYPE = VSAM,KSDS                                        *
  7363*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7364*                                                                *
  7365*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7366*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7367*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7368*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7369*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7370*                                                 RKP=75,LEN=21  *
  7371*                                                                *
  7372*   **** NOTE ****                                               *
  7373*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7374*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7375*                                                                *
  7376*   LOG = YES                                                    *
  7377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7378******************************************************************
  7379*                   C H A N G E   L O G
  7380*
  7381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7382*-----------------------------------------------------------------
  7383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7384* EFFECTIVE    NUMBER
  7385*-----------------------------------------------------------------
  7386* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7387* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7388* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7389* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7390* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7391******************************************************************
  7392 01  CLAIM-MASTER.
  7393     12  CL-RECORD-ID                PIC XX.
  7394         88  VALID-CL-ID         VALUE 'CL'.
  7395
  7396     12  CL-CONTROL-PRIMARY.
  7397         16  CL-COMPANY-CD           PIC X.
  7398         16  CL-CARRIER              PIC X.
  7399         16  CL-CLAIM-NO             PIC X(7).
  7400         16  CL-CERT-NO.
  7401             20  CL-CERT-PRIME       PIC X(10).
  7402             20  CL-CERT-SFX         PIC X.
  7403
  7404     12  CL-CONTROL-BY-NAME.
  7405         16  CL-COMPANY-CD-A1        PIC X.
  7406         16  CL-INSURED-LAST-NAME    PIC X(15).
  7407         16  CL-INSURED-NAME.
  7408             20  CL-INSURED-1ST-NAME PIC X(12).
  7409             20  CL-INSURED-MID-INIT PIC X.
  7410
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 137
* EL050.cbl
  7411     12  CL-CONTROL-BY-SSN.
  7412         16  CL-COMPANY-CD-A2        PIC X.
  7413         16  CL-SOC-SEC-NO.
  7414             20  CL-SSN-STATE        PIC XX.
  7415             20  CL-SSN-ACCOUNT      PIC X(6).
  7416             20  CL-SSN-LN3          PIC X(3).
  7417
  7418     12  CL-CONTROL-BY-CERT-NO.
  7419         16  CL-COMPANY-CD-A4        PIC X.
  7420         16  CL-CERT-NO-A4.
  7421             20  CL-CERT-A4-PRIME    PIC X(10).
  7422             20  CL-CERT-A4-SFX      PIC X.
  7423
  7424     12  CL-CONTROL-BY-CCN.
  7425         16  CL-COMPANY-CD-A5        PIC X.
  7426         16  CL-CCN-A5.
  7427             20  CL-CCN.
  7428                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7429                 24  CL-CCN-PRIME-A5 PIC X(12).
  7430             20  CL-CCN-FILLER-A5    PIC X(4).
  7431
  7432     12  CL-INSURED-PROFILE-DATA.
  7433         16  CL-INSURED-BIRTH-DT     PIC XX.
  7434         16  CL-INSURED-SEX-CD       PIC X.
  7435             88  INSURED-IS-MALE        VALUE 'M'.
  7436             88  INSURED-IS-FEMALE      VALUE 'F'.
  7437             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7438         16  CL-INSURED-OCC-CD       PIC X(6).
  7439         16  FILLER                  PIC X(5).
  7440
  7441     12  CL-PROCESSING-INFO.
  7442         16  CL-PROCESSOR-ID         PIC X(4).
  7443         16  CL-CLAIM-STATUS         PIC X.
  7444             88  CLAIM-IS-OPEN          VALUE 'O'.
  7445             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7446         16  CL-CLAIM-TYPE           PIC X.
  7447*            88  AH-CLAIM               VALUE 'A'.
  7448*            88  LIFE-CLAIM             VALUE 'L'.
  7449*            88  PROPERTY-CLAIM         VALUE 'P'.
  7450*            88  IUI-CLAIM              VALUE 'I'.
  7451*            88  GAP-CLAIM              VALUE 'G'.
  7452*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7453         16  CL-CLAIM-PREM-TYPE      PIC X.
  7454             88  SINGLE-PREMIUM         VALUE '1'.
  7455             88  O-B-COVERAGE           VALUE '2'.
  7456             88  OPEN-END-COVERAGE      VALUE '3'.
  7457         16  CL-INCURRED-DT          PIC XX.
  7458         16  CL-REPORTED-DT          PIC XX.
  7459         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7460         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7461         16  CL-LAST-PMT-DT          PIC XX.
  7462         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7463         16  CL-PAID-THRU-DT         PIC XX.
  7464         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7465         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7466         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7467         16  CL-PMT-CALC-METHOD      PIC X.
  7468             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 138
* EL050.cbl
  7469             88  CL-365-DAY-YR          VALUE '2'.
  7470             88  CL-FULL-MONTHS         VALUE '3'.
  7471         16  CL-CAUSE-CD             PIC X(6).
  7472
  7473         16  CL-PRIME-CERT-NO.
  7474             20  CL-PRIME-CERT-PRIME PIC X(10).
  7475             20  CL-PRIME-CERT-SFX   PIC X.
  7476
  7477         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7478             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7479             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7480
  7481         16  CL-MICROFILM-NO         PIC X(10).
  7482         16  FILLER REDEFINES CL-MICROFILM-NO.
  7483             20  CL-BENEFIT-PERIOD   PIC 99.
  7484             20  FILLER              PIC X(8).
  7485         16  CL-PROG-FORM-TYPE       PIC X.
  7486         16  CL-LAST-ADD-ON-DT       PIC XX.
  7487
  7488         16  CL-LAST-REOPEN-DT       PIC XX.
  7489         16  CL-LAST-CLOSE-DT        PIC XX.
  7490         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7491             88  FINAL-PAID             VALUE '1'.
  7492             88  CLAIM-DENIED           VALUE '2'.
  7493             88  AUTO-CLOSE             VALUE '3'.
  7494             88  MANUAL-CLOSE           VALUE '4'.
  7495             88  BENEFITS-CHANGED       VALUE 'C'.
  7496             88  SETUP-ERRORS           VALUE 'E'.
  7497         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7498         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7499         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7500             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7501         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7502         16  FILLER                  PIC X.
  7503
  7504     12  CL-CERTIFICATE-DATA.
  7505         16  CL-CERT-ORIGIN          PIC X.
  7506             88  CERT-WAS-ONLINE        VALUE '1'.
  7507             88  CERT-WAS-CREATED       VALUE '2'.
  7508             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7509         16  CL-CERT-KEY-DATA.
  7510             20  CL-CERT-CARRIER     PIC X.
  7511             20  CL-CERT-GROUPING    PIC X(6).
  7512             20  CL-CERT-STATE       PIC XX.
  7513             20  CL-CERT-ACCOUNT.
  7514                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7515                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7516             20  CL-CERT-EFF-DT      PIC XX.
  7517
  7518     12  CL-STATUS-CONTROLS.
  7519         16  CL-PRIORITY-CD          PIC X.
  7520             88  CONFIDENTIAL-DATA      VALUE '8'.
  7521             88  HIGHEST-PRIORITY       VALUE '9'.
  7522         16  CL-SUPV-ATTN-CD         PIC X.
  7523             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7524             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7525         16  CL-PURGED-DT            PIC XX.
  7526         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 139
* EL050.cbl
  7527         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7528         16  CL-NEXT-RESEND-DT       PIC XX.
  7529         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7530         16  CL-CRITICAL-PERIOD      PIC 99.
  7531*        16  FILLER                  PIC XX.
  7532         16  CL-LAST-MAINT-DT        PIC XX.
  7533         16  CL-LAST-MAINT-USER      PIC X(4).
  7534         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7535         16  CL-LAST-MAINT-TYPE      PIC X.
  7536             88  CLAIM-SET-UP           VALUE ' '.
  7537             88  PAYMENT-MADE           VALUE '1'.
  7538             88  LETTER-SENT            VALUE '2'.
  7539             88  MASTER-WAS-ALTERED     VALUE '3'.
  7540             88  MASTER-WAS-RESTORED    VALUE '4'.
  7541             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7542             88  FILE-CONVERTED         VALUE '6'.
  7543             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7544             88  ERROR-CORRECTION       VALUE 'E'.
  7545         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7546         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7547         16  CL-BENEFICIARY          PIC X(10).
  7548         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7549         16  CL-DENIAL-TYPE          PIC X.
  7550             88  CL-TYPE-DENIAL          VALUE '1'.
  7551             88  CL-TYPE-RESCISSION      VALUE '2'.
  7552             88  CL-TYPE-REFORMATION     VALUE '3'.
  7553             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7554             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7555         16  filler                  pic x(5).
  7556*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7557*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7558*        16  CL-RTW-DT               PIC XX.
  7559
  7560     12  CL-TRAILER-CONTROLS.
  7561         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7562             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7563             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7564             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7565         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7566         16  FILLER                  PIC XX.
  7567         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7568         16  CL-ADDRESS-TRAILER-CNT.
  7569             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7570                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7571             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7572                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7573             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7574                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7575             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7576                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7577             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7578                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7579             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7580                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7581             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7582                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7583
  7584     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 140
* EL050.cbl
  7585         16  CL-CV-REFNO-PRIME       PIC X(18).
  7586         16  CL-CV-REFNO-SFX         PIC XX.
  7587
  7588     12  CL-FILE-LOCATION            PIC X(4).
  7589
  7590     12  CL-PROCESS-ERRORS.
  7591         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7592             88  NO-FATAL-ERRORS        VALUE ZERO.
  7593         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7594             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7595
  7596     12  CL-PRODUCT-CD               PIC X.
  7597
  7598     12  CL-CURRENT-KEY-DATA.
  7599         16  CL-CURRENT-CARRIER      PIC X.
  7600         16  CL-CURRENT-GROUPING     PIC X(6).
  7601         16  CL-CURRENT-STATE        PIC XX.
  7602         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7603
  7604     12  CL-ASSOCIATES               PIC X.
  7605         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7606         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7607         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7608         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7609
  7610     12  CL-ACTIVITY-CODE            PIC 99.
  7611     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7612     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7613
  7614     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7615     12  CL-LAG-REPORT-CODE          PIC 9.
  7616     12  CL-LOAN-TYPE                PIC XX.
  7617     12  CL-LEGAL-STATE              PIC XX.
  7618
  7619     12  CL-YESNOSW                  PIC X.
  7620     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7621         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7622         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7623         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7624     12  cl-insured-type             pic x.
  7625         88  cl-claim-on-primary         value 'P'.
  7626         88  cl-claim-on-co-borrower     value 'C'.
  7627     12  cl-benefit-expiration-dt    PIC XX.
  7628
  7629 01  PLAN-RECORDS.
  7630     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7631     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7632
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 141
* EL050.cbl
  7634 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7635                          ACCOUNT-MASTER REINSURANCE-RECORD
  7636                          COMM-TABLE-RECORD FORM-MASTER
  7637                          CLAIM-MASTER PLAN-RECORDS.
  7638 0000-DFHEXIT SECTION.
  7639     MOVE '9#                    $   ' TO DFHEIV0.
  7640     MOVE 'EL050' TO DFHEIV1.
  7641     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7642
  7643     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7644
  7645
  7646* EXEC CICS  HANDLE CONDITION
  7647*           ERROR    (9300-ABEND)
  7648*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7649*    END-EXEC.
  7650*    MOVE '"$.J                  ! " #00007641' TO DFHEIV0
  7651     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7653     MOVE X'2220233030303037363431' TO DFHEIV0(25:11)
  7654     CALL 'kxdfhei1' USING DFHEIV0
  7655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7656
  7657
  7658 0000-COPY-PROCEDURE-DIV.
  7659*                          COPY ELC50PD.
  7660******************************************************************
  7661*                                                                *
  7662*                            ELC50PD                             *
  7663*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7664*                            VMOD=2.188                          *
  7665*                                                                *
  7666******************************************************************
  7667*                   C H A N G E   L O G
  7668*
  7669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7670*-----------------------------------------------------------------
  7671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7672* EFFECTIVE    NUMBER
  7673*-----------------------------------------------------------------
  7674* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7675* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7676* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7677*                             2709 AND 2718
  7678* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7679* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7680* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7681* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7682* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7683*                                IS OPEN OR CNC DT < PD THRU
  7684* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7685* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7686* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7687* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7688* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7689* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7690* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7691* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 142
* EL050.cbl
  7692* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7693* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7694* 020906                   PEMA  EXPAND LOAN OFFICER
  7695* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7696* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7697* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7698* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7699* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7700* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7701* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7702* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7703* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7704* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7705* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7706* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7707* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7708* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7709* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7710* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7711* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7712* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7713* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7714* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7715* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7716* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7717* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7718* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7719* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7720*                                UPDATE VIN ON CERT TRAILER
  7721* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7722* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7723* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7724* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7725* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7726* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7727* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7728* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7729* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7730* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7731* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7732* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7733* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7734* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7735* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7736* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7737* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7738* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7739* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7740* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7741* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7742* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7743* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7744* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7745* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7746* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7747* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7748* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7749* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 143
* EL050.cbl
  7750* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7751* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7752* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7753* 032912  CR2011110200001  PEMA  AHL CHANGES
  7754* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7755* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7756* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7757* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7758* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7759* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7760* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7761* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7762* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7763* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7764* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7765* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7766* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7767* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7768* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7769* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7770* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7771* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7772* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7773* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7774* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7775* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7776* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7777* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7778* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7779* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7780* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7781*                                CERT #, ADD 2898 FORCIBLE ERROR
  7782* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7783* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7784******************************************************************
  7785************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7786******************************************************************
  7787
  7788     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7789
  7790     MOVE SPACES                 TO PB-FATAL-FLAG
  7791                                    PB-FORCE-ER-CD
  7792                                    PB-WARN-ER-CD
  7793                                    PB-OUT-BAL-CD.
  7794
  7795     MOVE SPACE                  TO WS-IG-OVRD-AH
  7796                                    WS-IG-OVRD-LF
  7797                                    WS-IG-OVRD-AM
  7798                                    WS-IG-OVRD
  7799                                    WS-IG-OVRD-AH-PL
  7800                                    WS-IG-OVRD-LF-PL
  7801                                    WS-IG-OVRD-AH-BEN
  7802                                    WS-IG-OVRD-LF-BEN.
  7803
  7804******************************************************************
  7805*************       INITIALIZE COMMON ERRORS       ***************
  7806******************************************************************
  7807
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 144
* EL050.cbl
  7808     MOVE +0                     TO PB-NO-OF-ERRORS.
  7809     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7810
  7811******************************************************************
  7812
  7813     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7814     SET JULIAN-TO-BIN           TO TRUE.
  7815*    MOVE 5                      TO DC-OPTION-CODE.
  7816     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7817     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7818
  7819     MOVE ZERO                   TO  SUB4.
  7820
  7821 0040-INITIALIZE-GA-BILL-DT.
  7822
  7823     ADD +1                      TO  SUB4.
  7824
  7825     IF  SUB4 GREATER THAN +5
  7826         GO TO 0050-CHECK-CNTL-FOUND.
  7827
  7828     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7829         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7830
  7831     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7832
  7833 0050-CHECK-CNTL-FOUND.
  7834
  7835     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7836        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7837                                         WS-AH-REM-TERM-CALC
  7838                                         EC-CO-REM-TERM-CALC
  7839        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7840        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7841        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7842                                         WS-TOL-AH-CLAIM
  7843        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7844                                         WS-TOL-AH-PREM
  7845                                         EC-CO-TOL-PREM
  7846        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7847                                         WS-TOL-AH-REFUND
  7848                                         EC-CO-TOL-REFUND
  7849        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7850                                         WS-AH-REFUND-OVS-AMT
  7851                                         EC-CO-OVR-SHT-AMT
  7852        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7853                                         WS-TOL-AH-PREM-PCT
  7854                                         EC-CO-TOL-PREM-PCT
  7855        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7856                                         WS-TOL-AH-REFUND-PCT
  7857                                         EC-CO-TOL-REFUND-PCT
  7858        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7859                                         WS-AH-REFUND-OVS-PCT
  7860                                         EC-CO-OVR-SHT-PCT
  7861        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7862        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7863        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7864        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7865        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 145
* EL050.cbl
  7866        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7867        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7868        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7869        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7870        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7871        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7872        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7873                                         EC-CO-MONTH-END-DT
  7874        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7875          GO TO 0100-READ-ACCT.
  7876
  7877     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7878     MOVE SPACES                 TO CNTL-ACCESS.
  7879     MOVE '1'                    TO CNTL-REC-TYPE.
  7880     MOVE +0                     TO CNTL-SEQ-NO.
  7881
  7882     MOVE '1' TO RC-SW-1.
  7883     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7884     IF NOT CF-COMPANY-MASTER
  7885         MOVE ZEROS             TO WK-CO-TOL-PREM
  7886                                   WK-CO-TOL-CLAIM
  7887                                   WK-CO-TOL-REFUND
  7888                                   WK-REFUND-OVS-AMT
  7889                                   WK-REFUND-OVS-PCT
  7890                                   WK-CO-TOL-PREM-PCT
  7891                                   WK-CO-TOL-REFUND-PCT
  7892                                   WK-DEFAULT-APR
  7893                                   WK-CO-MAX-CAP
  7894        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7895                                   WK-CR-R78-METHOD
  7896                                   WK-CO-REF-REJECT-SW
  7897                                   WK-CO-PREM-REJECT-SW
  7898                                   WK-REM-TRM-CALC-OPTION
  7899                                   WK-BIRTH-DATE-INPUT
  7900                                   WK-JOINT-AGE-INPUT
  7901        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7902        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7903        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7904        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7905          GO TO 0099-COMPANY-NOT-FOUND.
  7906
  7907     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7908        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7909     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7910        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7911     IF CF-CO-TOL-CAP NOT NUMERIC
  7912        MOVE +0                    TO CF-CO-TOL-CAP.
  7913     IF CF-DEFAULT-APR NOT NUMERIC
  7914        MOVE +0                    TO CF-DEFAULT-APR.
  7915
  7916     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7917     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7918     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7919     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7920     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7921     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7922     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7923     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 146
* EL050.cbl
  7924     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7925     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7926     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7927     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7928
  7929     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7930          CF-CO-OVR-SHT-AMT > +0
  7931        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7932
  7933     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7934          CF-CO-OVR-SHT-PCT > +0
  7935        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7936
  7937     IF CF-VALID-REM-TRM-OPTION
  7938         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7939     ELSE
  7940         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7941
  7942     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7943     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7944     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7945     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7946
  7947     GO TO 0050-CHECK-CNTL-FOUND.
  7948
  7949 0099-COMPANY-NOT-FOUND.
  7950
  7951     MOVE ER-2616                TO WS-ERROR.
  7952     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7953
  7954 0100-READ-ACCT.
  7955
  7956     MOVE SPACES                 TO DATE-RANGE-SW.
  7957
  7958     IF WK-ACCT-ADDR = ZEROS
  7959        GO TO 0102-ACCT-GETMAIN.
  7960
  7961     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7962     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7963     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7964
  7965     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7966        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7967        GO TO 0105-READ-ACCT
  7968     END-IF
  7969
  7970     IF PB-CARRIER NOT = SPACES
  7971        IF PB-CARRIER NOT = AM-VG-CARRIER
  7972           GO TO 0105-READ-ACCT.
  7973
  7974     IF PB-STATE NOT = SPACES
  7975        IF PB-STATE NOT = AM-VG-STATE
  7976           GO TO 0105-READ-ACCT.
  7977
  7978     IF PB-GROUPING NOT = SPACES
  7979        IF PB-GROUPING NOT = AM-VG-GROUPING
  7980           GO TO 0105-READ-ACCT.
  7981
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 147
* EL050.cbl
  7982     MOVE 'X'                 TO DATE-RANGE-SW.
  7983
  7984     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7985        MOVE 'X'                 TO DATE-RANGE-SW
  7986        GO TO 0105-READ-ACCT.
  7987
  7988     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7989        GO TO 0105-READ-ACCT.
  7990
  7991     GO TO 0180-ACCOUNT-FOUND.
  7992
  7993 0102-ACCT-GETMAIN.
  7994     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7995     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7996
  7997 0105-READ-ACCT.
  7998     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7999     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8000     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8001     MOVE PB-STATE               TO ACCT-STATE.
  8002     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8003     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8004
  8005     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8006
  8007     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8008
  8009 0110-FIND-ACCT-TOLERANCES-LOOP.
  8010     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8011
  8012     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8013        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8014        GO TO 0199-ACCT-NOT-FOUND
  8015     END-IF
  8016     IF PB-CARRIER NOT = SPACES
  8017        IF PB-CARRIER NOT = AM-VG-CARRIER
  8018           GO TO 0199-ACCT-NOT-FOUND.
  8019
  8020     IF PB-STATE NOT = SPACES
  8021        IF PB-STATE NOT = AM-VG-STATE
  8022           GO TO 0199-ACCT-NOT-FOUND.
  8023
  8024     IF PB-GROUPING NOT = SPACES
  8025        IF PB-GROUPING NOT = AM-VG-GROUPING
  8026           GO TO 0199-ACCT-NOT-FOUND.
  8027
  8028     MOVE 'X'                    TO DATE-RANGE-SW.
  8029
  8030     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8031        MOVE 'X'                 TO DATE-RANGE-SW
  8032        GO TO 0199-ACCT-NOT-FOUND.
  8033
  8034     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8035        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8036
  8037 0180-ACCOUNT-FOUND.
  8038     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8039     MOVE AM-CARRIER             TO PB-SV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 148
* EL050.cbl
  8040     MOVE AM-STATE               TO PB-SV-STATE.
  8041     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8042
  8043     IF AM-CANCEL-FEE  NOT NUMERIC
  8044        MOVE ZEROS TO AM-CANCEL-FEE.
  8045
  8046     IF AM-MAX-MON-BEN NOT NUMERIC
  8047        MOVE ZEROS TO AM-MAX-MON-BEN.
  8048
  8049     IF AM-MAX-TOT-BEN NOT NUMERIC
  8050        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8051
  8052     IF AM-CLP-TOL-PCT NOT NUMERIC
  8053        MOVE +0                  TO AM-CLP-TOL-PCT
  8054     END-IF
  8055     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8056        MOVE +0                  TO AM-SPP-LEASE-COMM
  8057     END-IF
  8058     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8059        MOVE ER-2611             TO   WS-ERROR
  8060        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8061
  8062     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8063        MOVE ER-2621             TO   WS-ERROR
  8064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8065
  8066     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8067        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8068        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8069        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8070         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8071
  8072     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8073     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8074     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8075     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8076     IF AM-CLP-TOL-PCT NOT = ZEROS
  8077        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8078     END-IF
  8079     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8080        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8081     END-IF
  8082*    IF PB-COMPANY-ID = 'DCC'
  8083*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8084*                                   WS-ADMIN-FEES
  8085*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8086*          (SUB5 > +10)
  8087*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8088*             AND (AM-A-COM (SUB5) NUMERIC)
  8089*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8090*                + (AM-A-COM (SUB5) * 1000)
  8091*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8092*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8093*                + (AM-A-COM (SUB5) * 1000)
  8094*             END-IF
  8095*             IF AM-COM-TYP (SUB5) = 'N'
  8096*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8097*                + (AM-A-COM (SUB5) * 1000)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 149
* EL050.cbl
  8098*             END-IF
  8099*          END-IF
  8100*       END-PERFORM
  8101*    END-IF
  8102     IF (PB-COMPANY-ID = 'DCC')
  8103        AND (PB-ISSUE)
  8104        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8105                                    ws-cred-union-fees
  8106        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8107           (SUB5 > +10)
  8108           MOVE +0 TO WS-WK-RATE
  8109           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8110                                   'O' OR 'S')
  8111              IF (AM-A-COM (SUB5) NUMERIC)
  8112                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8113                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8114              ELSE
  8115                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8116                 IF PB-ISSUE
  8117                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8118                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8119                 ELSE
  8120                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8121                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8122                 END-IF
  8123                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8124                 MOVE ZEROS             TO WS-SUB1
  8125                                           WS-COMMISSION
  8126                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8127                 MOVE '0530'               TO CTBL-SW
  8128                 MOVE ' '                  TO WS-CTBL-READ-SW
  8129                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8130                 IF FIRST-TIME-THROUGH
  8131                    MOVE 'AA'              TO CTBL-BEN-CODE
  8132                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8133                 END-IF
  8134                 IF CTBL-TABLE-FOUND
  8135                    IF PB-ISSUE
  8136                       COMPUTE WS-COMM-CK-AMT =
  8137                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8138                    ELSE
  8139                       COMPUTE WS-COMM-CK-AMT =
  8140                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8141                    END-IF
  8142                    PERFORM 8800-GET-COMP-RATE
  8143                              THRU 8800-EXIT
  8144                 END-IF
  8145              END-IF
  8146              if am-com-typ (sub5) = 'O' or 'S'
  8147                 compute ws-cred-union-fees rounded =
  8148                    ws-cred-union-fees +
  8149                    (pb-i-ah-premium-amt * ws-wk-rate)
  8150              else
  8151                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8152                + (WS-WK-RATE * 1000)
  8153              end-if
  8154           END-IF
  8155        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 150
* EL050.cbl
  8156     END-IF
  8157     IF PB-COMPANY-ID EQUAL 'CRI'
  8158         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8159
  8160     IF PB-COMPANY-ID EQUAL 'NCL'
  8161         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8162     END-IF
  8163
  8164     GO TO 0200-READ-CERT.
  8165
  8166 0199-ACCT-NOT-FOUND.
  8167
  8168     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8169
  8170     IF DATE-RANGE-SW NOT = SPACES
  8171        MOVE ER-2601             TO WS-ERROR
  8172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8173     ELSE
  8174        MOVE ER-2619             TO WS-ERROR
  8175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8176
  8177     GO TO 9990-RETURN.
  8178
  8179 0200-READ-CERT.
  8180
  8181     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8182     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8183     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8184     MOVE PB-SV-STATE            TO CERT-STATE.
  8185     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8186     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8187     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8188
  8189     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8190
  8191     IF CERT-WAS-NOT-FOUND
  8192        GO TO 0299-CERT-NOT-FOUND.
  8193
  8194     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8195        MOVE ER-2759             TO WS-ERROR
  8196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8197        GO TO 0298-UNLOCK-RETURN.
  8198
  8199     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8200         MOVE ER-2758            TO WS-ERROR
  8201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8202         GO TO 0298-UNLOCK-RETURN.
  8203
  8204     IF PB-ISSUE
  8205        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8206           IF CERT-WAS-CREATED-FOR-CLAIM
  8207              NEXT SENTENCE
  8208            ELSE
  8209              MOVE ER-2626       TO WS-ERROR
  8210              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8211              GO TO 0298-UNLOCK-RETURN.
  8212
  8213     IF NOT PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 151
* EL050.cbl
  8214        GO TO 0300-CONTINUE-EDIT.
  8215
  8216     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8217     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8218     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8219     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8220     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8221     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8222
  8223     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8224     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8225     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8226     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8227     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8228     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8229     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8230     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8231     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8232
  8233     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8234     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8235     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8236     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8237     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8238     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8239     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8240
  8241     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8242     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8243
  8244     MOVE CM-CREDIT-INTERFACE-SW-1
  8245                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8246     MOVE CM-CREDIT-INTERFACE-SW-2
  8247                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8248
  8249     IF CM-O-B-COVERAGE
  8250         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8251
  8252     IF CM-LIVES NOT NUMERIC
  8253         MOVE ZERO                TO CM-LIVES.
  8254
  8255     IF CM-BILLED NOT NUMERIC
  8256         MOVE ZERO                TO CM-BILLED.
  8257
  8258     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8259         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8260         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8261         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8262         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8263         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8264         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8265         MOVE CM-LIVES             TO PB-CI-LIVES
  8266*The next line causes a problem with my change  I dont think it is
  8267*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8268
  8269     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8270     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8271     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 152
* EL050.cbl
  8272     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8273     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8274     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8275
  8276     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8277     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8278     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8279     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8280
  8281     IF CM-LIFE-COMM-PCT NUMERIC
  8282         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8283     ELSE
  8284         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8285
  8286     IF CM-AH-COMM-PCT NUMERIC
  8287         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8288     ELSE
  8289         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8290
  8291     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8292
  8293     IF CM-LOAN-APR       NOT NUMERIC
  8294           MOVE ZERO               TO CM-LOAN-APR.
  8295
  8296     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8297           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8298
  8299     IF CM-LOAN-TERM      NOT NUMERIC
  8300           MOVE ZERO               TO CM-LOAN-TERM.
  8301
  8302     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8303           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8304
  8305     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8306           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8307
  8308     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8309     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8310     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8311     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8312     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8313     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8314     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8315     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8316     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8317     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8318     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8319     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8320
  8321     IF CM-STATE = CM-SSN-STATE
  8322         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8323
  8324     IF CM-STATE NOT = CM-MEMB-STATE
  8325         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8326
  8327     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8328
  8329     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 153
* EL050.cbl
  8330        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8331        IF CM-ADDL-CLP NOT NUMERIC
  8332           MOVE +0               TO CM-ADDL-CLP
  8333        END-IF
  8334        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8335        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8336           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8337        END-IF
  8338     END-IF
  8339     IF PB-COMPANY-ID = 'DCC'
  8340        MOVE +0                  TO WS-ADMIN-FEES
  8341                                    WS-CSO-ADMIN-FEE
  8342                                    WS-COMM-AND-MFEE
  8343                                    WS-1ST-YR-ALLOW
  8344        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8345           (SUB5 > +10)
  8346           MOVE +0 TO WS-WK-RATE
  8347           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8348              IF (AM-A-COM (SUB5) NUMERIC)
  8349                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8350                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8351              ELSE
  8352                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8353                 IF PB-ISSUE
  8354                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8355                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8356                 ELSE
  8357                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8358                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8359                 END-IF
  8360                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8361                 MOVE ZEROS             TO WS-SUB1
  8362                                           WS-COMMISSION
  8363                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8364                 MOVE '0530'               TO CTBL-SW
  8365                 MOVE ' '                  TO WS-CTBL-READ-SW
  8366                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8367                 IF FIRST-TIME-THROUGH
  8368                    MOVE 'AA'              TO CTBL-BEN-CODE
  8369                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8370                 END-IF
  8371                 IF CTBL-TABLE-FOUND
  8372                    IF PB-ISSUE
  8373                       COMPUTE WS-COMM-CK-AMT =
  8374                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8375                    ELSE
  8376                       COMPUTE WS-COMM-CK-AMT =
  8377                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8378                    END-IF
  8379                    PERFORM 8800-GET-COMP-RATE
  8380                              THRU 8800-EXIT
  8381                 END-IF
  8382              END-IF
  8383              IF AM-COM-TYP (SUB5) = 'I'
  8384                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8385                   + (WS-WK-RATE * 1000)
  8386              END-IF
  8387              IF AM-COM-TYP (SUB5) = 'N'
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 154
* EL050.cbl
  8388                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8389                   + (WS-WK-RATE * 1000)
  8390              END-IF
  8391              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8392                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8393                   + (WS-WK-RATE * 1000)
  8394              END-IF
  8395              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8396                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8397                   + (WS-WK-RATE * 1000)
  8398              END-IF
  8399           END-IF
  8400        END-PERFORM
  8401     END-IF
  8402     GO TO 0300-CONTINUE-EDIT.
  8403
  8404 0298-UNLOCK-RETURN.
  8405      PERFORM 9250-UNLOCK-RETURN
  8406      GO TO 9990-RETURN.
  8407
  8408 0299-CERT-NOT-FOUND.
  8409
  8410     MOVE '1'                     TO CERT-STATUS-SW.
  8411
  8412     IF PB-COMPANY-ID = 'UCL'
  8413         IF WS-ERROR = ER-2799
  8414             GO TO 3000-CONTINUE-EDIT.
  8415
  8416     IF NOT PB-CANCELLATION
  8417         GO TO 0300-CONTINUE-EDIT.
  8418
  8419     MOVE ER-2726                  TO  WS-ERROR.
  8420     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8421     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8422     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8423                                    PB-CI-LF-TERM
  8424                                    PB-C-LF-REM-TERM
  8425                                    PB-CI-AH-TERM
  8426                                    PB-C-AH-REM-TERM
  8427                                    PB-CI-LF-BENEFIT-CD
  8428                                    PB-CI-LF-BENEFIT-AMT
  8429                                    PB-CI-LF-ALT-BENEFIT-AMT
  8430                                    PB-CI-LF-PREMIUM-AMT
  8431                                    PB-CI-LF-ALT-PREMIUM-AMT
  8432                                    PB-CI-AH-BENEFIT-CD
  8433                                    PB-CI-AH-BENEFIT-AMT
  8434                                    PB-CI-AH-PREMIUM-AMT
  8435                                    PB-CI-PAY-FREQUENCY
  8436                                    PB-CI-LOAN-APR
  8437                                    PB-CI-LOAN-TERM
  8438                                    PB-CI-LIFE-COMMISSION
  8439                                    PB-CI-AH-COMMISSION
  8440                                    PB-CI-CURR-SEQ
  8441                                    PB-CI-AH-CANCEL-AMT
  8442                                    PB-CI-LF-CANCEL-AMT
  8443                                    PB-CI-RATE-DEV-PCT-LF
  8444                                    PB-CI-RATE-DEV-PCT-AH
  8445                                    PB-CI-EXTENTION-DAYS
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 155
* EL050.cbl
  8446                                    PB-CI-TERM-IN-DAYS
  8447                                    PB-CI-LIVES
  8448                                    PB-CI-LF-CRIT-PER
  8449                                    PB-CI-AH-CRIT-PER
  8450                                    PB-CI-ADDL-CLP
  8451                                    PB-CI-DDF-IU-RATE-UP.
  8452
  8453     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8454                                    PB-CI-AH-SETTLEMENT-DT
  8455                                    PB-CI-DEATH-DT
  8456                                    PB-CI-LF-PRIOR-CANCEL-DT
  8457                                    PB-CI-AH-PRIOR-CANCEL-DT
  8458                                    PB-CI-ENTRY-DT
  8459                                    PB-CI-LF-EXPIRE-DT
  8460                                    PB-CI-AH-EXPIRE-DT
  8461                                    PB-CI-LOAN-1ST-PMT-DT.
  8462
  8463     IF ACCOUNT-MAST-FOUND
  8464        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8465        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8466
  8467
  8468 0300-CONTINUE-EDIT.
  8469
  8470     IF PB-ISSUE
  8471        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8472            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8473
  8474     IF PB-ISSUE
  8475        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8476            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8477
  8478     IF PB-ISSUE
  8479       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8480          (AM-NO-AH-ONLY)
  8481           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8482               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8483                   MOVE ER-2679 TO WS-ERROR
  8484                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8485
  8486     IF PB-ISSUE
  8487        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8488        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8489        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8490     ELSE
  8491        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8492        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8493        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8494
  8495     MOVE 'N'                    TO PLAN-MASTER-SW
  8496                                    PLAN-MASTER-LIFE-SW
  8497                                    FORM-MASTER-SW
  8498                                    WS-APP-CERT-SW.
  8499
  8500     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8501                                    WS-PL-TOL-LF-REFUND
  8502                                    WS-PL-REF-OVS-AMT
  8503                                    WS-PL-TOL-LF-PREM-PCT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 156
* EL050.cbl
  8504                                    WS-PL-TOL-LF-REFUND-PCT
  8505                                    WS-PL-REF-OVS-PCT
  8506                                    WS-PL-TOL-LF-CLAIM.
  8507
  8508     IF PB-COMPANY-ID = 'NCL'
  8509       IF PB-ISSUE
  8510         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8511             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8512             IF FORM-MASTER-FOUND
  8513                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8514
  8515     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8516        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8517
  8518********************** MON CODE **********************
  8519     IF PB-COMPANY-ID = 'MON'
  8520     IF PB-ISSUE
  8521     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8522        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8523             PB-I-LOAN-APR = ZERO)
  8524               MOVE 14.0         TO PB-I-LOAN-APR.
  8525******************************************************
  8526
  8527     IF PB-COMPANY-ID = 'NCL'
  8528       IF PB-ISSUE
  8529           IF FORM-MASTER-FOUND
  8530             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8531                AM-DISMBR-COVERAGE
  8532                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8533                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8534                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8535                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8536                                           PB-I-LIFE-BENEFIT-CD.
  8537
  8538     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8539
  8540     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8541         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8542         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8543         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8544         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8545         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8546           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8547             GO TO 0301-LIFE-BENEFIT-SEARCH
  8548         ELSE
  8549             NEXT SENTENCE
  8550     ELSE
  8551         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8552
  8553     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8554     MOVE '4'                    TO CNTL-REC-TYPE.
  8555     MOVE +0                     TO CNTL-SEQ-NO.
  8556     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8557
  8558     MOVE '1' TO RC-SW-2.
  8559     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8560
  8561     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 157
* EL050.cbl
  8562        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8563         GO TO 0305-BENEFIT-NOT-FOUND.
  8564
  8565     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8566
  8567 0301-LIFE-BENEFIT-SEARCH.
  8568
  8569     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8570
  8571     IF NO-BENEFIT-FOUND
  8572        GO TO 0305-BENEFIT-NOT-FOUND.
  8573
  8574     IF WS-BEN-CD = '99'
  8575        GO TO 0305-BENEFIT-NOT-FOUND.
  8576
  8577     IF PB-COMPANY-ID = 'NCL'
  8578         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8579             GO TO 0304-LIFE-BENEFIT-FOUND.
  8580
  8581     MOVE +1                     TO SUB5.
  8582     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8583
  8584* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8585* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8586     IF PB-COMPANY-ID = 'DMD'
  8587         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8588
  8589 0302-EDIT-ACCT-LF-BENEFITS.
  8590
  8591     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8592        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8593           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8594                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8595           GO TO 03XX-GET-LIFE-ERPLAN.
  8596
  8597     IF SUB5 LESS THAN +20
  8598        ADD +1                   TO SUB5
  8599        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8600
  8601     MOVE +1                     TO SUB5.
  8602
  8603     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8604        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8605
  8606 0303-EDIT-DMD-EXTRA-BENEFITS.
  8607
  8608     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8609        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8610           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8611                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8612           GO TO 03XX-GET-LIFE-ERPLAN.
  8613
  8614     IF SUB5 LESS THAN +30
  8615        ADD +1                   TO SUB5
  8616        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8617
  8618     MOVE +1                     TO SUB5.
  8619
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 158
* EL050.cbl
  8620 03XX-EDIT-FOR-NINETY-LF.
  8621
  8622***************************************************************
  8623*                                                             *
  8624*    NINETY BENEFIT PLAN TYPES:                               *
  8625*                                                             *
  8626*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8627*      92 = ALL GROUP REDUCING BENEFITS                       *
  8628*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8629*      94 = ALL GROUP LEVEL BENEFITS                          *
  8630*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8631*           BENEFIT CONTROLS.                                 *
  8632*      99 = ALL BENEFITS                                      *
  8633*                                                             *
  8634***************************************************************
  8635
  8636     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8637                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8638
  8639     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8640       AND
  8641        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8642        GO TO 03XX-GET-LIFE-ERPLAN.
  8643
  8644     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8645       AND
  8646        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8647        IF CF-REDUCING (SUB3)
  8648           IF (PB-I-INDV-GRP-OVRD = 'I')
  8649              OR
  8650           ((AM-IG = '1') AND
  8651           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8652              OR
  8653           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8654           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8655           (AM-IG NOT = '2'))
  8656              GO TO 03XX-GET-LIFE-ERPLAN.
  8657
  8658     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8659       AND
  8660        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8661        IF CF-REDUCING (SUB3)
  8662           IF (PB-I-INDV-GRP-OVRD = 'G')
  8663              OR
  8664           ((AM-IG = '2') AND
  8665           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8666              OR
  8667           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8668           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8669           (AM-IG NOT = '1'))
  8670              GO TO 03XX-GET-LIFE-ERPLAN.
  8671
  8672     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8673       AND
  8674        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8675        IF CF-LEVEL    (SUB3)
  8676           IF (PB-I-INDV-GRP-OVRD = 'I')
  8677              OR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 159
* EL050.cbl
  8678           ((AM-IG = '1') AND
  8679           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8680              OR
  8681           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8682           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8683            (AM-IG NOT = '2'))
  8684              GO TO 03XX-GET-LIFE-ERPLAN.
  8685
  8686     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8687       AND
  8688        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8689        IF CF-LEVEL    (SUB3)
  8690           IF (PB-I-INDV-GRP-OVRD = 'G')
  8691              OR
  8692           ((AM-IG = '2') AND
  8693           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8694              OR
  8695           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8696           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8697           (AM-IG NOT = '1'))
  8698              GO TO 03XX-GET-LIFE-ERPLAN.
  8699
  8700     IF SUB5 LESS THAN +20
  8701        ADD +1                   TO SUB5
  8702        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8703
  8704     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8705
  8706     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8707        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8708
  8709     MOVE +1                     TO SUB5.
  8710
  8711 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8712
  8713     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8714                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8715
  8716     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8717       AND
  8718        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8719        GO TO 03XX-GET-LIFE-ERPLAN.
  8720
  8721     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8722       AND
  8723        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8724        IF CF-REDUCING (SUB3)
  8725           IF (PB-I-INDV-GRP-OVRD = 'I')
  8726              OR
  8727           ((AM-IG = '1') AND
  8728           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8729              OR
  8730           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8731           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8732           (AM-IG NOT = '2'))
  8733              GO TO 03XX-GET-LIFE-ERPLAN.
  8734
  8735     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 160
* EL050.cbl
  8736       AND
  8737        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8738        IF CF-REDUCING (SUB3)
  8739           IF (PB-I-INDV-GRP-OVRD = 'G')
  8740              OR
  8741           ((AM-IG = '2') AND
  8742           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8743              OR
  8744           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8745           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8746           (AM-IG NOT = '1'))
  8747              GO TO 03XX-GET-LIFE-ERPLAN.
  8748
  8749     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8750       AND
  8751        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8752        IF CF-LEVEL    (SUB3)
  8753           IF (PB-I-INDV-GRP-OVRD = 'I')
  8754              OR
  8755           ((AM-IG = '1') AND
  8756           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8757              OR
  8758           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8759           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8760            (AM-IG NOT = '2'))
  8761              GO TO 03XX-GET-LIFE-ERPLAN.
  8762
  8763     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8764       AND
  8765        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8766        IF CF-LEVEL    (SUB3)
  8767           IF (PB-I-INDV-GRP-OVRD = 'G')
  8768              OR
  8769           ((AM-IG = '2') AND
  8770           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8771              OR
  8772           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8773           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8774           (AM-IG NOT = '1'))
  8775              GO TO 03XX-GET-LIFE-ERPLAN.
  8776
  8777     IF SUB5 LESS THAN +30
  8778        ADD +1                   TO SUB5
  8779        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8780
  8781     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8782
  8783 03XX-EDIT-FOR-NINETY-LF-CONT.
  8784
  8785     MOVE +99                    TO SUB5.
  8786
  8787     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8788        IF PB-ISSUE
  8789           MOVE ER-1924          TO  WS-ERROR
  8790           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8791
  8792     GO TO 0304-LIFE-BENEFIT-FOUND.
  8793
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 161
* EL050.cbl
  8794 03XX-GET-LIFE-ERPLAN.
  8795
  8796     IF WK-PLAN-ADDR EQUAL +0
  8797        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8798
  8799     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8800     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8801     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8802     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8803     MOVE 'Y'                    TO PLAN-MASTER-SW
  8804                                    PLAN-MASTER-LIFE-SW.
  8805     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8806
  8807 03XX-ERPLAN-LIFE-GETMAIN.
  8808
  8809     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8810     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8811
  8812 03XX-ERPLAN-LIFE-READ.
  8813
  8814     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8815     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8816     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8817     MOVE PB-SV-STATE            TO PLAN-STATE.
  8818     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8819     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8820     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8821     MOVE WS-SAVE-BENEFIT-REVISION
  8822                                 TO PLAN-REVISION-NO.
  8823
  8824     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8825     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8826
  8827     IF PB-COMPANY-ID = 'NCL'
  8828       IF NOT LF-PLAN-MASTER-FOUND
  8829         IF NOT PB-POLICY-IS-DECLINED  AND
  8830            NOT PB-POLICY-IS-VOIDED
  8831             MOVE  ER-1921         TO  WS-ERROR
  8832             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8833             GO TO 0304-LIFE-BENEFIT-FOUND.
  8834
  8835     IF NOT LF-PLAN-MASTER-FOUND
  8836        GO TO 0304-LIFE-BENEFIT-FOUND.
  8837
  8838 XXXX-CHECK-LF-PLAN-KEY.
  8839
  8840     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8841        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8842        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8843        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8844        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8845        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8846        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8847        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8848        MOVE 'N'                 TO PLAN-MASTER-SW
  8849          GO TO 03XX-ERPLAN-LIFE-READ.
  8850
  8851     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 162
* EL050.cbl
  8852
  8853     IF  PB-CANCELLATION
  8854         GO TO  0303-LF-ACCT-BEN-FOUND.
  8855
  8856     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8857        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8858           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8859           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8860              MOVE ER-2644             TO WS-ERROR
  8861              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8862           ELSE
  8863              NEXT SENTENCE
  8864        ELSE
  8865           IF PB-COMPANY-ID NOT = 'NCL'
  8866              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8867                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8868
  8869 0303-LF-ACCT-BEN-FOUND.
  8870
  8871     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8872
  8873     IF PL-DEV-CODE NOT = SPACES
  8874        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8875
  8876     IF PL-DEV-PCT NUMERIC AND
  8877        PL-DEV-PCT NOT = ZEROS
  8878        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8879
  8880     IF PL-TOL-PREM-AMT GREATER THAN +0
  8881        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8882
  8883     IF PL-TOL-REF-AMT GREATER THAN +0
  8884        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8885
  8886     IF PL-TOL-PREM-PCT GREATER THAN +0
  8887        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8888
  8889     IF PL-TOL-REF-PCT GREATER THAN +0
  8890        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8891
  8892     IF PL-TOL-CLM-AMT GREATER THAN +0
  8893        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8894
  8895     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8896                          PL-OVER-SHORT-AMT > +0
  8897        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8898
  8899     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8900                          PL-OVER-SHORT-PCT > +0
  8901        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8902
  8903     IF PL-SALES-TAX NUMERIC AND
  8904                          PL-SALES-TAX > +0
  8905         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8906
  8907     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8908        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8909                                    WS-IG-OVRD-AM.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 163
* EL050.cbl
  8910
  8911 0304-LIFE-BENEFIT-FOUND.
  8912
  8913     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8914
  8915     IF PB-ISSUE
  8916        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8917     ELSE
  8918        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8919
  8920     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8921     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8922     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8923     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8924     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8925                                         WS-LF-REFUND-CALC.
  8926     if (ws-lf-earnings-calc = '5')
  8927        and (pb-i-loan-apr = zeros)
  8928        and (benefit-code-chg)
  8929        move +99.9999 to pb-i-loan-apr
  8930     end-if
  8931
  8932     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8933        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8934
  8935     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8936        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8937     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8938
  8939     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8940     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8941     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8942     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8943     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8944     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8945
  8946     IF PB-COMPANY-ID = 'NCL'  AND
  8947        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8948         NEXT SENTENCE
  8949     ELSE
  8950         IF SUB5 NOT GREATER THAN +20
  8951            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8952               MOVE WS-SAVE-BENEFIT-REM-TERM
  8953                                      TO WS-AM-LF-BENE-REM-TERM
  8954                                         EC-BR-LF-REM-TERM-CALC.
  8955
  8956     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8957     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8958
  8959     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8960
  8961 0305-BENEFIT-NOT-FOUND.
  8962
  8963     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8964     MOVE ER-2604                TO WS-ERROR.
  8965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8966
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 164
* EL050.cbl
  8968
  8969 0310-FIND-AH-BENEFIT-RECORD.
  8970
  8971     MOVE 'N'                    TO PLAN-MASTER-SW
  8972                                    PLAN-MASTER-AH-SW.
  8973
  8974     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8975                                    WS-PL-TOL-AH-REFUND
  8976                                    WS-AH-PL-REF-OVS-AMT
  8977                                    WS-PL-TOL-AH-PREM-PCT
  8978                                    WS-PL-TOL-AH-REFUND-PCT
  8979                                    WS-AH-PL-REF-OVS-PCT
  8980                                    WS-PL-TOL-AH-CLAIM.
  8981     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8982
  8983
  8984     if pb-issue
  8985        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8986           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8987        end-if
  8988        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8989           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8990           GO TO 0399-BENEFIT-NOT-FOUND
  8991        end-if
  8992     end-if
  8993
  8994     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8995        GO TO 0400-FIND-CARRIER.
  8996
  8997     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8998
  8999     IF WK-AH-BEN-ADDR NOT = ZEROS
  9000         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9001         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9002         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9003         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9004           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9005             GO TO 0311-AH-BENEFIT-SEARCH
  9006         ELSE
  9007             NEXT SENTENCE
  9008     ELSE
  9009         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9010
  9011     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9012     MOVE '5'                    TO CNTL-REC-TYPE.
  9013     MOVE +0                     TO CNTL-SEQ-NO.
  9014     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9015
  9016     MOVE '2' TO RC-SW-2.
  9017     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9018
  9019     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9020        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9021          GO TO 0399-BENEFIT-NOT-FOUND.
  9022
  9023     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9024
  9025 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 165
* EL050.cbl
  9026
  9027     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9028
  9029     IF NO-BENEFIT-FOUND
  9030         GO TO 0399-BENEFIT-NOT-FOUND.
  9031
  9032     IF WS-BEN-CD = '99'
  9033        GO TO 0399-BENEFIT-NOT-FOUND.
  9034
  9035     IF PB-COMPANY-ID  =  'NCL'
  9036         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9037             GO TO 0314-A-H-BENEFIT-FOUND.
  9038
  9039     MOVE +1                     TO SUB5.
  9040     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9041
  9042* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9043* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9044     IF PB-COMPANY-ID = 'DMD'
  9045         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9046
  9047 0312-EDIT-ACCT-AH-BENEFITS.
  9048
  9049     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9050        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9051           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9052                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9053           GO TO 03XX-GET-AH-ERPLAN.
  9054
  9055     IF SUB5 LESS THAN +20
  9056        ADD +1                   TO SUB5
  9057        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9058
  9059     MOVE +1                     TO SUB5.
  9060
  9061     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9062        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9063
  9064 0313-EDIT-DMD-EXTRA-BENEFITS.
  9065
  9066     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9067        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9068           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9069                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9070           GO TO 03XX-GET-AH-ERPLAN.
  9071
  9072     IF SUB5 LESS THAN +30
  9073        ADD +1                   TO SUB5
  9074        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9075
  9076     MOVE +1                     TO SUB5.
  9077
  9078 03XX-EDIT-FOR-NINETY-AH.
  9079
  9080***************************************************************
  9081*                                                             *
  9082*    NINETY BENEFIT PLAN TYPES:                               *
  9083*                                                             *
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 166
* EL050.cbl
  9084*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9085*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9086*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9087*           BENEFIT CONTROLS.                                 *
  9088*      99 = ALL BENEFITS.                                     *
  9089*                                                             *
  9090***************************************************************
  9091
  9092     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9093                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9094
  9095     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9096       AND
  9097        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9098        GO TO 03XX-GET-AH-ERPLAN.
  9099
  9100     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9101       AND
  9102        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9103           IF (PB-I-INDV-GRP-OVRD = 'I')
  9104              OR
  9105           ((AM-IG = '1') AND
  9106           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9107              OR
  9108           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9109           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9110           (AM-IG NOT = '2'))
  9111              GO TO 03XX-GET-AH-ERPLAN.
  9112
  9113     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9114       AND
  9115        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9116           IF (PB-I-INDV-GRP-OVRD = 'G')
  9117              OR
  9118           ((AM-IG = '2') AND
  9119           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9120              OR
  9121           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9122           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9123           (AM-IG NOT = '1'))
  9124              GO TO 03XX-GET-AH-ERPLAN.
  9125
  9126     IF SUB5 LESS THAN +20
  9127        ADD +1                   TO SUB5
  9128        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9129
  9130     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9131        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9132
  9133     MOVE +1                    TO SUB5.
  9134
  9135 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9136
  9137     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9138                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9139
  9140     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9141       AND
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 167
* EL050.cbl
  9142        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9143        GO TO 03XX-GET-AH-ERPLAN.
  9144
  9145     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9146       AND
  9147        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9148           IF (PB-I-INDV-GRP-OVRD = 'I')
  9149              OR
  9150           ((AM-IG = '1') AND
  9151           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9152              OR
  9153           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9154           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9155           (AM-IG NOT = '2'))
  9156              GO TO 03XX-GET-AH-ERPLAN.
  9157
  9158     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9159       AND
  9160        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9161           IF (PB-I-INDV-GRP-OVRD = 'G')
  9162              OR
  9163           ((AM-IG = '2') AND
  9164           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9165              OR
  9166           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9167           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9168           (AM-IG NOT = '1'))
  9169              GO TO 03XX-GET-AH-ERPLAN.
  9170
  9171     IF SUB5 LESS THAN +30
  9172        ADD +1                   TO SUB5
  9173        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9174
  9175 03XX-EDIT-FOR-NINETY-AH-CONT.
  9176
  9177     MOVE +99                    TO SUB5.
  9178
  9179     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9180
  9181     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9182        IF PB-ISSUE
  9183           MOVE ER-1925          TO  WS-ERROR
  9184           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9185
  9186     GO TO 0314-A-H-BENEFIT-FOUND.
  9187
  9188 03XX-GET-AH-ERPLAN.
  9189
  9190     IF WK-PLAN-ADDR EQUAL +0
  9191         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9192
  9193     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9194     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9195     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9196     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9197     MOVE 'Y'                    TO PLAN-MASTER-SW
  9198                                    PLAN-MASTER-AH-SW.
  9199*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 168
* EL050.cbl
  9200     GO TO 03XX-ERPLAN-AH-READ.
  9201
  9202 03XX-ERPLAN-AH-GETMAIN.
  9203
  9204     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9205     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9206
  9207 03XX-ERPLAN-AH-READ.
  9208
  9209     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9210     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9211     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9212     MOVE PB-SV-STATE            TO PLAN-STATE.
  9213     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9214     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9215     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9216     MOVE WS-SAVE-BENEFIT-REVISION
  9217                                 TO PLAN-REVISION-NO.
  9218
  9219     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9220     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9221
  9222     IF PB-COMPANY-ID = 'NCL'
  9223       IF NOT AH-PLAN-MASTER-FOUND
  9224         IF NOT PB-POLICY-IS-DECLINED  AND
  9225            NOT PB-POLICY-IS-VOIDED
  9226             MOVE  ER-1922         TO  WS-ERROR
  9227             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9228             GO TO 0314-A-H-BENEFIT-FOUND.
  9229
  9230     IF NOT AH-PLAN-MASTER-FOUND
  9231        GO TO 0314-A-H-BENEFIT-FOUND.
  9232
  9233 XXXX-CHECK-AH-PLAN-KEY.
  9234
  9235     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9236        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9237        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9238        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9239        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9240        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9241        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9242        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9243        MOVE 'N'                 TO PLAN-MASTER-SW
  9244          GO TO 03XX-ERPLAN-AH-READ.
  9245
  9246     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9247
  9248     IF  PB-CANCELLATION
  9249         GO TO  0313-AH-ACCT-BEN-FOUND.
  9250
  9251     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9252       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9253          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9254          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9255             MOVE ER-2644             TO WS-ERROR
  9256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9257          ELSE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 169
* EL050.cbl
  9258             NEXT SENTENCE
  9259       ELSE
  9260          IF PB-COMPANY-ID NOT = 'NCL'
  9261             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9262                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9263
  9264 0313-AH-ACCT-BEN-FOUND.
  9265
  9266     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9267
  9268     IF PL-DEV-CODE NOT = SPACES
  9269        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9270
  9271     IF PL-DEV-PCT NUMERIC AND
  9272        PL-DEV-PCT NOT = ZEROS
  9273        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9274
  9275     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9276        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9277
  9278     IF PL-TOL-REF-AMT NOT EQUAL +0
  9279        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9280
  9281     IF PL-TOL-PREM-PCT GREATER THAN +0
  9282        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9283
  9284     IF PL-TOL-REF-PCT GREATER THAN +0
  9285        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9286
  9287     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9288        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9289
  9290     IF PL-OVER-SHORT-AMT NUMERIC AND
  9291                          PL-OVER-SHORT-AMT > +0
  9292        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9293
  9294     IF PL-OVER-SHORT-PCT NUMERIC AND
  9295                          PL-OVER-SHORT-PCT > +0
  9296        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9297
  9298     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9299        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9300        IF WS-IG-OVRD-AM EQUAL SPACES
  9301            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9302
  9303 0314-A-H-BENEFIT-FOUND.
  9304
  9305     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9306
  9307     IF PB-ISSUE
  9308        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9309       ELSE
  9310        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9311
  9312     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9313     if cf-maximum-benefits (sub3) numeric
  9314        move cf-maximum-benefits (sub3)
  9315                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 170
* EL050.cbl
  9316     else
  9317        move zeros               to ws-ah-max-bens
  9318     end-if
  9319     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9320     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9321     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9322                                         WS-AH-REFUND-CALC.
  9323
  9324     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9325        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9326
  9327     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9328        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9329     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9330
  9331     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9332     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9333     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9334     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9335     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9336     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9337
  9338     IF PB-COMPANY-ID = 'NCL'  AND
  9339        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9340         NEXT SENTENCE
  9341     ELSE
  9342         IF SUB5 NOT GREATER THAN +20
  9343            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9344                MOVE WS-SAVE-BENEFIT-REM-TERM
  9345                                      TO WS-AM-AH-BENE-REM-TERM
  9346                                         EC-BR-AH-REM-TERM-CALC.
  9347
  9348     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9349     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9350
  9351     GO TO 0400-FIND-CARRIER.
  9352
  9353 0399-BENEFIT-NOT-FOUND.
  9354
  9355     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9356     MOVE ER-2605                TO WS-ERROR.
  9357     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9358
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 171
* EL050.cbl
  9360
  9361 0400-FIND-CARRIER.
  9362
  9363     MOVE PB-SV-CARRIER          TO WS-CARR.
  9364
  9365     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9366     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9367     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9368     MOVE '6'                    TO CNTL-REC-TYPE.
  9369
  9370*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9371     MOVE SPACE                  TO WS-DMD-RATING-SW
  9372                                    EC-BR-DMD-RATING-SW.
  9373
  9374     MOVE '2'                    TO RC-SW-1.
  9375     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9376
  9377     IF NOT CF-CARRIER-MASTER
  9378        GO TO 0400-CARRIER-NOT-FOUND.
  9379
  9380 0400-BUILD-CARR-TOL.
  9381
  9382     IF CF-CR-TOL-PREM NUMERIC AND
  9383        CF-CR-TOL-PREM GREATER THAN +0
  9384        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9385                                    WS-TOL-AH-PREM.
  9386
  9387     IF CF-CR-TOL-REFUND NUMERIC AND
  9388        CF-CR-TOL-REFUND GREATER THAN +0
  9389        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9390                                    WS-TOL-AH-REFUND.
  9391
  9392     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9393        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9394        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9395                                    WS-AH-REFUND-OVS-AMT.
  9396
  9397     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9398        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9399        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9400                                    WS-AH-REFUND-OVS-PCT.
  9401
  9402     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9403        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9404        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9405                                    WS-TOL-AH-PREM-PCT.
  9406
  9407     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9408        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9409        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9410                                     WS-TOL-AH-REFUND-PCT.
  9411
  9412     IF CF-COMPANY-ID EQUAL 'DMD'
  9413         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9414                                    EC-BR-DMD-RATING-SW.
  9415
  9416     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9417     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 172
* EL050.cbl
  9418        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9419     END-IF
  9420     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9421        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9422     END-IF
  9423     IF WS-TOL-CLP-PCT = ZEROS
  9424        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9425     END-IF
  9426
  9427     IF WS-SPP-LEASE-COMM = ZEROS
  9428        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9429     END-IF
  9430     GO TO 0400-FIND-ERPDEF.
  9431
  9432 0400-CARRIER-NOT-FOUND.
  9433
  9434     MOVE ER-2602                TO WS-ERROR.
  9435     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9436
  9437 0400-FIND-ERPDEF.
  9438     IF PB-COMPANY-ID = 'DCC'
  9439        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9440        CONTINUE
  9441     ELSE
  9442        GO TO 0400-FIND-ERCOMP
  9443     END-IF
  9444     MOVE ' '                    TO PDEF-MASTER-SW
  9445     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9446     MOVE PB-STATE               TO ERPDEF-STATE
  9447     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9448     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9449     IF PB-ISSUE
  9450        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9451     ELSE
  9452        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9453     END-IF
  9454     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9455     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9456     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9457     IF PDEF-MASTER-FOUND
  9458        MOVE 'N'                 TO PDEF-MASTER-SW
  9459        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9460        IF PDEF-MASTER-FOUND
  9461           IF (ERPDEF-KEY-SAVE (1:16) =
  9462                        PD-CONTROL-PRIMARY (1:16))
  9463              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9464              CONTINUE
  9465           ELSE
  9466              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9467              IF (ERPDEF-KEY-SAVE (1:16) =
  9468                        PD-CONTROL-PRIMARY (1:16))
  9469                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9470                 CONTINUE
  9471              ELSE
  9472                 MOVE 'N'        TO PDEF-MASTER-SW
  9473              END-IF
  9474           END-IF
  9475        END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 173
* EL050.cbl
  9476        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9477     END-IF
  9478     IF PDEF-MASTER-FOUND
  9479        IF PD-TRUNCATED = 'Y'
  9480           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9481        END-IF
  9482     END-IF
  9483     .
  9484 0400-FIND-ERCOMP.
  9485     IF PB-COMPANY-ID = 'DCC'
  9486        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9487           (WS-SUB1 > +10)
  9488           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9489                 OR 'A' OR 'N'
  9490              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9491              MOVE PB-CARRIER    TO COMP-CARRIER
  9492              MOVE PB-GROUPING   TO COMP-GROUPING
  9493              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9494              MOVE AM-AGT (WS-SUB1)
  9495                                 TO COMP-FIN-RESP
  9496              MOVE 'G'           TO COMP-TYPE
  9497              PERFORM 8582-READ-COMPENSATION-MASTER
  9498                                 THRU 8582-EXIT
  9499              IF COMP-MASTER-FOUND
  9500                 IF CO-GA-INACTIVE
  9501                    MOVE ER-2763 TO WS-ERROR
  9502                    PERFORM 9900-ERROR-FORMAT
  9503                                 THRU 9900-EXIT
  9504                    MOVE +11     TO WS-SUB1
  9505                 END-IF
  9506                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9507                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9508                    MOVE ER-2788 TO WS-ERROR
  9509                    PERFORM 9900-ERROR-FORMAT
  9510                                 THRU 9900-EXIT
  9511                    MOVE +11     TO WS-SUB1
  9512                 END-IF
  9513              END-IF
  9514           END-IF
  9515        END-PERFORM
  9516     END-IF
  9517     IF PB-COMPANY-ID = 'DCC'
  9518        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9519           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9520                                    WS-CLP-STATE
  9521        ELSE
  9522           MOVE SPACES           TO PB-I-CLP-STATE
  9523                                    WS-CLP-STATE
  9524        END-IF
  9525     END-IF
  9526
  9527     IF (PB-COMPANY-ID = 'DCC')
  9528        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9529        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9530        CONTINUE
  9531     ELSE
  9532        GO TO 0400-FIND-STATE-RECORD
  9533     END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 174
* EL050.cbl
  9534     MOVE SPACES                 TO WS-CLP-STATE
  9535     MOVE +0                     TO WS-BANK-FEE
  9536                                    WS-BANK-LFEE
  9537                                    WS-BANK-NOCHRGB
  9538
  9539     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9540     IF (PB-ISSUE)
  9541        AND (PB-I-BANK-NUMBER NOT =
  9542            SPACES AND ZEROS AND LOW-VALUES)
  9543        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9544     ELSE
  9545        IF (PB-CANCELLATION)
  9546           AND (PB-CI-BANK-NUMBER NOT =
  9547                SPACES AND ZEROS AND LOW-VALUES)
  9548           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9549        END-IF
  9550     END-IF
  9551     IF COMP-FIN-RESP NOT = LOW-VALUES
  9552        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9553        MOVE PB-CARRIER          TO COMP-CARRIER
  9554        MOVE PB-GROUPING         TO COMP-GROUPING
  9555        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9556        MOVE 'B'                 TO COMP-TYPE
  9557        PERFORM 8582-READ-COMPENSATION-MASTER
  9558                                 THRU 8582-EXIT
  9559        IF COMP-MASTER-FOUND
  9560           IF CO-MAX-BANK-FEE NOT NUMERIC
  9561              MOVE +0            TO CO-MAX-BANK-FEE
  9562           END-IF
  9563           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9564              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9565           END-IF
  9566           IF CO-GA-INACTIVE
  9567              MOVE ER-2763       TO WS-ERROR
  9568              PERFORM 9900-ERROR-FORMAT
  9569                                 THRU 9900-EXIT
  9570           END-IF
  9571           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9572              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9573              MOVE ER-2788 TO WS-ERROR
  9574              PERFORM 9900-ERROR-FORMAT
  9575                                 THRU 9900-EXIT
  9576              MOVE +11     TO WS-SUB1
  9577           END-IF
  9578           IF WS-AH-BEN-CATEGORY = 'G'
  9579              MOVE CO-MAX-BANK-FEE
  9580                                 TO WS-BANK-FEE
  9581                                    PB-I-BANK-FEE
  9582           ELSE
  9583              MOVE CO-MAX-BANK-FEE-LEASE
  9584                                 TO WS-BANK-LFEE
  9585                                    PB-I-BANK-FEE
  9586           END-IF
  9587           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9588              AND (WS-AH-REFUND-CALC = 'G'))
  9589                        OR
  9590              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9591              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 175
* EL050.cbl
  9592              CONTINUE
  9593           ELSE
  9594              MOVE ER-2789 TO WS-ERROR
  9595              PERFORM 9900-ERROR-FORMAT
  9596                                 THRU 9900-EXIT
  9597           END-IF
  9598           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9599                                    PB-I-CLP-STATE
  9600           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9601           MOVE CO-CARRIER       TO BXRF-CARRIER
  9602           MOVE CO-GROUPING      TO BXRF-GROUPING
  9603           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9604           MOVE BXRF-MAX-REC-LENGTH
  9605                                 TO BXRF-REC-LENGTH
  9606           PERFORM 8584-READ-BANK-CROSS-REF
  9607                                 THRU 8584-EXIT
  9608           IF BXRF-MASTER-FOUND
  9609              MOVE ' '           TO BANK-ACCT-SW
  9610              MOVE BK-BANK-POINTER-CNT
  9611                                 TO BK-BANK-POINTER-CNT
  9612              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9613                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9614                 OR (BANK-ACCT-FOUND)
  9615                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9616                    AND (BK-AM-EXP-DT (WS-SUB1)
  9617                                 > PB-CERT-EFF-DT)
  9618                    AND (BK-AM-EFF-DT (WS-SUB1)
  9619                                 NOT > PB-CERT-EFF-DT)
  9620                    SET BANK-ACCT-FOUND TO TRUE
  9621                 END-IF
  9622              END-PERFORM
  9623              IF NOT BANK-ACCT-FOUND
  9624                 MOVE ZEROS      TO WS-BANK-FEE
  9625                                    WS-BANK-LFEE
  9626                 MOVE ER-2869    TO WS-ERROR
  9627                 PERFORM 9900-ERROR-FORMAT
  9628                                 THRU 9900-EXIT
  9629              ELSE
  9630                 PERFORM 5000-PROCESS-REPS
  9631                                 THRU 5000-EXIT
  9632                 IF AGENT-MASTER-FOUND
  9633                    MOVE +0      TO WS-BANK-FEE
  9634                                    WS-BANK-LFEE
  9635*                   MOVE AG-SPP-FEES (1)
  9636*                                TO PB-I-BANK-FEE
  9637*                                   WS-BANK-FEE
  9638                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9639                       (WS-SUB1 > +10)
  9640                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9641                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9642                       END-IF
  9643                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9644                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9645                       END-IF
  9646                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9647                          AG-SPP-FEES (WS-SUB1)
  9648                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9649                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 176
* EL050.cbl
  9650                    END-PERFORM
  9651                    IF WS-AH-BEN-CATEGORY = 'G'
  9652                       MOVE WS-BANK-FEE
  9653                                 TO PB-I-BANK-FEE
  9654                    ELSE
  9655                       MOVE WS-BANK-LFEE
  9656                                 TO PB-I-BANK-FEE
  9657                    END-IF
  9658                 END-IF
  9659              END-IF
  9660           END-IF
  9661        ELSE
  9662           MOVE ER-2879          TO WS-ERROR
  9663           PERFORM 9900-ERROR-FORMAT
  9664                                 THRU 9900-EXIT
  9665        END-IF
  9666     ELSE
  9667        MOVE ER-2879             TO WS-ERROR
  9668        PERFORM 9900-ERROR-FORMAT
  9669                                 THRU 9900-EXIT
  9670     END-IF
  9671     IF WS-AH-BEN-CATEGORY = 'G'
  9672        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9673        + WS-BANK-FEE
  9674     ELSE
  9675        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9676        + WS-BANK-LFEE
  9677     END-IF
  9678     .
  9679 0400-FIND-STATE-RECORD.
  9680
  9681     IF WK-STATE-ADDR NOT = ZEROS
  9682         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9683         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9684         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9685         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9686         IF PB-SV-STATE = CF-STATE-CODE
  9687             GO TO 0405-CONTINUE-EDIT
  9688         ELSE
  9689             NEXT SENTENCE
  9690     ELSE
  9691         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9692
  9693     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9694     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9695     MOVE '3'                    TO CNTL-REC-TYPE.
  9696     MOVE +0                     TO CNTL-SEQ-NO.
  9697
  9698     MOVE '3'                    TO RC-SW-2.
  9699     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9700
  9701     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9702        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9703        PB-SV-STATE   NOT = CF-STATE-CODE)
  9704        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9705                                    WS-TOL-AH-CLAIM
  9706                                    WS-MINIMUM-REFUND
  9707                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 177
* EL050.cbl
  9708                                    WS-TOL-AH-PREM
  9709                                    WS-TOL-LF-REFUND
  9710                                    WS-TOL-AH-REFUND
  9711                                    EC-ST-TOL-PREM-PCT
  9712                                    WS-TOL-LF-PREM-PCT
  9713                                    WS-TOL-AH-PREM-PCT
  9714                                    EC-ST-TOL-REFUND-PCT
  9715                                    WS-TOL-LF-REFUND-PCT
  9716                                    WS-TOL-AH-REFUND-PCT
  9717                                    EC-ST-TOL-PREM
  9718                                    EC-ST-TOL-REFUND
  9719                                    EC-ST-FST-PMT-DAYS-MAX
  9720                                    WS-FREE-LOOK-PERIOD
  9721                                    WS-ST-LF-PREM-TAX
  9722                                    WS-ST-AH-PREM-TAX-I
  9723                                    WS-ST-AH-PREM-TAX-G
  9724                                    WS-BANK-FEE
  9725                                    WS-BANK-LFEE
  9726                                    WS-TOL-CLP-PCT
  9727                                    WS-SPP-LEASE-COMM
  9728                                    WS-INT-PERIODS
  9729                                    WS-EXTRA-PMTS
  9730        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9731                                    EC-ST-FST-PMT-DAYS-CHG
  9732                                    WS-LF-REM-TERM-CALC
  9733                                    WS-LF-REFUND-CALC
  9734                                    EC-ST-LF-REM-TERM-CALC
  9735                                    EC-ST-LF-REFUND-CALC
  9736                                    WS-AH-REM-TERM-CALC
  9737                                    WS-AH-REFUND-CALC
  9738                                    WS-LF-BEN-CATEGORY
  9739                                    WS-AH-BEN-CATEGORY
  9740                                    WS-CLP-STATE
  9741                                    WS-ST-REFUND-CLAIM-FLAG
  9742                                    WS-ST-CAUSAL-STATE
  9743                                    ws-st-agent-sig-edit
  9744                                    EC-ST-AH-REM-TERM-CALC
  9745                                    EC-ST-AH-REFUND-CALC
  9746          GO TO 0499-STATE-NOT-FOUND.
  9747
  9748     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9749
  9750 0405-CONTINUE-EDIT.
  9751
  9752     if pb-company-id = 'AHL'
  9753        continue
  9754     else
  9755        IF PB-CERT-PRIME NOT NUMERIC
  9756           MOVE ER-2722          TO WS-ERROR
  9757           PERFORM 9900-ERROR-FORMAT
  9758                                 THRU 9900-EXIT
  9759        end-if
  9760     END-IF
  9761*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9762*       MOVE +0                  TO SUB3
  9763*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9764*       IF SUB3 > +0
  9765*          MOVE ER-2722          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 178
* EL050.cbl
  9766*          PERFORM 9900-ERROR-FORMAT
  9767*                                THRU 9900-EXIT
  9768*       END-IF
  9769*    END-IF
  9770*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9771*       IF PB-CERT-PRIME NOT NUMERIC
  9772*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9773*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9774*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9775*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9776*
  9777*          MOVE ER-2722          TO WS-ERROR
  9778*          PERFORM 9900-ERROR-FORMAT
  9779*                                THRU 9900-EXIT
  9780*       END-IF
  9781*    END-IF
  9782
  9783     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9784
  9785     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9786        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9787                                    WS-TOL-AH-CLAIM.
  9788
  9789     IF CF-ST-REFUND-MIN NOT NUMERIC
  9790        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9791
  9792     IF CF-ST-REFUND-MIN NOT = ZEROS
  9793        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9794
  9795     IF CF-ST-TOL-PREM  NOT = ZEROS
  9796        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9797                                    WS-TOL-AH-PREM
  9798        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9799
  9800     IF CF-ST-TOL-REFUND NOT = ZEROS
  9801        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9802                                    WS-TOL-AH-REFUND
  9803        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9804
  9805     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9806        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9807        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9808                                    WS-AH-REFUND-OVS-AMT
  9809                                    EC-ST-OVR-SHT-AMT.
  9810
  9811     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9812        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9813        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9814                                    WS-TOL-LF-PREM-PCT
  9815                                    WS-TOL-AH-PREM-PCT.
  9816
  9817     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9818        CF-ST-TOL-REF-PCT GREATER THAN +0
  9819        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9820                                    WS-TOL-LF-REFUND-PCT
  9821                                    WS-TOL-AH-REFUND-PCT.
  9822
  9823     IF CF-ST-OVR-SHT-PCT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 179
* EL050.cbl
  9824        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9825        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9826                                    WS-AH-REFUND-OVS-PCT
  9827                                    EC-ST-OVR-SHT-PCT.
  9828
  9829     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9830     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9831
  9832     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9833          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9834
  9835     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9836     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9837     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9838
  9839     IF CF-ST-LF-PREM-TAX NUMERIC
  9840        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9841     END-IF
  9842     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9843        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9844     END-IF
  9845     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9846        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9847     END-IF
  9848
  9849     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9850         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9851     END-IF.
  9852
  9853     IF CF-ST-CAUSAL-STATE > SPACES
  9854         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9855     END-IF.
  9856     if cf-st-extra-interest-periods not numeric
  9857        move zeros               to cf-st-extra-interest-periods
  9858     end-if
  9859     if cf-st-extra-payments not numeric
  9860        move zeros               to cf-st-extra-payments
  9861     end-if
  9862
  9863     move cf-st-extra-interest-periods
  9864                                 to ws-int-periods
  9865     move cf-st-extra-payments   to ws-extra-pmts
  9866     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9867     move cf-st-net-only-state   to ws-net-only-state
  9868     IF WS-LF-BENEFIT-CD = ZEROS
  9869        GO TO 0410-CHECK-AH.
  9870
  9871     IF CF-ST-RT-CALC NOT = SPACES
  9872        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9873                                    EC-ST-LF-REM-TERM-CALC
  9874     END-IF
  9875
  9876     IF WS-LF-COVERAGE-TYPE = 'R'
  9877        IF WS-LF-EARNINGS-CALC = '5'
  9878           IF CF-ST-RF-LN-CALC > '0'
  9879              MOVE CF-ST-RF-LN-CALC
  9880                                 TO WS-LF-REFUND-CALC
  9881                                    EC-ST-LF-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 180
* EL050.cbl
  9882           END-IF
  9883        ELSE
  9884           IF CF-ST-RF-LR-CALC > '0'
  9885              MOVE CF-ST-RF-LR-CALC
  9886                                 TO WS-LF-REFUND-CALC
  9887                                    EC-ST-LF-REFUND-CALC
  9888           END-IF
  9889        END-IF
  9890     ELSE
  9891        IF CF-ST-RF-LL-CALC > '0'
  9892           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9893                                    EC-ST-LF-REFUND-CALC
  9894        END-IF
  9895     END-IF
  9896
  9897     IF CF-ST-RT-CALC NOT = SPACES
  9898        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9899                                    EC-ST-LF-REM-TERM-CALC
  9900     END-IF
  9901
  9902     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9903     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9904
  9905     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9906
  9907     IF NO-BENEFIT-FOUND
  9908        GO TO 0410-CHECK-AH.
  9909
  9910     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9911        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9912                                 TO EC-ST-LF-REM-TERM-CALC
  9913                                    WS-LF-REM-TERM-CALC
  9914     END-IF
  9915
  9916     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9917        MOVE CF-ST-REFUND-CALC (SUB3)
  9918                                 TO WS-LF-REFUND-CALC
  9919                                    EC-ST-LF-REFUND-CALC
  9920     END-IF
  9921*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9922     if cf-st-extra-periods (sub3) not numeric
  9923        move zeros               to cf-st-extra-periods (sub3)
  9924     end-if
  9925     if cf-st-extra-periods (sub3) > zeros
  9926        if ws-lf-ben-category = 'P'
  9927           move cf-st-extra-periods (sub3)
  9928                                 to ws-extra-pmts
  9929        else
  9930           if ws-lf-ben-category = 'I'
  9931              move cf-st-extra-periods (sub3)
  9932                                 to ws-int-periods
  9933           end-if
  9934        end-if
  9935     end-if
  9936     .
  9937 0410-CHECK-AH.
  9938
  9939     IF WS-AH-BENEFIT-CD = ZEROS
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 181
* EL050.cbl
  9940        GO TO 0500-SET-ACCOUNT.
  9941
  9942     IF CF-ST-RT-CALC NOT = SPACES
  9943        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9944                                    EC-ST-AH-REM-TERM-CALC
  9945     END-IF
  9946
  9947     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9948        IF CF-ST-RF-CP-CALC > '0'
  9949           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9950                                    EC-ST-AH-REFUND-CALC
  9951        END-IF
  9952     ELSE
  9953        IF CF-ST-RF-AH-CALC > '0'
  9954           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9955                                    EC-ST-AH-REFUND-CALC
  9956        END-IF
  9957     END-IF
  9958     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9959     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9960
  9961     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9962
  9963     IF NO-BENEFIT-FOUND
  9964        GO TO 0500-SET-ACCOUNT.
  9965
  9966     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9967        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9968                                 TO WS-AH-REM-TERM-CALC
  9969                                    EC-ST-AH-REM-TERM-CALC
  9970     END-IF
  9971
  9972     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9973        MOVE CF-ST-REFUND-CALC (SUB3)
  9974                                 TO WS-AH-REFUND-CALC
  9975                                    EC-ST-AH-REFUND-CALC
  9976     END-IF
  9977
  9978*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9979
  9980     GO TO 0500-SET-ACCOUNT.
  9981
  9982 0499-STATE-NOT-FOUND.
  9983
  9984     MOVE ER-2603                TO WS-ERROR.
  9985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9986
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 182
* EL050.cbl
  9988
  9989 0500-SET-ACCOUNT.
  9990*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9991     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9992        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9993        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9994        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9995        MOVE '3'                 TO CNTL-REC-TYPE
  9996        MOVE +0                  TO CNTL-SEQ-NO
  9997
  9998        MOVE '3'                 TO RC-SW-2
  9999        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10000
 10001        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10002           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10003           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10004           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10005                                    WS-ST-AH-PREM-TAX-I
 10006                                    WS-ST-AH-PREM-TAX-G
 10007        ELSE
 10008           IF CF-ST-LF-PREM-TAX NUMERIC
 10009              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10010           END-IF
 10011           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10012              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10013           END-IF
 10014           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10015              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10016           END-IF
 10017        END-IF
 10018        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10019     END-IF
 10020*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10021*  FOR DCC ONLY
 10022     IF PB-COMPANY-ID = 'DCC'
 10023
 10024     MOVE ' '                    TO STAT-MASTER-SW
 10025     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10026     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10027     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10028     MOVE PB-STATE               TO ELSTAT-STATE
 10029     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10030        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10031     END-IF
 10032
 10033     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10034     SET BIN-TO-GREG             TO TRUE
 10035     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10036     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10037     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10038
 10039     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10040     IF STAT-MASTER-FOUND
 10041        MOVE 'N'                 TO STAT-MASTER-SW
 10042        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10043        IF STAT-MASTER-FOUND
 10044           IF (ELSTAT-KEY-SAVE (1:12) =
 10045                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 183
* EL050.cbl
 10046              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10047                 MOVE 'F'        TO STAT-MASTER-SW
 10048              ELSE
 10049                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10050                 IF (STAT-MASTER-FOUND)
 10051                    AND (ELSTAT-KEY-SAVE (1:12) =
 10052                        SF-CONTROL-PRIMARY (1:12))
 10053                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10054                    MOVE 'F'     TO STAT-MASTER-SW
 10055                 END-IF
 10056              END-IF
 10057           END-IF
 10058        END-IF
 10059     END-IF
 10060
 10061     IF STAT-MASTER-SW = 'F'
 10062        IF SF-ST-LF-PREM-TAX NUMERIC
 10063           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10064        END-IF
 10065        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10066           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10067        END-IF
 10068        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10069           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10070        END-IF
 10071     END-IF
 10072
 10073     END-IF
 10074     IF (PB-COMPANY-ID = 'DCC')
 10075        AND (PB-ISSUE)
 10076        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10077        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10078        AND (AM-GPCD = 06)
 10079        MOVE 'Y'                 TO WS-GOOD-HIN
 10080        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10081           MOVE PB-I-VIN         TO WS-WORK-VIN
 10082           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10083              (V1 > 16)
 10084              IF WS-WORK-VIN (V1:1) NUMERIC
 10085                 MOVE WS-WORK-VIN-N (V1)
 10086                                 TO WS-ROW-B-VAL (V1)
 10087              ELSE
 10088                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10089                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10090                    OR (V2 > 26)
 10091                 END-PERFORM
 10092                 IF V2 < 27
 10093                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10094                 ELSE
 10095                    MOVE 'N'     TO WS-GOOD-HIN
 10096                 END-IF
 10097              END-IF
 10098              COMPUTE WS-ROW-D-VAL (V1) =
 10099                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10100              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10101                 WS-ROW-D-VAL (V1)
 10102           END-PERFORM
 10103           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 184
* EL050.cbl
 10104           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10105             REMAINDER WS-VIN-REMAINDER
 10106           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10107              CONTINUE
 10108           ELSE
 10109              MOVE 'N'           TO WS-GOOD-HIN
 10110           END-IF
 10111        ELSE
 10112           MOVE 'N'              TO WS-GOOD-HIN
 10113        END-IF
 10114        IF WS-GOOD-HIN NOT = 'Y'
 10115           MOVE ER-3826           TO WS-ERROR
 10116           PERFORM 9900-ERROR-FORMAT
 10117                                 THRU 9900-EXIT
 10118        END-IF
 10119     END-IF
 10120     IF (PB-COMPANY-ID = 'DCC')
 10121        AND (PB-ISSUE)
 10122        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10123        AND (AM-GPCD NOT = 06)
 10124        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10125          MOVE PB-I-VIN          TO WS-WORK-VIN
 10126          MOVE +8                TO V2
 10127          MOVE ZEROS             TO WS-VIN-TOTAL
 10128          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10129           (V1 > 17)
 10130             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10131                MOVE ER-3825     TO WS-ERROR
 10132                PERFORM 9900-ERROR-FORMAT
 10133                                 THRU 9900-EXIT
 10134             ELSE
 10135                IF V1 = 8
 10136                   MOVE 10       TO V2
 10137                END-IF
 10138                IF V1 = 9
 10139                   MOVE 0        TO V2
 10140                END-IF
 10141                IF V1 = 10
 10142                   MOVE 9        TO V2
 10143                END-IF
 10144                IF WS-WORK-VIN (V1:1) NUMERIC
 10145                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10146                    + (WS-WORK-VIN-N (V1) * V2)
 10147                ELSE
 10148                   MOVE WS-WORK-VIN (V1:1)
 10149                                 TO WS-HEX-BYTE
 10150                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10151                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10152                    + (WS-NUM (V3) * V2)
 10153                END-IF
 10154                COMPUTE V2 = V2 - 1
 10155             END-IF
 10156          END-PERFORM
 10157          MOVE ZEROS TO WS-VIN-REMAINDER
 10158          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10159             REMAINDER WS-VIN-REMAINDER
 10160          IF ((WS-WORK-VIN (9:1) = 'X')
 10161             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 185
* EL050.cbl
 10162                     OR
 10163             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10164             CONTINUE
 10165          ELSE
 10166             MOVE ER-3826        TO WS-ERROR
 10167             PERFORM 9900-ERROR-FORMAT
 10168                                 THRU 9900-EXIT
 10169          END-IF
 10170        ELSE
 10171          MOVE ER-3826           TO WS-ERROR
 10172          PERFORM 9900-ERROR-FORMAT
 10173                                 THRU 9900-EXIT
 10174        END-IF
 10175     END-IF
 10176******************************************************************
 10177******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10178******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10179******* METHODS.
 10180******************************************************************
 10181     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10182        IF PB-CANCELLATION
 10183           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10184              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10185                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10186                IF FORM-MASTER-FOUND
 10187                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10188******************************************************************
 10189
 10190     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10191     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10192
 10193     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10194     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10195     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10196     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10197
 10198
 10199     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10200     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10201     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10202
 10203     IF AM-LF-OB-RATE NOT NUMERIC
 10204         MOVE ZERO               TO AM-LF-OB-RATE.
 10205
 10206     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10207         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10208
 10209     IF AM-AH-OB-RATE NOT NUMERIC
 10210         MOVE ZERO               TO AM-AH-OB-RATE.
 10211
 10212     IF WS-LF-JOINT-INDICATOR = 'J'
 10213         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10214     ELSE
 10215         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10216
 10217     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10218
 10219     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 186
* EL050.cbl
 10220         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10221
 10222     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10223         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10224                                       WS-IG-OVRD
 10225     ELSE
 10226         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10227             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10228                                       WS-IG-OVRD
 10229         ELSE
 10230             MOVE AM-IG             TO WS-IG-OVRD-AH
 10231                                       WS-IG-OVRD.
 10232
 10233     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10234         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10235                                       WS-IG-OVRD
 10236     ELSE
 10237         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10238             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10239                                       WS-IG-OVRD
 10240         ELSE
 10241             MOVE AM-IG             TO WS-IG-OVRD-LF
 10242                                       WS-IG-OVRD.
 10243
 10244     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10245     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10246     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10247     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10248     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10249
 10250     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10251     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10252     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10253     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10254
 10255     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10256     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10257     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10258     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10259     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10260     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10261     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10262
 10263     IF WS-ACCT-AH-DEV-PCT > +0
 10264        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10265     ELSE
 10266        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10267
 10268     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10269        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10270     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10271        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10272
 10273        IF AM-EARN-METHOD-L = 'S'
 10274            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10275                                        WS-LF-REFUND-CALC.
 10276
 10277        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 187
* EL050.cbl
 10278            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10279                                        WS-LF-REFUND-CALC.
 10280
 10281     IF WS-LF-COVERAGE-TYPE = 'R'
 10282         IF AM-EARN-METHOD-R = 'R'
 10283            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10284                                    WS-LF-REFUND-CALC.
 10285     IF WS-LF-COVERAGE-TYPE = 'R'
 10286         IF AM-EARN-METHOD-R = 'P'
 10287            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10288                                    WS-LF-REFUND-CALC.
 10289     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10290         IF AM-EARN-METHOD-L = 'R'
 10291            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10292                                    WS-LF-REFUND-CALC.
 10293     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10294         IF AM-EARN-METHOD-L = 'P'
 10295            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10296                                    WS-LF-REFUND-CALC.
 10297     IF WS-LF-COVERAGE-TYPE = 'R'
 10298         IF AM-EARN-METHOD-R = 'A'
 10299            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10300                                    WS-LF-REFUND-CALC.
 10301     IF WS-LF-COVERAGE-TYPE = 'R'
 10302         IF AM-EARN-METHOD-R = 'M'
 10303            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10304                                    WS-LF-REFUND-CALC.
 10305     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10306         IF AM-EARN-METHOD-L = 'A'
 10307            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10308                                    WS-LF-REFUND-CALC.
 10309     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10310         IF AM-EARN-METHOD-L = 'M'
 10311            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10312                                    WS-LF-REFUND-CALC.
 10313
 10314     IF AM-EARN-METHOD-A = 'R'
 10315        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10316                                    WS-AH-REFUND-CALC.
 10317     IF AM-EARN-METHOD-A = 'P'
 10318        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10319                                    WS-AH-REFUND-CALC.
 10320     IF AM-EARN-METHOD-A = 'C'
 10321        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10322                                    WS-AH-REFUND-CALC.
 10323     IF AM-EARN-METHOD-A = 'A'
 10324        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10325                                    WS-AH-REFUND-CALC.
 10326     IF AM-EARN-METHOD-A = 'M'
 10327        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10328                                    WS-AH-REFUND-CALC.
 10329     IF AM-EARN-METHOD-A = 'N'
 10330        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10331                                    WS-AH-REFUND-CALC.
 10332     IF AM-EARN-METHOD-A = 'S'
 10333        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10334                                    WS-AH-REFUND-CALC.
 10335
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 188
* EL050.cbl
 10336     IF AM-TOL-PREM NOT = ZEROS
 10337        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10338                                    WS-TOL-AH-PREM.
 10339
 10340     IF AM-OVR-SHT-AMT NUMERIC AND
 10341                  AM-OVR-SHT-AMT > 0
 10342        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10343                                    EC-AM-LF-OVR-SHT-AMT
 10344                                    WS-AH-REFUND-OVS-AMT
 10345                                    EC-AM-AH-OVR-SHT-AMT.
 10346
 10347     IF AM-OVR-SHT-PCT NUMERIC AND
 10348                    AM-OVR-SHT-PCT > 0
 10349        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10350                                    EC-AM-LF-OVR-SHT-PCT
 10351                                    WS-AH-REFUND-OVS-PCT
 10352                                    EC-AM-AH-OVR-SHT-PCT.
 10353
 10354     IF AM-TOL-REF-PCT NUMERIC AND
 10355                  AM-TOL-REF-PCT > 0
 10356        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10357                                    WS-TOL-AH-REFUND-PCT.
 10358
 10359     IF AM-TOL-REF  NOT = ZEROS  AND
 10360                  AM-TOL-REF NUMERIC
 10361        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10362                                    EC-AM-LF-TOL-REFUND
 10363                                    WS-TOL-AH-REFUND
 10364                                    EC-AM-AH-TOL-REFUND.
 10365
 10366     IF AM-TOL-CLM  NOT = ZEROS
 10367        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10368                                    WS-TOL-AH-CLAIM.
 10369
 10370     IF AM-CLP-TOL-PCT NOT NUMERIC
 10371        MOVE +0                  TO AM-CLP-TOL-PCT
 10372     END-IF
 10373
 10374     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10375        MOVE +0                  TO AM-SPP-LEASE-COMM
 10376     END-IF
 10377     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10378        MOVE WS-PL-TOL-LF-PREM-PCT
 10379                                 TO WS-TOL-LF-PREM-PCT.
 10380
 10381     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10382        MOVE WS-PL-TOL-AH-PREM-PCT
 10383                                 TO WS-TOL-AH-PREM-PCT.
 10384
 10385     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10386        MOVE WS-PL-TOL-LF-REFUND-PCT
 10387                                 TO WS-TOL-LF-REFUND-PCT.
 10388
 10389     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10390        MOVE WS-PL-TOL-AH-REFUND-PCT
 10391                                 TO WS-TOL-AH-REFUND-PCT.
 10392
 10393     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 189
* EL050.cbl
 10394        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10395
 10396     IF WS-PL-REF-OVS-PCT > +0
 10397        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10398
 10399     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10400        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10401     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10402        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10403     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10404        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10405     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10406        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10407     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10408        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10409     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10410        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10411
 10412     IF WS-AH-PL-REF-OVS-AMT > +0
 10413        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10414
 10415     IF WS-AH-PL-REF-OVS-PCT > +0
 10416        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10417
 10418     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10419     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10420
 10421     IF PB-CANCELLATION
 10422        GO TO 3000-CONTINUE-EDIT.
 10423
 10424     MOVE +1 TO SUB1.
 10425     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10426     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10427
 10428     IF CF-COMPANY-ID = 'DMD'
 10429       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10430         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10431        ELSE
 10432         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10433
 10434  0525-FIND-ACCT-COMM.
 10435     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10436        NEXT SENTENCE
 10437      ELSE
 10438         ADD +1 TO SUB1
 10439         IF SUB1 LESS +11
 10440            GO TO 0525-FIND-ACCT-COMM
 10441          ELSE
 10442             GO TO 0560-EDIT-CONTINUE.
 10443
 10444     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10445     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10446                                    PB-I-LIFE-COMMISSION.
 10447***  IF PB-COMPANY-ID = 'CRI'
 10448     IF PB-PREM-ACCTNG-ONLY
 10449         GO TO 0560-EDIT-CONTINUE.
 10450
 10451     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 190
* EL050.cbl
 10452     MOVE ' '    TO WS-CTBL-READ-SW.
 10453
 10454
 10455 0530-GET-AH-COMP.
 10456     IF NO-AH-COVERAGE  OR
 10457        NO-AH-BENEFIT-MATCH
 10458           GO TO 0540-NEXT-READ-STEP.
 10459
 10460     IF AM-A-COM (SUB1) NUMERIC
 10461        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10462         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10463         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10464         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10465         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10466     ELSE
 10467          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10468          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10469          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10470          MOVE ZEROS             TO WS-SUB1
 10471                                    WS-COMMISSION
 10472          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10473          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10474          IF WS-COMMISSION > ZEROS
 10475             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10476             GO TO 0540-NEXT-READ-STEP
 10477          END-IF
 10478          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10479          IF CTBL-TABLE-FOUND
 10480             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10481                                        PB-I-AH-TERM
 10482             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10483             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10484             GO TO 0540-NEXT-READ-STEP
 10485          ELSE
 10486             IF FIRST-TIME-THROUGH
 10487                 GO TO 0530-GET-AH-COMP
 10488             ELSE
 10489                 MOVE ER-2609                TO WS-ERROR
 10490                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10491
 10492 0540-NEXT-READ-STEP.
 10493     MOVE '0540' TO CTBL-SW.
 10494     MOVE ' '    TO WS-CTBL-READ-SW.
 10495
 10496 0540-GET-LF-COMP.
 10497     IF NO-LIFE-COVERAGE  OR
 10498        NO-LF-BENEFIT-MATCH
 10499           GO TO 0560-EDIT-CONTINUE.
 10500
 10501     IF WS-LF-JOINT-INDICATOR = 'J'
 10502        IF AM-J-COM (SUB1) NUMERIC
 10503           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10504           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10505           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10506           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10507           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10508        ELSE
 10509           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 191
* EL050.cbl
 10510           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10511           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10512           MOVE ZEROS                TO WS-SUB1
 10513                                        WS-COMMISSION
 10514           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10515           IF WS-COMMISSION > ZEROS
 10516              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10517              GO TO 0560-EDIT-CONTINUE
 10518           END-IF
 10519           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10520           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10521           IF CTBL-TABLE-FOUND
 10522              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10523              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10524              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10525              GO TO 0560-EDIT-CONTINUE
 10526           ELSE
 10527              IF FIRST-TIME-THROUGH
 10528                  GO TO 0540-GET-LF-COMP
 10529              ELSE
 10530                  MOVE ER-2609                TO WS-ERROR
 10531                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10532                  GO TO 0560-EDIT-CONTINUE.
 10533
 10534     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10535        IF AM-L-COM (SUB1) NUMERIC
 10536           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10537           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10538           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10539           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10540           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10541        ELSE
 10542           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10543           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10544           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10545           MOVE ZEROS                TO WS-SUB1
 10546                                        WS-COMMISSION
 10547           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10548           IF WS-COMMISSION IS GREATER THAN ZEROS
 10549              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10550              GO TO 0560-EDIT-CONTINUE
 10551           END-IF
 10552           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10553           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10554           IF CTBL-TABLE-FOUND
 10555              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10556              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10557              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10558              GO TO 0560-EDIT-CONTINUE
 10559           ELSE
 10560              IF FIRST-TIME-THROUGH
 10561                  GO TO 0540-GET-LF-COMP
 10562              ELSE
 10563                  MOVE ER-2609                TO WS-ERROR
 10564                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10565
 10566*    GO TO 0560-EDIT-CONTINUE.
 10567
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 192
* EL050.cbl
 10568 0560-EDIT-CONTINUE.
 10569     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10570                                    WS-AH-PMF-COMM
 10571*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10572*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10573     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10574        (SUB1 > +10)
 10575        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10576           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10577           MOVE '0530'           TO CTBL-SW
 10578           MOVE ' '              TO WS-CTBL-READ-SW
 10579           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10580           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10581           MOVE '0540'           TO CTBL-SW
 10582           MOVE ' '              TO WS-CTBL-READ-SW
 10583           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10584        END-IF
 10585     END-PERFORM
 10586     GO TO 0564-EDIT-CONTINUE
 10587     .
 10588 0561-CHECK-AH.
 10589     IF (NO-AH-COVERAGE)
 10590        OR (NO-AH-BENEFIT-MATCH)
 10591        CONTINUE
 10592     ELSE
 10593        IF (AM-A-COM (SUB1) NUMERIC)
 10594           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10595           IF (AM-COM-TYP (SUB1) = 'A')
 10596              AND (WS-AH-PMF-COMM = ZEROS)
 10597              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10598           END-IF
 10599           CONTINUE
 10600        ELSE
 10601           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10602           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10603           MOVE PB-AH-OVERRIDE-L1
 10604                                 TO CTBL-BEN-TYPE
 10605           MOVE ZEROS            TO WS-SUB1
 10606                                    WS-COMMISSION
 10607           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10608           PERFORM 8300-READ-CTBL-TABLE
 10609                                 THRU 8300-EXIT
 10610           IF CTBL-TABLE-FOUND
 10611              IF (AM-COM-TYP (SUB1) = 'A')
 10612                 AND (WS-AH-PMF-COMM = ZEROS)
 10613                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10614                                        PB-I-AH-TERM
 10615                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10616                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10617              END-IF
 10618              CONTINUE
 10619           ELSE
 10620              IF FIRST-TIME-THROUGH
 10621                 GO TO 0561-CHECK-AH
 10622              ELSE
 10623                 MOVE ER-2609    TO WS-ERROR
 10624                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10625              END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 193
* EL050.cbl
 10626           END-IF
 10627        END-IF
 10628     END-IF
 10629     .
 10630 0561-EXIT.
 10631     EXIT.
 10632 0563-CHECK-LF.
 10633     IF (NO-LIFE-COVERAGE)
 10634        OR (NO-LF-BENEFIT-MATCH)
 10635        CONTINUE
 10636     ELSE
 10637        IF WS-LF-JOINT-INDICATOR = 'J'
 10638           IF AM-J-COM (SUB1) NUMERIC
 10639              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10640              IF (AM-COM-TYP (SUB1) = 'A')
 10641                 AND (WS-LF-PMF-COMM = ZEROS)
 10642                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10643              END-IF
 10644              CONTINUE
 10645           ELSE
 10646              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10647              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10648              MOVE PB-LIFE-OVERRIDE-L1
 10649                                 TO CTBL-BEN-TYPE
 10650              MOVE ZEROS         TO WS-SUB1
 10651                                    WS-COMMISSION
 10652              MOVE AM-J-COMA (SUB1)
 10653                                 TO CTBL-TABLE
 10654              PERFORM 8300-READ-CTBL-TABLE
 10655                                 THRU 8300-EXIT
 10656              IF CTBL-TABLE-FOUND
 10657                 IF (AM-COM-TYP (SUB1) = 'A')
 10658                    AND (WS-LF-PMF-COMM = ZEROS)
 10659                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10660                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10661                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10662                 END-IF
 10663                 CONTINUE
 10664              ELSE
 10665                 IF FIRST-TIME-THROUGH
 10666                    GO TO 0563-CHECK-LF
 10667                 ELSE
 10668                    MOVE ER-2609 TO WS-ERROR
 10669                    PERFORM 9900-ERROR-FORMAT
 10670                                 THRU 9900-EXIT
 10671*                   GO TO 0560-EDIT-CONTINUE
 10672                 END-IF
 10673              END-IF
 10674           END-IF
 10675        ELSE
 10676           IF AM-L-COM (SUB1) NUMERIC
 10677              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10678              IF (AM-COM-TYP (SUB1) = 'A')
 10679                 AND (WS-LF-PMF-COMM = ZEROS)
 10680                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10681              END-IF
 10682              CONTINUE
 10683           ELSE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 194
* EL050.cbl
 10684              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10685              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10686              MOVE PB-LIFE-OVERRIDE-L1
 10687                                 TO CTBL-BEN-TYPE
 10688              MOVE ZEROS         TO WS-SUB1
 10689                                    WS-COMMISSION
 10690              MOVE AM-L-COMA (SUB1)
 10691                                 TO CTBL-TABLE
 10692              PERFORM 8300-READ-CTBL-TABLE
 10693                                 THRU 8300-EXIT
 10694              IF CTBL-TABLE-FOUND
 10695                 CONTINUE
 10696              ELSE
 10697                 IF FIRST-TIME-THROUGH
 10698                    GO TO 0563-CHECK-LF
 10699                 ELSE
 10700                    MOVE ER-2609 TO WS-ERROR
 10701                    PERFORM 9900-ERROR-FORMAT
 10702                                 THRU 9900-EXIT
 10703                 END-IF
 10704              END-IF
 10705           END-IF
 10706        END-IF
 10707     END-IF
 10708     .
 10709 0563-EXIT.
 10710     EXIT.
 10711 0564-EDIT-CONTINUE.
 10712
 10713     IF  PB-COMPANY-ID EQUAL 'DMD'
 10714         IF PB-I-NUM-BILLED EQUAL ZEROS
 10715            MOVE ER-8148       TO WS-ERROR
 10716            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10717
 10718*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10719*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10720*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10721*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10722*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10723*         IF NO-CONVERSION-ERROR
 10724*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10725*         ELSE
 10726*             IF PB-COMPANY-ID EQUAL 'HAN'
 10727*                 MOVE ZEROS     TO PB-I-AGE.
 10728     IF PB-I-BIRTHDAY > LOW-VALUES
 10729        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10730        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10731        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10732        PERFORM 8500-DATE-CONVERT
 10733                                 THRU 8500-EXIT
 10734        IF NO-CONVERSION-ERROR
 10735           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10736           IF PB-I-AGE > ZEROS
 10737              IF WS-WORK-AGE NOT = PB-I-AGE
 10738                 MOVE ER-9501    TO WS-ERROR
 10739                 PERFORM 9900-ERROR-FORMAT
 10740                                 THRU 9900-EXIT
 10741              END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 195
* EL050.cbl
 10742           ELSE
 10743              MOVE WS-WORK-AGE   TO PB-I-AGE
 10744           END-IF
 10745        END-IF
 10746     END-IF
 10747     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10748                                   WS-INS-AGE-SET
 10749     IF PB-I-AGE = ZEROS
 10750        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10751           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10752                                   WS-INS-AGE-SET
 10753           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10754
 10755     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10756                                   WS-AH-EDIT-AGE.
 10757
 10758     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10759        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10760        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10761        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10762        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10763        IF NO-CONVERSION-ERROR
 10764           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10765           IF PB-I-JOINT-AGE > 0
 10766              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10767                 MOVE ER-9503    TO WS-ERROR
 10768                 PERFORM 9900-ERROR-FORMAT
 10769                                 THRU 9900-EXIT
 10770              END-IF
 10771           ELSE
 10772              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10773           END-IF
 10774        ELSE
 10775           MOVE ZEROS            TO PB-I-JOINT-AGE
 10776        END-IF
 10777     END-IF
 10778     IF PB-I-JOINT-AGE NOT NUMERIC
 10779        MOVE ZERO               TO PB-I-JOINT-AGE.
 10780
 10781     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10782                                   WS-JNT-AGE-SET
 10783     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10784        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10785           (WS-AH-JOINT-INDICATOR = 'J')
 10786           IF PB-I-JOINT-AGE = ZEROS
 10787               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10788                                          WS-JNT-AGE-SET
 10789               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10790           END-IF
 10791        END-IF
 10792     END-IF
 10793
 10794     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10795     IF WS-LF-JOINT-INDICATOR = 'J'
 10796        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10797        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10798            IF  PB-I-JOINT-AGE = ZERO
 10799                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 196
* EL050.cbl
 10800                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10801            ELSE
 10802                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10803                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10804                    IF PB-COMPANY-ID NOT = 'LBL'
 10805                        MOVE ER-2685    TO WS-ERROR
 10806                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10807
 10808     IF WS-AH-JOINT-INDICATOR = 'J'
 10809        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10810            IF  PB-I-JOINT-AGE = ZERO
 10811                MOVE ER-2686       TO WS-ERROR
 10812                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10813            ELSE
 10814                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10815                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10816                                           WS-EDIT-AGE
 10817                    IF PB-COMPANY-ID NOT = 'LBL'
 10818                        MOVE ER-2685    TO WS-ERROR
 10819                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10820
 10821******************************************************************
 10822*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10823******************************************************************
 10824
 10825     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10826        (WS-AH-SPECIAL-CALC-CD = 'O')
 10827        NEXT SENTENCE
 10828     ELSE
 10829        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10830          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10831           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10832            WS-AH-JOINT-INDICATOR = 'J')  AND
 10833           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10834            MOVE ER-2627             TO WS-ERROR
 10835            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10836
 10837     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10838        (WS-AH-SPECIAL-CALC-CD = 'O')
 10839         NEXT SENTENCE
 10840     ELSE
 10841         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10842            WS-AH-JOINT-INDICATOR = 'J'
 10843             IF PB-I-JOINT-INSURED = SPACES
 10844                 IF PB-COMPANY-ID NOT = 'JAL'
 10845                     MOVE ER-2696    TO WS-ERROR
 10846                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10847
 10848     IF PB-COMPANY-ID NOT = 'BOA'
 10849        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10850           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10851           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10852               PB-I-JOINT-INSURED NOT = SPACES)
 10853                MOVE ER-2691         TO WS-ERROR
 10854                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10855
 10856     IF PB-COMPANY-ID = 'BOA'
 10857        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 197
* EL050.cbl
 10858           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10859            IF PB-I-JOINT-AGE NOT = ZEROS
 10860                MOVE ER-2691         TO WS-ERROR
 10861                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10862
 10863     IF PB-COMPANY-ID = 'CRI'
 10864        IF PB-I-SIG-SW = 'J'
 10865           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10866              WS-AH-JOINT-INDICATOR NOT = 'J'
 10867              MOVE ER-2675       TO WS-ERROR
 10868              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10869
 10870     IF PB-COMPANY-ID = 'CRI'
 10871        IF PB-I-SIG-SW = 'S'
 10872           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10873              WS-AH-JOINT-INDICATOR = 'J'
 10874              MOVE ER-2676       TO WS-ERROR
 10875              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10876
 10877     IF PB-COMPANY-ID = 'CVL'
 10878         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10879            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10880              MOVE ER-2783           TO WS-ERROR
 10881              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10882     IF (WS-LF-JOINT-INDICATOR = 'J')
 10883        AND (WS-AH-JOINT-INDICATOR = 'J')
 10884        AND (PB-I-LF-TERM > 120)
 10885        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10886        MOVE ER-2783             TO WS-ERROR
 10887        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10888     END-IF
 10889     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10890
 10891     IF PB-I-INDV-GRP-OVRD = 'I'
 10892        MOVE ER-2666             TO WS-ERROR
 10893        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10894        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10895
 10896     IF PB-I-INDV-GRP-OVRD = 'G'
 10897        MOVE ER-2666             TO WS-ERROR
 10898        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10899        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10900
 10901     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10902        NEXT SENTENCE
 10903     ELSE
 10904        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10905
 10906     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10907        IF WS-ERROR = ER-2666
 10908           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10909           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10910
 10911     IF PB-COMPANY-ID = 'CID'
 10912        IF PB-STATE = 'UT' OR 'MO'
 10913           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10914                 OR '76' OR '77')
 10915                      OR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 198
* EL050.cbl
 10916               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10917                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10918                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10919                   OR '2K' OR '2L'))
 10920              AND PB-I-INDV-GRP-CD = 'I'
 10921              MOVE ER-2721             TO WS-ERROR
 10922              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10923           END-IF
 10924        END-IF
 10925     END-IF
 10926
 10927     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10928     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10929        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10930     ELSE
 10931        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10932     END-IF
 10933
 10934*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10935*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10936     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10937                                    ACCOUNT-AH-CK-SW.
 10938
 10939     IF PB-REISSUED-CERT       OR
 10940        PB-REIN-ONLY-CERT      OR
 10941        PB-POLICY-IS-DECLINED  OR
 10942        PB-POLICY-IS-VOIDED
 10943*       OR PB-MONTHLY-CERT
 10944         GO TO 3000-CONTINUE-EDIT.
 10945
 10946     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10947        IF WS-EDIT-AGE           > +65
 10948           MOVE ER-2709          TO WS-ERROR
 10949           PERFORM 9900-ERROR-FORMAT
 10950                                 THRU 9900-EXIT
 10951        ELSE
 10952           IF WS-EDIT-AGE        > +55
 10953              MOVE ER-2718       TO WS-ERROR
 10954              PERFORM 9900-ERROR-FORMAT
 10955                                 THRU 9900-EXIT
 10956           END-IF
 10957        END-IF
 10958     IF PB-COMPANY-ID = 'DCC'
 10959        IF WS-EDIT-AGE           > +65
 10960           MOVE ER-2709          TO WS-ERROR
 10961           PERFORM 9900-ERROR-FORMAT
 10962                                 THRU 9900-EXIT
 10963        END-IF
 10964     END-IF
 10965     .
 10966
 10967 0565-LIFE-PLAN-LIMIT-EDITS.
 10968
 10969     IF NOT LF-PLAN-MASTER-FOUND
 10970        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10971                                    EC-AM-LF-MAX-TOT-BEN
 10972        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10973
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 199
* EL050.cbl
 10974     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10975
 10976     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10977         IF PL-LM-AGE (1) = ZEROS
 10978             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10979
 10980     IF NO-LF-BENEFIT-MATCH          OR
 10981        WS-LF-BENEFIT-CD = ZEROS     OR
 10982        WS-LF-SPECIAL-CALC-CD = 'M'
 10983        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10984
 10985     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10986     MOVE +1                     TO SUB2.
 10987
 10988     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10989        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10990           MOVE +5   TO SUB2
 10991           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10992              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10993              (PL-LM-AGE (SUB2) EQUAL +0)
 10994              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10995              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10996
 10997     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10998
 10999     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11000                               + PB-I-LF-ALT-BENEFIT-AMT.
 11001
 11002 0568-CHECK-LIFE-ATT-AGE.
 11003
 11004     IF PL-ATT-AGE NUMERIC AND
 11005        PL-ATT-AGE > +0
 11006        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11007     END-IF
 11008*    IF PL-ATT-AGE NUMERIC AND
 11009*       PL-ATT-AGE > +0
 11010*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11011*       IF PB-I-BIRTHDAY > LOW-VALUES
 11012*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11013*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11014*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11015*          SET BIN-PLUS-ELAPSED  TO TRUE
 11016*          PERFORM 8500-DATE-CONVERT
 11017*                                THRU 8500-EXIT
 11018*          IF NO-CONVERSION-ERROR
 11019*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11020*             MOVE ER-2669       TO WS-ERROR
 11021*             PERFORM 9900-ERROR-FORMAT
 11022*                                THRU 9900-EXIT
 11023*          END-IF
 11024*       ELSE
 11025*          IF WS-ATT-AGE >= PL-ATT-AGE
 11026*             MOVE ER-2669       TO WS-ERROR
 11027*             PERFORM 9900-ERROR-FORMAT
 11028*                                THRU 9900-EXIT
 11029*          END-IF
 11030*       END-IF
 11031*    END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 200
* EL050.cbl
 11032     .
 11033 0570-CHECK-LIFE-LIMITS.
 11034
 11035     IF PB-COMPANY-ID EQUAL 'CRI'
 11036        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11037           IF SUB2 GREATER THAN +4
 11038              MOVE ER-2637 TO WS-ERROR
 11039              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11040              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11041
 11042     IF PB-COMPANY-ID  =  'NCL'
 11043        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11044            SUB2 GREATER THAN +8
 11045             MOVE 'U'         TO PB-BATCH-ENTRY
 11046             MOVE ER-2637     TO WS-ERROR
 11047             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11048             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11049
 11050     IF SUB2 > +8
 11051        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11052           AND (PB-I-SIG-SW = 'Y')
 11053           CONTINUE
 11054        ELSE
 11055           MOVE ER-2637          TO WS-ERROR
 11056           PERFORM 9900-ERROR-FORMAT
 11057                                 THRU 9900-EXIT
 11058        END-IF
 11059        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11060     END-IF
 11061     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11062     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11063     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11064
 11065     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11066        ADD +1  TO SUB2
 11067        GO TO 0570-CHECK-LIFE-LIMITS.
 11068
 11069     IF PB-COMPANY-ID = 'NCL'
 11070         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11071
 11072     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11073        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11074        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11075           AND (PB-I-SIG-SW = 'Y')
 11076           CONTINUE
 11077        ELSE
 11078           MOVE ER-2637          TO WS-ERROR
 11079           PERFORM 9900-ERROR-FORMAT
 11080                                 THRU 9900-EXIT
 11081        END-IF
 11082     END-IF
 11083     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11084
 11085
 11086 0570-CHECK-NCL-LIFE-LIMITS.
 11087
 11088     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11089        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 201
* EL050.cbl
 11090         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11091
 11092     IF APP-CERT-USED
 11093         IF SUB2  LESS THAN  +5
 11094             MOVE +5          TO SUB2
 11095             GO TO 0570-CHECK-LIFE-LIMITS.
 11096
 11097     MOVE ER-2637             TO WS-ERROR.
 11098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11099
 11100     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11101
 11102 0575-CHECK-NCL-SIG-SWITCH.
 11103
 11104     IF NOT APP-CERT-USED
 11105         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11106
 11107     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11108        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11109        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11110        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11111         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11112
 11113     IF SUB2 GREATER THAN +4
 11114         IF PL-LM-AGE (5) = ZEROS  AND
 11115            PL-LM-AGE (6) = ZEROS  AND
 11116            PL-LM-AGE (7) = ZEROS  AND
 11117            PL-LM-AGE (8) = ZEROS
 11118             MOVE  ER-1927        TO WS-ERROR
 11119             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11120             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11121         ELSE
 11122             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11123                 MOVE  ER-1920    TO WS-ERROR
 11124                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11125
 11126     IF PB-I-SIG-SW  = 'Y'
 11127       IF NOT PB-I-POLICY-ACCEPTED  AND
 11128          NOT PB-I-POLICY-DECLINED
 11129           MOVE 'U'               TO PB-BATCH-ENTRY
 11130           MOVE  ER-1926          TO WS-ERROR
 11131           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11132
 11133
 11134 0580-AH-PLAN-LIMIT-EDITS.
 11135
 11136     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11137        IF PB-I-AH-BENEFIT-AMT > +1250
 11138           MOVE ER-2702          TO WS-ERROR
 11139           PERFORM 9900-ERROR-FORMAT
 11140                                 THRU 9900-EXIT
 11141        END-IF
 11142     END-IF
 11143
 11144     IF (PB-COMPANY-ID = 'DCC')
 11145        AND (PB-MONTHLY-CERT)
 11146        IF PB-I-AH-BENEFIT-AMT > +3000
 11147           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 202
* EL050.cbl
 11148           PERFORM 9900-ERROR-FORMAT
 11149                                 THRU 9900-EXIT
 11150        END-IF
 11151     END-IF
 11152     IF NOT AH-PLAN-MASTER-FOUND
 11153        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11154        GO TO 3000-CONTINUE-EDIT.
 11155
 11156     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11157
 11158     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11159         IF PL-LM-AGE (1) = ZEROS
 11160             GO TO 3000-CONTINUE-EDIT.
 11161
 11162     IF NO-AH-BENEFIT-MATCH          OR
 11163        WS-AH-BENEFIT-CD = ZEROS     OR
 11164        WS-AH-SPECIAL-CALC-CD = 'M'
 11165        GO TO 3000-CONTINUE-EDIT.
 11166
 11167     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11168     MOVE +1                     TO SUB2.
 11169
 11170     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11171        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11172           MOVE +5 TO SUB2
 11173           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11174              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11175              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11176              (PL-LM-AGE (SUB2) EQUAL +0)
 11177              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11178              GO TO 3000-CONTINUE-EDIT.
 11179
 11180     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11181
 11182 0590-CHECK-AH-ATT-AGE.
 11183
 11184     IF PL-ATT-AGE NUMERIC AND
 11185        PL-ATT-AGE GREATER THAN +0
 11186        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11187     END-IF
 11188*       IF WS-ATT-AGE >= PL-ATT-AGE
 11189*          MOVE ER-3054          TO WS-ERROR
 11190*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11191     .
 11192 0597-CHECK-AH-LIMITS.
 11193
 11194     IF PB-COMPANY-ID EQUAL 'CRI'
 11195        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11196           IF SUB2 GREATER THAN +4
 11197              MOVE ER-2638       TO WS-ERROR
 11198              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11199              GO TO 3000-CONTINUE-EDIT.
 11200
 11201     IF PB-COMPANY-ID  =  'NCL'
 11202        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11203            SUB2 GREATER THAN +8
 11204             MOVE 'U'            TO PB-BATCH-ENTRY
 11205             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 203
* EL050.cbl
 11206             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11207             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11208
 11209     IF SUB2 > +8
 11210        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11211           AND (PB-I-SIG-SW = 'Y')
 11212           CONTINUE
 11213        ELSE
 11214           MOVE ER-2638          TO WS-ERROR
 11215           PERFORM 9900-ERROR-FORMAT
 11216                                 THRU 9900-EXIT
 11217        END-IF
 11218        GO TO 3000-CONTINUE-EDIT
 11219     END-IF
 11220
 11221     IF PB-COMPANY-ID = 'CRI'
 11222        IF WS-ERROR = ER-2638
 11223           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11224
 11225     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11226     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11227     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11228     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11229
 11230     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11231        ADD +1                   TO SUB2
 11232        GO TO 0597-CHECK-AH-LIMITS.
 11233
 11234     IF PB-COMPANY-ID = 'NCL'
 11235         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11236
 11237     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11238        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11239        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11240                                 > PL-LM-AMT (SUB2))
 11241        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11242           AND (PB-I-SIG-SW = 'Y')
 11243           CONTINUE
 11244        ELSE
 11245           MOVE ER-2638          TO WS-ERROR
 11246           PERFORM 9900-ERROR-FORMAT
 11247                                 THRU 9900-EXIT
 11248        END-IF
 11249     END-IF
 11250
 11251     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11252         IF  WS-ERROR    EQUAL    ER-2638
 11253             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11254                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11255                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11256                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11257                MOVE  ER-1910    TO  WS-ERROR
 11258                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11259
 11260     IF PB-COMPANY-ID = 'CRI'
 11261        IF WS-ERROR = ER-2638
 11262            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11263            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 204
* EL050.cbl
 11264            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11265
 11266     GO TO 3000-CONTINUE-EDIT.
 11267
 11268 0597-CHECK-NCL-AH-LIMITS.
 11269
 11270     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11271        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11272        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11273                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11274         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11275
 11276     IF APP-CERT-USED
 11277         IF SUB2  LESS THAN  +5
 11278             MOVE +5             TO SUB2
 11279             GO TO 0597-CHECK-AH-LIMITS.
 11280
 11281     MOVE ER-2638                TO WS-ERROR.
 11282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11283
 11284     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11285
 11286 0599-CHECK-NCL-SIG-SWITCH.
 11287
 11288     IF NOT APP-CERT-USED
 11289         GO TO 3000-CONTINUE-EDIT.
 11290
 11291     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11292        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11293        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11294        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11295         GO TO 3000-CONTINUE-EDIT.
 11296
 11297     IF SUB2 GREATER THAN +4
 11298         IF PL-LM-AGE (5) = ZEROS  AND
 11299            PL-LM-AGE (6) = ZEROS  AND
 11300            PL-LM-AGE (7) = ZEROS  AND
 11301            PL-LM-AGE (8) = ZEROS
 11302             MOVE  ER-1927        TO WS-ERROR
 11303             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11304             GO TO 3000-CONTINUE-EDIT
 11305         ELSE
 11306             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11307                 MOVE  ER-1920    TO WS-ERROR
 11308                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11309
 11310     IF PB-I-SIG-SW  = 'Y'
 11311       IF NOT PB-I-POLICY-ACCEPTED  AND
 11312          NOT PB-I-POLICY-DECLINED
 11313           MOVE 'U'               TO PB-BATCH-ENTRY
 11314           MOVE  ER-1926          TO WS-ERROR
 11315           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11316
 11317******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 205
* EL050.cbl
 11319
 11320 3000-CONTINUE-EDIT.
 11321
 11322     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11323     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11324     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11325     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11326     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11327
 11328     IF BROWSE-STARTED
 11329        PERFORM 9990-RETURN THRU 9990-EXIT
 11330        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11331
 11332     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11333        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11334        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11335        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11336*       MOVE 1                   TO DC-OPTION-CODE
 11337        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11338        IF DATE-CONVERSION-ERROR
 11339           MOVE ER-2622          TO WS-ERROR
 11340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11341        ELSE
 11342           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11343              MOVE ER-2623       TO WS-ERROR
 11344              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11345           ELSE
 11346              MOVE ER-2622       TO WS-ERROR
 11347              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11348
 11349     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11350     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11351     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11352*    MOVE 1                      TO DC-OPTION-CODE.
 11353     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11354     IF DATE-CONVERSION-ERROR
 11355        GO TO 3005-EDIT-CONTINUE
 11356     ELSE
 11357        IF DC-ELAPSED-DAYS GREATER +180
 11358           MOVE ER-2613          TO WS-ERROR
 11359           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11360        ELSE
 11361           IF DC-ELAPSED-DAYS GREATER +90
 11362              MOVE ER-2612       TO WS-ERROR
 11363              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11364           ELSE
 11365             IF DC-ELAPSED-DAYS GREATER +60
 11366                MOVE ER-2614     TO WS-ERROR
 11367                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11368
 11369 3005-EDIT-CONTINUE.
 11370
 11371     IF PB-CANCELLATION
 11372         GO TO 3700-EDIT-CANCEL.
 11373
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 206
* EL050.cbl
 11375******************************************************************
 11376*                  E D I T   I S S U E                           *
 11377******************************************************************
 11378
 11379 3020-EDIT-ISSUE.
 11380
 11381      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11382      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11383      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11384      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11385      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11386
 11387     IF PB-ISSUE-FORCE
 11388        OR PB-ISSUE-DATE-FORCED
 11389        OR PB-FORCE-OFF
 11390        OR PB-OVERCHARGE-FORCE
 11391        CONTINUE
 11392     ELSE
 11393        MOVE ER-2670             TO WS-ERROR
 11394        PERFORM 9900-ERROR-FORMAT
 11395                                 THRU 9900-EXIT
 11396     END-IF
 11397     .
 11398 3022-SET-POLICY-STATUS.
 11399
 11400     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11401
 11402     IF (PB-REISSUED-CERT)
 11403             OR
 11404        ((PB-COMPANY-ID NOT = 'DCC')
 11405         AND (PB-MONTHLY-CERT))
 11406         MOVE '5'                TO PB-I-ENTRY-STATUS
 11407         MOVE 'E'                TO PB-BATCH-ENTRY
 11408     END-IF
 11409
 11410     IF PB-COMPANY-ID = 'DCC'
 11411        IF PB-MONTHLY-CERT
 11412           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11413        END-IF
 11414        IF PB-CASH-CERT
 11415           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11416        END-IF
 11417     END-IF
 11418     IF PB-POLICY-IS-DECLINED
 11419         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11420     IF PB-POLICY-IS-VOIDED
 11421         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11422     IF PB-NEEDS-UNDERWRITING
 11423         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11424     IF PB-REIN-ONLY-CERT
 11425         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11426     IF PB-PREM-ACCTNG-ONLY
 11427         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11428
 11429     MOVE SPACE                  TO PB-I-OB-FLAG.
 11430
 11431     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11432         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 207
* EL050.cbl
 11433         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11434         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11435
 11436     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11437        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11438           MOVE 'Z'             TO PB-I-OB-FLAG.
 11439
 11440     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11441        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11442           MOVE 'Z'             TO PB-I-OB-FLAG.
 11443
 11444     IF ACCOUNT-MAST-FOUND
 11445         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11446         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11447         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11448         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11449         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11450         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11451         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11452     END-IF
 11453
 11454     IF ACCOUNT-MAST-FOUND
 11455        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11456         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11457
 11458     IF (ACCOUNT-MAST-FOUND)
 11459        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11460        IF PB-REISSUED-CERT
 11461           CONTINUE
 11462        ELSE
 11463           MOVE ER-2608          TO WS-ERROR
 11464           PERFORM 9900-ERROR-FORMAT
 11465                                 THRU 9900-EXIT
 11466         END-IF
 11467     END-IF
 11468
 11469     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11470        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11471        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11472
 11473**********   DMD CUSTOM CODE FOLLOWS  **********
 11474 3024-EDIT-DMD-FIELDS.
 11475     IF PB-COMPANY-ID NOT = 'DMD'
 11476        GO TO 3025-EDIT-REINSURANCE.
 11477
 11478*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11479*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11480*** ERROR IF THEY ARE NOT EQUAL.
 11481
 11482     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11483     SET BIN-TO-GREG               TO TRUE.
 11484     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11485     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11486**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11487
 11488     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11489     SET BIN-TO-GREG               TO TRUE.
 11490     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 208
* EL050.cbl
 11491     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11492**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11493
 11494     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11495        MOVE ER-8116               TO WS-ERROR
 11496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11497
 11498     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11499
 11500     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11501                                      WK-FULL-CERT-NO.
 11502     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11503
 11504     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11505
 11506     IF PB-VALID-LIFE
 11507        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11508     ELSE
 11509        IF PB-VALID-AH
 11510          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11511
 11512
 11513     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11514     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11515     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11516                                      DCUA-UNDRWRTR-CODE
 11517                                      DCUA-UNDRWRTR-GROUP-CODE
 11518                                      DCUA-RETURN-CODE.
 11519
 11520****************************************************************
 11521*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11522***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11523***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11524***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11525***   TO THIS RECORD.                                        ***
 11526****************************************************************
 11527     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11528     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11529     IF DCUA-SUCCESSFUL-PROCESS
 11530        GO TO 3024-EDIT-DL7-CONT.
 11531
 11532     IF DCUA-RETURN-CODE EQUAL '01'
 11533        MOVE ER-8110               TO WS-ERROR
 11534        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL7-CONT.
 11537
 11538     IF DCUA-RETURN-CODE EQUAL '02'
 11539        MOVE ER-8111               TO WS-ERROR
 11540        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542        GO TO 3024-EDIT-DL7-CONT.
 11543
 11544     IF DCUA-RETURN-CODE EQUAL '03'
 11545        MOVE ER-8074               TO WS-ERROR
 11546        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11548        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 209
* EL050.cbl
 11549
 11550     IF DCUA-RETURN-CODE EQUAL '04'
 11551        MOVE ER-8075               TO WS-ERROR
 11552        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11554        GO TO 3024-EDIT-DL7-CONT.
 11555
 11556     IF DCUA-RETURN-CODE EQUAL '05'
 11557        MOVE ER-8076               TO WS-ERROR
 11558        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11560        GO TO 3024-EDIT-DL7-CONT.
 11561
 11562     IF DCUA-RETURN-CODE EQUAL '06'
 11563        MOVE ER-8077               TO WS-ERROR
 11564        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL7-CONT.
 11567
 11568     IF DCUA-RETURN-CODE EQUAL '07'
 11569        MOVE ER-8078               TO WS-ERROR
 11570        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL7-CONT.
 11573
 11574     IF DCUA-RETURN-CODE EQUAL 'E1'
 11575        MOVE ER-8079               TO WS-ERROR
 11576        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578        GO TO 3024-EDIT-DL7-CONT.
 11579
 11580     IF DCUA-RETURN-CODE EQUAL 'E2'
 11581        MOVE ER-8080               TO WS-ERROR
 11582        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11583        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584        GO TO 3024-EDIT-DL7-CONT.
 11585
 11586     IF DCUA-RETURN-CODE EQUAL 'E3'
 11587        MOVE ER-8098               TO WS-ERROR
 11588        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL7-CONT.
 11591
 11592     IF DCUA-RETURN-CODE EQUAL 'C1'
 11593        MOVE ER-8099               TO WS-ERROR
 11594        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11596        GO TO 3024-EDIT-DL7-CONT.
 11597
 11598     IF DCUA-RETURN-CODE EQUAL 'U1'
 11599        MOVE ER-8109               TO WS-ERROR
 11600        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11602        GO TO 3024-EDIT-DL7-CONT.
 11603
 11604     IF DCUA-RETURN-CODE EQUAL 'N1'
 11605        MOVE ER-8112               TO WS-ERROR
 11606        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 210
* EL050.cbl
 11607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11608        GO TO 3024-EDIT-DL7-CONT.
 11609
 11610     IF DCUA-RETURN-CODE EQUAL 'N2'
 11611        MOVE ER-8113               TO WS-ERROR
 11612        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL7-CONT.
 11615
 11616     IF DCUA-RETURN-CODE EQUAL 'N3'
 11617        MOVE ER-8114               TO WS-ERROR
 11618        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL7-CONT.
 11621
 11622     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11623     MOVE ER-8097                  TO WS-ERROR.
 11624     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11625     GO TO 3024-EDIT-DL7-CONT.
 11626
 11627 3024-EDIT-DL7-CONT.
 11628
 11629     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11630     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11631     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11632        NEXT SENTENCE
 11633     ELSE
 11634        MOVE ER-9263               TO WS-ERROR
 11635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11636
 11637******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11638******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11639     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11640        NEXT SENTENCE
 11641     ELSE
 11642        MOVE ER-8039               TO WS-ERROR
 11643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11644
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 211
* EL050.cbl
 11646****************************************************************
 11647*** VALIDATE STATE  : DLO022                                 ***
 11648****************************************************************
 11649     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11650     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11651
 11652     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11653     IF DVSC-SUCCESSFUL-EDIT
 11654        GO TO 3024-EDIT-DL22-CONT.
 11655
 11656     IF DVSC-RETURN-CODE EQUAL '01'
 11657        MOVE ER-8300               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL22-CONT.
 11660
 11661     IF DVSC-RETURN-CODE EQUAL '02'
 11662        MOVE ER-8301               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL22-CONT.
 11665
 11666     IF DVSC-RETURN-CODE EQUAL '03'
 11667        MOVE ER-8302               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL22-CONT.
 11670
 11671     IF DVSC-RETURN-CODE EQUAL 'N1'
 11672        MOVE ER-8304               TO WS-ERROR
 11673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11674        GO TO 3024-EDIT-DL22-CONT.
 11675
 11676     MOVE ER-8303                  TO WS-ERROR
 11677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11678
 11679 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 212
* EL050.cbl
 11681****************************************************************
 11682*** VALIDATE LOAN OFFICER : DLO021                           ***
 11683****************************************************************
 11684
 11685     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11686     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11687     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11688     IF DVLO-SUCCESSFUL-EDIT
 11689        GO TO 3024-EDIT-DL21-CONT.
 11690
 11691     IF DVLO-RETURN-CODE EQUAL '01'
 11692        MOVE ER-8081               TO WS-ERROR
 11693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11694        GO TO 3024-EDIT-DL21-CONT.
 11695
 11696     IF DVLO-RETURN-CODE EQUAL '02'
 11697        MOVE ER-8082               TO WS-ERROR
 11698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699        GO TO 3024-EDIT-DL21-CONT.
 11700
 11701     IF DVLO-RETURN-CODE EQUAL '03'
 11702        MOVE ER-8083               TO WS-ERROR
 11703        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11704        GO TO 3024-EDIT-DL21-CONT.
 11705
 11706     IF DVLO-RETURN-CODE EQUAL '04'
 11707        MOVE ER-8084               TO WS-ERROR
 11708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11709        GO TO 3024-EDIT-DL21-CONT.
 11710
 11711     IF DVLO-RETURN-CODE EQUAL '05'
 11712        MOVE ER-8085               TO WS-ERROR
 11713        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11714        GO TO 3024-EDIT-DL21-CONT.
 11715
 11716     MOVE ER-7825                  TO WS-ERROR
 11717     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11718     GO TO 3024-EDIT-DL21-CONT.
 11719
 11720 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 213
* EL050.cbl
 11722
 11723****************************************************************
 11724*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11725****************************************************************
 11726
 11727     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11728     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11729     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11730     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11731     IF DIPF-SUCCESSFUL-EDIT
 11732        GO TO 3024-EDIT-DL02-CONT.
 11733
 11734     IF DIPF-RETURN-CODE EQUAL '01'
 11735        MOVE ER-8086               TO WS-ERROR
 11736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11737        GO TO 3024-EDIT-DL02-CONT.
 11738
 11739     IF DIPF-RETURN-CODE EQUAL '02'
 11740        MOVE ER-8087               TO WS-ERROR
 11741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11742        GO TO 3024-EDIT-DL02-CONT.
 11743
 11744     IF DIPF-RETURN-CODE EQUAL '03'
 11745        MOVE ER-8088               TO WS-ERROR
 11746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747        GO TO 3024-EDIT-DL02-CONT.
 11748
 11749     MOVE ER-8095                  TO WS-ERROR
 11750     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11751     GO TO 3024-EDIT-DL02-CONT.
 11752
 11753 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 214
* EL050.cbl
 11755
 11756****************************************************************
 11757*** VALIDATE BANK ID : DLO003                                ***
 11758****************************************************************
 11759
 11760     MOVE WK-GREG-CENT           TO WCG-CENT.
 11761     MOVE WK-GREG-YYMM           TO WCG-REST.
 11762     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11763        MOVE ER-8040               TO WS-ERROR
 11764        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11765
 11766     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11767     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11768     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11769     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11770     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11771     IF DVBI-SUCCESSFUL-EDIT
 11772        GO TO 3024-EDIT-DL03-CONT.
 11773
 11774     IF DVBI-RETURN-CODE EQUAL '01'
 11775        MOVE ER-8089               TO WS-ERROR
 11776        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11777        GO TO 3024-EDIT-DL03-CONT.
 11778
 11779     IF DVBI-RETURN-CODE EQUAL '02'
 11780        MOVE ER-8090               TO WS-ERROR
 11781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11782        GO TO 3024-EDIT-DL03-CONT.
 11783
 11784     IF DVBI-RETURN-CODE EQUAL '03'
 11785        MOVE ER-8091               TO WS-ERROR
 11786        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11787        GO TO 3024-EDIT-DL03-CONT.
 11788
 11789     IF DVBI-RETURN-CODE EQUAL '04'
 11790        MOVE ER-8092               TO WS-ERROR
 11791        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792        GO TO 3024-EDIT-DL03-CONT.
 11793
 11794     IF DVBI-RETURN-CODE EQUAL '05'
 11795        MOVE ER-8093               TO WS-ERROR
 11796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11797        GO TO 3024-EDIT-DL03-CONT.
 11798
 11799     IF DVBI-RETURN-CODE EQUAL '06'
 11800        MOVE ER-8094               TO WS-ERROR
 11801        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11802        GO TO 3024-EDIT-DL03-CONT.
 11803
 11804     MOVE ER-8096                  TO WS-ERROR
 11805     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11806     GO TO 3024-EDIT-DL03-CONT.
 11807
 11808 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 215
* EL050.cbl
 11810
 11811     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11812        NEXT SENTENCE
 11813     ELSE
 11814        MOVE ER-8042               TO WS-ERROR
 11815        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11816
 11817     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11818     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11819     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11820
 11821     IF DMPF-RETURN-CODE = '01'
 11822        MOVE ER-8067               TO WS-ERROR
 11823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11824        GO TO 3024-EDIT-DL01-CONT.
 11825
 11826     IF DMPF-RETURN-CODE = '02'
 11827        MOVE ER-8068               TO WS-ERROR
 11828        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11829        GO TO 3024-EDIT-DL01-CONT.
 11830
 11831     IF DMPF-RETURN-CODE = '03'
 11832        MOVE ER-8069               TO WS-ERROR
 11833        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11834        GO TO 3024-EDIT-DL01-CONT.
 11835
 11836     IF DMPF-RETURN-CODE = 'E1'
 11837        MOVE ER-8070               TO WS-ERROR
 11838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11839        GO TO 3024-EDIT-DL01-CONT.
 11840
 11841     IF DMPF-RETURN-CODE = 'N1'
 11842        MOVE ER-8071               TO WS-ERROR
 11843        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11844        GO TO 3024-EDIT-DL01-CONT.
 11845
 11846     IF DMPF-RETURN-CODE NOT = 'OK'
 11847        MOVE ER-8072               TO WS-ERROR
 11848        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11849
 11850 3024-EDIT-DL01-CONT.
 11851******************************************************************
 11852***  VALIDATES RATE CODES : DLO017                             ***
 11853******************************************************************
 11854
 11855      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11856      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11857      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11858      IF DVRC-SUCCESSFUL-EDIT
 11859        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11860        GO TO 3024-CHECK-VALID-RATE.
 11861
 11862      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11863
 11864      IF DVRC-RETURN-CODE EQUAL '01'
 11865         MOVE ER-7817                   TO WS-ERROR
 11866         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11867         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 216
* EL050.cbl
 11868
 11869      IF DVRC-RETURN-CODE EQUAL '02'
 11870         MOVE ER-7818                   TO WS-ERROR
 11871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11872         GO TO 3025-EDIT-REINSURANCE.
 11873
 11874      IF DVRC-RETURN-CODE EQUAL '03'
 11875         MOVE ER-7819                   TO WS-ERROR
 11876         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11877         GO TO 3025-EDIT-REINSURANCE.
 11878
 11879       MOVE ER-7820                     TO WS-ERROR.
 11880       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11881       GO TO 3025-EDIT-REINSURANCE.
 11882
 11883******************************************************************
 11884***  GET PREMIUM RATES : DLO011                                ***
 11885******************************************************************
 11886
 11887 3024-CHECK-VALID-RATE.
 11888
 11889     IF VALID-RATE-CODE
 11890        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11891        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11892        MOVE SPACES                TO DPRB-RETURN-CODE
 11893        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11894     ELSE
 11895         GO TO 3025-EDIT-REINSURANCE.
 11896
 11897      IF DPRB-SUCCESSFUL-PROCESS
 11898         IF PB-VALID-LIFE
 11899             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11900             GO TO 3025-EDIT-REINSURANCE
 11901         ELSE
 11902             IF PB-VALID-AH
 11903                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11904                 GO TO 3025-EDIT-REINSURANCE.
 11905
 11906      IF DPRB-RETURN-CODE EQUAL '01'
 11907         MOVE ER-7812                   TO WS-ERROR
 11908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11909         GO TO 3025-EDIT-REINSURANCE.
 11910
 11911      IF DPRB-RETURN-CODE EQUAL '02'
 11912         MOVE ER-7813                   TO WS-ERROR
 11913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11914         GO TO 3025-EDIT-REINSURANCE.
 11915
 11916      IF DPRB-RETURN-CODE EQUAL '03'
 11917         MOVE ER-7814                   TO WS-ERROR
 11918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11919         GO TO 3025-EDIT-REINSURANCE.
 11920
 11921      IF DPRB-RETURN-CODE EQUAL '04'
 11922         IF NOT DPRB-1ST-TIME
 11923            MOVE ER-7815                   TO WS-ERROR
 11924            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11925            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 217
* EL050.cbl
 11926          ELSE
 11927         IF PB-VALID-LIFE
 11928            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11929          ELSE
 11930            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11931         END-IF
 11932         MOVE SPACES                TO DOCC-RETURN-CODE
 11933         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11934         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11935         IF DOCC-RETURN-CODE = 'OK'
 11936             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11937             GO TO 3024-CHECK-VALID-RATE
 11938           ELSE
 11939             MOVE ER-7823               TO WS-ERROR
 11940             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11941             GO TO 3025-EDIT-REINSURANCE.
 11942
 11943       MOVE ER-7816                     TO WS-ERROR.
 11944       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11945       GO TO 3025-EDIT-REINSURANCE.
 11946
 11947**********   DMD CUSTOM CODE ABOVE    **********
 11948
 11949 3025-EDIT-REINSURANCE.
 11950     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11951         GO TO 3027-EDIT-CONTINUE.
 11952
 11953     MOVE LOW-VALUES               TO ERREIN-KEY.
 11954     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11955     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11956                                      REIN-CODE-2
 11957                                      REIN-CODE-3.
 11958     MOVE 'A'                      TO REIN-TYPE.
 11959
 11960     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11961
 11962     MOVE '3026' TO REIN-SW.
 11963     MOVE ' '                   TO WS-REIN-READ-SW.
 11964
 11965     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11966     IF REIN-TABLE-NOT-FOUND
 11967         GO TO 3026-NO-SPEC-TABLE.
 11968
 11969     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11970     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11971                                   WS-NSP-ST-CD-LF.
 11972     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11973                                   WS-NSP-ST-CD-AH.
 11974
 11975     GO TO 3040-EDIT-CONTINUE.
 11976
 11977 3026-NO-SPEC-TABLE.
 11978
 11979     MOVE ER-2664                TO WS-ERROR.
 11980     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11981     GO TO 3040-EDIT-CONTINUE.
 11982
 11983 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 218
* EL050.cbl
 11984
 11985     IF PB-I-REIN-TABLE = SPACES
 11986       GO TO 3040-EDIT-CONTINUE.
 11987
 11988     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11989          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11990          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11991           GO TO 3040-EDIT-CONTINUE.
 11992
 11993     MOVE LOW-VALUES            TO ERREIN-KEY.
 11994     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11995     MOVE 'A'                   TO REIN-TYPE.
 11996     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11997
 11998     MOVE '3028'                TO REIN-SW.
 11999     MOVE ' '                   TO WS-REIN-READ-SW.
 12000
 12001     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12002     IF REIN-TABLE-NOT-FOUND
 12003         GO TO 3028-NO-REIN-TABLE.
 12004
 12005     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12006     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12007                                   WS-NSP-ST-CD-LF.
 12008     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12009                                   WS-NSP-ST-CD-AH.
 12010
 12011     GO TO 3040-EDIT-CONTINUE.
 12012
 12013 3028-NO-REIN-TABLE.
 12014
 12015     MOVE ER-2615                TO WS-ERROR.
 12016     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12017     GO TO 3040-EDIT-CONTINUE.
 12018
 12019 3040-EDIT-CONTINUE.
 12020
 12021     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12022         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12023
 12024     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12025         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12026
 12027     IF (NOT PB-REISSUED-CERT)
 12028        AND (NOT PB-MONTHLY-CERT)
 12029        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12030            MOVE '001'           TO PB-I-LF-TERM
 12031            MOVE 'M'             TO PB-I-INSURED-SEX.
 12032
 12033     IF (NOT PB-REISSUED-CERT)
 12034        AND (NOT PB-MONTHLY-CERT)
 12035        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12036            MOVE '001'           TO PB-I-AH-TERM
 12037            MOVE 'M'             TO PB-I-INSURED-SEX.
 12038
 12039 3040-EDIT-1ST-PMT-DT.
 12040     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12041     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 219
* EL050.cbl
 12042         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12043
 12044******************************************************************
 12045*                                                                *
 12046*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12047*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12048*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12049*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12050*                                                                *
 12051******************************************************************
 12052
 12053     IF PB-EFF-DT-PROCESSING
 12054        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12055                                    PB-I-LF-EXPIRE-DT
 12056                                    PB-I-AH-EXPIRE-DT
 12057        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12058        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12059        MOVE ZERO                TO DC-ELAPSED-DAYS
 12060        MOVE +1                  TO DC-ELAPSED-MONTHS
 12061        SET BIN-PLUS-ELAPSED     TO TRUE
 12062*       MOVE 6                   TO DC-OPTION-CODE
 12063        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12064        IF NO-CONVERSION-ERROR
 12065           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12066
 12067******************************************************************
 12068*                                                                *
 12069*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12070*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12071*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12072*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12073*                                                                *
 12074******************************************************************
 12075
 12076     IF PB-EXT-DAYS-PROCESSING
 12077          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12078                                         PB-I-LF-EXPIRE-DT
 12079                                         PB-I-AH-EXPIRE-DT
 12080          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12081          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12082          MOVE +1                     TO DC-ELAPSED-MONTHS
 12083          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12084          SET BIN-PLUS-ELAPSED        TO TRUE
 12085*         MOVE 6                      TO DC-OPTION-CODE
 12086          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12087          IF NO-CONVERSION-ERROR
 12088             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12089
 12090******************************************************************
 12091*                                                                *
 12092*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12093*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12094*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12095*        (EXPIRE DATE - (TERM -1))  *  -1.
 12096*                                                                *
 12097******************************************************************
 12098
 12099     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 220
* EL050.cbl
 12100        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12101           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12102              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12103              MOVE PB-I-AH-TERM      TO WS-TERM
 12104           ELSE
 12105              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12106              MOVE PB-I-LF-TERM      TO WS-TERM
 12107        ELSE
 12108           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12109              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12110              MOVE PB-I-LF-TERM      TO WS-TERM
 12111           ELSE
 12112              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12113              MOVE PB-I-AH-TERM      TO WS-TERM.
 12114
 12115     IF PB-EXPIRE-DT-PROCESSING
 12116        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12117        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12118        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12119        MOVE ZERO                TO DC-ELAPSED-DAYS
 12120                                    DC-ODD-DAYS-OVER
 12121          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12122          SET BIN-PLUS-ELAPSED    TO TRUE
 12123*         MOVE 6                  TO DC-OPTION-CODE
 12124          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12125          IF NO-CONVERSION-ERROR
 12126             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12127
 12128******************************************************************
 12129*                                                                *
 12130*            1ST PAYMENT DATE PROCESSING                         *
 12131*                                                                *
 12132******************************************************************
 12133
 12134     IF PB-1ST-PMT-DT-PROCESSING
 12135        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12136                                    PB-I-AH-EXPIRE-DT
 12137        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12138
 12139     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12140         NEXT SENTENCE
 12141     ELSE
 12142         MOVE ER-2680                 TO WS-ERROR
 12143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12144         GO TO 3060-ORIG-TERM-CHECK.
 12145
 12146     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12147     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12148     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12149*    MOVE 1                      TO DC-OPTION-CODE.
 12150     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12151                                    DC-ELAPSED-DAYS
 12152                                    DC-ODD-DAYS-OVER.
 12153
 12154     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12155
 12156     IF DATE-CONVERSION-ERROR
 12157        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 221
* EL050.cbl
 12158
 12159     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12160     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12161        AND (WS-LF-COVERAGE-TYPE = 'L')
 12162        IF (DC-ELAPSED-MONTHS > 1)
 12163                      OR
 12164           ((DC-ELAPSED-MONTHS = 1)
 12165           AND (DC-ODD-DAYS-OVER > 0))
 12166           MOVE ER-2882          TO WS-ERROR
 12167           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12168        END-IF
 12169     END-IF
 12170     if dc-elapsed-months > 0
 12171        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12172        + dc-odd-days-over
 12173     end-if
 12174     IF PB-EXT-DAYS-PROCESSING
 12175        CONTINUE
 12176     ELSE
 12177        IF DC-ELAPSED-MONTHS = +0
 12178           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12179        ELSE
 12180           IF (WS-LF-EARNINGS-CALC = '4')
 12181              AND (DC-ELAPSED-MONTHS > ZERO)
 12182              AND (DC-ELAPSED-DAYS > ZERO)
 12183              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12184           ELSE
 12185              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12186                                 THRU 6499-EXIT
 12187              MOVE WS-ODD-DAYS-OVER
 12188                                 TO PB-I-EXTENTION-DAYS
 12189           END-IF
 12190        END-IF
 12191     END-IF
 12192******************************************************************
 12193*                                                                *
 12194*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12195*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12196*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12197*            AND ANY ODD DAYS.                                   *
 12198*                                                                *
 12199******************************************************************
 12200
 12201     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12202                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12203     IF WS-LF-EARNINGS-CALC NOT = '4'
 12204        IF DC-ELAPSED-DAYS > ZEROS
 12205           MOVE ER-2681          TO WS-ERROR
 12206           PERFORM 9900-ERROR-FORMAT
 12207                                 THRU 9900-EXIT
 12208        END-IF
 12209     END-IF
 12210
 12211     IF WS-LF-EARNINGS-CALC NOT = '4'
 12212        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12213           MOVE ER-2681          TO WS-ERROR
 12214           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12215
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 222
* EL050.cbl
 12216     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12217        (PB-I-LF-TERM NOT = ZERO) AND
 12218         NOT NO-LIFE-COVERAGE
 12219          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12220          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12221          IF WS-LF-EARNINGS-CALC = '4'
 12222             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12223             PB-I-PAY-FREQUENCY
 12224          END-IF
 12225          MOVE ZERO              TO DC-ELAPSED-DAYS
 12226                                    DC-ODD-DAYS-OVER
 12227          MOVE 1                 TO DC-END-OF-MONTH
 12228          SET BIN-PLUS-ELAPSED        TO TRUE
 12229*         MOVE 6                 TO DC-OPTION-CODE
 12230          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12231          IF NO-CONVERSION-ERROR
 12232             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12233             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12234                (WS-LF-SPECIAL-CALC-CD = 'L')
 12235                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12236                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12237                  MOVE +1             TO DC-ELAPSED-MONTHS
 12238                  SET BIN-PLUS-ELAPSED  TO TRUE
 12239*                 MOVE 6              TO DC-OPTION-CODE
 12240                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12241                  IF NO-CONVERSION-ERROR
 12242                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12243
 12244* okay, i had to move the new att age edit down here because the
 12245* expiration date could get recalculated and i need the exp date
 12246     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12247        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12248        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12249        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12250           AND ZEROS
 12251           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12252           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12253           SET ELAPSED-BETWEEN-BIN TO TRUE
 12254           PERFORM 8500-DATE-CONVERT
 12255                                 THRU 8500-EXIT
 12256           IF NO-CONVERSION-ERROR
 12257              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12258                 MOVE ER-2669       TO WS-ERROR
 12259*                PERFORM 9900-ERROR-FORMAT
 12260*                                THRU 9900-EXIT
 12261              END-IF
 12262           END-IF
 12263        ELSE
 12264           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12265           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12266              MOVE ER-2669       TO WS-ERROR
 12267*             PERFORM 9900-ERROR-FORMAT
 12268*                                THRU 9900-EXIT
 12269           ELSE
 12270              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12271                 MOVE ER-1570    TO WS-ERROR
 12272                 PERFORM 9900-ERROR-FORMAT
 12273                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 223
* EL050.cbl
 12274              END-IF
 12275           END-IF
 12276        END-IF
 12277        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12278           AND ZEROS
 12279           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12280           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12281           SET ELAPSED-BETWEEN-BIN TO TRUE
 12282           PERFORM 8500-DATE-CONVERT
 12283                                 THRU 8500-EXIT
 12284           IF NO-CONVERSION-ERROR
 12285              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12286                 MOVE ER-2669       TO WS-ERROR
 12287*                PERFORM 9900-ERROR-FORMAT
 12288*                                THRU 9900-EXIT
 12289              END-IF
 12290           END-IF
 12291        ELSE
 12292           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12293             (PB-I-LF-TERM / 12)
 12294           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12295              MOVE ER-2669       TO WS-ERROR
 12296*             PERFORM 9900-ERROR-FORMAT
 12297*                                THRU 9900-EXIT
 12298           ELSE
 12299              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12300                 MOVE ER-1571    TO WS-ERROR
 12301                 PERFORM 9900-ERROR-FORMAT
 12302                                 THRU 9900-EXIT
 12303              END-IF
 12304           END-IF
 12305        END-IF
 12306        IF WS-ERROR = ER-2669
 12307           PERFORM 9900-ERROR-FORMAT
 12308                                 THRU 9900-EXIT
 12309        END-IF
 12310     END-IF
 12311     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12312        (PB-I-AH-TERM NOT = ZERO) AND
 12313         NOT NO-AH-COVERAGE
 12314          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12315             AND (PB-COMPANY-ID = 'DCC')
 12316             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12317             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12318          ELSE
 12319             IF WS-LF-EARNINGS-CALC = '4'
 12320                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12321                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12322                PB-I-PAY-FREQUENCY
 12323             ELSE
 12324                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12325                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12326             END-IF
 12327          END-IF
 12328          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12329                                         DC-ODD-DAYS-OVER
 12330          MOVE 1                      TO DC-END-OF-MONTH
 12331          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 224
* EL050.cbl
 12332*         MOVE 6                      TO DC-OPTION-CODE
 12333          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12334          IF NO-CONVERSION-ERROR
 12335             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12336     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12337        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12338        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12339        IF PB-I-BIRTHDAY > LOW-VALUES
 12340           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12341           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12342           SET ELAPSED-BETWEEN-BIN TO TRUE
 12343           PERFORM 8500-DATE-CONVERT
 12344                                 THRU 8500-EXIT
 12345           IF NO-CONVERSION-ERROR
 12346              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12347                 MOVE ER-3054       TO WS-ERROR
 12348*                PERFORM 9900-ERROR-FORMAT
 12349*                                THRU 9900-EXIT
 12350              END-IF
 12351           END-IF
 12352        ELSE
 12353           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12354           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12355              MOVE ER-3054       TO WS-ERROR
 12356*             PERFORM 9900-ERROR-FORMAT
 12357*                                THRU 9900-EXIT
 12358           END-IF
 12359        END-IF
 12360        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12361           AND ZEROS
 12362           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12363           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12364           SET ELAPSED-BETWEEN-BIN TO TRUE
 12365           PERFORM 8500-DATE-CONVERT
 12366                                 THRU 8500-EXIT
 12367           IF NO-CONVERSION-ERROR
 12368              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12369                 MOVE ER-3054       TO WS-ERROR
 12370*                PERFORM 9900-ERROR-FORMAT
 12371*                                THRU 9900-EXIT
 12372              END-IF
 12373           END-IF
 12374        ELSE
 12375           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12376             (PB-I-AH-TERM / 12)
 12377           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12378              MOVE ER-3054       TO WS-ERROR
 12379*             PERFORM 9900-ERROR-FORMAT
 12380*                                THRU 9900-EXIT
 12381           END-IF
 12382        END-IF
 12383        IF WS-ERROR = ER-3054
 12384           PERFORM 9900-ERROR-FORMAT
 12385                                 THRU 9900-EXIT
 12386        END-IF
 12387     END-IF
 12388     MOVE SPACE                       TO DC-END-OF-MONTH.
 12389
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 225
* EL050.cbl
 12390     IF PB-COMPANY-ID = 'NCB'
 12391        GO TO 3040-EDIT-EXTENSION-DAYS.
 12392
 12393     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12394       AND
 12395        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12396        NEXT SENTENCE
 12397     ELSE
 12398        GO TO 3040-EDIT-EXTENSION-DAYS.
 12399
 12400     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12401        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12402        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12403     ELSE
 12404        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12405        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12406
 12407     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12408*    MOVE '1'      TO DC-OPTION-CODE
 12409     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12410     IF (NO-CONVERSION-ERROR)
 12411        AND (DC-ELAPSED-MONTHS > +1)
 12412        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12413        MOVE ER-2668   TO WS-ERROR
 12414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12415
 12416 3040-EDIT-EXTENSION-DAYS.
 12417
 12418     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12419        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12420         GO TO 3050-EDIT-TERM-IN-DAYS
 12421     ELSE
 12422         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12423
 12424     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12425         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12426     ELSE
 12427        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12428           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12429           MOVE ER-2681         TO WS-ERROR
 12430           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12431
 12432     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12433        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12434        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12435         GO TO 3060-ORIG-TERM-CHECK.
 12436
 12437     GO TO 3060-ORIG-TERM-CHECK.
 12438
 12439 3050-EDIT-TERM-IN-DAYS.
 12440
 12441     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12442
 12443     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12444         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12445     ELSE
 12446         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12447            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 226
* EL050.cbl
 12448            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12449
 12450     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12451                                       REMAINDER WS-WORK-TERM.
 12452     IF WS-WORK-TERM GREATER THAN ZERO
 12453         ADD +1 TO PB-I-LF-TERM.
 12454
 12455     IF NOT NO-AH-COVERAGE
 12456         MOVE ER-2684            TO WS-ERROR
 12457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12458
 12459
 12460 3060-ORIG-TERM-CHECK.
 12461
 12462******************************************************************
 12463*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12464******************************************************************
 12465
 12466     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12467        NEXT SENTENCE
 12468     ELSE
 12469        IF NOT NO-LIFE-COVERAGE
 12470           IF PB-I-LF-TERM NUMERIC
 12471              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12472              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12473              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12474                  NEXT SENTENCE
 12475           ELSE
 12476              MOVE ER-2647       TO WS-ERROR
 12477              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12478
 12479     IF NOT NO-AH-COVERAGE
 12480         IF PB-I-AH-TERM NUMERIC
 12481            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12482            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12483            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12484             NEXT SENTENCE
 12485          ELSE
 12486              MOVE ER-2658       TO WS-ERROR
 12487              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12488
 12489     IF PB-COMPANY-ID = 'NCB'
 12490        GO TO 3070-LOAN-TERM-CHECK.
 12491
 12492     IF POLICY-HAS-AH
 12493       AND
 12494        POLICY-HAS-LIFE
 12495       AND
 12496        PB-I-LF-TERM NUMERIC
 12497       AND
 12498        PB-I-AH-TERM NUMERIC
 12499        NEXT SENTENCE
 12500     ELSE
 12501        GO TO 3070-LOAN-TERM-CHECK.
 12502
 12503     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12504     IF WS-TEX-FACT-2 LESS THAN +0
 12505        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 227
* EL050.cbl
 12506
 12507     IF WS-TEX-FACT-2 GREATER THAN +1
 12508        MOVE ER-2668             TO WS-ERROR
 12509        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12510
 12511 3070-LOAN-TERM-CHECK.
 12512
 12513     IF (WS-LF-BENEFIT-CD = ZERO)
 12514         OR (NO-LF-BENEFIT-MATCH)
 12515            GO TO 3125-EDIT-PMT-FREQ.
 12516*    IF PB-COMPANY-ID NOT = 'DCC'
 12517*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12518*          AND 'V' AND 'W' AND 'X'
 12519*          GO TO 3125-EDIT-PMT-FREQ
 12520*       END-IF
 12521*    ELSE
 12522*       IF WS-AH-DCC-TRUNC = 'T'
 12523*          CONTINUE
 12524*       ELSE
 12525*          GO TO 3125-EDIT-PMT-FREQ
 12526*       END-IF
 12527*    END-IF
 12528     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12529                    OR
 12530        ((PB-COMPANY-ID = 'DCC')
 12531        AND (WS-AH-DCC-TRUNC = 'T'))
 12532        CONTINUE
 12533     ELSE
 12534        GO TO 3125-EDIT-PMT-FREQ
 12535     END-IF
 12536     IF PB-I-LOAN-TERM NOT NUMERIC
 12537         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12538
 12539     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12540        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12541*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12542        PB-I-LOAN-TERM NOT GREATER THAN +360
 12543         NEXT SENTENCE
 12544     ELSE
 12545         MOVE ER-2648            TO WS-ERROR
 12546         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12547
 12548     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12549        MOVE ER-3058             TO WS-ERROR
 12550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12551     end-if
 12552
 12553     IF WS-STATE-ABBREVIATION = 'NC'
 12554        IF PB-I-LOAN-TERM > +59
 12555           CONTINUE
 12556        ELSE
 12557           MOVE ER-2792          TO WS-ERROR
 12558           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12559        END-IF
 12560     END-IF
 12561
 12562     .
 12563 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 228
* EL050.cbl
 12564     IF (WS-LF-BENEFIT-CD = ZERO)
 12565         OR (NO-LF-BENEFIT-MATCH)
 12566            GO TO 3127-EDIT-LOAN-OFFICER.
 12567     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12568                    OR
 12569        ((PB-COMPANY-ID = 'DCC')
 12570        AND (WS-AH-DCC-TRUNC = 'T'))
 12571                    OR
 12572         (PB-COMPANY-ID = 'AHL')
 12573        CONTINUE
 12574     ELSE
 12575        IF (PB-I-LOAN-TERM > ZEROS)
 12576           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12577           MOVE ER-1575          TO WS-ERROR
 12578           PERFORM 9900-ERROR-FORMAT
 12579                                 THRU 9900-EXIT
 12580        END-IF
 12581     END-IF
 12582     IF WS-LF-EARNINGS-CALC NOT = '4'
 12583         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12584            MOVE ER-2653         TO WS-ERROR
 12585            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12586            GO TO 3127-EDIT-LOAN-OFFICER
 12587         ELSE
 12588            GO TO 3127-EDIT-LOAN-OFFICER.
 12589
 12590     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12591         MOVE ER-2655            TO WS-ERROR
 12592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593         GO TO 3127-EDIT-LOAN-OFFICER.
 12594
 12595     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12596         MOVE ER-2654            TO WS-ERROR
 12597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12598         GO TO 3127-EDIT-LOAN-OFFICER.
 12599
 12600     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12601         GIVING WS-TEX-FACT-2
 12602             REMAINDER WS-TEX-FACT-3.
 12603
 12604*    IF WS-TEX-FACT-3 NOT = ZERO
 12605*       MOVE ER-2654             TO WS-ERROR
 12606*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12607
 12608
 12609 3127-EDIT-LOAN-OFFICER.
 12610
 12611     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12612        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12613           MOVE ER-2690          TO WS-ERROR
 12614           PERFORM 9900-ERROR-FORMAT
 12615                                 THRU 9900-EXIT
 12616        ELSE
 12617           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12618           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12619           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12620           MOVE PB-SV-STATE      TO LOFC-STATE
 12621           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 229
* EL050.cbl
 12622           MOVE PB-I-LOAN-OFFICER
 12623                                 TO LOFC-CODE
 12624           PERFORM 8586-READ-LOAN-OFFICER
 12625                                 THRU 8586-EXIT
 12626           IF (NOT LOFC-MASTER-FOUND)
 12627              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12628              MOVE ER-3006       TO WS-ERROR
 12629              PERFORM 9900-ERROR-FORMAT
 12630                                 THRU 9900-EXIT
 12631           END-IF
 12632        END-IF
 12633     END-IF
 12634     .
 12635 3129-EDIT-APR.
 12636
 12637     IF (WS-LF-BENEFIT-CD = ZERO)
 12638        OR (NO-LF-BENEFIT-MATCH)
 12639        IF PB-COMPANY-ID NOT = 'DCC'
 12640           GO TO 3130-EDIT-AGE
 12641*       ELSE
 12642*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12643*             GO TO 3130-EDIT-AGE
 12644*          END-IF
 12645        END-IF
 12646     END-IF
 12647
 12648     IF (WS-STATE-ABBREVIATION = 'OH')
 12649         AND (PB-I-RATE-CLASS NOT = 'L ')
 12650         AND (PB-I-LF-TERM GREATER THAN 60)
 12651         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12652         GO TO 3129-APR-CONT.
 12653
 12654     IF (WS-STATE-ABBREVIATION = 'RI')
 12655         AND (PB-I-LF-TERM GREATER THAN 60)
 12656         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12657         GO TO 3129-APR-CONT.
 12658
 12659     IF (WS-STATE-ABBREVIATION = 'UT')
 12660         AND (PB-I-LF-TERM GREATER THAN 62)
 12661         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12662         AND (PB-CERT-EFF-DT LESS WS-830901)
 12663         GO TO 3129-APR-CONT.
 12664
 12665     IF PB-COMPANY-ID = 'LAP'
 12666        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12667           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12668              MOVE ER-2656         TO WS-ERROR
 12669              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12670              GO TO 3130-EDIT-AGE.
 12671
 12672     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12673        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12674        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12675        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12676        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12677        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12678         GO TO 3130-EDIT-AGE.
 12679
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 230
* EL050.cbl
 12680 3129-APR-CONT.
 12681     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12682         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12683         GO TO 3130-EDIT-AGE.
 12684
 12685     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12686         WS-AH-BENEFIT-CD (1:1) = 'S')
 12687        AND (PB-COMPANY-ID = 'DCC')
 12688        AND (PB-I-LOAN-APR = ZERO)
 12689        MOVE ER-2657             TO WS-ERROR
 12690        PERFORM 9900-ERROR-FORMAT
 12691                                 THRU 9900-EXIT
 12692        GO TO 3130-EDIT-AGE
 12693     END-IF
 12694*    IF PB-I-LOAN-APR = ZERO
 12695*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12696*    END-IF
 12697
 12698     if pb-i-loan-apr = +99.9999
 12699        move er-2656             to ws-error
 12700        PERFORM 9900-ERROR-FORMAT
 12701                                 THRU 9900-EXIT
 12702        GO TO 3130-EDIT-AGE
 12703     end-if
 12704*    IF PB-I-LOAN-APR = ZERO
 12705*       MOVE ER-2656             TO WS-ERROR
 12706*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12707*       GO TO 3130-EDIT-AGE.
 12708
 12709*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12710     if pb-i-loan-apr not = +99.9999
 12711        IF PB-I-LOAN-APR > +30.000
 12712           MOVE ER-2657          TO WS-ERROR
 12713           PERFORM 9900-ERROR-FORMAT
 12714                                 THRU 9900-EXIT
 12715        end-if
 12716     end-if
 12717     .
 12718 3130-EDIT-AGE.
 12719
 12720******************************************************************
 12721*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12722******************************************************************
 12723
 12724     IF NOT NO-LIFE-COVERAGE
 12725        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12726           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12727               MOVE ER-2628             TO WS-ERROR
 12728               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12729
 12730     IF NOT NO-AH-COVERAGE
 12731        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12732           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12733               MOVE ER-2628         TO WS-ERROR
 12734               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12735
 12736 3133-SEX-CODE.
 12737     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 231
* EL050.cbl
 12738         IF WS-DEFAULT-SEX = 'M'
 12739             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12740          ELSE
 12741             IF WS-DEFAULT-SEX = 'F'
 12742             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12743
 12744     IF PB-I-INSURED-SEX = '1'
 12745         MOVE 'M' TO PB-I-INSURED-SEX.
 12746
 12747     IF PB-I-INSURED-SEX = '2'
 12748         MOVE 'F' TO PB-I-INSURED-SEX.
 12749
 12750 3134-SIG-SW-EDIT.
 12751     IF PB-I-SIG-SW = SPACE
 12752         MOVE 'N'                TO  PB-I-SIG-SW.
 12753
 12754     IF PB-COMPANY-ID = 'NCL'
 12755         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12756             NEXT SENTENCE
 12757         ELSE
 12758             MOVE ER-1923        TO  WS-ERROR
 12759             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12760     ELSE
 12761     IF PB-COMPANY-ID = 'CRI'
 12762         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12763             NEXT SENTENCE
 12764         ELSE
 12765             MOVE ER-2606        TO  WS-ERROR
 12766             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12767     ELSE
 12768     IF PB-COMPANY-ID = 'TMS'
 12769         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12770             NEXT SENTENCE
 12771         ELSE
 12772             MOVE ER-2689        TO  WS-ERROR
 12773             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12774     ELSE
 12775         IF PB-I-SIG-SW = 'Y' OR 'N'
 12776             NEXT SENTENCE
 12777         ELSE
 12778             MOVE ER-2651        TO  WS-ERROR
 12779             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12780
 12781     IF PB-COMPANY-ID = 'FLA'
 12782         IF (WS-EDIT-AGE GREATER 54  OR
 12783             WS-AH-EDIT-AGE GREATER 54)  AND
 12784            PB-I-SIG-SW = 'N'
 12785            MOVE ER-2651         TO  WS-ERROR
 12786            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12787
 12788 3135-NAME-EDIT.
 12789
 12790     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12791        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12792        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12793           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12794                                 TO PB-I-JOINT-FIRST-NAME
 12795        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 232
* EL050.cbl
 12796     END-IF
 12797     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12798        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12799        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12800           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12801                                 TO PB-I-JOINT-LAST-NAME
 12802        END-PERFORM
 12803     END-IF
 12804     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12805        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12806        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12807           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12808                                 TO PB-I-INSURED-FIRST-NAME
 12809        END-PERFORM
 12810     END-IF
 12811     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12812        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12813        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12814           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12815                                 TO PB-I-INSURED-LAST-NAME
 12816        END-PERFORM
 12817     END-IF
 12818     IF PB-I-INSURED-LAST-NAME = SPACES
 12819       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12820       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12821           MOVE ER-2660    TO WS-ERROR
 12822           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12823
 12824 3136-EDIT-SEX.
 12825
 12826******************************************************************
 12827*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12828******************************************************************
 12829
 12830     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12831        (WS-AH-SPECIAL-CALC-CD = 'O')
 12832        NEXT SENTENCE
 12833     ELSE
 12834        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12835           NEXT SENTENCE
 12836        ELSE
 12837           MOVE ER-2629            TO WS-ERROR
 12838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12839
 12840 3137-EDIT-EFF-DATE.
 12841
 12842     IF PB-REISSUED-CERT       OR
 12843        PB-POLICY-IS-DECLINED  OR
 12844        PB-POLICY-IS-VOIDED
 12845         GO TO 3139-EDIT-COVERAGE-CODES.
 12846
 12847     MOVE SPACE                  TO WS-2671-SW
 12848                                    WS-2672-SW.
 12849
 12850     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12851         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12852             MOVE ER-2703        TO WS-ERROR
 12853             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 233
* EL050.cbl
 12854             GO TO 3139-EDIT-COVERAGE-CODES.
 12855
 12856     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12857         GO TO 3139-EDIT-COVERAGE-CODES.
 12858
 12859     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12860     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12861*    MOVE '1'                    TO DC-OPTION-CODE.
 12862     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12863     MOVE +0                     TO DC-ELAPSED-MONTHS
 12864                                    DC-ELAPSED-DAYS.
 12865     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12866
 12867     IF DATE-CONVERSION-ERROR
 12868         GO TO 3139-EDIT-COVERAGE-CODES.
 12869
 12870     IF DC-ELAPSED-DAYS GREATER +180
 12871         MOVE ER-2672            TO WS-ERROR
 12872         MOVE 'Y'                TO WS-2672-SW
 12873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12874     END-IF
 12875
 12876     IF WS-ERROR = ER-2671  AND
 12877        PB-COMPANY-ID  = 'LBL'
 12878        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12879        MOVE SPACE               TO WS-2671-SW
 12880        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12881
 12882     IF PB-ISSUE-DATE-FORCED  AND
 12883      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12884         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12885         MOVE ER-2673            TO WS-ERROR
 12886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12887         MOVE SPACE              TO WS-2671-SW
 12888                                    WS-2672-SW.
 12889
 12890     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12891         IF PB-ISSUE-DATE-FORCED
 12892             MOVE ER-2600          TO  WS-ERROR
 12893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12894         ELSE
 12895             MOVE ER-2692          TO  WS-ERROR
 12896             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12897
 12898
 12899 3139-EDIT-COVERAGE-CODES.
 12900
 12901     if pb-company-id not = 'AHL'
 12902        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12903           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12904           MOVE ER-2787          TO WS-ERROR
 12905           PERFORM 9900-ERROR-FORMAT
 12906                                 THRU 9900-EXIT
 12907        END-IF
 12908     end-if
 12909     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12910        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12911                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 234
* EL050.cbl
 12912           MOVE ER-2719          TO WS-ERROR
 12913           PERFORM 9900-ERROR-FORMAT
 12914                                 THRU 9900-EXIT
 12915        END-IF
 12916     END-IF
 12917
 12918     IF PB-POLICY-IS-DECLINED  OR
 12919        PB-POLICY-IS-VOIDED
 12920         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12921
 12922     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12923        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12924         MOVE ER-2630                TO WS-ERROR
 12925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12926
 12927     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12928        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12929        PB-I-LF-PREMIUM-AMT = ZERO
 12930         GO TO 3140-CHECK-AH-FOR-ZERO.
 12931
 12932     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12933        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12934        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12935         GO TO 3140-CHECK-AH-FOR-ZERO.
 12936
 12937     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12938        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12939        MOVE ER-2631             TO WS-ERROR
 12940        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12941     END-IF
 12942
 12943
 12944******************************************************************
 12945*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12946******************************************************************
 12947
 12948     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12949        NEXT SENTENCE
 12950     ELSE
 12951        IF PB-I-LF-BENEFIT-AMT = ZERO
 12952           MOVE ER-2632             TO WS-ERROR
 12953           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12954
 12955
 12956******************************************************************
 12957*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12958******************************************************************
 12959
 12960     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12961        CONTINUE
 12962     ELSE
 12963        IF PB-I-LF-PREMIUM-AMT = ZERO
 12964           IF (NOT PB-COMP-LF-PREM)
 12965              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12966              and (ws-lf-ben-category not = 'C')
 12967              MOVE ER-2633       TO WS-ERROR
 12968              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12969           END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 235
* EL050.cbl
 12970        END-IF
 12971     END-IF
 12972     .
 12973 3140-CHECK-AH-FOR-ZERO.
 12974
 12975     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12976        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12977        PB-I-AH-PREMIUM-AMT = ZERO
 12978         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12979
 12980     IF PB-COMPANY-ID = 'CSL'  AND
 12981        PB-I-AH-BENEFIT-CD = ZERO  AND
 12982        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12983        PB-I-AH-PREMIUM-AMT = ZERO
 12984         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12985
 12986     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12987        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12988        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12989         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12990
 12991     IF PB-I-AH-BENEFIT-CD = ZERO
 12992         MOVE ER-2634            TO WS-ERROR
 12993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12994
 12995******************************************************************
 12996*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12997******************************************************************
 12998
 12999     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13000        NEXT SENTENCE
 13001     ELSE
 13002        IF PB-I-AH-BENEFIT-AMT = ZERO
 13003           MOVE ER-2635             TO WS-ERROR
 13004           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13005
 13006******************************************************************
 13007*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13008******************************************************************
 13009
 13010     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13011        NEXT SENTENCE
 13012     ELSE
 13013        IF PB-I-AH-PREMIUM-AMT = ZERO
 13014            IF NOT PB-COMP-AH-PREM
 13015                MOVE ER-2636    TO WS-ERROR
 13016                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13017
 13018
 13019 3140-EDIT-MAX-AMT-SIZES.
 13020* CUSTOM CODE FOR CLIENT    'DMD'
 13021     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13022                                     WS-RES-MUNI-TAX
 13023                                     PB-I-STATE-TAX
 13024                                     PB-I-MUNI-TAX.
 13025
 13026     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13027
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 236
* EL050.cbl
 13028     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13029        GO TO 3150-RATE-OUTSTAND-BAL.
 13030
 13031     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13032        GO TO 3150-RATE-OUTSTAND-BAL.
 13033
 13034     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13035        GO TO 3150-RATE-OUTSTAND-BAL.
 13036
 13037     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13038                             OR 'RIC')
 13039        GO TO 3150-RATE-OUTSTAND-BAL.
 13040
 13041     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13042        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13043            GO TO 3150-RATE-OUTSTAND-BAL
 13044        ELSE
 13045           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13046               GO TO 3150-RATE-OUTSTAND-BAL.
 13047
 13048     IF NOT PB-NO-MONTHS-SKIPPED
 13049        GO TO 3150-RATE-OUTSTAND-BAL.
 13050
 13051     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13052        GO TO 3150-RATE-OUTSTAND-BAL.
 13053
 13054     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13055        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13056           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13057             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13058           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13059           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13060              MOVE ER-2693     TO WS-ERROR
 13061              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13062              GO TO 3150-RATE-OUTSTAND-BAL
 13063           ELSE
 13064              GO TO 3150-RATE-OUTSTAND-BAL.
 13065
 13066 3150-RATE-OUTSTAND-BAL.
 13067
 13068* DMD RATING TEST
 13069     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13070         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13071         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13072         MOVE ER-2687                 TO WS-ERROR
 13073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13074         MOVE 'B'                     TO PB-I-OB-FLAG
 13075         GO TO 3260-EDIT-CONTINUE.
 13076
 13077     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13078         IF  WS-ERROR    EQUAL    ER-2693
 13079             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13080                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13081                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13082                 MOVE  +0            TO  WS-ERROR.
 13083
 13084     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13085         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 237
* EL050.cbl
 13086             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13087                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13088                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13089                 MOVE  +0            TO  WS-ERROR.
 13090
 13091     IF PLAN-MASTER-AH-SW = 'Y'
 13092        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13093            IF  WS-ERROR    EQUAL    ER-2693
 13094              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13095                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13096                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13097                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13098                 MOVE  ER-1910           TO  WS-ERROR
 13099                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13100
 13101     IF PLAN-MASTER-AH-SW = 'Y'
 13102        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13103            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13104               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13105               MOVE  ER-1910           TO  WS-ERROR
 13106               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13107
 13108     IF PLAN-MASTER-AH-SW = 'Y'
 13109        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13110            IF  WS-ERROR    EQUAL    ER-2693
 13111                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13112                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13113                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13114                 MOVE  +0       TO  WS-ERROR.
 13115
 13116     IF WS-ERROR = ER-2693
 13117        IF PB-COMPANY-ID = 'JAL' AND
 13118           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13119           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13120           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13121
 13122     IF WS-ERROR = ER-2693
 13123        IF PB-COMPANY-ID = 'NCL'  AND
 13124           PB-I-AH-BENEFIT-CD = 'OA'
 13125           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13126           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13127
 13128     IF WS-ERROR = ER-2693
 13129        IF PB-COMPANY-ID = 'CNL' AND
 13130           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13131           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13132           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13133
 13134     IF WS-ERROR = ER-2693
 13135        IF PB-COMPANY-ID = 'HER'
 13136           IF WS-LEVEL
 13137              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13138              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13139
 13140     IF ((LF-BENEFIT-FOUND) AND
 13141         (NOT NO-LIFE-COVERAGE)  AND
 13142         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13143       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 238
* EL050.cbl
 13144             (NOT NO-AH-COVERAGE)    AND
 13145             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13146         NEXT SENTENCE
 13147     ELSE
 13148         GO TO 3215-EDIT-RATES.
 13149
 13150     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13151        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13152           MOVE ER-2674          TO WS-ERROR
 13153           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13154           GO TO 3215-EDIT-RATES.
 13155
 13156     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13157        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13158           MOVE ER-2674          TO WS-ERROR
 13159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13160           GO TO 3215-EDIT-RATES.
 13161
 13162     MOVE 'B'                    TO PB-I-OB-FLAG.
 13163
 13164     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13165         NEXT SENTENCE
 13166     ELSE
 13167         IF NOT NO-LIFE-COVERAGE
 13168             IF WS-ACCT-LF-OB-RT = ZERO
 13169                MOVE ER-2641    TO WS-ERROR
 13170                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13171
 13172     IF PB-COMPANY-ID = 'CRI'
 13173       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13174         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13175         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13176         IF WS-ERROR = ER-2675
 13177            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13178            MOVE ER-2687              TO WS-ERROR
 13179            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13180         ELSE
 13181            MOVE ER-2687              TO WS-ERROR
 13182            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13183
 13184
 13185     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13186         NEXT SENTENCE
 13187     ELSE
 13188       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13189            NEXT SENTENCE
 13190       ELSE
 13191         IF NOT NO-AH-COVERAGE
 13192             IF WS-ACCT-AH-OB-RT = ZERO
 13193                MOVE ER-2642    TO WS-ERROR
 13194                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13195
 13196     IF PB-COMPANY-ID = 'CRI'
 13197       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13198         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13199         IF WS-ERROR = ER-2676
 13200            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13201            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 239
* EL050.cbl
 13202            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13203         ELSE
 13204            MOVE ER-2687              TO WS-ERROR
 13205            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13206
 13207     IF PB-COMPANY-ID NOT = 'GIC'
 13208         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13209            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13210     ELSE
 13211         IF PB-I-LF-PREM-CALC = ZEROS
 13212             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13213                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13214
 13215     IF PB-COMPANY-ID NOT = 'GIC'
 13216         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13217            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13218     ELSE
 13219         IF PB-I-AH-PREM-CALC = ZEROS
 13220             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13221                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13222
 13223     MOVE ZEROS TO PB-I-MORT-CODE.
 13224
 13225     GO TO 3260-EDIT-CONTINUE.
 13226
 13227
 13228 3215-EDIT-RATES.
 13229     IF ACCOUNT-MAST-FOUND
 13230         NEXT SENTENCE
 13231     ELSE
 13232         GO TO 3999-END-EDIT.
 13233
 13234 3220-CHECK-LF-RATES.
 13235
 13236     IF PB-COMPANY-ID = 'DCC'
 13237        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13238        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13239        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13240           AND (NOT WS-LF-CASH))
 13241                           OR
 13242           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13243           AND (NOT WS-AH-CASH)))
 13244                       AND
 13245           (PB-I-ENTRY-STATUS NOT = '5')
 13246           MOVE 'M'              TO PB-BATCH-ENTRY
 13247                                    PB-I-ENTRY-STATUS
 13248        END-IF
 13249     END-IF
 13250     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13251                                    PB-I-AH-PREM-CALC
 13252                                    PB-I-LF-ALT-PREM-CALC
 13253                                    PB-I-LF-ALT-RATE
 13254                                    PB-I-LF-REI-RATE
 13255                                    PB-I-LF-ALT-REI-RATE
 13256                                    PB-I-AH-REI-RATE
 13257                                    PB-I-TOT-FEES-CALC.
 13258
 13259     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 240
* EL050.cbl
 13260        NEXT SENTENCE
 13261     ELSE
 13262        MOVE ZEROS               TO PB-I-LF-RATE
 13263                                    PB-I-AH-RATE.
 13264
 13265     IF PB-I-TOT-FEES NOT NUMERIC
 13266        MOVE ZEROS               TO PB-I-TOT-FEES
 13267     END-IF
 13268     IF PB-I-LIVES NOT NUMERIC
 13269         MOVE ZERO               TO PB-I-LIVES.
 13270
 13271     IF PB-I-NUM-BILLED NOT NUMERIC
 13272         MOVE ZERO               TO PB-I-NUM-BILLED.
 13273
 13274     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13275        MOVE +0                  TO PB-I-LF-PREM-TAX
 13276     END-IF
 13277
 13278     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13279        MOVE +0                  TO PB-I-AH-PREM-TAX
 13280     END-IF
 13281
 13282     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13283        PB-I-PAY-FREQUENCY = ZEROS
 13284            MOVE 12 TO CP-PAY-FREQUENCY
 13285     ELSE
 13286            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13287
 13288     IF PB-I-STATE-TAX NOT NUMERIC
 13289         MOVE ZEROS               TO PB-I-STATE-TAX.
 13290
 13291     IF PB-I-MUNI-TAX NOT NUMERIC
 13292         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13293
 13294     MOVE SPACES                 TO CP-BEN-CATEGORY
 13295     IF PB-COMPANY-ID  = 'CSL'  AND
 13296        PB-I-LF-TERM NOT = ZERO
 13297        COMPUTE WS-PAYMENT-AMT =
 13298             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13299        COMPUTE WS-CSL-AMT1 =
 13300             PB-I-LF-TERM * AM-MAX-MON-BEN
 13301        COMPUTE WS-CSL-AMT2 =
 13302             WS-PAYMENT-AMT * PB-I-LF-TERM
 13303        IF CP-PAY-FREQUENCY NOT = 12
 13304           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13305           MOVE '8' TO WS-CSL-CALC-CD
 13306        ELSE
 13307           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13308              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13309               AM-MAX-TOT-BEN
 13310               MOVE '6' TO WS-CSL-CALC-CD
 13311           ELSE
 13312              IF (WS-CSL-AMT1  GREATER THAN
 13313                 AM-MAX-TOT-BEN) AND
 13314                 (WS-CSL-AMT2  GREATER THAN
 13315                 AM-MAX-TOT-BEN)
 13316                 MOVE '7' TO WS-CSL-CALC-CD
 13317              ELSE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 241
* EL050.cbl
 13318                 MOVE '5' TO WS-CSL-CALC-CD.
 13319
 13320     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13321         NEXT SENTENCE
 13322     ELSE
 13323         GO TO 3300-CHECK-AH-RATES.
 13324
 13325*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13326
 13327     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13328        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13329              OR
 13330           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13331           MOVE ER-2618          TO WS-ERROR
 13332           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13333           GO TO 3300-CHECK-AH-RATES.
 13334
 13335     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13336           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13337                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13338
 13339     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13340         MOVE ER-2687             TO WS-ERROR
 13341         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13342         MOVE 'Z000'              TO PB-I-MORT-CODE
 13343         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13344         GO TO 3300-CHECK-AH-RATES.
 13345
 13346     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13347        IF PB-I-LIVES = ZERO
 13348           MOVE ER-2688          TO WS-ERROR
 13349           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13350
 13351     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13352
 13353     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13354     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13355     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13356     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13357     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13358     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13359     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13360     MOVE '3'                    TO CP-PROCESS-TYPE.
 13361     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13362     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13363
 13364******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13365     IF PB-COMPANY-ID EQUAL 'CDL'
 13366         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13367            CP-EARN-AS-NET-PAY)
 13368             IF PB-CERT-EFF-DT GREATER  WS-931231
 13369                 MOVE '1'        TO CP-EARNING-METHOD.
 13370*******
 13371
 13372     MOVE PB-SV-STATE            TO CP-STATE.
 13373     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13374     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13375     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 242
* EL050.cbl
 13376     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13377     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13378                                    CP-RATING-BENEFIT-AMT.
 13379     IF CP-STATE-STD-ABBRV = 'OR'
 13380         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13381                                         PB-I-LF-ALT-BENEFIT-AMT.
 13382     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13383     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13384     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13385     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13386     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13387     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13388     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13389     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13390     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13391                                    CP-REMAINING-TERM
 13392                                    CP-LOAN-TERM.
 13393
 13394     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13395         NEXT SENTENCE
 13396     ELSE
 13397         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13398             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13399                                           PB-I-LF-PREMIUM-AMT.
 13400
 13401     IF PB-COMPANY-ID EQUAL 'CSL'
 13402        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13403           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13404                                         PB-I-LF-PREMIUM-AMT.
 13405
 13406     IF PB-COMPANY-ID EQUAL 'NCB'
 13407         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13408            CP-EARN-AS-NET-PAY
 13409             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13410                 PB-I-LF-PREMIUM-AMT.
 13411
 13412     IF (CP-TRUNCATED-LIFE)
 13413        or ((pb-company-id = 'AHL')
 13414           and (pb-i-loan-term > pb-i-lf-term))
 13415        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13416
 13417     IF PB-COMPANY-ID EQUAL 'CRI'
 13418        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13419
 13420     IF CP-TERM-IS-DAYS
 13421         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13422     ELSE
 13423         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13424     IF PB-COMPANY-ID = 'DCC'
 13425        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13426        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13427        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13428        IF WS-LF-BEN-CATEGORY = 'D'
 13429           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13430           MOVE PB-I-LIFE-COMMISSION
 13431                                 TO CP-DCC-ACT-COMM
 13432           MOVE WS-LF-BEN-CATEGORY
 13433                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 243
* EL050.cbl
 13434        END-IF
 13435        IF (CP-BENEFIT-CD (1:1) = 'P')
 13436           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13437           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13438           add pb-i-ah-premium-amt to cp-original-premium
 13439        END-IF
 13440     END-IF
 13441     IF PB-COMPANY-ID = 'CSL'
 13442         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13443         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13444         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13445
 13446     IF PB-COMPANY-ID = 'CSL'
 13447        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13448
 13449     IF (CP-SPECIAL-CALC-CD = 'H')
 13450        OR (PB-COMPANY-ID = 'DCC')
 13451         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13452                                    TO CP-ALTERNATE-BENEFIT
 13453         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13454     if (pb-company-id = 'CID')
 13455        and (ws-lf-earnings-calc = '4')
 13456        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13457        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13458        move pb-i-term-type      to cp-pmt-mode
 13459        move pb-i-no-of-payments to cp-no-of-pmts
 13460     end-if
 13461     move ws-net-only-state      to cp-net-only-state
 13462     IF (PB-COMPANY-ID = 'CID')
 13463        AND (WS-LF-EARNINGS-CALC = 'B')
 13464        AND (CP-STATE-STD-ABBRV = 'MN')
 13465        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13466                                 TO CP-ALTERNATE-BENEFIT
 13467        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13468     END-IF
 13469     IF (PB-COMPANY-ID = 'CID')
 13470        AND (WS-LF-EARNINGS-CALC = 'B')
 13471        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13472                                 TO CP-ALTERNATE-BENEFIT
 13473        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13474        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13475*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13476*         pb-i-lf-alt-premium-amt
 13477        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13478        IF WS-LF-BEN-CATEGORY = 'P'
 13479           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13480        ELSE
 13481           IF WS-LF-BEN-CATEGORY = 'I'
 13482              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13483           END-IF
 13484        END-IF
 13485     END-IF
 13486     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13487     MOVE 'R'                   TO CP-RATE-FILE.
 13488     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13489
 13490     IF CP-ERROR-RATE-NOT-FOUND
 13491        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 244
* EL050.cbl
 13492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13493        GO TO 3300-CHECK-AH-RATES.
 13494
 13495     IF PB-COMPANY-ID EQUAL 'CRI'
 13496        IF CP-ERROR-NO-LIMITS-CRI
 13497           IF NOT ACCOUNT-LIFE-CHECKED
 13498              MOVE ER-2607      TO WS-ERROR
 13499              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13500
 13501******************************************************************
 13502*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13503*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13504******************************************************************
 13505
 13506* CALC LIFE AGE AT EXPIRATION.
 13507
 13508     COMPUTE WS-AGE-AT-EXPIRE =
 13509          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13510
 13511*    IF PB-STATE = 'CO' OR 'UT'
 13512*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13513*        MOVE 'F'            TO PB-FATAL-FLAG
 13514*        MOVE ER-2709        TO WS-ERROR
 13515*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13516*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13517
 13518*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13519*        MOVE 'X'            TO PB-FATAL-FLAG
 13520*        MOVE ER-2718        TO WS-ERROR
 13521*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13522*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13523
 13524* CALC A & H AGE AT EXPIRATION.
 13525
 13526     COMPUTE WS-AGE-AT-EXPIRE =
 13527          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13528
 13529*    IF PB-STATE = 'CO' OR 'UT'
 13530*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13531*        MOVE 'F'            TO PB-FATAL-FLAG
 13532*        MOVE ER-2709        TO WS-ERROR
 13533*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13534*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13535
 13536*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13537*        MOVE 'X'            TO PB-FATAL-FLAG
 13538*        MOVE ER-2718        TO WS-ERROR
 13539*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13540*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13541
 13542     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13543        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13544
 13545     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13546        and (not pb-monthly-cert)
 13547        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13548     end-if
 13549
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 245
* EL050.cbl
 13550     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13551        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13552
 13553     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13554         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13555         MOVE ER-2639        TO WS-ERROR
 13556         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13557
 13558
 13559******************************************************************
 13560*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13561******************************************************************
 13562
 13563 PREMIUM-EDITING-IS-BYPASSED.
 13564     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13565        AND (CP-R-MAX-ATT-AGE > +0)
 13566        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13567        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13568           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13569           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13570           MOVE '1'              TO DC-OPTION-CODE
 13571           PERFORM 8500-DATE-CONVERT
 13572                                 THRU 8500-EXIT
 13573           IF NO-CONVERSION-ERROR
 13574              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13575                 MOVE ER-2661       TO WS-ERROR
 13576*                PERFORM 9900-ERROR-FORMAT
 13577*                                THRU 9900-EXIT
 13578              END-IF
 13579           END-IF
 13580        ELSE
 13581           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13582           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13583              MOVE ER-2661       TO WS-ERROR
 13584*             PERFORM 9900-ERROR-FORMAT
 13585*                                THRU 9900-EXIT
 13586           ELSE
 13587              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13588                 MOVE ER-1570    TO WS-ERROR
 13589                 PERFORM 9900-ERROR-FORMAT
 13590                                 THRU 9900-EXIT
 13591              END-IF
 13592           END-IF
 13593        END-IF
 13594        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13595           MOVE PB-I-JOINT-BIRTHDAY
 13596                                 TO DC-BIN-DATE-1
 13597           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13598           MOVE '1'              TO DC-OPTION-CODE
 13599           PERFORM 8500-DATE-CONVERT
 13600                                 THRU 8500-EXIT
 13601           IF NO-CONVERSION-ERROR
 13602              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13603                 MOVE ER-2661       TO WS-ERROR
 13604*                PERFORM 9900-ERROR-FORMAT
 13605*                                THRU 9900-EXIT
 13606              END-IF
 13607           ELSE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 246
* EL050.cbl
 13608              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13609           END-IF
 13610        ELSE
 13611           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13612             (PB-I-LF-TERM / 12)
 13613           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13614              MOVE ER-2661       TO WS-ERROR
 13615*             PERFORM 9900-ERROR-FORMAT
 13616*                                THRU 9900-EXIT
 13617           ELSE
 13618              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13619                 MOVE ER-1571    TO WS-ERROR
 13620                 PERFORM 9900-ERROR-FORMAT
 13621                                 THRU 9900-EXIT
 13622              END-IF
 13623           END-IF
 13624        END-IF
 13625        IF WS-ERROR = ER-2661
 13626           PERFORM 9900-ERROR-FORMAT
 13627                                 THRU 9900-EXIT
 13628        END-IF
 13629     END-IF
 13630*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13631*       MOVE ER-2661             TO WS-ERROR
 13632*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13633
 13634     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13635        MOVE ER-2662             TO WS-ERROR
 13636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13637
 13638     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13639        MOVE ER-2677             TO WS-ERROR
 13640        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13641
 13642     IF CP-ERROR-LOAN-TERM
 13643        MOVE ER-2648             TO WS-ERROR
 13644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13645
 13646 3221-CHECK-ERROR-RATE-OPEN.
 13647
 13648     IF CP-ERROR-RATE-FILE-NOTOPEN
 13649         GO TO 3990-FILES-NOT-OPEN.
 13650
 13651     IF PB-COMPANY-ID NOT = 'DMD'
 13652        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13653     END-IF
 13654     .
 13655 3221-CONTINUE.
 13656     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13657                                    WS-DCC-AH-RATE
 13658     IF PB-COMPANY-ID = 'DCC'
 13659        IF WS-LF-BEN-CATEGORY = 'D'
 13660           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13661              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13662        END-IF
 13663     END-IF
 13664     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13665*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 247
* EL050.cbl
 13666     IF (PB-COMPANY-ID = 'CID')
 13667        AND (WS-LF-EARNINGS-CALC = 'B')
 13668        AND (CP-STATE-STD-ABBRV = 'MN')
 13669        AND (PB-CERT-EFF-DT > X'A4FF')
 13670        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13671     END-IF
 13672     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13673
 13674     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13675     IF (PB-COMPANY-ID = 'DCC')
 13676        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13677        AND (PB-I-POLICY-IS-MONTHLY)
 13678        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13679        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13680     END-IF
 13681     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13682     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13683     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13684     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13685     IF (PB-COMPANY-ID = 'DCC')
 13686        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13687        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13688        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13689        MOVE ER-2786             TO WS-ERROR
 13690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13691     END-IF
 13692
 13693     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13694
 13695******************************************************************
 13696*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13697******************************************************************
 13698     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13699        and ((not pb-monthly-cert)
 13700        or (ws-lf-ben-category = 'C'))
 13701        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13702
 13703     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13704        GO TO 3225-CHECK-ALT-LIFE-RATE
 13705     ELSE
 13706       IF PB-I-LF-RATE = ZERO
 13707          MOVE ER-2641          TO WS-ERROR
 13708          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13709
 13710 3225-CHECK-ALT-LIFE-RATE.
 13711
 13712     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13713        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13714        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13715         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13716
 13717     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13718         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13719             AND PB-COMPANY-ID NOT = 'DCC')
 13720                   OR
 13721              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13722              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13723              AND PB-COMPANY-ID NOT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 248
* EL050.cbl
 13724             MOVE ER-2720        TO  WS-ERROR
 13725             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13726             GO TO 3225-RATING-CONT
 13727         ELSE
 13728             GO TO 3225-RATING-CONT.
 13729     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13730        AND (AM-GPCD = 01 OR 06 OR 15)
 13731        MOVE ER-2798             TO WS-ERROR
 13732        PERFORM 9900-ERROR-FORMAT
 13733                                 THRU 9900-EXIT
 13734*       GO TO 3225-RATING-CONT
 13735     END-IF
 13736     if (pb-company-id = 'CID')
 13737        and (ws-lf-earnings-calc = 'B')
 13738        and (ws-lf-ben-category = 'P' or 'I')
 13739        and (ws-net-only-state = 'Y')
 13740        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13741        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13742        go to 3225-rating-cont
 13743     end-if
 13744     IF (PB-COMPANY-ID = 'CID')
 13745        AND (WS-LF-EARNINGS-CALC = 'B')
 13746        AND (CP-STATE-STD-ABBRV = 'MN')
 13747        AND (PB-CERT-EFF-DT > X'A4FF')
 13748        GO TO 3225-RATING-CONT
 13749     END-IF
 13750     IF PB-COMPANY-ID = 'DCC'
 13751        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13752           AND (PB-I-POLICY-IS-MONTHLY)
 13753           GO TO 3225-RATING-CONT
 13754        END-IF
 13755     END-IF
 13756
 13757     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13758        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13759        CP-EARN-AS-REG-BALLOON
 13760        NEXT SENTENCE
 13761     ELSE
 13762        MOVE '2'                 TO CP-EARNING-METHOD.
 13763
 13764 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13765
 13766     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13767
 13768     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13769        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13770        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13771         NEXT SENTENCE
 13772     ELSE
 13773         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13774
 13775     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13776     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13777     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13778                                     CP-RATING-BENEFIT-AMT.
 13779     IF CP-STATE-STD-ABBRV = 'OR'
 13780         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13781                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 249
* EL050.cbl
 13782     IF PB-COMPANY-ID = 'DCC'
 13783        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13784     END-IF
 13785     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13786     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13787     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13788                                    CP-REMAINING-TERM
 13789                                    CP-LOAN-TERM.
 13790     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13791        ADD +1                   TO CP-ORIGINAL-TERM
 13792                                    CP-REMAINING-TERM
 13793                                    CP-LOAN-TERM.
 13794
 13795     MOVE 'R'                   TO CP-RATE-FILE.
 13796     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13797
 13798     IF CP-ERROR-RATE-NOT-FOUND
 13799         MOVE ER-2641            TO WS-ERROR
 13800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13801         GO TO 3300-CHECK-AH-RATES.
 13802
 13803     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13804     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13805
 13806     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13807         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13808
 13809     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13810                               + PB-I-LF-ALT-BENEFIT-AMT.
 13811
 13812     IF ACCOUNT-LIFE-CHECKED  OR
 13813        PB-POLICY-IS-VOIDED   OR
 13814        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13815        and (not pb-monthly-cert))
 13816        GO TO 3225-CONTINUE.
 13817
 13818     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13819        GO TO 3225-CONTINUE.
 13820
 13821     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13822                             EC-RT-LF-MAX-TOT-BEN
 13823        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13824        MOVE ER-2639       TO WS-ERROR
 13825        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13826
 13827 3225-CONTINUE.
 13828     IF PB-I-LF-ALT-RATE = ZERO
 13829         MOVE ER-2659            TO WS-ERROR
 13830         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13831
 13832     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13833        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13834        MOVE ER-2698             TO WS-ERROR
 13835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13836
 13837 3225-RATING-CONT.
 13838
 13839     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 250
* EL050.cbl
 13840        and (not pb-monthly-cert)
 13841         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13842         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13843         IF (PB-COMPANY-ID = 'DCC')
 13844            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13845            CONTINUE
 13846         ELSE
 13847            MOVE ER-2687         TO WS-ERROR
 13848            PERFORM 9900-ERROR-FORMAT
 13849                                 THRU 9900-EXIT
 13850         END-IF
 13851         GO TO 3290-EDIT-LF-REIN-RATE
 13852     END-IF
 13853
 13854* DMD RATING TEST
 13855     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13856         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13857         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13858         MOVE ER-2687                 TO WS-ERROR
 13859         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13860         GO TO 3290-EDIT-LF-REIN-RATE.
 13861
 13862 3230-CLIENT-MORT-CD-SPECIALS.
 13863
 13864     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13865     SET BIN-TO-GREG          TO TRUE.
 13866*    MOVE ' '                 TO DC-OPTION-CODE.
 13867     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13868     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13869
 13870 C-POS-3230-MORT-CD.
 13871     IF PB-COMPANY-ID = 'POS' AND
 13872        PB-SV-CARRIER = '2'
 13873         NEXT SENTENCE
 13874     ELSE
 13875         GO TO C-POS-3240-MORT-CD.
 13876
 13877     IF PB-SV-GROUPING = '030'
 13878        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13879         MOVE '2350' TO PB-I-MORT-CODE
 13880      ELSE
 13881         MOVE '3300' TO PB-I-MORT-CODE.
 13882
 13883
 13884 C-POS-3240-MORT-CD.
 13885     IF PB-COMPANY-ID = 'POS' AND
 13886        PB-SV-CARRIER = '1'
 13887         NEXT SENTENCE
 13888     ELSE
 13889         GO TO 3230-CONTINUE.
 13890
 13891     IF PB-SV-STATE = '45' OR '47'
 13892        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13893         MOVE '5200' TO PB-I-MORT-CODE
 13894     ELSE
 13895         MOVE '8300' TO PB-I-MORT-CODE.
 13896
 13897 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 251
* EL050.cbl
 13898
 13899     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13900        GO TO 3240-CONTINUE
 13901     END-IF
 13902
 13903     IF PB-CERT-EFF-DT > WS-971231
 13904        GO TO 3240-CONTINUE
 13905     END-IF
 13906
 13907     IF LF-BENEFIT-FOUND AND
 13908        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13909         MOVE 'F250'       TO PB-I-MORT-CODE
 13910     ELSE
 13911         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13912             MOVE '7250'   TO PB-I-MORT-CODE
 13913         ELSE
 13914             MOVE '4251'   TO PB-I-MORT-CODE
 13915         END-IF
 13916     END-IF
 13917
 13918     .
 13919 3240-CONTINUE.
 13920
 13921     IF PB-COMPANY-ID NOT = 'GNL'
 13922         GO TO 3256-CONTINUE.
 13923
 13924     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13925         MOVE 'A300' TO PB-I-MORT-CODE
 13926     ELSE
 13927         MOVE '8350' TO PB-I-MORT-CODE.
 13928
 13929 3256-CONTINUE.
 13930     IF PB-COMPANY-ID NOT = 'ABL'
 13931         GO TO 3260-EDIT-CONTINUE.
 13932
 13933     IF PB-I-LF-TERM GREATER THAN 59
 13934         MOVE 'F550' TO PB-I-MORT-CODE
 13935     ELSE
 13936         MOVE 'E550' TO PB-I-MORT-CODE.
 13937
 13938 3260-EDIT-CONTINUE.
 13939     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13940
 13941 3290-EDIT-LF-REIN-RATE.
 13942     IF LF-REIN-NSP-NOT-USED
 13943         GO TO 3290-RATING-CONT.
 13944
 13945     IF PB-COMPANY-ID = 'DCC'
 13946        GO TO 3290-RATING-CONT.
 13947     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13948     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13949     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13950     MOVE '3'                   TO CP-PROCESS-TYPE.
 13951     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13952
 13953******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13954     IF PB-COMPANY-ID EQUAL 'CDL'
 13955         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 252
* EL050.cbl
 13956            CP-EARN-AS-NET-PAY)
 13957             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13958*            MOVE SPACE          TO DC-OPTION-CODE
 13959             SET BIN-TO-GREG     TO TRUE
 13960             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13961***  Y2K PROJ 7744
 13962             IF DC-GREG-DATE-CYMD GREATER 19931231
 13963                 MOVE '1'        TO CP-EARNING-METHOD.
 13964***  Y2K PROJ 7744
 13965*******
 13966
 13967     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13968     MOVE PB-SV-STATE           TO CP-STATE.
 13969     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13970     MOVE ZERO                  TO CP-DEVIATION-CODE
 13971                                   CP-RATE-DEV-PCT.
 13972     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13973     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13974                                   CP-RATING-BENEFIT-AMT.
 13975
 13976************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13977     IF PB-COMPANY-ID EQUAL 'NCB'
 13978         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13979            CP-EARN-AS-NET-PAY
 13980             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13981                 PB-I-LF-PREMIUM-AMT.
 13982************
 13983
 13984     IF CP-STATE-STD-ABBRV = 'OR'
 13985         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13986                                         PB-I-LF-ALT-BENEFIT-AMT.
 13987     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13988     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13989     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13990     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13991     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13992     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13993     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13994     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13995                                   CP-REMAINING-TERM
 13996                                   CP-LOAN-TERM.
 13997     IF CP-TRUNCATED-LIFE
 13998        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13999
 14000     IF CP-TERM-IS-DAYS
 14001         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14002     ELSE
 14003         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14004
 14005     IF PB-COMPANY-ID = 'DCC'
 14006        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14007     END-IF
 14008     IF PB-COMPANY-ID NOT = 'TIC'
 14009          MOVE ZERO          TO CP-CLASS-CODE.
 14010
 14011     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14012
 14013     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 253
* EL050.cbl
 14014     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14015
 14016     IF CP-ERROR-RATE-NOT-FOUND
 14017        IF PB-I-OB
 14018           MOVE ER-2625      TO WS-ERROR
 14019           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14020           GO TO 3299-EDIT-CONTINUE
 14021        ELSE
 14022           MOVE ER-2643      TO WS-ERROR
 14023           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14024           GO TO 3299-EDIT-CONTINUE.
 14025
 14026     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14027
 14028     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14029     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14030
 14031     IF PB-I-LF-REI-RATE = ZERO
 14032         MOVE ER-2643        TO WS-ERROR
 14033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14034
 14035 3290-CHECK-ALT-REIN-RATE.
 14036
 14037     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14038        GO TO 3290-RATING-CONT.
 14039
 14040     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14041     MOVE '2'                    TO CP-EARNING-METHOD.
 14042     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14043     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14044     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14045     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14046                                     CP-RATING-BENEFIT-AMT.
 14047     IF CP-STATE-STD-ABBRV = 'OR'
 14048         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14049                                         PB-I-LF-ALT-BENEFIT-AMT.
 14050     IF PB-COMPANY-ID = 'DCC'
 14051        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14052     END-IF
 14053     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14054     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14055     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14056                                    CP-REMAINING-TERM
 14057                                    CP-LOAN-TERM.
 14058     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14059        ADD +1                   TO CP-ORIGINAL-TERM
 14060                                    CP-REMAINING-TERM
 14061                                    CP-LOAN-TERM.
 14062
 14063     MOVE 'R'                   TO CP-RATE-FILE.
 14064     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14065
 14066     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14067
 14068     IF PB-I-LF-ALT-REI-RATE = ZERO
 14069         MOVE ER-2643            TO WS-ERROR
 14070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14071
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 254
* EL050.cbl
 14072 3290-RATING-CONT.
 14073
 14074     IF PB-I-OB
 14075*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14076        GO TO 3300-CHECK-AH-RATES.
 14077
 14078 3299-EDIT-CONTINUE.
 14079
 14080     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14081         NEXT SENTENCE
 14082     ELSE
 14083         MOVE ER-2620           TO WS-ERROR
 14084         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14085
 14086 3300-CHECK-AH-RATES.
 14087     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14088         NEXT SENTENCE
 14089     ELSE
 14090         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14091
 14092     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14093        and (not pb-monthly-cert))
 14094                  or
 14095        ((CF-COMPANY-ID = 'DMD') AND
 14096                (NO-DMD-RATING))
 14097         IF (PB-COMPANY-ID = 'DCC')
 14098            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14099            CONTINUE
 14100         ELSE
 14101            MOVE ER-2687         TO WS-ERROR
 14102            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14103         END-IF
 14104         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14105         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14106     END-IF
 14107
 14108     IF PB-I-OB
 14109        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14110
 14111     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14112         MOVE ER-2687             TO WS-ERROR
 14113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14114         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14115         GO TO 3999-END-EDIT.
 14116
 14117*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14118     if pb-company-id = 'AHL'
 14119        go to 3300-skip-crit-per
 14120     end-if
 14121     if (pb-i-ah-crit-per not = zeros)
 14122        and (ws-ah-special-calc-cd not = 'C')
 14123        MOVE ER-1572             TO WS-ERROR
 14124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14125        go to 3300-skip-crit-per
 14126     END-IF
 14127     if (pb-company-id = 'DCC')
 14128        and (am-dcc-product-code not = spaces)
 14129        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 255
* EL050.cbl
 14130     end-if
 14131     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14132        IF PB-I-AH-CRIT-PER = ZERO
 14133           move ws-ah-max-bens   to pb-i-ah-crit-per
 14134*          MOVE ER-2618       TO WS-ERROR
 14135*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14136*          GO TO 3999-END-EDIT
 14137        END-IF
 14138     END-IF
 14139     if (ws-ah-special-calc-cd = 'C')
 14140        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14141        MOVE ER-1576             TO WS-ERROR
 14142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14143     end-if
 14144
 14145     .
 14146 3300-skip-crit-per.
 14147     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14148     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14149     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14150     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14151     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14152     MOVE PB-SV-STATE            TO CP-STATE.
 14153     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14154     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14155     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14156*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14157     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14158     MOVE '3'                    TO CP-PROCESS-TYPE.
 14159     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14160     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14161                                    CP-RATING-BENEFIT-AMT.
 14162     IF PB-COMPANY-ID = 'CID'
 14163               OR
 14164        CP-STATE-STD-ABBRV = 'OR'
 14165         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14166                                         PB-I-AH-TERM.
 14167     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14168        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14169           AND (PB-I-POLICY-IS-MONTHLY)
 14170           MOVE PB-I-LF-BENEFIT-AMT
 14171                                 TO CP-NET-BENEFIT-AMT
 14172           move pb-i-ah-premium-amt to cp-original-premium
 14173           add pb-i-lf-premium-amt to cp-original-premium
 14174        END-IF
 14175     END-IF
 14176     MOVE SPACES                 TO CP-BEN-CATEGORY
 14177     IF PB-COMPANY-ID = 'DCC'
 14178        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14179        EVALUATE TRUE
 14180           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14181              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14182              MOVE PB-I-LF-BENEFIT-AMT
 14183                                 TO CP-RATING-BENEFIT-AMT
 14184              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14185           WHEN WS-AH-BEN-CATEGORY = 'G'
 14186              MOVE PB-I-UNPAID-CASH-PRICE
 14187                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 256
* EL050.cbl
 14188           WHEN WS-AH-BEN-CATEGORY = 'D'
 14189              MOVE WS-AH-PMF-COMM
 14190                                 TO CP-DCC-PMF-COMM
 14191              MOVE PB-I-AH-COMMISSION
 14192                                 TO CP-DCC-ACT-COMM
 14193        END-EVALUATE
 14194     END-IF
 14195     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14196     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14197     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14198     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14199     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14200     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14201     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14202                                    CP-REMAINING-TERM
 14203                                    WS-WORK-TERM.
 14204     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14205
 14206     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14207     SET BIN-TO-GREG             TO TRUE.
 14208*    MOVE ' '                    TO DC-OPTION-CODE.
 14209     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14210     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14211
 14212     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14213     IF NOT VALID-SKIP-CODE
 14214         MOVE ER-2683            TO WS-ERROR
 14215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14216         GO TO 3320-RATE-CONTINUE.
 14217
 14218     IF PB-NO-MONTHS-SKIPPED
 14219         GO TO 3320-RATE-CONTINUE.
 14220
 14221     MOVE SPACE TO NUMBER-OF-MONTHS.
 14222
 14223     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14224         MOVE 'S'                TO SK-MO (6).
 14225     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14226         MOVE 'S'                TO SK-MO (7).
 14227     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14228         MOVE 'S'                TO SK-MO (8).
 14229     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14230         MOVE 'S'                TO SK-MO (9).
 14231     IF PB-I-SKIP-CODE = 'A'
 14232         MOVE 'S'                TO SK-MO (10).
 14233
 14234     MOVE 1                      TO SUB2.
 14235     MOVE PB-I-AH-TERM           TO SUB3.
 14236     MOVE WS-MONTH               TO SUB1.
 14237     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14238     GO TO 3320-RATE-CONTINUE.
 14239
 14240 3310-GET-SKIP-MO.
 14241     IF SUB1 = 13
 14242         MOVE 1                  TO SUB1.
 14243
 14244     IF SK-MO (SUB1) = 'S'
 14245         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 257
* EL050.cbl
 14246
 14247     ADD 1 TO SUB2
 14248              SUB1.
 14249
 14250 3320-RATE-CONTINUE.
 14251
 14252     IF WS-WORK-TERM = ZERO
 14253         MOVE 1                  TO WS-WORK-TERM.
 14254
 14255     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14256                                    CP-LOAN-TERM.
 14257
 14258     IF PB-COMPANY-ID EQUAL 'DMD'
 14259         NEXT SENTENCE
 14260     ELSE
 14261         MOVE ZERO               TO PB-I-AH-RATE
 14262                                    PB-I-AH-REI-RATE.
 14263
 14264
 14265     IF PB-COMPANY-ID EQUAL 'CRI'
 14266        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14267
 14268     IF PB-COMPANY-ID = 'CSL'
 14269         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14270         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14271         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14272         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14273
 14274     IF PB-COMPANY-ID = 'DCC'
 14275        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14276           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14277              PB-I-RATE-DEV-PCT-LF
 14278        END-IF
 14279        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14280                                 TO CP-ALTERNATE-BENEFIT
 14281        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14282        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14283        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14284     END-IF
 14285     IF (PB-COMPANY-ID = 'CID')
 14286        AND (WS-LF-EARNINGS-CALC = 'B')
 14287        AND (CP-STATE-STD-ABBRV = 'MN')
 14288        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14289     ELSE
 14290        MOVE ' '                 TO CP-AH-BALLOON-SW
 14291     END-IF
 14292     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14293     MOVE 'R'                   TO CP-RATE-FILE.
 14294     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14295
 14296     IF (CP-ERROR-RATE-NOT-FOUND)
 14297        and (not pb-monthly-cert)
 14298        IF PB-I-OB
 14299           MOVE ER-2624          TO WS-ERROR
 14300           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14301           GO TO 3340-CALCULATE-PREMIUM-AMT
 14302        ELSE
 14303          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 258
* EL050.cbl
 14304              NEXT SENTENCE
 14305          ELSE
 14306           MOVE ER-2642          TO WS-ERROR
 14307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14308           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14309
 14310     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14311        CP-ERROR-DIV-BY-ZERO
 14312           MOVE ER-3782          TO WS-ERROR
 14313           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14314
 14315     IF PB-COMPANY-ID EQUAL 'CRI'
 14316        IF CP-ERROR-NO-LIMITS-CRI
 14317           IF NOT ACCOUNT-AH-CHECKED
 14318              MOVE ER-2607          TO WS-ERROR
 14319              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14320
 14321     IF ACCOUNT-AH-CHECKED
 14322        NEXT SENTENCE
 14323     ELSE
 14324       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14325          MOVE ER-2640           TO WS-ERROR
 14326          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14327
 14328     IF PB-COMPANY-ID = 'CRI'
 14329         IF WS-ERROR = ER-2640
 14330             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14331     IF ACCOUNT-AH-CHECKED
 14332        CONTINUE
 14333     ELSE
 14334        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14335           AND (CP-R-MAX-ATT-AGE > +0)
 14336           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14337           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14338              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14339              MOVE PB-I-AH-EXPIRE-DT
 14340                                 TO DC-BIN-DATE-2
 14341              MOVE '1'           TO DC-OPTION-CODE
 14342              PERFORM 8500-DATE-CONVERT
 14343                                 THRU 8500-EXIT
 14344              IF NO-CONVERSION-ERROR
 14345                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14346                    MOVE ER-2661       TO WS-ERROR
 14347*                   PERFORM 9900-ERROR-FORMAT
 14348*                                THRU 9900-EXIT
 14349                 END-IF
 14350              END-IF
 14351           ELSE
 14352              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14353              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14354                 MOVE ER-2661    TO WS-ERROR
 14355*                PERFORM 9900-ERROR-FORMAT
 14356*                                THRU 9900-EXIT
 14357              ELSE
 14358                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14359                    MOVE ER-1570 TO WS-ERROR
 14360                    PERFORM 9900-ERROR-FORMAT
 14361                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 259
* EL050.cbl
 14362                 END-IF
 14363              END-IF
 14364           END-IF
 14365           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14366              MOVE PB-I-JOINT-BIRTHDAY
 14367                                    TO DC-BIN-DATE-1
 14368              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14369              MOVE '1'              TO DC-OPTION-CODE
 14370              PERFORM 8500-DATE-CONVERT
 14371                                    THRU 8500-EXIT
 14372              IF NO-CONVERSION-ERROR
 14373                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14374                    MOVE ER-2661       TO WS-ERROR
 14375*                   PERFORM 9900-ERROR-FORMAT
 14376*                                   THRU 9900-EXIT
 14377                 END-IF
 14378              END-IF
 14379           ELSE
 14380              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14381                (PB-I-AH-TERM / 12)
 14382              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14383                 MOVE ER-2661       TO WS-ERROR
 14384*                PERFORM 9900-ERROR-FORMAT
 14385*                                   THRU 9900-EXIT
 14386              ELSE
 14387                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14388                    MOVE ER-1571 TO WS-ERROR
 14389                    PERFORM 9900-ERROR-FORMAT
 14390                                 THRU 9900-EXIT
 14391                 END-IF
 14392              END-IF
 14393           END-IF
 14394           IF WS-ERROR = ER-2661
 14395              PERFORM 9900-ERROR-FORMAT
 14396                                    THRU 9900-EXIT
 14397           END-IF
 14398        END-IF
 14399     END-IF
 14400*    IF ACCOUNT-AH-CHECKED
 14401*       NEXT SENTENCE
 14402*    ELSE
 14403*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14404*          MOVE ER-2661          TO WS-ERROR
 14405*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14406
 14407     IF ACCOUNT-AH-CHECKED
 14408        NEXT SENTENCE
 14409     ELSE
 14410        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14411           MOVE ER-2663          TO WS-ERROR
 14412           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14413
 14414     IF ACCOUNT-AH-CHECKED OR
 14415        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14416         PB-POLICY-IS-VOIDED
 14417        NEXT SENTENCE
 14418     ELSE
 14419        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 260
* EL050.cbl
 14420           MOVE ER-2667            TO WS-ERROR
 14421           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14422
 14423     IF PB-COMPANY-ID = 'CRI'
 14424         IF WS-ERROR = ER-2667
 14425             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14426
 14427     IF ACCOUNT-AH-CHECKED
 14428        NEXT SENTENCE
 14429     ELSE
 14430        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14431           MOVE ER-2678            TO WS-ERROR
 14432           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14433
 14434     IF CP-ERROR-RATE-FILE-NOTOPEN
 14435         GO TO 3990-FILES-NOT-OPEN.
 14436
 14437 3321-CONTINUE.
 14438     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14439     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14440     IF (PB-COMPANY-ID = 'DCC')
 14441        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14442        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14443                                    PB-I-LF-ALT-PREM-CALC
 14444        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14445        IF WS-AH-BEN-CATEGORY = 'G'
 14446           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14447           + PB-I-ADDL-CLP)
 14448           * (1 + WS-TOL-CLP-PCT)
 14449*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14450        ELSE
 14451           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14452           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14453*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14454        END-IF
 14455        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14456                                 TO PB-I-AH-PREM-CALC
 14457        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14458           MOVE ER-8152          TO WS-ERROR
 14459           PERFORM 9900-ERROR-FORMAT
 14460                                 THRU 9900-EXIT
 14461        ELSE
 14462           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14463                 PB-I-ADDL-CLP)
 14464              MOVE ER-8148       TO WS-ERROR
 14465              PERFORM 9900-ERROR-FORMAT
 14466                                 THRU 9900-EXIT
 14467           END-IF
 14468        END-IF
 14469     END-IF
 14470     IF (PB-COMPANY-ID = 'DCC')
 14471        AND (PB-I-POLICY-IS-MONTHLY)
 14472        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14473        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14474        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14475           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14476        END-IF
 14477     END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 261
* EL050.cbl
 14478     IF (PB-COMPANY-ID = 'DCC')
 14479        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14480        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14481        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14482        MOVE ER-2786             TO WS-ERROR
 14483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14484     END-IF
 14485     MOVE +0                     TO PB-I-AH-CLP
 14486     IF PB-COMPANY-ID = 'DCC'
 14487        evaluate true
 14488           when WS-AH-BEN-CATEGORY = 'D'
 14489              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14490                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14491           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14492              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14493           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14494              compute ws-cred-union-fees rounded =
 14495                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14496                    pb-i-ah-commission)
 14497              COMPUTE PB-I-AH-CLP =
 14498                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14499        end-evaluate
 14500     END-IF
 14501     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14502
 14503     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14504         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14505
 14506     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14507         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14508
 14509     if (ws-ah-special-calc-cd = 'E')
 14510        and (pb-monthly-cert)
 14511        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14512     end-if
 14513     IF PB-COMPANY-ID = 'CRI'
 14514         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14515            PB-I-PAYMENT-AMOUNT = ZERO
 14516             NEXT SENTENCE
 14517         ELSE
 14518             COMPUTE PB-I-AH-PREM-CALC =
 14519                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14520                 (CP-PREMIUM-RATE / 100)
 14521             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14522                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14523                                             PB-I-RATE-DEV-PCT-AH.
 14524
 14525     IF (PB-I-AH-RATE  = ZERO)
 14526        and (not pb-monthly-cert)
 14527       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14528           NEXT SENTENCE
 14529       ELSE
 14530         MOVE ER-2642            TO WS-ERROR
 14531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14532
 14533     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14534     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14535     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 262
* EL050.cbl
 14536     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14537     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14538     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14539
 14540     IF (PB-COMPANY-ID = 'DCC')
 14541        AND (WS-AH-BEN-CATEGORY = 'G')
 14542        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14543        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14544        IF CP-DEVIATION-CODE NOT = '000'
 14545           MOVE '000'            TO CP-DEVIATION-CODE
 14546           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14547           IF NO-CP-ERROR
 14548              COMPUTE PB-I-DDF-IU-RATE-UP =
 14549              PB-I-AH-CLP - CP-CALC-PREMIUM
 14550           ELSE
 14551              MOVE ER-3057        TO WS-ERROR
 14552              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14553           END-IF
 14554        END-IF
 14555     END-IF
 14556     .
 14557 3335-EDIT-AH-REIN-NSP-RATE.
 14558     IF PB-COMPANY-ID = 'DCC'
 14559        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14560              compute ws-cred-union-fees rounded =
 14561                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14562                    pb-i-ah-commission)
 14563              COMPUTE PB-I-AH-CLP =
 14564                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14565        end-if
 14566     END-IF
 14567     IF AH-REIN-NSP-NOT-USED
 14568         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14569
 14570     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14571     IF PB-COMPANY-ID = 'DCC'
 14572         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14573     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14574     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14575     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14576     MOVE PB-SV-STATE            TO CP-STATE.
 14577     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14578     MOVE ZERO                   TO CP-DEVIATION-CODE
 14579                                    CP-RATE-DEV-PCT.
 14580*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14581     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14582     MOVE '3'                    TO CP-PROCESS-TYPE.
 14583     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14584     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14585                                    CP-RATING-BENEFIT-AMT.
 14586     IF CP-STATE-STD-ABBRV = 'OR'
 14587         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14588                                         PB-I-AH-TERM.
 14589     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14590     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14591     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14592     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14593     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 263
* EL050.cbl
 14594     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14595                                    CP-REMAINING-TERM
 14596                                    WS-WORK-TERM.
 14597     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14598     IF PB-COMPANY-ID = 'DCC'
 14599        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14600     END-IF
 14601     IF  PB-COMPANY-ID = 'TIC'
 14602         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14603            MOVE ZERO TO CP-CLASS-CODE.
 14604
 14605     IF PB-COMPANY-ID NOT = 'TIC'
 14606          MOVE ZERO          TO CP-CLASS-CODE.
 14607
 14608     MOVE ZERO               TO CP-DEVIATION-CODE.
 14609
 14610     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14611
 14612     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14613
 14614     MOVE 'R'                   TO CP-RATE-FILE.
 14615     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14616
 14617     IF CP-ERROR-RATE-NOT-FOUND
 14618         MOVE ER-2645        TO WS-ERROR
 14619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14620         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14621
 14622     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14623
 14624     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14625     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14626
 14627     IF PB-I-AH-REI-RATE = ZERO
 14628         MOVE ER-2645        TO WS-ERROR
 14629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14630
 14631
 14632 3340-CALCULATE-PREMIUM-AMT.
 14633
 14634     IF PB-COMPANY-ID = 'NCL'
 14635         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14636             WS-AH-SPECIAL-CALC-CD = 'O')
 14637             GO TO 3999-END-EDIT.
 14638
 14639     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14640                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14641                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14642                         OR 'AHL'
 14643         NEXT SENTENCE
 14644     ELSE
 14645         IF WS-STATE-ABBREVIATION = 'CT'
 14646             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14647                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14648                 COMPUTE PB-I-LF-PREM-CALC =
 14649                                     PB-I-LF-PREM-CALC * .90
 14650                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14651                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 264
* EL050.cbl
 14652                 COMPUTE PB-I-AH-PREM-CALC =
 14653                                     PB-I-AH-PREM-CALC * .90.
 14654
 14655     IF PB-COMP-LF-PREM
 14656        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14657        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14658
 14659     IF PB-COMP-AH-PREM
 14660        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14661
 14662 3340-CHECK-DCC-TOT-FEES.
 14663     IF (PB-COMPANY-ID = 'DCC')
 14664        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14665        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14666        AND (PB-I-POLICY-IS-MONTHLY)
 14667        CONTINUE
 14668     ELSE
 14669        GO TO 3340-EDIT-LF-AH-TOL
 14670     END-IF
 14671     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14672     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14673     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14674        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14675           PB-I-RATE-DEV-PCT-LF
 14676     END-IF
 14677     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14678        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14679           PB-I-RATE-DEV-PCT-AH
 14680     END-IF
 14681     MOVE 'N'                    TO CP-BEN-CATEGORY
 14682     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14683
 14684     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14685     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14686     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14687     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14688     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14689     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14690     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14691     MOVE '3'                    TO CP-PROCESS-TYPE.
 14692     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14693     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14694
 14695     MOVE PB-SV-STATE            TO CP-STATE.
 14696     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14697     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14698     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14699     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14700     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14701                                    CP-RATING-BENEFIT-AMT.
 14702     IF CP-STATE-STD-ABBRV = 'OR'
 14703         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14704                                         PB-I-LF-ALT-BENEFIT-AMT.
 14705     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14706     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14707     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14708     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14709     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 265
* EL050.cbl
 14710     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14711     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14712     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14713     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14714                                    CP-REMAINING-TERM
 14715                                    CP-LOAN-TERM.
 14716     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14717        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14718           PB-I-LF-PREMIUM-AMT
 14719     end-if
 14720
 14721     IF CP-TRUNCATED-LIFE
 14722        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14723
 14724     IF CP-TERM-IS-DAYS
 14725         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14726     ELSE
 14727         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14728
 14729     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14730     IF CP-SPECIAL-CALC-CD = 'H'
 14731         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14732                                    TO CP-ALTERNATE-BENEFIT
 14733         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14734     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14735     MOVE 'R'                    TO CP-RATE-FILE
 14736     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14737     IF NOT CP-ERROR-RATE-NOT-FOUND
 14738        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14739        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14740           AND (CP-BENEFIT-CD (1:1) = 'S')
 14741           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14742                                    PB-I-LF-PREMIUM-AMT
 14743        END-IF
 14744     ELSE
 14745        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14746     END-IF
 14747     .
 14748 3340-EDIT-LF-AH-TOL.
 14749
 14750***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14751***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14752***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14753***
 14754     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14755         PB-I-AH-PREMIUM-AMT
 14756          GIVING WS-CALC-WORK.
 14757
 14758     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14759        AND WS-CALC-WORK NOT = ZERO
 14760         MOVE ER-2649            TO WS-ERROR
 14761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14762
 14763     SUBTRACT PB-I-LF-PREM-CALC
 14764             FROM PB-I-LF-PREMIUM-AMT
 14765                 GIVING WS-UNSIGN-WRK1.
 14766
 14767     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 266
* EL050.cbl
 14768             FROM PB-I-LF-ALT-PREMIUM-AMT
 14769                 GIVING WS-UNSIGN-WRK4.
 14770
 14771     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14772                                + WS-UNSIGN-WRK4.
 14773
 14774     SUBTRACT PB-I-AH-PREM-CALC
 14775             FROM PB-I-AH-PREMIUM-AMT
 14776                 GIVING WS-UNSIGN-WRK2.
 14777
 14778******************************************************************
 14779*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14780******************************************************************
 14781
 14782     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14783         MOVE ZERO TO WS-UNSIGN-WRK1.
 14784
 14785     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14786         MOVE ZERO TO WS-UNSIGN-WRK2.
 14787
 14788     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14789             GIVING WS-UNSIGN-WRK3.
 14790
 14791 3342-CONTINUE.
 14792
 14793     IF (PB-I-LF-RATE = ZERO  AND
 14794         PB-I-AH-RATE = ZERO)
 14795         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14796            WS-AH-SPECIAL-CALC-CD = 'O'
 14797              NEXT SENTENCE
 14798         ELSE
 14799             GO TO 3345-EDIT-CONTINUE.
 14800
 14801     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14802         NEXT SENTENCE
 14803     ELSE
 14804     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14805        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14806           IF (PB-REISSUED-CERT         OR
 14807               PB-POLICY-IS-DECLINED    OR
 14808               PB-POLICY-IS-VOIDED)
 14809              NEXT SENTENCE
 14810           ELSE
 14811              IF WS-PREM-REJECT-SW = SPACE
 14812                 MOVE ER-2652    TO WS-ERROR
 14813                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14814                 GO TO 3344-CHECK-AH
 14815              ELSE
 14816                 MOVE ER-2650    TO WS-ERROR
 14817                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14818                 GO TO 3344-CHECK-AH.
 14819
 14820***
 14821***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14822***
 14823
 14824     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14825         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 267
* EL050.cbl
 14826            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14827             (1 + WS-TOL-LF-PREM-PCT)
 14828         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14829            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14830             (1 - WS-TOL-LF-PREM-PCT)
 14831     ELSE
 14832         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14833         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14834
 14835***
 14836***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14837***
 14838
 14839     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14840         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14841          WS-TOL-LF-PREM.
 14842
 14843     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14844         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14845          WS-TOL-LF-PREM.
 14846
 14847     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14848        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14849
 14850     IF PB-REISSUED-CERT
 14851        or PB-POLICY-IS-DECLINED
 14852        or PB-POLICY-IS-VOIDED
 14853        continue
 14854     ELSE
 14855        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14856              > WS-TOL-LF-HIGH-PREM-AMT)
 14857           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14858              < WS-TOL-LF-LOW-PREM-AMT))
 14859                      or
 14860           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14861              > WS-TOL-LF-HIGH-PREM-PCT)
 14862           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14863              < WS-TOL-LF-LOW-PREM-PCT))
 14864           IF WS-PREM-REJECT-SW = SPACE
 14865              MOVE ER-2652       TO WS-ERROR
 14866              PERFORM 9900-ERROR-FORMAT
 14867                                 THRU 9900-EXIT
 14868           ELSE
 14869              MOVE ER-2650       TO WS-ERROR
 14870              PERFORM 9900-ERROR-FORMAT
 14871                                 THRU 9900-EXIT
 14872           end-if
 14873        end-if
 14874     end-if
 14875
 14876*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14877*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14878*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14879*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14880
 14881     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14882        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14883                      OR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 268
* EL050.cbl
 14884           ((PB-COMPANY-ID = 'DCC')
 14885           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14886           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14887           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14888        END-IF
 14889     END-IF
 14890
 14891     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14892        IF WS-COMP-MAX-CAP GREATER THAN +0
 14893           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14894              IF (PB-REISSUED-CERT         OR
 14895                  PB-POLICY-IS-DECLINED    OR
 14896                  PB-POLICY-IS-VOIDED)
 14897                 NEXT SENTENCE
 14898              ELSE
 14899                  MOVE ER-2646   TO  WS-ERROR
 14900                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14901
 14902 3344-CVL-TOLERANCE-CHECK.
 14903
 14904      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14905          GO TO 3344-CHECK-AH.
 14906
 14907      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14908          GO TO 3344-CHECK-AH.
 14909
 14910      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14911                                     WS-UNSIGN-WRK6.
 14912
 14913      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14914          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14915                                 + PB-I-LF-PREMIUM-AMT
 14916                                 - PB-I-LF-PREM-CALC.
 14917
 14918      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14919          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14920                                 + PB-I-LF-ALT-PREMIUM-AMT
 14921                                 - PB-I-LF-ALT-PREM-CALC.
 14922
 14923      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14924          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14925              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14926                 MOVE ER-2652    TO  WS-ERROR
 14927                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14928              ELSE
 14929                 MOVE ER-2650    TO  WS-ERROR
 14930                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14931
 14932      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14933          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14934              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14935                 MOVE ER-2652    TO  WS-ERROR
 14936                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14937              ELSE
 14938                 MOVE ER-2650    TO  WS-ERROR
 14939                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14940
 14941 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 269
* EL050.cbl
 14942
 14943****************************************************************
 14944***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14945***
 14946
 14947     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14948         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14949             (1 + WS-TOL-AH-PREM-PCT)
 14950         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14951             (1 - WS-TOL-AH-PREM-PCT)
 14952     ELSE
 14953         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14954         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14955
 14956***
 14957***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14958***
 14959
 14960     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14961         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14962
 14963     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14964         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14965
 14966     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14967        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14968
 14969     IF (PB-REISSUED-CERT)
 14970        OR (PB-POLICY-IS-DECLINED)
 14971        OR (PB-POLICY-IS-VOIDED)
 14972        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14973        CONTINUE
 14974     ELSE
 14975        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14976              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14977                          or
 14978           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14979              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14980           IF WS-PREM-REJECT-SW = SPACE
 14981              MOVE ER-3052       TO WS-ERROR
 14982              PERFORM 9900-ERROR-FORMAT
 14983                                 THRU 9900-EXIT
 14984           ELSE
 14985              MOVE ER-3050       TO WS-ERROR
 14986              PERFORM 9900-ERROR-FORMAT
 14987                                 THRU 9900-EXIT
 14988           END-IF
 14989        END-IF
 14990     END-IF
 14991     if (pb-company-id = 'DCC')
 14992        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14993        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14994        and (pb-i-policy-is-monthly)
 14995        compute ws-tol-ah-high-prem-amt =
 14996           pb-i-tot-fees-calc + ws-tol-ah-prem
 14997        compute ws-tol-ah-low-prem-amt =
 14998           pb-i-tot-fees-calc - ws-tol-ah-prem
 14999        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 270
* EL050.cbl
 15000           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15001              (1 + ws-tol-ah-prem-pct)
 15002           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15003              (1 - ws-tol-ah-prem-pct)
 15004        else
 15005           move +9999999.99      to ws-tol-ah-high-prem-pct
 15006           move +0               to ws-tol-ah-low-prem-pct
 15007        end-if
 15008        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15009            or
 15010           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15011                          or
 15012           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15013           or
 15014           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15015            move er-3049         to ws-error
 15016           perform 9900-error-format
 15017                                 thru 9900-exit
 15018
 15019        end-if
 15020     end-if
 15021     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15022         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15023             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15024             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15025
 15026     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15027        IF WS-COMP-MAX-CAP GREATER THAN +0
 15028           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15029              IF (PB-REISSUED-CERT         OR
 15030                  PB-POLICY-IS-DECLINED    OR
 15031                  PB-POLICY-IS-VOIDED)
 15032                 NEXT SENTENCE
 15033              ELSE
 15034                  MOVE ER-2646   TO  WS-ERROR
 15035                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15036
 15037     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15038        (WS-COMP-MAX-CAP EQUAL +0)
 15039           GO TO 3345-EDIT-CONTINUE.
 15040
 15041     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15042        GREATER THAN WS-COMP-MAX-CAP
 15043           MOVE ER-2646          TO  WS-ERROR
 15044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15045
 15046 3345-EDIT-CONTINUE.
 15047
 15048*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15049*       IF PB-ENTRY-BATCH   NUMERIC
 15050*          IF PB-ISSUE
 15051*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15052*          ELSE
 15053*              IF PB-CANCELLATION
 15054*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15055
 15056*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15057*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 271
* EL050.cbl
 15058*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15059*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15060*        ELSE
 15061*            MOVE  ER-1909            TO  WS-ERROR
 15062*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15063
 15064     IF PB-I-POLICY-ACCEPTED
 15065        IF PB-POLICY-IS-DECLINED  OR
 15066           PB-REISSUED-CERT  OR
 15067           PB-REIN-ONLY-CERT  OR
 15068           PB-POLICY-IS-VOIDED
 15069            MOVE  ER-1891         TO  WS-ERROR
 15070            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15071        ELSE
 15072            MOVE SPACE            TO  PB-BATCH-ENTRY
 15073            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15074
 15075     IF PB-I-POLICY-DECLINED
 15076        IF PB-REISSUED-CERT  OR
 15077           PB-REIN-ONLY-CERT  OR
 15078           PB-POLICY-IS-VOIDED
 15079            MOVE  ER-1906         TO  WS-ERROR
 15080            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15081        ELSE
 15082            MOVE  'D'             TO  PB-BATCH-ENTRY
 15083                                      PB-I-ENTRY-STATUS.
 15084
 15085     IF PB-I-NEEDS-UNDERWRITING
 15086        IF PB-POLICY-IS-DECLINED OR
 15087           PB-REISSUED-CERT  OR
 15088           PB-REIN-ONLY-CERT  OR
 15089           PB-POLICY-IS-VOIDED
 15090            MOVE  ER-1907         TO  WS-ERROR
 15091            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15092        ELSE
 15093            MOVE 'U'              TO  PB-BATCH-ENTRY
 15094                                      PB-I-ENTRY-STATUS.
 15095
 15096     IF PB-NEEDS-UNDERWRITING
 15097        MOVE  ER-1901             TO  WS-ERROR
 15098        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15099     IF PB-COMPANY-ID = 'DCC'
 15100        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15101        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15102        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15103           AND (NOT WS-LF-CASH))
 15104                           OR
 15105           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15106           AND (NOT WS-AH-CASH)))
 15107                       AND
 15108           (PB-I-ENTRY-STATUS NOT = '5')
 15109           MOVE 'M'              TO PB-BATCH-ENTRY
 15110                                    PB-I-ENTRY-STATUS
 15111        END-IF
 15112     END-IF
 15113     move pending-business       to ws-passed-erpndb
 15114     move ' '                    to ws-exceed-limit-yn
 15115     perform 7780-call-agg       thru 7780-exit
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 272
* EL050.cbl
 15116     display ' el050 exceed ' ws-exceed-limit-yn
 15117     if ws-exceed-limit-yn = 'Y'
 15118        MOVE  ER-9813            TO WS-ERROR
 15119        PERFORM  9900-ERROR-FORMAT
 15120                                 THRU 9900-EXIT
 15121     end-if
 15122     IF  PB-COMPANY-ID NOT = 'NCL'
 15123         GO TO 3999-END-EDIT.
 15124
 15125     IF PB-REISSUED-CERT  OR
 15126        PB-POLICY-IS-DECLINED  OR
 15127        PB-POLICY-IS-VOIDED  OR
 15128        PB-I-OB
 15129         GO TO 3999-END-EDIT.
 15130
 15131     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15132         MOVE  ER-2644            TO  WS-ERROR
 15133         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15134         GO TO 3999-END-EDIT.
 15135
 15136     MOVE 'N'                     TO  FORM-MASTER-SW.
 15137     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15138
 15139     IF NOT FORM-MASTER-FOUND
 15140         GO TO 3999-END-EDIT.
 15141
 15142     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15143                                      FORM-MASTER-AH-SW.
 15144
 15145     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15146         MOVE  +1                 TO SUB6
 15147         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15148
 15149     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15150         MOVE  +1                 TO SUB6
 15151         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15152
 15153     IF LF-FORM-MASTER-FOUND  OR
 15154        AH-FORM-MASTER-FOUND
 15155         GO TO 3360-CHECK-FORM-LIMITS
 15156     ELSE
 15157         GO TO 3999-END-EDIT.
 15158
 15159******************************************************************
 15160*                  3350-GET-ERFORM                               *
 15161*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15162*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15163******************************************************************
 15164
 15165 3350-GET-ERFORM.
 15166
 15167     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15168         GO TO  3350-ERFORM-GETMAIN.
 15169
 15170     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15171     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15172     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15173     MOVE 'Y'                     TO FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 273
* EL050.cbl
 15174
 15175     IF PB-CANCELLATION
 15176         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15177            PB-SV-STATE          EQUAL   FO-STATE       AND
 15178            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15179              GO TO 3350-EXIT
 15180         ELSE
 15181             NEXT SENTENCE
 15182     ELSE
 15183         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15184            PB-SV-STATE          EQUAL   FO-STATE       AND
 15185            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15186              GO TO 3350-EXIT.
 15187
 15188 3350-ERFORM-GETMAIN.
 15189
 15190     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15191     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15192
 15193 3350-ERFORM-READ.
 15194
 15195     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15196     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15197     IF PB-CANCELLATION
 15198         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15199     ELSE
 15200         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15201     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15202
 15203     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15204
 15205     IF FORM-MASTER-FOUND
 15206       IF PB-CANCELLATION
 15207          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15208             PB-SV-STATE          EQUAL   FO-STATE       AND
 15209             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15210              GO  TO 3350-EXIT
 15211          ELSE
 15212              NEXT SENTENCE
 15213       ELSE
 15214          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15215             PB-SV-STATE          EQUAL   FO-STATE       AND
 15216             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15217              GO  TO 3350-EXIT.
 15218
 15219     MOVE  'N'                    TO  FORM-MASTER-SW.
 15220     MOVE  ER-1895                TO  WS-ERROR.
 15221     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15222
 15223 3350-EXIT.
 15224      EXIT.
 15225
 15226******************************************************************
 15227*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15228*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15229*   VALID FOR THE POLICY FORM USED.                              *
 15230******************************************************************
 15231
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 274
* EL050.cbl
 15232 3355-EDIT-FORM-LF-BENEFITS.
 15233
 15234     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15235        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15236         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15237         GO TO   3355-EXIT.
 15238
 15239     IF  SUB6    LESS THAN   +40
 15240         ADD  +1      TO  SUB6
 15241         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15242
 15243     MOVE  ER-1896         TO  WS-ERROR.
 15244     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15245
 15246 3355-EXIT.
 15247      EXIT.
 15248
 15249******************************************************************
 15250*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15251*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15252*   VALID FOR THE POLICY FORM USED.                              *
 15253******************************************************************
 15254
 15255 3356-EDIT-FORM-AH-BENEFITS.
 15256
 15257     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15258        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15259         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15260         GO TO  3356-EXIT.
 15261
 15262      IF  SUB6    LESS THAN     +40
 15263          ADD  +1      TO  SUB6
 15264          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15265
 15266     MOVE  ER-1897         TO  WS-ERROR.
 15267     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15268
 15269 3356-EXIT.
 15270      EXIT.
 15271
 15272******************************************************************
 15273*                  3357-BENEFIT-SEARCH                           *
 15274*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15275*   CANCELLATIONS ONLY.                                          *
 15276******************************************************************
 15277 3357-BENEFIT-SEARCH.
 15278     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15279         MOVE +1                          TO SUB6
 15280         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15281
 15282     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15283         MOVE +1                          TO SUB6
 15284         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15285
 15286 3357-EXIT.
 15287     EXIT.
 15288
 15289******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 275
* EL050.cbl
 15290*                  3358-BENEFIT-LIFE-SEARCH                      *
 15291*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15292*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15293*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15294******************************************************************
 15295 3358-BENEFIT-LIFE-SEARCH.
 15296     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15297       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15298         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15299           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15300              IF FO-PLAN-REFUND-METHOD (SUB6)
 15301                     IS GREATER THAN SPACES
 15302                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15303                                          WS-LF-REFUND-CALC
 15304                 GO TO 3358-EXIT.
 15305
 15306     IF SUB6 LESS THAN +40
 15307         ADD +1                 TO SUB6
 15308         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15309
 15310 3358-EXIT.
 15311     EXIT.
 15312******************************************************************
 15313*                  3359-BENEFIT-AH-SEARCH                        *
 15314*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15315*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15316*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15317******************************************************************
 15318 3359-BENEFIT-AH-SEARCH.
 15319     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15320       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15321         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15322           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15323              IF FO-PLAN-REFUND-METHOD (SUB6)
 15324                      IS GREATER THAN SPACES
 15325                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15326                                          WS-AH-REFUND-CALC
 15327                 GO TO 3359-EXIT.
 15328
 15329     IF SUB6 LESS THAN +40
 15330         ADD +1                 TO SUB6
 15331         GO TO 3359-BENEFIT-AH-SEARCH.
 15332
 15333 3359-EXIT.
 15334     EXIT.
 15335
 15336******************************************************************
 15337*                  3360-CHECK-FORM-LIMITS                        *
 15338*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15339*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15340******************************************************************
 15341
 15342 3360-CHECK-FORM-LIMITS.
 15343
 15344     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15345         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15346
 15347     IF NOT LF-FORM-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 276
* EL050.cbl
 15348         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15349
 15350 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15351
 15352     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15353       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15354        WS-LF-JOINT-INDICATOR = 'J'  AND
 15355        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15356         IF PB-COMPANY-ID = 'NCL'
 15357            MOVE  ER-1911          TO  WS-ERROR
 15358            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15359         ELSE
 15360            MOVE  ER-1892          TO  WS-ERROR
 15361            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15362
 15363 3360-CHECK-FORM-LF-ATT-AGE.
 15364
 15365     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15366
 15367     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15368         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15369         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15370            IF PB-COMPANY-ID = 'NCL'
 15371                MOVE  ER-1913      TO  WS-ERROR
 15372                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15373            ELSE
 15374                MOVE  ER-1894      TO  WS-ERROR
 15375                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15376
 15377 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15378
 15379     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15380         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15381         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15382            IF PB-COMPANY-ID = 'NCL'
 15383                MOVE  ER-1914      TO  WS-ERROR
 15384                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15385            ELSE
 15386                MOVE  ER-1899      TO  WS-ERROR
 15387                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15388
 15389 3360-CHECK-FORM-LF-TERM-BAMT.
 15390
 15391     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15392         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15393         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15394           IF  PB-COMPANY-ID = 'NCL'
 15395               MOVE  ER-1916       TO  WS-ERROR
 15396               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15397           ELSE
 15398               MOVE  ER-1902       TO  WS-ERROR
 15399               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15400
 15401     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15402                                    PB-I-LF-ALT-BENEFIT-AMT.
 15403
 15404     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15405         FO-MAX-LF-AMT   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 277
* EL050.cbl
 15406         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15407             IF  PB-COMPANY-ID = 'NCL'
 15408                 MOVE  ER-1918     TO  WS-ERROR
 15409                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15410             ELSE
 15411                 MOVE  ER-1904     TO  WS-ERROR
 15412                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15413
 15414******************************************************************
 15415*                  3360-CHECK-FORM-AH-LIMITS                     *
 15416*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15417*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15418******************************************************************
 15419
 15420 3360-CHECK-FORM-AH-LIMITS.
 15421
 15422     IF NOT AH-FORM-MASTER-FOUND
 15423         GO TO 3999-END-EDIT.
 15424
 15425 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15426
 15427     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15428       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15429        WS-AH-JOINT-INDICATOR = 'J'  AND
 15430        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15431         IF PB-COMPANY-ID = 'NCL'
 15432            MOVE  ER-1912          TO  WS-ERROR
 15433            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15434         ELSE
 15435            MOVE  ER-1893          TO  WS-ERROR
 15436            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15437
 15438 3360-CHECK-FORM-AH-ATT-AGE.
 15439
 15440     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15441
 15442     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15443         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15444         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15445            IF PB-COMPANY-ID = 'NCL'
 15446                MOVE  ER-1913      TO  WS-ERROR
 15447                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15448            ELSE
 15449                MOVE  ER-1894      TO  WS-ERROR
 15450                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15451
 15452 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15453
 15454     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15455         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15456         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15457            IF PB-COMPANY-ID = 'NCL'
 15458                MOVE  ER-1915      TO  WS-ERROR
 15459                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15460            ELSE
 15461                MOVE  ER-1900      TO  WS-ERROR
 15462                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15463
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 278
* EL050.cbl
 15464 3360-CHECK-FORM-AH-TERM-BAMT.
 15465
 15466     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15467         FO-AH-MAX-TERM    GREATER THAN  +0
 15468         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15469             IF  PB-COMPANY-ID = 'NCL'
 15470                 MOVE  ER-1917     TO  WS-ERROR
 15471                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15472             ELSE
 15473                  MOVE  ER-1903    TO  WS-ERROR
 15474                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15475
 15476     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15477         FO-MAX-AH-AMT    GREATER THAN  +0
 15478         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15479             IF  PB-COMPANY-ID = 'NCL'
 15480                 MOVE  ER-1919     TO  WS-ERROR
 15481                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15482             ELSE
 15483                 MOVE  ER-1905     TO  WS-ERROR
 15484                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15485
 15486     GO TO 3999-END-EDIT.
 15487
 15488******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 279
* EL050.cbl
 15490******************************************************************
 15491*                  E D I T   C A N C E L                         *
 15492******************************************************************
 15493
 15494 3700-EDIT-CANCEL.
 15495     IF PB-COMPANY-ID = 'DMD'
 15496         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15497                                         WS-RES-MUNI-TAX
 15498                                         PB-CI-STATE-TAX
 15499                                         PB-CI-MUNI-TAX
 15500         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15501
 15502*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15503*       IF PB-ENTRY-BATCH  NUMERIC
 15504*          IF PB-CANCELLATION
 15505*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15506*          ELSE
 15507*             IF PB-ISSUE
 15508*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15509
 15510     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15511        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15512     END-IF
 15513*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15514*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15515
 15516     IF CM-ENTRY-STATUS = 'V'
 15517        MOVE ER-2780             TO WS-ERROR
 15518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15519        GO TO 3999-END-EDIT.
 15520
 15521     IF CM-ENTRY-STATUS = 'D'
 15522        MOVE ER-2781             TO WS-ERROR
 15523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15524        GO TO 3999-END-EDIT.
 15525
 15526     IF CM-ENTRY-STATUS = 'U'
 15527        MOVE ER-2782             TO WS-ERROR
 15528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15529
 15530***************************************************************
 15531*                                                             *
 15532*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15533*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15534*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15535*   OF ANOTHER COVERAGE.                                      *
 15536*                                                             *
 15537***************************************************************
 15538
 15539     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15540                                    PB-C-AH-CANCEL-VOID-SW.
 15541
 15542     IF PB-C-LF-CANCEL-AMT = ZERO
 15543        NEXT SENTENCE
 15544     ELSE
 15545        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15546           AND
 15547           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 280
* EL050.cbl
 15548               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15549               MOVE ER-2745           TO WS-ERROR
 15550               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15551
 15552     IF PB-C-AH-CANCEL-AMT = ZERO
 15553        NEXT SENTENCE
 15554     ELSE
 15555        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15556           AND
 15557           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15558               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15559               MOVE ER-2745           TO WS-ERROR
 15560               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15561
 15562     IF WS-LF-EARNINGS-CALC = '4'
 15563        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15564
 15565     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15566     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15567     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15568     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15569     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15570     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15571
 15572     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15573                                      PB-C-AH-REF-CALC.
 15574     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15575
 15576******************************************************************
 15577*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15578*             TO VALIDATE COVERAGE.                              *
 15579******************************************************************
 15580
 15581     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15582        PB-C-LF-CANCEL-AMT = ZEROS
 15583          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15584      ELSE
 15585          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15586
 15587     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15588        PB-C-AH-CANCEL-AMT = ZEROS
 15589          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15590      ELSE
 15591          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15592
 15593     EVALUATE TRUE
 15594         WHEN PB-CANCEL-FORCE             OR
 15595              PB-CANCEL-DATE-FORCED       OR
 15596              PB-FORCE-OFF
 15597                  IF PB-COMPANY-ID = 'ACE'
 15598                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15599                  END-IF
 15600         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15601               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15602              (PB-COMPANY-ID = 'ACE' )
 15603                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15604         WHEN OTHER
 15605              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 281
* EL050.cbl
 15606                 MOVE ER-2794              TO WS-ERROR
 15607              ELSE
 15608                 MOVE ER-2749              TO WS-ERROR
 15609              END-IF
 15610              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15611     END-EVALUATE.
 15612
 15613
 15614*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15615*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15616*            MOVE  ER-1909            TO  WS-ERROR
 15617*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15618*        ELSE
 15619*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15620
 15621     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15622     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15623        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15624     ELSE
 15625        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15626     END-IF
 15627     .
 15628 3705-EDIT-CANCEL-DT.
 15629
 15630     IF LF-COVERAGE-CANCELLED
 15631        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15632         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15633         MOVE WS-CURRENT-MONTH-END
 15634                                 TO DC-BIN-DATE-2
 15635         SET ELAPSED-BETWEEN-BIN TO TRUE
 15636*        MOVE 1                  TO DC-OPTION-CODE
 15637         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15638         IF DATE-CONVERSION-ERROR
 15639            NEXT SENTENCE
 15640          ELSE
 15641             IF DC-ELAPSED-DAYS GREATER +180
 15642                IF PB-CANCEL-DATE-FORCED  OR
 15643                   PB-CANCEL-DATE-FORCED-NO-FEE
 15644                      MOVE ER-2751  TO WS-ERROR
 15645                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15646                 ELSE
 15647                   MOVE ER-2752  TO WS-ERROR
 15648                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15649
 15650     IF AH-COVERAGE-CANCELLED
 15651        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15652         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15653         MOVE WS-CURRENT-MONTH-END
 15654                                 TO DC-BIN-DATE-2
 15655         SET ELAPSED-BETWEEN-BIN TO TRUE
 15656*        MOVE 1                  TO DC-OPTION-CODE
 15657         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15658         IF DATE-CONVERSION-ERROR
 15659            NEXT SENTENCE
 15660          ELSE
 15661             IF DC-ELAPSED-DAYS GREATER +180
 15662                IF PB-CANCEL-DATE-FORCED OR
 15663                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 282
* EL050.cbl
 15664                      MOVE ER-2751  TO WS-ERROR
 15665                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15666                 ELSE
 15667                   MOVE ER-2752  TO WS-ERROR
 15668                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15669
 15670     IF WS-ERROR = ER-2752
 15671        AND (PB-COMPANY-ID = 'ABL'
 15672         OR  PB-COMPANY-ID = 'FGL'
 15673         OR  PB-COMPANY-ID = 'IST'
 15674         OR  PB-COMPANY-ID = 'JHL'
 15675         OR  PB-COMPANY-ID = 'LAP'
 15676         OR  PB-COMPANY-ID = 'LBL'
 15677         OR  PB-COMPANY-ID = 'NCB'
 15678         OR  PB-COMPANY-ID = 'NLI'
 15679         OR  PB-COMPANY-ID = 'OFI'
 15680         OR  PB-COMPANY-ID = 'PLI'
 15681         OR  PB-COMPANY-ID = 'TAO'
 15682         OR  PB-COMPANY-ID = 'TIC'
 15683         OR  PB-COMPANY-ID = 'HER'
 15684         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15685         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15686            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15687            MOVE ER-2762     TO WS-ERROR
 15688            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15689
 15690     IF LF-COVERAGE-CANCELLED
 15691        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15692        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15693             MOVE ER-2733         TO WS-ERROR
 15694             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15695
 15696     IF AH-COVERAGE-CANCELLED
 15697        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15698        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15699              MOVE ER-2733        TO WS-ERROR
 15700              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15701
 15702     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15703        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15704        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15705           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15706            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15707              IF PB-COMPANY-ID NOT = 'LAP'
 15708               MOVE ER-2704            TO WS-ERROR
 15709               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15710
 15711     IF CERT-WAS-NOT-FOUND
 15712         GO TO 3999-END-EDIT.
 15713
 15714     IF PB-COMPANY-ID EQUAL 'CDC'
 15715        IF LF-COVERAGE-CANCELLED
 15716           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15717            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15718            MOVE PB-C-LF-CANCEL-DT
 15719                                 TO DC-BIN-DATE-2
 15720            SET ELAPSED-BETWEEN-BIN TO TRUE
 15721*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 283
* EL050.cbl
 15722            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15723            IF DATE-CONVERSION-ERROR
 15724               NEXT SENTENCE
 15725             ELSE
 15726                IF DC-ELAPSED-DAYS GREATER +60
 15727                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15728
 15729     IF PB-COMPANY-ID EQUAL 'CDC'
 15730        IF AH-COVERAGE-CANCELLED
 15731           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15732            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15733            MOVE PB-C-AH-CANCEL-DT
 15734                                 TO DC-BIN-DATE-2
 15735            MOVE +0              TO DC-ELAPSED-DAYS
 15736                                    DC-ELAPSED-MONTHS
 15737            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15738*           MOVE 1               TO DC-OPTION-CODE
 15739            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15740            IF DATE-CONVERSION-ERROR
 15741               NEXT SENTENCE
 15742             ELSE
 15743                IF DC-ELAPSED-DAYS GREATER +60
 15744                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15745
 15746     MOVE +0                     TO DC-ELAPSED-DAYS
 15747                                    DC-ELAPSED-MONTHS.
 15748
 15749     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15750        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15751          MOVE 'Z'                TO PB-CI-OB-FLAG
 15752          MOVE ER-2767            TO WS-ERROR
 15753          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15754          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15755          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15756          GO TO 3775-OVER-REF-CHK
 15757        ELSE
 15758          MOVE ZEROS              TO PB-CI-LIVES
 15759                                     PB-C-LIVES
 15760          IF PB-CI-OB-FLAG NOT = 'B'
 15761             MOVE SPACE           TO PB-CI-OB-FLAG.
 15762
 15763     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15764         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15765     ELSE
 15766         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15767
 15768     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15769        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15770            MOVE ER-2760         TO WS-ERROR
 15771            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15772
 15773     IF LF-COVERAGE-CANCELLED
 15774        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15775         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15776            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15777               MOVE ER-2774       TO WS-ERROR
 15778               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15779
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 284
* EL050.cbl
 15780     IF AH-COVERAGE-CANCELLED
 15781        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15782         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15783            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15784               MOVE ER-2775       TO WS-ERROR
 15785               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15786
 15787     IF LF-COVERAGE-CANCELLED
 15788        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15789         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15790            MOVE ER-2776         TO WS-ERROR
 15791            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15792
 15793     IF AH-COVERAGE-CANCELLED
 15794        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15795         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15796            MOVE ER-2777         TO WS-ERROR
 15797            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15798
 15799     IF LF-COVERAGE-CANCELLED
 15800        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15801        if pb-ci-lf-expire-dt = low-values or spaces
 15802           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15803           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15804           MOVE PB-CI-EXTENTION-DAYS
 15805                                 TO DC-ELAPSED-DAYS
 15806           SET BIN-PLUS-ELAPSED  TO TRUE
 15807           PERFORM 8500-DATE-CONVERT
 15808                                 THRU 8500-EXIT
 15809           IF DATE-CONVERSION-ERROR
 15810              move low-values    to dc-bin-date-2
 15811           end-if
 15812        else
 15813           move pb-ci-lf-expire-dt
 15814                                 to dc-bin-date-2
 15815        end-if
 15816        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15817           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15818                             OR  'FIA'
 15819              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15820           ELSE
 15821              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15822              MOVE ER-2731       TO WS-ERROR
 15823              PERFORM 9900-ERROR-FORMAT
 15824                                 THRU 9900-EXIT
 15825           end-if
 15826        end-if
 15827     end-if
 15828*    IF LF-COVERAGE-CANCELLED
 15829*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15830*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15831*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15832*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15833*        SET BIN-PLUS-ELAPSED      TO TRUE
 15834*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15835*        IF DATE-CONVERSION-ERROR
 15836*           NEXT SENTENCE
 15837*         ELSE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 285
* EL050.cbl
 15838*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15839*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15840*                            OR  'FIA'
 15841*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15842*              ELSE
 15843*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15844*               MOVE ER-2731       TO WS-ERROR
 15845*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15846     .
 15847 3705-EDIT-AH-CANCEL-DT.
 15848     IF AH-COVERAGE-CANCELLED
 15849        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15850        if pb-ci-AH-expire-dt = low-values or spaces
 15851           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15852           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15853           MOVE PB-CI-EXTENTION-DAYS
 15854                                 TO DC-ELAPSED-DAYS
 15855           SET BIN-PLUS-ELAPSED  TO TRUE
 15856           PERFORM 8500-DATE-CONVERT
 15857                                 THRU 8500-EXIT
 15858           IF DATE-CONVERSION-ERROR
 15859              move low-values    to dc-bin-date-2
 15860           end-if
 15861        else
 15862           move pb-ci-ah-expire-dt
 15863                                 to dc-bin-date-2
 15864        end-if
 15865        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15866           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15867                             OR  'FIA'
 15868              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15869           ELSE
 15870              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15871              MOVE ER-2771       TO WS-ERROR
 15872              PERFORM 9900-ERROR-FORMAT
 15873                                 THRU 9900-EXIT
 15874           end-if
 15875        end-if
 15876     end-if
 15877*    IF AH-COVERAGE-CANCELLED
 15878*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15879*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15880*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15881*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15882**       MOVE 6                    TO DC-OPTION-CODE
 15883*        SET BIN-PLUS-ELAPSED      TO TRUE
 15884*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15885*        IF DATE-CONVERSION-ERROR
 15886*           NEXT SENTENCE
 15887*         ELSE
 15888*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15889*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15890*                             OR 'FIA'
 15891*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15892*             ELSE
 15893*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15894*              MOVE ER-2771       TO WS-ERROR
 15895*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 286
* EL050.cbl
 15896     .
 15897 3705-EDIT-CONTINUED.
 15898
 15899*    IF LF-COVERAGE-CANCELLED
 15900*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15901*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15902*            MOVE ER-2727         TO WS-ERROR
 15903*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15904*
 15905*    IF AH-COVERAGE-CANCELLED
 15906*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15907*        IF PB-COMPANY-ID = 'ACE'
 15908*           MOVE ER-2727        TO WS-ERROR
 15909*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15910*        ELSE
 15911*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15912*              MOVE ER-2727     TO WS-ERROR
 15913*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15914
 15915     IF PB-COMPANY-ID = 'ACE'
 15916       IF AH-COVERAGE-CANCELLED
 15917         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15918           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15919              MOVE ER-2732      TO WS-ERROR
 15920              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15921
 15922     IF PB-COMPANY-ID      EQUAL   'HER'
 15923        IF WS-ERROR        EQUAL   ER-2727
 15924            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15925            MOVE  ER-2725          TO  WS-ERROR
 15926            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15927
 15928     IF PB-C-CLAIM-CREATED-CANCEL
 15929            MOVE ER-2748         TO WS-ERROR
 15930            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15931
 15932     IF PB-C-LAST-NAME NOT = SPACES
 15933         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15934            MOVE ER-2747         TO WS-ERROR
 15935            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15936
 15937 3710-EDIT-LUMP-SUM-PRIOR.
 15938
 15939     IF AH-COVERAGE-CANCELLED
 15940         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15941             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15942                MOVE ER-2735    TO WS-ERROR
 15943                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15944
 15945     IF LF-COVERAGE-CANCELLED
 15946         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15947             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15948                MOVE ER-2735    TO WS-ERROR
 15949                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15950
 15951 3710-EDIT-PRIOR-DEATH.
 15952
 15953*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 287
* EL050.cbl
 15954*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15955*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15956*           (NOT PB-CI-OB)
 15957*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15958*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15959*                   MOVE ER-2732  TO WS-ERROR
 15960*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15961*
 15962*    IF AH-COVERAGE-CANCELLED
 15963*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15964*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15965*           (NOT PB-CI-OB)
 15966*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15967*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15968*                   MOVE ER-2732  TO WS-ERROR
 15969*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15970
 15971     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15972         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15973            (NOT PB-COMP-LF-CANCEL)
 15974             NEXT SENTENCE
 15975         ELSE
 15976           IF PB-C-LF-CANCEL-VOIDED
 15977              NEXT SENTENCE
 15978           ELSE
 15979              MOVE ER-2753      TO WS-ERROR
 15980              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15981
 15982     IF CANCEL-FUTURE-DT
 15983         GO TO 3999-END-EDIT.
 15984
 15985 3715-GET-REMAIN-TERM-LF.
 15986
 15987     IF NO-LF-BENEFIT-MATCH  OR
 15988        WS-LF-BENEFIT-CD = ZEROS
 15989        GO TO 3730-GET-AH-REMAIN-TERM.
 15990
 15991     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15992     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15993     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15994     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15995     MOVE PB-SV-STATE            TO CP-STATE.
 15996     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15997     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15998     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15999     MOVE '2'                    TO CP-PROCESS-TYPE.
 16000     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16001     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16002     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16003     IF (PB-COMPANY-ID = 'CID')
 16004        AND (CP-STATE-STD-ABBRV = 'WI')
 16005        MOVE '7'                 TO CP-REM-TERM-METHOD
 16006        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16007     ELSE
 16008        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16009        MOVE WS-REM-TRM-CALC-OPTION
 16010                                 TO CP-REM-TRM-CALC-OPTION
 16011     END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 288
* EL050.cbl
 16012**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16013     IF (PB-COMPANY-ID = 'CID')
 16014        AND (CP-STATE-STD-ABBRV = 'MO')
 16015        AND (PB-CERT-EFF-DT >= X'9B41')
 16016        AND (PB-CERT-EFF-DT <= X'A2FB')
 16017        MOVE '7'                 TO CP-REM-TERM-METHOD
 16018        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16019     END-IF
 16020     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16021                                    CP-LOAN-TERM.
 16022     IF CP-TRUNCATED-LIFE
 16023        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16024
 16025     IF CP-TERM-IS-DAYS
 16026         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16027     ELSE
 16028         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16029
 16030     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16031
 16032     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16033
 16034     IF LF-COVERAGE-CANCELLED
 16035        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16036        NEXT SENTENCE
 16037      ELSE
 16038          GO TO 3730-GET-AH-REMAIN-TERM.
 16039
 16040 3720-GET-LF-REFUND.
 16041
 16042     IF PB-C-LF-CANCEL-VOIDED
 16043        GO TO 3730-GET-AH-REMAIN-TERM
 16044     end-if
 16045
 16046     IF PB-COMPANY-ID EQUAL 'BOA'
 16047         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16048         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16049         GO TO 3730-GET-AH-REMAIN-TERM.
 16050
 16051     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16052        (WS-AH-SPECIAL-CALC-CD = 'M')
 16053         MOVE ER-2767            TO WS-ERROR
 16054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16055         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16056         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16057         GO TO 3780-UPDATE-CANCEL-CERT.
 16058
 16059*    if (ws-lf-earnings-calc = '6')
 16060*       or (pb-c-lf-refund-override = '6')
 16061*       move cp-remaining-term-1 to cp-remaining-term-2
 16062*    end-if
 16063     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16064
 16065     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16066     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16067     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16068     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16069     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 289
* EL050.cbl
 16070     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16071     IF (PB-COMPANY-ID = 'DCC')
 16072        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16073        IF PDEF-MASTER-FOUND
 16074           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16075              (V1 > +8)
 16076              OR (PD-PROD-CODE (V1) = 'L')
 16077           END-PERFORM
 16078           IF V1 < +9
 16079              MOVE PD-MAX-AMT (V1)
 16080                           TO CP-R-MAX-TOT-BEN
 16081                              EC-AM-LF-MAX-TOT-BEN
 16082           END-IF
 16083        ELSE
 16084        MOVE ' '                 TO PDEF-MASTER-SW
 16085        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16086        MOVE PB-STATE            TO ERPDEF-STATE
 16087        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16088        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16089        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16090        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16091        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16092        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16093        IF PDEF-MASTER-FOUND
 16094           MOVE 'N'              TO PDEF-MASTER-SW
 16095           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16096           IF PDEF-MASTER-FOUND
 16097              IF (ERPDEF-KEY-SAVE (1:16) =
 16098                           PD-CONTROL-PRIMARY (1:16))
 16099                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16100                 CONTINUE
 16101              ELSE
 16102                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16103                 IF (ERPDEF-KEY-SAVE (1:16) =
 16104                           PD-CONTROL-PRIMARY (1:16))
 16105                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16106                    CONTINUE
 16107                 ELSE
 16108                    MOVE 'N'     TO PDEF-MASTER-SW
 16109                 END-IF
 16110              END-IF
 16111
 16112              IF PDEF-MASTER-FOUND
 16113                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16114                    (V1 > +8)
 16115                    OR (PD-PROD-CODE (V1) = 'L')
 16116                 END-PERFORM
 16117                 IF V1 < +9
 16118                    MOVE PD-MAX-AMT (V1)
 16119                                 TO CP-R-MAX-TOT-BEN
 16120                                    EC-AM-LF-MAX-TOT-BEN
 16121                 END-IF
 16122              END-IF
 16123           END-IF
 16124           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16125        END-IF
 16126        END-IF
 16127     END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 290
* EL050.cbl
 16128     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16129
 16130     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16131
 16132     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16133                                    PB-C-LF-REM-TERM.
 16134
 16135     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16136     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16137
 16138     IF PB-COMPANY-ID EQUAL 'FLC'
 16139        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16140           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16141           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16142                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16143                    - CM-LF-ITD-DEATH-AMT
 16144           IF PB-C-LF-REF-CALC LESS THAN +0
 16145              MOVE +0            TO PB-C-LF-REF-CALC
 16146              GO TO 3730-GET-AH-REMAIN-TERM
 16147           ELSE
 16148              GO TO 3730-GET-AH-REMAIN-TERM.
 16149
 16150     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16151                            OR '4' OR '5' OR '6' OR '8'
 16152                            OR '9' OR 'G'
 16153        MOVE PB-C-LF-REFUND-OVERRIDE
 16154                                 TO CP-EARNING-METHOD.
 16155
 16156     if pb-company-id = 'AHL'
 16157        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16158        if cp-class-code = spaces
 16159           move zeros            to cp-class-code
 16160        end-if
 16161     ELSE
 16162        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16163     END-IF
 16164*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16165     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16166     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16167                                    CP-RATING-BENEFIT-AMT.
 16168     IF CP-STATE-STD-ABBRV = 'OR'
 16169         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16170                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16171     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16172     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16173     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16174     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16175     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16176     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16177     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16178     IF WS-DEFAULT-APR NOT NUMERIC
 16179         MOVE ZEROS TO WS-DEFAULT-APR.
 16180****   N O T E   ****
 16181*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16182*      THE OH HARD CODING IN ELCRFNDP
 16183
 16184     IF PB-COMPANY-ID = 'CID'
 16185        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 291
* EL050.cbl
 16186           MOVE WS-LF-EARNINGS-CALC
 16187                                 TO CP-EARNING-METHOD
 16188        END-IF
 16189     END-IF
 16190
 16191****   N O T E   ****
 16192
 16193     IF CP-EARN-AS-NET-PAY
 16194         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16195            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16196                MOVE WS-DEFAULT-APR
 16197                                 TO  CP-LOAN-APR
 16198                MOVE ER-3780     TO  WS-ERROR
 16199                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16200            ELSE
 16201                MOVE ER-3781     TO  WS-ERROR
 16202                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16203*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16204     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16205
 16206     IF CP-REFUND-TYPE-USED NOT = SPACE
 16207         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16208
 16209     IF CP-ERROR-RATE-IS-ZERO OR
 16210        CP-ERROR-RATE-NOT-FOUND
 16211        MOVE ER-2740             TO WS-ERROR
 16212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16213
 16214     IF CP-ERROR-RATE-FILE-NOTOPEN
 16215        MOVE ER-2617             TO WS-ERROR
 16216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16217
 16218     IF PB-COMPANY-ID = 'DCC'
 16219        AND PB-CI-ENTRY-STATUS = 'M'
 16220        MOVE +0                  TO PB-C-LF-REF-CALC
 16221     ELSE
 16222        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16223     END-IF
 16224
 16225     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16226         GO TO 3730-GET-AH-REMAIN-TERM.
 16227
 16228*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16229*       ADD +1                   TO PB-C-LF-REM-TERM
 16230*                                   CP-REMAINING-TERM
 16231*                                   CP-ORIGINAL-TERM.
 16232
 16233     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16234     MOVE '2'                    TO CP-EARNING-METHOD
 16235                                    CP-RATING-METHOD.
 16236     IF PB-COMPANY-ID = 'CID'
 16237        IF (CP-STATE-STD-ABBRV = 'MN')
 16238           AND (PB-CERT-EFF-DT > X'A4FF')
 16239           AND (WS-LF-EARNINGS-CALC = 'B')
 16240           MOVE '5'              TO CP-EARNING-METHOD
 16241           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16242        END-IF
 16243     END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 292
* EL050.cbl
 16244     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16245                                        CP-REMAINING-BENEFIT
 16246                                        CP-RATING-BENEFIT-AMT.
 16247     IF CP-STATE-STD-ABBRV = 'OR'
 16248         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16249                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16250     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16251     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16252
 16253     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16254
 16255     IF CP-ERROR-RATE-IS-ZERO OR
 16256        CP-ERROR-RATE-NOT-FOUND
 16257        MOVE ER-2740             TO WS-ERROR
 16258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16259
 16260     IF CP-ERROR-RATE-FILE-NOTOPEN
 16261        MOVE ER-2617             TO WS-ERROR
 16262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16263
 16264     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16265
 16266******************************************************************
 16267
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 293
* EL050.cbl
 16269 3730-GET-AH-REMAIN-TERM.
 16270     IF NO-AH-BENEFIT-MATCH  OR
 16271        WS-AH-BENEFIT-CD = ZEROS
 16272         GO TO 3770-CHECK-REFUNDS.
 16273
 16274     IF PB-CI-AH-LUMP-SUM-DISAB
 16275         IF  PB-C-AH-CANCEL-AMT = ZERO
 16276            IF NOT PB-COMP-AH-CANCEL
 16277             GO TO 3770-CHECK-REFUNDS.
 16278
 16279     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16280     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16281     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16282     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16283     MOVE PB-SV-STATE            TO CP-STATE.
 16284     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16285     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16286     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16287     MOVE '2'                    TO CP-PROCESS-TYPE.
 16288     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16289     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16290     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16291     IF (PB-COMPANY-ID = 'CID')
 16292        AND (CP-STATE-STD-ABBRV = 'WI')
 16293        MOVE '7'                 TO CP-REM-TERM-METHOD
 16294        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16295     ELSE
 16296        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16297        MOVE WS-REM-TRM-CALC-OPTION
 16298                                 TO CP-REM-TRM-CALC-OPTION
 16299     END-IF
 16300     IF (PB-COMPANY-ID = 'CID')
 16301        AND (CP-STATE-STD-ABBRV = 'MO')
 16302        AND (PB-CERT-EFF-DT >= X'9B41')
 16303        AND (PB-CERT-EFF-DT <= X'A2FB')
 16304        MOVE '7'                 TO CP-REM-TERM-METHOD
 16305        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16306     END-IF
 16307     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16308                                    CP-LOAN-TERM.
 16309     IF NOT CP-TERM-IS-DAYS
 16310         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16311
 16312     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16313
 16314     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16315
 16316     IF AH-COVERAGE-CANCELLED
 16317        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16318        NEXT SENTENCE
 16319      ELSE
 16320         GO TO 3770-CHECK-REFUNDS.
 16321
 16322 3740-GET-AH-REFUND.
 16323
 16324     IF PB-C-AH-CANCEL-VOIDED
 16325        GO TO 3780-UPDATE-CANCEL-CERT
 16326     END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 294
* EL050.cbl
 16327
 16328     IF PB-COMPANY-ID = 'BOA'
 16329         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16330         GO TO 3770-CHECK-REFUNDS.
 16331
 16332     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16333*    MOVE ' '                    TO DC-OPTION-CODE
 16334     SET BIN-TO-GREG             TO TRUE
 16335     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16336     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16337                                    PB-C-AH-REM-TERM.
 16338     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16339     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16340
 16341     IF PB-COMPANY-ID EQUAL 'FLC'
 16342        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16343           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16344           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16345                    - CM-AH-ITD-AH-PMT)
 16346           IF PB-C-AH-REF-CALC LESS THAN +0
 16347              MOVE +0            TO PB-C-AH-REF-CALC
 16348              GO TO 3770-CHECK-REFUNDS
 16349           ELSE
 16350              GO TO 3770-CHECK-REFUNDS.
 16351
 16352     IF PB-COMPANY-ID = 'DCC'
 16353        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16354            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16355           MOVE 'S'              TO CP-EARNING-METHOD
 16356        END-IF
 16357     END-IF
 16358     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16359                            OR '4' OR '5' OR '6' OR '8'
 16360                            OR '9' OR 'G' OR 'S'
 16361        MOVE PB-C-AH-REFUND-OVERRIDE
 16362                                 TO CP-EARNING-METHOD.
 16363
 16364     if pb-company-id = 'AHL'
 16365        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16366        if cp-class-code = spaces
 16367           move zeros            to cp-class-code
 16368        end-if
 16369     ELSE
 16370        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16371     END-IF
 16372*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16373     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16374     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16375                                    CP-RATING-BENEFIT-AMT.
 16376     IF CP-STATE-STD-ABBRV = 'OR'
 16377         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16378                                         PB-CI-AH-TERM.
 16379     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16380     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16381     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16382     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16383     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16384     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 295
* EL050.cbl
 16385
 16386     IF CP-STATE-STD-ABBRV = 'OH'
 16387        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16388                                AND 'CID' AND 'DCC' AND 'AHL')
 16389           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16390              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16391              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16392              MOVE '6' TO CP-EARNING-METHOD
 16393           END-IF
 16394        END-IF
 16395        IF PB-COMPANY-ID = 'CID'
 16396           IF NO-LIFE-COVERAGE
 16397              IF CP-CRITICAL-PERIOD
 16398                 MOVE '2'       TO CP-EARNING-METHOD
 16399              ELSE
 16400                 MOVE '6'       TO CP-EARNING-METHOD
 16401              END-IF
 16402           ELSE
 16403              IF WS-LF-COVERAGE-TYPE = 'L'
 16404                 MOVE '2'       TO CP-EARNING-METHOD
 16405              ELSE
 16406                 IF (PB-CI-LF-TERM > +60) OR
 16407                    (WS-LF-EARNINGS-CALC = '5')
 16408                    IF CP-CRITICAL-PERIOD
 16409                       MOVE '2'  TO CP-EARNING-METHOD
 16410                    ELSE
 16411                       MOVE '6'  TO CP-EARNING-METHOD
 16412                    END-IF
 16413                 ELSE
 16414                    MOVE '1'     TO CP-EARNING-METHOD
 16415                 END-IF
 16416              END-IF
 16417           END-IF
 16418        END-IF
 16419     END-IF
 16420
 16421*    IF CP-STATE-STD-ABBRV = 'VA'
 16422*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16423*          IF CP-ORIGINAL-TERM GREATER 61
 16424*             MOVE '6' TO CP-EARNING-METHOD
 16425*          ELSE
 16426*             MOVE '1' TO CP-EARNING-METHOD.
 16427
 16428     IF WS-DEFAULT-APR NOT NUMERIC
 16429         MOVE ZEROS TO WS-DEFAULT-APR.
 16430     IF CP-EARN-AS-NET-PAY
 16431         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16432            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16433                MOVE WS-DEFAULT-APR
 16434                                 TO  CP-LOAN-APR
 16435                MOVE ER-3780     TO  WS-ERROR
 16436                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16437            ELSE
 16438                MOVE ER-3781     TO  WS-ERROR
 16439                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16440     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16441     IF PB-COMPANY-ID = 'DCC'
 16442        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 296
* EL050.cbl
 16443        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16444        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16445     END-IF
 16446     IF PB-COMPANY-ID = 'DCC'
 16447        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16448        AND (CP-EARNING-METHOD = 'D')
 16449        AND (CP-CANCEL-REASON NOT = 'R')
 16450        CONTINUE
 16451     ELSE
 16452        GO TO 3750-CONTINUE
 16453     END-IF
 16454     MOVE ' '                    TO DD-IU-SW
 16455     IF NOT PDEF-MASTER-FOUND
 16456        MOVE ' '                 TO PDEF-MASTER-SW
 16457        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16458        MOVE PB-STATE            TO ERPDEF-STATE
 16459        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16460        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16461        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16462        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16463        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16464        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16465        IF PDEF-MASTER-FOUND
 16466           MOVE 'N'              TO PDEF-MASTER-SW
 16467           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16468           IF PDEF-MASTER-FOUND
 16469              IF (ERPDEF-KEY-SAVE (1:16) =
 16470                           PD-CONTROL-PRIMARY (1:16))
 16471                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16472                 CONTINUE
 16473              ELSE
 16474                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16475                 IF (ERPDEF-KEY-SAVE (1:16) =
 16476                           PD-CONTROL-PRIMARY (1:16))
 16477                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16478                    CONTINUE
 16479                 ELSE
 16480                    MOVE ER-2740 TO WS-ERROR
 16481                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16482                    GO TO 3770-CHECK-REFUNDS
 16483                 END-IF
 16484              END-IF
 16485           END-IF
 16486           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16487        END-IF
 16488     END-IF
 16489     IF PDEF-MASTER-FOUND
 16490        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16491           (V1 > +8)
 16492           OR (PD-PROD-CODE (V1) = 'I')
 16493        END-PERFORM
 16494        IF V1 < +9
 16495           SET DD-IU-PRESENT        TO TRUE
 16496        END-IF
 16497        IF WS-AH-DCC-TRUNC = 'T'
 16498           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16499        ELSE
 16500           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 297
* EL050.cbl
 16501        END-IF
 16502        EVALUATE TRUE
 16503           WHEN WS-TERM > +168
 16504              MOVE 15               TO V1
 16505           WHEN WS-TERM > +156
 16506              MOVE 14               TO V1
 16507           WHEN WS-TERM > +144
 16508              MOVE 13               TO V1
 16509           WHEN WS-TERM > +132
 16510              MOVE 12               TO V1
 16511           WHEN WS-TERM > +120
 16512              MOVE 11               TO V1
 16513           WHEN WS-TERM > +108
 16514              MOVE 10               TO V1
 16515           WHEN WS-TERM > +96
 16516              MOVE 9                TO V1
 16517           WHEN WS-TERM > +84
 16518              MOVE 8                TO V1
 16519           WHEN WS-TERM > +72
 16520              MOVE 7                TO V1
 16521           WHEN WS-TERM > +60
 16522              MOVE 6                TO V1
 16523           WHEN WS-TERM > +48
 16524              MOVE 5                TO V1
 16525           WHEN WS-TERM > +36
 16526              MOVE 4                TO V1
 16527           WHEN WS-TERM > +24
 16528              MOVE 3                TO V1
 16529           WHEN WS-TERM > +12
 16530              MOVE 2                TO V1
 16531           WHEN OTHER
 16532              MOVE 1                TO V1
 16533        END-EVALUATE
 16534
 16535        EVALUATE TRUE
 16536*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16537*             < +13)
 16538*             AND (DD-IU-PRESENT)
 16539*             MOVE 2                TO V2
 16540*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16541*             MOVE 1                TO V2
 16542           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16543              MOVE 2                TO V2
 16544           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16545              MOVE 3                TO V2
 16546           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16547              MOVE 4                TO V2
 16548           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16549              MOVE 5                TO V2
 16550           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16551              MOVE 6                TO V2
 16552           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16553              MOVE 7                TO V2
 16554           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16555              MOVE 8                TO V2
 16556           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16557              MOVE 9                TO V2
 16558           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 298
* EL050.cbl
 16559              MOVE 10               TO V2
 16560           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16561              MOVE 11               TO V2
 16562           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16563              MOVE 12               TO V2
 16564           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16565              MOVE 13               TO V2
 16566           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16567              MOVE 14               TO V2
 16568           WHEN OTHER
 16569              MOVE 15               TO V2
 16570        END-EVALUATE
 16571
 16572        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16573                                 TO CP-DDF-LO-FACT
 16574        MOVE PD-UEP-FACTOR (V1 V2)
 16575                                 TO CP-DDF-HI-FACT
 16576
 16577        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16578        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16579        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16580           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16581        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16582        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16583        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16584           + PD-1ST-YR-ADMIN-ALLOW
 16585
 16586        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16587*       IF PI-CLP-YN = 'Y'
 16588*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16589*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16590*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16591*       END-IF
 16592
 16593        IF DD-IU-PRESENT
 16594           MOVE 'I'              TO CP-EARNING-METHOD
 16595        END-IF
 16596        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16597                                     CP-CLP-RATE-UP
 16598        IF CP-IU-RATE-UP NOT = ZEROS
 16599           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16600              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16601           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16602              / (1 - WS-WORK-FACT)
 16603        END-IF
 16604     END-IF
 16605     .
 16606 3750-CONTINUE.
 16607     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16608
 16609     IF CP-REFUND-TYPE-USED NOT = SPACE
 16610         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16611
 16612     IF CP-ERROR-RATE-IS-ZERO OR
 16613        CP-ERROR-RATE-NOT-FOUND
 16614        MOVE ER-2740             TO WS-ERROR
 16615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16616
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 299
* EL050.cbl
 16617     IF CP-ERROR-RATE-FILE-NOTOPEN
 16618        MOVE ER-2617             TO WS-ERROR
 16619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16620     IF PB-COMPANY-ID = 'DCC'
 16621        AND PB-CI-ENTRY-STATUS = 'M'
 16622        MOVE +0                  TO PB-C-AH-REF-CALC
 16623     ELSE
 16624        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16625     END-IF
 16626     IF PB-COMPANY-ID = 'DCC'
 16627        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16628        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16629        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16630        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16631        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16632        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16633        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16634        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16635*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16636     END-IF
 16637     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 300
* EL050.cbl
 16639
 16640 3770-CHECK-REFUNDS.
 16641
 16642     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16643        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16644           MOVE ER-2766          TO WS-ERROR
 16645           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16646           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16647           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16648              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16649
 16650     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16651        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16652           MOVE ER-2766          TO WS-ERROR
 16653           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16654           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16655           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16656              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16657
 16658     IF PB-COMP-LF-CANCEL
 16659        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16660        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16661           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16662              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16663
 16664     IF PB-COMP-AH-CANCEL
 16665        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16666        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16667           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16668              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16669
 16670     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16671             GIVING WS-UNSIGN-WRK1
 16672     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16673             GIVING WS-UNSIGN-WRK2.
 16674
 16675     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16676         MOVE ZERO TO WS-UNSIGN-WRK1.
 16677
 16678     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16679         MOVE ZERO TO WS-UNSIGN-WRK2.
 16680
 16681     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16682
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 301
* EL050.cbl
 16684
 16685 3772-CONTINUE.
 16686
 16687**********************************
 16688*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16689*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16690*** DOUBLES THE TOLERANCE AMOUNT.
 16691***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16692**********************************
 16693     IF PB-COMPANY-ID = 'MON'
 16694     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16695         IF WS-REF-REJECT-SW = SPACE
 16696             MOVE ER-2754        TO WS-ERROR
 16697             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16698           ELSE
 16699             MOVE ER-2736        TO WS-ERROR
 16700             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16701**********************************
 16702
 16703 3773-CONTINUE.
 16704
 16705     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16706        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16707           MOVE ER-2723          TO WS-ERROR
 16708           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16709
 16710     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16711        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16712           MOVE ER-2724          TO WS-ERROR
 16713           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16714
 16715     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16716         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16717             (1 + WS-LF-REFUND-OVS-PCT)
 16718     ELSE
 16719         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16720
 16721     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16722         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16723             (1 - WS-TOL-LF-REFUND-PCT)
 16724     ELSE
 16725         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16726
 16727     IF (PB-COMPANY-ID = 'DCC')
 16728        AND (PB-CI-ENTRY-STATUS = 'M')
 16729        AND (PB-C-LF-CANCEL-AMT > +0)
 16730        MOVE ER-3843             TO WS-ERROR
 16731        PERFORM 9900-ERROR-FORMAT
 16732                                 THRU 9900-EXIT
 16733     END-IF
 16734     EVALUATE TRUE
 16735        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16736           CONTINUE
 16737        WHEN PB-C-LF-CANCEL-AMT = +0
 16738                 AND PB-C-LF-REF-CALC > +0
 16739           CONTINUE
 16740        WHEN WS-LF-REFUND-OVS-AMT = 0
 16741                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 302
* EL050.cbl
 16742           CONTINUE
 16743        WHEN OTHER
 16744           IF WS-TOL-LF-REFUND  = +0
 16745              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16746           END-IF
 16747           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16748                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16749                          (PB-C-LF-CANCEL-AMT))
 16750              CONTINUE
 16751           ELSE
 16752              IF WS-LF-REFUND-OVS-AMT = +0
 16753                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16754              END-IF
 16755              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16756                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16757                                       PB-C-LF-CANCEL-AMT)
 16758                 CONTINUE
 16759              ELSE
 16760                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16761                   MOVE ER-2754   TO  WS-ERROR
 16762                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16763                 ELSE
 16764                    MOVE ER-2736   TO  WS-ERROR
 16765                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16766                 END-IF
 16767              END-IF
 16768           END-IF
 16769     END-EVALUATE.
 16770
 16771     EVALUATE TRUE
 16772        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16773           CONTINUE
 16774        WHEN PB-C-LF-CANCEL-AMT = +0
 16775                 AND PB-C-LF-REF-CALC > +0
 16776           CONTINUE
 16777        WHEN OTHER
 16778           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16779               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16780              CONTINUE
 16781           ELSE
 16782              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16783               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16784                CONTINUE
 16785              ELSE
 16786                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16787                     MOVE ER-2754   TO  WS-ERROR
 16788                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16789                 ELSE
 16790                     MOVE ER-2736   TO  WS-ERROR
 16791                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16792                 END-IF
 16793              END-IF
 16794           END-IF
 16795     END-EVALUATE.
 16796
 16797     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16798         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16799             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 303
* EL050.cbl
 16800     ELSE
 16801         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16802
 16803     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16804         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16805             (1 - WS-TOL-AH-REFUND-PCT)
 16806     ELSE
 16807         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16808
 16809     IF (PB-COMPANY-ID = 'DCC')
 16810        AND (PB-CI-ENTRY-STATUS = 'M')
 16811        AND (PB-C-AH-CANCEL-AMT > +0)
 16812        MOVE ER-3843             TO WS-ERROR
 16813        PERFORM 9900-ERROR-FORMAT
 16814                                 THRU 9900-EXIT
 16815     END-IF
 16816     EVALUATE TRUE
 16817        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16818           CONTINUE
 16819*       WHEN PB-C-AH-REF-CALC = +0 AND
 16820*                  PB-C-AH-CANCEL-AMT > +0
 16821        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16822                   PB-C-AH-REF-CALC > +0
 16823           CONTINUE
 16824        WHEN WS-AH-REFUND-OVS-AMT = +0
 16825                AND WS-TOL-AH-REFUND = +0
 16826           CONTINUE
 16827        WHEN OTHER
 16828           IF WS-TOL-AH-REFUND = +0
 16829              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16830           END-IF
 16831           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16832               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16833                                         PB-C-AH-CANCEL-AMT)
 16834              CONTINUE
 16835           ELSE
 16836              IF WS-AH-REFUND-OVS-AMT = +0
 16837                 MOVE +9999999.99 TO
 16838                         WS-AH-REFUND-OVS-AMT
 16839              END-IF
 16840              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16841                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16842                                         PB-C-AH-CANCEL-AMT)
 16843                 CONTINUE
 16844              ELSE
 16845                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16846                    MOVE ER-2754   TO  WS-ERROR
 16847                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16848                 ELSE
 16849                    MOVE ER-2736   TO  WS-ERROR
 16850                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16851                 END-IF
 16852              END-IF
 16853           END-IF
 16854     END-EVALUATE.
 16855
 16856     EVALUATE TRUE
 16857        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 304
* EL050.cbl
 16858           CONTINUE
 16859*       WHEN PB-C-AH-REF-CALC > +0 AND
 16860*                  PB-C-AH-CANCEL-AMT = +0
 16861        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16862                   PB-C-AH-REF-CALC = +0
 16863           CONTINUE
 16864        WHEN OTHER
 16865           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16866               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16867              CONTINUE
 16868           ELSE
 16869              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16870                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16871                 CONTINUE
 16872              ELSE
 16873                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16874                     MOVE ER-2754   TO  WS-ERROR
 16875                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16876                 ELSE
 16877                     MOVE ER-2736   TO  WS-ERROR
 16878                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16879                 END-IF
 16880              END-IF
 16881           END-IF
 16882     END-EVALUATE.
 16883
 16884     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16885        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16886        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16887           AND  PB-C-LF-REF-CALC < +1.00
 16888           AND  PB-C-AH-REF-CALC < +1.00
 16889           CONTINUE
 16890        ELSE
 16891           IF (PB-COMPANY-ID = 'DCC')
 16892              AND (PB-CI-ENTRY-STATUS = 'M')
 16893              CONTINUE
 16894           ELSE
 16895              MOVE ER-2741       TO WS-ERROR
 16896              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16897           END-IF
 16898        END-IF
 16899     END-IF
 16900
 16901     IF (PB-C-LF-CANCEL-AMT = ZERO
 16902        AND WS-LF-BENEFIT-CD NOT = ZERO
 16903        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16904        AND PB-C-LF-REF-CALC NOT = ZERO)
 16905        OR
 16906        (PB-C-LF-CANCEL-AMT = ZERO
 16907        AND WS-LF-BENEFIT-CD NOT = ZERO
 16908        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16909             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16910                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16911                NEXT SENTENCE
 16912             ELSE
 16913                MOVE ER-2739        TO WS-ERROR
 16914                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16915
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 305
* EL050.cbl
 16916     IF (PB-C-AH-CANCEL-AMT = ZERO
 16917        AND WS-AH-BENEFIT-CD NOT = ZERO
 16918        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16919        AND PB-C-AH-REF-CALC NOT = ZERO)
 16920        OR
 16921        (PB-C-AH-CANCEL-AMT = ZERO
 16922        AND WS-AH-BENEFIT-CD NOT = ZERO
 16923        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16924             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16925                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16926                NEXT SENTENCE
 16927             ELSE
 16928                MOVE ER-2738        TO WS-ERROR
 16929                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16930
 16931 3775-OVER-REF-CHK.
 16932
 16933     IF PB-CI-ENTRY-STATUS = '5'
 16934        GO TO 3780-UPDATE-CANCEL-CERT.
 16935
 16936     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16937                              PB-CI-LF-ALT-PREMIUM-AMT.
 16938
 16939     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16940        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16941                                 PB-C-LF-REF-CALC
 16942      ELSE
 16943        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16944                                 PB-C-LF-CANCEL-AMT.
 16945
 16946     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16947        MOVE ER-2755             TO WS-ERROR
 16948        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16949
 16950     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16951
 16952     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16953        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16954                                 PB-C-AH-REF-CALC
 16955      ELSE
 16956        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16957                                 PB-C-AH-CANCEL-AMT.
 16958
 16959     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16960        MOVE ER-2778             TO WS-ERROR
 16961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16962
 16963     IF PB-CI-OB-FLAG NOT = 'Z'
 16964        NEXT SENTENCE
 16965       ELSE
 16966         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16967            MOVE ER-2757           TO WS-ERROR
 16968            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16969
 16970 3780-UPDATE-CANCEL-CERT.
 16971
 16972     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16973        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 306
* EL050.cbl
 16974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16975
 16976     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16977         MOVE ER-2729              TO WS-ERROR
 16978         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16979
 16980     IF PB-CI-LF-BENEFIT-CD = ZERO
 16981         GO TO 3780-UPDATE-CONT-1.
 16982
 16983     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16984         GO TO 3780-UPDATE-CONT-1.
 16985
 16986     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16987       AND
 16988        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16989       AND
 16990        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16991       AND
 16992        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16993            NEXT SENTENCE
 16994       ELSE
 16995        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16996          AND
 16997***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16998***       AND
 16999           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17000            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17001               MOVE ER-2730      TO WS-ERROR
 17002               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17003               GO TO 3999-END-EDIT
 17004            ELSE
 17005               GO TO 3999-END-EDIT
 17006        ELSE
 17007            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17008               MOVE ER-2765           TO WS-ERROR
 17009               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17010               GO TO 3785-CHECK-NH.
 17011*              GO TO 3999-END-EDIT.
 17012
 17013 3780-UPDATE-CONT-1.
 17014     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17015
 17016     IF PB-CI-AH-BENEFIT-CD = ZERO
 17017         GO TO 3780-UPDATE-CONT-2.
 17018
 17019     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17020         GO TO 3780-UPDATE-CONT-2.
 17021
 17022     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17023
 17024     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17025       AND
 17026        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17027       AND
 17028        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17029       AND
 17030        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17031            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 307
* EL050.cbl
 17032       ELSE
 17033        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17034          AND
 17035***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17036***       AND
 17037           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17038           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17039            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17040               MOVE ER-2773      TO WS-ERROR
 17041               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17042               GO TO 3999-END-EDIT
 17043            ELSE
 17044               GO TO 3999-END-EDIT
 17045            END-IF
 17046           ELSE
 17047             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17048                IF MSTR-CERT-NO = W-CL-CERT-NO
 17049                   MOVE ER-2890 TO WS-ERROR
 17050                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17051                   GO TO 3999-END-EDIT
 17052                ELSE
 17053                   MOVE ER-2898 TO WS-ERROR
 17054                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17055                   GO TO 3999-END-EDIT
 17056                END-IF
 17057             ELSE
 17058                GO TO 3785-CHECK-NH
 17059             END-IF
 17060           END-IF
 17061          ELSE
 17062            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17063              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17064                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17065                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17066                      MOVE ER-2890 TO WS-ERROR
 17067                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17068                      GO TO 3999-END-EDIT
 17069                   ELSE
 17070                      MOVE ER-2898 TO WS-ERROR
 17071                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17072                      GO TO 3999-END-EDIT
 17073                   END-IF
 17074                ELSE
 17075                   MOVE ER-2765 TO WS-ERROR
 17076                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17077                   GO TO 3785-CHECK-NH
 17078                END-IF
 17079              ELSE
 17080               MOVE ER-2765      TO WS-ERROR
 17081               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17082               GO TO 3785-CHECK-NH.
 17083*              GO TO 3999-END-EDIT.
 17084
 17085 3780-UPDATE-CONT-2.
 17086
 17087     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17088        AND WS-LF-BENEFIT-CD = ZERO
 17089           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 308
* EL050.cbl
 17090           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17091
 17092     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17093        AND WS-AH-BENEFIT-CD = ZERO
 17094           MOVE ER-2744           TO WS-ERROR
 17095           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17096
 17097     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17098        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17099        AND
 17100        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17101         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17102           MOVE ER-2746           TO WS-ERROR
 17103           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17104
 17105     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17106       AND
 17107        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17108             MOVE ER-2737        TO WS-ERROR
 17109             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17110
 17111     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17112       AND
 17113        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17114             MOVE ER-2737        TO WS-ERROR
 17115             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17116
 17117     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17118         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17119             OR 'CID' OR 'DCC' OR 'AHL'
 17120             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17121         ELSE
 17122             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17123                 MOVE ER-2768    TO WS-ERROR
 17124                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17125             ELSE
 17126                 MOVE ER-2756    TO WS-ERROR
 17127                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17128
 17129     IF CERT-PEND-ISSUE-RETURNED
 17130        MOVE ER-2772             TO WS-ERROR
 17131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17132 3785-CHECK-NH.
 17133     IF PB-STATE NOT = 'NH'
 17134        GO TO 3999-END-EDIT
 17135     END-IF
 17136
 17137     MOVE ER-2796                TO WS-ERROR
 17138     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17139     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17140        OR (CM-NH-INTERFACE-SW = 'Y')
 17141        MOVE ER-2793             TO WS-ERROR
 17142        PERFORM 9900-ERROR-FORMAT
 17143                                 THRU 9900-EXIT
 17144     END-IF
 17145     MOVE +0                     TO WS-PAYMENT-AMT
 17146     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17147        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 309
* EL050.cbl
 17148     END-IF
 17149     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17150        GO TO 3999-END-EDIT
 17151     END-IF
 17152     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17153     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17154     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17155        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17156     END-IF
 17157     MOVE '1'                    TO DC-OPTION-CODE
 17158     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17159     IF NO-CONVERSION-ERROR
 17160        IF DC-ELAPSED-DAYS < +16
 17161           GO TO 3999-END-EDIT
 17162        END-IF
 17163     END-IF
 17164     MOVE +0                     TO DC-ELAPSED-DAYS
 17165     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17166     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17167     MOVE '1'                    TO DC-OPTION-CODE
 17168     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17169     IF NO-CONVERSION-ERROR
 17170        IF DC-ELAPSED-DAYS > +30
 17171           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17172        ELSE
 17173           GO TO 3999-END-EDIT
 17174        END-IF
 17175     ELSE
 17176        GO TO 3999-END-EDIT
 17177     END-IF
 17178     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17179        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17180           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17181     IF WS-PAYMENT-AMT < 600.00
 17182        GO TO 3999-END-EDIT
 17183     END-IF
 17184     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17185
 17186     IF (ERMAIL-FOUND = ' ')
 17187         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17188         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17189        GO TO 3999-END-EDIT
 17190     END-IF
 17191     MOVE ER-2795                TO WS-ERROR
 17192     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17193
 17194     GO TO 3999-END-EDIT.
 17195******************************************************************
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 310
* EL050.cbl
 17197 3990-FILES-NOT-OPEN.
 17198
 17199     MOVE ER-2617                TO WS-ERROR.
 17200     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17201     GO TO 9990-RETURN.
 17202
 17203 3999-END-EDIT.
 17204
 17205     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17206
 17207     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17208         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17209         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17210             PERFORM 9250-UNLOCK-RETURN
 17211             GO TO 9990-RETURN
 17212          ELSE
 17213             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17214             GO TO 9990-RETURN.
 17215
 17216     IF PB-CANCELLATION
 17217          GO TO 9990-RETURN.
 17218
 17219     IF CERT-WAS-NOT-FOUND
 17220        MOVE SPACES              TO CERTIFICATE-MASTER.
 17221
 17222     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17223
 17224     IF CERT-WAS-FOUND
 17225         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17226             PERFORM 9250-UNLOCK-RETURN
 17227          ELSE
 17228            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17229      ELSE
 17230         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17231
 17232     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17233        IF PB-COMPANY-ID = 'DCC' AND
 17234           (PB-CARRIER = '2' OR '4' OR '6')
 17235              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17236        END-IF
 17237     END-IF.
 17238
 17239     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17240         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17241     END-IF.
 17242     move ' '                    to ws-ins-age-defaulted
 17243     perform 8150-read-elcrtt    thru 8150-exit
 17244     if ws-ins-age-defaulted = 'Y'
 17245        move er-1573             to ws-error
 17246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17247     end-if
 17248
 17249     if ws-jnt-age-defaulted = 'Y'
 17250        move er-1574             to ws-error
 17251        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17252     end-if
 17253***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17254***                                                           ****
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 311
* EL050.cbl
 17255***  Set an error if the state requires verification of agent ****
 17256***  and agent hasn't verified yet.                           ****
 17257***                                                           ****
 17258***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17259     if pb-input-dt >= X'AD81'    *> 09/01/2015
 17260     if (ws-st-agent-sig-edit = 'Y')
 17261        and (am-report-code-1 not = 'CONLEY')
 17262        evaluate true
 17263           when cs-agent-edit-status = 'C'
 17264              move er-1743       to ws-error
 17265              perform 9900-error-format
 17266                                 thru 9900-exit
 17267           when cs-agent-edit-status = 'S'
 17268              move er-1744       to ws-error
 17269              perform 9900-error-format
 17270                                 thru 9900-exit
 17271           when cs-agent-edit-status = 'M'
 17272              move er-1745       to ws-error
 17273              perform 9900-error-format
 17274                                 thru 9900-exit
 17275           when cs-agent-edit-status = 'R'
 17276              move er-1747       to ws-error
 17277              perform 9900-error-format
 17278                                 thru 9900-exit
 17279           when cs-agent-edit-status = 'N'
 17280              move er-1748       to ws-error
 17281              perform 9900-error-format
 17282                                 thru 9900-exit
 17283           when cs-agent-edit-status <> 'V' and 'U' and
 17284                                        'R' and 'N'
 17285              move er-1746       to ws-error
 17286              perform 9900-error-format
 17287                                 thru 9900-exit
 17288        end-evaluate
 17289     end-if
 17290     end-if
 17291     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17292     IF ((PB-COMPANY-ID = 'DCC')
 17293        AND (WS-NO-SECURE-PAY))
 17294                  OR
 17295        (WS-LF-SPECIAL-CALC-CD = 'O'
 17296        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17297        SET SKIP-ADDR-EDIT       TO TRUE
 17298     END-IF
 17299     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17300        AND (NOT SKIP-ADDR-EDIT)
 17301        MOVE ER-2963             TO WS-ERROR
 17302        PERFORM 9900-ERROR-FORMAT
 17303                                 THRU 9900-EXIT
 17304        GO TO 9990-RETURN
 17305     END-IF
 17306     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17307     IF ERPNDM-FOUND NOT = 'X'
 17308        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17309           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17310           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17311           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17312           AND (NOT SKIP-ADDR-EDIT)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 312
* EL050.cbl
 17313           MOVE ER-2694          TO WS-ERROR
 17314           PERFORM 9900-ERROR-FORMAT
 17315                                 THRU 9900-EXIT
 17316        END-IF
 17317        MOVE ' '                 TO STATE-RECORD-ERROR
 17318        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17319        MOVE PM-STATE            TO CNTL-ACCESS
 17320        MOVE '3'                 TO CNTL-REC-TYPE
 17321        MOVE +0                  TO CNTL-SEQ-NO
 17322        MOVE '0'                 TO RC-SW-2
 17323        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17324        IF (NO-STATE-RECORD)
 17325           OR (CF-RECORD-TYPE NOT = '3')
 17326           OR (PM-STATE NOT = CF-STATE-CODE)
 17327           IF (PM-STATE = SPACES)
 17328              AND (SKIP-ADDR-EDIT)
 17329              CONTINUE
 17330           ELSE
 17331              MOVE ER-2963       TO WS-ERROR
 17332              PERFORM 9900-ERROR-FORMAT
 17333                                 THRU 9900-EXIT
 17334           END-IF
 17335        END-IF
 17336        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17337           MOVE ER-2883          TO WS-ERROR
 17338           PERFORM 9900-ERROR-FORMAT
 17339                                 THRU 9900-EXIT
 17340        END-IF
 17341        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17342           MOVE ' '                 TO STATE-RECORD-ERROR
 17343           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17344           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17345           MOVE '3'                 TO CNTL-REC-TYPE
 17346           MOVE +0                  TO CNTL-SEQ-NO
 17347           MOVE '0'                 TO RC-SW-2
 17348           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17349           IF NO-STATE-RECORD
 17350              OR (CF-RECORD-TYPE NOT = '3')
 17351              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17352              MOVE ER-2964          TO WS-ERROR
 17353              PERFORM 9900-ERROR-FORMAT
 17354                                    THRU 9900-EXIT
 17355           END-IF
 17356        END-IF
 17357     ELSE
 17358        IF NOT SKIP-ADDR-EDIT
 17359           MOVE ER-2393          TO WS-ERROR
 17360           PERFORM 9900-ERROR-FORMAT
 17361                                 THRU 9900-EXIT
 17362        END-IF
 17363     END-IF
 17364
 17365     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17366
 17367     IF (ERMAIL-FOUND = ' ' AND
 17368        ERPNDM-FOUND = ' ')
 17369        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17370           MA-PROFILE-INFO = PM-PROFILE-INFO AND
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 313
* EL050.cbl
 17371           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17372          OR
 17373           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17374          OR
 17375           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17376           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17377           GO TO 3999-UNLOCK-ERMAIL.
 17378
 17379     IF ERPNDM-FOUND = 'X'
 17380        GO TO 3999-UNLOCK-ERMAIL.
 17381
 17382     IF PM-INSURED-LAST-NAME      = SPACES
 17383        AND PM-INSURED-FIRST-NAME = SPACES
 17384        AND PM-ADDRESS-LINE-1     = SPACES
 17385        AND PM-ADDRESS-LINE-2     = SPACES
 17386        AND PM-CITY-STATE         = SPACES
 17387        AND PM-CRED-BENE-NAME     = SPACES
 17388        AND PM-CRED-BENE-ADDR     = SPACES
 17389        AND PM-CRED-BENE-CTYST    = SPACES
 17390        GO TO 3999-UNLOCK-ERMAIL
 17391     END-IF
 17392
 17393     MOVE SPACES                 TO MAILING-DATA.
 17394
 17395     MOVE 'MA'                   TO MA-RECORD-ID.
 17396     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17397     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17398     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17399     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17400     MOVE PB-SV-STATE            TO MA-STATE.
 17401     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17402     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17403
 17404     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17405     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17406
 17407     IF ERMAIL-FOUND = ' '
 17408        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17409     ELSE
 17410        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17411        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17412        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17413
 17414     GO TO 9990-RETURN.
 17415
 17416 3999-UNLOCK-ERMAIL.
 17417     IF ERMAIL-FOUND = ' '
 17418        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17419
 17420     GO TO 9990-RETURN.
 17421******************************************************************
 17422
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 314
* EL050.cbl
 17424 4000-UPDATE-CANCELLED-CERT.
 17425     IF CERT-WAS-NOT-FOUND
 17426        GO TO 4299-EXIT.
 17427
 17428*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17429     IF PB-C-NH-INT-ON-REFS > ZEROS
 17430        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17431     END-IF
 17432     IF PB-C-REF-INTERFACE-SW = 'Y'
 17433        MOVE PB-C-REF-INTERFACE-SW
 17434                                 TO CM-NH-INTERFACE-SW
 17435     END-IF
 17436     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17437     IF ERMAIL-FOUND = 'X'
 17438        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17439        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17440        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17441        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17442           MOVE ER-2694          TO WS-ERROR
 17443           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17444     END-IF
 17445
 17446     IF PB-C-POST-CARD-IND = 'Y'
 17447        MOVE +8                  TO SUB
 17448*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17449        IF ERMAIL-FOUND = ' '
 17450           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17451              (SUB > +7)
 17452              OR (MA-MAIL-STATUS (SUB) = '1')
 17453           END-PERFORM
 17454        END-IF
 17455        IF (SUB > +7)
 17456           OR (ERMAIL-FOUND = 'X')
 17457           MOVE ER-3789          TO WS-ERROR
 17458           PERFORM 9900-ERROR-FORMAT
 17459                                 THRU 9900-EXIT
 17460        END-IF
 17461     ELSE
 17462        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17463     END-IF
 17464
 17465     IF ERMAIL-FOUND = ' '
 17466        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17467     END-IF.
 17468
 17469     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17470
 17471     IF PB-CI-OB-FLAG = 'Z'
 17472        GO TO 4150-SUMMARY-CERT-CANCEL.
 17473
 17474     IF PB-C-LF-CANCEL-VOIDED
 17475         PERFORM 4200-REVERSE-LF-CANCEL.
 17476     IF PB-C-AH-CANCEL-VOIDED
 17477         PERFORM 4200-REVERSE-AH-CANCEL.
 17478
 17479 4100-APPLY-LF-CANCEL.
 17480
 17481     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 315
* EL050.cbl
 17482
 17483 4100-CHECK-LF-ERRORS.
 17484
 17485     ADD +1                       TO WS-SUB.
 17486
 17487     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17488        IF LF-COVERAGE-CANCELLED
 17489           GO TO 4100-LF-CANCEL-CONT
 17490        ELSE
 17491           GO TO 4100-UPDATE-LF-COVERAGE.
 17492
 17493     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17494                                   ER-2729 OR
 17495                                   ER-2730 OR
 17496                                   ER-2731 OR
 17497                                   ER-2732 OR
 17498                                   ER-2737 OR
 17499                                   ER-2740 OR
 17500                                   ER-2743 OR
 17501                                   ER-2749 OR
 17502                                   ER-2750 OR
 17503                                   ER-2755 OR
 17504                                   ER-2757 OR
 17505                                   ER-2760 OR
 17506                                   ER-2772 OR
 17507                                   ER-2774 OR
 17508                                   ER-2776 OR
 17509                                   ER-2794
 17510        GO TO 4100-UPDATE-LF-COVERAGE.
 17511
 17512     GO TO 4100-CHECK-LF-ERRORS.
 17513
 17514 4100-UPDATE-LF-COVERAGE.
 17515
 17516     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17517     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17518     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17519        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17520     END-IF
 17521     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17522                                      TO CM-CREDIT-INTERFACE-SW-2.
 17523     IF CM-LF-CANCEL-DT = LOW-VALUE
 17524         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17525
 17526     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17527         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17528                                         CM-LF-STATUS-AT-CANCEL.
 17529
 17530     GO TO 4100-APPLY-AH-CANCEL.
 17531
 17532 4100-LF-CANCEL-CONT.
 17533     IF PB-C-LF-CANCEL-VOIDED
 17534         GO TO 4100-APPLY-AH-CANCEL.
 17535
 17536     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17537         GO TO 4100-APPLY-AH-CANCEL.
 17538
 17539     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 316
* EL050.cbl
 17540        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17541           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17542        ELSE
 17543           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17544
 17545     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17546     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17547
 17548     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17549         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17550
 17551     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17552        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17553         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17554         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17555
 17556     IF PB-RECORD-RETURNED
 17557        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17558      ELSE
 17559        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17560
 17561 4100-APPLY-AH-CANCEL.
 17562
 17563     MOVE +0                      TO WS-SUB.
 17564
 17565 4100-CHECK-AH-ERRORS.
 17566
 17567     ADD +1                       TO WS-SUB.
 17568
 17569     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17570        IF AH-COVERAGE-CANCELLED
 17571           GO TO 4100-AH-CANCEL-CONT
 17572        ELSE
 17573           GO TO 4100-UPDATE-AH-COVERAGE.
 17574
 17575     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17576                                   ER-2729 OR
 17577                                   ER-2732 OR
 17578                                   ER-2737 OR
 17579                                   ER-2740 OR
 17580                                   ER-2744 OR
 17581                                   ER-2749 OR
 17582                                   ER-2750 OR
 17583                                   ER-2755 OR
 17584                                   ER-2757 OR
 17585                                   ER-2760 OR
 17586                                   ER-2771 OR
 17587                                   ER-2772 OR
 17588                                   ER-2773 OR
 17589                                   ER-2775 OR
 17590                                   ER-2777 OR
 17591                                   ER-2778 OR
 17592                                   ER-2794
 17593        GO TO 4100-UPDATE-AH-COVERAGE.
 17594
 17595     GO TO 4100-CHECK-AH-ERRORS.
 17596
 17597 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 317
* EL050.cbl
 17598
 17599     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17600     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17601     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17602     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17603                                      TO CM-CREDIT-INTERFACE-SW-2.
 17604     IF CM-AH-CANCEL-DT = LOW-VALUE
 17605         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17606
 17607     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17608         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17609                                         CM-AH-STATUS-AT-CANCEL.
 17610
 17611     IF LF-COVERAGE-CANCELLED
 17612         IF PB-RECORD-RETURNED
 17613              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17614          ELSE
 17615              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17616
 17617     GO TO 4299-EXIT.
 17618
 17619 4100-AH-CANCEL-CONT.
 17620     IF PB-C-AH-CANCEL-VOIDED
 17621         GO TO 4299-EXIT.
 17622
 17623     if cm-credit-interface-sw-2 = ' '
 17624        if pb-fatal-errors or pb-unforced-errors
 17625           move '4'              to cm-credit-interface-sw-2
 17626        else
 17627           move '1'              to cm-credit-interface-sw-2
 17628        end-if
 17629     end-if
 17630     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17631         GO TO 4299-EXIT.
 17632
 17633     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17634        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17635           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17636        ELSE
 17637           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17638
 17639     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17640     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17641
 17642     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17643         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17644
 17645     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17646         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17647         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17648
 17649     IF PB-RECORD-RETURNED
 17650        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17651      ELSE
 17652        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17653
 17654     GO TO 4299-EXIT.
 17655
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 318
* EL050.cbl
 17656 4150-SUMMARY-CERT-CANCEL.
 17657     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17658
 17659     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17660        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17661                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17662     ELSE
 17663        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17664                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17665
 17666     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17667        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17668                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17669     ELSE
 17670        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17671                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17672
 17673     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17674        NEXT SENTENCE
 17675     ELSE
 17676        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17677
 17678     GO TO 4299-EXIT.
 17679
 17680 4200-REVERSE-LF-CANCEL.
 17681     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17682
 17683     IF CM-LF-CANCEL-APPLIED
 17684        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17685        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17686        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17687
 17688     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17689
 17690     IF PB-RECORD-RETURNED
 17691        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17692       ELSE
 17693        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17694
 17695 4200-REVERSE-LF-EXIT.
 17696       EXIT.
 17697
 17698 4200-REVERSE-AH-CANCEL.
 17699     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17700
 17701     IF CM-AH-CANCEL-APPLIED
 17702        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17703        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17704        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17705
 17706     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17707
 17708     IF PB-RECORD-RETURNED
 17709        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17710       ELSE
 17711        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17712
 17713 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 319
* EL050.cbl
 17714       EXIT.
 17715
 17716 4299-EXIT.
 17717       EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 320
* EL050.cbl
 17719
 17720 4500-UPDATE-NEW-CERT.
 17721     IF CERT-WAS-FOUND
 17722         NEXT SENTENCE
 17723       ELSE
 17724         GO TO 4520-BUILD-NEW-KEY.
 17725
 17726     IF  CLASIC-CREATED-CERT
 17727         GO TO 4999-EXIT.
 17728
 17729     IF  CERT-WAS-CREATED-FOR-CLAIM
 17730         GO TO 4520-BUILD-NEW-KEY.
 17731
 17732     IF CERT-ADDED-BATCH
 17733        IF CM-RECORD-ID = 'CM'
 17734            GO TO 4999-EXIT.
 17735
 17736 4520-BUILD-NEW-KEY.
 17737* BUILD CONTROL PRIMARY
 17738
 17739     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17740                                       CM-COMPANY-CD-A1
 17741                                       CM-COMPANY-CD-A2
 17742                                       CM-COMPANY-CD-A4
 17743                                       CM-COMPANY-CD-A5.
 17744
 17745     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17746     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17747     MOVE PB-SV-STATE               TO CM-STATE.
 17748     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17749     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17750     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17751     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17752
 17753     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17754
 17755     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17756     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17757     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17758     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17759
 17760     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17761        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17762
 17763     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17764         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17765         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17766         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17767         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17768     ELSE
 17769         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17770
 17771     IF PB-COMPANY-ID   EQUAL  'CRI'
 17772         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17773         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17774         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17775         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17776         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 321
* EL050.cbl
 17777
 17778     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17779        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17780         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17781
 17782     IF PB-COMPANY-ID  = 'LBL'
 17783        IF PB-I-JOINT-COVERAGE
 17784            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17785                                           PB-I-MEMBER-NO
 17786            GO TO 4550-CONT-CERT-PROCESS.
 17787
 17788     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17789        NEXT SENTENCE
 17790     ELSE
 17791        GO TO 4540-BUILD-MEMBER-NO.
 17792
 17793******************************************************************
 17794*                                                                *
 17795*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17796*    FOR 'MON'.                                                  *
 17797*                                                                *
 17798******************************************************************
 17799
 17800     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17801     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17802     MOVE +1                     TO WS-SUB1
 17803                                    WS-SUB2.
 17804
 17805 4530-EDIT-MEMB-NAME.
 17806
 17807     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17808        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17809        ADD +1                       TO WS-SUB2.
 17810
 17811     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17812        ADD +1                       TO WS-SUB1
 17813        GO TO 4530-EDIT-MEMB-NAME.
 17814
 17815     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17816     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17817     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17818*    MOVE SPACE                      TO DC-OPTION-CODE.
 17819     SET  BIN-TO-GREG                TO TRUE.
 17820     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17821     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17822
 17823     GO TO 4550-CONT-CERT-PROCESS.
 17824
 17825******************************************************************
 17826*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17827******************************************************************
 17828
 17829 4540-BUILD-MEMBER-NO.
 17830
 17831     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17832         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17833         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17834         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 322
* EL050.cbl
 17835         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17836     ELSE
 17837         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17838
 17839     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17840        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17841         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17842
 17843 4550-CONT-CERT-PROCESS.
 17844
 17845*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17846*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17847*    ELSE
 17848*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17849
 17850     IF CERT-WAS-CREATED-FOR-CLAIM
 17851        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17852        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17853
 17854     IF CERT-AND-CLAIM-ONLINE
 17855        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17856        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17857
 17858     MOVE 'CM'                     TO CM-RECORD-ID.
 17859     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17860
 17861     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17862        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17863        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17864     ELSE
 17865        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17866        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17867
 17868     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17869     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17870     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17871     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17872     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17873     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17874     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17875                                      CM-LF-ITD-CANCEL-AMT
 17876                                      CM-LF-ITD-DEATH-AMT
 17877                                      CM-AH-ITD-AH-PMT
 17878                                      CM-AH-ITD-LUMP-PMT
 17879                                      CM-AH-ITD-CANCEL-AMT
 17880                                      CM-LF-NSP-PREMIUM-AMT
 17881                                      CM-AH-NSP-PREMIUM-AMT.
 17882*                                     CM-CLAIM-DEDUCT-WITHHELD
 17883*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17884     if pb-i-loan-apr = +99.9999
 17885        move zeros                 to cm-loan-apr
 17886     else
 17887        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17888     end-if
 17889     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17890     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17891     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17892     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 323
* EL050.cbl
 17893     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17894     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17895     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17896     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17897     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17898     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17899     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17900
 17901     IF PB-I-LIVES NOT NUMERIC
 17902         MOVE ZERO                 TO PB-I-LIVES.
 17903
 17904     IF PB-I-NUM-BILLED NOT NUMERIC
 17905         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17906
 17907     MOVE PB-I-LIVES               TO CM-LIVES.
 17908     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17909
 17910     IF PB-COMPANY-ID EQUAL  'DMD'
 17911         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17912         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17913
 17914     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17915     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17916     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17917     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17918     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17919     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17920
 17921     IF PB-I-LF-POLICY-FEE NUMERIC
 17922        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17923     ELSE
 17924        MOVE +0                    TO CM-LF-POLICY-FEE.
 17925
 17926     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17927        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17928        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17929     ELSE
 17930        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17931
 17932     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17933     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17934     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17935     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17936     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17937     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17938     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17939     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17940     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17941
 17942     IF PB-I-AH-POLICY-FEE NUMERIC
 17943        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17944     ELSE
 17945        MOVE +0                    TO CM-AH-POLICY-FEE.
 17946
 17947     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17948        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17949     ELSE
 17950        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 324
* EL050.cbl
 17951
 17952     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17953     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17954
 17955     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17956                                      CM-LF-DEATH-EXIT-DT
 17957                                      CM-AH-SETTLEMENT-EXIT-DT.
 17958
 17959*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17960*                       'TIH' OR 'OFL' OR 'FLA' OR
 17961*                       'TII' OR 'TMS' OR 'CRI' OR
 17962*                       'NCL'
 17963     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17964
 17965     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17966         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17967            MOVE '2'                TO CM-PREMIUM-TYPE.
 17968
 17969     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17970         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17971            MOVE '2'                TO CM-PREMIUM-TYPE.
 17972
 17973     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17974         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17975     ELSE
 17976         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17977         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17978
 17979     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17980     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17981     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17982     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17983     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17984     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17985     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17986     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17987
 17988     IF PB-NO-MONTHS-SKIPPED
 17989         MOVE SPACE                 TO CM-SKIP-CODE
 17990     ELSE
 17991         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17992
 17993     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17994     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17995                                       CM-LF-STATUS-AT-CANCEL.
 17996
 17997     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17998     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17999                                       CM-AH-STATUS-AT-CANCEL.
 18000
 18001     MOVE '1'                       TO CM-ENTRY-STATUS.
 18002
 18003     IF PB-REISSUED-CERT
 18004        MOVE '5'                    TO CM-ENTRY-STATUS.
 18005
 18006     IF PB-MONTHLY-CERT
 18007        MOVE 'M'                    TO CM-ENTRY-STATUS.
 18008
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 325
* EL050.cbl
 18009     IF PB-CASH-CERT
 18010        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18011
 18012     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18013     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18014     IF PB-POLICY-IS-DECLINED
 18015        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18016
 18017     IF PB-POLICY-IS-VOIDED
 18018        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18019
 18020     IF PB-NEEDS-UNDERWRITING
 18021        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18022
 18023     IF PB-REIN-ONLY-CERT
 18024        MOVE '9'                    TO CM-ENTRY-STATUS.
 18025
 18026     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18027         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18028     ELSE
 18029         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18030
 18031     IF PB-RECORD-RETURNED
 18032        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18033      ELSE
 18034        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18035
 18036     IF PB-I-MAIL-ADDRS-PRESENT
 18037        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18038
 18039     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18040                                       CM-ENTRY-DT.
 18041
 18042 4999-EXIT.
 18043     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 326
* EL050.cbl
 18045
 18046 5000-PROCESS-REPS.
 18047     MOVE ' '                    TO AGTC-MASTER-SW
 18048     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18049     MOVE CO-TYPE                TO AGTC-TYPE
 18050     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18051     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18052     IF (AGTC-MASTER-SW NOT = 'N')
 18053        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18054        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18055        PERFORM 8583-READ-ERAGTC-NEXT
 18056                                 THRU 8583-EXIT
 18057     END-IF
 18058     IF AGTC-MASTER-SW = 'N'
 18059        CONTINUE
 18060     ELSE
 18061        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18062           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18063              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18064              MOVE 'Y'           TO AGTC-MASTER-SW
 18065           END-IF
 18066        END-IF
 18067     END-IF
 18068     .
 18069 5000-EXIT.
 18070     EXIT.
 18071 6370-EDIT-INPUT-LF-CODE.
 18072     move ' ' to ws-benefit-cd-chg-sw
 18073     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18074        MOVE +1                  TO SUB
 18075        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18076        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18077        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18078        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18079        GO TO 6370-SEARCH-LOOP.
 18080
 18081     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18082
 18083     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18084     MOVE SPACES                 TO CNTL-ACCESS.
 18085*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18086     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18087     MOVE +0                     TO CNTL-SEQ-NO.
 18088     MOVE '4' TO RC-SW-2.
 18089     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18090
 18091     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18092        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18093        GO TO 6370-NO-LF-FOUND.
 18094
 18095     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18096     MOVE +1                     TO SUB.
 18097
 18098 6370-SEARCH-LOOP.
 18099     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18100         GO TO 6370-NO-LF-FOUND.
 18101
 18102     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 327
* EL050.cbl
 18103        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18104           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18105           set benefit-code-chg to true
 18106        end-if
 18107        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18108        GO TO 6370-HER-NET-PAY-CHECK.
 18109
 18110     ADD 1   TO SUB.
 18111*    IF SUB GREATER 120
 18112     IF SUB GREATER 200
 18113         GO TO 6370-NO-LF-FOUND.
 18114
 18115     GO TO 6370-SEARCH-LOOP.
 18116
 18117 6370-NO-LF-FOUND.
 18118
 18119     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18120        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18121        set benefit-code-chg to true
 18122     end-if
 18123     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18124
 18125 6370-HER-NET-PAY-CHECK.
 18126
 18127     IF PB-COMPANY-ID = 'CID'
 18128        IF PB-SV-STATE = 'CA' OR 'MN'
 18129           IF PB-I-LF-BENEFIT-CD = '02'
 18130              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18131           ELSE
 18132              IF PB-I-LF-BENEFIT-CD = '04'
 18133                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18134              END-IF
 18135           END-IF
 18136        END-IF
 18137     END-IF
 18138
 18139     IF PB-COMPANY-ID NOT = 'HER'
 18140         GO TO 6370-EXIT.
 18141
 18142     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18143         GO TO 6370-EXIT.
 18144
 18145     IF PB-I-LF-TERM NOT NUMERIC
 18146         MOVE ZEROS              TO PB-I-LF-TERM.
 18147
 18148     IF PB-I-LOAN-TERM NOT NUMERIC
 18149         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18150
 18151     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18152         GO TO 6370-EXIT.
 18153
 18154     IF PB-I-LF-BENEFIT-CD = '33'
 18155         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18156
 18157     IF PB-I-LF-BENEFIT-CD = '34'
 18158         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18159
 18160 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 328
* EL050.cbl
 18161     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 329
* EL050.cbl
 18163
 18164 6380-EDIT-INPUT-AH-CODE.
 18165     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18166        MOVE +1                  TO SUB
 18167        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18168        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18169        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18170        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18171        GO TO 6380-SEARCH-LOOP.
 18172
 18173     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18174
 18175     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18176     MOVE SPACES                 TO CNTL-ACCESS.
 18177     MOVE 'A'                    TO CNTL-REC-TYPE.
 18178*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18179     MOVE +0                     TO CNTL-SEQ-NO.
 18180     MOVE '5' TO RC-SW-2.
 18181     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18182
 18183     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18184        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18185        GO TO 6380-NO-AH-FOUND.
 18186
 18187     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18188     MOVE +1 TO SUB.
 18189
 18190 6380-SEARCH-LOOP.
 18191     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18192         GO TO 6380-NO-AH-FOUND.
 18193
 18194     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18195         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18196         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18197
 18198     ADD 1   TO SUB.
 18199     IF SUB GREATER THAN 96
 18200*    IF SUB GREATER THAN 300
 18201         GO TO 6380-NO-AH-FOUND.
 18202
 18203     GO TO 6380-SEARCH-LOOP.
 18204
 18205 6380-NO-AH-FOUND.
 18206
 18207     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18208
 18209     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18210         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18211     ELSE
 18212         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18213
 18214 6380-CSO-AH-ONLY-CHECKS.
 18215
 18216     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18217        NEXT SENTENCE
 18218      ELSE
 18219        GO TO 6380-EXIT.
 18220
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 330
* EL050.cbl
 18221     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18222         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18223
 18224
 18225     GO TO 6380-EXIT
 18226     .
 18227 6380-CSO-LIFE-WITH-AH-CHECKS.
 18228
 18229
 18230     .
 18231 6380-EXIT.
 18232     EXIT.
 18233
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 331
* EL050.cbl
 18235
 18236 6400-COMPUTE-EXTENSION-DAYS.
 18237
 18238******************************************************************
 18239*                                                                *
 18240*                   COMPUTE EXTENSION DAYS                       *
 18241*                                                                *
 18242*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18243*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18244*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18245*    THE EXTENSION DAYS.                                         *
 18246*                                                                *
 18247******************************************************************
 18248
 18249     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18250     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18251
 18252******************************************************************
 18253*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18254*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18255******************************************************************
 18256
 18257     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18258        COMPUTE WS-ODD-DAYS-OVER =
 18259               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18260     ELSE
 18261        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18262
 18263     IF WS-ODD-DAYS-OVER = ZEROS
 18264           GO TO 6499-EXIT
 18265     ELSE
 18266        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18267           IF WS-WDF-MONTH = 02
 18268              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18269              ADD 2       TO  WS-ODD-DAYS-OVER
 18270              GO TO 6499-EXIT
 18271           ELSE
 18272              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18273                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18274                 GO TO 6499-EXIT
 18275               ELSE
 18276                 GO TO 6499-EXIT
 18277        ELSE
 18278           GO TO 6499-EXIT.
 18279
 18280 6412-CHECK-TO-DAY.
 18281
 18282        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18283           IF WS-WDT-DAY = 28
 18284              ADD 2              TO WS-ODD-DAYS-OVER
 18285           ELSE
 18286              IF WS-WDT-DAY = 29
 18287                 ADD 1           TO WS-ODD-DAYS-OVER
 18288              ELSE
 18289                 NEXT SENTENCE
 18290        ELSE
 18291           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18292              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 332
* EL050.cbl
 18293
 18294     GO TO 6499-EXIT.
 18295
 18296
 18297 6415-CHECK-LEAP-YEAR.
 18298
 18299     IF DC-DAYS-IN-MONTH = 29
 18300        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18301
 18302 6415-EXIT.
 18303     EXIT.
 18304
 18305 6499-EXIT.
 18306      EXIT.
 18307
 18308 6500-END.
 18309     EXIT.
 18310
 18311
 18312******************************************************************
 18313************* PROCEDURE DIVISION FOR EL050 ***********************
 18314********************** ELC50PD END *******************************
 18315
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 333
* EL050.cbl
 18317
 18318**START***********************************************************
 18319*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18320*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18321******************************************************************
 18322*
 18323 6600-GET-STATE-MUNICIPAL-TAX.
 18324
 18325     IF PB-COMPANY-ID NOT = 'DMD'
 18326         GO TO 6640-EXIT.
 18327
 18328     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18329     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18330     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18331*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18332*
 18333***  Y2K PROJ 7744
 18334     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18335     SET BIN-TO-GREG          TO TRUE.
 18336     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18337
 18338     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18339
 18340     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18341     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18342
 18343
 18344* EXEC CICS HANDLE CONDITION
 18345*        INVREQ    (6610-START-BROWSE)
 18346*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18347*        NOTFND    (6630-END-OF-FILE)
 18348*    END-EXEC.
 18349*    MOVE '"$8JI                 ! # #00018331' TO DFHEIV0
 18350     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18352     MOVE X'2320233030303138333331' TO DFHEIV0(25:11)
 18353     CALL 'kxdfhei1' USING DFHEIV0
 18354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18355
 18356
 18357 6610-START-BROWSE.
 18358
 18359
 18360* EXEC CICS HANDLE CONDITION
 18361*        NOTFND    (6630-END-OF-FILE)
 18362*        DISABLED  (6630-ERRESS-PROBLEM)
 18363*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18364*        ENDFILE   (6630-END-OF-FILE)
 18365*    END-EXEC.
 18366*    MOVE '"$IcJ''                ! $ #00018339' TO DFHEIV0
 18367     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18369     MOVE X'2420233030303138333339' TO DFHEIV0(25:11)
 18370     CALL 'kxdfhei1' USING DFHEIV0
 18371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18372
 18373
 18374
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 334
* EL050.cbl
 18375* EXEC CICS STARTBR
 18376*        DATASET (FILE-ID-ERRESS)
 18377*        RIDFLD  (WS-ERRESS-KEY)
 18378*        GTEQ
 18379*    END-EXEC.
 18380     MOVE 0
 18381       TO DFHEIV11
 18382*    MOVE '&,         G          &   #00018346' TO DFHEIV0
 18383     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18384     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18385     MOVE X'2020233030303138333436' TO DFHEIV0(25:11)
 18386     CALL 'kxdfhei1' USING DFHEIV0,
 18387           FILE-ID-ERRESS,
 18388           WS-ERRESS-KEY,
 18389           DFHEIV99,
 18390           DFHEIV11,
 18391           DFHEIV99
 18392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18393
 18394
 18395 6620-READ-NEXT-ERRESS-MASTER.
 18396
 18397
 18398* EXEC CICS HANDLE CONDITION
 18399*        NOTFND    (6630-END-OF-FILE)
 18400*        ENDFILE   (6630-END-OF-FILE)
 18401*        DISABLED  (6630-ERRESS-PROBLEM)
 18402*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18403*    END-EXEC.
 18404*    MOVE '"$I''cJ                ! % #00018354' TO DFHEIV0
 18405     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18407     MOVE X'2520233030303138333534' TO DFHEIV0(25:11)
 18408     CALL 'kxdfhei1' USING DFHEIV0
 18409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18410
 18411
 18412
 18413* EXEC CICS READNEXT
 18414*        DATASET (FILE-ID-ERRESS)
 18415*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18416*        RIDFLD  (WS-ERRESS-KEY)
 18417*    END-EXEC.
 18418     MOVE LENGTH OF
 18419      RESIDENT-STATE-TAX-MASTER
 18420       TO DFHEIV12
 18421     MOVE 0
 18422       TO DFHEIV11
 18423*    MOVE '&.IL                  )   #00018361' TO DFHEIV0
 18424     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18425     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18426     MOVE X'2020233030303138333631' TO DFHEIV0(25:11)
 18427     CALL 'kxdfhei1' USING DFHEIV0,
 18428           FILE-ID-ERRESS,
 18429           RESIDENT-STATE-TAX-MASTER,
 18430           DFHEIV12,
 18431           WS-ERRESS-KEY,
 18432           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 335
* EL050.cbl
 18433           DFHEIV11,
 18434           DFHEIV99,
 18435           DFHEIV99
 18436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18437
 18438
 18439     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18440
 18441* EXEC CICS ENDBR
 18442*            DATASET (FILE-ID-ERRESS)
 18443*       END-EXEC
 18444     MOVE 0
 18445       TO DFHEIV11
 18446*    MOVE '&2                    $   #00018368' TO DFHEIV0
 18447     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18448     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18449     MOVE X'2020233030303138333638' TO DFHEIV0(25:11)
 18450     CALL 'kxdfhei1' USING DFHEIV0,
 18451           FILE-ID-ERRESS,
 18452           DFHEIV11,
 18453           DFHEIV99
 18454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18455        GO TO 6630-END-OF-FILE.
 18456
 18457     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18458        NEXT SENTENCE
 18459      ELSE
 18460        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18461
 18462*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18463*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18464*
 18465     MOVE +2                     TO WS-SUB1.
 18466
 18467     IF PB-ISSUE
 18468     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18469        MOVE +1                  TO WS-SUB1.
 18470
 18471     IF PB-CANCELLATION
 18472     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18473        MOVE +1                  TO WS-SUB1.
 18474*
 18475*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18476*
 18477***  Y2K PROJ 7744
 18478     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18479***  Y2K PROJ 7744
 18480
 18481*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18482* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18483* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18484
 18485     ADD 1                    TO WS-YEAR-YY.
 18486
 18487     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18488         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18489                              TO WS-RES-STATE-TAX
 18490         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 336
* EL050.cbl
 18491                              TO WS-RES-MUNI-TAX
 18492     ELSE
 18493         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18494                              TO WS-RES-STATE-TAX
 18495         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18496                              TO WS-RES-MUNI-TAX.
 18497
 18498*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18499
 18500     IF PB-CANCELLATION
 18501         GO TO 6640-CANCEL-TAX.
 18502
 18503     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18504         COMPUTE PB-I-STATE-TAX ROUNDED =
 18505                                   PB-I-LF-PREMIUM-AMT
 18506                                 * WS-RES-STATE-TAX
 18507         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18508                                   PB-I-LF-PREMIUM-AMT
 18509                                 * WS-RES-MUNI-TAX
 18510     ELSE
 18511     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18512         COMPUTE PB-I-STATE-TAX ROUNDED =
 18513                                   PB-I-AH-PREMIUM-AMT
 18514                                 * WS-RES-STATE-TAX
 18515         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18516                                   PB-I-AH-PREMIUM-AMT
 18517                                 * WS-RES-MUNI-TAX.
 18518
 18519
 18520* EXEC CICS ENDBR
 18521*         DATASET (FILE-ID-ERRESS)
 18522*    END-EXEC.
 18523     MOVE 0
 18524       TO DFHEIV11
 18525*    MOVE '&2                    $   #00018435' TO DFHEIV0
 18526     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18527     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18528     MOVE X'2020233030303138343335' TO DFHEIV0(25:11)
 18529     CALL 'kxdfhei1' USING DFHEIV0,
 18530           FILE-ID-ERRESS,
 18531           DFHEIV11,
 18532           DFHEIV99
 18533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18534
 18535
 18536     GO TO 6640-EXIT.
 18537
 18538 6640-CANCEL-TAX.
 18539     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18540
 18541     IF PB-C-LF-CANCEL-AMT > ZEROS
 18542         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18543                                   PB-C-LF-CANCEL-AMT
 18544                                 * WS-RES-STATE-TAX
 18545         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18546                                   PB-C-LF-CANCEL-AMT
 18547                                *  WS-RES-MUNI-TAX
 18548     ELSE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 337
* EL050.cbl
 18549     IF PB-C-AH-CANCEL-AMT > ZEROS
 18550         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18551                                   PB-C-AH-CANCEL-AMT
 18552                                 * WS-RES-STATE-TAX
 18553         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18554                                   PB-C-AH-CANCEL-AMT
 18555                                *  WS-RES-MUNI-TAX.
 18556
 18557
 18558* EXEC CICS ENDBR
 18559*         DATASET (FILE-ID-ERRESS)
 18560*    END-EXEC.
 18561     MOVE 0
 18562       TO DFHEIV11
 18563*    MOVE '&2                    $   #00018460' TO DFHEIV0
 18564     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18565     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18566     MOVE X'2020233030303138343630' TO DFHEIV0(25:11)
 18567     CALL 'kxdfhei1' USING DFHEIV0,
 18568           FILE-ID-ERRESS,
 18569           DFHEIV11,
 18570           DFHEIV99
 18571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18572
 18573
 18574     GO TO 6640-EXIT.
 18575
 18576 6630-END-OF-FILE.
 18577     MOVE ER-8002              TO WS-ERROR.
 18578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18579
 18580     GO TO 6640-EXIT.
 18581
 18582 6630-ERRESS-PROBLEM.
 18583     MOVE ER-8044              TO WS-ERROR.
 18584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18585
 18586 6640-EXIT.
 18587     EXIT.
 18588
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 338
* EL050.cbl
 18590 6650-GET-RES-STATE-COMM.
 18591
 18592     IF PB-COMPANY-ID NOT = 'DMD'
 18593         GO TO 6700-COMM-EXIT.
 18594
 18595     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18596     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18597     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18598     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18599     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18600     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18601     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18602
 18603*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18604*
 18605***  Y2K PROJ 7744
 18606     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18607     SET BIN-TO-GREG          TO TRUE.
 18608     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18609
 18610     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18611***  Y2K PROJ 7744
 18612
 18613     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18614
 18615
 18616* EXEC CICS HANDLE CONDITION
 18617*        INVREQ    (6660-START-BROWSE)
 18618*        DISABLED  (6690-ERRESC-PROBLEM)
 18619*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18620*        NOTFND    (6690-END-OF-FILE)
 18621*    END-EXEC.
 18622*    MOVE '"$8cJI                ! & #00018505' TO DFHEIV0
 18623     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18624     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18625     MOVE X'2620233030303138353035' TO DFHEIV0(25:11)
 18626     CALL 'kxdfhei1' USING DFHEIV0
 18627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18628
 18629
 18630
 18631* EXEC CICS RESETBR
 18632*        DATASET (FILE-ID-ERRESC)
 18633*        RIDFLD  (WS-ERRESC-KEY)
 18634*    END-EXEC.
 18635     MOVE 0
 18636       TO DFHEIV11
 18637*    MOVE '&4         G          &   #00018512' TO DFHEIV0
 18638     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18639     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18640     MOVE X'2020233030303138353132' TO DFHEIV0(25:11)
 18641     CALL 'kxdfhei1' USING DFHEIV0,
 18642           FILE-ID-ERRESC,
 18643           WS-ERRESC-KEY,
 18644           DFHEIV99,
 18645           DFHEIV11,
 18646           DFHEIV99
 18647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 339
* EL050.cbl
 18648
 18649
 18650 6660-START-BROWSE.
 18651
 18652
 18653* EXEC CICS HANDLE CONDITION
 18654*        NOTFND    (6690-END-OF-FILE)
 18655*        DISABLED  (6690-ERRESC-PROBLEM)
 18656*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18657*        ENDFILE   (6690-END-OF-FILE)
 18658*    END-EXEC.
 18659*    MOVE '"$IcJ''                ! '' #00018519' TO DFHEIV0
 18660     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18662     MOVE X'2720233030303138353139' TO DFHEIV0(25:11)
 18663     CALL 'kxdfhei1' USING DFHEIV0
 18664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18665
 18666
 18667
 18668* EXEC CICS STARTBR
 18669*        DATASET (FILE-ID-ERRESC)
 18670*        RIDFLD  (WS-ERRESC-KEY)
 18671*        GTEQ
 18672*    END-EXEC.
 18673     MOVE 0
 18674       TO DFHEIV11
 18675*    MOVE '&,         G          &   #00018526' TO DFHEIV0
 18676     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18677     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18678     MOVE X'2020233030303138353236' TO DFHEIV0(25:11)
 18679     CALL 'kxdfhei1' USING DFHEIV0,
 18680           FILE-ID-ERRESC,
 18681           WS-ERRESC-KEY,
 18682           DFHEIV99,
 18683           DFHEIV11,
 18684           DFHEIV99
 18685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18686
 18687
 18688     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18689
 18690 6670-READ-NEXT-ERRESC-MASTER.
 18691
 18692
 18693* EXEC CICS HANDLE CONDITION
 18694*        NOTFND    (6690-END-OF-FILE)
 18695*        DISABLED  (6690-ERRESC-PROBLEM)
 18696*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18697*        ENDFILE   (6690-END-OF-FILE)
 18698*    END-EXEC.
 18699*    MOVE '"$IcJ''                ! ( #00018536' TO DFHEIV0
 18700     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18702     MOVE X'2820233030303138353336' TO DFHEIV0(25:11)
 18703     CALL 'kxdfhei1' USING DFHEIV0
 18704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18705
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 340
* EL050.cbl
 18706
 18707
 18708* EXEC CICS READNEXT
 18709*        DATASET (FILE-ID-ERRESC)
 18710*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18711*        RIDFLD  (ERRESC-RECORD-KEY)
 18712*    END-EXEC.
 18713     MOVE LENGTH OF
 18714      ACCOUNT-RESIDENT-ST-COMMISSION
 18715       TO DFHEIV12
 18716     MOVE 0
 18717       TO DFHEIV11
 18718*    MOVE '&.IL                  )   #00018543' TO DFHEIV0
 18719     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18720     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18721     MOVE X'2020233030303138353433' TO DFHEIV0(25:11)
 18722     CALL 'kxdfhei1' USING DFHEIV0,
 18723           FILE-ID-ERRESC,
 18724           ACCOUNT-RESIDENT-ST-COMMISSION,
 18725           DFHEIV12,
 18726           ERRESC-RECORD-KEY,
 18727           DFHEIV99,
 18728           DFHEIV11,
 18729           DFHEIV99,
 18730           DFHEIV99
 18731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18732
 18733
 18734     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18735        NEXT SENTENCE
 18736     ELSE
 18737
 18738* EXEC CICS ENDBR
 18739*            DATASET (FILE-ID-ERRESC)
 18740*       END-EXEC
 18741     MOVE 0
 18742       TO DFHEIV11
 18743*    MOVE '&2                    $   #00018552' TO DFHEIV0
 18744     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18745     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18746     MOVE X'2020233030303138353532' TO DFHEIV0(25:11)
 18747     CALL 'kxdfhei1' USING DFHEIV0,
 18748           FILE-ID-ERRESC,
 18749           DFHEIV11,
 18750           DFHEIV99
 18751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18752        GO TO 6690-END-OF-FILE.
 18753
 18754     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18755
 18756* EXEC CICS ENDBR
 18757*            DATASET (FILE-ID-ERRESC)
 18758*       END-EXEC
 18759     MOVE 0
 18760       TO DFHEIV11
 18761*    MOVE '&2                    $   #00018558' TO DFHEIV0
 18762     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18763     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 341
* EL050.cbl
 18764     MOVE X'2020233030303138353538' TO DFHEIV0(25:11)
 18765     CALL 'kxdfhei1' USING DFHEIV0,
 18766           FILE-ID-ERRESC,
 18767           DFHEIV11,
 18768           DFHEIV99
 18769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18770        GO TO 6690-END-OF-FILE.
 18771
 18772     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18773        NEXT SENTENCE
 18774      ELSE
 18775        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18776
 18777* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18778*
 18779     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18780
 18781     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18782
 18783     IF WS-SUB1 > ZERO
 18784         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18785             PERFORM 6680-SET-COMMISSION
 18786         ELSE
 18787             PERFORM 6680-SET-TABLE-CODE.
 18788
 18789
 18790* EXEC CICS ENDBR
 18791*         DATASET (FILE-ID-ERRESC)
 18792*    END-EXEC.
 18793     MOVE 0
 18794       TO DFHEIV11
 18795*    MOVE '&2                    $   #00018580' TO DFHEIV0
 18796     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18797     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18798     MOVE X'2020233030303138353830' TO DFHEIV0(25:11)
 18799     CALL 'kxdfhei1' USING DFHEIV0,
 18800           FILE-ID-ERRESC,
 18801           DFHEIV11,
 18802           DFHEIV99
 18803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18804
 18805
 18806     GO TO 6700-COMM-EXIT.
 18807
 18808 6680-SET-TABLE-CODE.
 18809     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18810        MOVE ZEROS             TO WS-SUB1
 18811     ELSE
 18812* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18813* TO COMPUTE AH COMMISSION.
 18814        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18815        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18816        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18817        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18818        PERFORM 6680-READ-CTBL-TABLE
 18819        IF WS-CTBL-READ-SW NOT = 'Y'
 18820           MOVE ZEROS          TO WS-SUB1.
 18821
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 342
* EL050.cbl
 18822 6680-READ-CTBL-TABLE.
 18823*
 18824* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18825* TO COMPUTE LIFE COMMISSION
 18826
 18827     IF CTBL-SW = '0540'
 18828        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18829        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18830        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18831
 18832     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18833
 18834     IF CTBL-TABLE-FOUND
 18835        IF CTBL-SW = '0530'
 18836             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18837                                    * PB-I-AH-TERM
 18838             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18839             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18840        ELSE
 18841             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18842             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18843             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18844     ELSE
 18845        IF FIRST-TIME-THROUGH
 18846            GO TO 6680-READ-CTBL-TABLE
 18847        ELSE
 18848            MOVE ZEROS         TO WS-SUB1.
 18849
 18850 6680-SET-COMMISSION.
 18851     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18852           MOVE ZEROS          TO WS-SUB1
 18853       ELSE
 18854           MOVE RESC-COMMISSION-PER (WS-SUB)
 18855                               TO WS-COMMISSION
 18856           IF CTBL-SW = '0530'
 18857               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18858           ELSE
 18859               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18860
 18861 6680-SEARCH-CATEGORY.
 18862     ADD +1                   TO WS-SUB.
 18863     IF WS-SUB > +12
 18864         GO TO 6680-EXIT.
 18865
 18866     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18867          MOVE WS-SUB         TO WS-SUB1
 18868          GO TO 6680-EXIT.
 18869
 18870     GO TO 6680-SEARCH-CATEGORY.
 18871
 18872 6680-EXIT.
 18873     EXIT.
 18874
 18875 6690-END-OF-FILE.
 18876     GO TO 6700-COMM-EXIT.
 18877
 18878 6690-ERRESC-PROBLEM.
 18879      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 343
* EL050.cbl
 18880      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18881
 18882      GO TO 6700-COMM-EXIT.
 18883
 18884 6700-COMM-EXIT.
 18885     EXIT.
 18886
 18887 7000-GET-RATE.
 18888
 18889* EXEC CICS LINK
 18890*        PROGRAM    ('ELRATE')
 18891*        COMMAREA   (CALCULATION-PASS-AREA)
 18892*        LENGTH     (CP-COMM-LENGTH)
 18893*    END-EXEC.
 18894     MOVE 'ELRATE' TO DFHEIV1
 18895*    MOVE '."C                   (   #00018666' TO DFHEIV0
 18896     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18898     MOVE X'2020233030303138363636' TO DFHEIV0(25:11)
 18899     CALL 'kxdfhei1' USING DFHEIV0,
 18900           DFHEIV1,
 18901           CALCULATION-PASS-AREA,
 18902           CP-COMM-LENGTH,
 18903           DFHEIV99,
 18904           DFHEIV99,
 18905           DFHEIV99,
 18906           DFHEIV99
 18907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18908
 18909
 18910 7000-EXIT.
 18911     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 344
* EL050.cbl
 18913 7100-FIND-BENEFIT-IN-STATE.
 18914     MOVE 'N'                    TO BEN-SEARCH-SW.
 18915
 18916     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18917         VARYING SUB3 FROM 1 BY 1 UNTIL
 18918            ((SUB3 GREATER 50) OR
 18919              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18920               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18921
 18922     IF SUB3 NOT = 51
 18923         MOVE 'Y'                TO BEN-SEARCH-SW.
 18924
 18925     GO TO 7199-EXIT.
 18926
 18927 7100-BENEFIT-DUMMY.
 18928
 18929 7100-DUMMY-EXIT.
 18930     EXIT.
 18931
 18932 7199-EXIT.
 18933     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 345
* EL050.cbl
 18935 7200-FIND-BENEFIT.
 18936     MOVE 'N'                    TO BEN-SEARCH-SW.
 18937
 18938     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18939         VARYING SUB3 FROM 1 BY 1 UNTIL
 18940            ((SUB3 GREATER 8) OR
 18941            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18942
 18943     IF SUB3 NOT = 9
 18944         MOVE 'Y'                TO BEN-SEARCH-SW.
 18945
 18946     GO TO 7200-EXIT.
 18947
 18948 7200-BENEFIT-DUMMY.
 18949
 18950 7200-DUMMY-EXIT.
 18951     EXIT.
 18952
 18953 7200-EXIT.
 18954     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 346
* EL050.cbl
 18956 7250-LOOK-FOR-RESCINDED-CLAIM.
 18957     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18958                                    W-CL-COMP-CD.
 18959     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18960                                    W-CL-CERT-NO.
 18961
 18962
 18963* EXEC CICS HANDLE CONDITION
 18964*        NOTFND  (7250-CONTINUE)
 18965*        ENDFILE (7250-CONTINUE)
 18966*    END-EXEC.
 18967*    MOVE '"$I''                  ! ) #00018724' TO DFHEIV0
 18968     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18970     MOVE X'2920233030303138373234' TO DFHEIV0(25:11)
 18971     CALL 'kxdfhei1' USING DFHEIV0
 18972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18973
 18974
 18975
 18976* EXEC CICS IGNORE CONDITION
 18977*        DUPKEY
 18978*    END-EXEC.
 18979*    MOVE '"*$                   !   #00018729' TO DFHEIV0
 18980     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18982     MOVE X'2020233030303138373239' TO DFHEIV0(25:11)
 18983     CALL 'kxdfhei1' USING DFHEIV0
 18984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18985
 18986
 18987
 18988* EXEC CICS STARTBR
 18989*        DATASET   (CLMS-ID)
 18990*        RIDFLD    (ELMSTR-KEY)
 18991*        GENERIC   EQUAL
 18992*        KEYLENGTH (ELMSTR-LENGTH)
 18993*    END-EXEC.
 18994     MOVE 0
 18995       TO DFHEIV11
 18996*    MOVE '&,   KG    E          &   #00018733' TO DFHEIV0
 18997     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18998     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18999     MOVE X'2020233030303138373333' TO DFHEIV0(25:11)
 19000     CALL 'kxdfhei1' USING DFHEIV0,
 19001           CLMS-ID,
 19002           ELMSTR-KEY,
 19003           ELMSTR-LENGTH,
 19004           DFHEIV11,
 19005           DFHEIV99
 19006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19007
 19008
 19009     MOVE 'Y'                    TO W-BROWSE-SW.
 19010
 19011 7250-NEXT-CLAIM.
 19012
 19013
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 347
* EL050.cbl
 19014* EXEC CICS READNEXT
 19015*        DATASET   (CLMS-ID)
 19016*        RIDFLD    (ELMSTR-KEY)
 19017*        SET       (ADDRESS OF CLAIM-MASTER)
 19018*    END-EXEC.
 19019     MOVE 0
 19020       TO DFHEIV11
 19021*    MOVE '&.S                   )   #00018744' TO DFHEIV0
 19022     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19023     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19024     MOVE X'2020233030303138373434' TO DFHEIV0(25:11)
 19025     CALL 'kxdfhei1' USING DFHEIV0,
 19026           CLMS-ID,
 19027           DFHEIV20,
 19028           DFHEIV99,
 19029           ELMSTR-KEY,
 19030           DFHEIV99,
 19031           DFHEIV11,
 19032           DFHEIV99,
 19033           DFHEIV99
 19034     SET ADDRESS OF CLAIM-MASTER TO
 19035         DFHEIV20
 19036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19037
 19038
 19039     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19040        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19041         GO TO 7250-CONTINUE
 19042     END-IF.
 19043
 19044     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19045        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19046        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19047        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19048        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19049         GO TO 7250-NEXT-CLAIM
 19050     END-IF.
 19051
 19052     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19053        OR (CL-CLAIM-TYPE = 'I')
 19054        OR (CL-CLAIM-TYPE = 'G')
 19055        OR (CL-CLAIM-TYPE = 'F')
 19056          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19057              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19058              GO TO 7250-CONTINUE
 19059          END-IF
 19060     END-IF.
 19061
 19062     GO TO 7250-NEXT-CLAIM.
 19063
 19064 7250-CONTINUE.
 19065
 19066     IF W-BROWSE-SW = 'Y'
 19067
 19068* EXEC CICS ENDBR
 19069*            DATASET   (CLMS-ID)
 19070*        END-EXEC
 19071     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 348
* EL050.cbl
 19072       TO DFHEIV11
 19073*    MOVE '&2                    $   #00018778' TO DFHEIV0
 19074     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19076     MOVE X'2020233030303138373738' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0,
 19078           CLMS-ID,
 19079           DFHEIV11,
 19080           DFHEIV99
 19081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19082         MOVE 'N' TO W-BROWSE-SW
 19083     END-IF.
 19084
 19085 7250-EXIT.
 19086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 349
* EL050.cbl
 19088 7300-CHECK-FOR-OPEN-CLMS.
 19089
 19090*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19091*    MOVE SPACES                 TO CNTL-ACCESS.
 19092*    MOVE '1'                    TO CNTL-REC-TYPE.
 19093*    MOVE +0                     TO CNTL-SEQ-NO.
 19094
 19095*    MOVE '3'                    TO RC-SW-1.
 19096*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19097
 19098*    IF NOT CF-COMPANY-MASTER
 19099*         PERFORM 0099-COMPANY-NOT-FOUND
 19100*         GO TO 7300-EXIT.
 19101
 19102     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19103                                    W-CL-COMP-CD.
 19104     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19105                                    W-CL-CERT-NO.
 19106
 19107
 19108* EXEC CICS HANDLE CONDITION
 19109*        NOTFND  (7300-CONTINUE)
 19110*        ENDFILE (7300-CONTINUE)
 19111*    END-EXEC.
 19112*    MOVE '"$I''                  ! * #00018806' TO DFHEIV0
 19113     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19115     MOVE X'2A20233030303138383036' TO DFHEIV0(25:11)
 19116     CALL 'kxdfhei1' USING DFHEIV0
 19117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19118
 19119
 19120
 19121* EXEC CICS IGNORE CONDITION
 19122*        DUPKEY
 19123*    END-EXEC.
 19124*    MOVE '"*$                   !   #00018811' TO DFHEIV0
 19125     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19127     MOVE X'2020233030303138383131' TO DFHEIV0(25:11)
 19128     CALL 'kxdfhei1' USING DFHEIV0
 19129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19130
 19131
 19132
 19133* EXEC CICS STARTBR
 19134*        DATASET   (CLMS-ID)
 19135*        RIDFLD    (ELMSTR-KEY)
 19136*        GENERIC   EQUAL
 19137*        KEYLENGTH (ELMSTR-LENGTH)
 19138*    END-EXEC.
 19139     MOVE 0
 19140       TO DFHEIV11
 19141*    MOVE '&,   KG    E          &   #00018815' TO DFHEIV0
 19142     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19143     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19144     MOVE X'2020233030303138383135' TO DFHEIV0(25:11)
 19145     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 350
* EL050.cbl
 19146           CLMS-ID,
 19147           ELMSTR-KEY,
 19148           ELMSTR-LENGTH,
 19149           DFHEIV11,
 19150           DFHEIV99
 19151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19152
 19153
 19154     MOVE 'Y'                    TO W-BROWSE-SW.
 19155
 19156 7300-NEXT-CLAIM.
 19157
 19158
 19159* EXEC CICS READNEXT
 19160*        DATASET   (CLMS-ID)
 19161*        RIDFLD    (ELMSTR-KEY)
 19162*        SET       (ADDRESS OF CLAIM-MASTER)
 19163*    END-EXEC.
 19164     MOVE 0
 19165       TO DFHEIV11
 19166*    MOVE '&.S                   )   #00018826' TO DFHEIV0
 19167     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19168     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19169     MOVE X'2020233030303138383236' TO DFHEIV0(25:11)
 19170     CALL 'kxdfhei1' USING DFHEIV0,
 19171           CLMS-ID,
 19172           DFHEIV20,
 19173           DFHEIV99,
 19174           ELMSTR-KEY,
 19175           DFHEIV99,
 19176           DFHEIV11,
 19177           DFHEIV99,
 19178           DFHEIV99
 19179     SET ADDRESS OF CLAIM-MASTER TO
 19180         DFHEIV20
 19181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19182
 19183
 19184     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19185        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19186         GO TO 7300-CONTINUE.
 19187
 19188     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19189        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19190        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19191        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19192        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19193         GO TO 7300-NEXT-CLAIM.
 19194
 19195*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19196     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19197        OR (CL-CLAIM-TYPE = 'I')
 19198        OR (CL-CLAIM-TYPE = 'G')
 19199        OR (CL-CLAIM-TYPE = 'F')
 19200        IF CLAIM-IS-OPEN
 19201           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19202             AND PB-C-AH-CANCEL-DT > SPACES
 19203              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 351
* EL050.cbl
 19204              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19205           END-IF
 19206           EVALUATE TRUE
 19207             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19208                 MOVE ER-2884      TO WS-ERROR
 19209             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19210                 MOVE ER-2887      TO WS-ERROR
 19211             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19212                 MOVE ER-2886      TO WS-ERROR
 19213             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19214                 MOVE ER-2888      TO WS-ERROR
 19215             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19216                 MOVE ER-2885      TO WS-ERROR
 19217             WHEN OTHER
 19218                 MOVE ER-2768      TO WS-ERROR
 19219           END-EVALUATE
 19220           IF PB-C-AH-CANCEL-VOIDED OR
 19221              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19222                NOT AH-COVERAGE-CANCELLED)
 19223               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19224               MOVE ER-2768      TO WS-ERROR
 19225           END-IF
 19226           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19227           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19228              PB-FORCE-CODE NOT EQUAL '8'
 19229               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19230           END-IF
 19231           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19232           GO TO 7300-NEXT-CLAIM
 19233        ELSE
 19234           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19235*****THIS IS A RESCISSION OR REFORMATION
 19236              IF AH-COVERAGE-CANCELLED
 19237                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19238                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19239                    MOVE 1                   TO DC-ELAPSED-DAYS
 19240                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19241                    SET BIN-PLUS-ELAPSED     TO TRUE
 19242                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19243                    IF NO-CONVERSION-ERROR
 19244                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19245                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19246                          MOVE ER-2897 TO WS-ERROR
 19247                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19248                          GO TO 7300-NEXT-CLAIM
 19249                       END-IF
 19250                    END-IF
 19251                 ELSE
 19252                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19253                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19254                         MOVE ER-2890 TO WS-ERROR
 19255                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19256                         GO TO 7300-NEXT-CLAIM
 19257                      ELSE
 19258                         MOVE ER-2898 TO WS-ERROR
 19259                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19260                         GO TO 7300-NEXT-CLAIM
 19261                      END-IF
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 352
* EL050.cbl
 19262                   END-IF
 19263                 END-IF
 19264              END-IF
 19265           ELSE
 19266              IF CL-DENIAL-TYPE = '1'  AND
 19267                 CL-TOTAL-PAID-AMT = 0
 19268                    GO TO 7300-NEXT-CLAIM
 19269              END-IF
 19270              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19271               AND PB-C-AH-CANCEL-DT > SPACES
 19272                 MOVE ER-2756        TO WS-ERROR
 19273                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19274                 GO TO 7300-NEXT-CLAIM
 19275              END-IF
 19276           END-IF
 19277        END-IF
 19278     ELSE
 19279*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19280        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19281           IF (CLAIM-IS-OPEN)
 19282              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19283                 <> zeros
 19284              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19285                 <> zeros)
 19286              MOVE ER-2889      TO WS-ERROR
 19287              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19288              GO TO 7300-NEXT-CLAIM
 19289           ELSE
 19290              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19291*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19292                 IF (LF-COVERAGE-CANCELLED AND
 19293                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19294                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19295                         MOVE ER-2890 TO WS-ERROR
 19296                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19297                         GO TO 7300-NEXT-CLAIM
 19298                      ELSE
 19299                         MOVE ER-2898 TO WS-ERROR
 19300                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19301                         GO TO 7300-NEXT-CLAIM
 19302                      END-IF
 19303                 END-IF
 19304              ELSE
 19305                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19306                    and (CL-TOTAL-PAID-AMT = 0)
 19307                    GO TO 7300-NEXT-CLAIM
 19308                 END-IF
 19309                 IF (
 19310                      (AH-COVERAGE-CANCELLED)
 19311                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19312                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19313                      and (pb-ci-ah-cancel-amt +
 19314                         pb-c-ah-cancel-amt) <> zeros
 19315                    )
 19316                               OR
 19317                    (
 19318                      (LF-COVERAGE-CANCELLED)
 19319                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 353
* EL050.cbl
 19320                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19321                      and (pb-ci-lf-cancel-amt +
 19322                         pb-c-lf-cancel-amt) <> zeros
 19323                    )
 19324                       MOVE ER-2965 TO WS-ERROR
 19325                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19326                       GO TO 7300-NEXT-CLAIM
 19327                 END-IF
 19328                 IF LF-COVERAGE-CANCELLED
 19329                  IF CL-TOTAL-PAID-AMT > 0
 19330                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19331                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19332                        MOVE ER-2891 TO WS-ERROR
 19333                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19334                        GO TO 7300-NEXT-CLAIM
 19335                      END-IF
 19336                    ELSE
 19337****only show this error if cert num matches exactly
 19338                      IF PB-CERT-NO = CL-CERT-NO
 19339                         MOVE ER-2892 TO WS-ERROR
 19340                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19341                         GO TO 7300-NEXT-CLAIM
 19342                      END-IF
 19343                    END-IF
 19344                  END-IF
 19345                 END-IF
 19346              END-IF
 19347           END-IF
 19348        END-IF
 19349     END-IF
 19350
 19351     GO TO 7300-NEXT-CLAIM.
 19352
 19353 7300-CONTINUE.
 19354
 19355     IF W-BROWSE-SW = 'Y'
 19356
 19357* EXEC CICS ENDBR
 19358*            DATASET   (CLMS-ID)
 19359*        END-EXEC.
 19360     MOVE 0
 19361       TO DFHEIV11
 19362*    MOVE '&2                    $   #00019004' TO DFHEIV0
 19363     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303139303034' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0,
 19367           CLMS-ID,
 19368           DFHEIV11,
 19369           DFHEIV99
 19370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19371
 19372
 19373 7300-EXIT.
 19374     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 354
* EL050.cbl
 19376
 19377 7400-GET-REMAIN-TERM.
 19378
 19379* EXEC CICS LINK
 19380*        PROGRAM    ('ELRTRM')
 19381*        COMMAREA   (CALCULATION-PASS-AREA)
 19382*        LENGTH     (CP-COMM-LENGTH)
 19383*    END-EXEC.
 19384     MOVE 'ELRTRM' TO DFHEIV1
 19385*    MOVE '."C                   (   #00019013' TO DFHEIV0
 19386     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19388     MOVE X'2020233030303139303133' TO DFHEIV0(25:11)
 19389     CALL 'kxdfhei1' USING DFHEIV0,
 19390           DFHEIV1,
 19391           CALCULATION-PASS-AREA,
 19392           CP-COMM-LENGTH,
 19393           DFHEIV99,
 19394           DFHEIV99,
 19395           DFHEIV99,
 19396           DFHEIV99
 19397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19398
 19399
 19400 7400-EXIT.
 19401     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 355
* EL050.cbl
 19403
 19404 7500-GET-REMAIN-AMOUNT.
 19405
 19406* EXEC CICS LINK
 19407*        PROGRAM    ('ELRAMT')
 19408*        COMMAREA   (CALCULATION-PASS-AREA)
 19409*        LENGTH     (CP-COMM-LENGTH)
 19410*    END-EXEC.
 19411     MOVE 'ELRAMT' TO DFHEIV1
 19412*    MOVE '."C                   (   #00019024' TO DFHEIV0
 19413     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19415     MOVE X'2020233030303139303234' TO DFHEIV0(25:11)
 19416     CALL 'kxdfhei1' USING DFHEIV0,
 19417           DFHEIV1,
 19418           CALCULATION-PASS-AREA,
 19419           CP-COMM-LENGTH,
 19420           DFHEIV99,
 19421           DFHEIV99,
 19422           DFHEIV99,
 19423           DFHEIV99
 19424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19425
 19426
 19427 7500-EXIT.
 19428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 356
* EL050.cbl
 19430
 19431 7600-GET-REFUND.
 19432
 19433* EXEC CICS LINK
 19434*        PROGRAM    ('ELRFND')
 19435*        COMMAREA   (CALCULATION-PASS-AREA)
 19436*        LENGTH     (CP-COMM-LENGTH)
 19437*    END-EXEC.
 19438     MOVE 'ELRFND' TO DFHEIV1
 19439*    MOVE '."C                   (   #00019035' TO DFHEIV0
 19440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19442     MOVE X'2020233030303139303335' TO DFHEIV0(25:11)
 19443     CALL 'kxdfhei1' USING DFHEIV0,
 19444           DFHEIV1,
 19445           CALCULATION-PASS-AREA,
 19446           CP-COMM-LENGTH,
 19447           DFHEIV99,
 19448           DFHEIV99,
 19449           DFHEIV99,
 19450           DFHEIV99
 19451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19452
 19453
 19454 7600-EXIT.
 19455     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 357
* EL050.cbl
 19457 7700-CALL-DL1.
 19458
 19459* EXEC CICS LINK
 19460*        PROGRAM    ('DLO001')
 19461*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19462*        LENGTH     (DLO001-COMM-LENGTH)
 19463*    END-EXEC.
 19464     MOVE 'DLO001' TO DFHEIV1
 19465*    MOVE '."C                   (   #00019045' TO DFHEIV0
 19466     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19468     MOVE X'2020233030303139303435' TO DFHEIV0(25:11)
 19469     CALL 'kxdfhei1' USING DFHEIV0,
 19470           DFHEIV1,
 19471           WS-DLO-MASTER-POLICY-FORM,
 19472           DLO001-COMM-LENGTH,
 19473           DFHEIV99,
 19474           DFHEIV99,
 19475           DFHEIV99,
 19476           DFHEIV99
 19477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19478
 19479
 19480 7700-EXIT.
 19481     EXIT.
 19482
 19483 7710-CALL-DL2.
 19484
 19485* EXEC CICS LINK
 19486*        PROGRAM    ('DLO002')
 19487*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19488*        LENGTH     (DLO002-COMM-LENGTH)
 19489*    END-EXEC.
 19490     MOVE 'DLO002' TO DFHEIV1
 19491*    MOVE '."C                   (   #00019055' TO DFHEIV0
 19492     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19494     MOVE X'2020233030303139303535' TO DFHEIV0(25:11)
 19495     CALL 'kxdfhei1' USING DFHEIV0,
 19496           DFHEIV1,
 19497           WS-DLO-INTERNAL-POLICY-FORM,
 19498           DLO002-COMM-LENGTH,
 19499           DFHEIV99,
 19500           DFHEIV99,
 19501           DFHEIV99,
 19502           DFHEIV99
 19503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19504
 19505
 19506 7710-EXIT.
 19507     EXIT.
 19508
 19509 7720-CALL-DL3.
 19510
 19511* EXEC CICS LINK
 19512*        PROGRAM    ('DLO003')
 19513*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19514*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 358
* EL050.cbl
 19515*    END-EXEC.
 19516     MOVE 'DLO003' TO DFHEIV1
 19517*    MOVE '."C                   (   #00019065' TO DFHEIV0
 19518     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19520     MOVE X'2020233030303139303635' TO DFHEIV0(25:11)
 19521     CALL 'kxdfhei1' USING DFHEIV0,
 19522           DFHEIV1,
 19523           WS-DLO-VALID-BANK-ID,
 19524           DLO003-COMM-LENGTH,
 19525           DFHEIV99,
 19526           DFHEIV99,
 19527           DFHEIV99,
 19528           DFHEIV99
 19529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19530
 19531
 19532 7720-EXIT.
 19533     EXIT.
 19534
 19535 7730-CALL-DL7.
 19536
 19537* EXEC CICS LINK
 19538*        PROGRAM    ('DLO007')
 19539*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19540*        LENGTH     (DLO007-COMM-LENGTH)
 19541*    END-EXEC.
 19542     MOVE 'DLO007' TO DFHEIV1
 19543*    MOVE '."C                   (   #00019075' TO DFHEIV0
 19544     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19546     MOVE X'2020233030303139303735' TO DFHEIV0(25:11)
 19547     CALL 'kxdfhei1' USING DFHEIV0,
 19548           DFHEIV1,
 19549           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19550           DLO007-COMM-LENGTH,
 19551           DFHEIV99,
 19552           DFHEIV99,
 19553           DFHEIV99,
 19554           DFHEIV99
 19555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19556
 19557
 19558 7730-EXIT.
 19559     EXIT.
 19560
 19561 7740-CALL-DL11.
 19562
 19563* EXEC CICS LINK
 19564*        PROGRAM    ('DLO011')
 19565*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19566*        LENGTH     (DLO011-COMM-LENGTH)
 19567*    END-EXEC.
 19568     MOVE 'DLO011' TO DFHEIV1
 19569*    MOVE '."C                   (   #00019085' TO DFHEIV0
 19570     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19572     MOVE X'2020233030303139303835' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 359
* EL050.cbl
 19573     CALL 'kxdfhei1' USING DFHEIV0,
 19574           DFHEIV1,
 19575           WS-DLO-PREM-RATES-BEN-TYPE,
 19576           DLO011-COMM-LENGTH,
 19577           DFHEIV99,
 19578           DFHEIV99,
 19579           DFHEIV99,
 19580           DFHEIV99
 19581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19582
 19583
 19584 7740-EXIT.
 19585     EXIT.
 19586
 19587 7750-CALL-DL17.
 19588
 19589* EXEC CICS LINK
 19590*        PROGRAM    ('DLO017')
 19591*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19592*        LENGTH     (DLO017-COMM-LENGTH)
 19593*    END-EXEC.
 19594     MOVE 'DLO017' TO DFHEIV1
 19595*    MOVE '."C                   (   #00019095' TO DFHEIV0
 19596     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19597     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19598     MOVE X'2020233030303139303935' TO DFHEIV0(25:11)
 19599     CALL 'kxdfhei1' USING DFHEIV0,
 19600           DFHEIV1,
 19601           WS-DLO-VALID-RATE-CODE,
 19602           DLO017-COMM-LENGTH,
 19603           DFHEIV99,
 19604           DFHEIV99,
 19605           DFHEIV99,
 19606           DFHEIV99
 19607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19608
 19609
 19610 7750-EXIT.
 19611     EXIT.
 19612
 19613 7755-CALL-DL19.
 19614
 19615* EXEC CICS LINK
 19616*        PROGRAM    ('DLO019')
 19617*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19618*        LENGTH     (DLO019-COMM-LENGTH)
 19619*    END-EXEC.
 19620     MOVE 'DLO019' TO DFHEIV1
 19621*    MOVE '."C                   (   #00019105' TO DFHEIV0
 19622     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19623     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19624     MOVE X'2020233030303139313035' TO DFHEIV0(25:11)
 19625     CALL 'kxdfhei1' USING DFHEIV0,
 19626           DFHEIV1,
 19627           WS-DLO-ORIG-COV-CAT,
 19628           DLO019-COMM-LENGTH,
 19629           DFHEIV99,
 19630           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 360
* EL050.cbl
 19631           DFHEIV99,
 19632           DFHEIV99
 19633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19634
 19635
 19636 7755-EXIT.
 19637     EXIT.
 19638
 19639 7760-CALL-DL21.
 19640
 19641* EXEC CICS LINK
 19642*        PROGRAM    ('DLO021')
 19643*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19644*        LENGTH     (DLO021-COMM-LENGTH)
 19645*    END-EXEC.
 19646     MOVE 'DLO021' TO DFHEIV1
 19647*    MOVE '."C                   (   #00019115' TO DFHEIV0
 19648     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19649     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19650     MOVE X'2020233030303139313135' TO DFHEIV0(25:11)
 19651     CALL 'kxdfhei1' USING DFHEIV0,
 19652           DFHEIV1,
 19653           WS-DLO-VALID-LOAN-OFFICER,
 19654           DLO021-COMM-LENGTH,
 19655           DFHEIV99,
 19656           DFHEIV99,
 19657           DFHEIV99,
 19658           DFHEIV99
 19659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19660
 19661
 19662 7760-EXIT.
 19663     EXIT.
 19664
 19665 7770-CALL-DL22.
 19666
 19667* EXEC CICS LINK
 19668*        PROGRAM    ('DLO022')
 19669*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19670*        LENGTH     (DLO022-COMM-LENGTH)
 19671*    END-EXEC.
 19672     MOVE 'DLO022' TO DFHEIV1
 19673*    MOVE '."C                   (   #00019125' TO DFHEIV0
 19674     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19675     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19676     MOVE X'2020233030303139313235' TO DFHEIV0(25:11)
 19677     CALL 'kxdfhei1' USING DFHEIV0,
 19678           DFHEIV1,
 19679           WS-DLO-VALID-STATE-CODE,
 19680           DLO022-COMM-LENGTH,
 19681           DFHEIV99,
 19682           DFHEIV99,
 19683           DFHEIV99,
 19684           DFHEIV99
 19685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19686
 19687
 19688 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 361
* EL050.cbl
 19689     EXIT.
 19690
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 362
* EL050.cbl
 19692
 19693 7780-CALL-AGG.
 19694
 19695* EXEC CICS LINK
 19696*        PROGRAM    ('ELAGGO')
 19697*        COMMAREA   (WS-PASS-to-pemaggo)
 19698*        LENGTH     (ws-passed-key-LENGTH)
 19699*    END-EXEC.
 19700     MOVE 'ELAGGO' TO DFHEIV1
 19701*    MOVE '."C                   (   #00019137' TO DFHEIV0
 19702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19704     MOVE X'2020233030303139313337' TO DFHEIV0(25:11)
 19705     CALL 'kxdfhei1' USING DFHEIV0,
 19706           DFHEIV1,
 19707           WS-PASS-to-pemaggo,
 19708           ws-passed-key-LENGTH,
 19709           DFHEIV99,
 19710           DFHEIV99,
 19711           DFHEIV99,
 19712           DFHEIV99
 19713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19714
 19715 7780-EXIT.
 19716     EXIT.
 19717 7800-REWRITE-CERT.
 19718******************************************************************
 19719*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19720*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19721******************************************************************
 19722
 19723     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19724        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19725        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19726        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19727
 19728* EXEC CICS REWRITE
 19729*                  DATASET (CERT-ID)
 19730*                  FROM    (CERTIFICATE-MASTER)
 19731*              END-EXEC
 19732     MOVE LENGTH OF
 19733      CERTIFICATE-MASTER
 19734       TO DFHEIV11
 19735*    MOVE '&& L                  %   #00019154' TO DFHEIV0
 19736     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19738     MOVE X'2020233030303139313534' TO DFHEIV0(25:11)
 19739     CALL 'kxdfhei1' USING DFHEIV0,
 19740           CERT-ID,
 19741           CERTIFICATE-MASTER,
 19742           DFHEIV11,
 19743           DFHEIV99
 19744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19745        GO TO 7800-EXIT.
 19746
 19747       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19748       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19749
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 363
* EL050.cbl
 19750 7800-EXIT.
 19751      EXIT.
 19752
 19753 7900-DELETE-CERT.
 19754
 19755* EXEC CICS DELETE
 19756*        DATASET (CERT-ID)
 19757*    END-EXEC.
 19758*    MOVE '&(                    &   #00019167' TO DFHEIV0
 19759     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19760     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19761     MOVE X'2020233030303139313637' TO DFHEIV0(25:11)
 19762     CALL 'kxdfhei1' USING DFHEIV0,
 19763           CERT-ID,
 19764           DFHEIV99,
 19765           DFHEIV99,
 19766           DFHEIV99,
 19767           DFHEIV99
 19768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19769
 19770
 19771 7900-EXIT.
 19772     EXIT.
 19773
 19774 8000-WRITE-CERT.
 19775
 19776* EXEC CICS HANDLE CONDITION
 19777*        DUPKEY    (8000-FREE-MAIN)
 19778*    END-EXEC.
 19779*    MOVE '"$$                   ! + #00019175' TO DFHEIV0
 19780     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19782     MOVE X'2B20233030303139313735' TO DFHEIV0(25:11)
 19783     CALL 'kxdfhei1' USING DFHEIV0
 19784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19785
 19786
 19787
 19788* EXEC CICS WRITE
 19789*        DATASET     (CERT-ID)
 19790*        FROM        (CERTIFICATE-MASTER)
 19791*        RIDFLD      (ELCERT-KEY)
 19792*    END-EXEC.
 19793     MOVE LENGTH OF
 19794      CERTIFICATE-MASTER
 19795       TO DFHEIV11
 19796*    MOVE '&$ L                  ''   #00019179' TO DFHEIV0
 19797     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19798     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19799     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 19800     CALL 'kxdfhei1' USING DFHEIV0,
 19801           CERT-ID,
 19802           CERTIFICATE-MASTER,
 19803           DFHEIV11,
 19804           ELCERT-KEY,
 19805           DFHEIV99,
 19806           DFHEIV99
 19807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 364
* EL050.cbl
 19808
 19809
 19810 8000-FREE-MAIN.
 19811
 19812 8000-EXIT.
 19813      EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 365
* EL050.cbl
 19815
 19816 8100-READ-ERPNDM.
 19817
 19818* EXEC CICS HANDLE CONDITION
 19819*         NOTFND     (8100-NOTFND)
 19820*         ENDFILE    (8100-NOTFND)
 19821*    END-EXEC.
 19822*    MOVE '"$I''                  ! , #00019192' TO DFHEIV0
 19823     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19825     MOVE X'2C20233030303139313932' TO DFHEIV0(25:11)
 19826     CALL 'kxdfhei1' USING DFHEIV0
 19827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19828
 19829
 19830     MOVE SPACES                 TO ERPNDM-FOUND.
 19831     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19832
 19833
 19834* EXEC CICS READ
 19835*         DATASET   (FILE-ERPNDM)
 19836*         RIDFLD    (PM-CONTROL-PRIMARY)
 19837*         INTO      (PENDING-MAILING-DATA)
 19838*    END-EXEC.
 19839     MOVE LENGTH OF
 19840      PENDING-MAILING-DATA
 19841       TO DFHEIV11
 19842*    MOVE '&"IL       E          (   #00019200' TO DFHEIV0
 19843     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19844     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19845     MOVE X'2020233030303139323030' TO DFHEIV0(25:11)
 19846     CALL 'kxdfhei1' USING DFHEIV0,
 19847           FILE-ERPNDM,
 19848           PENDING-MAILING-DATA,
 19849           DFHEIV11,
 19850           PM-CONTROL-PRIMARY,
 19851           DFHEIV99,
 19852           DFHEIV99,
 19853           DFHEIV99
 19854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19855
 19856
 19857     GO TO 8100-EXIT.
 19858
 19859 8100-NOTFND.
 19860
 19861     MOVE 'X'                    TO ERPNDM-FOUND.
 19862     MOVE ER-2694                TO WS-ERROR.
 19863     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19864     MOVE ER-2883                TO WS-ERROR
 19865     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19866     .
 19867 8100-EXIT.
 19868     EXIT.
 19869
 19870 8110-READ-ERMAIL.
 19871
 19872* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 366
* EL050.cbl
 19873*         NOTFND     (8110-NOTFND)
 19874*         ENDFILE    (8110-NOTFND)
 19875*    END-EXEC.
 19876*    MOVE '"$I''                  ! - #00019220' TO DFHEIV0
 19877     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19879     MOVE X'2D20233030303139323230' TO DFHEIV0(25:11)
 19880     CALL 'kxdfhei1' USING DFHEIV0
 19881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19882
 19883
 19884     MOVE SPACES                 TO ERMAIL-FOUND.
 19885     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19886     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19887     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19888     MOVE PB-SV-STATE            TO MA-STATE.
 19889
 19890
 19891* EXEC CICS READ
 19892*         UPDATE
 19893*         DATASET   (FILE-ERMAIL)
 19894*         RIDFLD    (MA-CONTROL-PRIMARY)
 19895*         INTO      (MAILING-DATA)
 19896*    END-EXEC.
 19897     MOVE LENGTH OF
 19898      MAILING-DATA
 19899       TO DFHEIV11
 19900*    MOVE '&"IL       EU         (   #00019231' TO DFHEIV0
 19901     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19902     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19903     MOVE X'2020233030303139323331' TO DFHEIV0(25:11)
 19904     CALL 'kxdfhei1' USING DFHEIV0,
 19905           FILE-ERMAIL,
 19906           MAILING-DATA,
 19907           DFHEIV11,
 19908           MA-CONTROL-PRIMARY,
 19909           DFHEIV99,
 19910           DFHEIV99,
 19911           DFHEIV99
 19912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19913
 19914
 19915     GO TO 8110-EXIT.
 19916
 19917 8110-NOTFND.
 19918     MOVE 'X'                    TO ERMAIL-FOUND.
 19919
 19920 8110-EXIT.
 19921     EXIT.
 19922
 19923 8120-REWRITE-ERMAIL.
 19924
 19925* EXEC CICS REWRITE
 19926*         DATASET    (FILE-ERMAIL)
 19927*         FROM       (MAILING-DATA)
 19928*    END-EXEC.
 19929     MOVE LENGTH OF
 19930      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 367
* EL050.cbl
 19931       TO DFHEIV11
 19932*    MOVE '&& L                  %   #00019247' TO DFHEIV0
 19933     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19934     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19935     MOVE X'2020233030303139323437' TO DFHEIV0(25:11)
 19936     CALL 'kxdfhei1' USING DFHEIV0,
 19937           FILE-ERMAIL,
 19938           MAILING-DATA,
 19939           DFHEIV11,
 19940           DFHEIV99
 19941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19942
 19943
 19944 8120-EXIT.
 19945     EXIT.
 19946
 19947 8130-WRITE-ERMAIL.
 19948
 19949* EXEC CICS HANDLE CONDITION
 19950*         DUPKEY   (8130-EXIT)
 19951*    END-EXEC.
 19952*    MOVE '"$$                   ! . #00019256' TO DFHEIV0
 19953     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19954     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19955     MOVE X'2E20233030303139323536' TO DFHEIV0(25:11)
 19956     CALL 'kxdfhei1' USING DFHEIV0
 19957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19958
 19959
 19960
 19961* EXEC CICS WRITE
 19962*         DATASET     (FILE-ERMAIL)
 19963*         RIDFLD      (MA-CONTROL-PRIMARY)
 19964*         FROM        (MAILING-DATA)
 19965*    END-EXEC.
 19966     MOVE LENGTH OF
 19967      MAILING-DATA
 19968       TO DFHEIV11
 19969*    MOVE '&$ L                  ''   #00019260' TO DFHEIV0
 19970     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19971     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19972     MOVE X'2020233030303139323630' TO DFHEIV0(25:11)
 19973     CALL 'kxdfhei1' USING DFHEIV0,
 19974           FILE-ERMAIL,
 19975           MAILING-DATA,
 19976           DFHEIV11,
 19977           MA-CONTROL-PRIMARY,
 19978           DFHEIV99,
 19979           DFHEIV99
 19980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19981
 19982
 19983 8130-EXIT.
 19984     EXIT.
 19985
 19986 8140-UNLOCK-ERMAIL.
 19987
 19988* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 368
* EL050.cbl
 19989*         DATASET   (FILE-ERMAIL)
 19990*    END-EXEC.
 19991*    MOVE '&*                    #   #00019270' TO DFHEIV0
 19992     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19993     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19994     MOVE X'2020233030303139323730' TO DFHEIV0(25:11)
 19995     CALL 'kxdfhei1' USING DFHEIV0,
 19996           FILE-ERMAIL,
 19997           DFHEIV99
 19998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19999
 20000
 20001 8140-EXIT.
 20002     EXIT.
 20003
 20004 8150-read-elcrtt.
 20005
 20006
 20007* EXEC CICS HANDLE CONDITION
 20008*        NOTFND   (8150-exit)
 20009*    END-EXEC
 20010*    MOVE '"$I                   ! / #00019279' TO DFHEIV0
 20011     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20013     MOVE X'2F20233030303139323739' TO DFHEIV0(25:11)
 20014     CALL 'kxdfhei1' USING DFHEIV0
 20015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20016
 20017     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20018     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20019
 20020
 20021* EXEC CICS READ
 20022*        DATASET  (CRTT-ID)
 20023*        RIDFLD   (WS-ELCRTT-KEY)
 20024*        INTO     (CERTIFICATE-TRAILERS)
 20025*    END-EXEC
 20026     MOVE LENGTH OF
 20027      CERTIFICATE-TRAILERS
 20028       TO DFHEIV11
 20029*    MOVE '&"IL       E          (   #00019286' TO DFHEIV0
 20030     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20032     MOVE X'2020233030303139323836' TO DFHEIV0(25:11)
 20033     CALL 'kxdfhei1' USING DFHEIV0,
 20034           CRTT-ID,
 20035           CERTIFICATE-TRAILERS,
 20036           DFHEIV11,
 20037           WS-ELCRTT-KEY,
 20038           DFHEIV99,
 20039           DFHEIV99,
 20040           DFHEIV99
 20041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20042
 20043     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20044     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20045
 20046     .
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 369
* EL050.cbl
 20047 8150-exit.
 20048     exit.
 20049 8180-UPDATE-VIN-NUMBER.
 20050
 20051* EXEC CICS HANDLE CONDITION
 20052*        NOTFND   (8180-NOTFND)
 20053*    END-EXEC.
 20054*    MOVE '"$I                   ! 0 #00019299' TO DFHEIV0
 20055     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20057     MOVE X'3020233030303139323939' TO DFHEIV0(25:11)
 20058     CALL 'kxdfhei1' USING DFHEIV0
 20059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20060
 20061
 20062     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20063     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20064
 20065
 20066* EXEC CICS READ
 20067*        UPDATE
 20068*        DATASET  (CRTT-ID)
 20069*        RIDFLD   (WS-ELCRTT-KEY)
 20070*        INTO     (CERTIFICATE-TRAILERS)
 20071*    END-EXEC.
 20072     MOVE LENGTH OF
 20073      CERTIFICATE-TRAILERS
 20074       TO DFHEIV11
 20075*    MOVE '&"IL       EU         (   #00019306' TO DFHEIV0
 20076     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20077     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20078     MOVE X'2020233030303139333036' TO DFHEIV0(25:11)
 20079     CALL 'kxdfhei1' USING DFHEIV0,
 20080           CRTT-ID,
 20081           CERTIFICATE-TRAILERS,
 20082           DFHEIV11,
 20083           WS-ELCRTT-KEY,
 20084           DFHEIV99,
 20085           DFHEIV99,
 20086           DFHEIV99
 20087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20088
 20089
 20090     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20091         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20092
 20093* EXEC CICS REWRITE
 20094*           DATASET  (CRTT-ID)
 20095*           FROM     (CERTIFICATE-TRAILERS)
 20096*        END-EXEC
 20097     MOVE LENGTH OF
 20098      CERTIFICATE-TRAILERS
 20099       TO DFHEIV11
 20100*    MOVE '&& L                  %   #00019315' TO DFHEIV0
 20101     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20102     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20103     MOVE X'2020233030303139333135' TO DFHEIV0(25:11)
 20104     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 370
* EL050.cbl
 20105           CRTT-ID,
 20106           CERTIFICATE-TRAILERS,
 20107           DFHEIV11,
 20108           DFHEIV99
 20109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20110     ELSE
 20111
 20112* EXEC CICS UNLOCK
 20113*          DATASET  (CRTT-ID)
 20114*       END-EXEC
 20115*    MOVE '&*                    #   #00019320' TO DFHEIV0
 20116     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20117     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20118     MOVE X'2020233030303139333230' TO DFHEIV0(25:11)
 20119     CALL 'kxdfhei1' USING DFHEIV0,
 20120           CRTT-ID,
 20121           DFHEIV99
 20122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20123     END-IF.
 20124
 20125     GO TO 8180-EXIT.
 20126
 20127 8180-NOTFND.
 20128
 20129     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20130     MOVE 'CS'         TO CS-RECORD-ID.
 20131     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20132     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20133     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20134     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20135
 20136* EXEC CICS WRITE
 20137*       DATASET  (CRTT-ID)
 20138*       RIDFLD   (WS-ELCRTT-KEY)
 20139*       FROM     (CERTIFICATE-TRAILERS)
 20140*    END-EXEC.
 20141     MOVE LENGTH OF
 20142      CERTIFICATE-TRAILERS
 20143       TO DFHEIV11
 20144*    MOVE '&$ L                  ''   #00019335' TO DFHEIV0
 20145     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20146     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20147     MOVE X'2020233030303139333335' TO DFHEIV0(25:11)
 20148     CALL 'kxdfhei1' USING DFHEIV0,
 20149           CRTT-ID,
 20150           CERTIFICATE-TRAILERS,
 20151           DFHEIV11,
 20152           WS-ELCRTT-KEY,
 20153           DFHEIV99,
 20154           DFHEIV99
 20155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20156
 20157
 20158 8180-EXIT.
 20159     EXIT.
 20160
 20161 8190-UPDATE-REFUND-CLAIM-FLAG.
 20162
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 371
* EL050.cbl
 20163* EXEC CICS HANDLE CONDITION
 20164*        NOTFND   (8190-NOTFND)
 20165*    END-EXEC.
 20166*    MOVE '"$I                   ! 1 #00019345' TO DFHEIV0
 20167     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20169     MOVE X'3120233030303139333435' TO DFHEIV0(25:11)
 20170     CALL 'kxdfhei1' USING DFHEIV0
 20171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20172
 20173
 20174     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20175     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20176
 20177
 20178* EXEC CICS READ
 20179*        UPDATE
 20180*        DATASET  (CRTT-ID)
 20181*        RIDFLD   (WS-ELCRTT-KEY)
 20182*        INTO     (CERTIFICATE-TRAILERS)
 20183*    END-EXEC.
 20184     MOVE LENGTH OF
 20185      CERTIFICATE-TRAILERS
 20186       TO DFHEIV11
 20187*    MOVE '&"IL       EU         (   #00019352' TO DFHEIV0
 20188     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20189     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20190     MOVE X'2020233030303139333532' TO DFHEIV0(25:11)
 20191     CALL 'kxdfhei1' USING DFHEIV0,
 20192           CRTT-ID,
 20193           CERTIFICATE-TRAILERS,
 20194           DFHEIV11,
 20195           WS-ELCRTT-KEY,
 20196           DFHEIV99,
 20197           DFHEIV99,
 20198           DFHEIV99
 20199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20200
 20201
 20202     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20203
 20204* EXEC CICS REWRITE
 20205*       DATASET  (CRTT-ID)
 20206*       FROM     (CERTIFICATE-TRAILERS)
 20207*    END-EXEC.
 20208     MOVE LENGTH OF
 20209      CERTIFICATE-TRAILERS
 20210       TO DFHEIV11
 20211*    MOVE '&& L                  %   #00019360' TO DFHEIV0
 20212     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20213     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20214     MOVE X'2020233030303139333630' TO DFHEIV0(25:11)
 20215     CALL 'kxdfhei1' USING DFHEIV0,
 20216           CRTT-ID,
 20217           CERTIFICATE-TRAILERS,
 20218           DFHEIV11,
 20219           DFHEIV99
 20220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 372
* EL050.cbl
 20221
 20222
 20223     GO TO 8190-EXIT.
 20224
 20225 8190-NOTFND.
 20226
 20227     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20228     MOVE 'CS'         TO CS-RECORD-ID.
 20229     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20230     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20231     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20232     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20233
 20234* EXEC CICS WRITE
 20235*       DATASET  (CRTT-ID)
 20236*       RIDFLD   (WS-ELCRTT-KEY)
 20237*       FROM     (CERTIFICATE-TRAILERS)
 20238*    END-EXEC.
 20239     MOVE LENGTH OF
 20240      CERTIFICATE-TRAILERS
 20241       TO DFHEIV11
 20242*    MOVE '&$ L                  ''   #00019375' TO DFHEIV0
 20243     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20244     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20245     MOVE X'2020233030303139333735' TO DFHEIV0(25:11)
 20246     CALL 'kxdfhei1' USING DFHEIV0,
 20247           CRTT-ID,
 20248           CERTIFICATE-TRAILERS,
 20249           DFHEIV11,
 20250           WS-ELCRTT-KEY,
 20251           DFHEIV99,
 20252           DFHEIV99
 20253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20254
 20255
 20256 8190-EXIT.
 20257     EXIT.
 20258
 20259 8195-UPDATE-AGE-FLAGS.
 20260
 20261* EXEC CICS HANDLE CONDITION
 20262*        NOTFND   (8195-NOTFND)
 20263*    END-EXEC.
 20264*    MOVE '"$I                   ! 2 #00019385' TO DFHEIV0
 20265     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20267     MOVE X'3220233030303139333835' TO DFHEIV0(25:11)
 20268     CALL 'kxdfhei1' USING DFHEIV0
 20269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20270
 20271
 20272     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20273     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20274
 20275
 20276* EXEC CICS READ
 20277*        UPDATE
 20278*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 373
* EL050.cbl
 20279*        RIDFLD   (WS-ELCRTT-KEY)
 20280*        INTO     (CERTIFICATE-TRAILERS)
 20281*    END-EXEC.
 20282     MOVE LENGTH OF
 20283      CERTIFICATE-TRAILERS
 20284       TO DFHEIV11
 20285*    MOVE '&"IL       EU         (   #00019392' TO DFHEIV0
 20286     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20287     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20288     MOVE X'2020233030303139333932' TO DFHEIV0(25:11)
 20289     CALL 'kxdfhei1' USING DFHEIV0,
 20290           CRTT-ID,
 20291           CERTIFICATE-TRAILERS,
 20292           DFHEIV11,
 20293           WS-ELCRTT-KEY,
 20294           DFHEIV99,
 20295           DFHEIV99,
 20296           DFHEIV99
 20297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20298
 20299
 20300     IF WS-INS-AGE-SET = 'Y'
 20301        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20302     END-IF
 20303     IF WS-JNT-AGE-SET = 'Y'
 20304        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20305     END-IF
 20306
 20307
 20308* EXEC CICS REWRITE
 20309*       DATASET  (CRTT-ID)
 20310*       FROM     (CERTIFICATE-TRAILERS)
 20311*    END-EXEC.
 20312     MOVE LENGTH OF
 20313      CERTIFICATE-TRAILERS
 20314       TO DFHEIV11
 20315*    MOVE '&& L                  %   #00019406' TO DFHEIV0
 20316     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20317     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20318     MOVE X'2020233030303139343036' TO DFHEIV0(25:11)
 20319     CALL 'kxdfhei1' USING DFHEIV0,
 20320           CRTT-ID,
 20321           CERTIFICATE-TRAILERS,
 20322           DFHEIV11,
 20323           DFHEIV99
 20324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20325
 20326
 20327     GO TO 8195-EXIT.
 20328
 20329 8195-NOTFND.
 20330
 20331     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20332     MOVE 'CS'         TO CS-RECORD-ID.
 20333     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20334     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20335     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20336     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 374
* EL050.cbl
 20337     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20338
 20339* EXEC CICS WRITE
 20340*       DATASET  (CRTT-ID)
 20341*       RIDFLD   (WS-ELCRTT-KEY)
 20342*       FROM     (CERTIFICATE-TRAILERS)
 20343*    END-EXEC.
 20344     MOVE LENGTH OF
 20345      CERTIFICATE-TRAILERS
 20346       TO DFHEIV11
 20347*    MOVE '&$ L                  ''   #00019422' TO DFHEIV0
 20348     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20349     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20350     MOVE X'2020233030303139343232' TO DFHEIV0(25:11)
 20351     CALL 'kxdfhei1' USING DFHEIV0,
 20352           CRTT-ID,
 20353           CERTIFICATE-TRAILERS,
 20354           DFHEIV11,
 20355           WS-ELCRTT-KEY,
 20356           DFHEIV99,
 20357           DFHEIV99
 20358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20359
 20360
 20361 8195-EXIT.
 20362     EXIT.
 20363
 20364 8200-READ-REIN-TABLE.
 20365
 20366* EXEC CICS HANDLE CONDITION
 20367*         NOTFND   (8200-NOTFND)
 20368*    END-EXEC.
 20369*    MOVE '"$I                   ! 3 #00019432' TO DFHEIV0
 20370     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20372     MOVE X'3320233030303139343332' TO DFHEIV0(25:11)
 20373     CALL 'kxdfhei1' USING DFHEIV0
 20374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20375
 20376
 20377
 20378* EXEC CICS READ
 20379*        DATASET     (REIN-ID)
 20380*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20381*        RIDFLD      (ERREIN-KEY)
 20382*    END-EXEC.
 20383*    MOVE '&"S        E          (   #00019436' TO DFHEIV0
 20384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20386     MOVE X'2020233030303139343336' TO DFHEIV0(25:11)
 20387     CALL 'kxdfhei1' USING DFHEIV0,
 20388           REIN-ID,
 20389           DFHEIV20,
 20390           DFHEIV99,
 20391           ERREIN-KEY,
 20392           DFHEIV99,
 20393           DFHEIV99,
 20394           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 375
* EL050.cbl
 20395     SET ADDRESS OF REINSURANCE-RECORD TO
 20396         DFHEIV20
 20397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20398
 20399
 20400     GO TO 8200-EXIT.
 20401
 20402 8200-NOTFND.
 20403     MOVE 'N'             TO WS-REIN-READ-SW.
 20404
 20405 8200-EXIT.
 20406      EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 376
* EL050.cbl
 20408
 20409 8300-READ-CTBL-TABLE.
 20410
 20411* EXEC CICS HANDLE CONDITION
 20412*        NOTFND    (8300-NOTFND)
 20413*        DISABLED  (8300-ERRESS-PROBLEM)
 20414*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20415*        ENDFILE   (8300-NOTFND)
 20416*    END-EXEC.
 20417*    MOVE '"$IcJ''                ! 4 #00019452' TO DFHEIV0
 20418     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20420     MOVE X'3420233030303139343532' TO DFHEIV0(25:11)
 20421     CALL 'kxdfhei1' USING DFHEIV0
 20422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20423
 20424
 20425
 20426* EXEC CICS READ
 20427*        DATASET     (CTBL-ID)
 20428*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20429*        RIDFLD      (ERCTBL-KEY)
 20430*    END-EXEC.
 20431*    MOVE '&"S        E          (   #00019459' TO DFHEIV0
 20432     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20434     MOVE X'2020233030303139343539' TO DFHEIV0(25:11)
 20435     CALL 'kxdfhei1' USING DFHEIV0,
 20436           CTBL-ID,
 20437           DFHEIV20,
 20438           DFHEIV99,
 20439           ERCTBL-KEY,
 20440           DFHEIV99,
 20441           DFHEIV99,
 20442           DFHEIV99
 20443     SET ADDRESS OF COMM-TABLE-RECORD TO
 20444         DFHEIV20
 20445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20446
 20447
 20448     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20449
 20450     GO TO 8300-EXIT.
 20451
 20452 8300-NOTFND.
 20453
 20454     IF CTBL-SW = '0530'
 20455         MOVE 'AA'                     TO WS-AH-COMP-CD
 20456         MOVE '0550'                   TO CTBL-SW
 20457         MOVE '1'                      TO WS-CTBL-READ-SW
 20458         GO TO 8300-EXIT.
 20459
 20460     IF CTBL-SW = '0540'
 20461         MOVE 'AA'                     TO WS-LF-COMP-CD
 20462         MOVE '0550'                   TO CTBL-SW
 20463         MOVE '1'                      TO WS-CTBL-READ-SW
 20464         GO TO 8300-EXIT.
 20465
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 377
* EL050.cbl
 20466     IF CTBL-SW = '0550'
 20467         MOVE '2'                      TO WS-CTBL-READ-SW
 20468         GO TO 8300-EXIT.
 20469
 20470     GO TO 8300-EXIT.
 20471
 20472 8300-ERRESS-PROBLEM.
 20473
 20474      MOVE ER-8050              TO WS-ERROR.
 20475      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20476
 20477     GO TO 8300-EXIT.
 20478
 20479 8300-EXIT.
 20480      EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 378
* EL050.cbl
 20482
 20483
 20484 8400-GETMAIN-ERFORM.
 20485
 20486
 20487* EXEC CICS   GETMAIN
 20488*        LENGTH  (500)
 20489*        SET     (ADDRESS OF FORM-MASTER)
 20490*    END-EXEC.
 20491     MOVE 500
 20492       TO DFHEIV11
 20493*    MOVE '," L                  $   #00019503' TO DFHEIV0
 20494     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20495     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20496     MOVE X'2020233030303139353033' TO DFHEIV0(25:11)
 20497     CALL 'kxdfhei1' USING DFHEIV0,
 20498           DFHEIV20,
 20499           DFHEIV11,
 20500           DFHEIV99
 20501     SET ADDRESS OF FORM-MASTER TO
 20502         DFHEIV20
 20503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20504
 20505
 20506     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20507
 20508 8400-EXIT.
 20509      EXIT.
 20510
 20511 8450-READ-FORM-MASTER.
 20512
 20513
 20514* EXEC CICS  HANDLE CONDITION
 20515*        NOTFND   (8450-FORM-NOT-FOUND)
 20516*        ENDFILE  (8450-FORM-NOT-FOUND)
 20517*    END-EXEC.
 20518*    MOVE '"$I''                  ! 5 #00019515' TO DFHEIV0
 20519     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20521     MOVE X'3520233030303139353135' TO DFHEIV0(25:11)
 20522     CALL 'kxdfhei1' USING DFHEIV0
 20523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20524
 20525
 20526
 20527* EXEC CICS   READ
 20528*        DATASET   (FORM-ID)
 20529*        RIDFLD    (ERFORM-KEY)
 20530*        INTO      (FORM-MASTER)
 20531*        GTEQ
 20532*    END-EXEC.
 20533     MOVE LENGTH OF
 20534      FORM-MASTER
 20535       TO DFHEIV11
 20536*    MOVE '&"IL       G          (   #00019520' TO DFHEIV0
 20537     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20539     MOVE X'2020233030303139353230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 379
* EL050.cbl
 20540     CALL 'kxdfhei1' USING DFHEIV0,
 20541           FORM-ID,
 20542           FORM-MASTER,
 20543           DFHEIV11,
 20544           ERFORM-KEY,
 20545           DFHEIV99,
 20546           DFHEIV99,
 20547           DFHEIV99
 20548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20549
 20550
 20551     MOVE  'Y'           TO  FORM-MASTER-SW.
 20552
 20553     GO TO  8450-EXIT.
 20554
 20555 8450-FORM-NOT-FOUND.
 20556
 20557     MOVE  'N'           TO  FORM-MASTER-SW.
 20558
 20559 8450-EXIT.
 20560      EXIT.
 20561
 20562 8500-DATE-CONVERT.
 20563
 20564* EXEC CICS LINK
 20565*        PROGRAM    ('ELDATCV')
 20566*        COMMAREA   (DATE-CONVERSION-DATA)
 20567*        LENGTH     (DC-COMM-LENGTH)
 20568*    END-EXEC.
 20569     MOVE 'ELDATCV' TO DFHEIV1
 20570*    MOVE '."C                   (   #00019539' TO DFHEIV0
 20571     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20573     MOVE X'2020233030303139353339' TO DFHEIV0(25:11)
 20574     CALL 'kxdfhei1' USING DFHEIV0,
 20575           DFHEIV1,
 20576           DATE-CONVERSION-DATA,
 20577           DC-COMM-LENGTH,
 20578           DFHEIV99,
 20579           DFHEIV99,
 20580           DFHEIV99,
 20581           DFHEIV99
 20582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20583
 20584
 20585 8500-EXIT.
 20586     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 380
* EL050.cbl
 20588
 20589 8555-RELOAD-CONTROL-FILE.
 20590     CONTINUE.
 20591
 20592 8555-EXIT.
 20593     EXIT.
 20594
 20595 8557-GETMAIN-ERPLAN.
 20596
 20597
 20598* EXEC CICS GETMAIN
 20599*        LENGTH    (840)
 20600*        SET       (ADDRESS OF PLAN-RECORDS)
 20601*    END-EXEC.
 20602     MOVE 840
 20603       TO DFHEIV11
 20604*    MOVE '," L                  $   #00019557' TO DFHEIV0
 20605     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20606     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20607     MOVE X'2020233030303139353537' TO DFHEIV0(25:11)
 20608     CALL 'kxdfhei1' USING DFHEIV0,
 20609           DFHEIV20,
 20610           DFHEIV11,
 20611           DFHEIV99
 20612     SET ADDRESS OF PLAN-RECORDS TO
 20613         DFHEIV20
 20614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20615
 20616
 20617     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20618
 20619 8557-EXIT.
 20620     EXIT.
 20621
 20622 8560-GETMAIN.
 20623
 20624* EXEC CICS GETMAIN
 20625*        LENGTH    (2000)
 20626*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20627*    END-EXEC.
 20628     MOVE 2000
 20629       TO DFHEIV11
 20630*    MOVE '," L                  $   #00019568' TO DFHEIV0
 20631     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20633     MOVE X'2020233030303139353638' TO DFHEIV0(25:11)
 20634     CALL 'kxdfhei1' USING DFHEIV0,
 20635           DFHEIV20,
 20636           DFHEIV11,
 20637           DFHEIV99
 20638     SET ADDRESS OF ACCOUNT-MASTER TO
 20639         DFHEIV20
 20640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20641
 20642
 20643     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20644
 20645 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 381
* EL050.cbl
 20646     EXIT.
 20647
 20648 8570-START-ACCOUNT-MASTER.
 20649
 20650* EXEC CICS HANDLE CONDITION
 20651*        NOTFND    (0199-ACCT-NOT-FOUND)
 20652*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20653*    END-EXEC.
 20654*    MOVE '"$I''                  ! 6 #00019579' TO DFHEIV0
 20655     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20657     MOVE X'3620233030303139353739' TO DFHEIV0(25:11)
 20658     CALL 'kxdfhei1' USING DFHEIV0
 20659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20660
 20661
 20662
 20663* EXEC CICS STARTBR
 20664*        DATASET    (ACCT-ID)
 20665*        RIDFLD     (ERACCT-KEY)
 20666*        GTEQ
 20667*    END-EXEC.
 20668     MOVE 0
 20669       TO DFHEIV11
 20670*    MOVE '&,         G          &   #00019584' TO DFHEIV0
 20671     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20672     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20673     MOVE X'2020233030303139353834' TO DFHEIV0(25:11)
 20674     CALL 'kxdfhei1' USING DFHEIV0,
 20675           ACCT-ID,
 20676           ERACCT-KEY,
 20677           DFHEIV99,
 20678           DFHEIV11,
 20679           DFHEIV99
 20680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20681
 20682
 20683 8570-EXIT.
 20684     EXIT.
 20685
 20686 8580-READ-ACCOUNT-MASTER.
 20687
 20688* EXEC CICS HANDLE CONDITION
 20689*        NOTFND    (0199-ACCT-NOT-FOUND)
 20690*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20691*    END-EXEC.
 20692*    MOVE '"$I''                  ! 7 #00019594' TO DFHEIV0
 20693     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20695     MOVE X'3720233030303139353934' TO DFHEIV0(25:11)
 20696     CALL 'kxdfhei1' USING DFHEIV0
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20698
 20699
 20700
 20701* EXEC CICS READNEXT
 20702*        DATASET     (ACCT-ID)
 20703*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 382
* EL050.cbl
 20704*        RIDFLD      (ERACCT-KEY)
 20705*    END-EXEC.
 20706     MOVE LENGTH OF
 20707      ACCOUNT-MASTER
 20708       TO DFHEIV12
 20709     MOVE 0
 20710       TO DFHEIV11
 20711*    MOVE '&.IL                  )   #00019599' TO DFHEIV0
 20712     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20713     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20714     MOVE X'2020233030303139353939' TO DFHEIV0(25:11)
 20715     CALL 'kxdfhei1' USING DFHEIV0,
 20716           ACCT-ID,
 20717           ACCOUNT-MASTER,
 20718           DFHEIV12,
 20719           ERACCT-KEY,
 20720           DFHEIV99,
 20721           DFHEIV11,
 20722           DFHEIV99,
 20723           DFHEIV99
 20724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20725
 20726
 20727 8580-EXIT.
 20728     EXIT.
 20729
 20730 8582-READ-COMPENSATION-MASTER.
 20731
 20732* EXEC CICS HANDLE CONDITION
 20733*        NOTFND    (8582-COMP-NOT-FOUND)
 20734*        ENDFILE   (8582-COMP-NOT-FOUND)
 20735*    END-EXEC.
 20736*    MOVE '"$I''                  ! 8 #00019609' TO DFHEIV0
 20737     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20739     MOVE X'3820233030303139363039' TO DFHEIV0(25:11)
 20740     CALL 'kxdfhei1' USING DFHEIV0
 20741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20742
 20743
 20744
 20745* EXEC CICS READ
 20746*        DATASET     (COMP-ID)
 20747*        INTO        (COMPENSATION-MASTER)
 20748*        RIDFLD      (ERCOMP-KEY)
 20749*    END-EXEC.
 20750     MOVE LENGTH OF
 20751      COMPENSATION-MASTER
 20752       TO DFHEIV11
 20753*    MOVE '&"IL       E          (   #00019614' TO DFHEIV0
 20754     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20756     MOVE X'2020233030303139363134' TO DFHEIV0(25:11)
 20757     CALL 'kxdfhei1' USING DFHEIV0,
 20758           COMP-ID,
 20759           COMPENSATION-MASTER,
 20760           DFHEIV11,
 20761           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 383
* EL050.cbl
 20762           DFHEIV99,
 20763           DFHEIV99,
 20764           DFHEIV99
 20765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20766
 20767
 20768     MOVE 'Y'                    TO COMP-MASTER-SW
 20769
 20770     GO TO 8582-EXIT
 20771     .
 20772 8582-COMP-NOT-FOUND.
 20773
 20774     MOVE 'N'                    TO COMP-MASTER-SW.
 20775
 20776 8582-EXIT.
 20777     EXIT.
 20778
 20779 8583-READ-ERAGTC.
 20780
 20781* EXEC CICS HANDLE CONDITION
 20782*        NOTFND    (8583-AGTC-NOT-FOUND)
 20783*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20784*    END-EXEC.
 20785*    MOVE '"$I''                  ! 9 #00019632' TO DFHEIV0
 20786     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20787     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20788     MOVE X'3920233030303139363332' TO DFHEIV0(25:11)
 20789     CALL 'kxdfhei1' USING DFHEIV0
 20790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20791
 20792
 20793
 20794* EXEC CICS STARTBR
 20795*        DATASET    (AGTC-ID)
 20796*        RIDFLD     (ERAGTC-KEY)
 20797*        GTEQ
 20798*    END-EXEC.
 20799     MOVE 0
 20800       TO DFHEIV11
 20801*    MOVE '&,         G          &   #00019637' TO DFHEIV0
 20802     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20803     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20804     MOVE X'2020233030303139363337' TO DFHEIV0(25:11)
 20805     CALL 'kxdfhei1' USING DFHEIV0,
 20806           AGTC-ID,
 20807           ERAGTC-KEY,
 20808           DFHEIV99,
 20809           DFHEIV11,
 20810           DFHEIV99
 20811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20812
 20813
 20814 8583-READ-ERAGTC-NEXT.
 20815
 20816* EXEC CICS READNEXT
 20817*        DATASET     (AGTC-ID)
 20818*        INTO        (AGENT-COMMISSIONS)
 20819*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 384
* EL050.cbl
 20820*    END-EXEC.
 20821     MOVE LENGTH OF
 20822      AGENT-COMMISSIONS
 20823       TO DFHEIV12
 20824     MOVE 0
 20825       TO DFHEIV11
 20826*    MOVE '&.IL                  )   #00019644' TO DFHEIV0
 20827     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20828     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20829     MOVE X'2020233030303139363434' TO DFHEIV0(25:11)
 20830     CALL 'kxdfhei1' USING DFHEIV0,
 20831           AGTC-ID,
 20832           AGENT-COMMISSIONS,
 20833           DFHEIV12,
 20834           ERAGTC-KEY,
 20835           DFHEIV99,
 20836           DFHEIV11,
 20837           DFHEIV99,
 20838           DFHEIV99
 20839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20840
 20841
 20842*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20843
 20844     GO TO 8583-EXIT
 20845     .
 20846 8583-AGTC-NOT-FOUND.
 20847
 20848     MOVE 'N'                    TO AGTC-MASTER-SW.
 20849
 20850 8583-EXIT.
 20851     EXIT.
 20852
 20853 8584-READ-BANK-CROSS-REF.
 20854
 20855* EXEC CICS HANDLE CONDITION
 20856*        NOTFND    (8584-BXRF-NOT-FOUND)
 20857*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20858*    END-EXEC.
 20859*    MOVE '"$I''                  ! : #00019662' TO DFHEIV0
 20860     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20861     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20862     MOVE X'3A20233030303139363632' TO DFHEIV0(25:11)
 20863     CALL 'kxdfhei1' USING DFHEIV0
 20864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20865
 20866
 20867
 20868* EXEC CICS READ
 20869*        DATASET     (BXRF-ID)
 20870*        INTO        (BANK-CROSS-REFERENCE)
 20871*        RIDFLD      (ERBXRF-KEY)
 20872*        LENGTH      (BXRF-REC-LENGTH)
 20873*    END-EXEC.
 20874*    MOVE '&"IL       E          (   #00019667' TO DFHEIV0
 20875     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20877     MOVE X'2020233030303139363637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 385
* EL050.cbl
 20878     CALL 'kxdfhei1' USING DFHEIV0,
 20879           BXRF-ID,
 20880           BANK-CROSS-REFERENCE,
 20881           BXRF-REC-LENGTH,
 20882           ERBXRF-KEY,
 20883           DFHEIV99,
 20884           DFHEIV99,
 20885           DFHEIV99
 20886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20887
 20888
 20889     MOVE 'Y'                    TO BXRF-MASTER-SW
 20890
 20891     GO TO 8584-EXIT
 20892     .
 20893 8584-BXRF-NOT-FOUND.
 20894
 20895     MOVE 'N'                    TO BXRF-MASTER-SW.
 20896
 20897 8584-EXIT.
 20898     EXIT.
 20899
 20900 8585-READ-PLAN-MASTER.
 20901
 20902
 20903* EXEC CICS HANDLE CONDITION
 20904*        NOTFND    (8585-PLAN-NOT-FOUND)
 20905*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20906*    END-EXEC.
 20907*    MOVE '"$I''                  ! ; #00019687' TO DFHEIV0
 20908     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20909     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20910     MOVE X'3B20233030303139363837' TO DFHEIV0(25:11)
 20911     CALL 'kxdfhei1' USING DFHEIV0
 20912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20913
 20914
 20915
 20916* EXEC CICS READ
 20917*        DATASET     (PLAN-ID)
 20918*        INTO        (PLAN-MASTER)
 20919*        RIDFLD      (ERPLAN-KEY)
 20920*    END-EXEC.
 20921     MOVE LENGTH OF
 20922      PLAN-MASTER
 20923       TO DFHEIV11
 20924*    MOVE '&"IL       E          (   #00019692' TO DFHEIV0
 20925     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20926     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20927     MOVE X'2020233030303139363932' TO DFHEIV0(25:11)
 20928     CALL 'kxdfhei1' USING DFHEIV0,
 20929           PLAN-ID,
 20930           PLAN-MASTER,
 20931           DFHEIV11,
 20932           ERPLAN-KEY,
 20933           DFHEIV99,
 20934           DFHEIV99,
 20935           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 386
* EL050.cbl
 20936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20937
 20938
 20939     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20940
 20941     GO TO 8585-EXIT.
 20942
 20943 8585-PLAN-NOT-FOUND.
 20944
 20945     MOVE 'N'                    TO PLAN-MASTER-SW.
 20946
 20947 8585-EXIT.
 20948     EXIT.
 20949
 20950 8586-READ-LOAN-OFFICER.
 20951
 20952* EXEC CICS READ
 20953*        DATASET     (LOFC-ID)
 20954*        INTO        (LOAN-OFFICER-MASTER)
 20955*        RIDFLD      (ERLOFC-KEY)
 20956*        RESP        (WS-RESPONSE)
 20957*    END-EXEC
 20958     MOVE LENGTH OF
 20959      LOAN-OFFICER-MASTER
 20960       TO DFHEIV11
 20961*    MOVE '&"IL       E          (  N#00019710' TO DFHEIV0
 20962     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20964     MOVE X'204E233030303139373130' TO DFHEIV0(25:11)
 20965     CALL 'kxdfhei1' USING DFHEIV0,
 20966           LOFC-ID,
 20967           LOAN-OFFICER-MASTER,
 20968           DFHEIV11,
 20969           ERLOFC-KEY,
 20970           DFHEIV99,
 20971           DFHEIV99,
 20972           DFHEIV99
 20973     MOVE EIBRESP  TO WS-RESPONSE
 20974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20975
 20976     IF WS-RESP-NORMAL
 20977        MOVE 'Y'                 TO LOFC-MASTER-SW
 20978     ELSE
 20979        MOVE 'N'                 TO LOFC-MASTER-SW
 20980     END-IF
 20981     .
 20982 8586-EXIT.
 20983     EXIT.
 20984 8587-START-ERPDEF.
 20985
 20986* EXEC CICS STARTBR
 20987*       DATASET   (PDEF-ID)
 20988*       RIDFLD    (ERPDEF-KEY)
 20989*       GTEQ
 20990*       RESP      (WS-RESPONSE)
 20991*    END-EXEC
 20992     MOVE 0
 20993       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 387
* EL050.cbl
 20994*    MOVE '&,         G          &  N#00019726' TO DFHEIV0
 20995     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20996     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20997     MOVE X'204E233030303139373236' TO DFHEIV0(25:11)
 20998     CALL 'kxdfhei1' USING DFHEIV0,
 20999           PDEF-ID,
 21000           ERPDEF-KEY,
 21001           DFHEIV99,
 21002           DFHEIV11,
 21003           DFHEIV99
 21004     MOVE EIBRESP  TO WS-RESPONSE
 21005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21006     IF WS-RESP-NORMAL
 21007        MOVE 'Y'                 TO PDEF-MASTER-SW
 21008     ELSE
 21009        MOVE 'N'                 TO PDEF-MASTER-SW
 21010     END-IF
 21011     .
 21012 8587-EXIT.
 21013     EXIT.
 21014 8588-READ-ERPDEF.
 21015
 21016* EXEC CICS READNEXT
 21017*       DATASET   (PDEF-ID)
 21018*       RIDFLD    (ERPDEF-KEY)
 21019*       INTO      (PRODUCT-MASTER)
 21020*       RESP      (WS-RESPONSE)
 21021*    END-EXEC
 21022     MOVE LENGTH OF
 21023      PRODUCT-MASTER
 21024       TO DFHEIV12
 21025     MOVE 0
 21026       TO DFHEIV11
 21027*    MOVE '&.IL                  )  N#00019741' TO DFHEIV0
 21028     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21029     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21030     MOVE X'204E233030303139373431' TO DFHEIV0(25:11)
 21031     CALL 'kxdfhei1' USING DFHEIV0,
 21032           PDEF-ID,
 21033           PRODUCT-MASTER,
 21034           DFHEIV12,
 21035           ERPDEF-KEY,
 21036           DFHEIV99,
 21037           DFHEIV11,
 21038           DFHEIV99,
 21039           DFHEIV99
 21040     MOVE EIBRESP  TO WS-RESPONSE
 21041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21042     IF WS-RESP-NORMAL
 21043        MOVE 'Y'                 TO PDEF-MASTER-SW
 21044     ELSE
 21045        MOVE 'N'                 TO PDEF-MASTER-SW
 21046     END-IF
 21047     .
 21048 8588-EXIT.
 21049     EXIT.
 21050 8589-ENDBR-ERPDEF.
 21051
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 388
* EL050.cbl
 21052* EXEC CICS ENDBR
 21053*       DATASET   (PDEF-ID)
 21054*    END-EXEC
 21055     MOVE 0
 21056       TO DFHEIV11
 21057*    MOVE '&2                    $   #00019756' TO DFHEIV0
 21058     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21060     MOVE X'2020233030303139373536' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0,
 21062           PDEF-ID,
 21063           DFHEIV11,
 21064           DFHEIV99
 21065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21066     .
 21067 8589-EXIT.
 21068     EXIT.
 21069 8590-READ-CERT-MASTER.
 21070     IF PB-COMPANY-ID = 'UCL'
 21071         GO TO 8690-READ-CERT-MASTER-UCL.
 21072
 21073
 21074* EXEC CICS HANDLE CONDITION
 21075*         NOTFND    (0299-CERT-NOT-FOUND)
 21076*    END-EXEC.
 21077*    MOVE '"$I                   ! < #00019766' TO DFHEIV0
 21078     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21080     MOVE X'3C20233030303139373636' TO DFHEIV0(25:11)
 21081     CALL 'kxdfhei1' USING DFHEIV0
 21082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21083
 21084
 21085
 21086* EXEC CICS READ
 21087*        DATASET     (CERT-ID)
 21088*        INTO        (CERTIFICATE-MASTER)
 21089*        RIDFLD      (ELCERT-KEY)
 21090*        UPDATE
 21091*    END-EXEC.
 21092     MOVE LENGTH OF
 21093      CERTIFICATE-MASTER
 21094       TO DFHEIV11
 21095*    MOVE '&"IL       EU         (   #00019770' TO DFHEIV0
 21096     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21097     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21098     MOVE X'2020233030303139373730' TO DFHEIV0(25:11)
 21099     CALL 'kxdfhei1' USING DFHEIV0,
 21100           CERT-ID,
 21101           CERTIFICATE-MASTER,
 21102           DFHEIV11,
 21103           ELCERT-KEY,
 21104           DFHEIV99,
 21105           DFHEIV99,
 21106           DFHEIV99
 21107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21108
 21109
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 389
* EL050.cbl
 21110 8590-EXIT.
 21111     EXIT.
 21112
 21113 8690-READ-CERT-MASTER-UCL.
 21114
 21115* EXEC CICS HANDLE CONDITION
 21116*         NOTFND    (8700-READ-CERT-MASTER)
 21117*    END-EXEC.
 21118*    MOVE '"$I                   ! = #00019781' TO DFHEIV0
 21119     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21121     MOVE X'3D20233030303139373831' TO DFHEIV0(25:11)
 21122     CALL 'kxdfhei1' USING DFHEIV0
 21123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21124
 21125
 21126 8690-READ-CERT-CONT.
 21127
 21128* EXEC CICS READ
 21129*        DATASET     (CERT-ID)
 21130*        INTO        (CERTIFICATE-MASTER)
 21131*        RIDFLD      (ELCERT-KEY)
 21132*        UPDATE
 21133*    END-EXEC.
 21134     MOVE LENGTH OF
 21135      CERTIFICATE-MASTER
 21136       TO DFHEIV11
 21137*    MOVE '&"IL       EU         (   #00019786' TO DFHEIV0
 21138     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21139     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21140     MOVE X'2020233030303139373836' TO DFHEIV0(25:11)
 21141     CALL 'kxdfhei1' USING DFHEIV0,
 21142           CERT-ID,
 21143           CERTIFICATE-MASTER,
 21144           DFHEIV11,
 21145           ELCERT-KEY,
 21146           DFHEIV99,
 21147           DFHEIV99,
 21148           DFHEIV99
 21149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21150
 21151
 21152     GO TO 8590-EXIT.
 21153
 21154 8700-READ-CERT-MASTER.
 21155     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21156     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21157
 21158* EXEC CICS HANDLE CONDITION
 21159*         DUPKEY    (8720-COMP-ACCOUNTS)
 21160*         ENDFILE   (8730-END-BROWSE)
 21161*         NOTFND    (8740-NOT-FOUND)
 21162*    END-EXEC.
 21163*    MOVE '"$$''I                 ! > #00019798' TO DFHEIV0
 21164     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21166     MOVE X'3E20233030303139373938' TO DFHEIV0(25:11)
 21167     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 390
* EL050.cbl
 21168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21169
 21170
 21171
 21172* EXEC CICS STARTBR
 21173*        DATASET     ('ELCERT5')
 21174*        RIDFLD      (ELCERT2-KEY)
 21175*        EQUAL
 21176*    END-EXEC.
 21177     MOVE 'ELCERT5' TO DFHEIV1
 21178     MOVE 0
 21179       TO DFHEIV11
 21180*    MOVE '&,         E          &   #00019804' TO DFHEIV0
 21181     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21182     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21183     MOVE X'2020233030303139383034' TO DFHEIV0(25:11)
 21184     CALL 'kxdfhei1' USING DFHEIV0,
 21185           DFHEIV1,
 21186           ELCERT2-KEY,
 21187           DFHEIV99,
 21188           DFHEIV11,
 21189           DFHEIV99
 21190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21191
 21192
 21193 8710-READ-NEXT.
 21194
 21195* EXEC CICS READNEXT
 21196*        DATASET     ('ELCERT5')
 21197*        INTO        (CERTIFICATE-MASTER)
 21198*        RIDFLD      (ELCERT2-KEY)
 21199*    END-EXEC.
 21200     MOVE LENGTH OF
 21201      CERTIFICATE-MASTER
 21202       TO DFHEIV12
 21203     MOVE 'ELCERT5' TO DFHEIV1
 21204     MOVE 0
 21205       TO DFHEIV11
 21206*    MOVE '&.IL                  )   #00019811' TO DFHEIV0
 21207     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21208     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21209     MOVE X'2020233030303139383131' TO DFHEIV0(25:11)
 21210     CALL 'kxdfhei1' USING DFHEIV0,
 21211           DFHEIV1,
 21212           CERTIFICATE-MASTER,
 21213           DFHEIV12,
 21214           ELCERT2-KEY,
 21215           DFHEIV99,
 21216           DFHEIV11,
 21217           DFHEIV99,
 21218           DFHEIV99
 21219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21220
 21221
 21222 8720-COMP-ACCOUNTS.
 21223
 21224* EXEC CICS ENTER
 21225*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 391
* EL050.cbl
 21226*         FROM (PB-C-LAST-NAME)
 21227*    END-EXEC.
 21228     MOVE 001
 21229       TO DFHEIV11
 21230*    MOVE ':$F                   %   #00019818' TO DFHEIV0
 21231     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21232     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21233     MOVE X'2020233030303139383138' TO DFHEIV0(25:11)
 21234     CALL 'kxdfhei1' USING DFHEIV0,
 21235           DFHEIV11,
 21236           PB-C-LAST-NAME,
 21237           DFHEIV99,
 21238           DFHEIV99
 21239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21240
 21241
 21242
 21243* EXEC CICS ENTER
 21244*         TRACEID (002)
 21245*         FROM (CM-INSURED-LAST-NAME)
 21246*    END-EXEC.
 21247     MOVE 002
 21248       TO DFHEIV11
 21249*    MOVE ':$F                   %   #00019823' TO DFHEIV0
 21250     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21251     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21252     MOVE X'2020233030303139383233' TO DFHEIV0(25:11)
 21253     CALL 'kxdfhei1' USING DFHEIV0,
 21254           DFHEIV11,
 21255           CM-INSURED-LAST-NAME,
 21256           DFHEIV99,
 21257           DFHEIV99
 21258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21259
 21260
 21261     IF PB-CERT-NO NOT = CM-CERT-NO
 21262         GO TO 8730-END-BROWSE.
 21263
 21264     IF PB-ACCOUNT = CM-ACCOUNT
 21265         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21266             MOVE ER-2799        TO WS-ERROR
 21267             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21268             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21269             GO TO 8730-END-BROWSE.
 21270
 21271     GO TO 8710-READ-NEXT.
 21272
 21273 8730-END-BROWSE.
 21274
 21275* EXEC CICS ENDBR
 21276*         DATASET    ('ELCERT5')
 21277*    END-EXEC.
 21278     MOVE 'ELCERT5' TO DFHEIV1
 21279     MOVE 0
 21280       TO DFHEIV11
 21281*    MOVE '&2                    $   #00019841' TO DFHEIV0
 21282     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21283     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 392
* EL050.cbl
 21284     MOVE X'2020233030303139383431' TO DFHEIV0(25:11)
 21285     CALL 'kxdfhei1' USING DFHEIV0,
 21286           DFHEIV1,
 21287           DFHEIV11,
 21288           DFHEIV99
 21289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21290
 21291
 21292 8740-NOT-FOUND.
 21293     GO TO 0299-CERT-NOT-FOUND.
 21294
 21295 8750-START-ELSTAT.
 21296
 21297* EXEC CICS STARTBR
 21298*       DATASET   (STAT-ID)
 21299*       RIDFLD    (ELSTAT-KEY)
 21300*       GTEQ
 21301*       RESP      (WS-RESPONSE)
 21302*    END-EXEC
 21303     MOVE 0
 21304       TO DFHEIV11
 21305*    MOVE '&,         G          &  N#00019849' TO DFHEIV0
 21306     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21307     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21308     MOVE X'204E233030303139383439' TO DFHEIV0(25:11)
 21309     CALL 'kxdfhei1' USING DFHEIV0,
 21310           STAT-ID,
 21311           ELSTAT-KEY,
 21312           DFHEIV99,
 21313           DFHEIV11,
 21314           DFHEIV99
 21315     MOVE EIBRESP  TO WS-RESPONSE
 21316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21317     IF WS-RESP-NORMAL
 21318        MOVE 'Y'                 TO STAT-MASTER-SW
 21319     ELSE
 21320        MOVE 'N'                 TO STAT-MASTER-SW
 21321     END-IF
 21322     .
 21323 8750-EXIT.
 21324     EXIT.
 21325 8752-READ-ELSTAT.
 21326
 21327* EXEC CICS READNEXT
 21328*       DATASET   (STAT-ID)
 21329*       RIDFLD    (ELSTAT-KEY)
 21330*       INTO      (STATE-FILE)
 21331*       RESP      (WS-RESPONSE)
 21332*    END-EXEC
 21333     MOVE LENGTH OF
 21334      STATE-FILE
 21335       TO DFHEIV12
 21336     MOVE 0
 21337       TO DFHEIV11
 21338*    MOVE '&.IL                  )  N#00019864' TO DFHEIV0
 21339     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21340     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21341     MOVE X'204E233030303139383634' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 393
* EL050.cbl
 21342     CALL 'kxdfhei1' USING DFHEIV0,
 21343           STAT-ID,
 21344           STATE-FILE,
 21345           DFHEIV12,
 21346           ELSTAT-KEY,
 21347           DFHEIV99,
 21348           DFHEIV11,
 21349           DFHEIV99,
 21350           DFHEIV99
 21351     MOVE EIBRESP  TO WS-RESPONSE
 21352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21353     IF WS-RESP-NORMAL
 21354        MOVE 'Y'                 TO STAT-MASTER-SW
 21355     ELSE
 21356        MOVE 'N'                 TO STAT-MASTER-SW
 21357     END-IF
 21358     .
 21359 8752-EXIT.
 21360     EXIT.
 21361 8800-GET-COMP-RATE.
 21362     MOVE +1 TO IB.
 21363     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21364         ADD +9 TO IB
 21365         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21366             ADD +9 TO IB
 21367             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21368                MOVE ZEROS       TO WS-WK-RATE
 21369                GO TO 8800-EXIT.
 21370
 21371     IF PB-I-AGE GREATER CT-AGE (1)
 21372         ADD +3 TO IB
 21373         IF PB-I-AGE GREATER CT-AGE (2)
 21374             ADD +3 TO IB
 21375             IF PB-I-AGE GREATER CT-AGE (3)
 21376                MOVE ZEROS       TO WS-WK-RATE
 21377                GO TO 8800-EXIT.
 21378
 21379     IF WS-WORK-TERM GREATER CT-TRM (1)
 21380         ADD +1 TO IB
 21381         IF WS-WORK-TERM GREATER CT-TRM (2)
 21382             ADD +1 TO IB
 21383             IF WS-WORK-TERM GREATER CT-TRM (3)
 21384                MOVE ZEROS       TO WS-WK-RATE
 21385                GO TO 8800-EXIT.
 21386
 21387     IF CT-RT (IB) NOT NUMERIC
 21388         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21389         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21390         GO TO 8800-GET-COMP-RATE.
 21391
 21392     MOVE CT-RT (IB) TO WS-WK-RATE.
 21393
 21394 8800-EXIT.
 21395     EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 394
* EL050.cbl
 21397 8900-ADDRESS-FILE.
 21398     IF ERACCT-FILE-ADDRESSED
 21399         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21400         GO TO 8900-ADDRESS-EXIT.
 21401
 21402     IF ELCNTL-FILE-ADDRESSED
 21403         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21404         GO TO 8900-ADDRESS-EXIT.
 21405
 21406     IF ERPLAN-FILE-ADDRESSED
 21407         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21408         GO TO 8900-ADDRESS-EXIT.
 21409
 21410     IF ERFORM-FILE-ADDRESSED
 21411         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21412         GO TO 8900-ADDRESS-EXIT.
 21413
 21414 8900-ADDRESS-EXIT.
 21415     EXIT.
 21416
 21417 9000-READ-CONTROL.
 21418
 21419* EXEC CICS HANDLE CONDITION
 21420*        NOTFND    (9000-NOTFND)
 21421*    END-EXEC.
 21422*    MOVE '"$I                   ! ? #00019935' TO DFHEIV0
 21423     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21424     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21425     MOVE X'3F20233030303139393335' TO DFHEIV0(25:11)
 21426     CALL 'kxdfhei1' USING DFHEIV0
 21427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21428
 21429
 21430
 21431* EXEC CICS READ
 21432*        DATASET     (CNTL-ID)
 21433*        SET         (ADDRESS OF CONTROL-FILE)
 21434*        RIDFLD      (ELCNTL-KEY)
 21435*        GTEQ
 21436*    END-EXEC.
 21437*    MOVE '&"S        G          (   #00019939' TO DFHEIV0
 21438     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21439     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21440     MOVE X'2020233030303139393339' TO DFHEIV0(25:11)
 21441     CALL 'kxdfhei1' USING DFHEIV0,
 21442           CNTL-ID,
 21443           DFHEIV20,
 21444           DFHEIV99,
 21445           ELCNTL-KEY,
 21446           DFHEIV99,
 21447           DFHEIV99,
 21448           DFHEIV99
 21449     SET ADDRESS OF CONTROL-FILE TO
 21450         DFHEIV20
 21451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21452
 21453
 21454     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 395
* EL050.cbl
 21455
 21456 9000-NOTFND.
 21457     IF RC-SW-1 = '1'
 21458        MOVE ER-2616              TO WS-ERROR
 21459        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21460        GO TO 9000-EXIT.
 21461
 21462     IF RC-SW-1 = '2'
 21463        MOVE ER-2602              TO WS-ERROR
 21464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21465
 21466 9000-EXIT.
 21467      EXIT.
 21468
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 396
* EL050.cbl
 21470 9100-READ-CONTROL.
 21471
 21472* EXEC CICS HANDLE CONDITION
 21473*        NOTFND  (9100-NOTFND)
 21474*        ENDFILE (9100-NOTFND)
 21475*    END-EXEC.
 21476*    MOVE '"$I''                  ! @ #00019963' TO DFHEIV0
 21477     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21479     MOVE X'4020233030303139393633' TO DFHEIV0(25:11)
 21480     CALL 'kxdfhei1' USING DFHEIV0
 21481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21482
 21483
 21484
 21485* EXEC CICS READ
 21486*        DATASET     (CNTL-ID)
 21487*        INTO        (CONTROL-FILE)
 21488*        RIDFLD      (ELCNTL-KEY)
 21489*        GTEQ
 21490*    END-EXEC.
 21491     MOVE LENGTH OF
 21492      CONTROL-FILE
 21493       TO DFHEIV11
 21494*    MOVE '&"IL       G          (   #00019968' TO DFHEIV0
 21495     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21497     MOVE X'2020233030303139393638' TO DFHEIV0(25:11)
 21498     CALL 'kxdfhei1' USING DFHEIV0,
 21499           CNTL-ID,
 21500           CONTROL-FILE,
 21501           DFHEIV11,
 21502           ELCNTL-KEY,
 21503           DFHEIV99,
 21504           DFHEIV99,
 21505           DFHEIV99
 21506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21507
 21508
 21509     GO TO 9100-EXIT.
 21510
 21511 9100-NOTFND.
 21512     IF RC-SW-2 = '0'
 21513        MOVE '1'                  TO STATE-RECORD-ERROR
 21514        GO TO 9100-EXIT
 21515     END-IF
 21516     IF RC-SW-2 = '1'
 21517        MOVE '1'                  TO LF-BENEFIT-ERROR
 21518        MOVE ER-2604              TO WS-ERROR
 21519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21520        GO TO 9100-EXIT.
 21521
 21522     IF RC-SW-2 = '2'
 21523        MOVE '1'                  TO AH-BENEFIT-ERROR
 21524        MOVE ER-2605              TO WS-ERROR
 21525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21526        GO TO 9100-EXIT.
 21527
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 397
* EL050.cbl
 21528     IF RC-SW-2 = '3'
 21529         MOVE ER-2603           TO WS-ERROR
 21530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21531         GO TO 9100-EXIT.
 21532
 21533     IF RC-SW-2 = '4'
 21534         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21535         GO TO 9100-EXIT.
 21536
 21537     IF RC-SW-2 = '5'
 21538         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21539         IF WS-AH-INPUT-CD-1 = SPACE
 21540             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21541         ELSE
 21542             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21543
 21544 9100-EXIT.
 21545      EXIT.
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 398
* EL050.cbl
 21547 9200-CONTROL-GETMAIN.
 21548
 21549* EXEC CICS GETMAIN
 21550*         LENGTH   (750)
 21551*         SET      (ADDRESS OF CONTROL-FILE)
 21552*    END-EXEC.
 21553     MOVE 750
 21554       TO DFHEIV11
 21555*    MOVE '," L                  $   #00020014' TO DFHEIV0
 21556     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21558     MOVE X'2020233030303230303134' TO DFHEIV0(25:11)
 21559     CALL 'kxdfhei1' USING DFHEIV0,
 21560           DFHEIV20,
 21561           DFHEIV11,
 21562           DFHEIV99
 21563     SET ADDRESS OF CONTROL-FILE TO
 21564         DFHEIV20
 21565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21566
 21567
 21568     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21569
 21570 9200-EXIT.
 21571     EXIT.
 21572
 21573 9250-UNLOCK-RETURN.
 21574
 21575* EXEC CICS UNLOCK
 21576*        DATASET   (CERT-ID)
 21577*    END-EXEC.
 21578*    MOVE '&*                    #   #00020025' TO DFHEIV0
 21579     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21580     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21581     MOVE X'2020233030303230303235' TO DFHEIV0(25:11)
 21582     CALL 'kxdfhei1' USING DFHEIV0,
 21583           CERT-ID,
 21584           DFHEIV99
 21585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21586
 21587
 21588 9300-ABEND.
 21589     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21590
 21591
 21592* EXEC CICS LINK
 21593*        PROGRAM   ('EL004')
 21594*        COMMAREA  (WS-ERROR-LINE)
 21595*        LENGTH    (72)
 21596*    END-EXEC.
 21597     MOVE 'EL004' TO DFHEIV1
 21598     MOVE 72
 21599       TO DFHEIV11
 21600*    MOVE '."C                   (   #00020032' TO DFHEIV0
 21601     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21602     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21603     MOVE X'2020233030303230303332' TO DFHEIV0(25:11)
 21604     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 399
* EL050.cbl
 21605           DFHEIV1,
 21606           WS-ERROR-LINE,
 21607           DFHEIV11,
 21608           DFHEIV99,
 21609           DFHEIV99,
 21610           DFHEIV99,
 21611           DFHEIV99
 21612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21613
 21614
 21615     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21616
 21617
 21618* EXEC CICS ABEND
 21619*        ABCODE ('EL50')
 21620*    END-EXEC.
 21621     MOVE 'EL50' TO DFHEIV5
 21622*    MOVE '.,A                   "   #00020040' TO DFHEIV0
 21623     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21624     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21625     MOVE X'2020233030303230303430' TO DFHEIV0(25:11)
 21626     CALL 'kxdfhei1' USING DFHEIV0,
 21627           DFHEIV5
 21628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21629
 21630
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 400
* EL050.cbl
 21632
 21633******************************************************************
 21634*                                                                *
 21635*            E R R O R   F O R M A T   R O U T I N E             *
 21636*                                                                *
 21637******************************************************************
 21638
 21639 9900-ERROR-FORMAT.
 21640
 21641     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21642                    PB-COMMON-ERROR (2) OR
 21643                    PB-COMMON-ERROR (3) OR
 21644                    PB-COMMON-ERROR (4) OR
 21645                    PB-COMMON-ERROR (5) OR
 21646                    PB-COMMON-ERROR (6) OR
 21647                    PB-COMMON-ERROR (7) OR
 21648                    PB-COMMON-ERROR (8) OR
 21649                    PB-COMMON-ERROR (9) OR
 21650                    PB-COMMON-ERROR (10)
 21651        GO TO 9900-EXIT.
 21652
 21653     IF PB-NO-OF-ERRORS = +10
 21654        GO TO 9900-EXIT.
 21655
 21656     ADD +1  TO PB-NO-OF-ERRORS.
 21657     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21658                                       (PB-NO-OF-ERRORS).
 21659 9900-EXIT.
 21660     EXIT.
 21661
 21662 9990-RETURN.
 21663     IF BROWSE-STARTED
 21664
 21665* EXEC CICS ENDBR
 21666*            DATASET  (ACCT-ID)
 21667*       END-EXEC.
 21668     MOVE 0
 21669       TO DFHEIV11
 21670*    MOVE '&2                    $   #00020077' TO DFHEIV0
 21671     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21672     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21673     MOVE X'2020233030303230303737' TO DFHEIV0(25:11)
 21674     CALL 'kxdfhei1' USING DFHEIV0,
 21675           ACCT-ID,
 21676           DFHEIV11,
 21677           DFHEIV99
 21678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21679
 21680
 21681 9990-EXIT.
 21682     EXIT.
 21683
 21684
 21685****Check for CRTO record, add one if not found.
 21686 9991-CHECK-FOR-ELCRTO.
 21687
 21688* EXEC CICS HANDLE CONDITION
 21689*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 401
* EL050.cbl
 21690*         ENDFILE (9991-CRTO-NOT-FOUND)
 21691*     END-EXEC.
 21692*    MOVE '"$I''                  ! A #00020087' TO DFHEIV0
 21693     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21695     MOVE X'4120233030303230303837' TO DFHEIV0(25:11)
 21696     CALL 'kxdfhei1' USING DFHEIV0
 21697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21698
 21699     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21700     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21701     MOVE +0                     TO ELCRTO-SEQ-NO
 21702
 21703
 21704* EXEC CICS READ
 21705*       DATASET   ('ELCRTO')
 21706*       INTO      (ORIGINAL-CERTIFICATE)
 21707*       RIDFLD    (ELCRTO-KEY)
 21708*       GTEQ
 21709*       RESP      (WS-RESPONSE)
 21710*    END-EXEC
 21711     MOVE LENGTH OF
 21712      ORIGINAL-CERTIFICATE
 21713       TO DFHEIV11
 21714     MOVE 'ELCRTO' TO DFHEIV1
 21715*    MOVE '&"IL       G          (  N#00020095' TO DFHEIV0
 21716     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21718     MOVE X'204E233030303230303935' TO DFHEIV0(25:11)
 21719     CALL 'kxdfhei1' USING DFHEIV0,
 21720           DFHEIV1,
 21721           ORIGINAL-CERTIFICATE,
 21722           DFHEIV11,
 21723           ELCRTO-KEY,
 21724           DFHEIV99,
 21725           DFHEIV99,
 21726           DFHEIV99
 21727     MOVE EIBRESP  TO WS-RESPONSE
 21728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21729
 21730     IF WS-RESP-NORMAL
 21731        AND (OC-CONTROL-PRIMARY (1:33) =
 21732                 PB-CONTROL-BY-ACCOUNT (1:33))
 21733        AND (OC-RECORD-TYPE =  'I')
 21734           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21735               GO TO 9991-CHECK-INDICATORS
 21736           ELSE
 21737               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21738               GO TO 9991-CRTO-ADD-REC
 21739           END-IF
 21740     END-IF.
 21741
 21742 9991-CRTO-NOT-FOUND.
 21743
 21744     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21745     MOVE 'OC'                TO OC-RECORD-ID
 21746     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21747                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 402
* EL050.cbl
 21748     MOVE +4096               TO OC-KEY-SEQ-NO.
 21749
 21750 9991-CRTO-ADD-REC.
 21751
 21752     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21753     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21754     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21755     MOVE 'I'                 TO OC-RECORD-TYPE
 21756     IF PB-ISSUE
 21757         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21758         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21759         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21760         MOVE PB-I-AGE               TO OC-INS-AGE
 21761         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21762         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21763         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21764         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21765         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21766         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21767         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21768         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21769         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21770         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21771         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21772         IF PB-I-JOINT-COMMISSION > +0
 21773             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21774         ELSE
 21775             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21776         END-IF
 21777         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21778         MOVE +0                     TO OC-LF-CANCEL-AMT
 21779                                        OC-LF-ITD-CANCEL-AMT
 21780         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21781         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21782         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21783         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21784         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21785         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21786         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21787         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21788         MOVE +0                     TO OC-AH-CANCEL-AMT
 21789                                        OC-AH-ITD-CANCEL-AMT
 21790         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21791         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21792         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21793     ELSE
 21794         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21795         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21796         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21797         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21798         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21799         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21800         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21801         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21802         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21803          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21804             MOVE SPACES             TO OC-LF-BENCD
 21805             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 403
* EL050.cbl
 21806                                        OC-LF-BEN-AMT
 21807                                        OC-LF-PRM-AMT
 21808                                        OC-LF-ALT-BEN-AMT
 21809                                        OC-LF-ALT-PRM-AMT
 21810                                        OC-LF-COMM-PCT
 21811                                        OC-LF-CANCEL-AMT
 21812             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21813             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21814         ELSE
 21815             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21816             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21817             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21818             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21819             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21820             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21821             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21822             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21823             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21824             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21825         END-IF
 21826         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21827         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21828          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21829             MOVE SPACES             TO OC-AH-BENCD
 21830             MOVE ZEROS              TO OC-AH-TERM
 21831                                        OC-AH-BEN-AMT
 21832                                        OC-AH-PRM-AMT
 21833                                        OC-AH-COMM-PCT
 21834                                        OC-AH-CANCEL-AMT
 21835                                        OC-AH-CP
 21836             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21837             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21838         ELSE
 21839             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21840             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21841             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21842             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21843             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21844             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21845             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21846             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21847             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21848         END-IF
 21849         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21850         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21851         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21852         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21853     END-IF
 21854     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21855
 21856     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21857
 21858
 21859* EXEC CICS READ
 21860*         DATASET   (FILE-ERMAIL)
 21861*         RIDFLD    (MA-CONTROL-PRIMARY)
 21862*         INTO      (MAILING-DATA)
 21863*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 404
* EL050.cbl
 21864*    END-EXEC
 21865     MOVE LENGTH OF
 21866      MAILING-DATA
 21867       TO DFHEIV11
 21868*    MOVE '&"IL       E          (  N#00020231' TO DFHEIV0
 21869     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21871     MOVE X'204E233030303230323331' TO DFHEIV0(25:11)
 21872     CALL 'kxdfhei1' USING DFHEIV0,
 21873           FILE-ERMAIL,
 21874           MAILING-DATA,
 21875           DFHEIV11,
 21876           MA-CONTROL-PRIMARY,
 21877           DFHEIV99,
 21878           DFHEIV99,
 21879           DFHEIV99
 21880     MOVE EIBRESP  TO WS-RESPONSE
 21881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21882
 21883     IF WS-RESP-NORMAL
 21884         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21885     END-IF.
 21886
 21887     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21888     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21889
 21890
 21891* EXEC CICS READ
 21892*         DATASET  (CRTT-ID)
 21893*         RIDFLD   (WS-ELCRTT-KEY)
 21894*         INTO     (CERTIFICATE-TRAILERS)
 21895*         RESP     (WS-RESPONSE)
 21896*    END-EXEC
 21897     MOVE LENGTH OF
 21898      CERTIFICATE-TRAILERS
 21899       TO DFHEIV11
 21900*    MOVE '&"IL       E          (  N#00020245' TO DFHEIV0
 21901     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21903     MOVE X'204E233030303230323435' TO DFHEIV0(25:11)
 21904     CALL 'kxdfhei1' USING DFHEIV0,
 21905           CRTT-ID,
 21906           CERTIFICATE-TRAILERS,
 21907           DFHEIV11,
 21908           WS-ELCRTT-KEY,
 21909           DFHEIV99,
 21910           DFHEIV99,
 21911           DFHEIV99
 21912     MOVE EIBRESP  TO WS-RESPONSE
 21913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21914
 21915     IF WS-RESP-NORMAL
 21916         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21917         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21918     END-IF.
 21919
 21920
 21921* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 405
* EL050.cbl
 21922*       DATASET   ('ELCRTO')
 21923*       FROM      (ORIGINAL-CERTIFICATE)
 21924*       RIDFLD    (OC-CONTROL-PRIMARY)
 21925*       RESP      (WS-RESPONSE)
 21926*    END-EXEC.
 21927     MOVE LENGTH OF
 21928      ORIGINAL-CERTIFICATE
 21929       TO DFHEIV11
 21930     MOVE 'ELCRTO' TO DFHEIV1
 21931*    MOVE '&$ L                  ''  N#00020257' TO DFHEIV0
 21932     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21933     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21934     MOVE X'204E233030303230323537' TO DFHEIV0(25:11)
 21935     CALL 'kxdfhei1' USING DFHEIV0,
 21936           DFHEIV1,
 21937           ORIGINAL-CERTIFICATE,
 21938           DFHEIV11,
 21939           OC-CONTROL-PRIMARY,
 21940           DFHEIV99,
 21941           DFHEIV99
 21942     MOVE EIBRESP  TO WS-RESPONSE
 21943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21944
 21945
 21946     GO TO 9991-EXIT.
 21947
 21948 9991-CHECK-INDICATORS.
 21949
 21950     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21951         GO TO 9991-EXIT
 21952     END-IF.
 21953
 21954     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21955         GO TO 9991-EXIT
 21956     END-IF.
 21957
 21958
 21959* EXEC CICS READ
 21960*       DATASET   ('ELCRTO')
 21961*       INTO      (ORIGINAL-CERTIFICATE)
 21962*       RIDFLD    (OC-CONTROL-PRIMARY)
 21963*       UPDATE
 21964*       RESP      (WS-RESPONSE)
 21965*    END-EXEC
 21966     MOVE LENGTH OF
 21967      ORIGINAL-CERTIFICATE
 21968       TO DFHEIV11
 21969     MOVE 'ELCRTO' TO DFHEIV1
 21970*    MOVE '&"IL       EU         (  N#00020276' TO DFHEIV0
 21971     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21972     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21973     MOVE X'204E233030303230323736' TO DFHEIV0(25:11)
 21974     CALL 'kxdfhei1' USING DFHEIV0,
 21975           DFHEIV1,
 21976           ORIGINAL-CERTIFICATE,
 21977           DFHEIV11,
 21978           OC-CONTROL-PRIMARY,
 21979           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 406
* EL050.cbl
 21980           DFHEIV99,
 21981           DFHEIV99
 21982     MOVE EIBRESP  TO WS-RESPONSE
 21983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21984     IF WS-RESP-NORMAL
 21985        IF PB-ISSUE
 21986          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21987          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21988          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21989          MOVE PB-I-AGE               TO OC-INS-AGE
 21990          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21991          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21992          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21993          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21994          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21995          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21996          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21997          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21998          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21999          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22000          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22001          IF PB-I-JOINT-COMMISSION > +0
 22002              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22003          ELSE
 22004              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22005          END-IF
 22006          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22007          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22008          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22009          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22010          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22011          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22012          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22013          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22014          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22015
 22016          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22017
 22018* EXEC CICS READ
 22019*             DATASET   (FILE-ERMAIL)
 22020*             RIDFLD    (MA-CONTROL-PRIMARY)
 22021*             INTO      (MAILING-DATA)
 22022*             RESP      (WS-RESPONSE)
 22023*         END-EXEC
 22024     MOVE LENGTH OF
 22025      MAILING-DATA
 22026       TO DFHEIV11
 22027*    MOVE '&"IL       E          (  N#00020316' TO DFHEIV0
 22028     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22030     MOVE X'204E233030303230333136' TO DFHEIV0(25:11)
 22031     CALL 'kxdfhei1' USING DFHEIV0,
 22032           FILE-ERMAIL,
 22033           MAILING-DATA,
 22034           DFHEIV11,
 22035           MA-CONTROL-PRIMARY,
 22036           DFHEIV99,
 22037           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 407
* EL050.cbl
 22038           DFHEIV99
 22039     MOVE EIBRESP  TO WS-RESPONSE
 22040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22041          IF WS-RESP-NORMAL
 22042             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22043          END-IF
 22044
 22045          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22046          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22047
 22048* EXEC CICS READ
 22049*             DATASET  (CRTT-ID)
 22050*             RIDFLD   (WS-ELCRTT-KEY)
 22051*             INTO     (CERTIFICATE-TRAILERS)
 22052*             RESP     (WS-RESPONSE)
 22053*         END-EXEC
 22054     MOVE LENGTH OF
 22055      CERTIFICATE-TRAILERS
 22056       TO DFHEIV11
 22057*    MOVE '&"IL       E          (  N#00020328' TO DFHEIV0
 22058     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22060     MOVE X'204E233030303230333238' TO DFHEIV0(25:11)
 22061     CALL 'kxdfhei1' USING DFHEIV0,
 22062           CRTT-ID,
 22063           CERTIFICATE-TRAILERS,
 22064           DFHEIV11,
 22065           WS-ELCRTT-KEY,
 22066           DFHEIV99,
 22067           DFHEIV99,
 22068           DFHEIV99
 22069     MOVE EIBRESP  TO WS-RESPONSE
 22070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22071          IF WS-RESP-NORMAL
 22072             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22073                               OC-INS-AGE-DEFAULT-FLAG
 22074             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22075                               OC-JNT-AGE-DEFAULT-FLAG
 22076          END-IF
 22077
 22078        ELSE
 22079          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22080             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22081             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22082             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22083          END-IF
 22084          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22085             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22086             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22087             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22088          END-IF
 22089          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22090        END-IF
 22091
 22092* EXEC CICS REWRITE
 22093*          DATASET   ('ELCRTO')
 22094*          FROM      (ORIGINAL-CERTIFICATE)
 22095*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 408
* EL050.cbl
 22096*       END-EXEC
 22097     MOVE LENGTH OF
 22098      ORIGINAL-CERTIFICATE
 22099       TO DFHEIV11
 22100     MOVE 'ELCRTO' TO DFHEIV1
 22101*    MOVE '&& L                  %  N#00020354' TO DFHEIV0
 22102     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22103     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22104     MOVE X'204E233030303230333534' TO DFHEIV0(25:11)
 22105     CALL 'kxdfhei1' USING DFHEIV0,
 22106           DFHEIV1,
 22107           ORIGINAL-CERTIFICATE,
 22108           DFHEIV11,
 22109           DFHEIV99
 22110     MOVE EIBRESP  TO WS-RESPONSE
 22111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22112     END-IF.
 22113
 22114 9991-EXIT.
 22115     EXIT.
 22116
 22117
 22118 9999-RETURN.
 22119     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22120
 22121
 22122* EXEC CICS RETURN
 22123*    END-EXEC.
 22124*    MOVE '.(                    ''   #00020368' TO DFHEIV0
 22125     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22126     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22127     MOVE X'2020233030303230333638' TO DFHEIV0(25:11)
 22128     CALL 'kxdfhei1' USING DFHEIV0,
 22129           DFHEIV99,
 22130           DFHEIV99,
 22131           DFHEIV99,
 22132           DFHEIV99,
 22133           DFHEIV99,
 22134           DFHEIV99
 22135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22136
 22137
 22138
 22139* GOBACK.
 22140     MOVE '9%                    "   ' TO DFHEIV0
 22141     MOVE 'EL050' TO DFHEIV1
 22142     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22143     GOBACK.
 22144
 22145 9999-DFHBACK SECTION.
 22146     MOVE '9%                    "   ' TO DFHEIV0
 22147     MOVE 'EL050' TO DFHEIV1
 22148     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22149     GOBACK.
 22150 9999-DFHEXIT.
 22151     IF DFHEIGDJ EQUAL 0001
 22152         NEXT SENTENCE
 22153     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 409
* EL050.cbl
 22154         GO TO 9300-ABEND,
 22155               3990-FILES-NOT-OPEN
 22156         DEPENDING ON DFHEIGDI
 22157     ELSE IF DFHEIGDJ EQUAL 3
 22158         GO TO 6610-START-BROWSE,
 22159               6630-ERRESS-PROBLEM,
 22160               6630-END-OF-FILE
 22161         DEPENDING ON DFHEIGDI
 22162     ELSE IF DFHEIGDJ EQUAL 4
 22163         GO TO 6630-END-OF-FILE,
 22164               6630-ERRESS-PROBLEM,
 22165               6630-ERRESS-PROBLEM,
 22166               6630-END-OF-FILE
 22167         DEPENDING ON DFHEIGDI
 22168     ELSE IF DFHEIGDJ EQUAL 5
 22169         GO TO 6630-END-OF-FILE,
 22170               6630-END-OF-FILE,
 22171               6630-ERRESS-PROBLEM,
 22172               6630-ERRESS-PROBLEM
 22173         DEPENDING ON DFHEIGDI
 22174     ELSE IF DFHEIGDJ EQUAL 6
 22175         GO TO 6660-START-BROWSE,
 22176               6690-ERRESC-PROBLEM,
 22177               6690-ERRESC-PROBLEM,
 22178               6690-END-OF-FILE
 22179         DEPENDING ON DFHEIGDI
 22180     ELSE IF DFHEIGDJ EQUAL 7
 22181         GO TO 6690-END-OF-FILE,
 22182               6690-ERRESC-PROBLEM,
 22183               6690-ERRESC-PROBLEM,
 22184               6690-END-OF-FILE
 22185         DEPENDING ON DFHEIGDI
 22186     ELSE IF DFHEIGDJ EQUAL 8
 22187         GO TO 6690-END-OF-FILE,
 22188               6690-ERRESC-PROBLEM,
 22189               6690-ERRESC-PROBLEM,
 22190               6690-END-OF-FILE
 22191         DEPENDING ON DFHEIGDI
 22192     ELSE IF DFHEIGDJ EQUAL 9
 22193         GO TO 7250-CONTINUE,
 22194               7250-CONTINUE
 22195         DEPENDING ON DFHEIGDI
 22196     ELSE IF DFHEIGDJ EQUAL 10
 22197         GO TO 7300-CONTINUE,
 22198               7300-CONTINUE
 22199         DEPENDING ON DFHEIGDI
 22200     ELSE IF DFHEIGDJ EQUAL 11
 22201         GO TO 8000-FREE-MAIN
 22202         DEPENDING ON DFHEIGDI
 22203     ELSE IF DFHEIGDJ EQUAL 12
 22204         GO TO 8100-NOTFND,
 22205               8100-NOTFND
 22206         DEPENDING ON DFHEIGDI
 22207     ELSE IF DFHEIGDJ EQUAL 13
 22208         GO TO 8110-NOTFND,
 22209               8110-NOTFND
 22210         DEPENDING ON DFHEIGDI
 22211     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 410
* EL050.cbl
 22212         GO TO 8130-EXIT
 22213         DEPENDING ON DFHEIGDI
 22214     ELSE IF DFHEIGDJ EQUAL 15
 22215         GO TO 8150-exit
 22216         DEPENDING ON DFHEIGDI
 22217     ELSE IF DFHEIGDJ EQUAL 16
 22218         GO TO 8180-NOTFND
 22219         DEPENDING ON DFHEIGDI
 22220     ELSE IF DFHEIGDJ EQUAL 17
 22221         GO TO 8190-NOTFND
 22222         DEPENDING ON DFHEIGDI
 22223     ELSE IF DFHEIGDJ EQUAL 18
 22224         GO TO 8195-NOTFND
 22225         DEPENDING ON DFHEIGDI
 22226     ELSE IF DFHEIGDJ EQUAL 19
 22227         GO TO 8200-NOTFND
 22228         DEPENDING ON DFHEIGDI
 22229     ELSE IF DFHEIGDJ EQUAL 20
 22230         GO TO 8300-NOTFND,
 22231               8300-ERRESS-PROBLEM,
 22232               8300-ERRESS-PROBLEM,
 22233               8300-NOTFND
 22234         DEPENDING ON DFHEIGDI
 22235     ELSE IF DFHEIGDJ EQUAL 21
 22236         GO TO 8450-FORM-NOT-FOUND,
 22237               8450-FORM-NOT-FOUND
 22238         DEPENDING ON DFHEIGDI
 22239     ELSE IF DFHEIGDJ EQUAL 22
 22240         GO TO 0199-ACCT-NOT-FOUND,
 22241               0199-ACCT-NOT-FOUND
 22242         DEPENDING ON DFHEIGDI
 22243     ELSE IF DFHEIGDJ EQUAL 23
 22244         GO TO 0199-ACCT-NOT-FOUND,
 22245               0199-ACCT-NOT-FOUND
 22246         DEPENDING ON DFHEIGDI
 22247     ELSE IF DFHEIGDJ EQUAL 24
 22248         GO TO 8582-COMP-NOT-FOUND,
 22249               8582-COMP-NOT-FOUND
 22250         DEPENDING ON DFHEIGDI
 22251     ELSE IF DFHEIGDJ EQUAL 25
 22252         GO TO 8583-AGTC-NOT-FOUND,
 22253               8583-AGTC-NOT-FOUND
 22254         DEPENDING ON DFHEIGDI
 22255     ELSE IF DFHEIGDJ EQUAL 26
 22256         GO TO 8584-BXRF-NOT-FOUND,
 22257               8584-BXRF-NOT-FOUND
 22258         DEPENDING ON DFHEIGDI
 22259     ELSE IF DFHEIGDJ EQUAL 27
 22260         GO TO 8585-PLAN-NOT-FOUND,
 22261               8585-PLAN-NOT-FOUND
 22262         DEPENDING ON DFHEIGDI
 22263     ELSE IF DFHEIGDJ EQUAL 28
 22264         GO TO 0299-CERT-NOT-FOUND
 22265         DEPENDING ON DFHEIGDI
 22266     ELSE IF DFHEIGDJ EQUAL 29
 22267         GO TO 8700-READ-CERT-MASTER
 22268         DEPENDING ON DFHEIGDI
 22269     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 01-Sep-15 12:41 Page 411
* EL050.cbl
 22270         GO TO 8720-COMP-ACCOUNTS,
 22271               8730-END-BROWSE,
 22272               8740-NOT-FOUND
 22273         DEPENDING ON DFHEIGDI
 22274     ELSE IF DFHEIGDJ EQUAL 31
 22275         GO TO 9000-NOTFND
 22276         DEPENDING ON DFHEIGDI
 22277     ELSE IF DFHEIGDJ EQUAL 32
 22278         GO TO 9100-NOTFND,
 22279               9100-NOTFND
 22280         DEPENDING ON DFHEIGDI
 22281     ELSE IF DFHEIGDJ EQUAL 33
 22282         GO TO 9991-CRTO-NOT-FOUND,
 22283               9991-CRTO-NOT-FOUND
 22284         DEPENDING ON DFHEIGDI.
 22285     MOVE '9%                    "   ' TO DFHEIV0
 22286     MOVE 'EL050' TO DFHEIV1
 22287     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22288     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40680     Code:       90038
