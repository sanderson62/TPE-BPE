* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   1
* EL6316.cbl
* Options: int("EL6316.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6316.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6316.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6316.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6316.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   2
* EL6316.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 110410   2007070900001  PEMA  ADD REFORMATIONS AND RESCISSIONS
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 072312   2011022800001  AJRA  NAPERSOFT MISC
    28* 091812 IR2012091400003  AJRA  CHANGE MSG 9999
    29* 101512   2011022800001  AJRA  FIX CLM RESC DEFAULT
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    35* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    36* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    37*-----------------------------------------------------------------
    38*REMARKS.
    39*        TRANSACTION - EXBC - CANCEL CHANGES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   3
* EL6316.cbl
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL6316 WORKING STORAGE    *'.
    47 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    48 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    49 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    50 77  W-ARCH-NUMBER               PIC 9(8) BINARY  VALUE ZEROS.
    51 77  w-prtsw                     pic x  value spaces.
    52 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    53 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    54     88  ACCT-FOUND                 VALUE 'Y'.
    55 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    56 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    57 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    58 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    59 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    60 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    61 77  s1                          pic s999 comp-3 value +0.
    62 77  s2                          pic s999 comp-3 value +0.
    63 77  WS-REASON-SW                PIC X  VALUE ' '.
    64     88  REASONS-FOUND                  VALUE 'Y'.
    65     88  REASONS-NOT-FOUND              VALUE 'N'.
    66 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    67     88  NO-CERT-RW                 VALUE 'N'.
    68     88  CERT-RW                    VALUE 'Y'.
    69 77  WS-COMM-LENGTH              PIC 9(4) BINARY.
    70 01  P pointer.
    71 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    72 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    73 01  var-ptr pointer.
    74 01  env-var-len                 pic 9(4)  binary.
    75 01  rc                          pic 9(9)  binary.
    76 01  WS-KIXHOST                  PIC X(10).
    77 01  WS-KIXSYS.
    78     05  WS-KIX-FIL1             PIC X(10).
    79     05  WS-KIX-APPS             PIC X(10).
    80     05  WS-KIX-ENV              PIC X(10).
    81     05  WS-KIX-MYENV            PIC X(10).
    82     05  WS-KIX-SYS              PIC X(10).
    83*    COPY ELCSCTM.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCTM                             *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-MESSAGE.
    94     12  FILLER                          PIC X(30)
    95            VALUE '** LOGIC SECURITY VIOLATION -'.
    96     12  SM-READ                         PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   4
* EL6316.cbl
    99     12  SM-PGM                          PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' OPR='.
   102     12  SM-PROCESSOR-ID                 PIC X(4).
   103     12  FILLER                          PIC X(6)
   104            VALUE ' TERM='.
   105     12  SM-TERMID                       PIC X(4).
   106     12  FILLER                          PIC XX   VALUE SPACE.
   107     12  SM-JUL-DATE                     PIC 9(5).
   108     12  FILLER                          PIC X    VALUE SPACE.
   109     12  SM-TIME                         PIC 99.99.
   110
   111*    COPY ELCSCRTY.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCRTY                            *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   119*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   120*        SAVED IN PI-SECURITY-ADDRESS.                           *
   121*                                                                *
   122******************************************************************
   123 01  SECURITY-CONTROL.
   124     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   125     12  FILLER                       PIC XX    VALUE 'SC'.
   126     12  SC-CREDIT-CODES.
   127         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   128             20  SC-CREDIT-DISPLAY    PIC X.
   129             20  SC-CREDIT-UPDATE     PIC X.
   130     12  SC-CLAIMS-CODES.
   131         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   132             20  SC-CLAIMS-DISPLAY    PIC X.
   133             20  SC-CLAIMS-UPDATE     PIC X.
   134 01 srch-commarea.
   135*                                copy ELCADLTRSPI.
   136******************************************************************
   137*                   C H A N G E   L O G
   138*
   139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   140*-----------------------------------------------------------------
   141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   142* EFFECTIVE    NUMBER
   143*-----------------------------------------------------------------
   144* 060611    2011022800001  PEMA  NEW COPYBOOK
   145* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   146* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   147******************************************************************
   148****************************************
   149*  commarea for NaperSoft On Demand Admin services letters
   150*  (business logic input & output)
   151****************************************
   152     03  BL-INPUT.
   153         05  BL-DATA-SRCE        PIC X.
   154         05  BL-LETTER-ID        PIC XXXX.
   155         05  BL-CARRIER          PIC X.
   156         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   5
* EL6316.cbl
   157         05  BL-STATE            PIC XX.
   158         05  BL-ACCOUNT          PIC X(10).
   159         05  BL-EFF-DT           PIC X(10).
   160         05  BL-CERT-NO          PIC X(11).
   161         05  BL-BATCH-NO         PIC X(6).
   162         05  BL-BATCH-SEQ        PIC 9(8).
   163         05  BL-RESP-NO          PIC X(10).
   164         05  BL-NO-OF-COPIES     PIC 99.
   165         05  BL-PROC-ID          PIC XXXX.
   166         05  BL-COMP-ID          PIC XXX.
   167         05  BL-PRINT-NOW-SW     PIC X.
   168         05  BL-ENC-CD           PIC XXX.
   169         05  BL-RESEND-DT        PIC X(10).
   170         05  BL-FOLLOW-UP-DT     PIC X(10).
   171         05  BL-ARCHIVE-NO       PIC 9(8).
   172         05  BL-FUNC             PIC X(8).
   173         05  BL-COMMENTS         PIC X(100).
   174         05  FILLER REDEFINES BL-COMMENTS.
   175             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   176             10  BL-LETTER-TO-ACCT PIC X.
   177             10  BL-LETTER-TO-BENE PIC X.
   178             10  BL-WRITE-ERARCH   PIC X.
   179                 88  ERARCH-QWS      VALUE 'Q'.
   180                 88  ERARCH-BATCH    VALUE 'B'.
   181                 88  ERARCH-TEMP     VALUE 'T'.
   182             10  BL-PROCESS-TYPE PIC X(07).
   183             10  BL-CERT-FORM-ID PIC X(05).
   184             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   185             10  BL-SOURCE-SCREEN PIC X(8).
   186             10  FILLER          PIC X(25).
   187     03  BL-OUTPUT.
   188         05  BL-STATUS                   PIC X.
   189             88  BL-OK                      VALUE "P".
   190             88  BL-FAIL                  VALUE "F".
   191         05  BL-MESSAGE          PIC X(50).
   192     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   193     03  FILLER                  PIC X(31).
   194
   195*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   196*                                COPY ELCZREC.
   197******************************************************************
   198*                                                                *
   199*                                                                *
   200*                            ELCZREC.                            *
   201*                                                                *
   202*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   203*                                                                *
   204******************************************************************
   205*-----------------------------------------------------------------
   206*                   C H A N G E   L O G
   207*
   208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   209*-----------------------------------------------------------------
   210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   211* EFFECTIVE    NUMBER
   212*-----------------------------------------------------------------
   213* 122011    2011022800001  AJRA  NEW FILE
   214* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   6
* EL6316.cbl
   215* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   216*-----------------------------------------------------------------
   217 01  W-Z-CONTROL-DATA.
   218     05  W-NUMBER-OF-COPIES      PIC  9.
   219     05  FILLER                  PIC  X.
   220     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   221     05  FILLER                  PIC  X.
   222     05  W-DAYS-TO-RESEND        PIC  999.
   223     05  FILLER                  PIC  X.
   224     05  W-FORM-TO-RESEND        PIC  X(4).
   225     05  FILLER                  PIC  X.
   226     05  W-PROMPT-LETTER         PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-ENCLOSURE-CD          PIC  XXX.
   229     05  FILLER                  PIC  X.
   230     05  W-AUTO-CLOSE-IND        PIC  X.
   231     05  FILLER                  PIC  X.
   232     05  W-LETTER-TO-BENE        PIC  X.
   233     05  FILLER                  PIC  X.
   234     05  W-LETTER-TO-ACCT        PIC  X.
   235     05  FILLER                  PIC  X.
   236     05  W-LETTER-TYPE           PIC  X.
   237     05  FILLER                  PIC  X.
   238     05  W-PRINT-CERTIFICATE     PIC  X.
   239     05  FILLER                  PIC  X.
   240     05  W-REFUND-REQUIRED       PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-ONBASE-CODE           PIC  XX.
   243     05  FILLER                  PIC  X.
   244     05  W-ACCT-SUMM             PIC  X.
   245     05  FILLER                  PIC  X.
   246     05  W-CSO-SUMM              PIC  X.
   247     05  FILLER                  PIC  X.
   248     05  W-REASONS-REQUIRED      PIC  X.
   249     05  FILLER                  PIC  X(29).
   250 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   251 01  STANDARD-AREAS.
   252     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   253     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   254                                 PIC  X(08).
   255     12  QID.
   256         16  QID-TERM        PIC X(4)    VALUE SPACES.
   257         16  FILLER          PIC X(4)    VALUE '631I'.
   258     12  TIME-MT                 PIC S9(7).
   259     12  TIME-MT-R  REDEFINES TIME-MT.
   260         16  FILLER              PIC X.
   261         16  TIME-LMT            PIC 99V99.
   262         16  FILLER              PIC X(2).
   263     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   264     12  MAP-LENGTH              PIC 9(4)   VALUE 359 BINARY.
   265     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   266     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   267     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   268     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   269     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   270     12  WS-ELCERT-KEY.
   271         16  W-CERT-COMPANY-CD   PIC X.
   272         16  W-CERT-CARRIER      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   7
* EL6316.cbl
   273         16  W-CERT-GROUPING     PIC X(6).
   274         16  W-CERT-STATE        PIC XX.
   275         16  W-CERT-ACCOUNT      PIC X(10).
   276         16  W-CERT-CERT-EFF-DT  PIC XX.
   277         16  W-CERT-CERT-PRIME   PIC X(10).
   278         16  W-CERT-CERT-SFX     PIC X.
   279     12  WS-ELEOBC-KEY.
   280         16  WS-EOBC-COMPANY-CD  PIC X.
   281         16  WS-EOBC-REC-TYPE    PIC X.
   282         16  WS-EOBC-CODE        PIC X(4).
   283         16  FILLER              PIC X(9).
   284     12  WS-ERNOTE-KEY.
   285         16  W-NOTE-COMPANY-CD   PIC X.
   286         16  W-NOTE-CARRIER      PIC X.
   287         16  W-NOTE-GROUPING     PIC X(6).
   288         16  W-NOTE-STATE        PIC XX.
   289         16  W-NOTE-ACCOUNT      PIC X(10).
   290         16  W-NOTE-CERT-EFF-DT  PIC XX.
   291         16  W-NOTE-CERT-PRIME   PIC X(10).
   292         16  W-NOTE-CERT-SFX     PIC X.
   293     12  ELLETR-KEY.
   294         16  LETR-PART-KEY.
   295             20  LETR-COMPANY-CD PIC X.
   296             20  LETR-LETTER-ID  PIC X(4).
   297         16  LETR-FILLER         PIC X(8).
   298         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   299     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   300     12  ERPNDB2-KEY.
   301         16  PNDB2-COMPANY-CD    PIC X.
   302         16  PNDB2-CARRIER       PIC X.
   303         16  PNDB2-GROUPING      PIC X(6).
   304         16  PNDB2-STATE         PIC XX.
   305         16  PNDB2-ACCOUNT       PIC X(10).
   306         16  PNDB2-CERT-EFF-DT   PIC XX.
   307         16  PNDB2-CERT-PRIME    PIC X(10).
   308         16  PNDB2-CERT-SFX      PIC X.
   309         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   310         16  PNDB2-RECORD-TYPE   PIC X.
   311     12  ERENDT-KEY.
   312         16  ENDT-COMPANY-CD       PIC X.
   313         16  ENDT-CARRIER          PIC X.
   314         16  ENDT-GROUPING         PIC X(6).
   315         16  ENDT-STATE            PIC XX.
   316         16  ENDT-ACCOUNT          PIC X(10).
   317         16  ENDT-CERT-EFF-DT      PIC XX.
   318         16  ENDT-CERT-PRIME       PIC X(10).
   319         16  ENDT-CERT-SFX         PIC X.
   320         16  ENDT-RECORD-TYPE      PIC X.
   321         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   322     12  ELCRTO-KEY.
   323         16  CRTO-COMPANY-CD     PIC X.
   324         16  CRTO-CARRIER        PIC X.
   325         16  CRTO-GROUPING       PIC X(6).
   326         16  CRTO-STATE          PIC XX.
   327         16  CRTO-ACCOUNT        PIC X(10).
   328         16  CRTO-CERT-EFF-DT    PIC XX.
   329         16  CRTO-CERT-PRIME     PIC X(10).
   330         16  CRTO-CERT-SFX       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   8
* EL6316.cbl
   331         16  CRTO-RECORD-TYPE    PIC X.
   332         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   333     12  WS-ERMAIL-KEY.
   334         16  MAIL-COMPANY-CD     PIC X.
   335         16  MAIL-CARRIER        PIC X.
   336         16  MAIL-GROUPING       PIC X(6).
   337         16  MAIL-STATE          PIC XX.
   338         16  MAIL-ACCOUNT        PIC X(10).
   339         16  MAIL-CERT-EFF-DT    PIC XX.
   340         16  MAIL-CERT-PRIME     PIC X(10).
   341         16  MAIL-CERT-SFX       PIC X.
   342     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   343     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   344     12  WS-CURRENT-DT.
   345         16  FILLER              PIC X(6)    VALUE SPACES.
   346         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   347     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   348     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   349         88  CANCEL-REC            VALUE 'C'.
   350         88  ISSUE-REC             VALUE 'I'.
   351     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   352     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   353     12  ELCNTL-KEY.
   354         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   355         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   356         16  CNTL-ACCESS.
   357             20  CNTL-STATE      PIC XX    VALUE SPACES.
   358             20  FILLER          PIC X     VALUE SPACES.
   359             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   360         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   361     12  WS-ERACCT-KEY.
   362         16  ACCT-COMPANY-CD     PIC X.
   363         16  ACCT-CARRIER        PIC X.
   364         16  ACCT-GROUPING       PIC X(6).
   365         16  ACCT-STATE          PIC XX.
   366         16  ACCT-ACCOUNT        PIC X(10).
   367         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   368         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   369     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   370     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   371     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   372     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   373     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   374     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   375     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   376     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   377     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   378     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   379     12  WS-RESPONSE             PIC S9(8)   COMP.
   380         88  RESP-NORMAL                  VALUE +00.
   381         88  RESP-NOTFND                  VALUE +13.
   382         88  RESP-DUPREC                  VALUE +14.
   383         88  RESP-DUPKEY                  VALUE +15.
   384         88  RESP-NOTOPEN                 VALUE +19.
   385         88  RESP-ENDFILE                 VALUE +20.
   386     12  MAP-NAME            PIC X(8)    VALUE 'EL631I'.
   387     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6316S'.
   388     12  SCREEN-NUMBER       PIC X(4)    VALUE '631I'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   9
* EL6316.cbl
   389     12  TRANS-ID            PIC X(4)    VALUE 'EXBC'.
   390     12  THIS-PGM            PIC X(8)    VALUE 'EL6316'.
   391     12  PGM-NAME            PIC X(8).
   392     12  TIME-IN             PIC S9(7).
   393     12  TIME-OUT-R  REDEFINES TIME-IN.
   394         16  FILLER          PIC X.
   395         16  TIME-OUT        PIC 99V99.
   396         16  FILLER          PIC X(2).
   397     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   398     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   399     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   400     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   401     12  XCTL-6317           PIC X(8)    VALUE 'EL6317'.
   402     12  XCTL-6318           PIC X(8)    VALUE 'EL6318'.
   403     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   404     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   405     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   406     12  WS-PHONE.
   407         16  WS-PH1              PIC XXX.
   408         16  WS-PH2              PIC XXX.
   409         16  WS-PH3              PIC XXXX.
   410     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   411     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   412
   413     12  WS-BILLING-NOTE.
   414         16  WS-BN-NOTE          PIC X(25).
   415         16  WS-BN-LTRID         PIC X(4).
   416         16  FILLER              PIC X(3).
   417         16  WS-BN-DATE          PIC X(8).
   418         16  FILLER              PIC X(3).
   419         16  WS-BN-USERID        PIC X(4).
   420         16  FILLER              PIC X(30).
   421     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   422         16  WS-MAN-BN-NOTE      PIC X(63).
   423         16  FILLER              PIC X(14).
   424     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   425     12  NEW-ORIG-REC.
   426         16  NEW-INS-LAST-NAME             PIC X(15).
   427         16  NEW-INS-FIRST-NAME            PIC X(10).
   428         16  NEW-INS-MIDDLE-INIT           PIC X.
   429         16  NEW-INS-AGE                   PIC S999     COMP-3.
   430         16  NEW-JNT-LAST-NAME             PIC X(15).
   431         16  NEW-JNT-FIRST-NAME            PIC X(10).
   432         16  NEW-JNT-MIDDLE-INIT           PIC X.
   433         16  NEW-JNT-AGE                   PIC S999     COMP-3.
   434         16  NEW-LF-BENCD                  PIC XX.
   435         16  NEW-LF-TERM                   PIC S999      COMP-3.
   436         16  NEW-LF-BEN-AMT                PIC S9(9)V99  COMP-3.
   437         16  NEW-LF-PRM-AMT                PIC S9(7)V99  COMP-3.
   438         16  NEW-LF-ALT-BEN-AMT            PIC S9(9)V99  COMP-3.
   439         16  NEW-LF-ALT-PRM-AMT            PIC S9(7)V99  COMP-3.
   440         16  NEW-LF-EXP-DT                 PIC XX.
   441         16  NEW-LF-COMM-PCT               PIC SV9(5)    COMP-3.
   442         16  NEW-LF-CANCEL-DT              PIC XX.
   443         16  NEW-LF-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   444         16  NEW-LF-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   445         16  NEW-AH-BENCD                  PIC XX.
   446         16  NEW-AH-TERM                   PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  10
* EL6316.cbl
   447         16  NEW-AH-BEN-AMT                PIC S9(9)V99  COMP-3.
   448         16  NEW-AH-PRM-AMT                PIC S9(7)V99  COMP-3.
   449         16  NEW-AH-EXP-DT                 PIC XX.
   450         16  NEW-AH-COMM-PCT               PIC SV9(5)    COMP-3.
   451         16  NEW-AH-CP                     PIC 99.
   452         16  NEW-AH-CANCEL-DT              PIC XX.
   453         16  NEW-AH-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   454         16  NEW-AH-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   455         16  NEW-CRED-BENE-NAME            PIC X(25).
   456         16  NEW-1ST-PMT-DT                PIC XX.
   457         16  NEW-INS-AGE-DEFAULT-FLAG      PIC X.
   458         16  NEW-JNT-AGE-DEFAULT-FLAG      PIC X.
   459         16  NEW-ISSUE-TRAN-IND            PIC X.
   460         16  NEW-CANCEL-TRAN-IND           PIC X.
   461         16  FILLER                        PIC X(235).
   462
   463 01  CERT-NOTE-ENTRIES.
   464     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   465         16  CERT-NT-TEXT                PIC X(63).
   466         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   467         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   468         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   469
   470 01  ERCNOT-AREA.
   471     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   472     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   473     12  ERCNOT-KEY.
   474         16  ERCNOT-PARTIAL-KEY.
   475             20 ERCNOT-COMPANY-CD    PIC X.
   476             20 ERCNOT-CARRIER       PIC X.
   477             20 ERCNOT-GROUPING      PIC X(06).
   478             20 ERCNOT-STATE         PIC XX.
   479             20 ERCNOT-ACCOUNT       PIC X(10).
   480             20 ERCNOT-EFF-DT        PIC XX.
   481             20 ERCNOT-CERT-NO.
   482                25 ERCNOT-CERT-PRIME PIC X(10).
   483                25 ERCNOT-CERT-SFX   PIC X.
   484             20 ERCNOT-REC-TYP       PIC X.
   485         16 ERCNOT-SEQ           PIC S9(4) COMP.
   486     12  SV-PARTIAL-KEY.
   487         20 SV-COMPANY-CD            PIC X.
   488         20 SV-CARRIER               PIC X.
   489         20 SV-GROUPING              PIC X(06).
   490         20 SV-STATE                 PIC XX.
   491         20 SV-ACCOUNT               PIC X(10).
   492         20 SV-EFF-DT                PIC XX.
   493         20 SV-CERT-NO.
   494            25 SV-CERT-PRIME         PIC X(10).
   495            25 SV-CERT-SFX           PIC X(1).
   496         20 SV-REC-TYP               PIC X.
   497 01  ERROR-MESSAGES.
   498     12  ER-0000                 PIC X(4)  VALUE '0000'.
   499     12  ER-0004                 PIC X(4)  VALUE '0004'.
   500     12  ER-0008                 PIC X(4)  VALUE '0008'.
   501     12  ER-0023                 PIC X(4)  VALUE '0023'.
   502     12  ER-0029                 PIC X(4)  VALUE '0029'.
   503     12  ER-0068                 PIC X(4)  VALUE '0068'.
   504     12  ER-0132                 PIC X(4)  VALUE '0132'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  11
* EL6316.cbl
   505     12  ER-0142                 PIC X(4)  VALUE '0142'.
   506     12  ER-0148                 PIC X(4)  VALUE '0148'.
   507     12  ER-0215                 PIC X(4)  VALUE '0215'.
   508     12  ER-0280                 PIC X(4)  VALUE '0280'.
   509     12  ER-0348                 PIC X(4)  VALUE '0348'.
   510     12  ER-0419                 PIC X(4)  VALUE '0419'.
   511     12  ER-0894                 PIC X(4)  VALUE '0894'.
   512     12  ER-1101                 PIC X(4)  VALUE '1101'.
   513     12  ER-1236                 PIC X(4)  VALUE '1236'.
   514     12  ER-1818                 PIC X(4)  VALUE '1818'.
   515     12  ER-1820                 PIC X(4)  VALUE '1820'.
   516     12  ER-2056                 PIC X(4)  VALUE '2056'.
   517     12  ER-2079                 PIC X(4)  VALUE '2079'.
   518     12  ER-2208                 PIC X(4)  VALUE '2208'.
   519     12  ER-2209                 PIC X(4)  VALUE '2209'.
   520     12  ER-2237                 PIC X(4)  VALUE '2237'.
   521     12  ER-2238                 PIC X(4)  VALUE '2238'.
   522     12  ER-2253                 PIC X(4)  VALUE '2253'.
   523     12  ER-2619                 PIC X(4)  VALUE '2619'.
   524     12  ER-2651                 PIC X(4)  VALUE '2651'.
   525     12  ER-2784                 PIC X(4)  VALUE '2784'.
   526     12  ER-2785                 PIC X(4)  VALUE '2785'.
   527     12  ER-2786                 PIC X(4)  VALUE '2786'.
   528     12  ER-2791                 PIC X(4)  VALUE '2791'.
   529     12  ER-2845                 PIC X(4)  VALUE '2845'.
   530     12  ER-2848                 PIC X(4)  VALUE '2848'.
   531     12  ER-2851                 PIC X(4)  VALUE '2851'.
   532     12  ER-3829                 PIC X(4)  VALUE '3829'.
   533     12  ER-3830                 PIC X(4)  VALUE '3830'.
   534     12  ER-3833                 PIC X(4)  VALUE '3833'.
   535     12  ER-7638                 PIC X(4)  VALUE '7638'.
   536     12  ER-8888                 PIC X(4)  VALUE '8888'.
   537     12  ER-9999                 PIC X(4)  VALUE '9999'.
   538*    COPY ELCDATE.
   539******************************************************************
   540*                                                                *
   541*                                                                *
   542*                            ELCDATE.                            *
   543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   544*                            VMOD=2.003
   545*                                                                *
   546*                                                                *
   547*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   548*                 LENGTH = 200                                   *
   549******************************************************************
   550
   551 01  DATE-CONVERSION-DATA.
   552     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   553     12  DC-OPTION-CODE                PIC X.
   554         88  BIN-TO-GREG                VALUE ' '.
   555         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   556         88  EDIT-GREG-TO-BIN           VALUE '2'.
   557         88  YMD-GREG-TO-BIN            VALUE '3'.
   558         88  MDY-GREG-TO-BIN            VALUE '4'.
   559         88  JULIAN-TO-BIN              VALUE '5'.
   560         88  BIN-PLUS-ELAPSED           VALUE '6'.
   561         88  FIND-CENTURY               VALUE '7'.
   562         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  12
* EL6316.cbl
   563         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   564         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   565         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   566         88  JULIAN-TO-BIN-3            VALUE 'C'.
   567         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   568         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   569         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   570         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   571         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   572         88  CHECK-LEAP-YEAR            VALUE 'H'.
   573         88  BIN-3-TO-GREG              VALUE 'I'.
   574         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   575         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   576         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   577         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   578         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   579         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   580         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   581         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   582         88  THREE-CHARACTER-BIN
   583                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   584         88  GREGORIAN-TO-BIN
   585                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   586         88  BIN-TO-GREGORIAN
   587                  VALUES ' ' '1' 'I' '8' 'G'.
   588         88  JULIAN-TO-BINARY
   589                  VALUES '5' 'C' 'E' 'F'.
   590     12  DC-ERROR-CODE                 PIC X.
   591         88  NO-CONVERSION-ERROR        VALUE ' '.
   592         88  DATE-CONVERSION-ERROR
   593                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   594         88  DATE-IS-ZERO               VALUE '1'.
   595         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   596         88  DATE-IS-INVALID            VALUE '3'.
   597         88  DATE1-GREATER-DATE2        VALUE '4'.
   598         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   599         88  DATE-INVALID-OPTION        VALUE '9'.
   600         88  INVALID-CENTURY            VALUE 'A'.
   601         88  ONLY-CENTURY               VALUE 'B'.
   602         88  ONLY-LEAP-YEAR             VALUE 'C'.
   603         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   604     12  DC-END-OF-MONTH               PIC X.
   605         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   606     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   607         88  USE-NORMAL-PROCESS         VALUE ' '.
   608         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   609         88  ADJUST-UP-100-YRS          VALUE '2'.
   610     12  FILLER                        PIC X.
   611     12  DC-CONVERSION-DATES.
   612         16  DC-BIN-DATE-1             PIC XX.
   613         16  DC-BIN-DATE-2             PIC XX.
   614         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   615         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   616                       DC-GREG-DATE-1-EDIT.
   617             20  DC-EDIT1-MONTH        PIC 99.
   618             20  SLASH1-1              PIC X.
   619             20  DC-EDIT1-DAY          PIC 99.
   620             20  SLASH1-2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  13
* EL6316.cbl
   621             20  DC-EDIT1-YEAR         PIC 99.
   622         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   623         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   624                     DC-GREG-DATE-2-EDIT.
   625             20  DC-EDIT2-MONTH        PIC 99.
   626             20  SLASH2-1              PIC X.
   627             20  DC-EDIT2-DAY          PIC 99.
   628             20  SLASH2-2              PIC X.
   629             20  DC-EDIT2-YEAR         PIC 99.
   630         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   631         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   632                     DC-GREG-DATE-1-YMD.
   633             20  DC-YMD-YEAR           PIC 99.
   634             20  DC-YMD-MONTH          PIC 99.
   635             20  DC-YMD-DAY            PIC 99.
   636         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   637         16  DC-GREG-DATE-1-MDY-R REDEFINES
   638                      DC-GREG-DATE-1-MDY.
   639             20  DC-MDY-MONTH          PIC 99.
   640             20  DC-MDY-DAY            PIC 99.
   641             20  DC-MDY-YEAR           PIC 99.
   642         16  DC-GREG-DATE-1-ALPHA.
   643             20  DC-ALPHA-MONTH        PIC X(10).
   644             20  DC-ALPHA-DAY          PIC 99.
   645             20  FILLER                PIC XX.
   646             20  DC-ALPHA-CENTURY.
   647                 24 DC-ALPHA-CEN-N     PIC 99.
   648             20  DC-ALPHA-YEAR         PIC 99.
   649         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   650         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   651         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   652         16  DC-JULIAN-DATE            PIC 9(05).
   653         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   654                                       PIC 9(05).
   655         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   656             20  DC-JULIAN-YEAR        PIC 99.
   657             20  DC-JULIAN-DAYS        PIC 999.
   658         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   659         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   660         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   661     12  DATE-CONVERSION-VARIBLES.
   662         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   663         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   664             20  FILLER                PIC 9(3).
   665             20  HOLD-CEN-1-CCYY.
   666                 24  HOLD-CEN-1-CC     PIC 99.
   667                 24  HOLD-CEN-1-YY     PIC 99.
   668             20  HOLD-CEN-1-MO         PIC 99.
   669             20  HOLD-CEN-1-DA         PIC 99.
   670         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   671             20  HOLD-CEN-1-R-MO       PIC 99.
   672             20  HOLD-CEN-1-R-DA       PIC 99.
   673             20  HOLD-CEN-1-R-CCYY.
   674                 24  HOLD-CEN-1-R-CC   PIC 99.
   675                 24  HOLD-CEN-1-R-YY   PIC 99.
   676             20  FILLER                PIC 9(3).
   677         16  HOLD-CENTURY-1-X.
   678             20  FILLER                PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  14
* EL6316.cbl
   679             20  HOLD-CEN-1-X-CCYY.
   680                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   681                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   682             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   683             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   684         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   685             20  HOLD-CEN-1-R-X-MO     PIC XX.
   686             20  HOLD-CEN-1-R-X-DA     PIC XX.
   687             20  HOLD-CEN-1-R-X-CCYY.
   688                 24  HOLD-CEN-1-R-X-CC PIC XX.
   689                 24  HOLD-CEN-1-R-X-YY PIC XX.
   690             20  FILLER                PIC XXX.
   691         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   692         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   693         16  DC-JULIAN-DATE-1          PIC 9(07).
   694         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   695             20  DC-JULIAN-1-CCYY.
   696                 24  DC-JULIAN-1-CC    PIC 99.
   697                 24  DC-JULIAN-1-YR    PIC 99.
   698             20  DC-JULIAN-DA-1        PIC 999.
   699         16  DC-JULIAN-DATE-2          PIC 9(07).
   700         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   701             20  DC-JULIAN-2-CCYY.
   702                 24  DC-JULIAN-2-CC    PIC 99.
   703                 24  DC-JULIAN-2-YR    PIC 99.
   704             20  DC-JULIAN-DA-2        PIC 999.
   705         16  DC-GREG-DATE-A-EDIT.
   706             20  DC-EDITA-MONTH        PIC 99.
   707             20  SLASHA-1              PIC X VALUE '/'.
   708             20  DC-EDITA-DAY          PIC 99.
   709             20  SLASHA-2              PIC X VALUE '/'.
   710             20  DC-EDITA-CCYY.
   711                 24  DC-EDITA-CENT     PIC 99.
   712                 24  DC-EDITA-YEAR     PIC 99.
   713         16  DC-GREG-DATE-B-EDIT.
   714             20  DC-EDITB-MONTH        PIC 99.
   715             20  SLASHB-1              PIC X VALUE '/'.
   716             20  DC-EDITB-DAY          PIC 99.
   717             20  SLASHB-2              PIC X VALUE '/'.
   718             20  DC-EDITB-CCYY.
   719                 24  DC-EDITB-CENT     PIC 99.
   720                 24  DC-EDITB-YEAR     PIC 99.
   721         16  DC-GREG-DATE-CYMD         PIC 9(08).
   722         16  DC-GREG-DATE-CYMD-R REDEFINES
   723                              DC-GREG-DATE-CYMD.
   724             20  DC-CYMD-CEN           PIC 99.
   725             20  DC-CYMD-YEAR          PIC 99.
   726             20  DC-CYMD-MONTH         PIC 99.
   727             20  DC-CYMD-DAY           PIC 99.
   728         16  DC-GREG-DATE-MDCY         PIC 9(08).
   729         16  DC-GREG-DATE-MDCY-R REDEFINES
   730                              DC-GREG-DATE-MDCY.
   731             20  DC-MDCY-MONTH         PIC 99.
   732             20  DC-MDCY-DAY           PIC 99.
   733             20  DC-MDCY-CEN           PIC 99.
   734             20  DC-MDCY-YEAR          PIC 99.
   735    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   736        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  15
* EL6316.cbl
   737    12  DC-EL310-DATE                  PIC X(21).
   738    12  FILLER                         PIC X(28).
   739*    COPY ELCLOGOF.
   740******************************************************************
   741*                                                                *
   742*                                                                *
   743*                            ELCLOGOF.                           *
   744*                            VMOD=2.001                          *
   745*                                                                *
   746*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   747*                                                                *
   748******************************************************************
   749 01  CLASIC-LOGOFF.
   750     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   751     12  LOGOFF-TEXT.
   752         16  FILLER          PIC X(5)    VALUE SPACES.
   753         16  LOGOFF-MSG.
   754             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   755             20  FILLER      PIC X       VALUE SPACES.
   756             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   757         16  FILLER          PIC X(80)
   758           VALUE '* YOU ARE NOW LOGGED OFF'.
   759         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   760         16  FILLER          PIC X       VALUE QUOTE.
   761         16  LOGOFF-SYS-MSG  PIC X(17)
   762           VALUE 'S CLAS-IC SYSTEM '.
   763     12  TEXT-MESSAGES.
   764         16  UNACCESS-MSG    PIC X(29)
   765             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   766         16  PGMIDERR-MSG    PIC X(17)
   767             VALUE 'PROGRAM NOT FOUND'.
   768*    COPY ELCATTR.
   769******************************************************************
   770*                                                                *
   771*                            ELCATTR.                            *
   772*                            VMOD=2.001                          *
   773*                                                                *
   774*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   775*                                                                *
   776*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   777*                                                                *
   778*                   POS 1   P=PROTECTED                          *
   779*                           U=UNPROTECTED                        *
   780*                           S=ASKIP                              *
   781*                   POS 2   A=ALPHA/NUMERIC                      *
   782*                           N=NUMERIC                            *
   783*                   POS 3   N=NORMAL                             *
   784*                           B=BRIGHT                             *
   785*                           D=DARK                               *
   786*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   787*                           OF=MODIFIED DATA TAG OFF             *
   788*                                                                *
   789*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   790******************************************************************
   791 01  ATTRIBUTE-LIST.
   792     12  AL-PABOF            PIC X       VALUE 'Y'.
   793     12  AL-PABON            PIC X       VALUE 'Z'.
   794     12  AL-PADOF            PIC X       VALUE '%'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  16
* EL6316.cbl
   795     12  AL-PADON            PIC X       VALUE '_'.
   796     12  AL-PANOF            PIC X       VALUE '-'.
   797     12  AL-PANON            PIC X       VALUE '/'.
   798     12  AL-SABOF            PIC X       VALUE '8'.
   799     12  AL-SABON            PIC X       VALUE '9'.
   800     12  AL-SADOF            PIC X       VALUE '@'.
   801     12  AL-SADON            PIC X       VALUE QUOTE.
   802     12  AL-SANOF            PIC X       VALUE '0'.
   803     12  AL-SANON            PIC X       VALUE '1'.
   804     12  AL-UABOF            PIC X       VALUE 'H'.
   805     12  AL-UABON            PIC X       VALUE 'I'.
   806     12  AL-UADOF            PIC X       VALUE '<'.
   807     12  AL-UADON            PIC X       VALUE '('.
   808     12  AL-UANOF            PIC X       VALUE ' '.
   809     12  AL-UANON            PIC X       VALUE 'A'.
   810     12  AL-UNBOF            PIC X       VALUE 'Q'.
   811     12  AL-UNBON            PIC X       VALUE 'R'.
   812     12  AL-UNDOF            PIC X       VALUE '*'.
   813     12  AL-UNDON            PIC X       VALUE ')'.
   814     12  AL-UNNOF            PIC X       VALUE '&'.
   815     12  AL-UNNON            PIC X       VALUE 'J'.
   816*    COPY ELCEMIB.
   817******************************************************************
   818*                                                                *
   819*                                                                *
   820*                            ELCEMIB.                            *
   821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   822*                            VMOD=2.005                          *
   823*                                                                *
   824*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   825*                                                                *
   826******************************************************************
   827 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   828     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   829     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   830     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   831     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   832     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   833     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   834     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   835     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   836     12  EMI-SWITCH1             PIC X        VALUE '1'.
   837         88  EMI-NO-ERRORS                    VALUE '1'.
   838         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   839         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   840     12  EMI-SWITCH2             PIC X        VALUE '1'.
   841         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   842     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   843         88  EMI-AREA1-EMPTY                  VALUE '1'.
   844         88  EMI-AREA1-FULL                   VALUE '2'.
   845     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   846         88  EMI-AREA2-EMPTY                  VALUE '1'.
   847         88  EMI-AREA2-FULL                   VALUE '2'.
   848     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   849         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   850         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   851         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   852         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  17
* EL6316.cbl
   853         88  EMI-BYPASS-FATALS                VALUE 'X'.
   854     12  EMI-ERROR-LINES.
   855         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   856         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   857         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   858         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   859             20  EMI-ERR-CODES OCCURS 10 TIMES.
   860                 24  EMI-ERR-NUM         PIC X(4).
   861                 24  EMI-FILLER          PIC X.
   862                 24  EMI-SEV             PIC X.
   863                 24  FILLER              PIC X.
   864             20  FILLER                  PIC X(02).
   865     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   866         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   867             20  EMI-ERROR-NUMBER    PIC X(4).
   868             20  EMI-FILL            PIC X.
   869             20  EMI-SEVERITY        PIC X.
   870             20  FILLER              PIC X.
   871             20  EMI-ERROR-TEXT.
   872                 24  EMI-TEXT-VARIABLE   PIC X(10).
   873                 24  FILLER          PIC X(55).
   874     12  EMI-SEVERITY-SAVE           PIC X.
   875         88  EMI-NOTE                    VALUE 'N'.
   876         88  EMI-WARNING                 VALUE 'W'.
   877         88  EMI-FORCABLE                VALUE 'F'.
   878         88  EMI-FATAL                   VALUE 'X'.
   879     12  EMI-MESSAGE-FLAG            PIC X.
   880         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   881         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   882     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   883     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   884         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   885         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   886         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   887     12  FILLER                      PIC X(137)  VALUE SPACES.
   888     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   889     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   890     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   891     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   892*    COPY ELCTEXT.
   893******************************************************************
   894*                                                                *
   895*                                                                *
   896*                            ELCTEXT.                            *
   897*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   898*                            VMOD=2.008                          *
   899*                                                                *
   900*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   901*                                     FORM LETTERS,              *
   902*                                     CERT FORM DISPLAY.
   903*                                                                *
   904*   FILE TYPE = VSAM,KSDS                                        *
   905*   RECORD SIZE = 100   RECFORM = FIXED                          *
   906*                                                                *
   907*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   908*       ALTERNATE INDEX = NONE                                   *
   909*                                                                *
   910*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  18
* EL6316.cbl
   911*       ALTERNATE INDEX = NONE                                   *
   912*                                                                *
   913*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   914*       ALTERNATE INDEX = NONE                                   *
   915*                                                                *
   916*   LOG = NO                                                     *
   917*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   918******************************************************************
   919 01  TEXT-FILES.
   920     12  TEXT-FILE-ID                PIC XX.
   921         88  FORMS-FILE-TEXT            VALUE 'TF'.
   922         88  LETTER-FILE-TEXT           VALUE 'TL'.
   923         88  HELP-FILE-TEXT             VALUE 'TH'.
   924
   925     12  TX-CONTROL-PRIMARY.
   926         16  TX-COMPANY-CD           PIC X.
   927             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   928         16  TX-ACCESS-CD-GENL       PIC X(12).
   929
   930         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   931             20  TX-LETTER-NO        PIC X(4).
   932             20  FILLER              PIC X(8).
   933
   934         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   935             20  TX-FORM-NO          PIC X(12).
   936
   937         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   938             20  TX-HELP-TYPE        PIC X.
   939                 88  HELP-FOR-GENERAL   VALUE ' '.
   940                 88  HELP-BY-SCREEN     VALUE 'S'.
   941                 88  HELP-BY-ERROR      VALUE 'E'.
   942             20  TX-SCREEN-OR-ERROR  PIC X(4).
   943                 88  GENERAL-INFO-HELP  VALUE '0000'.
   944             20  TX-HELP-FOR-COMPANY  PIC XXX.
   945                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   946             20  FILLER              PIC X(4).
   947
   948         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   949
   950     12  TX-PROCESS-CONTROL          PIC XX.
   951         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   952
   953     12  TX-TEXT-LINE                PIC X(70).
   954
   955     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   956         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   957         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   958         88  TX-VALID-FORM-SQUEEZE-VALUE
   959                                        VALUE 'Y' ' '.
   960
   961     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   962         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   963         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   964         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   965         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   966         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   967         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   968         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  19
* EL6316.cbl
   969                                              'K' 'N' ' '
   970                                              'Z'.
   971
   972     12  TX-ARCHIVE-SW               PIC X.
   973         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   974         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   975         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   976
   977     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   978     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   979
   980     12  TX-BSR-CODE                 PIC X.
   981         88  TX-BSR-LETTER              VALUE 'B'.
   982         88  TX-NON-BSR-LETTER          VALUE ' '.
   983
   984     12  FILLER                      PIC X.
   985*****************************************************************
   986*    COPY ELCINTF.
   987******************************************************************
   988*                                                                *
   989*                                                                *
   990*                            ELCINTF.                            *
   991*                            VMOD=2.017                          *
   992*                                                                *
   993*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   994*                                                                *
   995*       LENGTH = 1024                                            *
   996*                                                                *
   997******************************************************************
   998*                   C H A N G E   L O G
   999*
  1000* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1001*-----------------------------------------------------------------
  1002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1003* EFFECTIVE    NUMBER
  1004*-----------------------------------------------------------------
  1005* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1006******************************************************************
  1007 01  PROGRAM-INTERFACE-BLOCK.
  1008     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1009     12  PI-CALLING-PROGRAM              PIC X(8).
  1010     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1011     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1012     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1013     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1014     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1015     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1016     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1017     12  PI-COMPANY-ID                   PIC XXX.
  1018     12  PI-COMPANY-CD                   PIC X.
  1019
  1020     12  PI-COMPANY-PASSWORD             PIC X(8).
  1021
  1022     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1023
  1024     12  PI-CONTROL-IN-PROGRESS.
  1025         16  PI-CARRIER                  PIC X.
  1026         16  PI-GROUPING                 PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  20
* EL6316.cbl
  1027         16  PI-STATE                    PIC XX.
  1028         16  PI-ACCOUNT                  PIC X(10).
  1029         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1030                                         PIC X(10).
  1031         16  PI-CLAIM-CERT-GRP.
  1032             20  PI-CLAIM-NO             PIC X(7).
  1033             20  PI-CERT-NO.
  1034                 25  PI-CERT-PRIME       PIC X(10).
  1035                 25  PI-CERT-SFX         PIC X.
  1036             20  PI-CERT-EFF-DT          PIC XX.
  1037         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1038             20  PI-PLAN-CODE            PIC X(2).
  1039             20  PI-REVISION-NUMBER      PIC X(3).
  1040             20  PI-PLAN-EFF-DT          PIC X(2).
  1041             20  PI-PLAN-EXP-DT          PIC X(2).
  1042             20  FILLER                  PIC X(11).
  1043         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1044             20  PI-OE-REFERENCE-1.
  1045                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1046                 25  PI-OE-REF-1-SUFF    PIC XX.
  1047
  1048     12  PI-SESSION-IN-PROGRESS          PIC X.
  1049         88  CLAIM-SESSION                   VALUE '1'.
  1050         88  CREDIT-SESSION                  VALUE '2'.
  1051         88  WARRANTY-SESSION                VALUE '3'.
  1052         88  MORTGAGE-SESSION                VALUE '4'.
  1053         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1054
  1055
  1056*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1057
  1058     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1059     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1060
  1061     12  PI-CREDIT-USER                  PIC X.
  1062         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1063         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1064
  1065     12  PI-CLAIM-USER                   PIC X.
  1066         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1067         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1068
  1069     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1070         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1071         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1072         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1073         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1074         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1075
  1076     12  PI-PROCESSOR-ID                 PIC X(4).
  1077
  1078     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1079
  1080     12  PI-MEMBER-CAPTION               PIC X(10).
  1081
  1082     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1083         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1084
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  21
* EL6316.cbl
  1085     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1086     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1087     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1088     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1089
  1090     12  PI-AH-OVERRIDE-L1               PIC X.
  1091     12  PI-AH-OVERRIDE-L2               PIC XX.
  1092     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1093     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1094
  1095     12  PI-NEW-SYSTEM                   PIC X(2).
  1096
  1097     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1098     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1099         88  PI-USES-PAID-TO                 VALUE '1'.
  1100     12  PI-CRDTCRD-SYSTEM.
  1101         16  PI-CRDTCRD-USER             PIC X.
  1102             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1103             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1104         16  PI-CC-MONTH-END-DT          PIC XX.
  1105     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1106
  1107     12  PI-OE-REFERENCE-2.
  1108         16  PI-OE-REF-2-PRIME           PIC X(10).
  1109         16  PI-OE-REF-2-SUFF            PIC X.
  1110
  1111     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1112
  1113     12  PI-LANGUAGE-TYPE                PIC X.
  1114             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1115             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1116             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1117
  1118     12  PI-POLICY-LINKAGE-IND           PIC X.
  1119         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1120         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1121                                                   LOW-VALUES.
  1122
  1123     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1124     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1125         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1126         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1127
  1128     12  PI-PROCESSOR-CSR-IND            PIC X.
  1129         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1130         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1131
  1132     12  FILLER                          PIC X(3).
  1133
  1134     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1135
  1136     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1137         PI-SYSTEM-LEVEL.
  1138
  1139         16  PI-ENTRY-CODES.
  1140             20  PI-ENTRY-CD-1           PIC X.
  1141             20  PI-ENTRY-CD-2           PIC X.
  1142
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  22
* EL6316.cbl
  1143         16  PI-RETURN-CODES.
  1144             20  PI-RETURN-CD-1          PIC X.
  1145             20  PI-RETURN-CD-2          PIC X.
  1146
  1147         16  PI-UPDATE-STATUS-SAVE.
  1148             20  PI-UPDATE-BY            PIC X(4).
  1149             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1150
  1151         16  PI-LOWER-CASE-LETTERS       PIC X.
  1152             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1153
  1154*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1155*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1156*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1157
  1158         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1159             88  ST-ACCNT-CNTL               VALUE ' '.
  1160             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1161             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1162             88  ACCNT-CNTL                  VALUE '3'.
  1163             88  CARR-ACCNT-CNTL             VALUE '4'.
  1164
  1165         16  PI-PROCESSOR-CAP-LIST.
  1166             20  PI-SYSTEM-CONTROLS.
  1167                24 PI-SYSTEM-DISPLAY     PIC X.
  1168                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1169                24 PI-SYSTEM-MODIFY      PIC X.
  1170                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1171             20  FILLER                  PIC XX.
  1172             20  PI-DISPLAY-CAP          PIC X.
  1173                 88  DISPLAY-CAP             VALUE 'Y'.
  1174             20  PI-MODIFY-CAP           PIC X.
  1175                 88  MODIFY-CAP              VALUE 'Y'.
  1176             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1177                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1178             20  PI-FORCE-CAP            PIC X.
  1179                 88  FORCE-CAP               VALUE 'Y'.
  1180
  1181         16  PI-PROGRAM-CONTROLS.
  1182             20  PI-PGM-PRINT-OPT        PIC X.
  1183             20  PI-PGM-FORMAT-OPT       PIC X.
  1184             20  PI-PGM-PROCESS-OPT      PIC X.
  1185             20  PI-PGM-TOTALS-OPT       PIC X.
  1186
  1187         16  PI-HELP-INTERFACE.
  1188             20  PI-LAST-ERROR-NO        PIC X(4).
  1189             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1190
  1191         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1192             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1193
  1194         16  PI-CR-CONTROL-IN-PROGRESS.
  1195             20  PI-CR-CARRIER           PIC X.
  1196             20  PI-CR-GROUPING          PIC X(6).
  1197             20  PI-CR-STATE             PIC XX.
  1198             20  PI-CR-ACCOUNT           PIC X(10).
  1199             20  PI-CR-FIN-RESP          PIC X(10).
  1200             20  PI-CR-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  23
* EL6316.cbl
  1201
  1202         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1203
  1204         16  PI-CR-MONTH-END-DT          PIC XX.
  1205
  1206         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1207             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1208             88  PI-ZERO-CARRIER             VALUE '1'.
  1209             88  PI-ZERO-GROUPING            VALUE '2'.
  1210             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1211
  1212         16  PI-CARRIER-SECURITY         PIC X.
  1213             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1214
  1215         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1216             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1217             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1218
  1219         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1220             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1221                                         INDEXED BY PI-ACCESS-NDX
  1222                                         PIC X.
  1223
  1224         16  PI-GA-BILLING-CONTROL       PIC X.
  1225             88  PI-GA-BILLING               VALUE '1'.
  1226
  1227         16  PI-MAIL-PROCESSING          PIC X.
  1228             88  PI-MAIL-YES                 VALUE 'Y'.
  1229
  1230         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1231
  1232         16  PI-AR-SYSTEM.
  1233             20  PI-AR-PROCESSING-CNTL   PIC X.
  1234                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1235             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1236             20  PI-AR-MONTH-END-DT      PIC XX.
  1237
  1238         16  PI-MP-SYSTEM.
  1239             20  PI-MORTGAGE-USER            PIC X.
  1240                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1241                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1242             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1243                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1244                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1245                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1246                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1247                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1248             20  PI-MP-MONTH-END-DT          PIC XX.
  1249             20  PI-MP-REFERENCE-NO.
  1250                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1251                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1252
  1253         16  PI-LABEL-CONTROL            PIC X(01).
  1254             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1255             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1256
  1257         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1258             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  24
* EL6316.cbl
  1259
  1260         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1261             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1262             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1263
  1264         16  FILLER                      PIC X(14).
  1265
  1266     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1267******************************************************************
  1268     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1269        16  PI-ISS-CAN-SW           PIC X.
  1270        16  PI-ERENDT-KEY.
  1271            20  PI-ENDT-COMPANY-CD  PIC X.
  1272            20  PI-ENDT-CARRIER     PIC X.
  1273            20  PI-ENDT-GROUPING    PIC X(6).
  1274            20  PI-ENDT-STATE       PIC XX.
  1275            20  PI-ENDT-ACCOUNT     PIC X(10).
  1276            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1277            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1278            20  PI-ENDT-CERT-SFX    PIC X.
  1279            20  PI-ENDT-RECORD-TYPE PIC X.
  1280            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1281        16  PI-ELCRTO-KEY.
  1282            20  PI-CRTO-COMPANY-CD  PIC X.
  1283            20  PI-CRTO-CARRIER     PIC X.
  1284            20  PI-CRTO-GROUPING    PIC X(6).
  1285            20  PI-CRTO-STATE       PIC XX.
  1286            20  PI-CRTO-ACCOUNT     PIC X(10).
  1287            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1288            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1289            20  PI-CRTO-CERT-SFX    PIC X.
  1290            20  PI-CRTO-RECORD-TYPE PIC X.
  1291            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1292        16  PI-ERPNDB-KEY           PIC X(11).
  1293        16  PI-DOCUMENT-PROCESSED   PIC X.
  1294            88  PI-VERI-PROCESSED      VALUE 'V'.
  1295            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1296        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1297        16  PI-RES-REF-CLM-TYPE     PIC X.
  1298        16  PI-CLM-RESC-IND         PIC X.
  1299            88  PI-CLM-RESCISSION      VALUE 'Y'.
  1300        16  PI-CLEAR-ERROR-SW       PIC X.
  1301            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1302        16  PI-PRTSW-ENTERED        PIC X.
  1303        16  PI-LTRID-ENTERED        PIC X(4).
  1304        16  PI-REASONS-ENTERED      PIC X(84).
  1305        16  PI-CERTNT1-ENTERED      PIC X(63).
  1306        16  PI-CERTNT2-ENTERED      PIC X(63).
  1307        16  FILLER                  PIC X(20).
  1308        16  PI-FINALIZED-IND        PIC X.
  1309        16  PI-BILLNT1-ENTERED      PIC X(63).
  1310        16  FILLER                  PIC X(217).
  1311    12  FILLER                      PIC X(276).
  1312*    COPY ELCAID.
  1313******************************************************************
  1314*                                                                *
  1315*                            ELCAID.                             *
  1316*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  25
* EL6316.cbl
  1317*                                                                *
  1318*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1319*                                                                *
  1320*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1321*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1322******************************************************************
  1323
  1324 01  DFHAID.
  1325   02  DFHNULL   PIC  X  VALUE  ' '.
  1326   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1327   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1328   02  DFHPEN    PIC  X  VALUE  '='.
  1329   02  DFHOPID   PIC  X  VALUE  'W'.
  1330   02  DFHPA1    PIC  X  VALUE  '%'.
  1331   02  DFHPA2    PIC  X  VALUE  '>'.
  1332   02  DFHPA3    PIC  X  VALUE  ','.
  1333   02  DFHPF1    PIC  X  VALUE  '1'.
  1334   02  DFHPF2    PIC  X  VALUE  '2'.
  1335   02  DFHPF3    PIC  X  VALUE  '3'.
  1336   02  DFHPF4    PIC  X  VALUE  '4'.
  1337   02  DFHPF5    PIC  X  VALUE  '5'.
  1338   02  DFHPF6    PIC  X  VALUE  '6'.
  1339   02  DFHPF7    PIC  X  VALUE  '7'.
  1340   02  DFHPF8    PIC  X  VALUE  '8'.
  1341   02  DFHPF9    PIC  X  VALUE  '9'.
  1342   02  DFHPF10   PIC  X  VALUE  ':'.
  1343   02  DFHPF11   PIC  X  VALUE  '#'.
  1344   02  DFHPF12   PIC  X  VALUE  '@'.
  1345   02  DFHPF13   PIC  X  VALUE  'A'.
  1346   02  DFHPF14   PIC  X  VALUE  'B'.
  1347   02  DFHPF15   PIC  X  VALUE  'C'.
  1348   02  DFHPF16   PIC  X  VALUE  'D'.
  1349   02  DFHPF17   PIC  X  VALUE  'E'.
  1350   02  DFHPF18   PIC  X  VALUE  'F'.
  1351   02  DFHPF19   PIC  X  VALUE  'G'.
  1352   02  DFHPF20   PIC  X  VALUE  'H'.
  1353   02  DFHPF21   PIC  X  VALUE  'I'.
  1354*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1355   02  DFHPF22   PIC  X  VALUE  '['.
  1356   02  DFHPF23   PIC  X  VALUE  '.'.
  1357   02  DFHPF24   PIC  X  VALUE  '<'.
  1358   02  DFHMSRE   PIC  X  VALUE  'X'.
  1359   02  DFHSTRF   PIC  X  VALUE  'h'.
  1360   02  DFHTRIG   PIC  X  VALUE  '"'.
  1361 01  FILLER    REDEFINES DFHAID.
  1362     12  FILLER              PIC X(8).
  1363     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1364*   COPY EL6316S.
  1365 01  EL631II.
  1366     05  FILLER            PIC  X(0012).
  1367*    -------------------------------
  1368     05  DATEL PIC S9(0004) COMP.
  1369     05  DATEF PIC  X(0001).
  1370     05  FILLER REDEFINES DATEF.
  1371         10  DATEA PIC  X(0001).
  1372     05  DATEI PIC  X(0008).
  1373*    -------------------------------
  1374     05  TIMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  26
* EL6316.cbl
  1375     05  TIMEF PIC  X(0001).
  1376     05  FILLER REDEFINES TIMEF.
  1377         10  TIMEA PIC  X(0001).
  1378     05  TIMEI PIC  X(0005).
  1379*    -------------------------------
  1380     05  PROCIDL PIC S9(0004) COMP.
  1381     05  PROCIDF PIC  X(0001).
  1382     05  FILLER REDEFINES PROCIDF.
  1383         10  PROCIDA PIC  X(0001).
  1384     05  PROCIDI PIC  X(0004).
  1385*    -------------------------------
  1386     05  HOSTL PIC S9(0004) COMP.
  1387     05  HOSTF PIC  X(0001).
  1388     05  FILLER REDEFINES HOSTF.
  1389         10  HOSTA PIC  X(0001).
  1390     05  HOSTI PIC  X(0009).
  1391*    -------------------------------
  1392     05  SYSL PIC S9(0004) COMP.
  1393     05  SYSF PIC  X(0001).
  1394     05  FILLER REDEFINES SYSF.
  1395         10  SYSA PIC  X(0001).
  1396     05  SYSI PIC  X(0005).
  1397*    -------------------------------
  1398     05  COMPANYL PIC S9(0004) COMP.
  1399     05  COMPANYF PIC  X(0001).
  1400     05  FILLER REDEFINES COMPANYF.
  1401         10  COMPANYA PIC  X(0001).
  1402     05  COMPANYI PIC  X(0003).
  1403*    -------------------------------
  1404     05  DATASORL PIC S9(0004) COMP.
  1405     05  DATASORF PIC  X(0001).
  1406     05  FILLER REDEFINES DATASORF.
  1407         10  DATASORA PIC  X(0001).
  1408     05  DATASORI PIC  X(0001).
  1409*    -------------------------------
  1410     05  BATCHNOL PIC S9(0004) COMP.
  1411     05  BATCHNOF PIC  X(0001).
  1412     05  FILLER REDEFINES BATCHNOF.
  1413         10  BATCHNOA PIC  X(0001).
  1414     05  BATCHNOI PIC  X(0006).
  1415*    -------------------------------
  1416     05  BSEQNOL PIC S9(0004) COMP.
  1417     05  BSEQNOF PIC  X(0001).
  1418     05  FILLER REDEFINES BSEQNOF.
  1419         10  BSEQNOA PIC  X(0001).
  1420     05  BSEQNOI PIC  X(0008).
  1421*    -------------------------------
  1422     05  ARCHNOL PIC S9(0004) COMP.
  1423     05  ARCHNOF PIC  X(0001).
  1424     05  FILLER REDEFINES ARCHNOF.
  1425         10  ARCHNOA PIC  X(0001).
  1426     05  ARCHNOI PIC  X(0008).
  1427*    -------------------------------
  1428     05  PRTSWL PIC S9(0004) COMP.
  1429     05  PRTSWF PIC  X(0001).
  1430     05  FILLER REDEFINES PRTSWF.
  1431         10  PRTSWA PIC  X(0001).
  1432     05  PRTSWI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  27
* EL6316.cbl
  1433*    -------------------------------
  1434     05  CARRL PIC S9(0004) COMP.
  1435     05  CARRF PIC  X(0001).
  1436     05  FILLER REDEFINES CARRF.
  1437         10  CARRA PIC  X(0001).
  1438     05  CARRI PIC  X(0001).
  1439*    -------------------------------
  1440     05  GROUPL PIC S9(0004) COMP.
  1441     05  GROUPF PIC  X(0001).
  1442     05  FILLER REDEFINES GROUPF.
  1443         10  GROUPA PIC  X(0001).
  1444     05  GROUPI PIC  X(0006).
  1445*    -------------------------------
  1446     05  STATEL PIC S9(0004) COMP.
  1447     05  STATEF PIC  X(0001).
  1448     05  FILLER REDEFINES STATEF.
  1449         10  STATEA PIC  X(0001).
  1450     05  STATEI PIC  X(0002).
  1451*    -------------------------------
  1452     05  ACCTL PIC S9(0004) COMP.
  1453     05  ACCTF PIC  X(0001).
  1454     05  FILLER REDEFINES ACCTF.
  1455         10  ACCTA PIC  X(0001).
  1456     05  ACCTI PIC  X(0010).
  1457*    -------------------------------
  1458     05  EFFDTL PIC S9(0004) COMP.
  1459     05  EFFDTF PIC  X(0001).
  1460     05  FILLER REDEFINES EFFDTF.
  1461         10  EFFDTA PIC  X(0001).
  1462     05  EFFDTI PIC  X(0008).
  1463*    -------------------------------
  1464     05  CERTNOL PIC S9(0004) COMP.
  1465     05  CERTNOF PIC  X(0001).
  1466     05  FILLER REDEFINES CERTNOF.
  1467         10  CERTNOA PIC  X(0001).
  1468     05  CERTNOI PIC  X(0010).
  1469*    -------------------------------
  1470     05  CRTSFXL PIC S9(0004) COMP.
  1471     05  CRTSFXF PIC  X(0001).
  1472     05  FILLER REDEFINES CRTSFXF.
  1473         10  CRTSFXA PIC  X(0001).
  1474     05  CRTSFXI PIC  X(0001).
  1475*    -------------------------------
  1476     05  LTRIDL PIC S9(0004) COMP.
  1477     05  LTRIDF PIC  X(0001).
  1478     05  FILLER REDEFINES LTRIDF.
  1479         10  LTRIDA PIC  X(0001).
  1480     05  LTRIDI PIC  X(0004).
  1481*    -------------------------------
  1482     05  SEQNOL PIC S9(0004) COMP.
  1483     05  SEQNOF PIC  X(0001).
  1484     05  FILLER REDEFINES SEQNOF.
  1485         10  SEQNOA PIC  X(0001).
  1486     05  SEQNOI PIC  X(0006).
  1487*    -------------------------------
  1488     05  FNAMEL PIC S9(0004) COMP.
  1489     05  FNAMEF PIC  X(0001).
  1490     05  FILLER REDEFINES FNAMEF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  28
* EL6316.cbl
  1491         10  FNAMEA PIC  X(0001).
  1492     05  FNAMEI PIC  X(0010).
  1493*    -------------------------------
  1494     05  MINITL PIC S9(0004) COMP.
  1495     05  MINITF PIC  X(0001).
  1496     05  FILLER REDEFINES MINITF.
  1497         10  MINITA PIC  X(0001).
  1498     05  MINITI PIC  X(0001).
  1499*    -------------------------------
  1500     05  LNAMEL PIC S9(0004) COMP.
  1501     05  LNAMEF PIC  X(0001).
  1502     05  FILLER REDEFINES LNAMEF.
  1503         10  LNAMEA PIC  X(0001).
  1504     05  LNAMEI PIC  X(0015).
  1505*    -------------------------------
  1506     05  OLFDTL PIC S9(0004) COMP.
  1507     05  OLFDTF PIC  X(0001).
  1508     05  FILLER REDEFINES OLFDTF.
  1509         10  OLFDTA PIC  X(0001).
  1510     05  OLFDTI PIC  X(0008).
  1511*    -------------------------------
  1512     05  OLFAMTL PIC S9(0004) COMP.
  1513     05  OLFAMTF PIC  X(0001).
  1514     05  FILLER REDEFINES OLFAMTF.
  1515         10  OLFAMTA PIC  X(0001).
  1516     05  OLFAMTI PIC  X(0012).
  1517*    -------------------------------
  1518     05  OAHDTL PIC S9(0004) COMP.
  1519     05  OAHDTF PIC  X(0001).
  1520     05  FILLER REDEFINES OAHDTF.
  1521         10  OAHDTA PIC  X(0001).
  1522     05  OAHDTI PIC  X(0008).
  1523*    -------------------------------
  1524     05  OAHAMTL PIC S9(0004) COMP.
  1525     05  OAHAMTF PIC  X(0001).
  1526     05  FILLER REDEFINES OAHAMTF.
  1527         10  OAHAMTA PIC  X(0001).
  1528     05  OAHAMTI PIC  X(0012).
  1529*    -------------------------------
  1530     05  NLFDTL PIC S9(0004) COMP.
  1531     05  NLFDTF PIC  X(0001).
  1532     05  FILLER REDEFINES NLFDTF.
  1533         10  NLFDTA PIC  X(0001).
  1534     05  NLFDTI PIC  X(0008).
  1535*    -------------------------------
  1536     05  NLFAMTL PIC S9(0004) COMP.
  1537     05  NLFAMTF PIC  X(0001).
  1538     05  FILLER REDEFINES NLFAMTF.
  1539         10  NLFAMTA PIC  X(0001).
  1540     05  NLFAMTI PIC  X(0012).
  1541*    -------------------------------
  1542     05  NAHDTL PIC S9(0004) COMP.
  1543     05  NAHDTF PIC  X(0001).
  1544     05  FILLER REDEFINES NAHDTF.
  1545         10  NAHDTA PIC  X(0001).
  1546     05  NAHDTI PIC  X(0008).
  1547*    -------------------------------
  1548     05  NAHAMTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  29
* EL6316.cbl
  1549     05  NAHAMTF PIC  X(0001).
  1550     05  FILLER REDEFINES NAHAMTF.
  1551         10  NAHAMTA PIC  X(0001).
  1552     05  NAHAMTI PIC  X(0012).
  1553*    -------------------------------
  1554     05  INPDTL PIC S9(0004) COMP.
  1555     05  INPDTF PIC  X(0001).
  1556     05  FILLER REDEFINES INPDTF.
  1557         10  INPDTA PIC  X(0001).
  1558     05  INPDTI PIC  X(0008).
  1559*    -------------------------------
  1560     05  PROCDTL PIC S9(0004) COMP.
  1561     05  PROCDTF PIC  X(0001).
  1562     05  FILLER REDEFINES PROCDTF.
  1563         10  PROCDTA PIC  X(0001).
  1564     05  PROCDTI PIC  X(0008).
  1565*    -------------------------------
  1566     05  LFCOMML PIC S9(0004) COMP.
  1567     05  LFCOMMF PIC  X(0001).
  1568     05  FILLER REDEFINES LFCOMMF.
  1569         10  LFCOMMA PIC  X(0001).
  1570     05  LFCOMMI PIC  X(0006).
  1571*    -------------------------------
  1572     05  AHCOMML PIC S9(0004) COMP.
  1573     05  AHCOMMF PIC  X(0001).
  1574     05  FILLER REDEFINES AHCOMMF.
  1575         10  AHCOMMA PIC  X(0001).
  1576     05  AHCOMMI PIC  X(0006).
  1577*    -------------------------------
  1578     05  RCD01L PIC S9(0004) COMP.
  1579     05  RCD01F PIC  X(0001).
  1580     05  FILLER REDEFINES RCD01F.
  1581         10  RCD01A PIC  X(0001).
  1582     05  RCD01I PIC  X(0004).
  1583*    -------------------------------
  1584     05  RCD02L PIC S9(0004) COMP.
  1585     05  RCD02F PIC  X(0001).
  1586     05  FILLER REDEFINES RCD02F.
  1587         10  RCD02A PIC  X(0001).
  1588     05  RCD02I PIC  X(0004).
  1589*    -------------------------------
  1590     05  RCD03L PIC S9(0004) COMP.
  1591     05  RCD03F PIC  X(0001).
  1592     05  FILLER REDEFINES RCD03F.
  1593         10  RCD03A PIC  X(0001).
  1594     05  RCD03I PIC  X(0004).
  1595*    -------------------------------
  1596     05  RCD04L PIC S9(0004) COMP.
  1597     05  RCD04F PIC  X(0001).
  1598     05  FILLER REDEFINES RCD04F.
  1599         10  RCD04A PIC  X(0001).
  1600     05  RCD04I PIC  X(0004).
  1601*    -------------------------------
  1602     05  RCD05L PIC S9(0004) COMP.
  1603     05  RCD05F PIC  X(0001).
  1604     05  FILLER REDEFINES RCD05F.
  1605         10  RCD05A PIC  X(0001).
  1606     05  RCD05I PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  30
* EL6316.cbl
  1607*    -------------------------------
  1608     05  RCD06L PIC S9(0004) COMP.
  1609     05  RCD06F PIC  X(0001).
  1610     05  FILLER REDEFINES RCD06F.
  1611         10  RCD06A PIC  X(0001).
  1612     05  RCD06I PIC  X(0004).
  1613*    -------------------------------
  1614     05  RCD07L PIC S9(0004) COMP.
  1615     05  RCD07F PIC  X(0001).
  1616     05  FILLER REDEFINES RCD07F.
  1617         10  RCD07A PIC  X(0001).
  1618     05  RCD07I PIC  X(0004).
  1619*    -------------------------------
  1620     05  RCD08L PIC S9(0004) COMP.
  1621     05  RCD08F PIC  X(0001).
  1622     05  FILLER REDEFINES RCD08F.
  1623         10  RCD08A PIC  X(0001).
  1624     05  RCD08I PIC  X(0004).
  1625*    -------------------------------
  1626     05  RCD09L PIC S9(0004) COMP.
  1627     05  RCD09F PIC  X(0001).
  1628     05  FILLER REDEFINES RCD09F.
  1629         10  RCD09A PIC  X(0001).
  1630     05  RCD09I PIC  X(0004).
  1631*    -------------------------------
  1632     05  RCD10L PIC S9(0004) COMP.
  1633     05  RCD10F PIC  X(0001).
  1634     05  FILLER REDEFINES RCD10F.
  1635         10  RCD10A PIC  X(0001).
  1636     05  RCD10I PIC  X(0004).
  1637*    -------------------------------
  1638     05  RCD11L PIC S9(0004) COMP.
  1639     05  RCD11F PIC  X(0001).
  1640     05  FILLER REDEFINES RCD11F.
  1641         10  RCD11A PIC  X(0001).
  1642     05  RCD11I PIC  X(0004).
  1643*    -------------------------------
  1644     05  RCD12L PIC S9(0004) COMP.
  1645     05  RCD12F PIC  X(0001).
  1646     05  FILLER REDEFINES RCD12F.
  1647         10  RCD12A PIC  X(0001).
  1648     05  RCD12I PIC  X(0004).
  1649*    -------------------------------
  1650     05  CRTNT1L PIC S9(0004) COMP.
  1651     05  CRTNT1F PIC  X(0001).
  1652     05  FILLER REDEFINES CRTNT1F.
  1653         10  CRTNT1A PIC  X(0001).
  1654     05  CRTNT1I PIC  X(0063).
  1655*    -------------------------------
  1656     05  CRTNT2L PIC S9(0004) COMP.
  1657     05  CRTNT2F PIC  X(0001).
  1658     05  FILLER REDEFINES CRTNT2F.
  1659         10  CRTNT2A PIC  X(0001).
  1660     05  CRTNT2I PIC  X(0063).
  1661*    -------------------------------
  1662     05  BILNT1L PIC S9(0004) COMP.
  1663     05  BILNT1F PIC  X(0001).
  1664     05  FILLER REDEFINES BILNT1F.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  31
* EL6316.cbl
  1665         10  BILNT1A PIC  X(0001).
  1666     05  BILNT1I PIC  X(0063).
  1667*    -------------------------------
  1668     05  ERRMSGL PIC S9(0004) COMP.
  1669     05  ERRMSGF PIC  X(0001).
  1670     05  FILLER REDEFINES ERRMSGF.
  1671         10  ERRMSGA PIC  X(0001).
  1672     05  ERRMSGI PIC  X(0075).
  1673*    -------------------------------
  1674     05  PFENTRL PIC S9(0004) COMP.
  1675     05  PFENTRF PIC  X(0001).
  1676     05  FILLER REDEFINES PFENTRF.
  1677         10  PFENTRA PIC  X(0001).
  1678     05  PFENTRI PIC  9(2).
  1679 01  EL631IO REDEFINES EL631II.
  1680     05  FILLER            PIC  X(0012).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  DATEO PIC  X(0008).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  TIMEO PIC  99.99.
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  PROCIDO PIC  X(0004).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  HOSTO PIC  X(0009).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  SYSO PIC  X(0005).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  COMPANYO PIC  X(0003).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  DATASORO PIC  X(0001).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  BATCHNOO PIC  X(0006).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  BSEQNOO PIC  X(0008).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  ARCHNOO PIC  X(0008).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  PRTSWO PIC  X(0001).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  CARRO PIC  X(0001).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  GROUPO PIC  X(0006).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  STATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  32
* EL6316.cbl
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  ACCTO PIC  X(0010).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  EFFDTO PIC  X(0008).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  CERTNOO PIC  X(0010).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  CRTSFXO PIC  X(0001).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  LTRIDO PIC  X(0004).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  SEQNOO PIC  999999.
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  FNAMEO PIC  X(0010).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  MINITO PIC  X(0001).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  LNAMEO PIC  X(0015).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  OLFDTO PIC  X(0008).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  OLFAMTO PIC  Z,ZZZ,999.99.
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  OAHDTO PIC  X(0008).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  OAHAMTO PIC  Z,ZZZ,999.99.
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  NLFDTO PIC  X(0008).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  NLFAMTO PIC  Z,ZZZ,999.99.
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  NAHDTO PIC  X(0008).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  NAHAMTO PIC  Z,ZZZ,999.99.
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  INPDTO PIC  X(0008).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  PROCDTO PIC  X(0008).
  1780*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  33
* EL6316.cbl
  1781     05  FILLER            PIC  X(0003).
  1782     05  LFCOMMO PIC  .99999.
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  AHCOMMO PIC  .99999.
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  RCD01O PIC  X(0004).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  RCD02O PIC  X(0004).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  RCD03O PIC  X(0004).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  RCD04O PIC  X(0004).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  RCD05O PIC  X(0004).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  RCD06O PIC  X(0004).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  RCD07O PIC  X(0004).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  RCD08O PIC  X(0004).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  RCD09O PIC  X(0004).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  RCD10O PIC  X(0004).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  RCD11O PIC  X(0004).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  RCD12O PIC  X(0004).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CRTNT1O PIC  X(0063).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  CRTNT2O PIC  X(0063).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  BILNT1O PIC  X(0063).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  ERRMSGO PIC  X(0075).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  PFENTRO PIC  X(0002).
  1837*    -------------------------------
  1838 01  FILLER REDEFINES EL631II.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  34
* EL6316.cbl
  1839     12  FILLER                   PIC X(357).
  1840     12  REASONCDS.
  1841         16  FILLER OCCURS 12.
  1842             20  REACDL       PIC S9(4) COMP.
  1843             20  REACDA       PIC X.
  1844             20  REACD-IN     PIC X(4).
  1845     12  FILLER               PIC X(215).
  1846****************************************************************
  1847*
  1848* Copyright (c) 2007 by Clerity Solutions, Inc.
  1849* All rights reserved.
  1850*
  1851****************************************************************
  1852 01  DFHEIV.
  1853   02  DFHEIV0               PIC X(35).
  1854   02  DFHEIV1               PIC X(08).
  1855   02  DFHEIV2               PIC X(08).
  1856   02  DFHEIV3               PIC X(08).
  1857   02  DFHEIV4               PIC X(06).
  1858   02  DFHEIV5               PIC X(04).
  1859   02  DFHEIV6               PIC X(04).
  1860   02  DFHEIV7               PIC X(02).
  1861   02  DFHEIV8               PIC X(02).
  1862   02  DFHEIV9               PIC X(01).
  1863   02  DFHEIV10              PIC S9(7) COMP-3.
  1864   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1865   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1866   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1867   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1868   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1869   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1870   02  DFHEIV17              PIC X(04).
  1871   02  DFHEIV18              PIC X(04).
  1872   02  DFHEIV19              PIC X(04).
  1873   02  DFHEIV20              USAGE IS POINTER.
  1874   02  DFHEIV21              USAGE IS POINTER.
  1875   02  DFHEIV22              USAGE IS POINTER.
  1876   02  DFHEIV23              USAGE IS POINTER.
  1877   02  DFHEIV24              USAGE IS POINTER.
  1878   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1879   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1880   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1881   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1882   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1883   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1884   02  FILLER                PIC X(02).
  1885   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1886   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1887   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1888   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1889   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1890 LINKAGE  SECTION.
  1891*****************************************************************
  1892*                                                               *
  1893* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1894* All rights reserved.                                          *
  1895*                                                               *
  1896*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  35
* EL6316.cbl
  1897 01  dfheiblk.
  1898     02  eibtime          pic s9(7) comp-3.
  1899     02  eibdate          pic s9(7) comp-3.
  1900     02  eibtrnid         pic x(4).
  1901     02  eibtaskn         pic s9(7) comp-3.
  1902     02  eibtrmid         pic x(4).
  1903     02  dfheigdi         pic s9(4) comp.
  1904     02  eibcposn         pic s9(4) comp.
  1905     02  eibcalen         pic s9(4) comp.
  1906     02  eibaid           pic x(1).
  1907     02  eibfiller1       pic x(1).
  1908     02  eibfn            pic x(2).
  1909     02  eibfiller2       pic x(2).
  1910     02  eibrcode         pic x(6).
  1911     02  eibfiller3       pic x(2).
  1912     02  eibds            pic x(8).
  1913     02  eibreqid         pic x(8).
  1914     02  eibrsrce         pic x(8).
  1915     02  eibsync          pic x(1).
  1916     02  eibfree          pic x(1).
  1917     02  eibrecv          pic x(1).
  1918     02  eibsend          pic x(1).
  1919     02  eibatt           pic x(1).
  1920     02  eibeoc           pic x(1).
  1921     02  eibfmh           pic x(1).
  1922     02  eibcompl         pic x(1).
  1923     02  eibsig           pic x(1).
  1924     02  eibconf          pic x(1).
  1925     02  eiberr           pic x(1).
  1926     02  eibrldbk         pic x(1).
  1927     02  eiberrcd         pic x(4).
  1928     02  eibsynrb         pic x(1).
  1929     02  eibnodat         pic x(1).
  1930     02  eibfiller5       pic x(2).
  1931     02  eibresp          pic 9(09) comp.
  1932     02  eibresp2         pic 9(09) comp.
  1933     02  dfheigdj         pic s9(4) comp.
  1934     02  dfheigdk         pic s9(4) comp.
  1935 01  DFHCOMMAREA                 PIC X(1300).
  1936 01  var  pic x(30).
  1937*                                COPY ERCACCT.
  1938******************************************************************
  1939*                                                                *
  1940*                                                                *
  1941*                            ERCACCT                             *
  1942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1943*                            VMOD=2.031                          *
  1944*                                                                *
  1945*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1946*                                                                *
  1947*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1948*   VSAM ACCOUNT MASTER FILES.                                   *
  1949*                                                                *
  1950*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1951*                                                                *
  1952*   FILE TYPE = VSAM,KSDS                                        *
  1953*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1954*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  36
* EL6316.cbl
  1955*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1956*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1957*                                                                *
  1958*   LOG = NO                                                     *
  1959*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1960*                                                                *
  1961*                                                                *
  1962******************************************************************
  1963*                   C H A N G E   L O G
  1964*
  1965* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1966*-----------------------------------------------------------------
  1967*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1968* EFFECTIVE    NUMBER
  1969*-----------------------------------------------------------------
  1970* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1971* 092705    2005050300006  PEMA  ADD SPP LEASES
  1972* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1973* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1974* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1975* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1976* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1977******************************************************************
  1978
  1979 01  ACCOUNT-MASTER.
  1980     12  AM-RECORD-ID                      PIC XX.
  1981         88  VALID-AM-ID                      VALUE 'AM'.
  1982
  1983     12  AM-CONTROL-PRIMARY.
  1984         16  AM-COMPANY-CD                 PIC X.
  1985         16  AM-MSTR-CNTRL.
  1986             20  AM-CONTROL-A.
  1987                 24  AM-CARRIER            PIC X.
  1988                 24  AM-GROUPING.
  1989                     28 AM-GROUPING-PREFIX PIC XXX.
  1990                     28 AM-GROUPING-PRIME  PIC XXX.
  1991                 24  AM-STATE              PIC XX.
  1992                 24  AM-ACCOUNT.
  1993                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1994                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1995             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1996                                           PIC X(19).
  1997             20  AM-CNTRL-B.
  1998                 24  AM-EXPIRATION-DT      PIC XX.
  1999                 24  FILLER                PIC X(4).
  2000             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2001                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2002
  2003     12  AM-CONTROL-BY-VAR-GRP.
  2004         16  AM-COMPANY-CD-A1              PIC X.
  2005         16  AM-VG-CARRIER                 PIC X.
  2006         16  AM-VG-GROUPING                PIC X(6).
  2007         16  AM-VG-STATE                   PIC XX.
  2008         16  AM-VG-ACCOUNT                 PIC X(10).
  2009         16  AM-VG-DATE.
  2010             20  AM-VG-EXPIRATION-DT       PIC XX.
  2011             20  FILLER                    PIC X(4).
  2012         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  37
* EL6316.cbl
  2013                                           PIC 9(11)      COMP-3.
  2014     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2015         16  FILLER                        PIC X(10).
  2016         16  AM-VG-KEY3.
  2017             20  AM-VG3-ACCOUNT            PIC X(10).
  2018             20  AM-VG3-EXP-DT             PIC XX.
  2019         16  FILLER                        PIC X(4).
  2020     12  AM-MAINT-INFORMATION.
  2021         16  AM-LAST-MAINT-DT              PIC XX.
  2022         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2023         16  AM-LAST-MAINT-USER            PIC X(4).
  2024         16  FILLER                        PIC XX.
  2025
  2026     12  AM-EFFECTIVE-DT                   PIC XX.
  2027     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2028
  2029     12  AM-PREV-DATES  COMP-3.
  2030         16  AM-PREV-EXP-DT                PIC 9(11).
  2031         16  AM-PREV-EFF-DT                PIC 9(11).
  2032
  2033     12  AM-REPORT-CODE-1                  PIC X(10).
  2034     12  AM-REPORT-CODE-2                  PIC X(10).
  2035
  2036     12  AM-CITY-CODE                      PIC X(4).
  2037     12  AM-COUNTY-PARISH                  PIC X(6).
  2038
  2039     12  AM-NAME                           PIC X(30).
  2040     12  AM-PERSON                         PIC X(30).
  2041     12  AM-ADDRS                          PIC X(30).
  2042     12  AM-CITY.
  2043         16  AM-ADDR-CITY                  PIC X(28).
  2044         16  AM-ADDR-STATE                 PIC XX.
  2045     12  AM-ZIP.
  2046         16  AM-ZIP-PRIME.
  2047             20  AM-ZIP-PRI-1ST            PIC X.
  2048                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2049             20  FILLER                    PIC X(4).
  2050         16  AM-ZIP-PLUS4                  PIC X(4).
  2051     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2052         16  AM-CAN-POSTAL-1               PIC XXX.
  2053         16  AM-CAN-POSTAL-2               PIC XXX.
  2054         16  FILLER                        PIC XXX.
  2055     12  AM-TEL-NO.
  2056         16  AM-AREA-CODE                  PIC 999.
  2057         16  AM-TEL-PRE                    PIC 999.
  2058         16  AM-TEL-NBR                    PIC 9(4).
  2059     12  AM-TEL-LOC                        PIC X.
  2060         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2061         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2062
  2063     12  AM-COMM-STRUCTURE.
  2064         16  AM-DEFN-1.
  2065             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2066                 24  AM-AGT.
  2067                     28  AM-AGT-PREFIX     PIC X(4).
  2068                     28  AM-AGT-PRIME      PIC X(6).
  2069                 24  AM-COM-TYP            PIC X.
  2070                 24  AM-L-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  38
* EL6316.cbl
  2071                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2072                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2073                 24  AM-RECALC-LV-INDIC    PIC X.
  2074                 24  AM-RETRO-LV-INDIC     PIC X.
  2075                 24  AM-GL-CODES           PIC X.
  2076                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2077                 24  FILLER                PIC X(01).
  2078         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2079             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2080                 24  FILLER                PIC X(11).
  2081                 24  AM-L-COMA             PIC XXX.
  2082                 24  AM-J-COMA             PIC XXX.
  2083                 24  AM-A-COMA             PIC XXX.
  2084                 24  FILLER                PIC X(6).
  2085
  2086     12  AM-COMM-CHANGE-STATUS             PIC X.
  2087         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2088
  2089     12  AM-CSR-CODE                       PIC X(4).
  2090
  2091     12  AM-BILLING-STATUS                 PIC X.
  2092         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2093         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2094     12  AM-AUTO-REFUND-SW                 PIC X.
  2095         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2096         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2097     12  AM-GPCD                           PIC 99.
  2098     12  AM-IG                             PIC X.
  2099         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2100         88  AM-HAS-GROUP                     VALUE '2'.
  2101     12  AM-STATUS                         PIC X.
  2102         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2103         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2104         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2105         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2106         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2107         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2108     12  AM-REMIT-TO                       PIC 99.
  2109     12  AM-ID-NO                          PIC X(11).
  2110
  2111     12  AM-CAL-TABLE                      PIC XX.
  2112     12  AM-LF-DEVIATION                   PIC XXX.
  2113     12  AM-AH-DEVIATION                   PIC XXX.
  2114     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2115     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2116     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2117     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2118     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2119     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2120
  2121     12  AM-USER-FIELDS.
  2122         16  AM-FLD-1                      PIC XX.
  2123         16  AM-FLD-2                      PIC XX.
  2124         16  AM-FLD-3                      PIC XX.
  2125         16  AM-FLD-4                      PIC XX.
  2126         16  AM-FLD-5                      PIC XX.
  2127
  2128     12  AM-1ST-PROD-DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  39
* EL6316.cbl
  2129         16  AM-1ST-PROD-YR                PIC XX.
  2130         16  AM-1ST-PROD-MO                PIC XX.
  2131         16  AM-1ST-PROD-DA                PIC XX.
  2132     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2133     12  AM-CERTS-PURGED-DATE.
  2134         16  AM-PUR-YR                     PIC XX.
  2135         16  AM-PUR-MO                     PIC XX.
  2136         16  AM-PUR-DA                     PIC XX.
  2137     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2138     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2139     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2140     12  AM-INACTIVE-DATE.
  2141         16  AM-INA-MO                     PIC 99.
  2142         16  AM-INA-DA                     PIC 99.
  2143         16  AM-INA-YR                     PIC 99.
  2144     12  AM-AR-HI-CERT-DATE                PIC XX.
  2145
  2146     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2147     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2148
  2149     12  AM-OB-PAYMENT-MODE                PIC X.
  2150         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2151         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2152         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2153         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2154
  2155     12  AM-AH-ONLY-INDICATOR              PIC X.
  2156         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2157         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2158
  2159     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2160
  2161     12  AM-OVER-SHORT.
  2162         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2163         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2164
  2165     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2166     12  AM-DCC-CLP-STATE                  PIC XX.
  2167
  2168     12  AM-RECALC-COMM                    PIC X.
  2169     12  AM-RECALC-REIN                    PIC X.
  2170
  2171     12  AM-REI-TABLE                      PIC XXX.
  2172     12  AM-REI-ET-LF                      PIC X.
  2173     12  AM-REI-ET-AH                      PIC X.
  2174     12  AM-REI-PE-LF                      PIC X.
  2175     12  AM-REI-PE-AH                      PIC X.
  2176     12  AM-REI-PRT-ST                     PIC X.
  2177     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2178     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2179     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2180     12  AM-REI-GROUP-A                    PIC X(6).
  2181     12  AM-REI-MORT                       PIC X(4).
  2182     12  AM-REI-PRT-OW                     PIC X.
  2183     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2184     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2185     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2186     12  AM-REI-GROUP-B                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  40
* EL6316.cbl
  2187
  2188     12  AM-TRUST-TYPE                     PIC X(2).
  2189
  2190     12  AM-EMPLOYER-STMT-USED             PIC X.
  2191     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2192
  2193     12  AM-STD-AH-TYPE                    PIC XX.
  2194     12  AM-EARN-METHODS.
  2195         16  AM-EARN-METHOD-R              PIC X.
  2196             88 AM-REF-RL-R78                 VALUE 'R'.
  2197             88 AM-REF-RL-PR                  VALUE 'P'.
  2198             88 AM-REF-RL-MEAN                VALUE 'M'.
  2199             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2200         16  AM-EARN-METHOD-L              PIC X.
  2201             88 AM-REF-LL-R78                 VALUE 'R'.
  2202             88 AM-REF-LL-PR                  VALUE 'P'.
  2203             88 AM-REF-LL-MEAN                VALUE 'M'.
  2204             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2205         16  AM-EARN-METHOD-A              PIC X.
  2206             88 AM-REF-AH-R78                 VALUE 'R'.
  2207             88 AM-REF-AH-PR                  VALUE 'P'.
  2208             88 AM-REF-AH-MEAN                VALUE 'M'.
  2209             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2210             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2211             88 AM-REF-AH-NET                 VALUE 'N'.
  2212
  2213     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2214     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2215     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2216
  2217     12  AM-RET-Y-N                        PIC X.
  2218     12  AM-RET-P-E                        PIC X.
  2219     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2220     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2221     12  AM-RET-GRP                        PIC X(6).
  2222     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2223         16  AM-POOL-PRIME                 PIC XXX.
  2224         16  AM-POOL-SUB                   PIC XXX.
  2225     12  AM-RETRO-EARNINGS.
  2226         16  AM-RET-EARN-R                 PIC X.
  2227         16  AM-RET-EARN-L                 PIC X.
  2228         16  AM-RET-EARN-A                 PIC X.
  2229     12  AM-RET-ST-TAX-USE                 PIC X.
  2230         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2231         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2232     12  AM-RETRO-BEG-EARNINGS.
  2233         16  AM-RET-BEG-EARN-R             PIC X.
  2234         16  AM-RET-BEG-EARN-L             PIC X.
  2235         16  AM-RET-BEG-EARN-A             PIC X.
  2236     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2237     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2238
  2239     12  AM-USER-SELECT-OPTIONS.
  2240         16  AM-USER-SELECT-1              PIC X(10).
  2241         16  AM-USER-SELECT-2              PIC X(10).
  2242         16  AM-USER-SELECT-3              PIC X(10).
  2243         16  AM-USER-SELECT-4              PIC X(10).
  2244         16  AM-USER-SELECT-5              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  41
* EL6316.cbl
  2245
  2246     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2247
  2248     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2249
  2250     12  AM-RPT045A-SWITCH                 PIC X.
  2251         88  RPT045A-OFF                   VALUE 'N'.
  2252
  2253     12  AM-INSURANCE-LIMITS.
  2254         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2255         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2256
  2257     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2258         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2259
  2260     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2261         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2262         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2263
  2264     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2265
  2266     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2267     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2268     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2269     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2270     12  AM-DCC-UEF-STATE                  PIC XX.
  2271     12  FILLER                            PIC XXX.
  2272     12  AM-REPORT-CODE-3                  PIC X(10).
  2273*    12  FILLER                            PIC X(22).
  2274
  2275     12  AM-RESERVE-DATE.
  2276         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2277         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2278         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2279
  2280     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2281     12  AM-NOTIFICATION-TYPES.
  2282         16  AM-NOTIF-OF-LETTERS           PIC X.
  2283         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2284         16  AM-NOTIF-OF-REPORTS           PIC X.
  2285         16  AM-NOTIF-OF-STATUS            PIC X.
  2286
  2287     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2288         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2289         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2290         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2291         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2292
  2293     12  AM-BENEFIT-CONTROLS.
  2294         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2295             20  AM-BENEFIT-CODE           PIC XX.
  2296             20  AM-BENEFIT-TYPE           PIC X.
  2297             20  AM-BENEFIT-REVISION       PIC XXX.
  2298             20  AM-BENEFIT-REM-TERM       PIC X.
  2299             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2300             20  FILLER                    PIC XX.
  2301         16  FILLER                        PIC X(80).
  2302
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  42
* EL6316.cbl
  2303     12  AM-TRANSFER-DATA.
  2304         16  AM-TRANSFERRED-FROM.
  2305             20  AM-TRNFROM-CARRIER        PIC X.
  2306             20  AM-TRNFROM-GROUPING.
  2307                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2308                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2309             20  AM-TRNFROM-STATE          PIC XX.
  2310             20  AM-TRNFROM-ACCOUNT.
  2311                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2312                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2313             20  AM-TRNFROM-DTE            PIC XX.
  2314         16  AM-TRANSFERRED-TO.
  2315             20  AM-TRNTO-CARRIER          PIC X.
  2316             20  AM-TRNTO-GROUPING.
  2317                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2318                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2319             20  AM-TRNTO-STATE            PIC XX.
  2320             20  AM-TRNTO-ACCOUNT.
  2321                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2322                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2323             20  AM-TRNTO-DTE              PIC XX.
  2324         16  FILLER                        PIC X(10).
  2325
  2326     12  AM-SAVED-REMIT-TO                 PIC 99.
  2327
  2328     12  AM-COMM-STRUCTURE-SAVED.
  2329         16  AM-DEFN-1-SAVED.
  2330             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2331                 24  AM-AGT-SV             PIC X(10).
  2332                 24  AM-COM-TYP-SV         PIC X.
  2333                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2334                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2335                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2336                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2337                 24  FILLER                PIC X.
  2338                 24  AM-GL-CODES-SV        PIC X.
  2339                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2340                 24  FILLER                PIC X.
  2341         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2342             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2343                 24  FILLER                PIC X(11).
  2344                 24  AM-L-COMA-SV          PIC XXX.
  2345                 24  AM-J-COMA-SV          PIC XXX.
  2346                 24  AM-A-COMA-SV          PIC XXX.
  2347                 24  FILLER                PIC X(6).
  2348
  2349     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2350         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2351            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2352            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2353            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2354
  2355     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2356     12  FILLER                            PIC X(120).
  2357
  2358     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2359         16  AM-CONTROL-NAME               PIC X(30).
  2360         16  AM-EXECUTIVE-ONE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  43
* EL6316.cbl
  2361             20  AM-EXEC1-NAME             PIC X(15).
  2362             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2363                                                          COMP-3.
  2364             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2365                                                          COMP-3.
  2366         16  AM-EXECUTIVE-TWO.
  2367             20  AM-EXEC2-NAME             PIC X(15).
  2368             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2369                                                          COMP-3.
  2370             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2371                                                          COMP-3.
  2372
  2373     12  AM-RETRO-ADDITIONAL-DATA.
  2374         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2375         16  AM-RETRO-PREM-P-E             PIC X.
  2376         16  AM-RETRO-CLMS-P-I             PIC X.
  2377         16  AM-RETRO-RET-BRACKET-LF.
  2378             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2379                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2380                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2381             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2382                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2383                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2384             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2385                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2386                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2387         16  AM-RETRO-RET-BRACKET-AH.
  2388             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2389                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2390                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2391                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2392             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2393                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2394                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2395             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2396                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2397                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2398
  2399     12  AM-COMMENTS.
  2400         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2401
  2402     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2403         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2404         16  AM-FLI-BILLING-CODE           PIC X.
  2405         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2406         16  AM-FLI-UNITED-IDENT           PIC X.
  2407         16  AM-FLI-INTEREST-LOST-DATA.
  2408             20  AM-FLI-BANK-NO            PIC X(5).
  2409             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2410             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2411             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2412         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2413             20  AM-FLI-AGT                PIC X(9).
  2414             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2415             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2416         16  FILLER                        PIC X(102).
  2417
  2418     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  44
* EL6316.cbl
  2419         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2420             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2421             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2422             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2423             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2424             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2425         16  FILLER                          PIC X(10).
  2426******************************************************************
  2427*                                COPY ELCCNTL.
  2428******************************************************************
  2429*                                                                *
  2430*                                                                *
  2431*                            ELCCNTL.                            *
  2432*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2433*                            VMOD=2.059                          *
  2434*                                                                *
  2435*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2436*                                                                *
  2437*   FILE TYPE = VSAM,KSDS                                        *
  2438*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2439*                                                                *
  2440*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2441*       ALTERNATE INDEX = NONE                                   *
  2442*                                                                *
  2443*   LOG = YES                                                    *
  2444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2445******************************************************************
  2446*                   C H A N G E   L O G
  2447*
  2448* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2449*-----------------------------------------------------------------
  2450*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2451* EFFECTIVE    NUMBER
  2452*-----------------------------------------------------------------
  2453* 082503                   PEMA  ADD BENEFIT GROUP
  2454* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2455* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2456* 092705    2005050300006  PEMA  ADD SPP LEASES
  2457* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2458* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2459* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2460* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2461* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2462* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2463******************************************************************
  2464*
  2465 01  CONTROL-FILE.
  2466     12  CF-RECORD-ID                       PIC XX.
  2467         88  VALID-CF-ID                        VALUE 'CF'.
  2468
  2469     12  CF-CONTROL-PRIMARY.
  2470         16  CF-COMPANY-ID                  PIC XXX.
  2471         16  CF-RECORD-TYPE                 PIC X.
  2472             88  CF-COMPANY-MASTER              VALUE '1'.
  2473             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2474             88  CF-STATE-MASTER                VALUE '3'.
  2475             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2476             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  45
* EL6316.cbl
  2477             88  CF-CARRIER-MASTER              VALUE '6'.
  2478             88  CF-MORTALITY-MASTER            VALUE '7'.
  2479             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2480             88  CF-TERMINAL-MASTER             VALUE '9'.
  2481             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2482             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2483             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2484             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2485             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2486             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2487             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2488             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2489             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2490         16  CF-ACCESS-CD-GENL              PIC X(4).
  2491         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2492             20  CF-PROCESSOR               PIC X(4).
  2493         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2494             20  CF-STATE-CODE              PIC XX.
  2495             20  FILLER                     PIC XX.
  2496         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2497             20  FILLER                     PIC XX.
  2498             20  CF-HI-BEN-IN-REC           PIC XX.
  2499         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2500             20  FILLER                     PIC XXX.
  2501             20  CF-CARRIER-CNTL            PIC X.
  2502         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2503             20  FILLER                     PIC XX.
  2504             20  CF-HI-TYPE-IN-REC          PIC 99.
  2505         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2506             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2507                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2508             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2509             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2510         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2511             20  FILLER                     PIC X.
  2512             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2513         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2514             20  FILLER                     PIC XX.
  2515             20  CF-MORTGAGE-PLAN           PIC XX.
  2516         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2517
  2518     12  CF-LAST-MAINT-DT                   PIC XX.
  2519     12  CF-LAST-MAINT-BY                   PIC X(4).
  2520     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2521
  2522     12  CF-RECORD-BODY                     PIC X(728).
  2523
  2524
  2525****************************************************************
  2526*             COMPANY MASTER RECORD                            *
  2527****************************************************************
  2528
  2529     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2530         16  CF-COMPANY-ADDRESS.
  2531             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2532             20  CF-CL-IN-CARE-OF           PIC X(30).
  2533             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2534             20  CF-CL-ADDR-LINE-2          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  46
* EL6316.cbl
  2535             20  CF-CL-CITY-STATE           PIC X(30).
  2536             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2537             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2538         16  CF-COMPANY-CD                  PIC X.
  2539         16  CF-COMPANY-PASSWORD            PIC X(8).
  2540         16  CF-SECURITY-OPTION             PIC X.
  2541             88  ALL-SECURITY                   VALUE '1'.
  2542             88  COMPANY-VERIFY                 VALUE '2'.
  2543             88  PROCESSOR-VERIFY               VALUE '3'.
  2544             88  NO-SECURITY                    VALUE '4'.
  2545             88  ALL-BUT-TERM                   VALUE '5'.
  2546         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2547             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2548         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2549             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2550         16  CF-INFORCE-LOCATION            PIC X.
  2551             88  CERTS-ARE-ONLINE               VALUE '1'.
  2552             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2553             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2554         16  CF-LOWER-CASE-LETTERS          PIC X.
  2555         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2556             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2557             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2558             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2559             88  CF-ACCNT-CNTL                  VALUE '3'.
  2560             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2561
  2562         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2563         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2564
  2565         16  CF-LGX-CREDIT-USER             PIC X.
  2566             88  CO-IS-NOT-USER                 VALUE 'N'.
  2567             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2568
  2569         16 CF-CREDIT-CALC-CODES.
  2570             20  CF-CR-REM-TERM-CALC PIC X.
  2571               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2572               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2573               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2574               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2575               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2576               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2577               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2578             20  CF-CR-R78-METHOD           PIC X.
  2579               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2580               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2581
  2582         16  CF-CLAIM-CONTROL-COUNTS.
  2583             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2584                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2585
  2586             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2587                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2588
  2589             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2590                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2591
  2592             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  47
* EL6316.cbl
  2593                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2594
  2595         16  CF-CURRENT-MONTH-END           PIC XX.
  2596
  2597         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2598             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2599             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2600             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2601             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2602                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2603                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2604             20  CF-CO-PREM-REJECT-SW       PIC X.
  2605                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2606                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2607             20  CF-CO-REF-REJECT-SW        PIC X.
  2608                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2609                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2610
  2611         16  CF-CO-REPORTING-DT             PIC XX.
  2612         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2613         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2614           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2615           88  CF-CO-MONTH-END                  VALUE '1'.
  2616
  2617         16  CF-LGX-CLAIM-USER              PIC X.
  2618             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2619             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2620
  2621         16  CF-CREDIT-EDIT-CONTROLS.
  2622             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2623             20  CF-MIN-AGE                 PIC 99.
  2624             20  CF-DEFAULT-AGE             PIC 99.
  2625             20  CF-MIN-TERM                PIC S999      COMP-3.
  2626             20  CF-MAX-TERM                PIC S999      COMP-3.
  2627             20  CF-DEFAULT-SEX             PIC X.
  2628             20  CF-JOINT-AGE-INPUT         PIC X.
  2629                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2630             20  CF-BIRTH-DATE-INPUT        PIC X.
  2631                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2632             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2633                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2634                 88  CF-ZERO-CARRIER            VALUE '1'.
  2635                 88  CF-ZERO-GROUPING           VALUE '2'.
  2636                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2637             20  CF-EDIT-SW                 PIC X.
  2638                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2639             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2640             20  CF-CR-PR-METHOD            PIC X.
  2641               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2642               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2643             20  FILLER                     PIC X.
  2644
  2645         16  CF-CREDIT-MISC-CONTROLS.
  2646             20  CF-REIN-TABLE-SW           PIC X.
  2647                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2648             20  CF-COMP-TABLE-SW           PIC X.
  2649                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2650             20  CF-EXPERIENCE-RETENTION-AGE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  48
* EL6316.cbl
  2651                                            PIC S9        COMP-3.
  2652             20  CF-CONVERSION-DT           PIC XX.
  2653             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2654             20  CF-RUN-FREQUENCY-SW        PIC X.
  2655                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2656                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2657
  2658             20  CF-CR-CHECK-NO-CONTROL.
  2659                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2660                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2661                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2662                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2663                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2664                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2665
  2666                 24  CF-CR-CHECK-COUNT       REDEFINES
  2667                     CF-CR-CHECK-COUNTER      PIC X(4).
  2668
  2669                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2670                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2671
  2672                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2673                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2674                 24  CF-MAIL-PROCESSING       PIC X.
  2675                     88  MAIL-PROCESSING          VALUE 'Y'.
  2676
  2677         16  CF-MISC-SYSTEM-CONTROL.
  2678             20  CF-SYSTEM-C                 PIC X.
  2679                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2680             20  CF-SYSTEM-D                 PIC X.
  2681                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2682             20  CF-SOC-SEC-NO-SW            PIC X.
  2683                 88  SOC-SEC-NO-USED             VALUE '1'.
  2684             20  CF-MEMBER-NO-SW             PIC X.
  2685                 88  MEMBER-NO-USED              VALUE '1'.
  2686             20  CF-TAX-ID-NUMBER            PIC X(11).
  2687             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2688             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2689                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2690                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2691                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2692                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2693             20  CF-SYSTEM-E                 PIC X.
  2694                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2695
  2696         16  CF-LGX-LIFE-USER               PIC X.
  2697             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2698             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2699
  2700         16  CF-CR-MONTH-END-DT             PIC XX.
  2701
  2702         16  CF-FILE-MAINT-DATES.
  2703             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2704                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2705             20  CF-LAST-BATCH       REDEFINES
  2706                 CF-LAST-BATCH-NO               PIC X(4).
  2707             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2708             20  CF-RATES-FILE-CREATE-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  49
* EL6316.cbl
  2709             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2710             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2711             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2712             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2713             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2714             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2715             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2716             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2717
  2718         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2719         16  FILLER                         PIC X.
  2720
  2721         16  CF-ALT-MORT-CODE               PIC X(4).
  2722         16  CF-MEMBER-CAPTION              PIC X(10).
  2723
  2724         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2725             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2726             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2727             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2728             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2729             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2730
  2731         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2732
  2733         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2734         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2735         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2736         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2737
  2738         16  CF-AH-OVERRIDE-L1              PIC X.
  2739         16  CF-AH-OVERRIDE-L2              PIC XX.
  2740         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2741         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2742
  2743         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2744         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2745
  2746         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2747         16  CF-AR-LAST-EL860-DT            PIC XX.
  2748         16  CF-MP-MONTH-END-DT             PIC XX.
  2749
  2750         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2751         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2752             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2753
  2754         16  CF-AR-MONTH-END-DT             PIC XX.
  2755
  2756         16  CF-CRDTCRD-USER                PIC X.
  2757             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2758             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2759
  2760         16  CF-CC-MONTH-END-DT             PIC XX.
  2761
  2762         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2763
  2764         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2765             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2766             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  50
* EL6316.cbl
  2767             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2768         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2769         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2770         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2771         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2772             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2773             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2774         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2775         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2776         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2777             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2778         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2779
  2780         16  CF-CL-ZIP-CODE.
  2781             20  CF-CL-ZIP-PRIME.
  2782                 24  CF-CL-ZIP-1ST          PIC X.
  2783                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2784                 24  FILLER                 PIC X(4).
  2785             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2786         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2787             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2788             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2789             20  FILLER                     PIC XXX.
  2790
  2791         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2792         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2793         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2794         16  CF-CO-OPTION-START-DATE        PIC XX.
  2795         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2796           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2797                                                      '3' '4'.
  2798           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2799           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2800           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2801           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2802           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2803           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2804
  2805         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2806
  2807         16  CF-PAYMENT-APPROVAL-LEVELS.
  2808             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2809             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2810             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2811             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2812             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2813             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2814
  2815         16  CF-END-USER-REPORTING-USER     PIC X.
  2816             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2817             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2818
  2819         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2820             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2821             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2822
  2823         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2824
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  51
* EL6316.cbl
  2825         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2826         16  FILLER                         PIC X.
  2827
  2828         16  CF-CREDIT-ARCHIVE-CNTL.
  2829             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2830             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2831             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2832
  2833         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2834
  2835         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2836             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2837             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2838
  2839         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2840             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2841             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2842
  2843         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2844
  2845         16  CF-CO-ACH-ID-CODE              PIC  X.
  2846             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2847             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2848             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2849         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2850         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2851         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2852         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2853         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2854         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2855         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2856         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2857         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2858                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2859         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2860                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2861
  2862         16  CF-CO-OVER-SHORT.
  2863             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2864             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2865
  2866*         16  FILLER                         PIC X(102).
  2867         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2868             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2869             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2870
  2871         16  CF-AH-APPROVAL-DAYS.
  2872             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2873             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2874             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2875             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2876
  2877         16  FILLER                         PIC X(82).
  2878****************************************************************
  2879*             PROCESSOR/USER RECORD                            *
  2880****************************************************************
  2881
  2882     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  52
* EL6316.cbl
  2883         16  CF-PROCESSOR-NAME              PIC X(30).
  2884         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2885         16  CF-PROCESSOR-TITLE             PIC X(26).
  2886         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2887                 88  MESSAGE-YES                VALUE 'Y'.
  2888                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2889
  2890*****************************************************
  2891****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2892****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2893****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2894****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2895*****************************************************
  2896
  2897         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2898             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2899             20  CF-APPLICATION-FORCE       PIC X.
  2900             20  CF-INDIVIDUAL-APP.
  2901                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2902                     28  CF-BROWSE-APP      PIC X.
  2903                     28  CF-UPDATE-APP      PIC X.
  2904
  2905         16  CF-CURRENT-TERM-ON             PIC X(4).
  2906         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2907             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2908             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2909             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2910             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2911             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2912             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2913             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2914         16  CF-PROCESSOR-CARRIER           PIC X.
  2915             88  NO-CARRIER-SECURITY            VALUE ' '.
  2916         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2917             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2918         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2919             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2920         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2921             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2922
  2923         16  CF-PROC-SYS-ACCESS-SW.
  2924             20  CF-PROC-CREDIT-CLAIMS-SW.
  2925                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2926                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2927                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2928                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2929             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2930                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2931                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2932             20  CF-PROC-LIFE-GNRLDGR-SW.
  2933                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2934                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2935                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2936                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2937             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2938                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2939                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2940         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  53
* EL6316.cbl
  2941             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2942             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2943         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2944
  2945         16  CF-APPROVAL-LEVEL                  PIC X.
  2946             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2947             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2948             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2949             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2950
  2951         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2952
  2953         16  CF-LANGUAGE-TYPE                   PIC X.
  2954             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2955             88  CF-LANG-IS-FR                      VALUE 'F'.
  2956
  2957         16  CF-CSR-IND                         PIC X.
  2958         16  FILLER                             PIC X(239).
  2959
  2960****************************************************************
  2961*             PROCESSOR/REMINDERS RECORD                       *
  2962****************************************************************
  2963
  2964     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2965         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2966             20  CF-START-REMIND-DT         PIC XX.
  2967             20  CF-END-REMIND-DT           PIC XX.
  2968             20  CF-REMINDER-TEXT           PIC X(50).
  2969         16  FILLER                         PIC X(296).
  2970
  2971
  2972****************************************************************
  2973*             STATE MASTER RECORD                              *
  2974****************************************************************
  2975
  2976     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2977         16  CF-STATE-ABBREVIATION          PIC XX.
  2978         16  CF-STATE-NAME                  PIC X(25).
  2979         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2980         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2981             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2982             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2983             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2984             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2985                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2986                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2987             20  CF-ST-PREM-REJECT-SW       PIC X.
  2988                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2989                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2990             20  CF-ST-REF-REJECT-SW        PIC X.
  2991                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2992                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2993         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2994         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2995         16  CF-ST-REFUND-RULES.
  2996             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2997             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2998             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  54
* EL6316.cbl
  2999         16  CF-ST-FST-PMT-EXTENSION.
  3000             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3001             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3002                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3003                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3004                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3005                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3006         16  CF-ST-STATE-CALL.
  3007             20  CF-ST-CALL-UNEARNED        PIC X.
  3008             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3009             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3010         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3011             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3012             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3013         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3014         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3015         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3016         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3017         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3018         16  FILLER                         PIC X.
  3019         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3020             20  CF-ST-BENEFIT-CD           PIC XX.
  3021             20  CF-ST-BENEFIT-KIND         PIC X.
  3022                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3023                 88  CF-ST-AH-KIND              VALUE 'A'.
  3024             20  CF-ST-REM-TERM-CALC        PIC X.
  3025                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3026                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3027                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3028                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3029                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3030                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3031                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3032                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3033
  3034             20  CF-ST-REFUND-CALC          PIC X.
  3035                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3036                 88  ST-REFD-BY-R78             VALUE '1'.
  3037                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3038                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3039                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3040                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3041                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3042                 88  ST-REFD-UTAH               VALUE '7'.
  3043                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3044                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3045                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3046
  3047             20  CF-ST-EARNING-CALC         PIC X.
  3048                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3049                 88  ST-EARN-BY-R78             VALUE '1'.
  3050                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3051                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3052                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3053                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3054                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3055                 88  ST-EARN-MEAN               VALUE '8'.
  3056                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  55
* EL6316.cbl
  3057
  3058             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3059                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3060                 88  ST-OVRD-BY-R78             VALUE '1'.
  3061                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3062                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3063                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3064                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3065                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3066                 88  ST-OVRD-MEAN               VALUE '8'.
  3067                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3068             20  FILLER                     PIC X.
  3069
  3070         16  CF-ST-COMMISSION-CAPS.
  3071             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3072             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3073             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3074             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3075         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3076                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3077
  3078         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3079
  3080         16  CF-ST-STATUTORY-INTEREST.
  3081             20  CF-ST-STAT-DATE-FROM       PIC X.
  3082                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3083                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3084             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3085             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3086             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3087             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3088             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3089
  3090         16  CF-ST-OVER-SHORT.
  3091             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3092             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3093
  3094         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3095
  3096         16  CF-ST-RT-CALC                  PIC X.
  3097
  3098         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3099         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3100         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3101         16  CF-ST-RF-LR-CALC               PIC X.
  3102         16  CF-ST-RF-LL-CALC               PIC X.
  3103         16  CF-ST-RF-LN-CALC               PIC X.
  3104         16  CF-ST-RF-AH-CALC               PIC X.
  3105         16  CF-ST-RF-CP-CALC               PIC X.
  3106*        16  FILLER                         PIC X(206).
  3107*CIDMOD         16  FILLER                         PIC X(192).
  3108         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3109             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3110         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3111         16  CF-ST-VFY-2ND-BENE             PIC X.
  3112         16  FILLER                         PIC X(186).
  3113
  3114****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  56
* EL6316.cbl
  3115*             BENEFIT MASTER RECORD                            *
  3116****************************************************************
  3117
  3118     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3119         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3120             20  CF-BENEFIT-CODE            PIC XX.
  3121             20  CF-BENEFIT-NUMERIC  REDEFINES
  3122                 CF-BENEFIT-CODE            PIC XX.
  3123             20  CF-BENEFIT-ALPHA           PIC XXX.
  3124             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3125             20  CF-BENEFIT-COMMENT         PIC X(10).
  3126
  3127             20  CF-LF-COVERAGE-TYPE        PIC X.
  3128                 88  CF-REDUCING                VALUE 'R'.
  3129                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3130
  3131             20  CF-SPECIAL-CALC-CD         PIC X.
  3132                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3133                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3134                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3135                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3136                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3137                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3138                 88  CF-FARM-PLAN               VALUE 'F'.
  3139                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3140                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3141                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3142                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3143                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3144                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3145                 88  CF-PRUDENTIAL              VALUE 'P'.
  3146                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3147                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3148                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3149                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3150                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3151                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3152
  3153             20  CF-JOINT-INDICATOR         PIC X.
  3154                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3155
  3156*            20  FILLER                     PIC X(12).
  3157             20  FILLER                     PIC X(11).
  3158             20  CF-BENEFIT-CATEGORY        PIC X.
  3159             20  CF-LOAN-TYPE               PIC X(8).
  3160
  3161             20  CF-CO-REM-TERM-CALC        PIC X.
  3162                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3163                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3164                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3165                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3166                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3167
  3168             20  CF-CO-EARNINGS-CALC        PIC X.
  3169                 88  CO-EARN-BY-R78             VALUE '1'.
  3170                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3171                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3172                 88  CO-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  57
* EL6316.cbl
  3173                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3174                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3175                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3176                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3177
  3178             20  CF-CO-REFUND-CALC          PIC X.
  3179                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3180                 88  CO-REFD-BY-R78             VALUE '1'.
  3181                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3182                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3183                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3184                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3185                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3186                 88  CO-REFD-MEAN               VALUE '8'.
  3187                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3188                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3189                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3190
  3191             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3192                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3193                 88  CO-OVRD-BY-R78             VALUE '1'.
  3194                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3195                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3196                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3197                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3198                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3199                 88  CO-OVRD-MEAN               VALUE '8'.
  3200                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3201
  3202             20  CF-CO-BEN-I-G-CD           PIC X.
  3203                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3204                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3205                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3206
  3207         16  FILLER                         PIC X(304).
  3208
  3209
  3210****************************************************************
  3211*             CARRIER MASTER RECORD                            *
  3212****************************************************************
  3213
  3214     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3215         16  CF-ADDRESS-DATA.
  3216             20  CF-MAIL-TO-NAME            PIC X(30).
  3217             20  CF-IN-CARE-OF              PIC X(30).
  3218             20  CF-ADDRESS-LINE-1          PIC X(30).
  3219             20  CF-ADDRESS-LINE-2          PIC X(30).
  3220             20  CF-CITY-STATE              PIC X(30).
  3221             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3222             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3223
  3224         16  CF-CLAIM-NO-CONTROL.
  3225             20  CF-CLAIM-NO-METHOD         PIC X.
  3226                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3227                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3228                 88  CLAIM-NO-SEQ               VALUE '3'.
  3229                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3230             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  58
* EL6316.cbl
  3231                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3232                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3233                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3234
  3235         16  CF-CHECK-NO-CONTROL.
  3236             20  CF-CHECK-NO-METHOD         PIC X.
  3237                 88  CHECK-NO-MANUAL            VALUE '1'.
  3238                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3239                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3240                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3241             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3242                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3243
  3244         16  CF-DOMICILE-STATE              PIC XX.
  3245
  3246         16  CF-EXPENSE-CONTROLS.
  3247             20  CF-EXPENSE-METHOD          PIC X.
  3248                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3249                 88  DOLLARS-PER-PMT            VALUE '2'.
  3250                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3251                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3252             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3253             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3254
  3255         16  CF-CORRESPONDENCE-CONTROL.
  3256             20  CF-LETTER-RESEND-OPT       PIC X.
  3257                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3258                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3259             20  FILLER                     PIC X(4).
  3260
  3261         16  CF-RESERVE-CONTROLS.
  3262             20  CF-MANUAL-SW               PIC X.
  3263                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3264             20  CF-FUTURE-SW               PIC X.
  3265                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3266             20  CF-PTC-SW                  PIC X.
  3267                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3268             20  CF-IBNR-SW                 PIC X.
  3269                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3270             20  CF-PTC-LF-SW               PIC X.
  3271                 88  CF-LF-PTC-USED             VALUE '1'.
  3272             20  CF-CDT-ACCESS-METHOD       PIC X.
  3273                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3274                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3275                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3276             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3277
  3278         16  CF-CLAIM-CALC-METHOD           PIC X.
  3279             88  360-PLUS-MONTHS                VALUE '1'.
  3280             88  365-PLUS-MONTHS                VALUE '2'.
  3281             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3282             88  360-DAILY                      VALUE '4'.
  3283             88  365-DAILY                      VALUE '5'.
  3284
  3285         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3286         16  FILLER                         PIC X(11).
  3287
  3288         16  CF-LIMIT-AMOUNTS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  59
* EL6316.cbl
  3289             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3290             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3291             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3292             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3293             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3294             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3295             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3296             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3297             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3298             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3299
  3300         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3301         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3302         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3303
  3304         16  CF-ZIP-CODE.
  3305             20  CF-ZIP-PRIME.
  3306                 24  CF-ZIP-1ST             PIC X.
  3307                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3308                 24  FILLER                 PIC X(4).
  3309             20  CF-ZIP-PLUS4               PIC X(4).
  3310         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3311             20  CF-CAN-POSTAL-1            PIC XXX.
  3312             20  CF-CAN-POSTAL-2            PIC XXX.
  3313             20  FILLER                     PIC XXX.
  3314
  3315         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3316         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3317         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3318
  3319         16  CF-RATING-SWITCH               PIC X.
  3320             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3321             88  CF-NO-RATING                   VALUE 'N'.
  3322
  3323         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3324
  3325         16  CF-CARRIER-OVER-SHORT.
  3326             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3327             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3328
  3329         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3330         16  CF-SECPAY-SWITCH               PIC X.
  3331             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3332             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3333         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3334         16  FILLER                         PIC X(448).
  3335*        16  FILLER                         PIC X(452).
  3336
  3337
  3338****************************************************************
  3339*             MORTALITY MASTER RECORD                          *
  3340****************************************************************
  3341
  3342     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3343         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3344                                INDEXED BY CF-MORT-NDX.
  3345             20  CF-MORT-TABLE              PIC X(5).
  3346             20  CF-MORT-TABLE-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  60
* EL6316.cbl
  3347                 88  CF-MORT-JOINT              VALUE 'J'.
  3348                 88  CF-MORT-SINGLE             VALUE 'S'.
  3349                 88  CF-MORT-COMBINED           VALUE 'C'.
  3350                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3351                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3352             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3353             20  CF-MORT-AGE-METHOD         PIC XX.
  3354                 88  CF-AGE-LAST                VALUE 'AL'.
  3355                 88  CF-AGE-NEAR                VALUE 'AN'.
  3356             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3357             20  CF-MORT-ADJUSTMENT-DIRECTION
  3358                                            PIC X.
  3359                 88  CF-MINUS                   VALUE '-'.
  3360                 88  CF-PLUS                    VALUE '+'.
  3361             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3362             20  CF-MORT-JOINT-CODE         PIC X.
  3363                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3364             20  CF-MORT-PC-Q               PIC X.
  3365                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3366             20  CF-MORT-TABLE-CODE         PIC X(4).
  3367             20  CF-MORT-COMMENTS           PIC X(15).
  3368             20  FILLER                     PIC X(14).
  3369
  3370         16  FILLER                         PIC X(251).
  3371
  3372
  3373****************************************************************
  3374*             BUSSINESS TYPE MASTER RECORD                     *
  3375****************************************************************
  3376
  3377     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3378* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3379* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3380* AND RECORD 05 IS TYPES 81-99
  3381         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3382             20  CF-BUSINESS-TITLE          PIC  X(19).
  3383             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3384                                            PIC S9V9(4) COMP-3.
  3385             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3386             20  FILLER                     PIC  X.
  3387         16  FILLER                         PIC  X(248).
  3388
  3389
  3390****************************************************************
  3391*             TERMINAL MASTER RECORD                           *
  3392****************************************************************
  3393
  3394     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3395
  3396         16  CF-COMPANY-TERMINALS.
  3397             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3398                                  PIC X(4).
  3399         16  FILLER               PIC X(248).
  3400
  3401
  3402****************************************************************
  3403*             LIFE EDIT MASTER RECORD                          *
  3404****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  61
* EL6316.cbl
  3405
  3406     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3407         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3408             20  CF-LIFE-CODE-IN            PIC XX.
  3409             20  CF-LIFE-CODE-OUT           PIC XX.
  3410         16  FILLER                         PIC X(248).
  3411
  3412
  3413****************************************************************
  3414*             AH EDIT MASTER RECORD                            *
  3415****************************************************************
  3416
  3417     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3418         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3419             20  CF-AH-CODE-IN              PIC XXX.
  3420             20  CF-AH-CODE-OUT             PIC XX.
  3421         16  FILLER                         PIC X(248).
  3422
  3423
  3424****************************************************************
  3425*             CREDIBILITY TABLES                               *
  3426****************************************************************
  3427
  3428     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3429         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3430                             INDEXED BY CF-CRDB-NDX.
  3431             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3432             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3433             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3434         16  FILLER                         PIC  X(332).
  3435
  3436
  3437****************************************************************
  3438*             REPORT CUSTOMIZATION RECORD                      *
  3439****************************************************************
  3440
  3441     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3442         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3443             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3444             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3445             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3446**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3447****       A T-TRANSFER.                                   ****
  3448             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3449
  3450         16  FILLER                         PIC XX.
  3451
  3452         16  CF-CARRIER-CNTL-OPT.
  3453             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3454                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3455                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3456             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3457                                            PIC X.
  3458         16  CF-GROUP-CNTL-OPT.
  3459             20  CF-GROUP-OPT-SEQ           PIC 9.
  3460                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3461                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3462             20  CF-GROUP-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  62
* EL6316.cbl
  3463                                            PIC X(6).
  3464         16  CF-STATE-CNTL-OPT.
  3465             20  CF-STATE-OPT-SEQ           PIC 9.
  3466                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3467                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3468             20  CF-STATE-SELECT OCCURS 3 TIMES
  3469                                            PIC XX.
  3470         16  CF-ACCOUNT-CNTL-OPT.
  3471             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3472                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3473                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3474             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3475                                            PIC X(10).
  3476         16  CF-BUS-TYP-CNTL-OPT.
  3477             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3478                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3479                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3480             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3481                                            PIC XX.
  3482         16  CF-LF-TYP-CNTL-OPT.
  3483             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3484                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3485                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3486             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3487                                            PIC XX.
  3488         16  CF-AH-TYP-CNTL-OPT.
  3489             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3490                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3491                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3492             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3493                                            PIC XX.
  3494         16  CF-REPTCD1-CNTL-OPT.
  3495             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3496                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3497                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3498             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3499                                            PIC X(10).
  3500         16  CF-REPTCD2-CNTL-OPT.
  3501             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3502                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3503                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3504             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3505                                            PIC X(10).
  3506         16  CF-USER1-CNTL-OPT.
  3507             20  CF-USER1-OPT-SEQ           PIC 9.
  3508                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3509                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3510             20  CF-USER1-SELECT OCCURS 3 TIMES
  3511                                            PIC X(10).
  3512         16  CF-USER2-CNTL-OPT.
  3513             20  CF-USER2-OPT-SEQ           PIC 9.
  3514                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3515                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3516             20  CF-USER2-SELECT OCCURS 3 TIMES
  3517                                            PIC X(10).
  3518         16  CF-USER3-CNTL-OPT.
  3519             20  CF-USER3-OPT-SEQ           PIC 9.
  3520                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  63
* EL6316.cbl
  3521                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3522             20  CF-USER3-SELECT OCCURS 3 TIMES
  3523                                            PIC X(10).
  3524         16  CF-USER4-CNTL-OPT.
  3525             20  CF-USER4-OPT-SEQ           PIC 9.
  3526                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3527                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3528             20  CF-USER4-SELECT OCCURS 3 TIMES
  3529                                            PIC X(10).
  3530         16  CF-USER5-CNTL-OPT.
  3531             20  CF-USER5-OPT-SEQ           PIC 9.
  3532                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3533                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3534             20  CF-USER5-SELECT OCCURS 3 TIMES
  3535                                            PIC X(10).
  3536         16  CF-REINS-CNTL-OPT.
  3537             20  CF-REINS-OPT-SEQ           PIC 9.
  3538                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3539                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3540             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3541                 24  CF-REINS-PRIME         PIC XXX.
  3542                 24  CF-REINS-SUB           PIC XXX.
  3543
  3544         16  CF-AGENT-CNTL-OPT.
  3545             20  CF-AGENT-OPT-SEQ           PIC 9.
  3546                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3547                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3548             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3549                                            PIC X(10).
  3550
  3551         16  FILLER                         PIC X(43).
  3552
  3553         16  CF-LOSS-RATIO-SELECT.
  3554             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3555             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3556         16  CF-ENTRY-DATE-SELECT.
  3557             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3558             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3559         16  CF-EFFECTIVE-DATE-SELECT.
  3560             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3561             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3562
  3563         16  CF-EXCEPTION-LIST-IND          PIC X.
  3564             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3565
  3566         16  FILLER                         PIC X(318).
  3567
  3568****************************************************************
  3569*                  EXCEPTION REPORTING RECORD                  *
  3570****************************************************************
  3571
  3572     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3573         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3574             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3575
  3576         16  CF-COMBINED-LIFE-AH-OPT.
  3577             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3578             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  64
* EL6316.cbl
  3579             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3580             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3581
  3582         16  CF-LIFE-OPT.
  3583             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3584             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3585             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3586             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3587             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3588             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3589             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3590             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3591             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3592             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3593
  3594         16  CF-AH-OPT.
  3595             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3596             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3597             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3598             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3599             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3600             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3601             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3602             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3603             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3604             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3605
  3606         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3607             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3608             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3609             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3610
  3611         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3612
  3613         16  FILLER                         PIC X(673).
  3614
  3615
  3616****************************************************************
  3617*             MORTGAGE SYSTEM PLAN RECORD                      *
  3618****************************************************************
  3619
  3620     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3621         16  CF-PLAN-TYPE                   PIC X.
  3622             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3623             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3624             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3625         16  CF-PLAN-ABBREV                 PIC XXX.
  3626         16  CF-PLAN-DESCRIPT               PIC X(10).
  3627         16  CF-PLAN-NOTES                  PIC X(20).
  3628         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3629         16  CF-PLAN-UNDERWRITING.
  3630             20  CF-PLAN-TERM-DATA.
  3631                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3632                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3633             20  CF-PLAN-AGE-DATA.
  3634                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3635                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3636                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  65
* EL6316.cbl
  3637             20  CF-PLAN-BENEFIT-DATA.
  3638                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3639                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3640                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3641                                            PIC S9(7)V99  COMP-3.
  3642         16  CF-PLAN-POLICY-FORMS.
  3643             20  CF-POLICY-FORM             PIC X(12).
  3644             20  CF-MASTER-APPLICATION      PIC X(12).
  3645             20  CF-MASTER-POLICY           PIC X(12).
  3646         16  CF-PLAN-RATING.
  3647             20  CF-RATE-CODE               PIC X(5).
  3648             20  CF-SEX-RATING              PIC X.
  3649                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3650                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3651             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3652             20  CF-SUB-STD-TYPE            PIC X.
  3653                 88  CF-PCT-OF-PREM            VALUE '1'.
  3654                 88  CF-PCT-OF-BENE            VALUE '2'.
  3655         16  CF-PLAN-PREM-TOLERANCES.
  3656             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3657             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3658         16  CF-PLAN-PYMT-TOLERANCES.
  3659             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3660             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3661         16  CF-PLAN-MISC-DATA.
  3662             20  FILLER                     PIC X.
  3663             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3664             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3665         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3666         16  CF-PLAN-IND-GRP                PIC X.
  3667             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3668                                                     '1'.
  3669             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3670                                                     '2'.
  3671         16  CF-MIB-SEARCH-SW               PIC X.
  3672             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3673             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3674             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3675             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3676         16  CF-ALPHA-SEARCH-SW             PIC X.
  3677             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3678             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3679             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3680             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3681             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3682             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3683             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3684             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3685             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3686             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3687                                                     'A' 'B' 'C'
  3688                                                     'X' 'Y' 'Z'.
  3689         16  CF-EFF-DT-RULE-SW              PIC X.
  3690             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3691             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3692             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3693             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3694             88  CF-EFF-DT-ANN                 VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  66
* EL6316.cbl
  3695         16  FILLER                         PIC X(4).
  3696         16  CF-HEALTH-QUESTIONS            PIC X.
  3697             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3698         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3699         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3700         16  CF-PLAN-SNGL-JNT               PIC X.
  3701             88  CF-COMBINED-PLAN              VALUE 'C'.
  3702             88  CF-JNT-PLAN                   VALUE 'J'.
  3703             88  CF-SNGL-PLAN                  VALUE 'S'.
  3704         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3705         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3706         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3707         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3708         16  CF-RERATE-CNTL                 PIC  X.
  3709             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3710             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3711             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3712             88  CF-AUTO-RECALC                 VALUE '4'.
  3713         16  CF-BENEFIT-TYPE                PIC  X.
  3714             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3715             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3716         16  CF-POLICY-FEE                  PIC S999V99
  3717                                                    COMP-3.
  3718         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3719         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3720         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3721         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3722         16  FILLER                         PIC  X(32).
  3723         16  CF-TERMINATION-FORM            PIC  X(04).
  3724         16  FILLER                         PIC  X(08).
  3725         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3726                                                       COMP-3.
  3727         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3728         16  CF-ISSUE-LETTER                PIC  X(4).
  3729         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3730         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3731             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3732             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3733         16  CF-MP-REFUND-CALC              PIC X.
  3734             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3735             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3736             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3737             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3738             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3739             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3740             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3741             88  CF-MP-REFD-MEAN                VALUE '8'.
  3742         16  CF-ALT-RATE-CODE               PIC  X(5).
  3743
  3744
  3745         16  FILLER                         PIC X(498).
  3746****************************************************************
  3747*             MORTGAGE COMPANY MASTER RECORD                   *
  3748****************************************************************
  3749
  3750     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3751         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3752         16  CF-MORTG-ACCESS-CONTROL        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  67
* EL6316.cbl
  3753             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3754             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3755             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3756             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3757             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3758
  3759         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3760         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3761         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3762         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3763         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3764
  3765         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3766             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3767         16  CF-MP-RECON-USE-IND            PIC X(1).
  3768             88  CF-MP-USE-RECON             VALUE 'Y'.
  3769         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3770             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3771         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3772             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3773             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3774         16  FILLER                         PIC X(1).
  3775         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3776             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3777         16  CF-MORTG-MIB-VERSION           PIC X.
  3778             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3779             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3780             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3781         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3782             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3783                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3784             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3785                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3786             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3787                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3788             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3789                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3790             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3791                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3792             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3793                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3794         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3795         16  FILLER                         PIC X(7).
  3796         16  CF-MORTG-DESTINATION-SYMBOL.
  3797             20  CF-MORTG-MIB-COMM          PIC X(5).
  3798             20  CF-MORTG-MIB-TERM          PIC X(5).
  3799         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3800             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3801         16  FILLER                         PIC X(03).
  3802         16  CF-MP-CHECK-NO-CONTROL.
  3803             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3804                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3805                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3806                                                ' ' LOW-VALUES.
  3807                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3808                                               VALUE '3'.
  3809         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3810         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  68
* EL6316.cbl
  3811         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3812             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3813                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3814             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3815                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3816             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3817                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3818             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3819                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3820             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3821                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3822             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3823                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3824         16  CF-MORTG-BILLING-AREA.
  3825             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3826                                            PIC X.
  3827         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3828         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3829         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3830         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3831             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3832             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3833         16  FILLER                         PIC X.
  3834         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3835             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3836             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3837         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3838         16  FILLER                         PIC X(8).
  3839         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3840         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3841         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3842         16  CF-ACH-COMPANY-ID.
  3843             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3844                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3845                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3846                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3847             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3848         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3849             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3850         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3851             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3852             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3853         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3854         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3855         16  FILLER                         PIC X(536).
  3856
  3857****************************************************************
  3858*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3859****************************************************************
  3860
  3861     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3862         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3863             20  CF-FEMALE-HEIGHT.
  3864                 24  CF-FEMALE-FT           PIC 99.
  3865                 24  CF-FEMALE-IN           PIC 99.
  3866             20  CF-FEMALE-MIN-WT           PIC 999.
  3867             20  CF-FEMALE-MAX-WT           PIC 999.
  3868         16  FILLER                         PIC X(428).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  69
* EL6316.cbl
  3869
  3870     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3871         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3872             20  CF-MALE-HEIGHT.
  3873                 24  CF-MALE-FT             PIC 99.
  3874                 24  CF-MALE-IN             PIC 99.
  3875             20  CF-MALE-MIN-WT             PIC 999.
  3876             20  CF-MALE-MAX-WT             PIC 999.
  3877         16  FILLER                         PIC X(428).
  3878******************************************************************
  3879*             AUTOMATIC ACTIVITY RECORD                          *
  3880******************************************************************
  3881     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3882         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3883             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3884             20  CF-SYS-LETTER-ID           PIC X(04).
  3885             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3886             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3887             20  CF-SYS-RESET-SW            PIC X(01).
  3888             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3889             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3890
  3891         16  FILLER                         PIC X(50).
  3892
  3893         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3894             20  CF-USER-ACTIVE-SW          PIC X(01).
  3895             20  CF-USER-LETTER-ID          PIC X(04).
  3896             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3897             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3898             20  CF-USER-RESET-SW           PIC X(01).
  3899             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3900             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3901             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3902
  3903         16  FILLER                         PIC X(246).
  3904*                                COPY ERCPNDB.
  3905******************************************************************
  3906*                                                                *
  3907*                                                                *
  3908*                            ERCPNDB.                            *
  3909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3910*                            VMOD=2.025                          *
  3911*                                                                *
  3912*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3913*                                                                *
  3914******************************************************************
  3915*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3916*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3917******************************************************************
  3918*                                                                *
  3919*                                                                *
  3920*   FILE TYPE = VSAM,KSDS                                        *
  3921*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3922*                                                                *
  3923*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3924*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3925*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3926*                                                 RKP=13,LEN=36  *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  70
* EL6316.cbl
  3927*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3928*                                      AND CHG-SEQ.)             *
  3929*                                                RKP=49,LEN=11   *
  3930*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3931*                                      AND CHG-SEQ.)             *
  3932*                                                RKP=60,LEN=15   *
  3933*                                                                *
  3934*   LOG = NO                                                     *
  3935*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3936******************************************************************
  3937******************************************************************
  3938*                   C H A N G E   L O G
  3939*
  3940* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3941*-----------------------------------------------------------------
  3942*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3943* EFFECTIVE    NUMBER
  3944*-----------------------------------------------------------------
  3945* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3946* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3947* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3948* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3949* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3950* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3951* 032306                   PEMA  ADD BOW LOAN NUMBER
  3952* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3953* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3954* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3955* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3956* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3957* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3958* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3959* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3960******************************************************************
  3961
  3962 01  PENDING-BUSINESS.
  3963     12  PB-RECORD-ID                     PIC XX.
  3964         88  VALID-PB-ID                        VALUE 'PB'.
  3965
  3966     12  PB-CONTROL-PRIMARY.
  3967         16  PB-COMPANY-CD                PIC X.
  3968         16  PB-ENTRY-BATCH               PIC X(6).
  3969         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3970         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3971
  3972     12  PB-CONTROL-BY-ACCOUNT.
  3973         16  PB-COMPANY-CD-A1             PIC X.
  3974         16  PB-CARRIER                   PIC X.
  3975         16  PB-GROUPING.
  3976             20  PB-GROUPING-PREFIX       PIC XXX.
  3977             20  PB-GROUPING-PRIME        PIC XXX.
  3978         16  PB-STATE                     PIC XX.
  3979         16  PB-ACCOUNT.
  3980             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3981             20  PB-ACCOUNT-PRIME         PIC X(6).
  3982         16  PB-CERT-EFF-DT               PIC XX.
  3983         16  PB-CERT-NO.
  3984             20  PB-CERT-PRIME            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  71
* EL6316.cbl
  3985             20  PB-CERT-SFX              PIC X.
  3986         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3987
  3988         16  PB-RECORD-TYPE               PIC X.
  3989             88  PB-MAILING-DATA                VALUE '0'.
  3990             88  PB-ISSUE                       VALUE '1'.
  3991             88  PB-CANCELLATION                VALUE '2'.
  3992             88  PB-BATCH-TRAILER               VALUE '9'.
  3993
  3994     12  PB-CONTROL-BY-ORIG-BATCH.
  3995         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3996         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3997         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3998         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3999
  4000     12  PB-CONTROL-BY-CSR.
  4001         16  PB-CSR-COMPANY-CD            PIC X.
  4002         16  PB-CSR-ID                    PIC X(4).
  4003         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4004         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4005         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4006******************************************************************
  4007*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4008******************************************************************
  4009
  4010     12  PB-LAST-MAINT-DT                 PIC XX.
  4011     12  PB-LAST-MAINT-BY                 PIC X(4).
  4012     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4013
  4014     12  PB-RECORD-BODY                   PIC X(375).
  4015
  4016     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4017         16  PB-CERT-ORIGIN               PIC X.
  4018             88  CLASIC-CREATED-CERT         VALUE '1'.
  4019         16  PB-I-NAME.
  4020             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4021             20  PB-I-INSURED-FIRST-NAME.
  4022                 24  PB-I-INSURED-1ST-INIT PIC X.
  4023                 24  FILLER                PIC X(9).
  4024             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4025         16  PB-I-AGE                     PIC S99   COMP-3.
  4026         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4027         16  PB-I-BIRTHDAY                PIC XX.
  4028         16  PB-I-INSURED-SEX             PIC X.
  4029             88  PB-SEX-MALE     VALUE 'M'.
  4030             88  PB-SEX-FEMALE   VALUE 'F'.
  4031
  4032         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4033         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4034         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4035         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4036         16  PB-I-SKIP-CODE               PIC X.
  4037             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4038             88  PB-SKIP-JULY              VALUE '1'.
  4039             88  PB-SKIP-AUGUST            VALUE '2'.
  4040             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4041             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4042             88  PB-SKIP-AUG-SEPT          VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  72
* EL6316.cbl
  4043             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4044             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4045             88  PB-SKIP-JUNE              VALUE '8'.
  4046             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4047             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4048             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4049         16  PB-I-TERM-TYPE               PIC X.
  4050             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4051             88  PB-PAID-WEEKLY            VALUE 'W'.
  4052             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4053             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4054             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4055         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4056         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4057         16  PB-I-DATA-ENTRY-SW           PIC X.
  4058             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4059             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4060             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4061             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4062         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4063         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4064*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4065         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4066         16  FILLER                       PIC X.
  4067
  4068         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4069             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4070             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4071                                                   '90' THRU '99'.
  4072         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4073                                          PIC XX.
  4074         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4075         16  PB-I-AMOUNT-FINANCED REDEFINES
  4076                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4077         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4078         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4079                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4080         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4081         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4082         16  PB-I-CLP-AMOUNT REDEFINES
  4083                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4084         16  PB-I-LF-CALC-FLAG            PIC X.
  4085             88 PB-COMP-LF-PREM               VALUE '?'.
  4086         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4087         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4088         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4089         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4090         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4091         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4092         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4093         16  PB-I-LF-ABBR                 PIC XXX.
  4094         16  PB-I-LF-INPUT-CD             PIC XX.
  4095
  4096         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4097             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4098             88  PB-INVALID-AH               VALUE '  ' '00'
  4099                                                   '90' THRU '99'.
  4100         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  73
* EL6316.cbl
  4101         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4102         16  PB-I-AH-CALC-FLAG            PIC X.
  4103             88 PB-COMP-AH-PREM                  VALUE '?'.
  4104         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4105         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4106         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4107         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4108         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4109         16  PB-I-AH-ABBR                 PIC XXX.
  4110         16  PB-I-AH-INPUT-CD             PIC XXX.
  4111
  4112         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4113         16  PB-I-REIN-TABLE              PIC XXX.
  4114         16  PB-I-BUSINESS-TYPE           PIC 99.
  4115         16  PB-I-INDV-GRP-CD             PIC X.
  4116         16  PB-I-MORT-CODE.
  4117             20  PB-I-TABLE               PIC X.
  4118             20  PB-I-INTEREST            PIC XX.
  4119             20  PB-I-MORT-TYP            PIC X.
  4120         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4121         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4122         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4123         16  PB-I-INDV-GRP-OVRD           PIC X.
  4124         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4125         16  PB-I-SIG-SW                  PIC X.
  4126             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4127         16  PB-I-RATE-CLASS              PIC XX.
  4128         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4129         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4130         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4131         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4132         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4133         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4134         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4135         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4136         16  PB-I-OB-FLAG                 PIC X.
  4137             88  PB-I-OB                      VALUE 'B'.
  4138             88  PB-I-SUMMARY                 VALUE 'Z'.
  4139         16  PB-I-ENTRY-STATUS            PIC X.
  4140             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4141                                              'M' '5' '9' '2'.
  4142             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4143             88  PB-I-POLICY-PENDING          VALUE '2'.
  4144             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4145             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4146             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4147             88  PB-I-REIN-ONLY               VALUE '9'.
  4148             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4149             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4150             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4151             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4152         16  PB-I-INT-CODE                PIC X.
  4153             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4154             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4155         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4156         16  PB-I-SOC-SEC-NO              PIC X(11).
  4157         16  PB-I-MEMBER-NO               PIC X(12).
  4158         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  74
* EL6316.cbl
  4159*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4160         16  PB-I-OLD-LOF                 PIC XXX.
  4161         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4162         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4163         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4164         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4165         16  PB-I-LIFE-INDICATOR          PIC X.
  4166             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4167         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4168         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4169                                          PIC S9(5)V99    COMP-3.
  4170         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4171             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4172             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4173         16  PB-I-1ST-PMT-DT              PIC XX.
  4174         16  PB-I-JOINT-INSURED.
  4175             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4176             20 PB-I-JOINT-FIRST-NAME.
  4177                24  PB-I-JOINT-FIRST-INIT PIC X.
  4178                24  FILLER                PIC X(9).
  4179             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4180*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4181         16  PB-I-BENEFICIARY-NAME.
  4182             20  PB-I-BANK-NUMBER         PIC X(10).
  4183             20  FILLER                   PIC X(15).
  4184         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4185         16  PB-I-REFERENCE               PIC X(12).
  4186         16  FILLER REDEFINES PB-I-REFERENCE.
  4187             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4188             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4189             20  PB-I-CLP-STATE           PIC XX.
  4190         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4191             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4192             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4193             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4194         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4195         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4196         16  PB-I-RESIDENT-STATE          PIC XX.
  4197         16  PB-I-RATE-CODE               PIC X(4).
  4198         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4199         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4200         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4201         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4202         16  PB-I-BANK-NOCHRGB            PIC 99.
  4203         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4204         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4205
  4206     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4207         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4208             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4209         16  PB-C-CANCEL-ORIGIN           PIC X.
  4210             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4211         16  PB-C-LF-CANCEL-DT            PIC XX.
  4212         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4213         16  PB-C-LF-CALC-REQ             PIC X.
  4214             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4215         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4216         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  75
* EL6316.cbl
  4217         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4218             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4219         16  PB-C-AH-CANCEL-DT            PIC XX.
  4220         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4221         16  PB-C-AH-CALC-REQ             PIC X.
  4222             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4223         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4224         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4225         16  PB-C-LAST-NAME               PIC X(15).
  4226         16  PB-C-REFUND-SW               PIC X.
  4227             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4228             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4229         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4230         16  PB-C-PAYEE-CODE              PIC X(6).
  4231         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4232         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4233         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4234         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4235         16  PB-C-REFERENCE               PIC X(12).
  4236         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4237         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4238         16  PB-C-POST-CARD-IND           PIC X.
  4239         16  PB-C-CANCEL-REASON           PIC X.
  4240         16  PB-C-REF-INTERFACE-SW        PIC X.
  4241         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4242         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4243         16  FILLER                       PIC X(01).
  4244*        16  FILLER                       PIC X(18).
  4245         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4246*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4247         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4248         16  PB-CANCELED-CERT-DATA.
  4249             20  PB-CI-INSURED-NAME.
  4250                 24  PB-CI-LAST-NAME      PIC X(15).
  4251                 24  PB-CI-INITIALS       PIC XX.
  4252             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4253             20  PB-CI-INSURED-SEX        PIC X.
  4254             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4255             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4256             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4257             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4258             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4259             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4260             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4261             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4262             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4263             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4264             20  PB-CI-RATE-CLASS         PIC XX.
  4265             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4266             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4267             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4268             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4269             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4270             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4271             20  PB-CI-LF-ABBR            PIC X(3).
  4272             20  PB-CI-AH-ABBR            PIC X(3).
  4273             20  PB-CI-OB-FLAG            PIC X.
  4274                 88  PB-CI-OB                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  76
* EL6316.cbl
  4275             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4276                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4277                                           'M' '4' '5' '9' '2'.
  4278                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4279                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4280                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4281                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4282                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4283                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4284                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4285                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4286                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4287                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4288                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4289                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4290             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4291                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4292                                           'M' '4' '5' '9' '2'.
  4293                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4294                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4295                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4296                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4297                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4298                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4299                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4300                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4301                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4302                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4303                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4304                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4305             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4306             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4307             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4308             20  PB-CI-MEMBER-NO          PIC X(12).
  4309             20  PB-CI-INT-CODE           PIC X.
  4310                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4311                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4312             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4313             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4314             20  PB-CI-COMP-EXCP-SW       PIC X.
  4315                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4316                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4317             20  PB-CI-ENTRY-STATUS       PIC X.
  4318             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4319             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4320             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4321             20  PB-CI-DEATH-DT           PIC XX.
  4322             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4323             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4324             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4325             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4326             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4327             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4328             20  PB-CI-ENTRY-DT              PIC XX.
  4329             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4330             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4331             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4332             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  77
* EL6316.cbl
  4333             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4334             20  PB-CI-OLD-LOF               PIC XXX.
  4335*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4336             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4337             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4338             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4339             20  PB-CI-INDV-GRP-CD           PIC X.
  4340             20  PB-CI-BENEFICIARY-NAME.
  4341                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4342                 24  FILLER                  PIC X(15).
  4343             20  PB-CI-NOTE-SW               PIC X.
  4344             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4345             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4346             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4347             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4348             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4349             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4350             20  PB-CI-FIRST-NAME            PIC X(10).
  4351             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4352
  4353         16  FILLER                       PIC X(13).
  4354*032306  16  FILLER                       PIC X(27).
  4355*        16  FILLER                       PIC X(46).
  4356
  4357     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4358         16  FILLER                       PIC X(10).
  4359         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4360         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4361         16  PB-M-INSURED-MID-INIT        PIC X.
  4362         16  PB-M-INSURED-AGE             PIC 99.
  4363         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4364         16  PB-M-INSURED-SEX             PIC X.
  4365         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4366         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4367         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4368         16  PB-M-INSURED-CITY-STATE.
  4369             20  PB-M-INSURED-CITY        PIC X(28).
  4370             20  PB-M-INSURED-STATE       PIC XX.
  4371         16  PB-M-INSURED-ZIP-CODE.
  4372             20  PB-M-INSURED-ZIP-PRIME.
  4373                 24  PB-M-INSURED-ZIP-1   PIC X.
  4374                     88  PB-M-CANADIAN-POST-CODE
  4375                                             VALUE 'A' THRU 'Z'.
  4376                 24  FILLER               PIC X(4).
  4377             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4378         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4379                                        PB-M-INSURED-ZIP-CODE.
  4380             20  PM-M-INS-CAN-POST1       PIC XXX.
  4381             20  PM-M-INS-CAN-POST2       PIC XXX.
  4382             20  FILLER                   PIC XXX.
  4383         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4384         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4385         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4386         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4387         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4388         16  PB-M-CRED-BENE-CITYST.
  4389             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4390             20  PB-M-CRED-BENE-STATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  78
* EL6316.cbl
  4391         16  FILLER                       PIC X(92).
  4392
  4393     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4394         16  FILLER                       PIC X(10).
  4395         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4396         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4397         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4398         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4399         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4400         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4401         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4402         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4403         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4404         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4405         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4406         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4407         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4408         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4409         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4410         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4411         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4412         16  PB-ACCOUNT-NAME              PIC X(30).
  4413         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4414         16  PB-REFERENCE                 PIC X(12).
  4415         16  PB-B-RECEIVED-DT             PIC XX.
  4416         16  FILLER                       PIC X(234).
  4417
  4418     12  PB-RECORD-STATUS.
  4419         16  PB-CREDIT-SELECT-DT          PIC XX.
  4420         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4421         16  PB-BILLED-DT                 PIC XX.
  4422         16  PB-BILLING-STATUS            PIC X.
  4423             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4424             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4425             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4426         16  PB-RECORD-BILL               PIC X.
  4427             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4428             88  PB-RECORD-RETURNED           VALUE 'R'.
  4429             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4430             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4431             88  PB-OVERRIDE-AH               VALUE 'A'.
  4432             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4433         16  PB-BATCH-ENTRY               PIC X.
  4434             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4435             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4436             88  PB-REISSUED-CERT             VALUE 'E'.
  4437             88  PB-MONTHLY-CERT              VALUE 'M'.
  4438             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4439             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4440             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4441         16  PB-FORCE-CODE                PIC X.
  4442             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4443             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4444             88  PB-CANCEL-FORCE              VALUE '8'.
  4445             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4446             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4447             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4448             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  79
* EL6316.cbl
  4449             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4450             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4451             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4452         16  PB-FATAL-FLAG                PIC X.
  4453             88  PB-FATAL-ERRORS              VALUE 'X'.
  4454         16  PB-FORCE-ER-CD               PIC X.
  4455             88  PB-FORCE-ERRORS              VALUE 'F'.
  4456             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4457         16  PB-WARN-ER-CD                PIC X.
  4458             88  PB-WARNING-ERRORS            VALUE 'W'.
  4459         16  FILLER                       PIC X.
  4460         16  PB-OUT-BAL-CD                PIC X.
  4461             88  PB-OUT-OF-BAL                VALUE 'O'.
  4462         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4463         16  PB-AH-OVERRIDE-L1            PIC X.
  4464         16  PB-INPUT-DT                  PIC XX.
  4465         16  PB-INPUT-BY                  PIC X(4).
  4466         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4467         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4468         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4469         16  PB-LF-EARNING-METHOD         PIC X.
  4470         16  PB-AH-EARNING-METHOD         PIC X.
  4471         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4472         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4473         16  PB-REIN-CD                   PIC XXX.
  4474         16  PB-LF-REFUND-TYPE            PIC X.
  4475         16  PB-AH-REFUND-TYPE            PIC X.
  4476         16  PB-ACCT-EFF-DT               PIC XX.
  4477         16  PB-ACCT-EXP-DT               PIC XX.
  4478         16  PB-COMPANY-ID                PIC X(3).
  4479         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4480         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4481         16  PB-SV-CARRIER                PIC X.
  4482         16  PB-SV-GROUPING               PIC X(6).
  4483         16  PB-SV-STATE                  PIC XX.
  4484         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4485         16  PB-GA-BILLING-INFO.
  4486             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4487                                          PIC XX.
  4488         16  PB-SV-REMIT-TO  REDEFINES
  4489             PB-GA-BILLING-INFO           PIC X(10).
  4490         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4491         16  PB-I-LOAN-OFFICER            PIC X(5).
  4492         16  PB-I-VIN                     PIC X(17).
  4493
  4494         16  FILLER                       PIC X(04).
  4495         16  IMNET-BYPASS-SW              PIC X.
  4496
  4497******************************************************************
  4498*                COMMON EDIT ERRORS                              *
  4499******************************************************************
  4500
  4501     12  PB-COMMON-ERRORS.
  4502         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4503                                           PIC S9(4)     COMP.
  4504
  4505******************************************************************
  4506*                                COPY ELCCERT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  80
* EL6316.cbl
  4507******************************************************************
  4508*                                                                *
  4509*                            ELCCERT.                            *
  4510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4511*                            VMOD=2.013                          *
  4512*                                                                *
  4513*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4514*                                                                *
  4515*   FILE TYPE = VSAM,KSDS                                        *
  4516*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4517*                                                                *
  4518*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4519*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4520*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4521*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4522*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4523*                                                                *
  4524*   LOG = YES                                                    *
  4525*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4526******************************************************************
  4527*                   C H A N G E   L O G
  4528*
  4529* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4530*-----------------------------------------------------------------
  4531*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4532* EFFECTIVE    NUMBER
  4533*-----------------------------------------------------------------
  4534* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4535* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4536* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4537* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4538* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4539* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4540* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4541* 032612  CR2011110200001  PEMA  AHL CHANGES
  4542******************************************************************
  4543
  4544 01  CERTIFICATE-MASTER.
  4545     12  CM-RECORD-ID                      PIC XX.
  4546         88  VALID-CM-ID                      VALUE 'CM'.
  4547
  4548     12  CM-CONTROL-PRIMARY.
  4549         16  CM-COMPANY-CD                 PIC X.
  4550         16  CM-CARRIER                    PIC X.
  4551         16  CM-GROUPING.
  4552             20  CM-GROUPING-PREFIX        PIC X(3).
  4553             20  CM-GROUPING-PRIME         PIC X(3).
  4554         16  CM-STATE                      PIC XX.
  4555         16  CM-ACCOUNT.
  4556             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4557             20  CM-ACCOUNT-PRIME          PIC X(6).
  4558         16  CM-CERT-EFF-DT                PIC XX.
  4559         16  CM-CERT-NO.
  4560             20  CM-CERT-PRIME             PIC X(10).
  4561             20  CM-CERT-SFX               PIC X.
  4562
  4563     12  CM-CONTROL-BY-NAME.
  4564         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  81
* EL6316.cbl
  4565         16  CM-INSURED-LAST-NAME          PIC X(15).
  4566         16  CM-INSURED-INITIALS.
  4567             20  CM-INSURED-INITIAL1       PIC X.
  4568             20  CM-INSURED-INITIAL2       PIC X.
  4569
  4570     12  CM-CONTROL-BY-SSN.
  4571         16  CM-COMPANY-CD-A2              PIC X.
  4572         16  CM-SOC-SEC-NO.
  4573             20  CM-SSN-STATE              PIC XX.
  4574             20  CM-SSN-ACCOUNT            PIC X(6).
  4575             20  CM-SSN-LN3.
  4576                 25  CM-INSURED-INITIALS-A2.
  4577                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4578                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4579                 25 CM-PART-LAST-NAME-A2         PIC X.
  4580
  4581     12  CM-CONTROL-BY-CERT-NO.
  4582         16  CM-COMPANY-CD-A4              PIC X.
  4583         16  CM-CERT-NO-A4                 PIC X(11).
  4584
  4585     12  CM-CONTROL-BY-MEMB.
  4586         16  CM-COMPANY-CD-A5              PIC X.
  4587         16  CM-MEMBER-NO.
  4588             20  CM-MEMB-STATE             PIC XX.
  4589             20  CM-MEMB-ACCOUNT           PIC X(6).
  4590             20  CM-MEMB-LN4.
  4591                 25  CM-INSURED-INITIALS-A5.
  4592                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4593                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4594                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4595
  4596     12  CM-INSURED-PROFILE-DATA.
  4597         16  CM-INSURED-FIRST-NAME.
  4598             20  CM-INSURED-1ST-INIT       PIC X.
  4599             20  FILLER                    PIC X(9).
  4600         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4601         16  CM-INSURED-SEX                PIC X.
  4602             88  CM-SEX-MALE                  VALUE 'M'.
  4603             88  CM-SEX-FEMAL                 VALUE 'F'.
  4604         16  CM-INSURED-JOINT-AGE          PIC 99.
  4605         16  CM-JOINT-INSURED-NAME.
  4606             20  CM-JT-LAST-NAME           PIC X(15).
  4607             20  CM-JT-FIRST-NAME.
  4608                 24  CM-JT-1ST-INIT        PIC X.
  4609                 24  FILLER                PIC X(9).
  4610             20  CM-JT-INITIAL             PIC X.
  4611
  4612     12  CM-LIFE-DATA.
  4613         16  CM-LF-BENEFIT-CD              PIC XX.
  4614         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4615         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4616         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4617         16  CM-LF-DEV-CODE                PIC XXX.
  4618         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4619         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4620         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4621         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4622         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  82
* EL6316.cbl
  4623         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4624         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4625         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4626         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4627         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4628         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4629         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4630         16  FILLER                        PIC XX.
  4631
  4632     12  CM-AH-DATA.
  4633         16  CM-AH-BENEFIT-CD              PIC XX.
  4634         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4635         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4636         16  CM-AH-DEV-CODE                PIC XXX.
  4637         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4638         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4639         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4640         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4641         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4642         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4643         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4644         16  CM-AH-PAID-THRU-DT            PIC XX.
  4645             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4646         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4647         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4648         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4649         16  FILLER                        PIC X.
  4650
  4651     12  CM-LOAN-INFORMATION.
  4652         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4653         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4654                                           PIC S9(5)V99  COMP-3.
  4655         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4656         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4657         16  CM-PAY-FREQUENCY              PIC S99.
  4658         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4659         16  CM-RATE-CLASS                 PIC XX.
  4660         16  CM-BENEFICIARY                PIC X(25).
  4661         16  CM-POLICY-FORM-NO             PIC X(12).
  4662         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4663         16  CM-LAST-ADD-ON-DT             PIC XX.
  4664         16  CM-DEDUCTIBLE-AMOUNTS.
  4665             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4666             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4667         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4668             20  CM-RESIDENT-STATE         PIC XX.
  4669             20  CM-RATE-CODE              PIC X(4).
  4670             20  FILLER                    PIC XX.
  4671         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4672             20  CM-LOAN-OFFICER           PIC X(5).
  4673             20  FILLER                    PIC XXX.
  4674         16  CM-CSR-CODE                   PIC XXX.
  4675         16  CM-UNDERWRITING-CODE          PIC X.
  4676             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4677         16  CM-POST-CARD-IND              PIC X.
  4678         16  CM-NH-INTERFACE-SW            PIC X.
  4679         16  CM-PREMIUM-TYPE               PIC X.
  4680             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  83
* EL6316.cbl
  4681             88  CM-O-B-COVERAGE              VALUE '2'.
  4682             88  CM-OPEN-END                  VALUE '3'.
  4683         16  CM-IND-GRP-TYPE               PIC X.
  4684             88  CM-INDIVIDUAL                VALUE 'I'.
  4685             88  CM-GROUP                     VALUE 'G'.
  4686         16  CM-SKIP-CODE                  PIC X.
  4687             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4688             88  SKIP-JULY                    VALUE '1'.
  4689             88  SKIP-AUGUST                  VALUE '2'.
  4690             88  SKIP-SEPTEMBER               VALUE '3'.
  4691             88  SKIP-JULY-AUG                VALUE '4'.
  4692             88  SKIP-AUG-SEPT                VALUE '5'.
  4693             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4694             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4695             88  SKIP-JUNE                    VALUE '8'.
  4696             88  SKIP-JUNE-JULY               VALUE '9'.
  4697             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4698             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4699         16  CM-PAYMENT-MODE               PIC X.
  4700             88  PAY-MONTHLY                  VALUE SPACE.
  4701             88  PAY-WEEKLY                   VALUE '1'.
  4702             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4703             88  PAY-BI-WEEKLY                VALUE '3'.
  4704             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4705         16  CM-LOAN-NUMBER                PIC X(8).
  4706         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4707         16  CM-OLD-LOF                    PIC XXX.
  4708*        16  CM-LOAN-OFFICER               PIC XXX.
  4709         16  CM-REIN-TABLE                 PIC XXX.
  4710         16  CM-SPECIAL-REIN-CODE          PIC X.
  4711         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4712         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4713         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4714
  4715     12  CM-STATUS-DATA.
  4716         16  CM-ENTRY-STATUS               PIC X.
  4717         16  CM-ENTRY-DT                   PIC XX.
  4718
  4719         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4720         16  CM-LF-CANCEL-DT               PIC XX.
  4721         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4722
  4723         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4724         16  CM-LF-DEATH-DT                PIC XX.
  4725         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4726
  4727         16  CM-LF-CURRENT-STATUS          PIC X.
  4728             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4729                                                'M' '4' '5' '9'.
  4730             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4731             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4732             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4733             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4734             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4735             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4736             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4737             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4738             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  84
* EL6316.cbl
  4739             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4740             88  CM-LF-DECLINED               VALUE 'D'.
  4741             88  CM-LF-VOIDED                 VALUE 'V'.
  4742
  4743         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4744         16  CM-AH-CANCEL-DT               PIC XX.
  4745         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4746
  4747         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4748         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4749         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4750
  4751         16  CM-AH-CURRENT-STATUS          PIC X.
  4752             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4753                                                'M' '4' '5' '9'.
  4754             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4755             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4756             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4757             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4758             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4759             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4760             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4761             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4762             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4763             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4764             88  CM-AH-DECLINED               VALUE 'D'.
  4765             88  CM-AH-VOIDED                 VALUE 'V'.
  4766
  4767         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4768             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4769             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4770             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4771         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4772
  4773         16  CM-ENTRY-BATCH                PIC X(6).
  4774         16  CM-LF-EXIT-BATCH              PIC X(6).
  4775         16  CM-AH-EXIT-BATCH              PIC X(6).
  4776         16  CM-LAST-MONTH-END             PIC XX.
  4777
  4778     12  CM-NOTE-SW                        PIC X.
  4779         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4780         88  CERT-NOTES-PRESENT               VALUE '1'.
  4781         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4782         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4783         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4784         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4785         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4786         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4787     12  CM-COMP-EXCP-SW                   PIC X.
  4788         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4789         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4790     12  CM-INSURED-ADDRESS-SW             PIC X.
  4791         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4792         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4793
  4794*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4795     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4796     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  85
* EL6316.cbl
  4797
  4798*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4799     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4800     12  FILLER                            PIC X.
  4801*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4802     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4803
  4804     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4805         88  CERT-ADDED-BATCH                 VALUE ' '.
  4806         88  CERT-ADDED-ONLINE                VALUE '1'.
  4807         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4808         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4809         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4810     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4811         88  CERT-AS-LOADED                   VALUE ' '.
  4812         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4813         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4814         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4815         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4816         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4817         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4818         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4819
  4820     12  CM-ACCOUNT-COMM-PCTS.
  4821         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4822         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4823
  4824     12  CM-USER-FIELD                     PIC X.
  4825     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4826     12  CM-CLP-STATE                      PIC XX.
  4827     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4828     12  CM-USER-RESERVED                  PIC XXX.
  4829     12  FILLER REDEFINES CM-USER-RESERVED.
  4830         16  CM-AH-CLASS-CD                PIC XX.
  4831         16  F                             PIC X.
  4832******************************************************************
  4833*                                COPY ELCCRTO.
  4834******************************************************************
  4835*                                                                *
  4836*                            ELCCRTO.                            *
  4837*                                                                *
  4838*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4839*                                                                *
  4840*   FILE TYPE = VSAM,KSDS                                        *
  4841*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4842*                                                                *
  4843*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4844*                                                                *
  4845*   LOG = YES                                                    *
  4846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4847******************************************************************
  4848*                   C H A N G E   L O G
  4849*
  4850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4851*-----------------------------------------------------------------
  4852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4853* EFFECTIVE    NUMBER
  4854*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  86
* EL6316.cbl
  4855* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4856* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4857* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4858* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4859* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4860******************************************************************
  4861 01  ORIGINAL-CERTIFICATE.
  4862     12  OC-RECORD-ID                      PIC XX.
  4863         88  VALID-OC-ID                      VALUE 'OC'.
  4864     12  OC-CONTROL-PRIMARY.
  4865         16  OC-COMPANY-CD                 PIC X.
  4866         16  OC-CARRIER                    PIC X.
  4867         16  OC-GROUPING                   PIC X(6).
  4868         16  OC-STATE                      PIC XX.
  4869         16  OC-ACCOUNT                    PIC X(10).
  4870         16  OC-CERT-EFF-DT                PIC XX.
  4871         16  OC-CERT-NO.
  4872             20  OC-CERT-PRIME             PIC X(10).
  4873             20  OC-CERT-SFX               PIC X.
  4874         16  OC-RECORD-TYPE                PIC X.
  4875         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4876     12  OC-LAST-MAINT-DT                  PIC XX.
  4877     12  OC-LAST-MAINT-BY                  PIC X(4).
  4878     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4879     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4880     12  FILLER                            PIC X(49).
  4881     12  OC-ORIG-REC.
  4882         16  OC-INS-LAST-NAME              PIC X(15).
  4883         16  OC-INS-FIRST-NAME             PIC X(10).
  4884         16  OC-INS-MIDDLE-INIT            PIC X.
  4885         16  OC-INS-AGE                    PIC S999     COMP-3.
  4886         16  OC-JNT-LAST-NAME              PIC X(15).
  4887         16  OC-JNT-FIRST-NAME             PIC X(10).
  4888         16  OC-JNT-MIDDLE-INIT            PIC X.
  4889         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4890         16  OC-LF-BENCD                   PIC XX.
  4891         16  OC-LF-TERM                    PIC S999      COMP-3.
  4892         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4893         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4894         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4895         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4896         16  OC-LF-EXP-DT                  PIC XX.
  4897         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4898         16  OC-LF-CANCEL-DT               PIC XX.
  4899         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4900         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4901         16  OC-AH-BENCD                   PIC XX.
  4902         16  OC-AH-TERM                    PIC S999      COMP-3.
  4903         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4904         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4905         16  OC-AH-EXP-DT                  PIC XX.
  4906         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4907         16  OC-AH-CP                      PIC 99.
  4908         16  OC-AH-CANCEL-DT               PIC XX.
  4909         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4910         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4911         16  OC-CRED-BENE-NAME             PIC X(25).
  4912         16  OC-1ST-PMT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  87
* EL6316.cbl
  4913         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4914         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4915         16  OC-ISSUE-TRAN-IND             PIC X.
  4916         16  OC-CANCEL-TRAN-IND            PIC X.
  4917         16  FILLER                        PIC X(211).
  4918
  4919     12  FILLER                            PIC X(50).
  4920******************************************************************
  4921*                                COPY ERCENDT.
  4922******************************************************************
  4923*                                                                *
  4924*                                                                *
  4925*                            ERCENDT.                            *
  4926*                            VMOD=2.001                          *
  4927*                                                                *
  4928*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4929*                                                                *
  4930*   FILE TYPE = VSAM,KSDS                                        *
  4931*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4932*                                                                *
  4933*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4934*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4935*                                                                *
  4936*   LOG = NO                                                     *
  4937*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4938******************************************************************
  4939*-----------------------------------------------------------------
  4940*                   C H A N G E   L O G
  4941*
  4942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4943*-----------------------------------------------------------------
  4944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4945* EFFECTIVE    NUMBER
  4946*-----------------------------------------------------------------
  4947* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4948*                                WITH OPEN CLAIMS
  4949* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4950* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4951* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4952*-----------------------------------------------------------------
  4953 01  ENDORSEMENT-RECORD.
  4954     12  EN-RECORD-ID                PIC XX.
  4955         88  VALID-EN-ID                VALUE 'EN'.
  4956     12  EN-CONTROL-PRIMARY.
  4957         16  EN-COMPANY-CD           PIC X.
  4958         16  EN-CARRIER              PIC X.
  4959         16  EN-GROUPING             PIC X(6).
  4960         16  EN-STATE                PIC XX.
  4961         16  EN-ACCOUNT              PIC X(10).
  4962         16  EN-CERT-EFF-DT          PIC XX.
  4963         16  EN-CERT-NO.
  4964             20  EN-CERT-PRIME       PIC X(10).
  4965             20  EN-CERT-SFX         PIC X.
  4966         16  EN-REC-TYPE             PIC X.
  4967             88  EN-ISSUE               VALUE 'I'.
  4968             88  EN-CANCELLATION        VALUE 'C'.
  4969         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4970     12  EN-CONTROL-BY-ARCH-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  88
* EL6316.cbl
  4971         16  EN-COMPANY-CD-A1              PIC X.
  4972         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4973     12  EN-LAST-MAINT-DT            PIC XX.
  4974     12  EN-LAST-MAINT-BY            PIC X(4).
  4975     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4976     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4977     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4978         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4979         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4980         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4981         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4982         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4983         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4984         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4985         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4986         16  EN-LF-ORIG-BENCD        PIC XX.
  4987         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4988         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4989         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4990         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4991         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4992         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4993*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4994         16  EN-ORIG-CRED-BENE       PIC X(25).
  4995         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4996         16  FILLER                  PIC X.
  4997         16  EN-AH-ORIG-BENCD        PIC XX.
  4998         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4999         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5000         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5001         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5002*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5003*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5004         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5005         16  F                       PIC X(09).
  5006         16  EN-AH-ORIG-CP           PIC 99.
  5007         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5008         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5009         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5010         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5011         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5012         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5013         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5014         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5015         16  EN-LF-NEW-BENCD         PIC XX.
  5016         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5017         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5018         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5019         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5020         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5021         16  EN-LF-NEW-EXP-DT        PIC XX.
  5022         16  EN-NEW-CRED-BENE        PIC X(25).
  5023         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5024         16  FILLER                  PIC X.
  5025         16  EN-AH-NEW-BENCD         PIC XX.
  5026         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5027         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5028         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  89
* EL6316.cbl
  5029         16  EN-AH-NEW-EXP-DT        PIC XX.
  5030*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5031*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5032*        16  F                       PIC X(12).
  5033         16  EN-AH-NEW-CP            PIC 99.
  5034         16  EN-SIG-SW               PIC X.
  5035         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5036         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5037         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5038         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5039         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5040         16  FILLER                  PIC X(33).
  5041     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5042         16  EN-LF-ORIG-REF-DT       PIC XX.
  5043         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5044         16  EN-AH-ORIG-REF-DT       PIC XX.
  5045         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5046         16  EN-LF-NEW-REF-DT        PIC XX.
  5047         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5048         16  EN-AH-NEW-REF-DT        PIC XX.
  5049         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5050         16  EN-FLAG-CERT            PIC X.
  5051         16  EN-INS-LAST-NAME        PIC X(15).
  5052         16  EN-INS-FIRST-NAME       PIC X(10).
  5053         16  EN-INS-MIDDLE-INIT      PIC X.
  5054         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5055         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5056         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5057         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5058         16  FILLER                  PIC X(262).
  5059     12  EN-MONEY-SW             PIC X.
  5060     12  EN-HEALTH-APP           PIC X.
  5061     12  EN-VOUCHER-SW           PIC X.
  5062     12  EN-PAYEE                PIC X(14).
  5063     12  EN-INPUT-DT             PIC XX.
  5064     12  EN-PROCESS-DT           PIC XX.
  5065     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5066     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5067     12  EN-REASON-CODES.
  5068         16  F OCCURS 12.
  5069             20  EN-REASON-CODE  PIC X(4).
  5070     12  EN-TEMPLATE-USED        PIC X(8).
  5071     12  EN-DOCU-TYPE            PIC X.
  5072         88  EN-VERI-DOCU          VALUE 'V'.
  5073         88  EN-GCE-DOCU           VALUE 'G'.
  5074         88  EN-CANC-DOCU          VALUE 'C'.
  5075     12  EN-COMMENTS1            PIC X(13).
  5076     12  EN-COMMENTS2            PIC X(70).
  5077     12  EN-COMM-CHGBK           PIC X.
  5078         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5079         88  EN-CHG-ACCT           VALUE 'Y'.
  5080     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5081     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5082     12  EN-BATCH-NUMBER         PIC X(6).
  5083     12  EN-ACCT-SUMM            PIC X.
  5084     12  EN-CSO-SUMM             PIC X.
  5085     12  FILLER                  PIC X(13).
  5086******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  90
* EL6316.cbl
  5087*                                COPY ERCNOTE.
  5088******************************************************************
  5089*                                                                *
  5090*                                                                *
  5091*                            ERCNOTE                             *
  5092*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5093*                            VMOD=2.003                          *
  5094*                                                                *
  5095*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5096*                                                                *
  5097*        FILE TYPE= VSAM,KSDS                                    *
  5098*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5099*                                                                *
  5100*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5101*                                                                *
  5102*        LOG = YES                                               *
  5103*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5104*                                                                *
  5105******************************************************************
  5106*                   C H A N G E   L O G
  5107*
  5108* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5109*-----------------------------------------------------------------
  5110*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5111* EFFECTIVE    NUMBER
  5112*-----------------------------------------------------------------
  5113* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5114*                                FILE WILL CONTAIN BILLING NOTES O
  5115******************************************************************
  5116
  5117 01  CERTIFICATE-NOTE.
  5118     12  CN-RECORD-ID                PIC  XX.
  5119         88  VALID-CN-ID                  VALUE 'CN'.
  5120
  5121     12  CN-CONTROL-PRIMARY.
  5122         16  CN-COMPANY-CD           PIC X.
  5123         16  CN-CARRIER              PIC X.
  5124         16  CN-GROUPING.
  5125             20 CN-GROUPING-PREFIX   PIC XXX.
  5126             20 CN-GROUPING-PRIME    PIC XXX.
  5127         16  CN-STATE                PIC XX.
  5128         16  CN-ACCOUNT.
  5129             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5130             20 CN-ACCOUNT-PRIME     PIC X(6).
  5131         16  CN-CERT-EFF-DT          PIC XX.
  5132         16  CN-CERT-NO.
  5133             20  CN-CERT-PRIME       PIC X(10).
  5134             20  CN-CERT-SFX         PIC X.
  5135
  5136     12  CN-BILLING-START-LINE-NO    PIC 99.
  5137     12  CN-BILLING-END-LINE-NO      PIC 99.
  5138
  5139     12  CN-LINES.
  5140         16  CN-LINE OCCURS 10       PIC X(77).
  5141
  5142     12  CN-LAST-MAINT-DT            PIC XX.
  5143     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5144     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  91
* EL6316.cbl
  5145     12  FILLER                      PIC X(6).
  5146******************************************************************
  5147*                                COPY ERCMAIL.
  5148******************************************************************
  5149*                                                                *
  5150*                                                                *
  5151*                            ERCMAIL                             *
  5152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5153*                            VMOD=2.003                          *
  5154*                                                                *
  5155*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5156*                                                                *
  5157*   FILE TYPE = VSAM,KSDS                                        *
  5158*   RECORD SIZE = 374   RECFORM = FIX                            *
  5159*                                                                *
  5160*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5161*   ALTERNATE PATH    = NOT USED                                 *
  5162*                                                                *
  5163*   LOG = YES                                                    *
  5164*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5165******************************************************************
  5166*                   C H A N G E   L O G
  5167*
  5168* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5169*-----------------------------------------------------------------
  5170*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5171* EFFECTIVE    NUMBER
  5172*-----------------------------------------------------------------
  5173* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5174* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5175* 111108                   PEMA  ADD CRED BENE ADDR2
  5176******************************************************************
  5177
  5178 01  MAILING-DATA.
  5179     12  MA-RECORD-ID                      PIC XX.
  5180         88  VALID-MA-ID                       VALUE 'MA'.
  5181
  5182     12  MA-CONTROL-PRIMARY.
  5183         16  MA-COMPANY-CD                 PIC X.
  5184         16  MA-CARRIER                    PIC X.
  5185         16  MA-GROUPING.
  5186             20  MA-GROUPING-PREFIX        PIC XXX.
  5187             20  MA-GROUPING-PRIME         PIC XXX.
  5188         16  MA-STATE                      PIC XX.
  5189         16  MA-ACCOUNT.
  5190             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5191             20  MA-ACCOUNT-PRIME          PIC X(6).
  5192         16  MA-CERT-EFF-DT                PIC XX.
  5193         16  MA-CERT-NO.
  5194             20  MA-CERT-PRIME             PIC X(10).
  5195             20  MA-CERT-SFX               PIC X.
  5196
  5197     12  FILLER                            PIC XX.
  5198
  5199     12  MA-ACCESS-CONTROL.
  5200         16  MA-SOURCE-SYSTEM              PIC XX.
  5201             88  MA-FROM-CREDIT                VALUE 'CR'.
  5202             88  MA-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  92
* EL6316.cbl
  5203             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5204             88  MA-FROM-OTHER                 VALUE 'OT'.
  5205         16  MA-RECORD-ADD-DT              PIC XX.
  5206         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5207         16  MA-LAST-MAINT-DT              PIC XX.
  5208         16  MA-LAST-MAINT-BY              PIC XXXX.
  5209         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5210
  5211     12  MA-PROFILE-INFO.
  5212         16  MA-QUALIFY-CODE-1             PIC XX.
  5213         16  MA-QUALIFY-CODE-2             PIC XX.
  5214         16  MA-QUALIFY-CODE-3             PIC XX.
  5215         16  MA-QUALIFY-CODE-4             PIC XX.
  5216         16  MA-QUALIFY-CODE-5             PIC XX.
  5217
  5218         16  MA-INSURED-LAST-NAME          PIC X(15).
  5219         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5220         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5221         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5222         16  MA-INSURED-BIRTH-DT           PIC XX.
  5223         16  MA-INSURED-SEX                PIC X.
  5224             88  MA-SEX-MALE                   VALUE 'M'.
  5225             88  MA-SEX-FEMALE                 VALUE 'F'.
  5226         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5227
  5228         16  MA-ADDRESS-CORRECTED          PIC X.
  5229         16  MA-JOINT-BIRTH-DT             PIC XX.
  5230*        16  FILLER                        PIC X(12).
  5231
  5232         16  MA-ADDRESS-LINE-1             PIC X(30).
  5233         16  MA-ADDRESS-LINE-2             PIC X(30).
  5234         16  MA-CITY-STATE.
  5235             20  MA-CITY                   PIC X(28).
  5236             20  MA-ADDR-STATE             PIC XX.
  5237         16  MA-ZIP.
  5238             20  MA-ZIP-CODE.
  5239                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5240                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5241                 24  FILLER                PIC X(4).
  5242             20  MA-ZIP-PLUS4              PIC X(4).
  5243         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5244             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5245             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5246             20  FILLER                    PIC X(3).
  5247
  5248         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5249
  5250         16  FILLER                        PIC XXX.
  5251*        16  FILLER                        PIC X(10).
  5252
  5253     12  MA-CRED-BENE-INFO.
  5254         16  MA-CRED-BENE-NAME                 PIC X(25).
  5255         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5256         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5257         16  MA-CRED-BENE-CTYST.
  5258             20  MA-CRED-BENE-CITY             PIC X(28).
  5259             20  MA-CRED-BENE-STATE            PIC XX.
  5260         16  MA-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  93
* EL6316.cbl
  5261             20  MA-CB-ZIP-CODE.
  5262                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5263                     88  MA-CB-CANADIAN-POST-CODE
  5264                                           VALUE 'A' THRU 'Z'.
  5265                 24  FILLER                    PIC X(4).
  5266             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5267         16  MA-CB-CANADIAN-POSTAL-CODE
  5268                            REDEFINES MA-CRED-BENE-ZIP.
  5269             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5270             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5271             20  FILLER                        PIC X(3).
  5272     12  MA-POST-CARD-MAIL-DATA.
  5273         16  MA-MAIL-DATA OCCURS 7.
  5274             20  MA-MAIL-TYPE              PIC X.
  5275                 88  MA-12MO-MAILING           VALUE '1'.
  5276                 88  MA-EXP-MAILING            VALUE '2'.
  5277             20  MA-MAIL-STATUS            PIC X.
  5278                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5279                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5280                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5281             20  MA-MAIL-DATE              PIC XX.
  5282     12  FILLER                            PIC XX.
  5283     12  FILLER                            PIC XX.
  5284*    12  FILLER                            PIC X(30).
  5285******************************************************************
  5286*                                COPY ERCCNOT.
  5287******************************************************************
  5288*                                                                *
  5289*                            ERCCNOT                             *
  5290*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5291*                            VMOD=2.003                          *
  5292*                                                                *
  5293*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5294*                                                                *
  5295*        FILE TYPE= VSAM,KSDS                                    *
  5296*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5297*                                                                *
  5298*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5299*                                                                *
  5300*        LOG = YES                                               *
  5301*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5302*                                                                *
  5303******************************************************************
  5304*                   C H A N G E   L O G
  5305*
  5306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5307*-----------------------------------------------------------------
  5308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5309* EFFECTIVE    NUMBER
  5310*-----------------------------------------------------------------
  5311* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5312******************************************************************
  5313
  5314 01  CERT-NOTE-FILE.
  5315     12  CZ-RECORD-ID                PIC  XX.
  5316         88  VALID-CZ-ID                  VALUE 'CZ'.
  5317
  5318     12  CZ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  94
* EL6316.cbl
  5319         16  CZ-COMPANY-CD           PIC X.
  5320         16  CZ-CARRIER              PIC X.
  5321         16  CZ-GROUPING.
  5322             20 CZ-GROUPING-PREFIX   PIC XXX.
  5323             20 CZ-GROUPING-PRIME    PIC XXX.
  5324         16  CZ-STATE                PIC XX.
  5325         16  CZ-ACCOUNT.
  5326             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5327             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5328         16  CZ-CERT-EFF-DT          PIC XX.
  5329         16  CZ-CERT-NO.
  5330             20  CZ-CERT-PRIME       PIC X(10).
  5331             20  CZ-CERT-SFX         PIC X.
  5332         16  CZ-RECORD-TYPE          PIC X.
  5333             88  CERT-NOTE           VALUE '1'.
  5334             88  CLAIM-CERT-NOTE     VALUE '2'.
  5335         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5336
  5337     12  CZ-LAST-MAINT-DT            PIC XX.
  5338     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5339     12  CZ-LAST-MAINT-USER          PIC X(4).
  5340
  5341     12  CZ-NOTE-INFORMATION.
  5342         16  CZ-NOTE                 PIC X(63).
  5343         16  FILLER                  PIC X(39).
  5344******************************************************************
  5345*                                COPY ELCEOBC.
  5346******************************************************************
  5347*                                                                *
  5348*                                                                *
  5349*                            ELCEOBC                             *
  5350*                            VMOD=2.001                          *
  5351*                                                                *
  5352*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5353*                                                                *
  5354*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5355*   VSAM EOB CODE TABLE                                          *
  5356*                                                                *
  5357*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5358*                                                                *
  5359*   FILE TYPE = VSAM,KSDS                                        *
  5360*   RECORD SIZE = 350   RECFORM = FIX                            *
  5361*                                                                *
  5362*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5363*                                                                *
  5364*   LOG = NO                                                     *
  5365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5366*                                                                *
  5367*                                                                *
  5368******************************************************************
  5369*                   C H A N G E   L O G
  5370*
  5371* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5372*-----------------------------------------------------------------
  5373*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5374* EFFECTIVE    NUMBER
  5375*-----------------------------------------------------------------
  5376* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  95
* EL6316.cbl
  5377* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5378******************************************************************
  5379 01  EOB-CODES.
  5380     12  EO-RECORD-ID                      PIC XX.
  5381         88  VALID-DN-ID                      VALUE 'EO'.
  5382     12  EO-CONTROL-PRIMARY.
  5383         16  EO-COMPANY-CD                 PIC X.
  5384         16  EO-RECORD-TYPE                PIC X.
  5385             88  EO-EOB-RECS                  VALUE '1'.
  5386             88  EO-VERIF-RECS                VALUE '2'.
  5387             88  EO-GCE-RECS                  VALUE '3'.
  5388         16  EO-EOB-CODE                   PIC X(4).
  5389         16  FILLER                        PIC X(9).
  5390     12  EO-MAINT-INFORMATION.
  5391         16  EO-LAST-MAINT-DT              PIC XX.
  5392         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5393         16  EO-LAST-MAINT-USER            PIC X(4).
  5394         16  FILLER                        PIC XX.
  5395     12  EO-DESCRIPTION                    PIC X(275).
  5396     12  FILLER                            PIC X(46).
  5397******************************************************************
  5398 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5399                          ACCOUNT-MASTER CONTROL-FILE
  5400                          PENDING-BUSINESS CERTIFICATE-MASTER
  5401                          ORIGINAL-CERTIFICATE
  5402                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5403                          MAILING-DATA CERT-NOTE-FILE EOB-CODES.
  5404 0000-DFHEXIT SECTION.
  5405     MOVE '9#                    $   ' TO DFHEIV0.
  5406     MOVE 'EL6316' TO DFHEIV1.
  5407     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5408     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5409     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5410     MOVE '5'                    TO DC-OPTION-CODE
  5411     PERFORM 9700-DATE-LINK
  5412     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
  5413     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT
  5414     MOVE EIBTRMID               TO QID-TERM
  5415     IF EIBCALEN = 0
  5416        GO TO 8800-UNAUTHORIZED-ACCESS
  5417     END-IF
  5418     DISPLAY ' ENDORSE LENGTH  '
  5419                FUNCTION LENGTH(ENDORSEMENT-RECORD)
  5420     move function length(EL631II) TO MAP-LENGTH
  5421     DISPLAY ' MAP LENGTH      ' MAP-LENGTH
  5422     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5423        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5424           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5425           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5426           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5427           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5428           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5429           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5430           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5431           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5432           MOVE LOW-VALUES             TO EL631II
  5433           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5434           GO TO 0350-DISPLAY-COMMON-DATA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  96
* EL6316.cbl
  5435        END-IF
  5436     END-IF
  5437     IF PI-CALLING-PROGRAM = 'EL614'
  5438        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5439                                 TO WS-PASSED-REASON-CODES
  5440        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5441        IF WS-PASSED-REASON-CODES NOT = SPACES
  5442           MOVE 'Y'                TO WS-SET-CODES-MDT
  5443        ELSE
  5444           MOVE 'N'                TO WS-SET-CODES-MDT
  5445        END-IF
  5446        PERFORM 0610-RECOVER-TEMP-STORAGE
  5447                                 THRU 0610-EXIT
  5448        GO TO 0350-DISPLAY-COMMON-DATA
  5449     END-IF
  5450     IF EIBAID = DFHCLEAR
  5451        IF PI-CLEAR-ERROR
  5452           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5453           MOVE ER-3833           TO EMI-ERROR
  5454           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5455           GO TO 0350-DISPLAY-COMMON-DATA
  5456        ELSE
  5457           GO TO 9400-CLEAR
  5458        END-IF
  5459     END-IF
  5460     .
  5461 0200-RECEIVE.
  5462     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5463        MOVE ER-0008             TO EMI-ERROR
  5464        PERFORM 9900-ERROR-FORMAT
  5465                                 THRU 9900-EXIT
  5466        MOVE -1                  TO PFENTRL
  5467        GO TO 8100-SEND-INITIAL-MAP
  5468     END-IF
  5469
  5470* EXEC CICS RECEIVE
  5471*        MAP      (MAP-NAME)
  5472*        MAPSET   (MAPSET-NAME)
  5473*        INTO     (EL631II)
  5474*    END-EXEC
  5475     MOVE LENGTH OF
  5476      EL631II
  5477       TO DFHEIV11
  5478*    MOVE '8"T I  L              ''   #00005465' TO DFHEIV0
  5479     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5480     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5481     MOVE X'2020233030303035343635' TO DFHEIV0(25:11)
  5482     CALL 'kxdfhei1' USING DFHEIV0,
  5483           MAP-NAME,
  5484           EL631II,
  5485           DFHEIV11,
  5486           MAPSET-NAME,
  5487           DFHEIV99,
  5488           DFHEIV99
  5489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5490     IF PFENTRL = 0
  5491         GO TO 0300-CHECK-PFKEYS
  5492     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  97
* EL6316.cbl
  5493     IF EIBAID NOT = DFHENTER
  5494         MOVE ER-0004            TO EMI-ERROR
  5495         GO TO 0320-INPUT-ERROR
  5496     END-IF
  5497     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5498        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5499     ELSE
  5500        MOVE ER-0029            TO EMI-ERROR
  5501        GO TO 0320-INPUT-ERROR
  5502     END-IF
  5503     .
  5504 0300-CHECK-PFKEYS.
  5505     IF EIBAID = DFHPF1
  5506        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5507        PERFORM 0520-ERENDT-STARTBR
  5508                                 THRU 0520-EXIT
  5509        PERFORM 0510-ERENDT-READNEXT
  5510                                 THRU 0510-EXIT
  5511        IF ERENDT-KEY = PI-PREV-ERENDT-KEY
  5512            PERFORM 0510-ERENDT-READNEXT
  5513                                 THRU 0510-EXIT
  5514        END-IF
  5515        IF (RESP-NORMAL) AND
  5516         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5517           PERFORM 0390-BUILD-FROM-ERENDT
  5518                                 THRU 0390-EXIT
  5519           MOVE ER-0000          TO EMI-ERROR
  5520           PERFORM 9900-ERROR-FORMAT
  5521                                 THRU 9900-EXIT
  5522           GO TO 8100-SEND-INITIAL-MAP
  5523        ELSE
  5524           MOVE ER-2237          TO EMI-ERROR
  5525           MOVE -1               TO CARRL
  5526           PERFORM 9900-ERROR-FORMAT
  5527                                 THRU 9900-EXIT
  5528           GO TO 8200-SEND-DATAONLY
  5529        END-IF
  5530     END-IF
  5531     IF EIBAID = DFHPF2
  5532        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5533        PERFORM 0520-ERENDT-STARTBR
  5534                                 THRU 0520-EXIT
  5535        PERFORM 0510-ERENDT-READNEXT
  5536                                 THRU 0510-EXIT
  5537        PERFORM 0530-ERENDT-READPREV
  5538                                 THRU 0530-EXIT
  5539        PERFORM 0530-ERENDT-READPREV
  5540                                 THRU 0530-EXIT
  5541        IF (RESP-NORMAL) AND
  5542         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5543           PERFORM 0390-BUILD-FROM-ERENDT
  5544                                 THRU 0390-EXIT
  5545           MOVE ER-0000          TO EMI-ERROR
  5546           PERFORM 9900-ERROR-FORMAT
  5547                                 THRU 9900-EXIT
  5548           GO TO 8100-SEND-INITIAL-MAP
  5549        ELSE
  5550           GO TO 0350-DISPLAY-COMMON-DATA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  98
* EL6316.cbl
  5551           MOVE ER-2238          TO EMI-ERROR
  5552           PERFORM 9900-ERROR-FORMAT
  5553                                 THRU 9900-EXIT
  5554           MOVE -1               TO CARRL
  5555           GO TO 8200-SEND-DATAONLY
  5556        END-IF
  5557     END-IF
  5558     IF EIBAID = DFHPF3
  5559        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5560        PERFORM 0600-CREATE-TEMP-STORAGE
  5561                                 THRU 0600-EXIT
  5562        MOVE 'EL614'             TO PGM-NAME
  5563        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5564        MOVE +1                  TO S2
  5565        PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5566           IF REACD-IN (S1) NOT = SPACES AND LOW-VALUES
  5567              MOVE REACD-IN (S1) TO PI-PROGRAM-WORK-AREA (S2:4)
  5568              ADD +5 TO S2
  5569           END-IF
  5570        END-PERFORM
  5571        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5572        GO TO 9300-XCTL
  5573     END-IF
  5574     IF EIBAID = DFHPF4 OR DFHPF8
  5575        GO TO 1000-FINALIZE
  5576     END-IF
  5577     IF EIBAID = DFHPF23
  5578        IF PI-CLEAR-ERROR
  5579           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5580           MOVE ER-3833           TO EMI-ERROR
  5581           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5582           GO TO 0350-DISPLAY-COMMON-DATA
  5583        ELSE
  5584           GO TO 8810-PF23
  5585        END-IF
  5586     END-IF
  5587     IF EIBAID = DFHPF24
  5588        IF PI-CLEAR-ERROR
  5589           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5590           MOVE ER-3833           TO EMI-ERROR
  5591           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5592           GO TO 0350-DISPLAY-COMMON-DATA
  5593        ELSE
  5594           GO TO 9200-RETURN-MAIN-MENU
  5595        END-IF
  5596     END-IF
  5597     IF EIBAID = DFHPF12
  5598        GO TO 9500-PF12
  5599     END-IF
  5600     IF EIBAID = DFHENTER
  5601        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5602        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5603        IF EMI-NO-ERRORS
  5604           GO TO 0350-DISPLAY-COMMON-DATA
  5605        ELSE
  5606           GO TO 8200-SEND-DATAONLY
  5607        END-IF
  5608     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  99
* EL6316.cbl
  5609     MOVE ER-0029                TO EMI-ERROR
  5610     .
  5611 0320-INPUT-ERROR.
  5612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5613     MOVE AL-UNBON               TO PFENTRA
  5614     MOVE -1                     TO PFENTRL
  5615     GO TO 8200-SEND-DATAONLY
  5616     .
  5617 0325-EDIT-SCREEN.
  5618     IF PRTSWL > ZEROS
  5619        IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5620*          move prtswi to w-prtsw
  5621*          MOVE AL-UANON         TO PRTSWA
  5622*          IF PRTSWI = ' '
  5623              MOVE 'P'         TO PRTSWI
  5624*          END-IF
  5625*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5626        END-IF
  5627     END-IF
  5628     IF LTRIDL > ZEROS
  5629        AND LTRIDI > SPACES
  5630        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5631        MOVE LTRIDI              TO LETR-LETTER-ID
  5632                                    PI-LTRID-ENTERED
  5633        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5634        MOVE SPACES              TO LETR-FILLER
  5635        MOVE 0                   TO LETR-SEQ-NO
  5636        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5637     ELSE
  5638        MOVE ER-1236          TO EMI-ERROR
  5639        MOVE -1               TO LTRIDL
  5640        MOVE AL-UABON         TO LTRIDA
  5641        PERFORM 9900-ERROR-FORMAT
  5642                                 THRU 9900-EXIT
  5643     END-IF
  5644
  5645     IF W-PROMPT-LETTER EQUAL 'Y'
  5646         MOVE ER-0894            TO EMI-ERROR
  5647         MOVE -1                 TO LTRIDL
  5648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5649     END-IF
  5650     SET REASONS-NOT-FOUND TO TRUE
  5651     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5652        IF REACDL (S1) = +4 OR
  5653          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5654              MOVE AL-SANON     TO REACDA (S1)
  5655              SET REASONS-FOUND TO TRUE
  5656        END-IF
  5657     END-PERFORM
  5658
  5659     IF REASONS-NOT-FOUND
  5660        MOVE ER-1820             TO EMI-ERROR
  5661        MOVE -1                  TO PFENTRL
  5662        PERFORM 9900-ERROR-FORMAT
  5663                                 THRU 9900-EXIT
  5664     ELSE
  5665        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5666     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 100
* EL6316.cbl
  5667
  5668     IF CRTNT1L > ZEROS
  5669        IF CRTNT1I > SPACES
  5670           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5671        END-IF
  5672     END-IF
  5673
  5674     IF CRTNT2L > ZEROS
  5675        IF CRTNT2I > SPACES
  5676           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5677        END-IF
  5678     END-IF
  5679
  5680     IF BILNT1L > ZEROS
  5681        IF BILNT1I > SPACES
  5682           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5683        END-IF
  5684     END-IF
  5685
  5686     .
  5687 0325-EXIT.
  5688     EXIT.
  5689
  5690 0326-GET-Z-RECORD.
  5691
  5692     MOVE SPACES  TO W-Z-CONTROL-DATA
  5693
  5694
  5695* EXEC CICS STARTBR
  5696*         DATASET    ('ELLETR')
  5697*         RIDFLD     (ELLETR-KEY)
  5698*         GTEQ
  5699*         RESP      (WS-RESPONSE)
  5700*    END-EXEC.
  5701     MOVE 'ELLETR' TO DFHEIV1
  5702     MOVE 0
  5703       TO DFHEIV11
  5704*    MOVE '&,         G          &  N#00005674' TO DFHEIV0
  5705     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5706     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5707     MOVE X'204E233030303035363734' TO DFHEIV0(25:11)
  5708     CALL 'kxdfhei1' USING DFHEIV0,
  5709           DFHEIV1,
  5710           ELLETR-KEY,
  5711           DFHEIV99,
  5712           DFHEIV11,
  5713           DFHEIV99
  5714     MOVE EIBRESP  TO WS-RESPONSE
  5715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5716
  5717     IF NOT RESP-NORMAL
  5718         MOVE ER-1236          TO EMI-ERROR
  5719         MOVE -1               TO LTRIDL
  5720         MOVE AL-UABON         TO LTRIDA
  5721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5722         GO TO 0326-ENDBR
  5723     END-IF.
  5724
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 101
* EL6316.cbl
  5725 0326-READNEXT.
  5726
  5727
  5728* EXEC CICS READNEXT
  5729*        DATASET   ('ELLETR')
  5730*        INTO      (TEXT-FILES)
  5731*        RIDFLD    (ELLETR-KEY)
  5732*        RESP      (WS-RESPONSE)
  5733*    END-EXEC
  5734     MOVE LENGTH OF
  5735      TEXT-FILES
  5736       TO DFHEIV12
  5737     MOVE 'ELLETR' TO DFHEIV1
  5738     MOVE 0
  5739       TO DFHEIV11
  5740*    MOVE '&.IL                  )  N#00005690' TO DFHEIV0
  5741     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5742     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5743     MOVE X'204E233030303035363930' TO DFHEIV0(25:11)
  5744     CALL 'kxdfhei1' USING DFHEIV0,
  5745           DFHEIV1,
  5746           TEXT-FILES,
  5747           DFHEIV12,
  5748           ELLETR-KEY,
  5749           DFHEIV99,
  5750           DFHEIV11,
  5751           DFHEIV99,
  5752           DFHEIV99
  5753     MOVE EIBRESP  TO WS-RESPONSE
  5754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5755     IF RESP-NORMAL
  5756        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5757           MOVE ER-1236          TO EMI-ERROR
  5758           MOVE -1               TO LTRIDL
  5759           MOVE AL-UABON         TO LTRIDA
  5760           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5761           GO TO 0326-ENDBR
  5762        END-IF
  5763
  5764        MOVE AL-UANON         TO LTRIDA
  5765        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5766           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5767        ELSE
  5768           GO TO 0326-READNEXT
  5769        END-IF
  5770     ELSE
  5771        MOVE ER-1236          TO EMI-ERROR
  5772        MOVE -1               TO LTRIDL
  5773        MOVE AL-UABON         TO LTRIDA
  5774        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5775        GO TO 0326-ENDBR
  5776     END-IF.
  5777
  5778 0326-ENDBR.
  5779
  5780
  5781* EXEC CICS ENDBR
  5782*        DATASET     ('ELLETR')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 102
* EL6316.cbl
  5783*    END-EXEC.
  5784     MOVE 'ELLETR' TO DFHEIV1
  5785     MOVE 0
  5786       TO DFHEIV11
  5787*    MOVE '&2                    $   #00005721' TO DFHEIV0
  5788     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5789     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5790     MOVE X'2020233030303035373231' TO DFHEIV0(25:11)
  5791     CALL 'kxdfhei1' USING DFHEIV0,
  5792           DFHEIV1,
  5793           DFHEIV11,
  5794           DFHEIV99
  5795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5796
  5797
  5798 0326-EXIT.
  5799      EXIT.
  5800 0350-DISPLAY-COMMON-DATA.
  5801     display ' made it to 0350 '
  5802     PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
  5803     IF PI-LTRID-ENTERED > SPACES
  5804        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5805        MOVE AL-UANON            TO LTRIDA
  5806        MOVE +4                  TO LTRIDL
  5807     ELSE
  5808        IF PI-CLM-RESCISSION
  5809            MOVE 'CLRC'          TO LTRIDI
  5810                                    PI-LTRID-ENTERED
  5811            MOVE +4              TO LTRIDL
  5812            MOVE AL-UANON        TO LTRIDA
  5813        END-IF
  5814     END-IF
  5815
  5816     SET REASONS-NOT-FOUND TO TRUE
  5817     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5818     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5819        IF REACDL (S1) = +4 OR
  5820          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5821              MOVE AL-SANON      TO REACDA (S1)
  5822              MOVE +4            TO REACDL (S1)
  5823              SET REASONS-FOUND  TO TRUE
  5824        END-IF
  5825     END-PERFORM
  5826
  5827     IF REASONS-NOT-FOUND
  5828         IF PI-CLM-RESCISSION
  5829            MOVE 'CRNA'          TO REACD-IN (1)
  5830            MOVE AL-SANON        TO REACDA (1)
  5831            MOVE +4              TO REACDL (1)
  5832            SET REASONS-FOUND    TO TRUE
  5833        END-IF
  5834     END-IF
  5835
  5836     IF PI-CERTNT1-ENTERED > SPACES
  5837        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5838        MOVE AL-UANON            TO CRTNT1A
  5839        MOVE +63                 TO CRTNT1L
  5840     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 103
* EL6316.cbl
  5841
  5842     IF PI-CERTNT2-ENTERED > SPACES
  5843        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5844        MOVE AL-UANON            TO CRTNT2A
  5845        MOVE +63                 TO CRTNT2L
  5846     END-IF
  5847
  5848     IF PI-BILLNT1-ENTERED > SPACES
  5849        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  5850        MOVE AL-UANON            TO BILNT1A
  5851        MOVE +63                 TO BILNT1L
  5852     END-IF
  5853     GO TO 8100-SEND-INITIAL-MAP
  5854     .
  5855 0350-EXIT.
  5856     EXIT.
  5857 0360-CHECK-PENDING.
  5858     display ' made it to 0360 '
  5859     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5860     MOVE PI-CARRIER             TO CRTO-CARRIER
  5861     MOVE PI-GROUPING            TO CRTO-GROUPING
  5862     MOVE PI-STATE               TO CRTO-STATE
  5863     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5864     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5865     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5866     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5867     MOVE 'I'                    TO CRTO-RECORD-TYPE
  5868     MOVE ZEROS                  TO CRTO-SEQ-NO
  5869     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5870     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  5871     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  5872     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  5873     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  5874     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  5875      display 'response ' ws-response
  5876      display 'pi-elcrto-key ' pi-elcrto-key
  5877      display 'oc key ' oc-control-primary
  5878     IF RESP-NORMAL
  5879       IF (PI-ELCRTO-KEY (1:33) =
  5880              OC-CONTROL-PRIMARY (1:33))
  5881          DISPLAY 'CRTO RESP NORMAL '
  5882          MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  5883          PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  5884          PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  5885          IF RESP-NORMAL
  5886             MOVE PB-CONTROL-PRIMARY TO PI-ERPNDB-KEY
  5887             PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
  5888          END-IF
  5889       ELSE
  5890          MOVE ER-3829           TO EMI-ERROR
  5891          PERFORM 9900-ERROR-FORMAT
  5892                                 THRU 9900-EXIT
  5893          MOVE -1                TO CARRL
  5894          GO TO 8100-SEND-INITIAL-MAP
  5895       END-IF
  5896     ELSE
  5897        MOVE ER-3829             TO EMI-ERROR
  5898        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 104
* EL6316.cbl
  5899                                 THRU 9900-EXIT
  5900        MOVE -1                  TO CARRL
  5901        GO TO 8100-SEND-INITIAL-MAP
  5902     END-IF
  5903     .
  5904 0360-EXIT.
  5905     EXIT.
  5906 0361-MOVE-CRTO-TO-SCREEN.
  5907     display ' made it to 0361 '
  5908     MOVE OC-LF-CANCEL-DT          TO DC-BIN-DATE-1
  5909     MOVE ' '                      TO DC-OPTION-CODE
  5910     PERFORM 9700-DATE-LINK
  5911     IF NO-CONVERSION-ERROR
  5912        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  5913     END-IF
  5914     MOVE OC-AH-CANCEL-DT          TO DC-BIN-DATE-1
  5915     MOVE ' '                      TO DC-OPTION-CODE
  5916     PERFORM 9700-DATE-LINK
  5917     IF NO-CONVERSION-ERROR
  5918        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  5919     END-IF
  5920     MOVE OC-LF-CANCEL-AMT         TO OLFAMTO
  5921     MOVE OC-AH-CANCEL-AMT         TO OAHAMTO
  5922     .
  5923 0361-EXIT.
  5924     EXIT.
  5925 0362-READ-ELCRTO.
  5926     display ' made it to 0362 '
  5927
  5928* EXEC CICS READ
  5929*        DATASET   (WS-ELCRTO-FILE-ID)
  5930*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5931*        RIDFLD    (ELCRTO-KEY)
  5932*        GTEQ
  5933*        RESP      (WS-RESPONSE)
  5934*    END-EXEC
  5935*    MOVE '&"S        G          (  N#00005854' TO DFHEIV0
  5936     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5938     MOVE X'204E233030303035383534' TO DFHEIV0(25:11)
  5939     CALL 'kxdfhei1' USING DFHEIV0,
  5940           WS-ELCRTO-FILE-ID,
  5941           DFHEIV20,
  5942           DFHEIV99,
  5943           ELCRTO-KEY,
  5944           DFHEIV99,
  5945           DFHEIV99,
  5946           DFHEIV99
  5947     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5948         DFHEIV20
  5949     MOVE EIBRESP  TO WS-RESPONSE
  5950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5951     .
  5952 0362-EXIT.
  5953     EXIT.
  5954 0363-READ-ELCRTO-UPD.
  5955     display ' made it to 0363 '
  5956
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 105
* EL6316.cbl
  5957* EXEC CICS READ
  5958*        DATASET   (WS-ELCRTO-FILE-ID)
  5959*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5960*        RIDFLD    (ELCRTO-KEY)
  5961*        UPDATE
  5962*        RESP      (WS-RESPONSE)
  5963*    END-EXEC
  5964*    MOVE '&"S        EU         (  N#00005866' TO DFHEIV0
  5965     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5966     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5967     MOVE X'204E233030303035383636' TO DFHEIV0(25:11)
  5968     CALL 'kxdfhei1' USING DFHEIV0,
  5969           WS-ELCRTO-FILE-ID,
  5970           DFHEIV20,
  5971           DFHEIV99,
  5972           ELCRTO-KEY,
  5973           DFHEIV99,
  5974           DFHEIV99,
  5975           DFHEIV99
  5976     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5977         DFHEIV20
  5978     MOVE EIBRESP  TO WS-RESPONSE
  5979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5980     .
  5981 0363-EXIT.
  5982     EXIT.
  5983
  5984 0364-MOVE-ZERO-TO-SCREEN.
  5985
  5986     MOVE ZEROS    TO OLFDTO
  5987                      OAHDTO
  5988                      OLFAMTO
  5989                      OAHAMTO.
  5990
  5991 0364-EXIT.
  5992     EXIT.
  5993
  5994 0365-READ-ERENDT.
  5995
  5996* EXEC CICS READ
  5997*        DATASET   (WS-ERENDT-FILE-ID)
  5998*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  5999*        RIDFLD    (ERENDT-KEY)
  6000*        RESP      (WS-RESPONSE)
  6001*    END-EXEC
  6002*    MOVE '&"S        E          (  N#00005888' TO DFHEIV0
  6003     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6005     MOVE X'204E233030303035383838' TO DFHEIV0(25:11)
  6006     CALL 'kxdfhei1' USING DFHEIV0,
  6007           WS-ERENDT-FILE-ID,
  6008           DFHEIV20,
  6009           DFHEIV99,
  6010           ERENDT-KEY,
  6011           DFHEIV99,
  6012           DFHEIV99,
  6013           DFHEIV99
  6014     SET ADDRESS OF ENDORSEMENT-RECORD TO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 106
* EL6316.cbl
  6015         DFHEIV20
  6016     MOVE EIBRESP  TO WS-RESPONSE
  6017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6018     .
  6019 0365-EXIT.
  6020     EXIT.
  6021 0370-READ-ERPNDB.
  6022     display ' made it to 0370 '
  6023     MOVE PI-COMPANY-CD          TO PNDB2-COMPANY-CD
  6024     MOVE PI-CRTO-CARRIER        TO PNDB2-CARRIER
  6025     MOVE PI-CRTO-GROUPING       TO PNDB2-GROUPING
  6026     MOVE PI-CRTO-STATE          TO PNDB2-STATE
  6027     MOVE PI-CRTO-ACCOUNT        TO PNDB2-ACCOUNT
  6028     MOVE PI-CRTO-CERT-PRIME     TO PNDB2-CERT-PRIME
  6029     MOVE PI-CRTO-CERT-SFX       TO PNDB2-CERT-SFX
  6030     MOVE PI-CRTO-CERT-EFF-DT    TO PNDB2-CERT-EFF-DT
  6031     MOVE +0                     TO PNDB2-CHG-SEQ-NO
  6032     MOVE '2'                    TO PNDB2-RECORD-TYPE
  6033
  6034* EXEC CICS READ
  6035*        DATASET   (WS-ERPNDB2-FILE-ID)
  6036*        SET       (ADDRESS OF PENDING-BUSINESS)
  6037*        RIDFLD    (ERPNDB2-KEY)
  6038*        RESP      (WS-RESPONSE)
  6039*    END-EXEC
  6040*    MOVE '&"S        E          (  N#00005909' TO DFHEIV0
  6041     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6043     MOVE X'204E233030303035393039' TO DFHEIV0(25:11)
  6044     CALL 'kxdfhei1' USING DFHEIV0,
  6045           WS-ERPNDB2-FILE-ID,
  6046           DFHEIV20,
  6047           DFHEIV99,
  6048           ERPNDB2-KEY,
  6049           DFHEIV99,
  6050           DFHEIV99,
  6051           DFHEIV99
  6052     SET ADDRESS OF PENDING-BUSINESS TO
  6053         DFHEIV20
  6054     MOVE EIBRESP  TO WS-RESPONSE
  6055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6056     .
  6057 0370-EXIT.
  6058     EXIT.
  6059 0380-BUILD-FROM-ERPNDB.
  6060     display ' made it to 0380 '
  6061     MOVE PB-CARRIER             TO CARRO
  6062     MOVE PB-GROUPING            TO GROUPO
  6063     MOVE PB-STATE               TO STATEO
  6064     MOVE PB-ACCOUNT             TO ACCTO
  6065     MOVE PB-CERT-PRIME          TO CERTNOO
  6066     MOVE PB-CERT-SFX            TO CRTSFXO
  6067     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  6068     MOVE ' '                    TO DC-OPTION-CODE
  6069     PERFORM 9700-DATE-LINK
  6070     IF NO-CONVERSION-ERROR
  6071        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6072     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 107
* EL6316.cbl
  6073     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6074     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6075     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6076     MOVE PB-C-LF-CANCEL-DT        TO DC-BIN-DATE-1
  6077     MOVE ' '                      TO DC-OPTION-CODE
  6078     PERFORM 9700-DATE-LINK
  6079     IF NO-CONVERSION-ERROR
  6080        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6081     END-IF
  6082     MOVE PB-C-AH-CANCEL-DT        TO DC-BIN-DATE-1
  6083     MOVE ' '                      TO DC-OPTION-CODE
  6084     PERFORM 9700-DATE-LINK
  6085     IF NO-CONVERSION-ERROR
  6086        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6087     END-IF
  6088     MOVE PB-C-LF-CANCEL-AMT       TO NLFAMTO
  6089     MOVE PB-C-AH-CANCEL-AMT       TO NAHAMTO
  6090     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6091        MOVE PB-CI-LIFE-COMMISSION
  6092                              TO LFCOMMO
  6093*       MOVE AL-UNNON         TO LFCOMMA
  6094     END-IF
  6095     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6096        MOVE PB-CI-AH-COMMISSION
  6097                              TO AHCOMMO
  6098*       MOVE AL-UNNON         TO AHCOMMA
  6099     END-IF
  6100     MOVE ER-2785                TO EMI-ERROR
  6101     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  6102     .
  6103 0380-EXIT.
  6104     EXIT.
  6105 0390-BUILD-FROM-ERENDT.
  6106     MOVE LOW-VALUES             TO EL631II
  6107*    move PI-PRTSW-ENTERED       to prtswo
  6108     IF PI-CERTNT1-ENTERED > SPACES
  6109        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6110        MOVE AL-UANON            TO CRTNT1A
  6111        MOVE +63                 TO CRTNT1L
  6112     END-IF
  6113
  6114     IF PI-CERTNT2-ENTERED > SPACES
  6115        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6116        MOVE AL-UANON            TO CRTNT2A
  6117        MOVE +63                 TO CRTNT2L
  6118     END-IF
  6119
  6120     IF PI-BILLNT1-ENTERED > SPACES
  6121        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6122        MOVE AL-UANON            TO BILNT1A
  6123        MOVE +63                 TO BILNT1L
  6124     END-IF
  6125
  6126     MOVE PI-COMPANY-CD          TO PI-ENDT-COMPANY-CD
  6127     MOVE EN-CARRIER             TO PI-ENDT-CARRIER
  6128     MOVE EN-GROUPING            TO PI-ENDT-GROUPING
  6129     MOVE EN-STATE               TO PI-ENDT-STATE
  6130     MOVE EN-ACCOUNT             TO PI-ENDT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 108
* EL6316.cbl
  6131     MOVE EN-CERT-PRIME          TO PI-ENDT-CERT-PRIME
  6132     MOVE EN-CERT-SFX            TO PI-ENDT-CERT-SFX
  6133     MOVE EN-CERT-EFF-DT         TO PI-ENDT-CERT-EFF-DT
  6134     MOVE EN-REC-TYPE            TO PI-ENDT-RECORD-TYPE
  6135     MOVE EN-SEQ-NO              TO PI-ENDT-SEQ-NO
  6136     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6137     MOVE EN-CARRIER             TO CARRO
  6138     MOVE EN-GROUPING            TO GROUPO
  6139     MOVE EN-STATE               TO STATEO
  6140     MOVE EN-ACCOUNT             TO ACCTO
  6141     MOVE EN-CERT-PRIME          TO CERTNOO
  6142     MOVE EN-CERT-SFX            TO CRTSFXO
  6143     MOVE EN-SEQ-NO              TO SEQNOO
  6144     MOVE EN-TEMPLATE-USED       TO LTRIDO
  6145     PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6146     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6147     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6148     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6149     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6150        MOVE PB-CI-LIFE-COMMISSION TO LFCOMMO
  6151     END-IF
  6152     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6153        MOVE PB-CI-AH-COMMISSION TO AHCOMMO
  6154     END-IF
  6155     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6156        IF EN-REASON-CODE (S1) NOT = SPACES
  6157           MOVE EN-REASON-CODE (S1) TO REACD-IN (S1)
  6158           MOVE AL-SANON         TO REACDA (S1)
  6159           MOVE +4               TO REACDL (S1)
  6160        END-IF
  6161     END-PERFORM
  6162     MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
  6163     MOVE ' '                    TO DC-OPTION-CODE
  6164     PERFORM 9700-DATE-LINK
  6165     IF NO-CONVERSION-ERROR
  6166        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6167     END-IF
  6168     IF EN-PROCESS-DT NOT = SPACES AND LOW-VALUES
  6169        MOVE EN-PROCESS-DT       TO DC-BIN-DATE-1
  6170        MOVE ' '                 TO DC-OPTION-CODE
  6171        PERFORM 9700-DATE-LINK
  6172        IF NO-CONVERSION-ERROR
  6173           MOVE DC-GREG-DATE-1-EDIT
  6174                                 TO PROCDTO
  6175        END-IF
  6176     END-IF
  6177     IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
  6178        MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
  6179        MOVE ' '                 TO DC-OPTION-CODE
  6180        PERFORM 9700-DATE-LINK
  6181        IF NO-CONVERSION-ERROR
  6182           MOVE DC-GREG-DATE-1-EDIT
  6183                                 TO INPDTO
  6184        END-IF
  6185     END-IF
  6186     MOVE EN-LF-ORIG-REF-DT        TO DC-BIN-DATE-1
  6187     MOVE ' '                      TO DC-OPTION-CODE
  6188     PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 109
* EL6316.cbl
  6189     IF NO-CONVERSION-ERROR
  6190        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6191     END-IF
  6192     MOVE EN-LF-ORIG-REF-AMT       TO OLFAMTO
  6193     MOVE EN-AH-ORIG-REF-DT        TO DC-BIN-DATE-1
  6194     MOVE ' '                      TO DC-OPTION-CODE
  6195     PERFORM 9700-DATE-LINK
  6196     IF NO-CONVERSION-ERROR
  6197        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6198     END-IF
  6199     MOVE EN-AH-ORIG-REF-AMT       TO OAHAMTO
  6200     MOVE EN-LF-NEW-REF-DT         TO DC-BIN-DATE-1
  6201     MOVE ' '                      TO DC-OPTION-CODE
  6202     PERFORM 9700-DATE-LINK
  6203     IF NO-CONVERSION-ERROR
  6204        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6205     END-IF
  6206     MOVE EN-LF-NEW-REF-AMT        TO NLFAMTO
  6207     MOVE EN-AH-NEW-REF-DT         TO DC-BIN-DATE-1
  6208     MOVE ' '                      TO DC-OPTION-CODE
  6209     PERFORM 9700-DATE-LINK
  6210     IF NO-CONVERSION-ERROR
  6211        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6212     END-IF
  6213     MOVE EN-AH-NEW-REF-AMT        TO NAHAMTO
  6214     MOVE EN-ARCHIVE-NO            TO ARCHNOO
  6215     .
  6216 0390-EXIT.
  6217     EXIT.
  6218 0400-ADD-ERENDT.
  6219     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6220
  6221* EXEC CICS GETMAIN
  6222*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6223*         LENGTH   (ERENDT-LENGTH)
  6224*         INITIMG  (GETMAIN-SPACE)
  6225*    END-EXEC
  6226*    MOVE ',"IL                  $   #00006079' TO DFHEIV0
  6227     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6228     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6229     MOVE X'2020233030303036303739' TO DFHEIV0(25:11)
  6230     CALL 'kxdfhei1' USING DFHEIV0,
  6231           DFHEIV20,
  6232           ERENDT-LENGTH,
  6233           GETMAIN-SPACE
  6234     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6235         DFHEIV20
  6236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6237     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6238     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6239     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6240     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6241                                    EN-INPUT-DT
  6242     MOVE OC-LF-CANCEL-DT        TO EN-LF-ORIG-REF-DT
  6243     MOVE OC-AH-CANCEL-DT        TO EN-AH-ORIG-REF-DT
  6244     MOVE OC-LF-CANCEL-AMT       TO EN-LF-ORIG-REF-AMT
  6245     MOVE OC-AH-CANCEL-AMT       TO EN-AH-ORIG-REF-AMT
  6246
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 110
* EL6316.cbl
  6247     MOVE OC-LF-ITD-CANCEL-AMT   TO NEW-LF-ITD-CANCEL-AMT
  6248     MOVE OC-AH-ITD-CANCEL-AMT   TO NEW-AH-ITD-CANCEL-AMT
  6249
  6250     MOVE OC-INS-LAST-NAME       TO EN-INS-LAST-NAME
  6251     MOVE OC-INS-FIRST-NAME      TO EN-INS-FIRST-NAME
  6252     MOVE OC-INS-MIDDLE-INIT     TO EN-INS-MIDDLE-INIT
  6253
  6254     MOVE OC-LF-COMM-PCT         TO EN-LF-ORIG-REF-COMM-PCT
  6255     MOVE OC-AH-COMM-PCT         TO EN-AH-ORIG-REF-COMM-PCT
  6256
  6257* EXEC CICS READ
  6258*        DATASET   (WS-ERPNDB-FILE-ID)
  6259*        SET       (ADDRESS OF PENDING-BUSINESS)
  6260*        RIDFLD    (PI-ERPNDB-KEY)
  6261*        RESP      (WS-RESPONSE)
  6262*    END-EXEC
  6263*    MOVE '&"S        E          (  N#00006103' TO DFHEIV0
  6264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6266     MOVE X'204E233030303036313033' TO DFHEIV0(25:11)
  6267     CALL 'kxdfhei1' USING DFHEIV0,
  6268           WS-ERPNDB-FILE-ID,
  6269           DFHEIV20,
  6270           DFHEIV99,
  6271           PI-ERPNDB-KEY,
  6272           DFHEIV99,
  6273           DFHEIV99,
  6274           DFHEIV99
  6275     SET ADDRESS OF PENDING-BUSINESS TO
  6276         DFHEIV20
  6277     MOVE EIBRESP  TO WS-RESPONSE
  6278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6279     IF NOT RESP-NORMAL
  6280        GO TO 0400-EXIT
  6281     END-IF
  6282     MOVE PB-C-LF-CANCEL-DT      TO EN-LF-NEW-REF-DT
  6283                                    NEW-LF-CANCEL-DT
  6284     MOVE PB-C-AH-CANCEL-DT      TO EN-AH-NEW-REF-DT
  6285                                    NEW-AH-CANCEL-DT
  6286     MOVE PB-C-LF-CANCEL-AMT     TO EN-LF-NEW-REF-AMT
  6287                                    NEW-LF-CANCEL-AMT
  6288     MOVE PB-C-AH-CANCEL-AMT     TO EN-AH-NEW-REF-AMT
  6289                                    NEW-AH-CANCEL-AMT
  6290     MOVE PB-CI-LIFE-COMMISSION  TO EN-LF-COMMISSION
  6291                                    EN-LF-NEW-REF-COMM-PCT
  6292                                    NEW-LF-COMM-PCT
  6293     MOVE PB-CI-AH-COMMISSION    TO EN-AH-COMMISSION
  6294                                    EN-AH-NEW-REF-COMM-PCT
  6295                                    NEW-AH-COMM-PCT
  6296     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6297     MOVE 'C'                    TO EN-DOCU-TYPE
  6298     MOVE 'Y'                    TO EN-MONEY-SW
  6299     MOVE PB-ENTRY-BATCH         TO EN-BATCH-NUMBER
  6300     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6301     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6302     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6303        IF REACD-IN (S1) NOT = LOW-VALUES
  6304           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 111
* EL6316.cbl
  6305        END-IF
  6306     END-PERFORM
  6307     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6308
  6309     IF ACCT-FOUND
  6310        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  6311        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
  6312        IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  6313           MOVE PB-C-LF-CANCEL-DT
  6314                                 TO DC-BIN-DATE-2
  6315        END-IF
  6316        MOVE '1'                 TO DC-OPTION-CODE
  6317        PERFORM 9700-DATE-LINK
  6318        IF NO-CONVERSION-ERROR
  6319           MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  6320           IF DC-ODD-DAYS-OVER > +1
  6321              ADD +1          TO WS-DIFF
  6322           END-IF
  6323        ELSE
  6324            MOVE +0           TO WS-DIFF
  6325        END-IF
  6326     ELSE
  6327        MOVE +0           TO WS-DIFF
  6328     END-IF
  6329
  6330     COMPUTE WS-DUE-BORROWER = (EN-LF-NEW-REF-AMT
  6331         + EN-AH-NEW-REF-AMT)
  6332
  6333     IF (WS-CHGBACK = 99)
  6334         OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  6335          MOVE WS-DUE-BORROWER TO EN-CSO-PORTION
  6336          MOVE ZEROS           TO EN-ACCT-PORTION
  6337          MOVE 'N'             TO EN-COMM-CHGBK
  6338     ELSE
  6339         COMPUTE EN-ACCT-PORTION = (EN-LF-NEW-REF-AMT
  6340                 * EN-LF-COMMISSION) +
  6341                (EN-AH-NEW-REF-AMT * EN-AH-COMMISSION)
  6342         COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER
  6343                 - EN-ACCT-PORTION
  6344         MOVE 'Y'                TO EN-COMM-CHGBK
  6345     END-IF
  6346     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6347     .
  6348 0400-EXIT.
  6349     EXIT.
  6350 0410-INIT-ERENDT.
  6351     MOVE OC-CONTROL-PRIMARY (1:33) TO ERENDT-KEY (1:33)
  6352     MOVE 'C'                    TO ENDT-RECORD-TYPE
  6353     MOVE ZEROS                  TO ENDT-SEQ-NO
  6354
  6355* EXEC CICS READ
  6356*        DATASET    (WS-ERENDT-FILE-ID)
  6357*        RIDFLD     (ERENDT-KEY)
  6358*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6359*        RESP       (WS-RESPONSE)
  6360*        GTEQ
  6361*    END-EXEC
  6362*    MOVE '&"S        G          (  N#00006184' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 112
* EL6316.cbl
  6363     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6365     MOVE X'204E233030303036313834' TO DFHEIV0(25:11)
  6366     CALL 'kxdfhei1' USING DFHEIV0,
  6367           WS-ERENDT-FILE-ID,
  6368           DFHEIV20,
  6369           DFHEIV99,
  6370           ERENDT-KEY,
  6371           DFHEIV99,
  6372           DFHEIV99,
  6373           DFHEIV99
  6374     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6375         DFHEIV20
  6376     MOVE EIBRESP  TO WS-RESPONSE
  6377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6378     IF RESP-NORMAL
  6379        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
  6380        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6381     ELSE
  6382        MOVE +4096               TO WS-SEQ-NO
  6383     END-IF
  6384     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6385     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6386     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6387     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6388     MOVE WS-CURRENT-BIN-DT      TO EN-PROCESS-DT
  6389     MOVE 'C'                    TO EN-REC-TYPE
  6390     INITIALIZE EN-CANCEL-RECORD
  6391     MOVE ZEROS TO EN-CSO-PORTION EN-ACCT-PORTION
  6392     MOVE LOW-VALUES             TO EN-LF-ORIG-REF-DT
  6393                                    EN-AH-ORIG-REF-DT
  6394                                    EN-LF-NEW-REF-DT
  6395                                    EN-AH-NEW-REF-DT
  6396     .
  6397 0410-EXIT.
  6398     EXIT.
  6399 0420-UPDATE-ELCRTO.
  6400     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6401     IF RESP-NORMAL
  6402        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6403                                    OC-LAST-MAINT-DT
  6404        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6405        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6406
  6407* EXEC CICS REWRITE
  6408*          FROM     (ORIGINAL-CERTIFICATE)
  6409*          DATASET  ('ELCRTO')
  6410*       END-EXEC
  6411     MOVE LENGTH OF
  6412      ORIGINAL-CERTIFICATE
  6413       TO DFHEIV11
  6414     MOVE 'ELCRTO' TO DFHEIV1
  6415*    MOVE '&& L                  %   #00006219' TO DFHEIV0
  6416     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6418     MOVE X'2020233030303036323139' TO DFHEIV0(25:11)
  6419     CALL 'kxdfhei1' USING DFHEIV0,
  6420           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 113
* EL6316.cbl
  6421           ORIGINAL-CERTIFICATE,
  6422           DFHEIV11,
  6423           DFHEIV99
  6424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6425     END-IF
  6426     .
  6427 0420-EXIT.
  6428     EXIT.
  6429
  6430 0425-ADD-NEW-ELCRTO.
  6431     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6432     MOVE 'OC'                   TO OC-RECORD-ID
  6433     MOVE PI-ELCRTO-KEY          TO OC-CONTROL-PRIMARY
  6434     SUBTRACT +1                 FROM OC-KEY-SEQ-NO
  6435     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6436     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6437     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6438     MOVE NEW-INS-FIRST-NAME     TO OC-INS-FIRST-NAME
  6439     MOVE NEW-INS-MIDDLE-INIT    TO OC-INS-MIDDLE-INIT
  6440     MOVE NEW-INS-LAST-NAME      TO OC-INS-LAST-NAME
  6441     MOVE NEW-INS-AGE            TO OC-INS-AGE
  6442     MOVE NEW-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6443     MOVE NEW-JNT-FIRST-NAME     TO OC-JNT-FIRST-NAME
  6444     MOVE NEW-JNT-MIDDLE-INIT    TO OC-JNT-MIDDLE-INIT
  6445     MOVE NEW-JNT-LAST-NAME      TO OC-JNT-LAST-NAME
  6446     MOVE NEW-JNT-AGE            TO OC-JNT-AGE
  6447     MOVE NEW-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6448     MOVE NEW-LF-BENCD           TO OC-LF-BENCD
  6449     MOVE NEW-LF-BEN-AMT         TO OC-LF-BEN-AMT
  6450     MOVE NEW-LF-PRM-AMT         TO OC-LF-PRM-AMT
  6451     MOVE NEW-LF-ALT-BEN-AMT     TO OC-LF-ALT-BEN-AMT
  6452     MOVE NEW-LF-ALT-PRM-AMT     TO OC-LF-ALT-PRM-AMT
  6453     MOVE NEW-LF-TERM            TO OC-LF-TERM
  6454     MOVE NEW-LF-EXP-DT          TO OC-LF-EXP-DT
  6455     MOVE NEW-LF-COMM-PCT        TO OC-LF-COMM-PCT
  6456     MOVE NEW-LF-CANCEL-DT       TO OC-LF-CANCEL-DT
  6457     MOVE NEW-LF-CANCEL-AMT      TO OC-LF-CANCEL-AMT
  6458     MOVE NEW-AH-BENCD           TO OC-AH-BENCD
  6459     MOVE NEW-AH-BEN-AMT         TO OC-AH-BEN-AMT
  6460     MOVE NEW-AH-PRM-AMT         TO OC-AH-PRM-AMT
  6461     MOVE NEW-AH-TERM            TO OC-AH-TERM
  6462     MOVE NEW-AH-EXP-DT          TO OC-AH-EXP-DT
  6463     MOVE NEW-AH-CP              TO OC-AH-CP
  6464     MOVE NEW-AH-COMM-PCT        TO OC-AH-COMM-PCT
  6465     MOVE NEW-AH-CANCEL-DT       TO OC-AH-CANCEL-DT
  6466     MOVE NEW-AH-CANCEL-AMT      TO OC-AH-CANCEL-AMT
  6467     MOVE NEW-CRED-BENE-NAME     TO OC-CRED-BENE-NAME
  6468     MOVE NEW-1ST-PMT-DT         TO OC-1ST-PMT-DT
  6469     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
  6470     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  6471     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6472     .
  6473 0425-WRITE-ELCRTO.
  6474
  6475
  6476* EXEC CICS WRITE
  6477*       DATASET   ('ELCRTO')
  6478*       FROM      (ORIGINAL-CERTIFICATE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 114
* EL6316.cbl
  6479*       RIDFLD    (OC-CONTROL-PRIMARY)
  6480*       RESP      (WS-RESPONSE)
  6481*    END-EXEC
  6482     MOVE LENGTH OF
  6483      ORIGINAL-CERTIFICATE
  6484       TO DFHEIV11
  6485     MOVE 'ELCRTO' TO DFHEIV1
  6486*    MOVE '&$ L                  ''  N#00006273' TO DFHEIV0
  6487     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6488     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6489     MOVE X'204E233030303036323733' TO DFHEIV0(25:11)
  6490     CALL 'kxdfhei1' USING DFHEIV0,
  6491           DFHEIV1,
  6492           ORIGINAL-CERTIFICATE,
  6493           DFHEIV11,
  6494           OC-CONTROL-PRIMARY,
  6495           DFHEIV99,
  6496           DFHEIV99
  6497     MOVE EIBRESP  TO WS-RESPONSE
  6498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6499
  6500     display ' just wrote new crto ' ws-response
  6501     IF RESP-DUPKEY
  6502        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6503        GO TO 0425-WRITE-ELCRTO
  6504     ELSE
  6505        IF NOT RESP-NORMAL
  6506           MOVE -1               TO LTRIDL
  6507           MOVE ER-3830          TO EMI-ERROR
  6508           PERFORM 9900-ERROR-FORMAT
  6509                                 THRU 9900-EXIT
  6510        ELSE
  6511           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6512        END-IF
  6513     END-IF
  6514
  6515     .
  6516 0425-EXIT.
  6517     EXIT.
  6518
  6519 0426-ADD-CERT-NOTES.
  6520
  6521     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6522     SET TB-INDX TO 1
  6523
  6524     IF PI-CERTNT1-ENTERED > SPACES
  6525         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6526         MOVE PI-PROCESSOR-ID    TO
  6527                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6528         MOVE EIBTIME            TO
  6529                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6530         MOVE WS-CURRENT-BIN-DT  TO
  6531                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6532         SET TB-INDX UP BY +1
  6533     END-IF
  6534
  6535     IF PI-CERTNT2-ENTERED > SPACES
  6536         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 115
* EL6316.cbl
  6537         MOVE PI-PROCESSOR-ID    TO
  6538                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6539         MOVE EIBTIME            TO
  6540                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6541         MOVE WS-CURRENT-BIN-DT  TO
  6542                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6543         SET TB-INDX UP BY +1
  6544     END-IF
  6545
  6546     IF CERT-NOTE-ENTRIES > SPACES
  6547         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6548         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6549     END-IF
  6550
  6551     IF PI-BILLNT1-ENTERED > SPACES
  6552         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6553         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6554         MOVE +63 TO WS-LEN
  6555         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6556     END-IF
  6557
  6558     .
  6559 0426-EXIT.
  6560     EXIT.
  6561
  6562 0427-LOAD-CURRENT-CERT-NOTES.
  6563
  6564     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6565     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6566     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6567     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6568     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6569     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6570     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6571     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6572     MOVE '1'                 TO ERCNOT-REC-TYP
  6573     MOVE +0                  TO ERCNOT-SEQ
  6574     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6575
  6576
  6577* EXEC CICS STARTBR
  6578*         DATASET(WS-ERCNOT-FILE-ID)
  6579*         RIDFLD(ERCNOT-KEY)
  6580*         KEYLENGTH(ERCNOT-START-LENGTH)
  6581*         RESP      (WS-RESPONSE)
  6582*         GENERIC
  6583*         GTEQ
  6584*    END-EXEC.
  6585     MOVE 0
  6586       TO DFHEIV11
  6587*    MOVE '&,   KG    G          &  N#00006356' TO DFHEIV0
  6588     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6589     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6590     MOVE X'204E233030303036333536' TO DFHEIV0(25:11)
  6591     CALL 'kxdfhei1' USING DFHEIV0,
  6592           WS-ERCNOT-FILE-ID,
  6593           ERCNOT-KEY,
  6594           ERCNOT-START-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 116
* EL6316.cbl
  6595           DFHEIV11,
  6596           DFHEIV99
  6597     MOVE EIBRESP  TO WS-RESPONSE
  6598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6599
  6600
  6601     IF NOT RESP-NORMAL
  6602        GO TO 0427-ENDBR
  6603     END-IF.
  6604
  6605 0427-LOOP.
  6606
  6607* EXEC CICS READNEXT
  6608*         SET(ADDRESS OF CERT-NOTE-FILE)
  6609*         DATASET(WS-ERCNOT-FILE-ID)
  6610*         RIDFLD(ERCNOT-KEY)
  6611*    END-EXEC.
  6612     MOVE 0
  6613       TO DFHEIV11
  6614*    MOVE '&.S                   )   #00006370' TO DFHEIV0
  6615     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6616     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6617     MOVE X'2020233030303036333730' TO DFHEIV0(25:11)
  6618     CALL 'kxdfhei1' USING DFHEIV0,
  6619           WS-ERCNOT-FILE-ID,
  6620           DFHEIV20,
  6621           DFHEIV99,
  6622           ERCNOT-KEY,
  6623           DFHEIV99,
  6624           DFHEIV11,
  6625           DFHEIV99,
  6626           DFHEIV99
  6627     SET ADDRESS OF CERT-NOTE-FILE TO
  6628         DFHEIV20
  6629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6630
  6631
  6632     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6633         GO TO 0427-ENDBR
  6634     END-IF.
  6635
  6636     IF (CZ-CARRIER = SV-CARRIER)
  6637        AND (CZ-GROUPING = SV-GROUPING)
  6638        AND (CZ-STATE = SV-STATE)
  6639        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6640        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6641        AND (CZ-CERT-NO = SV-CERT-NO)
  6642        AND (CZ-RECORD-TYPE = '1')
  6643          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6644          MOVE CZ-LAST-MAINT-USER TO
  6645                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6646          MOVE CZ-LAST-MAINT-DT TO
  6647                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6648          MOVE CZ-LAST-MAINT-HHMMSS TO
  6649                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6650          SET TB-INDX UP BY 1
  6651          GO TO 0427-LOOP
  6652     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 117
* EL6316.cbl
  6653
  6654 0427-ENDBR.
  6655
  6656
  6657* EXEC CICS ENDBR
  6658*         DATASET(WS-ERCNOT-FILE-ID)
  6659*    END-EXEC.
  6660     MOVE 0
  6661       TO DFHEIV11
  6662*    MOVE '&2                    $   #00006400' TO DFHEIV0
  6663     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6664     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6665     MOVE X'2020233030303036343030' TO DFHEIV0(25:11)
  6666     CALL 'kxdfhei1' USING DFHEIV0,
  6667           WS-ERCNOT-FILE-ID,
  6668           DFHEIV11,
  6669           DFHEIV99
  6670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6671
  6672
  6673     .
  6674 0427-EXIT.
  6675     EXIT.
  6676
  6677 0430-WRITE-ERENDT.
  6678     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6679     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6680     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6681
  6682* EXEC CICS WRITE
  6683*         DATASET   (WS-ERENDT-FILE-ID)
  6684*         FROM      (ENDORSEMENT-RECORD)
  6685*         RIDFLD    (EN-CONTROL-PRIMARY)
  6686*         RESP      (WS-RESPONSE)
  6687*    END-EXEC
  6688     MOVE LENGTH OF
  6689      ENDORSEMENT-RECORD
  6690       TO DFHEIV11
  6691*    MOVE '&$ L                  ''  N#00006412' TO DFHEIV0
  6692     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6693     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6694     MOVE X'204E233030303036343132' TO DFHEIV0(25:11)
  6695     CALL 'kxdfhei1' USING DFHEIV0,
  6696           WS-ERENDT-FILE-ID,
  6697           ENDORSEMENT-RECORD,
  6698           DFHEIV11,
  6699           EN-CONTROL-PRIMARY,
  6700           DFHEIV99,
  6701           DFHEIV99
  6702     MOVE EIBRESP  TO WS-RESPONSE
  6703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6704     IF RESP-NORMAL
  6705        MOVE 'C'                 TO PI-DOCUMENT-PROCESSED
  6706        display ' good write erendt '
  6707        IF EIBAID = DFHPF4
  6708           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6709           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6710           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 118
* EL6316.cbl
  6711           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6712        END-IF
  6713     ELSE
  6714        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6715        MOVE -1                  TO LTRIDL
  6716        MOVE ER-0132             TO EMI-ERROR
  6717        MOVE AL-UABON            TO LTRIDA
  6718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6719     END-IF
  6720     .
  6721 0430-EXIT.
  6722     EXIT.
  6723 0440-ADD-BILLING-NOTE.
  6724
  6725* EXEC CICS GETMAIN
  6726*         SET      (ADDRESS OF EOB-CODES)
  6727*         LENGTH   (ELEOBC-LENGTH)
  6728*         INITIMG  (GETMAIN-SPACE)
  6729*    END-EXEC
  6730*    MOVE ',"IL                  $   #00006438' TO DFHEIV0
  6731     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6732     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6733     MOVE X'2020233030303036343338' TO DFHEIV0(25:11)
  6734     CALL 'kxdfhei1' USING DFHEIV0,
  6735           DFHEIV20,
  6736           ELEOBC-LENGTH,
  6737           GETMAIN-SPACE
  6738     SET ADDRESS OF EOB-CODES TO
  6739         DFHEIV20
  6740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6741
  6742     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6743     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6744     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6745
  6746
  6747* EXEC CICS STARTBR
  6748*        DATASET   ('ELEOBC')
  6749*        RIDFLD    (WS-ELEOBC-KEY)
  6750*        GTEQ
  6751*        RESP      (WS-RESPONSE)
  6752*    END-EXEC
  6753     MOVE 'ELEOBC' TO DFHEIV1
  6754     MOVE 0
  6755       TO DFHEIV11
  6756*    MOVE '&,         G          &  N#00006448' TO DFHEIV0
  6757     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6758     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6759     MOVE X'204E233030303036343438' TO DFHEIV0(25:11)
  6760     CALL 'kxdfhei1' USING DFHEIV0,
  6761           DFHEIV1,
  6762           WS-ELEOBC-KEY,
  6763           DFHEIV99,
  6764           DFHEIV11,
  6765           DFHEIV99
  6766     MOVE EIBRESP  TO WS-RESPONSE
  6767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6768
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 119
* EL6316.cbl
  6769     IF NOT RESP-NORMAL
  6770        GO TO 0440-EXIT
  6771     END-IF
  6772      .
  6773 0440-READNEXT-ELEOBC.
  6774
  6775
  6776* EXEC CICS READNEXT
  6777*       INTO    (EOB-CODES)
  6778*       DATASET ('ELEOBC')
  6779*       RIDFLD  (WS-ELEOBC-KEY)
  6780*       RESP    (WS-RESPONSE)
  6781*    END-EXEC
  6782     MOVE LENGTH OF
  6783      EOB-CODES
  6784       TO DFHEIV12
  6785     MOVE 'ELEOBC' TO DFHEIV1
  6786     MOVE 0
  6787       TO DFHEIV11
  6788*    MOVE '&.IL                  )  N#00006461' TO DFHEIV0
  6789     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6790     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6791     MOVE X'204E233030303036343631' TO DFHEIV0(25:11)
  6792     CALL 'kxdfhei1' USING DFHEIV0,
  6793           DFHEIV1,
  6794           EOB-CODES,
  6795           DFHEIV12,
  6796           WS-ELEOBC-KEY,
  6797           DFHEIV99,
  6798           DFHEIV11,
  6799           DFHEIV99,
  6800           DFHEIV99
  6801     MOVE EIBRESP  TO WS-RESPONSE
  6802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6803
  6804     IF RESP-NORMAL
  6805         IF EO-RECORD-TYPE NOT = '5'
  6806             GO TO 0440-EXIT
  6807         END-IF
  6808     ELSE
  6809         GO TO 0440-EXIT
  6810     END-IF
  6811
  6812     IF EO-RECORD-TYPE = '5' AND
  6813        EO-EOB-CODE = PI-LTRID-ENTERED
  6814           CONTINUE
  6815     ELSE
  6816         GO TO 0440-READNEXT-ELEOBC
  6817     END-IF
  6818
  6819     MOVE SPACES TO WS-BILLING-NOTE
  6820     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6821     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6822     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6823     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6824     MOVE +25 TO WS-LEN
  6825
  6826     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 120
* EL6316.cbl
  6827     .
  6828 0440-EXIT.
  6829     EXIT.
  6830
  6831 0441-UPDATE-BILLING-NOTE.
  6832
  6833* EXEC CICS GETMAIN
  6834*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6835*         LENGTH   (ERNOTE-LENGTH)
  6836*         INITIMG  (GETMAIN-SPACE)
  6837*    END-EXEC
  6838*    MOVE ',"IL                  $   #00006496' TO DFHEIV0
  6839     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6841     MOVE X'2020233030303036343936' TO DFHEIV0(25:11)
  6842     CALL 'kxdfhei1' USING DFHEIV0,
  6843           DFHEIV20,
  6844           ERNOTE-LENGTH,
  6845           GETMAIN-SPACE
  6846     SET ADDRESS OF CERTIFICATE-NOTE TO
  6847         DFHEIV20
  6848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6849
  6850     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  6851
  6852
  6853* EXEC CICS READ
  6854*       DATASET    (WS-ERNOTE-FILE-ID)
  6855*       RIDFLD     (WS-ERNOTE-KEY)
  6856*       INTO       (CERTIFICATE-NOTE)
  6857*       RESP       (WS-RESPONSE)
  6858*       UPDATE
  6859*    END-EXEC
  6860     MOVE LENGTH OF
  6861      CERTIFICATE-NOTE
  6862       TO DFHEIV11
  6863*    MOVE '&"IL       EU         (  N#00006504' TO DFHEIV0
  6864     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6865     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6866     MOVE X'204E233030303036353034' TO DFHEIV0(25:11)
  6867     CALL 'kxdfhei1' USING DFHEIV0,
  6868           WS-ERNOTE-FILE-ID,
  6869           CERTIFICATE-NOTE,
  6870           DFHEIV11,
  6871           WS-ERNOTE-KEY,
  6872           DFHEIV99,
  6873           DFHEIV99,
  6874           DFHEIV99
  6875     MOVE EIBRESP  TO WS-RESPONSE
  6876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6877
  6878     IF RESP-NORMAL
  6879       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  6880          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  6881       END-IF
  6882       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  6883          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  6884       END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 121
* EL6316.cbl
  6885       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6886           (NOTE-SUB > +10) OR
  6887           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  6888                             WS-BILLING-NOTE (1:WS-LEN))
  6889       END-PERFORM
  6890       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  6891                              WS-BILLING-NOTE (1:WS-LEN)
  6892
  6893* EXEC CICS UNLOCK
  6894*           DATASET    (WS-ERNOTE-FILE-ID)
  6895*        END-EXEC
  6896*    MOVE '&*                    #   #00006526' TO DFHEIV0
  6897     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6898     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6899     MOVE X'2020233030303036353236' TO DFHEIV0(25:11)
  6900     CALL 'kxdfhei1' USING DFHEIV0,
  6901           WS-ERNOTE-FILE-ID,
  6902           DFHEIV99
  6903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6904       ELSE
  6905         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6906           (NOTE-SUB > +10) OR
  6907           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  6908         END-PERFORM
  6909         IF (NOTE-SUB < +11)
  6910           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  6911              NOTE-SUB <= CN-BILLING-END-LINE-NO
  6912                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6913           ELSE
  6914             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  6915              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  6916                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  6917                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  6918             ELSE
  6919               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  6920                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  6921                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6922                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  6923               ELSE
  6924                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  6925                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  6926                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  6927                                       CN-BILLING-START-LINE-NO
  6928                 ELSE
  6929                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  6930                 END-IF
  6931               END-IF
  6932             END-IF
  6933           END-IF
  6934           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6935           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6936           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6937
  6938* EXEC CICS REWRITE
  6939*             DATASET    (WS-ERNOTE-FILE-ID)
  6940*             FROM       (CERTIFICATE-NOTE)
  6941*             RESP       (WS-RESPONSE)
  6942*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 122
* EL6316.cbl
  6943     MOVE LENGTH OF
  6944      CERTIFICATE-NOTE
  6945       TO DFHEIV11
  6946*    MOVE '&& L                  %  N#00006562' TO DFHEIV0
  6947     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6948     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6949     MOVE X'204E233030303036353632' TO DFHEIV0(25:11)
  6950     CALL 'kxdfhei1' USING DFHEIV0,
  6951           WS-ERNOTE-FILE-ID,
  6952           CERTIFICATE-NOTE,
  6953           DFHEIV11,
  6954           DFHEIV99
  6955     MOVE EIBRESP  TO WS-RESPONSE
  6956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6957           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6958         END-IF
  6959       END-IF
  6960     ELSE
  6961        MOVE SPACES              TO CERTIFICATE-NOTE
  6962        MOVE 'CN'                TO CN-RECORD-ID
  6963        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  6964                                     WS-ERNOTE-KEY
  6965        MOVE 01                  TO CN-BILLING-START-LINE-NO
  6966                                    CN-BILLING-END-LINE-NO
  6967        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  6968        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6969        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6970        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6971
  6972* EXEC CICS WRITE
  6973*          DATASET    (WS-ERNOTE-FILE-ID)
  6974*          FROM       (CERTIFICATE-NOTE)
  6975*          RIDFLD     (WS-ERNOTE-KEY)
  6976*          RESP       (WS-RESPONSE)
  6977*       END-EXEC
  6978     MOVE LENGTH OF
  6979      CERTIFICATE-NOTE
  6980       TO DFHEIV11
  6981*    MOVE '&$ L                  ''  N#00006581' TO DFHEIV0
  6982     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6983     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6984     MOVE X'204E233030303036353831' TO DFHEIV0(25:11)
  6985     CALL 'kxdfhei1' USING DFHEIV0,
  6986           WS-ERNOTE-FILE-ID,
  6987           CERTIFICATE-NOTE,
  6988           DFHEIV11,
  6989           WS-ERNOTE-KEY,
  6990           DFHEIV99,
  6991           DFHEIV99
  6992     MOVE EIBRESP  TO WS-RESPONSE
  6993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6994
  6995        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6996     END-IF
  6997
  6998     .
  6999 0441-EXIT.
  7000     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 123
* EL6316.cbl
  7001
  7002
  7003 0442-SQUEEZE-IT-IN.
  7004
  7005     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7006        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7007           NOTE-SUB = +10
  7008           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7009           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7010             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7011             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7012             MOVE +9 TO NOTE-SUB
  7013           END-IF
  7014        END-PERFORM
  7015     ELSE
  7016        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7017           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7018             UNTIL NOTE-SUB = +1
  7019             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7020             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7021                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7022                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7023                MOVE +2          TO NOTE-SUB
  7024             END-IF
  7025           END-PERFORM
  7026        END-IF
  7027     END-IF
  7028
  7029     .
  7030 0442-EXIT.
  7031     EXIT.
  7032
  7033 0445-CERTIFICATE-UPDATE.
  7034    display 'billing note written, updating cert'
  7035     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7036     IF RESP-NORMAL
  7037        EVALUATE CM-NOTE-SW
  7038           WHEN '2'
  7039           WHEN '3'
  7040           WHEN '6'
  7041           WHEN '7'
  7042              SET NO-CERT-RW     TO TRUE
  7043           WHEN ' '
  7044              MOVE '2'           TO CM-NOTE-SW
  7045           WHEN '1'
  7046              MOVE '3'           TO CM-NOTE-SW
  7047           WHEN '4'
  7048              MOVE '6'           TO CM-NOTE-SW
  7049           WHEN '5'
  7050              MOVE '7'           TO CM-NOTE-SW
  7051        END-EVALUATE
  7052     END-IF
  7053     IF NOT NO-CERT-RW
  7054        PERFORM 1810-REWRITE-ELCERT
  7055                                 THRU 1810-EXIT
  7056     ELSE
  7057
  7058* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 124
* EL6316.cbl
  7059*          DATASET    (WS-ELCERT-FILE-ID)
  7060*       END-EXEC
  7061*    MOVE '&*                    #   #00006650' TO DFHEIV0
  7062     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7063     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7064     MOVE X'2020233030303036363530' TO DFHEIV0(25:11)
  7065     CALL 'kxdfhei1' USING DFHEIV0,
  7066           WS-ELCERT-FILE-ID,
  7067           DFHEIV99
  7068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7069     END-IF
  7070
  7071     .
  7072 0445-EXIT.
  7073     EXIT.
  7074
  7075 0450-GET-ERACCT.
  7076     DISPLAY ' MADE IT TO 0450 '
  7077     MOVE ' '                    TO WS-ERACCT-SW
  7078     MOVE ZEROS                  TO WS-CHGBACK
  7079                                    WS-CSO-PORTION
  7080                                    WS-ACCT-PORTION
  7081                                    WS-DIFF
  7082     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7083     IF RESP-NORMAL
  7084        DISPLAY ' GOOD STARTBR '
  7085        PERFORM 0470-READNEXT-ERACCT
  7086                                 THRU 0470-EXIT
  7087     END-IF
  7088     IF RESP-NORMAL
  7089        DISPLAY ' GOOD READNEXT '
  7090        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7091           IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7092              AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7093              DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7094              SET ACCT-FOUND TO TRUE
  7095           ELSE
  7096              PERFORM 0470-READNEXT-ERACCT
  7097                                 THRU 0470-EXIT
  7098              IF RESP-NORMAL
  7099                 IF AM-CONTROL-PRIMARY (1:20)
  7100                    = EN-CONTROL-PRIMARY (1:20)
  7101                    IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7102                       AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7103                       DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7104                       SET ACCT-FOUND TO TRUE
  7105                    END-IF
  7106                 END-IF
  7107              END-IF
  7108           END-IF
  7109        END-IF
  7110     END-IF
  7111     IF ACCT-FOUND
  7112        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7113           (AM-COM-TYP (S1) = 'C' OR 'D')
  7114           OR (S1 > +10)
  7115        END-PERFORM
  7116        IF S1 < +11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 125
* EL6316.cbl
  7117           MOVE AM-COMM-CHARGEBACK (S1)
  7118                                 TO WS-CHGBACK
  7119        END-IF
  7120     END-IF
  7121
  7122* EXEC CICS ENDBR
  7123*        DATASET     ('ERACCT')
  7124*    END-EXEC.
  7125     MOVE 'ERACCT' TO DFHEIV1
  7126     MOVE 0
  7127       TO DFHEIV11
  7128*    MOVE '&2                    $   #00006705' TO DFHEIV0
  7129     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7130     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7131     MOVE X'2020233030303036373035' TO DFHEIV0(25:11)
  7132     CALL 'kxdfhei1' USING DFHEIV0,
  7133           DFHEIV1,
  7134           DFHEIV11,
  7135           DFHEIV99
  7136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7137
  7138    .
  7139 0450-EXIT.
  7140     EXIT.
  7141 0460-STARTBR-ERACCT.
  7142     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7143     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7144     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7145
  7146* EXEC CICS STARTBR
  7147*        DATASET   ('ERACCT')
  7148*        RIDFLD    (WS-ERACCT-KEY)
  7149*        GTEQ
  7150*        RESP      (WS-RESPONSE)
  7151*    END-EXEC
  7152     MOVE 'ERACCT' TO DFHEIV1
  7153     MOVE 0
  7154       TO DFHEIV11
  7155*    MOVE '&,         G          &  N#00006715' TO DFHEIV0
  7156     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7157     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7158     MOVE X'204E233030303036373135' TO DFHEIV0(25:11)
  7159     CALL 'kxdfhei1' USING DFHEIV0,
  7160           DFHEIV1,
  7161           WS-ERACCT-KEY,
  7162           DFHEIV99,
  7163           DFHEIV11,
  7164           DFHEIV99
  7165     MOVE EIBRESP  TO WS-RESPONSE
  7166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7167     .
  7168 0460-EXIT.
  7169     EXIT.
  7170 0470-READNEXT-ERACCT.
  7171
  7172* EXEC CICS READNEXT
  7173*       SET      (ADDRESS OF ACCOUNT-MASTER)
  7174*       DATASET ('ERACCT')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 126
* EL6316.cbl
  7175*       RIDFLD  (WS-ERACCT-KEY)
  7176*       RESP    (WS-RESPONSE)
  7177*    END-EXEC
  7178     MOVE 'ERACCT' TO DFHEIV1
  7179     MOVE 0
  7180       TO DFHEIV11
  7181*    MOVE '&.S                   )  N#00006725' TO DFHEIV0
  7182     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7183     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7184     MOVE X'204E233030303036373235' TO DFHEIV0(25:11)
  7185     CALL 'kxdfhei1' USING DFHEIV0,
  7186           DFHEIV1,
  7187           DFHEIV20,
  7188           DFHEIV99,
  7189           WS-ERACCT-KEY,
  7190           DFHEIV99,
  7191           DFHEIV11,
  7192           DFHEIV99,
  7193           DFHEIV99
  7194     SET ADDRESS OF ACCOUNT-MASTER TO
  7195         DFHEIV20
  7196     MOVE EIBRESP  TO WS-RESPONSE
  7197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7198     .
  7199 0470-EXIT.
  7200     EXIT.
  7201 0491-ERNOTE-READ-UPDATE.
  7202
  7203* EXEC CICS READ
  7204*       UPDATE
  7205*       DATASET    (WS-ERNOTE-FILE-ID)
  7206*       RIDFLD     (WS-ERNOTE-KEY)
  7207*       SET        (ADDRESS OF CERTIFICATE-NOTE)
  7208*       RESP       (WS-RESPONSE)
  7209*    END-EXEC
  7210*    MOVE '&"S        EU         (  N#00006735' TO DFHEIV0
  7211     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7212     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7213     MOVE X'204E233030303036373335' TO DFHEIV0(25:11)
  7214     CALL 'kxdfhei1' USING DFHEIV0,
  7215           WS-ERNOTE-FILE-ID,
  7216           DFHEIV20,
  7217           DFHEIV99,
  7218           WS-ERNOTE-KEY,
  7219           DFHEIV99,
  7220           DFHEIV99,
  7221           DFHEIV99
  7222     SET ADDRESS OF CERTIFICATE-NOTE TO
  7223         DFHEIV20
  7224     MOVE EIBRESP  TO WS-RESPONSE
  7225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7226     .
  7227 0491-EXIT.
  7228     EXIT.
  7229 0492-REWRITE-ERNOTE.
  7230     MOVE 'E631'              TO CN-LAST-MAINT-USER
  7231     MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7232     MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 127
* EL6316.cbl
  7233
  7234* EXEC CICS REWRITE
  7235*       DATASET    (WS-ERNOTE-FILE-ID)
  7236*       FROM       (CERTIFICATE-NOTE)
  7237*       RESP       (WS-RESPONSE)
  7238*    END-EXEC
  7239     MOVE LENGTH OF
  7240      CERTIFICATE-NOTE
  7241       TO DFHEIV11
  7242*    MOVE '&& L                  %  N#00006749' TO DFHEIV0
  7243     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7244     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7245     MOVE X'204E233030303036373439' TO DFHEIV0(25:11)
  7246     CALL 'kxdfhei1' USING DFHEIV0,
  7247           WS-ERNOTE-FILE-ID,
  7248           CERTIFICATE-NOTE,
  7249           DFHEIV11,
  7250           DFHEIV99
  7251     MOVE EIBRESP  TO WS-RESPONSE
  7252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7253     .
  7254 0492-EXIT.
  7255     EXIT.
  7256 0493-SQUEEZE-ERNOTE.
  7257     IF CN-BILLING-START-LINE-NO > 0
  7258         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
  7259     ELSE
  7260         MOVE +1                 TO NOTE-SUB
  7261     END-IF.
  7262
  7263     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7264        (NOTE-SUB > +9)
  7265        IF CN-LINE (NOTE-SUB) = SPACES
  7266           MOVE CN-LINE (NOTE-SUB + +1)
  7267                                 TO CN-LINE (NOTE-SUB)
  7268           MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
  7269        END-IF
  7270     END-PERFORM
  7271     .
  7272 0493-EXIT.
  7273     EXIT.
  7274 0500-ERENDT-READ-GTEQ.
  7275
  7276* EXEC CICS READ
  7277*        DATASET    (WS-ERENDT-FILE-ID)
  7278*        RIDFLD     (ERENDT-KEY)
  7279*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7280*        RESP       (WS-RESPONSE)
  7281*        GTEQ
  7282*    END-EXEC
  7283*    MOVE '&"S        G          (  N#00006776' TO DFHEIV0
  7284     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7285     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7286     MOVE X'204E233030303036373736' TO DFHEIV0(25:11)
  7287     CALL 'kxdfhei1' USING DFHEIV0,
  7288           WS-ERENDT-FILE-ID,
  7289           DFHEIV20,
  7290           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 128
* EL6316.cbl
  7291           ERENDT-KEY,
  7292           DFHEIV99,
  7293           DFHEIV99,
  7294           DFHEIV99
  7295     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7296         DFHEIV20
  7297     MOVE EIBRESP  TO WS-RESPONSE
  7298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7299     IF NOT RESP-NORMAL
  7300        MOVE ER-2237             TO EMI-ERROR
  7301        PERFORM 9900-ERROR-FORMAT
  7302                                 THRU 9900-EXIT
  7303        MOVE -1                  TO CARRL
  7304        GO TO 8200-SEND-DATAONLY
  7305     END-IF
  7306     .
  7307 0500-EXIT.
  7308     EXIT.
  7309 0510-ERENDT-READNEXT.
  7310
  7311* EXEC CICS READNEXT
  7312*       DATASET    (WS-ERENDT-FILE-ID)
  7313*       RIDFLD     (ERENDT-KEY)
  7314*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7315*       RESP       (WS-RESPONSE)
  7316*    END-EXEC
  7317     MOVE 0
  7318       TO DFHEIV11
  7319*    MOVE '&.S                   )  N#00006794' TO DFHEIV0
  7320     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7321     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7322     MOVE X'204E233030303036373934' TO DFHEIV0(25:11)
  7323     CALL 'kxdfhei1' USING DFHEIV0,
  7324           WS-ERENDT-FILE-ID,
  7325           DFHEIV20,
  7326           DFHEIV99,
  7327           ERENDT-KEY,
  7328           DFHEIV99,
  7329           DFHEIV11,
  7330           DFHEIV99,
  7331           DFHEIV99
  7332     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7333         DFHEIV20
  7334     MOVE EIBRESP  TO WS-RESPONSE
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7336     IF NOT RESP-NORMAL
  7337        MOVE ER-2237             TO EMI-ERROR
  7338        PERFORM 9900-ERROR-FORMAT
  7339                                 THRU 9900-EXIT
  7340        MOVE -1                  TO CARRL
  7341        GO TO 8200-SEND-DATAONLY
  7342     END-IF
  7343     .
  7344 0510-EXIT.
  7345     EXIT.
  7346 0520-ERENDT-STARTBR.
  7347
  7348* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 129
* EL6316.cbl
  7349*       DATASET    (WS-ERENDT-FILE-ID)
  7350*       RIDFLD     (ERENDT-KEY)
  7351*       RESP       (WS-RESPONSE)
  7352*    END-EXEC
  7353     MOVE 0
  7354       TO DFHEIV11
  7355*    MOVE '&,         G          &  N#00006811' TO DFHEIV0
  7356     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7357     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7358     MOVE X'204E233030303036383131' TO DFHEIV0(25:11)
  7359     CALL 'kxdfhei1' USING DFHEIV0,
  7360           WS-ERENDT-FILE-ID,
  7361           ERENDT-KEY,
  7362           DFHEIV99,
  7363           DFHEIV11,
  7364           DFHEIV99
  7365     MOVE EIBRESP  TO WS-RESPONSE
  7366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7367     IF NOT RESP-NORMAL
  7368        MOVE ER-2237             TO EMI-ERROR
  7369        PERFORM 9900-ERROR-FORMAT
  7370                                 THRU 9900-EXIT
  7371        MOVE -1                  TO CARRL
  7372        GO TO 8200-SEND-DATAONLY
  7373     END-IF
  7374     .
  7375 0520-EXIT.
  7376     EXIT.
  7377 0530-ERENDT-READPREV.
  7378
  7379* EXEC CICS READPREV
  7380*       DATASET    (WS-ERENDT-FILE-ID)
  7381*       RIDFLD     (ERENDT-KEY)
  7382*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7383*       RESP       (WS-RESPONSE)
  7384*    END-EXEC
  7385     MOVE 0
  7386       TO DFHEIV11
  7387*    MOVE '&0S                   )  N#00006827' TO DFHEIV0
  7388     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7389     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7390     MOVE X'204E233030303036383237' TO DFHEIV0(25:11)
  7391     CALL 'kxdfhei1' USING DFHEIV0,
  7392           WS-ERENDT-FILE-ID,
  7393           DFHEIV20,
  7394           DFHEIV99,
  7395           ERENDT-KEY,
  7396           DFHEIV99,
  7397           DFHEIV11,
  7398           DFHEIV99,
  7399           DFHEIV99
  7400     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7401         DFHEIV20
  7402     MOVE EIBRESP  TO WS-RESPONSE
  7403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7404     IF NOT RESP-NORMAL
  7405        MOVE ER-2238             TO EMI-ERROR
  7406        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 130
* EL6316.cbl
  7407                                 THRU 9900-EXIT
  7408        MOVE -1                  TO CARRL
  7409        GO TO 8200-SEND-DATAONLY
  7410     END-IF
  7411     .
  7412 0530-EXIT.
  7413     EXIT.
  7414 0600-CREATE-TEMP-STORAGE.
  7415
  7416* EXEC CICS WRITEQ TS
  7417*        QUEUE (QID)
  7418*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7419*        LENGTH(PI-COMM-LENGTH)
  7420*    END-EXEC
  7421*    MOVE '*"                    ''   #00006844' TO DFHEIV0
  7422     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7423     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7424     MOVE X'2020233030303036383434' TO DFHEIV0(25:11)
  7425     CALL 'kxdfhei1' USING DFHEIV0,
  7426           QID,
  7427           PROGRAM-INTERFACE-BLOCK,
  7428           PI-COMM-LENGTH,
  7429           DFHEIV99,
  7430           DFHEIV99,
  7431           DFHEIV99
  7432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7433     display ' about to write map ' el631ii
  7434
  7435* EXEC CICS WRITEQ TS
  7436*        QUEUE (QID)
  7437*        FROM  (EL631II)
  7438*        LENGTH(MAP-LENGTH)
  7439*    END-EXEC.
  7440*    MOVE '*"                    ''   #00006850' TO DFHEIV0
  7441     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7443     MOVE X'2020233030303036383530' TO DFHEIV0(25:11)
  7444     CALL 'kxdfhei1' USING DFHEIV0,
  7445           QID,
  7446           EL631II,
  7447           MAP-LENGTH,
  7448           DFHEIV99,
  7449           DFHEIV99,
  7450           DFHEIV99
  7451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7452
  7453 0600-EXIT.
  7454      EXIT.
  7455 0610-RECOVER-TEMP-STORAGE.
  7456
  7457* EXEC CICS READQ TS
  7458*        QUEUE (QID)
  7459*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7460*        LENGTH(PI-COMM-LENGTH)
  7461*    END-EXEC
  7462*    MOVE '*$I    L              ''   #00006858' TO DFHEIV0
  7463     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7464     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 131
* EL6316.cbl
  7465     MOVE X'2020233030303036383538' TO DFHEIV0(25:11)
  7466     CALL 'kxdfhei1' USING DFHEIV0,
  7467           QID,
  7468           PROGRAM-INTERFACE-BLOCK,
  7469           PI-COMM-LENGTH,
  7470           DFHEIV99,
  7471           DFHEIV99,
  7472           DFHEIV99
  7473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7474
  7475* EXEC CICS READQ TS
  7476*        QUEUE (QID)
  7477*        INTO  (EL631II)
  7478*        LENGTH(MAP-LENGTH)
  7479*    END-EXEC
  7480*    MOVE '*$I    L              ''   #00006863' TO DFHEIV0
  7481     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7482     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7483     MOVE X'2020233030303036383633' TO DFHEIV0(25:11)
  7484     CALL 'kxdfhei1' USING DFHEIV0,
  7485           QID,
  7486           EL631II,
  7487           MAP-LENGTH,
  7488           DFHEIV99,
  7489           DFHEIV99,
  7490           DFHEIV99
  7491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7492     display ' map ' EL631II
  7493     PERFORM 0620-DELETE-TS THRU 0620-EXIT
  7494     MOVE AL-UANON            TO LTRIDA
  7495     IF WS-SET-CODES-MDT = 'Y'
  7496        move +1                  to s2
  7497        perform varying s1 from +1 by +5 until s1 > +60
  7498           MOVE WS-PASSED-REASON-CODES (s1:4)
  7499                                 TO reacd-in (s2)
  7500           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7501               MOVE AL-SANON     TO REACDA (S2)
  7502               MOVE +4           TO REACDL (S2)
  7503           END-IF
  7504           add +1                to s2
  7505        end-perform
  7506        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7507     END-IF
  7508
  7509     IF CRTNT1I > SPACES
  7510         MOVE AL-UANON       TO CRTNT1A
  7511     END-IF
  7512
  7513     IF CRTNT2I > SPACES
  7514         MOVE AL-UANON       TO CRTNT2A
  7515     END-IF
  7516
  7517     IF BILNT1I > SPACES
  7518         MOVE AL-UANON       TO BILNT1A
  7519     END-IF
  7520     .
  7521 0610-EXIT.
  7522      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 132
* EL6316.cbl
  7523 0620-DELETE-TS.
  7524
  7525* EXEC CICS DELETEQ TS
  7526*        QUEUE(QID)
  7527*    END-EXEC
  7528*    MOVE '*&                    #   #00006900' TO DFHEIV0
  7529     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7530     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7531     MOVE X'2020233030303036393030' TO DFHEIV0(25:11)
  7532     CALL 'kxdfhei1' USING DFHEIV0,
  7533           QID,
  7534           DFHEIV99
  7535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7536     .
  7537 0620-EXIT.
  7538      EXIT.
  7539 1000-FINALIZE.
  7540     PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  7541     IF NOT EMI-NO-ERRORS
  7542      AND EIBAID = DFHPF4
  7543        GO TO 8200-SEND-DATAONLY
  7544     END-IF
  7545     display ' made it to 1000 '
  7546     set P to address of KIXSYS
  7547     CALL "getenv" using by value P returning var-ptr
  7548     if var-ptr = null then
  7549        display ' kixsys not set '
  7550     else
  7551        set address of var to var-ptr
  7552        move 0 to env-var-len
  7553        inspect var tallying env-var-len
  7554          for characters before X'00'
  7555*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  7556        unstring var (1:env-var-len) delimited by '/'
  7557           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  7558              WS-KIX-SYS
  7559        end-unstring
  7560*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  7561*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  7562     end-if
  7563     set P to address of KIXHOST
  7564     CALL "getenv" using by value P returning var-ptr
  7565     if var-ptr = null then
  7566        display ' kixhost not set '
  7567     else
  7568        set address of var to var-ptr
  7569        move 0 to env-var-len
  7570        inspect var tallying env-var-len
  7571          for characters before X'00'
  7572*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  7573        MOVE var(1:env-var-len)  to ws-kixhost
  7574        DISPLAY ' WS KIX HOST ' WS-KIXhost
  7575     end-if
  7576     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  7577     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  7578     IF RESP-NORMAL
  7579        AND (PI-ELCRTO-KEY (1:33) =
  7580              OC-CONTROL-PRIMARY (1:33))
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 133
* EL6316.cbl
  7581           DISPLAY ' RESP NORMAL AND = '
  7582           MOVE OC-ORIG-REC         TO NEW-ORIG-REC
  7583           PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  7584           PERFORM 1100-CALL-NS-BUS-LOGIC
  7585                                    THRU 1100-EXIT
  7586           IF BL-OK
  7587              CONTINUE
  7588           ELSE
  7589              MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  7590              MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  7591              MOVE -1               TO CARRL
  7592           END-IF
  7593     ELSE
  7594        MOVE ER-3829             TO EMI-ERROR
  7595        PERFORM 9900-ERROR-FORMAT
  7596                                 THRU 9900-EXIT
  7597        MOVE -1                  TO CARRL
  7598        GO TO 8100-SEND-INITIAL-MAP
  7599     END-IF
  7600     PERFORM 0390-BUILD-FROM-ERENDT THRU 0390-EXIT
  7601     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  7602                                 TO SYSO
  7603     MOVE WS-KIXHOST             TO HOSTO
  7604     MOVE PI-COMPANY-ID          TO COMPANYO
  7605     MOVE PI-PROCESSOR-ID        TO PROCIDO
  7606     MOVE '4'                    TO DATASORO
  7607     MOVE BL-BATCH-NO            TO BATCHNOO
  7608     MOVE BL-BATCH-SEQ           TO BSEQNOO
  7609     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  7610*    MOVE -1                     TO PRTSWL
  7611*    MOVE AL-UANON               TO PRTSWA
  7612     IF EIBAID = DFHPF4
  7613        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  7614        MOVE ER-0280             TO EMI-ERROR
  7615        PERFORM 9900-ERROR-FORMAT
  7616                                 THRU 9900-EXIT
  7617        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  7618        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7619        MOVE 'Y'                 TO PI-FINALIZED-IND
  7620        GO TO 9400-CLEAR
  7621     ELSE
  7622        MOVE ER-1818             TO EMI-ERROR
  7623        PERFORM 9900-ERROR-FORMAT
  7624                                 THRU 9900-EXIT
  7625     END-IF
  7626     GO TO 8100-SEND-INITIAL-MAP
  7627     .
  7628 1000-EXIT.
  7629     EXIT.
  7630 1100-CALL-NS-BUS-LOGIC.
  7631     DISPLAY ' MADE IT TO 1100 ' w-arch-number
  7632     MOVE SPACES                 TO BL-INPUT
  7633     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7634     MOVE '4'                    TO BL-DATA-SRCE
  7635     MOVE PB-CARRIER             TO BL-CARRIER
  7636     MOVE PB-GROUPING            TO BL-GROUP
  7637     MOVE PB-STATE               TO BL-STATE
  7638     MOVE PB-ACCOUNT             TO BL-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 134
* EL6316.cbl
  7639     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7640        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7641        MOVE ' '                 TO DC-OPTION-CODE
  7642        PERFORM 9700-date-link
  7643        IF NO-CONVERSION-ERROR
  7644           MOVE DC-GREG-DATE-B-EDIT
  7645                                 TO BL-EFF-DT
  7646        END-IF
  7647     END-IF
  7648     MOVE PB-CERT-NO             TO BL-CERT-NO
  7649     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7650     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7651     MOVE SPACES                 TO BL-RESP-NO
  7652     MOVE LTRIDI                 TO BL-LETTER-ID
  7653     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7654     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7655*    MOVE 'ALWA'                 TO BL-PROC-ID
  7656     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7657     IF EIBAID = DFHPF4
  7658        MOVE 'B'                 TO BL-WRITE-ERARCH
  7659     ELSE
  7660        MOVE 'T'                 TO BL-WRITE-ERARCH
  7661     END-IF
  7662     MOVE SPACES                 TO BL-CERT-FORM-ID
  7663     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7664     MOVE 'CAN ENDT'             TO BL-SOURCE-SCREEN
  7665     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7666        IF REACD-IN (S1) NOT = LOW-VALUES
  7667           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7668        END-IF
  7669     END-PERFORM
  7670    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7671     DISPLAY ' BL INPUT ' BL-INPUT
  7672*****************************************
  7673* Invoke the LETTER business logic
  7674*****************************************
  7675     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  7676     display ' srch commarea ' srch-commarea
  7677     display ' length ' ws-comm-length
  7678
  7679* exec cics link
  7680*       program('NSRASBL')
  7681*       commarea(srch-commarea)
  7682*       LENGTH  (WS-COMM-LENGTH)
  7683*    end-exec.
  7684     MOVE 'NSRASBL' TO DFHEIV1
  7685*    MOVE '."C                   (   #00007045' TO DFHEIV0
  7686     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7688     MOVE X'2020233030303037303435' TO DFHEIV0(25:11)
  7689     CALL 'kxdfhei1' USING DFHEIV0,
  7690           DFHEIV1,
  7691           srch-commarea,
  7692           WS-COMM-LENGTH,
  7693           DFHEIV99,
  7694           DFHEIV99,
  7695           DFHEIV99,
  7696           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 135
* EL6316.cbl
  7697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7698
  7699     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7700        BL-MESSAGE
  7701     .
  7702 1100-EXIT.
  7703     EXIT.
  7704 1500-GET-ARCH-NO.
  7705     display ' made it to 1500 '
  7706     MOVE SPACES                 TO ELCNTL-KEY
  7707     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7708     MOVE '1'                    TO CNTL-REC-TYPE
  7709     MOVE ZEROS                  TO CNTL-SEQ
  7710
  7711* EXEC CICS READ
  7712*         DATASET    (WS-ELCNTL-FILE-ID)
  7713*         SET        (ADDRESS OF CONTROL-FILE)
  7714*         RIDFLD     (ELCNTL-KEY)
  7715*         UPDATE
  7716*         RESP       (WS-RESPONSE)
  7717*    END-EXEC
  7718*    MOVE '&"S        EU         (  N#00007061' TO DFHEIV0
  7719     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7720     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7721     MOVE X'204E233030303037303631' TO DFHEIV0(25:11)
  7722     CALL 'kxdfhei1' USING DFHEIV0,
  7723           WS-ELCNTL-FILE-ID,
  7724           DFHEIV20,
  7725           DFHEIV99,
  7726           ELCNTL-KEY,
  7727           DFHEIV99,
  7728           DFHEIV99,
  7729           DFHEIV99
  7730     SET ADDRESS OF CONTROL-FILE TO
  7731         DFHEIV20
  7732     MOVE EIBRESP  TO WS-RESPONSE
  7733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7734     IF RESP-NORMAL
  7735        display ' good read elcntl '
  7736        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7737           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7738        END-IF
  7739        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7740        MOVE CF-CREDIT-LAST-ARCH-NUM
  7741                                 TO W-ARCH-NUMBER
  7742        display ' new arch number ' w-arch-number
  7743
  7744* EXEC CICS REWRITE
  7745*          FROM      (CONTROL-FILE)
  7746*          DATASET   (WS-ELCNTL-FILE-ID)
  7747*       END-EXEC
  7748     MOVE LENGTH OF
  7749      CONTROL-FILE
  7750       TO DFHEIV11
  7751*    MOVE '&& L                  %   #00007077' TO DFHEIV0
  7752     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7753     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7754     MOVE X'2020233030303037303737' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 136
* EL6316.cbl
  7755     CALL 'kxdfhei1' USING DFHEIV0,
  7756           WS-ELCNTL-FILE-ID,
  7757           CONTROL-FILE,
  7758           DFHEIV11,
  7759           DFHEIV99
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7761     END-IF
  7762     .
  7763 1500-EXIT.
  7764     EXIT.
  7765
  7766
  7767 1700-WRITE-CERT-NOTE      SECTION.
  7768
  7769     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7770     MOVE ZERO           TO ERCNOT-SEQ.
  7771     SET TB-INDX         DOWN BY 1.
  7772     SET TB-INDX1        TO TB-INDX.
  7773
  7774****DELETE CURRENT CERT NOTES
  7775 1700-LOOP.
  7776
  7777* EXEC CICS READ
  7778*        DATASET (WS-ERCNOT-FILE-ID)
  7779*        RIDFLD  (ERCNOT-KEY)
  7780*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7781*        RESP    (WS-RESPONSE)
  7782*        GTEQ
  7783*    END-EXEC.
  7784*    MOVE '&"S        G          (  N#00007096' TO DFHEIV0
  7785     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7787     MOVE X'204E233030303037303936' TO DFHEIV0(25:11)
  7788     CALL 'kxdfhei1' USING DFHEIV0,
  7789           WS-ERCNOT-FILE-ID,
  7790           DFHEIV20,
  7791           DFHEIV99,
  7792           ERCNOT-KEY,
  7793           DFHEIV99,
  7794           DFHEIV99,
  7795           DFHEIV99
  7796     SET ADDRESS OF CERT-NOTE-FILE TO
  7797         DFHEIV20
  7798     MOVE EIBRESP  TO WS-RESPONSE
  7799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7800
  7801
  7802     IF NOT RESP-NORMAL
  7803        GO TO 1700-ENDDEL
  7804     END-IF
  7805
  7806     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7807
  7808     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7809         GO TO 1700-ENDDEL
  7810     END-IF.
  7811
  7812
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 137
* EL6316.cbl
  7813* EXEC CICS DELETE
  7814*        DATASET (WS-ERCNOT-FILE-ID)
  7815*        RIDFLD  (ERCNOT-KEY)
  7816*    END-EXEC.
  7817*    MOVE '&(  R                 &   #00007114' TO DFHEIV0
  7818     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7819     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7820     MOVE X'2020233030303037313134' TO DFHEIV0(25:11)
  7821     CALL 'kxdfhei1' USING DFHEIV0,
  7822           WS-ERCNOT-FILE-ID,
  7823           ERCNOT-KEY,
  7824           DFHEIV99,
  7825           DFHEIV99,
  7826           DFHEIV99
  7827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7828
  7829
  7830     GO TO 1700-LOOP.
  7831
  7832 1700-ENDDEL.
  7833
  7834
  7835* EXEC CICS GETMAIN
  7836*         LENGTH(ERCNOT-LENGTH)
  7837*         SET(ADDRESS OF CERT-NOTE-FILE)
  7838*         INITIMG(GETMAIN-SPACE)
  7839*    END-EXEC.
  7840*    MOVE ',"IL                  $   #00007123' TO DFHEIV0
  7841     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7842     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7843     MOVE X'2020233030303037313233' TO DFHEIV0(25:11)
  7844     CALL 'kxdfhei1' USING DFHEIV0,
  7845           DFHEIV20,
  7846           ERCNOT-LENGTH,
  7847           GETMAIN-SPACE
  7848     SET ADDRESS OF CERT-NOTE-FILE TO
  7849         DFHEIV20
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7851
  7852
  7853     SET TB-INDX TO 1.
  7854     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7855     MOVE +0             TO ERCNOT-SEQ
  7856
  7857     PERFORM VARYING TB-INDX FROM 1 BY 1
  7858             UNTIL TB-INDX > TB-INDX1
  7859        MOVE SPACES                 TO  CERT-NOTE-FILE
  7860        ADD 1                       TO  ERCNOT-SEQ
  7861        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7862        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7863        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7864        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7865                                    TO  CZ-LAST-MAINT-USER
  7866        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7867                                    TO  CZ-LAST-MAINT-HHMMSS
  7868        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7869                                    TO  CZ-LAST-MAINT-DT
  7870
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 138
* EL6316.cbl
  7871
  7872* EXEC CICS WRITE
  7873*            DATASET(WS-ERCNOT-FILE-ID)
  7874*            FROM(CERT-NOTE-FILE)
  7875*            RIDFLD(ERCNOT-KEY)
  7876*       END-EXEC
  7877     MOVE LENGTH OF
  7878      CERT-NOTE-FILE
  7879       TO DFHEIV11
  7880*    MOVE '&$ L                  ''   #00007147' TO DFHEIV0
  7881     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7882     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7883     MOVE X'2020233030303037313437' TO DFHEIV0(25:11)
  7884     CALL 'kxdfhei1' USING DFHEIV0,
  7885           WS-ERCNOT-FILE-ID,
  7886           CERT-NOTE-FILE,
  7887           DFHEIV11,
  7888           ERCNOT-KEY,
  7889           DFHEIV99,
  7890           DFHEIV99
  7891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7892     END-PERFORM
  7893
  7894     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7895     IF RESP-NORMAL
  7896        EVALUATE CM-NOTE-SW
  7897           WHEN '1'
  7898           WHEN '3'
  7899           WHEN '5'
  7900           WHEN '7'
  7901              SET NO-CERT-RW     TO TRUE
  7902           WHEN ' '
  7903              MOVE '1'           TO CM-NOTE-SW
  7904           WHEN '2'
  7905              MOVE '3'           TO CM-NOTE-SW
  7906           WHEN '4'
  7907              MOVE '5'           TO CM-NOTE-SW
  7908           WHEN '6'
  7909              MOVE '7'           TO CM-NOTE-SW
  7910        END-EVALUATE
  7911     END-IF
  7912     IF NOT NO-CERT-RW
  7913        PERFORM 1810-REWRITE-ELCERT
  7914                                 THRU 1810-EXIT
  7915     ELSE
  7916
  7917* EXEC CICS UNLOCK
  7918*          DATASET    (WS-ELCERT-FILE-ID)
  7919*       END-EXEC
  7920*    MOVE '&*                    #   #00007176' TO DFHEIV0
  7921     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7922     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7923     MOVE X'2020233030303037313736' TO DFHEIV0(25:11)
  7924     CALL 'kxdfhei1' USING DFHEIV0,
  7925           WS-ELCERT-FILE-ID,
  7926           DFHEIV99
  7927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7928     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 139
* EL6316.cbl
  7929
  7930     .
  7931 1799-EXIT.
  7932     EXIT.
  7933
  7934 1800-READ-ELCERT-UPDATE.
  7935
  7936     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7937     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7938     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7939     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7940     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7941     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7942     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7943     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7944
  7945
  7946* EXEC CICS READ
  7947*        UPDATE
  7948*        DATASET  (WS-ELCERT-FILE-ID)
  7949*        RIDFLD   (WS-ELCERT-KEY)
  7950*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7951*        RESP     (WS-RESPONSE)
  7952*    END-EXEC
  7953*    MOVE '&"S        EU         (  N#00007196' TO DFHEIV0
  7954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7956     MOVE X'204E233030303037313936' TO DFHEIV0(25:11)
  7957     CALL 'kxdfhei1' USING DFHEIV0,
  7958           WS-ELCERT-FILE-ID,
  7959           DFHEIV20,
  7960           DFHEIV99,
  7961           WS-ELCERT-KEY,
  7962           DFHEIV99,
  7963           DFHEIV99,
  7964           DFHEIV99
  7965     SET ADDRESS OF CERTIFICATE-MASTER TO
  7966         DFHEIV20
  7967     MOVE EIBRESP  TO WS-RESPONSE
  7968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7969
  7970     .
  7971 1800-EXIT.
  7972     EXIT.
  7973
  7974 1810-REWRITE-ELCERT.
  7975
  7976
  7977* EXEC CICS REWRITE
  7978*        FROM     (CERTIFICATE-MASTER)
  7979*        DATASET  (WS-ELCERT-FILE-ID)
  7980*        RESP     (WS-RESPONSE)
  7981*    END-EXEC.
  7982     MOVE LENGTH OF
  7983      CERTIFICATE-MASTER
  7984       TO DFHEIV11
  7985*    MOVE '&& L                  %  N#00007210' TO DFHEIV0
  7986     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 140
* EL6316.cbl
  7987     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7988     MOVE X'204E233030303037323130' TO DFHEIV0(25:11)
  7989     CALL 'kxdfhei1' USING DFHEIV0,
  7990           WS-ELCERT-FILE-ID,
  7991           CERTIFICATE-MASTER,
  7992           DFHEIV11,
  7993           DFHEIV99
  7994     MOVE EIBRESP  TO WS-RESPONSE
  7995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7996
  7997
  7998     .
  7999 1810-EXIT.
  8000     EXIT.
  8001
  8002 8100-SEND-INITIAL-MAP.
  8003     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8004     MOVE '5'                    TO DC-OPTION-CODE.
  8005     PERFORM 9700-DATE-LINK.
  8006     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8007     MOVE EIBTIME                TO TIME-IN.
  8008     MOVE TIME-OUT               TO TIMEO.
  8009     MOVE -1                     TO LTRIDL
  8010*    MOVE AL-UANON               TO PRTSWA
  8011     IF PI-PROCESSOR-IS-CSR-SUPER
  8012        perform varying s1 from +1 by +1 until
  8013           s1 > +12
  8014           MOVE AL-UANON            TO reacda (s1)
  8015        end-perform
  8016     END-IF
  8017     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  8018
  8019* EXEC CICS SEND
  8020*        MAP      (MAP-NAME)
  8021*        MAPSET   (MAPSET-NAME)
  8022*        FROM     (EL631IO)
  8023*        ERASE
  8024*        CURSOR
  8025*    END-EXEC.
  8026     MOVE LENGTH OF
  8027      EL631IO
  8028       TO DFHEIV12
  8029     MOVE -1
  8030       TO DFHEIV11
  8031*    MOVE '8$     CT  E    H L F ,   #00007236' TO DFHEIV0
  8032     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8033     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8034     MOVE X'2020233030303037323336' TO DFHEIV0(25:11)
  8035     CALL 'kxdfhei1' USING DFHEIV0,
  8036           MAP-NAME,
  8037           EL631IO,
  8038           DFHEIV12,
  8039           MAPSET-NAME,
  8040           DFHEIV99,
  8041           DFHEIV99,
  8042           DFHEIV99,
  8043           DFHEIV11,
  8044           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 141
* EL6316.cbl
  8045           DFHEIV99,
  8046           DFHEIV99
  8047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8048
  8049     GO TO 9100-RETURN-TRAN.
  8050 8200-SEND-DATAONLY.
  8051     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8052     MOVE '5'                    TO DC-OPTION-CODE.
  8053     PERFORM 9700-DATE-LINK.
  8054     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8055     MOVE EIBTIME                TO TIME-IN.
  8056     MOVE TIME-OUT               TO TIMEO.
  8057     MOVE -1                     TO PFENTRL
  8058     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  8059
  8060* EXEC CICS SEND
  8061*        MAP      (MAP-NAME)
  8062*        MAPSET   (MAPSET-NAME)
  8063*        FROM     (EL631IO)
  8064*        DATAONLY
  8065*        ERASEAUP
  8066*        CURSOR
  8067*    END-EXEC.
  8068     MOVE LENGTH OF
  8069      EL631IO
  8070       TO DFHEIV12
  8071     MOVE -1
  8072       TO DFHEIV11
  8073*    MOVE '8$D    CT  A    H L F ,   #00007253' TO DFHEIV0
  8074     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8075     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8076     MOVE X'2020233030303037323533' TO DFHEIV0(25:11)
  8077     CALL 'kxdfhei1' USING DFHEIV0,
  8078           MAP-NAME,
  8079           EL631IO,
  8080           DFHEIV12,
  8081           MAPSET-NAME,
  8082           DFHEIV99,
  8083           DFHEIV99,
  8084           DFHEIV99,
  8085           DFHEIV11,
  8086           DFHEIV99,
  8087           DFHEIV99,
  8088           DFHEIV99
  8089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8090
  8091     GO TO 9100-RETURN-TRAN.
  8092 8300-SEND-TEXT.
  8093
  8094* EXEC CICS SEND TEXT
  8095*        FROM     (LOGOFF-TEXT)
  8096*        LENGTH   (LOGOFF-LENGTH)
  8097*        ERASE
  8098*        FREEKB
  8099*    END-EXEC.
  8100*    MOVE '8&      T  E F  H   F -   #00007263' TO DFHEIV0
  8101     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8102     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 142
* EL6316.cbl
  8103     MOVE X'2020233030303037323633' TO DFHEIV0(25:11)
  8104     CALL 'kxdfhei1' USING DFHEIV0,
  8105           LOGOFF-TEXT,
  8106           LOGOFF-LENGTH,
  8107           DFHEIV99,
  8108           DFHEIV99,
  8109           DFHEIV99,
  8110           DFHEIV99,
  8111           DFHEIV99,
  8112           DFHEIV99,
  8113           DFHEIV99,
  8114           DFHEIV99,
  8115           DFHEIV99,
  8116           DFHEIV99
  8117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8118
  8119
  8120* EXEC CICS RETURN
  8121*    END-EXEC.
  8122*    MOVE '.(                    ''   #00007269' TO DFHEIV0
  8123     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8124     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8125     MOVE X'2020233030303037323639' TO DFHEIV0(25:11)
  8126     CALL 'kxdfhei1' USING DFHEIV0,
  8127           DFHEIV99,
  8128           DFHEIV99,
  8129           DFHEIV99,
  8130           DFHEIV99,
  8131           DFHEIV99,
  8132           DFHEIV99
  8133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8134
  8135 8800-UNAUTHORIZED-ACCESS.
  8136     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8137     GO TO 8300-SEND-TEXT.
  8138 8810-PF23.
  8139     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8140     MOVE XCTL-005               TO PGM-NAME.
  8141     GO TO 9300-XCTL.
  8142 9000-RETURN-CICS.
  8143
  8144* EXEC CICS RETURN
  8145*    END-EXEC.
  8146*    MOVE '.(                    ''   #00007279' TO DFHEIV0
  8147     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8148     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8149     MOVE X'2020233030303037323739' TO DFHEIV0(25:11)
  8150     CALL 'kxdfhei1' USING DFHEIV0,
  8151           DFHEIV99,
  8152           DFHEIV99,
  8153           DFHEIV99,
  8154           DFHEIV99,
  8155           DFHEIV99,
  8156           DFHEIV99
  8157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8158
  8159 9100-RETURN-TRAN.
  8160     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 143
* EL6316.cbl
  8161     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8162
  8163* EXEC CICS RETURN
  8164*        TRANSID    (TRANS-ID)
  8165*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8166*        LENGTH     (1300)
  8167*    END-EXEC.
  8168     MOVE 1300
  8169       TO DFHEIV11
  8170*    MOVE '.(CT                  ''   #00007284' TO DFHEIV0
  8171     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8172     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8173     MOVE X'2020233030303037323834' TO DFHEIV0(25:11)
  8174     CALL 'kxdfhei1' USING DFHEIV0,
  8175           TRANS-ID,
  8176           PROGRAM-INTERFACE-BLOCK,
  8177           DFHEIV11,
  8178           DFHEIV99,
  8179           DFHEIV99,
  8180           DFHEIV99
  8181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8182
  8183 9200-RETURN-MAIN-MENU.
  8184     MOVE XCTL-626               TO PGM-NAME.
  8185     GO TO 9300-XCTL.
  8186 9300-XCTL.
  8187
  8188* EXEC CICS XCTL
  8189*        PROGRAM    (PGM-NAME)
  8190*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8191*        LENGTH     (1300)
  8192*    END-EXEC.
  8193     MOVE 1300
  8194       TO DFHEIV11
  8195*    MOVE '.$C                   %   #00007293' TO DFHEIV0
  8196     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8197     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8198     MOVE X'2020233030303037323933' TO DFHEIV0(25:11)
  8199     CALL 'kxdfhei1' USING DFHEIV0,
  8200           PGM-NAME,
  8201           PROGRAM-INTERFACE-BLOCK,
  8202           DFHEIV11,
  8203           DFHEIV99
  8204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8205
  8206 9400-CLEAR.
  8207     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8208
  8209* EXEC CICS XCTL
  8210*        PROGRAM    (PGM-NAME)
  8211*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8212*        LENGTH     (1300)
  8213*    END-EXEC.
  8214     MOVE 1300
  8215       TO DFHEIV11
  8216*    MOVE '.$C                   %   #00007300' TO DFHEIV0
  8217     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8218     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 144
* EL6316.cbl
  8219     MOVE X'2020233030303037333030' TO DFHEIV0(25:11)
  8220     CALL 'kxdfhei1' USING DFHEIV0,
  8221           PGM-NAME,
  8222           PROGRAM-INTERFACE-BLOCK,
  8223           DFHEIV11,
  8224           DFHEIV99
  8225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8226
  8227 9500-PF12.
  8228     MOVE XCTL-010               TO PGM-NAME.
  8229     GO TO 9300-XCTL.
  8230 9600-PGMID-ERROR.
  8231
  8232* EXEC CICS HANDLE CONDITION
  8233*        PGMIDERR    (8300-SEND-TEXT)
  8234*    END-EXEC.
  8235*    MOVE '"$L                   ! " #00007309' TO DFHEIV0
  8236     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8238     MOVE X'2220233030303037333039' TO DFHEIV0(25:11)
  8239     CALL 'kxdfhei1' USING DFHEIV0
  8240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8241
  8242     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8243     MOVE ' '                    TO PI-ENTRY-CD-1.
  8244     MOVE XCTL-005               TO PGM-NAME.
  8245     MOVE PGM-NAME               TO LOGOFF-PGM.
  8246     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8247     GO TO 9300-XCTL.
  8248 9700-DATE-LINK.
  8249     MOVE LINK-ELDATCV           TO PGM-NAME.
  8250
  8251* EXEC CICS LINK
  8252*        PROGRAM    (PGM-NAME)
  8253*        COMMAREA   (DATE-CONVERSION-DATA)
  8254*        LENGTH     (DC-COMM-LENGTH)
  8255*    END-EXEC.
  8256*    MOVE '."C                   (   #00007320' TO DFHEIV0
  8257     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8259     MOVE X'2020233030303037333230' TO DFHEIV0(25:11)
  8260     CALL 'kxdfhei1' USING DFHEIV0,
  8261           PGM-NAME,
  8262           DATE-CONVERSION-DATA,
  8263           DC-COMM-LENGTH,
  8264           DFHEIV99,
  8265           DFHEIV99,
  8266           DFHEIV99,
  8267           DFHEIV99
  8268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8269
  8270 9900-ERROR-FORMAT.
  8271     IF NOT EMI-ERRORS-COMPLETE
  8272        MOVE LINK-001            TO PGM-NAME
  8273
  8274* EXEC CICS LINK
  8275*           PROGRAM    (PGM-NAME)
  8276*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 145
* EL6316.cbl
  8277*           LENGTH     (EMI-COMM-LENGTH)
  8278*       END-EXEC
  8279*    MOVE '."C                   (   #00007328' TO DFHEIV0
  8280     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8282     MOVE X'2020233030303037333238' TO DFHEIV0(25:11)
  8283     CALL 'kxdfhei1' USING DFHEIV0,
  8284           PGM-NAME,
  8285           ERROR-MESSAGE-INTERFACE-BLOCK,
  8286           EMI-COMM-LENGTH,
  8287           DFHEIV99,
  8288           DFHEIV99,
  8289           DFHEIV99,
  8290           DFHEIV99
  8291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8292     END-IF
  8293     .
  8294 9900-EXIT.
  8295     EXIT.
  8296 9990-ABEND.
  8297     MOVE LINK-004               TO PGM-NAME.
  8298     MOVE DFHEIBLK               TO EMI-LINE1.
  8299
  8300* EXEC CICS LINK
  8301*        PROGRAM   (PGM-NAME)
  8302*        COMMAREA  (EMI-LINE1)
  8303*        LENGTH    (72)
  8304*    END-EXEC.
  8305     MOVE 72
  8306       TO DFHEIV11
  8307*    MOVE '."C                   (   #00007340' TO DFHEIV0
  8308     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8309     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8310     MOVE X'2020233030303037333430' TO DFHEIV0(25:11)
  8311     CALL 'kxdfhei1' USING DFHEIV0,
  8312           PGM-NAME,
  8313           EMI-LINE1,
  8314           DFHEIV11,
  8315           DFHEIV99,
  8316           DFHEIV99,
  8317           DFHEIV99,
  8318           DFHEIV99
  8319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8320
  8321     GO TO 8200-SEND-DATAONLY.
  8322
  8323* GOBACK.
  8324     MOVE '9%                    "   ' TO DFHEIV0
  8325     MOVE 'EL6316' TO DFHEIV1
  8326     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8327     GOBACK.
  8328 9995-SECURITY-VIOLATION.
  8329*                            COPY ELCSCTP.
  8330******************************************************************
  8331*                                                                *
  8332*                            ELCSCTP                             *
  8333*                            VMOD=2.001                          *
  8334*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 146
* EL6316.cbl
  8335*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8336******************************************************************
  8337
  8338
  8339     MOVE EIBDATE          TO SM-JUL-DATE.
  8340     MOVE EIBTRMID         TO SM-TERMID.
  8341     MOVE THIS-PGM         TO SM-PGM.
  8342     MOVE EIBTIME          TO TIME-IN.
  8343     MOVE TIME-OUT         TO SM-TIME.
  8344     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8345
  8346
  8347* EXEC CICS LINK
  8348*         PROGRAM  ('EL003')
  8349*         COMMAREA (SECURITY-MESSAGE)
  8350*         LENGTH   (80)
  8351*    END-EXEC.
  8352     MOVE 'EL003' TO DFHEIV1
  8353     MOVE 80
  8354       TO DFHEIV11
  8355*    MOVE '."C                   (   #00007365' TO DFHEIV0
  8356     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8358     MOVE X'2020233030303037333635' TO DFHEIV0(25:11)
  8359     CALL 'kxdfhei1' USING DFHEIV0,
  8360           DFHEIV1,
  8361           SECURITY-MESSAGE,
  8362           DFHEIV11,
  8363           DFHEIV99,
  8364           DFHEIV99,
  8365           DFHEIV99,
  8366           DFHEIV99
  8367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8368
  8369
  8370******************************************************************
  8371
  8372 9995-EXIT.
  8373     EXIT.
  8374
  8375 9999-DFHBACK SECTION.
  8376     MOVE '9%                    "   ' TO DFHEIV0
  8377     MOVE 'EL6316' TO DFHEIV1
  8378     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8379     GOBACK.
  8380 9999-DFHEXIT.
  8381     IF DFHEIGDJ EQUAL 0001
  8382         NEXT SENTENCE
  8383     ELSE IF DFHEIGDJ EQUAL 2
  8384         GO TO 8300-SEND-TEXT
  8385         DEPENDING ON DFHEIGDI.
  8386     MOVE '9%                    "   ' TO DFHEIV0
  8387     MOVE 'EL6316' TO DFHEIV1
  8388     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8389     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 147
* EL6316.cbl
* Total Messages:     0
* Data:       34536     Code:       19286
