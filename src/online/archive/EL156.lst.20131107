* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46******************************************************************
    47
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   3
* EL156.cbl
    49 ENVIRONMENT DIVISION.
    50
    51 DATA DIVISION.
    52
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55
    56 77  FILLER  PIC X(32)  VALUE '********************************'.
    57 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    58 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    59 77  WS-SSN  PIC X(9) VALUE ZEROS.
    60 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    61 77  C0                          PIC S999 COMP-3 VALUE +0.
    62 77  C1                          PIC S999 COMP-3 VALUE +0.
    63 77  C2                          PIC S999 COMP-3 VALUE +0.
    64 77  C3                          PIC S999 COMP-3 VALUE +0.
    65 77  s1                          PIC S999 COMP-3 VALUE +0.
    66 77  s2                          pic s999 comp-3 value +0.
    67 77  P1                          PIC S999 COMP-3 VALUE +0.
    68 77  DD-IU-SW                    PIC X   VALUE ' '.
    69     88  DD-IU-PRESENT                 VALUE 'Y'.
    70 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    71 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    72 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    73 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    74 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    75 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    76 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    77 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    78 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    79
    80*    COPY ELCSCTM.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCTM                             *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-MESSAGE.
    91     12  FILLER                          PIC X(30)
    92            VALUE '** LOGIC SECURITY VIOLATION -'.
    93     12  SM-READ                         PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' PGM='.
    96     12  SM-PGM                          PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' OPR='.
    99     12  SM-PROCESSOR-ID                 PIC X(4).
   100     12  FILLER                          PIC X(6)
   101            VALUE ' TERM='.
   102     12  SM-TERMID                       PIC X(4).
   103     12  FILLER                          PIC XX   VALUE SPACE.
   104     12  SM-JUL-DATE                     PIC 9(5).
   105     12  FILLER                          PIC X    VALUE SPACE.
   106     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   4
* EL156.cbl
   107
   108
   109*    COPY ELCSCRTY.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCRTY                            *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   117*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   118*        SAVED IN PI-SECURITY-ADDRESS.                           *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-CONTROL.
   122     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   123     12  FILLER                       PIC XX    VALUE 'SC'.
   124     12  SC-CREDIT-CODES.
   125         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   126             20  SC-CREDIT-DISPLAY    PIC X.
   127             20  SC-CREDIT-UPDATE     PIC X.
   128     12  SC-CLAIMS-CODES.
   129         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   130             20  SC-CLAIMS-DISPLAY    PIC X.
   131             20  SC-CLAIMS-UPDATE     PIC X.
   132
   133 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   134 01  WS-DATE-AREA.
   135     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   136     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   137     12  SAVE-DATE-CCYYMMDD.
   138         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   139         16  SAVE-DATE-YMD.
   140             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   141             20  FILLER              PIC X(04)   VALUE SPACES.
   142
   143 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   144 01  STANDARD-AREAS.
   145     12  WS-RESPONSE         PIC S9(8)   COMP.
   146         88  WS-RESP-NORMAL              VALUE +00.
   147         88  WS-RESP-ERROR               VALUE +01.
   148         88  WS-RESP-NOTFND              VALUE +13.
   149         88  WS-RESP-DUPREC              VALUE +14.
   150         88  WS-RESP-ENDFILE             VALUE +20.
   151     12  PMT-HEAD-A.
   152         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   153         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   154         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   155-        '     RESERVES  TYPE    AMOUNT'.
   156     12  PMT-HEAD-B.
   157         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   158         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   159         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   160     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   161     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   162     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   163     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   164     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   5
* EL156.cbl
   165     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   166     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   167     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   168     12  PGM-NAME            PIC X(8).
   169     12  TIME-IN             PIC S9(7).
   170     12  TIME-OUT-R  REDEFINES TIME-IN.
   171         16  FILLER          PIC X.
   172         16  TIME-OUT        PIC 99V99.
   173         16  FILLER          PIC XX.
   174     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   175     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   176     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   177     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   178     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   179     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   180     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   181     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   182     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   183     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   184     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   185     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   186     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   187     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   188     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   189     12  WS-BLANK            PIC X       VALUE ' '.
   190
   191 01  MISC-WORK-AREAS.
   192     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   193     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   194     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   195     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   196     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   197     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   198     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   199     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   200     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   201     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   202     12  W-CALLED-NAME           PIC X(08).
   203     12  W-EOB-CODES.
   204         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   205             20  W-EOB-CODE      PIC XXX.
   206             20  W-EOB-FILLER    PIC X.
   207     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   208     12  W-NAME-LAST             PIC X(15).
   209     12  W-NAME-FIRST            PIC X(15).
   210     12  W-NAME-MIDDLE.
   211         16  FILLER              PIC X.
   212         16  W-NAME-MIDDLE-2     PIC X.
   213         16  FILLER              PIC X(13).
   214     12  W-DMD-CHECK-NO.
   215         16  W-DMD-CHECK-NO-1    PIC X(4).
   216         16  W-DMD-CHECK-NO-2    PIC X.
   217         16  W-DMD-CHECK-NO-3    PIC XX.
   218
   219     12  WS-COMPUTE-FROM-DT  PIC XX.
   220     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   221     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   222     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   6
* EL156.cbl
   223     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   224     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   225     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   226         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   227         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   228     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   229         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   230     12  WS-UPDATE-SW        PIC X VALUE ' '.
   231     12  WS-GROUPING.
   232         16  WS-GROUP-1      PIC X VALUE SPACES.
   233         16  FILLER          PIC X(05) VALUE SPACES.
   234     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   235     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   236     12  WS-WORK-STATE-ACCT.
   237         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   238         16  FILLER          PIC X       VALUE '/'.
   239         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   240     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   241     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   242     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   243     12  QID.
   244         16  QID-TERM        PIC X(4)    VALUE SPACES.
   245         16  FILLER          PIC X(4)    VALUE '156A'.
   246     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   247     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   248     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   249     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   250     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   251     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   252     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   253     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   254     12  WS-STATUS           PIC X       VALUE SPACES.
   255     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   256     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   257     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   258     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   259     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   260     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   261     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   262     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   263     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   264     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   265     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   266     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   267     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   268     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   269     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   270     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   271     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   272     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   273     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   274     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   275     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   276     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   277     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   278     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   279     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   280     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   7
* EL156.cbl
   281     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   282     12  WORK-DATE-FROM.
   283         16  WDF-MONTH       PIC 99        VALUE ZERO.
   284         16  WDF-DAY         PIC 99        VALUE ZERO.
   285         16  WDF-YEAR        PIC 99        VALUE ZERO.
   286     12  WORK-DATE-THRU.
   287         16  WDT-MONTH       PIC 99        VALUE ZERO.
   288         16  WDT-DAY         PIC 99        VALUE ZERO.
   289         16  WDT-YEAR        PIC 99        VALUE ZERO.
   290     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   291     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   292     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   293     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   294     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   295     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   296     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   297     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   298     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   299     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   300     12  WS-PY-WK REDEFINES WS-PY-WORK.
   301         16  WS-PY-NUM       PIC S9(7)V99.
   302         16  WS-PY-SIGN      PIC X.
   303     12  WS-DY-WORK          PIC S9(5).
   304     12  WS-DY-WK REDEFINES WS-DY-WORK.
   305         16  WS-DY-NUM       PIC S9(4).
   306         16  WS-DY-SIGN      PIC X.
   307     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   308         88  COMP-REC-FOUND              VALUE 'Y'.
   309     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   310         88  BENEFIT-FOUND       VALUE 'Y'.
   311         88  NO-BENEFIT-FOUND    VALUE 'N'.
   312     12  WS-TERMS.
   313         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   314         16  FILLER          PIC X       VALUE '/'.
   315         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   316         16  WST-REM-DAYS-GRP.
   317             20  WST-SLASH   PIC X       VALUE '/'.
   318             20  WST-REM-DAYS
   319                             PIC --9.
   320     12  WS-ACCESS.
   321         16  FILLER          PIC XX      VALUE SPACES.
   322         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   323     12  WS-STATE-ACCESS.
   324         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   325         16  FILLER          PIC XX      VALUE SPACES.
   326     12  WS-CARR-ACCESS.
   327         16  FILLER          PIC X(3)    VALUE SPACES.
   328         16  WS-CARR         PIC X       VALUE SPACES.
   329     12  DATE-WORK.
   330         16  FILLER          PIC XX      VALUE SPACES.
   331         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   332     12  WS-SAVE-INPUT.
   333         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   334         16  WS-PAYEE        PIC XX      VALUE SPACE.
   335         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   336         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   337         16  WS-OFFLINE      PIC X       VALUE SPACE.
   338         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   8
* EL156.cbl
   339         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   340         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   341         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   342         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   343         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   344         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   345         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   346         16  WS-ETYPE        PIC X       VALUE SPACE.
   347         16  WS-CASH         PIC X       VALUE SPACE.
   348         16  WS-GROUPED      PIC X       VALUE SPACE.
   349         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   350         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   351         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   352         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   353         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   354         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   355         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   356     12  LAST-ERROR-LINE.
   357         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   358         16  FILLER              PIC X(30)
   359             VALUE ' FATAL ERRORS ENCOUNTERED'.
   360         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   361         16  FILLER              PIC X(28)
   362             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   363     12  WS-CHECK-AREA.
   364         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   365         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   366     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   367     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   368         16  FILLER              PIC XX.
   369         16  WS-A-CHECK-NUM-5    PIC 9(5).
   370     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   371         16  FILLER              PIC X.
   372         16  WS-A-CHECK-NUM-6    PIC 9(6).
   373     12  OPTION-1-SAVE-AREA.
   374         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   375         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   376     12  WS-WORK-ZIP.
   377         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   378         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   379     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   380                                 PIC 9(9).
   381     12  WS-FLI-PMTNOTE.
   382         16  WS-PMTOPTION        PIC XX.
   383         16  WS-DOCNAME          PIC X(28).
   384         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   385             20  WS-AMOUNT       PIC X(8).
   386             20  FILLER          PIC X(20).
   387         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   388             20  WS-NUM-AMT      PIC 9(6)V99.
   389             20  FILLER          PIC X(20).
   390
   391     12  WS-HAN-PMTNOTE.
   392         16  WS-HAN-PMT-CODE     PIC X.
   393         16  WS-HAN-PMT-NOTE     PIC X(39).
   394
   395     12  WS-NCL-PMT-OPTION       PIC XX.
   396         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page   9
* EL156.cbl
   397
   398     12  WS-CLAIM-SEQUENCE.
   399         16  FILLER              PIC X VALUE '('.
   400         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   401         16  FILLER              PIC X(04) VALUE ' OF '.
   402         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   403         16  FILLER              PIC X VALUE ')'.
   404
   405     12  WS-REFUND-AMT           PIC Z(7).99.
   406     12  WS-CALC-INT             PIC S9(7)V99.
   407     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   408
   409     12  SUB                     PIC 99 VALUE ZEROS.
   410
   411     12  WS-BOANOTE1.
   412         16  WS-BOANOTE1-DESC    PIC X(11).
   413         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   414         16  FILLER              PIC X(17).
   415     12  WS-BOANOTE2.
   416         16  WS-BOANOTE2-DESC    PIC X(11).
   417         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   418         16  FILLER              PIC X(17).
   419
   420     12  WS-NCLNOTE1.
   421         16  WS-NCLNOTE1-DESC    PIC X(11).
   422         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   423         16  FILLER              PIC X(17).
   424     12  WS-NCLNOTE2.
   425         16  WS-NCLNOTE2-DESC    PIC X(11).
   426         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   427         16  FILLER              PIC X(17).
   428
   429     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   430     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   431     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   432     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   433     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   434     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   435     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   436     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   437     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   438     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   439
   440     12  WS-AIG-WORK-AREAS.
   441         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   442             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   443         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   444             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   445         16  WS-FROM-DATE-MDY.
   446             20  WS-FROM-MO      PIC 99.
   447             20  WS-FROM-DA      PIC 99.
   448             20  WS-FROM-YR      PIC 99.
   449         16  WS-TEMP-DATE-MDY.
   450             20  WS-TEMP-MO      PIC 99.
   451             20  WS-TEMP-DA      PIC 99.
   452             20  WS-TEMP-YR      PIC 99.
   453         16  WS-BIN-FROM-DT      PIC XX.
   454         16  WS-TEMP-INC-MDY.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  10
* EL156.cbl
   455             20  WS-TEMP-INC-MO  PIC 99.
   456             20  WS-TEMP-INC-DA  PIC 99.
   457             20  WS-TEMP-INC-YR  PIC 99.
   458         16  WS-PMT-DUE-MDY.
   459             20  WS-PMT-DUE-MO   PIC 99.
   460             20  WS-PMT-DUE-DA   PIC 99.
   461             20  WS-PMT-DUE-YR   PIC 99.
   462         16  WS-PMT-DUE-DT       PIC XX.
   463         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   464         16  WS-RETRO-ELIM-DT    PIC XX.
   465         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   466             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   467         16  WS-SAVE-DUE-DA      PIC 99.
   468         16  WS-CDAYS            PIC S9(05).
   469         16  WS-DAYS-OFF         PIC S9(05).
   470         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   471             88  ELIM-SATISFIED            VALUE 'Y'.
   472         16  WS-AIG-CHECKNO.
   473             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   474             20  WS-A-CHECKNO-3-7.
   475                 24  FILLER              PIC X(3)    VALUE SPACES.
   476                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   477                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   478         16  WS-AIG-GROUPING.
   479             20  WS-A-BENE               PIC XXX.
   480             20  FILLER                  PIC XXX.
   481         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   482             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   483             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   484         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   485                 VALUE 'UNEMPLOYMENT PAYMENT'.
   486         16  WS-CHK-THRU-DT              PIC XX.
   487         16  WS-HOLD-BIN-DATE-1          PIC XX.
   488
   489 01  MISC-CSO-AREA.
   490     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   491     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   492     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   493         88  APPROVAL-NEEDED                        VALUE 'Y'.
   494     12  WS-APPROV-NOTE                  PIC X(43)
   495         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   496     12  WS-REAUDIT-NOTE                 PIC X(43)
   497         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   498     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   499     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   500     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   501     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   502     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   503     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   504     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   505         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   506     12  WS-PAYEE-CITY-STATE     PIC X(30).
   507     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   508         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   509     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   510     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   511     12  WS-WORK-NAME            PIC X(30).
   512     12  FILLER  REDEFINES WS-WORK-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  11
* EL156.cbl
   513         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   514     12  WS-INSURED-NAME         PIC X(30).
   515     12  FILLER  REDEFINES WS-INSURED-NAME.
   516         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   517     12  WS-PAYEE-NAME           PIC X(30).
   518     12  FILLER  REDEFINES WS-PAYEE-NAME.
   519         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   520
   521 01  ERROR-MESSAGES.
   522     12  ER-0000                 PIC X(4)  VALUE '0000'.
   523     12  ER-0004                 PIC X(4)  VALUE '0004'.
   524     12  ER-0008                 PIC X(4)  VALUE '0008'.
   525     12  ER-0019                 PIC X(4)  VALUE '0019'.
   526     12  ER-0029                 PIC X(4)  VALUE '0029'.
   527     12  ER-0042                 PIC X(4)  VALUE '0042'.
   528     12  ER-0070                 PIC X(4)  VALUE '0070'.
   529     12  ER-0130                 PIC X(4)  VALUE '0130'.
   530     12  ER-0149                 PIC X(4)  VALUE '0149'.
   531     12  ER-0154                 PIC X(4)  VALUE '0154'.
   532     12  ER-0168                 PIC X(4)  VALUE '0168'.
   533     12  ER-0169                 PIC X(4)  VALUE '0169'.
   534     12  ER-0172                 PIC X(4)  VALUE '0174'.
   535     12  ER-0198                 PIC X(4)  VALUE '0198'.
   536     12  ER-0204                 PIC X(4)  VALUE '0204'.
   537     12  ER-0206                 PIC X(4)  VALUE '0206'.
   538     12  ER-0252                 PIC X(4)  VALUE '0252'.
   539     12  ER-0254                 PIC X(4)  VALUE '0254'.
   540     12  ER-0282                 PIC X(4)  VALUE '0282'.
   541     12  ER-0283                 PIC X(4)  VALUE '0283'.
   542     12  ER-0294                 PIC X(4)  VALUE '0294'.
   543     12  ER-0338                 PIC X(4)  VALUE '0338'.
   544     12  ER-0419                 PIC X(4)  VALUE '0419'.
   545     12  ER-0420                 PIC X(4)  VALUE '0420'.
   546     12  ER-0421                 PIC X(4)  VALUE '0421'.
   547     12  ER-0422                 PIC X(4)  VALUE '0422'.
   548     12  ER-0433                 PIC X(4)  VALUE '0433'.
   549     12  ER-0436                 PIC X(4)  VALUE '0436'.
   550     12  ER-0437                 PIC X(4)  VALUE '0437'.
   551     12  ER-0438                 PIC X(4)  VALUE '0438'.
   552     12  ER-0439                 PIC X(4)  VALUE '0439'.
   553     12  ER-0440                 PIC X(4)  VALUE '0440'.
   554     12  ER-0441                 PIC X(4)  VALUE '0441'.
   555     12  ER-0442                 PIC X(4)  VALUE '0442'.
   556     12  ER-0443                 PIC X(4)  VALUE '0443'.
   557     12  ER-0444                 PIC X(4)  VALUE '0444'.
   558     12  ER-0445                 PIC X(4)  VALUE '0445'.
   559     12  ER-0446                 PIC X(4)  VALUE '0446'.
   560     12  ER-0447                 PIC X(4)  VALUE '0447'.
   561     12  ER-0448                 PIC X(4)  VALUE '0448'.
   562     12  ER-0449                 PIC X(4)  VALUE '0449'.
   563     12  ER-0452                 PIC X(4)  VALUE '0452'.
   564     12  ER-0458                 PIC X(4)  VALUE '0458'.
   565     12  ER-0459                 PIC X(4)  VALUE '0459'.
   566     12  ER-0460                 PIC X(4)  VALUE '0460'.
   567     12  ER-0461                 PIC X(4)  VALUE '0461'.
   568     12  ER-0462                 PIC X(4)  VALUE '0462'.
   569     12  ER-0463                 PIC X(4)  VALUE '0463'.
   570     12  ER-0464                 PIC X(4)  VALUE '0464'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  12
* EL156.cbl
   571     12  ER-0465                 PIC X(4)  VALUE '0465'.
   572     12  ER-0466                 PIC X(4)  VALUE '0466'.
   573     12  ER-0467                 PIC X(4)  VALUE '0467'.
   574     12  ER-0468                 PIC X(4)  VALUE '0468'.
   575     12  ER-0469                 PIC X(4)  VALUE '0469'.
   576     12  ER-0473                 PIC X(4)  VALUE '0473'.
   577     12  ER-0474                 PIC X(4)  VALUE '0474'.
   578     12  ER-0475                 PIC X(4)  VALUE '0475'.
   579     12  ER-0476                 PIC X(4)  VALUE '0476'.
   580     12  ER-0477                 PIC X(4)  VALUE '0477'.
   581     12  ER-0478                 PIC X(4)  VALUE '0478'.
   582     12  ER-0479                 PIC X(4)  VALUE '0479'.
   583     12  ER-0481                 PIC X(4)  VALUE '0481'.
   584     12  ER-0491                 PIC X(4)  VALUE '0491'.
   585     12  ER-0492                 PIC X(4)  VALUE '0492'.
   586     12  ER-0493                 PIC X(4)  VALUE '0493'.
   587     12  ER-0494                 PIC X(4)  VALUE '0494'.
   588     12  ER-0495                 PIC X(4)  VALUE '0495'.
   589     12  ER-0499                 PIC X(4)  VALUE '0499'.
   590     12  ER-0500                 PIC X(4)  VALUE '0500'.
   591     12  ER-0501                 PIC X(4)  VALUE '0501'.
   592     12  ER-0502                 PIC X(4)  VALUE '0502'.
   593     12  ER-0508                 PIC X(4)  VALUE '0508'.
   594     12  ER-0513                 PIC X(4)  VALUE '0513'.
   595     12  ER-0518                 PIC X(4)  VALUE '0518'.
   596     12  ER-0524                 PIC X(4)  VALUE '0524'.
   597     12  ER-0525                 PIC X(4)  VALUE '0525'.
   598     12  ER-0526                 PIC X(4)  VALUE '0526'.
   599     12  ER-0530                 PIC X(4)  VALUE '0530'.
   600     12  ER-0540                 PIC X(4)  VALUE '0540'.
   601     12  ER-0541                 PIC X(4)  VALUE '0541'.
   602     12  ER-0542                 PIC X(4)  VALUE '0542'.
   603     12  ER-0543                 PIC X(4)  VALUE '0543'.
   604     12  ER-0545                 PIC X(4)  VALUE '0545'.
   605     12  ER-0552                 PIC X(4)  VALUE '0552'.
   606     12  ER-0555                 PIC X(4)  VALUE '0555'.
   607     12  ER-0556                 PIC X(4)  VALUE '0556'.
   608     12  ER-0557                 PIC X(4)  VALUE '0557'.
   609     12  ER-0572                 PIC X(4)  VALUE '0572'.
   610     12  ER-0573                 PIC X(4)  VALUE '0573'.
   611     12  ER-0594                 PIC X(4)  VALUE '0594'.
   612     12  ER-0616                 PIC X(4)  VALUE '0616'.
   613     12  ER-0617                 PIC X(4)  VALUE '0617'.
   614     12  ER-0618                 PIC X(4)  VALUE '0618'.
   615     12  ER-0657                 PIC X(4)  VALUE '0657'.
   616     12  ER-0658                 PIC X(4)  VALUE '0658'.
   617     12  ER-0699                 PIC X(4)  VALUE '0699'.
   618     12  ER-0730                 PIC X(4)  VALUE '0730'.
   619     12  ER-0737                 PIC X(4)  VALUE '0737'.
   620     12  ER-0760                 PIC X(4)  VALUE '0760'.
   621     12  ER-0768                 PIC X(4)  VALUE '0768'.
   622     12  ER-0769                 PIC X(4)  VALUE '0769'.
   623     12  ER-0770                 PIC X(4)  VALUE '0770'.
   624     12  ER-0802                 PIC X(4)  VALUE '0802'.
   625     12  ER-0803                 PIC X(4)  VALUE '0803'.
   626     12  ER-0819                 PIC X(4)  VALUE '0819'.
   627     12  ER-0834                 PIC X(4)  VALUE '0834'.
   628     12  ER-0836                 PIC X(4)  VALUE '0836'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  13
* EL156.cbl
   629     12  ER-0844                 PIC X(4)  VALUE '0844'.
   630     12  ER-0845                 PIC X(4)  VALUE '0845'.
   631     12  ER-0846                 PIC X(4)  VALUE '0846'.
   632     12  ER-0849                 PIC X(4)  VALUE '0849'.
   633     12  ER-0851                 PIC X(4)  VALUE '0851'.
   634     12  ER-0872                 PIC X(4)  VALUE '0872'.
   635     12  ER-0873                 PIC X(4)  VALUE '0873'.
   636     12  ER-0874                 PIC X(4)  VALUE '0874'.
   637     12  ER-0879                 PIC X(4)  VALUE '0879'.
   638     12  ER-0919                 PIC X(4)  VALUE '0919'.
   639     12  ER-0921                 PIC X(4)  VALUE '0921'.
   640     12  ER-0923                 PIC X(4)  VALUE '0923'.
   641     12  ER-0925                 PIC X(4)  VALUE '0925'.
   642     12  ER-0944                 PIC X(4)  VALUE '0944'.
   643     12  ER-0945                 PIC X(4)  VALUE '0945'.
   644     12  ER-0946                 PIC X(4)  VALUE '0946'.
   645     12  ER-0947                 PIC X(4)  VALUE '0947'.
   646     12  ER-0948                 PIC X(4)  VALUE '0948'.
   647     12  ER-0949                 PIC X(4)  VALUE '0949'.
   648     12  ER-0950                 PIC X(4)  VALUE '0950'.
   649     12  ER-0951                 PIC X(4)  VALUE '0951'.
   650     12  ER-0954                 PIC X(4)  VALUE '0954'.
   651     12  ER-0956                 PIC X(4)  VALUE '0956'.
   652     12  ER-0967                 PIC X(4)  VALUE '0967'.
   653     12  ER-0968                 PIC X(4)  VALUE '0968'.
   654     12  ER-0974                 PIC X(4)  VALUE '0974'.
   655     12  ER-0975                 PIC X(4)  VALUE '0975'.
   656     12  ER-1561                 PIC X(4)  VALUE '1561'.
   657     12  ER-1566                 PIC X(4)  VALUE '1566'.
   658     12  ER-1567                 PIC X(4)  VALUE '1567'.
   659     12  er-1657                 pic x(4)  value '1657'.
   660     12  er-1658                 pic x(4)  value '1658'.
   661     12  ER-1775                 PIC X(4)  VALUE '1775'.
   662     12  ER-1880                 PIC X(4)  VALUE '1880'.
   663     12  ER-2044                 PIC X(4)  VALUE '2044'.
   664     12  ER-3140                 PIC X(4)  VALUE '3140'.
   665     12  ER-3141                 PIC X(4)  VALUE '3141'.
   666     12  ER-3255                 PIC X(4)  VALUE '3255'.
   667     12  ER-3516                 PIC X(4)  VALUE '3516'.
   668     12  ER-3527                 PIC X(4)  VALUE '3527'.
   669     12  ER-3528                 PIC X(4)  VALUE '3528'.
   670     12  ER-3529                 PIC X(4)  VALUE '3529'.
   671     12  ER-3530                 PIC X(4)  VALUE '3530'.
   672     12  ER-3531                 PIC X(4)  VALUE '3531'.
   673     12  ER-3532                 PIC X(4)  VALUE '3532'.
   674     12  ER-3533                 PIC X(4)  VALUE '3533'.
   675     12  ER-3534                 PIC X(4)  VALUE '3534'.
   676     12  ER-3535                 PIC X(4)  VALUE '3535'.
   677     12  ER-3536                 PIC X(4)  VALUE '3536'.
   678     12  ER-3537                 PIC X(4)  VALUE '3537'.
   679     12  ER-3538                 PIC X(4)  VALUE '3538'.
   680     12  ER-3539                 PIC X(4)  VALUE '3539'.
   681     12  ER-3540                 PIC X(4)  VALUE '3540'.
   682     12  ER-3541                 PIC X(4)  VALUE '3541'.
   683     12  ER-3542                 PIC X(4)  VALUE '3542'.
   684     12  ER-3543                 PIC X(4)  VALUE '3543'.
   685     12  ER-3546                 PIC X(4)  VALUE '3546'.
   686     12  ER-3549                 PIC X(4)  VALUE '3549'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  14
* EL156.cbl
   687     12  ER-3818                 PIC X(4)  VALUE '3818'.
   688     12  ER-7540                 PIC X(4)  VALUE '7540'.
   689     12  ER-7576                 PIC X(4)  VALUE '7576'.
   690     12  ER-7579                 PIC X(4)  VALUE '7579'.
   691     12  ER-7830                 PIC X(4)  VALUE '7830'.
   692     12  ER-7831                 PIC X(4)  VALUE '7831'.
   693     12  ER-7832                 PIC X(4)  VALUE '7832'.
   694     12  ER-7833                 PIC X(4)  VALUE '7833'.
   695     12  ER-7834                 PIC X(4)  VALUE '7834'.
   696     12  ER-7835                 PIC X(4)  VALUE '7835'.
   697     12  ER-7836                 PIC X(4)  VALUE '7836'.
   698     12  ER-7837                 PIC X(4)  VALUE '7837'.
   699     12  ER-7838                 PIC X(4)  VALUE '7838'.
   700     12  ER-7841                 PIC X(4)  VALUE '7841'.
   701     12  ER-7844                 PIC X(4)  VALUE '7844'.
   702     12  ER-7845                 PIC X(4)  VALUE '7845'.
   703     12  ER-8000                 PIC X(4)  VALUE '8000'.
   704     12  ER-8051                 PIC X(4)  VALUE '8051'.
   705     12  ER-8052                 PIC X(4)  VALUE '8052'.
   706     12  ER-8053                 PIC X(4)  VALUE '8053'.
   707     12  ER-8054                 PIC X(4)  VALUE '8054'.
   708     12  ER-8055                 PIC X(4)  VALUE '8055'.
   709     12  ER-8056                 PIC X(4)  VALUE '8056'.
   710     12  ER-8057                 PIC X(4)  VALUE '8057'.
   711     12  ER-8058                 PIC X(4)  VALUE '8058'.
   712     12  ER-8059                 PIC X(4)  VALUE '8059'.
   713     12  ER-8060                 PIC X(4)  VALUE '8060'.
   714     12  ER-8061                 PIC X(4)  VALUE '8061'.
   715     12  ER-8062                 PIC X(4)  VALUE '8062'.
   716     12  ER-8063                 PIC X(4)  VALUE '8063'.
   717     12  ER-8064                 PIC X(4)  VALUE '8064'.
   718     12  ER-8065                 PIC X(4)  VALUE '8065'.
   719     12  ER-8066                 PIC X(4)  VALUE '8066'.
   720     12  ER-8146                 PIC X(4)  VALUE '8146'.
   721     12  ER-8147                 PIC X(4)  VALUE '8147'.
   722     12  ER-8152                 PIC X(4)  VALUE '8152'.
   723     12  ER-8153                 PIC X(4)  VALUE '8153'.
   724     12  ER-8154                 PIC X(4)  VALUE '8154'.
   725     12  ER-8155                 PIC X(4)  VALUE '8155'.
   726     12  ER-8310                 PIC X(4)  VALUE '8310'.
   727     12  ER-8311                 PIC X(4)  VALUE '8311'.
   728     12  ER-8312                 PIC X(4)  VALUE '8312'.
   729     12  ER-8313                 PIC X(4)  VALUE '8313'.
   730     12  ER-8314                 PIC X(4)  VALUE '8314'.
   731     12  ER-8315                 PIC X(4)  VALUE '8315'.
   732     12  ER-8316                 PIC X(4)  VALUE '8316'.
   733     12  ER-8317                 PIC X(4)  VALUE '8317'.
   734
   735 01  CSO-WORK-FIELDS.
   736     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   737       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   738
   739     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   740     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   741         88  CERT-NOTE-ADDED           VALUE 'Y'.
   742     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   743         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   744     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  15
* EL156.cbl
   745
   746     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   747
   748 01  SC-NP6-CERT-NOTE.
   749     12  FILLER                  PIC X(12)
   750               VALUE 'REM BENEFIT '.
   751     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   752     12  SC-NP6-COMM             PIC X(8)
   753               VALUE ' + 6 MO '.
   754     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   755     12  FILLER                  PIC X(12)
   756               VALUE ' = AMT PAID '.
   757     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   758
   759 01  SC-NP6-ORIG-NOTE.
   760     12  FILLER                  PIC X(63)  VALUE
   761         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   762 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   763     88  PDEF-FOUND                   VALUE 'Y'.
   764 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   765     88  ACCT-FOUND                   VALUE 'Y'.
   766 01  CTBL-KEY-SAVE               PIC X(5).
   767 01  CTBL-KEY.
   768     05  CTBL-COMPANY-CD         PIC X.
   769     05  CTBL-TABLE              PIC XXX.
   770     05  CTBL-BEN-TYPE           PIC X.
   771     05  CTBL-BEN-CODE           PIC XX.
   772 01  ERPDEF-KEY-SAVE             PIC X(18).
   773 01  ERPDEF-KEY.
   774     12  ERPDEF-COMPANY-CD       PIC X.
   775     12  ERPDEF-STATE            PIC XX.
   776     12  ERPDEF-PROD-CD          PIC XXX.
   777     12  F                       PIC X(7).
   778     12  ERPDEF-BEN-TYPE         PIC X.
   779     12  ERPDEF-BEN-CODE         PIC XX.
   780     12  ERPDEF-EXP-DT           PIC XX.
   781 01  ELCRTT-KEY.
   782     05  CTRLR-COMP-CD       PIC X.
   783     05  CTRLR-CARRIER       PIC X.
   784     05  CTRLR-GROUPING      PIC X(6).
   785     05  CTRLR-STATE         PIC X(2).
   786     05  CTRLR-ACCOUNT       PIC X(10).
   787     05  CTRLR-EFF-DT        PIC XX.
   788     05  CTRLR-CERT-NO       PIC X(11).
   789     05  CTRLR-REC-TYPE      PIC X.
   790 01  ACCESS-KEYS.
   791     12  ELARCH-KEY.
   792         16  ARCH-CO             PIC X.
   793         16  ARCH-NUMBER         PIC S9(08) COMP.
   794         16  ARCH-REC-TYPE       PIC X.
   795         16  ARCH-SEQ            PIC S9(04) COMP.
   796     12  ELMSTR-KEY.
   797         16  MSTR-COMP-CD        PIC X.
   798         16  MSTR-CARRIER        PIC X.
   799         16  MSTR-CLAIM-NO       PIC X(7).
   800         16  MSTR-CERT-NO        PIC X(11).
   801     12  ELCNTL-KEY.
   802         16  CNTL-COMP-ID        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  16
* EL156.cbl
   803         16  CNTL-REC-TYPE       PIC X.
   804         16  CNTL-ACCESS         PIC X(4).
   805         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   806     12  ELCERT-KEY.
   807         16  CERT-COMP-CD        PIC X.
   808         16  CERT-CARRIER        PIC X.
   809         16  CERT-GROUPING       PIC X(6).
   810         16  CERT-STATE          PIC XX.
   811         16  CERT-ACCOUNT        PIC X(10).
   812         16  CERT-EFF-DT         PIC XX.
   813         16  CERT-CERT-NO        PIC X(11).
   814     12  ELTRLR-KEY.
   815         16  TRLR-COMP-CD        PIC X.
   816         16  TRLR-CARRIER        PIC X.
   817         16  TRLR-CLAIM-NO       PIC X(7).
   818         16  TRLR-CERT-NO        PIC X(11).
   819         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   820     12  ELACTQ-KEY.
   821         16  ACTQ-COMP-CD        PIC X.
   822         16  ACTQ-CARRIER        PIC X.
   823         16  ACTQ-CLAIM-NO       PIC X(7).
   824         16  ACTQ-CERT-NO        PIC X(11).
   825     12  W-NOTE-KEY.
   826         16  W-NOTE-COMP-CD      PIC X.
   827         16  W-NOTE-CERT-KEY.
   828             20  W-NOTE-CARRIER  PIC X.
   829             20  W-NOTE-GROUPING PIC X(6).
   830             20  W-NOTE-STATE    PIC XX.
   831             20  W-NOTE-ACCOUNT  PIC X(10).
   832             20  W-NOTE-EFF-DT   PIC XX.
   833             20  W-NOTE-CERT-NO  PIC X(11).
   834     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   835     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   836     12  ERACCT-KEY.
   837         16  ERACCT-PARTIAL-KEY.
   838             20  ACCT-COMP-CD    PIC X.
   839             20  ACCT-CARRIER    PIC X.
   840             20  ACCT-GROUPING   PIC X(6).
   841             20  ACCT-STATE      PIC XX.
   842             20  ACCT-ACCOUNT    PIC X(10).
   843         16  ACCT-EXP-DT         PIC XX.
   844         16  FILLER              PIC X(4) VALUE SPACES.
   845     12  ELCHKQ-KEY.
   846         16  CHKQ-COMP-CD        PIC X.
   847         16  CHKQ-CONTROL        PIC S9(8) COMP.
   848         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   849     12  ELBENE-KEY.
   850         16  BENE-COMP-CD         PIC X.
   851         16  BENE-RECORD-TYPE     PIC X.
   852         16  BENE-NUMBER          PIC X(10).
   853     12  ERCOMP-KEY.
   854         16  COMP-COMP-CD        PIC X.
   855         16  COMP-CARRIER        PIC X.
   856         16  COMP-GROUP          PIC X(06).
   857         16  COMP-FIN-RESP       PIC X(10).
   858         16  COMP-ACCOUNT        PIC X(10).
   859         16  COMP-TYPE           PIC X.
   860
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  17
* EL156.cbl
   861     12  DLO035-KEY.
   862         16  DL35-PROCESS-TYPE   PIC X.
   863         16  DL35-CREDIT-CARD    PIC X(20).
   864         16  DL35-BEN-TYPE       PIC XX.
   865         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   866         16  DL35-RETURN-CODE    PIC XX.
   867
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  18
* EL156.cbl
   869*    COPY ELCDATE.
   870******************************************************************
   871*                                                                *
   872*                                                                *
   873*                            ELCDATE.                            *
   874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   875*                            VMOD=2.003
   876*                                                                *
   877*                                                                *
   878*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   879*                 LENGTH = 200                                   *
   880******************************************************************
   881
   882 01  DATE-CONVERSION-DATA.
   883     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   884     12  DC-OPTION-CODE                PIC X.
   885         88  BIN-TO-GREG                VALUE ' '.
   886         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   887         88  EDIT-GREG-TO-BIN           VALUE '2'.
   888         88  YMD-GREG-TO-BIN            VALUE '3'.
   889         88  MDY-GREG-TO-BIN            VALUE '4'.
   890         88  JULIAN-TO-BIN              VALUE '5'.
   891         88  BIN-PLUS-ELAPSED           VALUE '6'.
   892         88  FIND-CENTURY               VALUE '7'.
   893         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   894         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   895         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   896         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   897         88  JULIAN-TO-BIN-3            VALUE 'C'.
   898         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   899         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   900         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   901         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   902         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   903         88  CHECK-LEAP-YEAR            VALUE 'H'.
   904         88  BIN-3-TO-GREG              VALUE 'I'.
   905         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   906         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   907         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   908         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   909         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   910         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   911         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   912         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   913         88  THREE-CHARACTER-BIN
   914                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   915         88  GREGORIAN-TO-BIN
   916                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   917         88  BIN-TO-GREGORIAN
   918                  VALUES ' ' '1' 'I' '8' 'G'.
   919         88  JULIAN-TO-BINARY
   920                  VALUES '5' 'C' 'E' 'F'.
   921     12  DC-ERROR-CODE                 PIC X.
   922         88  NO-CONVERSION-ERROR        VALUE ' '.
   923         88  DATE-CONVERSION-ERROR
   924                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   925         88  DATE-IS-ZERO               VALUE '1'.
   926         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  19
* EL156.cbl
   927         88  DATE-IS-INVALID            VALUE '3'.
   928         88  DATE1-GREATER-DATE2        VALUE '4'.
   929         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   930         88  DATE-INVALID-OPTION        VALUE '9'.
   931         88  INVALID-CENTURY            VALUE 'A'.
   932         88  ONLY-CENTURY               VALUE 'B'.
   933         88  ONLY-LEAP-YEAR             VALUE 'C'.
   934         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   935     12  DC-END-OF-MONTH               PIC X.
   936         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   937     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   938         88  USE-NORMAL-PROCESS         VALUE ' '.
   939         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   940         88  ADJUST-UP-100-YRS          VALUE '2'.
   941     12  FILLER                        PIC X.
   942     12  DC-CONVERSION-DATES.
   943         16  DC-BIN-DATE-1             PIC XX.
   944         16  DC-BIN-DATE-2             PIC XX.
   945         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   946         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   947                       DC-GREG-DATE-1-EDIT.
   948             20  DC-EDIT1-MONTH        PIC 99.
   949             20  SLASH1-1              PIC X.
   950             20  DC-EDIT1-DAY          PIC 99.
   951             20  SLASH1-2              PIC X.
   952             20  DC-EDIT1-YEAR         PIC 99.
   953         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   954         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   955                     DC-GREG-DATE-2-EDIT.
   956             20  DC-EDIT2-MONTH        PIC 99.
   957             20  SLASH2-1              PIC X.
   958             20  DC-EDIT2-DAY          PIC 99.
   959             20  SLASH2-2              PIC X.
   960             20  DC-EDIT2-YEAR         PIC 99.
   961         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   962         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   963                     DC-GREG-DATE-1-YMD.
   964             20  DC-YMD-YEAR           PIC 99.
   965             20  DC-YMD-MONTH          PIC 99.
   966             20  DC-YMD-DAY            PIC 99.
   967         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   968         16  DC-GREG-DATE-1-MDY-R REDEFINES
   969                      DC-GREG-DATE-1-MDY.
   970             20  DC-MDY-MONTH          PIC 99.
   971             20  DC-MDY-DAY            PIC 99.
   972             20  DC-MDY-YEAR           PIC 99.
   973         16  DC-GREG-DATE-1-ALPHA.
   974             20  DC-ALPHA-MONTH        PIC X(10).
   975             20  DC-ALPHA-DAY          PIC 99.
   976             20  FILLER                PIC XX.
   977             20  DC-ALPHA-CENTURY.
   978                 24 DC-ALPHA-CEN-N     PIC 99.
   979             20  DC-ALPHA-YEAR         PIC 99.
   980         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   981         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   982         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   983         16  DC-JULIAN-DATE            PIC 9(05).
   984         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  20
* EL156.cbl
   985                                       PIC 9(05).
   986         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   987             20  DC-JULIAN-YEAR        PIC 99.
   988             20  DC-JULIAN-DAYS        PIC 999.
   989         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   990         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   991         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   992     12  DATE-CONVERSION-VARIBLES.
   993         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   994         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   995             20  FILLER                PIC 9(3).
   996             20  HOLD-CEN-1-CCYY.
   997                 24  HOLD-CEN-1-CC     PIC 99.
   998                 24  HOLD-CEN-1-YY     PIC 99.
   999             20  HOLD-CEN-1-MO         PIC 99.
  1000             20  HOLD-CEN-1-DA         PIC 99.
  1001         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1002             20  HOLD-CEN-1-R-MO       PIC 99.
  1003             20  HOLD-CEN-1-R-DA       PIC 99.
  1004             20  HOLD-CEN-1-R-CCYY.
  1005                 24  HOLD-CEN-1-R-CC   PIC 99.
  1006                 24  HOLD-CEN-1-R-YY   PIC 99.
  1007             20  FILLER                PIC 9(3).
  1008         16  HOLD-CENTURY-1-X.
  1009             20  FILLER                PIC X(3)  VALUE SPACES.
  1010             20  HOLD-CEN-1-X-CCYY.
  1011                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1012                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1013             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1014             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1015         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1016             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1017             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1018             20  HOLD-CEN-1-R-X-CCYY.
  1019                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1020                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1021             20  FILLER                PIC XXX.
  1022         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1023         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1024         16  DC-JULIAN-DATE-1          PIC 9(07).
  1025         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1026             20  DC-JULIAN-1-CCYY.
  1027                 24  DC-JULIAN-1-CC    PIC 99.
  1028                 24  DC-JULIAN-1-YR    PIC 99.
  1029             20  DC-JULIAN-DA-1        PIC 999.
  1030         16  DC-JULIAN-DATE-2          PIC 9(07).
  1031         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1032             20  DC-JULIAN-2-CCYY.
  1033                 24  DC-JULIAN-2-CC    PIC 99.
  1034                 24  DC-JULIAN-2-YR    PIC 99.
  1035             20  DC-JULIAN-DA-2        PIC 999.
  1036         16  DC-GREG-DATE-A-EDIT.
  1037             20  DC-EDITA-MONTH        PIC 99.
  1038             20  SLASHA-1              PIC X VALUE '/'.
  1039             20  DC-EDITA-DAY          PIC 99.
  1040             20  SLASHA-2              PIC X VALUE '/'.
  1041             20  DC-EDITA-CCYY.
  1042                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  21
* EL156.cbl
  1043                 24  DC-EDITA-YEAR     PIC 99.
  1044         16  DC-GREG-DATE-B-EDIT.
  1045             20  DC-EDITB-MONTH        PIC 99.
  1046             20  SLASHB-1              PIC X VALUE '/'.
  1047             20  DC-EDITB-DAY          PIC 99.
  1048             20  SLASHB-2              PIC X VALUE '/'.
  1049             20  DC-EDITB-CCYY.
  1050                 24  DC-EDITB-CENT     PIC 99.
  1051                 24  DC-EDITB-YEAR     PIC 99.
  1052         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1053         16  DC-GREG-DATE-CYMD-R REDEFINES
  1054                              DC-GREG-DATE-CYMD.
  1055             20  DC-CYMD-CEN           PIC 99.
  1056             20  DC-CYMD-YEAR          PIC 99.
  1057             20  DC-CYMD-MONTH         PIC 99.
  1058             20  DC-CYMD-DAY           PIC 99.
  1059         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1060         16  DC-GREG-DATE-MDCY-R REDEFINES
  1061                              DC-GREG-DATE-MDCY.
  1062             20  DC-MDCY-MONTH         PIC 99.
  1063             20  DC-MDCY-DAY           PIC 99.
  1064             20  DC-MDCY-CEN           PIC 99.
  1065             20  DC-MDCY-YEAR          PIC 99.
  1066    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1067        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1068    12  DC-EL310-DATE                  PIC X(21).
  1069    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  22
* EL156.cbl
  1071*    COPY ELCLOGOF.
  1072******************************************************************
  1073*                                                                *
  1074*                                                                *
  1075*                            ELCLOGOF.                           *
  1076*                            VMOD=2.001                          *
  1077*                                                                *
  1078*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1079*                                                                *
  1080******************************************************************
  1081 01  CLASIC-LOGOFF.
  1082     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1083     12  LOGOFF-TEXT.
  1084         16  FILLER          PIC X(5)    VALUE SPACES.
  1085         16  LOGOFF-MSG.
  1086             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1087             20  FILLER      PIC X       VALUE SPACES.
  1088             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1089         16  FILLER          PIC X(80)
  1090           VALUE '* YOU ARE NOW LOGGED OFF'.
  1091         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1092         16  FILLER          PIC X       VALUE QUOTE.
  1093         16  LOGOFF-SYS-MSG  PIC X(17)
  1094           VALUE 'S CLAS-IC SYSTEM '.
  1095     12  TEXT-MESSAGES.
  1096         16  UNACCESS-MSG    PIC X(29)
  1097             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1098         16  PGMIDERR-MSG    PIC X(17)
  1099             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  23
* EL156.cbl
  1101*    COPY ELCCALC.
  1102******************************************************************
  1103*                                                                *
  1104*                           ELCCALC.                            *
  1105*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1106*                            VMOD=2.025                          *
  1107*                                                                *
  1108*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1109*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1110*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1111*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1112*                                                                *
  1113*  PASSED TO ELRTRM                                              *
  1114*  -----------------                                             *
  1115*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1116*  ORIGINAL TERM                                                 *
  1117*  BEGINNING DATE                                                *
  1118*  ENDING DATE                                                   *
  1119*  COMPANY I.D.                                                  *
  1120*  ACCOUNT MASTER USER FIELD                                     *
  1121*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1122*  FREE LOOK DAYS                                                *
  1123*                                                                *
  1124*  RETURNED FROM ELRTRM                                          *
  1125*  ---------------------                                         *
  1126*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1127*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1128*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1129*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1130*----------------------------------------------------------------*
  1131*  PASSED TO ELRAMT                                              *
  1132*  ----------------                                              *
  1133*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1134*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1135*  ORIGINAL AMOUNT                                               *
  1136*  ALTERNATE BENEFIT (BALLON)                                    *
  1137*  A.P.R. - NET PAY ONLY                                         *
  1138*  METHOD
  1139*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1140*  COMPANY I.D.                                                  *
  1141*  BENEFIT TYPE                                                  *
  1142*                                                                *
  1143*  RETURNED FROM ELRAMT                                          *
  1144*  --------------------                                          *
  1145*  REMAINING AMOUNT 1 - CURRENT                                  *
  1146*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1147*  REMAINING AMOUNT FACTOR
  1148*----------------------------------------------------------------*
  1149*  PASSED TO ELRESV                                              *
  1150*  -----------------                                             *
  1151*  CERTIFICATE EFFECTIVE DATE                                    *
  1152*  VALUATION DATE                                                *
  1153*  PAID THRU DATE                                                *
  1154*  BENEFIT                                                       *
  1155*  INCURRED DATE                                                 *
  1156*  REPORTED DATE                                                 *
  1157*  ISSUE AGE                                                     *
  1158*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  24
* EL156.cbl
  1159*  CDT PERCENT                                                   *
  1160*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1161* *CLAIM TYPE (LIFE, A/H)                                        *
  1162* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1163* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1164*                                                                *
  1165*  RETURNED FROM ELRESV                                          *
  1166*  --------------------                                          *
  1167*  CDT TABLE USED                                                *
  1168*  CDT FACTOR USED                                               *
  1169*  PAY TO CURRENT RESERVE                                        *
  1170*  I.B.N.R. - A/H ONLY                                           *
  1171*  FUTURE (ACCRUED) AH ONLY                                      *
  1172*----------------------------------------------------------------*
  1173*  PASSED TO ELRATE                                              *
  1174*  ----------------                                              *
  1175*  CERT ISSUE DATE                                               *
  1176*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1177*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1178*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1179*  STATE CODE (CLIENT DEFINED)                                   *
  1180*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1181*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1182*  DEVIATION CODE                                                *
  1183*  ISSUE AGE                                                     *
  1184*  ORIGINAL BENEFIT AMOUNT                                       *
  1185*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1186*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1187*  BENEFIT KIND (LIFE OR A/H)                                    *
  1188*  A.P.R.                                                        *
  1189*  METHOD
  1190*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1191*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1192*  COMPANY I.D. (3 CHARACTER)                                    *
  1193*  BENEFIT CODE                                                  *
  1194*  BENEFIT OVERRIDE CODE                                         *
  1195*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1196*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1197*  JOINT INDICATOR (CSL ONLY)                                    *
  1198*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1199*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1200*                                                                *
  1201*  RETURNED FROM ELRATE                                          *
  1202*  --------------------                                          *
  1203*  CALCULATED PREMIUM                                            *
  1204*  PREMIUM RATE                                                  *
  1205*  MORTALITY CODE                                                *
  1206*  MAX ATTAINED AGE                                              *
  1207*  MAX AGE                                                       *
  1208*  MAX TERM                                                      *
  1209*  MAX MONTHLY BENEFIT                                           *
  1210*  MAX TOTAL BENIFIT                                             *
  1211*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1212*----------------------------------------------------------------*
  1213*  PASSED TO ELRFND                                              *
  1214*  ----------------                                              *
  1215*  CERT ISSUE DATE                                               *
  1216*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  25
* EL156.cbl
  1217*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1218*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1219*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1220*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1221*  STATE CODE (CLIENT DEFINED)                                   *
  1222*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1223*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1224*  DEVIATION CODE                                                *
  1225*  ISSUE AGE                                                     *
  1226*  ORIGINAL BENEFIT AMOUNT                                       *
  1227*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1228*  PROCESS TYPE (CANCEL)                                         *
  1229*  BENEFIT KIND (LIFE OR A/H)                                    *
  1230*  A.P.R.                                                        *
  1231*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1232*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1233*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1234*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1235*  COMPANY I.D. (3 CHARACTER)                                    *
  1236*  BENEFIT CODE                                                  *
  1237*  BENEFIT OVERRIDE CODE                                         *
  1238*                                                                *
  1239*  RETURNED FROM ELRFND                                          *
  1240*  --------------------                                          *
  1241*  CALCULATED REFUND                                             *
  1242*----------------------------------------------------------------*
  1243*  PASSED TO ELEARN                                              *
  1244*  ----------------                                              *
  1245*  CERT ISSUE DATE                                               *
  1246*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1247*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1248*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1249*  STATE CODE (CLIENT DEFINED)                                   *
  1250*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1251*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1252*  DEVIATION CODE                                                *
  1253*  ISSUE AGE                                                     *
  1254*  ORIGINAL BENEFIT AMOUNT                                       *
  1255*  BENEFIT KIND (LIFE OR A/H)                                    *
  1256*  A.P.R.                                                        *
  1257*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1258*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1259*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1260*  COMPANY I.D. (3 CHARACTER)                                    *
  1261*  BENEFIT CODE                                                  *
  1262*  BENEFIT OVERRIDE CODE                                         *
  1263*                                                                *
  1264*  RETURNED FROM ELEARN                                          *
  1265*  --------------------                                          *
  1266*  INDICATED  EARNINGS                                           *
  1267*----------------------------------------------------------------*
  1268*                 LENGTH = 450                                   *
  1269*                                                                *
  1270******************************************************************
  1271******************************************************************
  1272*                   C H A N G E   L O G
  1273*
  1274* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  26
* EL156.cbl
  1275*-----------------------------------------------------------------
  1276*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1277* EFFECTIVE    NUMBER
  1278*-----------------------------------------------------------------
  1279* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1280* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1281* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1282* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1283* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1284* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1285* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1286* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1287* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1288******************************************************************
  1289
  1290 01  CALCULATION-PASS-AREA.
  1291     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1292                                     COMP.
  1293
  1294     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1295       88  NO-CP-ERROR                             VALUE ZERO.
  1296       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1297                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1298       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1299       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1300       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1301       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1302       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1303       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1304       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1305       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1306       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1307       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1308       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1309       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1310       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1311       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1312       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1313       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1314       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1315
  1316     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1317       88  NO-CP-ERROR-2                           VALUE ZERO.
  1318***********************  INPUT AREAS ****************************
  1319
  1320     12  CP-CALCULATION-AREA.
  1321         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1322         16  CP-CERT-EFF-DT        PIC XX.
  1323         16  CP-VALUATION-DT       PIC XX.
  1324         16  CP-PAID-THRU-DT       PIC XX.
  1325         16  CP-BENEFIT-TYPE       PIC X.
  1326           88  CP-AH                               VALUE 'A' 'D'
  1327                                                   'I' 'U'.
  1328           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1329           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1330         16  CP-INCURRED-DT        PIC XX.
  1331         16  CP-REPORTED-DT        PIC XX.
  1332         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  27
* EL156.cbl
  1333         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1334         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1335                                     COMP-3.
  1336         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1337                                     COMP-3.
  1338         16  CP-CDT-METHOD         PIC X.
  1339           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1340           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1341           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1342         16  CP-CLAIM-TYPE         PIC X.
  1343           88  CP-AH-CLAIM                         VALUE 'A'.
  1344           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1345         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1346                                     COMP-3.
  1347         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1348                                     COMP-3.
  1349         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1350                                     COMP-3.
  1351         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1352                                     COMP-3.
  1353         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1354                                     COMP-3.
  1355         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1356                                     COMP-3.
  1357         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1358                                     COMP-3.
  1359         16  CP-REM-TERM-METHOD    PIC X.
  1360           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1361           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1362           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1363           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1364           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1365           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1366           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1367         16  CP-EARNING-METHOD     PIC X.
  1368           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1369           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1370           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1371           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1372           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1373           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1374           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1375           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1376           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1377           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1378           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1379           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1380           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1381           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1382         16  CP-PROCESS-TYPE       PIC X.
  1383           88  CP-CLAIM                            VALUE '1'.
  1384           88  CP-CANCEL                           VALUE '2'.
  1385           88  CP-ISSUE                            VALUE '3'.
  1386         16  CP-SPECIAL-CALC-CD    PIC X.
  1387           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1388           88  CP-1-MTH-INTEREST               VALUE ' '.
  1389           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1390           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  28
* EL156.cbl
  1391           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1392           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1393           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1394           88  CP-FARM-PLAN                    VALUE 'F'.
  1395           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1396           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1397           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1398           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1399           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1400           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1401           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1402           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1403           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1404           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1405                                                     'W' 'X'.
  1406           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1407           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1408           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1409           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1410           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1411           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1412           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1413           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1414           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1415           88  CP-CSL-METH-1                   VALUE '5'.
  1416           88  CP-CSL-METH-2                   VALUE '6'.
  1417           88  CP-CSL-METH-3                   VALUE '7'.
  1418           88  CP-CSL-METH-4                   VALUE '8'.
  1419
  1420         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1421                                     COMP-3.
  1422         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1423         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1424         16  CP-STATE              PIC XX          VALUE SPACE.
  1425         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1426         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1427           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1428               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1429         16  CP-R78-OPTION         PIC X.
  1430           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1431           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1432
  1433         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1434         16  CP-IBNR-RESERVE-SW    PIC X.
  1435         16  CP-CLAIM-STATUS       PIC X.
  1436         16  CP-RATE-FILE          PIC X.
  1437         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1438                                     COMP-3.
  1439
  1440         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1441         16  CP-AH-OVERRIDE-CODE   PIC X.
  1442
  1443         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1444                                     COMP-3.
  1445         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1446                                   PIC S9(5)V99 COMP-3.
  1447         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1448                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  29
* EL156.cbl
  1449         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1450                                     COMP-3.
  1451         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1452                                     COMP-3.
  1453         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1454                                  PIC S9(7)V99 COMP-3.
  1455
  1456         16  CP-PAID-FROM-DATE     PIC X(02).
  1457         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1458         16  CP-EXT-DAYS-CALC      PIC X.
  1459           88  CP-EXT-NO-CHG                   VALUE ' '.
  1460           88  CP-EXT-CHG-LF                   VALUE '1'.
  1461           88  CP-EXT-CHG-AH                   VALUE '2'.
  1462           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1463         16  CP-DOMICILE-STATE     PIC XX.
  1464         16  CP-CARRIER            PIC X.
  1465         16  CP-REIN-FLAG          PIC X.
  1466         16  CP-REM-TRM-CALC-OPTION PIC X.
  1467           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1468                      '2' '3' '4' '5'.
  1469           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1470           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1471           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1472           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1473           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1474           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1475           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1476           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1477         16  CP-SIG-SWITCH         PIC X.
  1478         16  CP-RATING-METHOD      PIC X.
  1479           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1480           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1481           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1482           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1483           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1484           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1485           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1486           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1487           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1488         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1489                                     COMP-3.
  1490         16  CP-BEN-CATEGORY       PIC X.
  1491         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1492         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1493                                   PIC S99V9(5) COMP-3.
  1494         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1495         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1496                                   PIC S99V9(5) COMP-3.
  1497         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1498         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1499         16  CP-EXPIRE-DT          PIC XX.
  1500         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1501         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1502         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1503         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1504         16  CP-DDF-SPEC-CALC      PIC X.
  1505             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1506             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  30
* EL156.cbl
  1507         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1508         16  CP-CANCEL-REASON      PIC X.
  1509         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1510         16  CP-PMT-MODE           PIC X.
  1511         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1512         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1513         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1514         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1515         16  FILLER                PIC X.
  1516
  1517***************    OUTPUT FROM ELRESV   ************************
  1518
  1519         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1520
  1521         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1522                                     COMP-3.
  1523         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1524                                     COMP-3.
  1525         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1526                                     COMP-3.
  1527         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1528                                     COMP-3.
  1529         16  FILLER                PIC X(09).
  1530***************    OUTPUT FROM ELRTRM   *************************
  1531
  1532         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1533                                     COMP-3.
  1534         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1535                                     COMP-3.
  1536         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1537                                     COMP-3.
  1538         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1539                                     COMP-3.
  1540         16  FILLER                PIC X(12).
  1541
  1542***************    OUTPUT FROM ELRAMT   *************************
  1543
  1544         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1545                                     COMP-3.
  1546         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1547                                     COMP-3.
  1548         16  FILLER                PIC X(12).
  1549
  1550***************    OUTPUT FROM ELRATE   *************************
  1551
  1552         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1553                                     COMP-3.
  1554         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1555                                     COMP-3.
  1556         16  CP-MORTALITY-CODE     PIC X(4).
  1557         16  CP-RATE-EDIT-FLAG     PIC X.
  1558             88  CP-RATES-NEED-APR                  VALUE '1'.
  1559         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1560                                     COMP-3.
  1561         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1562         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1563         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1564                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  31
* EL156.cbl
  1565         16  FILLER                PIC X(07).
  1566
  1567***************    OUTPUT FROM ELRFND   *************************
  1568
  1569         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1570                                     COMP-3.
  1571         16  CP-REFUND-TYPE-USED   PIC X.
  1572           88  CP-R-AS-R78                         VALUE '1'.
  1573           88  CP-R-AS-PRORATA                     VALUE '2'.
  1574           88  CP-R-AS-CALIF                       VALUE '3'.
  1575           88  CP-R-AS-TEXAS                       VALUE '4'.
  1576           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1577           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1578           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1579           88  CP-R-AS-MEAN                        VALUE '8'.
  1580           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1581           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1582           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1583           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1584           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1585           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1586         16  FILLER                PIC X(12).
  1587
  1588***************    OUTPUT FROM ELEARN   *************************
  1589
  1590         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1591                                     COMP-3.
  1592         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1593                                     COMP-3.
  1594         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1595                                     COMP-3.
  1596         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1597                                     COMP-3.
  1598         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1599                                     COMP-3.
  1600         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1601                                     COMP-3.
  1602         16  CP-EARNING-TYPE-USED  PIC X.
  1603           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1604           88  CP-E-AS-R78                         VALUE '1'.
  1605           88  CP-E-AS-PRORATA                     VALUE '2'.
  1606           88  CP-E-AS-TEXAS                       VALUE '4'.
  1607           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1608           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1609           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1610           88  CP-E-AS-MEAN                        VALUE '8'.
  1611           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1612         16  FILLER                PIC X(12).
  1613
  1614***************    OUTPUT FROM ELPMNT   *************************
  1615
  1616         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1617                                     COMP-3.
  1618         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1619                                     COMP-3.
  1620         16  FILLER                PIC X(12).
  1621
  1622***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  32
* EL156.cbl
  1623         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1626                                     COMP-3.
  1627         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1628                                     COMP-3.
  1629         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1632                                     COMP-3.
  1633         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1636             88  OPEN-RATE-FILE                   VALUE 'O'.
  1637             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1638             88  IO-ERROR                         VALUE 'E'.
  1639
  1640         16  CP-FIRST-PAY-DATE     PIC XX.
  1641
  1642         16  CP-JOINT-INDICATOR    PIC X.
  1643
  1644         16  CP-RESERVE-REMAINING-TERM
  1645                                   PIC S9(4)V9    VALUE ZERO
  1646                                     COMP-3.
  1647
  1648         16  CP-INSURED-BIRTH-DT   PIC XX.
  1649
  1650         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1651                                     COMP-3.
  1652
  1653         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1654                                     COMP-3.
  1655
  1656         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1657                                     COMP-3.
  1658
  1659         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1660                                     COMP-3.
  1661
  1662         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1663                                     COMP-3.
  1664
  1665         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1666                                     COMP-3.
  1667
  1668         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1669                                     COMP-3.
  1670
  1671         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1672             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1673
  1674         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1675                                     COMP-3.
  1676         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1677                                     COMP-3.
  1678         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1679         16  FILLER                PIC X(15).
  1680******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  33
* EL156.cbl
  1681*    COPY ELCICALC.
  1682******************************************************************
  1683*                                                                *
  1684*                           ELCCICALC.                           *
  1685*                            VMOD=2.001                          *
  1686*                                                                *
  1687*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1688*                 CALCULATION MODULE                             *
  1689*                                                                *
  1690*  PASSED TO ELCLMI                                              *
  1691*  -----------------                                             *
  1692*  STATE                                                         *
  1693*  PRODUCT                                                       *
  1694*  COVERAGE                                                      *
  1695*  EFFECTIVE DATE                                                *
  1696*  INCURRED DATE                                                 *
  1697*  ESTABLISHED DATE                                              *
  1698*  LAST PAID DATE                                                *
  1699*  REPORTED DATE                                                 *
  1700*  CLAIM PAYMENT AMOUNT                                          *
  1701*                                                                *
  1702*  RETURNED FROM ELRTRM                                          *
  1703*  ---------------------                                         *
  1704*  RETURN CODE                                                   *
  1705*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1706*  CLAIM INTEREST AMOUNT                                         *
  1707*----------------------------------------------------------------*
  1708*----------------------------------------------------------------*
  1709*                 LENGTH = 100                                   *
  1710*                                                                *
  1711******************************************************************
  1712******************************************************************
  1713*                   C H A N G E   L O G
  1714*
  1715* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1716*-----------------------------------------------------------------
  1717*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1718* EFFECTIVE    NUMBER
  1719*-----------------------------------------------------------------
  1720* 120905    2004040700004  PEMA  NEW COPYBOOK
  1721* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1722******************************************************************
  1723
  1724 01  CLAIM-INT-PASS-AREA.
  1725     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1726                                     COMP.
  1727
  1728     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1729       88  NO-CI-ERROR                             VALUE ZERO.
  1730       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1731       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1732       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1733       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1734       88  CP-AMT-LT-5000                          VALUE '4'.
  1735       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1736       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1737       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1738       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  34
* EL156.cbl
  1739***********************  INPUT AREAS ****************************
  1740
  1741     12  CP-CALCULATION-AREA.
  1742         16  CP-COMPANY-CD         PIC X.
  1743         16  CP-STATE              PIC XX.
  1744         16  CP-PRODUCT            PIC XX.
  1745         16  CP-COVERAGE           PIC XX.
  1746         16  CP-INC-DT             PIC XX.
  1747         16  CP-EST-DT             PIC XX.
  1748         16  CP-LSTPD-DT           PIC XX.
  1749         16  CP-RPT-DT             PIC XX.
  1750         16  CP-PRF-DT             PIC XX.
  1751         16  CP-EFF-DT             PIC XX.
  1752         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1753         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1754         16  FILLER                PIC X(37).
  1755
  1756***************    OUTPUT FROM ELCLMI   ************************
  1757
  1758         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1759
  1760         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1761         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1762         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1763         16  FILLER                PIC X(19).
  1764******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  35
* EL156.cbl
  1766*    COPY ELCATTR.
  1767******************************************************************
  1768*                                                                *
  1769*                            ELCATTR.                            *
  1770*                            VMOD=2.001                          *
  1771*                                                                *
  1772*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1773*                                                                *
  1774*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1775*                                                                *
  1776*                   POS 1   P=PROTECTED                          *
  1777*                           U=UNPROTECTED                        *
  1778*                           S=ASKIP                              *
  1779*                   POS 2   A=ALPHA/NUMERIC                      *
  1780*                           N=NUMERIC                            *
  1781*                   POS 3   N=NORMAL                             *
  1782*                           B=BRIGHT                             *
  1783*                           D=DARK                               *
  1784*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1785*                           OF=MODIFIED DATA TAG OFF             *
  1786*                                                                *
  1787*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1788******************************************************************
  1789 01  ATTRIBUTE-LIST.
  1790     12  AL-PABOF            PIC X       VALUE 'Y'.
  1791     12  AL-PABON            PIC X       VALUE 'Z'.
  1792     12  AL-PADOF            PIC X       VALUE '%'.
  1793     12  AL-PADON            PIC X       VALUE '_'.
  1794     12  AL-PANOF            PIC X       VALUE '-'.
  1795     12  AL-PANON            PIC X       VALUE '/'.
  1796     12  AL-SABOF            PIC X       VALUE '8'.
  1797     12  AL-SABON            PIC X       VALUE '9'.
  1798     12  AL-SADOF            PIC X       VALUE '@'.
  1799     12  AL-SADON            PIC X       VALUE QUOTE.
  1800     12  AL-SANOF            PIC X       VALUE '0'.
  1801     12  AL-SANON            PIC X       VALUE '1'.
  1802     12  AL-UABOF            PIC X       VALUE 'H'.
  1803     12  AL-UABON            PIC X       VALUE 'I'.
  1804     12  AL-UADOF            PIC X       VALUE '<'.
  1805     12  AL-UADON            PIC X       VALUE '('.
  1806     12  AL-UANOF            PIC X       VALUE ' '.
  1807     12  AL-UANON            PIC X       VALUE 'A'.
  1808     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1809     12  AL-UNBON            PIC X       VALUE 'R'.
  1810     12  AL-UNDOF            PIC X       VALUE '*'.
  1811     12  AL-UNDON            PIC X       VALUE ')'.
  1812     12  AL-UNNOF            PIC X       VALUE '&'.
  1813     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  36
* EL156.cbl
  1815*    COPY ELCEMIB.
  1816******************************************************************
  1817*                                                                *
  1818*                                                                *
  1819*                            ELCEMIB.                            *
  1820*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1821*                            VMOD=2.005                          *
  1822*                                                                *
  1823*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1824*                                                                *
  1825******************************************************************
  1826 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1827     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1828     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1829     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1830     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1831     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1832     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1833     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1834     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1835     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1836         88  EMI-NO-ERRORS                    VALUE '1'.
  1837         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1838         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1839     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1840         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1841     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1842         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1843         88  EMI-AREA1-FULL                   VALUE '2'.
  1844     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1845         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1846         88  EMI-AREA2-FULL                   VALUE '2'.
  1847     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1848         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1849         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1850         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1851         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1852         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1853     12  EMI-ERROR-LINES.
  1854         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1855         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1856         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1857         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1858             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1859                 24  EMI-ERR-NUM         PIC X(4).
  1860                 24  EMI-FILLER          PIC X.
  1861                 24  EMI-SEV             PIC X.
  1862                 24  FILLER              PIC X.
  1863             20  FILLER                  PIC X(02).
  1864     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1865         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1866             20  EMI-ERROR-NUMBER    PIC X(4).
  1867             20  EMI-FILL            PIC X.
  1868             20  EMI-SEVERITY        PIC X.
  1869             20  FILLER              PIC X.
  1870             20  EMI-ERROR-TEXT.
  1871                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1872                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  37
* EL156.cbl
  1873     12  EMI-SEVERITY-SAVE           PIC X.
  1874         88  EMI-NOTE                    VALUE 'N'.
  1875         88  EMI-WARNING                 VALUE 'W'.
  1876         88  EMI-FORCABLE                VALUE 'F'.
  1877         88  EMI-FATAL                   VALUE 'X'.
  1878     12  EMI-MESSAGE-FLAG            PIC X.
  1879         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1880         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1881     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1882     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1883         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1884         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1885         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1886     12  emi-claim-no                pic x(7).
  1887     12  emi-claim-type              pic x(6).
  1888     12  FILLER                      PIC X(124)  VALUE SPACES.
  1889     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1890     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1891     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1892     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  38
* EL156.cbl
  1894*    COPY ELCLNKLT.
  1895******************************************************************
  1896*                                                                *
  1897*                                                                *
  1898*                           ELCLNKLT                             *
  1899*                            VMOD=2.003                          *
  1900*                                                                *
  1901*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1902*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1903*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1904*                                                                *
  1905*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1906*   COMPLETING THE REQUIRED FIELDS.                              *
  1907*                                                                *
  1908*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1909*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1910*                              9999 INDICATES AN UNKNOWN ABEND   *
  1911*                                   WAS DETECTED.                *
  1912*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1913*                              CODES FOUND IN THE ERROR FILE.    *
  1914******************************************************************
  1915 01  W-1523-LINKDATA.
  1916     12  W-1523-COMMON-PI-DATA.
  1917         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1918         16  FILLER              PIC  X(67).
  1919         16  W-1523-COMPANY-CD   PIC  X(01).
  1920         16  FILLER              PIC  X(10).
  1921         16  W-1523-CONTROL-IN-PROGRESS.
  1922             20  W-1523-CARRIER  PIC  X(01).
  1923             20  W-1523-GROUPING PIC  X(06).
  1924             20  W-1523-STATE    PIC  X(02).
  1925             20  W-1523-ACCOUNT  PIC  X(10).
  1926             20  W-1523-CLAIM-CERT-GRP.
  1927                 24  W-1523-CLAIM-NO
  1928                                 PIC  X(07).
  1929                 24  W-1523-CERT-NO.
  1930                     28  W-1523-CERT-PRIME
  1931                                 PIC  X(10).
  1932                     28  W-1523-CERT-SFX
  1933                                 PIC  X(01).
  1934                 24  W-1523-CERT-EFF-DT
  1935                                 PIC  X(02).
  1936         16  FILLER              PIC X(265).
  1937
  1938     12  W-1523-WORK-AREA.
  1939         16  W-1523-FORM-NUMBER  PIC  X(04).
  1940         16  W-1523-NUMBER-COPIES
  1941                                 PIC  9(01).
  1942         16  W-1523-ADDR-TYPE    PIC  X(02).
  1943         16  W-1523-FOLLOW-UP-DATE
  1944                                 PIC  X(02).
  1945         16  W-1523-RESEND-DATE  PIC  X(02).
  1946         16  W-1523-ERROR-CODE   PIC  9(04).
  1947             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1948             88  W-1523-FATAL-ERROR
  1949                                    VALUES  0006 0013 0042
  1950                                            0154 0168 0169
  1951                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  39
* EL156.cbl
  1952                                            0179 0186 0281
  1953                                            0332 2055 3697
  1954                                            3698 3699 3770
  1955                                            3771 3772 7675
  1956                                            9106 9808 9883
  1957                                            9887.
  1958             88  W-1523-STOP-ERRORS
  1959                                    VALUES  0013 0042 0154
  1960                                            0168 0169 0172
  1961                                            0281 0332 2055
  1962                                            3698 3699 7675
  1963                                            9106 9808 9883
  1964                                            9999.
  1965         16  W-1523-REASON       PIC  X(70).
  1966         16  W-1523-ARCHIVE-NUMBER
  1967                                 PIC  9(08).
  1968     12  W-1523-POINTER-AREA.
  1969         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1970         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1971         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1972         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1973         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  40
* EL156.cbl
  1975*    COPY ELCNWA.
  1976*****************************************************************
  1977*                                                               *
  1978*                                                               *
  1979*                            ELCNWA.                            *
  1980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1981*                            VMOD=2.003                         *
  1982*                                                               *
  1983*            M O V E   N A M E   W O R K   A R E A.             *
  1984*                                                               *
  1985*****************************************************************.
  1986
  1987 01  WS-NAME-WORK-AREA.
  1988     05  WS-INSURED-LAST-NAME        PIC X(15).
  1989     05  WS-INSURED-1ST-NAME         PIC X(12).
  1990     05  WS-INSURED-MID-INIT         PIC X.
  1991
  1992     05  WS-NAME-WORK.
  1993         10  WS-NW                   PIC X
  1994             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1995
  1996     05  WS-NAME-WORK2.
  1997         10  WS-NW2                  PIC X
  1998             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1999                                        NWA-INDEX0.
  2000
  2001     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2002                                     COMP-3.
  2003
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  41
* EL156.cbl
  2005*    COPY ELCDMO.
  2006******************************************************************
  2007*                                                                *
  2008*                                                                *
  2009*                            ELCDMO.                             *
  2010*                            VMOD=2.004                          *
  2011*                                                                *
  2012*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2013*        COMMUNICATION AREA                                      *
  2014*   FILE TYPE = NA                                               *
  2015*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2016*                                                                *
  2017******************************************************************
  2018 01  DMO-COMMUNICATION-AREA.
  2019     12  DM-RECORD-TYPE                  PIC  X(02).
  2020             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2021             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2022             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2023     12  DM-DIST-CODE                    PIC  X(04).
  2024     12  DM-MAIL-CODE                    PIC  X(05).
  2025     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2026     12  DM-INSURED-NAME                 PIC  X(30).
  2027     12  DM-CLAIM-NO                     PIC  X(07).
  2028     12  DM-CLAIM-TYPE                   PIC  X.
  2029
  2030     12  DM-STATUS-DATA-AREA.
  2031         16  DM-CLAIM-STATUS             PIC  X.
  2032             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2033             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2034             88  DM-CLOSED                        VALUE '3'.
  2035             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2036             88  DM-DEFAULT                       VALUE '9'.
  2037         16  DM-STATUS-DATE              PIC  X(08).
  2038******YYYYMMDD
  2039         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2040             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2041             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2042             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2043             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2044             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2045             88  DM-RE-OPENED                     VALUE 'R'.
  2046             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2047             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2048             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2049         16  DM-STAT-CARRIER             PIC X.
  2050
  2051     12  DM-DRAFT-DATA-AREA.
  2052         16  DM-PAYMENT-TYPE             PIC  X.
  2053             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2054         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2055         16  DM-PAYMENT-DATE             PIC  X(08).
  2056******YYYYMMDD
  2057         16  DM-CERT-NO                  PIC  X(11).
  2058         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2059         16  DM-CARRIER                  PIC  X.
  2060
  2061     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  42
* EL156.cbl
  2063*    COPY ELCDMDCD.
  2064******************************************************************
  2065*                                                                *
  2066*                                                                *
  2067*                            ELCDMDCD.                           *
  2068*                            VMOD=2.001                          *
  2069*                                                                *
  2070*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2071*       COMMUNICATIONS AREA                                      *
  2072*                                                                *
  2073******************************************************************
  2074 01  CD-COMMUNICATION-AREA.
  2075     12  CD-SYSTEM-ID            PIC  X(02).
  2076         88 CD-CLAIMS                      VALUE 'CL'.
  2077         88 CD-CREDIT                      VALUE 'CR'.
  2078     12  CD-RECORD-TYPE          PIC  X(02).
  2079         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2080         88 CD-EOB-CODE                    VALUE 'EO'.
  2081         88 CD-ICD9-CODE                   VALUE 'I9'.
  2082         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2083         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2084         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2085         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2086         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2087     12  CD-RECORD-KEY           PIC  X(06).
  2088         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2089     12  CD-RETURN-CODE          PIC  X(02).
  2090     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2091     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2092     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2093     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  43
* EL156.cbl
  2095*    COPY ELCDCTB.
  2096******************************************************************
  2097*                                                                *
  2098*                                                                *
  2099*                            ELCDCTB.                            *
  2100*                            VMOD=2.002                          *
  2101*                                                                *
  2102*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2103*       COMMUNICATIONS AREA                                      *
  2104*                                                                *
  2105******************************************************************
  2106 01  DCT-COMMUNICATION-AREA.
  2107     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2108     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2109     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2110     12  DCT-PRODUCT-CODE         PIC  X(02).
  2111     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2112     12  DCT-RETURN-CODE          PIC  X(02).
  2113     12  DCT-MAIL-CODE            PIC  X(05).
  2114     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2115     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  44
* EL156.cbl
  2117 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2118 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2119 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2120 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  45
* EL156.cbl
  2122*    COPY ELCINTF.
  2123******************************************************************
  2124*                                                                *
  2125*                                                                *
  2126*                            ELCINTF.                            *
  2127*                            VMOD=2.017                          *
  2128*                                                                *
  2129*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2130*                                                                *
  2131*       LENGTH = 1024                                            *
  2132*                                                                *
  2133******************************************************************
  2134*                   C H A N G E   L O G
  2135*
  2136* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2137*-----------------------------------------------------------------
  2138*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2139* EFFECTIVE    NUMBER
  2140*-----------------------------------------------------------------
  2141* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2142******************************************************************
  2143 01  PROGRAM-INTERFACE-BLOCK.
  2144     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2145     12  PI-CALLING-PROGRAM              PIC X(8).
  2146     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2147     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2148     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2149     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2150     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2151     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2152     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2153     12  PI-COMPANY-ID                   PIC XXX.
  2154     12  PI-COMPANY-CD                   PIC X.
  2155
  2156     12  PI-COMPANY-PASSWORD             PIC X(8).
  2157
  2158     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2159
  2160     12  PI-CONTROL-IN-PROGRESS.
  2161         16  PI-CARRIER                  PIC X.
  2162         16  PI-GROUPING                 PIC X(6).
  2163         16  PI-STATE                    PIC XX.
  2164         16  PI-ACCOUNT                  PIC X(10).
  2165         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2166                                         PIC X(10).
  2167         16  PI-CLAIM-CERT-GRP.
  2168             20  PI-CLAIM-NO             PIC X(7).
  2169             20  PI-CERT-NO.
  2170                 25  PI-CERT-PRIME       PIC X(10).
  2171                 25  PI-CERT-SFX         PIC X.
  2172             20  PI-CERT-EFF-DT          PIC XX.
  2173         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2174             20  PI-PLAN-CODE            PIC X(2).
  2175             20  PI-REVISION-NUMBER      PIC X(3).
  2176             20  PI-PLAN-EFF-DT          PIC X(2).
  2177             20  PI-PLAN-EXP-DT          PIC X(2).
  2178             20  FILLER                  PIC X(11).
  2179         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  46
* EL156.cbl
  2180             20  PI-OE-REFERENCE-1.
  2181                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2182                 25  PI-OE-REF-1-SUFF    PIC XX.
  2183
  2184     12  PI-SESSION-IN-PROGRESS          PIC X.
  2185         88  CLAIM-SESSION                   VALUE '1'.
  2186         88  CREDIT-SESSION                  VALUE '2'.
  2187         88  WARRANTY-SESSION                VALUE '3'.
  2188         88  MORTGAGE-SESSION                VALUE '4'.
  2189         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2190
  2191
  2192*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2193
  2194     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2195     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2196
  2197     12  PI-CREDIT-USER                  PIC X.
  2198         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2199         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2200
  2201     12  PI-CLAIM-USER                   PIC X.
  2202         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2203         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2204
  2205     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2206         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2207         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2208         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2209         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2210         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2211
  2212     12  PI-PROCESSOR-ID                 PIC X(4).
  2213
  2214     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2215
  2216     12  PI-MEMBER-CAPTION               PIC X(10).
  2217
  2218     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2219         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2220
  2221     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2222     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2223     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2224     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2225
  2226     12  PI-AH-OVERRIDE-L1               PIC X.
  2227     12  PI-AH-OVERRIDE-L2               PIC XX.
  2228     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2229     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2230
  2231     12  PI-NEW-SYSTEM                   PIC X(2).
  2232
  2233     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2234     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2235         88  PI-USES-PAID-TO                 VALUE '1'.
  2236     12  PI-CRDTCRD-SYSTEM.
  2237         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  47
* EL156.cbl
  2238             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2239             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2240         16  PI-CC-MONTH-END-DT          PIC XX.
  2241     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2242
  2243     12  PI-OE-REFERENCE-2.
  2244         16  PI-OE-REF-2-PRIME           PIC X(10).
  2245         16  PI-OE-REF-2-SUFF            PIC X.
  2246
  2247     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2248
  2249     12  PI-LANGUAGE-TYPE                PIC X.
  2250             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2251             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2252             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2253
  2254     12  PI-POLICY-LINKAGE-IND           PIC X.
  2255         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2256         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2257                                                   LOW-VALUES.
  2258
  2259     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2260     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2261         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2262         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2263
  2264     12  PI-PROCESSOR-CSR-IND            PIC X.
  2265         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2266         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2267
  2268     12  FILLER                          PIC X(3).
  2269
  2270     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2271
  2272     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2273         PI-SYSTEM-LEVEL.
  2274
  2275         16  PI-ENTRY-CODES.
  2276             20  PI-ENTRY-CD-1           PIC X.
  2277             20  PI-ENTRY-CD-2           PIC X.
  2278
  2279         16  PI-RETURN-CODES.
  2280             20  PI-RETURN-CD-1          PIC X.
  2281             20  PI-RETURN-CD-2          PIC X.
  2282
  2283         16  PI-UPDATE-STATUS-SAVE.
  2284             20  PI-UPDATE-BY            PIC X(4).
  2285             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2286
  2287         16  PI-LOWER-CASE-LETTERS       PIC X.
  2288             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2289
  2290*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2291*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2292*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2293
  2294         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2295             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  48
* EL156.cbl
  2296             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2297             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2298             88  ACCNT-CNTL                  VALUE '3'.
  2299             88  CARR-ACCNT-CNTL             VALUE '4'.
  2300
  2301         16  PI-PROCESSOR-CAP-LIST.
  2302             20  PI-SYSTEM-CONTROLS.
  2303                24 PI-SYSTEM-DISPLAY     PIC X.
  2304                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2305                24 PI-SYSTEM-MODIFY      PIC X.
  2306                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2307             20  FILLER                  PIC XX.
  2308             20  PI-DISPLAY-CAP          PIC X.
  2309                 88  DISPLAY-CAP             VALUE 'Y'.
  2310             20  PI-MODIFY-CAP           PIC X.
  2311                 88  MODIFY-CAP              VALUE 'Y'.
  2312             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2313                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2314             20  PI-FORCE-CAP            PIC X.
  2315                 88  FORCE-CAP               VALUE 'Y'.
  2316
  2317         16  PI-PROGRAM-CONTROLS.
  2318             20  PI-PGM-PRINT-OPT        PIC X.
  2319             20  PI-PGM-FORMAT-OPT       PIC X.
  2320             20  PI-PGM-PROCESS-OPT      PIC X.
  2321             20  PI-PGM-TOTALS-OPT       PIC X.
  2322
  2323         16  PI-HELP-INTERFACE.
  2324             20  PI-LAST-ERROR-NO        PIC X(4).
  2325             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2326
  2327         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2328             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2329
  2330         16  PI-CR-CONTROL-IN-PROGRESS.
  2331             20  PI-CR-CARRIER           PIC X.
  2332             20  PI-CR-GROUPING          PIC X(6).
  2333             20  PI-CR-STATE             PIC XX.
  2334             20  PI-CR-ACCOUNT           PIC X(10).
  2335             20  PI-CR-FIN-RESP          PIC X(10).
  2336             20  PI-CR-TYPE              PIC X.
  2337
  2338         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2339
  2340         16  PI-CR-MONTH-END-DT          PIC XX.
  2341
  2342         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2343             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2344             88  PI-ZERO-CARRIER             VALUE '1'.
  2345             88  PI-ZERO-GROUPING            VALUE '2'.
  2346             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2347
  2348         16  PI-CARRIER-SECURITY         PIC X.
  2349             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2350
  2351         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2352             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2353             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  49
* EL156.cbl
  2354
  2355         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2356             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2357                                         INDEXED BY PI-ACCESS-NDX
  2358                                         PIC X.
  2359
  2360         16  PI-GA-BILLING-CONTROL       PIC X.
  2361             88  PI-GA-BILLING               VALUE '1'.
  2362
  2363         16  PI-MAIL-PROCESSING          PIC X.
  2364             88  PI-MAIL-YES                 VALUE 'Y'.
  2365
  2366         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2367
  2368         16  PI-AR-SYSTEM.
  2369             20  PI-AR-PROCESSING-CNTL   PIC X.
  2370                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2371             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2372             20  PI-AR-MONTH-END-DT      PIC XX.
  2373
  2374         16  PI-MP-SYSTEM.
  2375             20  PI-MORTGAGE-USER            PIC X.
  2376                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2377                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2378             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2379                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2380                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2381                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2382                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2383                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2384             20  PI-MP-MONTH-END-DT          PIC XX.
  2385             20  PI-MP-REFERENCE-NO.
  2386                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2387                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2388
  2389         16  PI-LABEL-CONTROL            PIC X(01).
  2390             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2391             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2392
  2393         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2394             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2395
  2396         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2397             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2398             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2399
  2400         16  FILLER                      PIC X(14).
  2401
  2402     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2403******************************************************************
  2404     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2405         16  PI-SAVE-FORM        PIC X(12).
  2406         16  PI-ACCT-KEY         PIC X(26).
  2407         16  PI-PAYEE-NAME       PIC X(30).
  2408         16  PI-DAILY-RATE       PIC S9(3)V99.
  2409         16  PI-MONTH-END-SAVE   PIC XX.
  2410         16  PI-BENEFIT-SAVE.
  2411             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  50
* EL156.cbl
  2412             20  PI-BEN-TYPE     PIC X.
  2413         16  PI-MANUAL-SW        PIC 9.
  2414         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2415         16  PI-PASS-SW          PIC X.
  2416         16  PI-PFKEY-USED       PIC X.
  2417         16  PI-CK-ASSIGN        PIC X.
  2418         16  PI-FATAL-COUNT      PIC 99.
  2419         16  PI-FORCE-COUNT      PIC 99.
  2420         16  PI-SAVE-INPUT.
  2421             20  PI-PMTTYPE      PIC X.
  2422             20  PI-PAYEE.
  2423                 24  PI-PAYEE-TYPE PIC X.
  2424                 24  PI-PAYEE-SEQ  PIC X.
  2425                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2426                   PI-PAYEE-SEQ    PIC S9.
  2427             20  PI-PMTNOTE1     PIC X(60).
  2428             20  PI-PMTNOTE2     PIC X(60).
  2429             20  PI-OFFLINE      PIC X.
  2430             20  PI-ECHECKNO     PIC X(7).
  2431             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2432                 28  PI-ECHECKNO-N     PIC X.
  2433                 28  PI-ECHECKNO-6     PIC X(6).
  2434             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2435                 24  PI-ECHECKNO-CR    PIC XX.
  2436                 24  PI-ECHECKNO-5     PIC X(5).
  2437             20  PI-HOLDTIL      PIC 9(6).
  2438             20  PI-EPYFROM      PIC 9(6).
  2439             20  PI-EPYTHRU      PIC 9(6).
  2440             20  PI-EDAYS        PIC S9(5).
  2441             20  PI-EPYAMT       PIC S9(7)V99.
  2442             20  PI-ERESV        PIC S9(7)V99.
  2443             20  PI-EEXPENS      PIC 9(6)V99.
  2444             20  PI-ETYPE        PIC X.
  2445             20  PI-CASH         PIC X.
  2446             20  PI-GROUPED      PIC X.
  2447             20  PI-INT-RATE     PIC S99V9(5).
  2448             20  PI-AIGFROM      PIC 9(6).
  2449             20  PI-LOAN-NO      PIC X(20).
  2450             20  PI-PROOF-DATE   PIC 9(6).
  2451             20  PI-PRINT-EOB-YN PIC X.
  2452             20  PI-PRINT-CLM-FRM-YN PIC X.
  2453             20  PI-PRINT-SURVEY-YN PIC X.
  2454         16  PI-SAVE-COMPUTED.
  2455             20  PI-CCHECKNO     PIC X(7).
  2456             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2457                 28  PI-CCHECKNO-N     PIC X.
  2458                 28  PI-CCHECKNO-6     PIC X(6).
  2459             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2460                 24  PI-CCHECKNO-CR    PIC XX.
  2461                 24  PI-CCHECKNO-5     PIC X(5).
  2462             20  PI-CPYFROM      PIC XX.
  2463             20  PI-CPYTHRU      PIC XX.
  2464             20  PI-CDAYS        PIC S9(5).
  2465             20  PI-CPYAMT       PIC S9(7)V99.
  2466             20  PI-CRESV        PIC 9(6)V99.
  2467             20  PI-CEXPENS      PIC 9(6)V99.
  2468             20  PI-PMT-APPR-SW  PIC X.
  2469                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  51
* EL156.cbl
  2470                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2471                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2472         16  PI-PREV-CLMNO       PIC X(7).
  2473         16  PI-LF-COVERAGE-TYPE PIC X.
  2474         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2475         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2476         16  PI-PROVISIONAL-IND  PIC X.
  2477             88 PI-PROV-PMT      VALUE 'P'.
  2478         16  PI-PREV-TRLR-KEY    PIC X(22).
  2479         16  PI-SPLIT-PMT-SW     PIC X.
  2480         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2481         16  PI-ACTIVITY-CODE    PIC 99.
  2482         16  PI-RESET-SW         PIC X.
  2483         16  PI-SPECIAL-BEN-SW   PIC X.
  2484             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2485         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2486         16  PI-EXP-DT           PIC XX.
  2487         16  PI-LOAN-DUE-DAY     PIC 99.
  2488         16  PI-3RD-PARTY-SW     PIC X.
  2489         16  PI-LOAN-UPDATE-SW   PIC X.
  2490
  2491         16  PI-DMD-DATA.
  2492             20  PI-SV-CERT-KEY       PIC X(21).
  2493             20  PI-SV-CERT-NO        PIC X(11).
  2494             20  PI-SV-BEN            PIC X(10).
  2495             20  PI-SV-CCN            PIC X(16).
  2496             20  PI-INTEREST-PAID-IND PIC X.
  2497                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2498             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2499             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2500             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2501             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2502         16  PI-AT-EOB-CODES.
  2503             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2504         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2505         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2506         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2507         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2508         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2509         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2510         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2511         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2512         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2513         16  PI-LF-BENEFIT-CD         PIC X(2).
  2514         16  PI-EOB-CODES-EXIST PIC X.
  2515         16  PI-SET-NOTE2-MDT   PIC X.
  2516         16  PI-VFY-2ND-BENE          PIC X.
  2517         16  PI-CLM-TYPE              PIC X.
  2518         16  PI-APPROVAL-LEVEL        PIC X.
  2519         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2520         16  PI-REAUDIT-NEEDED        PIC X.
  2521         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2522         16  PI-AH-BENEFIT-CD         PIC XX.
  2523*00781          16  FILLER                   PIC X(176).
  2524*052506         16  FILLER                   PIC X(161).
  2525*031808         16  FILLER                   PIC X(154).
  2526*091808         16  FILLER                   PIC X(152).
  2527*041710         16  FILLER                   PIC X(94).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  52
* EL156.cbl
  2528         16  FILLER                   PIC X(82).
  2529
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  53
* EL156.cbl
  2531*    COPY ELCJPFX.
  2532******************************************************************
  2533*                                                                *
  2534*                                                                *
  2535*                            ELCJPFX.                            *
  2536*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2537*                            VMOD=2.002                          *
  2538*                                                                *
  2539*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2540*                                                                *
  2541*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2542*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2543*        ELCNTL - CONTROL FILE                                   *
  2544*        ELMSTR - CLAIM MASTERS                                  *
  2545*        ELTRLR - ACTIVITY TRAILERS                              *
  2546*        ELCHKQ - CHECK QUE                                      *
  2547******************************************************************
  2548 01  JOURNAL-RECORD.
  2549     12  jp-date                     pic s9(5) comp-3.
  2550     12  jp-time                     pic s9(7) comp-3.
  2551     12  JP-USER-ID                  PIC X(4).
  2552     12  JP-FILE-ID                  PIC X(8).
  2553     12  JP-PROGRAM-ID               PIC X(8).
  2554     12  JP-RECORD-TYPE              PIC X.
  2555         88 JP-ADD              VALUE 'A'.
  2556         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2557         88 JP-AFTER-CHANGE     VALUE 'C'.
  2558         88 JP-DELETE           VALUE 'D'.
  2559         88 JP-GENERIC-DELETE   VALUE 'G'.
  2560         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2561         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2562     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2563     12  JP-RECORD-AREA
  2564
  2565
  2566                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  54
* EL156.cbl
  2568*    COPY ELCAID.
  2569******************************************************************
  2570*                                                                *
  2571*                            ELCAID.                             *
  2572*                            VMOD=2.001                          *
  2573*                                                                *
  2574*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2575*                                                                *
  2576*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2577*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2578******************************************************************
  2579
  2580 01  DFHAID.
  2581   02  DFHNULL   PIC  X  VALUE  ' '.
  2582   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2583   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2584   02  DFHPEN    PIC  X  VALUE  '='.
  2585   02  DFHOPID   PIC  X  VALUE  'W'.
  2586   02  DFHPA1    PIC  X  VALUE  '%'.
  2587   02  DFHPA2    PIC  X  VALUE  '>'.
  2588   02  DFHPA3    PIC  X  VALUE  ','.
  2589   02  DFHPF1    PIC  X  VALUE  '1'.
  2590   02  DFHPF2    PIC  X  VALUE  '2'.
  2591   02  DFHPF3    PIC  X  VALUE  '3'.
  2592   02  DFHPF4    PIC  X  VALUE  '4'.
  2593   02  DFHPF5    PIC  X  VALUE  '5'.
  2594   02  DFHPF6    PIC  X  VALUE  '6'.
  2595   02  DFHPF7    PIC  X  VALUE  '7'.
  2596   02  DFHPF8    PIC  X  VALUE  '8'.
  2597   02  DFHPF9    PIC  X  VALUE  '9'.
  2598   02  DFHPF10   PIC  X  VALUE  ':'.
  2599   02  DFHPF11   PIC  X  VALUE  '#'.
  2600   02  DFHPF12   PIC  X  VALUE  '@'.
  2601   02  DFHPF13   PIC  X  VALUE  'A'.
  2602   02  DFHPF14   PIC  X  VALUE  'B'.
  2603   02  DFHPF15   PIC  X  VALUE  'C'.
  2604   02  DFHPF16   PIC  X  VALUE  'D'.
  2605   02  DFHPF17   PIC  X  VALUE  'E'.
  2606   02  DFHPF18   PIC  X  VALUE  'F'.
  2607   02  DFHPF19   PIC  X  VALUE  'G'.
  2608   02  DFHPF20   PIC  X  VALUE  'H'.
  2609   02  DFHPF21   PIC  X  VALUE  'I'.
  2610*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2611   02  DFHPF22   PIC  X  VALUE  '['.
  2612   02  DFHPF23   PIC  X  VALUE  '.'.
  2613   02  DFHPF24   PIC  X  VALUE  '<'.
  2614   02  DFHMSRE   PIC  X  VALUE  'X'.
  2615   02  DFHSTRF   PIC  X  VALUE  'h'.
  2616   02  DFHTRIG   PIC  X  VALUE  '"'.
  2617 01  FILLER    REDEFINES DFHAID.
  2618     12  FILLER              PIC X(8).
  2619     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  55
* EL156.cbl
  2621*    COPY EL156S.
  2622 01  EL156AI.
  2623     05  FILLER            PIC  X(0012).
  2624*    -------------------------------
  2625     05  RUNDTEAL PIC S9(0004) COMP.
  2626     05  RUNDTEAF PIC  X(0001).
  2627     05  FILLER REDEFINES RUNDTEAF.
  2628         10  RUNDTEAA PIC  X(0001).
  2629     05  RUNDTEAI PIC  X(0008).
  2630*    -------------------------------
  2631     05  RUNTIMAL PIC S9(0004) COMP.
  2632     05  RUNTIMAF PIC  X(0001).
  2633     05  FILLER REDEFINES RUNTIMAF.
  2634         10  RUNTIMAA PIC  X(0001).
  2635     05  RUNTIMAI PIC  X(0005).
  2636*    -------------------------------
  2637     05  SEQUL PIC S9(0004) COMP.
  2638     05  SEQUF PIC  X(0001).
  2639     05  FILLER REDEFINES SEQUF.
  2640         10  SEQUA PIC  X(0001).
  2641     05  SEQUI PIC  X(0010).
  2642*    -------------------------------
  2643     05  CLMNOL PIC S9(0004) COMP.
  2644     05  CLMNOF PIC  X(0001).
  2645     05  FILLER REDEFINES CLMNOF.
  2646         10  CLMNOA PIC  X(0001).
  2647     05  CLMNOI PIC  X(0007).
  2648*    -------------------------------
  2649     05  CARRL PIC S9(0004) COMP.
  2650     05  CARRF PIC  X(0001).
  2651     05  FILLER REDEFINES CARRF.
  2652         10  CARRA PIC  X(0001).
  2653     05  CARRI PIC  X(0001).
  2654*    -------------------------------
  2655     05  CERTNOL PIC S9(0004) COMP.
  2656     05  CERTNOF PIC  X(0001).
  2657     05  FILLER REDEFINES CERTNOF.
  2658         10  CERTNOA PIC  X(0001).
  2659     05  CERTNOI PIC  X(0010).
  2660*    -------------------------------
  2661     05  SUFXL PIC S9(0004) COMP.
  2662     05  SUFXF PIC  X(0001).
  2663     05  FILLER REDEFINES SUFXF.
  2664         10  SUFXA PIC  X(0001).
  2665     05  SUFXI PIC  X(0001).
  2666*    -------------------------------
  2667     05  CLMTYPL PIC S9(0004) COMP.
  2668     05  CLMTYPF PIC  X(0001).
  2669     05  FILLER REDEFINES CLMTYPF.
  2670         10  CLMTYPA PIC  X(0001).
  2671     05  CLMTYPI PIC  X(0006).
  2672*    -------------------------------
  2673     05  CLMSTATL PIC S9(0004) COMP.
  2674     05  CLMSTATF PIC  X(0001).
  2675     05  FILLER REDEFINES CLMSTATF.
  2676         10  CLMSTATA PIC  X(0001).
  2677     05  CLMSTATI PIC  X(0006).
  2678*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  56
* EL156.cbl
  2679     05  LSTNMEL PIC S9(0004) COMP.
  2680     05  LSTNMEF PIC  X(0001).
  2681     05  FILLER REDEFINES LSTNMEF.
  2682         10  LSTNMEA PIC  X(0001).
  2683     05  LSTNMEI PIC  X(0015).
  2684*    -------------------------------
  2685     05  FSTNMEL PIC S9(0004) COMP.
  2686     05  FSTNMEF PIC  X(0001).
  2687     05  FILLER REDEFINES FSTNMEF.
  2688         10  FSTNMEA PIC  X(0001).
  2689     05  FSTNMEI PIC  X(0012).
  2690*    -------------------------------
  2691     05  MINITL PIC S9(0004) COMP.
  2692     05  MINITF PIC  X(0001).
  2693     05  FILLER REDEFINES MINITF.
  2694         10  MINITA PIC  X(0001).
  2695     05  MINITI PIC  X(0001).
  2696*    -------------------------------
  2697     05  PRIMHDGL PIC S9(0004) COMP.
  2698     05  PRIMHDGF PIC  X(0001).
  2699     05  FILLER REDEFINES PRIMHDGF.
  2700         10  PRIMHDGA PIC  X(0001).
  2701     05  PRIMHDGI PIC  X(0012).
  2702*    -------------------------------
  2703     05  PCERTNOL PIC S9(0004) COMP.
  2704     05  PCERTNOF PIC  X(0001).
  2705     05  FILLER REDEFINES PCERTNOF.
  2706         10  PCERTNOA PIC  X(0001).
  2707     05  PCERTNOI PIC  X(0010).
  2708*    -------------------------------
  2709     05  PSUFXL PIC S9(0004) COMP.
  2710     05  PSUFXF PIC  X(0001).
  2711     05  FILLER REDEFINES PSUFXF.
  2712         10  PSUFXA PIC  X(0001).
  2713     05  PSUFXI PIC  X(0001).
  2714*    -------------------------------
  2715     05  STATUSL PIC S9(0004) COMP.
  2716     05  STATUSF PIC  X(0001).
  2717     05  FILLER REDEFINES STATUSF.
  2718         10  STATUSA PIC  X(0001).
  2719     05  STATUSI PIC  X(0010).
  2720*    -------------------------------
  2721     05  LOANHL PIC S9(0004) COMP.
  2722     05  LOANHF PIC  X(0001).
  2723     05  FILLER REDEFINES LOANHF.
  2724         10  LOANHA PIC  X(0001).
  2725     05  LOANHI PIC  X(0014).
  2726*    -------------------------------
  2727     05  LOANNOL PIC S9(0004) COMP.
  2728     05  LOANNOF PIC  X(0001).
  2729     05  FILLER REDEFINES LOANNOF.
  2730         10  LOANNOA PIC  X(0001).
  2731     05  LOANNOI PIC  X(0025).
  2732*    -------------------------------
  2733     05  DUEDAYHL PIC S9(0004) COMP.
  2734     05  DUEDAYHF PIC  X(0001).
  2735     05  FILLER REDEFINES DUEDAYHF.
  2736         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  57
* EL156.cbl
  2737     05  DUEDAYHI PIC  X(0008).
  2738*    -------------------------------
  2739     05  DUEDAYL PIC S9(0004) COMP.
  2740     05  DUEDAYF PIC  X(0001).
  2741     05  FILLER REDEFINES DUEDAYF.
  2742         10  DUEDAYA PIC  X(0001).
  2743     05  DUEDAYI PIC  X(0002).
  2744*    -------------------------------
  2745     05  ZINTHL PIC S9(0004) COMP.
  2746     05  ZINTHF PIC  X(0001).
  2747     05  FILLER REDEFINES ZINTHF.
  2748         10  ZINTHA PIC  X(0001).
  2749     05  ZINTHI PIC  X(0009).
  2750*    -------------------------------
  2751     05  ZINTL PIC S9(0004) COMP.
  2752     05  ZINTF PIC  X(0001).
  2753     05  FILLER REDEFINES ZINTF.
  2754         10  ZINTA PIC  X(0001).
  2755     05  ZINTI PIC  99V99999.
  2756*    -------------------------------
  2757     05  PTHRHDGL PIC S9(0004) COMP.
  2758     05  PTHRHDGF PIC  X(0001).
  2759     05  FILLER REDEFINES PTHRHDGF.
  2760         10  PTHRHDGA PIC  X(0001).
  2761     05  PTHRHDGI PIC  X(0014).
  2762*    -------------------------------
  2763     05  PDTHRUL PIC S9(0004) COMP.
  2764     05  PDTHRUF PIC  X(0001).
  2765     05  FILLER REDEFINES PDTHRUF.
  2766         10  PDTHRUA PIC  X(0001).
  2767     05  PDTHRUI PIC  X(0008).
  2768*    -------------------------------
  2769     05  TOTPAIDL PIC S9(0004) COMP.
  2770     05  TOTPAIDF PIC  X(0001).
  2771     05  FILLER REDEFINES TOTPAIDF.
  2772         10  TOTPAIDA PIC  X(0001).
  2773     05  TOTPAIDI PIC  X(0010).
  2774*    -------------------------------
  2775     05  COVERL PIC S9(0004) COMP.
  2776     05  COVERF PIC  X(0001).
  2777     05  FILLER REDEFINES COVERF.
  2778         10  COVERA PIC  X(0001).
  2779     05  COVERI PIC  X(0010).
  2780*    -------------------------------
  2781     05  INCURL PIC S9(0004) COMP.
  2782     05  INCURF PIC  X(0001).
  2783     05  FILLER REDEFINES INCURF.
  2784         10  INCURA PIC  X(0001).
  2785     05  INCURI PIC  X(0008).
  2786*    -------------------------------
  2787     05  LSTDTEL PIC S9(0004) COMP.
  2788     05  LSTDTEF PIC  X(0001).
  2789     05  FILLER REDEFINES LSTDTEF.
  2790         10  LSTDTEA PIC  X(0001).
  2791     05  LSTDTEI PIC  X(0008).
  2792*    -------------------------------
  2793     05  CRTSTATL PIC S9(0004) COMP.
  2794     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  58
* EL156.cbl
  2795     05  FILLER REDEFINES CRTSTATF.
  2796         10  CRTSTATA PIC  X(0001).
  2797     05  CRTSTATI PIC  X(0010).
  2798*    -------------------------------
  2799     05  EFFECTL PIC S9(0004) COMP.
  2800     05  EFFECTF PIC  X(0001).
  2801     05  FILLER REDEFINES EFFECTF.
  2802         10  EFFECTA PIC  X(0001).
  2803     05  EFFECTI PIC  X(0008).
  2804*    -------------------------------
  2805     05  TERMSL PIC S9(0004) COMP.
  2806     05  TERMSF PIC  X(0001).
  2807     05  FILLER REDEFINES TERMSF.
  2808         10  TERMSA PIC  X(0001).
  2809     05  TERMSI PIC  X(0011).
  2810*    -------------------------------
  2811     05  STACCTL PIC S9(0004) COMP.
  2812     05  STACCTF PIC  X(0001).
  2813     05  FILLER REDEFINES STACCTF.
  2814         10  STACCTA PIC  X(0001).
  2815     05  STACCTI PIC  X(0013).
  2816*    -------------------------------
  2817     05  EXPDTEHL PIC S9(0004) COMP.
  2818     05  EXPDTEHF PIC  X(0001).
  2819     05  FILLER REDEFINES EXPDTEHF.
  2820         10  EXPDTEHA PIC  X(0001).
  2821     05  EXPDTEHI PIC  X(0014).
  2822*    -------------------------------
  2823     05  EXPDTEL PIC S9(0004) COMP.
  2824     05  EXPDTEF PIC  X(0001).
  2825     05  FILLER REDEFINES EXPDTEF.
  2826         10  EXPDTEA PIC  X(0001).
  2827     05  EXPDTEI PIC  X(0008).
  2828*    -------------------------------
  2829     05  BENECAPL PIC S9(0004) COMP.
  2830     05  BENECAPF PIC  X(0001).
  2831     05  FILLER REDEFINES BENECAPF.
  2832         10  BENECAPA PIC  X(0001).
  2833     05  BENECAPI PIC  X(0013).
  2834*    -------------------------------
  2835     05  BENEL PIC S9(0004) COMP.
  2836     05  BENEF PIC  X(0001).
  2837     05  FILLER REDEFINES BENEF.
  2838         10  BENEA PIC  X(0001).
  2839     05  BENEI PIC  X(0009).
  2840*    -------------------------------
  2841     05  FORMTYPL PIC S9(0004) COMP.
  2842     05  FORMTYPF PIC  X(0001).
  2843     05  FILLER REDEFINES FORMTYPF.
  2844         10  FORMTYPA PIC  X(0001).
  2845     05  FORMTYPI PIC  X(0001).
  2846*    -------------------------------
  2847     05  PMTTYPEL PIC S9(0004) COMP.
  2848     05  PMTTYPEF PIC  X(0001).
  2849     05  FILLER REDEFINES PMTTYPEF.
  2850         10  PMTTYPEA PIC  X(0001).
  2851     05  PMTTYPEI PIC  X(0001).
  2852*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  59
* EL156.cbl
  2853     05  PAYEEL PIC S9(0004) COMP.
  2854     05  PAYEEF PIC  X(0001).
  2855     05  FILLER REDEFINES PAYEEF.
  2856         10  PAYEEA PIC  X(0001).
  2857     05  PAYEEI PIC  X(0002).
  2858*    -------------------------------
  2859     05  CHECKNOL PIC S9(0004) COMP.
  2860     05  CHECKNOF PIC  X(0001).
  2861     05  FILLER REDEFINES CHECKNOF.
  2862         10  CHECKNOA PIC  X(0001).
  2863     05  CHECKNOI PIC  X(0007).
  2864*    -------------------------------
  2865     05  OFFLINEL PIC S9(0004) COMP.
  2866     05  OFFLINEF PIC  X(0001).
  2867     05  FILLER REDEFINES OFFLINEF.
  2868         10  OFFLINEA PIC  X(0001).
  2869     05  OFFLINEI PIC  X(0001).
  2870*    -------------------------------
  2871     05  HOLDTILL PIC S9(0004) COMP.
  2872     05  HOLDTILF PIC  X(0001).
  2873     05  FILLER REDEFINES HOLDTILF.
  2874         10  HOLDTILA PIC  X(0001).
  2875     05  HOLDTILI PIC  X(0008).
  2876*    -------------------------------
  2877     05  NOTE1L PIC S9(0004) COMP.
  2878     05  NOTE1F PIC  X(0001).
  2879     05  FILLER REDEFINES NOTE1F.
  2880         10  NOTE1A PIC  X(0001).
  2881     05  NOTE1I PIC  X(0060).
  2882*    -------------------------------
  2883     05  NOTE2L PIC S9(0004) COMP.
  2884     05  NOTE2F PIC  X(0001).
  2885     05  FILLER REDEFINES NOTE2F.
  2886         10  NOTE2A PIC  X(0001).
  2887     05  NOTE2I PIC  X(0060).
  2888*    -------------------------------
  2889     05  EOBYNL PIC S9(0004) COMP.
  2890     05  EOBYNF PIC  X(0001).
  2891     05  FILLER REDEFINES EOBYNF.
  2892         10  EOBYNA PIC  X(0001).
  2893     05  EOBYNI PIC  X(0001).
  2894*    -------------------------------
  2895     05  CLMFMYNL PIC S9(0004) COMP.
  2896     05  CLMFMYNF PIC  X(0001).
  2897     05  FILLER REDEFINES CLMFMYNF.
  2898         10  CLMFMYNA PIC  X(0001).
  2899     05  CLMFMYNI PIC  X(0001).
  2900*    -------------------------------
  2901     05  SURVYYNL PIC S9(0004) COMP.
  2902     05  SURVYYNF PIC  X(0001).
  2903     05  FILLER REDEFINES SURVYYNF.
  2904         10  SURVYYNA PIC  X(0001).
  2905     05  SURVYYNI PIC  X(0001).
  2906*    -------------------------------
  2907     05  PINTHL PIC S9(0004) COMP.
  2908     05  PINTHF PIC  X(0001).
  2909     05  FILLER REDEFINES PINTHF.
  2910         10  PINTHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  60
* EL156.cbl
  2911     05  PINTHI PIC  X(0004).
  2912*    -------------------------------
  2913     05  PINTL PIC S9(0004) COMP.
  2914     05  PINTF PIC  X(0001).
  2915     05  FILLER REDEFINES PINTF.
  2916         10  PINTA PIC  X(0001).
  2917     05  PINTI PIC  X(0008).
  2918*    -------------------------------
  2919     05  PROOFDTL PIC S9(0004) COMP.
  2920     05  PROOFDTF PIC  X(0001).
  2921     05  FILLER REDEFINES PROOFDTF.
  2922         10  PROOFDTA PIC  X(0001).
  2923     05  PROOFDTI PIC  X(0008).
  2924*    -------------------------------
  2925     05  AIGFRMHL PIC S9(0004) COMP.
  2926     05  AIGFRMHF PIC  X(0001).
  2927     05  FILLER REDEFINES AIGFRMHF.
  2928         10  AIGFRMHA PIC  X(0001).
  2929     05  AIGFRMHI PIC  X(0012).
  2930*    -------------------------------
  2931     05  AIGFROML PIC S9(0004) COMP.
  2932     05  AIGFROMF PIC  X(0001).
  2933     05  FILLER REDEFINES AIGFROMF.
  2934         10  AIGFROMA PIC  X(0001).
  2935     05  AIGFROMI PIC  X(0008).
  2936*    -------------------------------
  2937     05  PMTHDGAL PIC S9(0004) COMP.
  2938     05  PMTHDGAF PIC  X(0001).
  2939     05  FILLER REDEFINES PMTHDGAF.
  2940         10  PMTHDGAA PIC  X(0001).
  2941     05  PMTHDGAI PIC  X(0066).
  2942*    -------------------------------
  2943     05  EPYFROML PIC S9(0004) COMP.
  2944     05  EPYFROMF PIC  X(0001).
  2945     05  FILLER REDEFINES EPYFROMF.
  2946         10  EPYFROMA PIC  X(0001).
  2947     05  EPYFROMI PIC  X(0008).
  2948*    -------------------------------
  2949     05  EPYTHRUL PIC S9(0004) COMP.
  2950     05  EPYTHRUF PIC  X(0001).
  2951     05  FILLER REDEFINES EPYTHRUF.
  2952         10  EPYTHRUA PIC  X(0001).
  2953     05  EPYTHRUI PIC  X(0008).
  2954*    -------------------------------
  2955     05  EDAYSL PIC S9(0004) COMP.
  2956     05  EDAYSF PIC  X(0001).
  2957     05  FILLER REDEFINES EDAYSF.
  2958         10  EDAYSA PIC  X(0001).
  2959     05  EDAYSI PIC  S9(6).
  2960*    -------------------------------
  2961     05  EPYAMTL PIC S9(0004) COMP.
  2962     05  EPYAMTF PIC  X(0001).
  2963     05  FILLER REDEFINES EPYAMTF.
  2964         10  EPYAMTA PIC  X(0001).
  2965     05  EPYAMTI PIC  S9(8)V99.
  2966*    -------------------------------
  2967     05  ERESVL PIC S9(0004) COMP.
  2968     05  ERESVF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  61
* EL156.cbl
  2969     05  FILLER REDEFINES ERESVF.
  2970         10  ERESVA PIC  X(0001).
  2971     05  ERESVI PIC  S9(7)V99.
  2972*    -------------------------------
  2973     05  ETYPEL PIC S9(0004) COMP.
  2974     05  ETYPEF PIC  X(0001).
  2975     05  FILLER REDEFINES ETYPEF.
  2976         10  ETYPEA PIC  X(0001).
  2977     05  ETYPEI PIC  X(0001).
  2978*    -------------------------------
  2979     05  EEXPENSL PIC S9(0004) COMP.
  2980     05  EEXPENSF PIC  X(0001).
  2981     05  FILLER REDEFINES EEXPENSF.
  2982         10  EEXPENSA PIC  X(0001).
  2983     05  EEXPENSI PIC  9(6)V99.
  2984*    -------------------------------
  2985     05  CPYFROML PIC S9(0004) COMP.
  2986     05  CPYFROMF PIC  X(0001).
  2987     05  FILLER REDEFINES CPYFROMF.
  2988         10  CPYFROMA PIC  X(0001).
  2989     05  CPYFROMI PIC  X(0008).
  2990*    -------------------------------
  2991     05  CPYTHRUL PIC S9(0004) COMP.
  2992     05  CPYTHRUF PIC  X(0001).
  2993     05  FILLER REDEFINES CPYTHRUF.
  2994         10  CPYTHRUA PIC  X(0001).
  2995     05  CPYTHRUI PIC  X(0008).
  2996*    -------------------------------
  2997     05  CDAYSL PIC S9(0004) COMP.
  2998     05  CDAYSF PIC  X(0001).
  2999     05  FILLER REDEFINES CDAYSF.
  3000         10  CDAYSA PIC  X(0001).
  3001     05  CDAYSI PIC  9(6).
  3002*    -------------------------------
  3003     05  CPYAMTL PIC S9(0004) COMP.
  3004     05  CPYAMTF PIC  X(0001).
  3005     05  FILLER REDEFINES CPYAMTF.
  3006         10  CPYAMTA PIC  X(0001).
  3007     05  CPYAMTI PIC  S9(8)V99.
  3008*    -------------------------------
  3009     05  CRESVL PIC S9(0004) COMP.
  3010     05  CRESVF PIC  X(0001).
  3011     05  FILLER REDEFINES CRESVF.
  3012         10  CRESVA PIC  X(0001).
  3013     05  CRESVI PIC  9(6)V99.
  3014*    -------------------------------
  3015     05  CEXPENSL PIC S9(0004) COMP.
  3016     05  CEXPENSF PIC  X(0001).
  3017     05  FILLER REDEFINES CEXPENSF.
  3018         10  CEXPENSA PIC  X(0001).
  3019     05  CEXPENSI PIC  9(6)V99.
  3020*    -------------------------------
  3021     05  ERRMSG0L PIC S9(0004) COMP.
  3022     05  ERRMSG0F PIC  X(0001).
  3023     05  FILLER REDEFINES ERRMSG0F.
  3024         10  ERRMSG0A PIC  X(0001).
  3025     05  ERRMSG0I PIC  X(0072).
  3026*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  62
* EL156.cbl
  3027     05  ERRMSG1L PIC S9(0004) COMP.
  3028     05  ERRMSG1F PIC  X(0001).
  3029     05  FILLER REDEFINES ERRMSG1F.
  3030         10  ERRMSG1A PIC  X(0001).
  3031     05  ERRMSG1I PIC  X(0072).
  3032*    -------------------------------
  3033     05  ERRMSG2L PIC S9(0004) COMP.
  3034     05  ERRMSG2F PIC  X(0001).
  3035     05  FILLER REDEFINES ERRMSG2F.
  3036         10  ERRMSG2A PIC  X(0001).
  3037     05  ERRMSG2I PIC  X(0072).
  3038*    -------------------------------
  3039     05  ENTERPFL PIC S9(0004) COMP.
  3040     05  ENTERPFF PIC  X(0001).
  3041     05  FILLER REDEFINES ENTERPFF.
  3042         10  ENTERPFA PIC  X(0001).
  3043     05  ENTERPFI PIC  99.
  3044*    -------------------------------
  3045     05  PF6TITL PIC S9(0004) COMP.
  3046     05  PF6TITF PIC  X(0001).
  3047     05  FILLER REDEFINES PF6TITF.
  3048         10  PF6TITA PIC  X(0001).
  3049     05  PF6TITI PIC  X(0016).
  3050 01  EL156AO REDEFINES EL156AI.
  3051     05  FILLER            PIC  X(0012).
  3052*    -------------------------------
  3053     05  FILLER            PIC  X(0003).
  3054     05  RUNDTEAO PIC  X(0008).
  3055*    -------------------------------
  3056     05  FILLER            PIC  X(0003).
  3057     05  RUNTIMAO PIC  99.99.
  3058*    -------------------------------
  3059     05  FILLER            PIC  X(0003).
  3060     05  SEQUO PIC  X(0010).
  3061*    -------------------------------
  3062     05  FILLER            PIC  X(0003).
  3063     05  CLMNOO PIC  X(0007).
  3064*    -------------------------------
  3065     05  FILLER            PIC  X(0003).
  3066     05  CARRO PIC  X(0001).
  3067*    -------------------------------
  3068     05  FILLER            PIC  X(0003).
  3069     05  CERTNOO PIC  X(0010).
  3070*    -------------------------------
  3071     05  FILLER            PIC  X(0003).
  3072     05  SUFXO PIC  X(0001).
  3073*    -------------------------------
  3074     05  FILLER            PIC  X(0003).
  3075     05  CLMTYPO PIC  X(0006).
  3076*    -------------------------------
  3077     05  FILLER            PIC  X(0003).
  3078     05  CLMSTATO PIC  X(0006).
  3079*    -------------------------------
  3080     05  FILLER            PIC  X(0003).
  3081     05  LSTNMEO PIC  X(0015).
  3082*    -------------------------------
  3083     05  FILLER            PIC  X(0003).
  3084     05  FSTNMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  63
* EL156.cbl
  3085*    -------------------------------
  3086     05  FILLER            PIC  X(0003).
  3087     05  MINITO PIC  X(0001).
  3088*    -------------------------------
  3089     05  FILLER            PIC  X(0003).
  3090     05  PRIMHDGO PIC  X(0012).
  3091*    -------------------------------
  3092     05  FILLER            PIC  X(0003).
  3093     05  PCERTNOO PIC  X(0010).
  3094*    -------------------------------
  3095     05  FILLER            PIC  X(0003).
  3096     05  PSUFXO PIC  X(0001).
  3097*    -------------------------------
  3098     05  FILLER            PIC  X(0003).
  3099     05  STATUSO PIC  X(0010).
  3100*    -------------------------------
  3101     05  FILLER            PIC  X(0003).
  3102     05  LOANHO PIC  X(0014).
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  LOANNOO PIC  X(0025).
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  DUEDAYHO PIC  X(0008).
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  DUEDAYO PIC  X(0002).
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  ZINTHO PIC  X(0009).
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  ZINTO PIC  9.99999.
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  PTHRHDGO PIC  X(0014).
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  PDTHRUO PIC  X(0008).
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  TOTPAIDO PIC  Z(6).99-.
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  COVERO PIC  X(0010).
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  INCURO PIC  X(0008).
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  LSTDTEO PIC  X(0008).
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  CRTSTATO PIC  X(0010).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  EFFECTO PIC  X(0008).
  3142*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  64
* EL156.cbl
  3143     05  FILLER            PIC  X(0003).
  3144     05  TERMSO PIC  X(0011).
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  STACCTO PIC  X(0013).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  EXPDTEHO PIC  X(0014).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  EXPDTEO PIC  X(0008).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  BENECAPO PIC  X(0013).
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  BENEO PIC  Z(6).99.
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  FORMTYPO PIC  X(0001).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  PMTTYPEO PIC  X(0001).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  PAYEEO PIC  X(0002).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  CHECKNOO PIC  X(0007).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  OFFLINEO PIC  X(0001).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  HOLDTILO PIC  99B99B99.
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  NOTE1O PIC  X(0060).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  NOTE2O PIC  X(0060).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  EOBYNO PIC  X(0001).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  CLMFMYNO PIC  X(0001).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  SURVYYNO PIC  X(0001).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  PINTHO PIC  X(0004).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  PINTO PIC  Z,ZZ9.99.
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  65
* EL156.cbl
  3201     05  PROOFDTO PIC  99B99B99.
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  AIGFRMHO PIC  X(0012).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  AIGFROMO PIC  99B99B99.
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  PMTHDGAO PIC  X(0066).
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  EPYFROMO PIC  99B99B99.
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  EPYTHRUO PIC  99B99B99.
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  EDAYSO PIC  Z(4)9-.
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  EPYAMTO PIC  Z(6).99-.
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  ERESVO PIC  Z(5).99-.
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  ETYPEO PIC  X(0001).
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  EEXPENSO PIC  Z(5).99.
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  CPYFROMO PIC  99B99B99.
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  CPYTHRUO PIC  99B99B99.
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  CDAYSO PIC  Z(4)9-.
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  CPYAMTO PIC  Z(6).99-.
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  CRESVO PIC  Z(5).99.
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  CEXPENSO PIC  Z(5).99.
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  ERRMSG0O PIC  X(0072).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  ERRMSG1O PIC  X(0072).
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  ERRMSG2O PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  66
* EL156.cbl
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  ENTERPFO PIC  X(0002).
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  PF6TITO PIC  X(0016).
  3265*    -------------------------------
  3266 01  EL156BI REDEFINES EL156AI.
  3267     05  FILLER            PIC  X(0012).
  3268*    -------------------------------
  3269     05  RUNDTEBL PIC S9(0004) COMP.
  3270     05  RUNDTEBF PIC  X(0001).
  3271     05  FILLER REDEFINES RUNDTEBF.
  3272         10  RUNDTEBA PIC  X(0001).
  3273     05  RUNDTEBI PIC  X(0008).
  3274*    -------------------------------
  3275     05  RUNTIMBL PIC S9(0004) COMP.
  3276     05  RUNTIMBF PIC  X(0001).
  3277     05  FILLER REDEFINES RUNTIMBF.
  3278         10  RUNTIMBA PIC  X(0001).
  3279     05  RUNTIMBI PIC  X(0005).
  3280*    -------------------------------
  3281     05  PAYDTBL PIC S9(0004) COMP.
  3282     05  PAYDTBF PIC  X(0001).
  3283     05  FILLER REDEFINES PAYDTBF.
  3284         10  PAYDTBA PIC  X(0001).
  3285     05  PAYDTBI PIC  X(0008).
  3286*    -------------------------------
  3287     05  PAYTYPBL PIC S9(0004) COMP.
  3288     05  PAYTYPBF PIC  X(0001).
  3289     05  FILLER REDEFINES PAYTYPBF.
  3290         10  PAYTYPBA PIC  X(0001).
  3291     05  PAYTYPBI PIC  X(0015).
  3292*    -------------------------------
  3293     05  PAYAMTBL PIC S9(0004) COMP.
  3294     05  PAYAMTBF PIC  X(0001).
  3295     05  FILLER REDEFINES PAYAMTBF.
  3296         10  PAYAMTBA PIC  X(0001).
  3297     05  PAYAMTBI PIC  X(0011).
  3298*    -------------------------------
  3299     05  LOANHBL PIC S9(0004) COMP.
  3300     05  LOANHBF PIC  X(0001).
  3301     05  FILLER REDEFINES LOANHBF.
  3302         10  LOANHBA PIC  X(0001).
  3303     05  LOANHBI PIC  X(0012).
  3304*    -------------------------------
  3305     05  LOANNBL PIC S9(0004) COMP.
  3306     05  LOANNBF PIC  X(0001).
  3307     05  FILLER REDEFINES LOANNBF.
  3308         10  LOANNBA PIC  X(0001).
  3309     05  LOANNBI PIC  X(0025).
  3310*    -------------------------------
  3311     05  CKNUMHDL PIC S9(0004) COMP.
  3312     05  CKNUMHDF PIC  X(0001).
  3313     05  FILLER REDEFINES CKNUMHDF.
  3314         10  CKNUMHDA PIC  X(0001).
  3315     05  CKNUMHDI PIC  X(0012).
  3316*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  67
* EL156.cbl
  3317     05  CKNUMBL PIC S9(0004) COMP.
  3318     05  CKNUMBF PIC  X(0001).
  3319     05  FILLER REDEFINES CKNUMBF.
  3320         10  CKNUMBA PIC  X(0001).
  3321     05  CKNUMBI PIC  X(0007).
  3322*    -------------------------------
  3323     05  AGTHDGL PIC S9(0004) COMP.
  3324     05  AGTHDGF PIC  X(0001).
  3325     05  FILLER REDEFINES AGTHDGF.
  3326         10  AGTHDGA PIC  X(0001).
  3327     05  AGTHDGI PIC  X(0016).
  3328*    -------------------------------
  3329     05  NAMEBL PIC S9(0004) COMP.
  3330     05  NAMEBF PIC  X(0001).
  3331     05  FILLER REDEFINES NAMEBF.
  3332         10  NAMEBA PIC  X(0001).
  3333     05  NAMEBI PIC  X(0030).
  3334*    -------------------------------
  3335     05  NAMEB2L PIC S9(0004) COMP.
  3336     05  NAMEB2F PIC  X(0001).
  3337     05  FILLER REDEFINES NAMEB2F.
  3338         10  NAMEB2A PIC  X(0001).
  3339     05  NAMEB2I PIC  X(0030).
  3340*    -------------------------------
  3341     05  ADDR1BL PIC S9(0004) COMP.
  3342     05  ADDR1BF PIC  X(0001).
  3343     05  FILLER REDEFINES ADDR1BF.
  3344         10  ADDR1BA PIC  X(0001).
  3345     05  ADDR1BI PIC  X(0030).
  3346*    -------------------------------
  3347     05  ADDR1B2L PIC S9(0004) COMP.
  3348     05  ADDR1B2F PIC  X(0001).
  3349     05  FILLER REDEFINES ADDR1B2F.
  3350         10  ADDR1B2A PIC  X(0001).
  3351     05  ADDR1B2I PIC  X(0030).
  3352*    -------------------------------
  3353     05  ADDR2BL PIC S9(0004) COMP.
  3354     05  ADDR2BF PIC  X(0001).
  3355     05  FILLER REDEFINES ADDR2BF.
  3356         10  ADDR2BA PIC  X(0001).
  3357     05  ADDR2BI PIC  X(0030).
  3358*    -------------------------------
  3359     05  ADDR2B2L PIC S9(0004) COMP.
  3360     05  ADDR2B2F PIC  X(0001).
  3361     05  FILLER REDEFINES ADDR2B2F.
  3362         10  ADDR2B2A PIC  X(0001).
  3363     05  ADDR2B2I PIC  X(0030).
  3364*    -------------------------------
  3365     05  CITYSTBL PIC S9(0004) COMP.
  3366     05  CITYSTBF PIC  X(0001).
  3367     05  FILLER REDEFINES CITYSTBF.
  3368         10  CITYSTBA PIC  X(0001).
  3369     05  CITYSTBI PIC  X(0030).
  3370*    -------------------------------
  3371     05  CITYST2L PIC S9(0004) COMP.
  3372     05  CITYST2F PIC  X(0001).
  3373     05  FILLER REDEFINES CITYST2F.
  3374         10  CITYST2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  68
* EL156.cbl
  3375     05  CITYST2I PIC  X(0030).
  3376*    -------------------------------
  3377     05  ZIPBL PIC S9(0004) COMP.
  3378     05  ZIPBF PIC  X(0001).
  3379     05  FILLER REDEFINES ZIPBF.
  3380         10  ZIPBA PIC  X(0001).
  3381     05  ZIPBI PIC  X(0009).
  3382*    -------------------------------
  3383     05  ZIPB2L PIC S9(0004) COMP.
  3384     05  ZIPB2F PIC  X(0001).
  3385     05  FILLER REDEFINES ZIPB2F.
  3386         10  ZIPB2A PIC  X(0001).
  3387     05  ZIPB2I PIC  X(0009).
  3388*    -------------------------------
  3389     05  INTHDBL PIC S9(0004) COMP.
  3390     05  INTHDBF PIC  X(0001).
  3391     05  FILLER REDEFINES INTHDBF.
  3392         10  INTHDBA PIC  X(0001).
  3393     05  INTHDBI PIC  X(0012).
  3394*    -------------------------------
  3395     05  INTAMTBL PIC S9(0004) COMP.
  3396     05  INTAMTBF PIC  X(0001).
  3397     05  FILLER REDEFINES INTAMTBF.
  3398         10  INTAMTBA PIC  X(0001).
  3399     05  INTAMTBI PIC  X(0011).
  3400*    -------------------------------
  3401     05  PMTHDGBL PIC S9(0004) COMP.
  3402     05  PMTHDGBF PIC  X(0001).
  3403     05  FILLER REDEFINES PMTHDGBF.
  3404         10  PMTHDGBA PIC  X(0001).
  3405     05  PMTHDGBI PIC  X(0034).
  3406*    -------------------------------
  3407     05  CLMNOBL PIC S9(0004) COMP.
  3408     05  CLMNOBF PIC  X(0001).
  3409     05  FILLER REDEFINES CLMNOBF.
  3410         10  CLMNOBA PIC  X(0001).
  3411     05  CLMNOBI PIC  X(0007).
  3412*    -------------------------------
  3413     05  CARRBL PIC S9(0004) COMP.
  3414     05  CARRBF PIC  X(0001).
  3415     05  FILLER REDEFINES CARRBF.
  3416         10  CARRBA PIC  X(0001).
  3417     05  CARRBI PIC  X(0001).
  3418*    -------------------------------
  3419     05  CERTNOBL PIC S9(0004) COMP.
  3420     05  CERTNOBF PIC  X(0001).
  3421     05  FILLER REDEFINES CERTNOBF.
  3422         10  CERTNOBA PIC  X(0001).
  3423     05  CERTNOBI PIC  X(0010).
  3424*    -------------------------------
  3425     05  SUFXBL PIC S9(0004) COMP.
  3426     05  SUFXBF PIC  X(0001).
  3427     05  FILLER REDEFINES SUFXBF.
  3428         10  SUFXBA PIC  X(0001).
  3429     05  SUFXBI PIC  X(0001).
  3430*    -------------------------------
  3431     05  CLMTYPBL PIC S9(0004) COMP.
  3432     05  CLMTYPBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  69
* EL156.cbl
  3433     05  FILLER REDEFINES CLMTYPBF.
  3434         10  CLMTYPBA PIC  X(0001).
  3435     05  CLMTYPBI PIC  X(0006).
  3436*    -------------------------------
  3437     05  INCURBL PIC S9(0004) COMP.
  3438     05  INCURBF PIC  X(0001).
  3439     05  FILLER REDEFINES INCURBF.
  3440         10  INCURBA PIC  X(0001).
  3441     05  INCURBI PIC  X(0008).
  3442*    -------------------------------
  3443     05  PYFROMBL PIC S9(0004) COMP.
  3444     05  PYFROMBF PIC  X(0001).
  3445     05  FILLER REDEFINES PYFROMBF.
  3446         10  PYFROMBA PIC  X(0001).
  3447     05  PYFROMBI PIC  X(0008).
  3448*    -------------------------------
  3449     05  PYTHRUBL PIC S9(0004) COMP.
  3450     05  PYTHRUBF PIC  X(0001).
  3451     05  FILLER REDEFINES PYTHRUBF.
  3452         10  PYTHRUBA PIC  X(0001).
  3453     05  PYTHRUBI PIC  X(0008).
  3454*    -------------------------------
  3455     05  DAYSBL PIC S9(0004) COMP.
  3456     05  DAYSBF PIC  X(0001).
  3457     05  FILLER REDEFINES DAYSBF.
  3458         10  DAYSBA PIC  X(0001).
  3459     05  DAYSBI PIC  X(0005).
  3460*    -------------------------------
  3461     05  BYBL PIC S9(0004) COMP.
  3462     05  BYBF PIC  X(0001).
  3463     05  FILLER REDEFINES BYBF.
  3464         10  BYBA PIC  X(0001).
  3465     05  BYBI PIC  X(0004).
  3466*    -------------------------------
  3467     05  PROOFDBL PIC S9(0004) COMP.
  3468     05  PROOFDBF PIC  X(0001).
  3469     05  FILLER REDEFINES PROOFDBF.
  3470         10  PROOFDBA PIC  X(0001).
  3471     05  PROOFDBI PIC  X(0008).
  3472*    -------------------------------
  3473     05  ACCTBL PIC S9(0004) COMP.
  3474     05  ACCTBF PIC  X(0001).
  3475     05  FILLER REDEFINES ACCTBF.
  3476         10  ACCTBA PIC  X(0001).
  3477     05  ACCTBI PIC  X(0010).
  3478*    -------------------------------
  3479     05  STATEBL PIC S9(0004) COMP.
  3480     05  STATEBF PIC  X(0001).
  3481     05  FILLER REDEFINES STATEBF.
  3482         10  STATEBA PIC  X(0001).
  3483     05  STATEBI PIC  X(0002).
  3484*    -------------------------------
  3485     05  GROUPBL PIC S9(0004) COMP.
  3486     05  GROUPBF PIC  X(0001).
  3487     05  FILLER REDEFINES GROUPBF.
  3488         10  GROUPBA PIC  X(0001).
  3489     05  GROUPBI PIC  X(0006).
  3490*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  70
* EL156.cbl
  3491     05  ACARRBL PIC S9(0004) COMP.
  3492     05  ACARRBF PIC  X(0001).
  3493     05  FILLER REDEFINES ACARRBF.
  3494         10  ACARRBA PIC  X(0001).
  3495     05  ACARRBI PIC  X(0001).
  3496*    -------------------------------
  3497     05  ACCTNMBL PIC S9(0004) COMP.
  3498     05  ACCTNMBF PIC  X(0001).
  3499     05  FILLER REDEFINES ACCTNMBF.
  3500         10  ACCTNMBA PIC  X(0001).
  3501     05  ACCTNMBI PIC  X(0030).
  3502*    -------------------------------
  3503     05  UNDISBL PIC S9(0004) COMP.
  3504     05  UNDISBF PIC  X(0001).
  3505     05  FILLER REDEFINES UNDISBF.
  3506         10  UNDISBA PIC  X(0001).
  3507     05  UNDISBI PIC  X(0010).
  3508*    -------------------------------
  3509     05  RATEBL PIC S9(0004) COMP.
  3510     05  RATEBF PIC  X(0001).
  3511     05  FILLER REDEFINES RATEBF.
  3512         10  RATEBA PIC  X(0001).
  3513     05  RATEBI PIC  X(0006).
  3514*    -------------------------------
  3515     05  ERMSG1BL PIC S9(0004) COMP.
  3516     05  ERMSG1BF PIC  X(0001).
  3517     05  FILLER REDEFINES ERMSG1BF.
  3518         10  ERMSG1BA PIC  X(0001).
  3519     05  ERMSG1BI PIC  X(0072).
  3520*    -------------------------------
  3521     05  ENTPFBL PIC S9(0004) COMP.
  3522     05  ENTPFBF PIC  X(0001).
  3523     05  FILLER REDEFINES ENTPFBF.
  3524         10  ENTPFBA PIC  X(0001).
  3525     05  ENTPFBI PIC  99.
  3526 01  EL156BO REDEFINES EL156AI.
  3527     05  FILLER            PIC  X(0012).
  3528*    -------------------------------
  3529     05  FILLER            PIC  X(0003).
  3530     05  RUNDTEBO PIC  X(0008).
  3531*    -------------------------------
  3532     05  FILLER            PIC  X(0003).
  3533     05  RUNTIMBO PIC  99.99.
  3534*    -------------------------------
  3535     05  FILLER            PIC  X(0003).
  3536     05  PAYDTBO PIC  99B99B99.
  3537*    -------------------------------
  3538     05  FILLER            PIC  X(0003).
  3539     05  PAYTYPBO PIC  X(0015).
  3540*    -------------------------------
  3541     05  FILLER            PIC  X(0003).
  3542     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3543*    -------------------------------
  3544     05  FILLER            PIC  X(0003).
  3545     05  LOANHBO PIC  X(0012).
  3546*    -------------------------------
  3547     05  FILLER            PIC  X(0003).
  3548     05  LOANNBO PIC  X(0025).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  71
* EL156.cbl
  3549*    -------------------------------
  3550     05  FILLER            PIC  X(0003).
  3551     05  CKNUMHDO PIC  X(0012).
  3552*    -------------------------------
  3553     05  FILLER            PIC  X(0003).
  3554     05  CKNUMBO PIC  X(0007).
  3555*    -------------------------------
  3556     05  FILLER            PIC  X(0003).
  3557     05  AGTHDGO PIC  X(0016).
  3558*    -------------------------------
  3559     05  FILLER            PIC  X(0003).
  3560     05  NAMEBO PIC  X(0030).
  3561*    -------------------------------
  3562     05  FILLER            PIC  X(0003).
  3563     05  NAMEB2O PIC  X(0030).
  3564*    -------------------------------
  3565     05  FILLER            PIC  X(0003).
  3566     05  ADDR1BO PIC  X(0030).
  3567*    -------------------------------
  3568     05  FILLER            PIC  X(0003).
  3569     05  ADDR1B2O PIC  X(0030).
  3570*    -------------------------------
  3571     05  FILLER            PIC  X(0003).
  3572     05  ADDR2BO PIC  X(0030).
  3573*    -------------------------------
  3574     05  FILLER            PIC  X(0003).
  3575     05  ADDR2B2O PIC  X(0030).
  3576*    -------------------------------
  3577     05  FILLER            PIC  X(0003).
  3578     05  CITYSTBO PIC  X(0030).
  3579*    -------------------------------
  3580     05  FILLER            PIC  X(0003).
  3581     05  CITYST2O PIC  X(0030).
  3582*    -------------------------------
  3583     05  FILLER            PIC  X(0003).
  3584     05  ZIPBO PIC  ZZZZ99999.
  3585*    -------------------------------
  3586     05  FILLER            PIC  X(0003).
  3587     05  ZIPB2O PIC  ZZZZZZZZZ.
  3588*    -------------------------------
  3589     05  FILLER            PIC  X(0003).
  3590     05  INTHDBO PIC  X(0012).
  3591*    -------------------------------
  3592     05  FILLER            PIC  X(0003).
  3593     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3594*    -------------------------------
  3595     05  FILLER            PIC  X(0003).
  3596     05  PMTHDGBO PIC  X(0034).
  3597*    -------------------------------
  3598     05  FILLER            PIC  X(0003).
  3599     05  CLMNOBO PIC  X(0007).
  3600*    -------------------------------
  3601     05  FILLER            PIC  X(0003).
  3602     05  CARRBO PIC  X(0001).
  3603*    -------------------------------
  3604     05  FILLER            PIC  X(0003).
  3605     05  CERTNOBO PIC  X(0010).
  3606*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  72
* EL156.cbl
  3607     05  FILLER            PIC  X(0003).
  3608     05  SUFXBO PIC  X(0001).
  3609*    -------------------------------
  3610     05  FILLER            PIC  X(0003).
  3611     05  CLMTYPBO PIC  X(0006).
  3612*    -------------------------------
  3613     05  FILLER            PIC  X(0003).
  3614     05  INCURBO PIC  X(0008).
  3615*    -------------------------------
  3616     05  FILLER            PIC  X(0003).
  3617     05  PYFROMBO PIC  99B99B99.
  3618*    -------------------------------
  3619     05  FILLER            PIC  X(0003).
  3620     05  PYTHRUBO PIC  99B99B99.
  3621*    -------------------------------
  3622     05  FILLER            PIC  X(0003).
  3623     05  DAYSBO PIC  X(0005).
  3624*    -------------------------------
  3625     05  FILLER            PIC  X(0003).
  3626     05  BYBO PIC  X(0004).
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  PROOFDBO PIC  99B99B99.
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  ACCTBO PIC  X(0010).
  3633*    -------------------------------
  3634     05  FILLER            PIC  X(0003).
  3635     05  STATEBO PIC  X(0002).
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  GROUPBO PIC  X(0006).
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  ACARRBO PIC  X(0001).
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  ACCTNMBO PIC  X(0030).
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  UNDISBO PIC  ZZZ,Z99.99.
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  RATEBO PIC  ZZZ.99.
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  ERMSG1BO PIC  X(0072).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  ENTPFBO PIC  X(0002).
  3657*    -------------------------------
  3658****************************************************************
  3659*
  3660* Copyright (c) 2007 by Clerity Solutions, Inc.
  3661* All rights reserved.
  3662*
  3663****************************************************************
  3664 01  DFHEIV.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  73
* EL156.cbl
  3665   02  DFHEIV0               PIC X(35).
  3666   02  DFHEIV1               PIC X(08).
  3667   02  DFHEIV2               PIC X(08).
  3668   02  DFHEIV3               PIC X(08).
  3669   02  DFHEIV4               PIC X(06).
  3670   02  DFHEIV5               PIC X(04).
  3671   02  DFHEIV6               PIC X(04).
  3672   02  DFHEIV7               PIC X(02).
  3673   02  DFHEIV8               PIC X(02).
  3674   02  DFHEIV9               PIC X(01).
  3675   02  DFHEIV10              PIC S9(7) COMP-3.
  3676   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3677   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3678   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3679   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3680   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3681   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3682   02  DFHEIV17              PIC X(04).
  3683   02  DFHEIV18              PIC X(04).
  3684   02  DFHEIV19              PIC X(04).
  3685   02  DFHEIV20              USAGE IS POINTER.
  3686   02  DFHEIV21              USAGE IS POINTER.
  3687   02  DFHEIV22              USAGE IS POINTER.
  3688   02  DFHEIV23              USAGE IS POINTER.
  3689   02  DFHEIV24              USAGE IS POINTER.
  3690   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3691   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3692   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3693   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3694   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3695   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3696   02  FILLER                PIC X(02).
  3697   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3698   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3699   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3700   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3701   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3702 LINKAGE  SECTION.
  3703*****************************************************************
  3704*                                                               *
  3705* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3706* All rights reserved.                                          *
  3707*                                                               *
  3708*****************************************************************
  3709 01  dfheiblk.
  3710     02  eibtime          pic s9(7) comp-3.
  3711     02  eibdate          pic s9(7) comp-3.
  3712     02  eibtrnid         pic x(4).
  3713     02  eibtaskn         pic s9(7) comp-3.
  3714     02  eibtrmid         pic x(4).
  3715     02  dfheigdi         pic s9(4) comp.
  3716     02  eibcposn         pic s9(4) comp.
  3717     02  eibcalen         pic s9(4) comp.
  3718     02  eibaid           pic x(1).
  3719     02  eibfiller1       pic x(1).
  3720     02  eibfn            pic x(2).
  3721     02  eibfiller2       pic x(2).
  3722     02  eibrcode         pic x(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  74
* EL156.cbl
  3723     02  eibfiller3       pic x(2).
  3724     02  eibds            pic x(8).
  3725     02  eibreqid         pic x(8).
  3726     02  eibrsrce         pic x(8).
  3727     02  eibsync          pic x(1).
  3728     02  eibfree          pic x(1).
  3729     02  eibrecv          pic x(1).
  3730     02  eibsend          pic x(1).
  3731     02  eibatt           pic x(1).
  3732     02  eibeoc           pic x(1).
  3733     02  eibfmh           pic x(1).
  3734     02  eibcompl         pic x(1).
  3735     02  eibsig           pic x(1).
  3736     02  eibconf          pic x(1).
  3737     02  eiberr           pic x(1).
  3738     02  eibrldbk         pic x(1).
  3739     02  eiberrcd         pic x(4).
  3740     02  eibsynrb         pic x(1).
  3741     02  eibnodat         pic x(1).
  3742     02  eibfiller5       pic x(2).
  3743     02  eibresp          pic 9(09) comp.
  3744     02  eibresp2         pic 9(09) comp.
  3745     02  dfheigdj         pic s9(4) comp.
  3746     02  dfheigdk         pic s9(4) comp.
  3747 01  DFHCOMMAREA             PIC X(1024).
  3748
  3749*    COPY ELCMSTR.
  3750******************************************************************
  3751*                                                                *
  3752*                            ELCMSTR.                            *
  3753*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3754*                            VMOD=2.012                          *
  3755*                                                                *
  3756*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3757*                                                                *
  3758*   FILE TYPE = VSAM,KSDS                                        *
  3759*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3760*                                                                *
  3761*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3762*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3763*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3764*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3765*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3766*                                                 RKP=75,LEN=21  *
  3767*                                                                *
  3768*   **** NOTE ****                                               *
  3769*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3770*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3771*                                                                *
  3772*   LOG = YES                                                    *
  3773*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3774******************************************************************
  3775*                   C H A N G E   L O G
  3776*
  3777* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3778*-----------------------------------------------------------------
  3779*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3780* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  75
* EL156.cbl
  3781*-----------------------------------------------------------------
  3782* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3783* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3784* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3785******************************************************************
  3786 01  CLAIM-MASTER.
  3787     12  CL-RECORD-ID                PIC XX.
  3788         88  VALID-CL-ID         VALUE 'CL'.
  3789
  3790     12  CL-CONTROL-PRIMARY.
  3791         16  CL-COMPANY-CD           PIC X.
  3792         16  CL-CARRIER              PIC X.
  3793         16  CL-CLAIM-NO             PIC X(7).
  3794         16  CL-CERT-NO.
  3795             20  CL-CERT-PRIME       PIC X(10).
  3796             20  CL-CERT-SFX         PIC X.
  3797
  3798     12  CL-CONTROL-BY-NAME.
  3799         16  CL-COMPANY-CD-A1        PIC X.
  3800         16  CL-INSURED-LAST-NAME    PIC X(15).
  3801         16  CL-INSURED-NAME.
  3802             20  CL-INSURED-1ST-NAME PIC X(12).
  3803             20  CL-INSURED-MID-INIT PIC X.
  3804
  3805     12  CL-CONTROL-BY-SSN.
  3806         16  CL-COMPANY-CD-A2        PIC X.
  3807         16  CL-SOC-SEC-NO.
  3808             20  CL-SSN-STATE        PIC XX.
  3809             20  CL-SSN-ACCOUNT      PIC X(6).
  3810             20  CL-SSN-LN3          PIC X(3).
  3811
  3812     12  CL-CONTROL-BY-CERT-NO.
  3813         16  CL-COMPANY-CD-A4        PIC X.
  3814         16  CL-CERT-NO-A4.
  3815             20  CL-CERT-A4-PRIME    PIC X(10).
  3816             20  CL-CERT-A4-SFX      PIC X.
  3817
  3818     12  CL-CONTROL-BY-CCN.
  3819         16  CL-COMPANY-CD-A5        PIC X.
  3820         16  CL-CCN-A5.
  3821             20  CL-CCN.
  3822                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3823                 24  CL-CCN-PRIME-A5 PIC X(12).
  3824             20  CL-CCN-FILLER-A5    PIC X(4).
  3825
  3826     12  CL-INSURED-PROFILE-DATA.
  3827         16  CL-INSURED-BIRTH-DT     PIC XX.
  3828         16  CL-INSURED-SEX-CD       PIC X.
  3829             88  INSURED-IS-MALE        VALUE 'M'.
  3830             88  INSURED-IS-FEMALE      VALUE 'F'.
  3831             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3832         16  CL-INSURED-OCC-CD       PIC X(6).
  3833         16  FILLER                  PIC X(5).
  3834
  3835     12  CL-PROCESSING-INFO.
  3836         16  CL-PROCESSOR-ID         PIC X(4).
  3837         16  CL-CLAIM-STATUS         PIC X.
  3838             88  CLAIM-IS-OPEN          VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  76
* EL156.cbl
  3839             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3840         16  CL-CLAIM-TYPE           PIC X.
  3841*            88  AH-CLAIM               VALUE 'A'.
  3842*            88  LIFE-CLAIM             VALUE 'L'.
  3843*            88  PROPERTY-CLAIM         VALUE 'P'.
  3844*            88  IUI-CLAIM              VALUE 'I'.
  3845*            88  GAP-CLAIM              VALUE 'G'.
  3846         16  CL-CLAIM-PREM-TYPE      PIC X.
  3847             88  SINGLE-PREMIUM         VALUE '1'.
  3848             88  O-B-COVERAGE           VALUE '2'.
  3849             88  OPEN-END-COVERAGE      VALUE '3'.
  3850         16  CL-INCURRED-DT          PIC XX.
  3851         16  CL-REPORTED-DT          PIC XX.
  3852         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3853         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3854         16  CL-LAST-PMT-DT          PIC XX.
  3855         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3856         16  CL-PAID-THRU-DT         PIC XX.
  3857         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3858         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3859         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3860         16  CL-PMT-CALC-METHOD      PIC X.
  3861             88  CL-360-DAY-YR          VALUE '1'.
  3862             88  CL-365-DAY-YR          VALUE '2'.
  3863             88  CL-FULL-MONTHS         VALUE '3'.
  3864         16  CL-CAUSE-CD             PIC X(6).
  3865
  3866         16  CL-PRIME-CERT-NO.
  3867             20  CL-PRIME-CERT-PRIME PIC X(10).
  3868             20  CL-PRIME-CERT-SFX   PIC X.
  3869
  3870         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3871             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3872             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3873
  3874         16  CL-MICROFILM-NO         PIC X(10).
  3875         16  CL-PROG-FORM-TYPE       PIC X.
  3876         16  CL-LAST-ADD-ON-DT       PIC XX.
  3877
  3878         16  CL-LAST-REOPEN-DT       PIC XX.
  3879         16  CL-LAST-CLOSE-DT        PIC XX.
  3880         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3881             88  FINAL-PAID             VALUE '1'.
  3882             88  CLAIM-DENIED           VALUE '2'.
  3883             88  AUTO-CLOSE             VALUE '3'.
  3884             88  MANUAL-CLOSE           VALUE '4'.
  3885             88  BENEFITS-CHANGED       VALUE 'C'.
  3886             88  SETUP-ERRORS           VALUE 'E'.
  3887         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3888         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3889         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3890             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3891         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3892         16  FILLER                  PIC X.
  3893
  3894     12  CL-CERTIFICATE-DATA.
  3895         16  CL-CERT-ORIGIN          PIC X.
  3896             88  CERT-WAS-ONLINE        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  77
* EL156.cbl
  3897             88  CERT-WAS-CREATED       VALUE '2'.
  3898             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3899         16  CL-CERT-KEY-DATA.
  3900             20  CL-CERT-CARRIER     PIC X.
  3901             20  CL-CERT-GROUPING    PIC X(6).
  3902             20  CL-CERT-STATE       PIC XX.
  3903             20  CL-CERT-ACCOUNT.
  3904                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3905                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3906             20  CL-CERT-EFF-DT      PIC XX.
  3907
  3908     12  CL-STATUS-CONTROLS.
  3909         16  CL-PRIORITY-CD          PIC X.
  3910             88  CONFIDENTIAL-DATA      VALUE '8'.
  3911             88  HIGHEST-PRIORITY       VALUE '9'.
  3912         16  CL-SUPV-ATTN-CD         PIC X.
  3913             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3914             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3915         16  CL-PURGED-DT            PIC XX.
  3916         16  CL-RESTORED-DT          PIC XX.
  3917         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3918         16  CL-NEXT-RESEND-DT       PIC XX.
  3919         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3920         16  CL-CRITICAL-PERIOD      PIC 99.
  3921*        16  FILLER                  PIC XX.
  3922         16  CL-LAST-MAINT-DT        PIC XX.
  3923         16  CL-LAST-MAINT-USER      PIC X(4).
  3924         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3925         16  CL-LAST-MAINT-TYPE      PIC X.
  3926             88  CLAIM-SET-UP           VALUE ' '.
  3927             88  PAYMENT-MADE           VALUE '1'.
  3928             88  LETTER-SENT            VALUE '2'.
  3929             88  MASTER-WAS-ALTERED     VALUE '3'.
  3930             88  MASTER-WAS-RESTORED    VALUE '4'.
  3931             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3932             88  FILE-CONVERTED         VALUE '6'.
  3933             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3934             88  ERROR-CORRECTION       VALUE 'E'.
  3935         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3936         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3937         16  CL-BENEFICIARY          PIC X(10).
  3938         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3939         16  CL-DENIAL-TYPE          PIC X.
  3940             88  CL-TYPE-DENIAL          VALUE '1'.
  3941             88  CL-TYPE-RESCISSION      VALUE '2'.
  3942             88  CL-TYPE-REFORMATION     VALUE '3'.
  3943             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3944             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3945         16  CL-CRIT-PER-RECURRENT   PIC X.
  3946         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3947         16  CL-RTW-DT               PIC XX.
  3948
  3949     12  CL-TRAILER-CONTROLS.
  3950         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3951             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3952             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3953             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3954         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  78
* EL156.cbl
  3955         16  FILLER                  PIC XX.
  3956         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3957         16  CL-ADDRESS-TRAILER-CNT.
  3958             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3959                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3960             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3961                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3962             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3963                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3964             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3965                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3966             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3967                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3968             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3969                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3970             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3971                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3972
  3973     12  CL-CV-REFERENCE-NO.
  3974         16  CL-CV-REFNO-PRIME       PIC X(18).
  3975         16  CL-CV-REFNO-SFX         PIC XX.
  3976
  3977     12  CL-FILE-LOCATION            PIC X(4).
  3978
  3979     12  CL-PROCESS-ERRORS.
  3980         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3981             88  NO-FATAL-ERRORS        VALUE ZERO.
  3982         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3983             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3984
  3985     12  CL-PRODUCT-CD               PIC X.
  3986
  3987     12  CL-CURRENT-KEY-DATA.
  3988         16  CL-CURRENT-CARRIER      PIC X.
  3989         16  CL-CURRENT-GROUPING     PIC X(6).
  3990         16  CL-CURRENT-STATE        PIC XX.
  3991         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3992
  3993     12  CL-ASSOCIATES               PIC X.
  3994         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3995         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3996         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3997         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3998
  3999     12  CL-ACTIVITY-CODE            PIC 99.
  4000     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4001     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4002
  4003     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4004     12  CL-LAG-REPORT-CODE          PIC 9.
  4005     12  CL-LOAN-TYPE                PIC XX.
  4006     12  CL-LEGAL-STATE              PIC XX.
  4007
  4008     12  CL-YESNOSW                  PIC X.
  4009     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4010         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4011         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4012         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  79
* EL156.cbl
  4013     12  cl-insured-claim            pic x.
  4014         88  cl-claim-on-primary         value 'P'.
  4015         88  cl-claim-on-secondary       value 'S'.
  4016     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  80
* EL156.cbl
  4018*    COPY ELCCNTL.
  4019******************************************************************
  4020*                                                                *
  4021*                                                                *
  4022*                            ELCCNTL.                            *
  4023*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4024*                            VMOD=2.059                          *
  4025*                                                                *
  4026*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4027*                                                                *
  4028*   FILE TYPE = VSAM,KSDS                                        *
  4029*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4030*                                                                *
  4031*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4032*       ALTERNATE INDEX = NONE                                   *
  4033*                                                                *
  4034*   LOG = YES                                                    *
  4035*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4036******************************************************************
  4037*                   C H A N G E   L O G
  4038*
  4039* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4040*-----------------------------------------------------------------
  4041*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4042* EFFECTIVE    NUMBER
  4043*-----------------------------------------------------------------
  4044* 082503                   PEMA  ADD BENEFIT GROUP
  4045* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4046* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4047* 092705    2005050300006  PEMA  ADD SPP LEASES
  4048* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4049* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4050* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4051* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4052* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4053* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4054* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4055* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4056* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4057******************************************************************
  4058*
  4059 01  CONTROL-FILE.
  4060     12  CF-RECORD-ID                       PIC XX.
  4061         88  VALID-CF-ID                        VALUE 'CF'.
  4062
  4063     12  CF-CONTROL-PRIMARY.
  4064         16  CF-COMPANY-ID                  PIC XXX.
  4065         16  CF-RECORD-TYPE                 PIC X.
  4066             88  CF-COMPANY-MASTER              VALUE '1'.
  4067             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4068             88  CF-STATE-MASTER                VALUE '3'.
  4069             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4070             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4071             88  CF-CARRIER-MASTER              VALUE '6'.
  4072             88  CF-MORTALITY-MASTER            VALUE '7'.
  4073             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4074             88  CF-TERMINAL-MASTER             VALUE '9'.
  4075             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  81
* EL156.cbl
  4076             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4077             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4078             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4079             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4080             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4081             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4082             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4083             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4084         16  CF-ACCESS-CD-GENL              PIC X(4).
  4085         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4086             20  CF-PROCESSOR               PIC X(4).
  4087         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4088             20  CF-STATE-CODE              PIC XX.
  4089             20  FILLER                     PIC XX.
  4090         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4091             20  FILLER                     PIC XX.
  4092             20  CF-HI-BEN-IN-REC           PIC XX.
  4093         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4094             20  FILLER                     PIC XXX.
  4095             20  CF-CARRIER-CNTL            PIC X.
  4096         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4097             20  FILLER                     PIC XX.
  4098             20  CF-HI-TYPE-IN-REC          PIC 99.
  4099         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4100             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4101                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4102             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4103             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4104         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4105             20  FILLER                     PIC X.
  4106             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4107         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4108             20  FILLER                     PIC XX.
  4109             20  CF-MORTGAGE-PLAN           PIC XX.
  4110         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4111
  4112     12  CF-LAST-MAINT-DT                   PIC XX.
  4113     12  CF-LAST-MAINT-BY                   PIC X(4).
  4114     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4115
  4116     12  CF-RECORD-BODY                     PIC X(728).
  4117
  4118
  4119****************************************************************
  4120*             COMPANY MASTER RECORD                            *
  4121****************************************************************
  4122
  4123     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4124         16  CF-COMPANY-ADDRESS.
  4125             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4126             20  CF-CL-IN-CARE-OF           PIC X(30).
  4127             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4128             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4129             20  CF-CL-CITY-STATE           PIC X(30).
  4130             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4131             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4132         16  CF-COMPANY-CD                  PIC X.
  4133         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  82
* EL156.cbl
  4134         16  CF-SECURITY-OPTION             PIC X.
  4135             88  ALL-SECURITY                   VALUE '1'.
  4136             88  COMPANY-VERIFY                 VALUE '2'.
  4137             88  PROCESSOR-VERIFY               VALUE '3'.
  4138             88  NO-SECURITY                    VALUE '4'.
  4139             88  ALL-BUT-TERM                   VALUE '5'.
  4140         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4141             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4142         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4143             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4144         16  CF-INFORCE-LOCATION            PIC X.
  4145             88  CERTS-ARE-ONLINE               VALUE '1'.
  4146             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4147             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4148         16  CF-LOWER-CASE-LETTERS          PIC X.
  4149         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4150             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4151             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4152             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4153             88  CF-ACCNT-CNTL                  VALUE '3'.
  4154             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4155
  4156         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4157         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4158
  4159         16  CF-LGX-CREDIT-USER             PIC X.
  4160             88  CO-IS-NOT-USER                 VALUE 'N'.
  4161             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4162
  4163         16 CF-CREDIT-CALC-CODES.
  4164             20  CF-CR-REM-TERM-CALC PIC X.
  4165               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4166               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4167               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4168               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4169               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4170               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4171               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4172             20  CF-CR-R78-METHOD           PIC X.
  4173               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4174               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4175
  4176         16  CF-CLAIM-CONTROL-COUNTS.
  4177             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4178                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4179
  4180             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4181                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4182
  4183             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4184                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4185
  4186             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4187                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4188
  4189         16  CF-CURRENT-MONTH-END           PIC XX.
  4190
  4191         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  83
* EL156.cbl
  4192             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4193             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4194             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4195             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4196                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4197                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4198             20  CF-CO-PREM-REJECT-SW       PIC X.
  4199                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4200                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4201             20  CF-CO-REF-REJECT-SW        PIC X.
  4202                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4203                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4204
  4205         16  CF-CO-REPORTING-DT             PIC XX.
  4206         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4207         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4208           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4209           88  CF-CO-MONTH-END                  VALUE '1'.
  4210
  4211         16  CF-LGX-CLAIM-USER              PIC X.
  4212             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4213             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4214
  4215         16  CF-CREDIT-EDIT-CONTROLS.
  4216             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4217             20  CF-MIN-AGE                 PIC 99.
  4218             20  CF-DEFAULT-AGE             PIC 99.
  4219             20  CF-MIN-TERM                PIC S999      COMP-3.
  4220             20  CF-MAX-TERM                PIC S999      COMP-3.
  4221             20  CF-DEFAULT-SEX             PIC X.
  4222             20  CF-JOINT-AGE-INPUT         PIC X.
  4223                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4224             20  CF-BIRTH-DATE-INPUT        PIC X.
  4225                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4226             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4227                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4228                 88  CF-ZERO-CARRIER            VALUE '1'.
  4229                 88  CF-ZERO-GROUPING           VALUE '2'.
  4230                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4231             20  CF-EDIT-SW                 PIC X.
  4232                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4233             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4234             20  CF-CR-PR-METHOD            PIC X.
  4235               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4236               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4237             20  FILLER                     PIC X.
  4238
  4239         16  CF-CREDIT-MISC-CONTROLS.
  4240             20  CF-REIN-TABLE-SW           PIC X.
  4241                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4242             20  CF-COMP-TABLE-SW           PIC X.
  4243                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4244             20  CF-EXPERIENCE-RETENTION-AGE
  4245                                            PIC S9        COMP-3.
  4246             20  CF-CONVERSION-DT           PIC XX.
  4247             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4248             20  CF-RUN-FREQUENCY-SW        PIC X.
  4249                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  84
* EL156.cbl
  4250                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4251
  4252             20  CF-CR-CHECK-NO-CONTROL.
  4253                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4254                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4255                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4256                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4257                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4258                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4259
  4260                 24  CF-CR-CHECK-COUNT       REDEFINES
  4261                     CF-CR-CHECK-COUNTER      PIC X(4).
  4262
  4263                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4264                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4265
  4266                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4267                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4268                 24  CF-MAIL-PROCESSING       PIC X.
  4269                     88  MAIL-PROCESSING          VALUE 'Y'.
  4270
  4271         16  CF-MISC-SYSTEM-CONTROL.
  4272             20  CF-SYSTEM-C                 PIC X.
  4273                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4274             20  CF-SYSTEM-D                 PIC X.
  4275                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4276             20  CF-SOC-SEC-NO-SW            PIC X.
  4277                 88  SOC-SEC-NO-USED             VALUE '1'.
  4278             20  CF-MEMBER-NO-SW             PIC X.
  4279                 88  MEMBER-NO-USED              VALUE '1'.
  4280             20  CF-TAX-ID-NUMBER            PIC X(11).
  4281             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4282             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4283                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4284                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4285                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4286                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4287             20  CF-SYSTEM-E                 PIC X.
  4288                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4289
  4290         16  CF-LGX-LIFE-USER               PIC X.
  4291             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4292             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4293
  4294         16  CF-CR-MONTH-END-DT             PIC XX.
  4295
  4296         16  CF-FILE-MAINT-DATES.
  4297             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4298                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4299             20  CF-LAST-BATCH       REDEFINES
  4300                 CF-LAST-BATCH-NO               PIC X(4).
  4301             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4302             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4303             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4304             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4305             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4306             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4307             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  85
* EL156.cbl
  4308             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4309             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4310             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4311
  4312         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4313         16  FILLER                         PIC X.
  4314
  4315         16  CF-ALT-MORT-CODE               PIC X(4).
  4316         16  CF-MEMBER-CAPTION              PIC X(10).
  4317
  4318         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4319             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4320             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4321             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4322             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4323             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4324
  4325         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4326
  4327         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4328         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4329         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4330         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4331
  4332         16  CF-AH-OVERRIDE-L1              PIC X.
  4333         16  CF-AH-OVERRIDE-L2              PIC XX.
  4334         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4335         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4336
  4337         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4338         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4339
  4340         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4341         16  CF-AR-LAST-EL860-DT            PIC XX.
  4342         16  CF-MP-MONTH-END-DT             PIC XX.
  4343
  4344         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4345         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4346             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4347
  4348         16  CF-AR-MONTH-END-DT             PIC XX.
  4349
  4350         16  CF-CRDTCRD-USER                PIC X.
  4351             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4352             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4353
  4354         16  CF-CC-MONTH-END-DT             PIC XX.
  4355
  4356         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4357
  4358         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4359             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4360             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4361             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4362         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4363         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4364         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4365         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  86
* EL156.cbl
  4366             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4367             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4368         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4369         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4370         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4371             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4372         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4373
  4374         16  CF-CL-ZIP-CODE.
  4375             20  CF-CL-ZIP-PRIME.
  4376                 24  CF-CL-ZIP-1ST          PIC X.
  4377                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4378                 24  FILLER                 PIC X(4).
  4379             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4380         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4381             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4382             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4383             20  FILLER                     PIC XXX.
  4384
  4385         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4386         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4387         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4388         16  CF-CO-OPTION-START-DATE        PIC XX.
  4389         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4390           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4391                                                      '3' '4'.
  4392           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4393           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4394           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4395           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4396           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4397           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4398
  4399         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4400
  4401         16  CF-PAYMENT-APPROVAL-LEVELS.
  4402             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4403             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4404             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4405             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4406             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4407             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4408
  4409         16  CF-END-USER-REPORTING-USER     PIC X.
  4410             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4411             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4412
  4413         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4414             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4415             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4416
  4417         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4418
  4419         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4420         16  FILLER                         PIC X.
  4421
  4422         16  CF-CREDIT-ARCHIVE-CNTL.
  4423             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  87
* EL156.cbl
  4424             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4425             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4426
  4427         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4428
  4429         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4430             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4431             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4432
  4433         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4434             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4435             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4436
  4437         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4438
  4439         16  CF-CO-ACH-ID-CODE              PIC  X.
  4440             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4441             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4442             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4443         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4444         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4445         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4446         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4447         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4448         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4449         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4450         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4451         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4452                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4453         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4454                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4455
  4456         16  CF-CO-OVER-SHORT.
  4457             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4458             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4459
  4460*         16  FILLER                         PIC X(102).
  4461         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4462             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4463             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4464
  4465         16  CF-AH-APPROVAL-DAYS.
  4466             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4467             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4468             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4469             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4470
  4471         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4472
  4473         16  CF-APPROV-LEV-5.
  4474             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4475             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4476             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4477
  4478         16  FILLER                         PIC X(68).
  4479****************************************************************
  4480*             PROCESSOR/USER RECORD                            *
  4481****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  88
* EL156.cbl
  4482
  4483     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4484         16  CF-PROCESSOR-NAME              PIC X(30).
  4485         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4486         16  CF-PROCESSOR-TITLE             PIC X(26).
  4487         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4488                 88  MESSAGE-YES                VALUE 'Y'.
  4489                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4490
  4491*****************************************************
  4492****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4493****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4494****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4495****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4496*****************************************************
  4497
  4498         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4499             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4500             20  CF-APPLICATION-FORCE       PIC X.
  4501             20  CF-INDIVIDUAL-APP.
  4502                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4503                     28  CF-BROWSE-APP      PIC X.
  4504                     28  CF-UPDATE-APP      PIC X.
  4505
  4506         16  CF-CURRENT-TERM-ON             PIC X(4).
  4507         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4508             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4509             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4510             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4511             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4512             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4513             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4514             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4515         16  CF-PROCESSOR-CARRIER           PIC X.
  4516             88  NO-CARRIER-SECURITY            VALUE ' '.
  4517         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4518             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4519         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4520             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4521         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4522             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4523
  4524         16  CF-PROC-SYS-ACCESS-SW.
  4525             20  CF-PROC-CREDIT-CLAIMS-SW.
  4526                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4527                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4528                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4529                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4530             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4531                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4532                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4533             20  CF-PROC-LIFE-GNRLDGR-SW.
  4534                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4535                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4536                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4537                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4538             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4539                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  89
* EL156.cbl
  4540                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4541         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4542             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4543             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4544         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4545
  4546         16  CF-APPROVAL-LEVEL                  PIC X.
  4547             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4548             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4549             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4550             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4551             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4552
  4553         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4554
  4555         16  CF-LANGUAGE-TYPE                   PIC X.
  4556             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4557             88  CF-LANG-IS-FR                      VALUE 'F'.
  4558
  4559         16  CF-CSR-IND                         PIC X.
  4560         16  FILLER                             PIC X(239).
  4561
  4562****************************************************************
  4563*             PROCESSOR/REMINDERS RECORD                       *
  4564****************************************************************
  4565
  4566     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4567         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4568             20  CF-START-REMIND-DT         PIC XX.
  4569             20  CF-END-REMIND-DT           PIC XX.
  4570             20  CF-REMINDER-TEXT           PIC X(50).
  4571         16  FILLER                         PIC X(296).
  4572
  4573
  4574****************************************************************
  4575*             STATE MASTER RECORD                              *
  4576****************************************************************
  4577
  4578     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4579         16  CF-STATE-ABBREVIATION          PIC XX.
  4580         16  CF-STATE-NAME                  PIC X(25).
  4581         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4582         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4583             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4584             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4585             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4586             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4587                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4588                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4589             20  CF-ST-PREM-REJECT-SW       PIC X.
  4590                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4591                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4592             20  CF-ST-REF-REJECT-SW        PIC X.
  4593                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4594                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4595         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4596         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4597         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  90
* EL156.cbl
  4598             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4599             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4600             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4601         16  CF-ST-FST-PMT-EXTENSION.
  4602             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4603             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4604                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4605                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4606                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4607                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4608         16  CF-ST-STATE-CALL.
  4609             20  CF-ST-CALL-UNEARNED        PIC X.
  4610             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4611             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4612         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4613             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4614             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4615         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4616         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4617         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4618         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4619         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4620         16  FILLER                         PIC X.
  4621         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4622             20  CF-ST-BENEFIT-CD           PIC XX.
  4623             20  CF-ST-BENEFIT-KIND         PIC X.
  4624                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4625                 88  CF-ST-AH-KIND              VALUE 'A'.
  4626             20  CF-ST-REM-TERM-CALC        PIC X.
  4627                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4628                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4629                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4630                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4631                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4632                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4633                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4634                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4635
  4636             20  CF-ST-REFUND-CALC          PIC X.
  4637                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4638                 88  ST-REFD-BY-R78             VALUE '1'.
  4639                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4640                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4641                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4642                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4643                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4644                 88  ST-REFD-UTAH               VALUE '7'.
  4645                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4646                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4647                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4648
  4649             20  CF-ST-EARNING-CALC         PIC X.
  4650                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4651                 88  ST-EARN-BY-R78             VALUE '1'.
  4652                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4653                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4654                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4655                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  91
* EL156.cbl
  4656                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4657                 88  ST-EARN-MEAN               VALUE '8'.
  4658                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4659
  4660             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4661                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4662                 88  ST-OVRD-BY-R78             VALUE '1'.
  4663                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4664                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4665                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4666                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4667                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4668                 88  ST-OVRD-MEAN               VALUE '8'.
  4669                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4670             20  FILLER                     PIC X.
  4671
  4672         16  CF-ST-COMMISSION-CAPS.
  4673             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4674             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4675             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4676             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4677         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4678                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4679
  4680         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4681
  4682         16  CF-ST-STATUTORY-INTEREST.
  4683             20  CF-ST-STAT-DATE-FROM       PIC X.
  4684                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4685                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4686             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4687             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4688             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4689             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4690             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4691
  4692         16  CF-ST-OVER-SHORT.
  4693             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4694             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4695
  4696         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4697
  4698         16  CF-ST-RT-CALC                  PIC X.
  4699
  4700         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4701         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4702         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4703         16  CF-ST-RF-LR-CALC               PIC X.
  4704         16  CF-ST-RF-LL-CALC               PIC X.
  4705         16  CF-ST-RF-LN-CALC               PIC X.
  4706         16  CF-ST-RF-AH-CALC               PIC X.
  4707         16  CF-ST-RF-CP-CALC               PIC X.
  4708*        16  FILLER                         PIC X(206).
  4709*CIDMOD         16  FILLER                         PIC X(192).
  4710         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4711             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4712         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4713         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  92
* EL156.cbl
  4714         16  CF-ST-CAUSAL-STATE             PIC X.
  4715         16  FILLER                         PIC X(185).
  4716
  4717****************************************************************
  4718*             BENEFIT MASTER RECORD                            *
  4719****************************************************************
  4720
  4721     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4722         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4723             20  CF-BENEFIT-CODE            PIC XX.
  4724             20  CF-BENEFIT-NUMERIC  REDEFINES
  4725                 CF-BENEFIT-CODE            PIC XX.
  4726             20  CF-BENEFIT-ALPHA           PIC XXX.
  4727             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4728             20  CF-BENEFIT-COMMENT         PIC X(10).
  4729
  4730             20  CF-LF-COVERAGE-TYPE        PIC X.
  4731                 88  CF-REDUCING                VALUE 'R'.
  4732                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4733
  4734             20  CF-SPECIAL-CALC-CD         PIC X.
  4735                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4736                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4737                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4738                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4739                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4740                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4741                 88  CF-FARM-PLAN               VALUE 'F'.
  4742                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4743                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4744                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4745                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4746                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4747                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4748                 88  CF-PRUDENTIAL              VALUE 'P'.
  4749                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4750                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4751                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4752                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4753                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4754                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4755
  4756             20  CF-JOINT-INDICATOR         PIC X.
  4757                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4758
  4759*            20  FILLER                     PIC X(12).
  4760             20  FILLER                     PIC X(11).
  4761             20  CF-BENEFIT-CATEGORY        PIC X.
  4762             20  CF-LOAN-TYPE               PIC X(8).
  4763
  4764             20  CF-CO-REM-TERM-CALC        PIC X.
  4765                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4766                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4767                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4768                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4769                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4770
  4771             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  93
* EL156.cbl
  4772                 88  CO-EARN-BY-R78             VALUE '1'.
  4773                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4774                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4775                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4776                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4777                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4778                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4779                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4780
  4781             20  CF-CO-REFUND-CALC          PIC X.
  4782                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4783                 88  CO-REFD-BY-R78             VALUE '1'.
  4784                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4785                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4786                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4787                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4788                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4789                 88  CO-REFD-MEAN               VALUE '8'.
  4790                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4791                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4792                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4793
  4794             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4795                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4796                 88  CO-OVRD-BY-R78             VALUE '1'.
  4797                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4798                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4799                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4800                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4801                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4802                 88  CO-OVRD-MEAN               VALUE '8'.
  4803                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4804
  4805             20  CF-CO-BEN-I-G-CD           PIC X.
  4806                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4807                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4808                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4809
  4810         16  FILLER                         PIC X(304).
  4811
  4812
  4813****************************************************************
  4814*             CARRIER MASTER RECORD                            *
  4815****************************************************************
  4816
  4817     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4818         16  CF-ADDRESS-DATA.
  4819             20  CF-MAIL-TO-NAME            PIC X(30).
  4820             20  CF-IN-CARE-OF              PIC X(30).
  4821             20  CF-ADDRESS-LINE-1          PIC X(30).
  4822             20  CF-ADDRESS-LINE-2          PIC X(30).
  4823             20  CF-CITY-STATE              PIC X(30).
  4824             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4825             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4826
  4827         16  CF-CLAIM-NO-CONTROL.
  4828             20  CF-CLAIM-NO-METHOD         PIC X.
  4829                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  94
* EL156.cbl
  4830                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4831                 88  CLAIM-NO-SEQ               VALUE '3'.
  4832                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4833             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4834                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4835                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4836                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4837
  4838         16  CF-CHECK-NO-CONTROL.
  4839             20  CF-CHECK-NO-METHOD         PIC X.
  4840                 88  CHECK-NO-MANUAL            VALUE '1'.
  4841                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4842                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4843                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4844             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4845                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4846
  4847         16  CF-DOMICILE-STATE              PIC XX.
  4848
  4849         16  CF-EXPENSE-CONTROLS.
  4850             20  CF-EXPENSE-METHOD          PIC X.
  4851                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4852                 88  DOLLARS-PER-PMT            VALUE '2'.
  4853                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4854                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4855             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4856             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4857
  4858         16  CF-CORRESPONDENCE-CONTROL.
  4859             20  CF-LETTER-RESEND-OPT       PIC X.
  4860                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4861                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4862             20  FILLER                     PIC X(4).
  4863
  4864         16  CF-RESERVE-CONTROLS.
  4865             20  CF-MANUAL-SW               PIC X.
  4866                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4867             20  CF-FUTURE-SW               PIC X.
  4868                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4869             20  CF-PTC-SW                  PIC X.
  4870                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4871             20  CF-IBNR-SW                 PIC X.
  4872                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4873             20  CF-PTC-LF-SW               PIC X.
  4874                 88  CF-LF-PTC-USED             VALUE '1'.
  4875             20  CF-CDT-ACCESS-METHOD       PIC X.
  4876                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4877                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4878                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4879             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4880
  4881         16  CF-CLAIM-CALC-METHOD           PIC X.
  4882             88  360-PLUS-MONTHS                VALUE '1'.
  4883             88  365-PLUS-MONTHS                VALUE '2'.
  4884             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4885             88  360-DAILY                      VALUE '4'.
  4886             88  365-DAILY                      VALUE '5'.
  4887
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  95
* EL156.cbl
  4888         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4889         16  FILLER                         PIC X(11).
  4890
  4891         16  CF-LIMIT-AMOUNTS.
  4892             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4893             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4894             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4895             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4896             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4897             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4898             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4899             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4900             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4901             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4902
  4903         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4904         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4905         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4906
  4907         16  CF-ZIP-CODE.
  4908             20  CF-ZIP-PRIME.
  4909                 24  CF-ZIP-1ST             PIC X.
  4910                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4911                 24  FILLER                 PIC X(4).
  4912             20  CF-ZIP-PLUS4               PIC X(4).
  4913         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4914             20  CF-CAN-POSTAL-1            PIC XXX.
  4915             20  CF-CAN-POSTAL-2            PIC XXX.
  4916             20  FILLER                     PIC XXX.
  4917
  4918         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4919         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4920         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4921
  4922         16  CF-RATING-SWITCH               PIC X.
  4923             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4924             88  CF-NO-RATING                   VALUE 'N'.
  4925
  4926         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4927
  4928         16  CF-CARRIER-OVER-SHORT.
  4929             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4930             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4931
  4932         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4933         16  CF-SECPAY-SWITCH               PIC X.
  4934             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4935             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4936         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4937         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4938         16  FILLER                         PIC X(444).
  4939*        16  FILLER                         PIC X(452).
  4940
  4941
  4942****************************************************************
  4943*             MORTALITY MASTER RECORD                          *
  4944****************************************************************
  4945
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  96
* EL156.cbl
  4946     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4947         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4948                                INDEXED BY CF-MORT-NDX.
  4949             20  CF-MORT-TABLE              PIC X(5).
  4950             20  CF-MORT-TABLE-TYPE         PIC X.
  4951                 88  CF-MORT-JOINT              VALUE 'J'.
  4952                 88  CF-MORT-SINGLE             VALUE 'S'.
  4953                 88  CF-MORT-COMBINED           VALUE 'C'.
  4954                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4955                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4956             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4957             20  CF-MORT-AGE-METHOD         PIC XX.
  4958                 88  CF-AGE-LAST                VALUE 'AL'.
  4959                 88  CF-AGE-NEAR                VALUE 'AN'.
  4960             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4961             20  CF-MORT-ADJUSTMENT-DIRECTION
  4962                                            PIC X.
  4963                 88  CF-MINUS                   VALUE '-'.
  4964                 88  CF-PLUS                    VALUE '+'.
  4965             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4966             20  CF-MORT-JOINT-CODE         PIC X.
  4967                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4968             20  CF-MORT-PC-Q               PIC X.
  4969                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4970             20  CF-MORT-TABLE-CODE         PIC X(4).
  4971             20  CF-MORT-COMMENTS           PIC X(15).
  4972             20  FILLER                     PIC X(14).
  4973
  4974         16  FILLER                         PIC X(251).
  4975
  4976
  4977****************************************************************
  4978*             BUSSINESS TYPE MASTER RECORD                     *
  4979****************************************************************
  4980
  4981     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4982* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4983* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4984* AND RECORD 05 IS TYPES 81-99
  4985         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4986             20  CF-BUSINESS-TITLE          PIC  X(19).
  4987             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4988                                            PIC S9V9(4) COMP-3.
  4989             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4990             20  FILLER                     PIC  X.
  4991         16  FILLER                         PIC  X(248).
  4992
  4993
  4994****************************************************************
  4995*             TERMINAL MASTER RECORD                           *
  4996****************************************************************
  4997
  4998     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4999
  5000         16  CF-COMPANY-TERMINALS.
  5001             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5002                                  PIC X(4).
  5003         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  97
* EL156.cbl
  5004
  5005
  5006****************************************************************
  5007*             LIFE EDIT MASTER RECORD                          *
  5008****************************************************************
  5009
  5010     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5011         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5012             20  CF-LIFE-CODE-IN            PIC XX.
  5013             20  CF-LIFE-CODE-OUT           PIC XX.
  5014         16  FILLER                         PIC X(248).
  5015
  5016
  5017****************************************************************
  5018*             AH EDIT MASTER RECORD                            *
  5019****************************************************************
  5020
  5021     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5022         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5023             20  CF-AH-CODE-IN              PIC XXX.
  5024             20  CF-AH-CODE-OUT             PIC XX.
  5025         16  FILLER                         PIC X(248).
  5026
  5027
  5028****************************************************************
  5029*             CREDIBILITY TABLES                               *
  5030****************************************************************
  5031
  5032     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5033         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5034                             INDEXED BY CF-CRDB-NDX.
  5035             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5036             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5037             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5038         16  FILLER                         PIC  X(332).
  5039
  5040
  5041****************************************************************
  5042*             REPORT CUSTOMIZATION RECORD                      *
  5043****************************************************************
  5044
  5045     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5046         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5047             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5048             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5049             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5050**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5051****       A T-TRANSFER.                                   ****
  5052             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5053
  5054         16  FILLER                         PIC XX.
  5055
  5056         16  CF-CARRIER-CNTL-OPT.
  5057             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5058                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5059                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5060             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5061                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  98
* EL156.cbl
  5062         16  CF-GROUP-CNTL-OPT.
  5063             20  CF-GROUP-OPT-SEQ           PIC 9.
  5064                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5065                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5066             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5067                                            PIC X(6).
  5068         16  CF-STATE-CNTL-OPT.
  5069             20  CF-STATE-OPT-SEQ           PIC 9.
  5070                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5071                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5072             20  CF-STATE-SELECT OCCURS 3 TIMES
  5073                                            PIC XX.
  5074         16  CF-ACCOUNT-CNTL-OPT.
  5075             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5076                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5077                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5078             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5079                                            PIC X(10).
  5080         16  CF-BUS-TYP-CNTL-OPT.
  5081             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5082                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5083                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5084             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5085                                            PIC XX.
  5086         16  CF-LF-TYP-CNTL-OPT.
  5087             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5088                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5089                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5090             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5091                                            PIC XX.
  5092         16  CF-AH-TYP-CNTL-OPT.
  5093             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5094                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5095                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5096             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5097                                            PIC XX.
  5098         16  CF-REPTCD1-CNTL-OPT.
  5099             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5100                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5101                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5102             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5103                                            PIC X(10).
  5104         16  CF-REPTCD2-CNTL-OPT.
  5105             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5106                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5107                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5108             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5109                                            PIC X(10).
  5110         16  CF-USER1-CNTL-OPT.
  5111             20  CF-USER1-OPT-SEQ           PIC 9.
  5112                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5113                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5114             20  CF-USER1-SELECT OCCURS 3 TIMES
  5115                                            PIC X(10).
  5116         16  CF-USER2-CNTL-OPT.
  5117             20  CF-USER2-OPT-SEQ           PIC 9.
  5118                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5119                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page  99
* EL156.cbl
  5120             20  CF-USER2-SELECT OCCURS 3 TIMES
  5121                                            PIC X(10).
  5122         16  CF-USER3-CNTL-OPT.
  5123             20  CF-USER3-OPT-SEQ           PIC 9.
  5124                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5125                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5126             20  CF-USER3-SELECT OCCURS 3 TIMES
  5127                                            PIC X(10).
  5128         16  CF-USER4-CNTL-OPT.
  5129             20  CF-USER4-OPT-SEQ           PIC 9.
  5130                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5131                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5132             20  CF-USER4-SELECT OCCURS 3 TIMES
  5133                                            PIC X(10).
  5134         16  CF-USER5-CNTL-OPT.
  5135             20  CF-USER5-OPT-SEQ           PIC 9.
  5136                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5137                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5138             20  CF-USER5-SELECT OCCURS 3 TIMES
  5139                                            PIC X(10).
  5140         16  CF-REINS-CNTL-OPT.
  5141             20  CF-REINS-OPT-SEQ           PIC 9.
  5142                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5143                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5144             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5145                 24  CF-REINS-PRIME         PIC XXX.
  5146                 24  CF-REINS-SUB           PIC XXX.
  5147
  5148         16  CF-AGENT-CNTL-OPT.
  5149             20  CF-AGENT-OPT-SEQ           PIC 9.
  5150                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5151                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5152             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5153                                            PIC X(10).
  5154
  5155         16  FILLER                         PIC X(43).
  5156
  5157         16  CF-LOSS-RATIO-SELECT.
  5158             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5159             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5160         16  CF-ENTRY-DATE-SELECT.
  5161             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5162             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5163         16  CF-EFFECTIVE-DATE-SELECT.
  5164             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5165             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5166
  5167         16  CF-EXCEPTION-LIST-IND          PIC X.
  5168             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5169
  5170         16  FILLER                         PIC X(318).
  5171
  5172****************************************************************
  5173*                  EXCEPTION REPORTING RECORD                  *
  5174****************************************************************
  5175
  5176     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5177         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 100
* EL156.cbl
  5178             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5179
  5180         16  CF-COMBINED-LIFE-AH-OPT.
  5181             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5182             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5183             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5184             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5185
  5186         16  CF-LIFE-OPT.
  5187             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5188             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5189             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5190             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5191             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5192             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5193             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5194             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5195             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5196             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5197
  5198         16  CF-AH-OPT.
  5199             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5200             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5201             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5202             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5203             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5204             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5205             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5206             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5207             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5208             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5209
  5210         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5211             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5212             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5213             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5214
  5215         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5216
  5217         16  FILLER                         PIC X(673).
  5218
  5219
  5220****************************************************************
  5221*             MORTGAGE SYSTEM PLAN RECORD                      *
  5222****************************************************************
  5223
  5224     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5225         16  CF-PLAN-TYPE                   PIC X.
  5226             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5227             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5228             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5229         16  CF-PLAN-ABBREV                 PIC XXX.
  5230         16  CF-PLAN-DESCRIPT               PIC X(10).
  5231         16  CF-PLAN-NOTES                  PIC X(20).
  5232         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5233         16  CF-PLAN-UNDERWRITING.
  5234             20  CF-PLAN-TERM-DATA.
  5235                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 101
* EL156.cbl
  5236                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5237             20  CF-PLAN-AGE-DATA.
  5238                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5239                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5240                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5241             20  CF-PLAN-BENEFIT-DATA.
  5242                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5243                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5244                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5245                                            PIC S9(7)V99  COMP-3.
  5246         16  CF-PLAN-POLICY-FORMS.
  5247             20  CF-POLICY-FORM             PIC X(12).
  5248             20  CF-MASTER-APPLICATION      PIC X(12).
  5249             20  CF-MASTER-POLICY           PIC X(12).
  5250         16  CF-PLAN-RATING.
  5251             20  CF-RATE-CODE               PIC X(5).
  5252             20  CF-SEX-RATING              PIC X.
  5253                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5254                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5255             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5256             20  CF-SUB-STD-TYPE            PIC X.
  5257                 88  CF-PCT-OF-PREM            VALUE '1'.
  5258                 88  CF-PCT-OF-BENE            VALUE '2'.
  5259         16  CF-PLAN-PREM-TOLERANCES.
  5260             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5261             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5262         16  CF-PLAN-PYMT-TOLERANCES.
  5263             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5264             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5265         16  CF-PLAN-MISC-DATA.
  5266             20  FILLER                     PIC X.
  5267             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5268             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5269         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5270         16  CF-PLAN-IND-GRP                PIC X.
  5271             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5272                                                     '1'.
  5273             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5274                                                     '2'.
  5275         16  CF-MIB-SEARCH-SW               PIC X.
  5276             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5277             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5278             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5279             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5280         16  CF-ALPHA-SEARCH-SW             PIC X.
  5281             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5282             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5283             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5284             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5285             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5286             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5287             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5288             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5289             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5290             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5291                                                     'A' 'B' 'C'
  5292                                                     'X' 'Y' 'Z'.
  5293         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 102
* EL156.cbl
  5294             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5295             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5296             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5297             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5298             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5299         16  FILLER                         PIC X(4).
  5300         16  CF-HEALTH-QUESTIONS            PIC X.
  5301             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5302         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5303         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5304         16  CF-PLAN-SNGL-JNT               PIC X.
  5305             88  CF-COMBINED-PLAN              VALUE 'C'.
  5306             88  CF-JNT-PLAN                   VALUE 'J'.
  5307             88  CF-SNGL-PLAN                  VALUE 'S'.
  5308         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5309         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5310         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5311         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5312         16  CF-RERATE-CNTL                 PIC  X.
  5313             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5314             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5315             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5316             88  CF-AUTO-RECALC                 VALUE '4'.
  5317         16  CF-BENEFIT-TYPE                PIC  X.
  5318             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5319             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5320         16  CF-POLICY-FEE                  PIC S999V99
  5321                                                    COMP-3.
  5322         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5323         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5324         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5325         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5326         16  FILLER                         PIC  X(32).
  5327         16  CF-TERMINATION-FORM            PIC  X(04).
  5328         16  FILLER                         PIC  X(08).
  5329         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5330                                                       COMP-3.
  5331         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5332         16  CF-ISSUE-LETTER                PIC  X(4).
  5333         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5334         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5335             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5336             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5337         16  CF-MP-REFUND-CALC              PIC X.
  5338             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5339             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5340             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5341             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5342             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5343             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5344             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5345             88  CF-MP-REFD-MEAN                VALUE '8'.
  5346         16  CF-ALT-RATE-CODE               PIC  X(5).
  5347
  5348
  5349         16  FILLER                         PIC X(498).
  5350****************************************************************
  5351*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 103
* EL156.cbl
  5352****************************************************************
  5353
  5354     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5355         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5356         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5357             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5358             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5359             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5360             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5361             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5362
  5363         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5364         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5365         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5366         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5367         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5368
  5369         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5370             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5371         16  CF-MP-RECON-USE-IND            PIC X(1).
  5372             88  CF-MP-USE-RECON             VALUE 'Y'.
  5373         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5374             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5375         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5376             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5377             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5378         16  FILLER                         PIC X(1).
  5379         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5380             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5381         16  CF-MORTG-MIB-VERSION           PIC X.
  5382             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5383             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5384             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5385         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5386             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5387                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5388             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5389                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5390             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5391                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5392             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5393                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5394             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5395                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5396             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5397                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5398         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5399         16  FILLER                         PIC X(7).
  5400         16  CF-MORTG-DESTINATION-SYMBOL.
  5401             20  CF-MORTG-MIB-COMM          PIC X(5).
  5402             20  CF-MORTG-MIB-TERM          PIC X(5).
  5403         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5404             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5405         16  FILLER                         PIC X(03).
  5406         16  CF-MP-CHECK-NO-CONTROL.
  5407             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5408                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5409                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 104
* EL156.cbl
  5410                                                ' ' LOW-VALUES.
  5411                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5412                                               VALUE '3'.
  5413         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5414         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5415         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5416             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5417                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5418             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5419                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5420             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5421                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5422             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5423                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5424             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5425                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5426             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5427                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5428         16  CF-MORTG-BILLING-AREA.
  5429             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5430                                            PIC X.
  5431         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5432         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5433         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5434         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5435             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5436             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5437         16  FILLER                         PIC X.
  5438         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5439             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5440             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5441         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5442         16  FILLER                         PIC X(8).
  5443         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5444         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5445         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5446         16  CF-ACH-COMPANY-ID.
  5447             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5448                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5449                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5450                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5451             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5452         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5453             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5454         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5455             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5456             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5457         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5458         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5459         16  FILLER                         PIC X(536).
  5460
  5461****************************************************************
  5462*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5463****************************************************************
  5464
  5465     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5466         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5467             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 105
* EL156.cbl
  5468                 24  CF-FEMALE-FT           PIC 99.
  5469                 24  CF-FEMALE-IN           PIC 99.
  5470             20  CF-FEMALE-MIN-WT           PIC 999.
  5471             20  CF-FEMALE-MAX-WT           PIC 999.
  5472         16  FILLER                         PIC X(428).
  5473
  5474     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5475         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5476             20  CF-MALE-HEIGHT.
  5477                 24  CF-MALE-FT             PIC 99.
  5478                 24  CF-MALE-IN             PIC 99.
  5479             20  CF-MALE-MIN-WT             PIC 999.
  5480             20  CF-MALE-MAX-WT             PIC 999.
  5481         16  FILLER                         PIC X(428).
  5482******************************************************************
  5483*             AUTOMATIC ACTIVITY RECORD                          *
  5484******************************************************************
  5485     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5486         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5487             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5488             20  CF-SYS-LETTER-ID           PIC X(04).
  5489             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5490             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5491             20  CF-SYS-RESET-SW            PIC X(01).
  5492             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5493             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5494
  5495         16  FILLER                         PIC X(50).
  5496
  5497         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5498             20  CF-USER-ACTIVE-SW          PIC X(01).
  5499             20  CF-USER-LETTER-ID          PIC X(04).
  5500             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5501             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5502             20  CF-USER-RESET-SW           PIC X(01).
  5503             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5504             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5505             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5506
  5507         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 106
* EL156.cbl
  5509*    COPY ELCCERT.
  5510******************************************************************
  5511*                                                                *
  5512*                            ELCCERT.                            *
  5513*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5514*                            VMOD=2.013                          *
  5515*                                                                *
  5516*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5517*                                                                *
  5518*   FILE TYPE = VSAM,KSDS                                        *
  5519*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5520*                                                                *
  5521*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5522*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5523*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5524*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5525*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5526*                                                                *
  5527*   LOG = YES                                                    *
  5528*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5529******************************************************************
  5530*                   C H A N G E   L O G
  5531*
  5532* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5533*-----------------------------------------------------------------
  5534*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5535* EFFECTIVE    NUMBER
  5536*-----------------------------------------------------------------
  5537* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5538* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5539* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5540* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5541* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5542* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5543* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5544* 032612  CR2011110200001  PEMA  AHL CHANGES
  5545******************************************************************
  5546
  5547 01  CERTIFICATE-MASTER.
  5548     12  CM-RECORD-ID                      PIC XX.
  5549         88  VALID-CM-ID                      VALUE 'CM'.
  5550
  5551     12  CM-CONTROL-PRIMARY.
  5552         16  CM-COMPANY-CD                 PIC X.
  5553         16  CM-CARRIER                    PIC X.
  5554         16  CM-GROUPING.
  5555             20  CM-GROUPING-PREFIX        PIC X(3).
  5556             20  CM-GROUPING-PRIME         PIC X(3).
  5557         16  CM-STATE                      PIC XX.
  5558         16  CM-ACCOUNT.
  5559             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5560             20  CM-ACCOUNT-PRIME          PIC X(6).
  5561         16  CM-CERT-EFF-DT                PIC XX.
  5562         16  CM-CERT-NO.
  5563             20  CM-CERT-PRIME             PIC X(10).
  5564             20  CM-CERT-SFX               PIC X.
  5565
  5566     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 107
* EL156.cbl
  5567         16  CM-COMPANY-CD-A1              PIC X.
  5568         16  CM-INSURED-LAST-NAME          PIC X(15).
  5569         16  CM-INSURED-INITIALS.
  5570             20  CM-INSURED-INITIAL1       PIC X.
  5571             20  CM-INSURED-INITIAL2       PIC X.
  5572
  5573     12  CM-CONTROL-BY-SSN.
  5574         16  CM-COMPANY-CD-A2              PIC X.
  5575         16  CM-SOC-SEC-NO.
  5576             20  CM-SSN-STATE              PIC XX.
  5577             20  CM-SSN-ACCOUNT            PIC X(6).
  5578             20  CM-SSN-LN3.
  5579                 25  CM-INSURED-INITIALS-A2.
  5580                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5581                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5582                 25 CM-PART-LAST-NAME-A2         PIC X.
  5583
  5584     12  CM-CONTROL-BY-CERT-NO.
  5585         16  CM-COMPANY-CD-A4              PIC X.
  5586         16  CM-CERT-NO-A4                 PIC X(11).
  5587
  5588     12  CM-CONTROL-BY-MEMB.
  5589         16  CM-COMPANY-CD-A5              PIC X.
  5590         16  CM-MEMBER-NO.
  5591             20  CM-MEMB-STATE             PIC XX.
  5592             20  CM-MEMB-ACCOUNT           PIC X(6).
  5593             20  CM-MEMB-LN4.
  5594                 25  CM-INSURED-INITIALS-A5.
  5595                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5596                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5597                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5598
  5599     12  CM-INSURED-PROFILE-DATA.
  5600         16  CM-INSURED-FIRST-NAME.
  5601             20  CM-INSURED-1ST-INIT       PIC X.
  5602             20  FILLER                    PIC X(9).
  5603         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5604         16  CM-INSURED-SEX                PIC X.
  5605             88  CM-SEX-MALE                  VALUE 'M'.
  5606             88  CM-SEX-FEMAL                 VALUE 'F'.
  5607         16  CM-INSURED-JOINT-AGE          PIC 99.
  5608         16  CM-JOINT-INSURED-NAME.
  5609             20  CM-JT-LAST-NAME           PIC X(15).
  5610             20  CM-JT-FIRST-NAME.
  5611                 24  CM-JT-1ST-INIT        PIC X.
  5612                 24  FILLER                PIC X(9).
  5613             20  CM-JT-INITIAL             PIC X.
  5614
  5615     12  CM-LIFE-DATA.
  5616         16  CM-LF-BENEFIT-CD              PIC XX.
  5617         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5618         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5619         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5620         16  CM-LF-DEV-CODE                PIC XXX.
  5621         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5622         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5623         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5624         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 108
* EL156.cbl
  5625         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5626         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5627         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5628         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5629         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5630         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5631         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5632         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5633         16  FILLER                        PIC XX.
  5634
  5635     12  CM-AH-DATA.
  5636         16  CM-AH-BENEFIT-CD              PIC XX.
  5637         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5638         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5639         16  CM-AH-DEV-CODE                PIC XXX.
  5640         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5641         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5642         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5643         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5644         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5645         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5646         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5647         16  CM-AH-PAID-THRU-DT            PIC XX.
  5648             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5649         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5650         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5651         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5652         16  FILLER                        PIC X.
  5653
  5654     12  CM-LOAN-INFORMATION.
  5655         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5656         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5657                                           PIC S9(5)V99  COMP-3.
  5658         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5659         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5660         16  CM-PAY-FREQUENCY              PIC S99.
  5661         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5662         16  CM-RATE-CLASS                 PIC XX.
  5663         16  CM-BENEFICIARY                PIC X(25).
  5664         16  CM-POLICY-FORM-NO             PIC X(12).
  5665         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5666         16  CM-LAST-ADD-ON-DT             PIC XX.
  5667         16  CM-DEDUCTIBLE-AMOUNTS.
  5668             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5669             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5670         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5671             20  CM-RESIDENT-STATE         PIC XX.
  5672             20  CM-RATE-CODE              PIC X(4).
  5673             20  FILLER                    PIC XX.
  5674         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5675             20  CM-LOAN-OFFICER           PIC X(5).
  5676             20  FILLER                    PIC XXX.
  5677         16  CM-CSR-CODE                   PIC XXX.
  5678         16  CM-UNDERWRITING-CODE          PIC X.
  5679             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5680         16  CM-POST-CARD-IND              PIC X.
  5681         16  CM-NH-INTERFACE-SW            PIC X.
  5682         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 109
* EL156.cbl
  5683             88  CM-SING-PRM                  VALUE '1'.
  5684             88  CM-O-B-COVERAGE              VALUE '2'.
  5685             88  CM-OPEN-END                  VALUE '3'.
  5686         16  CM-IND-GRP-TYPE               PIC X.
  5687             88  CM-INDIVIDUAL                VALUE 'I'.
  5688             88  CM-GROUP                     VALUE 'G'.
  5689         16  CM-SKIP-CODE                  PIC X.
  5690             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5691             88  SKIP-JULY                    VALUE '1'.
  5692             88  SKIP-AUGUST                  VALUE '2'.
  5693             88  SKIP-SEPTEMBER               VALUE '3'.
  5694             88  SKIP-JULY-AUG                VALUE '4'.
  5695             88  SKIP-AUG-SEPT                VALUE '5'.
  5696             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5697             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5698             88  SKIP-JUNE                    VALUE '8'.
  5699             88  SKIP-JUNE-JULY               VALUE '9'.
  5700             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5701             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5702         16  CM-PAYMENT-MODE               PIC X.
  5703             88  PAY-MONTHLY                  VALUE SPACE.
  5704             88  PAY-WEEKLY                   VALUE '1'.
  5705             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5706             88  PAY-BI-WEEKLY                VALUE '3'.
  5707             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5708         16  CM-LOAN-NUMBER                PIC X(8).
  5709         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5710         16  CM-OLD-LOF                    PIC XXX.
  5711*        16  CM-LOAN-OFFICER               PIC XXX.
  5712         16  CM-REIN-TABLE                 PIC XXX.
  5713         16  CM-SPECIAL-REIN-CODE          PIC X.
  5714         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5715         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5716         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5717
  5718     12  CM-STATUS-DATA.
  5719         16  CM-ENTRY-STATUS               PIC X.
  5720         16  CM-ENTRY-DT                   PIC XX.
  5721
  5722         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5723         16  CM-LF-CANCEL-DT               PIC XX.
  5724         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5725
  5726         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5727         16  CM-LF-DEATH-DT                PIC XX.
  5728         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5729
  5730         16  CM-LF-CURRENT-STATUS          PIC X.
  5731             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5732                                                'M' '4' '5' '9'.
  5733             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5734             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5735             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5736             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5737             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5738             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5739             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5740             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 110
* EL156.cbl
  5741             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5742             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5743             88  CM-LF-DECLINED               VALUE 'D'.
  5744             88  CM-LF-VOIDED                 VALUE 'V'.
  5745
  5746         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5747         16  CM-AH-CANCEL-DT               PIC XX.
  5748         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5749
  5750         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5751         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5752         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5753
  5754         16  CM-AH-CURRENT-STATUS          PIC X.
  5755             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5756                                                'M' '4' '5' '9'.
  5757             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5758             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5759             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5760             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5761             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5762             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5763             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5764             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5765             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5766             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5767             88  CM-AH-DECLINED               VALUE 'D'.
  5768             88  CM-AH-VOIDED                 VALUE 'V'.
  5769
  5770         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5771             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5772             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5773             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5774         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5775
  5776         16  CM-ENTRY-BATCH                PIC X(6).
  5777         16  CM-LF-EXIT-BATCH              PIC X(6).
  5778         16  CM-AH-EXIT-BATCH              PIC X(6).
  5779         16  CM-LAST-MONTH-END             PIC XX.
  5780
  5781     12  CM-NOTE-SW                        PIC X.
  5782         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5783         88  CERT-NOTES-PRESENT               VALUE '1'.
  5784         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5785         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5786         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5787         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5788         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5789         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5790     12  CM-COMP-EXCP-SW                   PIC X.
  5791         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5792         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5793     12  CM-INSURED-ADDRESS-SW             PIC X.
  5794         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5795         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5796
  5797*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5798     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 111
* EL156.cbl
  5799     12  FILLER                            PIC X.
  5800
  5801*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5802     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5803     12  FILLER                            PIC X.
  5804*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5805     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5806
  5807     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5808         88  CERT-ADDED-BATCH                 VALUE ' '.
  5809         88  CERT-ADDED-ONLINE                VALUE '1'.
  5810         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5811         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5812         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5813     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5814         88  CERT-AS-LOADED                   VALUE ' '.
  5815         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5816         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5817         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5818         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5819         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5820         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5821         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5822
  5823     12  CM-ACCOUNT-COMM-PCTS.
  5824         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5825         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5826
  5827     12  CM-USER-FIELD                     PIC X.
  5828     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5829     12  CM-CLP-STATE                      PIC XX.
  5830     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5831     12  CM-USER-RESERVED                  PIC XXX.
  5832     12  FILLER REDEFINES CM-USER-RESERVED.
  5833         16  CM-AH-CLASS-CD                PIC XX.
  5834         16  F                             PIC X.
  5835******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 112
* EL156.cbl
  5837*    COPY ELCTRLR.
  5838******************************************************************
  5839*                                                                *
  5840*                            ELCTRLR.                            *
  5841*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5842*                            VMOD=2.014                          *
  5843*                                                                *
  5844*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5845*                                                                *
  5846*   FILE TYPE = VSAM,KSDS                                        *
  5847*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5848*                                                                *
  5849*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5850*       ALTERNATE INDEX = NONE                                   *
  5851*                                                                *
  5852*   LOG = YES                                                    *
  5853*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5854******************************************************************
  5855*                   C H A N G E   L O G
  5856*
  5857* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5858*-----------------------------------------------------------------
  5859*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5860* EFFECTIVE    NUMBER
  5861*-----------------------------------------------------------------
  5862* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5863* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5864* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5865* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5866* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5867* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5868* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5869* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5870* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5871* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5872* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5873* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5874* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5875* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5876* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5877* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5878******************************************************************
  5879 01  ACTIVITY-TRAILERS.
  5880     12  AT-RECORD-ID                    PIC XX.
  5881         88  VALID-AT-ID                       VALUE 'AT'.
  5882
  5883     12  AT-CONTROL-PRIMARY.
  5884         16  AT-COMPANY-CD               PIC X.
  5885         16  AT-CARRIER                  PIC X.
  5886         16  AT-CLAIM-NO                 PIC X(7).
  5887         16  AT-CERT-NO.
  5888             20  AT-CERT-PRIME           PIC X(10).
  5889             20  AT-CERT-SFX             PIC X.
  5890         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5891             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5892             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5893             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5894             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 113
* EL156.cbl
  5895             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5896             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5897             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5898             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5899             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5900             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5901             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5902             88  AT-BENEFICIARY-TRL           VALUE +91.
  5903             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5904             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5905             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5906             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5907
  5908     12  AT-TRAILER-TYPE                 PIC X.
  5909         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5910         88  PAYMENT-TR                       VALUE '2'.
  5911         88  AUTO-PAY-TR                      VALUE '3'.
  5912         88  CORRESPONDENCE-TR                VALUE '4'.
  5913         88  ADDRESS-TR                       VALUE '5'.
  5914         88  GENERAL-INFO-TR                  VALUE '6'.
  5915         88  AUTO-PROMPT-TR                   VALUE '7'.
  5916         88  DENIAL-TR                        VALUE '8'.
  5917         88  INCURRED-CHG-TR                  VALUE '9'.
  5918         88  FORM-CONTROL-TR                  VALUE 'A'.
  5919
  5920     12  AT-RECORDED-DT                  PIC XX.
  5921     12  AT-RECORDED-BY                  PIC X(4).
  5922     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5923
  5924     12  AT-TRAILER-BODY                 PIC X(165).
  5925
  5926     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5927         16  AT-RESERVE-CONTROLS.
  5928             20  AT-MANUAL-SW            PIC X.
  5929                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5930             20  AT-FUTURE-SW            PIC X.
  5931                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5932             20  AT-PTC-SW               PIC X.
  5933                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5934             20  AT-IBNR-SW              PIC X.
  5935                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5936             20  AT-PTC-LF-SW            PIC X.
  5937                 88  AT-LF-PTC-USED          VALUE '1'.
  5938             20  AT-CDT-ACCESS-METHOD    PIC X.
  5939                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5940                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5941                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5942             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5943         16  AT-LAST-COMPUTED-DT         PIC XX.
  5944         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5945         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5946         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5947         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5948         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5949         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5950         16  AT-EXPENSE-CONTROLS.
  5951             20  AT-EXPENSE-METHOD       PIC X.
  5952                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 114
* EL156.cbl
  5953                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5954                 88  PERCENT-OF-PMT           VALUE '3'.
  5955                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5956             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5957             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5958         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5959         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5960
  5961         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5962         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5963
  5964*        16  FILLER                      PIC X(53).
  5965         16  FILLER                      PIC X(47).
  5966
  5967         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5968         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5969
  5970         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5971             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5972             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5973*                    C = CLOSED
  5974*                    O = OPEN
  5975             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5976*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5977
  5978     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5979         16  AT-PAYMENT-TYPE             PIC X.
  5980             88  PARTIAL-PAYMENT                VALUE '1'.
  5981             88  FINAL-PAYMENT                  VALUE '2'.
  5982             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5983             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5984             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5985             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5986             88  VOIDED-PAYMENT                 VALUE '9'.
  5987             88  TRANSFER                       VALUE 'T'.
  5988             88  LIFE-INTEREST                  VALUE 'I'.
  5989
  5990         16  AT-CLAIM-TYPE               PIC X.
  5991             88  PAID-FOR-AH                    VALUE 'A'.
  5992             88  PAID-FOR-LIFE                  VALUE 'L'.
  5993             88  PAID-FOR-IUI                   VALUE 'I'.
  5994             88  PAID-FOR-GAP                   VALUE 'G'.
  5995         16  AT-CLAIM-PREM-TYPE          PIC X.
  5996             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5997             88  AT-O-B-COVERAGE                VALUE '2'.
  5998             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5999         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6000         16  AT-CHECK-NO                 PIC X(7).
  6001         16  AT-PAID-FROM-DT             PIC XX.
  6002         16  AT-PAID-THRU-DT             PIC XX.
  6003         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6004         16  FILLER                      PIC X.
  6005         16  AT-PAYEES-NAME              PIC X(30).
  6006         16  AT-PAYMENT-ORIGIN           PIC X.
  6007             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6008             88  ONLINE-AUTO-PMT                VALUE '2'.
  6009             88  OFFLINE-PMT                    VALUE '3'.
  6010         16  AT-CHECK-WRITTEN-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 115
* EL156.cbl
  6011         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6012         16  AT-VOID-DATA.
  6013             20  AT-VOID-DT              PIC XX.
  6014*00144       20  AT-VOID-REASON          PIC X(30).
  6015             20  AT-VOID-REASON          PIC X(26).
  6016         16  AT-PMT-APPROVED-BY          PIC X(04).
  6017         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6018         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6019         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6020                                         PIC S99V9(5)  COMP-3.
  6021         16  AT-CREDIT-INTERFACE.
  6022             20  AT-PMT-SELECT-DT        PIC XX.
  6023                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6024             20  AT-PMT-ACCEPT-DT        PIC XX.
  6025                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6026             20  AT-VOID-SELECT-DT       PIC XX.
  6027                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6028             20  AT-VOID-ACCEPT-DT       PIC XX.
  6029                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6030
  6031         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6032                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6033                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6034         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6035
  6036         16  AT-FORCE-CONTROL            PIC X.
  6037             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6038         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6039         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6040         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6041         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6042         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6043         16  AT-BENEFIT-TYPE             PIC X.
  6044
  6045         16  AT-EXPENSE-TYPE             PIC X.
  6046         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6047
  6048         16  AT-PAYEE-TYPE-CD.
  6049             20  AT-PAYEE-TYPE           PIC X.
  6050                 88  INSURED-PAID           VALUE 'I'.
  6051                 88  BENEFICIARY-PAID       VALUE 'B'.
  6052                 88  ACCOUNT-PAID           VALUE 'A'.
  6053                 88  OTHER-1-PAID           VALUE 'O'.
  6054                 88  OTHER-2-PAID           VALUE 'Q'.
  6055                 88  DOCTOR-PAID            VALUE 'P'.
  6056                 88  EMPLOYER-PAID          VALUE 'E'.
  6057             20  AT-PAYEE-SEQ            PIC X.
  6058
  6059         16  AT-CASH-PAYMENT             PIC X.
  6060         16  AT-GROUPED-PAYMENT          PIC X.
  6061         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6062         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6063         16  AT-APPROVED-LEVEL           PIC X.
  6064         16  AT-VOID-TYPE                PIC X.
  6065             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6066             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6067         16  AT-AIG-UNEMP-IND            PIC X.
  6068             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 116
* EL156.cbl
  6069         16  AT-ASSOCIATES               PIC X.
  6070             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6071             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6072
  6073         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6074         16  AT-CV-PMT-CODE              PIC X.
  6075             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6076             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6077             88  FULL-ADD-PAYMENT           VALUE '3'.
  6078             88  HALF-ADD-PAYMENT           VALUE '4'.
  6079             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6080             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6081             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6082             88  ADDL-PAYMENT               VALUE '8'.
  6083
  6084         16  AT-EOB-CODE1                PIC XXX.
  6085         16  AT-EOB-CODE2                PIC XXX.
  6086         16  AT-EOB-CODE3                PIC XXX.
  6087         16  FILLER REDEFINES AT-EOB-CODE3.
  6088             20  AT-PRINT-CLM-FORM       PIC X.
  6089             20  AT-PRINT-SURVEY         PIC X.
  6090             20  FILLER                  PIC X.
  6091         16  AT-EOB-CODE4                PIC XXX.
  6092         16  FILLER REDEFINES AT-EOB-CODE4.
  6093             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6094             20  FILLER                  PIC X.
  6095         16  AT-EOB-CODE5                PIC XXX.
  6096         16  FILLER REDEFINES AT-EOB-CODE5.
  6097             20  AT-PMT-PROOF-DT         PIC XX.
  6098             20  FILLER                  PIC X.
  6099
  6100         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6101             88  AT-PRINT-EOB            VALUE 'Y'.
  6102
  6103         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6104         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6105
  6106     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6107         16  AT-SCHEDULE-START-DT        PIC XX.
  6108         16  AT-SCHEDULE-END-DT          PIC XX.
  6109         16  AT-TERMINATED-DT            PIC XX.
  6110         16  AT-LAST-PMT-TYPE            PIC X.
  6111             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6112             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6113         16  AT-FIRST-PMT-DATA.
  6114             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6115             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6116             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6117         16  AT-REGULAR-PMT-DATA.
  6118             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6119             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6120             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6121         16  AT-AUTO-PAYEE-CD.
  6122             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6123                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6124                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6125                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6126                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 117
* EL156.cbl
  6127                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6128             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6129         16  AT-AUTO-PAY-DAY             PIC 99.
  6130         16  AT-AUTO-CASH                PIC X.
  6131             88  AT-CASH                      VALUE 'Y'.
  6132             88  AT-NON-CASH                  VALUE 'N'.
  6133*        16  FILLER                      PIC X(129).
  6134         16  AT-AUTO-END-LETTER          PIC X(4).
  6135         16  FILLER                      PIC X(125).
  6136
  6137         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6138         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6139
  6140     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6141         16  AT-LETTER-SENT-DT           PIC XX.
  6142         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6143         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6144         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6145         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6146         16  AT-LETTER-ORIGIN            PIC X.
  6147             88  ONLINE-CREATION              VALUE '1' '3'.
  6148             88  OFFLINE-CREATION             VALUE '2' '4'.
  6149             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6150             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6151         16  AT-STD-LETTER-FORM          PIC X(4).
  6152         16  AT-REASON-TEXT              PIC X(70).
  6153         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6154         16  AT-ADDRESEE-TYPE            PIC X.
  6155              88  INSURED-ADDRESEE            VALUE 'I'.
  6156              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6157              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6158              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6159              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6160              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6161              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6162         16  AT-ADDRESSEE-NAME           PIC X(30).
  6163         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6164         16  AT-RESEND-PRINT-DATE        PIC XX.
  6165         16  AT-CORR-SOL-UNSOL           PIC X.
  6166         16  AT-LETTER-PURGED-DT         PIC XX.
  6167*
  6168*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6169*
  6170         16  AT-CSO-REDEFINITION.
  6171             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6172             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6173             20  AT-LETTER-TO-BENE       PIC X(1).
  6174             20  AT-STOP-LETTER-DT       PIC X(2).
  6175             20  FILLER                  PIC X(19).
  6176*             20  FILLER                  PIC X(27).
  6177             20  AT-CSO-LETTER-STATUS    PIC X.
  6178                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6179                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6180                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6181             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6182             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6183*
  6184*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 118
* EL156.cbl
  6185*
  6186*        16  FILLER                      PIC X(26).
  6187*
  6188*        16  AT-DMD-BSR-CODE             PIC X.
  6189*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6190*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6191*
  6192*        16  AT-DMD-LETTER-STATUS        PIC X.
  6193*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6194*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6195*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6196*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6197*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6198
  6199         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6200         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6201
  6202     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6203         16  AT-ADDRESS-TYPE             PIC X.
  6204             88  INSURED-ADDRESS               VALUE 'I'.
  6205             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6206             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6207             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6208             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6209             88  OTHER-ADDRESS-1               VALUE 'O'.
  6210             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6211         16  AT-MAIL-TO-NAME             PIC X(30).
  6212         16  AT-ADDRESS-LINE-1           PIC X(30).
  6213         16  AT-ADDRESS-LINE-2           PIC X(30).
  6214         16  AT-CITY-STATE.
  6215             20  AT-CITY                 PIC X(28).
  6216             20  AT-STATE                PIC XX.
  6217         16  AT-ZIP.
  6218             20  AT-ZIP-CODE.
  6219                 24  AT-ZIP-1ST          PIC X.
  6220                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6221                 24  FILLER              PIC X(4).
  6222             20  AT-ZIP-PLUS4            PIC X(4).
  6223         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6224             20  AT-CAN-POSTAL-1         PIC XXX.
  6225             20  AT-CAN-POSTAL-2         PIC XXX.
  6226             20  FILLER                  PIC XXX.
  6227         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6228*         16  FILLER                      PIC X(23).
  6229         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6230         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6231         16  FILLER                      PIC X(13).
  6232         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6233         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6234
  6235     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6236         16  AT-INFO-LINE-1              PIC X(60).
  6237         16  FILLER REDEFINES AT-INFO-LINE-1.
  6238             20  AT-NOTE-ERROR-NO OCCURS 15
  6239                                         PIC X(4).
  6240         16  AT-INFO-LINE-2              PIC X(60).
  6241         16  AT-INFO-TRAILER-TYPE        PIC X.
  6242             88  AT-ERRORS-NOTE          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 119
* EL156.cbl
  6243             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6244             88  AT-CALL-NOTE            VALUE 'C'.
  6245             88  AT-MAINT-NOTE           VALUE 'M'.
  6246             88  AT-CERT-CHANGE          VALUE 'X'.
  6247             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6248             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6249         16  AT-CALL-TYPE                PIC X.
  6250             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6251             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6252         16  AT-NOTE-CONTINUATION        PIC X.
  6253             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6254         16  AT-EOB-CODES-EXIST          PIC X.
  6255             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6256         16  FILLER                      PIC X(35).
  6257         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6258         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6259
  6260     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6261         16  AT-PROMPT-LINE-1            PIC X(60).
  6262         16  AT-PROMPT-LINE-2            PIC X(60).
  6263         16  AT-PROMPT-START-DT          PIC XX.
  6264         16  AT-PROMPT-END-DT            PIC XX.
  6265         16  FILLER                      PIC X(35).
  6266         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6267         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6268
  6269     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6270         16  AT-DENIAL-INFO-1            PIC X(60).
  6271         16  AT-DENIAL-INFO-2            PIC X(60).
  6272         16  AT-DENIAL-DT                PIC XX.
  6273         16  AT-RETRACTION-DT            PIC XX.
  6274         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6275*         16  FILLER                      PIC X(31).
  6276         16  AT-DENIAL-PROOF-DT          PIC XX.
  6277         16  FILLER                      PIC X(29).
  6278         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6279         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6280
  6281     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6282         16  AT-OLD-INCURRED-DT          PIC XX.
  6283         16  AT-OLD-REPORTED-DT          PIC XX.
  6284         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6285         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6286         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6287         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6288         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6289         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6290         16  FILLER                      PIC X(26).
  6291         16  AT-OLD-DIAG-CODE            PIC X(6).
  6292         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6293         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6294         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6295         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6296         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6297         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6298         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6299         16  FILLER                      PIC X(25).
  6300         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 120
* EL156.cbl
  6301
  6302     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6303         16  AT-FORM-SEND-ON-DT          PIC XX.
  6304         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6305         16  AT-FORM-RE-SEND-DT          PIC XX.
  6306         16  AT-FORM-ANSWERED-DT         PIC XX.
  6307         16  AT-FORM-PRINTED-DT          PIC XX.
  6308         16  AT-FORM-REPRINT-DT          PIC XX.
  6309         16  AT-FORM-TYPE                PIC X.
  6310             88  INITIAL-FORM                  VALUE '1'.
  6311             88  PROGRESS-FORM                 VALUE '2'.
  6312         16  AT-INSTRUCT-LN-1            PIC X(28).
  6313         16  AT-INSTRUCT-LN-2            PIC X(28).
  6314         16  AT-INSTRUCT-LN-3            PIC X(28).
  6315         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6316         16  AT-FORM-ADDRESS             PIC X.
  6317             88  FORM-TO-INSURED              VALUE 'I'.
  6318             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6319             88  FORM-TO-OTHER-1              VALUE 'O'.
  6320             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6321         16  AT-RELATED-1.
  6322             20 AT-REL-CARR-1            PIC X.
  6323             20 AT-REL-CLAIM-1           PIC X(7).
  6324             20 AT-REL-CERT-1            PIC X(11).
  6325         16  AT-RELATED-2.
  6326             20 AT-REL-CARR-2            PIC X.
  6327             20 AT-REL-CLAIM-2           PIC X(7).
  6328             20 AT-REL-CERT-2            PIC X(11).
  6329         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6330         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6331         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6332         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6333         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6334         16  AT-STOP-FORM-DT             PIC X(2).
  6335
  6336         16  FILLER                      PIC X(09).
  6337         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6338         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6339******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 121
* EL156.cbl
  6341*    COPY ELCACTQ.
  6342******************************************************************
  6343*                                                                *
  6344*                            ELCACTQ.                            *
  6345*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6346*                            VMOD=2.004                          *
  6347*                                                                *
  6348*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6349*                                                                *
  6350*   FILE TYPE = VSAM,KSDS                                        *
  6351*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6352*                                                                *
  6353*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6354*       ALTERNATE INDEX = NONE                                   *
  6355*                                                                *
  6356*   LOG = YES                                                    *
  6357*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6358*                                                                *
  6359*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6360******************************************************************
  6361
  6362 01  ACTIVITY-QUE.
  6363     12  AQ-RECORD-ID                PIC XX.
  6364         88  VALID-AQ-ID                VALUE 'AQ'.
  6365
  6366     12  AQ-CONTROL-PRIMARY.
  6367         16  AQ-COMPANY-CD           PIC X.
  6368         16  AQ-CARRIER              PIC X.
  6369         16  AQ-CLAIM-NO             PIC X(7).
  6370         16  AQ-CERT-NO.
  6371             20  AQ-CERT-PRIME       PIC X(10).
  6372             20  AQ-CERT-SFX         PIC X.
  6373
  6374     12  AQ-PENDING-ACTIVITY-FLAGS.
  6375         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6376         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6377             88  PENDING-PAYMENTS       VALUE '1'.
  6378         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6379             88  PENDING-FULL-PRINT     VALUE '1'.
  6380             88  PENDING-PART-PRINT     VALUE '2'.
  6381         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6382             88  PENDING-LETTERS        VALUE '1'.
  6383         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6384             88  PENDING-RESTORE        VALUE 'C'.
  6385             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6386
  6387     12  FILLER                      PIC X(20).
  6388
  6389     12  AQ-RESEND-DATE              PIC XX.
  6390     12  AQ-FOLLOWUP-DATE            PIC XX.
  6391     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6392     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6393     12  AQ-AUTO-LETTER              PIC X(4).
  6394     12  FILLER                      PIC XX.
  6395     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6396*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 122
* EL156.cbl
  6398*    COPY ERCACCT.
  6399******************************************************************
  6400*                                                                *
  6401*                                                                *
  6402*                            ERCACCT                             *
  6403*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6404*                            VMOD=2.031                          *
  6405*                                                                *
  6406*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6407*                                                                *
  6408*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6409*   VSAM ACCOUNT MASTER FILES.                                   *
  6410*                                                                *
  6411*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6412*                                                                *
  6413*   FILE TYPE = VSAM,KSDS                                        *
  6414*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6415*                                                                *
  6416*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6417*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6418*                                                                *
  6419*   LOG = NO                                                     *
  6420*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6421*                                                                *
  6422*                                                                *
  6423******************************************************************
  6424*                   C H A N G E   L O G
  6425*
  6426* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6427*-----------------------------------------------------------------
  6428*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6429* EFFECTIVE    NUMBER
  6430*-----------------------------------------------------------------
  6431* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6432* 092705    2005050300006  PEMA  ADD SPP LEASES
  6433* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6434* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6435* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6436* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6437* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6438******************************************************************
  6439
  6440 01  ACCOUNT-MASTER.
  6441     12  AM-RECORD-ID                      PIC XX.
  6442         88  VALID-AM-ID                      VALUE 'AM'.
  6443
  6444     12  AM-CONTROL-PRIMARY.
  6445         16  AM-COMPANY-CD                 PIC X.
  6446         16  AM-MSTR-CNTRL.
  6447             20  AM-CONTROL-A.
  6448                 24  AM-CARRIER            PIC X.
  6449                 24  AM-GROUPING.
  6450                     28 AM-GROUPING-PREFIX PIC XXX.
  6451                     28 AM-GROUPING-PRIME  PIC XXX.
  6452                 24  AM-STATE              PIC XX.
  6453                 24  AM-ACCOUNT.
  6454                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6455                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 123
* EL156.cbl
  6456             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6457                                           PIC X(19).
  6458             20  AM-CNTRL-B.
  6459                 24  AM-EXPIRATION-DT      PIC XX.
  6460                 24  FILLER                PIC X(4).
  6461             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6462                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6463
  6464     12  AM-CONTROL-BY-VAR-GRP.
  6465         16  AM-COMPANY-CD-A1              PIC X.
  6466         16  AM-VG-CARRIER                 PIC X.
  6467         16  AM-VG-GROUPING                PIC X(6).
  6468         16  AM-VG-STATE                   PIC XX.
  6469         16  AM-VG-ACCOUNT                 PIC X(10).
  6470         16  AM-VG-DATE.
  6471             20  AM-VG-EXPIRATION-DT       PIC XX.
  6472             20  FILLER                    PIC X(4).
  6473         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6474                                           PIC 9(11)      COMP-3.
  6475     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6476         16  FILLER                        PIC X(10).
  6477         16  AM-VG-KEY3.
  6478             20  AM-VG3-ACCOUNT            PIC X(10).
  6479             20  AM-VG3-EXP-DT             PIC XX.
  6480         16  FILLER                        PIC X(4).
  6481     12  AM-MAINT-INFORMATION.
  6482         16  AM-LAST-MAINT-DT              PIC XX.
  6483         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6484         16  AM-LAST-MAINT-USER            PIC X(4).
  6485         16  FILLER                        PIC XX.
  6486
  6487     12  AM-EFFECTIVE-DT                   PIC XX.
  6488     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6489
  6490     12  AM-PREV-DATES  COMP-3.
  6491         16  AM-PREV-EXP-DT                PIC 9(11).
  6492         16  AM-PREV-EFF-DT                PIC 9(11).
  6493
  6494     12  AM-REPORT-CODE-1                  PIC X(10).
  6495     12  AM-REPORT-CODE-2                  PIC X(10).
  6496
  6497     12  AM-CITY-CODE                      PIC X(4).
  6498     12  AM-COUNTY-PARISH                  PIC X(6).
  6499
  6500     12  AM-NAME                           PIC X(30).
  6501     12  AM-PERSON                         PIC X(30).
  6502     12  AM-ADDRS                          PIC X(30).
  6503     12  AM-CITY.
  6504         16  AM-ADDR-CITY                  PIC X(28).
  6505         16  AM-ADDR-STATE                 PIC XX.
  6506     12  AM-ZIP.
  6507         16  AM-ZIP-PRIME.
  6508             20  AM-ZIP-PRI-1ST            PIC X.
  6509                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6510             20  FILLER                    PIC X(4).
  6511         16  AM-ZIP-PLUS4                  PIC X(4).
  6512     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6513         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 124
* EL156.cbl
  6514         16  AM-CAN-POSTAL-2               PIC XXX.
  6515         16  FILLER                        PIC XXX.
  6516     12  AM-TEL-NO.
  6517         16  AM-AREA-CODE                  PIC 999.
  6518         16  AM-TEL-PRE                    PIC 999.
  6519         16  AM-TEL-NBR                    PIC 9(4).
  6520     12  AM-TEL-LOC                        PIC X.
  6521         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6522         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6523
  6524     12  AM-COMM-STRUCTURE.
  6525         16  AM-DEFN-1.
  6526             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6527                 24  AM-AGT.
  6528                     28  AM-AGT-PREFIX     PIC X(4).
  6529                     28  AM-AGT-PRIME      PIC X(6).
  6530                 24  AM-COM-TYP            PIC X.
  6531                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6532                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6533                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6534                 24  AM-RECALC-LV-INDIC    PIC X.
  6535                 24  AM-RETRO-LV-INDIC     PIC X.
  6536                 24  AM-GL-CODES           PIC X.
  6537                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6538                 24  FILLER                PIC X(01).
  6539         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6540             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6541                 24  FILLER                PIC X(11).
  6542                 24  AM-L-COMA             PIC XXX.
  6543                 24  AM-J-COMA             PIC XXX.
  6544                 24  AM-A-COMA             PIC XXX.
  6545                 24  FILLER                PIC X(6).
  6546
  6547     12  AM-COMM-CHANGE-STATUS             PIC X.
  6548         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6549
  6550     12  AM-CSR-CODE                       PIC X(4).
  6551
  6552     12  AM-BILLING-STATUS                 PIC X.
  6553         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6554         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6555     12  AM-AUTO-REFUND-SW                 PIC X.
  6556         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6557         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6558     12  AM-GPCD                           PIC 99.
  6559     12  AM-IG                             PIC X.
  6560         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6561         88  AM-HAS-GROUP                     VALUE '2'.
  6562     12  AM-STATUS                         PIC X.
  6563         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6564         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6565         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6566         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6567         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6568         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6569     12  AM-REMIT-TO                       PIC 99.
  6570     12  AM-ID-NO                          PIC X(11).
  6571
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 125
* EL156.cbl
  6572     12  AM-CAL-TABLE                      PIC XX.
  6573     12  AM-LF-DEVIATION                   PIC XXX.
  6574     12  AM-AH-DEVIATION                   PIC XXX.
  6575     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6576     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6577     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6578     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6579     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6580     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6581
  6582     12  AM-USER-FIELDS.
  6583         16  AM-FLD-1                      PIC XX.
  6584         16  AM-FLD-2                      PIC XX.
  6585         16  AM-FLD-3                      PIC XX.
  6586         16  AM-FLD-4                      PIC XX.
  6587         16  AM-FLD-5                      PIC XX.
  6588
  6589     12  AM-1ST-PROD-DATE.
  6590         16  AM-1ST-PROD-YR                PIC XX.
  6591         16  AM-1ST-PROD-MO                PIC XX.
  6592         16  AM-1ST-PROD-DA                PIC XX.
  6593     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6594     12  AM-CERTS-PURGED-DATE.
  6595         16  AM-PUR-YR                     PIC XX.
  6596         16  AM-PUR-MO                     PIC XX.
  6597         16  AM-PUR-DA                     PIC XX.
  6598     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6599     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6600     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6601     12  AM-INACTIVE-DATE.
  6602         16  AM-INA-MO                     PIC 99.
  6603         16  AM-INA-DA                     PIC 99.
  6604         16  AM-INA-YR                     PIC 99.
  6605     12  AM-AR-HI-CERT-DATE                PIC XX.
  6606
  6607     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6608     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6609
  6610     12  AM-OB-PAYMENT-MODE                PIC X.
  6611         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6612         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6613         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6614         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6615
  6616     12  AM-AH-ONLY-INDICATOR              PIC X.
  6617         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6618         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6619
  6620     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6621
  6622     12  AM-OVER-SHORT.
  6623         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6624         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6625
  6626     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6627     12  AM-DCC-CLP-STATE                  PIC XX.
  6628
  6629     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 126
* EL156.cbl
  6630     12  AM-RECALC-REIN                    PIC X.
  6631
  6632     12  AM-REI-TABLE                      PIC XXX.
  6633     12  AM-REI-ET-LF                      PIC X.
  6634     12  AM-REI-ET-AH                      PIC X.
  6635     12  AM-REI-PE-LF                      PIC X.
  6636     12  AM-REI-PE-AH                      PIC X.
  6637     12  AM-REI-PRT-ST                     PIC X.
  6638     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6639     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6640     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6641     12  AM-REI-GROUP-A                    PIC X(6).
  6642     12  AM-REI-MORT                       PIC X(4).
  6643     12  AM-REI-PRT-OW                     PIC X.
  6644     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6645     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6646     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6647     12  AM-REI-GROUP-B                    PIC X(6).
  6648
  6649     12  AM-TRUST-TYPE                     PIC X(2).
  6650
  6651     12  AM-EMPLOYER-STMT-USED             PIC X.
  6652     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6653
  6654     12  AM-STD-AH-TYPE                    PIC XX.
  6655     12  AM-EARN-METHODS.
  6656         16  AM-EARN-METHOD-R              PIC X.
  6657             88 AM-REF-RL-R78                 VALUE 'R'.
  6658             88 AM-REF-RL-PR                  VALUE 'P'.
  6659             88 AM-REF-RL-MEAN                VALUE 'M'.
  6660             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6661         16  AM-EARN-METHOD-L              PIC X.
  6662             88 AM-REF-LL-R78                 VALUE 'R'.
  6663             88 AM-REF-LL-PR                  VALUE 'P'.
  6664             88 AM-REF-LL-MEAN                VALUE 'M'.
  6665             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6666         16  AM-EARN-METHOD-A              PIC X.
  6667             88 AM-REF-AH-R78                 VALUE 'R'.
  6668             88 AM-REF-AH-PR                  VALUE 'P'.
  6669             88 AM-REF-AH-MEAN                VALUE 'M'.
  6670             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6671             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6672             88 AM-REF-AH-NET                 VALUE 'N'.
  6673
  6674     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6675     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6676     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6677
  6678     12  AM-RET-Y-N                        PIC X.
  6679     12  AM-RET-P-E                        PIC X.
  6680     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6681     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6682     12  AM-RET-GRP                        PIC X(6).
  6683     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6684         16  AM-POOL-PRIME                 PIC XXX.
  6685         16  AM-POOL-SUB                   PIC XXX.
  6686     12  AM-RETRO-EARNINGS.
  6687         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 127
* EL156.cbl
  6688         16  AM-RET-EARN-L                 PIC X.
  6689         16  AM-RET-EARN-A                 PIC X.
  6690     12  AM-RET-ST-TAX-USE                 PIC X.
  6691         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6692         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6693     12  AM-RETRO-BEG-EARNINGS.
  6694         16  AM-RET-BEG-EARN-R             PIC X.
  6695         16  AM-RET-BEG-EARN-L             PIC X.
  6696         16  AM-RET-BEG-EARN-A             PIC X.
  6697     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6698     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6699
  6700     12  AM-USER-SELECT-OPTIONS.
  6701         16  AM-USER-SELECT-1              PIC X(10).
  6702         16  AM-USER-SELECT-2              PIC X(10).
  6703         16  AM-USER-SELECT-3              PIC X(10).
  6704         16  AM-USER-SELECT-4              PIC X(10).
  6705         16  AM-USER-SELECT-5              PIC X(10).
  6706
  6707     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6708
  6709     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6710
  6711     12  AM-RPT045A-SWITCH                 PIC X.
  6712         88  RPT045A-OFF                   VALUE 'N'.
  6713
  6714     12  AM-INSURANCE-LIMITS.
  6715         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6716         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6717
  6718     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6719         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6720
  6721     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6722         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6723         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6724
  6725     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6726
  6727     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6728     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6729     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6730     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6731     12  AM-DCC-UEF-STATE                  PIC XX.
  6732     12  FILLER                            PIC XXX.
  6733     12  AM-REPORT-CODE-3                  PIC X(10).
  6734*    12  FILLER                            PIC X(22).
  6735
  6736     12  AM-RESERVE-DATE.
  6737         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6738         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6739         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6740
  6741     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6742     12  AM-NOTIFICATION-TYPES.
  6743         16  AM-NOTIF-OF-LETTERS           PIC X.
  6744         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6745         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 128
* EL156.cbl
  6746         16  AM-NOTIF-OF-STATUS            PIC X.
  6747
  6748     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6749         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6750         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6751         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6752         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6753
  6754     12  AM-BENEFIT-CONTROLS.
  6755         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6756             20  AM-BENEFIT-CODE           PIC XX.
  6757             20  AM-BENEFIT-TYPE           PIC X.
  6758             20  AM-BENEFIT-REVISION       PIC XXX.
  6759             20  AM-BENEFIT-REM-TERM       PIC X.
  6760             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6761             20  FILLER                    PIC XX.
  6762         16  FILLER                        PIC X(80).
  6763
  6764     12  AM-TRANSFER-DATA.
  6765         16  AM-TRANSFERRED-FROM.
  6766             20  AM-TRNFROM-CARRIER        PIC X.
  6767             20  AM-TRNFROM-GROUPING.
  6768                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6769                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6770             20  AM-TRNFROM-STATE          PIC XX.
  6771             20  AM-TRNFROM-ACCOUNT.
  6772                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6773                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6774             20  AM-TRNFROM-DTE            PIC XX.
  6775         16  AM-TRANSFERRED-TO.
  6776             20  AM-TRNTO-CARRIER          PIC X.
  6777             20  AM-TRNTO-GROUPING.
  6778                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6779                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6780             20  AM-TRNTO-STATE            PIC XX.
  6781             20  AM-TRNTO-ACCOUNT.
  6782                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6783                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6784             20  AM-TRNTO-DTE              PIC XX.
  6785         16  FILLER                        PIC X(10).
  6786
  6787     12  AM-SAVED-REMIT-TO                 PIC 99.
  6788
  6789     12  AM-COMM-STRUCTURE-SAVED.
  6790         16  AM-DEFN-1-SAVED.
  6791             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6792                 24  AM-AGT-SV             PIC X(10).
  6793                 24  AM-COM-TYP-SV         PIC X.
  6794                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6795                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6796                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6797                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6798                 24  FILLER                PIC X.
  6799                 24  AM-GL-CODES-SV        PIC X.
  6800                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6801                 24  FILLER                PIC X.
  6802         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6803             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 129
* EL156.cbl
  6804                 24  FILLER                PIC X(11).
  6805                 24  AM-L-COMA-SV          PIC XXX.
  6806                 24  AM-J-COMA-SV          PIC XXX.
  6807                 24  AM-A-COMA-SV          PIC XXX.
  6808                 24  FILLER                PIC X(6).
  6809
  6810     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6811         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6812            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6813            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6814            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6815
  6816     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6817     12  FILLER                            PIC X(120).
  6818
  6819     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6820         16  AM-CONTROL-NAME               PIC X(30).
  6821         16  AM-EXECUTIVE-ONE.
  6822             20  AM-EXEC1-NAME             PIC X(15).
  6823             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6824                                                          COMP-3.
  6825             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6826                                                          COMP-3.
  6827         16  AM-EXECUTIVE-TWO.
  6828             20  AM-EXEC2-NAME             PIC X(15).
  6829             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6830                                                          COMP-3.
  6831             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6832                                                          COMP-3.
  6833
  6834     12  AM-RETRO-ADDITIONAL-DATA.
  6835         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6836         16  AM-RETRO-PREM-P-E             PIC X.
  6837         16  AM-RETRO-CLMS-P-I             PIC X.
  6838         16  AM-RETRO-RET-BRACKET-LF.
  6839             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6840                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6841                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6842             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6843                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6844                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6845             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6846                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6847                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6848         16  AM-RETRO-RET-BRACKET-AH.
  6849             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6850                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6851                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6852                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6853             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6854                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6855                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6856             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6857                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6858                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6859
  6860     12  AM-COMMENTS.
  6861         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 130
* EL156.cbl
  6862
  6863     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6864         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6865         16  AM-FLI-BILLING-CODE           PIC X.
  6866         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6867         16  AM-FLI-UNITED-IDENT           PIC X.
  6868         16  AM-FLI-INTEREST-LOST-DATA.
  6869             20  AM-FLI-BANK-NO            PIC X(5).
  6870             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6871             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6872             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6873         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6874             20  AM-FLI-AGT                PIC X(9).
  6875             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6876             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6877         16  FILLER                        PIC X(102).
  6878
  6879     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6880         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6881             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6882             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6883             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6884             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6885             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6886         16  FILLER                          PIC X(10).
  6887******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 131
* EL156.cbl
  6889*    COPY ELCCHKQ.
  6890******************************************************************
  6891*                                                                *
  6892*                                                                *
  6893*                            ELCCHKQ.                            *
  6894*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6895*                            VMOD=2.007                          *
  6896*                                                                *
  6897*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6898*                                                                *
  6899*   FILE TYPE = VSAM,KSDS                                        *
  6900*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6901*                                                                *
  6902*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6903*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6904*                                                                *
  6905*   LOG = YES                                                    *
  6906*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6907******************************************************************
  6908 01  CHECK-QUE.
  6909     12  CQ-RECORD-ID                PIC XX.
  6910         88  VALID-CQ-ID         VALUE 'CQ'.
  6911
  6912     12  CQ-CONTROL-PRIMARY.
  6913         16  CQ-COMPANY-CD           PIC X.
  6914         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6915         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6916
  6917     12  CQ-CONTROL-BY-PAYEE.
  6918         16  CQ-CONTROL-BY-NUMBER.
  6919             20  CQ-COMPANY-CD-A1     PIC X.
  6920             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6921         16  CQ-PAYEE-CARRIER        PIC X.
  6922         16  CQ-PAYEE-GROUPING       PIC X(6).
  6923         16  CQ-PAYEE-STATE          PIC XX.
  6924         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6925         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6926
  6927     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6928         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6929         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6930         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6931         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6932         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6933         16  FILLER                  PIC X(3).
  6934
  6935     12  CQ-ENTRY-TYPE               PIC X.
  6936             88  CHECK-ON-QUE           VALUE 'Q'.
  6937             88  ALIGNMENT-CHECK        VALUE 'A'.
  6938             88  SPOILED-CHECK          VALUE 'S'.
  6939             88  PAYMENT-ABORTED        VALUE 'X'.
  6940
  6941     12  CQ-CLAIM-MAST-CNTL.
  6942         16  CQ-CARRIER              PIC X.
  6943         16  CQ-CLAIM-NO             PIC X(7).
  6944         16  CQ-CERT-NO.
  6945             20  CQ-CERT-PRIME       PIC X(10).
  6946             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 132
* EL156.cbl
  6947         16  CQ-CLAIM-TYPE           PIC X.
  6948             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6949             88  CQ-AH-CLAIM            VALUE 'A'.
  6950         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6951             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6952             88  CQ-O-B-COVERAGE        VALUE '2'.
  6953             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6954
  6955     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6956     12  CQ-CHECK-NUMBER             PIC X(7).
  6957     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6958     12  CQ-PAYMENT-TYPE             PIC X.
  6959             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6960             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6961             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6962             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6963             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6964             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6965             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6966             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6967     12  CQ-VOID-INDICATOR           PIC X.
  6968             88  CHECK-IS-STOPPED          VALUE 'S'.
  6969             88  CHECK-IS-VOID             VALUE 'V'.
  6970     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6971     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6972     12  CQ-CHECK-BY-USER            PIC X(4).
  6973     12  CQ-PRE-NUMBERING-SW         PIC X.
  6974       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6975       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6976
  6977     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6978     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6979     12  CQ-LEDGER-FLAG              PIC X(01).
  6980     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6981     12  CQ-LAST-UPDATED-DT          PIC XX.
  6982     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6983     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6984
  6985     12  FILLER                      PIC X(04).
  6986
  6987******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 133
* EL156.cbl
  6989*    COPY ELCBENE.
  6990******************************************************************
  6991*                                                                *
  6992*                            ELCBENE.                            *
  6993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6994*                            VMOD=2.006                          *
  6995*                                                                *
  6996*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6997*                                                                *
  6998*   FILE TYPE = VSAM,KSDS                                        *
  6999*   RECORD SIZE = 500   RECFORM = FIX                            *
  7000*                                                                *
  7001*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7002*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7003*                                                                *
  7004*   LOG = YES                                                    *
  7005*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7006*                                                                *
  7007*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7008******************************************************************
  7009
  7010 01  BENEFICIARY-MASTER.
  7011     12  BE-RECORD-ID                PIC XX.
  7012         88  VALID-BE-ID                VALUE 'BE'.
  7013
  7014     12  BE-CONTROL-PRIMARY.
  7015         16  BE-COMPANY-CD           PIC X.
  7016         16  BE-RECORD-TYPE          PIC X.
  7017             88  BENEFICIARY-RECORD  VALUE 'B'.
  7018             88  ADJUSTOR-RECORD     VALUE 'A'.
  7019         16  BE-BENEFICIARY          PIC X(10).
  7020     12  BE-CONTROL-BY-NAME.
  7021         16  BE-COMPANY-CD-A1        PIC X.
  7022         16  BE-RECORD-TYPE-A1       PIC X.
  7023         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7024         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7025
  7026     12  BE-LAST-MAINT-DT            PIC XX.
  7027     12  BE-LAST-MAINT-BY            PIC X(4).
  7028     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7029
  7030     12  BE-ADDRESS-DATA.
  7031         16  BE-MAIL-TO-NAME         PIC X(30).
  7032         16  BE-ADDRESS-LINE-1       PIC X(30).
  7033         16  BE-ADDRESS-LINE-2       PIC X(30).
  7034         16  BE-ADDRESS-LINE-3       PIC X(30).
  7035         16  BE-CITY-STATE.
  7036             20  BE-CITY             PIC X(28).
  7037             20  BE-STATE            PIC XX.
  7038         16  BE-ZIP-CODE.
  7039             20  BE-ZIP-PRIME.
  7040                 24  BE-ZIP-1ST      PIC X.
  7041                     88  BE-CANADIAN-POST-CODE
  7042                                         VALUE 'A' THRU 'Z'.
  7043                 24  FILLER          PIC X(4).
  7044             20  BE-ZIP-PLUS4        PIC X(4).
  7045         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7046             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 134
* EL156.cbl
  7047             20  BE-CAN-POSTAL-2     PIC XXX.
  7048             20  FILLER              PIC XXX.
  7049         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7050         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7051
  7052******************************************************************
  7053*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7054*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7055******************************************************************
  7056     12  BE-CARRIER                  PIC X.
  7057
  7058     12  BE-ADDRESS-DATA2.
  7059         16  BE-MAIL-TO-NAME2        PIC X(30).
  7060         16  BE-ADDRESS-LINE-12      PIC X(30).
  7061         16  BE-ADDRESS-LINE-22      PIC X(30).
  7062         16  BE-ADDRESS-LINE-32      PIC X(30).
  7063         16  BE-CITY-STATE2.
  7064             20  BE-CITY2            PIC X(28).
  7065             20  BE-STATE2           PIC XX.
  7066         16  BE-ZIP-CODE2.
  7067             20  BE-ZIP-PRIME2.
  7068                 24  BE-ZIP-1ST2     PIC X.
  7069                     88  BE-CANADIAN-POST-CODE2
  7070                                         VALUE 'A' THRU 'Z'.
  7071                 24  FILLER          PIC X(4).
  7072             20  BE-ZIP-PLUS42       PIC X(4).
  7073         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7074             20  BE-CAN-POSTAL-12    PIC XXX.
  7075             20  BE-CAN-POSTAL-22    PIC XXX.
  7076             20  FILLER              PIC XXX.
  7077         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7078         16  BE-BILLING-STMT-DATA.
  7079             20  BE-BSR              PIC X.
  7080                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7081                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7082             20  BE-BSR-FROM         PIC X(30).
  7083             20  BE-BSR-DEPT         PIC X(30).
  7084             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7085             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7086             20  BE-OUTPUT-TYPE      PIC X.
  7087                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7088                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7089
  7090     12  FILLER                      PIC X(28).
  7091******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 135
* EL156.cbl
  7093*    COPY ELCARCH.
  7094******************************************************************
  7095*                                                                *
  7096*                            ELCARCH.                            *
  7097*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7098*                            VMOD=2.007                          *
  7099*                                                                *
  7100*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7101*                                                                *
  7102*   FILE TYPE = VSAM,KSDS                                        *
  7103*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7104*                                                                *
  7105*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7106*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7107*                                                                *
  7108*   LOG = NO                                                     *
  7109*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7110*                                                                *
  7111*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7112******************************************************************
  7113 01  LETTER-ARCHIVE.
  7114     12  LA-RECORD-ID                PIC XX.
  7115         88  VALID-LA-ID                VALUE 'LA'.
  7116
  7117     12  LA-CONTROL-PRIMARY.
  7118         16  LA-COMPANY-CD           PIC X.
  7119         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7120         16  LA-RECORD-TYPE          PIC X.
  7121             88  LA-HEADER-DATA         VALUE '1'.
  7122             88  LA-ADDRESS-DATA        VALUE '2'.
  7123             88  LA-TEXT-DATA           VALUE '3'.
  7124             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7125         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7126
  7127     12  LA-CONTROL-BY-TYPE.
  7128         16  LA-COMPANY-CD-A1        PIC X.
  7129         16  LA-RECORD-TYPE-A1       PIC X.
  7130         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7131         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7132
  7133     12  LA-TEXT-RECORD.
  7134         16  LA-SKIP-CONTROL         PIC XX.
  7135             88  NO-LINES-SKIPPED       VALUE SPACES.
  7136             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7137         16  LA-TEXT-LINE            PIC X(70).
  7138
  7139     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7140         16  FILLER                  PIC XX.
  7141         16  LA-ADDRESS-LINE         PIC X(30).
  7142         16  FILLER                  PIC X(40).
  7143
  7144     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7145         16  FILLER                  PIC XX.
  7146         16  LA-CARRIER              PIC X.
  7147         16  LA-CLAIM-NO             PIC X(7).
  7148         16  LA-CERT-NO.
  7149             20  LA-CERT-PRIME       PIC X(10).
  7150             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 136
* EL156.cbl
  7151         16  LA-NO-OF-COPIES         PIC S9.
  7152         16  LA-RESEND-DATE          PIC XX.
  7153         16  LA-PROCESSOR-CD         PIC X(4).
  7154         16  LA-CREATION-DT          PIC XX.
  7155         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7156         16  LA-RESEND-PRINT-DATE    PIC XX.
  7157         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7158         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7159*
  7160* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7161*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7162*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7163*   I        20  LA-DMD-RES-ST           PIC XX.
  7164*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7165*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7166*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7167*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7168*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7169*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7170*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7171*   I        20  LA-DMD-UND-CODE         PIC XX.
  7172*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7173*   V    16  FILLER                  PIC X(15).
  7174* -----
  7175*
  7176* REINSERTED  CSO  MODS
  7177*
  7178         16  FILLER.
  7179             20  FILLER                  PIC X(29).
  7180             20  LA-CSO-LETTER-STATUS    PIC X.
  7181                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7182                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7183                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7184             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7185             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7186*
  7187
  7188     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7189         16  FILLER                  PIC XX.
  7190         16  LA4-CARRIER             PIC X.
  7191         16  LA4-CLAIM-NO            PIC X(7).
  7192         16  LA4-CERT-NO.
  7193             20  LA4-CERT-PRIME      PIC X(10).
  7194             20  LA4-CERT-SFX        PIC X.
  7195         16  LA4-NO-OF-COPIES        PIC S9.
  7196         16  LA4-RESEND-DATE         PIC XX.
  7197         16  LA4-PROCESSOR-CD        PIC X(4).
  7198         16  LA4-CREATION-DT         PIC XX.
  7199         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7200         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7201         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7202         16  LA4-FORM-TYPE           PIC X.
  7203             88  LA4-INITIAL-FORM    VALUE '1'.
  7204             88  LA4-PROGRESS-FORM   VALUE '2'.
  7205         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7206         16  LA4-STATE               PIC X(02).
  7207         16  FILLER                  PIC X(31).
  7208******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 137
* EL156.cbl
  7210*    COPY ELCDAR.
  7211******************************************************************
  7212*                                                                *
  7213*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7214*   FILE TYPE = VSAM,KSDS                                        *
  7215*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7216*   BASE CLUSTER = DLYACTV                                       *
  7217*   LOG = YES                                                    *
  7218*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7219*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7220*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7221*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7222*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7223*               BY PROGRAM "LGINFCE".                            *
  7224*                                                                *
  7225******************************************************************
  7226 01  DAILY-ACTIVITY-RECORD.
  7227     05  DA-KEY.
  7228         10  DA-COMP-CD          PIC X.
  7229         10  DA-CARRIER          PIC X.
  7230         10  DA-CLAIM-NO         PIC X(7).
  7231         10  DA-CERT-NO.
  7232             15  DA-CERT-PRIME   PIC X(10).
  7233             15  DA-CERT-SFX     PIC X.
  7234     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7235     05  DA-RECORD-TYPE          PIC X.
  7236     05  FILLER                  PIC X(2).
  7237******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 138
* EL156.cbl
  7239*    COPY ERCCOMP.
  7240******************************************************************
  7241*                                                                *
  7242*                                                                *
  7243*                            ERCCOMP                             *
  7244*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7245*                            VMOD=2.019                          *
  7246*                                                                *
  7247*   ONLINE CREDIT SYSTEM                                         *
  7248*                                                                *
  7249*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7250*                                                                *
  7251*   FILE TYPE = VSAM,KSDS                                        *
  7252*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7253*                                                                *
  7254*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7255*       ALTERNATE PATH = NONE                                    *
  7256*                                                                *
  7257*   LOG = NO                                                     *
  7258*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7259*                                                                *
  7260******************************************************************
  7261*                   C H A N G E   L O G
  7262*
  7263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7264*-----------------------------------------------------------------
  7265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7266* EFFECTIVE    NUMBER
  7267*-----------------------------------------------------------------
  7268* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7269* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7270* 092205    2005050300006  PEMA  ADD LEASE FEE
  7271* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7272* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7273* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7274* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7275* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7276* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7277******************************************************************
  7278
  7279 01  COMPENSATION-MASTER.
  7280     12  CO-RECORD-ID                          PIC XX.
  7281         88  VALID-CO-ID                          VALUE 'CO'.
  7282
  7283     12  CO-CONTROL-PRIMARY.
  7284         16  CO-COMPANY-CD                     PIC X.
  7285         16  CO-CONTROL.
  7286             20  CO-CTL-1.
  7287                 24  CO-CARR-GROUP.
  7288                     28  CO-CARRIER            PIC X.
  7289                     28  CO-GROUPING.
  7290                         32  CO-GROUP-PREFIX   PIC XXX.
  7291                         32  CO-GROUP-PRIME    PIC XXX.
  7292                 24  CO-RESP-NO.
  7293                     28  CO-RESP-PREFIX        PIC X(4).
  7294                     28  CO-RESP-PRIME         PIC X(6).
  7295             20  CO-CTL-2.
  7296                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 139
* EL156.cbl
  7297                     28  CO-ACCT-PREFIX        PIC X(4).
  7298                     28  CO-ACCT-PRIME         PIC X(6).
  7299         16  CO-TYPE                           PIC X.
  7300             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7301             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7302             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7303
  7304     12  CO-MAINT-INFORMATION.
  7305         16  CO-LAST-MAINT-DT                  PIC XX.
  7306         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7307         16  CO-LAST-MAINT-USER                PIC X(4).
  7308     12  FILLER                                PIC XX.
  7309     12  CO-STMT-TYPE                          PIC XXX.
  7310     12  CO-COMP-TYPE                          PIC X.
  7311         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7312     12  CO-STMT-OWNER                         PIC X(4).
  7313     12  CO-BALANCE-CONTROL                    PIC X.
  7314         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7315         88  CO-NO-BALANCE                        VALUE 'N'.
  7316
  7317     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7318         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7319         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7320         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7321
  7322     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7323         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7324         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7325
  7326     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7327     12  CO-GA-DIRECT-DEP                      PIC X.
  7328     12  CO-FUTURE-SPACE                       PIC X.
  7329         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7330
  7331     12  CO-ACCT-NAME                          PIC X(30).
  7332     12  CO-MAIL-NAME                          PIC X(30).
  7333     12  CO-ADDR-1                             PIC X(30).
  7334     12  CO-ADDR-2                             PIC X(30).
  7335     12  CO-ADDR-3.
  7336         16  CO-ADDR-CITY                      PIC X(27).
  7337         16  CO-ADDR-STATE                     PIC XX.
  7338     12  CO-CSO-1099                           PIC X.
  7339     12  CO-ZIP.
  7340         16  CO-ZIP-PRIME.
  7341             20  CO-ZIP-PRI-1ST                PIC X.
  7342                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7343             20  FILLER                        PIC X(4).
  7344         16  CO-ZIP-PLUS4                      PIC X(4).
  7345     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7346         16  CO-CAN-POSTAL-1                   PIC XXX.
  7347         16  CO-CAN-POSTAL-2                   PIC XXX.
  7348         16  FILLER                            PIC XXX.
  7349     12  CO-SOC-SEC                            PIC X(13).
  7350     12  CO-TELEPHONE.
  7351         16  CO-AREA-CODE                      PIC XXX.
  7352         16  CO-PREFIX                         PIC XXX.
  7353         16  CO-PHONE                          PIC X(4).
  7354
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 140
* EL156.cbl
  7355     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7356
  7357     12  CO-AR-BAL-LEVEL                       PIC X.
  7358         88  CO-AR-REF-LVL                        VALUE '1'.
  7359         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7360         88  CO-AR-BILL-LVL                       VALUE '2'.
  7361         88  CO-AR-AGT-LVL                        VALUE '3'.
  7362         88  CO-AR-FR-LVL                         VALUE '4'.
  7363
  7364     12  CO-AR-NORMAL-PRINT                    PIC X.
  7365         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7366         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7367
  7368     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7369
  7370     12  CO-AR-REPORTING                       PIC X.
  7371         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7372         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7373
  7374     12  CO-AR-PULL-CHECK                      PIC X.
  7375         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7376         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7377
  7378     12  CO-AR-BALANCE-PRINT                   PIC X.
  7379         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7380
  7381     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7382         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7383         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7384         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7385
  7386     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7387
  7388     12  CO-USER-CODE                          PIC X.
  7389     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7390
  7391******************************************************************
  7392*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7393*    THE LAST MONTH END RUN.
  7394******************************************************************
  7395
  7396     12  CO-LAST-ACTIVITY-DATE.
  7397         16  CO-ACT-YEAR                       PIC 99.
  7398         16  CO-ACT-MONTH                      PIC 99.
  7399         16  CO-ACT-DAY                        PIC 99.
  7400
  7401     12  CO-LAST-STMT-DT.
  7402         16  CO-LAST-STMT-YEAR                 PIC 99.
  7403         16  CO-LAST-STMT-MONTH                PIC 99.
  7404         16  CO-LAST-STMT-DAY                  PIC 99.
  7405
  7406     12  CO-MO-END-TOTALS.
  7407         16  CO-MONTHLY-TOTALS.
  7408             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7409             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7410             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7411             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7412             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 141
* EL156.cbl
  7413
  7414         16  CO-AGING-TOTALS.
  7415             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7416             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7417             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7418             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7419
  7420         16  CO-YTD-TOTALS.
  7421             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7422             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7423
  7424         16  CO-OVER-UNDER-TOTALS.
  7425             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7426             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7427
  7428     12  CO-MISCELLANEOUS-TOTALS.
  7429         16  CO-FICA-TOTALS.
  7430             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7431             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7432
  7433         16  CO-CLAIM-TOTALS.
  7434             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7435             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7436
  7437******************************************************************
  7438*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7439*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7440******************************************************************
  7441
  7442     12  CO-CURRENT-TOTALS.
  7443         16  CO-CURRENT-LAST-STMT-DT.
  7444             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7445             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7446             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7447
  7448         16  CO-CURRENT-MONTHLY-TOTALS.
  7449             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7450             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7451             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7452             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7453             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7454
  7455         16  CO-CURRENT-AGING-TOTALS.
  7456             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7457             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7458             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7459             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7460
  7461         16  CO-CURRENT-YTD-TOTALS.
  7462             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7463             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7464
  7465     12  CO-PAID-COMM-TOTALS.
  7466         16  CO-YTD-PAID-COMMS.
  7467             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7468             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7469
  7470     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 142
* EL156.cbl
  7471         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7472         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7473
  7474     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7475         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7476         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7477         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7478         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7479         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7480         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7481         88  CO-FINAL-LETTER                  VALUE 'F'.
  7482         88  CO-RECONCILING                   VALUE 'R'.
  7483         88  CO-PHONE-CALL                    VALUE 'P'.
  7484         88  CO-LEGAL                         VALUE 'L'.
  7485         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7486         88  CO-WRITE-OFF                     VALUE 'W'.
  7487         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7488
  7489     12  CO-CSR-CODE                       PIC X(4).
  7490
  7491     12  CO-GA-STATUS-INFO.
  7492         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7493         16  CO-GA-TERMINATION-DT          PIC XX.
  7494         16  CO-GA-STATUS-CODE             PIC X.
  7495             88  CO-GA-ACTIVE                 VALUE 'A'.
  7496             88  CO-GA-INACTIVE               VALUE 'I'.
  7497             88  CO-GA-PENDING                VALUE 'P'.
  7498         16  CO-GA-COMMENTS.
  7499             20  CO-GA-COMMENT-1           PIC X(40).
  7500             20  CO-GA-COMMENT-2           PIC X(40).
  7501             20  CO-GA-COMMENT-3           PIC X(40).
  7502             20  CO-GA-COMMENT-4           PIC X(40).
  7503
  7504     12  CO-RPTCD2                         PIC X(10).
  7505     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7506         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7507         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7508
  7509     12  CO-TYPE-AGENT                     PIC X(01).
  7510         88  CO-CORPORATION                   VALUE 'C'.
  7511         88  CO-PARTNERSHIP                   VALUE 'P'.
  7512         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7513         88  CO-TRUST                         VALUE 'T'.
  7514         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7515
  7516     12  CO-FAXNO.
  7517         16  CO-FAX-AREA-CODE                  PIC XXX.
  7518         16  CO-FAX-PREFIX                     PIC XXX.
  7519         16  CO-FAX-PHONE                      PIC X(4).
  7520
  7521     12  CO-BANK-INFORMATION.
  7522         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7523         16  CO-BANK-TRANSIT-NON REDEFINES
  7524             CO-BANK-TRANSIT-NO                PIC 9(8).
  7525
  7526         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7527     12  CO-MISC-DEDUCT-INFO REDEFINES
  7528                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 143
* EL156.cbl
  7529         16  CO-MD-GL-ACCT                     PIC X(10).
  7530         16  CO-MD-DIV                         PIC XX.
  7531         16  CO-MD-CENTER                      PIC X(4).
  7532         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7533         16  CO-CREATE-AP-CHECK                PIC X.
  7534         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7535         16  FILLER                            PIC XXX.
  7536     12  CO-ACH-STATUS                         PIC X.
  7537         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7538         88  CO-ACH-PENDING                        VALUE 'P'.
  7539
  7540     12  CO-BILL-SW                            PIC X.
  7541     12  CO-CONTROL-NAME                       PIC X(30).
  7542     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7543     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7544     12  CO-CLP-STATE                          PIC XX.
  7545     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7546     12  CO-SPP-REFUND-EDIT                    PIC X.
  7547
  7548******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 144
* EL156.cbl
  7550*    COPY ERCDMDNT.
  7551******************************************************************
  7552*                                                                *
  7553*                            ERCDMDNT                            *
  7554*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7555*                            VMOD=2.005                          *
  7556*                                                                *
  7557*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7558*                                                                *
  7559*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7560*                                                                *
  7561*        FILE TYPE= VSAM,KSDS                                    *
  7562*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7563*                                                                *
  7564*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7565*                                                                *
  7566*        LOG = YES                                               *
  7567*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7568*                                                                *
  7569******************************************************************
  7570
  7571 01  CERTIFICATE-NOTE.
  7572     12  CN-RECORD-ID                     PIC  XX.
  7573         88  VALID-CN-ID                      VALUE 'CN'.
  7574
  7575     12  CN-CONTROL-PRIMARY.
  7576         16  CN-COMPANY-CD                PIC X.
  7577         16  CN-CERT-KEY.
  7578             20  CN-CARRIER               PIC X.
  7579             20  CN-GROUPING.
  7580                 24  CN-GROUPING-PREFIX   PIC XXX.
  7581                 24  CN-GROUPING-PRIME    PIC XXX.
  7582             20  CN-STATE                 PIC XX.
  7583             20  CN-ACCOUNT.
  7584                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7585                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7586             20  CN-CERT-EFF-DT           PIC XX.
  7587             20  CN-CERT-NO.
  7588                 24  CN-CERT-PRIME        PIC X(10).
  7589                 24  CN-CERT-SFX          PIC X.
  7590
  7591     12  CN-BILLING-START-LINE-NO         PIC 99.
  7592     12  CN-BILLING-END-LINE-NO           PIC 99.
  7593
  7594     12  CN-LINES.
  7595         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7596
  7597     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7598         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7599         16  CN-CSI-GENERAL-DATA-AREA.
  7600             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7601
  7602         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7603             CN-CSI-GENERAL-DATA-AREA.
  7604             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7605             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7606             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7607             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 145
* EL156.cbl
  7608             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7609             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7610             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7611             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7612             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7613             20  FILLER                       PIC XX.
  7614             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7615             20  FILLER                       PIC X(38).
  7616
  7617         16  CN-CSI-PRODUCT-DATA-AREA.
  7618             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7619
  7620         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7621             CN-CSI-PRODUCT-DATA-AREA.
  7622             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7623             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7624             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7625             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7626             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7627             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7628             20  FILLER                   PIC XX.
  7629             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7630             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7631             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7632             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7633             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7634             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7635             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7636             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7637             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7638             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7639             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7640             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7641             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7642             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7643             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7644             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7645             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7646             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7647             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7648             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7649             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7650             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7651             20  FILLER                   PIC X(25).
  7652
  7653         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7654             CN-CSI-CREDIT-CARD-DATA.
  7655             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7656             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7657             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7658             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7659             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7660             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7661             20  FILLER                   PIC XX.
  7662             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7663             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7664             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7665             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 146
* EL156.cbl
  7666             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7667             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7668             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7669             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7670             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7671             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7672             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7673             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7674             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7675             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7676             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7677             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7678             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7679             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7680             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7681             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7682             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7683             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7684             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7685             20  FILLER                   PIC X(17).
  7686
  7687         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7688             CN-CSI-FAMILY-LEAVE-DATA.
  7689             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7690             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7691             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7692             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7693             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7694             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7695             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7696             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7697             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7698             20  CN-CSI-SL-INT-ON-PROCEEDS
  7699                                          PIC S9(5)V99  COMP-3.
  7700             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7701             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7702             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7703             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7704             20  CN-CSI-SL-POLICY-BENEFITS
  7705                                          PIC S9(5)V99  COMP-3.
  7706             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7707             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7708             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7709             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7710             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7711             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7712             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7713             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7714             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7715             20  CN-CSI-SL-STATE-NOT      PIC X.
  7716             20  FILLER                   PIC XX.
  7717
  7718         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7719             CN-CSI-SENIOR-LIFE-DATA.
  7720             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7721             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7722             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7723                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 147
* EL156.cbl
  7724             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7725             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7726             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7727             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7728             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7729             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7730             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7731             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7732             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7733             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7734             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7735             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7736             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7737             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7738             20  CN-CSI-PP-REPAIR         PIC X.
  7739             20  CN-CSI-PP-REPLACE        PIC X.
  7740             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7741             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7742             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7743             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7744             20  FILLER                   PIC X(5).
  7745
  7746         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7747             CN-CSI-PURCH-PROP-DATA.
  7748             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7749             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7750             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7751             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7752             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7753             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7754             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7755             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7756             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7757             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7758             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7759             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7760             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7761             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7762             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7763             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7764             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7765             20  CN-CSI-EW-REPLACE        PIC X.
  7766             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7767             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7768             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7769             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7770             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7771             20  FILLER                   PIC X(4).
  7772
  7773     12  CN-LAST-MAINT-DT                 PIC XX.
  7774     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7775     12  CN-LAST-MAINT-USER               PIC X(4).
  7776     12  FILLER                           PIC X(6).
  7777
  7778******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 148
* EL156.cbl
  7780*    COPY ERCCNOT.
  7781******************************************************************
  7782*                                                                *
  7783*                            ERCCNOT                             *
  7784*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7785*                            VMOD=2.003                          *
  7786*                                                                *
  7787*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7788*                                                                *
  7789*        FILE TYPE= VSAM,KSDS                                    *
  7790*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7791*                                                                *
  7792*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7793*                                                                *
  7794*        LOG = YES                                               *
  7795*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7796*                                                                *
  7797******************************************************************
  7798*                   C H A N G E   L O G
  7799*
  7800* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7801*-----------------------------------------------------------------
  7802*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7803* EFFECTIVE    NUMBER
  7804*-----------------------------------------------------------------
  7805* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7806******************************************************************
  7807
  7808 01  CERT-NOTE-FILE.
  7809     12  CZ-RECORD-ID                PIC  XX.
  7810         88  VALID-CZ-ID                  VALUE 'CZ'.
  7811
  7812     12  CZ-CONTROL-PRIMARY.
  7813         16  CZ-COMPANY-CD           PIC X.
  7814         16  CZ-CARRIER              PIC X.
  7815         16  CZ-GROUPING.
  7816             20 CZ-GROUPING-PREFIX   PIC XXX.
  7817             20 CZ-GROUPING-PRIME    PIC XXX.
  7818         16  CZ-STATE                PIC XX.
  7819         16  CZ-ACCOUNT.
  7820             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7821             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7822         16  CZ-CERT-EFF-DT          PIC XX.
  7823         16  CZ-CERT-NO.
  7824             20  CZ-CERT-PRIME       PIC X(10).
  7825             20  CZ-CERT-SFX         PIC X.
  7826         16  CZ-RECORD-TYPE          PIC X.
  7827             88  CERT-NOTE           VALUE '1'.
  7828             88  CLAIM-CERT-NOTE     VALUE '2'.
  7829         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7830
  7831     12  CZ-LAST-MAINT-DT            PIC XX.
  7832     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7833     12  CZ-LAST-MAINT-USER          PIC X(4).
  7834
  7835     12  CZ-NOTE-INFORMATION.
  7836         16  CZ-NOTE                 PIC X(63).
  7837         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 149
* EL156.cbl
  7838******************************************************************
  7839*                            COPY ERCPDEF.
  7840******************************************************************
  7841*                                                                *
  7842*                                                                *
  7843*                            ERCPDEF.                            *
  7844*                                                                *
  7845*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7846*                                                                *
  7847*    FILE TYPE = VSAM,KSDS                                       *
  7848*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7849*                                                                *
  7850*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7851*                                                                *
  7852*    LOG = YES                                                   *
  7853*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7854******************************************************************
  7855 01  PRODUCT-MASTER.
  7856    12  PD-RECORD-ID                 PIC X(02).
  7857        88  VALID-PD-ID                  VALUE 'PD'.
  7858    12  PD-CONTROL-PRIMARY.
  7859        16  PD-COMPANY-CD            PIC X.
  7860        16  PD-STATE                 PIC XX.
  7861        16  PD-PRODUCT-CD            PIC XXX.
  7862        16  PD-FILLER                PIC X(7).
  7863        16  PD-BEN-TYPE              PIC X.
  7864        16  PD-BEN-CODE              PIC XX.
  7865        16  PD-PROD-EXP-DT           PIC XX.
  7866    12  FILLER                       PIC X(50).
  7867    12  PD-PRODUCT-DATA OCCURS 8.
  7868        16  PD-PROD-CODE             PIC X.
  7869            88  PD-PROD-LIFE           VALUE 'L'.
  7870            88  PD-PROD-PROP           VALUE 'P'.
  7871            88  PD-PROD-AH             VALUE 'A'.
  7872            88  PD-PROD-IU             VALUE 'I'.
  7873            88  PD-PROD-GAP            VALUE 'G'.
  7874        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7875        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7876        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7877        16  PD-MAX-TERM              PIC S999        COMP-3.
  7878        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7879        16  FILLER                   PIC X.
  7880        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7881        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7882        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7883        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7884        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7885        16  PD-REC-CRIT-PERIOD       PIC X.
  7886        16  PD-RTW-MOS               PIC 99.
  7887        16  FILLER                   PIC X(5).
  7888    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7889    12  PD-TERM-LIMITS OCCURS 15.
  7890        16  PD-LOW-TERM              PIC S999        COMP-3.
  7891        16  PD-HI-TERM               PIC S999        COMP-3.
  7892*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7893    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7894        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7895        16  PD-HI-AMT                PIC S9(7)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 150
* EL156.cbl
  7896    12  PD-EARN-FACTORS.
  7897        16  FILLER OCCURS 15.
  7898            20  FILLER OCCURS 15.
  7899                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7900    12  PD-PRODUCT-DESC              PIC X(80).
  7901    12  PD-TRUNCATED                 PIC X.
  7902    12  FILLER                       PIC X(59).
  7903    12  PD-MAINT-INFORMATION.
  7904        16  PD-LAST-MAINT-DT         PIC X(02).
  7905        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7906        16  PD-LAST-MAINT-BY         PIC X(04).
  7907*                            COPY ELCCRTT.
  7908******************************************************************
  7909*                                                                *
  7910*                            ELCCRTT.                            *
  7911*                                                                *
  7912*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7913*                                                                *
  7914*   FILE TYPE = VSAM,KSDS                                        *
  7915*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7916*                                                                *
  7917*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7918*                                                                *
  7919*   LOG = YES                                                    *
  7920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7921******************************************************************
  7922*                   C H A N G E   L O G
  7923*
  7924* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7925*-----------------------------------------------------------------
  7926*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7927* EFFECTIVE    NUMBER
  7928*-----------------------------------------------------------------
  7929* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7930* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7931* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7932* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7933* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7934******************************************************************
  7935
  7936 01  CERTIFICATE-TRAILERS.
  7937     12  CS-RECORD-ID                      PIC XX.
  7938         88  VALID-CS-ID                      VALUE 'CS'.
  7939
  7940     12  CS-CONTROL-PRIMARY.
  7941         16  CS-COMPANY-CD                 PIC X.
  7942         16  CS-CARRIER                    PIC X.
  7943         16  CS-GROUPING                   PIC X(6).
  7944         16  CS-STATE                      PIC XX.
  7945         16  CS-ACCOUNT                    PIC X(10).
  7946         16  CS-CERT-EFF-DT                PIC XX.
  7947         16  CS-CERT-NO.
  7948             20  CS-CERT-PRIME             PIC X(10).
  7949             20  CS-CERT-SFX               PIC X.
  7950         16  CS-TRAILER-TYPE               PIC X.
  7951             88  COMM-TRLR           VALUE 'A'.
  7952             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7953             88  CERT-DATA-TRLR      VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 151
* EL156.cbl
  7954
  7955     12  CS-DATA-AREA                      PIC X(516).
  7956
  7957     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7958         16  CS-BANK-COMMISSION-AREA.
  7959             20  CS-BANK-COMMS       OCCURS 10.
  7960                 24  CS-AGT                PIC X(10).
  7961                 24  CS-COM-TYP            PIC X.
  7962                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7963                 24  CS-RECALC-LV-INDIC    PIC X.
  7964                 24  FILLER                PIC X(10).
  7965         16  FILLER                        PIC X(256).
  7966
  7967     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7968****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7969****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7970         16  CS-MB-CLAIM-DATA OCCURS 2.
  7971             20  FILLER OCCURS 10.
  7972                 24  CS-CLAIM-TYPE         PIC X.
  7973                     88  CS-AH-CLM           VALUE 'A'.
  7974                     88  CS-IU-CLM           VALUE 'I'.
  7975                     88  CS-GP-CLM           VALUE 'G'.
  7976                     88  CS-LF-CLM           VALUE 'L'.
  7977                     88  CS-PR-CLM           VALUE 'P'.
  7978                 24  CS-BANK               PIC S999 COMP-3.
  7979                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7980                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7981                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7982         16  FILLER                        PIC X(216).
  7983     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7984         16  CS-VIN-NUMBER                 PIC X(17).
  7985         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7986         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7987         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7988         16  FILLER                        PIC X(496).
  7989******************************************************************
  7990 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7991                          CONTROL-FILE CERTIFICATE-MASTER
  7992                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7993                          ACCOUNT-MASTER CHECK-QUE
  7994                          BENEFICIARY-MASTER LETTER-ARCHIVE
  7995                          DAILY-ACTIVITY-RECORD
  7996                          COMPENSATION-MASTER CERTIFICATE-NOTE
  7997                          CERT-NOTE-FILE PRODUCT-MASTER
  7998                          CERTIFICATE-TRAILERS.
  7999 0000-DFHEXIT SECTION.
  8000     MOVE '9#                    $   ' TO DFHEIV0.
  8001     MOVE 'EL156' TO DFHEIV1.
  8002     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8003
  8004     IF EIBCALEN = 0
  8005         GO TO 8800-UNAUTHORIZED-ACCESS.
  8006
  8007     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8008     MOVE EIBTRMID               TO QID-TERM.
  8009     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8010     MOVE '2'                    TO EMI-SWITCH2.
  8011     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 152
* EL156.cbl
  8012     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8013
  8014     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8015     MOVE '5'                    TO DC-OPTION-CODE.
  8016     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8017     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8018                                    SAVE-BIN-DATE.
  8019     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8020     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8021
  8022     IF SAVE-DATE-YY > 70
  8023         MOVE 19                 TO SAVE-DATE-CC
  8024     ELSE
  8025         MOVE 20                 TO SAVE-DATE-CC.
  8026
  8027     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8028         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8029     END-IF.
  8030
  8031     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8032        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8033     ELSE
  8034        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8035     END-IF
  8036
  8037     IF PI-PRINT-CLM-FRM-YN = 'N'
  8038         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8039     ELSE
  8040         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8041     END-IF
  8042
  8043     IF PI-PRINT-SURVEY-YN = 'N'
  8044         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8045     ELSE
  8046         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8047     END-IF
  8048
  8049* EXEC CICS HANDLE CONDITION
  8050*        NOTOPEN   (9990-ABEND)
  8051*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8052*        MAPFAIL   (0400-FIRST-TIME)
  8053*        DUPREC    (6180-DUPREC)
  8054*        ERROR     (9990-ABEND)
  8055*    END-EXEC.
  8056*    MOVE '"$JL?%.               ! " #00008044' TO DFHEIV0
  8057     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8059     MOVE X'2220233030303038303434' TO DFHEIV0(25:11)
  8060     CALL 'kxdfhei1' USING DFHEIV0
  8061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8062
  8063
  8064     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8065         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8066
  8067     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8068         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8069             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 153
* EL156.cbl
  8070             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8071             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8072             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8073             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8074             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8075             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8076             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8077             MOVE LOW-VALUES           TO EL156AI
  8078             MOVE 'Y'                  TO FIRST-ENTRY
  8079         ELSE
  8080             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8081             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8082             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8083             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8084             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8085             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8086             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8087             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8088
  8089     IF RETURNED-FROM NOT = SPACES
  8090        IF (RETURNED-FROM = 'EL614')
  8091           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8092           IF WS-SAVED-EOB-CODES NOT = SPACES
  8093              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8094           ELSE
  8095              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8096           END-IF
  8097        END-IF
  8098         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8099            MOVE 'Y'             TO FIRST-ENTRY
  8100            IF RETURNED-FROM = 'EL614'
  8101               AND (PI-PASS-SW NOT = 'C')
  8102               IF WS-SAVED-EOB-CODES NOT = SPACES
  8103                  MOVE WS-SAVED-EOB-CODES
  8104                                 TO PI-PMTNOTE2
  8105                                    WS-PMTNOTE2
  8106                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8107               ELSE
  8108                  MOVE SPACES    TO PI-PMTNOTE2
  8109                                    WS-PMTNOTE2
  8110                                    PI-EOB-CODES-EXIST
  8111               END-IF
  8112            END-IF
  8113            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8114            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8115            IF RETURNED-FROM = 'EL614'
  8116               GO TO 1000-EDIT-DATA
  8117            END-IF
  8118            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8119               (PAYEEI   = LOW-VALUES OR SPACES)
  8120               GO TO 8100-SEND-INITIAL-MAP
  8121            ELSE
  8122               GO TO 1000-EDIT-DATA.
  8123
  8124     IF EIBTRNID NOT = TRANS-ID
  8125         GO TO 0400-FIRST-TIME.
  8126
  8127     IF EIBAID = DFHCLEAR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 154
* EL156.cbl
  8128        IF PI-PASS-SW = 'C'
  8129           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8130           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8131           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8132           MOVE 'Y'            TO RETURNED-FROM-B
  8133           GO TO 1000-EDIT-DATA
  8134        ELSE
  8135           GO TO 9400-CLEAR.
  8136
  8137     IF PI-PASS-SW = 'C'
  8138         MOVE MAP-NAMEB          TO MAP-NAME
  8139         IF EIBAID = DFHPF1 OR DFHPF13
  8140             GO TO 5000-UPDATE
  8141           ELSE
  8142             IF EIBAID NOT = DFHENTER
  8143                 MOVE LOW-VALUES TO EL156BI
  8144                 MOVE MAP-NAMEB  TO MAP-NAME
  8145                 MOVE ER-0029    TO EMI-ERROR
  8146                 MOVE -1         TO  ENTPFBL
  8147                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8148                 GO TO 8200-SEND-DATAONLY.
  8149
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 155
* EL156.cbl
  8151 0200-RECEIVE.
  8152     MOVE LOW-VALUES             TO EL156AI.
  8153     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8154         MOVE ER-0008            TO EMI-ERROR
  8155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8156         IF PI-PASS-SW = 'C'
  8157             MOVE -1             TO ENTPFBL
  8158             GO TO 8200-SEND-DATAONLY
  8159         ELSE
  8160             MOVE -1             TO PMTTYPEL
  8161             GO TO 8200-SEND-DATAONLY.
  8162
  8163     IF PI-COMPANY-ID = 'DMD'
  8164         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8165
  8166     IF PI-PASS-SW = 'C'
  8167         MOVE MAP-NAMEB          TO MAP-NAME.
  8168
  8169
  8170* EXEC CICS RECEIVE
  8171*        MAP   (MAP-NAME)
  8172*        MAPSET(MAPSET-NAME)
  8173*        ASIS
  8174*        INTO  (EL156AI)
  8175*    END-EXEC.
  8176     MOVE LENGTH OF
  8177      EL156AI
  8178       TO DFHEIV11
  8179*    MOVE '8"TAI  L              ''   #00008157' TO DFHEIV0
  8180     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8182     MOVE X'2020233030303038313537' TO DFHEIV0(25:11)
  8183     CALL 'kxdfhei1' USING DFHEIV0,
  8184           MAP-NAME,
  8185           EL156AI,
  8186           DFHEIV11,
  8187           MAPSET-NAME,
  8188           DFHEIV99,
  8189           DFHEIV99
  8190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8191
  8192
  8193     IF PI-PASS-SW NOT = 'C'
  8194         GO TO 0250-MAPA.
  8195
  8196     IF ENTPFBL NOT > ZERO
  8197         MOVE MAP-NAMEB          TO MAP-NAME
  8198         MOVE ER-0029            TO EMI-ERROR
  8199         MOVE -1                 TO  ENTPFBL
  8200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8201         GO TO 8200-SEND-DATAONLY.
  8202
  8203     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8204         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8205       ELSE
  8206         MOVE MAP-NAMEB           TO MAP-NAME
  8207         MOVE ER-0029             TO EMI-ERROR
  8208         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 156
* EL156.cbl
  8209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8210         GO TO 8200-SEND-DATAONLY.
  8211
  8212     IF EIBAID = DFHPF1 OR DFHPF13
  8213         IF MODIFY-CAP
  8214            GO TO 5000-UPDATE
  8215          ELSE
  8216            MOVE 'UPDATE'           TO SM-READ
  8217            PERFORM 9995-SECURITY-VIOLATION
  8218            MOVE MAP-NAMEB          TO MAP-NAME
  8219            MOVE ER-0070            TO EMI-ERROR
  8220            MOVE -1                 TO  ENTPFBL
  8221            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8222            GO TO 8200-SEND-DATAONLY.
  8223
  8224 0250-MAPA.
  8225     IF ENTERPFL = 0
  8226         GO TO 0300-CHECK-PFKEYS.
  8227
  8228     IF EIBAID NOT = DFHENTER
  8229         MOVE ER-0004            TO EMI-ERROR
  8230         GO TO 0320-INPUT-ERROR.
  8231
  8232     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8233         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8234     ELSE
  8235         MOVE ER-0029            TO EMI-ERROR
  8236         GO TO 0320-INPUT-ERROR.
  8237
  8238 0300-CHECK-PFKEYS.
  8239     IF EIBAID = DFHPF7 OR DFHPF8
  8240         GO TO 8820-PF7-8.
  8241
  8242     IF EIBAID = DFHPF23
  8243         GO TO 8810-PF23.
  8244
  8245     IF EIBAID = DFHPF24
  8246         GO TO 9200-RETURN-MAIN-MENU.
  8247
  8248     IF EIBAID = DFHPF12
  8249         GO TO 9500-PF12.
  8250
  8251     IF EIBAID = DFHPF1
  8252        IF PI-PASS-SW = 'A' OR 'B'
  8253          GO TO 0330-BROWSE-FORWARD.
  8254
  8255     IF EIBAID = DFHPF2
  8256        IF PI-PASS-SW = 'A' OR 'B'
  8257          GO TO 0350-BROWSE-BACKWARD.
  8258
  8259     IF EIBAID = DFHPF6
  8260        IF PI-EOB-CODES-EXIST = 'Y'
  8261           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8262        ELSE
  8263           MOVE SPACES              TO WS-PMTNOTE2
  8264        END-IF
  8265         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8266         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 157
* EL156.cbl
  8267            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8268         END-IF
  8269         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8270         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8271             MOVE 'EL614'        TO PGM-NAME
  8272             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8273             GO TO 9300-XCTL
  8274         ELSE
  8275             MOVE XCTL-157       TO PGM-NAME
  8276             GO TO 9300-XCTL.
  8277
  8278     IF EIBAID = DFHPF9
  8279        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8280        MOVE XCTL-141            TO PGM-NAME
  8281        GO TO 9300-XCTL.
  8282
  8283     IF EIBAID = DFHPF10
  8284        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8285        MOVE XCTL-155            TO PGM-NAME
  8286        GO TO 9300-XCTL.
  8287
  8288     MOVE SPACES                 TO ERRMSG0O
  8289                                    ERRMSG1O
  8290                                    ERRMSG2O.
  8291
  8292     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8293         IF PI-PASS-SW NOT = 'B'
  8294             MOVE ER-0422        TO EMI-ERROR
  8295             GO TO 0320-INPUT-ERROR
  8296           ELSE
  8297             GO TO 0700-TEST-FOR-CHANGES.
  8298
  8299     IF EIBAID = DFHPF11
  8300        IF PI-PASS-SW = 'C'
  8301           MOVE ER-0029          TO EMI-ERROR
  8302           GO TO 0320-INPUT-ERROR.
  8303
  8304     IF EIBAID = DFHENTER OR DFHPF11
  8305        NEXT SENTENCE
  8306     ELSE
  8307        MOVE ER-0029             TO EMI-ERROR
  8308        GO TO 0320-INPUT-ERROR.
  8309
  8310     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8311
  8312     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8313         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8314         GO TO 1000-EDIT-DATA
  8315     ELSE
  8316         IF PI-FATAL-COUNT NOT = 0 OR
  8317            PI-FORCE-COUNT NOT = 0
  8318             GO TO 1000-EDIT-DATA
  8319         ELSE
  8320             GO TO 2000-EDIT-DONE.
  8321
  8322 0320-INPUT-ERROR.
  8323     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8324
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 158
* EL156.cbl
  8325     IF ENTERPFL = 0
  8326         MOVE -1                 TO PMTTYPEL
  8327     ELSE
  8328         MOVE AL-UNBON           TO ENTERPFA
  8329         MOVE -1                 TO ENTERPFL.
  8330
  8331     GO TO 8200-SEND-DATAONLY.
  8332
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 159
* EL156.cbl
  8334 0330-BROWSE-FORWARD.
  8335
  8336     MOVE CLMNOI            TO PI-CLAIM-NO.
  8337     MOVE CARRI             TO PI-CARRIER.
  8338     MOVE CERTNOI           TO PI-CERT-PRIME.
  8339     MOVE SUFXI             TO PI-CERT-SFX.
  8340
  8341     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8342     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8343     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8344     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8345
  8346     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8347
  8348
  8349* EXEC CICS HANDLE CONDITION
  8350*         NOTFND   (0380-CLAIM-END-FILE)
  8351*         ENDFILE  (0380-CLAIM-END-FILE)
  8352*    END-EXEC.
  8353*    MOVE '"$I''                  ! # #00008319' TO DFHEIV0
  8354     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8356     MOVE X'2320233030303038333139' TO DFHEIV0(25:11)
  8357     CALL 'kxdfhei1' USING DFHEIV0
  8358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8359
  8360
  8361
  8362* EXEC CICS STARTBR
  8363*         DATASET    ('ELMSTR')
  8364*         RIDFLD     (ELMSTR-KEY)
  8365*         GTEQ
  8366*    END-EXEC.
  8367     MOVE 'ELMSTR' TO DFHEIV1
  8368     MOVE 0
  8369       TO DFHEIV11
  8370*    MOVE '&,         G          &   #00008324' TO DFHEIV0
  8371     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8372     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8373     MOVE X'2020233030303038333234' TO DFHEIV0(25:11)
  8374     CALL 'kxdfhei1' USING DFHEIV0,
  8375           DFHEIV1,
  8376           ELMSTR-KEY,
  8377           DFHEIV99,
  8378           DFHEIV11,
  8379           DFHEIV99
  8380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8381
  8382
  8383     MOVE 'Y' TO WS-BROWSE-START-SW.
  8384
  8385 0335-READNEXT.
  8386
  8387
  8388* EXEC CICS READNEXT
  8389*         DATASET    ('ELMSTR')
  8390*         RIDFLD     (ELMSTR-KEY)
  8391*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 160
* EL156.cbl
  8392*    END-EXEC.
  8393     MOVE 'ELMSTR' TO DFHEIV1
  8394     MOVE 0
  8395       TO DFHEIV11
  8396*    MOVE '&.S                   )   #00008334' TO DFHEIV0
  8397     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8398     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8399     MOVE X'2020233030303038333334' TO DFHEIV0(25:11)
  8400     CALL 'kxdfhei1' USING DFHEIV0,
  8401           DFHEIV1,
  8402           DFHEIV20,
  8403           DFHEIV99,
  8404           ELMSTR-KEY,
  8405           DFHEIV99,
  8406           DFHEIV11,
  8407           DFHEIV99,
  8408           DFHEIV99
  8409     SET ADDRESS OF CLAIM-MASTER TO
  8410         DFHEIV20
  8411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8412
  8413
  8414     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8415        GO TO 0380-CLAIM-END-FILE.
  8416
  8417     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8418        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8419        GO TO 0335-READNEXT.
  8420
  8421     IF PI-COMPANY-ID = 'CRI'
  8422         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8423            GO TO 0380-CLAIM-END-FILE.
  8424
  8425     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8426         GO TO 0335-READNEXT.
  8427
  8428     IF PI-CARRIER-SECURITY > SPACES
  8429         IF CL-CARRIER = PI-CARRIER-SECURITY
  8430             NEXT SENTENCE
  8431         ELSE
  8432             GO TO 0335-READNEXT.
  8433
  8434     IF PI-ACCOUNT-SECURITY > SPACES
  8435         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8436             NEXT SENTENCE
  8437         ELSE
  8438             GO TO 0335-READNEXT.
  8439
  8440     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8441     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8442     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8443
  8444     GO TO 0400-FIRST-TIME.
  8445
  8446 0350-BROWSE-BACKWARD.
  8447
  8448     MOVE CLMNOI            TO PI-CLAIM-NO
  8449                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 161
* EL156.cbl
  8450     MOVE CARRI             TO PI-CARRIER.
  8451     MOVE CERTNOI           TO PI-CERT-PRIME.
  8452     MOVE SUFXI             TO PI-CERT-SFX.
  8453
  8454     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8455
  8456     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8457     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8458     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8459
  8460
  8461* EXEC CICS HANDLE CONDITION
  8462*         NOTFND   (0380-CLAIM-END-FILE)
  8463*         ENDFILE  (0380-CLAIM-END-FILE)
  8464*    END-EXEC.
  8465*    MOVE '"$I''                  ! $ #00008386' TO DFHEIV0
  8466     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8468     MOVE X'2420233030303038333836' TO DFHEIV0(25:11)
  8469     CALL 'kxdfhei1' USING DFHEIV0
  8470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8471
  8472
  8473
  8474* EXEC CICS STARTBR
  8475*         DATASET    ('ELMSTR')
  8476*         RIDFLD     (ELMSTR-KEY)
  8477*         GTEQ
  8478*    END-EXEC.
  8479     MOVE 'ELMSTR' TO DFHEIV1
  8480     MOVE 0
  8481       TO DFHEIV11
  8482*    MOVE '&,         G          &   #00008391' TO DFHEIV0
  8483     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8484     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8485     MOVE X'2020233030303038333931' TO DFHEIV0(25:11)
  8486     CALL 'kxdfhei1' USING DFHEIV0,
  8487           DFHEIV1,
  8488           ELMSTR-KEY,
  8489           DFHEIV99,
  8490           DFHEIV11,
  8491           DFHEIV99
  8492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8493
  8494
  8495     MOVE 'Y' TO WS-BROWSE-START-SW.
  8496
  8497
  8498* EXEC CICS READNEXT
  8499*         DATASET    ('ELMSTR')
  8500*         RIDFLD     (ELMSTR-KEY)
  8501*         SET        (ADDRESS OF CLAIM-MASTER)
  8502*    END-EXEC.
  8503     MOVE 'ELMSTR' TO DFHEIV1
  8504     MOVE 0
  8505       TO DFHEIV11
  8506*    MOVE '&.S                   )   #00008399' TO DFHEIV0
  8507     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 162
* EL156.cbl
  8508     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8509     MOVE X'2020233030303038333939' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0,
  8511           DFHEIV1,
  8512           DFHEIV20,
  8513           DFHEIV99,
  8514           ELMSTR-KEY,
  8515           DFHEIV99,
  8516           DFHEIV11,
  8517           DFHEIV99,
  8518           DFHEIV99
  8519     SET ADDRESS OF CLAIM-MASTER TO
  8520         DFHEIV20
  8521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8522
  8523
  8524
  8525* EXEC CICS READPREV
  8526*         DATASET    ('ELMSTR')
  8527*         RIDFLD     (ELMSTR-KEY)
  8528*         SET        (ADDRESS OF CLAIM-MASTER)
  8529*    END-EXEC.
  8530     MOVE 'ELMSTR' TO DFHEIV1
  8531     MOVE 0
  8532       TO DFHEIV11
  8533*    MOVE '&0S                   )   #00008405' TO DFHEIV0
  8534     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8535     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8536     MOVE X'2020233030303038343035' TO DFHEIV0(25:11)
  8537     CALL 'kxdfhei1' USING DFHEIV0,
  8538           DFHEIV1,
  8539           DFHEIV20,
  8540           DFHEIV99,
  8541           ELMSTR-KEY,
  8542           DFHEIV99,
  8543           DFHEIV11,
  8544           DFHEIV99,
  8545           DFHEIV99
  8546     SET ADDRESS OF CLAIM-MASTER TO
  8547         DFHEIV20
  8548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8549
  8550
  8551 0360-BROWSE-BACKWARD.
  8552
  8553
  8554* EXEC CICS READPREV
  8555*         DATASET    ('ELMSTR')
  8556*         RIDFLD     (ELMSTR-KEY)
  8557*         SET        (ADDRESS OF CLAIM-MASTER)
  8558*    END-EXEC.
  8559     MOVE 'ELMSTR' TO DFHEIV1
  8560     MOVE 0
  8561       TO DFHEIV11
  8562*    MOVE '&0S                   )   #00008413' TO DFHEIV0
  8563     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8564     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8565     MOVE X'2020233030303038343133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 163
* EL156.cbl
  8566     CALL 'kxdfhei1' USING DFHEIV0,
  8567           DFHEIV1,
  8568           DFHEIV20,
  8569           DFHEIV99,
  8570           ELMSTR-KEY,
  8571           DFHEIV99,
  8572           DFHEIV11,
  8573           DFHEIV99,
  8574           DFHEIV99
  8575     SET ADDRESS OF CLAIM-MASTER TO
  8576         DFHEIV20
  8577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8578
  8579
  8580     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8581        GO TO 0380-CLAIM-END-FILE.
  8582
  8583     IF PI-COMPANY-ID = 'CRI'
  8584         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8585            GO TO 0380-CLAIM-END-FILE.
  8586
  8587     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8588         GO TO 0360-BROWSE-BACKWARD.
  8589
  8590     IF PI-CARRIER-SECURITY > SPACES
  8591         IF CL-CARRIER = PI-CARRIER-SECURITY
  8592             NEXT SENTENCE
  8593         ELSE
  8594             GO TO 0360-BROWSE-BACKWARD.
  8595
  8596     IF PI-ACCOUNT-SECURITY > SPACES
  8597         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8598             NEXT SENTENCE
  8599         ELSE
  8600             GO TO 0360-BROWSE-BACKWARD.
  8601
  8602     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8603     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8604     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8605
  8606     GO TO 0400-FIRST-TIME.
  8607
  8608 0380-CLAIM-END-FILE.
  8609
  8610     MOVE ER-0130     TO EMI-ERROR.
  8611     MOVE -1          TO CLMNOL.
  8612     MOVE AL-UABON    TO CARRA
  8613                         CLMNOA
  8614                         CERTNOA
  8615                         SUFXA.
  8616
  8617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8618
  8619     GO TO 8200-SEND-DATAONLY.
  8620
  8621 0400-FIRST-TIME.
  8622
  8623     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 164
* EL156.cbl
  8624        MOVE 'N'         TO WS-BROWSE-START-SW
  8625
  8626* EXEC CICS ENDBR
  8627*            DATASET    ('ELMSTR')
  8628*       END-EXEC.
  8629     MOVE 'ELMSTR' TO DFHEIV1
  8630     MOVE 0
  8631       TO DFHEIV11
  8632*    MOVE '&2                    $   #00008464' TO DFHEIV0
  8633     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8634     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8635     MOVE X'2020233030303038343634' TO DFHEIV0(25:11)
  8636     CALL 'kxdfhei1' USING DFHEIV0,
  8637           DFHEIV1,
  8638           DFHEIV11,
  8639           DFHEIV99
  8640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8641
  8642
  8643     IF PI-PROCESSOR-ID = 'LGXX'
  8644         NEXT SENTENCE
  8645     ELSE
  8646
  8647* EXEC CICS READQ TS
  8648*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8649*            INTO    (SECURITY-CONTROL)
  8650*            LENGTH  (SC-COMM-LENGTH)
  8651*            ITEM    (SC-ITEM)
  8652*        END-EXEC
  8653*    MOVE '*$II   L              ''   #00008471' TO DFHEIV0
  8654     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8655     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8656     MOVE X'2020233030303038343731' TO DFHEIV0(25:11)
  8657     CALL 'kxdfhei1' USING DFHEIV0,
  8658           PI-SECURITY-TEMP-STORE-ID,
  8659           SECURITY-CONTROL,
  8660           SC-COMM-LENGTH,
  8661           SC-ITEM,
  8662           DFHEIV99,
  8663           DFHEIV99
  8664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8665         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8666         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8667
  8668     MOVE LOW-VALUES             TO EL156AI.
  8669     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8670     MOVE 'Y'                    TO FIRST-ENTRY.
  8671     GO TO 7000-SHOW-CLAIM.
  8672
  8673 0500-CREATE-TEMP-STORAGE.
  8674     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8675
  8676
  8677* EXEC CICS WRITEQ TS
  8678*        QUEUE (QID)
  8679*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8680*        LENGTH(PI-COMM-LENGTH)
  8681*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 165
* EL156.cbl
  8682*    MOVE '*"                    ''   #00008488' TO DFHEIV0
  8683     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8684     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8685     MOVE X'2020233030303038343838' TO DFHEIV0(25:11)
  8686     CALL 'kxdfhei1' USING DFHEIV0,
  8687           QID,
  8688           PROGRAM-INTERFACE-BLOCK,
  8689           PI-COMM-LENGTH,
  8690           DFHEIV99,
  8691           DFHEIV99,
  8692           DFHEIV99
  8693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8694
  8695
  8696
  8697* EXEC CICS WRITEQ TS
  8698*        QUEUE (QID)
  8699*        FROM  (EL156AI)
  8700*        LENGTH(MAP-LENGTH)
  8701*    END-EXEC.
  8702*    MOVE '*"                    ''   #00008494' TO DFHEIV0
  8703     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8704     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8705     MOVE X'2020233030303038343934' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0,
  8707           QID,
  8708           EL156AI,
  8709           MAP-LENGTH,
  8710           DFHEIV99,
  8711           DFHEIV99,
  8712           DFHEIV99
  8713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8714
  8715
  8716 0599-EXIT.
  8717      EXIT.
  8718
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 166
* EL156.cbl
  8720 0600-RECOVER-TEMP-STORAGE.
  8721
  8722* EXEC CICS READQ TS
  8723*        QUEUE (QID)
  8724*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8725*        LENGTH(PI-COMM-LENGTH)
  8726*    END-EXEC.
  8727*    MOVE '*$I    L              ''   #00008505' TO DFHEIV0
  8728     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8729     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8730     MOVE X'2020233030303038353035' TO DFHEIV0(25:11)
  8731     CALL 'kxdfhei1' USING DFHEIV0,
  8732           QID,
  8733           PROGRAM-INTERFACE-BLOCK,
  8734           PI-COMM-LENGTH,
  8735           DFHEIV99,
  8736           DFHEIV99,
  8737           DFHEIV99
  8738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8739
  8740
  8741
  8742* EXEC CICS READQ TS
  8743*        QUEUE (QID)
  8744*        INTO  (EL156AI)
  8745*        LENGTH(MAP-LENGTH)
  8746*    END-EXEC.
  8747*    MOVE '*$I    L              ''   #00008511' TO DFHEIV0
  8748     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8749     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8750     MOVE X'2020233030303038353131' TO DFHEIV0(25:11)
  8751     CALL 'kxdfhei1' USING DFHEIV0,
  8752           QID,
  8753           EL156AI,
  8754           MAP-LENGTH,
  8755           DFHEIV99,
  8756           DFHEIV99,
  8757           DFHEIV99
  8758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8759
  8760
  8761     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8762
  8763     IF PMTTYPEI NOT = LOW-VALUES
  8764         MOVE AL-UANON           TO PMTTYPEA.
  8765
  8766     IF PAYEEI NOT = LOW-VALUES
  8767         MOVE AL-UANON           TO PAYEEA.
  8768
  8769     IF NOTE1I NOT = LOW-VALUES
  8770         MOVE AL-UANON           TO NOTE1A.
  8771
  8772     IF (RETURNED-FROM = 'EL614')
  8773        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8774     END-IF
  8775*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8776*       AND (PI-EOB-CODES-EXIST = 'Y')
  8777*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 167
* EL156.cbl
  8778*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8779     IF PI-SET-NOTE2-MDT = 'Y'
  8780         MOVE AL-SANON           TO NOTE2A
  8781     END-IF
  8782
  8783     IF OFFLINEI NOT = LOW-VALUES
  8784         MOVE AL-UANON           TO OFFLINEA.
  8785
  8786*    IF GROUPEDI NOT = LOW-VALUES
  8787*        MOVE AL-UANON           TO GROUPEDA.
  8788
  8789*    IF CASHI NOT = LOW-VALUES
  8790*        MOVE AL-UANON           TO CASHA.
  8791
  8792     IF CHECKNOI NOT = LOW-VALUES
  8793         MOVE AL-UANON           TO CHECKNOA.
  8794
  8795     IF HOLDTILI NOT = LOW-VALUES
  8796         MOVE AL-UANON           TO HOLDTILA.
  8797
  8798     IF EPYFROMI NOT = LOW-VALUES
  8799         MOVE AL-UANON           TO EPYFROMA.
  8800
  8801     IF AIGFROMI NOT = LOW-VALUES
  8802         MOVE AL-UANON           TO AIGFROMA.
  8803
  8804     IF EPYTHRUI NOT = LOW-VALUES
  8805         MOVE AL-UANON           TO EPYTHRUA.
  8806
  8807     IF EDAYSI NOT = LOW-VALUES
  8808         MOVE AL-UNNON           TO EDAYSA.
  8809
  8810     IF EPYAMTL NOT = +0
  8811         MOVE AL-UNNON           TO EPYAMTA.
  8812
  8813     IF ERESVL NOT = +0
  8814         MOVE AL-UNNON           TO ERESVA.
  8815
  8816     IF EEXPENSL NOT = +0
  8817         MOVE AL-UNNON           TO EEXPENSA.
  8818
  8819     IF ETYPEI NOT = LOW-VALUES
  8820         MOVE AL-UNNON           TO ETYPEA.
  8821
  8822     IF PROOFDTI NOT = 0
  8823         MOVE AL-UNNON           TO PROOFDTA.
  8824
  8825     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8826        MOVE AL-UANON            TO EOBYNA
  8827     END-IF
  8828     IF CLMFMYNI = 'Y' OR 'N'
  8829        MOVE AL-UANON            TO CLMFMYNA
  8830     END-IF
  8831
  8832     IF SURVYYNI = 'Y' OR 'N'
  8833        IF PI-APPROVAL-LEVEL = '5'
  8834           MOVE AL-UANON         TO SURVYYNA
  8835        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 168
* EL156.cbl
  8836     END-IF
  8837
  8838     .
  8839 0699-EXIT.
  8840      EXIT.
  8841
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 169
* EL156.cbl
  8843 0700-TEST-FOR-CHANGES.
  8844     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8845         MOVE ER-0433            TO EMI-ERROR
  8846         GO TO 0750-FUNCTION-ERROR.
  8847
  8848     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8849
  8850     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8851         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8852         MOVE 'A'                TO PI-PASS-SW
  8853         GO TO 1000-EDIT-DATA.
  8854
  8855     IF PI-FATAL-COUNT NOT = 0
  8856         MOVE ER-0499            TO EMI-ERROR
  8857         GO TO 0750-FUNCTION-ERROR.
  8858
  8859     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8860         MOVE ER-0500            TO EMI-ERROR
  8861         GO TO 0750-FUNCTION-ERROR.
  8862
  8863     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8864        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8865           MOVE ER-0542          TO EMI-ERROR
  8866           MOVE -1               TO EPYAMTL
  8867           GO TO 0750-FUNCTION-ERROR.
  8868
  8869     IF PI-OFFLINE = 'Y'  OR
  8870        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8871        MOVE EIBAID              TO PI-PFKEY-USED
  8872        GO TO 5000-UPDATE.
  8873
  8874     GO TO 6000-BUILD-SCREEN-B.
  8875
  8876 0750-FUNCTION-ERROR.
  8877     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8878
  8879     IF ENTERPFL > 0
  8880         MOVE -1                 TO ENTERPFL
  8881         MOVE AL-UNBON           TO ENTERPFA
  8882         GO TO 8200-SEND-DATAONLY
  8883     ELSE
  8884         MOVE -1                 TO ENTERPFL
  8885         MOVE AL-UNNOF           TO ENTERPFA
  8886         GO TO 8200-SEND-DATAONLY.
  8887
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 170
* EL156.cbl
  8889 0800-DELETE-TS.
  8890
  8891* EXEC CICS HANDLE CONDITION
  8892*        QIDERR(0800-EXIT)
  8893*    END-EXEC.
  8894*    MOVE '"$N                   ! % #00008646' TO DFHEIV0
  8895     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8897     MOVE X'2520233030303038363436' TO DFHEIV0(25:11)
  8898     CALL 'kxdfhei1' USING DFHEIV0
  8899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8900
  8901
  8902
  8903* EXEC CICS DELETEQ TS
  8904*        QUEUE(QID)
  8905*    END-EXEC.
  8906*    MOVE '*&                    #   #00008650' TO DFHEIV0
  8907     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8908     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8909     MOVE X'2020233030303038363530' TO DFHEIV0(25:11)
  8910     CALL 'kxdfhei1' USING DFHEIV0,
  8911           QID,
  8912           DFHEIV99
  8913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8914
  8915
  8916 0800-EXIT.
  8917      EXIT.
  8918 0900-GET-DDF-FACTORS.
  8919
  8920     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8921     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8922     MOVE CL-CERT-STATE          TO ERPDEF-STATE
  8923     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8924     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8925     MOVE PI-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8926     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8927
  8928     DISPLAY ' MADE 0900 ' ERPDEF-KEY (2:15)
  8929     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8930
  8931
  8932* EXEC CICS STARTBR
  8933*        DATASET  ('ERPDEF')
  8934*        RIDFLD   (ERPDEF-KEY)
  8935*        GTEQ
  8936*        RESP     (WS-RESPONSE)
  8937*    END-EXEC
  8938     MOVE 'ERPDEF' TO DFHEIV1
  8939     MOVE 0
  8940       TO DFHEIV11
  8941*    MOVE '&,         G          &  N#00008669' TO DFHEIV0
  8942     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8943     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8944     MOVE X'204E233030303038363639' TO DFHEIV0(25:11)
  8945     CALL 'kxdfhei1' USING DFHEIV0,
  8946           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 171
* EL156.cbl
  8947           ERPDEF-KEY,
  8948           DFHEIV99,
  8949           DFHEIV11,
  8950           DFHEIV99
  8951     MOVE EIBRESP  TO WS-RESPONSE
  8952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8953
  8954     IF NOT WS-RESP-NORMAL
  8955        GO TO 0900-EXIT
  8956     END-IF
  8957
  8958     .
  8959 0900-READNEXT.
  8960
  8961
  8962* EXEC CICS READNEXT
  8963*       DATASET  ('ERPDEF')
  8964*       SET      (ADDRESS OF PRODUCT-MASTER)
  8965*       RIDFLD   (ERPDEF-KEY)
  8966*       RESP     (WS-RESPONSE)
  8967*    END-EXEC
  8968     MOVE 'ERPDEF' TO DFHEIV1
  8969     MOVE 0
  8970       TO DFHEIV11
  8971*    MOVE '&.S                   )  N#00008683' TO DFHEIV0
  8972     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8973     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8974     MOVE X'204E233030303038363833' TO DFHEIV0(25:11)
  8975     CALL 'kxdfhei1' USING DFHEIV0,
  8976           DFHEIV1,
  8977           DFHEIV20,
  8978           DFHEIV99,
  8979           ERPDEF-KEY,
  8980           DFHEIV99,
  8981           DFHEIV11,
  8982           DFHEIV99,
  8983           DFHEIV99
  8984     SET ADDRESS OF PRODUCT-MASTER TO
  8985         DFHEIV20
  8986     MOVE EIBRESP  TO WS-RESPONSE
  8987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8988
  8989     IF NOT WS-RESP-NORMAL
  8990        GO TO 0900-ENDBR
  8991     END-IF
  8992
  8993     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8994        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8995           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8996        ELSE
  8997           GO TO 0900-READNEXT
  8998        END-IF
  8999     ELSE
  9000        GO TO 0900-ENDBR
  9001     END-IF
  9002
  9003     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9004        (P1 > +8)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 172
* EL156.cbl
  9005        OR (PD-PROD-CODE (P1) = 'I')
  9006     END-PERFORM
  9007     IF P1 < +9
  9008        SET DD-IU-PRESENT        TO TRUE
  9009     END-IF
  9010
  9011     IF CM-LOAN-TERM = ZEROS
  9012        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9013     END-IF
  9014
  9015     .
  9016 0900-ENDBR.
  9017
  9018
  9019* EXEC CICS ENDBR
  9020*       DATASET  ('ERPDEF')
  9021*    END-EXEC
  9022     MOVE 'ERPDEF' TO DFHEIV1
  9023     MOVE 0
  9024       TO DFHEIV11
  9025*    MOVE '&2                    $   #00008719' TO DFHEIV0
  9026     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9027     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9028     MOVE X'2020233030303038373139' TO DFHEIV0(25:11)
  9029     CALL 'kxdfhei1' USING DFHEIV0,
  9030           DFHEIV1,
  9031           DFHEIV11,
  9032           DFHEIV99
  9033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9034
  9035     .
  9036 0900-EXIT.
  9037     EXIT.
  9038 1000-EDIT-DATA.
  9039
  9040     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9041         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9042         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9043
  9044     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9045
  9046     IF NOT MODIFY-CAP
  9047         MOVE ER-0070            TO EMI-ERROR
  9048         MOVE -1                 TO PMTTYPEL
  9049         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9050         GO TO 2000-EDIT-DONE.
  9051
  9052     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9053                         '5' AND '6'
  9054         MOVE ER-0420            TO EMI-ERROR
  9055         MOVE -1                 TO PMTTYPEL
  9056         MOVE AL-UABON           TO PMTTYPEA
  9057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9058     ELSE
  9059         MOVE AL-UANON           TO PMTTYPEA.
  9060
  9061*    IF PI-OFFLINE = 'Y'
  9062*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 173
* EL156.cbl
  9063*          MOVE ER-1880         TO EMI-ERROR
  9064*          MOVE -1              TO GROUPEDL
  9065*          MOVE AL-UABON        TO GROUPEDA
  9066*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9067*
  9068*    IF GROUPEDL > +0
  9069*       IF PI-GROUPED = 'Y' OR 'N'
  9070*          MOVE AL-UANON TO GROUPEDA
  9071*       ELSE
  9072*          MOVE ER-3140            TO EMI-ERROR
  9073*          MOVE -1                 TO GROUPEDL
  9074*          MOVE AL-UABON           TO GROUPEDA
  9075*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9076*
  9077*    IF CASHL > +0
  9078*       IF PI-CASH = 'Y' OR 'N'
  9079*          MOVE AL-UANON           TO CASHA
  9080*       ELSE
  9081*          MOVE ER-3141            TO EMI-ERROR
  9082*          MOVE -1                 TO CASHL
  9083*          MOVE AL-UABON           TO CASHA
  9084*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9085
  9086     IF LOANNOL > +0
  9087         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9088
  9089 1000-EDIT-PAYEE.
  9090
  9091     IF PI-PAYEE-SEQ NOT NUMERIC
  9092         MOVE ER-0294            TO  EMI-ERROR
  9093         MOVE -1                 TO  PAYEEL
  9094         MOVE AL-UABON           TO  PAYEEA
  9095         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9096         GO TO 1000-CONT-EDIT.
  9097
  9098     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9099                         'E' OR 'O' OR 'Q'
  9100         NEXT SENTENCE
  9101     ELSE
  9102         MOVE ER-0294            TO  EMI-ERROR
  9103         MOVE -1                 TO  PAYEEL
  9104         MOVE AL-UABON           TO  PAYEEA
  9105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9106         GO TO 1000-CONT-EDIT.
  9107
  9108     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9109        (PI-PAYEE-SEQ NOT < '1' AND
  9110         PI-PAYEE-SEQ NOT > '9'))
  9111      OR
  9112        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9113         (PI-PAYEE-SEQ NOT > '9'))
  9114         MOVE AL-UANON            TO PAYEEA
  9115     ELSE
  9116         MOVE ER-0294            TO EMI-ERROR
  9117         MOVE -1                 TO PAYEEL
  9118         MOVE AL-UABON           TO PAYEEA
  9119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9120
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 174
* EL156.cbl
  9121     IF PI-COMPANY-ID = 'DMD'
  9122         IF PI-PAYEE-TYPE = 'B' AND
  9123            PI-PAYEE-SEQ NOT = '0'
  9124               MOVE ER-7841            TO EMI-ERROR
  9125               MOVE -1                 TO PAYEEL
  9126               MOVE AL-UABON           TO PAYEEA
  9127               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9128
  9129     IF PI-COMPANY-ID = 'JHL'
  9130         IF PI-PAYEE = 'B0'
  9131             NEXT SENTENCE
  9132           ELSE
  9133
  9134* EXEC CICS HANDLE CONDITION
  9135*            ENDFILE(1950-NOT-FOUND)
  9136*            NOTFND (1950-NOT-FOUND)
  9137*        END-EXEC
  9138*    MOVE '"$''I                  ! & #00008821' TO DFHEIV0
  9139     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9141     MOVE X'2620233030303038383231' TO DFHEIV0(25:11)
  9142     CALL 'kxdfhei1' USING DFHEIV0
  9143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9144         MOVE 'N'                    TO FOUND-TOL-SW
  9145         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9146         MOVE '2'                    TO CNTL-REC-TYPE
  9147         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9148         MOVE +0                     TO CNTL-SEQ-NO
  9149         MOVE 'PROC'                 TO FILE-SWITCH
  9150         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9151         IF PI-PAYEE = 'I1' AND
  9152            APPROVAL-LEVEL-2
  9153             NEXT SENTENCE
  9154           ELSE
  9155         IF NOT PI-USER-ALMIGHTY-YES
  9156             MOVE ER-3546        TO EMI-ERROR
  9157             MOVE -1             TO PAYEEL
  9158             MOVE AL-UABON       TO PAYEEA
  9159             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9160
  9161     IF PI-PAYEE-TYPE = 'E'
  9162        IF PI-PMTTYPE = '5' OR '6'
  9163            NEXT SENTENCE
  9164        ELSE
  9165            MOVE ER-3539            TO EMI-ERROR
  9166            MOVE -1                 TO PAYEEL
  9167            MOVE AL-UABON           TO PAYEEA
  9168            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9169
  9170 1000-CONT-EDIT.
  9171
  9172     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9173        IF PI-EPYAMT NOT NEGATIVE
  9174            MOVE ER-0421         TO EMI-ERROR
  9175            MOVE -1              TO OFFLINEL
  9176            MOVE AL-UABON        TO OFFLINEA
  9177            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9178        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 175
* EL156.cbl
  9179            MOVE AL-UANON        TO OFFLINEA.
  9180
  9181     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9182        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9183           CONTINUE
  9184        ELSE
  9185        IF PI-PRINT-EOB-YN = 'S' AND
  9186           PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9187             CONTINUE
  9188        ELSE
  9189           MOVE ER-1561          TO EMI-ERROR
  9190           MOVE -1               TO EOBYNL
  9191           MOVE AL-UABON         TO EOBYNA
  9192           PERFORM 9900-ERROR-FORMAT
  9193                                 THRU 9900-EXIT
  9194        END-IF
  9195        END-IF
  9196
  9197        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9198            MOVE ER-1566        TO EMI-ERROR
  9199            MOVE -1             TO CLMFMYNL
  9200            MOVE AL-UABON       TO CLMFMYNA
  9201            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9202        END-IF
  9203
  9204        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9205            MOVE ER-1567        TO EMI-ERROR
  9206            MOVE -1             TO SURVYYNL
  9207            MOVE AL-UABON       TO SURVYYNA
  9208            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9209        END-IF
  9210
  9211     END-IF
  9212     IF PI-EPYAMT IS NEGATIVE
  9213         IF PI-OFFLINE NOT = 'Y'
  9214             MOVE ER-0836        TO  EMI-ERROR
  9215             MOVE -1             TO  OFFLINEL
  9216             MOVE AL-UABON       TO  OFFLINEA
  9217             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9218
  9219     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9220        MOVE ER-0872             TO EMI-ERROR
  9221        MOVE -1                  TO PROOFDTL
  9222        MOVE AL-UABON            TO PROOFDTA
  9223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9224     ELSE
  9225        MOVE '4'                TO DC-OPTION-CODE
  9226        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9227        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9228        IF DATE-CONVERSION-ERROR
  9229            MOVE ER-0873        TO EMI-ERROR
  9230            MOVE -1                  TO PROOFDTL
  9231            MOVE AL-UABON            TO PROOFDTA
  9232            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9233        ELSE
  9234            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9235            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9236                MOVE ER-0873    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 176
* EL156.cbl
  9237                MOVE -1                  TO PROOFDTL
  9238                MOVE AL-UABON            TO PROOFDTA
  9239                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9240            END-IF
  9241        END-IF
  9242     END-IF.
  9243
  9244     IF PI-COMPANY-ID = 'DMD'
  9245        IF NOTE1L NOT = ZEROS
  9246            MOVE ER-7844        TO  EMI-ERROR
  9247            MOVE -1             TO  NOTE1L
  9248            MOVE AL-UABON       TO  NOTE1A
  9249            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9250
  9251     IF PI-COMPANY-ID = 'DMD'
  9252        IF NOTE2L NOT = ZEROS
  9253          GO TO 1004-DMD-EOB-CHECKS.
  9254
  9255     IF NOTE1L NOT > +0
  9256         GO TO 1005-CHECK-ERRORS.
  9257
  9258     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9259         GO TO 1005-CHECK-ERRORS.
  9260
  9261     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9262         GO TO 1003-HAN-PMT-NOTES.
  9263
  9264     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9265
  9266     IF WS-PMTOPTION NUMERIC
  9267        IF WS-PMTOPTION > '00' AND < '17'
  9268           NEXT SENTENCE
  9269        ELSE
  9270           MOVE ER-0618          TO EMI-ERROR
  9271           MOVE -1               TO NOTE1L
  9272           MOVE AL-UABON         TO NOTE1A
  9273           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9274     ELSE
  9275        GO TO 1005-CHECK-ERRORS.
  9276
  9277     IF WS-PMTOPTION = '05' AND
  9278        WS-DOCNAME = SPACES
  9279          MOVE ER-0616             TO EMI-ERROR
  9280          MOVE -1                  TO NOTE1L
  9281          MOVE AL-UABON            TO NOTE1A
  9282          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9283
  9284     IF WS-PMTOPTION = '15' OR '16'
  9285
  9286* EXEC CICS BIF DEEDIT
  9287*            FIELD (WS-AMOUNT)
  9288*            LENGTH(08)
  9289*        END-EXEC
  9290     MOVE 08
  9291       TO DFHEIV11
  9292*    MOVE '@"L                   #   #00008966' TO DFHEIV0
  9293     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9294     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 177
* EL156.cbl
  9295     MOVE X'2020233030303038393636' TO DFHEIV0(25:11)
  9296     CALL 'kxdfhei1' USING DFHEIV0,
  9297           WS-AMOUNT,
  9298           DFHEIV11
  9299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9300        IF (WS-NUM-AMT = ZEROS) OR
  9301           (WS-AMOUNT NOT NUMERIC)
  9302           MOVE ER-0617          TO EMI-ERROR
  9303           MOVE -1               TO NOTE1L
  9304           MOVE AL-UABON         TO NOTE1A
  9305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9306
  9307     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9308
  9309     GO TO 1005-CHECK-ERRORS.
  9310
  9311 1003-HAN-PMT-NOTES.
  9312
  9313     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9314
  9315     IF WS-HAN-PMT-CODE = SPACE
  9316         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9317     ELSE
  9318     IF WS-HAN-PMT-CODE = 'A'
  9319         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9320                                 TO WS-HAN-PMT-NOTE
  9321     ELSE
  9322     IF WS-HAN-PMT-CODE = 'B'
  9323         MOVE ':FINAL PAYMENT / DECEASED'
  9324                                 TO WS-HAN-PMT-NOTE
  9325     ELSE
  9326     IF WS-HAN-PMT-CODE = 'C'
  9327         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9328                                 TO WS-HAN-PMT-NOTE
  9329     ELSE
  9330     IF WS-HAN-PMT-CODE = 'D'
  9331         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9332                                 TO WS-HAN-PMT-NOTE
  9333     ELSE
  9334     IF WS-HAN-PMT-CODE = 'E'
  9335         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9336                                 TO WS-HAN-PMT-NOTE
  9337     ELSE
  9338     IF WS-HAN-PMT-CODE = 'F'
  9339         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9340                                 TO WS-HAN-PMT-NOTE
  9341     ELSE
  9342     IF WS-HAN-PMT-CODE = 'P'
  9343         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9344
  9345     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9346     GO TO 1005-CHECK-ERRORS.
  9347
  9348 1004-DMD-EOB-CHECKS.
  9349
  9350     INITIALIZE PI-AT-EOB-CODES.
  9351
  9352     IF NOTE2I (20:21) > SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 178
* EL156.cbl
  9353         MOVE ER-7845          TO EMI-ERROR
  9354         MOVE -1               TO NOTE2L
  9355         MOVE AL-UABON         TO NOTE2A
  9356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9357         GO TO 1005-CHECK-ERRORS
  9358      ELSE
  9359         MOVE NOTE2I             TO W-EOB-CODES.
  9360
  9361     MOVE +1                     TO W-EOB-NDX.
  9362
  9363 1004-CHECK-EACH-EOB.
  9364
  9365     IF W-EOB-NDX > +5
  9366             OR
  9367        W-EOB-CODE (W-EOB-NDX) = SPACES
  9368         GO TO 1004-CHECK-DUP-EOB.
  9369
  9370     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9371         MOVE ER-0956            TO EMI-ERROR
  9372         MOVE -1                 TO NOTE2L
  9373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9374         GO TO 1005-CHECK-ERRORS.
  9375
  9376     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9377     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9378     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9379     MOVE 'DLO023'               TO PGM-NAME.
  9380
  9381
  9382* EXEC CICS LINK
  9383*        PROGRAM    (PGM-NAME)
  9384*        COMMAREA   (CD-COMMUNICATION-AREA)
  9385*        LENGTH     (CD-RCRD-LENGTH)
  9386*    END-EXEC.
  9387*    MOVE '."C                   (   #00009051' TO DFHEIV0
  9388     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9389     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9390     MOVE X'2020233030303039303531' TO DFHEIV0(25:11)
  9391     CALL 'kxdfhei1' USING DFHEIV0,
  9392           PGM-NAME,
  9393           CD-COMMUNICATION-AREA,
  9394           CD-RCRD-LENGTH,
  9395           DFHEIV99,
  9396           DFHEIV99,
  9397           DFHEIV99,
  9398           DFHEIV99
  9399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9400
  9401
  9402     IF CD-RETURN-CODE = 'OK'
  9403         GO TO 1004-CONT.
  9404
  9405     MOVE -1                     TO NOTE2L.
  9406
  9407     IF CD-RETURN-CODE = '01'
  9408         MOVE ER-8310            TO EMI-ERROR
  9409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9410         GO TO 1005-CHECK-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 179
* EL156.cbl
  9411
  9412     IF CD-RETURN-CODE = '02'
  9413         MOVE ER-8311            TO EMI-ERROR
  9414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9415         GO TO 1005-CHECK-ERRORS.
  9416
  9417     IF CD-RETURN-CODE = '03'
  9418         MOVE ER-8312            TO EMI-ERROR
  9419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9420         GO TO 1005-CHECK-ERRORS.
  9421
  9422     IF CD-RETURN-CODE = '04'
  9423         MOVE ER-8313            TO EMI-ERROR
  9424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9425         GO TO 1005-CHECK-ERRORS.
  9426
  9427     IF CD-RETURN-CODE = '05'
  9428         MOVE ER-8314            TO EMI-ERROR
  9429         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9430         GO TO 1005-CHECK-ERRORS.
  9431
  9432     IF CD-RETURN-CODE = '06'
  9433         MOVE ER-8315            TO EMI-ERROR
  9434         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9435         GO TO 1005-CHECK-ERRORS.
  9436
  9437     IF CD-RETURN-CODE = 'E1'
  9438         MOVE ER-8316            TO EMI-ERROR
  9439         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9440         GO TO 1005-CHECK-ERRORS.
  9441
  9442     IF CD-RETURN-CODE = 'N1'
  9443         MOVE ER-8317            TO EMI-ERROR
  9444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9445         GO TO 1005-CHECK-ERRORS.
  9446
  9447 1004-CONT.
  9448     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9449
  9450     ADD +1 TO W-EOB-NDX.
  9451     GO TO 1004-CHECK-EACH-EOB.
  9452
  9453 1004-CHECK-DUP-EOB.
  9454     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9455         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9456                               PI-AT-EOB-CODE (3) OR
  9457                               PI-AT-EOB-CODE (4) OR
  9458                               PI-AT-EOB-CODE (5)))
  9459                  OR
  9460        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9461         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9462                               PI-AT-EOB-CODE (4) OR
  9463                               PI-AT-EOB-CODE (5)))
  9464                  OR
  9465        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9466         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9467                               PI-AT-EOB-CODE (5)))
  9468                  OR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 180
* EL156.cbl
  9469        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9470         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9471            MOVE ER-8000            TO EMI-ERROR
  9472            MOVE AL-UABON           TO NOTE2A
  9473            MOVE -1                 TO NOTE2L
  9474            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9475            GO TO 1005-CHECK-ERRORS.
  9476
  9477 1005-CHECK-ERRORS.
  9478*    IF PI-COMPANY-ID NOT = 'DMD'
  9479        GO TO 1006-CHECK-ERRORS.
  9480
  9481*********  DMD CODE START ******************
  9482*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9483*       GO TO 1006-CHECK-ERRORS.
  9484*
  9485*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9486*
  9487*    COMPUTE W-PAYMENT-TOTAL
  9488*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9489*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9490*               AND
  9491*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9492*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9493*          MOVE ER-0967    TO EMI-ERROR
  9494*          MOVE -1         TO PMTTYPEL
  9495*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9496*
  9497*    GO TO 1006-CHECK-ERRORS.
  9498*********  DMD CODE END ******************
  9499
  9500 1006-CHECK-ERRORS.
  9501     IF NOT EMI-NO-ERRORS
  9502        GO TO 2000-EDIT-DONE.
  9503
  9504
  9505* EXEC CICS HANDLE CONDITION
  9506*        NOTFND(1950-NOT-FOUND)
  9507*    END-EXEC.
  9508*    MOVE '"$I                   ! '' #00009159' TO DFHEIV0
  9509     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9511     MOVE X'2720233030303039313539' TO DFHEIV0(25:11)
  9512     CALL 'kxdfhei1' USING DFHEIV0
  9513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9514
  9515
  9516     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9517     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9518     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9519     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9520     MOVE 'MSTR'                 TO FILE-SWITCH.
  9521
  9522     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9523
  9524     IF PI-COMPANY-ID = 'DMD'
  9525         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9526
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 181
* EL156.cbl
  9527     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9528        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9529           MOVE ER-0873    TO EMI-ERROR
  9530           MOVE -1                  TO PROOFDTL
  9531           MOVE AL-UABON            TO PROOFDTA
  9532           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9533        END-IF
  9534     END-IF
  9535     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9536     MOVE +95                    TO TRLR-SEQ-NO
  9537
  9538* EXEC CICS READ
  9539*       DATASET  ('ELTRLR')
  9540*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9541*       RIDFLD   (ELTRLR-KEY)
  9542*       RESP     (WS-RESPONSE)
  9543*    END-EXEC
  9544     MOVE 'ELTRLR' TO DFHEIV1
  9545*    MOVE '&"S        E          (  N#00009184' TO DFHEIV0
  9546     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9548     MOVE X'204E233030303039313834' TO DFHEIV0(25:11)
  9549     CALL 'kxdfhei1' USING DFHEIV0,
  9550           DFHEIV1,
  9551           DFHEIV20,
  9552           DFHEIV99,
  9553           ELTRLR-KEY,
  9554           DFHEIV99,
  9555           DFHEIV99,
  9556           DFHEIV99
  9557     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9558         DFHEIV20
  9559     MOVE EIBRESP  TO WS-RESPONSE
  9560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9561
  9562     if ws-resp-normal
  9563        perform varying s1 from +1 by +1 until
  9564           at-note-error-no (s1) = spaces
  9565           if at-note-error-no (s1) = '1662'
  9566              continue
  9567           else
  9568              move at-note-error-no (s1)
  9569                                 to emi-error
  9570              if at-note-error-no (s1) = '1653'
  9571                 evaluate true
  9572                    when cl-claim-type = 'L'
  9573                       move '  LF  '
  9574                                 to emi-claim-type
  9575                    when cl-claim-type = 'I'
  9576                       move '  IU  '
  9577                                 to emi-claim-type
  9578                    when other
  9579                       move '  AH  '
  9580                                 to emi-claim-type
  9581                 end-evaluate
  9582              end-if
  9583              PERFORM 9900-ERROR-FORMAT
  9584                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 182
* EL156.cbl
  9585           end-if
  9586        end-perform
  9587     end-if
  9588     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9589         IF PI-PMTTYPE = '5' OR '6'
  9590             NEXT SENTENCE
  9591         ELSE
  9592             MOVE ER-0555             TO EMI-ERROR
  9593             MOVE -1                  TO PMTTYPEL
  9594             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9595
  9596     IF CL-LAST-CLOSE-REASON = '2'
  9597         IF CL-CLAIM-STATUS = 'C'
  9598             MOVE ER-0760        TO  EMI-ERROR
  9599             MOVE -1             TO  PMTTYPEL
  9600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9601
  9602     IF PI-ACTIVITY-CODE = 9
  9603         MOVE ER-3538            TO  EMI-ERROR
  9604         MOVE -1                 TO  PMTTYPEL
  9605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9606
  9607     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9608         GO TO 1008-READ-CERT.
  9609**********************AIG LOGIC STARTS *********************
  9610     IF CL-CERT-PRIME = 'INCOMPLETE'
  9611         MOVE ER-3540            TO  EMI-ERROR
  9612         MOVE -1                 TO  PMTTYPEL
  9613         MOVE AL-UABON           TO  PMTTYPEA
  9614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9615         GO TO 2000-EDIT-DONE.
  9616
  9617     IF PI-PMTTYPE = '4'
  9618         IF PI-EPYAMT IS NEGATIVE
  9619             IF PI-ECHECKNO-CR = 'CR'
  9620                 NEXT SENTENCE
  9621             ELSE
  9622                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9623
  9624     IF PI-PMTTYPE = '4'
  9625         IF PI-ECHECKNO-CR = 'CR'
  9626             IF PI-EPYAMT IS NEGATIVE
  9627                 NEXT SENTENCE
  9628             ELSE
  9629                 MOVE ER-0834    TO  EMI-ERROR
  9630                 MOVE -1         TO  EPYAMTL
  9631                 MOVE AL-UNBON   TO  EPYAMTA
  9632                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9633
  9634     IF PI-PMTTYPE = '4'
  9635         IF PI-EPYAMT IS NEGATIVE
  9636             IF PI-OFFLINE = 'Y'
  9637                 NEXT SENTENCE
  9638             ELSE
  9639                 MOVE 'Y'        TO  PI-OFFLINE
  9640                                     WS-OFFLINE
  9641                                     OFFLINEO
  9642                 MOVE AL-UANON   TO  OFFLINEA.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 183
* EL156.cbl
  9643
  9644*    IF PI-PMTTYPE = '4'
  9645*        IF PI-EPYAMT IS NEGATIVE
  9646*            IF PI-CASH = 'Y'
  9647*                NEXT SENTENCE
  9648*            ELSE
  9649*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9650*                MOVE AL-UANON   TO  CASHA
  9651*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9652*
  9653*    IF PI-CASH NOT = 'Y' AND 'N'
  9654*         IF PI-OFFLINE = 'Y'  AND
  9655*            PI-ECHECKNO-CR = 'CR'
  9656*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9657*              MOVE AL-UANON     TO  CASHA
  9658*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9659*
  9660*    IF PI-CASH NOT = 'Y' AND 'N'
  9661*        IF PI-PMTTYPE = '5' OR '6'
  9662*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9663*            MOVE AL-UANON       TO  CASHA
  9664*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9665*
  9666*    IF PI-CASH NOT = 'Y' AND 'N'
  9667*       IF CL-ASSOCIATES = 'N' OR 'A'
  9668*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9669*           MOVE AL-UANON        TO  CASHA
  9670*       ELSE
  9671*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9672*           MOVE AL-UANON        TO  CASHA.
  9673*
  9674*    IF PI-PMTTYPE = '5' OR '6'
  9675*        IF PI-CASH = 'N'
  9676*            MOVE ER-0819        TO  EMI-ERROR
  9677*            MOVE AL-UANON       TO  CASHA
  9678*            MOVE -1             TO  CASHL
  9679*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9680*
  9681*    IF CL-ASSOCIATES = 'N' OR 'A'
  9682*       IF CASHI = 'N'
  9683*        MOVE ER-3537            TO  EMI-ERROR
  9684*        MOVE AL-UANON           TO  CASHA
  9685*        MOVE -1                 TO  CASHL
  9686*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9687
  9688 1007-DEFAULT-AIG-CHECKNO.
  9689
  9690     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9691         MOVE ER-3532            TO  EMI-ERROR
  9692         MOVE -1                 TO  PMTTYPEL
  9693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9694**********************AIG LOGIC ENDS ***********************
  9695
  9696 1008-READ-CERT.
  9697
  9698     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9699     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9700     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 184
* EL156.cbl
  9701     MOVE CL-CERT-STATE          TO CERT-STATE.
  9702     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9703     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9704     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9705     MOVE 'CERT'                 TO FILE-SWITCH.
  9706
  9707     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9708
  9709     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9710         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9711     ELSE
  9712         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9713
  9714*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9715*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9716
  9717     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9718         MOVE ER-0458            TO EMI-ERROR
  9719         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9720
  9721     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9722         MOVE ER-0459            TO EMI-ERROR
  9723         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9724
  9725     IF CL-REPORTED-DT = LOW-VALUES
  9726        MOVE ER-0530             TO EMI-ERROR
  9727        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9728
  9729     IF PI-COMPANY-ID = 'NCL'
  9730        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9731            MOVE ER-0770            TO EMI-ERROR
  9732            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9733
  9734     IF PI-COMPANY-ID = 'NCL'
  9735        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9736            MOVE ER-0737            TO EMI-ERROR
  9737            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9738
  9739     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9740         MOVE ER-0768            TO  EMI-ERROR
  9741         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9742
  9743     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9744         MOVE ER-0769            TO  EMI-ERROR
  9745         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9746
  9747     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9748         GO TO 1020-DO-LIFE-EDITS
  9749     ELSE
  9750         GO TO 1030-DO-AH-EDITS.
  9751
  9752 1010-GENERAL-ERROR.
  9753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9754
  9755     IF EMI-MESSAGE-FORMATTED
  9756         MOVE -1                 TO PMTTYPEL.
  9757
  9758 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 185
* EL156.cbl
  9759     EXIT.
  9760
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 186
* EL156.cbl
  9762 1020-DO-LIFE-EDITS.
  9763     IF CM-LF-BENEFIT-CD = '00'
  9764         IF PI-PMTTYPE = '5' OR '6'
  9765             MOVE ER-0658        TO EMI-ERROR
  9766             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9767         ELSE
  9768             MOVE ER-1775        TO EMI-ERROR
  9769             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9770
  9771     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9772     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9773         MOVE ER-0460            TO EMI-ERROR
  9774         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9775
  9776     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9777     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9778     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9779     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9780     MOVE '4'                    TO  CNTL-REC-TYPE.
  9781     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9782     MOVE 'BENE'                 TO  FILE-SWITCH.
  9783     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9784     IF NO-BENEFIT-FOUND
  9785         GO TO 1950-NOT-FOUND.
  9786
  9787     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9788
  9789     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9790         IF PI-PMTTYPE = '4'
  9791             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9792                PI-LF-COVERAGE-TYPE = 'P'
  9793                 NEXT SENTENCE
  9794             ELSE
  9795                 MOVE ER-0461        TO EMI-ERROR
  9796                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9797         ELSE
  9798            NEXT SENTENCE
  9799     ELSE
  9800         IF PI-PMTTYPE = '2'
  9801            IF NOT CM-O-B-COVERAGE
  9802              AND CM-LF-CURRENT-STATUS = '7'
  9803                MOVE ER-0462     TO EMI-ERROR
  9804                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9805
  9806     IF PI-PMTTYPE = '2'
  9807         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9808            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9809             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9810             MOVE ER-0730            TO  EMI-ERROR
  9811             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9812             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9813
  9814     IF PI-PMTTYPE = '2'
  9815         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9816            PI-LF-COVERAGE-TYPE = 'P'
  9817             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9818                 MOVE ER-0462    TO  EMI-ERROR
  9819                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 187
* EL156.cbl
  9820
  9821     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9822       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9823         MOVE ER-0466            TO EMI-ERROR
  9824         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9825
  9826     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9827         IF PI-PMTTYPE = '3'
  9828             MOVE 0436           TO EMI-ERROR
  9829             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9830             GO TO 1045-EDIT-PAYEE-ADDR
  9831         ELSE
  9832             GO TO 1045-EDIT-PAYEE-ADDR.
  9833
  9834     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9835        PI-LF-COVERAGE-TYPE = 'P'
  9836         IF PI-PMTTYPE = '3'
  9837             MOVE ER-0436          TO  EMI-ERROR
  9838             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9839         ELSE
  9840             NEXT SENTENCE
  9841     ELSE
  9842         IF PI-PMTTYPE = '1' OR '3'
  9843             MOVE ER-0436            TO EMI-ERROR
  9844             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9845*
  9846     IF PI-COMPANY-ID = 'CID' AND
  9847        CL-CERT-STATE = 'SC'  AND
  9848        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9849           MOVE ER-0879    TO  EMI-ERROR
  9850           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9851           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9852     END-IF.
  9853     IF PI-COMPANY-ID = 'AHL'
  9854        evaluate true
  9855           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9856              MOVE ER-0879       TO  EMI-ERROR
  9857              PERFORM 1040-PMTTYPE-ERROR
  9858                                 THRU 1040-EXIT
  9859              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9860           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9861                 '6D' OR '6H' OR '6R'
  9862              MOVE ER-0879       TO  EMI-ERROR
  9863              PERFORM 1040-PMTTYPE-ERROR
  9864                                 THRU 1040-EXIT
  9865              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9866           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9867              MOVE ER-0879       TO  EMI-ERROR
  9868              PERFORM 1040-PMTTYPE-ERROR
  9869                                 THRU 1040-EXIT
  9870              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9871        end-evaluate
  9872     END-IF
  9873     GO TO 1045-EDIT-PAYEE-ADDR.
  9874
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 188
* EL156.cbl
  9876 1030-DO-AH-EDITS.
  9877     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9878     IF CM-AH-BENEFIT-CD = '00'
  9879         IF PI-PMTTYPE = '5' OR '6'
  9880             MOVE ER-0658        TO EMI-ERROR
  9881             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9882         ELSE
  9883             MOVE ER-1775        TO EMI-ERROR
  9884             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9885
  9886     IF CL-TOTAL-PAID-AMT = ZEROS
  9887         IF PI-PMTTYPE = '4'
  9888             MOVE ER-0438        TO EMI-ERROR
  9889             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9890
  9891     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9892         IF PI-PMTTYPE = '3'
  9893             MOVE ER-0463        TO EMI-ERROR
  9894             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9895         ELSE
  9896             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9897              AND CM-LF-CURRENT-STATUS = '7'
  9898                 MOVE ER-0465    TO EMI-ERROR
  9899                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9900
  9901     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9902         IF PI-PMTTYPE = '3'
  9903             MOVE ER-0464        TO EMI-ERROR
  9904             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9905         ELSE
  9906             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9907                 MOVE ER-0469    TO EMI-ERROR
  9908                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9909
  9910     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9911         IF PI-PMTTYPE = '3'
  9912             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9913                 MOVE ER-0467    TO EMI-ERROR
  9914                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9915             ELSE
  9916                 NEXT SENTENCE
  9917         ELSE
  9918             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9919                 MOVE ER-0468    TO EMI-ERROR
  9920                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9921
  9922     GO TO 1045-EDIT-PAYEE-ADDR.
  9923
  9924 1040-PMTTYPE-ERROR.
  9925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9926
  9927     IF EMI-MESSAGE-FORMATTED
  9928         MOVE -1                 TO PMTTYPEL
  9929         MOVE AL-UABON           TO PMTTYPEA.
  9930
  9931 1040-EXIT.
  9932     EXIT.
  9933
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 189
* EL156.cbl
  9935 1045-EDIT-PAYEE-ADDR.
  9936
  9937     IF PI-OFFLINE = 'N' AND
  9938        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9939           < PI-PAYEE-SEQ-NUM)
  9940        OR
  9941         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9942         (PI-PAYEE-TYPE = 'B')                 AND
  9943         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9944        OR
  9945         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9946           < PI-PAYEE-SEQ-NUM)
  9947        OR
  9948         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9949           < PI-PAYEE-SEQ-NUM)
  9950        OR
  9951         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9952           < PI-PAYEE-SEQ-NUM)
  9953        OR
  9954         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9955           < PI-PAYEE-SEQ-NUM)
  9956        OR
  9957         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9958           < PI-PAYEE-SEQ-NUM))
  9959             MOVE ER-0437        TO EMI-ERROR
  9960             MOVE -1             TO PAYEEL
  9961             MOVE AL-UABON       TO PAYEEA
  9962             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9963
  9964     IF PI-OFFLINE    = 'N' AND
  9965        PI-PAYEE-TYPE = 'B' AND
  9966        PI-PAYEE-SEQ  = '0'
  9967         PERFORM 7920-READ-BENE THRU 7920-EXIT
  9968         IF BENE-FOUND-SW = 'N'
  9969             MOVE ER-0437        TO EMI-ERROR
  9970             MOVE -1             TO PAYEEL
  9971             MOVE AL-UABON       TO PAYEEA
  9972             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9973
  9974     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9975        IF PI-OFFLINE    = 'N'  AND
  9976           PI-PAYEE-TYPE = 'B'  AND
  9977           PI-PAYEE-SEQ  = '9'
  9978             PERFORM 7920-READ-BENE THRU 7920-EXIT
  9979             IF BENE-FOUND-SW = 'N'
  9980                MOVE ER-0437        TO EMI-ERROR
  9981                MOVE -1             TO PAYEEL
  9982                MOVE AL-UABON       TO PAYEEA
  9983                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9984
  9985*    IF PI-COMPANY-ID = 'CRI'
  9986*        IF CL-CLAIM-TYPE = 'L'
  9987*            MOVE 'N'                TO  WS-GROUPED
  9988*                                        PI-GROUPED
  9989*                                        GROUPEDI
  9990*            MOVE AL-UANON           TO  GROUPEDA
  9991*            GO TO 1050-EDIT-CHECK-NO
  9992*        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 190
* EL156.cbl
  9993*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
  9994*            IF WS-GROUP-1 = 'C'
  9995*                NEXT SENTENCE
  9996*            ELSE
  9997*                MOVE 'N'            TO  WS-GROUPED
  9998*                                        PI-GROUPED
  9999*                                        GROUPEDI
 10000*                MOVE AL-UANON       TO  GROUPEDA
 10001*                GO TO 1050-EDIT-CHECK-NO.
 10002
 10003*     IF PI-GROUPED = 'Y'
 10004*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10005*           NEXT SENTENCE
 10006*        ELSE
 10007*           MOVE ER-0437        TO EMI-ERROR
 10008*           MOVE -1             TO PAYEEL
 10009**02180            MOVE AL-UABON       TO PAYEEA
 10010*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10011*
 10012*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10013*        (PI-GROUPED    = ' ')
 10014*        NEXT SENTENCE
 10015*     ELSE
 10016*
 10017     GO TO 1050-EDIT-CHECK-NO.
 10018*     IF PI-COMPANY-ID = 'CRI'
 10019*        MOVE 'N'           TO GROUPEDI
 10020*                              PI-GROUPED
 10021*                              WS-GROUPED
 10022*        MOVE AL-UANON      TO GROUPEDA.
 10023*
 10024*     IF PI-COMPANY-ID = 'CRI'
 10025*        IF PI-PAYEE-TYPE = 'B'
 10026*           IF BENE-FOUND-SW = 'Y'
 10027*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10028*                 MOVE 'Y'           TO GROUPEDI
 10029*                                       PI-GROUPED
 10030*                                       WS-GROUPED
 10031*                 MOVE AL-UANON      TO GROUPEDA
 10032*              ELSE
 10033*                 NEXT SENTENCE
 10034*           ELSE
 10035*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10036*              IF BENE-FOUND-SW = 'Y'
 10037*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10038*                    MOVE 'Y'      TO GROUPEDI
 10039*                                     PI-GROUPED
 10040*                                     WS-GROUPED
 10041*                    MOVE AL-UANON TO GROUPEDA.
 10042*
 10043
 10044     IF PI-COMPANY-ID NOT = 'CRI'
 10045        GO TO 1050-EDIT-CHECK-NO.
 10046
 10047*************** CRI CODE START ******************
 10048     IF PI-PAYEE-TYPE NOT = 'A'
 10049        GO TO 1050-EDIT-CHECK-NO.
 10050
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 191
* EL156.cbl
 10051     MOVE LOW-VALUES             TO ERACCT-KEY.
 10052     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10053     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10054     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10055     MOVE PI-STATE               TO ACCT-STATE.
 10056     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10057     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10058     MOVE 'ACCT'                 TO FILE-SWITCH.
 10059
 10060     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10061     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10062
 10063
 10064* EXEC CICS HANDLE CONDITION
 10065*         NOTFND   (1950-NOT-FOUND)
 10066*         ENDFILE  (1950-NOT-FOUND)
 10067*    END-EXEC.
 10068*    MOVE '"$I''                  ! ( #00009692' TO DFHEIV0
 10069     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10071     MOVE X'2820233030303039363932' TO DFHEIV0(25:11)
 10072     CALL 'kxdfhei1' USING DFHEIV0
 10073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10074
 10075
 10076
 10077* EXEC CICS STARTBR
 10078*         DATASET   ('ERACCT')
 10079*         RIDFLD    (ERACCT-KEY)
 10080*         GTEQ
 10081*    END-EXEC.
 10082     MOVE 'ERACCT' TO DFHEIV1
 10083     MOVE 0
 10084       TO DFHEIV11
 10085*    MOVE '&,         G          &   #00009697' TO DFHEIV0
 10086     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10087     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10088     MOVE X'2020233030303039363937' TO DFHEIV0(25:11)
 10089     CALL 'kxdfhei1' USING DFHEIV0,
 10090           DFHEIV1,
 10091           ERACCT-KEY,
 10092           DFHEIV99,
 10093           DFHEIV11,
 10094           DFHEIV99
 10095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10096
 10097
 10098 1046-READNEXT-ERACCT.
 10099
 10100
 10101* EXEC CICS READNEXT
 10102*         DATASET   ('ERACCT')
 10103*         RIDFLD    (ERACCT-KEY)
 10104*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10105*    END-EXEC.
 10106     MOVE 'ERACCT' TO DFHEIV1
 10107     MOVE 0
 10108       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 192
* EL156.cbl
 10109*    MOVE '&.S                   )   #00009705' TO DFHEIV0
 10110     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10111     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10112     MOVE X'2020233030303039373035' TO DFHEIV0(25:11)
 10113     CALL 'kxdfhei1' USING DFHEIV0,
 10114           DFHEIV1,
 10115           DFHEIV20,
 10116           DFHEIV99,
 10117           ERACCT-KEY,
 10118           DFHEIV99,
 10119           DFHEIV11,
 10120           DFHEIV99,
 10121           DFHEIV99
 10122     SET ADDRESS OF ACCOUNT-MASTER TO
 10123         DFHEIV20
 10124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10125
 10126
 10127     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10128        IF WS-ERACCT-HOLD-RECORD = SPACES
 10129           GO TO 1950-NOT-FOUND
 10130        ELSE
 10131           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10132           GO TO 1048-CONTINUE.
 10133
 10134     IF ACCT-EXP-DT = HIGH-VALUES
 10135        NEXT SENTENCE
 10136     ELSE
 10137        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10138        GO TO 1046-READNEXT-ERACCT.
 10139
 10140 1048-CONTINUE.
 10141
 10142*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10143*       MOVE 'Y'                 TO GROUPEDI
 10144*                                   PI-GROUPED
 10145*                                   WS-GROUPED
 10146*       MOVE AL-UANON            TO GROUPEDA.
 10147*************** CRI CODE END ******************
 10148
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 193
* EL156.cbl
 10150 1050-EDIT-CHECK-NO.
 10151
 10152     IF PI-OFFLINE = 'Y'
 10153         IF PI-ECHECKNO = SPACES
 10154              MOVE ER-0439        TO EMI-ERROR
 10155              GO TO 1090-CHECK-NO-ERROR
 10156           ELSE
 10157*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10158*           IF PI-ECHECKNO-N = 'N' AND
 10159*              PI-CASH       = 'Y'
 10160*                MOVE ER-3535        TO EMI-ERROR
 10161*                GO TO 1090-CHECK-NO-ERROR
 10162*             ELSE
 10163*                MOVE AL-UANON    TO CHECKNOA
 10164*                GO TO 1100-EDIT-HOLDTIL
 10165*         ELSE
 10166            MOVE AL-UANON    TO CHECKNOA
 10167            GO TO 1100-EDIT-HOLDTIL.
 10168
 10169     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10170     MOVE '6'                    TO CNTL-REC-TYPE.
 10171
 10172     IF CONTROL-IS-ACTUAL-CARRIER
 10173         MOVE PI-CARRIER         TO WS-CARR
 10174     ELSE
 10175         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10176
 10177     IF PI-COMPANY-ID = 'FIA'
 10178         MOVE PI-CARRIER         TO WS-CARR.
 10179
 10180     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10181     MOVE 0                      TO CNTL-SEQ-NO.
 10182     MOVE 'CARR'                 TO FILE-SWITCH.
 10183
 10184     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10185
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 194
* EL156.cbl
 10187     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10188         GO TO 1051-EDIT-CHECKNO-CONT.
 10189
 10190**********************AIG LOGIC STARTS**********************
 10191     IF PI-ECHECKNO = SPACES
 10192         IF CHECK-NO-MANUAL
 10193             MOVE ER-0441        TO EMI-ERROR
 10194             GO TO 1090-CHECK-NO-ERROR
 10195         ELSE
 10196             MOVE AL-UANOF       TO CHECKNOA
 10197             GO TO 1100-EDIT-HOLDTIL.
 10198
 10199     IF PI-ECHECKNO NOT = SPACES
 10200         IF CHECK-NO-MANUAL
 10201             MOVE AL-UANON       TO CHECKNOA
 10202             GO TO 1100-EDIT-HOLDTIL.
 10203
 10204     IF PI-ECHECKNO-CR = 'CR'
 10205        IF PI-OFFLINE = 'Y'
 10206            MOVE AL-UANON       TO CHECKNOA
 10207            GO TO 1100-EDIT-HOLDTIL
 10208        ELSE
 10209            MOVE ER-3534        TO EMI-ERROR
 10210            GO TO 1090-CHECK-NO-ERROR.
 10211
 10212     IF PI-ECHECKNO-N = 'N'
 10213        IF PI-CASH = 'N'
 10214            MOVE AL-UANON       TO CHECKNOA
 10215            GO TO 1100-EDIT-HOLDTIL
 10216        ELSE
 10217            MOVE ER-3535          TO EMI-ERROR
 10218            GO TO 1090-CHECK-NO-ERROR.
 10219
 10220     MOVE ER-0442        TO EMI-ERROR
 10221     GO TO 1090-CHECK-NO-ERROR.
 10222**********************AIG LOGIC ENDS************************
 10223
 10224 1051-EDIT-CHECKNO-CONT.
 10225
 10226     IF PI-COMPANY-ID = 'DMD'
 10227        IF PI-ECHECKNO NOT = SPACES
 10228           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10229              MOVE ER-0442        TO EMI-ERROR
 10230              GO TO 1090-CHECK-NO-ERROR
 10231            ELSE
 10232              GO TO 1100-EDIT-HOLDTIL
 10233          ELSE
 10234           GO TO 1100-EDIT-HOLDTIL.
 10235
 10236     IF PI-ECHECKNO = SPACES
 10237         IF CHECK-NO-MANUAL
 10238             MOVE ER-0441        TO EMI-ERROR
 10239             GO TO 1090-CHECK-NO-ERROR
 10240         ELSE
 10241             MOVE AL-UANOF       TO CHECKNOA
 10242             GO TO 1100-EDIT-HOLDTIL
 10243     ELSE
 10244         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 195
* EL156.cbl
 10245             MOVE AL-UANON       TO CHECKNOA
 10246             GO TO 1100-EDIT-HOLDTIL
 10247         ELSE
 10248             MOVE ER-0442        TO EMI-ERROR
 10249             GO TO 1090-CHECK-NO-ERROR.
 10250
 10251 1090-CHECK-NO-ERROR.
 10252     MOVE -1                     TO CHECKNOL.
 10253     MOVE AL-UABON               TO CHECKNOA.
 10254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10255
 10256     GO TO 2000-EDIT-DONE.
 10257
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 196
* EL156.cbl
 10259 1100-EDIT-HOLDTIL.
 10260     MOVE AL-UANON               TO HOLDTILA.
 10261
 10262     IF PI-HOLDTIL = ZEROS
 10263        IF PI-OFFLINE = 'Y'
 10264           MOVE ER-0572          TO EMI-ERROR
 10265           GO TO 1105-HOLDTIL-ERROR
 10266        ELSE
 10267           GO TO 1110-EDIT-PAID-FROM.
 10268
 10269     MOVE '4'                    TO DC-OPTION-CODE.
 10270     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10271     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10272
 10273     IF DATE-CONVERSION-ERROR
 10274         MOVE ER-0446            TO EMI-ERROR
 10275         GO TO 1105-HOLDTIL-ERROR
 10276     END-IF
 10277     IF PI-OFFLINE = 'Y'
 10278        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10279           MOVE ER-0446            TO EMI-ERROR
 10280           GO TO 1105-HOLDTIL-ERROR
 10281        END-IF
 10282     END-IF
 10283
 10284     IF PI-OFFLINE = 'Y'
 10285        GO TO 1110-EDIT-PAID-FROM.
 10286
 10287     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10288     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10289     MOVE '1'                    TO DC-OPTION-CODE.
 10290     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10291
 10292     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10293         MOVE ER-0447            TO EMI-ERROR
 10294         GO TO 1105-HOLDTIL-ERROR.
 10295
 10296     GO TO 1110-EDIT-PAID-FROM.
 10297
 10298 1105-HOLDTIL-ERROR.
 10299     MOVE -1                     TO HOLDTILL.
 10300     MOVE AL-UNBON               TO HOLDTILA.
 10301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10302
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 197
* EL156.cbl
 10304 1110-EDIT-PAID-FROM.
 10305     MOVE AL-UANON               TO EPYFROMA.
 10306
 10307     IF PI-EPYFROM = ZEROS
 10308         GO TO 1120-CALCULATE-PAID-FROM.
 10309
 10310     IF PI-PMTTYPE = '5' OR '6'
 10311         MOVE ER-0448            TO EMI-ERROR
 10312         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10313         MOVE AL-UNBON           TO EPYFROMA
 10314         MOVE -1                 TO EPYFROML
 10315         GO TO 1150-EDIT-PAID-THRU.
 10316
 10317     MOVE '4'                    TO DC-OPTION-CODE.
 10318     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10319     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10320
 10321     IF DATE-CONVERSION-ERROR
 10322         MOVE ER-0449            TO EMI-ERROR
 10323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10324         MOVE AL-UNBON           TO EPYFROMA
 10325         MOVE -1                 TO EPYFROML
 10326     ELSE
 10327         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10328
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 198
* EL156.cbl
 10330 1120-CALCULATE-PAID-FROM.
 10331     IF PI-PMTTYPE = '5' OR '6'
 10332         GO TO 1150-EDIT-PAID-THRU.
 10333
 10334*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10335*       IF PI-PMTTYPE = '4'
 10336*         GO TO 1150-EDIT-PAID-THRU.
 10337
 10338     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10339         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10340         MOVE ' '                TO DC-OPTION-CODE
 10341         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10342         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10343         GO TO 1145-TEST-PAID-FROM.
 10344
 10345     IF PI-PMTTYPE = '4'
 10346        GO TO 1150-EDIT-PAID-THRU.
 10347
 10348     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10349     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10350     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10351     MOVE '5'                    TO CNTL-REC-TYPE.
 10352     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10353     MOVE 'BENE'                 TO FILE-SWITCH.
 10354
 10355     IF WS-BEN-CD = ZEROS
 10356         GO TO 1950-NOT-FOUND.
 10357
 10358     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10359
 10360     IF NO-BENEFIT-FOUND
 10361         GO TO 1950-NOT-FOUND.
 10362
 10363     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10364     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10365
 10366     IF PI-BEN-DAYS NOT NUMERIC
 10367        MOVE ZEROS               TO PI-BEN-DAYS.
 10368
 10369     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10370
 10371     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10372        (CL-TOTAL-PAID-AMT > ZEROS)
 10373         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10374         MOVE '6'                 TO DC-OPTION-CODE
 10375         MOVE +0                  TO DC-ELAPSED-MONTHS
 10376         MOVE +1                  TO DC-ELAPSED-DAYS
 10377         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10378         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10379         GO TO 1145-TEST-PAID-FROM.
 10380
 10381******************************************************************
 10382****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10383****** SPECIAL ENTERED DATE.
 10384******************************************************************
 10385
 10386     IF PI-AIGFROM = ZEROS
 10387         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 199
* EL156.cbl
 10388
 10389     MOVE AL-UANON TO AIGFROMA.
 10390
 10391     MOVE '4'                    TO DC-OPTION-CODE.
 10392     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10393     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10394
 10395     IF DATE-CONVERSION-ERROR
 10396         MOVE ER-0449            TO EMI-ERROR
 10397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10398         MOVE AL-UNBON           TO AIGFROMA
 10399         MOVE -1                 TO AIGFROML
 10400         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10401     ELSE
 10402         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10403         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10404
 10405     GO TO 1140-CONTINUE-PAID-FROM.
 10406
 10407 1130-CONTINUE-PAID-FROM.
 10408
 10409     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10410        (CL-TOTAL-PAID-AMT = ZEROS)
 10411           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10412
 10413 1140-CONTINUE-PAID-FROM.
 10414
 10415     IF PI-BEN-TYPE = 'R'
 10416         IF PI-BEN-DAYS = ZEROS
 10417             NEXT SENTENCE
 10418         ELSE
 10419         IF PI-COMPANY-ID NOT = 'DMD'
 10420             SUBTRACT 1 FROM PI-BEN-DAYS.
 10421
 10422     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10423
 10424     IF PI-COMPANY-ID = 'DMD'
 10425         MOVE -1                 TO DC-ELAPSED-DAYS
 10426         MOVE +0                 TO DC-ELAPSED-MONTHS
 10427         MOVE '6'                TO DC-OPTION-CODE
 10428         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10429         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10430         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10431                               REMAINDER DC-ELAPSED-DAYS
 10432      ELSE
 10433         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10434         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10435
 10436     MOVE '6'                    TO DC-OPTION-CODE.
 10437     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10438     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10439
 10440     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10441
 10442     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10443         MOVE ER-0541            TO EMI-ERROR
 10444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10445         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 200
* EL156.cbl
 10446         MOVE AL-UNBON           TO EPYFROMA.
 10447
 10448     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10449        (PI-BENEFIT-SAVE = '60E')
 10450        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10451           (CL-TOTAL-PAID-AMT = ZEROS)
 10452             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10453             MOVE 30                  TO DC-ELAPSED-DAYS
 10454             MOVE +0                  TO DC-ELAPSED-MONTHS
 10455             MOVE '6'                 TO DC-OPTION-CODE
 10456             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10457
 10458     IF PI-BEN-TYPE = 'R'
 10459         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10460     ELSE
 10461         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10462         IF WS-SV-EPYFROM = LOW-VALUES
 10463            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10464
 10465     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10466         IF WS-USE-AIG-PAYFROM   OR
 10467            WS-AIG-RECALC-PAYFROM
 10468              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10469                                      DC-BIN-DATE-1
 10470              MOVE ' '            TO  DC-OPTION-CODE
 10471              MOVE +0             TO  DC-ELAPSED-MONTHS
 10472                                      DC-ELAPSED-DAYS
 10473              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10474              IF NO-CONVERSION-ERROR
 10475                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10476
 10477     IF PI-CPYFROM < CL-INCURRED-DT
 10478        MOVE -1                  TO EPYFROML
 10479        MOVE ER-3542             TO EMI-ERROR
 10480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10481
 10482     IF CM-ENTRY-DT < CL-INCURRED-DT
 10483        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10484        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10485        MOVE +0                     TO DC-ELAPSED-DAYS
 10486        MOVE +0                     TO DC-ELAPSED-MONTHS
 10487        MOVE '1'                    TO DC-OPTION-CODE
 10488        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10489        ELSE
 10490        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10491
 10492     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10493         NEXT SENTENCE
 10494     ELSE
 10495         IF DC-ELAPSED-MONTHS < 2
 10496             MOVE ER-3255        TO EMI-ERROR
 10497             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10498
 10499 1145-TEST-PAID-FROM.
 10500     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10501         GO TO 1150-EDIT-PAID-THRU.
 10502
 10503     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 201
* EL156.cbl
 10504         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10505         MOVE ' '                TO DC-OPTION-CODE
 10506         MOVE +0                 TO DC-ELAPSED-MONTHS
 10507                                    DC-ELAPSED-DAYS
 10508         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10509         IF NO-CONVERSION-ERROR
 10510             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10511         ELSE
 10512             MOVE SPACES             TO EMI-DATE-FIELD.
 10513
 10514     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10515         IF CL-TOTAL-PAID-AMT = ZEROS
 10516             MOVE ER-3543            TO EMI-ERROR
 10517             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10518             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10519             IF EMI-MESSAGE-FORMATTED
 10520                MOVE -1             TO EPYFROML
 10521                MOVE AL-UNBON       TO EPYFROMA
 10522             ELSE
 10523                NEXT SENTENCE
 10524         ELSE
 10525             MOVE ER-0452            TO EMI-ERROR
 10526             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10527             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10528             IF EMI-MESSAGE-FORMATTED
 10529                MOVE -1             TO EPYFROML
 10530                MOVE AL-UNBON       TO EPYFROMA.
 10531
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 202
* EL156.cbl
 10533 1150-EDIT-PAID-THRU.
 10534
 10535     MOVE AL-UANON               TO EPYTHRUA.
 10536
 10537     IF PI-EPYTHRU = ZEROS
 10538         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10539             GO TO 1200-EDIT-FIND-TOLERANCES
 10540         ELSE
 10541            IF (PI-PMTTYPE = '3') OR
 10542               (PI-PMTTYPE = '2' AND
 10543                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10544               GO TO 1152-CHECK-TYPE
 10545            ELSE
 10546               MOVE ER-0473      TO EMI-ERROR
 10547               GO TO 1170-PAID-THRU-FATAL-ERROR
 10548     ELSE
 10549         IF PI-PMTTYPE = '5' OR '6'
 10550             MOVE ER-0474        TO EMI-ERROR
 10551             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10552
 10553     MOVE '4'                    TO DC-OPTION-CODE.
 10554     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10555     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10556
 10557     IF DATE-CONVERSION-ERROR
 10558         MOVE ER-0475            TO EMI-ERROR
 10559         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10560
 10561     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10562
 10563     IF PI-COMPANY-ID = 'DMD'
 10564         IF PI-PMTTYPE NOT = '2'
 10565                 AND
 10566            WS-EXP-DT > WS-SV-EPYTHRU
 10567             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10568             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10569             MOVE '1'              TO DC-OPTION-CODE
 10570             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10571             IF DATE-CONVERSION-ERROR
 10572                 MOVE ER-0944      TO EMI-ERROR
 10573                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10574             ELSE
 10575                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10576                    DC-ELAPSED-DAYS   = 1
 10577                     MOVE ER-0945  TO EMI-ERROR
 10578                     MOVE -1       TO EPYTHRUL
 10579                     MOVE AL-UABON TO EPYTHRUA
 10580                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10581
 10582     IF PI-PMTTYPE = '4'
 10583         NEXT SENTENCE
 10584     ELSE
 10585         IF WS-SV-EPYTHRU = WS-EXP-DT
 10586             IF PI-PMTTYPE NOT = '2' AND '3'
 10587                 MOVE ER-3541    TO EMI-ERROR
 10588                 MOVE -1         TO PMTTYPEL
 10589                 MOVE AL-UABON   TO PMTTYPEA
 10590                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 203
* EL156.cbl
 10591
 10592     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10593         MOVE ER-0501            TO EMI-ERROR
 10594         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10595
 10596     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10597        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10598*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10599*              MOVE ER-0540         TO EMI-ERROR
 10600*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10601*              MOVE -1              TO EPYTHRUL
 10602*              MOVE AL-UNBON        TO EPYTHRUA
 10603*          ELSE
 10604*          IF PI-COMPANY-ID = 'DMD'
 10605*              MOVE ER-7540         TO EMI-ERROR
 10606*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10607*              MOVE -1              TO EPYTHRUL
 10608*              MOVE AL-UNBON        TO EPYTHRUA
 10609*          ELSE
 10610               IF PI-PMTTYPE NOT = '2' AND '3'
 10611                  IF PI-COMPANY-ID = '???'
 10612                      MOVE ER-7540  TO EMI-ERROR
 10613                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10614                      MOVE -1       TO EPYTHRUL
 10615                      MOVE AL-UNBON TO EPYTHRUA
 10616                  ELSE
 10617                      MOVE ER-0540  TO EMI-ERROR
 10618                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10619                      MOVE -1       TO EPYTHRUL
 10620                      MOVE AL-UNBON TO EPYTHRUA.
 10621
 10622     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10623            OR
 10624        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10625         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10626            OR
 10627        (PI-CPYFROM NOT = LOW-VALUES AND
 10628         PI-CPYFROM < CL-PAID-THRU-DT)
 10629        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10630
 10631 1152-CHECK-TYPE.
 10632     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10633        OR (PI-PMTTYPE = '5' OR '6')
 10634         GO TO 1160-EDIT-PAID-THRU-AH.
 10635
 10636 1155-EDIT-PAID-THRU-LIFE.
 10637     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10638     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10639     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10640     MOVE '4'                    TO CNTL-REC-TYPE.
 10641     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10642     MOVE 'BENE'                 TO FILE-SWITCH.
 10643
 10644     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10645
 10646     IF NO-BENEFIT-FOUND
 10647         GO TO 1950-NOT-FOUND.
 10648
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 204
* EL156.cbl
 10649     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10650
 10651     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10652
 10653     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10654        PI-LF-COVERAGE-TYPE = 'P'
 10655         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10656         GO TO 1200-EDIT-FIND-TOLERANCES.
 10657
 10658     IF PI-EPYTHRU = ZEROS
 10659        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10660
 10661     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10662         MOVE ER-0476            TO EMI-ERROR
 10663         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10664
 10665     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10666*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10667     move cl-critical-period    to dc-elapsed-months
 10668     MOVE +0                    TO DC-ELAPSED-DAYS.
 10669     MOVE '6'                   TO DC-OPTION-CODE.
 10670     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10671
 10672     IF (NO-CONVERSION-ERROR AND
 10673         WS-SPECIAL-CALC-CD = 'C')
 10674        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10675            MOVE ER-0657 TO EMI-ERROR
 10676            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10677
 10678     IF PI-COMPANY-ID = 'NCL'
 10679         IF WS-SPECIAL-CALC-CD = 'C' AND
 10680            cl-critical-period = zeros
 10681*           CM-LF-CRITICAL-PERIOD = +0
 10682             MOVE ER-0844       TO EMI-ERROR
 10683             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10684
 10685     GO TO 1200-EDIT-FIND-TOLERANCES.
 10686
 10687 1160-EDIT-PAID-THRU-AH.
 10688     IF PI-EPYTHRU = ZEROS
 10689        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10690                                    WS-SV-EPYTHRU
 10691     ELSE
 10692        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10693
 10694     IF WS-SV-EPYTHRU < PI-CPYFROM
 10695         MOVE ER-0508            TO EMI-ERROR
 10696         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10697
 10698     IF PI-PMTTYPE = '3'
 10699        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10700         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10701             MOVE ER-0477        TO EMI-ERROR
 10702             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10703         ELSE
 10704             NEXT SENTENCE
 10705     ELSE
 10706         IF WS-SV-EPYTHRU > WS-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 205
* EL156.cbl
 10707             MOVE ER-0557        TO EMI-ERROR
 10708             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10709
 10710     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10711         PI-PMTTYPE NOT = '3'
 10712         MOVE ER-0541        TO EMI-ERROR
 10713         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10714
 10715     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10716        (PI-PMTTYPE NOT = '3')
 10717         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10718             MOVE ER-0478        TO EMI-ERROR
 10719             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10720
 10721     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10722        (PI-PMTTYPE NOT = '4')
 10723         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10724             MOVE ER-0479        TO EMI-ERROR
 10725             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10726
 10727     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10728         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10729             MOVE ER-0545        TO EMI-ERROR
 10730             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10731
 10732     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10733         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10734             MOVE ER-0481        TO EMI-ERROR
 10735             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10736
 10737*    IF PI-COMPANY-ID = 'NCL'
 10738*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10739*           CM-AH-CRITICAL-PERIOD = +0
 10740*            MOVE ER-0844        TO  EMI-ERROR
 10741*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10742
 10743*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10744     if (cl-critical-period = zeros)
 10745        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10746          GO TO 1200-EDIT-FIND-TOLERANCES.
 10747
 10748     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10749     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10750     MOVE '1'        TO DC-OPTION-CODE.
 10751     MOVE +0         TO DC-ELAPSED-DAYS
 10752                        DC-ELAPSED-MONTHS.
 10753     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10754
 10755*    IF NO-CONVERSION-ERROR
 10756*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10757*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10758*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10759*           MOVE ER-0657 TO EMI-ERROR
 10760*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10761
 10762     GO TO 1200-EDIT-FIND-TOLERANCES.
 10763
 10764 1165-PAID-THRU-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 206
* EL156.cbl
 10765     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10766
 10767     IF EMI-MESSAGE-FORMATTED
 10768         MOVE -1                 TO EPYTHRUL
 10769         MOVE AL-UNBON           TO EPYTHRUA.
 10770
 10771 1165-EXIT.
 10772     EXIT.
 10773
 10774 1166-CHECK-ALL-TRLRS.
 10775
 10776     IF PI-PMTTYPE = '4'
 10777        GO TO 1166-TRLR-EXIT.
 10778
 10779     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10780
 10781     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10782        WS-SV-EPYFROM = LOW-VALUES
 10783          GO TO 1166-END-CHECK.
 10784
 10785
 10786* EXEC CICS HANDLE CONDITION
 10787*        ENDFILE   (1166-END-CHECK)
 10788*        NOTFND    (1166-END-CHECK)
 10789*    END-EXEC.
 10790*    MOVE '"$''I                  ! ) #00010369' TO DFHEIV0
 10791     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10793     MOVE X'2920233030303130333639' TO DFHEIV0(25:11)
 10794     CALL 'kxdfhei1' USING DFHEIV0
 10795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10796
 10797
 10798     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10799     MOVE +100                   TO TRLR-SEQ-NO.
 10800
 10801
 10802* EXEC CICS STARTBR
 10803*         DATASET    ('ELTRLR')
 10804*         RIDFLD     (ELTRLR-KEY)
 10805*         GTEQ
 10806*    END-EXEC.
 10807     MOVE 'ELTRLR' TO DFHEIV1
 10808     MOVE 0
 10809       TO DFHEIV11
 10810*    MOVE '&,         G          &   #00010377' TO DFHEIV0
 10811     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10812     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10813     MOVE X'2020233030303130333737' TO DFHEIV0(25:11)
 10814     CALL 'kxdfhei1' USING DFHEIV0,
 10815           DFHEIV1,
 10816           ELTRLR-KEY,
 10817           DFHEIV99,
 10818           DFHEIV11,
 10819           DFHEIV99
 10820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10821
 10822
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 207
* EL156.cbl
 10823     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10824
 10825 1166-READ-TRLR-NEXT.
 10826
 10827
 10828* EXEC CICS READNEXT
 10829*         DATASET    ('ELTRLR')
 10830*         RIDFLD     (ELTRLR-KEY)
 10831*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10832*    END-EXEC.
 10833     MOVE 'ELTRLR' TO DFHEIV1
 10834     MOVE 0
 10835       TO DFHEIV11
 10836*    MOVE '&.S                   )   #00010387' TO DFHEIV0
 10837     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10838     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10839     MOVE X'2020233030303130333837' TO DFHEIV0(25:11)
 10840     CALL 'kxdfhei1' USING DFHEIV0,
 10841           DFHEIV1,
 10842           DFHEIV20,
 10843           DFHEIV99,
 10844           ELTRLR-KEY,
 10845           DFHEIV99,
 10846           DFHEIV11,
 10847           DFHEIV99,
 10848           DFHEIV99
 10849     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10850         DFHEIV20
 10851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10852
 10853
 10854     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10855        TRLR-CARRIER  = MSTR-CARRIER  AND
 10856        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10857        TRLR-CERT-NO  = MSTR-CERT-NO
 10858          NEXT SENTENCE
 10859      ELSE
 10860          GO TO 1166-END-CHECK.
 10861
 10862* **  BYPASS ALL NON-PAYMENT TRAILERS
 10863
 10864     IF AT-TRAILER-TYPE = '2'
 10865        NEXT SENTENCE
 10866     ELSE
 10867        GO TO 1166-READ-TRLR-NEXT.
 10868
 10869* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10870
 10871     IF AT-PAYMENT-TYPE = '1' OR '2'
 10872        NEXT SENTENCE
 10873     ELSE
 10874        GO TO 1166-READ-TRLR-NEXT.
 10875
 10876* **  BYPASS ALL VOID PAYMENTS
 10877
 10878     IF AT-VOID-DT NOT = LOW-VALUES
 10879        GO TO 1166-READ-TRLR-NEXT.
 10880
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 208
* EL156.cbl
 10881     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10882        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10883          GO TO 1166-READ-TRLR-NEXT.
 10884
 10885     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10886         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10887            OR
 10888        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10889         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10890        NEXT SENTENCE
 10891     ELSE
 10892         IF CL-TOTAL-PAID-AMT > ZEROS
 10893             MOVE ER-0502            TO EMI-ERROR
 10894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10895             MOVE -1                 TO EPYTHRUL
 10896             MOVE AL-UNBON           TO EPYTHRUA.
 10897
 10898     GO TO 1166-READ-TRLR-NEXT.
 10899
 10900 1166-END-CHECK.
 10901
 10902     IF WS-BROWSE-TRLR-SW = 'Y'
 10903
 10904* EXEC CICS ENDBR
 10905*            DATASET   ('ELTRLR')
 10906*       END-EXEC.
 10907     MOVE 'ELTRLR' TO DFHEIV1
 10908     MOVE 0
 10909       TO DFHEIV11
 10910*    MOVE '&2                    $   #00010442' TO DFHEIV0
 10911     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10912     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10913     MOVE X'2020233030303130343432' TO DFHEIV0(25:11)
 10914     CALL 'kxdfhei1' USING DFHEIV0,
 10915           DFHEIV1,
 10916           DFHEIV11,
 10917           DFHEIV99
 10918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10919
 10920
 10921     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10922
 10923 1166-TRLR-EXIT.
 10924     EXIT.
 10925
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 209
* EL156.cbl
 10927 1170-PAID-THRU-FATAL-ERROR.
 10928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10929
 10930     MOVE -1                     TO EPYTHRUL.
 10931     MOVE AL-UNBON               TO EPYTHRUA.
 10932
 10933 1200-EDIT-FIND-TOLERANCES.
 10934
 10935* EXEC CICS HANDLE CONDITION
 10936*        ENDFILE(1950-NOT-FOUND)
 10937*        NOTFND (1950-NOT-FOUND)
 10938*    END-EXEC.
 10939*    MOVE '"$''I                  ! * #00010459' TO DFHEIV0
 10940     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10941     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10942     MOVE X'2A20233030303130343539' TO DFHEIV0(25:11)
 10943     CALL 'kxdfhei1' USING DFHEIV0
 10944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10945
 10946
 10947     IF PI-PROCESSOR-ID = 'LGXX'
 10948        GO TO 1240-FIND-ACCT-TOLERANCES.
 10949
 10950     MOVE 'N'                    TO FOUND-TOL-SW.
 10951     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10952     MOVE '2'                    TO CNTL-REC-TYPE.
 10953     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10954     MOVE +0                     TO CNTL-SEQ-NO.
 10955     MOVE 'PROC'                 TO FILE-SWITCH.
 10956
 10957     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10958
 10959     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10960     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10961                                    PI-MAX-PMT-TOL.
 10962     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10963
 10964     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10965         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10966
 10967     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 10968     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 10969                                    PI-MAX-LF-PMT-TOL.
 10970
 10971     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 10972         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 10973
 10974     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 10975                                    PI-MAX-EXP-PMT.
 10976
 10977 1240-FIND-ACCT-TOLERANCES.
 10978
 10979     IF WS-PMT-TOL NOT = +0
 10980         MOVE 'Y'                TO FOUND-TOL-SW.
 10981
 10982     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10983         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10984         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 210
* EL156.cbl
 10985         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 10986         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 10987         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 10988         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 10989     ELSE
 10990         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10991         MOVE PI-CARRIER             TO ACCT-CARRIER
 10992         MOVE PI-GROUPING            TO ACCT-GROUPING
 10993         MOVE PI-STATE               TO ACCT-STATE
 10994         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 10995         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10996
 10997     MOVE 'ACCT'                 TO FILE-SWITCH.
 10998
 10999     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11000     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11001
 11002
 11003* EXEC CICS HANDLE CONDITION
 11004*         NOTFND   (1950-NOT-FOUND)
 11005*         ENDFILE  (1950-NOT-FOUND)
 11006*    END-EXEC.
 11007*    MOVE '"$I''                  ! + #00010519' TO DFHEIV0
 11008     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11010     MOVE X'2B20233030303130353139' TO DFHEIV0(25:11)
 11011     CALL 'kxdfhei1' USING DFHEIV0
 11012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11013
 11014
 11015
 11016* EXEC CICS STARTBR
 11017*        DATASET('ERACCT')
 11018*        RIDFLD (ERACCT-KEY)
 11019*        GTEQ
 11020*    END-EXEC.
 11021     MOVE 'ERACCT' TO DFHEIV1
 11022     MOVE 0
 11023       TO DFHEIV11
 11024*    MOVE '&,         G          &   #00010524' TO DFHEIV0
 11025     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11027     MOVE X'2020233030303130353234' TO DFHEIV0(25:11)
 11028     CALL 'kxdfhei1' USING DFHEIV0,
 11029           DFHEIV1,
 11030           ERACCT-KEY,
 11031           DFHEIV99,
 11032           DFHEIV11,
 11033           DFHEIV99
 11034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11035
 11036
 11037 1245-FIND-ACCT-TOLERANCES-LOOP.
 11038
 11039
 11040* EXEC CICS READNEXT
 11041*        DATASET('ERACCT')
 11042*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 211
* EL156.cbl
 11043*        RIDFLD (ERACCT-KEY)
 11044*    END-EXEC.
 11045     MOVE 'ERACCT' TO DFHEIV1
 11046     MOVE 0
 11047       TO DFHEIV11
 11048*    MOVE '&.S                   )   #00010532' TO DFHEIV0
 11049     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11050     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11051     MOVE X'2020233030303130353332' TO DFHEIV0(25:11)
 11052     CALL 'kxdfhei1' USING DFHEIV0,
 11053           DFHEIV1,
 11054           DFHEIV20,
 11055           DFHEIV99,
 11056           ERACCT-KEY,
 11057           DFHEIV99,
 11058           DFHEIV11,
 11059           DFHEIV99,
 11060           DFHEIV99
 11061     SET ADDRESS OF ACCOUNT-MASTER TO
 11062         DFHEIV20
 11063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11064
 11065
 11066     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11067        IF WS-ERACCT-HOLD-RECORD = SPACES
 11068           GO TO 1950-NOT-FOUND
 11069        ELSE
 11070           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11071           GO TO 1250-CONTINUE.
 11072
 11073     IF ACCT-EXP-DT = HIGH-VALUES
 11074        NEXT SENTENCE
 11075     ELSE
 11076        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11077        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11078
 11079 1250-CONTINUE.
 11080
 11081     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11082
 11083     IF FOUND-TOL-SW = 'N'
 11084         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11085
 11086********* 1260-FIND-STATE-TOLERANCES.
 11087
 11088     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11089     MOVE PI-STATE               TO WS-ST-ACCESS.
 11090     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11091     MOVE '3'                    TO CNTL-REC-TYPE.
 11092     MOVE +0                     TO CNTL-SEQ-NO.
 11093     MOVE 'STAT'                 TO FILE-SWITCH.
 11094
 11095     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11096
 11097     IF WS-PMT-TOL = +0
 11098         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11099
 11100     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 212
* EL156.cbl
 11101     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11102     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11103     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11104     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11105
 11106****USE THIS ROUTINE TO CHECK PAYEE NAME EQUAL TO DECEASED
 11107     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 11108*        PI-VFY-2ND-BENE = 'Y' AND
 11109        PI-PAYEE-TYPE <> 'B'
 11110           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11111     END-IF.
 11112
 11113     IF PI-PMTTYPE      = '2'  AND
 11114        PI-SPLIT-PMT-SW = 'Y'  AND
 11115        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11116          MOVE ER-3530                TO EMI-ERROR
 11117          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11118
 11119********* 1280-FIND-BENEFIT-TOLERANCES.
 11120
 11121     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11122        OR (PI-PMTTYPE = '5' OR '6')
 11123         GO TO 1300-FIND-CARR-TOLERANCES.
 11124
 11125     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11126     MOVE '4'                    TO CNTL-REC-TYPE.
 11127     MOVE +0                     TO CNTL-SEQ-NO.
 11128     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11129     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11130     MOVE 'BENE'                 TO FILE-SWITCH.
 11131
 11132     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11133
 11134     IF NO-BENEFIT-FOUND
 11135         GO TO 1950-NOT-FOUND.
 11136
 11137     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11138     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11139     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11140
 11141
 11142* EXEC CICS HANDLE CONDITION
 11143*        NOTFND(1950-NOT-FOUND)
 11144*    END-EXEC.
 11145*    MOVE '"$I                   ! , #00010613' TO DFHEIV0
 11146     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11148     MOVE X'2C20233030303130363133' TO DFHEIV0(25:11)
 11149     CALL 'kxdfhei1' USING DFHEIV0
 11150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11151
 11152
 11153 1300-FIND-CARR-TOLERANCES.
 11154     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11155     MOVE '6'                    TO CNTL-REC-TYPE.
 11156
 11157     IF CONTROL-IS-ACTUAL-CARRIER
 11158         MOVE PI-CARRIER               TO WS-CARR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 213
* EL156.cbl
 11159     ELSE
 11160         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11161
 11162     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11163     MOVE +0                     TO CNTL-SEQ-NO.
 11164     MOVE 'CARR'                 TO FILE-SWITCH.
 11165
 11166     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11167
 11168     IF WS-DAYS-TOL = +0
 11169         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11170
 11171     IF WS-PMT-TOL = +0
 11172         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11173
 11174     IF WS-MAX-DAYS-TOL = +0
 11175         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11176
 11177     IF WS-MAX-PMT-TOL = +0
 11178         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11179                                    PI-MAX-PMT-TOL.
 11180
 11181     IF WS-MAX-LF-PMT-TOL = +0
 11182        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11183                                    PI-MAX-LF-PMT-TOL.
 11184
 11185     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11186
 11187********* 1320-FIND-COMP-TOLERANCES.
 11188
 11189     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11190     MOVE '1'                    TO CNTL-REC-TYPE.
 11191     MOVE SPACES                 TO CNTL-ACCESS.
 11192     MOVE +0                     TO CNTL-SEQ-NO.
 11193     MOVE 'COMP'                 TO FILE-SWITCH.
 11194
 11195     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11196
 11197     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11198     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11199
 11200     IF WS-PMT-TOL NOT = +0
 11201        IF WS-TOL-SEVERITY NOT = ' '
 11202         GO TO 1360-EDIT-DAYS.
 11203
 11204     IF WS-PMT-TOL = +0
 11205         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11206
 11207     IF WS-TOL-SEVERITY = ' '
 11208         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11209
 11210 1360-EDIT-DAYS.
 11211     IF PI-PMTTYPE NOT = '4'
 11212        IF PI-EDAYS NEGATIVE OR
 11213           PI-EPYAMT NEGATIVE
 11214          MOVE ER-0513             TO EMI-ERROR
 11215          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11216          MOVE -1                  TO PMTTYPEL.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 214
* EL156.cbl
 11217
 11218     IF PI-PMTTYPE = '5' OR '6'
 11219        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11220
 11221     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11222        IF PI-PMTTYPE = '4'
 11223          MOVE PI-EDAYS          TO PI-CDAYS.
 11224
 11225     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11226         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11227
 11228     IF PI-PMTTYPE = '4'
 11229        MOVE PI-EDAYS            TO PI-CDAYS
 11230        GO TO 1400-EDIT-PAYMENT.
 11231
 11232     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11233        GO TO 1500-EDIT-EXPENSES.
 11234
 11235*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11236*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11237*          CM-AH-BENEFIT-CD = '23'              AND
 11238*          CL-CERT-STATE    = '04'              AND
 11239*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11240*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11241*            GO TO 1362-CHECK-MAX-DAYS.
 11242
 11243     IF PI-EDAYS = ZEROS
 11244*        IF PI-COMPANY-ID = 'DMD'
 11245*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11246*            MOVE -1             TO DC-ELAPSED-DAYS
 11247*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11248*            MOVE '6'            TO DC-OPTION-CODE
 11249*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11250*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11251*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11252*            MOVE '1'            TO DC-OPTION-CODE
 11253*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11254*            IF NO-CONVERSION-ERROR
 11255*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11256*                                 + DC-ODD-DAYS-OVER
 11257*               MOVE 6           TO EDAYSL
 11258*               MOVE AL-UNNON    TO EDAYSA
 11259*            ELSE
 11260*                NEXT SENTENCE
 11261*       ELSE
 11262            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11263            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11264            MOVE '1'             TO DC-OPTION-CODE
 11265            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11266            IF NO-CONVERSION-ERROR
 11267                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11268                ADD 1                 TO PI-EDAYS
 11269                MOVE AL-UNNON         TO EDAYSA.
 11270
 11271*    IF PI-COMPANY-ID = 'DMD'
 11272*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11273*        MOVE -1                 TO DC-ELAPSED-DAYS
 11274*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 215
* EL156.cbl
 11275*        MOVE '6'                TO DC-OPTION-CODE
 11276*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11277*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11278*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11279*        MOVE '1'                TO DC-OPTION-CODE
 11280*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11281*    ELSE
 11282         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11283         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11284         MOVE '1'                TO DC-OPTION-CODE.
 11285         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11286
 11287     IF NO-CONVERSION-ERROR
 11288        IF PI-COMPANY-ID = 'DMD'
 11289            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11290                             + DC-ODD-DAYS-OVER
 11291        ELSE
 11292            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11293            ADD 1                TO PI-CDAYS.
 11294
 11295     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11296        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11297        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11298
 11299     IF PI-EDAYS NOT NUMERIC
 11300         MOVE ER-0491            TO EMI-ERROR
 11301         GO TO 1370-DAYS-ERROR.
 11302
 11303     IF CL-NO-OF-PMTS-MADE = 0
 11304        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11305        AND CL-CERT-STATE = 'MI'
 11306        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11307            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11308     END-IF.
 11309
 11310 1362-CHECK-MAX-DAYS.
 11311
 11312     IF WS-MAX-DAYS-TOL = +999
 11313         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11314
 11315     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11316         IF PI-EDAYS = ZEROS
 11317             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11318         ELSE
 11319             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11320
 11321     IF WS-MAX-DAYS-TOL NOT = ZERO
 11322        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11323           PI-CDAYS > WS-MAX-DAYS-TOL
 11324             MOVE ER-0492          TO EMI-ERROR
 11325             GO TO 1370-DAYS-ERROR.
 11326
 11327 1365-SKIP-MAX-DAYS-EDIT.
 11328     IF PI-EDAYS = ZEROS
 11329        GO TO 1400-EDIT-PAYMENT.
 11330
 11331     IF WS-DAYS-TOL NOT = ZERO
 11332        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 216
* EL156.cbl
 11333           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
 11334                MOVE ER-0493     TO EMI-ERROR
 11335                GO TO 1370-DAYS-ERROR.
 11336
 11337     GO TO 1400-EDIT-PAYMENT.
 11338
 11339 1370-DAYS-ERROR.
 11340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11341
 11342     IF EMI-MESSAGE-FORMATTED
 11343         MOVE -1                 TO EDAYSL
 11344         MOVE AL-UABON           TO EDAYSA.
 11345
 11346     GO TO 1400-EDIT-PAYMENT.
 11347
 11348 1380-EDIT-EXPENSE-PMT-AMT.
 11349     IF PI-PMTTYPE = '5' OR '6'
 11350         NEXT SENTENCE
 11351     ELSE
 11352         GO TO 1400-EDIT-PAYMENT.
 11353
 11354     IF WS-MAX-EXP-PMT NOT = ZEROS
 11355        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11356            MOVE ER-3529            TO EMI-ERROR
 11357            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11358
 11359     GO TO 1500-EDIT-EXPENSES.
 11360
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 217
* EL156.cbl
 11362
 11363 1390-CHECK-PAYMENT-DAYS.
 11364
 11365     IF PI-EDAYS = 0
 11366         MOVE PI-CDAYS TO WS-PD-DAYS
 11367     ELSE
 11368         MOVE PI-EDAYS TO WS-PD-DAYS
 11369     END-IF.
 11370
 11371     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11372         IF WS-PD-DAYS = 14
 11373            GO TO 1390-EXIT
 11374         END-IF
 11375     END-IF.
 11376
 11377     IF PI-COMPANY-ID = 'AHL'  AND
 11378        CM-AH-BENEFIT-CD = '1K'
 11379         IF WS-PD-DAYS = 14
 11380            GO TO 1390-EXIT
 11381         END-IF
 11382     END-IF.
 11383
 11384     IF WS-PD-DAYS < 30
 11385         MOVE ER-3549              TO EMI-ERROR
 11386         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11387     END-IF.
 11388
 11389 1390-EXIT.
 11390      EXIT.
 11391
 11392 1400-EDIT-PAYMENT.
 11393*    IF PI-COMPANY-ID = 'DMD'
 11394*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11395*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11396
 11397     IF PI-COMPANY-ID = 'DCC'
 11398        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11399        MOVE PI-CARRIER          TO ACCT-CARRIER
 11400        MOVE PI-GROUPING         TO ACCT-GROUPING
 11401        MOVE PI-STATE            TO ACCT-STATE
 11402        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11403        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11404        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11405        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11406
 11407
 11408* EXEC CICS READ
 11409*          DATASET ('ERACCT')
 11410*          RIDFLD  (ERACCT-KEY)
 11411*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11412*          GTEQ
 11413*          resp    (WS-RESPONSE)
 11414*       END-EXEC
 11415     MOVE 'ERACCT' TO DFHEIV1
 11416*    MOVE '&"S        G          (  N#00010871' TO DFHEIV0
 11417     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11419     MOVE X'204E233030303130383731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 218
* EL156.cbl
 11420     CALL 'kxdfhei1' USING DFHEIV0,
 11421           DFHEIV1,
 11422           DFHEIV20,
 11423           DFHEIV99,
 11424           ERACCT-KEY,
 11425           DFHEIV99,
 11426           DFHEIV99,
 11427           DFHEIV99
 11428     SET ADDRESS OF ACCOUNT-MASTER TO
 11429         DFHEIV20
 11430     MOVE EIBRESP  TO WS-RESPONSE
 11431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11432        IF WS-RESP-NORMAL
 11433           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11434           and pi-cert-eff-dt < am-expiration-dt
 11435           and pi-cert-eff-dt >= am-effective-dt
 11436           move am-dcc-product-code to pi-dcc-product-code
 11437        else
 11438           move spaces           to pi-dcc-product-code
 11439        end-if
 11440        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11441           MOVE ' '              TO WS-PDEF-RECORD-SW
 11442           PERFORM 0900-GET-DDF-FACTORS
 11443                                 THRU 0900-EXIT
 11444           IF PDEF-FOUND
 11445              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11446                 (P1 > +8)
 11447                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11448              END-PERFORM
 11449              IF P1 < +9
 11450                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11451                    MOVE PD-MAX-AMT (P1)
 11452                                 TO CM-AH-BENEFIT-AMT
 11453                 end-if
 11454              END-IF
 11455           END-IF
 11456        end-if
 11457     END-IF
 11458     IF PI-PMTTYPE NOT = '4'
 11459        GO TO 1405-CALC-PAYMENT.
 11460
 11461     IF PI-EDAYS NOT NUMERIC
 11462         MOVE PI-EPYAMT           TO PI-CPYAMT
 11463         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11464         GO TO 1430-CHECK-AH-TOLERANCE.
 11465
 11466*    IF PI-COMPANY-ID = 'FIA'
 11467*       IF CERT-ACCOUNT = '0000011043'
 11468*        COMPUTE PI-DAILY-RATE ROUNDED =
 11469*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11470*        COMPUTE PI-CPYAMT ROUNDED =
 11471*                          PI-DAILY-RATE * PI-EDAYS
 11472*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11473*        GO TO 1430-CHECK-AH-TOLERANCE.
 11474
 11475     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11476         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11477         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 219
* EL156.cbl
 11478         GO TO 1420-CHECK-AIG-BENEFIT.
 11479
 11480     IF WS-CALC-METHOD = '2' OR  '5'
 11481         COMPUTE PI-DAILY-RATE ROUNDED =
 11482                        (CM-AH-BENEFIT-AMT * 12) / 365
 11483         COMPUTE PI-CPYAMT ROUNDED =
 11484                           PI-DAILY-RATE * PI-EDAYS
 11485        GO TO 1420-CHECK-AIG-BENEFIT.
 11486
 11487     IF WS-CALC-METHOD = '3'
 11488         COMPUTE PI-DAILY-RATE =
 11489                         (CM-AH-BENEFIT-AMT * 12) / 365
 11490         COMPUTE PI-CPYAMT ROUNDED =
 11491                           PI-DAILY-RATE * PI-EDAYS
 11492        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 220
* EL156.cbl
 11494*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11495
 11496****************************************************************
 11497****************************************************************
 11498*                  CALCULATED FROM      PAYMENT      PAYMENT
 11499*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11500* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11501*1-01-83  1-15-83    0    15     15        15           15
 11502*1-01-83  1-30-83    0    30     30        30           30
 11503*1-01-83  1-31-83    1     0     31        30           30
 11504*1-01-83  2-01-83    1     1     32        31           31
 11505*1-01-83  2-15-83    1    15     46        45           45
 11506*1-01-83  2-28-83    2     0     59        60           60
 11507*1-01-83  3-01-83    2     1     60        61           61
 11508*1-01-83  3-31-83    3     0     90        90           90
 11509*1-15-83  1-31-83    0    17     17        17           16
 11510*1-15-83  2-01-83    0    18     18        18           17
 11511*1-15-83  2-28-83    1    14     45        44           46
 11512*1-21-83  3-09-83    1    20     48        50           49
 11513*2-05-83  3-06-83    1     2     30        32           32
 11514*2-05-83  3-23-83    1    19     47        49           49
 11515*2-15-83  2-28-83    0    14     14        14           16
 11516*2-15-83  3-01-83    0    15     15        15           17
 11517*2-21-83  3-19-83    0    27     27        27           29
 11518*2-21-83  3-20-83    1     0     28        30           30
 11519*2-21-83  4-10-83    1    18     49        30           50
 11520*2-21-83  5-19-83    2    27     88        87           89
 11521*2-21-83  5-22-83    3     2     91        92           92
 11522*3-21-83  5-19-83    1    30     60        60           59
 11523****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 221
* EL156.cbl
 11525 1405-CALC-PAYMENT.
 11526     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11527     MOVE ' '                    TO DC-OPTION-CODE.
 11528     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11529     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11530     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11531
 11532     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11533     MOVE ' '                    TO DC-OPTION-CODE.
 11534     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11535     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11536     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11537
 11538     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11539     MOVE -1                     TO DC-ELAPSED-DAYS.
 11540     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11541     MOVE '6'                    TO DC-OPTION-CODE.
 11542     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11543     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11544
 11545     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11546     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11547     MOVE '1'                    TO DC-OPTION-CODE.
 11548     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11549
 11550     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11551     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11552     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11553
 11554******************************************************************
 11555*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11556*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11557*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11558******************************************************************
 11559
 11560     IF WS-CALC-METHOD = '1'           AND
 11561        DC-ELAPSED-MONTHS > ZERO AND
 11562        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11563        WDF-DAY > WDT-DAY
 11564          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11565          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11566          MOVE -1                  TO DC-ELAPSED-MONTHS
 11567          MOVE '6'                 TO DC-OPTION-CODE
 11568          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11569          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11570          COMPUTE WS-SAVE-ODD-DAYS =
 11571          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11572          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11573
 11574     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11575     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11576     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11577
 11578     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11579     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11580
 11581*    IF PI-COMPANY-ID = 'FIA'
 11582*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 222
* EL156.cbl
 11583*        COMPUTE PI-DAILY-RATE ROUNDED =
 11584*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11585*        COMPUTE PI-CPYAMT ROUNDED =
 11586*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11587*        GO TO 1420-CHECK-AIG-BENEFIT.
 11588
 11589*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11590*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11591*          CM-AH-BENEFIT-CD = '23'               AND
 11592*          CL-CERT-STATE    = '04'               AND
 11593*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11594*            COMPUTE WS-DAILY-RATE ROUNDED =
 11595*                               CM-AH-BENEFIT-AMT / 30
 11596*            COMPUTE PI-CPYAMT ROUNDED =
 11597*                               (WS-DAILY-RATE * PI-CDAYS)
 11598*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11599*            GO TO 1420-CHECK-AIG-BENEFIT.
 11600
 11601     IF WS-CALC-METHOD = '1'
 11602         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11603         COMPUTE PI-CPYAMT ROUNDED =
 11604             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11605             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11606         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11607         GO TO 1420-CHECK-AIG-BENEFIT.
 11608
 11609     IF WS-CALC-METHOD = '2'
 11610         COMPUTE PI-DAILY-RATE ROUNDED =
 11611                          (CM-AH-BENEFIT-AMT * 12) / 365
 11612         COMPUTE PI-CPYAMT ROUNDED =
 11613             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11614             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11615         GO TO 1420-CHECK-AIG-BENEFIT.
 11616
 11617     IF WS-CALC-METHOD = '4'
 11618         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11619         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11620         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11621         COMPUTE PI-CPYAMT ROUNDED =
 11622                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11623         GO TO 1420-CHECK-AIG-BENEFIT.
 11624
 11625     IF WS-CALC-METHOD = '5'
 11626         COMPUTE PI-DAILY-RATE ROUNDED =
 11627                            (CM-AH-BENEFIT-AMT * 12) / 365
 11628         COMPUTE PI-CPYAMT ROUNDED =
 11629                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11630         GO TO 1420-CHECK-AIG-BENEFIT.
 11631
 11632     IF WS-CALC-METHOD NOT = '3'
 11633        GO TO 1410-CHECK-PAYMENT.
 11634
 11635******   CALCULATION METHOD  3  ROUTINE
 11636     COMPUTE PI-DAILY-RATE =
 11637                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11638
 11639******CHECK TO SEE IF WITHIN SAME MONTH
 11640     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 223
* EL156.cbl
 11641        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11642                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11643         GO TO 1420-CHECK-AIG-BENEFIT.
 11644
 11645******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11646     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11647             SAVE-ODD-DAYS-OVER = ZEROS
 11648      COMPUTE PI-CPYAMT  ROUNDED =
 11649                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11650      GO TO 1420-CHECK-AIG-BENEFIT.
 11651
 11652******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11653******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11654     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11655        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11656        IF WDF-MONTH > 12
 11657           ADD 1                 TO WDF-YEAR
 11658           SUBTRACT 12         FROM WDF-MONTH.
 11659
 11660******CONVERT THE NEW FROM MONTH TO BINARY
 11661     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11662        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11663        MOVE '4'              TO DC-OPTION-CODE
 11664        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11665        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11666
 11667     IF WDF-MONTH = WDT-MONTH AND
 11668        WDF-YEAR  = WDT-YEAR
 11669          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11670                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11671                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11672        ELSE
 11673          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11674          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11675          COMPUTE PI-CPYAMT ROUNDED =
 11676       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11677       +
 11678       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11679       +
 11680       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11681
 11682     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 224
* EL156.cbl
 11684 1410-CHECK-PAYMENT.
 11685******PAYMENT OPTION 6
 11686******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11687     IF SAVE-ELAPSED-MONTHS > ZERO
 11688        IF SAVE-ODD-DAYS-OVER = ZEROS
 11689           GO TO 1412-CHECK-TO-DAY
 11690        ELSE
 11691           IF WDF-DAY > WDT-DAY
 11692              IF WDF-MONTH = 02
 11693                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11694                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11695                  GO TO 1412-CHECK-TO-DAY
 11696              ELSE
 11697                  IF FROM-DAYS-IN-MONTH = 31
 11698                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11699                     GO TO 1412-CHECK-TO-DAY
 11700                  ELSE
 11701                     GO TO 1412-CHECK-TO-DAY
 11702           ELSE
 11703               GO TO 1412-CHECK-TO-DAY.
 11704
 11705     IF WDF-MONTH NOT = WDT-MONTH
 11706        IF WDF-MONTH = 02
 11707           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11708           IF WDF-DAY = 29
 11709              ADD 1              TO SAVE-ODD-DAYS-OVER
 11710           ELSE
 11711              ADD 2              TO SAVE-ODD-DAYS-OVER
 11712        ELSE
 11713           IF FROM-DAYS-IN-MONTH = 31
 11714              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11715
 11716 1412-CHECK-TO-DAY.
 11717        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11718           IF WDT-DAY = 28
 11719              ADD 2              TO SAVE-ODD-DAYS-OVER
 11720           ELSE
 11721              IF WDT-DAY = 29
 11722                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11723              ELSE
 11724                 NEXT SENTENCE
 11725        ELSE
 11726           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11727              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11728
 11729     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11730     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11731     COMPUTE PI-CPYAMT ROUNDED =
 11732         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11733         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11734
 11735     GO TO 1420-CHECK-AIG-BENEFIT.
 11736
 11737 1415-CHECK-LEAP-YEAR.
 11738     IF FROM-DAYS-IN-MONTH = 29
 11739        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11740
 11741 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 225
* EL156.cbl
 11742     EXIT.
 11743
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 226
* EL156.cbl
 11745 1420-CHECK-AIG-BENEFIT.
 11746
 11747     IF WS-SPECIAL-CALC-CD = 'Q'
 11748         GO TO 1425-CHECK-WHOLE-MONTH.
 11749
 11750*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11751*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11752*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11753*       (PI-PMTTYPE = '1' OR '2')
 11754*        NEXT SENTENCE
 11755*    ELSE
 11756         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11757         GO TO 1430-CHECK-AH-TOLERANCE.
 11758
 11759******************AIG LOGIC STARTS**********************
 11760*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11761*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11762*    MOVE ER-3533      TO EMI-ERROR.
 11763*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11764*    GO TO 1430-CHECK-AH-TOLERANCE.
 11765******************AIG LOGIC ENDS************************
 11766
 11767 1425-CHECK-WHOLE-MONTH.
 11768******************************************************************
 11769****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11770****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11771****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11772****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11773****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11774****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11775****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11776****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11777****          PAID * MONTHLY BENEFIT.                         ****
 11778******************************************************************
 11779
 11780     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11781
 11782     IF CL-NO-OF-PMTS-MADE > +0
 11783         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11784
 11785     IF PI-CDAYS < WS-BEN-DAYS
 11786         GO TO 1430-CHECK-AH-TOLERANCE.
 11787
 11788     IF PI-CDAYS = WS-BEN-DAYS
 11789         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11790         GO TO 1430-CHECK-AH-TOLERANCE.
 11791
 11792*    IF PI-COMPANY-ID = 'ACM'
 11793*       NEXT SENTENCE
 11794*    ELSE
 11795        GO TO 1425-NOT-ACM-W15C.
 11796
 11797*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11798*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11799*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11800*    MOVE '6'                    TO  DC-OPTION-CODE.
 11801*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11802*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 227
* EL156.cbl
 11803*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11804*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11805*       MOVE '1'                 TO  DC-OPTION-CODE
 11806*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11807*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11808*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11809*       IF NO-CONVERSION-ERROR
 11810*          IF (DC-ELAPSED-MONTHS > +0) OR
 11811*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11812*             NEXT SENTENCE
 11813*          ELSE
 11814*             MOVE +0            TO  PI-CPYAMT
 11815*             MOVE ER-0846       TO  EMI-ERROR
 11816*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11817*             GO TO 1430-CHECK-AH-TOLERANCE
 11818*       ELSE
 11819*           MOVE ER-0846         TO  EMI-ERROR
 11820*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11821*           GO TO 1430-CHECK-AH-TOLERANCE.
 11822*
 11823*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11824*       ADD +1 TO DC-ELAPSED-MONTHS.
 11825*
 11826*    COMPUTE PI-CPYAMT ROUNDED =
 11827*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11828*
 11829*    GO TO 1430-CHECK-AH-TOLERANCE.
 11830
 11831 1425-NOT-ACM-W15C.
 11832
 11833     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11834     MOVE '6'                        TO  DC-OPTION-CODE.
 11835     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11836     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11837
 11838     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11839     IF NO-CONVERSION-ERROR
 11840         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11841     ELSE
 11842         MOVE ER-0846                TO  EMI-ERROR
 11843         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11844         GO TO 1430-CHECK-AH-TOLERANCE.
 11845
 11846     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11847     MOVE '1'                        TO  DC-OPTION-CODE.
 11848     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11849     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11850     IF NO-CONVERSION-ERROR
 11851         IF DC-ODD-DAYS-OVER = +0
 11852             NEXT SENTENCE
 11853         ELSE
 11854             MOVE ER-0846            TO  EMI-ERROR
 11855             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11856             GO TO 1430-CHECK-AH-TOLERANCE
 11857     ELSE
 11858         MOVE ER-0846                TO  EMI-ERROR
 11859         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11860         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 228
* EL156.cbl
 11861
 11862     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11863         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11864
 11865     GO TO 1430-CHECK-AH-TOLERANCE.
 11866
 11867 1425-CONT-WHOLE-MONTH-PMTS.
 11868******************************************************************
 11869****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11870****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11871****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11872******************************************************************
 11873
 11874     IF PI-COMPANY-ID = 'ACM'
 11875        NEXT SENTENCE
 11876     ELSE
 11877        IF DC-ODD-DAYS-OVER = +0
 11878            NEXT SENTENCE
 11879        ELSE
 11880            MOVE ER-0845            TO  EMI-ERROR
 11881            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11882            GO TO 1430-CHECK-AH-TOLERANCE.
 11883
 11884     COMPUTE PI-CPYAMT ROUNDED =
 11885                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11886
 11887 1430-CHECK-AH-TOLERANCE.
 11888     IF PI-PMT-APPR-SW = 'G'
 11889         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11890
 11891*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11892*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11893*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11894*
 11895*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11896*      IF WDF-MONTH = 02
 11897*        IF SAVE-ELAPSED-MONTHS = 0
 11898*          NEXT SENTENCE
 11899*        ELSE
 11900*          IF SAVE-ODD-DAYS-OVER > 0
 11901*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11902*            COMPUTE WS-PMT-MOS ROUNDED =
 11903*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11904*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11905*                                     WS-PMT-MOS
 11906*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11907*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11908*          ELSE
 11909*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11910*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11911*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11912*                                     WS-PMT-MOS.
 11913
 11914     IF WS-MAX-PMT-TOL NOT = ZERO
 11915        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11916           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11917            MOVE ER-0494         TO  EMI-ERROR
 11918            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 229
* EL156.cbl
 11919            GO TO 1500-EDIT-EXPENSES.
 11920
 11921 1430-CONT-CHECK-AH-TOLERANCE.
 11922
 11923     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11924        GO TO 1500-EDIT-EXPENSES.
 11925
 11926     IF CM-O-B-COVERAGE
 11927        GO TO 1500-EDIT-EXPENSES.
 11928
 11929     IF PI-COMPANY-ID = 'NCL'
 11930       IF FOUND-TOL-SW = 'Y'
 11931         IF WS-PMT-TOL NOT = ZERO
 11932           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11933              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11934                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11935                  IF WS-NCL-PMT-OPTION = SPACES
 11936                      MOVE ER-0699 TO EMI-ERROR
 11937                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11938                  ELSE
 11939                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11940                      NEXT SENTENCE
 11941                  ELSE
 11942                  IF NOT WS-VALID-NCL-OPTION
 11943                      MOVE ER-0699 TO EMI-ERROR
 11944                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11945
 11946     if pi-company-id = 'DCC'
 11947        and pdef-found
 11948        and pi-cpyamt < pi-epyamt
 11949           move er-1657          to emi-error
 11950           perform 1490-payment-error
 11951                                 thru 1490-exit
 11952     else
 11953        IF WS-PMT-TOL NOT = ZERO
 11954           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 11955              or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11956              MOVE ER-0495       TO EMI-ERROR
 11957              PERFORM 1490-PAYMENT-ERROR
 11958                                 THRU 1490-EXIT
 11959           end-if
 11960        end-if
 11961     end-if
 11962
 11963     GO TO 1500-EDIT-EXPENSES.
 11964
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 230
* EL156.cbl
 11966 1440-COMPUTE-LIFE-REMAINING.
 11967
 11968     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11969        IF PI-PMTTYPE = '4'
 11970          MOVE PI-EPYAMT TO PI-CPYAMT
 11971          GO TO 1460-TEST-TYPE.
 11972
 11973     IF WS-LF-COVERAGE-TYPE = 'L'
 11974        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 11975                          - CL-TOTAL-PAID-AMT
 11976        GO TO 1450-CHECK-MAX.
 11977
 11978     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11979        PI-LF-COVERAGE-TYPE = 'P'
 11980          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 11981                              CM-LF-ITD-DEATH-AMT
 11982          GO TO 1450-CHECK-MAX.
 11983
 11984     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 11985     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 11986     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 11987     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11988     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11989     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 11990     MOVE '4'                    TO CP-REM-TERM-METHOD.
 11991     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11992     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11993
 11994     PERFORM 9800-LINK-REM-TERM.
 11995
 11996     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 11997     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11998     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11999     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12000     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12001     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12002     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12003     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12004     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12005     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12006     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12007     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12008     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12009     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12010     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12011     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12012     IF PI-COMPANY-ID = 'DCC'
 12013        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12014        MOVE PI-CARRIER          TO ACCT-CARRIER
 12015        MOVE PI-GROUPING         TO ACCT-GROUPING
 12016        MOVE PI-STATE            TO ACCT-STATE
 12017        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12018        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12019        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12020        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12021
 12022
 12023* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 231
* EL156.cbl
 12024*          DATASET ('ERACCT')
 12025*          RIDFLD  (ERACCT-KEY)
 12026*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12027*          GTEQ
 12028*          resp    (WS-RESPONSE)
 12029*       END-EXEC
 12030     MOVE 'ERACCT' TO DFHEIV1
 12031*    MOVE '&"S        G          (  N#00011468' TO DFHEIV0
 12032     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12034     MOVE X'204E233030303131343638' TO DFHEIV0(25:11)
 12035     CALL 'kxdfhei1' USING DFHEIV0,
 12036           DFHEIV1,
 12037           DFHEIV20,
 12038           DFHEIV99,
 12039           ERACCT-KEY,
 12040           DFHEIV99,
 12041           DFHEIV99,
 12042           DFHEIV99
 12043     SET ADDRESS OF ACCOUNT-MASTER TO
 12044         DFHEIV20
 12045     MOVE EIBRESP  TO WS-RESPONSE
 12046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12047        IF WS-RESP-NORMAL
 12048           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12049           and (pi-cert-eff-dt < am-expiration-dt)
 12050           and (pi-cert-eff-dt >= am-effective-dt)
 12051           move am-dcc-product-code to pi-dcc-product-code
 12052        else
 12053           move spaces           to pi-dcc-product-code
 12054        end-if
 12055        if pi-dcc-product-code not = spaces
 12056           MOVE ' '              TO WS-PDEF-RECORD-SW
 12057           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12058           PERFORM 0900-GET-DDF-FACTORS
 12059                                 THRU 0900-EXIT
 12060           IF PDEF-FOUND
 12061              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12062                 (P1 > +8)
 12063                 OR (PD-PROD-CODE (P1) = 'L')
 12064              END-PERFORM
 12065              IF P1 < +9
 12066                 MOVE PD-MAX-AMT (P1)
 12067                                 TO CP-R-MAX-TOT-BEN
 12068              END-IF
 12069           END-IF
 12070        end-if
 12071     END-IF
 12072
 12073* EXEC CICS LINK
 12074*       PROGRAM  (LINK-REMAMT)
 12075*       COMMAREA (CALCULATION-PASS-AREA)
 12076*       LENGTH   (CP-COMM-LENGTH)
 12077*    END-EXEC.
 12078*    MOVE '."C                   (   #00011500' TO DFHEIV0
 12079     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12081     MOVE X'2020233030303131353030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 232
* EL156.cbl
 12082     CALL 'kxdfhei1' USING DFHEIV0,
 12083           LINK-REMAMT,
 12084           CALCULATION-PASS-AREA,
 12085           CP-COMM-LENGTH,
 12086           DFHEIV99,
 12087           DFHEIV99,
 12088           DFHEIV99,
 12089           DFHEIV99
 12090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12091
 12092
 12093     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12094
 12095     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12096     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12097
 12098     IF PI-COMPANY-ID = 'BOA' AND
 12099        PI-PMTTYPE    = '2'   AND
 12100        PI-OFFLINE    = 'N'
 12101           GO TO 1441-COMPUTE-BOA-INTEREST.
 12102
 12103     IF PI-COMPANY-ID = 'NCL' AND
 12104        PI-PMTTYPE    = '2'   AND
 12105        PI-OFFLINE    = 'N'
 12106          GO TO 1442-COMPUTE-NCL-INTEREST
 12107       ELSE
 12108          GO TO 1445-CONTINUE.
 12109
 12110 1441-COMPUTE-BOA-INTEREST.
 12111     MOVE +0             TO WS-CALC-INT.
 12112
 12113     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12114     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12115     MOVE +0             TO DC-ELAPSED-MONTHS
 12116                            DC-ELAPSED-DAYS.
 12117     MOVE '1'            TO DC-OPTION-CODE.
 12118     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12119     IF NO-CONVERSION-ERROR
 12120         NEXT SENTENCE
 12121     ELSE
 12122         GO TO 1445-CONTINUE.
 12123
 12124     IF (PI-INT-RATE NOT > ZEROS)  AND
 12125        (DC-ELAPSED-DAYS > +30)
 12126         MOVE ER-3531            TO EMI-ERROR
 12127         MOVE -1                 TO PINTL
 12128         MOVE AL-UNBON           TO PINTA
 12129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12130
 12131     IF PI-EPYAMT NOT > ZEROS
 12132         GO TO 1445-CONTINUE.
 12133
 12134     IF (PI-INT-RATE NOT > ZEROS)  OR
 12135        (DC-ELAPSED-DAYS NOT > +30)
 12136         MOVE PI-EPYAMT TO PI-CPYAMT
 12137         GO TO 1441-FORMAT-NOTE.
 12138
 12139     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 233
* EL156.cbl
 12140                                 *  PI-INT-RATE
 12141                                 *  DC-ELAPSED-DAYS
 12142                                 /  365
 12143                                 /  100.
 12144
 12145     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12146
 12147 1441-FORMAT-NOTE.
 12148
 12149     MOVE SPACES        TO WS-BOANOTE1.
 12150     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12151     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12152     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12153     MOVE AL-UANON      TO NOTE1A.
 12154
 12155     IF WS-CALC-INT > ZEROS
 12156         MOVE SPACES        TO WS-BOANOTE2
 12157         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12158         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12159         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12160         MOVE AL-UANON      TO NOTE2A.
 12161
 12162     GO TO 1445-CONTINUE.
 12163
 12164 1442-COMPUTE-NCL-INTEREST.
 12165     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12166     MOVE PI-STATE               TO WS-ST-ACCESS.
 12167     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12168     MOVE '3'                    TO CNTL-REC-TYPE.
 12169     MOVE +0                     TO CNTL-SEQ-NO.
 12170     MOVE 'STAT'                 TO FILE-SWITCH.
 12171
 12172     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12173
 12174     MOVE +0                 TO WS-CALC-INT.
 12175
 12176     IF ST-STAT-FROM-INCURRED
 12177         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12178       ELSE
 12179     IF ST-STAT-FROM-REPORTED
 12180         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12181       ELSE
 12182         GO TO 1445-CONTINUE.
 12183
 12184     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12185     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12186     MOVE +0                 TO DC-ELAPSED-MONTHS
 12187                                DC-ELAPSED-DAYS.
 12188     MOVE '1'                TO DC-OPTION-CODE.
 12189     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12190     IF NO-CONVERSION-ERROR
 12191         NEXT SENTENCE
 12192     ELSE
 12193         GO TO 1445-CONTINUE.
 12194
 12195     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12196        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12197         GO TO 1445-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 234
* EL156.cbl
 12198
 12199     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12200                                 *  CF-ST-STAT-INTEREST.
 12201
 12202     MOVE SPACES              TO WS-NCLNOTE1.
 12203     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12204     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12205     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12206                                 PI-PMTNOTE1
 12207                                 NOTE1I.
 12208     MOVE AL-UANON            TO NOTE1A.
 12209
 12210     IF WS-CALC-INT > ZEROS
 12211         MOVE SPACES          TO WS-NCLNOTE2
 12212         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12213         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12214         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12215                                 PI-PMTNOTE2
 12216                                 NOTE2I
 12217         MOVE AL-UANON        TO NOTE2A.
 12218
 12219     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12220
 12221 1445-CONTINUE.
 12222
 12223     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12224        GO TO 1460-TEST-TYPE.
 12225
 12226     IF CM-O-B-COVERAGE
 12227        GO TO 1460-TEST-TYPE.
 12228
 12229     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12230         GO TO 1450-CHECK-MAX.
 12231
 12232     if pi-company-id = 'DCC'
 12233        and pdef-found
 12234        and pi-epyamt > pd-max-amt (p1)
 12235        move er-1657             to emi-error
 12236        perform 1490-payment-error
 12237                                 thru 1490-exit
 12238        go to 1460-test-type
 12239     else
 12240        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12241           > PI-EPYAMT)
 12242                         OR
 12243           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12244           < PI-EPYAMT)
 12245           MOVE ER-0594          TO EMI-ERROR
 12246           PERFORM 1490-PAYMENT-ERROR
 12247                                 THRU 1490-EXIT
 12248           GO TO 1460-TEST-TYPE
 12249        end-if
 12250     end-if
 12251     .
 12252 1450-CHECK-MAX.
 12253
 12254     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12255        PI-LF-COVERAGE-TYPE = 'P'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 235
* EL156.cbl
 12256         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12257                                   CM-LF-ITD-DEATH-AMT
 12258     ELSE
 12259         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12260                                   CL-TOTAL-PAID-AMT.
 12261
 12262     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12263          MOVE ER-0543           TO EMI-ERROR
 12264          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12265
 12266 1460-TEST-TYPE.
 12267
 12268     IF PI-PMT-APPR-SW = 'G'
 12269       NEXT SENTENCE
 12270     ELSE
 12271       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12272         IF PI-EPYAMT = ZERO
 12273             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12274                 MOVE ER-0494    TO  EMI-ERROR
 12275                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12276                 GO TO 1500-EDIT-EXPENSES
 12277             ELSE
 12278                 NEXT SENTENCE
 12279         ELSE
 12280             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12281                 MOVE ER-0494    TO  EMI-ERROR
 12282                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12283                 GO TO 1500-EDIT-EXPENSES.
 12284
 12285     IF PI-PMTTYPE NOT = '2' OR
 12286        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12287         GO TO 1500-EDIT-EXPENSES.
 12288
 12289     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12290     MOVE ER-0526                TO EMI-ERROR.
 12291     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12292
 12293     IF EMI-ERROR-NUMBER (1) = '0526'
 12294        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12295
 12296     IF EMI-ERROR-NUMBER (2) = '0526'
 12297        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12298
 12299     GO TO 1500-EDIT-EXPENSES.
 12300
 12301 1490-PAYMENT-ERROR.
 12302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12303
 12304     IF EMI-MESSAGE-FORMATTED
 12305         MOVE -1                 TO EPYAMTL
 12306         MOVE AL-UNBON           TO EPYAMTA.
 12307
 12308 1490-EXIT.
 12309      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 236
* EL156.cbl
 12311 1500-EDIT-EXPENSES.
 12312     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12313         GO TO 1500-SKIP-ERROR-0556.
 12314
 12315 1500-CONTINUE-ON.
 12316
 12317     IF CM-O-B-COVERAGE
 12318        MOVE ER-0556             TO EMI-ERROR
 12319        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12320
 12321 1500-SKIP-ERROR-0556.
 12322     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12323        IF PI-EEXPENS NOT = ZEROS
 12324           MOVE ER-0524          TO EMI-ERROR
 12325           GO TO 1590-EXPENSE-ERROR
 12326        ELSE
 12327           GO TO 1600-EDIT-RESERVES.
 12328
 12329     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12330     MOVE '6'                    TO CNTL-REC-TYPE.
 12331
 12332     IF CONTROL-IS-ACTUAL-CARRIER
 12333         MOVE PI-CARRIER         TO WS-CARR
 12334     ELSE
 12335         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12336
 12337     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12338     MOVE +0                     TO CNTL-SEQ-NO.
 12339     MOVE 'CARR'                 TO FILE-SWITCH.
 12340
 12341     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12342
 12343     IF EXPENSE-CALC-MANUAL
 12344        GO TO 1600-EDIT-RESERVES.
 12345
 12346     IF DOLLARS-PER-PMT
 12347        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12348        GO TO 1600-EDIT-RESERVES.
 12349
 12350     IF DOLLARS-PER-MONTH AND
 12351        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12352       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12353       GO TO 1600-EDIT-RESERVES.
 12354
 12355     IF PERCENT-OF-PAYMENT
 12356        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12357
 12358     GO TO 1600-EDIT-RESERVES.
 12359
 12360 1590-EXPENSE-ERROR.
 12361     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12362
 12363     IF EMI-MESSAGE-FORMATTED
 12364        MOVE -1                  TO EEXPENSL
 12365        MOVE AL-UNBON            TO EEXPENSA.
 12366
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 237
* EL156.cbl
 12368 1600-EDIT-RESERVES.
 12369     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12370        IF PI-ERESV = ZEROS
 12371           GO TO 1700-EDIT-EXPENSE-TYPE
 12372        ELSE
 12373           MOVE ER-0525          TO EMI-ERROR
 12374           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12375           GO TO 1700-EDIT-EXPENSE-TYPE.
 12376
 12377     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12378     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12379     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12380
 12381     IF NOT AT-MANUAL-RESERVES-USED
 12382        IF PI-ERESV NOT = ZEROS
 12383           MOVE ER-0518          TO EMI-ERROR
 12384           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12385
 12386     IF AT-MANUAL-RESERVES-USED
 12387        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12388        GO TO 1700-EDIT-EXPENSE-TYPE.
 12389
 12390     IF AT-FUTURE-RESERVES-USED
 12391        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12392
 12393     IF AT-FUTURE-RESERVES-USED
 12394        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12395
 12396     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12397        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12398
 12399     IF AT-IBNR-RESERVES-USED
 12400        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12401
 12402     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12403     GO TO 1700-EDIT-EXPENSE-TYPE.
 12404
 12405 1690-RESERVE-ERROR.
 12406     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12407
 12408     IF EMI-MESSAGE-FORMATTED
 12409        MOVE AL-UNBON            TO ERESVA
 12410        MOVE -1                  TO ERESVL.
 12411
 12412 1690-EXIT.
 12413      EXIT.
 12414
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 238
* EL156.cbl
 12416 1700-EDIT-EXPENSE-TYPE.
 12417     IF PI-PMTTYPE NOT = '5' AND '6'
 12418        GO TO 2000-EDIT-DONE.
 12419
 12420     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12421                   '6' OR '7' OR '8' OR '9'
 12422        GO TO 2000-EDIT-DONE.
 12423
 12424 1705-EXPENSE-ERROR.
 12425     MOVE ER-0573                TO EMI-ERROR.
 12426     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12427
 12428     IF EMI-MESSAGE-FORMATTED
 12429        MOVE AL-UABON            TO ETYPEA
 12430        MOVE -1                  TO ETYPEL.
 12431
 12432     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 239
* EL156.cbl
 12434 1950-NOT-FOUND.
 12435     IF FILE-SWITCH = 'MSTR'
 12436        MOVE ER-0204             TO EMI-ERROR.
 12437
 12438     IF FILE-SWITCH = 'CARR'
 12439        MOVE ER-0252             TO EMI-ERROR.
 12440
 12441     IF FILE-SWITCH = 'COMP'
 12442        MOVE ER-0254             TO EMI-ERROR.
 12443
 12444     IF FILE-SWITCH = 'STAT'
 12445        MOVE ER-0149             TO EMI-ERROR.
 12446
 12447     IF FILE-SWITCH = 'PROC'
 12448        MOVE ER-0019             TO EMI-ERROR.
 12449
 12450     IF FILE-SWITCH = 'ACCT'
 12451        MOVE ER-0198             TO EMI-ERROR.
 12452
 12453     IF FILE-SWITCH = 'BENE'
 12454        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12455           MOVE ER-0282          TO EMI-ERROR
 12456        ELSE
 12457           MOVE ER-0283          TO EMI-ERROR.
 12458
 12459     MOVE -1                     TO PMTTYPEL.
 12460     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12461
 12462     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12463                                     WS-FORCE-CTR.
 12464
 12465     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12466                                     WS-FATAL-CTR.
 12467
 12468     GO TO 8200-SEND-DATAONLY.
 12469
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 240
* EL156.cbl
 12471 2000-EDIT-DONE.
 12472     if pi-company-id = 'DCC'
 12473        and cl-critical-period > 0
 12474        perform 2210-dcc-max-benes thru 2210-exit
 12475     else
 12476     IF (WS-SPECIAL-CALC-CD = 'C')
 12477*       AND (CM-AH-CRITICAL-PERIOD) > 0
 12478        and (cl-critical-period > 0)
 12479        IF CM-AH-BENEFIT-AMT NOT = ZERO
 12480           IF PI-EPYAMT > ZEROS
 12481              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12482                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12483           ELSE
 12484              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12485                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12486           END-IF
 12487*          IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 12488           if ws-crit-period-days > cl-critical-period
 12489              MOVE ER-0657          TO EMI-ERROR
 12490              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12491           END-IF
 12492        END-IF
 12493     END-IF
 12494     end-if
 12495     IF PI-HOLDTIL NOT = ZEROS
 12496        MOVE PI-HOLDTIL          TO HOLDTILO
 12497        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12498
 12499     IF PI-EPYFROM NOT = ZEROS
 12500        MOVE PI-EPYFROM          TO EPYFROMO
 12501        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12502
 12503     IF PI-EPYTHRU NOT = ZEROS
 12504        MOVE PI-EPYTHRU            TO EPYTHRUO
 12505        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12506        IF PI-USES-PAID-TO
 12507           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12508           MOVE '4'                TO DC-OPTION-CODE
 12509           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12510           IF NO-CONVERSION-ERROR
 12511              MOVE +1              TO DC-ELAPSED-DAYS
 12512              MOVE +0              TO DC-ELAPSED-MONTHS
 12513              MOVE '6'             TO DC-OPTION-CODE
 12514              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12515              IF NO-CONVERSION-ERROR
 12516                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12517
 12518     MOVE PI-EDAYS               TO EDAYSO.
 12519
 12520     IF PI-AIGFROM NOT = ZEROS
 12521        MOVE PI-AIGFROM          TO AIGFROMO
 12522        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12523
 12524     MOVE PI-EPYAMT              TO EPYAMTO.
 12525     MOVE PI-ERESV               TO ERESVO.
 12526     MOVE PI-EEXPENS             TO EEXPENSO.
 12527
 12528     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 241
* EL156.cbl
 12529     MOVE SPACES                 TO DC-OPTION-CODE.
 12530     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12531
 12532     IF DATE-CONVERSION-ERROR
 12533        MOVE SPACES              TO CPYFROMI
 12534     ELSE
 12535        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12536        IF PI-EPYFROM = ZEROS
 12537           MOVE AL-UANON             TO EPYFROMA
 12538           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12539           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12540
 12541     IF PI-USES-PAID-TO
 12542        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12543        MOVE +1                            TO DC-ELAPSED-DAYS
 12544        MOVE +0                            TO DC-ELAPSED-MONTHS
 12545        MOVE '6'                           TO DC-OPTION-CODE
 12546        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12547        IF NO-CONVERSION-ERROR
 12548           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12549           IF PI-EPYTHRU = ZEROS
 12550              MOVE AL-UANON                TO EPYTHRUA
 12551              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12552              MOVE ' '                     TO DC-OPTION-CODE
 12553              MOVE +0                      TO DC-ELAPSED-DAYS
 12554                                              DC-ELAPSED-MONTHS
 12555              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12556              IF NO-CONVERSION-ERROR
 12557                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12558                  GO TO 2001-CONTINUE
 12559              ELSE
 12560                  GO TO 2001-CONTINUE
 12561           ELSE
 12562              GO TO 2001-CONTINUE.
 12563
 12564     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12565     MOVE SPACES                 TO DC-OPTION-CODE.
 12566     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12567
 12568     IF DATE-CONVERSION-ERROR
 12569        MOVE SPACES              TO CPYTHRUI
 12570     ELSE
 12571        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12572        IF PI-EPYTHRU = ZEROS
 12573           MOVE AL-UANON TO EPYTHRUA
 12574           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12575           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12576
 12577 2001-CONTINUE.
 12578
 12579     MOVE PI-CDAYS               TO CDAYSO.
 12580
 12581     IF PI-EDAYS = ZEROS
 12582        MOVE AL-UNNON TO EDAYSA
 12583        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12584
 12585     MOVE PI-CPYAMT              TO CPYAMTO.
 12586
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 242
* EL156.cbl
 12587     IF PI-EPYAMT = ZEROS
 12588        MOVE AL-UNNON            TO EPYAMTA
 12589        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12590
 12591     MOVE PI-CRESV               TO CRESVO.
 12592     MOVE PI-CEXPENS             TO CEXPENSO.
 12593
 12594     IF PI-EEXPENS = ZEROS
 12595        MOVE AL-UNNON TO EEXPENSA
 12596        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12597
 12598     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12599        AND (CL-CLAIM-TYPE = 'L')
 12600        AND (PI-OFFLINE NOT EQUAL 'Y')
 12601        IF PI-PMTTYPE = '2' OR '4'
 12602           PERFORM 2200-CALC-INTEREST
 12603                                 THRU 2200-EXIT
 12604        END-IF
 12605     END-IF
 12606     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12607     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12608     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12609
 12610     IF EMI-FATAL-CTR = ZEROS
 12611        MOVE 'B'                 TO PI-PASS-SW.
 12612
 12613     IF NOT EMI-MESSAGE-FORMATTED
 12614         MOVE -1                 TO EPYFROML
 12615     ELSE
 12616         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12617            EMI-ERROR-NUMBER (2) = SPACES
 12618             MOVE -1             TO EPYFROML.
 12619
 12620     GO TO 8200-SEND-DATAONLY.
 12621
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 243
* EL156.cbl
 12623 2200-CALC-INTEREST.
 12624     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12625        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12626        MOVE '4'                 TO DC-OPTION-CODE
 12627        PERFORM 9700-LINK-DATE-CONVERT
 12628        IF DATE-CONVERSION-ERROR
 12629            MOVE LOW-VALUES      TO CP-PRF-DT
 12630        ELSE
 12631           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12632        END-IF
 12633     END-IF
 12634     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12635        IN CLAIM-INT-PASS-AREA
 12636     MOVE CL-CERT-STATE          TO CP-STATE
 12637        IN CLAIM-INT-PASS-AREA
 12638     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12639     MOVE 'LF'                   TO CP-COVERAGE
 12640     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12641     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12642     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12643     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12644     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12645     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12646
 12647* EXEC CICS LINK
 12648*       PROGRAM   ('ELCLMI')
 12649*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12650*       LENGTH    (CP-CLAIM-LENGTH)
 12651*    END-EXEC
 12652     MOVE 'ELCLMI' TO DFHEIV1
 12653*    MOVE '."C                   (   #00012059' TO DFHEIV0
 12654     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12656     MOVE X'2020233030303132303539' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0,
 12658           DFHEIV1,
 12659           CLAIM-INT-PASS-AREA,
 12660           CP-CLAIM-LENGTH,
 12661           DFHEIV99,
 12662           DFHEIV99,
 12663           DFHEIV99,
 12664           DFHEIV99
 12665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12666     MOVE AL-PANOF               TO PINTHA
 12667                                    PINTA
 12668     IF NO-CI-ERROR
 12669        MOVE CP-CLM-INT-AMT      TO PINTO
 12670                                    PI-INT-AMT
 12671        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12672        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12673        MOVE AL-PANOF            TO PINTHA
 12674                                    PINTA
 12675     ELSE
 12676        IF CI-RETURN-CODE = '8'
 12677           MOVE ER-3818          TO EMI-ERROR
 12678           MOVE -1               TO ZINTL
 12679           PERFORM 9900-ERROR-FORMAT
 12680                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 244
* EL156.cbl
 12681           GO TO 2200-EXIT
 12682        ELSE
 12683           MOVE ZEROS            TO PINTO
 12684                                    PI-INT-AMT
 12685                                    PI-INT-DAYS
 12686                                    PI-INT-RATE-USED
 12687        END-IF
 12688     END-IF
 12689     IF PI-INT-AMT NOT = ZEROS
 12690        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12691           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12692           CONTINUE
 12693        ELSE
 12694           MOVE CL-SOC-SEC-NO (1:3)
 12695                                 TO WS-SSN (1:3)
 12696           MOVE CL-SOC-SEC-NO (5:2)
 12697                                 TO WS-SSN (4:2)
 12698           MOVE CL-SOC-SEC-NO (8:4)
 12699                                 TO WS-SSN (6:4)
 12700           IF (WS-SSN NUMERIC)
 12701              AND (WS-SSN NOT = ZEROS)
 12702              CONTINUE
 12703           ELSE
 12704              MOVE ER-2044       TO EMI-ERROR
 12705              PERFORM 9900-ERROR-FORMAT
 12706                                 THRU 9900-EXIT
 12707           END-IF
 12708        END-IF
 12709        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12710        MOVE +51                 TO TRLR-SEQ-NO
 12711
 12712* EXEC CICS READ
 12713*          DATASET  ('ELTRLR')
 12714*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12715*          RIDFLD   (ELTRLR-KEY)
 12716*          RESP     (WS-RESPONSE)
 12717*       END-EXEC
 12718     MOVE 'ELTRLR' TO DFHEIV1
 12719*    MOVE '&"S        E          (  N#00012109' TO DFHEIV0
 12720     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12721     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12722     MOVE X'204E233030303132313039' TO DFHEIV0(25:11)
 12723     CALL 'kxdfhei1' USING DFHEIV0,
 12724           DFHEIV1,
 12725           DFHEIV20,
 12726           DFHEIV99,
 12727           ELTRLR-KEY,
 12728           DFHEIV99,
 12729           DFHEIV99,
 12730           DFHEIV99
 12731     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12732         DFHEIV20
 12733     MOVE EIBRESP  TO WS-RESPONSE
 12734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12735        IF (NOT WS-RESP-NORMAL)
 12736                    OR
 12737           ((WS-RESP-NORMAL)
 12738           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 245
* EL156.cbl
 12739           OR (AT-CITY-STATE = SPACES)))
 12740           MOVE ER-0874          TO EMI-ERROR
 12741           PERFORM 9900-ERROR-FORMAT
 12742                                 THRU 9900-EXIT
 12743        END-IF
 12744     END-IF
 12745     .
 12746 2200-EXIT.
 12747     EXIT.
 12748 2210-dcc-max-benes.
 12749
 12750     move cm-ah-benefit-amt      to ws-monthly-benefit
 12751     if pdef-found
 12752        and pd-max-amt (p1) < ws-monthly-benefit
 12753        move pd-max-amt (p1)     to ws-monthly-benefit
 12754     end-if
 12755
 12756     move cl-cert-key-data       to elcrtt-key (2:21)
 12757     move cl-company-cd          to ctrlr-comp-cd
 12758     move cl-cert-no             to ctrlr-cert-no
 12759     move 'B'                    to ctrlr-rec-type
 12760
 12761
 12762* EXEC CICS READ
 12763*       DATASET  ('ELCRTT')
 12764*       set      (address of CERTIFICATE-TRAILERS)
 12765*       RIDFLD   (ELCRTT-KEY)
 12766*       RESP     (WS-RESPONSE)
 12767*    END-EXEC
 12768     MOVE 'ELCRTT' TO DFHEIV1
 12769*    MOVE '&"S        E          (  N#00012141' TO DFHEIV0
 12770     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12772     MOVE X'204E233030303132313431' TO DFHEIV0(25:11)
 12773     CALL 'kxdfhei1' USING DFHEIV0,
 12774           DFHEIV1,
 12775           DFHEIV20,
 12776           DFHEIV99,
 12777           ELCRTT-KEY,
 12778           DFHEIV99,
 12779           DFHEIV99,
 12780           DFHEIV99
 12781     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12782         DFHEIV20
 12783     MOVE EIBRESP  TO WS-RESPONSE
 12784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12785     IF not WS-RESP-NORMAL
 12786        go to 2210-exit
 12787     end-if
 12788
 12789*    if instypei = 'P'
 12790*       move +1 to s1
 12791*    else
 12792*       MOVE +2 to s1
 12793*    end-if
 12794
 12795     move +1 to s1
 12796     evaluate cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 246
* EL156.cbl
 12797        when 'A'
 12798           move +1 to s2
 12799        when 'I'
 12800           move +2 to s2
 12801        when 'G'
 12802           move +3 to s2
 12803        when 'L'
 12804           move +4 to s2
 12805        when 'P'
 12806           move +5 to s2
 12807     end-evaluate
 12808
 12809     if pi-epyamt > zeros
 12810        compute ws-crit-period-days =
 12811           (cs-total-paid (s1 s2) + PI-EPYAMT)
 12812           / ws-monthly-benefit
 12813     else
 12814        compute ws-crit-period-days =
 12815           (cs-total-paid (s1 s2) + PI-CPYAMT)
 12816           / ws-monthly-benefit
 12817     end-if
 12818
 12819     if ws-crit-period-days > cl-critical-period
 12820*    if ws-crit-period-days > pd-crit-period (p1)
 12821        move er-1658             to emi-error
 12822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12823     end-if
 12824
 12825     .
 12826 2210-exit.
 12827     exit.
 12828
 12829 2220-update-elcrtt.
 12830
 12831
 12832* EXEC CICS GETMAIN
 12833*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 12834*       LENGTH   (ELCRTT-LENGTH)
 12835*       INITIMG  (GETMAIN-SPACE)
 12836*    END-EXEC
 12837*    MOVE ',"IL                  $   #00012193' TO DFHEIV0
 12838     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12839     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12840     MOVE X'2020233030303132313933' TO DFHEIV0(25:11)
 12841     CALL 'kxdfhei1' USING DFHEIV0,
 12842           DFHEIV20,
 12843           ELCRTT-LENGTH,
 12844           GETMAIN-SPACE
 12845     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12846         DFHEIV20
 12847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12848
 12849     move cl-cert-key-data       to elcrtt-key (2:21)
 12850     move cl-company-cd          to ctrlr-comp-cd
 12851     move cl-cert-no             to ctrlr-cert-no
 12852     move 'B'                    to ctrlr-rec-type
 12853
 12854
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 247
* EL156.cbl
 12855* EXEC CICS READ
 12856*       UPDATE
 12857*       DATASET  (ELCRTT-DSID)
 12858*       into     (CERTIFICATE-TRAILERS)
 12859*       RIDFLD   (ELCRTT-KEY)
 12860*       RESP     (WS-RESPONSE)
 12861*    END-EXEC
 12862     MOVE LENGTH OF
 12863      CERTIFICATE-TRAILERS
 12864       TO DFHEIV11
 12865*    MOVE '&"IL       EU         (  N#00012204' TO DFHEIV0
 12866     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12867     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12868     MOVE X'204E233030303132323034' TO DFHEIV0(25:11)
 12869     CALL 'kxdfhei1' USING DFHEIV0,
 12870           ELCRTT-DSID,
 12871           CERTIFICATE-TRAILERS,
 12872           DFHEIV11,
 12873           ELCRTT-KEY,
 12874           DFHEIV99,
 12875           DFHEIV99,
 12876           DFHEIV99
 12877     MOVE EIBRESP  TO WS-RESPONSE
 12878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12879
 12880     IF WS-RESP-NORMAL
 12881        perform 2225-upd-crt-trlr thru 2225-exit
 12882
 12883* EXEC CICS REWRITE
 12884*          DATASET  (ELCRTT-DSID)
 12885*          from     (CERTIFICATE-TRAILERS)
 12886*          RESP     (WS-RESPONSE)
 12887*       END-EXEC
 12888     MOVE LENGTH OF
 12889      CERTIFICATE-TRAILERS
 12890       TO DFHEIV11
 12891*    MOVE '&& L                  %  N#00012214' TO DFHEIV0
 12892     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12893     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12894     MOVE X'204E233030303132323134' TO DFHEIV0(25:11)
 12895     CALL 'kxdfhei1' USING DFHEIV0,
 12896           ELCRTT-DSID,
 12897           CERTIFICATE-TRAILERS,
 12898           DFHEIV11,
 12899           DFHEIV99
 12900     MOVE EIBRESP  TO WS-RESPONSE
 12901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12902     else
 12903        if ws-resp-notfnd
 12904           move 'CS'             to certificate-trailers
 12905           move cl-company-cd    to cs-company-cd
 12906           move cl-cert-key-data to cs-control-primary (2:21)
 12907           move cl-cert-no       to cs-cert-no
 12908           move 'B'              to cs-trailer-type
 12909           perform varying s1 from +1 by +1 until s1 > +2
 12910              perform varying s2 from +1 by +1 until s2 > +10
 12911                 move zeros      to cs-bank (s1 s2)
 12912                                    cs-no-of-claims (s1 s2)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 248
* EL156.cbl
 12913                                    cs-days-paid (s1 s2)
 12914                                    cs-total-paid (s1 s2)
 12915              end-perform
 12916           end-perform
 12917           perform 2225-upd-crt-trlr
 12918                                 thru 2225-exit
 12919
 12920* EXEC CICS WRITE
 12921*             DATASET  (ELCRTT-DSID)
 12922*             from     (CERTIFICATE-TRAILERS)
 12923*             RIDFLD   (cs-control-primary)
 12924*             RESP     (WS-RESPONSE)
 12925*          END-EXEC
 12926     MOVE LENGTH OF
 12927      CERTIFICATE-TRAILERS
 12928       TO DFHEIV11
 12929*    MOVE '&$ L                  ''  N#00012236' TO DFHEIV0
 12930     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12932     MOVE X'204E233030303132323336' TO DFHEIV0(25:11)
 12933     CALL 'kxdfhei1' USING DFHEIV0,
 12934           ELCRTT-DSID,
 12935           CERTIFICATE-TRAILERS,
 12936           DFHEIV11,
 12937           cs-control-primary,
 12938           DFHEIV99,
 12939           DFHEIV99
 12940     MOVE EIBRESP  TO WS-RESPONSE
 12941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12942        end-if
 12943     END-IF
 12944
 12945     .
 12946 2220-exit.
 12947     exit.
 12948
 12949 2225-upd-crt-trlr.
 12950
 12951*    if instypei = 'P'
 12952*       move +1 to s1
 12953*    else
 12954*       MOVE +2 to s1
 12955*    end-if
 12956
 12957     move +1 to s1
 12958     evaluate cl-claim-type
 12959        when 'A'
 12960           move +1 to s2
 12961        when 'I'
 12962           move +2 to s2
 12963        when 'G'
 12964           move +3 to s2
 12965        when 'L'
 12966           move +4 to s2
 12967        when 'P'
 12968           move +5 to s2
 12969     end-evaluate
 12970
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 249
* EL156.cbl
 12971     compute cs-total-paid (s1 s2) = cs-total-paid (s1 s2) +
 12972        at-amount-paid
 12973     compute cs-days-paid (s1 s2) = cs-days-paid (s1 s2) +
 12974        at-days-in-period
 12975
 12976     .
 12977 2225-exit.
 12978     exit.
 12979 3000-MOVE-INPUT-TO-SAVE-AREA.
 12980     IF PMTTYPEL > 0
 12981         MOVE PMTTYPEI           TO WS-PMTTYPE.
 12982
 12983     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 12984
 12985     IF WS-PMTTYPE = '9'
 12986         MOVE 'P'                TO PI-PROVISIONAL-IND
 12987         MOVE '1'                TO WS-PMTTYPE.
 12988
 12989     IF PAYEEL > 0
 12990         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 12991         MOVE PAYEEI             TO WS-PAYEE.
 12992
 12993     IF NOTE1L > +0
 12994         MOVE NOTE1I             TO WS-PMTNOTE1
 12995                                    WS-FLI-PMTNOTE
 12996                                    WS-HAN-PMTNOTE.
 12997
 12998     IF NOTE2L > +0
 12999         MOVE NOTE2I             TO WS-PMTNOTE2.
 13000
 13001     IF OFFLINEL > 0
 13002         MOVE OFFLINEI           TO WS-OFFLINE.
 13003
 13004     IF PROOFDTL > 0
 13005         MOVE PROOFDTI            TO DATE-WORK
 13006         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13007         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13008         MOVE '4'                 TO DC-OPTION-CODE
 13009         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13010         IF NO-CONVERSION-ERROR
 13011            MOVE NUM-WORK         TO PROOFDTO
 13012            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13013            MOVE NUM-WORK         TO WS-PROOF-DATE
 13014         ELSE
 13015            MOVE ZEROS            TO WS-PROOF-DATE
 13016         END-IF
 13017     END-IF.
 13018
 13019     IF EOBYNL > +0
 13020         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13021         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13022     END-IF
 13023
 13024     IF CLMFMYNL > +0
 13025         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13026         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13027     END-IF
 13028
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 250
* EL156.cbl
 13029     IF SURVYYNL > +0
 13030         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13031         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13032     END-IF
 13033*    IF GROUPEDL > +0
 13034*        MOVE GROUPEDI           TO WS-GROUPED.
 13035*
 13036*    IF CASHL > +0
 13037*       MOVE CASHI               TO WS-CASH.
 13038     IF LOANNOL > +0
 13039         MOVE LOANNOI            TO WS-LOAN-NO.
 13040
 13041     IF CHECKNOL > 0
 13042         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13043
 13044     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13045         IF WS-AIG-CREDIT-ENTERED
 13046             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13047             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13048             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13049             MOVE AL-UANON         TO CHECKNOA.
 13050
 13051     IF HOLDTILL > 0
 13052         MOVE HOLDTILI           TO DATE-WORK
 13053         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13054         MOVE NUM-WORK           TO WS-HOLDTIL.
 13055
 13056     IF ZINTL > +0
 13057
 13058* EXEC CICS BIF DEEDIT
 13059*           FIELD   (ZINTI)
 13060*           LENGTH  (07)
 13061*       END-EXEC
 13062     MOVE 07
 13063       TO DFHEIV11
 13064*    MOVE '@"L                   #   #00012357' TO DFHEIV0
 13065     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13066     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13067     MOVE X'2020233030303132333537' TO DFHEIV0(25:11)
 13068     CALL 'kxdfhei1' USING DFHEIV0,
 13069           ZINTI,
 13070           DFHEIV11
 13071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13072        IF ZINTI NOT NUMERIC
 13073           MOVE ER-0419          TO EMI-ERROR
 13074           PERFORM 9900-ERROR-FORMAT
 13075           MOVE AL-UABON         TO ZINTA
 13076           MOVE -1               TO ZINTL
 13077        ELSE
 13078           MOVE ZINTI            TO CP-INT-RATE
 13079                                    WS-INT-RATE
 13080           MOVE CP-INT-RATE      TO ZINTO
 13081           MOVE AL-UNNON         TO ZINTA
 13082        END-IF
 13083     ELSE
 13084        MOVE ZEROS               TO CP-INT-RATE
 13085     END-IF
 13086     IF EPYFROML > 0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 251
* EL156.cbl
 13087         MOVE EPYFROMI           TO DATE-WORK
 13088         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13089         MOVE NUM-WORK           TO WS-EPYFROM.
 13090
 13091     IF AIGFROML > 0
 13092         MOVE AIGFROMI           TO DATE-WORK
 13093         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13094         MOVE NUM-WORK           TO WS-AIGFROM
 13095     ELSE
 13096         IF (AIGFROMI = LOW-VALUES) AND
 13097            (PI-AIGFROM NOT = ZEROS)
 13098              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13099
 13100     IF EPYTHRUL > +0
 13101        MOVE EPYTHRUI           TO DATE-WORK
 13102        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13103        MOVE NUM-WORK           TO WS-EPYTHRU
 13104        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13105        MOVE '4'                TO DC-OPTION-CODE
 13106        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13107        IF NO-CONVERSION-ERROR
 13108           IF PI-USES-PAID-TO
 13109              MOVE '6'                TO DC-OPTION-CODE
 13110              MOVE -1                 TO DC-ELAPSED-DAYS
 13111              MOVE +0                 TO DC-ELAPSED-MONTHS
 13112              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13113              IF NO-CONVERSION-ERROR
 13114                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13115                 MOVE ' '             TO DC-OPTION-CODE
 13116                 MOVE +0              TO DC-ELAPSED-DAYS
 13117                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13118              IF NO-CONVERSION-ERROR
 13119                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13120
 13121*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13122*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13123     IF EDAYSL > 0
 13124
 13125* EXEC CICS BIF DEEDIT
 13126*            FIELD(EDAYSI)
 13127*            LENGTH(6)
 13128*        END-EXEC
 13129     MOVE 6
 13130       TO DFHEIV11
 13131*    MOVE '@"L                   #   #00012413' TO DFHEIV0
 13132     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13133     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13134     MOVE X'2020233030303132343133' TO DFHEIV0(25:11)
 13135     CALL 'kxdfhei1' USING DFHEIV0,
 13136           EDAYSI,
 13137           DFHEIV11
 13138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13139         MOVE EDAYSI             TO WS-DY-WORK
 13140         IF WS-DY-SIGN = SPACES
 13141            MOVE WS-DY-NUM       TO WS-EDAYS
 13142            ADD 0                TO WS-EDAYS
 13143         ELSE
 13144            MOVE EDAYSI          TO WS-EDAYS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 252
* EL156.cbl
 13145            ADD 0                TO WS-EDAYS.
 13146
 13147*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13148*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13149     IF EPYAMTL > 0
 13150
 13151* EXEC CICS BIF DEEDIT
 13152*            FIELD(EPYAMTI)
 13153*            LENGTH(10)
 13154*        END-EXEC
 13155     MOVE 10
 13156       TO DFHEIV11
 13157*    MOVE '@"L                   #   #00012428' TO DFHEIV0
 13158     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13159     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13160     MOVE X'2020233030303132343238' TO DFHEIV0(25:11)
 13161     CALL 'kxdfhei1' USING DFHEIV0,
 13162           EPYAMTI,
 13163           DFHEIV11
 13164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13165         MOVE EPYAMTI            TO WS-PY-WORK
 13166         IF WS-PY-SIGN = SPACES
 13167            MOVE WS-PY-NUM       TO WS-EPYAMT
 13168            ADD 0                TO WS-EPYAMT
 13169         ELSE
 13170            MOVE EPYAMTI         TO WS-EPYAMT
 13171            ADD 0                TO WS-EPYAMT.
 13172
 13173     IF ERESVL > 0
 13174
 13175* EXEC CICS BIF DEEDIT
 13176*            FIELD(ERESVI)
 13177*            LENGTH(9)
 13178*        END-EXEC
 13179     MOVE 9
 13180       TO DFHEIV11
 13181*    MOVE '@"L                   #   #00012441' TO DFHEIV0
 13182     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13183     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13184     MOVE X'2020233030303132343431' TO DFHEIV0(25:11)
 13185     CALL 'kxdfhei1' USING DFHEIV0,
 13186           ERESVI,
 13187           DFHEIV11
 13188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13189         MOVE ERESVI TO WS-ERESV.
 13190
 13191     IF EEXPENSL > 0
 13192
 13193* EXEC CICS BIF DEEDIT
 13194*            FIELD(EEXPENSI)
 13195*            LENGTH(8)
 13196*        END-EXEC
 13197     MOVE 8
 13198       TO DFHEIV11
 13199*    MOVE '@"L                   #   #00012448' TO DFHEIV0
 13200     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13201     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13202     MOVE X'2020233030303132343438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 253
* EL156.cbl
 13203     CALL 'kxdfhei1' USING DFHEIV0,
 13204           EEXPENSI,
 13205           DFHEIV11
 13206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13207         MOVE EEXPENSI           TO WS-EEXPENS.
 13208
 13209     IF ETYPEL > ZEROS
 13210         MOVE ETYPEI             TO WS-ETYPE.
 13211
 13212     IF PI-COMPANY-ID = 'BOA'
 13213        IF PINTL > ZEROS
 13214
 13215* EXEC CICS BIF DEEDIT
 13216*            FIELD (PINTI)
 13217*            LENGTH(05)
 13218*          END-EXEC
 13219     MOVE 05
 13220       TO DFHEIV11
 13221*    MOVE '@"L                   #   #00012459' TO DFHEIV0
 13222     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13223     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13224     MOVE X'2020233030303132343539' TO DFHEIV0(25:11)
 13225     CALL 'kxdfhei1' USING DFHEIV0,
 13226           PINTI,
 13227           DFHEIV11
 13228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13229           IF PINTI NUMERIC
 13230               MOVE AL-UNNON     TO PINTA
 13231               MOVE PINTI        TO WS-INT-RATE
 13232               MOVE WS-INT-RATE  TO PINTO.
 13233
 13234 3000-EXIT.
 13235     EXIT.
 13236
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 254
* EL156.cbl
 13238 3050-REBUILD-ENTERED.
 13239
 13240     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13241
 13242     IF PI-PROV-PMT
 13243         MOVE '9'           TO PMTTYPEO
 13244     ELSE
 13245         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13246
 13247     MOVE PI-PAYEE          TO PAYEEO.
 13248     MOVE PI-PMTNOTE1       TO NOTE1O.
 13249     MOVE PI-PMTNOTE2       TO NOTE2O.
 13250     MOVE PI-OFFLINE        TO OFFLINEO.
 13251     IF PI-PROOF-DATE NOT = ZEROS
 13252         MOVE PI-PROOF-DATE TO PROOFDTO
 13253         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13254     END-IF.
 13255*    MOVE PI-GROUPED        TO GROUPEDO.
 13256
 13257*    MOVE PI-CASH           TO CASHO.
 13258
 13259     IF PI-INT-RATE > ZEROS
 13260         MOVE PI-INT-RATE   TO PINTO.
 13261
 13262     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13263        IF PI-INT-AMT > ZEROS
 13264           MOVE PI-INT-AMT       TO PINTO
 13265           MOVE AL-PANOF         TO PINTA
 13266                                    PINTHA
 13267        END-IF
 13268     END-IF
 13269     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13270     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13271     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13272     IF PI-HOLDTIL NOT = ZEROS
 13273        MOVE PI-HOLDTIL          TO HOLDTILO
 13274        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13275
 13276     IF PI-EPYFROM NOT = ZEROS
 13277        MOVE PI-EPYFROM          TO EPYFROMO
 13278        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13279
 13280     IF PI-AIGFROM NOT = ZEROS
 13281        MOVE PI-AIGFROM          TO AIGFROMO
 13282        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13283
 13284     IF PI-EPYTHRU NOT = ZEROS
 13285        MOVE PI-EPYTHRU          TO EPYTHRUO
 13286        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13287        IF PI-USES-PAID-TO
 13288           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13289           MOVE '4'                TO DC-OPTION-CODE
 13290           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13291           IF NO-CONVERSION-ERROR
 13292              MOVE +1 TO DC-ELAPSED-DAYS
 13293              MOVE +0 TO DC-ELAPSED-MONTHS
 13294              MOVE '6' TO DC-OPTION-CODE
 13295              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 255
* EL156.cbl
 13296              IF NO-CONVERSION-ERROR
 13297                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13298
 13299     IF PI-EDAYS NOT = ZEROS
 13300        MOVE PI-EDAYS TO EDAYSO.
 13301
 13302     IF PI-EPYAMT NOT = ZEROS
 13303        MOVE PI-EPYAMT TO EPYAMTO.
 13304
 13305     IF PI-ERESV NOT = ZEROS
 13306        MOVE PI-ERESV TO ERESVO.
 13307
 13308     IF PI-EEXPENS NOT = ZEROS
 13309        MOVE PI-EEXPENS TO EEXPENSO.
 13310
 13311     MOVE PI-ETYPE TO ETYPEO.
 13312
 13313     IF PI-ECHECKNO NOT = SPACES
 13314        MOVE PI-ECHECKNO         TO CHECKNOO
 13315     ELSE
 13316        MOVE PI-CCHECKNO         TO CHECKNOO.
 13317
 13318     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13319     MOVE SPACES                 TO DC-OPTION-CODE.
 13320     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13321
 13322     IF DATE-CONVERSION-ERROR
 13323        MOVE SPACES              TO CPYFROMI
 13324     ELSE
 13325        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13326
 13327     IF PI-USES-PAID-TO
 13328        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13329        MOVE +1                  TO DC-ELAPSED-DAYS
 13330        MOVE +0                  TO DC-ELAPSED-MONTHS
 13331        MOVE '6'                 TO DC-OPTION-CODE
 13332        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13333        IF NO-CONVERSION-ERROR
 13334           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13335           GO TO 3051-CONTINUE.
 13336
 13337     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13338     MOVE SPACES                 TO DC-OPTION-CODE.
 13339     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13340
 13341     IF DATE-CONVERSION-ERROR
 13342        MOVE SPACES              TO CPYTHRUI
 13343     ELSE
 13344        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13345
 13346 3051-CONTINUE.
 13347
 13348     IF PI-CDAYS NOT = ZEROS
 13349        MOVE PI-CDAYS TO CDAYSO.
 13350
 13351     IF PI-CPYAMT NOT = ZEROS
 13352        MOVE PI-CPYAMT TO CPYAMTO.
 13353
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 256
* EL156.cbl
 13354     IF PI-CRESV NOT = ZEROS
 13355        MOVE PI-CRESV TO CRESVO.
 13356
 13357     IF PI-CEXPENS NOT = ZEROS
 13358        MOVE PI-CEXPENS TO CEXPENSO.
 13359
 13360 3059-EXIT.
 13361     EXIT.
 13362
 13363 3100-DEEDIT-DATE.
 13364
 13365* EXEC CICS BIF DEEDIT
 13366*        FIELD(DATE-WORK)
 13367*        LENGTH(8)
 13368*    END-EXEC.
 13369     MOVE 8
 13370       TO DFHEIV11
 13371*    MOVE '@"L                   #   #00012598' TO DFHEIV0
 13372     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13373     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13374     MOVE X'2020233030303132353938' TO DFHEIV0(25:11)
 13375     CALL 'kxdfhei1' USING DFHEIV0,
 13376           DATE-WORK,
 13377           DFHEIV11
 13378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13379
 13380
 13381 3100-EXIT.
 13382     EXIT.
 13383
 13384 3200-CALC-AIG-DAYS.
 13385
 13386     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13387
 13388     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13389     MOVE ' '                    TO DC-OPTION-CODE.
 13390     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13391     IF NO-CONVERSION-ERROR
 13392         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13393     ELSE
 13394         GO TO 3290-ERROR.
 13395
 13396     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13397         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13398                                WS-BIN-FROM-DT
 13399     ELSE
 13400         IF CL-TOTAL-PAID-AMT > ZEROS
 13401             IF WS-SV-EPYFROM = LOW-VALUES
 13402                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13403                                        WS-BIN-FROM-DT
 13404             ELSE
 13405                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13406                                        WS-BIN-FROM-DT
 13407         ELSE
 13408             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13409                                        WS-BIN-FROM-DT.
 13410
 13411 3210-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 257
* EL156.cbl
 13412
 13413     MOVE ' '                    TO DC-OPTION-CODE.
 13414     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13415     IF DATE-CONVERSION-ERROR
 13416         GO TO 3290-ERROR.
 13417
 13418     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13419
 13420     IF PI-LOAN-DUE-DAY = 31
 13421         MOVE 30              TO WS-PMT-DUE-DA
 13422                                 WS-SAVE-DUE-DA
 13423     ELSE
 13424         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13425                                 WS-SAVE-DUE-DA.
 13426
 13427     IF (PI-LOAN-DUE-DAY > 28) AND
 13428        (WS-PMT-DUE-MO = 2)
 13429         MOVE 'Y'                TO WS-DUE-DAY-SW
 13430         MOVE 28                 TO WS-PMT-DUE-DA.
 13431
 13432     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13433     MOVE '4'                    TO DC-OPTION-CODE.
 13434     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13435     IF NO-CONVERSION-ERROR
 13436         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13437     ELSE
 13438         GO TO 3290-ERROR.
 13439
 13440*--------------------------------------------------------------*
 13441*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13442*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13443*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13444*                                                              *
 13445*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13446*             INCURRED DATE      - 04/15/91                    *
 13447*             PMT DUE DATE       - 04/03/91                    *
 13448*             PMT DUE DATE       - 05/03/91                    *
 13449*--------------------------------------------------------------*
 13450
 13451     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13452        (WS-SV-AIGFROM = LOW-VALUES)
 13453         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13454            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13455             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13456             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13457             IF NO-CONVERSION-ERROR
 13458                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13459                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13460             ELSE
 13461                 GO TO 3290-ERROR.
 13462
 13463     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13464        (WS-SV-AIGFROM = LOW-VALUES)
 13465         GO TO 3205-CONT-CALC-PMT.
 13466
 13467     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13468     MOVE ' '                    TO DC-OPTION-CODE.
 13469     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 258
* EL156.cbl
 13470     IF NO-CONVERSION-ERROR
 13471         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13472     ELSE
 13473         GO TO 3290-ERROR.
 13474
 13475     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13476        (WS-PMT-DUE-DA < WS-FROM-DA)
 13477          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13478          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13479          IF NO-CONVERSION-ERROR
 13480              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13481              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13482          ELSE
 13483              GO TO 3290-ERROR.
 13484
 13485 3205-CONT-CALC-PMT.
 13486
 13487*--------------------------------------------------------------*
 13488*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13489*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13490*--------------------------------------------------------------*
 13491
 13492     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13493        PI-PMTTYPE = '2'
 13494          NEXT SENTENCE
 13495     ELSE
 13496        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13497           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13498             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13499             MOVE ER-3527            TO EMI-ERROR
 13500             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13501             MOVE -1                 TO EPYTHRUL
 13502             MOVE AL-UNBON           TO EPYTHRUA
 13503                                        EPYFROMA
 13504             GO TO 3299-EXIT.
 13505
 13506*--------------------------------------------------------------*
 13507*    CALCULATE RETRO ELIMINATION DATE                          *
 13508*--------------------------------------------------------------*
 13509
 13510     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13511         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13512     ELSE
 13513         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13514
 13515     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13516     MOVE +0             TO DC-ELAPSED-MONTHS.
 13517     MOVE '6'            TO DC-OPTION-CODE.
 13518     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13519     IF NO-CONVERSION-ERROR
 13520         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13521     ELSE
 13522         GO TO 3290-ERROR.
 13523
 13524 3210-CHECK-PMT-DATE.
 13525
 13526*--------------------------------------------------------------*
 13527*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 259
* EL156.cbl
 13528*    THE ENTERED PAY FROM DATE                                 *
 13529*--------------------------------------------------------------*
 13530
 13531     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13532         NEXT SENTENCE
 13533     ELSE
 13534         GO TO 3220-COMPUTE-DAYS.
 13535
 13536     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13537     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13538     IF NO-CONVERSION-ERROR
 13539         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13540         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13541         GO TO 3210-CHECK-PMT-DATE
 13542     ELSE
 13543         GO TO 3290-ERROR.
 13544
 13545 3220-COMPUTE-DAYS.
 13546
 13547     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13548     MOVE ZEROS         TO WS-CDAYS.
 13549     MOVE 'N'           TO WS-ELIMINATION-SW.
 13550
 13551*--------------------------------------------------------------*
 13552*    COMPUTE CALIFORNIA DUE DAYS                               *
 13553*--------------------------------------------------------------*
 13554
 13555     IF CL-TOTAL-PAID-AMT > ZEROS
 13556         MOVE 'Y' TO WS-ELIMINATION-SW
 13557         GO TO 3240-FIRST-PMT-DUE
 13558     ELSE
 13559        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13560            NEXT SENTENCE
 13561        ELSE
 13562            GO TO 3240-FIRST-PMT-DUE.
 13563
 13564 3230-NEXT-PMT-DUE.
 13565
 13566     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13567     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13568     IF NO-CONVERSION-ERROR
 13569         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13570         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13571     ELSE
 13572         GO TO 3290-ERROR.
 13573
 13574 3240-FIRST-PMT-DUE.
 13575
 13576     IF CL-TOTAL-PAID-AMT > ZEROS
 13577         NEXT SENTENCE
 13578     ELSE
 13579        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13580            GO TO 3230-NEXT-PMT-DUE.
 13581
 13582     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13583         GO TO 3250-VERIFY-ELIMINATION.
 13584
 13585     ADD +30 TO WS-CDAYS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 260
* EL156.cbl
 13586     MOVE 'Y' TO WS-ELIMINATION-SW.
 13587     GO TO 3230-NEXT-PMT-DUE.
 13588
 13589 3250-VERIFY-ELIMINATION.
 13590
 13591     IF ELIM-SATISFIED
 13592         GO TO 3260-END-CALC.
 13593
 13594     IF PI-PMTTYPE = '1'
 13595         MOVE ZEROS TO WS-CDAYS
 13596         GO TO 3260-END-CALC.
 13597
 13598     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13599         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13600     ELSE
 13601         IF CL-TOTAL-PAID-AMT > ZEROS
 13602             IF WS-SV-EPYFROM = LOW-VALUES
 13603                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13604             ELSE
 13605                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13606         ELSE
 13607             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13608
 13609     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13610     MOVE '1'                    TO DC-OPTION-CODE.
 13611     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13612     IF NO-CONVERSION-ERROR
 13613         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13614     ELSE
 13615         GO TO 3290-ERROR.
 13616
 13617     IF CL-TOTAL-PAID-AMT > ZEROS
 13618         MOVE WS-DAYS-OFF TO WS-CDAYS
 13619     ELSE
 13620         IF PI-BEN-DAYS > WS-DAYS-OFF
 13621             MOVE ZEROS TO WS-CDAYS
 13622         ELSE
 13623             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13624
 13625 3260-END-CALC.
 13626
 13627     MOVE WS-CDAYS TO PI-CDAYS.
 13628
 13629     IF PI-EDAYS = ZEROS
 13630         MOVE PI-CDAYS TO PI-EDAYS
 13631         MOVE AL-UNNON TO EDAYSA.
 13632
 13633     GO TO 3299-EXIT.
 13634
 13635 3290-ERROR.
 13636
 13637     MOVE ER-3528            TO EMI-ERROR.
 13638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13639     MOVE -1                 TO CDAYSL.
 13640     MOVE AL-UNBON           TO CDAYSA.
 13641
 13642 3299-EXIT.
 13643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 261
* EL156.cbl
 13644
 13645 3300-BUMP-DATE.
 13646
 13647     IF WS-RESTORE-DUE-DAY
 13648         MOVE 'N'              TO WS-DUE-DAY-SW
 13649         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13650         ADD 1                 TO WS-PMT-DUE-MO
 13651         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13652         MOVE '4'              TO DC-OPTION-CODE
 13653         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13654         IF NO-CONVERSION-ERROR
 13655             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13656             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13657             GO TO 3399-EXIT
 13658         ELSE
 13659             MOVE '9'          TO DC-ERROR-CODE
 13660             GO TO 3399-EXIT.
 13661
 13662     IF (WS-PMT-DUE-MO = 1) AND
 13663        (WS-SAVE-DUE-DA > 28)
 13664           MOVE 'Y' TO WS-DUE-DAY-SW.
 13665
 13666     MOVE +0                 TO DC-ELAPSED-DAYS.
 13667     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13668     MOVE '6'                TO DC-OPTION-CODE.
 13669     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13670
 13671 3399-EXIT.
 13672     EXIT.
 13673
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 262
* EL156.cbl
 13675 3400-COMPUTE-EXPIRY.
 13676
 13677     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13678     MOVE +0                    TO DC-ELAPSED-DAYS
 13679                                   DC-ODD-DAYS-OVER.
 13680     MOVE '1'                   TO DC-END-OF-MONTH.
 13681     MOVE '6'                   TO DC-OPTION-CODE.
 13682
 13683     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13684         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13685     ELSE
 13686         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13687
 13688     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13689     IF NO-CONVERSION-ERROR
 13690         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13691     ELSE
 13692         GO TO 3390-CONTINUE.
 13693
 13694     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13695         GO TO 3390-CONTINUE.
 13696
 13697     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13698     MOVE '4'                    TO CNTL-REC-TYPE.
 13699     MOVE +0                     TO CNTL-SEQ-NO.
 13700     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13701     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13702     MOVE 'BENE'                 TO FILE-SWITCH.
 13703
 13704     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13705
 13706     IF NO-BENEFIT-FOUND
 13707         GO TO 3390-CONTINUE.
 13708
 13709     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13710        IF (PI-OFFLINE = 'Y') OR
 13711           (PI-PMTTYPE = '7')
 13712           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13713                                     THRU 9870-EXIT
 13714           IF ERROR-ON-OUTPUT
 13715             MOVE -1                 TO ENTERPFL
 13716             MOVE AL-UANON           TO ENTERPFA
 13717             MOVE MAP-NAMEA          TO MAP-NAME
 13718             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13719             GO TO 8200-SEND-DATAONLY.
 13720
 13721     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 13722        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 13723        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 13724          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 13725          MOVE +0        TO DC-ELAPSED-DAYS
 13726          MOVE +1        TO DC-ELAPSED-MONTHS
 13727          MOVE 6         TO DC-OPTION-CODE
 13728          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13729          IF NO-CONVERSION-ERROR
 13730              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 13731
 13732 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 263
* EL156.cbl
 13733
 13734      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13735         MOVE CM-AH-LOAN-EXPIRE-DT
 13736                                 TO DC-BIN-DATE-1
 13737      ELSE
 13738         MOVE CM-LF-LOAN-EXPIRE-DT
 13739                                 TO DC-BIN-DATE-1
 13740      END-IF
 13741
 13742      MOVE ' '                    TO DC-OPTION-CODE.
 13743      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13744      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 13745      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 13746
 13747 3499-EXIT.
 13748     EXIT.
 13749
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 264
* EL156.cbl
 13751
 13752 3600-CHECK-VERIFICATION.
 13753
 13754     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13755
 13756     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13757
 13758     IF PI-PAYEE-TYPE = 'I'
 13759        GO TO 3600-READ-TRAILER.
 13760
 13761     IF PI-PAYEE-TYPE = 'B'
 13762        ADD +10                  TO TRLR-SEQ-NO
 13763        GO TO 3600-READ-TRAILER.
 13764
 13765     IF PI-PAYEE-TYPE = 'A'
 13766        ADD +20                  TO TRLR-SEQ-NO
 13767        GO TO 3600-READ-TRAILER.
 13768
 13769     IF PI-PAYEE-TYPE = 'O'
 13770        ADD +50                  TO TRLR-SEQ-NO
 13771        GO TO 3600-READ-TRAILER.
 13772
 13773     IF PI-PAYEE-TYPE = 'Q'
 13774        ADD +60                  TO TRLR-SEQ-NO
 13775        GO TO 3600-READ-TRAILER.
 13776
 13777     IF PI-PAYEE-TYPE = 'P'
 13778        ADD +30                  TO TRLR-SEQ-NO
 13779        GO TO 3600-READ-TRAILER.
 13780
 13781     IF PI-PAYEE-TYPE = 'E'
 13782        ADD +40                  TO TRLR-SEQ-NO.
 13783
 13784 3600-READ-TRAILER.
 13785
 13786
 13787* EXEC CICS HANDLE CONDITION
 13788*         NOTFND(3600-CONTINUE)
 13789*    END-EXEC.
 13790*    MOVE '"$I                   ! - #00013008' TO DFHEIV0
 13791     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13793     MOVE X'2D20233030303133303038' TO DFHEIV0(25:11)
 13794     CALL 'kxdfhei1' USING DFHEIV0
 13795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13796
 13797
 13798     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13799
 13800 3600-CONTINUE.
 13801
 13802     IF PI-VFY-2ND-BENE = 'Y'
 13803       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 13804         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 13805           MOVE ER-7576            TO EMI-ERROR
 13806           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13807           MOVE -1                 TO PAYEEL
 13808           MOVE AL-UABON           TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 265
* EL156.cbl
 13809           GO TO 3600-EXIT
 13810         END-IF
 13811       END-IF
 13812     END-IF.
 13813
 13814     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 13815     MOVE 1 TO WS-SUB2
 13816     MOVE SPACES TO WS-PAYEE-NAME
 13817     PERFORM VARYING WS-SUB FROM 1 BY 1
 13818             UNTIL WS-SUB > 30
 13819         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13820            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13821                 WS-PAYEE-NAME-X (WS-SUB2)
 13822            ADD +1 TO WS-SUB2
 13823         END-IF
 13824     END-PERFORM.
 13825
 13826     STRING CL-INSURED-1ST-NAME
 13827            CL-INSURED-MID-INIT
 13828            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 13829     MOVE 1 TO WS-SUB2
 13830     MOVE SPACES TO WS-INSURED-NAME
 13831     PERFORM VARYING WS-SUB FROM 1 BY 1
 13832             UNTIL WS-SUB > 30
 13833         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13834            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13835                 WS-INSURED-NAME-X (WS-SUB2)
 13836            ADD +1 TO WS-SUB2
 13837         END-IF
 13838     END-PERFORM.
 13839
 13840     IF WS-PAYEE-NAME = WS-INSURED-NAME
 13841        MOVE ER-7579            TO EMI-ERROR
 13842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13843        MOVE -1                 TO PAYEEL
 13844        MOVE AL-UABON           TO PAYEEA
 13845     END-IF.
 13846
 13847 3600-EXIT.
 13848     EXIT.
 13849
 13850 5000-UPDATE.
 13851
 13852     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 13853
 13854     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 13855
 13856     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 13857        PI-OFFLINE = 'Y'
 13858        NEXT SENTENCE
 13859     ELSE
 13860        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 13861
 13862*    IF PI-COMPANY-ID = 'CRI'
 13863*       IF PI-PMTTYPE = '1' OR  '2'
 13864*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13865*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 13866*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 266
* EL156.cbl
 13867
 13868*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 13869*       IF PI-PMTTYPE = '1'
 13870*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13871*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 13872
 13873     IF PI-PMTTYPE      = '2' AND
 13874        PI-SPLIT-PMT-SW = 'Y' AND
 13875        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 13876          MOVE ER-3530                TO EMI-ERROR
 13877          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13878
 13879     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13880        AND (CL-CLAIM-TYPE = 'L')
 13881        IF PI-PMTTYPE = '2' OR '4'
 13882           IF PI-INT-AMT NOT = ZEROS
 13883              PERFORM 7110-BUILD-PMT-TRLR
 13884                                 THRU 7130-EXIT
 13885           ELSE
 13886              IF PI-PMTTYPE = '2'
 13887                 PERFORM 7140-BUILD-NOTE-TRLR
 13888                                 THRU 7170-EXIT
 13889              END-IF
 13890           END-IF
 13891        END-IF
 13892     END-IF
 13893*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13894*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13895*            MOVE 'N'                 TO  WS-LETTER-SW.
 13896
 13897*    IF PI-COMPANY-ID = 'DMD'
 13898*        IF CL-NO-OF-PMTS-MADE = +1
 13899*                OR
 13900*           PI-PMTTYPE = '2'
 13901*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 13902
 13903     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 13904
 13905*    IF PI-COMPANY-ID = 'DMD'
 13906*       IF CL-CERT-NO (5:2) = '69' OR '70'
 13907*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 13908
 13909
 13910* EXEC CICS REWRITE
 13911*         DATASET('ELMSTR')
 13912*         FROM(CLAIM-MASTER)
 13913*     END-EXEC.
 13914     MOVE LENGTH OF
 13915      CLAIM-MASTER
 13916       TO DFHEIV11
 13917     MOVE 'ELMSTR' TO DFHEIV1
 13918*    MOVE '&& L                  %   #00013123' TO DFHEIV0
 13919     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13920     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13921     MOVE X'2020233030303133313233' TO DFHEIV0(25:11)
 13922     CALL 'kxdfhei1' USING DFHEIV0,
 13923           DFHEIV1,
 13924           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 267
* EL156.cbl
 13925           DFHEIV11,
 13926           DFHEIV99
 13927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13928
 13929
 13930     IF WS-LETTER-SW = 'N'
 13931         GO TO 5000-END-UPDATE.
 13932
 13933 5000-GENERATE-AUTO-LETTER.
 13934
 13935
 13936* EXEC CICS LINK
 13937*        PROGRAM    (LINK-1523)
 13938*        COMMAREA   (W-1523-LINKDATA)
 13939*        LENGTH     (W-1523-COMM-LENGTH)
 13940*    END-EXEC.
 13941*    MOVE '."C                   (   #00013133' TO DFHEIV0
 13942     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13944     MOVE X'2020233030303133313333' TO DFHEIV0(25:11)
 13945     CALL 'kxdfhei1' USING DFHEIV0,
 13946           LINK-1523,
 13947           W-1523-LINKDATA,
 13948           W-1523-COMM-LENGTH,
 13949           DFHEIV99,
 13950           DFHEIV99,
 13951           DFHEIV99,
 13952           DFHEIV99
 13953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13954
 13955
 13956     IF W-1523-FATAL-ERROR
 13957         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 13958         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13959         MOVE ER-0802                TO  EMI-ERROR
 13960         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13961
 13962     IF W-1523-ERROR-CODE = 0191
 13963         MOVE ER-0803                TO  EMI-ERROR
 13964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13965
 13966     IF PI-COMPANY-ID      = 'HAN' AND
 13967        PI-PMTTYPE         = '1'   AND
 13968        PI-3RD-PARTY-SW    = 'Y'   AND
 13969        W-1523-FORM-NUMBER = 'EOB1'
 13970           MOVE LOW-VALUES              TO W-1523-LINKDATA
 13971           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 13972           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 13973           GO TO 5000-GENERATE-AUTO-LETTER.
 13974
 13975 5000-END-UPDATE.
 13976
 13977     MOVE ER-0000                TO EMI-ERROR.
 13978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13979     GO TO 7000-SHOW-CLAIM.
 13980
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 268
* EL156.cbl
 13982 5000-MOVE-NAME.
 13983     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13984     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13985     MOVE CL-INSURED-MID-INIT    TO MINITO.
 13986
 13987 5000-EXIT.
 13988     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 269
* EL156.cbl
 13990 5300-CREATE-DMO.
 13991
 13992     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 13993     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 13994     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 13995
 13996
 13997* EXEC CICS HANDLE CONDITION
 13998*         NOTFND   (5300-NOTE-NOT-FOUND)
 13999*    END-EXEC.
 14000*    MOVE '"$I                   ! . #00013179' TO DFHEIV0
 14001     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14002     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14003     MOVE X'2E20233030303133313739' TO DFHEIV0(25:11)
 14004     CALL 'kxdfhei1' USING DFHEIV0
 14005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14006
 14007
 14008
 14009* EXEC CICS READ
 14010*         DATASET('ERNOTE')
 14011*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14012*         RIDFLD (W-NOTE-KEY)
 14013*    END-EXEC.
 14014     MOVE 'ERNOTE' TO DFHEIV1
 14015*    MOVE '&"S        E          (   #00013183' TO DFHEIV0
 14016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14018     MOVE X'2020233030303133313833' TO DFHEIV0(25:11)
 14019     CALL 'kxdfhei1' USING DFHEIV0,
 14020           DFHEIV1,
 14021           DFHEIV20,
 14022           DFHEIV99,
 14023           W-NOTE-KEY,
 14024           DFHEIV99,
 14025           DFHEIV99,
 14026           DFHEIV99
 14027     SET ADDRESS OF CERTIFICATE-NOTE TO
 14028         DFHEIV20
 14029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14030
 14031
 14032     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14033     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14034     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14035
 14036     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14037         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14038     ELSE
 14039         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14040
 14041     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14042     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14043     MOVE 'DLO006'               TO PGM-NAME.
 14044
 14045
 14046* EXEC CICS LINK
 14047*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 270
* EL156.cbl
 14048*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14049*        LENGTH     (DCT-RCRD-LENGTH)
 14050*    END-EXEC.
 14051*    MOVE '."C                   (   #00013202' TO DFHEIV0
 14052     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14054     MOVE X'2020233030303133323032' TO DFHEIV0(25:11)
 14055     CALL 'kxdfhei1' USING DFHEIV0,
 14056           PGM-NAME,
 14057           DCT-COMMUNICATION-AREA,
 14058           DCT-RCRD-LENGTH,
 14059           DFHEIV99,
 14060           DFHEIV99,
 14061           DFHEIV99,
 14062           DFHEIV99
 14063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14064
 14065
 14066     IF DCT-RETURN-CODE = 'OK'
 14067         GO TO 5300-CONT.
 14068
 14069     IF DCT-RETURN-CODE = '01' OR '02'
 14070         GO TO 5300-EXIT.
 14071
 14072     IF DCT-RETURN-CODE = '03'
 14073         MOVE ER-0951            TO EMI-ERROR
 14074         GO TO 5300-BAD-EXIT.
 14075
 14076     IF DCT-RETURN-CODE = '04'
 14077         MOVE ER-0946            TO EMI-ERROR
 14078         GO TO 5300-BAD-EXIT.
 14079
 14080     IF DCT-RETURN-CODE = '05'
 14081         MOVE ER-0947            TO EMI-ERROR
 14082         GO TO 5300-BAD-EXIT.
 14083
 14084     IF DCT-RETURN-CODE = '06'
 14085         MOVE ER-0921            TO EMI-ERROR
 14086         GO TO 5300-BAD-EXIT.
 14087
 14088     IF DCT-RETURN-CODE = '07'
 14089         MOVE ER-0849            TO EMI-ERROR
 14090         GO TO 5300-BAD-EXIT.
 14091
 14092     IF DCT-RETURN-CODE = '08'
 14093         MOVE ER-0948            TO EMI-ERROR
 14094         GO TO 5300-BAD-EXIT.
 14095
 14096     IF DCT-RETURN-CODE = 'N1'
 14097         MOVE ER-0950            TO EMI-ERROR
 14098         GO TO 5300-BAD-EXIT.
 14099
 14100     IF DCT-RETURN-CODE = 'E1'
 14101         MOVE ER-0974            TO EMI-ERROR
 14102         GO TO 5300-BAD-EXIT.
 14103
 14104     IF DCT-RETURN-CODE = 'E2'
 14105         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 271
* EL156.cbl
 14106         GO TO 5300-BAD-EXIT.
 14107
 14108     IF DCT-RETURN-CODE NOT = 'OK'
 14109         MOVE ER-0949            TO EMI-ERROR
 14110         GO TO 5300-BAD-EXIT.
 14111
 14112 5300-CONT.
 14113
 14114     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14115     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14116     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14117     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14118     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14119     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14120     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14121     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14122
 14123     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14124     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14125     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14126     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14127     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14128
 14129     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14130
 14131     IF PI-PMTTYPE = '2'
 14132         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14133         MOVE '4'                TO DM-CLAIM-STATUS
 14134     ELSE
 14135         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14136         MOVE '2'                TO DM-CLAIM-STATUS.
 14137
 14138     MOVE 'DLO025'               TO PGM-NAME.
 14139
 14140
 14141* EXEC CICS LINK
 14142*        PROGRAM    (PGM-NAME)
 14143*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14144*        LENGTH     (DM-DMO-LENGTH)
 14145*    END-EXEC.
 14146*    MOVE '."C                   (   #00013282' TO DFHEIV0
 14147     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14148     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14149     MOVE X'2020233030303133323832' TO DFHEIV0(25:11)
 14150     CALL 'kxdfhei1' USING DFHEIV0,
 14151           PGM-NAME,
 14152           DMO-COMMUNICATION-AREA,
 14153           DM-DMO-LENGTH,
 14154           DFHEIV99,
 14155           DFHEIV99,
 14156           DFHEIV99,
 14157           DFHEIV99
 14158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14159
 14160
 14161     IF DM-RETURN-CODE = 'OK'
 14162         GO TO 5300-EXIT.
 14163
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 272
* EL156.cbl
 14164     IF DM-RETURN-CODE = '01'
 14165         MOVE ER-8051            TO EMI-ERROR
 14166         GO TO 5300-BAD-EXIT.
 14167
 14168     IF DM-RETURN-CODE = '02'
 14169         MOVE ER-8052            TO EMI-ERROR
 14170         GO TO 5300-BAD-EXIT.
 14171
 14172     IF DM-RETURN-CODE = '03'
 14173         MOVE ER-8053            TO EMI-ERROR
 14174         GO TO 5300-BAD-EXIT.
 14175
 14176     IF DM-RETURN-CODE = '04'
 14177         MOVE ER-8054            TO EMI-ERROR
 14178         GO TO 5300-BAD-EXIT.
 14179
 14180     IF DM-RETURN-CODE = '05'
 14181         MOVE ER-8055            TO EMI-ERROR
 14182         GO TO 5300-BAD-EXIT.
 14183
 14184     IF DM-RETURN-CODE = '06'
 14185         MOVE ER-8056            TO EMI-ERROR
 14186         GO TO 5300-BAD-EXIT.
 14187
 14188     IF DM-RETURN-CODE = '07'
 14189         MOVE ER-8057            TO EMI-ERROR
 14190         GO TO 5300-BAD-EXIT.
 14191
 14192     IF DM-RETURN-CODE = '08'
 14193         MOVE ER-8058            TO EMI-ERROR
 14194         GO TO 5300-BAD-EXIT.
 14195
 14196     IF DM-RETURN-CODE = '09'
 14197         MOVE ER-8059            TO EMI-ERROR
 14198         GO TO 5300-BAD-EXIT.
 14199
 14200     IF DM-RETURN-CODE = '10'
 14201         MOVE ER-8060            TO EMI-ERROR
 14202         GO TO 5300-BAD-EXIT.
 14203
 14204     IF DM-RETURN-CODE = '11'
 14205         MOVE ER-8061            TO EMI-ERROR
 14206         GO TO 5300-BAD-EXIT.
 14207
 14208     IF DM-RETURN-CODE = '12'
 14209         MOVE ER-8062            TO EMI-ERROR
 14210         GO TO 5300-BAD-EXIT.
 14211
 14212     IF DM-RETURN-CODE = '13'
 14213         MOVE ER-8063            TO EMI-ERROR
 14214         GO TO 5300-BAD-EXIT.
 14215
 14216     IF DM-RETURN-CODE = '14'
 14217         MOVE ER-8064            TO EMI-ERROR
 14218         GO TO 5300-BAD-EXIT.
 14219
 14220     IF DM-RETURN-CODE = '15'
 14221         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 273
* EL156.cbl
 14222         GO TO 5300-BAD-EXIT.
 14223
 14224     IF DM-RETURN-CODE = '16'
 14225         MOVE ER-8154            TO EMI-ERROR
 14226         GO TO 5300-BAD-EXIT.
 14227
 14228     IF DM-RETURN-CODE = '17'
 14229         MOVE ER-8155            TO EMI-ERROR
 14230         GO TO 5300-BAD-EXIT.
 14231
 14232     IF DM-RETURN-CODE = 'N1'
 14233         MOVE ER-8152            TO EMI-ERROR
 14234         GO TO 5300-BAD-EXIT.
 14235
 14236     IF DM-RETURN-CODE = 'E1'
 14237         MOVE ER-8153            TO EMI-ERROR
 14238         GO TO 5300-BAD-EXIT.
 14239
 14240     MOVE ER-8066            TO EMI-ERROR.
 14241     GO TO 5300-BAD-EXIT.
 14242
 14243 5300-NOTE-NOT-FOUND.
 14244
 14245     MOVE ER-0954                TO EMI-ERROR.
 14246     GO TO 5300-BAD-EXIT.
 14247
 14248 5300-BAD-EXIT.
 14249
 14250* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14251*    MOVE '6"R                   !   #00013376' TO DFHEIV0
 14252     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14254     MOVE X'2020233030303133333736' TO DFHEIV0(25:11)
 14255     CALL 'kxdfhei1' USING DFHEIV0
 14256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14257
 14258     IF MAP-NAME = 'EL156A'
 14259         MOVE -1             TO ENTERPFL
 14260       ELSE
 14261         MOVE LOW-VALUES     TO EL156BI
 14262         MOVE -1             TO ENTPFBL.
 14263
 14264     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14265     GO TO 8200-SEND-DATAONLY.
 14266
 14267 5300-EXIT.
 14268     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 274
* EL156.cbl
 14270 5350-FORMAT-LAST-NAME-1ST.
 14271*****************************************************************
 14272*             M O V E   N A M E   R O U T I N E                 *
 14273*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14274*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14275*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14276*                  FIELD                   VALUE                *
 14277*           W-NAME-LAST    (CL15)      SMITH                    *
 14278*           W-NAME-FIRST   (CL15)      JOHN                     *
 14279*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14280*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14281*     CONTAIN                                                   *
 14282*                SMITH, JOHN ALLEN                              *
 14283*     OR                                                        *
 14284*                SMITH, JOHN A.                                 *
 14285*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14286*     COPYBOOK, ELCNWA.                                         *
 14287*****************************************************************.
 14288
 14289     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14290     MOVE ZERO                   TO  WS-NAME-SW.
 14291     SET NWA-INDEX               TO +1.
 14292
 14293     IF W-NAME-LAST   = SPACES AND
 14294        W-NAME-MIDDLE = SPACES
 14295         MOVE +1                 TO WS-NAME-SW.
 14296
 14297     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14298     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14299
 14300     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14301     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14302
 14303     SET NWA-INDEX UP BY +1.
 14304
 14305     IF W-NAME-MIDDLE NOT = SPACES
 14306         IF W-NAME-MIDDLE-2 = SPACES
 14307             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14308             SET NWA-INDEX UP BY +1
 14309             MOVE '.'            TO WS-NW (NWA-INDEX)
 14310             SET NWA-INDEX UP BY +2
 14311         ELSE
 14312             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14313             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14314
 14315 5350-EXIT.
 14316     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 275
* EL156.cbl
 14318 5360-MOVE-NAME.
 14319
 14320     IF WS-NAME-SW > +1
 14321         GO TO 5360-EXIT.
 14322
 14323     IF WS-NAME-WORK2 = SPACES
 14324         GO TO 5360-EXIT.
 14325
 14326     SET NWA-INDEX2            TO +1.
 14327     SET NWA-INDEX3            TO +2.
 14328
 14329 5360-MOVE-NAME-CYCLE.
 14330
 14331     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14332
 14333     IF NWA-INDEX < +30
 14334         SET NWA-INDEX UP BY +1
 14335     ELSE
 14336         ADD +2                TO  WS-NAME-SW
 14337         GO TO 5360-EXIT.
 14338
 14339     IF NWA-INDEX2 < +20
 14340         SET NWA-INDEX3 UP BY +1
 14341         SET NWA-INDEX2 UP BY +1.
 14342
 14343     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14344        WS-NW2 (NWA-INDEX3) = SPACES
 14345         IF WS-NAME-SW = ZERO
 14346             MOVE ','            TO  WS-NW (NWA-INDEX)
 14347             SET NWA-INDEX UP BY +2
 14348             MOVE +1             TO  WS-NAME-SW
 14349             GO TO 5360-EXIT
 14350         ELSE
 14351             GO TO 5360-EXIT.
 14352
 14353     GO TO 5360-MOVE-NAME-CYCLE.
 14354
 14355 5360-EXIT.
 14356     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 276
* EL156.cbl
 14358 6000-BUILD-SCREEN-B.
 14359     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14360     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14361     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14362     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14363
 14364     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14365
 14366 6050-BUILD-SCREEN.
 14367     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14368     MOVE LOW-VALUES             TO EL156BI.
 14369     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14370
 14371     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14372
 14373     IF PI-PAYEE-TYPE = 'I'
 14374        GO TO 6060-READ-TRAILER.
 14375
 14376     IF PI-PAYEE-TYPE = 'B'
 14377        ADD +10                  TO TRLR-SEQ-NO
 14378        GO TO 6060-READ-TRAILER.
 14379
 14380     IF PI-PAYEE-TYPE = 'A'
 14381        ADD +20                  TO TRLR-SEQ-NO
 14382        GO TO 6060-READ-TRAILER.
 14383
 14384     IF PI-PAYEE-TYPE = 'O'
 14385        ADD +50                  TO TRLR-SEQ-NO
 14386        GO TO 6060-READ-TRAILER.
 14387
 14388     IF PI-PAYEE-TYPE = 'Q'
 14389        ADD +60                  TO TRLR-SEQ-NO
 14390        GO TO 6060-READ-TRAILER.
 14391
 14392     IF PI-PAYEE-TYPE = 'P'
 14393        ADD +30                  TO TRLR-SEQ-NO
 14394        GO TO 6060-READ-TRAILER.
 14395
 14396     IF PI-PAYEE-TYPE = 'E'
 14397        ADD +40                  TO TRLR-SEQ-NO.
 14398
 14399 6060-READ-TRAILER.
 14400
 14401     IF PI-PAYEE-TYPE    = 'A' AND
 14402        PI-PAYEE-SEQ-NUM = 0
 14403          GO TO 6061-READ-ACCOUNT.
 14404
 14405     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14406        (PI-PAYEE-TYPE    = 'B')             AND
 14407        (PI-PAYEE-SEQ-NUM = 9)
 14408          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14409          IF BENE-FOUND-SW = 'N'
 14410            GO TO 6065-NOT-FOUND
 14411          ELSE
 14412            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14413            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14414            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14415*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 277
* EL156.cbl
 14416            STRING BE-CITY ' ' BE-STATE
 14417               DELIMITED BY '  ' INTO CITYSTBO
 14418            END-STRING
 14419            MOVE BE-ZIP-CODE       TO ZIPBO
 14420            GO TO 6061-READ-ACCOUNT.
 14421
 14422     IF PI-PAYEE-TYPE    = 'B' AND
 14423        PI-PAYEE-SEQ-NUM = 0
 14424          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14425          IF BENE-FOUND-SW = 'N'
 14426            GO TO 6065-NOT-FOUND
 14427          ELSE
 14428            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14429            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14430            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14431*           MOVE BE-CITY-STATE     TO CITYSTBO
 14432            STRING BE-CITY ' ' BE-STATE
 14433               DELIMITED BY '  ' INTO CITYSTBO
 14434            END-STRING
 14435            MOVE BE-ZIP-CODE       TO ZIPBO
 14436            GO TO 6061-READ-ACCOUNT.
 14437
 14438
 14439* EXEC CICS HANDLE CONDITION
 14440*         NOTFND(6065-NOT-FOUND)
 14441*     END-EXEC.
 14442*    MOVE '"$I                   ! / #00013557' TO DFHEIV0
 14443     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14445     MOVE X'2F20233030303133353537' TO DFHEIV0(25:11)
 14446     CALL 'kxdfhei1' USING DFHEIV0
 14447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14448
 14449
 14450     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14451
 14452     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14453     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14454     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14455     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14456*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14457     STRING AT-CITY ' ' AT-STATE
 14458        DELIMITED BY '  ' INTO CITYSTBO
 14459     END-STRING
 14460     MOVE AT-ZIP-CODE            TO ZIPBO.
 14461
 14462 6061-READ-ACCOUNT.
 14463
 14464* EXEC CICS HANDLE CONDITION
 14465*         NOTFND(6068-ACCT-NOT-FND)
 14466*     END-EXEC.
 14467*    MOVE '"$I                   ! 0 #00013574' TO DFHEIV0
 14468     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14470     MOVE X'3020233030303133353734' TO DFHEIV0(25:11)
 14471     CALL 'kxdfhei1' USING DFHEIV0
 14472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14473
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 278
* EL156.cbl
 14474
 14475
 14476* EXEC CICS READ
 14477*         DATASET('ERACCT')
 14478*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14479*         RIDFLD (PI-ACCT-KEY)
 14480*     END-EXEC.
 14481     MOVE 'ERACCT' TO DFHEIV1
 14482*    MOVE '&"S        E          (   #00013578' TO DFHEIV0
 14483     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14485     MOVE X'2020233030303133353738' TO DFHEIV0(25:11)
 14486     CALL 'kxdfhei1' USING DFHEIV0,
 14487           DFHEIV1,
 14488           DFHEIV20,
 14489           DFHEIV99,
 14490           PI-ACCT-KEY,
 14491           DFHEIV99,
 14492           DFHEIV99,
 14493           DFHEIV99
 14494     SET ADDRESS OF ACCOUNT-MASTER TO
 14495         DFHEIV20
 14496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14497
 14498
 14499     MOVE AM-CARRIER             TO ACARRBO.
 14500     MOVE AM-GROUPING            TO GROUPBO.
 14501     MOVE AM-STATE               TO STATEBO.
 14502     MOVE AM-ACCOUNT             TO ACCTBO.
 14503     MOVE AM-NAME                TO ACCTNMBO.
 14504
 14505     IF PI-PAYEE-TYPE = 'A' AND
 14506        PI-PAYEE-SEQ-NUM = 0
 14507          MOVE AM-NAME             TO NAMEBO
 14508                                      PI-PAYEE-NAME
 14509          MOVE AM-ADDRS            TO ADDR1BO
 14510          MOVE SPACES              TO ADDR2BO
 14511*         MOVE AM-CITY             TO CITYSTBO
 14512          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14513             DELIMITED BY '  ' INTO CITYSTBO
 14514          END-STRING
 14515          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14516          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14517          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14518          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14519
 14520     IF CITYSTBO EQUAL SPACES
 14521         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14522         GO TO 6070-FORMAT-DATA
 14523     END-IF.
 14524
 14525     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14526     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14527     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14528     PERFORM VARYING WS-SUB FROM 30 BY -1
 14529          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14530        IF WS-END-SUB = 0  AND
 14531           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES OR '.')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 279
* EL156.cbl
 14532            CONTINUE
 14533        ELSE
 14534            IF WS-END-SUB = 0
 14535                MOVE WS-SUB TO WS-END-SUB
 14536            ELSE
 14537                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14538                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14539                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14540                END-IF
 14541            END-IF
 14542        END-IF
 14543        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14544            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14545            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14546        END-IF
 14547     END-PERFORM.
 14548
 14549     IF WS-BEG-SUB > 0
 14550         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14551         IF WS-STATE-LENGTH = 2
 14552             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14553                  TO PI-CHECK-STATE-FOR-AK
 14554         ELSE
 14555             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14556                'ALASKA'
 14557                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14558             ELSE
 14559                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14560             END-IF
 14561         END-IF
 14562     ELSE
 14563         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14564     END-IF.
 14565
 14566     GO TO 6070-FORMAT-DATA.
 14567
 14568 6065-NOT-FOUND.
 14569     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14570     GO TO 6061-READ-ACCOUNT.
 14571
 14572 6068-ACCT-NOT-FND.
 14573     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14574
 14575 6070-FORMAT-DATA.
 14576     IF PI-HOLDTIL = ZEROS
 14577        MOVE SAVE-DATE           TO PAYDTBI
 14578       ELSE
 14579        MOVE PI-HOLDTIL          TO PAYDTBO
 14580        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14581
 14582     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14583     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14584
 14585     IF EIBAID = DFHPF3 OR DFHPF4
 14586        NEXT SENTENCE
 14587     ELSE
 14588       GO TO 6071-CONTINUE.
 14589
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 280
* EL156.cbl
 14590     MOVE PI-EPYFROM          TO PYFROMBO.
 14591     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14592
 14593     IF NOT PI-USES-PAID-TO
 14594        MOVE PI-EPYTHRU          TO PYTHRUBO
 14595        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14596     ELSE
 14597        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14598        MOVE '4'              TO DC-OPTION-CODE
 14599        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14600        IF NO-CONVERSION-ERROR
 14601           MOVE +1            TO DC-ELAPSED-DAYS
 14602           MOVE +0            TO DC-ELAPSED-MONTHS
 14603           MOVE '6'           TO DC-OPTION-CODE
 14604           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14605           IF NO-CONVERSION-ERROR
 14606              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14607
 14608     MOVE PI-EDAYS            TO DAYSBO.
 14609     MOVE PI-EPYAMT           TO PAYAMTBO.
 14610     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14611        IF PI-INT-AMT > ZEROS
 14612           MOVE PI-INT-AMT       TO INTAMTBO
 14613        END-IF
 14614     END-IF
 14615     GO TO 6072-SET-TYPE.
 14616
 14617 6071-CONTINUE.
 14618
 14619     IF PI-CPYFROM NOT = LOW-VALUES
 14620        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14621        MOVE SPACES              TO DC-OPTION-CODE
 14622        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14623        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14624
 14625     IF PI-CPYTHRU NOT = LOW-VALUES
 14626        IF NOT PI-USES-PAID-TO
 14627           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14628           MOVE SPACES             TO DC-OPTION-CODE
 14629           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14630           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14631        ELSE
 14632           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14633           MOVE '6'                TO DC-OPTION-CODE
 14634           MOVE +1                 TO DC-ELAPSED-DAYS
 14635           MOVE +0                 TO DC-ELAPSED-MONTHS
 14636           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14637           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14638
 14639     MOVE PI-CDAYS               TO DAYSBO.
 14640     MOVE PI-CPYAMT              TO PAYAMTBO.
 14641     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14642        IF PI-INT-AMT > ZEROS
 14643           MOVE PI-INT-AMT       TO INTAMTBO
 14644        END-IF
 14645     END-IF
 14646     .
 14647 6072-SET-TYPE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 281
* EL156.cbl
 14648     IF PI-PMTTYPE = '1'
 14649        MOVE 'PARTIAL'           TO PAYTYPBO.
 14650
 14651     IF PI-PMTTYPE = '2'
 14652        MOVE 'FINAL'             TO PAYTYPBO.
 14653
 14654     IF PI-PMTTYPE = '3'
 14655        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14656
 14657     IF PI-PMTTYPE = '4'
 14658        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14659
 14660     IF PI-PMTTYPE = '5'
 14661        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14662
 14663     IF PI-PMTTYPE = '6'
 14664        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14665
 14666     IF PI-PROV-PMT
 14667        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14668
 14669     IF PI-ECHECKNO NOT = SPACES
 14670        MOVE PI-ECHECKNO         TO CKNUMBO
 14671     ELSE
 14672        MOVE PI-CCHECKNO         TO CKNUMBO.
 14673
 14674     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14675        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14676        MOVE +91                 TO  TRLR-SEQ-NO
 14677
 14678* EXEC CICS READ
 14679*           DATASET  ('ELTRLR')
 14680*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14681*           RIDFLD   (ELTRLR-KEY)
 14682*           RESP     (WS-RESPONSE)
 14683*       END-EXEC
 14684     MOVE 'ELTRLR' TO DFHEIV1
 14685*    MOVE '&"S        E          (  N#00013762' TO DFHEIV0
 14686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14688     MOVE X'204E233030303133373632' TO DFHEIV0(25:11)
 14689     CALL 'kxdfhei1' USING DFHEIV0,
 14690           DFHEIV1,
 14691           DFHEIV20,
 14692           DFHEIV99,
 14693           ELTRLR-KEY,
 14694           DFHEIV99,
 14695           DFHEIV99,
 14696           DFHEIV99
 14697     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14698         DFHEIV20
 14699     MOVE EIBRESP  TO WS-RESPONSE
 14700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14701
 14702        IF WS-RESP-NORMAL
 14703           MOVE AT-INFO-LINE-1   TO  LOANNBO
 14704        ELSE
 14705           MOVE SPACES           TO  LOANNBO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 282
* EL156.cbl
 14706        END-IF
 14707     END-IF
 14708
 14709*       MOVE PI-LOAN-NO          TO LOANNBO
 14710
 14711     IF CKNUMBO = SPACES
 14712         MOVE SPACES             TO CKNUMHDO.
 14713
 14714     MOVE CL-CLAIM-NO            TO CLMNOBO.
 14715     MOVE CL-CARRIER             TO CARRBO.
 14716     MOVE CL-CERT-PRIME          TO CERTNOBO.
 14717     MOVE CL-CERT-SFX            TO SUFXBO.
 14718
 14719     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14720        EVALUATE CL-CLAIM-TYPE
 14721           WHEN 'I'
 14722              MOVE '  IU  '      TO CLMTYPBO
 14723           WHEN 'G'
 14724              MOVE ' GAP  '      TO CLMTYPBO
 14725           WHEN OTHER
 14726              MOVE PI-AH-OVERRIDE-L6
 14727                                 TO CLMTYPBO
 14728        END-EVALUATE
 14729        MOVE ZEROS               TO UNDISBO
 14730*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 14731        IF PI-PMTTYPE = '5' OR '6'
 14732           GO TO 6073-GET-NOTIFY-DATA
 14733        ELSE
 14734           MOVE PI-DAILY-RATE    TO RATEBO
 14735           GO TO 6073-GET-NOTIFY-DATA.
 14736
 14737     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 14738
 14739     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 14740        MOVE ZEROS               TO UNDISBO
 14741     ELSE
 14742        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 14743
 14744 6073-GET-NOTIFY-DATA.
 14745
 14746     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 14747
 14748     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 14749         MOVE SPACES             TO  NAMEB2O
 14750                                     ADDR1B2O
 14751                                     ADDR2B2O
 14752                                     CITYST2O
 14753                                     AGTHDGO
 14754         MOVE ZEROS              TO  ZIPB2O
 14755         GO TO 6080-SET-INCURRED.
 14756
 14757     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 14758     MOVE +29                    TO  TRLR-SEQ-NO.
 14759
 14760
 14761* EXEC CICS HANDLE CONDITION
 14762*        NOTFND   (6074-GET-COMP-DATA)
 14763*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 283
* EL156.cbl
 14764*    MOVE '"$I                   ! 1 #00013827' TO DFHEIV0
 14765     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14767     MOVE X'3120233030303133383237' TO DFHEIV0(25:11)
 14768     CALL 'kxdfhei1' USING DFHEIV0
 14769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14770
 14771
 14772     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14773
 14774     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 14775     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 14776     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 14777*    MOVE AT-CITY-STATE          TO  CITYST2O.
 14778     STRING AT-CITY ' ' AT-STATE
 14779        DELIMITED BY '  ' INTO CITYST2O
 14780     END-STRING
 14781     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 14782     GO TO 6080-SET-INCURRED.
 14783
 14784 6074-GET-COMP-DATA.
 14785
 14786     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 14787         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 14788
 14789     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 14790         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 14791                                         ADDR1B2O
 14792                                         ADDR2B2O
 14793                                         CITYST2O
 14794         MOVE ZEROS                  TO  ZIPB2O
 14795         GO TO 6080-SET-INCURRED.
 14796
 14797     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 14798     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 14799     MOVE AM-CARRIER             TO  COMP-CARRIER.
 14800     MOVE AM-GROUPING            TO  COMP-GROUP.
 14801     MOVE 'A'                    TO  COMP-TYPE.
 14802     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14803                                 TO  COMP-FIN-RESP.
 14804
 14805     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 14806         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 14807                                       'G' OR 'B'
 14808             MOVE 'G'            TO  COMP-TYPE
 14809             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 14810         ELSE
 14811             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14812                                 TO  COMP-ACCOUNT
 14813     ELSE
 14814         MOVE 'G'                TO  COMP-TYPE
 14815         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 14816
 14817     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 14818
 14819     IF COMP-REC-FOUND
 14820         MOVE CO-ACCT-NAME       TO  NAMEB2O
 14821         MOVE CO-ADDR-1          TO  ADDR1B2O
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 284
* EL156.cbl
 14822         MOVE CO-ADDR-2          TO  ADDR2B2O
 14823*        MOVE CO-ADDR-3          TO  CITYST2O
 14824         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14825            DELIMITED BY '  ' INTO CITYST2O
 14826         END-STRING
 14827         MOVE CO-ZIP             TO  ZIPB2O
 14828     ELSE
 14829         MOVE 'NO COMP ADDRESS AVAILABLE'
 14830                                 TO  NAMEB2O
 14831                                     ADDR1B2O
 14832                                     ADDR2B2O
 14833                                     CITYST2O
 14834         MOVE ZEROS               TO ZIPB2O.
 14835
 14836 6080-SET-INCURRED.
 14837     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14838     MOVE SPACES                 TO DC-OPTION-CODE.
 14839     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14840     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 14841     MOVE PI-PROCESSOR-ID        TO BYBO.
 14842     MOVE MAP-NAMEB              TO MAP-NAME.
 14843     MOVE 'C'                    TO PI-PASS-SW.
 14844     MOVE EIBAID                 TO PI-PFKEY-USED.
 14845     MOVE -1                     TO ENTPFBL.
 14846     GO TO 8100-SEND-INITIAL-MAP.
 14847
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 285
* EL156.cbl
 14849 6100-BUILD-PAYMENT-TRAILER.
 14850
 14851     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 14852       (PI-COMPANY-ID = 'CID' OR 'AHL')
 14853         GO TO 6105-STATE-CHECK-NUMBER
 14854     END-IF.
 14855
 14856     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14857     MOVE '6'                    TO CNTL-REC-TYPE.
 14858
 14859     IF CONTROL-IS-ACTUAL-CARRIER
 14860         MOVE PI-CARRIER         TO WS-CARR
 14861     ELSE
 14862         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 14863
 14864     IF PI-COMPANY-ID = 'FIA'
 14865         MOVE PI-CARRIER         TO  WS-CARR.
 14866
 14867     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 14868     MOVE 0                      TO CNTL-SEQ-NO.
 14869     MOVE 'CARR'                 TO FILE-SWITCH.
 14870
 14871     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14872
 14873     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14874         IF PI-OFFLINE     = 'Y' AND
 14875            PI-ECHECKNO-CR = 'CR'
 14876              GO TO 6110-READ-CONTROL
 14877         ELSE
 14878            IF PI-CASH = 'N'
 14879                GO TO 6110-READ-CONTROL.
 14880
 14881     IF CHECK-NO-MANUAL    OR
 14882        CHECK-NO-AT-PRINT  OR
 14883        PI-OFFLINE = 'Y'
 14884          GO TO 6130-BUILD-TRAILER.
 14885
 14886     IF PI-COMPANY-ID = 'FIA'
 14887         NEXT SENTENCE
 14888     ELSE
 14889         IF NOT CONTROL-IS-ACTUAL-CARRIER
 14890             GO TO 6110-READ-CONTROL.
 14891
 14892     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14893
 14894     IF CHECK-CNT-RESET-VALUE
 14895        MOVE +1                  TO CF-CHECK-COUNTER
 14896     ELSE
 14897        ADD +1                   TO CF-CHECK-COUNTER.
 14898
 14899     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 14900
 14901     IF CHECK-NO-CARR-SEQ
 14902        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 14903
 14904     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 14905
 14906     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 286
* EL156.cbl
 14907     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 14908        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 14909         MOVE 'Y' TO PI-REAUDIT-NEEDED
 14910         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 14911            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 14912         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 14913                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 14914     END-IF.
 14915
 14916     GO TO 6120-REWRITE.
 14917
 14918 6105-STATE-CHECK-NUMBER.
 14919     IF CHECK-NO-MANUAL    OR
 14920        CHECK-NO-AT-PRINT  OR
 14921        PI-OFFLINE = 'Y'
 14922           GO TO 6130-BUILD-TRAILER
 14923     END-IF.
 14924
 14925     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 14926     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 14927     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 14928     MOVE '3'                TO CNTL-REC-TYPE.
 14929     MOVE +0                 TO CNTL-SEQ-NO.
 14930     MOVE 'STAT'             TO FILE-SWITCH.
 14931     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14932
 14933     IF CF-ST-CHECK-CNT-RESET
 14934         MOVE +1             TO CF-ST-CHECK-COUNTER
 14935     ELSE
 14936         ADD +1              TO CF-ST-CHECK-COUNTER
 14937     END-IF.
 14938
 14939     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 14940     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 14941     GO TO 6120-REWRITE.
 14942
 14943 6110-READ-CONTROL.
 14944     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14945     MOVE '1'                    TO CNTL-REC-TYPE.
 14946     MOVE SPACES                 TO CNTL-ACCESS.
 14947     MOVE 0                      TO CNTL-SEQ-NO.
 14948
 14949     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14950
 14951     IF CO-CHECK-COUNT-RESET
 14952        MOVE +1                  TO CF-CO-CHECK-COUNTER
 14953     ELSE
 14954        ADD +1                   TO CF-CO-CHECK-COUNTER.
 14955
 14956     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 14957
 14958     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14959         IF PI-OFFLINE     = 'Y'  AND
 14960            PI-ECHECKNO-CR = 'CR'
 14961              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 14962              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14963              MOVE AL-UANON           TO CHECKNOA
 14964              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 287
* EL156.cbl
 14965         ELSE
 14966         IF PI-CASH = 'N'
 14967             MOVE 'N'                TO PI-ECHECKNO-N
 14968             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 14969             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14970             MOVE AL-UANON           TO CHECKNOA
 14971             GO TO 6120-REWRITE.
 14972
 14973     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 14974
 14975 6120-REWRITE.
 14976
 14977* EXEC CICS REWRITE
 14978*         DATASET('ELCNTL')
 14979*         FROM(CONTROL-FILE)
 14980*     END-EXEC.
 14981     MOVE LENGTH OF
 14982      CONTROL-FILE
 14983       TO DFHEIV11
 14984     MOVE 'ELCNTL' TO DFHEIV1
 14985*    MOVE '&& L                  %   #00014035' TO DFHEIV0
 14986     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14987     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14988     MOVE X'2020233030303134303335' TO DFHEIV0(25:11)
 14989     CALL 'kxdfhei1' USING DFHEIV0,
 14990           DFHEIV1,
 14991           CONTROL-FILE,
 14992           DFHEIV11,
 14993           DFHEIV99
 14994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14995
 14996
 14997     MOVE 'Y'                    TO PI-CK-ASSIGN.
 14998
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 288
* EL156.cbl
 15000 6130-BUILD-TRAILER.
 15001
 15002
 15003* EXEC CICS GETMAIN
 15004*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15005*         LENGTH    (200)
 15006*         INITIMG   (GETMAIN-SPACE)
 15007*     END-EXEC.
 15008     MOVE 200
 15009       TO DFHEIV11
 15010*    MOVE ',"IL                  $   #00014045' TO DFHEIV0
 15011     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15012     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15013     MOVE X'2020233030303134303435' TO DFHEIV0(25:11)
 15014     CALL 'kxdfhei1' USING DFHEIV0,
 15015           DFHEIV20,
 15016           DFHEIV11,
 15017           GETMAIN-SPACE
 15018     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15019         DFHEIV20
 15020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15021
 15022
 15023     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15024                                    AT-PREV-PAID-THRU-DT.
 15025     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15026     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15027     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15028     MOVE 'AT'                   TO AT-RECORD-ID.
 15029     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15030
 15031     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15032        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15033           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15034     ELSE
 15035           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15036           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15037
 15038     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15039         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15040             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15041             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15042           ELSE
 15043             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15044             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15045
 15046     MOVE '2'                    TO AT-TRAILER-TYPE.
 15047     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15048                                    AT-PAYMENT-LAST-MAINT-DT.
 15049     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15050                                    AT-PAYMENT-LAST-UPDATED-BY.
 15051     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15052     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15053     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15054     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15055
 15056     IF PI-PMT-APPROVED
 15057        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 289
* EL156.cbl
 15058           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15059
 15060     IF PI-PFKEY-USED = DFHPF5
 15061        GO TO 6140-PF5-ENTERED.
 15062
 15063     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15064     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15065
 15066     IF PI-AIG-SPECIAL-BENEFIT
 15067         IF WS-1ST-SPECIAL-PMT
 15068             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15069             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15070                                        AT-AMOUNT-PAID
 15071         ELSE
 15072             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15073
 15074     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15075
 15076     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15077     MOVE '4'                    TO DC-OPTION-CODE.
 15078     PERFORM 9700-LINK-DATE-CONVERT.
 15079
 15080     IF DATE-CONVERSION-ERROR
 15081        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15082     ELSE
 15083        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15084
 15085     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15086     MOVE '4'                    TO DC-OPTION-CODE.
 15087     PERFORM 9700-LINK-DATE-CONVERT.
 15088
 15089     IF DATE-CONVERSION-ERROR
 15090        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15091     ELSE
 15092        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15093
 15094     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15095     GO TO 6150-FINISH-MOVE.
 15096
 15097 6140-PF5-ENTERED.
 15098     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15099     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15100
 15101     IF PI-AIG-SPECIAL-BENEFIT
 15102         IF WS-1ST-SPECIAL-PMT
 15103             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15104             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15105                                        AT-AMOUNT-PAID
 15106         ELSE
 15107             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15108
 15109     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15110     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15111     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15112
 15113 6150-FINISH-MOVE.
 15114
 15115     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 290
* EL156.cbl
 15116         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15117     ELSE
 15118         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15119
 15120     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15121     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15122
 15123*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15124*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15125
 15126     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15127         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15128
 15129     IF PI-OFFLINE = 'N'
 15130        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15131        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15132     ELSE
 15133        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15134        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15135
 15136     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15137
 15138     IF WS-2ND-SPECIAL-PMT
 15139         MOVE 'Y'                TO AT-CASH-PAYMENT
 15140         MOVE SPACES             TO AT-CHECK-NO
 15141         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15142         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15143         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15144         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15145
 15146     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15147                                    AT-TO-BE-WRITTEN-DT.
 15148
 15149     IF PI-HOLDTIL NOT = ZEROS
 15150        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15151        MOVE '4'                 TO DC-OPTION-CODE
 15152        PERFORM 9700-LINK-DATE-CONVERT
 15153        IF PI-OFFLINE = 'N'
 15154           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15155        ELSE
 15156           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15157
 15158     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15159     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15160                                    AT-CHECK-QUE-SEQUENCE.
 15161
 15162     IF PI-PFKEY-USED = DFHPF4
 15163        MOVE '1'                 TO AT-FORCE-CONTROL.
 15164
 15165     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15166        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15167        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15168        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15169
 15170     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15171                                    AT-VOID-SELECT-DT
 15172                                    AT-VOID-ACCEPT-DT
 15173                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 291
* EL156.cbl
 15174     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15175        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15176        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15177        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15178        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15179     ELSE
 15180        MOVE ZEROS               TO AT-DAILY-RATE
 15181                                    AT-ELIMINATION-DAYS
 15182        MOVE SPACES              TO AT-BENEFIT-TYPE
 15183     END-IF
 15184     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15185     MOVE '4'                    TO DC-OPTION-CODE.
 15186     PERFORM 9700-LINK-DATE-CONVERT.
 15187     IF DATE-CONVERSION-ERROR
 15188         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15189     ELSE
 15190         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15191     END-IF.
 15192     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15193     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15194     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15195     IF PI-REAUDIT-NEEDED = 'Y'
 15196         MOVE '5' TO AT-APPROVAL-LEVEL-REQD
 15197         MOVE 'Y' TO WS-NEED-APPROVAL
 15198         GO TO 6170-WRITE
 15199     END-IF.
 15200*******************************************************
 15201     IF NOT PI-PMT-GRADUATED
 15202         GO TO 6170-WRITE.
 15203
 15204     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15205     MOVE '1'                    TO CNTL-REC-TYPE.
 15206     MOVE SPACES                 TO CNTL-ACCESS.
 15207     MOVE +0                     TO CNTL-SEQ-NO.
 15208     MOVE 'COMP'                 TO FILE-SWITCH.
 15209
 15210     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15211
 15212     IF PAID-FOR-LIFE
 15213         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15214             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15215                                     WS-PMT-APPROVAL-SW
 15216             GO TO 6170-WRITE.
 15217
 15218*05999      IF PAID-FOR-AH
 15219     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15220         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15221             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15222                                     WS-PMT-APPROVAL-SW
 15223             GO TO 6170-WRITE.
 15224
 15225     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15226
 15227******A&H Limits are set as a monthly payment.  Calculate the mont
 15228******equivalent of the amount paid today
 15229     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15230        PI-SAVE-ODD-DAYS-OVER > 0
 15231           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 292
* EL156.cbl
 15232                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15233           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15234                                  WS-CALC-PMT-MONTHS
 15235     ELSE
 15236           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15237     END-IF.
 15238*06007      IF ((PAID-FOR-AH) AND
 15239     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15240*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15241        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15242              OR
 15243        ((PAID-FOR-LIFE) AND
 15244        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15245            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15246       ELSE
 15247*06014      IF ((PAID-FOR-AH)  AND
 15248         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15249*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15250           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15251              OR
 15252        ((PAID-FOR-LIFE) AND
 15253        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15254            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15255         ELSE
 15256*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15257           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15258               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15259              OR
 15260          ((PAID-FOR-LIFE) AND
 15261          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15262            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15263       ELSE
 15264           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15265               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15266              OR
 15267          ((PAID-FOR-LIFE) AND
 15268          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15269            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15270       ELSE
 15271            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15272
 15273     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15274        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15275        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15276            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15277        END-IF
 15278     ELSE
 15279     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15280        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15281        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15282            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15283        END-IF
 15284     ELSE
 15285     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15286        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15287        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15288            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15289        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 293
* EL156.cbl
 15290     ELSE
 15291     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15292        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15293        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15294            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15295        END-IF
 15296     ELSE
 15297     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15298            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15299
 15300     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15301
 15302     IF NOT PI-PMT-GRADUATED
 15303         GO TO 6170-WRITE.
 15304
 15305
 15306* EXEC CICS HANDLE CONDITION
 15307*        NOTFND   (6170-WRITE)
 15308*    END-EXEC.
 15309*    MOVE '"$I                   ! 2 #00014333' TO DFHEIV0
 15310     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15312     MOVE X'3220233030303134333333' TO DFHEIV0(25:11)
 15313     CALL 'kxdfhei1' USING DFHEIV0
 15314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15315
 15316
 15317     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15318     MOVE '2'                    TO CNTL-REC-TYPE.
 15319     MOVE +0                     TO CNTL-SEQ-NO.
 15320     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15321
 15322
 15323* EXEC CICS READ
 15324*         DATASET  ('ELCNTL')
 15325*         SET      (ADDRESS OF CONTROL-FILE)
 15326*         RIDFLD   (ELCNTL-KEY)
 15327*    END-EXEC.
 15328     MOVE 'ELCNTL' TO DFHEIV1
 15329*    MOVE '&"S        E          (   #00014342' TO DFHEIV0
 15330     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15332     MOVE X'2020233030303134333432' TO DFHEIV0(25:11)
 15333     CALL 'kxdfhei1' USING DFHEIV0,
 15334           DFHEIV1,
 15335           DFHEIV20,
 15336           DFHEIV99,
 15337           ELCNTL-KEY,
 15338           DFHEIV99,
 15339           DFHEIV99,
 15340           DFHEIV99
 15341     SET ADDRESS OF CONTROL-FILE TO
 15342         DFHEIV20
 15343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15344
 15345
 15346     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15347
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 294
* EL156.cbl
 15348     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15349                         OR '4' OR '5'
 15350         NEXT SENTENCE
 15351     ELSE
 15352         MOVE 'Y' TO WS-NEED-APPROVAL
 15353         GO TO 6170-WRITE.
 15354
 15355     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15356         MOVE 'Y' TO WS-NEED-APPROVAL
 15357         IF WS-APPROVAL-LEVEL = '1'
 15358             MOVE '2'        TO  AT-APPROVED-LEVEL
 15359                            WS-SAVE-APPROVED-LEVEL
 15360             GO TO 6170-WRITE
 15361         ELSE
 15362             IF WS-APPROVAL-LEVEL = '2'
 15363                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15364                                WS-SAVE-APPROVED-LEVEL
 15365                 GO TO 6170-WRITE
 15366             ELSE IF WS-APPROVAL-LEVEL = '3'
 15367                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15368                                WS-SAVE-APPROVED-LEVEL
 15369                 GO TO 6170-WRITE
 15370             ELSE IF WS-APPROVAL-LEVEL = '4'
 15371                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15372                                WS-SAVE-APPROVED-LEVEL
 15373                 GO TO 6170-WRITE.
 15374
 15375     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15376                             WS-PMT-APPROVAL-SW.
 15377     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15378                             AT-APPROVAL-LEVEL-REQD.
 15379
 15380*******************************************************
 15381
 15382 6170-WRITE.
 15383
 15384     if pi-company-id = 'DCC'
 15385        MOVE ' '                 TO WS-PDEF-RECORD-SW
 15386        PERFORM 0900-GET-DDF-FACTORS
 15387                                 THRU 0900-EXIT
 15388     end-if
 15389    perform 2220-update-elcrtt   thru 2220-exit
 15390     IF PI-COMPANY-ID = 'DMD'
 15391        IF PI-AT-EOB-CODES NOT = SPACES
 15392           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15393           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15394           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15395           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15396           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15397
 15398
 15399* EXEC CICS HANDLE CONDITION
 15400*        DUPREC    (6180-DUPREC)
 15401*    END-EXEC.
 15402*    MOVE '"$%                   ! 3 #00014400' TO DFHEIV0
 15403     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15405     MOVE X'3320233030303134343030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 295
* EL156.cbl
 15406     CALL 'kxdfhei1' USING DFHEIV0
 15407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15408
 15409
 15410
 15411* EXEC CICS WRITE
 15412*         DATASET       ('ELTRLR')
 15413*         FROM          (ACTIVITY-TRAILERS)
 15414*         RIDFLD        (AT-CONTROL-PRIMARY)
 15415*     END-EXEC.
 15416     MOVE LENGTH OF
 15417      ACTIVITY-TRAILERS
 15418       TO DFHEIV11
 15419     MOVE 'ELTRLR' TO DFHEIV1
 15420*    MOVE '&$ L                  ''   #00014404' TO DFHEIV0
 15421     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15422     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15423     MOVE X'2020233030303134343034' TO DFHEIV0(25:11)
 15424     CALL 'kxdfhei1' USING DFHEIV0,
 15425           DFHEIV1,
 15426           ACTIVITY-TRAILERS,
 15427           DFHEIV11,
 15428           AT-CONTROL-PRIMARY,
 15429           DFHEIV99,
 15430           DFHEIV99
 15431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15432
 15433
 15434     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15435        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15436*06088           GO TO 6199-EXIT.
 15437           GO TO 6176-APPROVAL-NOTE.
 15438
 15439
 15440* EXEC CICS GETMAIN
 15441*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15442*         LENGTH    (200)
 15443*         INITIMG   (GETMAIN-SPACE)
 15444*     END-EXEC.
 15445     MOVE 200
 15446       TO DFHEIV11
 15447*    MOVE ',"IL                  $   #00014415' TO DFHEIV0
 15448     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15449     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15450     MOVE X'2020233030303134343135' TO DFHEIV0(25:11)
 15451     CALL 'kxdfhei1' USING DFHEIV0,
 15452           DFHEIV20,
 15453           DFHEIV11,
 15454           GETMAIN-SPACE
 15455     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15456         DFHEIV20
 15457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15458
 15459
 15460     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15461
 15462     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15463     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 296
* EL156.cbl
 15464     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15465     MOVE '6'                    TO AT-TRAILER-TYPE.
 15466     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15467                                    AT-GEN-INFO-LAST-MAINT-DT
 15468     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15469                                    AT-GEN-INFO-LAST-UPDATED-BY
 15470     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15471
 15472     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15473     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15474     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15475
 15476     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15477
 15478 6175-WRITE.
 15479
 15480
 15481* EXEC CICS HANDLE CONDITION
 15482*        DUPREC    (6190-DUPREC)
 15483*    END-EXEC.
 15484*    MOVE '"$%                   ! 4 #00014441' TO DFHEIV0
 15485     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15487     MOVE X'3420233030303134343431' TO DFHEIV0(25:11)
 15488     CALL 'kxdfhei1' USING DFHEIV0
 15489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15490
 15491
 15492
 15493* EXEC CICS WRITE
 15494*         DATASET     ('ELTRLR')
 15495*         FROM        (ACTIVITY-TRAILERS)
 15496*         RIDFLD      (AT-CONTROL-PRIMARY)
 15497*     END-EXEC.
 15498     MOVE LENGTH OF
 15499      ACTIVITY-TRAILERS
 15500       TO DFHEIV11
 15501     MOVE 'ELTRLR' TO DFHEIV1
 15502*    MOVE '&$ L                  ''   #00014445' TO DFHEIV0
 15503     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15504     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15505     MOVE X'2020233030303134343435' TO DFHEIV0(25:11)
 15506     CALL 'kxdfhei1' USING DFHEIV0,
 15507           DFHEIV1,
 15508           ACTIVITY-TRAILERS,
 15509           DFHEIV11,
 15510           AT-CONTROL-PRIMARY,
 15511           DFHEIV99,
 15512           DFHEIV99
 15513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15514
 15515
 15516 6176-APPROVAL-NOTE.
 15517
 15518     IF NOT APPROVAL-NEEDED
 15519         GO TO 6199-EXIT.
 15520
 15521
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 297
* EL156.cbl
 15522* EXEC CICS GETMAIN
 15523*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15524*        LENGTH    (200)
 15525*        INITIMG   (GETMAIN-SPACE)
 15526*    END-EXEC.
 15527     MOVE 200
 15528       TO DFHEIV11
 15529*    MOVE ',"IL                  $   #00014456' TO DFHEIV0
 15530     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15531     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15532     MOVE X'2020233030303134343536' TO DFHEIV0(25:11)
 15533     CALL 'kxdfhei1' USING DFHEIV0,
 15534           DFHEIV20,
 15535           DFHEIV11,
 15536           GETMAIN-SPACE
 15537     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15538         DFHEIV20
 15539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15540
 15541
 15542     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15543
 15544     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15545     MOVE 'AT'               TO AT-RECORD-ID
 15546     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15547     MOVE '6'                TO AT-TRAILER-TYPE
 15548     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15549                                AT-GEN-INFO-LAST-MAINT-DT
 15550     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15551                                AT-GEN-INFO-LAST-UPDATED-BY
 15552     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15553
 15554     IF PI-REAUDIT-NEEDED = 'Y'
 15555         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15556     ELSE
 15557         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15558     END-IF
 15559     MOVE SPACES             TO AT-INFO-LINE-2
 15560
 15561     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15562 6177-WRITE.
 15563
 15564
 15565* EXEC CICS HANDLE CONDITION
 15566*        DUPREC    (6185-DUPREC)
 15567*    END-EXEC.
 15568*    MOVE '"$%                   ! 5 #00014484' TO DFHEIV0
 15569     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15571     MOVE X'3520233030303134343834' TO DFHEIV0(25:11)
 15572     CALL 'kxdfhei1' USING DFHEIV0
 15573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15574
 15575
 15576
 15577* EXEC CICS WRITE
 15578*         DATASET     ('ELTRLR')
 15579*         FROM        (ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 298
* EL156.cbl
 15580*         RIDFLD      (AT-CONTROL-PRIMARY)
 15581*     END-EXEC.
 15582     MOVE LENGTH OF
 15583      ACTIVITY-TRAILERS
 15584       TO DFHEIV11
 15585     MOVE 'ELTRLR' TO DFHEIV1
 15586*    MOVE '&$ L                  ''   #00014488' TO DFHEIV0
 15587     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15588     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15589     MOVE X'2020233030303134343838' TO DFHEIV0(25:11)
 15590     CALL 'kxdfhei1' USING DFHEIV0,
 15591           DFHEIV1,
 15592           ACTIVITY-TRAILERS,
 15593           DFHEIV11,
 15594           AT-CONTROL-PRIMARY,
 15595           DFHEIV99,
 15596           DFHEIV99
 15597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15598
 15599
 15600
 15601     GO TO 6199-EXIT.
 15602
 15603 6180-DUPREC.
 15604
 15605     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15606     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15607     GO TO 6170-WRITE.
 15608
 15609 6185-DUPREC.
 15610     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15611     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15612     GO TO 6177-WRITE.
 15613
 15614 6190-DUPREC.
 15615     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15616     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15617     GO TO 6175-WRITE.
 15618
 15619 6199-EXIT.
 15620      EXIT.
 15621
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 299
* EL156.cbl
 15623 6200-UPDATE-CLAIM-MSTR.
 15624     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15625     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15626     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15627     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15628
 15629     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15630
 15631     MOVE ZEROS                  TO W-INTEREST.
 15632
 15633     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15634        IF (PI-OFFLINE = 'Y') OR
 15635           (PI-PMTTYPE = '7')
 15636           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15637                                 THRU 9870-EXIT
 15638        END-IF
 15639     END-IF
 15640     IF NOT ERROR-ON-OUTPUT
 15641        CONTINUE
 15642     ELSE
 15643
 15644* EXEC CICS REWRITE
 15645*          DATASET('ELMSTR')
 15646*          FROM(CLAIM-MASTER)
 15647*       END-EXEC
 15648     MOVE LENGTH OF
 15649      CLAIM-MASTER
 15650       TO DFHEIV11
 15651     MOVE 'ELMSTR' TO DFHEIV1
 15652*    MOVE '&& L                  %   #00014537' TO DFHEIV0
 15653     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15654     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15655     MOVE X'2020233030303134353337' TO DFHEIV0(25:11)
 15656     CALL 'kxdfhei1' USING DFHEIV0,
 15657           DFHEIV1,
 15658           CLAIM-MASTER,
 15659           DFHEIV11,
 15660           DFHEIV99
 15661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15662
 15663        MOVE -1                  TO ENTPFBL
 15664        MOVE AL-UANON            TO ENTPFBA
 15665        MOVE MAP-NAMEB           TO MAP-NAME
 15666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15667        GO TO 8200-SEND-DATAONLY
 15668     END-IF
 15669
 15670     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15671
 15672     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15673
 15674     IF PI-AIG-SPECIAL-BENEFIT
 15675         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15676
 15677     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15678
 15679     IF PI-SPECIAL-BEN-SW = 'Y'
 15680         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 300
* EL156.cbl
 15681         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 15682
 15683     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15684         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 15685     ELSE
 15686         IF PI-PMTTYPE NOT = '4'
 15687            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 15688
 15689     IF PI-PMTTYPE = '5' OR '6'
 15690        GO TO  6250-SET-MAINT.
 15691
 15692     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 15693                                         CL-LAG-REPORT-CODE.
 15694
 15695     IF CL-ACTIVITY-CODE = 09
 15696         GO TO 6200-CONT-UPDATE.
 15697
 15698     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15699         IF CL-ACTIVITY-CODE = 11
 15700             GO TO 6200-CONT-UPDATE.
 15701
 15702     IF WS-ACT-REC-FOUND-SW = 'N'
 15703         GO TO 6200-CONT-UPDATE.
 15704
 15705     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 15706         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 15707         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 15708         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 15709
 15710     IF WS-UPDATE-SW = 'Y'
 15711         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 15712                                         CL-NEXT-FOLLOWUP-DT.
 15713
 15714 6200-CONT-UPDATE.
 15715
 15716     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15717       IF CLAIM-IS-CLOSED
 15718         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15719           IF WS-OPEN-CLOSE-SW = '2'
 15720             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 15721                                        CL-LAST-CLOSE-DT.
 15722
 15723     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 15724        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 15725        MOVE 'O'                 TO CL-CLAIM-STATUS.
 15726
 15727     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 15728        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 15729        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 15730        MOVE 'C'                 TO CL-CLAIM-STATUS
 15731        IF PI-PMTTYPE = '2'
 15732           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15733           CONTINUE
 15734        ELSE
 15735           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15736        END-IF
 15737     ELSE
 15738        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 301
* EL156.cbl
 15739           IF PI-PMTTYPE = '2' AND
 15740              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15741              CONTINUE
 15742           ELSE
 15743              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15744           END-IF
 15745        END-IF
 15746     END-IF
 15747
 15748     IF PI-PMTTYPE = '4'
 15749        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 15750
 15751     IF PI-COMPANY-ID = 'CVL'
 15752         IF PI-LOAN-UPDATE-SW = 'Y'
 15753             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 15754             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 15755             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 15756             MOVE CL-CERT-STATE      TO  CERT-STATE
 15757             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 15758             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 15759             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 15760             MOVE 'CERT'             TO  FILE-SWITCH
 15761             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 15762             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 15763             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 15764
 15765     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 15766        GO TO 6220-USE-COMPUTED.
 15767
 15768     IF (PI-PMTTYPE = '4')  AND
 15769        (PI-EPYAMT < ZEROS)
 15770          COMPUTE CL-NO-OF-DAYS-PAID =
 15771                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 15772          IF CL-NO-OF-DAYS-PAID < +0
 15773              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15774          ELSE
 15775              NEXT SENTENCE
 15776     ELSE
 15777          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 15778
 15779     IF PI-PROCESSOR-ID = 'FIX '
 15780        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15781           NEXT SENTENCE
 15782        ELSE
 15783           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 15784     ELSE
 15785        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 15786
 15787     IF PI-PMTTYPE = '4'
 15788        GO TO 6250-SET-MAINT.
 15789
 15790     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15791
 15792     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15793     MOVE '4'                    TO DC-OPTION-CODE.
 15794     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15795     IF DATE-CONVERSION-ERROR
 15796        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 302
* EL156.cbl
 15797     ELSE
 15798        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 15799           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 15800           IF PI-AIG-SPECIAL-BENEFIT
 15801               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 15802           ELSE
 15803               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 15804
 15805     GO TO 6250-SET-MAINT.
 15806
 15807 6220-USE-COMPUTED.
 15808
 15809     IF (PI-PMTTYPE = '4')  AND
 15810        (PI-CPYAMT < ZEROS)
 15811          COMPUTE CL-NO-OF-DAYS-PAID =
 15812                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 15813          IF CL-NO-OF-DAYS-PAID < +0
 15814              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15815          ELSE
 15816              NEXT SENTENCE
 15817     ELSE
 15818          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 15819
 15820     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 15821
 15822     IF PI-PMTTYPE = '4'
 15823        GO TO 6250-SET-MAINT.
 15824
 15825     IF PI-AIG-SPECIAL-BENEFIT
 15826         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 15827     ELSE
 15828         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 15829
 15830     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15831
 15832     IF PI-CPYTHRU > CL-PAID-THRU-DT
 15833        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 15834
 15835 6250-SET-MAINT.
 15836     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 15837
 15838     IF PI-PROCESSOR-ID = 'FIX '
 15839        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 15840           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 15841        ELSE
 15842           NEXT SENTENCE
 15843     ELSE
 15844        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 15845
 15846     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 15847     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 15848     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 15849
 15850 6299-EXIT.
 15851      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 303
* EL156.cbl
 15853 6300-UPDATE-CERT.
 15854
 15855*  ADD CERTNOTE FOR SC NP+6
 15856     IF PI-COMPANY-ID = 'CID' AND
 15857       (PI-PMTTYPE = '2' OR '3') AND
 15858        CL-CERT-STATE = 'SC'  AND
 15859        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 15860           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15861     END-IF.
 15862
 15863     IF PI-COMPANY-ID = 'AHL' AND
 15864       (PI-PMTTYPE = '2' OR '3') AND
 15865        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 15866           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 15867           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15868     END-IF.
 15869
 15870     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 15871     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 15872     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 15873     MOVE CL-CERT-STATE    TO CERT-STATE.
 15874     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 15875     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 15876     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 15877     MOVE 'CERT'           TO FILE-SWITCH.
 15878
 15879     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 15880
 15881     IF CERT-NOTE-ADDED
 15882        IF CM-NOTE-SW = ' '
 15883           MOVE '4'             TO CM-NOTE-SW
 15884        ELSE
 15885           IF CM-NOTE-SW = '1'
 15886               MOVE '5'           TO CM-NOTE-SW
 15887           ELSE
 15888              IF CM-NOTE-SW = '2'
 15889                 MOVE '6'         TO CM-NOTE-SW
 15890              ELSE
 15891                 IF CM-NOTE-SW = '3'
 15892                    MOVE '7'      TO CM-NOTE-SW
 15893                 END-IF
 15894              END-IF
 15895           END-IF
 15896        END-IF
 15897     END-IF.
 15898
 15899     IF PI-COMPANY-ID = 'CVL'
 15900         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 15901         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 15902
 15903     IF PI-PMTTYPE NOT = '4'
 15904        GO TO 6340-UPDATE-CERT.
 15905
 15906     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15907        IF PI-PFKEY-USED = DFHPF5
 15908           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 15909        ELSE
 15910           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 304
* EL156.cbl
 15911
 15912*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15913*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15914*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15915*               PI-LF-COVERAGE-TYPE = 'P'
 15916*                GO TO 6350-REWRITE-CERT.
 15917
 15918     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15919       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15920          PI-LF-COVERAGE-TYPE = 'P'
 15921           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15922                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15923                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15924                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15925                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 15926                GO TO 6350-REWRITE-CERT
 15927            ELSE
 15928                GO TO 6350-REWRITE-CERT.
 15929
 15930     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15931         GO TO 6350-REWRITE-CERT.
 15932
 15933     IF NOT CM-AH-LUMP-SUM-DISAB
 15934        GO TO 6380-UNLOCK-CERT.
 15935
 15936     IF PI-PFKEY-USED = DFHPF5
 15937        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 15938                                    CM-AH-ITD-AH-PMT
 15939        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15940        GO TO 6350-REWRITE-CERT
 15941     ELSE
 15942        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 15943                                    CM-AH-ITD-AH-PMT
 15944        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15945        GO TO 6350-REWRITE-CERT.
 15946
 15947 6340-UPDATE-CERT.
 15948
 15949     IF CL-CLAIM-TYPE = 'L'
 15950         IF PI-PFKEY-USED = DFHPF5
 15951             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 15952         ELSE
 15953             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 15954
 15955     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15956         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15957             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15958                PI-LF-COVERAGE-TYPE = 'P'
 15959                 GO TO 6350-REWRITE-CERT.
 15960
 15961     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15962       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15963          PI-LF-COVERAGE-TYPE = 'P'
 15964           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15965                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15966                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15967                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15968                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 305
* EL156.cbl
 15969                GO TO 6350-REWRITE-CERT.
 15970
 15971     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15972         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 15973            PI-LF-COVERAGE-TYPE NOT = 'P'
 15974             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 15975             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 15976             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 15977             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 15978             GO TO 6350-REWRITE-CERT.
 15979
 15980     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15981         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 15982         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 15983         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 15984         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 15985         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 15986         IF PI-PFKEY-USED = DFHPF5
 15987             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 15988                                        CM-AH-ITD-AH-PMT
 15989             GO TO 6350-REWRITE-CERT
 15990         ELSE
 15991             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 15992                                        CM-AH-ITD-AH-PMT
 15993             GO TO 6350-REWRITE-CERT.
 15994
 15995 6350-REWRITE-CERT.
 15996
 15997
 15998* EXEC CICS REWRITE
 15999*         DATASET  ('ELCERT')
 16000*         FROM(CERTIFICATE-MASTER)
 16001*     END-EXEC.
 16002     MOVE LENGTH OF
 16003      CERTIFICATE-MASTER
 16004       TO DFHEIV11
 16005     MOVE 'ELCERT' TO DFHEIV1
 16006*    MOVE '&& L                  %   #00014876' TO DFHEIV0
 16007     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16008     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16009     MOVE X'2020233030303134383736' TO DFHEIV0(25:11)
 16010     CALL 'kxdfhei1' USING DFHEIV0,
 16011           DFHEIV1,
 16012           CERTIFICATE-MASTER,
 16013           DFHEIV11,
 16014           DFHEIV99
 16015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16016
 16017
 16018     GO TO 6399-EXIT.
 16019
 16020 6380-UNLOCK-CERT.
 16021
 16022* EXEC CICS UNLOCK
 16023*         DATASET  ('ELCERT')
 16024*     END-EXEC.
 16025     MOVE 'ELCERT' TO DFHEIV1
 16026*    MOVE '&*                    #   #00014884' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 306
* EL156.cbl
 16027     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16028     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16029     MOVE X'2020233030303134383834' TO DFHEIV0(25:11)
 16030     CALL 'kxdfhei1' USING DFHEIV0,
 16031           DFHEIV1,
 16032           DFHEIV99
 16033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16034
 16035
 16036 6399-EXIT.
 16037      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 307
* EL156.cbl
 16039 6400-UPDATE-ZERO-TRAILER.
 16040     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16041     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16042
 16043     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16044
 16045     IF PI-EPYAMT NOT = ZEROS
 16046         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16047     ELSE
 16048         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16049
 16050     IF PI-ERESV NOT = ZEROS
 16051        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16052
 16053     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16054        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16055
 16056     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16057        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16058     ELSE
 16059        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16060
 16061     IF PI-PMTTYPE = '5'
 16062        IF PI-EPYAMT = ZEROS
 16063           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16064        ELSE
 16065           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16066
 16067     IF PI-PMTTYPE = '6'
 16068        IF PI-EPYAMT = ZEROS
 16069           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16070        ELSE
 16071           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16072
 16073 6420-CHECK-OPEN-CLOSE.
 16074     IF PI-PMTTYPE = '5' OR '6'
 16075        GO TO 6450-REWRITE.
 16076
 16077     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16078         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16079             IF CLAIM-IS-CLOSED
 16080                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16081                 MOVE 1          TO  SUB-1
 16082                 GO TO 6440-AIG-LOOP.
 16083
 16084     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16085        GO TO 6450-REWRITE.
 16086
 16087     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16088        GO TO 6450-REWRITE.
 16089
 16090     MOVE 1                      TO SUB-1.
 16091
 16092 6430-LOOP.
 16093     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16094        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16095        IF PI-PMTTYPE = '1' OR '4'
 16096           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 308
* EL156.cbl
 16097           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16098           GO TO 6450-REWRITE
 16099        ELSE
 16100           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16101           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16102           GO TO 6450-REWRITE.
 16103
 16104     IF SUB-1 = 6
 16105      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16106      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16107      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16108      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16109      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16110      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16111      GO TO 6430-LOOP.
 16112
 16113     ADD 1                       TO SUB-1.
 16114     GO TO 6430-LOOP.
 16115
 16116
 16117 6440-AIG-LOOP.
 16118
 16119     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16120       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16121       IF WS-OPEN-CLOSE-SW = '1'
 16122         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16123         IF PI-PMTTYPE = '2'
 16124           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16125           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16126         ELSE
 16127           IF PI-PMTTYPE = '3'
 16128             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16129             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16130           ELSE
 16131             IF PI-PMTTYPE = '4'
 16132               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16133               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16134             ELSE
 16135               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16136               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16137       ELSE
 16138         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16139         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16140         GO TO 6450-REWRITE.
 16141
 16142     IF SUB-1 = 6
 16143      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16144      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16145      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16146      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16147      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16148      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16149      GO TO 6440-AIG-LOOP.
 16150
 16151     ADD 1                       TO SUB-1.
 16152     GO TO 6440-AIG-LOOP.
 16153
 16154 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 309
* EL156.cbl
 16155     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16156     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16157     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16158
 16159     IF PI-COMPANY-ID = 'DMD'
 16160         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16161         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16162         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16163         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16164         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16165
 16166
 16167* EXEC CICS REWRITE
 16168*         DATASET  ('ELTRLR')
 16169*         FROM     (ACTIVITY-TRAILERS)
 16170*     END-EXEC.
 16171     MOVE LENGTH OF
 16172      ACTIVITY-TRAILERS
 16173       TO DFHEIV11
 16174     MOVE 'ELTRLR' TO DFHEIV1
 16175*    MOVE '&& L                  %   #00015018' TO DFHEIV0
 16176     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16177     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16178     MOVE X'2020233030303135303138' TO DFHEIV0(25:11)
 16179     CALL 'kxdfhei1' USING DFHEIV0,
 16180           DFHEIV1,
 16181           ACTIVITY-TRAILERS,
 16182           DFHEIV11,
 16183           DFHEIV99
 16184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16185
 16186
 16187 6499-EXIT.
 16188      EXIT.
 16189
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 310
* EL156.cbl
 16191 6500-READ-DLO035.
 16192     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16193     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16194     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16195     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16196
 16197
 16198* EXEC CICS LINK
 16199*        PROGRAM    ('DLO035')
 16200*        COMMAREA   (DLO035-KEY)
 16201*        LENGTH     (DL35-LENGTH)
 16202*    END-EXEC.
 16203     MOVE 'DLO035' TO DFHEIV1
 16204*    MOVE '."C                   (   #00015033' TO DFHEIV0
 16205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16207     MOVE X'2020233030303135303333' TO DFHEIV0(25:11)
 16208     CALL 'kxdfhei1' USING DFHEIV0,
 16209           DFHEIV1,
 16210           DLO035-KEY,
 16211           DL35-LENGTH,
 16212           DFHEIV99,
 16213           DFHEIV99,
 16214           DFHEIV99,
 16215           DFHEIV99
 16216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16217
 16218
 16219     IF DL35-RETURN-CODE = 'OK'
 16220         GO TO 6500-EXIT.
 16221
 16222     IF DL35-RETURN-CODE = '01'
 16223         MOVE ER-7830            TO EMI-ERROR
 16224         GO TO 6500-BAD-EXIT.
 16225
 16226     IF DL35-RETURN-CODE = '02'
 16227         MOVE ER-7831            TO EMI-ERROR
 16228         GO TO 6500-BAD-EXIT.
 16229
 16230     IF DL35-RETURN-CODE = '03'
 16231         MOVE ER-7832            TO EMI-ERROR
 16232         GO TO 6500-BAD-EXIT.
 16233
 16234     IF DL35-RETURN-CODE = '04'
 16235         MOVE ER-7833            TO EMI-ERROR
 16236         GO TO 6500-BAD-EXIT.
 16237
 16238     IF DL35-RETURN-CODE = '05'
 16239         MOVE ER-7834            TO EMI-ERROR
 16240         GO TO 6500-BAD-EXIT.
 16241
 16242     IF DL35-RETURN-CODE = '06'
 16243         MOVE ER-7835            TO EMI-ERROR
 16244         GO TO 6500-BAD-EXIT.
 16245
 16246     IF DL35-RETURN-CODE = '07'
 16247         MOVE ER-7836            TO EMI-ERROR
 16248         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 311
* EL156.cbl
 16249
 16250     IF DL35-RETURN-CODE = 'E1'
 16251         MOVE ER-7837            TO EMI-ERROR
 16252         GO TO 6500-BAD-EXIT.
 16253
 16254     IF DL35-RETURN-CODE NOT = 'OK'
 16255         MOVE ER-7838            TO EMI-ERROR
 16256         GO TO 6500-BAD-EXIT.
 16257
 16258 6500-EXIT.
 16259      EXIT.
 16260
 16261 6500-BAD-EXIT.
 16262
 16263* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16264*    MOVE '6"R                   !   #00015082' TO DFHEIV0
 16265     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16267     MOVE X'2020233030303135303832' TO DFHEIV0(25:11)
 16268     CALL 'kxdfhei1' USING DFHEIV0
 16269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16270
 16271     MOVE -1                 TO PMTTYPEL.
 16272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16273     GO TO 8200-SEND-DATAONLY.
 16274
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 312
* EL156.cbl
 16276 6600-UPDATE-DLO035.
 16277     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16278     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16279     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16280     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16281
 16282
 16283* EXEC CICS LINK
 16284*        PROGRAM    ('DLO035')
 16285*        COMMAREA   (DLO035-KEY)
 16286*        LENGTH     (DL35-LENGTH)
 16287*    END-EXEC.
 16288     MOVE 'DLO035' TO DFHEIV1
 16289*    MOVE '."C                   (   #00015094' TO DFHEIV0
 16290     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16292     MOVE X'2020233030303135303934' TO DFHEIV0(25:11)
 16293     CALL 'kxdfhei1' USING DFHEIV0,
 16294           DFHEIV1,
 16295           DLO035-KEY,
 16296           DL35-LENGTH,
 16297           DFHEIV99,
 16298           DFHEIV99,
 16299           DFHEIV99,
 16300           DFHEIV99
 16301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16302
 16303
 16304     IF DL35-RETURN-CODE = 'OK'
 16305         GO TO 6600-EXIT.
 16306
 16307     IF DL35-RETURN-CODE = '01'
 16308         MOVE ER-7830            TO EMI-ERROR
 16309         GO TO 6500-BAD-EXIT.
 16310
 16311     IF DL35-RETURN-CODE = '02'
 16312         MOVE ER-7831            TO EMI-ERROR
 16313         GO TO 6500-BAD-EXIT.
 16314
 16315     IF DL35-RETURN-CODE = '03'
 16316         MOVE ER-7832            TO EMI-ERROR
 16317         GO TO 6500-BAD-EXIT.
 16318
 16319     IF DL35-RETURN-CODE = '04'
 16320         MOVE ER-7833            TO EMI-ERROR
 16321         GO TO 6500-BAD-EXIT.
 16322
 16323     IF DL35-RETURN-CODE = '05'
 16324         MOVE ER-7834            TO EMI-ERROR
 16325         GO TO 6500-BAD-EXIT.
 16326
 16327     IF DL35-RETURN-CODE = '06'
 16328         MOVE ER-7835            TO EMI-ERROR
 16329         GO TO 6500-BAD-EXIT.
 16330
 16331     IF DL35-RETURN-CODE = '07'
 16332         MOVE ER-7836            TO EMI-ERROR
 16333         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 313
* EL156.cbl
 16334
 16335     IF DL35-RETURN-CODE = 'E1'
 16336         MOVE ER-7837            TO EMI-ERROR
 16337         GO TO 6500-BAD-EXIT.
 16338
 16339     IF DL35-RETURN-CODE NOT = 'OK'
 16340         MOVE ER-7838            TO EMI-ERROR
 16341         GO TO 6500-BAD-EXIT.
 16342
 16343 6600-EXIT.
 16344      EXIT.
 16345
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 314
* EL156.cbl
 16347 6700-UPDATE-ACTQ.
 16348***************************************************************
 16349*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16350*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16351*    ONE ALREADY THERE.                                       *
 16352***************************************************************
 16353
 16354
 16355* EXEC CICS HANDLE CONDITION
 16356*         NOTFND(6720-BUILD-NEW-RECORD)
 16357*     END-EXEC.
 16358*    MOVE '"$I                   ! 6 #00015150' TO DFHEIV0
 16359     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16361     MOVE X'3620233030303135313530' TO DFHEIV0(25:11)
 16362     CALL 'kxdfhei1' USING DFHEIV0
 16363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16364
 16365
 16366
 16367* EXEC CICS READ
 16368*         DATASET('ELACTQ')
 16369*         RIDFLD (ELMSTR-KEY)
 16370*         SET    (ADDRESS OF ACTIVITY-QUE)
 16371*         UPDATE
 16372*     END-EXEC.
 16373     MOVE 'ELACTQ' TO DFHEIV1
 16374*    MOVE '&"S        EU         (   #00015154' TO DFHEIV0
 16375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16376     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16377     MOVE X'2020233030303135313534' TO DFHEIV0(25:11)
 16378     CALL 'kxdfhei1' USING DFHEIV0,
 16379           DFHEIV1,
 16380           DFHEIV20,
 16381           DFHEIV99,
 16382           ELMSTR-KEY,
 16383           DFHEIV99,
 16384           DFHEIV99,
 16385           DFHEIV99
 16386     SET ADDRESS OF ACTIVITY-QUE TO
 16387         DFHEIV20
 16388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16389
 16390
 16391     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16392
 16393     IF PI-AIG-SPECIAL-BENEFIT AND
 16394        PI-CASH = 'Y'
 16395         ADD 2                   TO AQ-PAYMENT-COUNTER
 16396     ELSE
 16397         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16398
 16399     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16400         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16401
 16402     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16403
 16404     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 315
* EL156.cbl
 16405         IF WS-PMT-APPROVAL-SW = 'A'
 16406             NEXT SENTENCE
 16407         ELSE
 16408            IF PI-AIG-SPECIAL-BENEFIT AND
 16409               PI-CASH = 'Y'
 16410                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16411                                     WS-PMT-UNAPPROVED-CNT
 16412            ELSE
 16413                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16414                                     WS-PMT-UNAPPROVED-CNT
 16415     ELSE
 16416         IF PI-PMT-APPR-SW = 'Y'
 16417            IF PI-AIG-SPECIAL-BENEFIT AND
 16418               PI-CASH = 'Y'
 16419                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16420                                     WS-PMT-UNAPPROVED-CNT
 16421            ELSE
 16422                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16423                                     WS-PMT-UNAPPROVED-CNT.
 16424
 16425     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16426         MOVE ER-3536 TO EMI-ERROR
 16427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16428
 16429     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16430
 16431
 16432* EXEC CICS REWRITE
 16433*         DATASET('ELACTQ')
 16434*         FROM   (ACTIVITY-QUE)
 16435*     END-EXEC.
 16436     MOVE LENGTH OF
 16437      ACTIVITY-QUE
 16438       TO DFHEIV11
 16439     MOVE 'ELACTQ' TO DFHEIV1
 16440*    MOVE '&& L                  %   #00015201' TO DFHEIV0
 16441     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16442     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16443     MOVE X'2020233030303135323031' TO DFHEIV0(25:11)
 16444     CALL 'kxdfhei1' USING DFHEIV0,
 16445           DFHEIV1,
 16446           ACTIVITY-QUE,
 16447           DFHEIV11,
 16448           DFHEIV99
 16449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16450
 16451
 16452     GO TO 6799-EXIT.
 16453
 16454 6720-BUILD-NEW-RECORD.
 16455
 16456* EXEC CICS GETMAIN
 16457*         SET    (ADDRESS OF ACTIVITY-QUE)
 16458*         LENGTH (60)
 16459*         INITIMG(GETMAIN-SPACE)
 16460*     END-EXEC.
 16461     MOVE 60
 16462       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 316
* EL156.cbl
 16463*    MOVE ',"IL                  $   #00015209' TO DFHEIV0
 16464     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16465     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16466     MOVE X'2020233030303135323039' TO DFHEIV0(25:11)
 16467     CALL 'kxdfhei1' USING DFHEIV0,
 16468           DFHEIV20,
 16469           DFHEIV11,
 16470           GETMAIN-SPACE
 16471     SET ADDRESS OF ACTIVITY-QUE TO
 16472         DFHEIV20
 16473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16474
 16475
 16476     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16477
 16478     IF PI-AIG-SPECIAL-BENEFIT AND
 16479        PI-CASH = 'Y'
 16480         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16481     ELSE
 16482         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16483
 16484     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16485     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16486     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16487     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16488                                    AQ-FOLLOWUP-DATE.
 16489     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16490     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16491
 16492     IF PI-PMT-GRADUATED
 16493         IF WS-PMT-APPROVAL-SW = 'A'
 16494             NEXT SENTENCE
 16495         ELSE
 16496            IF PI-AIG-SPECIAL-BENEFIT AND
 16497               PI-CASH = 'Y'
 16498                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16499            ELSE
 16500                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16501     ELSE
 16502         IF PI-PMT-APPR-SW = 'Y'
 16503            IF PI-AIG-SPECIAL-BENEFIT AND
 16504               PI-CASH = 'Y'
 16505                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16506            ELSE
 16507                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16508
 16509     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16510         MOVE ER-3536 TO EMI-ERROR
 16511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16512
 16513
 16514* EXEC CICS WRITE
 16515*         DATASET('ELACTQ')
 16516*         RIDFLD (ELMSTR-KEY)
 16517*         FROM   (ACTIVITY-QUE)
 16518*     END-EXEC.
 16519     MOVE LENGTH OF
 16520      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 317
* EL156.cbl
 16521       TO DFHEIV11
 16522     MOVE 'ELACTQ' TO DFHEIV1
 16523*    MOVE '&$ L                  ''   #00015252' TO DFHEIV0
 16524     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16525     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16526     MOVE X'2020233030303135323532' TO DFHEIV0(25:11)
 16527     CALL 'kxdfhei1' USING DFHEIV0,
 16528           DFHEIV1,
 16529           ACTIVITY-QUE,
 16530           DFHEIV11,
 16531           ELMSTR-KEY,
 16532           DFHEIV99,
 16533           DFHEIV99
 16534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16535
 16536
 16537 6799-EXIT.
 16538      EXIT.
 16539
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 318
* EL156.cbl
 16541 6800-BUILD-FORM-TRAILER.
 16542
 16543
 16544* EXEC CICS GETMAIN
 16545*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16546*         LENGTH   (200)
 16547*         INITIMG  (GETMAIN-SPACE)
 16548*    END-EXEC.
 16549     MOVE 200
 16550       TO DFHEIV11
 16551*    MOVE ',"IL                  $   #00015264' TO DFHEIV0
 16552     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16554     MOVE X'2020233030303135323634' TO DFHEIV0(25:11)
 16555     CALL 'kxdfhei1' USING DFHEIV0,
 16556           DFHEIV20,
 16557           DFHEIV11,
 16558           GETMAIN-SPACE
 16559     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16560         DFHEIV20
 16561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16562
 16563
 16564     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16565
 16566     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16567     MOVE 'AT'                   TO AT-RECORD-ID.
 16568     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16569
 16570     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16571     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16572                                    AT-FORM-LAST-MAINT-DT
 16573                                    AT-FORM-SEND-ON-DT.
 16574     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16575                                    AT-FORM-LAST-UPDATED-BY.
 16576     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16577     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16578     MOVE '6'                    TO DC-OPTION-CODE.
 16579     MOVE +29                    TO DC-ELAPSED-DAYS.
 16580     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16581     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16582     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16583
 16584     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16585         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16586
 16587     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16588                                    AT-FORM-RE-SEND-DT
 16589                                    AT-EMP-FORM-ANSWERED-DT
 16590                                    AT-PHY-FORM-ANSWERED-DT
 16591                                    AT-EMP-FORM-SEND-ON-DT
 16592                                    AT-PHY-FORM-SEND-ON-DT
 16593                                    AT-FORM-PRINTED-DT
 16594                                    AT-FORM-REPRINT-DT.
 16595     MOVE '2'                    TO AT-FORM-TYPE.
 16596
 16597     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16598     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 319
* EL156.cbl
 16599
 16600     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16601         NEXT SENTENCE
 16602     ELSE
 16603         IF CL-PROG-FORM-TYPE NOT = 'S'
 16604            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16605
 16606
 16607* EXEC CICS WRITE
 16608*         DATASET  ('ELTRLR')
 16609*         FROM     (ACTIVITY-TRAILERS)
 16610*         RIDFLD   (AT-CONTROL-PRIMARY)
 16611*     END-EXEC.
 16612     MOVE LENGTH OF
 16613      ACTIVITY-TRAILERS
 16614       TO DFHEIV11
 16615     MOVE 'ELTRLR' TO DFHEIV1
 16616*    MOVE '&$ L                  ''   #00015312' TO DFHEIV0
 16617     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16618     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16619     MOVE X'2020233030303135333132' TO DFHEIV0(25:11)
 16620     CALL 'kxdfhei1' USING DFHEIV0,
 16621           DFHEIV1,
 16622           ACTIVITY-TRAILERS,
 16623           DFHEIV11,
 16624           AT-CONTROL-PRIMARY,
 16625           DFHEIV99,
 16626           DFHEIV99
 16627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16628
 16629
 16630 6899-EXIT.
 16631      EXIT.
 16632
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 320
* EL156.cbl
 16634 6900-BUILD-ARCHIVE-HEADER.
 16635
 16636     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16637     MOVE '1'                    TO CNTL-REC-TYPE.
 16638     MOVE +0                     TO CNTL-SEQ-NO.
 16639     MOVE SPACES                 TO CNTL-ACCESS.
 16640
 16641
 16642* EXEC CICS READ
 16643*         DATASET  ('ELCNTL')
 16644*         SET      (ADDRESS OF CONTROL-FILE)
 16645*         RIDFLD   (ELCNTL-KEY)
 16646*         UPDATE
 16647*    END-EXEC.
 16648     MOVE 'ELCNTL' TO DFHEIV1
 16649*    MOVE '&"S        EU         (   #00015329' TO DFHEIV0
 16650     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16651     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16652     MOVE X'2020233030303135333239' TO DFHEIV0(25:11)
 16653     CALL 'kxdfhei1' USING DFHEIV0,
 16654           DFHEIV1,
 16655           DFHEIV20,
 16656           DFHEIV99,
 16657           ELCNTL-KEY,
 16658           DFHEIV99,
 16659           DFHEIV99,
 16660           DFHEIV99
 16661     SET ADDRESS OF CONTROL-FILE TO
 16662         DFHEIV20
 16663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16664
 16665
 16666     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16667     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16668
 16669
 16670* EXEC CICS REWRITE
 16671*         FROM     (CONTROL-FILE)
 16672*         DATASET  ('ELCNTL')
 16673*    END-EXEC.
 16674     MOVE LENGTH OF
 16675      CONTROL-FILE
 16676       TO DFHEIV11
 16677     MOVE 'ELCNTL' TO DFHEIV1
 16678*    MOVE '&& L                  %   #00015339' TO DFHEIV0
 16679     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16680     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16681     MOVE X'2020233030303135333339' TO DFHEIV0(25:11)
 16682     CALL 'kxdfhei1' USING DFHEIV0,
 16683           DFHEIV1,
 16684           CONTROL-FILE,
 16685           DFHEIV11,
 16686           DFHEIV99
 16687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16688
 16689
 16690
 16691* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 321
* EL156.cbl
 16692*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 16693*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 16694*    END-EXEC.
 16695*    MOVE '"$$%                  ! 7 #00015344' TO DFHEIV0
 16696     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 16697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16698     MOVE X'3720233030303135333434' TO DFHEIV0(25:11)
 16699     CALL 'kxdfhei1' USING DFHEIV0
 16700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16701
 16702
 16703
 16704* EXEC CICS GETMAIN
 16705*         SET     (ADDRESS OF LETTER-ARCHIVE)
 16706*         LENGTH  (ELARCH-LENGTH)
 16707*         INITIMG (GETMAIN-SPACE)
 16708*    END-EXEC.
 16709*    MOVE ',"IL                  $   #00015349' TO DFHEIV0
 16710     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16711     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16712     MOVE X'2020233030303135333439' TO DFHEIV0(25:11)
 16713     CALL 'kxdfhei1' USING DFHEIV0,
 16714           DFHEIV20,
 16715           ELARCH-LENGTH,
 16716           GETMAIN-SPACE
 16717     SET ADDRESS OF LETTER-ARCHIVE TO
 16718         DFHEIV20
 16719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16720
 16721
 16722     MOVE 'LA'                   TO LA-RECORD-ID.
 16723     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 16724                                    LA-ARCHIVE-NO-A1.
 16725     MOVE '4'                    TO LA-RECORD-TYPE
 16726                                    LA-RECORD-TYPE-A1.
 16727     MOVE +0                     TO LA-LINE-SEQ-NO
 16728                                    LA-LINE-SEQ-NO-A1.
 16729     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 16730                                    LA-COMPANY-CD-A1.
 16731     MOVE CL-CARRIER             TO LA4-CARRIER.
 16732     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 16733     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 16734     MOVE CL-CERT-STATE          TO LA4-STATE.
 16735     MOVE +0                     TO LA4-NO-OF-COPIES.
 16736     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 16737     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 16738     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 16739                                    LA4-INITIAL-PRINT-DATE
 16740                                    LA4-RESEND-PRINT-DATE
 16741                                    LA4-FORM-REM-PRINT-DT.
 16742     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 16743     MOVE '2'                    TO LA4-FORM-TYPE.
 16744
 16745
 16746* EXEC CICS WRITE
 16747*         DATASET  ('ELARCH')
 16748*         FROM     (LETTER-ARCHIVE)
 16749*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 322
* EL156.cbl
 16750*    END-EXEC.
 16751     MOVE LENGTH OF
 16752      LETTER-ARCHIVE
 16753       TO DFHEIV11
 16754     MOVE 'ELARCH' TO DFHEIV1
 16755*    MOVE '&$ L                  ''   #00015378' TO DFHEIV0
 16756     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16757     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16758     MOVE X'2020233030303135333738' TO DFHEIV0(25:11)
 16759     CALL 'kxdfhei1' USING DFHEIV0,
 16760           DFHEIV1,
 16761           LETTER-ARCHIVE,
 16762           DFHEIV11,
 16763           LA-CONTROL-PRIMARY,
 16764           DFHEIV99,
 16765           DFHEIV99
 16766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16767
 16768
 16769 6999-EXIT.
 16770      EXIT.
 16771
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 323
* EL156.cbl
 16773 7000-SHOW-CLAIM.
 16774     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 16775     MOVE 'A'                    TO PI-PASS-SW.
 16776     MOVE LOW-VALUES             TO PI-CPYFROM
 16777                                    PI-MONTH-END-SAVE
 16778                                    PI-CPYTHRU.
 16779
 16780     MOVE ZEROS                  TO PI-FATAL-COUNT
 16781                                    PI-DAILY-RATE
 16782                                    PI-BEN-DAYS
 16783                                    PI-MANUAL-SW
 16784                                    PI-SAVE-CURSOR
 16785                                    PI-FORCE-COUNT
 16786                                    PI-HOLDTIL
 16787                                    PI-EPYFROM
 16788                                    PI-EPYTHRU
 16789                                    PI-EDAYS
 16790                                    PI-EPYAMT
 16791                                    PI-ERESV
 16792                                    PI-EEXPENS
 16793                                    PI-CDAYS
 16794                                    PI-CPYAMT
 16795                                    PI-CRESV
 16796                                    PI-CEXPENS
 16797                                    PI-INT-RATE
 16798                                    PI-AIGFROM.
 16799     MOVE ZEROS                  TO PI-PROOF-DATE.
 16800     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 16801                                    PI-REM-BEN-AMT
 16802                                    PI-MO-BEN-AMT.
 16803
 16804     MOVE LOW-VALUES             TO EL156AI.
 16805     MOVE MAP-NAMEA              TO MAP-NAME.
 16806
 16807* EXEC CICS HANDLE CONDITION
 16808*        NOTFND   (7010-BUILD-MAP)
 16809*    END-EXEC.
 16810*    MOVE '"$I                   ! 8 #00015421' TO DFHEIV0
 16811     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16813     MOVE X'3820233030303135343231' TO DFHEIV0(25:11)
 16814     CALL 'kxdfhei1' USING DFHEIV0
 16815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16816
 16817
 16818     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16819     MOVE '2'                    TO CNTL-REC-TYPE.
 16820     MOVE +0                     TO CNTL-SEQ-NO.
 16821     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16822
 16823
 16824* EXEC CICS READ
 16825*         DATASET  ('ELCNTL')
 16826*         SET      (ADDRESS OF CONTROL-FILE)
 16827*         RIDFLD   (ELCNTL-KEY)
 16828*    END-EXEC.
 16829     MOVE 'ELCNTL' TO DFHEIV1
 16830*    MOVE '&"S        E          (   #00015430' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 324
* EL156.cbl
 16831     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16832     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16833     MOVE X'2020233030303135343330' TO DFHEIV0(25:11)
 16834     CALL 'kxdfhei1' USING DFHEIV0,
 16835           DFHEIV1,
 16836           DFHEIV20,
 16837           DFHEIV99,
 16838           ELCNTL-KEY,
 16839           DFHEIV99,
 16840           DFHEIV99,
 16841           DFHEIV99
 16842     SET ADDRESS OF CONTROL-FILE TO
 16843         DFHEIV20
 16844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16845
 16846
 16847     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 16848
 16849     IF PI-APPROVAL-LEVEL = '5'
 16850         MOVE AL-UANON      TO SURVYYNA
 16851     END-IF.
 16852
 16853
 16854     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16855     MOVE '1'                    TO CNTL-REC-TYPE.
 16856     MOVE SPACES                 TO CNTL-ACCESS.
 16857     MOVE +0                     TO CNTL-SEQ-NO.
 16858
 16859
 16860* EXEC CICS READ
 16861*         DATASET  ('ELCNTL')
 16862*         SET      (ADDRESS OF CONTROL-FILE)
 16863*         RIDFLD   (ELCNTL-KEY)
 16864*    END-EXEC.
 16865     MOVE 'ELCNTL' TO DFHEIV1
 16866*    MOVE '&"S        E          (   #00015448' TO DFHEIV0
 16867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16869     MOVE X'2020233030303135343438' TO DFHEIV0(25:11)
 16870     CALL 'kxdfhei1' USING DFHEIV0,
 16871           DFHEIV1,
 16872           DFHEIV20,
 16873           DFHEIV99,
 16874           ELCNTL-KEY,
 16875           DFHEIV99,
 16876           DFHEIV99,
 16877           DFHEIV99
 16878     SET ADDRESS OF CONTROL-FILE TO
 16879         DFHEIV20
 16880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16881
 16882
 16883     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 16884
 16885 7010-BUILD-MAP.
 16886
 16887
 16888* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 325
* EL156.cbl
 16889*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 16890*    END-EXEC.
 16891*    MOVE '"$I                   ! 9 #00015458' TO DFHEIV0
 16892     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16893     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16894     MOVE X'3920233030303135343538' TO DFHEIV0(25:11)
 16895     CALL 'kxdfhei1' USING DFHEIV0
 16896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16897
 16898
 16899     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16900     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16901     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16902     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16903     MOVE 'MSTR'                 TO FILE-SWITCH.
 16904
 16905     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 16906
 16907     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 16908     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 16909     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 16910     MOVE CL-CCN                 TO PI-SV-CCN.
 16911
 16912     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 16913     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 16914     MOVE CL-CLAIM-NO            TO CLMNOO.
 16915     MOVE CL-CARRIER             TO CARRO.
 16916     MOVE CL-CERT-PRIME          TO CERTNOO.
 16917     MOVE CL-CERT-SFX            TO SUFXO.
 16918
 16919     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 16920        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 16921        CONTINUE
 16922     ELSE
 16923        MOVE AL-SADOF            TO ZINTHA
 16924                                    ZINTA
 16925                                    PINTHA
 16926                                    PINTA
 16927     END-IF
 16928     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 16929     EVALUATE TRUE
 16930     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 16931         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 16932     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16933         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 16934
 16935     WHEN CL-CLAIM-TYPE = 'I'
 16936         MOVE '  IU  '           TO CLMTYPO
 16937     WHEN CL-CLAIM-TYPE = 'G'
 16938         MOVE ' GAP  '           TO CLMTYPO
 16939     END-EVALUATE.
 16940     IF CLAIM-IS-OPEN
 16941         MOVE ' OPEN'            TO CLMSTATO
 16942     ELSE
 16943         MOVE 'CLOSED'           TO CLMSTATO.
 16944
 16945     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 16946
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 326
* EL156.cbl
 16947     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 16948         MOVE SPACES             TO  PCERTNOO
 16949                                     PSUFXO
 16950                                     PRIMHDGO
 16951                                     SEQUO
 16952         MOVE AL-SADOF           TO  PCERTNOA
 16953                                     PSUFXA
 16954                                     PRIMHDGA
 16955                                     SEQUA
 16956     ELSE
 16957         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 16958         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 16959         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 16960         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 16961         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 16962         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 16963         MOVE AL-SANON               TO  PCERTNOA
 16964                                         PSUFXA
 16965                                         PRIMHDGA
 16966         MOVE AL-SABON               TO  SEQUA.
 16967
 16968     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 16969
 16970     IF CL-NO-OF-PMTS-MADE = 0 AND
 16971        CL-TOTAL-PAID-AMT = 0
 16972         NEXT SENTENCE
 16973     ELSE
 16974         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 16975             IF NOT PI-USES-PAID-TO
 16976                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 16977                 MOVE ' '                 TO DC-OPTION-CODE
 16978                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16979                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 16980             ELSE
 16981                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 16982                 MOVE '6'                 TO DC-OPTION-CODE
 16983                 MOVE +1                  TO DC-ELAPSED-DAYS
 16984                 MOVE +0                  TO DC-ELAPSED-MONTHS
 16985                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16986                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 16987
 16988     IF MAP-NAME = 'EL156A'
 16989        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 16990           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16991             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 16992           end-if
 16993        end-if
 16994     end-if
 16995     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 16996         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 16997         MOVE ' '                TO DC-OPTION-CODE
 16998         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16999         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17000
 17001     IF CL-INCURRED-DT NOT = LOW-VALUES
 17002         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17003         MOVE ' '                TO DC-OPTION-CODE
 17004         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 327
* EL156.cbl
 17005         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17006
 17007     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17008
 17009     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17010         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17011         MOVE ' '                TO DC-OPTION-CODE
 17012         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17013         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17014
 17015     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17016         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17017         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17018     ELSE
 17019         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17020         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17021
 17022     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17023     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17024     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17025     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17026                                    PI-GROUPING.
 17027     MOVE CL-CERT-STATE          TO CERT-STATE
 17028                                    PI-STATE.
 17029     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17030                                    PI-ACCOUNT.
 17031     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17032     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17033     MOVE 'CERT'                 TO FILE-SWITCH.
 17034
 17035     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17036     if pi-company-id = 'DCC'
 17037        perform 7975-read-acct   thru 7975-exit
 17038     end-if
 17039     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17040     MOVE PI-STATE               TO WS-ST-ACCESS.
 17041     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17042     MOVE '3'                    TO CNTL-REC-TYPE.
 17043     MOVE +0                     TO CNTL-SEQ-NO.
 17044     MOVE 'STAT'                 TO FILE-SWITCH.
 17045
 17046     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17047
 17048     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17049     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17050
 17051     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17052        GO TO 7020-BYPASS-BENEFIT.
 17053
 17054     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17055     MOVE '4'                    TO CNTL-REC-TYPE.
 17056     MOVE +0                     TO CNTL-SEQ-NO.
 17057     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17058     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17059     MOVE 'BENE'                 TO FILE-SWITCH.
 17060
 17061     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17062
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 328
* EL156.cbl
 17063     IF NO-BENEFIT-FOUND
 17064        GO TO 7020-BYPASS-BENEFIT.
 17065
 17066     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17067     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17068     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17069
 17070 7020-BYPASS-BENEFIT.
 17071
 17072*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17073*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17074*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17075
 17076     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17077         GO TO 7021-GO-TO-LIFE.
 17078     move zeros                  to PI-MAX-BENEFIT-AMT
 17079     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17080
 17081     IF (PI-COMPANY-ID = 'DCC')
 17082        and (acct-found)
 17083        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17084        MOVE ' '                 TO WS-PDEF-RECORD-SW
 17085        PERFORM 0900-GET-DDF-FACTORS
 17086                                 THRU 0900-EXIT
 17087        IF PDEF-FOUND
 17088           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17089              (P1 > +8)
 17090              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17091           END-PERFORM
 17092           IF P1 < +9
 17093              MOVE PD-MAX-AMT (P1)
 17094                                 TO PI-MAX-BENEFIT-AMT
 17095           END-IF
 17096        END-IF
 17097     end-if
 17098     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17099     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17100     if (pi-max-benefit-amt not = zeros)
 17101        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17102        move pi-max-benefit-amt  to beneo
 17103     else
 17104        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17105     end-if
 17106     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17107     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17108                                    CP-ORIGINAL-TERM.
 17109     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17110
 17111*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17112*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17113*    ELSE
 17114         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17115
 17116     MOVE ' '                    TO DC-OPTION-CODE.
 17117     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17118     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17119
 17120     IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 329
* EL156.cbl
 17121         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17122         GO TO 7023-BYPASS-REMAINING-TERM.
 17123
 17124     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17125     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17126     GO TO 7022-AROUND-LIFE.
 17127
 17128 7021-GO-TO-LIFE.
 17129
 17130     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17131     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17132     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17133                                    CP-ORIGINAL-TERM.
 17134     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17135     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17136     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17137     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17138
 17139     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17140         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17141     ELSE
 17142         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17143
 17144     MOVE ' '                    TO DC-OPTION-CODE.
 17145     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17146     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17147
 17148 7022-AROUND-LIFE.
 17149
 17150     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17151     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17152     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17153     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17154     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17155     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17156     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17157
 17158     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17159
 17160     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17161        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17162           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17163
 17164     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17165        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17166           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17167
 17168 7023-BYPASS-REMAINING-TERM.
 17169     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17170       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17171          MOVE ZEROS                  TO BENEO
 17172       ELSE
 17173          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17174          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17175          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17176          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17177          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17178          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 330
* EL156.cbl
 17179          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17180          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17181          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17182          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17183          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17184          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17185          IF (PI-COMPANY-ID = 'DCC')
 17186             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17187             MOVE ' '            TO WS-PDEF-RECORD-SW
 17188             PERFORM 0900-GET-DDF-FACTORS
 17189                                 THRU 0900-EXIT
 17190             IF PDEF-FOUND
 17191                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17192                   (P1 > +8)
 17193                   OR (PD-PROD-CODE (P1) = 'L')
 17194                END-PERFORM
 17195                IF P1 < +9
 17196                   MOVE PD-MAX-AMT (P1)
 17197                                 TO CP-R-MAX-TOT-BEN
 17198                END-IF
 17199             END-IF
 17200          END-IF
 17201
 17202* EXEC CICS LINK
 17203*            PROGRAM  (LINK-REMAMT)
 17204*            COMMAREA (CALCULATION-PASS-AREA)
 17205*            LENGTH   (CP-COMM-LENGTH)
 17206*         END-EXEC
 17207*    MOVE '."C                   (   #00015764' TO DFHEIV0
 17208     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17209     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17210     MOVE X'2020233030303135373634' TO DFHEIV0(25:11)
 17211     CALL 'kxdfhei1' USING DFHEIV0,
 17212           LINK-REMAMT,
 17213           CALCULATION-PASS-AREA,
 17214           CP-COMM-LENGTH,
 17215           DFHEIV99,
 17216           DFHEIV99,
 17217           DFHEIV99,
 17218           DFHEIV99
 17219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17220          MOVE CP-REMAINING-AMT       TO BENEO
 17221       end-if
 17222     end-if
 17223     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17224     MOVE +95                    TO TRLR-SEQ-NO
 17225
 17226* EXEC CICS READ
 17227*       DATASET  ('ELTRLR')
 17228*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17229*       RIDFLD   (ELTRLR-KEY)
 17230*       RESP     (WS-RESPONSE)
 17231*    END-EXEC
 17232     MOVE 'ELTRLR' TO DFHEIV1
 17233*    MOVE '&"S        E          (  N#00015774' TO DFHEIV0
 17234     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17235     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17236     MOVE X'204E233030303135373734' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 331
* EL156.cbl
 17237     CALL 'kxdfhei1' USING DFHEIV0,
 17238           DFHEIV1,
 17239           DFHEIV20,
 17240           DFHEIV99,
 17241           ELTRLR-KEY,
 17242           DFHEIV99,
 17243           DFHEIV99,
 17244           DFHEIV99
 17245     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17246         DFHEIV20
 17247     MOVE EIBRESP  TO WS-RESPONSE
 17248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17249
 17250     if ws-resp-normal
 17251        perform varying s1 from +1 by +1 until
 17252           at-note-error-no (s1) = spaces
 17253           move at-note-error-no (s1)
 17254                                 to emi-error
 17255           if at-note-error-no (s1) = '1653'
 17256              evaluate true
 17257                 when cl-claim-type = 'L'
 17258                    move '  LF  '
 17259                                 to emi-claim-type
 17260                 when cl-claim-type = 'I'
 17261                    move '  IU  '
 17262                                 to emi-claim-type
 17263                 when other
 17264                    move '  AH  '
 17265                                 to emi-claim-type
 17266              end-evaluate
 17267           end-if
 17268           PERFORM 9900-ERROR-FORMAT
 17269                                 THRU 9900-EXIT
 17270        end-perform
 17271     end-if
 17272     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17273         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17274            WS-LF-COVERAGE-TYPE = 'P'
 17275             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17276                                        CM-LF-ITD-DEATH-AMT
 17277             MOVE WS-REMAINING-AMT  TO  BENEO.
 17278
 17279     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17280     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17281     MOVE WS-TERMS               TO TERMSO.
 17282
 17283     IF WS-STATUS = '6' OR '7' OR '8'
 17284         MOVE AL-SABOF           TO CRTSTATA.
 17285
 17286     IF WS-STATUS = '1' OR '4'
 17287        IF CP-REMAINING-TERM-3 = ZEROS
 17288           MOVE 'EXPIRED'        TO CRTSTATO
 17289        ELSE
 17290           MOVE 'ACTIVE  '       TO CRTSTATO.
 17291
 17292     IF WS-STATUS = '2'
 17293         MOVE 'PEND    '         TO CRTSTATO.
 17294
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 332
* EL156.cbl
 17295     IF WS-STATUS = '3'
 17296         MOVE 'RESTORE '         TO CRTSTATO.
 17297
 17298     IF WS-STATUS = '5'
 17299         MOVE 'REISSUE '         TO CRTSTATO.
 17300
 17301     IF WS-STATUS = '6'
 17302         MOVE 'LMP DIS'          TO CRTSTATO.
 17303
 17304     IF WS-STATUS = '7'
 17305         MOVE 'DEATH'            TO CRTSTATO.
 17306
 17307     IF WS-STATUS = '8'
 17308         MOVE 'CANCEL'           TO CRTSTATO.
 17309
 17310     IF WS-STATUS = '9'
 17311         MOVE 'RE-ONLY '         TO CRTSTATO.
 17312
 17313     IF WS-STATUS = 'V'
 17314         MOVE 'VOID  '           TO CRTSTATO.
 17315
 17316     IF WS-STATUS = 'D'
 17317         MOVE 'DECLINE '         TO CRTSTATO.
 17318
 17319     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17320         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17321         MOVE '5'                TO CNTL-REC-TYPE
 17322     ELSE
 17323         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17324         MOVE '4'                TO CNTL-REC-TYPE.
 17325
 17326     MOVE '** NONE **'           TO COVERO.
 17327     MOVE AL-SABON               TO COVERA.
 17328
 17329     IF PI-COMPANY-ID = 'CVL'
 17330         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17331             MOVE CM-BENEFICIARY TO LOANNOO
 17332             MOVE AL-UANON       TO LOANNOA.
 17333
 17334     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17335        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17336        MOVE +91                 TO  TRLR-SEQ-NO
 17337
 17338* EXEC CICS READ
 17339*           DATASET  ('ELTRLR')
 17340*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17341*           RIDFLD   (ELTRLR-KEY)
 17342*           RESP     (WS-RESPONSE)
 17343*       END-EXEC
 17344     MOVE 'ELTRLR' TO DFHEIV1
 17345*    MOVE '&"S        E          (  N#00015868' TO DFHEIV0
 17346     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17347     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17348     MOVE X'204E233030303135383638' TO DFHEIV0(25:11)
 17349     CALL 'kxdfhei1' USING DFHEIV0,
 17350           DFHEIV1,
 17351           DFHEIV20,
 17352           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 333
* EL156.cbl
 17353           ELTRLR-KEY,
 17354           DFHEIV99,
 17355           DFHEIV99,
 17356           DFHEIV99
 17357     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17358         DFHEIV20
 17359     MOVE EIBRESP  TO WS-RESPONSE
 17360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17361
 17362        IF WS-RESP-NORMAL
 17363           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17364        ELSE
 17365           MOVE SPACES           TO  LOANNOO
 17366        END-IF
 17367*052506
 17368*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17369*052506
 17370     END-IF
 17371
 17372     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17373        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17374
 17375     IF WS-BEN-CD = ZEROS
 17376         GO TO 7050-SHOW-CONTINUE.
 17377
 17378     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17379     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17380     MOVE +0                     TO CNTL-SEQ-NO.
 17381     MOVE 'BENE'                 TO FILE-SWITCH.
 17382
 17383     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17384
 17385     IF BENEFIT-FOUND
 17386         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17387         MOVE AL-SANON                    TO COVERA.
 17388
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 334
* EL156.cbl
 17390 7050-SHOW-CONTINUE.
 17391
 17392     IF PI-COMPANY-ID = 'DMD'
 17393         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17394
 17395     MOVE -1                     TO PMTTYPEL.
 17396     GO TO 8100-SEND-INITIAL-MAP.
 17397
 17398 7100-SHOW-RECORD-NOT-FOUND.
 17399     IF FILE-SWITCH = 'MSTR'
 17400         MOVE ER-0204            TO EMI-ERROR.
 17401
 17402     IF FILE-SWITCH = 'CERT'
 17403         MOVE ER-0206            TO EMI-ERROR.
 17404
 17405     IF FILE-SWITCH = 'STAT'
 17406         MOVE ER-0149            TO EMI-ERROR.
 17407
 17408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17409
 17410     MOVE -1                     TO PMTTYPEL.
 17411     GO TO 8100-SEND-INITIAL-MAP
 17412
 17413     .
 17414 7110-BUILD-PMT-TRLR.
 17415     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17416     MOVE +51                    TO TRLR-SEQ-NO
 17417
 17418* EXEC CICS READ
 17419*        DATASET  ('ELTRLR')
 17420*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17421*        RIDFLD   (ELTRLR-KEY)
 17422*        RESP     (WS-RESPONSE)
 17423*    END-EXEC
 17424     MOVE 'ELTRLR' TO DFHEIV1
 17425*    MOVE '&"S        E          (  N#00015930' TO DFHEIV0
 17426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17428     MOVE X'204E233030303135393330' TO DFHEIV0(25:11)
 17429     CALL 'kxdfhei1' USING DFHEIV0,
 17430           DFHEIV1,
 17431           DFHEIV20,
 17432           DFHEIV99,
 17433           ELTRLR-KEY,
 17434           DFHEIV99,
 17435           DFHEIV99,
 17436           DFHEIV99
 17437     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17438         DFHEIV20
 17439     MOVE EIBRESP  TO WS-RESPONSE
 17440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17441     IF WS-RESP-NORMAL
 17442        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 17443     END-IF
 17444     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17445
 17446* EXEC CICS GETMAIN
 17447*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 335
* EL156.cbl
 17448*         LENGTH    (200)
 17449*         INITIMG   (GETMAIN-SPACE)
 17450*     END-EXEC
 17451     MOVE 200
 17452       TO DFHEIV11
 17453*    MOVE ',"IL                  $   #00015940' TO DFHEIV0
 17454     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17455     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17456     MOVE X'2020233030303135393430' TO DFHEIV0(25:11)
 17457     CALL 'kxdfhei1' USING DFHEIV0,
 17458           DFHEIV20,
 17459           DFHEIV11,
 17460           GETMAIN-SPACE
 17461     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17462         DFHEIV20
 17463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17464     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17465                                    AT-PREV-PAID-THRU-DT
 17466     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17467     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17468     MOVE 'AT'                   TO AT-RECORD-ID
 17469     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17470     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17471     MOVE '2'                    TO AT-TRAILER-TYPE
 17472     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17473                                    AT-PAYMENT-LAST-MAINT-DT
 17474     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17475                                    AT-PAYMENT-LAST-UPDATED-BY
 17476     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17477     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17478     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17479     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17480     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17481     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17482     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17483     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17484     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17485     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17486     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17487     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17488     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17489     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17490     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17491     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17492                                    AT-TO-BE-WRITTEN-DT
 17493     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17494                                    AT-CHECK-QUE-SEQUENCE
 17495                                    AT-ADDL-RESERVE
 17496     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17497                                    AT-VOID-SELECT-DT
 17498                                    AT-VOID-ACCEPT-DT
 17499                                    AT-VOID-DT
 17500                                    AT-PMT-PROOF-DT
 17501                                    AT-INT-PMT-SELECT-DT
 17502     MOVE ZEROS                  TO AT-DAILY-RATE
 17503                                    AT-ELIMINATION-DAYS
 17504     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17505*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 336
* EL156.cbl
 17506*        DUPREC    (7120-DUPREC)
 17507*    END-EXEC
 17508     .
 17509 7115-WRITE-INT-TRLR.
 17510
 17511* EXEC CICS WRITE
 17512*         DATASET       ('ELTRLR')
 17513*         FROM          (ACTIVITY-TRAILERS)
 17514*         RIDFLD        (AT-CONTROL-PRIMARY)
 17515*         RESP          (WS-RESPONSE)
 17516*     END-EXEC
 17517     MOVE LENGTH OF
 17518      ACTIVITY-TRAILERS
 17519       TO DFHEIV11
 17520     MOVE 'ELTRLR' TO DFHEIV1
 17521*    MOVE '&$ L                  ''  N#00015991' TO DFHEIV0
 17522     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17523     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17524     MOVE X'204E233030303135393931' TO DFHEIV0(25:11)
 17525     CALL 'kxdfhei1' USING DFHEIV0,
 17526           DFHEIV1,
 17527           ACTIVITY-TRAILERS,
 17528           DFHEIV11,
 17529           AT-CONTROL-PRIMARY,
 17530           DFHEIV99,
 17531           DFHEIV99
 17532     MOVE EIBRESP  TO WS-RESPONSE
 17533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17534      IF WS-RESP-DUPREC
 17535         GO TO 7120-DUPREC
 17536      END-IF
 17537     GO TO 7130-EXIT
 17538     .
 17539 7120-DUPREC.
 17540     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17541     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17542     GO TO 7115-WRITE-INT-TRLR
 17543     .
 17544 7130-EXIT.
 17545      EXIT.
 17546 7140-BUILD-NOTE-TRLR.
 17547
 17548
 17549* EXEC CICS GETMAIN
 17550*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17551*         LENGTH    (200)
 17552*         INITIMG   (GETMAIN-SPACE)
 17553*     END-EXEC
 17554     MOVE 200
 17555       TO DFHEIV11
 17556*    MOVE ',"IL                  $   #00016011' TO DFHEIV0
 17557     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17558     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17559     MOVE X'2020233030303136303131' TO DFHEIV0(25:11)
 17560     CALL 'kxdfhei1' USING DFHEIV0,
 17561           DFHEIV20,
 17562           DFHEIV11,
 17563           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 337
* EL156.cbl
 17564     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17565         DFHEIV20
 17566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17567     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17568     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17569     MOVE 'AT'                   TO AT-RECORD-ID
 17570     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17571     MOVE '6'                    TO AT-TRAILER-TYPE
 17572     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17573                                    AT-GEN-INFO-LAST-MAINT-DT
 17574     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17575                                    AT-GEN-INFO-LAST-UPDATED-BY
 17576     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17577     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17578     .
 17579 7150-WRITE.
 17580
 17581* EXEC CICS HANDLE CONDITION
 17582*        DUPREC    (7160-DUPREC)
 17583*    END-EXEC
 17584*    MOVE '"$%                   ! : #00016029' TO DFHEIV0
 17585     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17587     MOVE X'3A20233030303136303239' TO DFHEIV0(25:11)
 17588     CALL 'kxdfhei1' USING DFHEIV0
 17589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17590
 17591* EXEC CICS WRITE
 17592*         DATASET     ('ELTRLR')
 17593*         FROM        (ACTIVITY-TRAILERS)
 17594*         RIDFLD      (AT-CONTROL-PRIMARY)
 17595*         RESP        (WS-RESPONSE)
 17596*     END-EXEC
 17597     MOVE LENGTH OF
 17598      ACTIVITY-TRAILERS
 17599       TO DFHEIV11
 17600     MOVE 'ELTRLR' TO DFHEIV1
 17601*    MOVE '&$ L                  ''  N#00016032' TO DFHEIV0
 17602     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17603     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17604     MOVE X'204E233030303136303332' TO DFHEIV0(25:11)
 17605     CALL 'kxdfhei1' USING DFHEIV0,
 17606           DFHEIV1,
 17607           ACTIVITY-TRAILERS,
 17608           DFHEIV11,
 17609           AT-CONTROL-PRIMARY,
 17610           DFHEIV99,
 17611           DFHEIV99
 17612     MOVE EIBRESP  TO WS-RESPONSE
 17613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17614      IF WS-RESP-DUPREC
 17615         GO TO 7160-DUPREC
 17616      END-IF
 17617     GO TO 7170-EXIT
 17618     .
 17619 7160-DUPREC.
 17620     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17621     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 338
* EL156.cbl
 17622     GO TO 7150-WRITE
 17623     .
 17624 7170-EXIT.
 17625      EXIT.
 17626
 17627 7180-ADD-CERT-NOTE.
 17628*ADD CERT NOTE FOR SC NP+6
 17629
 17630
 17631* EXEC CICS GETMAIN
 17632*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17633*         LENGTH    (150)
 17634*         INITIMG   (GETMAIN-SPACE)
 17635*     END-EXEC.
 17636     MOVE 150
 17637       TO DFHEIV11
 17638*    MOVE ',"IL                  $   #00016054' TO DFHEIV0
 17639     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17640     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17641     MOVE X'2020233030303136303534' TO DFHEIV0(25:11)
 17642     CALL 'kxdfhei1' USING DFHEIV0,
 17643           DFHEIV20,
 17644           DFHEIV11,
 17645           GETMAIN-SPACE
 17646     SET ADDRESS OF CERT-NOTE-FILE TO
 17647         DFHEIV20
 17648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17649
 17650
 17651     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17652     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17653     MOVE +1                     TO WRK-NOTE-SEQ.
 17654     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17655     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17656     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17657     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17658     MOVE CL-CERT-STATE          TO CZ-STATE.
 17659     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17660     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17661     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17662     MOVE '2'                    TO CZ-RECORD-TYPE.
 17663     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17664     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17665     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17666     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17667     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17668     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 17669     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 17670     MOVE ' + 6 MO '             TO SC-NP6-COMM
 17671     IF PI-COMPANY-ID = 'AHL'
 17672        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 17673           CONTINUE
 17674        ELSE
 17675           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 17676              MOVE ' + 1 MO '    TO SC-NP6-COMM
 17677           ELSE
 17678              MOVE ' + 2 MO '    TO SC-NP6-COMM
 17679           END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 339
* EL156.cbl
 17680        END-IF
 17681     END-IF
 17682     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 17683     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 17684
 17685 7181-WRITE.
 17686
 17687
 17688* EXEC CICS WRITE
 17689*         DATASET     ('ERCNOT')
 17690*         FROM        (CERT-NOTE-FILE)
 17691*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17692*         RESP        (WS-RESPONSE)
 17693*    END-EXEC.
 17694     MOVE LENGTH OF
 17695      CERT-NOTE-FILE
 17696       TO DFHEIV11
 17697     MOVE 'ERCNOT' TO DFHEIV1
 17698*    MOVE '&$ L                  ''  N#00016096' TO DFHEIV0
 17699     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17700     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17701     MOVE X'204E233030303136303936' TO DFHEIV0(25:11)
 17702     CALL 'kxdfhei1' USING DFHEIV0,
 17703           DFHEIV1,
 17704           CERT-NOTE-FILE,
 17705           DFHEIV11,
 17706           CZ-CONTROL-PRIMARY,
 17707           DFHEIV99,
 17708           DFHEIV99
 17709     MOVE EIBRESP  TO WS-RESPONSE
 17710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17711
 17712
 17713     IF WS-RESP-DUPREC
 17714         GO TO 7182-DUPREC
 17715     END-IF.
 17716
 17717     SET CERT-NOTE-ADDED TO TRUE.
 17718
 17719     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 17720         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 17721     END-IF.
 17722
 17723     GO TO 7189-EXIT.
 17724
 17725 7182-DUPREC.
 17726
 17727     ADD +1                      TO  WRK-NOTE-SEQ.
 17728     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17729     GO TO 7181-WRITE.
 17730
 17731 7189-EXIT.
 17732      EXIT.
 17733
 17734 7190-ADD-ORIG-NOTE.
 17735
 17736
 17737* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 340
* EL156.cbl
 17738*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17739*         LENGTH    (150)
 17740*         INITIMG   (GETMAIN-SPACE)
 17741*     END-EXEC.
 17742     MOVE 150
 17743       TO DFHEIV11
 17744*    MOVE ',"IL                  $   #00016126' TO DFHEIV0
 17745     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17746     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17747     MOVE X'2020233030303136313236' TO DFHEIV0(25:11)
 17748     CALL 'kxdfhei1' USING DFHEIV0,
 17749           DFHEIV20,
 17750           DFHEIV11,
 17751           GETMAIN-SPACE
 17752     SET ADDRESS OF CERT-NOTE-FILE TO
 17753         DFHEIV20
 17754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17755
 17756
 17757     ADD +1                      TO WRK-NOTE-SEQ.
 17758     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17759     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17760     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17761     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17762     MOVE CL-CERT-STATE          TO CZ-STATE.
 17763     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17764     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17765     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17766     MOVE '2'                    TO CZ-RECORD-TYPE.
 17767     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17768     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17769     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17770     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17771     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17772     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 17773
 17774 7191-WRITE.
 17775
 17776
 17777* EXEC CICS WRITE
 17778*         DATASET     ('ERCNOT')
 17779*         FROM        (CERT-NOTE-FILE)
 17780*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17781*         RESP        (WS-RESPONSE)
 17782*    END-EXEC.
 17783     MOVE LENGTH OF
 17784      CERT-NOTE-FILE
 17785       TO DFHEIV11
 17786     MOVE 'ERCNOT' TO DFHEIV1
 17787*    MOVE '&$ L                  ''  N#00016151' TO DFHEIV0
 17788     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17790     MOVE X'204E233030303136313531' TO DFHEIV0(25:11)
 17791     CALL 'kxdfhei1' USING DFHEIV0,
 17792           DFHEIV1,
 17793           CERT-NOTE-FILE,
 17794           DFHEIV11,
 17795           CZ-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 341
* EL156.cbl
 17796           DFHEIV99,
 17797           DFHEIV99
 17798     MOVE EIBRESP  TO WS-RESPONSE
 17799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17800
 17801
 17802     IF WS-RESP-DUPREC
 17803         GO TO 7192-DUPREC
 17804     END-IF.
 17805
 17806     GO TO 7199-EXIT.
 17807
 17808 7192-DUPREC.
 17809
 17810     ADD +1                      TO  WRK-NOTE-SEQ.
 17811     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17812     GO TO 7191-WRITE.
 17813
 17814 7199-EXIT.
 17815      EXIT.
 17816 7200-FIND-BENEFIT.
 17817     MOVE 'N' TO WS-BEN-SEARCH-SW.
 17818
 17819
 17820* EXEC CICS HANDLE CONDITION
 17821*        ENDFILE(7200-EXIT)
 17822*        NOTFND(7200-EXIT)
 17823*    END-EXEC.
 17824*    MOVE '"$''I                  ! ; #00016175' TO DFHEIV0
 17825     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 17826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17827     MOVE X'3B20233030303136313735' TO DFHEIV0(25:11)
 17828     CALL 'kxdfhei1' USING DFHEIV0
 17829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17830
 17831
 17832
 17833* EXEC CICS READ
 17834*        DATASET('ELCNTL')
 17835*        SET(ADDRESS OF CONTROL-FILE)
 17836*        RIDFLD(ELCNTL-KEY)
 17837*        GTEQ
 17838*    END-EXEC.
 17839     MOVE 'ELCNTL' TO DFHEIV1
 17840*    MOVE '&"S        G          (   #00016180' TO DFHEIV0
 17841     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17842     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17843     MOVE X'2020233030303136313830' TO DFHEIV0(25:11)
 17844     CALL 'kxdfhei1' USING DFHEIV0,
 17845           DFHEIV1,
 17846           DFHEIV20,
 17847           DFHEIV99,
 17848           ELCNTL-KEY,
 17849           DFHEIV99,
 17850           DFHEIV99,
 17851           DFHEIV99
 17852     SET ADDRESS OF CONTROL-FILE TO
 17853         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 342
* EL156.cbl
 17854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17855
 17856
 17857     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 17858        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 17859           GO TO 7200-EXIT.
 17860
 17861     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 17862         VARYING SUB-1 FROM 1 BY 1 UNTIL
 17863            ((SUB-1 > 8) OR
 17864            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 17865
 17866     IF SUB-1 NOT = 9
 17867         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 17868
 17869     GO TO 7200-EXIT.
 17870
 17871 7200-BENEFIT-DUMMY.
 17872
 17873 7200-DUMMY-EXIT.
 17874     EXIT.
 17875
 17876 7200-EXIT.
 17877     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 343
* EL156.cbl
 17879*052506
 17880*052506 7250-FIND-LETTER-TRLR.
 17881*052506     EXEC CICS HANDLE CONDITION
 17882*052506         ENDFILE  (7250-END)
 17883*052506         NOTFND   (7250-END)
 17884*052506     END-EXEC.
 17885*052506
 17886*052506     EXEC CICS STARTBR
 17887*052506         DATASET   ('ELTRLR')
 17888*052506         RIDFLD    (ELTRLR-KEY)
 17889*052506         GTEQ
 17890*052506     END-EXEC.
 17891*052506
 17892*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 17893*052506
 17894*052506 7250-FIND-LOOP.
 17895*052506     EXEC CICS READNEXT
 17896*052506         DATASET   ('ELTRLR')
 17897*052506         RIDFLD    (ELTRLR-KEY)
 17898*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17899*052506     END-EXEC.
 17900*052506
 17901*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17902*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17903*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17904*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 17905*052506        GO TO 7250-END
 17906*052506     END-IF.
 17907*052506
 17908*052506     IF AT-TRAILER-TYPE NOT = '4'
 17909*052506         GO TO 7250-FIND-LOOP
 17910*052506     END-IF.
 17911*052506
 17912*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 17913*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 17914*052506     END-IF.
 17915*052506
 17916*052506     GO TO 7250-FIND-LOOP.
 17917*052506
 17918*052506 7250-END.
 17919*052506
 17920*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 17921*051506         MOVE SPACES             TO  DC-OPTION-CODE
 17922*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 17923*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17924*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 17925*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 17926*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 17927*052506     END-IF.
 17928*052506
 17929*052506     EXEC CICS ENDBR
 17930*052506          DATASET    ('ELTRLR')
 17931*052506     END-EXEC.
 17932*052506
 17933*052506 7250-EXIT.
 17934*052506     EXIT.
 17935*052506     EJECT
 17936*052506
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 344
* EL156.cbl
 17937 7300-CHECK-AUTO-ACTIVITY.
 17938
 17939     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 17940         NEXT SENTENCE
 17941     ELSE
 17942         GO TO 7399-EXIT.
 17943
 17944     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 17945
 17946     IF WS-ACT-REC-FOUND-SW = 'N'
 17947         GO TO 7399-EXIT.
 17948
 17949     IF PI-ACTIVITY-CODE = 09
 17950         GO TO 7300-CONT-AUTO-ACTIVITY.
 17951
 17952     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 17953        (PI-ACTIVITY-CODE = 11)
 17954         GO TO 7300-CONT-AUTO-ACTIVITY.
 17955
 17956     IF PI-PROVISIONAL-IND = 'P'
 17957         IF PI-PMTTYPE = '1'
 17958             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 17959                 MOVE 'N'    TO  PI-RESET-SW
 17960                 GO TO 7399-EXIT.
 17961
 17962     IF PI-PMTTYPE = '1'
 17963         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 17964             MOVE 'N'        TO  PI-RESET-SW
 17965             GO TO 7399-EXIT.
 17966
 17967     IF PI-PMTTYPE = '2' OR '3'
 17968         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 17969             MOVE 'N'        TO  PI-RESET-SW
 17970             GO TO 7399-EXIT.
 17971
 17972     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17973         IF PI-PROVISIONAL-IND = 'P'
 17974             NEXT SENTENCE
 17975         ELSE
 17976             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 17977
 17978 7300-CONT-AUTO-ACTIVITY.
 17979
 17980     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 17981         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 17982         MOVE '4'            TO DC-OPTION-CODE
 17983         MOVE +0             TO DC-ELAPSED-DAYS
 17984                                DC-ELAPSED-MONTHS
 17985         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17986         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 17987         IF PI-USES-PAID-TO
 17988             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17989             IF NO-CONVERSION-ERROR
 17990                 MOVE +1     TO DC-ELAPSED-DAYS
 17991                 MOVE +0     TO DC-ELAPSED-MONTHS
 17992                 MOVE '6'    TO DC-OPTION-CODE
 17993                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17994                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 345
* EL156.cbl
 17995                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 17996
 17997     IF PI-PFKEY-USED = DFHPF5
 17998         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 17999         IF PI-USES-PAID-TO
 18000             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18001             MOVE +1                  TO DC-ELAPSED-DAYS
 18002             MOVE +0                  TO DC-ELAPSED-MONTHS
 18003             MOVE '6'                 TO DC-OPTION-CODE
 18004             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18005             IF NO-CONVERSION-ERROR
 18006                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18007
 18008     IF WS-CHK-THRU-DT < PI-EXP-DT
 18009         NEXT SENTENCE
 18010     ELSE
 18011         MOVE 03                     TO  WS-ACTIVITY-CODE
 18012         GO TO 7390-PROCESS-ACTIVITY.
 18013
 18014     IF PI-PROV-PMT
 18015         MOVE 09                     TO  WS-ACTIVITY-CODE
 18016     ELSE
 18017        IF PI-PMTTYPE = '1'
 18018            MOVE 02                  TO  WS-ACTIVITY-CODE
 18019        ELSE
 18020        IF PI-PMTTYPE = '2' OR '3'
 18021            MOVE 07                  TO  WS-ACTIVITY-CODE
 18022        ELSE
 18023        IF PI-PMTTYPE = '4'
 18024            MOVE 00                  TO  WS-ACTIVITY-CODE
 18025        ELSE
 18026            MOVE 'N'                 TO  PI-RESET-SW
 18027            GO TO 7399-EXIT.
 18028
 18029 7390-PROCESS-ACTIVITY.
 18030
 18031     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 18032
 18033 7399-EXIT.
 18034     EXIT.
 18035
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 346
* EL156.cbl
 18037 7400-CHECK-AUTO-ACTIVITY.
 18038
 18039
 18040* EXEC CICS HANDLE CONDITION
 18041*        NOTFND   (7400-NOT-FOUND)
 18042*    END-EXEC.
 18043*    MOVE '"$I                   ! < #00016369' TO DFHEIV0
 18044     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18046     MOVE X'3C20233030303136333639' TO DFHEIV0(25:11)
 18047     CALL 'kxdfhei1' USING DFHEIV0
 18048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18049
 18050
 18051     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18052     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18053     MOVE SPACES                 TO  CNTL-ACCESS.
 18054     MOVE +0                     TO  CNTL-SEQ-NO.
 18055
 18056
 18057* EXEC CICS READ
 18058*        DATASET   ('ELCNTL')
 18059*        RIDFLD    (ELCNTL-KEY)
 18060*        SET       (ADDRESS OF CONTROL-FILE)
 18061*    END-EXEC.
 18062     MOVE 'ELCNTL' TO DFHEIV1
 18063*    MOVE '&"S        E          (   #00016378' TO DFHEIV0
 18064     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18065     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18066     MOVE X'2020233030303136333738' TO DFHEIV0(25:11)
 18067     CALL 'kxdfhei1' USING DFHEIV0,
 18068           DFHEIV1,
 18069           DFHEIV20,
 18070           DFHEIV99,
 18071           ELCNTL-KEY,
 18072           DFHEIV99,
 18073           DFHEIV99,
 18074           DFHEIV99
 18075     SET ADDRESS OF CONTROL-FILE TO
 18076         DFHEIV20
 18077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18078
 18079
 18080     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18081     GO TO 7400-EXIT.
 18082
 18083 7400-NOT-FOUND.
 18084     MOVE 'N'                        TO  PI-RESET-SW
 18085                                         WS-LETTER-SW
 18086                                         WS-ACT-REC-FOUND-SW.
 18087
 18088     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18089
 18090 7400-EXIT.
 18091     EXIT.
 18092
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 347
* EL156.cbl
 18094 7450-FORMAT-AUTO-LETTER.
 18095
 18096     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18097         MOVE 'Y'                    TO PI-RESET-SW
 18098         GO TO 7450-CONTINUE-PROCESS.
 18099
 18100     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18101
 18102     IF SUB > 9
 18103         SUBTRACT 9 FROM SUB
 18104         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18105     ELSE
 18106         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18107
 18108 7450-CONTINUE-PROCESS.
 18109
 18110     IF WS-ACTIVITY-CODE = ZEROS
 18111         MOVE 'N'                    TO  WS-LETTER-SW
 18112         GO TO 7499-EXIT.
 18113
 18114     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18115
 18116     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18117         MOVE 'N'                    TO  PI-RESET-SW
 18118                                         WS-LETTER-SW
 18119         GO TO 7499-EXIT.
 18120
 18121     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18122         MOVE 'N'                    TO  WS-LETTER-SW
 18123         GO TO 7499-EXIT.
 18124
 18125     MOVE 'Y'                        TO  WS-LETTER-SW.
 18126     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18127     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18128
 18129     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18130
 18131     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18132         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18133         MOVE '6'                    TO  DC-OPTION-CODE
 18134         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18135         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18136         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18137         IF NO-CONVERSION-ERROR
 18138             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18139         ELSE
 18140              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18141
 18142     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18143         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18144         MOVE '6'                    TO  DC-OPTION-CODE
 18145         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18146         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18147         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18148         IF NO-CONVERSION-ERROR
 18149             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18150         ELSE
 18151             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 348
* EL156.cbl
 18152
 18153 7499-EXIT.
 18154     EXIT.
 18155
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 349
* EL156.cbl
 18157 7500-RESET-AUTO-ACTIVITY.
 18158
 18159     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18160     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18161     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18162     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18163     MOVE +100                   TO  TRLR-SEQ-NO.
 18164
 18165 7500-STARTBR-TRLR.
 18166
 18167
 18168* EXEC CICS HANDLE CONDITION
 18169*        ENDFILE  (7590-END)
 18170*        NOTFND   (7590-END)
 18171*    END-EXEC.
 18172*    MOVE '"$''I                  ! = #00016471' TO DFHEIV0
 18173     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18175     MOVE X'3D20233030303136343731' TO DFHEIV0(25:11)
 18176     CALL 'kxdfhei1' USING DFHEIV0
 18177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18178
 18179
 18180
 18181* EXEC CICS STARTBR
 18182*        DATASET   ('ELTRLR')
 18183*        RIDFLD    (ELTRLR-KEY)
 18184*        GTEQ
 18185*    END-EXEC.
 18186     MOVE 'ELTRLR' TO DFHEIV1
 18187     MOVE 0
 18188       TO DFHEIV11
 18189*    MOVE '&,         G          &   #00016476' TO DFHEIV0
 18190     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18191     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18192     MOVE X'2020233030303136343736' TO DFHEIV0(25:11)
 18193     CALL 'kxdfhei1' USING DFHEIV0,
 18194           DFHEIV1,
 18195           ELTRLR-KEY,
 18196           DFHEIV99,
 18197           DFHEIV11,
 18198           DFHEIV99
 18199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18200
 18201
 18202     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18203
 18204 7500-READ-NEXT.
 18205
 18206
 18207* EXEC CICS READNEXT
 18208*        DATASET   ('ELTRLR')
 18209*        RIDFLD    (ELTRLR-KEY)
 18210*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18211*    END-EXEC.
 18212     MOVE 'ELTRLR' TO DFHEIV1
 18213     MOVE 0
 18214       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 350
* EL156.cbl
 18215*    MOVE '&.S                   )   #00016486' TO DFHEIV0
 18216     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18217     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18218     MOVE X'2020233030303136343836' TO DFHEIV0(25:11)
 18219     CALL 'kxdfhei1' USING DFHEIV0,
 18220           DFHEIV1,
 18221           DFHEIV20,
 18222           DFHEIV99,
 18223           ELTRLR-KEY,
 18224           DFHEIV99,
 18225           DFHEIV11,
 18226           DFHEIV99,
 18227           DFHEIV99
 18228     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18229         DFHEIV20
 18230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18231
 18232
 18233     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18234        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18235        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18236        PI-CERT-NO    NOT = TRLR-CERT-NO
 18237         GO TO 7590-END.
 18238
 18239     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18240         GO TO 7500-READ-NEXT.
 18241
 18242     IF AT-TRAILER-TYPE NOT = '4'
 18243         GO TO 7500-READ-NEXT.
 18244
 18245     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18246         GO TO 7500-READ-NEXT.
 18247
 18248     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18249        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18250         GO TO 7500-READ-NEXT.
 18251
 18252     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18253        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18254        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18255         GO TO 7500-READ-NEXT.
 18256
 18257     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18258                         AND
 18259        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18260                         AND
 18261        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18262            GO TO 7500-READ-NEXT.
 18263
 18264     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18265
 18266
 18267* EXEC CICS ENDBR
 18268*        DATASET   ('ELTRLR')
 18269*    END-EXEC.
 18270     MOVE 'ELTRLR' TO DFHEIV1
 18271     MOVE 0
 18272       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 351
* EL156.cbl
 18273*    MOVE '&2                    $   #00016525' TO DFHEIV0
 18274     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18275     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18276     MOVE X'2020233030303136353235' TO DFHEIV0(25:11)
 18277     CALL 'kxdfhei1' USING DFHEIV0,
 18278           DFHEIV1,
 18279           DFHEIV11,
 18280           DFHEIV99
 18281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18282
 18283
 18284     MOVE 'N'                        TO  WS-BROWSE-SW.
 18285
 18286
 18287* EXEC CICS READ
 18288*        DATASET   ('ELTRLR')
 18289*        RIDFLD    (ELTRLR-KEY)
 18290*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18291*        UPDATE
 18292*    END-EXEC.
 18293     MOVE 'ELTRLR' TO DFHEIV1
 18294*    MOVE '&"S        EU         (   #00016531' TO DFHEIV0
 18295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18296     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18297     MOVE X'2020233030303136353331' TO DFHEIV0(25:11)
 18298     CALL 'kxdfhei1' USING DFHEIV0,
 18299           DFHEIV1,
 18300           DFHEIV20,
 18301           DFHEIV99,
 18302           ELTRLR-KEY,
 18303           DFHEIV99,
 18304           DFHEIV99,
 18305           DFHEIV99
 18306     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18307         DFHEIV20
 18308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18309
 18310
 18311     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18312
 18313     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18314         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18315     ELSE
 18316         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18317             NEXT SENTENCE
 18318         ELSE
 18319             GO TO 7500-REWRITE-TRLR.
 18320
 18321     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18322
 18323     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18324     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18325     MOVE '1'                        TO  ARCH-REC-TYPE.
 18326     MOVE +0                         TO  ARCH-SEQ.
 18327
 18328     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18329
 18330 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 352
* EL156.cbl
 18331
 18332
 18333* EXEC CICS REWRITE
 18334*        DATASET   ('ELTRLR')
 18335*        FROM      (ACTIVITY-TRAILERS)
 18336*    END-EXEC.
 18337     MOVE LENGTH OF
 18338      ACTIVITY-TRAILERS
 18339       TO DFHEIV11
 18340     MOVE 'ELTRLR' TO DFHEIV1
 18341*    MOVE '&& L                  %   #00016559' TO DFHEIV0
 18342     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18343     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18344     MOVE X'2020233030303136353539' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0,
 18346           DFHEIV1,
 18347           ACTIVITY-TRAILERS,
 18348           DFHEIV11,
 18349           DFHEIV99
 18350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18351
 18352
 18353     GO TO 7500-STARTBR-TRLR.
 18354
 18355 7590-END.
 18356
 18357     IF WS-BROWSE-SW = 'Y'
 18358         MOVE 'N'                    TO  WS-BROWSE-SW
 18359
 18360* EXEC CICS ENDBR
 18361*            DATASET   ('ELTRLR')
 18362*        END-EXEC.
 18363     MOVE 'ELTRLR' TO DFHEIV1
 18364     MOVE 0
 18365       TO DFHEIV11
 18366*    MOVE '&2                    $   #00016570' TO DFHEIV0
 18367     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18368     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18369     MOVE X'2020233030303136353730' TO DFHEIV0(25:11)
 18370     CALL 'kxdfhei1' USING DFHEIV0,
 18371           DFHEIV1,
 18372           DFHEIV11,
 18373           DFHEIV99
 18374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18375
 18376
 18377 7599-EXIT.
 18378     EXIT.
 18379
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 353
* EL156.cbl
 18381 7600-READ-ARCH-UPDATE.
 18382
 18383
 18384* EXEC CICS HANDLE CONDITION
 18385*        NOTFND   (7699-EXIT)
 18386*    END-EXEC.
 18387*    MOVE '"$I                   ! > #00016580' TO DFHEIV0
 18388     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18390     MOVE X'3E20233030303136353830' TO DFHEIV0(25:11)
 18391     CALL 'kxdfhei1' USING DFHEIV0
 18392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18393
 18394
 18395
 18396* EXEC CICS READ
 18397*        DATASET   ('ELARCH')
 18398*        RIDFLD    (ELARCH-KEY)
 18399*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18400*        UPDATE
 18401*    END-EXEC.
 18402     MOVE 'ELARCH' TO DFHEIV1
 18403*    MOVE '&"S        EU         (   #00016584' TO DFHEIV0
 18404     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18405     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18406     MOVE X'2020233030303136353834' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0,
 18408           DFHEIV1,
 18409           DFHEIV20,
 18410           DFHEIV99,
 18411           ELARCH-KEY,
 18412           DFHEIV99,
 18413           DFHEIV99,
 18414           DFHEIV99
 18415     SET ADDRESS OF LETTER-ARCHIVE TO
 18416         DFHEIV20
 18417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18418
 18419
 18420     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18421
 18422
 18423* EXEC CICS REWRITE
 18424*        DATASET   ('ELARCH')
 18425*        FROM      (LETTER-ARCHIVE)
 18426*    END-EXEC.
 18427     MOVE LENGTH OF
 18428      LETTER-ARCHIVE
 18429       TO DFHEIV11
 18430     MOVE 'ELARCH' TO DFHEIV1
 18431*    MOVE '&& L                  %   #00016593' TO DFHEIV0
 18432     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18433     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18434     MOVE X'2020233030303136353933' TO DFHEIV0(25:11)
 18435     CALL 'kxdfhei1' USING DFHEIV0,
 18436           DFHEIV1,
 18437           LETTER-ARCHIVE,
 18438           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 354
* EL156.cbl
 18439           DFHEIV99
 18440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18441
 18442
 18443 7699-EXIT.
 18444     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 355
* EL156.cbl
 18446 7700-GET-DCT.
 18447
 18448     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18449     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18450     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18451     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18452                                    PI-MAX-BENEFIT-AMT
 18453                                    PI-MAX-BENEFIT-PYMT
 18454                                    PI-MIN-PAYMENT-AMT
 18455                                    PI-TIME-OF-LOSS-BAL.
 18456
 18457
 18458* EXEC CICS HANDLE CONDITION
 18459*         NOTFND (5300-NOTE-NOT-FOUND)
 18460*     END-EXEC.
 18461*    MOVE '"$I                   ! ? #00016612' TO DFHEIV0
 18462     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18464     MOVE X'3F20233030303136363132' TO DFHEIV0(25:11)
 18465     CALL 'kxdfhei1' USING DFHEIV0
 18466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18467
 18468
 18469
 18470* EXEC CICS READ
 18471*         DATASET('ERNOTE')
 18472*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18473*         RIDFLD (W-NOTE-KEY)
 18474*     END-EXEC.
 18475     MOVE 'ERNOTE' TO DFHEIV1
 18476*    MOVE '&"S        E          (   #00016616' TO DFHEIV0
 18477     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18479     MOVE X'2020233030303136363136' TO DFHEIV0(25:11)
 18480     CALL 'kxdfhei1' USING DFHEIV0,
 18481           DFHEIV1,
 18482           DFHEIV20,
 18483           DFHEIV99,
 18484           W-NOTE-KEY,
 18485           DFHEIV99,
 18486           DFHEIV99,
 18487           DFHEIV99
 18488     SET ADDRESS OF CERTIFICATE-NOTE TO
 18489         DFHEIV20
 18490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18491
 18492
 18493     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18494     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18495     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18496     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18497     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18498
 18499     IF PI-PAYEE-TYPE NOT = 'B'
 18500         GO TO 7700-EXIT.
 18501
 18502     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18503     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 356
* EL156.cbl
 18504     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18505
 18506     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18507         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18508     ELSE
 18509         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18510
 18511     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18512     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18513     MOVE 'DLO006'               TO PGM-NAME.
 18514
 18515
 18516* EXEC CICS LINK
 18517*        PROGRAM    (PGM-NAME)
 18518*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18519*        LENGTH     (DCT-RCRD-LENGTH)
 18520*    END-EXEC.
 18521*    MOVE '."C                   (   #00016644' TO DFHEIV0
 18522     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18524     MOVE X'2020233030303136363434' TO DFHEIV0(25:11)
 18525     CALL 'kxdfhei1' USING DFHEIV0,
 18526           PGM-NAME,
 18527           DCT-COMMUNICATION-AREA,
 18528           DCT-RCRD-LENGTH,
 18529           DFHEIV99,
 18530           DFHEIV99,
 18531           DFHEIV99,
 18532           DFHEIV99
 18533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18534
 18535
 18536     IF DCT-RETURN-CODE = 'OK'
 18537         GO TO 7700-CONT.
 18538
 18539     IF DCT-RETURN-CODE = '01' OR '02'
 18540         GO TO 7700-SET-TO-YES.
 18541
 18542     IF DCT-RETURN-CODE = '03'
 18543
 18544* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18545*    MOVE '6"R                   !   #00016657' TO DFHEIV0
 18546     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18548     MOVE X'2020233030303136363537' TO DFHEIV0(25:11)
 18549     CALL 'kxdfhei1' USING DFHEIV0
 18550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18551         MOVE ER-0951            TO EMI-ERROR
 18552         MOVE -1                 TO PMTTYPEL
 18553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18554         GO TO 8200-SEND-DATAONLY.
 18555
 18556     IF DCT-RETURN-CODE = '04'
 18557
 18558* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18559*    MOVE '6"R                   !   #00016664' TO DFHEIV0
 18560     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 357
* EL156.cbl
 18562     MOVE X'2020233030303136363634' TO DFHEIV0(25:11)
 18563     CALL 'kxdfhei1' USING DFHEIV0
 18564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18565         MOVE ER-0946            TO EMI-ERROR
 18566         MOVE -1                 TO PMTTYPEL
 18567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18568         GO TO 8200-SEND-DATAONLY.
 18569
 18570     IF DCT-RETURN-CODE = '05'
 18571
 18572* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18573*    MOVE '6"R                   !   #00016671' TO DFHEIV0
 18574     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18576     MOVE X'2020233030303136363731' TO DFHEIV0(25:11)
 18577     CALL 'kxdfhei1' USING DFHEIV0
 18578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18579         MOVE ER-0947            TO EMI-ERROR
 18580         MOVE -1                 TO PMTTYPEL
 18581         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18582         GO TO 8200-SEND-DATAONLY.
 18583
 18584     IF DCT-RETURN-CODE = '06'
 18585
 18586* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18587*    MOVE '6"R                   !   #00016678' TO DFHEIV0
 18588     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18589     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18590     MOVE X'2020233030303136363738' TO DFHEIV0(25:11)
 18591     CALL 'kxdfhei1' USING DFHEIV0
 18592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18593         MOVE ER-0921            TO EMI-ERROR
 18594         MOVE -1                 TO PMTTYPEL
 18595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18596         GO TO 8200-SEND-DATAONLY.
 18597
 18598     IF DCT-RETURN-CODE = '07'
 18599
 18600* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18601*    MOVE '6"R                   !   #00016685' TO DFHEIV0
 18602     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18604     MOVE X'2020233030303136363835' TO DFHEIV0(25:11)
 18605     CALL 'kxdfhei1' USING DFHEIV0
 18606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18607         MOVE ER-0919            TO EMI-ERROR
 18608         MOVE -1                 TO PMTTYPEL
 18609         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18610         GO TO 8200-SEND-DATAONLY.
 18611
 18612     IF DCT-RETURN-CODE = '08'
 18613
 18614* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18615*    MOVE '6"R                   !   #00016692' TO DFHEIV0
 18616     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18618     MOVE X'2020233030303136363932' TO DFHEIV0(25:11)
 18619     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 358
* EL156.cbl
 18620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18621         MOVE ER-0948            TO EMI-ERROR
 18622         MOVE -1                 TO PMTTYPEL
 18623         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18624         GO TO 8200-SEND-DATAONLY.
 18625
 18626     IF DCT-RETURN-CODE = 'N1'
 18627
 18628* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18629*    MOVE '6"R                   !   #00016699' TO DFHEIV0
 18630     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18632     MOVE X'2020233030303136363939' TO DFHEIV0(25:11)
 18633     CALL 'kxdfhei1' USING DFHEIV0
 18634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18635         MOVE ER-0950            TO EMI-ERROR
 18636         MOVE -1                 TO PMTTYPEL
 18637         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18638         GO TO 8200-SEND-DATAONLY.
 18639
 18640     IF DCT-RETURN-CODE = 'E1'
 18641
 18642* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18643*    MOVE '6"R                   !   #00016706' TO DFHEIV0
 18644     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18646     MOVE X'2020233030303136373036' TO DFHEIV0(25:11)
 18647     CALL 'kxdfhei1' USING DFHEIV0
 18648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18649         MOVE ER-0974            TO EMI-ERROR
 18650         MOVE -1                 TO PMTTYPEL
 18651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18652         GO TO 8200-SEND-DATAONLY.
 18653
 18654     IF DCT-RETURN-CODE = 'E2'
 18655
 18656* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18657*    MOVE '6"R                   !   #00016713' TO DFHEIV0
 18658     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18659     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18660     MOVE X'2020233030303136373133' TO DFHEIV0(25:11)
 18661     CALL 'kxdfhei1' USING DFHEIV0
 18662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18663         MOVE ER-0975            TO EMI-ERROR
 18664         MOVE -1                 TO PMTTYPEL
 18665         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18666         GO TO 8200-SEND-DATAONLY.
 18667
 18668     IF DCT-RETURN-CODE NOT = 'OK'
 18669
 18670* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18671*    MOVE '6"R                   !   #00016720' TO DFHEIV0
 18672     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18674     MOVE X'2020233030303136373230' TO DFHEIV0(25:11)
 18675     CALL 'kxdfhei1' USING DFHEIV0
 18676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18677         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 359
* EL156.cbl
 18678         MOVE -1                 TO PMTTYPEL
 18679         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18680         GO TO 8200-SEND-DATAONLY.
 18681
 18682 7700-CONT.
 18683
 18684*    MOVE 'N'                    TO CASHO.
 18685*    MOVE +1                     TO CASHL.
 18686*    MOVE AL-UANON               TO CASHA.
 18687
 18688     IF PI-OFFLINE = 'Y'
 18689         GO TO 7700-EXIT.
 18690
 18691     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 18692     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 18693     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 18694     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 18695     MOVE +7                     TO CHECKNOL.
 18696     MOVE AL-UANON               TO CHECKNOA.
 18697     GO TO 7700-EXIT.
 18698
 18699 7700-SET-TO-YES.
 18700
 18701*    MOVE 'Y'                    TO CASHO.
 18702*    MOVE +1                     TO CASHL.
 18703*    MOVE AL-UANON               TO CASHA.
 18704
 18705 7700-EXIT.
 18706     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 360
* EL156.cbl
 18708 7800-READ-COMP-MSTR.
 18709
 18710
 18711* EXEC CICS HANDLE CONDITION
 18712*        NOTFND   (7800-COMP-NOTFND)
 18713*    END-EXEC.
 18714*    MOVE '"$I                   ! @ #00016754' TO DFHEIV0
 18715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18717     MOVE X'4020233030303136373534' TO DFHEIV0(25:11)
 18718     CALL 'kxdfhei1' USING DFHEIV0
 18719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18720
 18721
 18722
 18723* EXEC CICS READ
 18724*        DATASET   ('ERCOMP')
 18725*        RIDFLD    (ERCOMP-KEY)
 18726*        SET       (ADDRESS OF COMPENSATION-MASTER)
 18727*    END-EXEC.
 18728     MOVE 'ERCOMP' TO DFHEIV1
 18729*    MOVE '&"S        E          (   #00016758' TO DFHEIV0
 18730     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18732     MOVE X'2020233030303136373538' TO DFHEIV0(25:11)
 18733     CALL 'kxdfhei1' USING DFHEIV0,
 18734           DFHEIV1,
 18735           DFHEIV20,
 18736           DFHEIV99,
 18737           ERCOMP-KEY,
 18738           DFHEIV99,
 18739           DFHEIV99,
 18740           DFHEIV99
 18741     SET ADDRESS OF COMPENSATION-MASTER TO
 18742         DFHEIV20
 18743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18744
 18745
 18746     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 18747     GO TO 7800-COMP-EXIT.
 18748
 18749 7800-COMP-NOTFND.
 18750     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 18751
 18752 7800-COMP-EXIT.
 18753     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 361
* EL156.cbl
 18755 7900-READ-CLAIM.
 18756
 18757* EXEC CICS READ
 18758*        DATASET  ('ELMSTR')
 18759*        SET      (ADDRESS OF CLAIM-MASTER)
 18760*        RIDFLD   (ELMSTR-KEY)
 18761*    END-EXEC.
 18762     MOVE 'ELMSTR' TO DFHEIV1
 18763*    MOVE '&"S        E          (   #00016774' TO DFHEIV0
 18764     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18766     MOVE X'2020233030303136373734' TO DFHEIV0(25:11)
 18767     CALL 'kxdfhei1' USING DFHEIV0,
 18768           DFHEIV1,
 18769           DFHEIV20,
 18770           DFHEIV99,
 18771           ELMSTR-KEY,
 18772           DFHEIV99,
 18773           DFHEIV99,
 18774           DFHEIV99
 18775     SET ADDRESS OF CLAIM-MASTER TO
 18776         DFHEIV20
 18777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18778
 18779
 18780 7900-EXIT.
 18781      EXIT.
 18782
 18783 7910-READ-CLAIM-UPDATE.
 18784
 18785* EXEC CICS READ
 18786*        DATASET  ('ELMSTR')
 18787*        SET      (ADDRESS OF CLAIM-MASTER)
 18788*        RIDFLD   (ELMSTR-KEY)
 18789*        UPDATE
 18790*    END-EXEC.
 18791     MOVE 'ELMSTR' TO DFHEIV1
 18792*    MOVE '&"S        EU         (   #00016784' TO DFHEIV0
 18793     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18794     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18795     MOVE X'2020233030303136373834' TO DFHEIV0(25:11)
 18796     CALL 'kxdfhei1' USING DFHEIV0,
 18797           DFHEIV1,
 18798           DFHEIV20,
 18799           DFHEIV99,
 18800           ELMSTR-KEY,
 18801           DFHEIV99,
 18802           DFHEIV99,
 18803           DFHEIV99
 18804     SET ADDRESS OF CLAIM-MASTER TO
 18805         DFHEIV20
 18806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18807
 18808
 18809 7910-EXIT.
 18810      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 362
* EL156.cbl
 18812 7920-READ-BENE.
 18813     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 18814     MOVE 'B'                TO BENE-RECORD-TYPE.
 18815     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 18816
 18817     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18818        IF PI-PAYEE-TYPE    = 'B' AND
 18819           PI-PAYEE-SEQ-NUM = 9
 18820             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 18821             MOVE WS-A-BENE           TO BENE-NUMBER.
 18822
 18823
 18824* EXEC CICS HANDLE CONDITION
 18825*        NOTFND   (7920-NOT-FOUND)
 18826*    END-EXEC.
 18827*    MOVE '"$I                   ! A #00016805' TO DFHEIV0
 18828     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18830     MOVE X'4120233030303136383035' TO DFHEIV0(25:11)
 18831     CALL 'kxdfhei1' USING DFHEIV0
 18832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18833
 18834
 18835
 18836* EXEC CICS READ
 18837*        DATASET  ('ELBENE')
 18838*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 18839*        RIDFLD   (ELBENE-KEY)
 18840*    END-EXEC.
 18841     MOVE 'ELBENE' TO DFHEIV1
 18842*    MOVE '&"S        E          (   #00016809' TO DFHEIV0
 18843     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18844     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18845     MOVE X'2020233030303136383039' TO DFHEIV0(25:11)
 18846     CALL 'kxdfhei1' USING DFHEIV0,
 18847           DFHEIV1,
 18848           DFHEIV20,
 18849           DFHEIV99,
 18850           ELBENE-KEY,
 18851           DFHEIV99,
 18852           DFHEIV99,
 18853           DFHEIV99
 18854     SET ADDRESS OF BENEFICIARY-MASTER TO
 18855         DFHEIV20
 18856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18857
 18858
 18859     MOVE 'Y' TO BENE-FOUND-SW.
 18860     GO TO 7920-EXIT.
 18861
 18862 7920-NOT-FOUND.
 18863     MOVE 'N'                    TO BENE-FOUND-SW.
 18864
 18865 7920-EXIT.
 18866      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 363
* EL156.cbl
 18868 7930-READ-CONTROL.
 18869
 18870* EXEC CICS READ
 18871*        DATASET  ('ELCNTL')
 18872*        SET      (ADDRESS OF CONTROL-FILE)
 18873*        RIDFLD   (ELCNTL-KEY)
 18874*    END-EXEC.
 18875     MOVE 'ELCNTL' TO DFHEIV1
 18876*    MOVE '&"S        E          (   #00016825' TO DFHEIV0
 18877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18879     MOVE X'2020233030303136383235' TO DFHEIV0(25:11)
 18880     CALL 'kxdfhei1' USING DFHEIV0,
 18881           DFHEIV1,
 18882           DFHEIV20,
 18883           DFHEIV99,
 18884           ELCNTL-KEY,
 18885           DFHEIV99,
 18886           DFHEIV99,
 18887           DFHEIV99
 18888     SET ADDRESS OF CONTROL-FILE TO
 18889         DFHEIV20
 18890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18891
 18892
 18893 7930-EXIT.
 18894      EXIT.
 18895
 18896 7940-READ-CONTROL-UPDATE.
 18897
 18898* EXEC CICS READ
 18899*        DATASET  ('ELCNTL')
 18900*        SET      (ADDRESS OF CONTROL-FILE)
 18901*        RIDFLD   (ELCNTL-KEY)
 18902*        UPDATE
 18903*    END-EXEC.
 18904     MOVE 'ELCNTL' TO DFHEIV1
 18905*    MOVE '&"S        EU         (   #00016835' TO DFHEIV0
 18906     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18907     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18908     MOVE X'2020233030303136383335' TO DFHEIV0(25:11)
 18909     CALL 'kxdfhei1' USING DFHEIV0,
 18910           DFHEIV1,
 18911           DFHEIV20,
 18912           DFHEIV99,
 18913           ELCNTL-KEY,
 18914           DFHEIV99,
 18915           DFHEIV99,
 18916           DFHEIV99
 18917     SET ADDRESS OF CONTROL-FILE TO
 18918         DFHEIV20
 18919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18920
 18921
 18922 7940-EXIT.
 18923      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 364
* EL156.cbl
 18925 7950-READ-TRAILER.
 18926
 18927* EXEC CICS READ
 18928*        DATASET  ('ELTRLR')
 18929*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18930*        RIDFLD   (ELTRLR-KEY)
 18931*    END-EXEC.
 18932     MOVE 'ELTRLR' TO DFHEIV1
 18933*    MOVE '&"S        E          (   #00016846' TO DFHEIV0
 18934     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18936     MOVE X'2020233030303136383436' TO DFHEIV0(25:11)
 18937     CALL 'kxdfhei1' USING DFHEIV0,
 18938           DFHEIV1,
 18939           DFHEIV20,
 18940           DFHEIV99,
 18941           ELTRLR-KEY,
 18942           DFHEIV99,
 18943           DFHEIV99,
 18944           DFHEIV99
 18945     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18946         DFHEIV20
 18947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18948
 18949
 18950 7950-EXIT.
 18951      EXIT.
 18952
 18953 7960-READ-TRAILER-UPDATE.
 18954
 18955* EXEC CICS READ
 18956*        DATASET  ('ELTRLR')
 18957*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18958*        RIDFLD   (ELTRLR-KEY)
 18959*        UPDATE
 18960*    END-EXEC.
 18961     MOVE 'ELTRLR' TO DFHEIV1
 18962*    MOVE '&"S        EU         (   #00016856' TO DFHEIV0
 18963     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18964     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18965     MOVE X'2020233030303136383536' TO DFHEIV0(25:11)
 18966     CALL 'kxdfhei1' USING DFHEIV0,
 18967           DFHEIV1,
 18968           DFHEIV20,
 18969           DFHEIV99,
 18970           ELTRLR-KEY,
 18971           DFHEIV99,
 18972           DFHEIV99,
 18973           DFHEIV99
 18974     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18975         DFHEIV20
 18976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18977
 18978
 18979 7960-EXIT.
 18980      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 365
* EL156.cbl
 18982 7970-READ-CERT.
 18983
 18984* EXEC CICS READ
 18985*        DATASET  ('ELCERT')
 18986*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 18987*        RIDFLD   (ELCERT-KEY)
 18988*    END-EXEC.
 18989     MOVE 'ELCERT' TO DFHEIV1
 18990*    MOVE '&"S        E          (   #00016867' TO DFHEIV0
 18991     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18993     MOVE X'2020233030303136383637' TO DFHEIV0(25:11)
 18994     CALL 'kxdfhei1' USING DFHEIV0,
 18995           DFHEIV1,
 18996           DFHEIV20,
 18997           DFHEIV99,
 18998           ELCERT-KEY,
 18999           DFHEIV99,
 19000           DFHEIV99,
 19001           DFHEIV99
 19002     SET ADDRESS OF CERTIFICATE-MASTER TO
 19003         DFHEIV20
 19004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19005
 19006
 19007 7970-EXIT.
 19008      EXIT.
 19009 7975-read-acct.
 19010
 19011     move spaces              to WS-ACCT-RECORD-SW
 19012                                 pi-dcc-product-code
 19013
 19014     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19015     MOVE PI-CARRIER          TO ACCT-CARRIER
 19016     MOVE PI-GROUPING         TO ACCT-GROUPING
 19017     MOVE PI-STATE            TO ACCT-STATE
 19018     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19019     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19020     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19021     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19022
 19023
 19024* EXEC CICS READ
 19025*       DATASET ('ERACCT')
 19026*       RIDFLD  (ERACCT-KEY)
 19027*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19028*       GTEQ
 19029*       resp    (WS-RESPONSE)
 19030*    END-EXEC
 19031     MOVE 'ERACCT' TO DFHEIV1
 19032*    MOVE '&"S        G          (  N#00016889' TO DFHEIV0
 19033     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19035     MOVE X'204E233030303136383839' TO DFHEIV0(25:11)
 19036     CALL 'kxdfhei1' USING DFHEIV0,
 19037           DFHEIV1,
 19038           DFHEIV20,
 19039           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 366
* EL156.cbl
 19040           ERACCT-KEY,
 19041           DFHEIV99,
 19042           DFHEIV99,
 19043           DFHEIV99
 19044     SET ADDRESS OF ACCOUNT-MASTER TO
 19045         DFHEIV20
 19046     MOVE EIBRESP  TO WS-RESPONSE
 19047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19048     IF WS-RESP-NORMAL
 19049        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19050        and pi-cert-eff-dt < am-expiration-dt
 19051        and pi-cert-eff-dt >= am-effective-dt
 19052        move am-dcc-product-code to pi-dcc-product-code
 19053        set acct-found to true
 19054     end-if
 19055
 19056     .
 19057 7975-exit.
 19058     exit.
 19059 7980-READ-CERT-UPDATE.
 19060
 19061* EXEC CICS READ
 19062*        DATASET  ('ELCERT')
 19063*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19064*        RIDFLD   (ELCERT-KEY)
 19065*        UPDATE
 19066*    END-EXEC.
 19067     MOVE 'ELCERT' TO DFHEIV1
 19068*    MOVE '&"S        EU         (   #00016908' TO DFHEIV0
 19069     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19070     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19071     MOVE X'2020233030303136393038' TO DFHEIV0(25:11)
 19072     CALL 'kxdfhei1' USING DFHEIV0,
 19073           DFHEIV1,
 19074           DFHEIV20,
 19075           DFHEIV99,
 19076           ELCERT-KEY,
 19077           DFHEIV99,
 19078           DFHEIV99,
 19079           DFHEIV99
 19080     SET ADDRESS OF CERTIFICATE-MASTER TO
 19081         DFHEIV20
 19082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19083
 19084
 19085 7980-EXIT.
 19086      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 367
* EL156.cbl
 19088 8000-LOAD-ERROR-MESSAGES.
 19089     IF PI-PASS-SW = 'C'
 19090        MOVE EMI-LINE1           TO ERMSG1BO
 19091     ELSE
 19092        MOVE EMI-LINE1           TO ERRMSG1O
 19093        MOVE EMI-LINE2           TO ERRMSG2O.
 19094
 19095 8000-EXIT.
 19096     EXIT.
 19097
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 368
* EL156.cbl
 19099
 19100 8010-DMD-ERROR-CHECKS.
 19101     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19102
 19103     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19104         GO TO 8051-ISSUE-ERROR.
 19105
 19106     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19107     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19108     MOVE '3'                    TO DC-OPTION-CODE.
 19109     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19110     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19111         GO TO 8051-ISSUE-ERROR.
 19112
 19113     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19114       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19115                           OR
 19116          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19117           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19118             MOVE ER-0851         TO EMI-ERROR
 19119             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19120       END-IF
 19121       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19122             MOVE ER-8147         TO EMI-ERROR
 19123             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19124
 19125     GO TO 8090-EXIT.
 19126
 19127 8051-ISSUE-ERROR.
 19128     MOVE ER-8146            TO EMI-ERROR.
 19129     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19130     GO TO 8090-EXIT.
 19131
 19132 8090-EXIT.
 19133      EXIT.
 19134
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 369
* EL156.cbl
 19136 8100-SEND-INITIAL-MAP.
 19137
 19138     MOVE SAVE-DATE              TO RUNDTEAO.
 19139     MOVE EIBTIME                TO TIME-IN.
 19140     MOVE TIME-OUT               TO RUNTIMAO.
 19141     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19142
 19143     IF MAP-NAME = 'EL156A'
 19144        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19145           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19146        END-IF
 19147     END-IF
 19148*    IF MAP-NAME = 'EL156A'
 19149*       IF PI-COMPANY-ID = 'CRI'
 19150*          NEXT SENTENCE
 19151*       ELSE
 19152*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19153
 19154     IF MAP-NAME = 'EL156A'
 19155        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19156           NEXT SENTENCE
 19157        ELSE
 19158           MOVE AL-SADOF TO  PINTA    PINTHA.
 19159
 19160     IF MAP-NAME = 'EL156A'
 19161        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19162            NEXT SENTENCE
 19163        ELSE
 19164           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19165
 19166*    IF MAP-NAME = 'EL156A'
 19167*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19168*          NEXT SENTENCE
 19169*       ELSE
 19170*          MOVE AL-SADOF TO CASHHA CASHA.
 19171
 19172     IF MAP-NAME = 'EL156A'
 19173        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19174           NEXT SENTENCE
 19175        ELSE
 19176           MOVE AL-SADOF        TO  LOANHA
 19177                                    LOANNOA.
 19178
 19179     IF MAP-NAME = 'EL156A'
 19180        MOVE -1                 TO  ENTERPFL
 19181        IF PI-USES-PAID-TO
 19182           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19183           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19184           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19185        ELSE
 19186           NEXT SENTENCE
 19187     ELSE
 19188        IF MAP-NAME = 'EL156B'
 19189           IF PI-USES-PAID-TO
 19190              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19191              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19192
 19193
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 370
* EL156.cbl
 19194* EXEC CICS SEND
 19195*        MAP   (MAP-NAME)
 19196*        MAPSET(MAPSET-NAME)
 19197*        FROM  (EL156AI)
 19198*        ERASE
 19199*        CURSOR
 19200*    END-EXEC.
 19201     MOVE LENGTH OF
 19202      EL156AI
 19203       TO DFHEIV12
 19204     MOVE -1
 19205       TO DFHEIV11
 19206*    MOVE '8$     CT  E    H L F ,   #00017023' TO DFHEIV0
 19207     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19208     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19209     MOVE X'2020233030303137303233' TO DFHEIV0(25:11)
 19210     CALL 'kxdfhei1' USING DFHEIV0,
 19211           MAP-NAME,
 19212           EL156AI,
 19213           DFHEIV12,
 19214           MAPSET-NAME,
 19215           DFHEIV99,
 19216           DFHEIV99,
 19217           DFHEIV99,
 19218           DFHEIV11,
 19219           DFHEIV99,
 19220           DFHEIV99,
 19221           DFHEIV99
 19222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19223
 19224
 19225     GO TO 9100-RETURN-TRAN.
 19226
 19227 8200-SEND-DATAONLY.
 19228
 19229     IF FIRST-ENTRY = 'Y'
 19230         GO TO 8100-SEND-INITIAL-MAP.
 19231
 19232     IF RETURNED-FROM-B = 'Y'
 19233         GO TO 8100-SEND-INITIAL-MAP.
 19234
 19235     MOVE SAVE-DATE              TO RUNDTEAO.
 19236     MOVE EIBTIME                TO TIME-IN.
 19237     MOVE TIME-OUT               TO RUNTIMAO.
 19238
 19239     IF EIBAID = DFHPF11
 19240        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19241        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19242        MOVE 'EL001   '          TO RETURNED-FROM
 19243        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19244        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19245        GO TO 8100-SEND-INITIAL-MAP.
 19246
 19247     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19248
 19249     IF MAP-NAME =  'EL156A'
 19250        MOVE -1                 TO  ENTERPFL
 19251        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 371
* EL156.cbl
 19252           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19253           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19254           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19255        ELSE
 19256           NEXT SENTENCE
 19257     ELSE
 19258        IF MAP-NAME = 'EL156B'
 19259           IF PI-USES-PAID-TO
 19260              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19261              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19262
 19263     IF MAP-NAME =  'EL156A'
 19264        IF PI-COMPANY-ID = 'BOA'
 19265            IF PI-INT-RATE NUMERIC
 19266                MOVE PI-INT-RATE TO PINTO.
 19267     IF MAP-NAME = 'EL156A'
 19268        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19269           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19270*          MOVE 'Y'              TO EOBYNO
 19271        END-IF
 19272     END-IF
 19273
 19274
 19275* EXEC CICS SEND
 19276*        MAP   (MAP-NAME)
 19277*        MAPSET(MAPSET-NAME)
 19278*        FROM  (EL156AI)
 19279*        DATAONLY
 19280*        CURSOR
 19281*    END-EXEC.
 19282     MOVE LENGTH OF
 19283      EL156AI
 19284       TO DFHEIV12
 19285     MOVE -1
 19286       TO DFHEIV11
 19287*    MOVE '8$D    CT       H L F ,   #00017080' TO DFHEIV0
 19288     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19289     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19290     MOVE X'2020233030303137303830' TO DFHEIV0(25:11)
 19291     CALL 'kxdfhei1' USING DFHEIV0,
 19292           MAP-NAME,
 19293           EL156AI,
 19294           DFHEIV12,
 19295           MAPSET-NAME,
 19296           DFHEIV99,
 19297           DFHEIV99,
 19298           DFHEIV99,
 19299           DFHEIV11,
 19300           DFHEIV99,
 19301           DFHEIV99,
 19302           DFHEIV99
 19303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19304
 19305
 19306     GO TO 9100-RETURN-TRAN.
 19307
 19308 8300-SEND-TEXT.
 19309
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 372
* EL156.cbl
 19310* EXEC CICS SEND TEXT
 19311*        FROM(LOGOFF-TEXT)
 19312*        LENGTH(LOGOFF-LENGTH)
 19313*        ERASE
 19314*        FREEKB
 19315*    END-EXEC.
 19316*    MOVE '8&      T  E F  H   F -   #00017091' TO DFHEIV0
 19317     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19318     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19319     MOVE X'2020233030303137303931' TO DFHEIV0(25:11)
 19320     CALL 'kxdfhei1' USING DFHEIV0,
 19321           LOGOFF-TEXT,
 19322           LOGOFF-LENGTH,
 19323           DFHEIV99,
 19324           DFHEIV99,
 19325           DFHEIV99,
 19326           DFHEIV99,
 19327           DFHEIV99,
 19328           DFHEIV99,
 19329           DFHEIV99,
 19330           DFHEIV99,
 19331           DFHEIV99,
 19332           DFHEIV99
 19333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19334
 19335
 19336
 19337* EXEC CICS RETURN
 19338*    END-EXEC.
 19339*    MOVE '.(                    ''   #00017098' TO DFHEIV0
 19340     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19341     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19342     MOVE X'2020233030303137303938' TO DFHEIV0(25:11)
 19343     CALL 'kxdfhei1' USING DFHEIV0,
 19344           DFHEIV99,
 19345           DFHEIV99,
 19346           DFHEIV99,
 19347           DFHEIV99,
 19348           DFHEIV99,
 19349           DFHEIV99
 19350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19351
 19352
 19353 8500-FILE-NOTOPEN.
 19354     IF FILE-SWITCH = 'MSTR'
 19355         MOVE ER-0154            TO EMI-ERROR.
 19356     IF FILE-SWITCH = 'TRLR'
 19357         MOVE ER-0172            TO EMI-ERROR.
 19358     IF FILE-SWITCH = 'CERT'
 19359         MOVE ER-0169            TO EMI-ERROR.
 19360     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19361                      'PROC' OR 'STAT'
 19362         MOVE ER-0042            TO EMI-ERROR.
 19363     IF FILE-SWITCH = 'ACTQ'
 19364         MOVE ER-0338            TO EMI-ERROR.
 19365     IF FILE-SWITCH = 'ACCT'
 19366         MOVE ER-0168            TO EMI-ERROR.
 19367
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 373
* EL156.cbl
 19368     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19369     MOVE -1                     TO PMTTYPEL.
 19370
 19371     IF FIRST-ENTRY = 'Y'
 19372         GO TO 8100-SEND-INITIAL-MAP.
 19373
 19374     GO TO 8200-SEND-DATAONLY.
 19375
 19376 8600-PGRM-NOT-FOUND.
 19377
 19378     MOVE ER-0923                TO EMI-ERROR.
 19379     MOVE -1                     TO ENTPFBL.
 19380     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19381
 19382     IF FIRST-ENTRY = 'Y'
 19383         GO TO 8100-SEND-INITIAL-MAP
 19384     ELSE
 19385         GO TO 8200-SEND-DATAONLY.
 19386
 19387 8800-UNAUTHORIZED-ACCESS.
 19388     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19389     GO TO 8300-SEND-TEXT.
 19390
 19391 8810-PF23.
 19392     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19393     MOVE XCTL-005               TO PGM-NAME.
 19394     GO TO 9300-XCTL.
 19395
 19396 8820-PF7-8.
 19397     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19398     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19399                                    PI-SAVED-PROGRAM-2
 19400                                    PI-SAVED-PROGRAM-3
 19401                                    PI-SAVED-PROGRAM-4
 19402                                    PI-SAVED-PROGRAM-5
 19403                                    PI-SAVED-PROGRAM-6
 19404                                    PI-RETURN-TO-PROGRAM.
 19405     IF EIBAID = DFHPF8
 19406        MOVE XCTL-132            TO PGM-NAME
 19407     ELSE
 19408        MOVE XCTL-130            TO PGM-NAME.
 19409
 19410     GO TO 9300-XCTL.
 19411
 19412 9100-RETURN-TRAN.
 19413     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19414     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19415
 19416
 19417* EXEC CICS RETURN
 19418*        TRANSID(TRANS-ID)
 19419*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19420*        LENGTH(PI-COMM-LENGTH)
 19421*    END-EXEC.
 19422*    MOVE '.(CT                  ''   #00017164' TO DFHEIV0
 19423     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19424     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19425     MOVE X'2020233030303137313634' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 374
* EL156.cbl
 19426     CALL 'kxdfhei1' USING DFHEIV0,
 19427           TRANS-ID,
 19428           PROGRAM-INTERFACE-BLOCK,
 19429           PI-COMM-LENGTH,
 19430           DFHEIV99,
 19431           DFHEIV99,
 19432           DFHEIV99
 19433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19434
 19435
 19436 9200-RETURN-MAIN-MENU.
 19437     MOVE XCTL-126               TO PGM-NAME.
 19438     GO TO 9300-XCTL.
 19439
 19440 9300-XCTL.
 19441
 19442* EXEC CICS XCTL
 19443*        PROGRAM(PGM-NAME)
 19444*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19445*        LENGTH(PI-COMM-LENGTH)
 19446*    END-EXEC.
 19447*    MOVE '.$C                   %   #00017175' TO DFHEIV0
 19448     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19449     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19450     MOVE X'2020233030303137313735' TO DFHEIV0(25:11)
 19451     CALL 'kxdfhei1' USING DFHEIV0,
 19452           PGM-NAME,
 19453           PROGRAM-INTERFACE-BLOCK,
 19454           PI-COMM-LENGTH,
 19455           DFHEIV99
 19456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19457
 19458
 19459 9400-CLEAR.
 19460     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19461     GO TO 9300-XCTL.
 19462
 19463 9500-PF12.
 19464     MOVE XCTL-010               TO PGM-NAME.
 19465     GO TO 9300-XCTL.
 19466
 19467 9700-LINK-DATE-CONVERT.
 19468     MOVE LINK-ELDATCV           TO PGM-NAME.
 19469
 19470* EXEC CICS LINK
 19471*        PROGRAM   (PGM-NAME)
 19472*        COMMAREA  (DATE-CONVERSION-DATA)
 19473*        LENGTH    (DC-COMM-LENGTH)
 19474*    END-EXEC.
 19475*    MOVE '."C                   (   #00017191' TO DFHEIV0
 19476     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19478     MOVE X'2020233030303137313931' TO DFHEIV0(25:11)
 19479     CALL 'kxdfhei1' USING DFHEIV0,
 19480           PGM-NAME,
 19481           DATE-CONVERSION-DATA,
 19482           DC-COMM-LENGTH,
 19483           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 375
* EL156.cbl
 19484           DFHEIV99,
 19485           DFHEIV99,
 19486           DFHEIV99
 19487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19488
 19489
 19490 9700-EXIT.
 19491     EXIT.
 19492
 19493 9800-LINK-REM-TERM.
 19494     MOVE LINK-REMTERM TO PGM-NAME.
 19495
 19496
 19497* EXEC CICS LINK
 19498*        PROGRAM   (PGM-NAME)
 19499*        COMMAREA  (CALCULATION-PASS-AREA)
 19500*        LENGTH    (CP-COMM-LENGTH)
 19501*    END-EXEC.
 19502*    MOVE '."C                   (   #00017203' TO DFHEIV0
 19503     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19505     MOVE X'2020233030303137323033' TO DFHEIV0(25:11)
 19506     CALL 'kxdfhei1' USING DFHEIV0,
 19507           PGM-NAME,
 19508           CALCULATION-PASS-AREA,
 19509           CP-COMM-LENGTH,
 19510           DFHEIV99,
 19511           DFHEIV99,
 19512           DFHEIV99,
 19513           DFHEIV99
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19515
 19516
 19517 9800-EXIT.
 19518     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 376
* EL156.cbl
 19520 9830-DMD-REMAINING-TERM.
 19521
 19522     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19523         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19524
 19525     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19526                              CM-PMT-EXTENSION-DAYS.
 19527
 19528     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19529                                  CL-NO-OF-DAYS-PAID.
 19530
 19531     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19532         GIVING W-REM REMAINDER W-REM-DAYS.
 19533
 19534     MOVE W-REM                  TO WST-REM.
 19535
 19536     IF W-REM-DAYS > ZEROS
 19537         MOVE '/'                TO WST-SLASH
 19538         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19539     ELSE
 19540         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19541
 19542 9830-EXIT.
 19543     EXIT.
 19544
 19545 9870-OUTPUT-ACTIVITY-RECORD.
 19546
 19547
 19548* EXEC CICS GETMAIN
 19549*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19550*         LENGTH(25)
 19551*         INITIMG(WS-BLANK)
 19552*    END-EXEC.
 19553     MOVE 25
 19554       TO DFHEIV11
 19555*    MOVE ',"IL                  $   #00017239' TO DFHEIV0
 19556     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19558     MOVE X'2020233030303137323339' TO DFHEIV0(25:11)
 19559     CALL 'kxdfhei1' USING DFHEIV0,
 19560           DFHEIV20,
 19561           DFHEIV11,
 19562           WS-BLANK
 19563     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19564         DFHEIV20
 19565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19566
 19567
 19568     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19569     MOVE ELMSTR-KEY             TO DA-KEY.
 19570     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19571
 19572     IF PI-PMTTYPE EQUAL '7'
 19573         MOVE 'V'                TO DA-RECORD-TYPE
 19574     ELSE
 19575         MOVE 'P'                TO DA-RECORD-TYPE.
 19576
 19577
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 377
* EL156.cbl
 19578* EXEC CICS HANDLE CONDITION
 19579*         NOTOPEN(9870-NOTOPEN)
 19580*         DUPREC(9870-EXIT)
 19581*    END-EXEC.
 19582*    MOVE '"$J%                  ! B #00017254' TO DFHEIV0
 19583     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19585     MOVE X'4220233030303137323534' TO DFHEIV0(25:11)
 19586     CALL 'kxdfhei1' USING DFHEIV0
 19587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19588
 19589
 19590
 19591* EXEC CICS WRITE
 19592*         DATASET('DLYACTV')
 19593*         RIDFLD(DA-KEY)
 19594*         FROM(DAILY-ACTIVITY-RECORD)
 19595*         LENGTH(25)
 19596*    END-EXEC.
 19597     MOVE 'DLYACTV' TO DFHEIV1
 19598     MOVE 25
 19599       TO DFHEIV11
 19600*    MOVE '&$ L                  ''   #00017259' TO DFHEIV0
 19601     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19602     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19603     MOVE X'2020233030303137323539' TO DFHEIV0(25:11)
 19604     CALL 'kxdfhei1' USING DFHEIV0,
 19605           DFHEIV1,
 19606           DAILY-ACTIVITY-RECORD,
 19607           DFHEIV11,
 19608           DA-KEY,
 19609           DFHEIV99,
 19610           DFHEIV99
 19611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19612
 19613     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19614     GO TO 9870-EXIT.
 19615
 19616 9870-NOTOPEN.
 19617
 19618     MOVE '2955'                 TO EMI-ERROR.
 19619     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19620
 19621 9870-EXIT.
 19622     EXIT.
 19623
 19624 9900-ERROR-FORMAT.
 19625
 19626     IF EMI-ERROR = ER-0923
 19627         MOVE PGM-NAME           TO W-CALLED-NAME.
 19628
 19629     MOVE LINK-001      TO PGM-NAME.
 19630     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19631
 19632
 19633* EXEC CICS LINK
 19634*        PROGRAM (PGM-NAME)
 19635*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 378
* EL156.cbl
 19636*        LENGTH  (EMI-COMM-LENGTH)
 19637*    END-EXEC.
 19638*    MOVE '."C                   (   #00017284' TO DFHEIV0
 19639     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19641     MOVE X'2020233030303137323834' TO DFHEIV0(25:11)
 19642     CALL 'kxdfhei1' USING DFHEIV0,
 19643           PGM-NAME,
 19644           ERROR-MESSAGE-INTERFACE-BLOCK,
 19645           EMI-COMM-LENGTH,
 19646           DFHEIV99,
 19647           DFHEIV99,
 19648           DFHEIV99,
 19649           DFHEIV99
 19650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19651
 19652
 19653     IF EMI-ERROR = ER-0923
 19654         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19655
 19656 9900-EXIT.
 19657     EXIT.
 19658
 19659 9990-ABEND.
 19660     MOVE LINK-004               TO PGM-NAME.
 19661     MOVE DFHEIBLK               TO EMI-LINE1.
 19662
 19663* EXEC CICS LINK
 19664*        PROGRAM   (PGM-NAME)
 19665*        COMMAREA  (EMI-LINE1)
 19666*        LENGTH    (64)
 19667*    END-EXEC.
 19668     MOVE 64
 19669       TO DFHEIV11
 19670*    MOVE '."C                   (   #00017299' TO DFHEIV0
 19671     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19672     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19673     MOVE X'2020233030303137323939' TO DFHEIV0(25:11)
 19674     CALL 'kxdfhei1' USING DFHEIV0,
 19675           PGM-NAME,
 19676           EMI-LINE1,
 19677           DFHEIV11,
 19678           DFHEIV99,
 19679           DFHEIV99,
 19680           DFHEIV99,
 19681           DFHEIV99
 19682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19683
 19684
 19685     MOVE 'EL156A'               TO  MAP-NAME.
 19686     MOVE LOW-VALUES             TO  EL156AO.
 19687     GO TO 8100-SEND-INITIAL-MAP.
 19688
 19689 9995-SECURITY-VIOLATION.
 19690*    COPY ELCSCTP.
 19691******************************************************************
 19692*                                                                *
 19693*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 379
* EL156.cbl
 19694*                            VMOD=2.001                          *
 19695*                                                                *
 19696*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 19697******************************************************************
 19698
 19699
 19700     MOVE EIBDATE          TO SM-JUL-DATE.
 19701     MOVE EIBTRMID         TO SM-TERMID.
 19702     MOVE THIS-PGM         TO SM-PGM.
 19703     MOVE EIBTIME          TO TIME-IN.
 19704     MOVE TIME-OUT         TO SM-TIME.
 19705     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 19706
 19707
 19708* EXEC CICS LINK
 19709*         PROGRAM  ('EL003')
 19710*         COMMAREA (SECURITY-MESSAGE)
 19711*         LENGTH   (80)
 19712*    END-EXEC.
 19713     MOVE 'EL003' TO DFHEIV1
 19714     MOVE 80
 19715       TO DFHEIV11
 19716*    MOVE '."C                   (   #00017327' TO DFHEIV0
 19717     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19719     MOVE X'2020233030303137333237' TO DFHEIV0(25:11)
 19720     CALL 'kxdfhei1' USING DFHEIV0,
 19721           DFHEIV1,
 19722           SECURITY-MESSAGE,
 19723           DFHEIV11,
 19724           DFHEIV99,
 19725           DFHEIV99,
 19726           DFHEIV99,
 19727           DFHEIV99
 19728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19729
 19730
 19731******************************************************************
 19732
 19733
 19734
 19735 9999-DFHBACK SECTION.
 19736     MOVE '9%                    "   ' TO DFHEIV0
 19737     MOVE 'EL156' TO DFHEIV1
 19738     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19739     GOBACK.
 19740 9999-DFHEXIT.
 19741     IF DFHEIGDJ EQUAL 0001
 19742         NEXT SENTENCE
 19743     ELSE IF DFHEIGDJ EQUAL 2
 19744         GO TO 9990-ABEND,
 19745               8600-PGRM-NOT-FOUND,
 19746               0400-FIRST-TIME,
 19747               6180-DUPREC,
 19748               9990-ABEND
 19749         DEPENDING ON DFHEIGDI
 19750     ELSE IF DFHEIGDJ EQUAL 3
 19751         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 380
* EL156.cbl
 19752               0380-CLAIM-END-FILE
 19753         DEPENDING ON DFHEIGDI
 19754     ELSE IF DFHEIGDJ EQUAL 4
 19755         GO TO 0380-CLAIM-END-FILE,
 19756               0380-CLAIM-END-FILE
 19757         DEPENDING ON DFHEIGDI
 19758     ELSE IF DFHEIGDJ EQUAL 5
 19759         GO TO 0800-EXIT
 19760         DEPENDING ON DFHEIGDI
 19761     ELSE IF DFHEIGDJ EQUAL 6
 19762         GO TO 1950-NOT-FOUND,
 19763               1950-NOT-FOUND
 19764         DEPENDING ON DFHEIGDI
 19765     ELSE IF DFHEIGDJ EQUAL 7
 19766         GO TO 1950-NOT-FOUND
 19767         DEPENDING ON DFHEIGDI
 19768     ELSE IF DFHEIGDJ EQUAL 8
 19769         GO TO 1950-NOT-FOUND,
 19770               1950-NOT-FOUND
 19771         DEPENDING ON DFHEIGDI
 19772     ELSE IF DFHEIGDJ EQUAL 9
 19773         GO TO 1166-END-CHECK,
 19774               1166-END-CHECK
 19775         DEPENDING ON DFHEIGDI
 19776     ELSE IF DFHEIGDJ EQUAL 10
 19777         GO TO 1950-NOT-FOUND,
 19778               1950-NOT-FOUND
 19779         DEPENDING ON DFHEIGDI
 19780     ELSE IF DFHEIGDJ EQUAL 11
 19781         GO TO 1950-NOT-FOUND,
 19782               1950-NOT-FOUND
 19783         DEPENDING ON DFHEIGDI
 19784     ELSE IF DFHEIGDJ EQUAL 12
 19785         GO TO 1950-NOT-FOUND
 19786         DEPENDING ON DFHEIGDI
 19787     ELSE IF DFHEIGDJ EQUAL 13
 19788         GO TO 3600-CONTINUE
 19789         DEPENDING ON DFHEIGDI
 19790     ELSE IF DFHEIGDJ EQUAL 14
 19791         GO TO 5300-NOTE-NOT-FOUND
 19792         DEPENDING ON DFHEIGDI
 19793     ELSE IF DFHEIGDJ EQUAL 15
 19794         GO TO 6065-NOT-FOUND
 19795         DEPENDING ON DFHEIGDI
 19796     ELSE IF DFHEIGDJ EQUAL 16
 19797         GO TO 6068-ACCT-NOT-FND
 19798         DEPENDING ON DFHEIGDI
 19799     ELSE IF DFHEIGDJ EQUAL 17
 19800         GO TO 6074-GET-COMP-DATA
 19801         DEPENDING ON DFHEIGDI
 19802     ELSE IF DFHEIGDJ EQUAL 18
 19803         GO TO 6170-WRITE
 19804         DEPENDING ON DFHEIGDI
 19805     ELSE IF DFHEIGDJ EQUAL 19
 19806         GO TO 6180-DUPREC
 19807         DEPENDING ON DFHEIGDI
 19808     ELSE IF DFHEIGDJ EQUAL 20
 19809         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 16-Oct-13 15:25 Page 381
* EL156.cbl
 19810         DEPENDING ON DFHEIGDI
 19811     ELSE IF DFHEIGDJ EQUAL 21
 19812         GO TO 6185-DUPREC
 19813         DEPENDING ON DFHEIGDI
 19814     ELSE IF DFHEIGDJ EQUAL 22
 19815         GO TO 6720-BUILD-NEW-RECORD
 19816         DEPENDING ON DFHEIGDI
 19817     ELSE IF DFHEIGDJ EQUAL 23
 19818         GO TO 6900-BUILD-ARCHIVE-HEADER,
 19819               6900-BUILD-ARCHIVE-HEADER
 19820         DEPENDING ON DFHEIGDI
 19821     ELSE IF DFHEIGDJ EQUAL 24
 19822         GO TO 7010-BUILD-MAP
 19823         DEPENDING ON DFHEIGDI
 19824     ELSE IF DFHEIGDJ EQUAL 25
 19825         GO TO 7100-SHOW-RECORD-NOT-FOUND
 19826         DEPENDING ON DFHEIGDI
 19827     ELSE IF DFHEIGDJ EQUAL 26
 19828         GO TO 7160-DUPREC
 19829         DEPENDING ON DFHEIGDI
 19830     ELSE IF DFHEIGDJ EQUAL 27
 19831         GO TO 7200-EXIT,
 19832               7200-EXIT
 19833         DEPENDING ON DFHEIGDI
 19834     ELSE IF DFHEIGDJ EQUAL 28
 19835         GO TO 7400-NOT-FOUND
 19836         DEPENDING ON DFHEIGDI
 19837     ELSE IF DFHEIGDJ EQUAL 29
 19838         GO TO 7590-END,
 19839               7590-END
 19840         DEPENDING ON DFHEIGDI
 19841     ELSE IF DFHEIGDJ EQUAL 30
 19842         GO TO 7699-EXIT
 19843         DEPENDING ON DFHEIGDI
 19844     ELSE IF DFHEIGDJ EQUAL 31
 19845         GO TO 5300-NOTE-NOT-FOUND
 19846         DEPENDING ON DFHEIGDI
 19847     ELSE IF DFHEIGDJ EQUAL 32
 19848         GO TO 7800-COMP-NOTFND
 19849         DEPENDING ON DFHEIGDI
 19850     ELSE IF DFHEIGDJ EQUAL 33
 19851         GO TO 7920-NOT-FOUND
 19852         DEPENDING ON DFHEIGDI
 19853     ELSE IF DFHEIGDJ EQUAL 34
 19854         GO TO 9870-NOTOPEN,
 19855               9870-EXIT
 19856         DEPENDING ON DFHEIGDI.
 19857     MOVE '9%                    "   ' TO DFHEIV0
 19858     MOVE 'EL156' TO DFHEIV1
 19859     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19860     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12052     Code:       73116
