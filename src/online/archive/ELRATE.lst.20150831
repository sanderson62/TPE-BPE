* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   193******************************************************************
   194
   195 01  NET-PAY-WORK-AREA.
   196     12  OPTION-SW               PIC X   VALUE 'X'.
   197        88  NPO-STD         VALUE SPACE.
   198        88  NPO-ALT         VALUE 'A'.
   199        88  NPO-SIMPLE      VALUE 'S'.
   200        88  NPO-2MO         VALUE 'I'.
   201        88  NPO-3MO         VALUE 'J'.
   202        88  NPO-4MO         VALUE 'K'.
   203        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   204        88  NPO-TRUNC-0     VALUE 'T'.
   205        88  NPO-TRUNC-1     VALUE 'U'.
   206        88  NPO-TRUNC-2     VALUE 'V'.
   207        88  NPO-TRUNC-3     VALUE 'W'.
   208        88  NPO-TRUNC-4     VALUE 'X'.
   209        88  NPO-REFUND      VALUE 'R'.
   210        88  NPO-PRUDENTIAL  VALUE 'P'.
   211
   212     12  TYPE-SW             PIC X   VALUE 'N'.
   213        88  NET-STD             VALUE 'N'.
   214        88  NET-SMP             VALUE 'S'.
   215
   216     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   217        88  NP-RATING           VALUE '1'.
   218        88  NP-REFUND           VALUE '2'.
   219        88  NP-REMAIN-AMT       VALUE '3'.
   220
   221     12  COMP-3-WORK-AREA         COMP-3.
   222         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   223         16  V               PIC SV9(13)       VALUE +.0.
   224         16  J               PIC SV9(9)        VALUE +0.
   225         16  K               PIC SV9(9)        VALUE +0.
   226         16  I               PIC SV9(10)       VALUE +.0.
   227         16  D               PIC S9(5)         VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   6
* ELRATE.cbl
   228         16  APR100          PIC SV9(9)        VALUE +.0.
   229         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   230         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   232         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   233         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   234         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   235         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   236         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   237         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   238         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   239         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   240         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   241         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   242         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   243         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   244         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   246         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   247         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   248         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   251         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   252         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   253         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   254         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   255         16  K1              PIC S999          VALUE +1.
   256         16  K12             PIC S999          VALUE +12.
   257         16  K100            PIC S999          VALUE +100.
   258         16  K1000           PIC S9(7)         VALUE +1000.
   259         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   260         16  Y REDEFINES NC-LR
   261                             PIC S99V9(5).
   262         16  TI              PIC S999V9(5)     VALUE +0.
   263         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   264         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   265         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   266         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   267         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   268         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   269         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   270         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   271
   272         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   273         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   274         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   275         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   276         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   277         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   278         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   279         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   280         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   281         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   282         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   283         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   284         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   285
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   7
* ELRATE.cbl
   286         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   287
   288         16  ORIGINAL-TERM   PIC S999.
   289         16  M              REDEFINES ORIGINAL-TERM
   290                             PIC S999.
   291
   292         16  REMAINING-TERM  PIC S999.
   293         16  R              REDEFINES REMAINING-TERM
   294                             PIC S999.
   295
   296         16  LOAN-TERM       PIC S999.
   297         16  N              REDEFINES LOAN-TERM
   298                             PIC S999.
   299
   300         16  EXPIRED-TERM    PIC S999.
   301         16  E              REDEFINES EXPIRED-TERM
   302                             PIC S999.
   303
   304         16  PRUDENTIAL-WORK-AMT
   305                             PIC S9(7)V9(8).
   306         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   307                             PIC S9(7)V9(8).
   308
   309         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   310         16  VX              PIC S9V9(13)      VALUE +0.0.
   311         16  SV              PIC S9V9(13)      VALUE +0.0.
   312         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   313         16  SX              PIC S9V9(13)      VALUE +0.0.
   314         16  SE              PIC S9V9(10)      VALUE +0.0.
   315         16  N2              PIC S9(7)         VALUE +0.
   316         16  N3              PIC S9(7)         VALUE +0.
   317         16  K-I             PIC S9V9(8)       VALUE +0.0.
   318
   319     12  BINARY-WORK-AREA        COMP.
   320         16  X1              PIC S999        VALUE +0.
   321         16  X2              PIC S999        VALUE +0.
   322         16  MAX-X           PIC S9(5)       VALUE +0.
   323         16  B1              PIC S9(5)       VALUE +1.
   324         16  LINDX           PIC S999        VALUE ZEROS.
   325         16  AHNDX           PIC S999        VALUE ZEROS.
   326
   327     12  CSO-RATE-WORK-AREAS.
   328         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   329         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   330         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   331     12  WS-WORK-MISC.
   332         16  ws-extra-pmts       pic s999         comp-3.
   333         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   334         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   335*        16  WS-AGE              PIC 99           VALUE ZEROS.
   336         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   337         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   338         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   339         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   340         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   341         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   342         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   343         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   8
* ELRATE.cbl
   344         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   345         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   346         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   347         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   348******************************************************************
   349
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page   9
* ELRATE.cbl
   351*                            COPY ELCDATE.
   352******************************************************************
   353*                                                                *
   354*                                                                *
   355*                            ELCDATE.                            *
   356*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   357*                            VMOD=2.003
   358*                                                                *
   359*                                                                *
   360*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   361*                 LENGTH = 200                                   *
   362******************************************************************
   363
   364 01  DATE-CONVERSION-DATA.
   365     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   366     12  DC-OPTION-CODE                PIC X.
   367         88  BIN-TO-GREG                VALUE ' '.
   368         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   369         88  EDIT-GREG-TO-BIN           VALUE '2'.
   370         88  YMD-GREG-TO-BIN            VALUE '3'.
   371         88  MDY-GREG-TO-BIN            VALUE '4'.
   372         88  JULIAN-TO-BIN              VALUE '5'.
   373         88  BIN-PLUS-ELAPSED           VALUE '6'.
   374         88  FIND-CENTURY               VALUE '7'.
   375         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   376         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   377         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   378         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   379         88  JULIAN-TO-BIN-3            VALUE 'C'.
   380         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   381         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   382         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   383         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   384         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   385         88  CHECK-LEAP-YEAR            VALUE 'H'.
   386         88  BIN-3-TO-GREG              VALUE 'I'.
   387         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   388         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   389         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   390         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   391         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   392         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   393         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   394         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   395         88  THREE-CHARACTER-BIN
   396                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   397         88  GREGORIAN-TO-BIN
   398                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   399         88  BIN-TO-GREGORIAN
   400                  VALUES ' ' '1' 'I' '8' 'G'.
   401         88  JULIAN-TO-BINARY
   402                  VALUES '5' 'C' 'E' 'F'.
   403     12  DC-ERROR-CODE                 PIC X.
   404         88  NO-CONVERSION-ERROR        VALUE ' '.
   405         88  DATE-CONVERSION-ERROR
   406                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   407         88  DATE-IS-ZERO               VALUE '1'.
   408         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  10
* ELRATE.cbl
   409         88  DATE-IS-INVALID            VALUE '3'.
   410         88  DATE1-GREATER-DATE2        VALUE '4'.
   411         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   412         88  DATE-INVALID-OPTION        VALUE '9'.
   413         88  INVALID-CENTURY            VALUE 'A'.
   414         88  ONLY-CENTURY               VALUE 'B'.
   415         88  ONLY-LEAP-YEAR             VALUE 'C'.
   416         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   417     12  DC-END-OF-MONTH               PIC X.
   418         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   419     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   420         88  USE-NORMAL-PROCESS         VALUE ' '.
   421         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   422         88  ADJUST-UP-100-YRS          VALUE '2'.
   423     12  FILLER                        PIC X.
   424     12  DC-CONVERSION-DATES.
   425         16  DC-BIN-DATE-1             PIC XX.
   426         16  DC-BIN-DATE-2             PIC XX.
   427         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   428         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   429                       DC-GREG-DATE-1-EDIT.
   430             20  DC-EDIT1-MONTH        PIC 99.
   431             20  SLASH1-1              PIC X.
   432             20  DC-EDIT1-DAY          PIC 99.
   433             20  SLASH1-2              PIC X.
   434             20  DC-EDIT1-YEAR         PIC 99.
   435         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   436         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   437                     DC-GREG-DATE-2-EDIT.
   438             20  DC-EDIT2-MONTH        PIC 99.
   439             20  SLASH2-1              PIC X.
   440             20  DC-EDIT2-DAY          PIC 99.
   441             20  SLASH2-2              PIC X.
   442             20  DC-EDIT2-YEAR         PIC 99.
   443         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   444         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   445                     DC-GREG-DATE-1-YMD.
   446             20  DC-YMD-YEAR           PIC 99.
   447             20  DC-YMD-MONTH          PIC 99.
   448             20  DC-YMD-DAY            PIC 99.
   449         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   450         16  DC-GREG-DATE-1-MDY-R REDEFINES
   451                      DC-GREG-DATE-1-MDY.
   452             20  DC-MDY-MONTH          PIC 99.
   453             20  DC-MDY-DAY            PIC 99.
   454             20  DC-MDY-YEAR           PIC 99.
   455         16  DC-GREG-DATE-1-ALPHA.
   456             20  DC-ALPHA-MONTH        PIC X(10).
   457             20  DC-ALPHA-DAY          PIC 99.
   458             20  FILLER                PIC XX.
   459             20  DC-ALPHA-CENTURY.
   460                 24 DC-ALPHA-CEN-N     PIC 99.
   461             20  DC-ALPHA-YEAR         PIC 99.
   462         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   463         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   464         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   465         16  DC-JULIAN-DATE            PIC 9(05).
   466         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  11
* ELRATE.cbl
   467                                       PIC 9(05).
   468         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   469             20  DC-JULIAN-YEAR        PIC 99.
   470             20  DC-JULIAN-DAYS        PIC 999.
   471         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   472         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   473         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   474     12  DATE-CONVERSION-VARIBLES.
   475         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   476         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   477             20  FILLER                PIC 9(3).
   478             20  HOLD-CEN-1-CCYY.
   479                 24  HOLD-CEN-1-CC     PIC 99.
   480                 24  HOLD-CEN-1-YY     PIC 99.
   481             20  HOLD-CEN-1-MO         PIC 99.
   482             20  HOLD-CEN-1-DA         PIC 99.
   483         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   484             20  HOLD-CEN-1-R-MO       PIC 99.
   485             20  HOLD-CEN-1-R-DA       PIC 99.
   486             20  HOLD-CEN-1-R-CCYY.
   487                 24  HOLD-CEN-1-R-CC   PIC 99.
   488                 24  HOLD-CEN-1-R-YY   PIC 99.
   489             20  FILLER                PIC 9(3).
   490         16  HOLD-CENTURY-1-X.
   491             20  FILLER                PIC X(3)  VALUE SPACES.
   492             20  HOLD-CEN-1-X-CCYY.
   493                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   494                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   495             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   496             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   497         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   498             20  HOLD-CEN-1-R-X-MO     PIC XX.
   499             20  HOLD-CEN-1-R-X-DA     PIC XX.
   500             20  HOLD-CEN-1-R-X-CCYY.
   501                 24  HOLD-CEN-1-R-X-CC PIC XX.
   502                 24  HOLD-CEN-1-R-X-YY PIC XX.
   503             20  FILLER                PIC XXX.
   504         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   505         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   506         16  DC-JULIAN-DATE-1          PIC 9(07).
   507         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   508             20  DC-JULIAN-1-CCYY.
   509                 24  DC-JULIAN-1-CC    PIC 99.
   510                 24  DC-JULIAN-1-YR    PIC 99.
   511             20  DC-JULIAN-DA-1        PIC 999.
   512         16  DC-JULIAN-DATE-2          PIC 9(07).
   513         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   514             20  DC-JULIAN-2-CCYY.
   515                 24  DC-JULIAN-2-CC    PIC 99.
   516                 24  DC-JULIAN-2-YR    PIC 99.
   517             20  DC-JULIAN-DA-2        PIC 999.
   518         16  DC-GREG-DATE-A-EDIT.
   519             20  DC-EDITA-MONTH        PIC 99.
   520             20  SLASHA-1              PIC X VALUE '/'.
   521             20  DC-EDITA-DAY          PIC 99.
   522             20  SLASHA-2              PIC X VALUE '/'.
   523             20  DC-EDITA-CCYY.
   524                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  12
* ELRATE.cbl
   525                 24  DC-EDITA-YEAR     PIC 99.
   526         16  DC-GREG-DATE-B-EDIT.
   527             20  DC-EDITB-MONTH        PIC 99.
   528             20  SLASHB-1              PIC X VALUE '/'.
   529             20  DC-EDITB-DAY          PIC 99.
   530             20  SLASHB-2              PIC X VALUE '/'.
   531             20  DC-EDITB-CCYY.
   532                 24  DC-EDITB-CENT     PIC 99.
   533                 24  DC-EDITB-YEAR     PIC 99.
   534         16  DC-GREG-DATE-CYMD         PIC 9(08).
   535         16  DC-GREG-DATE-CYMD-R REDEFINES
   536                              DC-GREG-DATE-CYMD.
   537             20  DC-CYMD-CEN           PIC 99.
   538             20  DC-CYMD-YEAR          PIC 99.
   539             20  DC-CYMD-MONTH         PIC 99.
   540             20  DC-CYMD-DAY           PIC 99.
   541         16  DC-GREG-DATE-MDCY         PIC 9(08).
   542         16  DC-GREG-DATE-MDCY-R REDEFINES
   543                              DC-GREG-DATE-MDCY.
   544             20  DC-MDCY-MONTH         PIC 99.
   545             20  DC-MDCY-DAY           PIC 99.
   546             20  DC-MDCY-CEN           PIC 99.
   547             20  DC-MDCY-YEAR          PIC 99.
   548    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   549        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   550    12  DC-EL310-DATE                  PIC X(21).
   551    12  FILLER                         PIC X(28).
   552
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  13
* ELRATE.cbl
   554*                            COPY ELCCALC.
   555******************************************************************
   556*                                                                *
   557*                           ELCCALC.                            *
   558*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   559*                            VMOD=2.025                          *
   560*                                                                *
   561*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   562*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   563*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   564*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   565*                                                                *
   566*  PASSED TO ELRTRM                                              *
   567*  -----------------                                             *
   568*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   569*  ORIGINAL TERM                                                 *
   570*  BEGINNING DATE                                                *
   571*  ENDING DATE                                                   *
   572*  COMPANY I.D.                                                  *
   573*  ACCOUNT MASTER USER FIELD                                     *
   574*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   575*  FREE LOOK DAYS                                                *
   576*                                                                *
   577*  RETURNED FROM ELRTRM                                          *
   578*  ---------------------                                         *
   579*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   580*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   581*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   582*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   583*----------------------------------------------------------------*
   584*  PASSED TO ELRAMT                                              *
   585*  ----------------                                              *
   586*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   587*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   588*  ORIGINAL AMOUNT                                               *
   589*  ALTERNATE BENEFIT (BALLON)                                    *
   590*  A.P.R. - NET PAY ONLY                                         *
   591*  METHOD
   592*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   593*  COMPANY I.D.                                                  *
   594*  BENEFIT TYPE                                                  *
   595*                                                                *
   596*  RETURNED FROM ELRAMT                                          *
   597*  --------------------                                          *
   598*  REMAINING AMOUNT 1 - CURRENT                                  *
   599*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   600*  REMAINING AMOUNT FACTOR
   601*----------------------------------------------------------------*
   602*  PASSED TO ELRESV                                              *
   603*  -----------------                                             *
   604*  CERTIFICATE EFFECTIVE DATE                                    *
   605*  VALUATION DATE                                                *
   606*  PAID THRU DATE                                                *
   607*  BENEFIT                                                       *
   608*  INCURRED DATE                                                 *
   609*  REPORTED DATE                                                 *
   610*  ISSUE AGE                                                     *
   611*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  14
* ELRATE.cbl
   612*  CDT PERCENT                                                   *
   613*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   614* *CLAIM TYPE (LIFE, A/H)                                        *
   615* *REMAINING BENEFIT (FROM ELRAMT)                               *
   616* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   617*                                                                *
   618*  RETURNED FROM ELRESV                                          *
   619*  --------------------                                          *
   620*  CDT TABLE USED                                                *
   621*  CDT FACTOR USED                                               *
   622*  PAY TO CURRENT RESERVE                                        *
   623*  I.B.N.R. - A/H ONLY                                           *
   624*  FUTURE (ACCRUED) AH ONLY                                      *
   625*----------------------------------------------------------------*
   626*  PASSED TO ELRATE                                              *
   627*  ----------------                                              *
   628*  CERT ISSUE DATE                                               *
   629*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   630*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   631*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   632*  STATE CODE (CLIENT DEFINED)                                   *
   633*  STATE CODE (STANDARD P.O. ABBRV)                              *
   634*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   635*  DEVIATION CODE                                                *
   636*  ISSUE AGE                                                     *
   637*  ORIGINAL BENEFIT AMOUNT                                       *
   638*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   639*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   640*  BENEFIT KIND (LIFE OR A/H)                                    *
   641*  A.P.R.                                                        *
   642*  METHOD
   643*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   644*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   645*  COMPANY I.D. (3 CHARACTER)                                    *
   646*  BENEFIT CODE                                                  *
   647*  BENEFIT OVERRIDE CODE                                         *
   648*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   649*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   650*  JOINT INDICATOR (CSL ONLY)                                    *
   651*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   652*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   653*                                                                *
   654*  RETURNED FROM ELRATE                                          *
   655*  --------------------                                          *
   656*  CALCULATED PREMIUM                                            *
   657*  PREMIUM RATE                                                  *
   658*  MORTALITY CODE                                                *
   659*  MAX ATTAINED AGE                                              *
   660*  MAX AGE                                                       *
   661*  MAX TERM                                                      *
   662*  MAX MONTHLY BENEFIT                                           *
   663*  MAX TOTAL BENIFIT                                             *
   664*  COMPOSITE RATE (OPEN-END ONLY)                                *
   665*----------------------------------------------------------------*
   666*  PASSED TO ELRFND                                              *
   667*  ----------------                                              *
   668*  CERT ISSUE DATE                                               *
   669*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  15
* ELRATE.cbl
   670*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   671*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   672*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   673*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   674*  STATE CODE (CLIENT DEFINED)                                   *
   675*  STATE CODE (STANDARD P.O. ABBRV)                              *
   676*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   677*  DEVIATION CODE                                                *
   678*  ISSUE AGE                                                     *
   679*  ORIGINAL BENEFIT AMOUNT                                       *
   680*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   681*  PROCESS TYPE (CANCEL)                                         *
   682*  BENEFIT KIND (LIFE OR A/H)                                    *
   683*  A.P.R.                                                        *
   684*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   685*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   686*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   687*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   688*  COMPANY I.D. (3 CHARACTER)                                    *
   689*  BENEFIT CODE                                                  *
   690*  BENEFIT OVERRIDE CODE                                         *
   691*                                                                *
   692*  RETURNED FROM ELRFND                                          *
   693*  --------------------                                          *
   694*  CALCULATED REFUND                                             *
   695*----------------------------------------------------------------*
   696*  PASSED TO ELEARN                                              *
   697*  ----------------                                              *
   698*  CERT ISSUE DATE                                               *
   699*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   700*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   701*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   702*  STATE CODE (CLIENT DEFINED)                                   *
   703*  STATE CODE (STANDARD P.O. ABBRV)                              *
   704*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   705*  DEVIATION CODE                                                *
   706*  ISSUE AGE                                                     *
   707*  ORIGINAL BENEFIT AMOUNT                                       *
   708*  BENEFIT KIND (LIFE OR A/H)                                    *
   709*  A.P.R.                                                        *
   710*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   711*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   712*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   713*  COMPANY I.D. (3 CHARACTER)                                    *
   714*  BENEFIT CODE                                                  *
   715*  BENEFIT OVERRIDE CODE                                         *
   716*                                                                *
   717*  RETURNED FROM ELEARN                                          *
   718*  --------------------                                          *
   719*  INDICATED  EARNINGS                                           *
   720*----------------------------------------------------------------*
   721*                 LENGTH = 450                                   *
   722*                                                                *
   723******************************************************************
   724******************************************************************
   725*                   C H A N G E   L O G
   726*
   727* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  16
* ELRATE.cbl
   728*-----------------------------------------------------------------
   729*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   730* EFFECTIVE    NUMBER
   731*-----------------------------------------------------------------
   732* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   733* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   734* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   735* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   736* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   737* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   738* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   739* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   740* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   741******************************************************************
   742
   743 01  CALCULATION-PASS-AREA.
   744     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   745                                     COMP.
   746
   747     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   748       88  NO-CP-ERROR                             VALUE ZERO.
   749       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   750                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   751       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   752       88  CP-ERROR-IN-DATES                       VALUE '2'.
   753       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   754       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   755       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   756       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   757       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   758       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   759       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   760       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   761       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   762       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   763       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   764       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   765       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   766       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   767       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   768
   769     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   770       88  NO-CP-ERROR-2                           VALUE ZERO.
   771***********************  INPUT AREAS ****************************
   772
   773     12  CP-CALCULATION-AREA.
   774         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   775         16  CP-CERT-EFF-DT        PIC XX.
   776         16  CP-VALUATION-DT       PIC XX.
   777         16  CP-PAID-THRU-DT       PIC XX.
   778         16  CP-BENEFIT-TYPE       PIC X.
   779           88  CP-AH                               VALUE 'A' 'D'
   780                                                   'I' 'U'.
   781           88  CP-REDUCING-LIFE                    VALUE 'R'.
   782           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   783         16  CP-INCURRED-DT        PIC XX.
   784         16  CP-REPORTED-DT        PIC XX.
   785         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  17
* ELRATE.cbl
   786         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   787         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   788                                     COMP-3.
   789         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   790                                     COMP-3.
   791         16  CP-CDT-METHOD         PIC X.
   792           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   793           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   794           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   795         16  CP-CLAIM-TYPE         PIC X.
   796           88  CP-AH-CLAIM                         VALUE 'A'.
   797           88  CP-LIFE-CLAIM                       VALUE 'L'.
   798         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   799                                     COMP-3.
   800         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   801                                     COMP-3.
   802         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   803                                     COMP-3.
   804         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   805                                     COMP-3.
   806         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   807                                     COMP-3.
   808         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   809                                     COMP-3.
   810         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   811                                     COMP-3.
   812         16  CP-REM-TERM-METHOD    PIC X.
   813           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   814           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   815           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   816           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   817           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   818           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   819           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   820         16  CP-EARNING-METHOD     PIC X.
   821           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   822           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   823           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   824           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   825           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   826           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   827           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   828           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   829           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   830           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   831           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   832           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   833           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   834           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   835         16  CP-PROCESS-TYPE       PIC X.
   836           88  CP-CLAIM                            VALUE '1'.
   837           88  CP-CANCEL                           VALUE '2'.
   838           88  CP-ISSUE                            VALUE '3'.
   839         16  CP-SPECIAL-CALC-CD    PIC X.
   840           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   841           88  CP-1-MTH-INTEREST               VALUE ' '.
   842           88  CP-0-MTH-INTEREST               VALUE 'A'.
   843           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  18
* ELRATE.cbl
   844           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   845           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   846           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   847           88  CP-FARM-PLAN                    VALUE 'F'.
   848           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   849           88  CP-2-MTH-INTEREST               VALUE 'I'.
   850           88  CP-3-MTH-INTEREST               VALUE 'J'.
   851           88  CP-4-MTH-INTEREST               VALUE 'K'.
   852           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   853           88  CP-MORTGAGE-REC                 VALUE 'M'.
   854           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   855           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   856           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   857           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   858                                                     'W' 'X'.
   859           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   860           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   861           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   862           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   863           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   864           88  CP-SUMMARY-REC                  VALUE 'Z'.
   865           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   866           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   867           88  CP-AD-D-BENEFIT                 VALUE '4'.
   868           88  CP-CSL-METH-1                   VALUE '5'.
   869           88  CP-CSL-METH-2                   VALUE '6'.
   870           88  CP-CSL-METH-3                   VALUE '7'.
   871           88  CP-CSL-METH-4                   VALUE '8'.
   872
   873         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   874                                     COMP-3.
   875         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   876         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   877         16  CP-STATE              PIC XX          VALUE SPACE.
   878         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   879         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   880           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   881               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   882         16  CP-R78-OPTION         PIC X.
   883           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   884           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   885
   886         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   887         16  CP-IBNR-RESERVE-SW    PIC X.
   888         16  CP-CLAIM-STATUS       PIC X.
   889         16  CP-RATE-FILE          PIC X.
   890         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   891                                     COMP-3.
   892
   893         16  CP-LIFE-OVERRIDE-CODE PIC X.
   894         16  CP-AH-OVERRIDE-CODE   PIC X.
   895
   896         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   897                                     COMP-3.
   898         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   899                                   PIC S9(5)V99 COMP-3.
   900         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   901                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  19
* ELRATE.cbl
   902         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   903                                     COMP-3.
   904         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   905                                     COMP-3.
   906         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   907                                  PIC S9(7)V99 COMP-3.
   908
   909         16  CP-PAID-FROM-DATE     PIC X(02).
   910         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   911         16  CP-EXT-DAYS-CALC      PIC X.
   912           88  CP-EXT-NO-CHG                   VALUE ' '.
   913           88  CP-EXT-CHG-LF                   VALUE '1'.
   914           88  CP-EXT-CHG-AH                   VALUE '2'.
   915           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   916         16  CP-DOMICILE-STATE     PIC XX.
   917         16  CP-CARRIER            PIC X.
   918         16  CP-REIN-FLAG          PIC X.
   919         16  CP-REM-TRM-CALC-OPTION PIC X.
   920           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   921                      '2' '3' '4' '5'.
   922           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   923           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   924           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   925           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   926           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   927           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   928           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   929           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   930         16  CP-SIG-SWITCH         PIC X.
   931         16  CP-RATING-METHOD      PIC X.
   932           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   933           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   934           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   935           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   936           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   937           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   938           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   939           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   940           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   941         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   942                                     COMP-3.
   943         16  CP-BEN-CATEGORY       PIC X.
   944         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   945         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   946                                   PIC S99V9(5) COMP-3.
   947         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   948         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   949                                   PIC S99V9(5) COMP-3.
   950         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   951         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   952         16  CP-EXPIRE-DT          PIC XX.
   953         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   954         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   955         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   956         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   957         16  CP-DDF-SPEC-CALC      PIC X.
   958             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   959             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  20
* ELRATE.cbl
   960         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   961         16  CP-CANCEL-REASON      PIC X.
   962         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   963         16  CP-PMT-MODE           PIC X.
   964         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   965         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   966         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   967         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   968         16  FILLER                PIC X.
   969
   970***************    OUTPUT FROM ELRESV   ************************
   971
   972         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   973
   974         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   975                                     COMP-3.
   976         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   977                                     COMP-3.
   978         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   979                                     COMP-3.
   980         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   981                                     COMP-3.
   982         16  FILLER                PIC X(09).
   983***************    OUTPUT FROM ELRTRM   *************************
   984
   985         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   986                                     COMP-3.
   987         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   988                                     COMP-3.
   989         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   990                                     COMP-3.
   991         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   992                                     COMP-3.
   993         16  FILLER                PIC X(12).
   994
   995***************    OUTPUT FROM ELRAMT   *************************
   996
   997         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   998                                     COMP-3.
   999         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1000                                     COMP-3.
  1001         16  FILLER                PIC X(12).
  1002
  1003***************    OUTPUT FROM ELRATE   *************************
  1004
  1005         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1008                                     COMP-3.
  1009         16  CP-MORTALITY-CODE     PIC X(4).
  1010         16  CP-RATE-EDIT-FLAG     PIC X.
  1011             88  CP-RATES-NEED-APR                  VALUE '1'.
  1012         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1013                                     COMP-3.
  1014         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1015         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1016         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1017                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  21
* ELRATE.cbl
  1018         16  FILLER                PIC X(07).
  1019
  1020***************    OUTPUT FROM ELRFND   *************************
  1021
  1022         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1023                                     COMP-3.
  1024         16  CP-REFUND-TYPE-USED   PIC X.
  1025           88  CP-R-AS-R78                         VALUE '1'.
  1026           88  CP-R-AS-PRORATA                     VALUE '2'.
  1027           88  CP-R-AS-CALIF                       VALUE '3'.
  1028           88  CP-R-AS-TEXAS                       VALUE '4'.
  1029           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1030           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1031           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1032           88  CP-R-AS-MEAN                        VALUE '8'.
  1033           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1034           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1035           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1036           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1037           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1038           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1039         16  FILLER                PIC X(12).
  1040
  1041***************    OUTPUT FROM ELEARN   *************************
  1042
  1043         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1044                                     COMP-3.
  1045         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1046                                     COMP-3.
  1047         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1048                                     COMP-3.
  1049         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1050                                     COMP-3.
  1051         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1054                                     COMP-3.
  1055         16  CP-EARNING-TYPE-USED  PIC X.
  1056           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1057           88  CP-E-AS-R78                         VALUE '1'.
  1058           88  CP-E-AS-PRORATA                     VALUE '2'.
  1059           88  CP-E-AS-TEXAS                       VALUE '4'.
  1060           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1061           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1062           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1063           88  CP-E-AS-MEAN                        VALUE '8'.
  1064           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1065         16  FILLER                PIC X(12).
  1066
  1067***************    OUTPUT FROM ELPMNT   *************************
  1068
  1069         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1070                                     COMP-3.
  1071         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1072                                     COMP-3.
  1073         16  FILLER                PIC X(12).
  1074
  1075***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  22
* ELRATE.cbl
  1076         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1077                                     COMP-3.
  1078         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1081                                     COMP-3.
  1082         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1083                                     COMP-3.
  1084         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1085                                     COMP-3.
  1086         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1087                                     COMP-3.
  1088         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1089             88  OPEN-RATE-FILE                   VALUE 'O'.
  1090             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1091             88  IO-ERROR                         VALUE 'E'.
  1092
  1093         16  CP-FIRST-PAY-DATE     PIC XX.
  1094
  1095         16  CP-JOINT-INDICATOR    PIC X.
  1096
  1097         16  CP-RESERVE-REMAINING-TERM
  1098                                   PIC S9(4)V9    VALUE ZERO
  1099                                     COMP-3.
  1100
  1101         16  CP-INSURED-BIRTH-DT   PIC XX.
  1102
  1103         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1104                                     COMP-3.
  1105
  1106         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1107                                     COMP-3.
  1108
  1109         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1110                                     COMP-3.
  1111
  1112         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1113                                     COMP-3.
  1114
  1115         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1116                                     COMP-3.
  1117
  1118         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1119                                     COMP-3.
  1120
  1121         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1122                                     COMP-3.
  1123
  1124         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1125             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1126
  1127         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1128                                     COMP-3.
  1129         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1130                                     COMP-3.
  1131         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1132         16  FILLER                PIC X(15).
  1133******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  23
* ELRATE.cbl
  1134
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  24
* ELRATE.cbl
  1136****************************************************************
  1137*
  1138* Copyright (c) 2007 by Clerity Solutions, Inc.
  1139* All rights reserved.
  1140*
  1141****************************************************************
  1142 01  DFHEIV.
  1143   02  DFHEIV0               PIC X(35).
  1144   02  DFHEIV1               PIC X(08).
  1145   02  DFHEIV2               PIC X(08).
  1146   02  DFHEIV3               PIC X(08).
  1147   02  DFHEIV4               PIC X(06).
  1148   02  DFHEIV5               PIC X(04).
  1149   02  DFHEIV6               PIC X(04).
  1150   02  DFHEIV7               PIC X(02).
  1151   02  DFHEIV8               PIC X(02).
  1152   02  DFHEIV9               PIC X(01).
  1153   02  DFHEIV10              PIC S9(7) COMP-3.
  1154   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1155   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1156   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1157   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1158   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1159   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1160   02  DFHEIV17              PIC X(04).
  1161   02  DFHEIV18              PIC X(04).
  1162   02  DFHEIV19              PIC X(04).
  1163   02  DFHEIV20              USAGE IS POINTER.
  1164   02  DFHEIV21              USAGE IS POINTER.
  1165   02  DFHEIV22              USAGE IS POINTER.
  1166   02  DFHEIV23              USAGE IS POINTER.
  1167   02  DFHEIV24              USAGE IS POINTER.
  1168   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1169   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1170   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1171   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1172   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1173   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1174   02  FILLER                PIC X(02).
  1175   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1176   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1177   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1178   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1179   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1180 LINKAGE  SECTION.
  1181*****************************************************************
  1182*                                                               *
  1183* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1184* All rights reserved.                                          *
  1185*                                                               *
  1186*****************************************************************
  1187 01  dfheiblk.
  1188     02  eibtime          pic s9(7) comp-3.
  1189     02  eibdate          pic s9(7) comp-3.
  1190     02  eibtrnid         pic x(4).
  1191     02  eibtaskn         pic s9(7) comp-3.
  1192     02  eibtrmid         pic x(4).
  1193     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  25
* ELRATE.cbl
  1194     02  eibcposn         pic s9(4) comp.
  1195     02  eibcalen         pic s9(4) comp.
  1196     02  eibaid           pic x(1).
  1197     02  eibfiller1       pic x(1).
  1198     02  eibfn            pic x(2).
  1199     02  eibfiller2       pic x(2).
  1200     02  eibrcode         pic x(6).
  1201     02  eibfiller3       pic x(2).
  1202     02  eibds            pic x(8).
  1203     02  eibreqid         pic x(8).
  1204     02  eibrsrce         pic x(8).
  1205     02  eibsync          pic x(1).
  1206     02  eibfree          pic x(1).
  1207     02  eibrecv          pic x(1).
  1208     02  eibsend          pic x(1).
  1209     02  eibatt           pic x(1).
  1210     02  eibeoc           pic x(1).
  1211     02  eibfmh           pic x(1).
  1212     02  eibcompl         pic x(1).
  1213     02  eibsig           pic x(1).
  1214     02  eibconf          pic x(1).
  1215     02  eiberr           pic x(1).
  1216     02  eibrldbk         pic x(1).
  1217     02  eiberrcd         pic x(4).
  1218     02  eibsynrb         pic x(1).
  1219     02  eibnodat         pic x(1).
  1220     02  eibfiller5       pic x(2).
  1221     02  eibresp          pic 9(09) comp.
  1222     02  eibresp2         pic 9(09) comp.
  1223     02  dfheigdj         pic s9(4) comp.
  1224     02  dfheigdk         pic s9(4) comp.
  1225 01  DFHCOMMAREA             PIC X(450).
  1226
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  26
* ELRATE.cbl
  1228*01 PARMLIST              COMP.
  1229*    02  FILLER              PIC S9(8).
  1230*    02  ERRATE-POINTER      PIC S9(8).
  1231
  1232*                                COPY ERCRATE.
  1233******************************************************************
  1234*                                                                *
  1235*                                                                *
  1236*                            ERCRATE                             *
  1237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1238*                            VMOD=2.008                          *
  1239*                                                                *
  1240*   ONLINE CREDIT SYSTEM                                         *
  1241*                                                                *
  1242*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1243*                                                                *
  1244*   FILE TYPE = VSAM,KSDS                                        *
  1245*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1246*                                                                *
  1247*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1248*       ALTERNATE PATH = NONE                                    *
  1249*                                                                *
  1250*   LOG = NO                                                     *
  1251*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1252*                                                                *
  1253******************************************************************
  1254
  1255 01  RATE-RECORD.
  1256     12  RT-RECORD-ID                      PIC XX.
  1257         88  VALID-RT-ID                      VALUE 'RT'.
  1258
  1259     12  RT-CONTROL-PRIMARY.
  1260         16  RT-COMPANY-CD                 PIC X.
  1261         16  RT-STATE-CODE.
  1262             20  RT-ST-CODE                PIC XX.
  1263             20  RT-ST-CLASS               PIC XX.
  1264             20  RT-ST-DEV                 PIC XXX.
  1265         16  RT-L-AH-CODE.
  1266             20  RT-L-AH                   PIC X.
  1267             20  RT-LAH-NUM                PIC XX.
  1268         16  RT-LIMITS.
  1269             20  RT-HIGH-AGE               PIC 99.
  1270             20  RT-HIGH-AMT               PIC 9(6).
  1271             20  RT-FUTURE                 PIC XX.
  1272             20  RT-SEX                    PIC X.
  1273         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1274
  1275     12  RT-MAINT-INFORMATION.
  1276         16  RT-LAST-MAINT-DT              PIC XX.
  1277         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1278         16  RT-LAST-MAINT-USER            PIC X(4).
  1279         16  FILLER                        PIC X(10).
  1280
  1281     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1282     12  RT-RATE-COMMENT                   PIC X(50).
  1283
  1284     12  CSL-RESERVED                      PIC X(10).
  1285     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  27
* ELRATE.cbl
  1286
  1287     12  RT-MAX-AGE                        PIC 99.
  1288
  1289     12  RT-LIFE-LIMS-FLDS.
  1290         16  RT-LIFE-MORT-CODE             PIC X(4).
  1291         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1292             20  RT-L-EX-AGE               PIC 99.
  1293             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1294             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1295         16  FILLER                        PIC X(20).
  1296
  1297     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1298         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1299             20  RT-AH-AGE                 PIC 99.
  1300             20  RT-AH-TERM                PIC S999       COMP-3.
  1301             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1302             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1303
  1304     12  RT-LIFE-RATES.
  1305         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1306
  1307     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1308         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1309
  1310     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1311
  1312     12  RT-DISCOUNT-OPTION                PIC X.
  1313         88  RT-DO-NOT-USE                     VALUE ' '.
  1314         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1315         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1316
  1317     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1318     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1319
  1320     12  RT-COMPOSITE-OPTION               PIC X.
  1321         88  RT-NO-COMPOSITE                   VALUE ' '.
  1322         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1323
  1324     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1325
  1326     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  1327     12  FILLER                            PIC X(13).
  1328
  1329     12  RT-TYPE-RATE                      PIC X.
  1330         88  RT-IS-STND                        VALUE ' ' 'S'.
  1331         88  RT-IS-OB                          VALUE 'O'.
  1332
  1333     12  RT-SRT-ALPHA                      PIC X.
  1334
  1335     12  RT-CONTROL-2.
  1336         16  RTC-1                         PIC X(7).
  1337         16  RTC-3                         PIC X(11).
  1338         16  RTC-4                         PIC 9(11) COMP-3.
  1339         16  RTC-2                         PIC X(3).
  1340******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  28
* ELRATE.cbl
  1342 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1343 0000-DFHEXIT SECTION.
  1344     MOVE '9#                    $   ' TO DFHEIV0.
  1345     MOVE 'ELRATE' TO DFHEIV1.
  1346     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1347
  1348     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1349
  1350 000-START-PREMIUM-CALC.
  1351     MOVE ZERO                   TO CP-RETURN-CODE
  1352                                    CP-CALC-PREMIUM
  1353                                    CP-PREMIUM-RATE
  1354                                    CP-POLICY-FEE.
  1355
  1356     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1357     MOVE ALL '9'                TO ERRATE-KEY.
  1358
  1359*    IF CP-RATE-FILE = 'O'
  1360*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1361
  1362     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1363     MOVE CP-STATE               TO RATE-ST-CODE.
  1364     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1365     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1366     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1367
  1368     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1369        CP-RATING-BENEFIT-AMT = ZEROS
  1370         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1371     ELSE
  1372         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1373
  1374     IF CP-AH
  1375         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1376     ELSE
  1377         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1378
  1379     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1380     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1381     MOVE SPACE                  TO DC-OPTION-CODE.
  1382
  1383     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1384
  1385*** Y2K, PROJ 7744
  1386     IF NO-CONVERSION-ERROR
  1387         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1388                                       WS-HOLD-RATE-EXP-DT
  1389         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1390         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1391         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1392     ELSE
  1393         MOVE '2'                   TO CP-RETURN-CODE
  1394         GO TO 9999-CALC-RATE-PREM-X
  1395     END-IF.
  1396*** Y2K, PROJ 7744
  1397
  1398
  1399* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  29
* ELRATE.cbl
  1400*        NOTFND   (9999-RATE-NOTFND)
  1401*        NOTOPEN  (9999-RATE-NOTOPEN)
  1402*        ENDFILE  (9999-RATE-NOTFND)
  1403*    END-EXEC.
  1404*    MOVE '"$IJ''                 ! " #00001394' TO DFHEIV0
  1405     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1407     MOVE X'2220233030303031333934' TO DFHEIV0(25:11)
  1408     CALL 'kxdfhei1' USING DFHEIV0
  1409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1410
  1411
  1412 0050-RATE-START-BROWSE.
  1413
  1414* EXEC CICS STARTBR
  1415*        DATASET  (ERRATE-FILE-ID)
  1416*        RIDFLD   (ERRATE-KEY)
  1417*        GTEQ
  1418*    END-EXEC.
  1419     MOVE 0
  1420       TO DFHEIV11
  1421*    MOVE '&,         G          &   #00001401' TO DFHEIV0
  1422     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1423     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1424     MOVE X'2020233030303031343031' TO DFHEIV0(25:11)
  1425     CALL 'kxdfhei1' USING DFHEIV0,
  1426           ERRATE-FILE-ID,
  1427           ERRATE-KEY,
  1428           DFHEIV99,
  1429           DFHEIV11,
  1430           DFHEIV99
  1431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1432
  1433
  1434     MOVE 'Y'                  TO WS-BROWSE-SW.
  1435
  1436 0100-READ-RATE-LOOP.
  1437
  1438* EXEC CICS READNEXT
  1439*        DATASET  (ERRATE-FILE-ID)
  1440*        SET      (ADDRESS OF RATE-RECORD)
  1441*        RIDFLD   (ERRATE-KEY)
  1442*    END-EXEC.
  1443     MOVE 0
  1444       TO DFHEIV11
  1445*    MOVE '&.S                   )   #00001410' TO DFHEIV0
  1446     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1447     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1448     MOVE X'2020233030303031343130' TO DFHEIV0(25:11)
  1449     CALL 'kxdfhei1' USING DFHEIV0,
  1450           ERRATE-FILE-ID,
  1451           DFHEIV20,
  1452           DFHEIV99,
  1453           ERRATE-KEY,
  1454           DFHEIV99,
  1455           DFHEIV11,
  1456           DFHEIV99,
  1457           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  30
* ELRATE.cbl
  1458     SET ADDRESS OF RATE-RECORD TO
  1459         DFHEIV20
  1460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1461
  1462
  1463 0110-CHECK-KEYS.
  1464*                            COPY ELCRATPD.
  1465******************************************************************
  1466*                                                                *
  1467*                                                                *
  1468*                            ELCRATPD                            *
  1469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1470*                            VMOD=2.061                          *
  1471*                                                                *
  1472******************************************************************
  1473******************************************************************
  1474*                   C H A N G E   L O G
  1475*
  1476* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1477*-----------------------------------------------------------------
  1478*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1479* EFFECTIVE    NUMBER
  1480*-----------------------------------------------------------------
  1481* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1482* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1483* 032603                   PEMA  ADD SPECIAL AZ CALC
  1484* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1485* 120403                   PEMA  ADD SPECIAL TX CALC
  1486* 092205                   PEMA  FIX CRIT PER FOR DCC
  1487* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1488* 021207                   PEMA  ADD PA NP
  1489* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1490* 032807                   PEMA  ADD VT NP PLUS 2
  1491* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1492* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1493* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1494* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1495* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1496* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1497* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1498* 071211    2010012700001  PEMA  ADD SPPDD
  1499* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1500* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1501* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1502* 032612  CR2011110200001  PEMA  AHL CHANGES
  1503* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1504* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1505* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1506******************************************************************
  1507
  1508 0110-CHECK-KEY.
  1509     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1510        SVRT-ST-CODE    = RT-ST-CODE     AND
  1511        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1512        SVRT-ST-DEV     = RT-ST-DEV      AND
  1513        SVRT-L-AH       = RT-L-AH        AND
  1514        SVRT-LAH-NUM    = RT-LAH-NUM
  1515         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  31
* ELRATE.cbl
  1516     ELSE
  1517         GO TO 9999-RATE-NOTFND.
  1518
  1519     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1520         GO TO 9999-RATE-NOTFND.
  1521
  1522     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1523        GO TO 0100-READ-RATE-LOOP.
  1524
  1525     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1526         GO TO 0100-READ-RATE-LOOP.
  1527
  1528     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1529         GO TO 0100-READ-RATE-LOOP.
  1530
  1531     IF RT-MAX-AGE = ZEROS
  1532         NEXT SENTENCE
  1533     ELSE
  1534         COMPUTE WS-AGE =
  1535             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1536         IF WS-AGE >= RT-MAX-AGE
  1537             MOVE 'B'               TO CP-RETURN-CODE.
  1538
  1539     IF CP-LOAN-TERM NOT NUMERIC
  1540         MOVE +0                    TO CP-LOAN-TERM.
  1541
  1542     IF CP-LOAN-TERM = ZERO
  1543         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1544
  1545     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1546         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1547
  1548     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1549     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1550
  1551     IF CP-AH
  1552         GO TO 2000-TYPE-IS-AH.
  1553
  1554     evaluate true
  1555        when (rt-is-ob)
  1556           and (cp-company-id not = 'CID')
  1557              move cp-loan-term  to ws-rate-term
  1558        when (cp-company-id = 'DCC')
  1559           and (cp-benefit-cd (1:1) = 'P')
  1560           move cp-loan-term     to ws-rate-term
  1561        when other
  1562           move cp-original-term to ws-rate-term
  1563     end-evaluate
  1564
  1565*    IF ((RT-IS-OB)
  1566*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1567*                     OR
  1568*       ((CP-COMPANY-ID = 'DCC')
  1569*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1570*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1571*    ELSE
  1572*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1573*    END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  32
* ELRATE.cbl
  1574
  1575     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1576     MOVE SPACE                     TO DC-OPTION-CODE.
  1577
  1578     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1579
  1580 1000-TYPE-IS-LIFE.
  1581     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1582
  1583     MOVE ZERO                      TO CP-R-MAX-AGE
  1584                                       CP-R-MAX-TERM
  1585                                       CP-R-MAX-MON-BEN
  1586                                       CP-R-MAX-TOT-BEN.
  1587
  1588     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1589
  1590     IF RT-POLICY-FEE NUMERIC
  1591        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1592
  1593     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1594
  1595     IF (RT-DISCOUNT-OPTION EQUAL
  1596                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1597        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1598        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1599         NEXT SENTENCE
  1600     ELSE
  1601         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1602            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1603             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1604                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1605                 GO TO 1050-REGULAR-RATES
  1606             ELSE
  1607                 GO TO 1050-REGULAR-RATES
  1608         ELSE
  1609             GO TO 1050-REGULAR-RATES.
  1610
  1611*    display ' discount option ' rt-discount-option
  1612     IF RT-DISCOUNT-RATE NOT NUMERIC
  1613        MOVE +0                  TO RT-DISCOUNT-RATE.
  1614
  1615     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1616        NEXT SENTENCE
  1617     ELSE
  1618        MOVE +0                  TO CP-PREMIUM-RATE
  1619                                    CP-COMPOSITE-RATE
  1620                                    CP-CALC-PREMIUM
  1621         MOVE '4'                TO CP-RETURN-CODE
  1622         GO TO 9999-CALC-RATE-PREM-X.
  1623
  1624     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1625        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1626     ELSE
  1627        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1628
  1629*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1630*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1631*       GO TO 1075-BYPASS-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  33
* ELRATE.cbl
  1632
  1633     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1634        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1635        COMPUTE WS-WORK-DIS-RATE EQUAL
  1636                WS-WORK-DIS-RATE / +100
  1637        GO TO 1075-BYPASS-REGULAR-RATE.
  1638
  1639     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1640        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1641        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1642        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1643        GO TO 1075-BYPASS-REGULAR-RATE.
  1644
  1645     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1646        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1647        (CP-TRUNCATED-LIFE)
  1648        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1649        GO TO 1075-BYPASS-REGULAR-RATE.
  1650
  1651     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1652        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1653        (CP-EARN-AS-NET-PAY)
  1654*       (CP-TRUNCATED-LIFE)
  1655        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1656        GO TO 1075-BYPASS-REGULAR-RATE.
  1657
  1658     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1659        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1660                   AND
  1661        ((CP-EARN-AS-NET-PAY)
  1662               OR
  1663        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1664        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1665        GO TO 1075-BYPASS-REGULAR-RATE.
  1666
  1667     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1668        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1669        (CP-EARN-AS-NET-PAY) AND
  1670        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1671        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1672        GO TO 1075-BYPASS-REGULAR-RATE.
  1673
  1674     IF (CP-COMPANY-ID = 'CID')
  1675        AND (CP-STATE-STD-ABBRV = 'MN')
  1676        AND (RT-DISCOUNT-OPTION = '1')
  1677        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1678                     OR
  1679            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1680            AND (CP-CERT-EFF-DT > X'A4FF'))
  1681        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1682        GO TO 1075-BYPASS-REGULAR-RATE
  1683     END-IF
  1684     IF (CP-COMPANY-ID EQUAL 'CID')
  1685        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1686                      OR
  1687            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1688        AND (CP-EARN-AS-NET-PAY)
  1689        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  34
* ELRATE.cbl
  1690        GO TO 1075-BYPASS-REGULAR-RATE
  1691     END-IF
  1692     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1693        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1694        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1695         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1696         GO TO 1075-BYPASS-REGULAR-RATE.
  1697
  1698     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1699        CONTINUE
  1700     ELSE
  1701        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1702           (CP-EARN-AS-NET-PAY ) AND
  1703           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1704            GO TO 1075-BYPASS-REGULAR-RATE
  1705        END-IF
  1706     END-IF
  1707     IF (CP-COMPANY-ID = 'CID') AND
  1708        (CP-EARN-AS-NET-PAY) AND
  1709        (CP-LEVEL-LIFE) AND
  1710        (CP-STATE-STD-ABBRV = 'CA') AND
  1711        (CP-STATE-STD-ABBRV = CP-STATE)
  1712        COMPUTE WS-WORK-DIS-RATE =
  1713             RT-DISCOUNT-RATE / +100
  1714        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1715        GO TO 1075-BYPASS-REGULAR-RATE
  1716     END-IF
  1717
  1718     IF (CP-COMPANY-ID = 'CID')
  1719        AND (CP-EARN-AS-NET-PAY)
  1720        AND (CP-STATE-STD-ABBRV = 'ME')
  1721        COMPUTE WS-WORK-DIS-RATE =
  1722             RT-DISCOUNT-RATE / +100
  1723        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1724        GO TO 1075-BYPASS-REGULAR-RATE
  1725     END-IF
  1726     IF (CP-COMPANY-ID = 'CID')
  1727        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1728           OR 'IN' OR 'AZ' OR 'WA')
  1729        AND (CP-FARM-PLAN)
  1730        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1731        GO TO 1075-BYPASS-REGULAR-RATE
  1732     END-IF
  1733     IF (CP-COMPANY-ID = 'DCC')
  1734        AND (CP-BEN-CATEGORY = 'D')
  1735        AND (CP-EARN-AS-NET-PAY)
  1736        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1737        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1738           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1739*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1740*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1741*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1742*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1743        GO TO 1075-BYPASS-REGULAR-RATE
  1744     END-IF
  1745     IF (CP-COMPANY-ID = 'CID') AND
  1746        (CP-EARN-AS-NET-PAY) AND
  1747        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  35
* ELRATE.cbl
  1748                            OR 'VT')
  1749                   OR
  1750        ((CP-STATE-STD-ABBRV = 'IN') AND
  1751        (CP-CERT-EFF-DT > X'9A7F'))
  1752                   OR
  1753        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1754        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1755        (CP-STATE-STD-ABBRV = CP-STATE)
  1756        COMPUTE WS-WORK-DIS-RATE =
  1757             RT-DISCOUNT-RATE / +100
  1758        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1759        GO TO 1075-BYPASS-REGULAR-RATE
  1760     END-IF
  1761
  1762     IF (CP-COMPANY-ID = 'CID') AND
  1763        (CP-EARN-AS-NET-PAY) AND
  1764        (CP-STATE-STD-ABBRV = 'TX') AND
  1765        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1766        (WS-DISCOUNT-OPTION NOT = ' ')
  1767        COMPUTE WS-WORK-DIS-RATE =
  1768             RT-DISCOUNT-RATE / +100
  1769        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1770        GO TO 1075-BYPASS-REGULAR-RATE
  1771     END-IF
  1772
  1773     IF (CP-COMPANY-ID = 'CID') AND
  1774        (CP-EARN-AS-NET-PAY) AND
  1775        (CP-TRUNCATED-LIFE) AND
  1776        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1777        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1778        (WS-DISCOUNT-OPTION NOT = ' ')
  1779        COMPUTE WS-WORK-DIS-RATE =
  1780             RT-DISCOUNT-RATE / +100
  1781        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1782        GO TO 1075-BYPASS-REGULAR-RATE
  1783     END-IF
  1784
  1785     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1786        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1787           COMPUTE WS-WORK-DIS-RATE EQUAL
  1788                   WS-WORK-DIS-RATE / +100.
  1789
  1790     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1791        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1792           IF CP-MONTHLY-PAYMENT EQUAL +0
  1793            IF CP-LOAN-APR GREATER THAN +2
  1794              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1795              CP-ORIGINAL-BENEFIT /
  1796               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1797               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1798            ELSE
  1799             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1800               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1801
  1802     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1803        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1804          IF WS-WORK-DIS-RATE GREATER THAN +0
  1805           COMPUTE WK1 ROUNDED EQUAL
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  36
* ELRATE.cbl
  1806           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1807                              (WS-RATE-TERM - +1)) /
  1808                        (WS-WORK-DIS-RATE / +12)
  1809           COMPUTE WK2 ROUNDED EQUAL
  1810           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1811                              (WS-RATE-TERM)) /
  1812                        (WS-WORK-DIS-RATE / +12)
  1813           COMPUTE WK3 EQUAL
  1814                RT-DISCOUNT-OB-RATE *
  1815                (1 + WS-WORK-DIS-RATE / +12)
  1816                MOVE WK3 TO CP-PREMIUM-RATE
  1817                COMPUTE WK5 EQUAL WK3 / +1000
  1818           GO TO 1075-BYPASS-REGULAR-RATE.
  1819*               (RT-DISCOUNT-OB-RATE / +1000) *
  1820*               (1 + WS-WORK-DIS-RATE / +12)
  1821*          GO TO 1075-BYPASS-REGULAR-RATE.
  1822
  1823     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1824        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1825           COMPUTE WK3 EQUAL
  1826           RT-DISCOUNT-OB-RATE *
  1827           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1828           MOVE WK3 TO CP-PREMIUM-RATE
  1829           COMPUTE WK5 EQUAL WK3 / +1000
  1830           GO TO 1075-BYPASS-REGULAR-RATE.
  1831
  1832     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1833        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1834        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1835        GO TO 1075-BYPASS-REGULAR-RATE.
  1836
  1837     COMPUTE WS-SIN-PREM-RATE =
  1838             (RT-DISCOUNT-OB-RATE / +1000) *
  1839             ((WS-RATE-TERM + +1) / +2).
  1840
  1841     COMPUTE CP-PREMIUM-RATE =
  1842             WS-SIN-PREM-RATE /
  1843             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1844             WS-RATE-TERM) / +24)).
  1845
  1846     IF CP-PREMIUM-RATE NOT = +0
  1847        MULTIPLY +100 BY CP-PREMIUM-RATE
  1848        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1849        GO TO 1075-BYPASS-REGULAR-RATE.
  1850
  1851 1050-REGULAR-RATES.
  1852
  1853     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1854        COMPUTE WK5 EQUAL
  1855        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1856        (6 * (WS-RATE-TERM + 1))
  1857        MOVE WK5 TO CP-PREMIUM-RATE
  1858        GO TO 1075-BYPASS-REGULAR-RATE.
  1859
  1860     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1861        (CP-CSL-VALID-NP-BENEFIT-CD)
  1862        IF CP-JOINT-INDICATOR EQUAL 'J'
  1863           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  37
* ELRATE.cbl
  1864           GO TO 1075-BYPASS-REGULAR-RATE
  1865        ELSE
  1866           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1867           GO TO 1075-BYPASS-REGULAR-RATE.
  1868
  1869     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1870        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1871        (CP-EARN-AS-NET-PAY )
  1872        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1873        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1874        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1875        MOVE '1'                 TO DC-OPTION-CODE
  1876        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1877        IF DATE-CONVERSION-ERROR
  1878            MOVE '2'                TO CP-RETURN-CODE
  1879            GO TO 9999-CALC-RATE-PREM-X
  1880        ELSE
  1881            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1882                                         DC-ODD-DAYS-OVER
  1883            GO TO 1075-BYPASS-REGULAR-RATE.
  1884
  1885     IF RT-COMPOSITE-RATE NOT NUMERIC
  1886         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1887
  1888*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1889     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1890         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1891                                              WS-PREMIUM-RATE
  1892         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1893     ELSE
  1894         MOVE +0                           TO CP-PREMIUM-RATE
  1895                                              CP-COMPOSITE-RATE
  1896                                              CP-CALC-PREMIUM
  1897         GO TO 9999-CALC-RATE-PREM-X.
  1898     IF (CP-COMPANY-ID EQUAL 'CID')
  1899        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1900        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1901        AND (CP-EARN-AS-NET-PAY)
  1902        GO TO 1075-BYPASS-REGULAR-RATE
  1903     END-IF
  1904******************************************************
  1905*    IF CP-COMPANY-ID NOT = 'LBL'
  1906     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1907         GO TO 1075-BYPASS-REGULAR-RATE.
  1908
  1909     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1910     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1911     MOVE '1'                    TO DC-OPTION-CODE.
  1912     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1913     IF DATE-CONVERSION-ERROR
  1914         MOVE '2'                TO CP-RETURN-CODE
  1915         GO TO 9999-CALC-RATE-PREM-X
  1916       ELSE
  1917         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1918         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1919
  1920     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1921        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  38
* ELRATE.cbl
  1922        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1923
  1924     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1925        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1926           NEXT SENTENCE
  1927         ELSE
  1928           GO TO 1075-BYPASS-REGULAR-RATE
  1929       ELSE
  1930        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1931           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1932           NEXT SENTENCE
  1933         ELSE
  1934           GO TO 1075-BYPASS-REGULAR-RATE.
  1935
  1936     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1937        COMPUTE CP-PREMIUM-RATE =
  1938        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1939         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1940         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1941
  1942     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1943        COMPUTE CP-PREMIUM-RATE =
  1944        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1945        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1946        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1947        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1948         * (CP-ORIGINAL-TERM - 1)).
  1949******************************************************
  1950
  1951 1075-BYPASS-REGULAR-RATE.
  1952
  1953     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1954
  1955     MOVE +1 TO LINDX.
  1956
  1957     IF CP-COMPANY-ID EQUAL 'CRI'
  1958        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1959           MOVE +5               TO LINDX
  1960           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1961              MOVE 'F'           TO CP-RETURN-CODE
  1962              GO TO 1200-CALCULATE-PREMIUMS.
  1963
  1964     IF RT-L-EX-AGE (LINDX) = ZERO
  1965          GO TO 1200-CALCULATE-PREMIUMS.
  1966
  1967 1100-SEARCH-LIFE-LIMITS.
  1968
  1969     IF CP-COMPANY-ID EQUAL 'CRI'
  1970        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1971           IF LINDX GREATER THAN +4
  1972              MOVE 'A'           TO CP-RETURN-CODE
  1973              GO TO 1200-CALCULATE-PREMIUMS.
  1974
  1975     IF LINDX GREATER +8
  1976         MOVE 'A'                TO CP-RETURN-CODE
  1977         GO TO 1200-CALCULATE-PREMIUMS.
  1978
  1979     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  39
* ELRATE.cbl
  1980         IF RT-L-EX-AGE (LINDX) = ZEROS
  1981             ADD +1              TO LINDX
  1982             GO TO 1100-SEARCH-LIFE-LIMITS
  1983         ELSE
  1984             MOVE RT-L-EX-AGE (LINDX)
  1985                                 TO CP-R-MAX-AGE
  1986             MOVE RT-L-EX-TERM (LINDX)
  1987                                 TO CP-R-MAX-TERM
  1988             MOVE RT-L-EX-FACE (LINDX)
  1989                                 TO CP-R-MAX-TOT-BEN
  1990             ADD +1              TO LINDX
  1991             GO TO 1100-SEARCH-LIFE-LIMITS
  1992     ELSE
  1993         MOVE RT-L-EX-AGE (LINDX)
  1994                                 TO CP-R-MAX-AGE
  1995         MOVE RT-L-EX-TERM (LINDX)
  1996                                 TO CP-R-MAX-TERM
  1997         MOVE RT-L-EX-FACE (LINDX)
  1998                                 TO CP-R-MAX-TOT-BEN.
  1999
  2000     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  2001         MOVE '9'                TO CP-RETURN-CODE.
  2002
  2003     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  2004         MOVE '8'                TO CP-RETURN-CODE.
  2005
  2006 1200-CALCULATE-PREMIUMS.
  2007
  2008     IF CP-COMPANY-ID = 'CSL'
  2009        IF CP-CSL-VALID-NP-BENEFIT-CD
  2010           GO TO 1240-NET-PAY-CONT
  2011        ELSE
  2012           GO TO 1250-CSL-CALC.
  2013
  2014     IF CP-COMPANY-ID = 'WDS'
  2015        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2016           IF CP-EARN-AS-REG-BALLOON
  2017              GO TO 1240-NET-PAY-CONT.
  2018
  2019     IF (CP-COMPANY-ID = 'CID')
  2020        AND (CP-STATE-STD-ABBRV = 'MN')
  2021        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2022        AND (CP-CERT-EFF-DT > X'A4FF')
  2023        GO TO 1240-NET-PAY-CONT
  2024     END-IF
  2025     IF (CP-COMPANY-ID = 'CID')
  2026        AND (CP-STATE-STD-ABBRV = 'WA')
  2027        AND (CP-FARM-PLAN)
  2028        GO TO 1240-NET-PAY-CONT
  2029     END-IF
  2030     IF (CP-COMPANY-ID = 'CID')
  2031        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2032           OR 'IN' OR 'AZ')
  2033        AND (CP-FARM-PLAN)
  2034***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2035***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2036        MOVE +1.0                TO CP-LOAN-APR
  2037        GO TO 1240-NET-PAY-CONT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  40
* ELRATE.cbl
  2038     END-IF
  2039     IF CP-RATE-AS-STANDARD
  2040         GO TO 1210-REGULAR-RATE.
  2041
  2042     IF CP-CRITICAL-PERIOD
  2043         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2044
  2045     IF CP-EARN-AS-TEXAS
  2046         GO TO 1230-TEXAS-CONT.
  2047
  2048     IF CP-EARN-AS-NET-PAY
  2049        IF CP-STATE-STD-ABBRV = 'MD'
  2050          IF CP-COMPANY-ID = 'MON'
  2051            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2052                               '14' OR '26' OR '47'
  2053              GO TO 1210-REGULAR-RATE.
  2054
  2055     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2056        IF CP-MONTHLY-PAYMENT EQUAL +0
  2057           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2058                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2059
  2060     IF CP-COMPANY-ID EQUAL 'GTL'
  2061        NEXT SENTENCE
  2062     ELSE
  2063     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2064        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2065           COMPUTE WK3 ROUNDED EQUAL
  2066           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2067           CP-MONTHLY-PAYMENT
  2068           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2069           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2070           CP-ALTERNATE-BENEFIT)
  2071           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2072           WK3 * WK5
  2073           GO TO 9999-CALC-RATE-PREM-X
  2074        ELSE
  2075           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2076           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2077           (WS-WORK-DIS-RATE / +12)
  2078           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2079           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2080                               WK5
  2081           GO TO 9999-CALC-RATE-PREM-X.
  2082
  2083     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2084        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2085        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2086        CP-ORIGINAL-TERM LESS THAN +61
  2087        COMPUTE CP-CALC-PREMIUM EQUAL
  2088                        (CP-ORIGINAL-BENEFIT *
  2089           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2090           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2091        COMPUTE CP-CALC-PREMIUM EQUAL
  2092                CP-CALC-PREMIUM +
  2093              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2094        (CP-ORIGINAL-TERM + 1)) /
  2095        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  41
* ELRATE.cbl
  2096        GO TO 9999-CALC-RATE-PREM-X.
  2097
  2098     IF CP-COMPANY-ID = 'GTL'     AND
  2099        CP-STATE-STD-ABBRV = 'PA' AND
  2100        CP-SPECIAL-CALC-CD = 'H'
  2101         GO TO 1260-GTL-PA-LEASE.
  2102
  2103     IF (CP-EARN-AS-NET-PAY)
  2104*       AND (CP-LOAN-APR > ZEROS)
  2105        GO TO 1240-NET-PAY-CONT
  2106     END-IF
  2107
  2108     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2109         GO TO 1210-REGULAR-RATE.
  2110
  2111**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2112**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2113****
  2114     IF CP-DEVIATION-CODE = 'LEV' AND
  2115        CP-LOAN-APR = ZEROS
  2116         GO TO 1210-REGULAR-RATE.
  2117
  2118     IF (CP-STATE-STD-ABBRV = 'OH')
  2119        AND (CP-CLASS-CODE NOT = 'L ')
  2120        AND (CP-ORIGINAL-TERM > 60)
  2121        AND (DC-GREG-DATE-CYMD > 19831031)
  2122        AND (CP-LOAN-APR > ZEROS)
  2123        GO TO 1240-NET-PAY-CONT
  2124     END-IF
  2125
  2126     IF (CP-STATE-STD-ABBRV = 'UT')
  2127        AND (CP-ORIGINAL-TERM > 62)
  2128        AND (DC-GREG-DATE-CYMD > 19810831)
  2129        AND (DC-GREG-DATE-CYMD < 19830901)
  2130        AND (CP-LOAN-APR > ZEROS)
  2131        GO TO 1240-NET-PAY-CONT
  2132     END-IF
  2133
  2134     IF (CP-STATE-STD-ABBRV = 'RI')
  2135        AND (CP-ORIGINAL-TERM > 60)
  2136        AND (DC-GREG-DATE-CYMD > 19831231)
  2137        AND (CP-LOAN-APR > ZEROS)
  2138        GO TO 1240-NET-PAY-CONT
  2139     END-IF
  2140     .
  2141 1210-REGULAR-RATE.
  2142
  2143     IF (CP-COMPANY-ID = 'CID')
  2144        AND (CP-EARN-AS-NET-PAY)
  2145        AND (CP-LOAN-APR = 0)
  2146        IF RT-L-RATE (WS-RATE-TERM) = 0
  2147           COMPUTE WS-SIN-PREM-RATE =
  2148              (RT-DISCOUNT-OB-RATE / +1000) *
  2149              ((WS-RATE-TERM + +1) / +2)
  2150           COMPUTE CP-PREMIUM-RATE =
  2151              WS-SIN-PREM-RATE /
  2152              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2153              WS-RATE-TERM) / +24))
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  42
* ELRATE.cbl
  2154        ELSE
  2155           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2156        END-IF
  2157     END-IF
  2158*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2159*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2160*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2161*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2162*
  2163*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2164*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2165*          COMPUTE WK3 ROUNDED EQUAL
  2166*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2167*          CP-MONTHLY-PAYMENT
  2168*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2169*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2170*          CP-ALTERNATE-BENEFIT)
  2171*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2172*          WK3 * WK5
  2173*          GO TO 9999-CALC-RATE-PREM-X
  2174*       ELSE
  2175*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2176*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2177*          (WS-WORK-DIS-RATE / +12)
  2178*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2179*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2180*                              WK5
  2181*          GO TO 9999-CALC-RATE-PREM-X.
  2182
  2183     IF CP-TERM-IS-DAYS
  2184         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2185             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2186         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2187             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2188                          * CP-TERM-OR-EXT-DAYS
  2189           GO TO 9999-CALC-RATE-PREM-X.
  2190
  2191     if (cp-company-id = 'AHL')
  2192        and (cp-loan-term > cp-original-term)
  2193        continue
  2194     else
  2195        IF NOT CP-TRUNCATED-LIFE
  2196           GO TO 1212-GROSS-NOT-TRUNCATED
  2197        end-if
  2198     end-if
  2199
  2200****  GROSS TRUNCATED CALCULATION
  2201
  2202     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2203         MOVE 'H'                TO  CP-RETURN-CODE
  2204         GO TO 9999-CALC-RATE-PREM-X.
  2205     if cp-company-id = 'AHL'
  2206        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2207           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2208           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2209           cp-original-term) * (cp-loan-term - cp-original-term
  2210            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2211            cp-premium-rate / 100 * cp-original-term /
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  43
* ELRATE.cbl
  2212            cp-loan-term * cp-original-benefit
  2213        else
  2214           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2215           cp-original-term) * (cp-loan-term - cp-original-term
  2216            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2217            cp-premium-rate * cp-original-benefit / 100
  2218        end-if
  2219        go to 9999-calc-rate-prem-x
  2220     end-if
  2221
  2222     IF CP-COMPANY-ID = 'NCL'
  2223         COMPUTE WK-MONTHLY-RATE =
  2224               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2225                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2226                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2227                                 /
  2228                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2229                                 *
  2230                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2231         COMPUTE CP-CALC-PREMIUM =
  2232                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2233     ELSE
  2234         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2235                                 CP-ORIGINAL-TERM
  2236         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2237                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2238                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2239                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2240     END-IF
  2241     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2242        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2243           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2244           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2245     END-IF
  2246     GO TO 9999-CALC-RATE-PREM-X
  2247     .
  2248 1212-GROSS-NOT-TRUNCATED.
  2249*    DISPLAY ' ELCRATPD '
  2250*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2251*    display ' premium rate ' cp-premium-rate
  2252
  2253     IF (CP-COMPANY-ID = 'CID')
  2254        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2255           OR 'IN')
  2256        AND (CP-BENEFIT-CD = '55' OR '56')
  2257        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2258          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2259          (CP-ORIGINAL-TERM) *
  2260          ((CP-ORIGINAL-TERM) / 12) *
  2261          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2262          GO TO 9999-CALC-RATE-PREM-X
  2263     END-IF
  2264     IF (CP-COMPANY-ID = 'CID')
  2265        AND (CP-STATE-STD-ABBRV = 'GA')
  2266        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2267        COMPUTE WK3 ROUNDED =
  2268          CP-ORIGINAL-BENEFIT *
  2269          ((CP-ORIGINAL-TERM + 1) / 2) *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  44
* ELRATE.cbl
  2270          (RT-DISCOUNT-OB-RATE / 1000)
  2271          MOVE WK3 TO CP-CALC-PREMIUM
  2272          GO TO 9999-CALC-RATE-PREM-X
  2273     END-IF
  2274     IF (CP-COMPANY-ID EQUAL 'CID')
  2275        AND (CP-STATE-STD-ABBRV = 'MN')
  2276        AND (CP-LEVEL-LIFE)
  2277        AND (CP-CERT-EFF-DT > X'A4FF')
  2278        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2279        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2280        MOVE '1'                 TO DC-OPTION-CODE
  2281        PERFORM 9100-CONVERT-DATE
  2282                                 THRU 9100-EXIT
  2283        IF DATE-CONVERSION-ERROR
  2284           MOVE '2'              TO CP-RETURN-CODE
  2285           MOVE ZEROS            TO FACTOR
  2286                                 CP-CALC-PREMIUM
  2287           GO TO 9999-CALC-RATE-PREM-X
  2288        END-IF
  2289        MOVE DC-ELAPSED-DAYS     TO D
  2290        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2291           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2292           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2293        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2294           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2295        GO TO 9999-CALC-RATE-PREM-X
  2296     END-IF
  2297     IF (CP-COMPANY-ID = 'CID')
  2298        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2299        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2300           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2301     ELSE
  2302        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2303                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2304     END-IF
  2305*    display ' calc premium ' cp-calc-premium
  2306
  2307*    IF CP-COMPANY-ID = 'LBL'
  2308     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2309        AND (NOT CP-EARN-AS-NET-PAY)
  2310        GO TO 9999-CALC-RATE-PREM-X
  2311     END-IF
  2312
  2313*    display ' fell through to ext days '
  2314     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2315         GO TO 9999-CALC-RATE-PREM-X.
  2316
  2317     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2318         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2319            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2320               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2321
  2322     GO TO 9999-CALC-RATE-PREM-X.
  2323
  2324 1220-CRITICAL-PERIOD-LF-CONT.
  2325     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2326               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2327
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  45
* ELRATE.cbl
  2328     GO TO 9999-CALC-RATE-PREM-X.
  2329
  2330 1230-TEXAS-CONT.
  2331     IF CP-FARM-PLAN
  2332         GO TO 1235-TEXAS-FARM-CONT.
  2333
  2334     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2335               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2336
  2337     COMPUTE TEX-FACT-9 =
  2338                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2339                 (CP-ORIGINAL-TERM + 1).
  2340
  2341     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2342                 CP-CALC-PREMIUM * TEX-FACT-9.
  2343
  2344     GO TO 9999-CALC-RATE-PREM-X.
  2345
  2346 1235-TEXAS-FARM-CONT.
  2347     COMPUTE WS-FARM-TERM =
  2348               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2349
  2350     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2351     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2352
  2353
  2354     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2355              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2356
  2357     GO TO 9999-CALC-RATE-PREM-X.
  2358
  2359 1240-NET-PAY-CONT.
  2360
  2361     MOVE CP-LOAN-APR             TO N-P-APR.
  2362     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2363                                     N-P-REM
  2364                                     N-P-LOAN.
  2365
  2366     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2367
  2368     IF CP-TRUNCATED-LIFE
  2369         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2370
  2371     IF CP-COMPANY-ID EQUAL 'NCL'
  2372        NEXT SENTENCE
  2373     ELSE
  2374        GO TO 1241-NET-PAY-CONT.
  2375
  2376     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2377     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2378     MOVE '1'                    TO DC-OPTION-CODE
  2379     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2380     IF DATE-CONVERSION-ERROR
  2381         MOVE '2'                TO CP-RETURN-CODE
  2382         GO TO 9999-CALC-RATE-PREM-X
  2383     ELSE
  2384        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2385        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  46
* ELRATE.cbl
  2386
  2387     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2388        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2389        NEXT SENTENCE
  2390     ELSE
  2391        MOVE +1                  TO ODF
  2392        GO TO 1241-NET-PAY-CONT.
  2393
  2394     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2395        COMPUTE CP-PREMIUM-RATE EQUAL
  2396        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2397        CP-PREMIUM-RATE) *
  2398        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2399
  2400     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2401        COMPUTE CP-PREMIUM-RATE EQUAL
  2402        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2403        N-P-LOAN * (N-P-LOAN - 1))) *
  2404        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2405        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2406
  2407     COMPUTE ODF EQUAL
  2408     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2409     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2410
  2411 1241-NET-PAY-CONT.
  2412
  2413     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2414
  2415*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2416     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2417        NEXT SENTENCE
  2418     ELSE
  2419        GO TO 9999-CALC-RATE-PREM-X.
  2420
  2421     IF RT-DISCOUNT-OPTION EQUAL '6'
  2422         GO TO 9999-CALC-RATE-PREM-X.
  2423
  2424     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2425        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2426        GO TO 9999-CALC-RATE-PREM-X.
  2427
  2428     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2429
  2430     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2431        GO TO 9999-CALC-RATE-PREM-X.
  2432
  2433     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2434        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2435        (CP-TRUNCATED-LIFE)
  2436        GO TO 9999-CALC-RATE-PREM-X.
  2437
  2438     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2439        (CP-CSL-VALID-NP-BENEFIT-CD)
  2440        GO TO 9999-CALC-RATE-PREM-X.
  2441
  2442     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2443        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  47
* ELRATE.cbl
  2444        (CP-EARN-AS-NET-PAY)
  2445        GO TO 9999-CALC-RATE-PREM-X.
  2446
  2447*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2448*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2449*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2450*       GO TO 9999-CALC-RATE-PREM-X.
  2451
  2452     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2453        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2454        (CP-EARN-AS-NET-PAY)
  2455        GO TO 9999-CALC-RATE-PREM-X.
  2456
  2457     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2458        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2459        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2460        GO TO 9999-CALC-RATE-PREM-X.
  2461
  2462     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2463        (CP-EARN-AS-NET-PAY)
  2464        GO TO 9999-CALC-RATE-PREM-X.
  2465
  2466     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2467        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2468        (CP-TRUNCATED-LIFE)
  2469        GO TO 9999-CALC-RATE-PREM-X.
  2470
  2471     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2472        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2473        (CP-EARN-AS-NET-PAY)
  2474*       (CP-TRUNCATED-LIFE)
  2475        GO TO 9999-CALC-RATE-PREM-X.
  2476
  2477     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2478        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2479                   AND
  2480        ((CP-EARN-AS-NET-PAY)
  2481               OR
  2482        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2483        GO TO 9999-CALC-RATE-PREM-X.
  2484
  2485     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2486        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2487        (CP-EARN-AS-NET-PAY) AND
  2488        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2489        GO TO 9999-CALC-RATE-PREM-X.
  2490
  2491     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2492        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2493        (CP-EARN-AS-NET-PAY)
  2494        GO TO 9999-CALC-RATE-PREM-X.
  2495
  2496     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2497        CONTINUE
  2498     ELSE
  2499        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2500           (CP-EARN-AS-NET-PAY) AND
  2501           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  48
* ELRATE.cbl
  2502           GO TO 9999-CALC-RATE-PREM-X
  2503        END-IF
  2504     END-IF
  2505
  2506     IF (CP-COMPANY-ID = 'CID')
  2507        AND (CP-EARN-AS-NET-PAY)
  2508        AND (CP-STATE-STD-ABBRV = 'ME')
  2509        GO TO 9999-CALC-RATE-PREM-X
  2510     END-IF
  2511     IF (CP-COMPANY-ID = 'DCC')
  2512        AND (CP-BEN-CATEGORY = 'D')
  2513        AND (CP-EARN-AS-NET-PAY)
  2514        GO TO 9999-CALC-RATE-PREM-X
  2515     END-IF
  2516     IF (CP-COMPANY-ID = 'CID')
  2517        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2518           OR 'IN' OR 'AZ' OR 'WA')
  2519        AND (CP-FARM-PLAN)
  2520        GO TO 9999-CALC-RATE-PREM-X
  2521     END-IF
  2522     IF (CP-COMPANY-ID = 'CID') AND
  2523        (CP-EARN-AS-NET-PAY) AND
  2524        (CP-LEVEL-LIFE) AND
  2525        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2526        (CP-STATE-STD-ABBRV = CP-STATE)
  2527        GO TO 9999-CALC-RATE-PREM-X
  2528     END-IF
  2529
  2530     IF (CP-COMPANY-ID = 'CID') AND
  2531        (CP-EARN-AS-NET-PAY) AND
  2532        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2533                            OR 'VT')
  2534                   OR
  2535        ((CP-STATE-STD-ABBRV = 'IN') AND
  2536        (CP-CERT-EFF-DT > X'9A7F'))
  2537                   OR
  2538        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2539        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2540        (CP-STATE-STD-ABBRV = CP-STATE)
  2541        GO TO 9999-CALC-RATE-PREM-X
  2542     END-IF
  2543
  2544     IF (CP-COMPANY-ID = 'CID') AND
  2545        (CP-EARN-AS-NET-PAY) AND
  2546        (CP-STATE-STD-ABBRV = 'TX') AND
  2547        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2548        (WS-DISCOUNT-OPTION NOT = ' ')
  2549        GO TO 9999-CALC-RATE-PREM-X
  2550     END-IF
  2551
  2552     IF (CP-COMPANY-ID = 'CID')
  2553        AND (CP-STATE-STD-ABBRV = 'MN')
  2554        AND (RT-DISCOUNT-OPTION = '1')
  2555        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2556           CP-EARN-AS-FARM-PLAN)
  2557        GO TO 9999-CALC-RATE-PREM-X
  2558     END-IF
  2559     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  49
* ELRATE.cbl
  2560        AND (CP-EARN-AS-NET-PAY)
  2561        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2562                      OR
  2563            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2564        GO TO 9999-CALC-RATE-PREM-X
  2565     END-IF
  2566     IF (CP-COMPANY-ID = 'CID')
  2567        AND (CP-EARN-AS-NET-PAY)
  2568        AND (CP-STATE-STD-ABBRV = 'SC')
  2569        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2570        GO TO 9999-CALC-RATE-PREM-X
  2571     END-IF
  2572     IF (CP-COMPANY-ID = 'CID') AND
  2573        (CP-EARN-AS-NET-PAY) AND
  2574        (CP-TRUNCATED-LIFE) AND
  2575        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2576        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2577        (WS-DISCOUNT-OPTION NOT = ' ')
  2578        GO TO 9999-CALC-RATE-PREM-X
  2579     END-IF
  2580
  2581     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2582        (CP-EARN-AS-NET-PAY)
  2583        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2584        GO TO 9999-CALC-RATE-PREM-X
  2585     END-IF
  2586
  2587     IF (CP-COMPANY-ID EQUAL 'CID')
  2588        AND (CP-EARN-AS-NET-PAY)
  2589        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2590        GO TO 9999-CALC-RATE-PREM-X
  2591     END-IF
  2592
  2593     IF (RT-IS-OB) AND
  2594        (CP-COMPANY-ID NOT EQUAL 'CID')
  2595        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2596               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2597      ELSE
  2598         IF (CP-COMPANY-ID = 'DCC')
  2599            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2600            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2601*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2602             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2603               CP-ORIGINAL-TERM
  2604             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2605             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2606        ELSE
  2607           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2608               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2609        END-IF
  2610     END-IF
  2611
  2612     IF CP-ROA-PREM-AT-REFUND
  2613         COMPUTE NET-BEN ROUNDED =
  2614             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2615     ELSE
  2616         COMPUTE NET-BEN ROUNDED =
  2617              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  50
* ELRATE.cbl
  2618
  2619     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2620        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2621          COMPUTE NET-BEN ROUNDED =
  2622              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2623                         (CP-TERM-OR-EXT-DAYS / 30)).
  2624
  2625     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2626*       OR 'DCC'
  2627*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2628     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2629       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2630       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2631                        * CP-ORIGINAL-TERM / 1200))
  2632     ELSE
  2633     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2634       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2635       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2636
  2637****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2638****** INTEREST IS CHARGED ON PREMIUM.
  2639
  2640*    IF CP-STATE-STD-ABBRV = 'MI'
  2641*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2642*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2643
  2644     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2645
  2646     GO TO 9999-CALC-RATE-PREM-X.
  2647
  2648******
  2649****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2650******
  2651
  2652 1250-CSL-CALC.
  2653     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2654     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2655     MOVE '1' TO DC-OPTION-CODE.
  2656     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2657
  2658     IF DATE-CONVERSION-ERROR
  2659         MOVE '2' TO CP-RETURN-CODE
  2660         GO TO 9999-CALC-RATE-PREM-X.
  2661
  2662     IF CP-JOINT-INDICATOR = 'J'
  2663         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2664     ELSE
  2665         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2666
  2667     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2668     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2669
  2670     IF CP-PAY-FREQUENCY = 12
  2671         MOVE 01               TO WS-PAY-SCH.
  2672     IF CP-PAY-FREQUENCY = 04
  2673         MOVE 03               TO WS-PAY-SCH.
  2674     IF CP-PAY-FREQUENCY = 02
  2675         MOVE 06               TO WS-PAY-SCH.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  51
* ELRATE.cbl
  2676     IF CP-PAY-FREQUENCY = 01
  2677         MOVE 12               TO WS-PAY-SCH.
  2678
  2679     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2680     IF CP-PAY-FREQUENCY NOT = 12
  2681         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2682                                WS-NUM-PAYMTS.
  2683
  2684     IF CP-STATE = 'SC'  AND
  2685       (CP-BENEFIT-CD = '07'  OR  '08')
  2686         GO TO 1250-CSL-CALC-LIFE-6.
  2687
  2688     IF CP-CSL-METH-1
  2689         GO TO 1250-CSL-CALC-LIFE-1.
  2690
  2691     IF CP-CSL-METH-2
  2692         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2693                          WS-MAX-TOT-BEN
  2694             GO TO 1250-CSL-CALC-LIFE-2
  2695         ELSE
  2696             GO TO 1250-CSL-CALC-LIFE-1.
  2697
  2698     IF CP-CSL-METH-3
  2699         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2700             GO TO 1250-CSL-CALC-LIFE-2
  2701         ELSE
  2702             GO TO 1250-CSL-CALC-LIFE-3.
  2703
  2704     IF CP-CSL-METH-4
  2705         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2706                          WS-MAX-TOT-BEN
  2707             GO TO 1250-CSL-CALC-LIFE-5
  2708         ELSE
  2709             GO TO 1250-CSL-CALC-LIFE-4.
  2710
  2711 1250-CSL-CALC-LIFE-1.
  2712     IF CP-JOINT-INDICATOR = 'J'
  2713         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2714     ELSE
  2715         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2716
  2717     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2718                    365) - 1) * 365 / 12.
  2719     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2720                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2721                    4380.
  2722     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2723                    WS-NUM-PAYMTS * WK-S.
  2724
  2725     GO TO 9999-CALC-RATE-PREM-X.
  2726
  2727 1250-CSL-CALC-LIFE-2.
  2728     IF CP-JOINT-INDICATOR = 'J'
  2729         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2730     ELSE
  2731         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2732
  2733     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  52
* ELRATE.cbl
  2734     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2735     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2736                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2737                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2738     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2739                    WK-S) + WK-D.
  2740
  2741     GO TO 9999-CALC-RATE-PREM-X.
  2742
  2743 1250-CSL-CALC-LIFE-3.
  2744     IF CP-JOINT-INDICATOR = 'J'
  2745         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2746     ELSE
  2747         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2748
  2749     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2750     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2751     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2752                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2753                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2754     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2755                    WK-S) + WK-D.
  2756
  2757     GO TO 9999-CALC-RATE-PREM-X.
  2758
  2759 1250-CSL-CALC-LIFE-4.
  2760     IF CP-JOINT-INDICATOR = 'J'
  2761         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2762     ELSE
  2763         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2764
  2765     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2766     COMPUTE WK-S ROUNDED =
  2767                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2768                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2769                    CP-PAY-FREQUENCY.
  2770     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2771                    WS-NUM-PAYMTS * WK-S.
  2772
  2773     GO TO 9999-CALC-RATE-PREM-X.
  2774
  2775 1250-CSL-CALC-LIFE-5.
  2776     IF CP-JOINT-INDICATOR = 'J'
  2777         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2778     ELSE
  2779         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2780
  2781     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2782     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2783                    CP-PAY-FREQUENCY.
  2784     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2785                    - 1) + WS-NUM-PAYMTS) * 12) /
  2786                    CP-PAY-FREQUENCY.
  2787     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2788     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2789                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2790
  2791     GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  53
* ELRATE.cbl
  2792
  2793 1250-CSL-CALC-LIFE-6.
  2794
  2795     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2796                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2797
  2798     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2799                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2800
  2801     GO TO 9999-CALC-RATE-PREM-X.
  2802
  2803******
  2804****** END OF PREMIUM CALCULATIONS FOR CSL
  2805******
  2806
  2807 1260-GTL-PA-LEASE.
  2808
  2809     IF CP-REDUCING-LIFE
  2810         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2811                                 TO  CP-PREMIUM-RATE
  2812         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2813                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2814     ELSE
  2815         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2816                                 TO  CP-PREMIUM-RATE
  2817         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2818                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2819                 (+1 + CP-SALES-TAX) / +100.
  2820
  2821     GO TO 9999-CALC-RATE-PREM-X.
  2822
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  54
* ELRATE.cbl
  2824******************************************************************
  2825 2000-TYPE-IS-AH.
  2826     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2827
  2828     MOVE ZERO                      TO CP-R-MAX-AGE
  2829                                       CP-R-MAX-TERM
  2830                                       CP-R-MAX-MON-BEN
  2831                                       CP-R-MAX-TOT-BEN.
  2832
  2833     IF RT-POLICY-FEE NUMERIC
  2834        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2835
  2836     IF RT-COMPOSITE-RATE NOT NUMERIC
  2837        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2838
  2839     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2840        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2841                                 TO CP-PREMIUM-RATE
  2842                                    WS-PREMIUM-RATE
  2843        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2844     ELSE
  2845         MOVE +0                 TO CP-PREMIUM-RATE
  2846                                    CP-CALC-PREMIUM
  2847         GO TO 9999-CALC-RATE-PREM-X
  2848     END-IF
  2849
  2850     IF (CP-COMPANY-ID = 'DCC')
  2851        AND (CP-DDF-SPEC-CALC = 'T')
  2852        AND (CP-LOAN-TERM > ZERO AND < 361)
  2853        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2854                                 TO CP-PREMIUM-RATE
  2855                                    WS-PREMIUM-RATE
  2856     END-IF
  2857*    IF (CP-COMPANY-ID = 'DCC')
  2858*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2859*       OR (CP-DDF-SPEC-CALC = 'T'))
  2860*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2861*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2862*                                TO CP-PREMIUM-RATE
  2863*                                   WS-PREMIUM-RATE
  2864*    END-IF
  2865     MOVE +1 TO AHNDX.
  2866
  2867     IF CP-COMPANY-ID EQUAL 'CRI'
  2868        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2869           MOVE +5               TO AHNDX
  2870           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2871              MOVE 'F'           TO CP-RETURN-CODE
  2872              GO TO 2200-CALCULATE-PREMIUMS.
  2873
  2874     IF RT-AH-AGE (AHNDX) = ZERO
  2875          GO TO 2200-CALCULATE-PREMIUMS.
  2876
  2877 2100-SEARCH-AH-LIMITS.
  2878
  2879     IF CP-COMPANY-ID EQUAL 'CRI'
  2880        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2881           IF AHNDX GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  55
* ELRATE.cbl
  2882              MOVE 'A'             TO CP-RETURN-CODE
  2883              GO TO 2200-CALCULATE-PREMIUMS.
  2884
  2885     IF AHNDX GREATER +8
  2886         MOVE 'A'                TO CP-RETURN-CODE
  2887         GO TO 2200-CALCULATE-PREMIUMS.
  2888
  2889     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2890         IF RT-AH-AGE (AHNDX) = ZEROS
  2891             ADD +1               TO AHNDX
  2892             GO TO 2100-SEARCH-AH-LIMITS
  2893         ELSE
  2894             MOVE RT-AH-AGE (AHNDX)
  2895                                 TO CP-R-MAX-AGE
  2896             MOVE RT-AH-TERM (AHNDX)
  2897                                 TO CP-R-MAX-TERM
  2898             MOVE RT-AH-BEN-M (AHNDX)
  2899                                 TO CP-R-MAX-MON-BEN
  2900             ADD +1               TO AHNDX
  2901             GO TO 2100-SEARCH-AH-LIMITS
  2902     ELSE
  2903         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2904         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2905         MOVE RT-AH-BEN-M (AHNDX)
  2906                                 TO CP-R-MAX-MON-BEN.
  2907
  2908     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2909         MOVE '9'                 TO CP-RETURN-CODE.
  2910
  2911     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2912         MOVE '8'                 TO CP-RETURN-CODE.
  2913
  2914     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2915         GIVING WS-AH-FACE-BENEFIT.
  2916
  2917     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2918         MOVE 'C'                 TO CP-RETURN-CODE.
  2919
  2920 2200-CALCULATE-PREMIUMS.
  2921
  2922     IF CP-COMPANY-ID = 'CSL'
  2923         GO TO 2250-CSL-CALC.
  2924
  2925*    IF CP-CRITICAL-PERIOD
  2926*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2927
  2928     IF CP-CRITICAL-PERIOD
  2929        IF (CP-COMPANY-ID = 'DCC')
  2930           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2931               OR 'S' OR 'P')
  2932                          OR
  2933                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2934           CONTINUE
  2935        ELSE
  2936           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  2937        END-IF
  2938     END-IF
  2939
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  56
* ELRATE.cbl
  2940     IF (CP-COMPANY-ID = 'DCC')
  2941        AND (CP-BEN-CATEGORY = 'D')
  2942        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2943           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2944     END-IF
  2945     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2946        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  2947        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2948                                     CP-PREMIUM-RATE
  2949        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2950        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2951        CP-PREMIUM-RATE) / +100
  2952     ELSE
  2953        IF (CP-COMPANY-ID = 'DCC')
  2954           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2955           MOVE CP-PREMIUM-RATE  TO WK-S
  2956*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2957           IF CP-RATE-DEV-PCT NOT = ZEROS
  2958              COMPUTE WK-S ROUNDED =
  2959                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2960           END-IF
  2961           IF CP-BENEFIT-CD (1:1) = 'M'
  2962              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2963              CP-ORIGINAL-BENEFIT * WK-S / 100
  2964           ELSE
  2965              IF CP-BENEFIT-CD (1:1) = 'H'
  2966                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2967                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2968                    WK-S) / 1000
  2969              ELSE
  2970                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2971                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2972                 ELSE
  2973                    IF CP-BEN-CATEGORY = 'D'
  2974                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2975                        CP-ORIGINAL-BENEFIT *
  2976                        CP-ORIGINAL-TERM * WK-S / 100
  2977                    ELSE
  2978                      IF CP-BENEFIT-CD (1:1) = 'P'
  2979                         GO TO 2300-CALC-DCC-BEN-P-AH
  2980                      ELSE
  2981                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2982                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2983                        WK-S) / 100
  2984                      END-IF
  2985                    END-IF
  2986                 END-IF
  2987              END-IF
  2988           END-IF
  2989           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2990        ELSE
  2991           IF CP-BENEFIT-CD (1:1) = 'M'
  2992              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2993                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  2994           ELSE
  2995              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2996                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2997                    (CP-NET-BENEFIT-AMT *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  57
* ELRATE.cbl
  2998                    CP-PREMIUM-RATE) / 1000
  2999              ELSE
  3000                 IF CP-AH-BALLOON-SW = 'Y'
  3001                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  3002                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3003                      CP-PREMIUM-RATE) / 100
  3004                 ELSE
  3005                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  3006                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3007                    CP-PREMIUM-RATE) / 100
  3008                 END-IF
  3009              END-IF
  3010           END-IF
  3011        END-IF
  3012     END-IF
  3013
  3014     IF (CP-COMPANY-ID = 'DCC')
  3015        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3016        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3017     END-IF
  3018     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3019         GO TO 9999-CALC-RATE-PREM-X.
  3020
  3021     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3022         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3023             CP-CALC-PREMIUM +
  3024                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3025                                       * CP-TERM-OR-EXT-DAYS).
  3026
  3027     GO TO 9999-CALC-RATE-PREM-X.
  3028
  3029 2200-CRITICAL-PERIOD-AH-CONT.
  3030
  3031     IF CP-COMPANY-ID = 'WDS'
  3032         IF CP-ORIGINAL-TERM GREATER THAN 60
  3033             MOVE 60              TO CP-LOAN-TERM.
  3034
  3035     IF CP-COMPANY-ID EQUAL 'CVL'
  3036         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3037           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3038                                       * CP-PREMIUM-RATE
  3039         GO TO 9999-CALC-RATE-PREM-X.
  3040
  3041     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3042           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3043                                       * CP-PREMIUM-RATE.
  3044
  3045     GO TO 9999-CALC-RATE-PREM-X.
  3046
  3047 2250-CSL-CALC.
  3048
  3049     IF RT-DAILY-RATE NOT NUMERIC OR
  3050        RT-DAILY-RATE = ZEROS
  3051            MOVE ZEROS TO CP-CALC-PREMIUM
  3052            MOVE '7' TO CP-RETURN-CODE
  3053            GO TO 9999-CALC-RATE-PREM-X.
  3054
  3055     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  58
* ELRATE.cbl
  3056     COMPUTE WK-MONTHLY-RATE =
  3057          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3058
  3059     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3060     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3061     MOVE '1' TO DC-OPTION-CODE.
  3062     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3063     IF DATE-CONVERSION-ERROR
  3064         MOVE '2' TO CP-RETURN-CODE
  3065         GO TO 9999-CALC-RATE-PREM-X.
  3066
  3067     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3068     IF CP-CSL-METH-1
  3069         GO TO 2250-CSL-CALC-AH-1.
  3070     IF CP-CSL-METH-2
  3071         GO TO 2250-CSL-CALC-AH-2.
  3072     IF CP-CSL-METH-3
  3073         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3074             GO TO 2250-CSL-CALC-AH-4
  3075         ELSE
  3076             GO TO 2250-CSL-CALC-AH-3.
  3077
  3078 2250-CSL-CALC-AH-1.
  3079
  3080     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3081     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3082                    + WK-MONTHLY-RATE.
  3083     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3084                    CP-ORIGINAL-TERM * WK-D.
  3085
  3086     GO TO 9999-CALC-RATE-PREM-X.
  3087
  3088
  3089 2250-CSL-CALC-AH-2.
  3090     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3091     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3092                    + WK-MONTHLY-RATE.
  3093     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3094                    CP-ORIGINAL-TERM * WK-D.
  3095
  3096     GO TO 9999-CALC-RATE-PREM-X.
  3097
  3098 2250-CSL-CALC-AH-3.
  3099
  3100     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3101     COMPUTE WK-T = WK-K + 1.
  3102     COMPUTE WK-MONTHLY-RATE-T =
  3103          RT-AH-RATE (WK-T) / 100.
  3104     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3105
  3106     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3107     IF WK-T1 EQUAL ZEROS
  3108         MOVE ZEROS TO CP-CALC-PREMIUM
  3109         MOVE 'G' TO CP-RETURN-CODE
  3110         GO TO 9999-CALC-RATE-PREM-X.
  3111
  3112     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3113                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  59
* ELRATE.cbl
  3114                    - WK-T)).
  3115     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3116     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3117                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3118                       WS-MAX-TOT-BEN).
  3119     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3120                    WK-MONTHLY-RATE-T) + WK-PREM.
  3121
  3122     GO TO 9999-CALC-RATE-PREM-X.
  3123
  3124 2250-CSL-CALC-AH-4.
  3125     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3126     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3127     COMPUTE WK-MONTHLY-RATE-J =
  3128          RT-AH-RATE (WK-J) / 100.
  3129     COMPUTE WK-T = WK-J + 1.
  3130     COMPUTE WK-MONTHLY-RATE-T =
  3131          RT-AH-RATE (WK-T) / 100.
  3132     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3133     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3134                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3135                    (CP-ORIGINAL-TERM - WK-T)).
  3136     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3137     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3138                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3139                       WS-MAX-TOT-BEN).
  3140     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3141                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3142
  3143     GO TO 9999-CALC-RATE-PREM-X.
  3144
  3145 2300-CALC-DCC-BEN-P-AH.
  3146     IF CP-NO-OF-PMTS NOT NUMERIC
  3147        MOVE +0                  TO CP-NO-OF-PMTS
  3148     END-IF
  3149     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3150        AND ' ' AND 'M'
  3151        MOVE ' '                 TO CP-PMT-MODE
  3152     END-IF
  3153******************************************************************
  3154***   Default is monthly, use loan term for rate and amort     ***
  3155******************************************************************
  3156     move cp-loan-term         to c-tot-pmts
  3157     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3158     MOVE +12                  TO C-PMTS-PER-YEAR
  3159******************************************************************
  3160
  3161     evaluate true
  3162        when cp-pmt-mode = 'W'
  3163           MOVE +52              TO C-PMTS-PER-YEAR
  3164           compute c-tot-pmts = cp-loan-term /
  3165              12 * c-pmts-per-year
  3166           MOVE +7               TO C-DAYS-IN-PMT-PER
  3167        when cp-pmt-mode = 'B'
  3168           MOVE +26              TO C-PMTS-PER-YEAR
  3169           compute c-tot-pmts = cp-loan-term /
  3170              12 * c-pmts-per-year
  3171           MOVE +14              TO C-DAYS-IN-PMT-PER
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  60
* ELRATE.cbl
  3172     end-evaluate
  3173     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3174     if i = zeros
  3175        move .0000000001         to i
  3176     end-if
  3177     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3178        C-DAYS-IN-PMT-PER)) / (1 + I)
  3179     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3180     COMPUTE ANGLEN-1 = ANGLEN / Y
  3181     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3182        / ANGLEN-1
  3183     if cp-net-benefit-amt = zeros
  3184        compute wk3 = cp-original-benefit - cp-original-premium
  3185     end-if
  3186     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3187     GO TO 9999-CALC-RATE-PREM-X
  3188     .
  3189 2300-CALC-DCC-MOB-NET-AH.
  3190     IF CP-ALTERNATE-BENEFIT = ZEROS
  3191        CONTINUE
  3192     ELSE
  3193        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3194     END-IF
  3195     MOVE CP-ORIGINAL-TERM       TO M
  3196     MOVE CP-LOAN-TERM           TO N
  3197     IF N = ZEROS
  3198        MOVE M                   TO N
  3199     END-IF
  3200     COMPUTE I = CP-LOAN-APR / +1200
  3201     if i = zeros
  3202        move .0000000001         to i
  3203     end-if
  3204     IF CP-BENEFIT-CD (1:1) = 'S'
  3205        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3206        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3207        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3208          (WK-S / 1000)
  3209          * 1
  3210        MOVE WK3                 TO CP-CALC-PREMIUM
  3211        GO TO 9999-CALC-RATE-PREM-X
  3212     END-IF
  3213     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3214        / (1 + I)
  3215     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3216          ** ((N - M) * -1))) / I)
  3217     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3218     COMPUTE J = I + (WK-S / +1000)
  3219     COMPUTE WK2 = (1 + J) ** (M * -1)
  3220     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3221     COMPUTE ANGLEM = ((1 - ((1 + J)
  3222          ** (M * -1))) / J) / OD
  3223     IF CP-NET-BENEFIT-AMT = ZEROS
  3224        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3225           * ANGLEM
  3226     END-IF
  3227     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3228     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3229          ** ((N - M) * -1))) / I)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  61
* ELRATE.cbl
  3230     MOVE +0                     TO WK3
  3231     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3232        (WS-COUNTER > M)
  3233        COMPUTE ANGLEM = (1 - ((1 + J)
  3234          ** ((M - WS-COUNTER + 1) * -1))) / J
  3235        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3236        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3237        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3238     END-PERFORM
  3239     MOVE WK3                    TO CP-CALC-PREMIUM
  3240     GO TO 9999-CALC-RATE-PREM-X
  3241     .
  3242 2300-CALC-DCC-MOB-BAL-AH.
  3243     IF CP-BENEFIT-CD (1:1) = 'S'
  3244        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3245     END-IF
  3246     MOVE CP-ORIGINAL-TERM       TO M
  3247     MOVE CP-LOAN-TERM           TO N
  3248     IF N = ZEROS
  3249        MOVE M                   TO N
  3250     END-IF
  3251     COMPUTE I = CP-LOAN-APR / +1200
  3252     if i = zeros
  3253        move .0000000001         to i
  3254     end-if
  3255     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3256        / (1 + I)
  3257     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3258     COMPUTE J = I + (WK-S / +1000)
  3259     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3260     MOVE I TO K
  3261     COMPUTE WK2 = (1 + J) ** (M * -1)
  3262     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3263     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3264          ** ((M - 1) * -1))) / J)
  3265     COMPUTE ANGLEM = ((1 - ((1 + J)
  3266          ** (M * -1))) / J) / OD
  3267     IF CP-NET-BENEFIT-AMT = ZEROS
  3268        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3269           * ANGLEM
  3270     END-IF
  3271     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3272        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3273        / ANGLEM-1
  3274     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3275          ** ((N - M) * -1))) / I)
  3276     MOVE +0                     TO WK3
  3277     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3278        (WS-COUNTER > M)
  3279        COMPUTE ANGLEM = (1 - ((1 + J)
  3280          ** ((M - WS-COUNTER) * -1))) / J
  3281        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3282        COMPUTE WK5-CSL = (RA * ANGLEM)
  3283        + (CP-ALTERNATE-BENEFIT * WK2)
  3284        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3285          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3286          (WK-S / 1000)
  3287     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  62
* ELRATE.cbl
  3288     MOVE WK3                    TO CP-CALC-PREMIUM
  3289     GO TO 9999-CALC-RATE-PREM-X
  3290     .
  3291 2300-CALC-DCC-MOB-BAL-AHSUM.
  3292     MOVE CP-ORIGINAL-TERM       TO M
  3293     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3294        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3295        * WK-S / 1000
  3296*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3297*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3298*       * WK-S / 1000
  3299     MOVE WK3                    TO CP-CALC-PREMIUM
  3300     GO TO 9999-CALC-RATE-PREM-X
  3301     .
  3302 9999-RATE-NOTFND.
  3303     MOVE '6'                    TO CP-RETURN-CODE.
  3304     GO TO 9999-CALC-RATE-PREM-X.
  3305
  3306 9999-RATE-NOTOPEN.
  3307     MOVE 'D'                    TO CP-RETURN-CODE.
  3308     GO TO 9999-CALC-RATE-PREM-X.
  3309
  3310 9999-CALC-RATE-PREM-X.
  3311     IF (CP-COMPANY-ID = 'DCC')
  3312        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3313        CONTINUE
  3314     ELSE
  3315        IF CP-RATE-DEV-PCT NOT = ZERO
  3316           COMPUTE CP-CALC-PREMIUM =
  3317              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3318
  3319
  3320     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3321
  3322     IF WS-BROWSE-STARTED
  3323
  3324* EXEC CICS ENDBR
  3325*            DATASET  (ERRATE-FILE-ID)
  3326*       END-EXEC.
  3327     MOVE 0
  3328       TO DFHEIV11
  3329*    MOVE '&2                    $   #00003276' TO DFHEIV0
  3330     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3331     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3332     MOVE X'2020233030303033323736' TO DFHEIV0(25:11)
  3333     CALL 'kxdfhei1' USING DFHEIV0,
  3334           ERRATE-FILE-ID,
  3335           DFHEIV11,
  3336           DFHEIV99
  3337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3338
  3339
  3340
  3341* EXEC CICS RETURN
  3342*    END-EXEC.
  3343*    MOVE '.(                    ''   #00003280' TO DFHEIV0
  3344     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3345     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  63
* ELRATE.cbl
  3346     MOVE X'2020233030303033323830' TO DFHEIV0(25:11)
  3347     CALL 'kxdfhei1' USING DFHEIV0,
  3348           DFHEIV99,
  3349           DFHEIV99,
  3350           DFHEIV99,
  3351           DFHEIV99,
  3352           DFHEIV99,
  3353           DFHEIV99
  3354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3355
  3356
  3357 9100-CONVERT-DATE.
  3358
  3359* EXEC CICS LINK
  3360*        PROGRAM  ('ELDATCV')
  3361*        COMMAREA (DATE-CONVERSION-DATA)
  3362*        LENGTH   (DC-COMM-LENGTH)
  3363*    END-EXEC.
  3364     MOVE 'ELDATCV' TO DFHEIV1
  3365*    MOVE '."C                   (   #00003284' TO DFHEIV0
  3366     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3367     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3368     MOVE X'2020233030303033323834' TO DFHEIV0(25:11)
  3369     CALL 'kxdfhei1' USING DFHEIV0,
  3370           DFHEIV1,
  3371           DATE-CONVERSION-DATA,
  3372           DC-COMM-LENGTH,
  3373           DFHEIV99,
  3374           DFHEIV99,
  3375           DFHEIV99,
  3376           DFHEIV99
  3377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3378
  3379
  3380 9100-EXIT.
  3381     EXIT.
  3382
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  64
* ELRATE.cbl
  3384 10000-NET-TERM SECTION.
  3385*                         COPY ERCNETP.
  3386*****************************************************************
  3387*                                                               *
  3388*                            ERCNETP                            *
  3389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3390*                            VMOD=2.029                         *
  3391*                                                               *
  3392*****************************************************************.
  3393*
  3394*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3395*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3396*                                   ORIGINAL TERM (S999)
  3397*                                   REMAINING TERM (S999)
  3398*                                   NET PAY OPTION (X)
  3399*                                   LOAN TERM (S999)
  3400*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3401*
  3402*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3403*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3404*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3405*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3406*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3407*    CHARGED.
  3408*
  3409*    OPTIONS - S = NET SIMPLE
  3410*          SPACE = NET PAY  (1 MO. INTEREST)
  3411*              A = NET PAY  (0 MO. INTEREST)
  3412*              I = NET PAY  (2 MO. INTEREST)
  3413*              J = NET PAY  (3 MO. INTEREST)
  3414*              K = NET PAY  (4 MO. INTEREST)
  3415*              T = TRUNCATED  (0 MO. INTEREST)
  3416*              U = TRUNCATED  (1 MO. INTEREST)
  3417*              V = TRUNCATED  (2 MO. INTEREST)
  3418*              W = TRUNCATED  (3 MO. INTEREST)
  3419*              X = TRUNCATED  (4 MO. INTEREST)
  3420*              R = REFUNDS (REGULAR OR TRUNCATED)
  3421******************************************************************
  3422*                   C H A N G E   L O G
  3423*
  3424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3425*-----------------------------------------------------------------
  3426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3427* EFFECTIVE    NUMBER
  3428*-----------------------------------------------------------------
  3429* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3430* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3431* 120403                   PEMA  ADD SPECIAL TX CALC
  3432* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3433* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3434* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3435* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3436* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3437* 021207                   PEMA  ADD PA NP
  3438* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3439* 032807                   PEMA  ADD VT NP PLUS 2
  3440* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3441* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  65
* ELRATE.cbl
  3442* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3443* 110207      TO 'AL' NET PAY CALC
  3444* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3445* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3446* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3447* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3448* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3449* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3450* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3451* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3452* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3453* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3454* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3455* 032612  CR2011110200001  PEMA  AHL CHANGES
  3456* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3457* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3458* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3459* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3460******************************************************************
  3461
  3462     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3463     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3464     MOVE N-P-LOAN    TO LOAN-TERM.
  3465     MOVE N-P-REM     TO REMAINING-TERM.
  3466     MOVE N-P-OPT     TO OPTION-SW.
  3467
  3468     MOVE +0 TO FACTOR.
  3469     if cp-company-id = 'CID'
  3470        if annual-int-rate = +99.9999
  3471           go to 99000-error
  3472        end-if
  3473     else
  3474        if annual-int-rate = zero
  3475           go to 99000-error
  3476        end-if
  3477     end-if
  3478     IF ORIGINAL-TERM = ZERO
  3479         GO TO 99999-RETURN.
  3480     IF REMAINING-TERM = ZERO
  3481         GO TO 99999-RETURN.
  3482     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3483         GO TO 99000-ERROR.
  3484     IF LOAN-TERM = ZERO
  3485         GO TO 99999-RETURN.
  3486     IF LOAN-TERM LESS ORIGINAL-TERM
  3487         GO TO 99000-ERROR.
  3488
  3489*    IF ANNUAL-INT-RATE LESS +2
  3490*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3491*    IF ANNUAL-INT-RATE LESS +2
  3492*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3493*    IF ANNUAL-INT-RATE LESS +2
  3494*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3495
  3496     IF NPO-REFUND
  3497         MOVE '2' TO NP-PROCESS-SW
  3498       ELSE
  3499         IF ORIGINAL-TERM = REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  66
* ELRATE.cbl
  3500            MOVE '1'   TO NP-PROCESS-SW
  3501           ELSE
  3502            MOVE '3'   TO NP-PROCESS-SW.
  3503
  3504     IF NPO-SIMPLE
  3505         MOVE 'S' TO TYPE-SW
  3506     ELSE
  3507         MOVE 'N' TO TYPE-SW.
  3508
  3509     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3510     if i = zeros
  3511        move .0000000001         to i
  3512     end-if
  3513
  3514     COMPUTE V ROUNDED = K1 / (K1 + I).
  3515
  3516     MOVE V     TO VX
  3517                   SV.
  3518
  3519     MOVE +1    TO X1
  3520                   SX.
  3521
  3522     MOVE LOAN-TERM TO MAX-X.
  3523
  3524     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3525
  3526     IF MAX-X = +1
  3527        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3528
  3529     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3530
  3531     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3532         OR 'DCC'        OR 'NCL') AND
  3533        (NOT NP-REFUND)
  3534        NEXT SENTENCE
  3535     ELSE
  3536     IF LOAN-TERM NOT = ORIGINAL-TERM
  3537        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3538
  3539     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3540
  3541 10500-VX-LOOP.
  3542
  3543***  VX = AMORT. LOAN TERM.
  3544***  SV = AMORT. INSURANCE TERM.
  3545***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3546***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3547***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3548
  3549     IF X2 = 1
  3550        MOVE V         TO SX
  3551     END-IF
  3552     COMPUTE VX ROUNDED = VX * V.
  3553
  3554     ADD B1 TO X1.
  3555
  3556     IF X1 = REMAINING-TERM
  3557          MOVE VX    TO SV.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  67
* ELRATE.cbl
  3558
  3559     IF X1 EQUAL SV-MINUS-ONE
  3560        MOVE VX      TO SV-MINUS-ONE.
  3561
  3562     IF X1 = X2
  3563          MOVE VX    TO SX.
  3564
  3565     IF X1 NOT = MAX-X
  3566          GO TO 10500-VX-LOOP.
  3567
  3568 10700-COMPUTE-REMAINING-FACTOR.
  3569*****  WK1 = LOAN TERM AMORT
  3570     COMPUTE WK1 = K1 - VX.
  3571*****  WK2 = INS TERM AMORT
  3572     COMPUTE WK2 = K1 - SV.
  3573*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3574     COMPUTE WK5 = K1 - SX.
  3575*****  WK6 = INS TERM - 1
  3576     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3577
  3578     IF NP-RATING
  3579         GO TO 12000-PREMIUM-RATE.
  3580
  3581     IF NP-REFUND
  3582         GO TO 11000-REFUND-CALC.
  3583
  3584     IF NET-STD
  3585         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3586
  3587     IF NET-SMP
  3588         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3589         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3590         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3591         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3592
  3593     IF REMAINING-TERM LESS THAN X2
  3594         MOVE +0 TO WK3.
  3595
  3596     MOVE WK3 TO FACTOR.
  3597
  3598     GO TO 99999-RETURN.
  3599
  3600 11000-REFUND-CALC.
  3601     IF REMAINING-TERM NOT LESS MAX-X
  3602        MOVE +1 TO FACTOR
  3603        GO TO 99999-RETURN.
  3604
  3605     IF REMAINING-TERM LESS +1
  3606        MOVE 0 TO FACTOR
  3607        GO TO 99999-RETURN.
  3608
  3609     COMPUTE WK2 ROUNDED = WK2 / I.
  3610     COMPUTE WK5 ROUNDED = WK5 / I.
  3611     COMPUTE WK1 ROUNDED = WK1 / I.
  3612
  3613     IF (CP-COMPANY-ID EQUAL 'CID')
  3614        AND (CP-STATE-STD-ABBRV = 'MN')
  3615        AND (CP-CERT-EFF-DT > X'A4FF')
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  68
* ELRATE.cbl
  3616        AND (CP-RATE-AS-REG-BALLOON)
  3617        AND (CP-EARN-AS-NET-PAY)
  3618        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3619        CONTINUE
  3620     ELSE
  3621        GO TO 11000-CHECK-MN-LEV-BALLOON
  3622     END-IF
  3623
  3624     COMPUTE R = M - E
  3625     COMPUTE FACTOR = (R - WK2 + WK5) /
  3626        (M - WK1 + WK5)
  3627
  3628     GO TO 99999-RETURN
  3629
  3630      .
  3631 11000-CHECK-MN-LEV-BALLOON.
  3632
  3633     IF (CP-COMPANY-ID EQUAL 'CID')
  3634        AND (CP-STATE-STD-ABBRV = 'MN')
  3635        AND (CP-CERT-EFF-DT > X'A4FF')
  3636        AND (CP-RATE-AS-REG-BALLOON)
  3637        AND (CP-EARN-AS-NET-PAY)
  3638        AND (CP-DEVIATION-CODE = 'LEV')
  3639        CONTINUE
  3640     ELSE
  3641        GO TO 11000-CONTINUE-REFUND
  3642     END-IF
  3643
  3644     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3645     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3646        ** (M - E)) / I
  3647
  3648     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3649
  3650     GO TO 99999-RETURN
  3651
  3652     .
  3653 11000-CONTINUE-REFUND.
  3654*    IF CP-GAP-ACTUARIAL
  3655*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3656*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3657*       COMPUTE WK3 = WK2 / ANGLEN
  3658*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3659     IF CP-GAP-ACTUARIAL
  3660        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3661           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3662        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3663     ELSE
  3664        COMPUTE WK3 ROUNDED =
  3665          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3666     END-IF
  3667
  3668     MOVE WK3  TO FACTOR.
  3669
  3670     GO TO 99999-RETURN.
  3671
  3672 12000-PREMIUM-RATE.
  3673*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  69
* ELRATE.cbl
  3674*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3675*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3676*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3677*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3678*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3679
  3680     COMPUTE K-I = K1 + I.
  3681     MOVE K-I TO ONE-PLUS-I.
  3682
  3683     IF NPO-ALT OR NPO-TRUNC-0
  3684         MOVE K1 TO K-I.
  3685
  3686     IF NPO-2MO OR NPO-TRUNC-2
  3687         COMPUTE K-I = K1 + (2 * I).
  3688
  3689     IF NPO-3MO OR NPO-TRUNC-3
  3690         COMPUTE K-I = K1 + (3 * I).
  3691
  3692     IF NPO-4MO OR NPO-TRUNC-4
  3693         COMPUTE K-I = K1 + (4 * I).
  3694
  3695     COMPUTE RA ROUNDED = 1 -
  3696             ((X2 * (X2 + 1)) /
  3697              (N *  (N  + 1))).
  3698
  3699     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3700        (CP-CSL-VALID-NP-BENEFIT-CD)
  3701        NEXT SENTENCE
  3702     ELSE
  3703        GO TO XXXX-CHECK-DISCOUNT-5.
  3704
  3705     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3706     MOVE ' ' TO DC-OPTION-CODE.
  3707     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3708
  3709     IF DATE-CONVERSION-ERROR
  3710        MOVE '2'                 TO CP-RETURN-CODE
  3711        MOVE ZEROS               TO FACTOR
  3712                                    CP-CALC-PREMIUM
  3713         GO TO 99999-RETURN.
  3714
  3715     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3716     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3717     MOVE ' ' TO DC-OPTION-CODE
  3718     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3719
  3720     IF DATE-CONVERSION-ERROR
  3721        MOVE '2'                 TO CP-RETURN-CODE
  3722        MOVE ZEROS               TO FACTOR
  3723                                    CP-CALC-PREMIUM
  3724         GO TO 99999-RETURN.
  3725
  3726     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3727
  3728     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3729
  3730     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3731        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  70
* ELRATE.cbl
  3732        CP-PAY-FREQUENCY / 365) * I
  3733     ELSE
  3734        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3735        CP-PAY-FREQUENCY / 365) * I.
  3736
  3737     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3738     13).
  3739
  3740     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3741     (N - ( ANGLEN-1 / WK3)).
  3742
  3743     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3744
  3745     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3746       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3747
  3748     COMPUTE WS-Y-X-FACTOR EQUAL
  3749       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3750       WS-CALC-FREQ-RATE).
  3751
  3752     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3753       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3754
  3755     COMPUTE WS-X-Y-FACTOR EQUAL
  3756       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3757
  3758     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3759       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3760       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3761
  3762     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3763
  3764     GO TO 99999-RETURN.
  3765
  3766 XXXX-CHECK-DISCOUNT-5.
  3767
  3768     IF WS-DISCOUNT-OPTION EQUAL '5'
  3769        NEXT SENTENCE
  3770     ELSE
  3771        GO TO 12000-CHECK-CLIENT.
  3772
  3773      COMPUTE ANGLEN EQUAL WK1 / I.
  3774
  3775      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3776
  3777      COMPUTE WK3 EQUAL
  3778        (12 *
  3779        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3780        CP-ORIGINAL-BENEFIT)) /
  3781        APR100.
  3782
  3783     COMPUTE WK3 EQUAL
  3784        (WK3 * CP-PREMIUM-RATE) / +1000.
  3785
  3786     COMPUTE WK3 EQUAL
  3787        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3788
  3789      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  71
* ELRATE.cbl
  3790
  3791     GO TO 99999-RETURN.
  3792
  3793 12000-CHECK-CLIENT.
  3794
  3795     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3796        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3797        (CP-TRUNCATED-LIFE)
  3798        NEXT SENTENCE
  3799     ELSE
  3800        GO TO 12000-CHECK-NEXT.
  3801
  3802     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3803
  3804     COMPUTE ANGLEN EQUAL WK1 / I.
  3805     COMPUTE ANGLEM EQUAL WK2 / I.
  3806
  3807     COMPUTE FM EQUAL
  3808                    (((ONE-PLUS-I ** M) * I * M) /
  3809                    ((ONE-PLUS-I ** M) - 1))
  3810                    - 1.
  3811
  3812     COMPUTE FN EQUAL
  3813                    (((ONE-PLUS-I ** N) * I * N) /
  3814                    ((ONE-PLUS-I ** N) - 1))
  3815                    - 1.
  3816
  3817     COMPUTE FNM EQUAL
  3818                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3819                    ((ONE-PLUS-I ** (N - M)) - 1))
  3820                    - 1.
  3821
  3822     COMPUTE GR EQUAL
  3823                    (WS-WORK-RATE * ANGLEM * I) /
  3824                    (M - ANGLEM).
  3825
  3826     COMPUTE ODF EQUAL
  3827                     (1 +
  3828                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3829                     360)) /
  3830                     ONE-PLUS-I.
  3831
  3832     COMPUTE OD EQUAL
  3833                    (1 + (ODF * (FN / I - 1))) +
  3834                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3835
  3836     COMPUTE WK3 EQUAL
  3837*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3838                    ((1 + FN) * ODF *
  3839                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3840                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3841                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3842
  3843     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3844     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3845
  3846     COMPUTE WK3 EQUAL
  3847                    (WK3 / (ODF * (1 + FN))) -
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  72
* ELRATE.cbl
  3848*                   CP-ORIGINAL-BENEFIT.
  3849                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3850
  3851      MOVE WK3 TO CP-CALC-PREMIUM.
  3852
  3853     GO TO 99999-RETURN.
  3854
  3855 12000-CHECK-NEXT.
  3856
  3857     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3858        NEXT SENTENCE
  3859     ELSE
  3860        GO TO 12000-CHECK-PA-TRUNC.
  3861
  3862      IF WS-WORK-DIS-RATE EQUAL +0
  3863         MOVE '7'                TO CP-RETURN-CODE
  3864         MOVE ZEROS              TO FACTOR
  3865                                    CP-CALC-PREMIUM
  3866         GO TO 99999-RETURN.
  3867
  3868      COMPUTE ANGLEN EQUAL WK1 / I.
  3869
  3870      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3871
  3872      IF WS-WORK-DIS-RATE EQUAL APR100
  3873         ADD .00001 TO APR100.
  3874
  3875      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3876      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3877
  3878     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3879        / (1 + I)
  3880     COMPUTE ANGLEN-1 = ANGLEN / Y
  3881      IF CP-COMPANY-ID EQUAL 'CDL'
  3882         COMPUTE WK3 EQUAL
  3883
  3884          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3885          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3886
  3887          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3888
  3889          ((WK8 ** N) /
  3890          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3891
  3892          ((WK9 ** N) /
  3893          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3894
  3895      ELSE
  3896         COMPUTE WK3 EQUAL
  3897
  3898          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3899          (12 + WS-WORK-DIS-RATE) * 12) *
  3900
  3901          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3902
  3903          ((WK8 ** N) /
  3904          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3905
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  73
* ELRATE.cbl
  3906          ((WK9 ** N) /
  3907          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3908
  3909      COMPUTE WK3 EQUAL
  3910          (WK3 * CP-PREMIUM-RATE) / +1000.
  3911
  3912      MOVE WK3 TO CP-CALC-PREMIUM.
  3913
  3914     GO TO 99999-RETURN.
  3915
  3916 12000-CHECK-PA-TRUNC.
  3917
  3918     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3919        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  3920        (CP-EARN-AS-NET-PAY) AND
  3921        (CP-TRUNCATED-LIFE)
  3922        NEXT SENTENCE
  3923     ELSE
  3924        GO TO 12000-CHECK-MD-TRUNC.
  3925
  3926     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3927
  3928     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3929     COMPUTE ANGLEN EQUAL WK1 / I.
  3930
  3931     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3932
  3933     COMPUTE WK3 EQUAL
  3934        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3935        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3936
  3937     MOVE WK3 TO CP-CALC-PREMIUM.
  3938
  3939     GO TO 99999-RETURN.
  3940
  3941 12000-CHECK-MD-TRUNC.
  3942
  3943     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3944        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3945        (CP-EARN-AS-NET-PAY) AND
  3946        (CP-TRUNCATED-LIFE)
  3947        NEXT SENTENCE
  3948     ELSE
  3949        GO TO 12000-CHECK-MD.
  3950
  3951     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3952
  3953     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3954     COMPUTE ANGLEM EQUAL WK2 / I.
  3955     COMPUTE ANGLEN EQUAL WK1 / I.
  3956
  3957     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3958
  3959     COMPUTE WK3 EQUAL
  3960        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3961        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3962        (ANGLEN-1 * (M - ANGLEM))).
  3963
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  74
* ELRATE.cbl
  3964     MOVE WK3 TO CP-CALC-PREMIUM.
  3965
  3966     GO TO 99999-RETURN.
  3967
  3968 12000-CHECK-MD.
  3969
  3970     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3971        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3972        (CP-EARN-AS-NET-PAY)
  3973        NEXT SENTENCE
  3974     ELSE
  3975        GO TO 12000-CHECK-ME-TRUNC.
  3976
  3977     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3978
  3979     COMPUTE WK3 EQUAL
  3980        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3981
  3982     MOVE WK3 TO CP-CALC-PREMIUM.
  3983
  3984     GO TO 99999-RETURN.
  3985
  3986 12000-CHECK-ME-TRUNC.
  3987
  3988     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3989        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3990        AND (CP-EARN-AS-NET-PAY)
  3991        AND (CP-TRUNCATED-LIFE)
  3992        CONTINUE
  3993     ELSE
  3994        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3995     END-IF
  3996
  3997     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3998     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3999     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4000     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4001     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4002     COMPUTE ANGLEN-1 = ANGLEN / Y
  4003     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4004     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4005     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4006     COMPUTE WK3
  4007        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4008        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4009            * (1 / (1.0635 ** (M / 12))))
  4010*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  4011*    COMPUTE WK9 EQUAL
  4012*       1 / (1 + (.045 * (N - M) / 24))
  4013*    COMPUTE WK7 EQUAL
  4014*       WS-WORK-RATE * 20 / (M + 1).
  4015*    COMPUTE WK3 EQUAL
  4016*       ((( N - ANGLEN) * WK7 * WK8) /
  4017*       (10 * ANGLEN-1 * I)) -
  4018*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  4019*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  4020*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4021*
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  75
* ELRATE.cbl
  4022     MOVE WK3 TO CP-CALC-PREMIUM.
  4023
  4024     GO TO 99999-RETURN
  4025      .
  4026 12000-CHECK-CID-WA-FARMPLAN.
  4027
  4028     IF (CP-COMPANY-ID EQUAL 'CID')
  4029        AND (CP-STATE-STD-ABBRV = 'WA')
  4030        AND (CP-FARM-PLAN)
  4031        CONTINUE
  4032     ELSE
  4033        GO TO 12000-CHECK-CID-FARMPLAN
  4034     END-IF
  4035
  4036     move cp-original-term       to n
  4037     move cp-no-of-pmts          TO C-TOT-PMTS
  4038     compute c-pmts-per-year = 12 / cp-pay-frequency
  4039     move cp-pay-frequency       to m
  4040     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4041     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4042     if i = zeros
  4043        move .0000000001         to i
  4044     end-if
  4045     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4046
  4047     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4048        (m * 30))) / (1 + I)
  4049     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4050        ** CP-PAY-FREQUENCY) - 1
  4051     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4052     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4053        ** TI) / WS-WORK-DIS-RATE
  4054     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4055     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4056     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4057        ** m) / WS-WORK-DIS-RATE
  4058     COMPUTE WK2 = WK2 * (1 + J)
  4059     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4060     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4061     COMPUTE WK3 = WK3 * (1 + J)
  4062     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4063        ** (c-tot-pmts - 1))) / J
  4064     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4065        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4066        (CP-PREMIUM-RATE / 1000)
  4067     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4068     COMPUTE WK6 = (WK7 * GR)
  4069
  4070     MOVE WK6 TO CP-CALC-PREMIUM
  4071
  4072     GO TO 99999-RETURN
  4073
  4074     .
  4075 12000-CHECK-CID-FARMPLAN.
  4076     IF (CP-COMPANY-ID EQUAL 'CID')
  4077        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4078           OR 'IN' OR 'AZ')
  4079        AND (CP-FARM-PLAN)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  76
* ELRATE.cbl
  4080        CONTINUE
  4081     ELSE
  4082        GO TO 12000-CHECK-SC-CID
  4083     END-IF
  4084     COMPUTE N = M / CP-PAY-FREQUENCY
  4085     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4086     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4087        ** CP-PAY-FREQUENCY) - 1
  4088     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4089     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4090        ** TI) / WS-WORK-DIS-RATE
  4091     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4092     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4093     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4094        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4095     COMPUTE WK2 = WK2 * (1 + J)
  4096     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4097     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4098     COMPUTE WK3 = WK3 * (1 + J)
  4099     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4100        ** (N - 1))) / J
  4101     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4102        ((N * WK2) - WK5)) + (N * WK1)) *
  4103        (CP-PREMIUM-RATE / 1000)
  4104     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4105     COMPUTE WK6 = (WK7 * GR)
  4106     MOVE WK6 TO CP-CALC-PREMIUM
  4107     GO TO 99999-RETURN
  4108     .
  4109 12000-CHECK-SC-CID.
  4110     IF (CP-COMPANY-ID = 'CID')
  4111        AND (CP-STATE-STD-ABBRV = 'SC')
  4112        AND (CP-EARN-AS-NET-PAY)
  4113        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4114        move 6                   to ws-extra-pmts
  4115     ELSE
  4116        GO TO 12000-CHECK-AL-CID
  4117     END-IF
  4118     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4119     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4120     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4121        / 12)) / ((M + 1) / 2)
  4122
  4123     if i = .0000000001
  4124        compute wk4 = cp-original-benefit / n
  4125        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4126            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4127        display ' hit sc wo apr - wk2 ' wk2
  4128     else
  4129        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4130        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4131        COMPUTE ANGLEN-1 = ANGLEN / Y
  4132        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4133        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4134           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4135     end-if
  4136*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4137*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  77
* ELRATE.cbl
  4138*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4139*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4140*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4141*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4142*       / 12)) / ((M + 1) / 2)
  4143*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4144*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4145*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4146     MOVE WK3 TO CP-CALC-PREMIUM
  4147     GO TO 99999-RETURN
  4148     .
  4149 12000-CHECK-AL-CID.
  4150     IF (CP-COMPANY-ID EQUAL 'CID')
  4151        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4152        AND (CP-EARN-AS-NET-PAY)
  4153        CONTINUE
  4154     ELSE
  4155        GO TO 12000-CHECK-NH-CID
  4156     END-IF
  4157     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4158     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4159     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4160     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4161                   / (1 + I)
  4162     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4163     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4164     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4165        (CP-PREMIUM-RATE / 1000)
  4166     MOVE WK3 TO CP-CALC-PREMIUM
  4167     GO TO 99999-RETURN
  4168     .
  4169 12000-CHECK-NH-CID.
  4170     IF (CP-COMPANY-ID EQUAL 'CID')
  4171        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4172        AND (CP-EARN-AS-NET-PAY)
  4173        CONTINUE
  4174     ELSE
  4175        GO TO 12000-CHECK-PA-CID
  4176     END-IF
  4177     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4178     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4179     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4180                   / (1 + I)
  4181     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4182     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4183     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4184        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4185     MOVE WK3 TO CP-CALC-PREMIUM
  4186     GO TO 99999-RETURN
  4187     .
  4188 12000-CHECK-PA-CID.
  4189     IF (CP-COMPANY-ID EQUAL 'CID')
  4190        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4191        AND (CP-EARN-AS-NET-PAY)
  4192        CONTINUE
  4193     ELSE
  4194        GO TO 12000-CHECK-ME-CID
  4195     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  78
* ELRATE.cbl
  4196
  4197     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4198     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4199     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4200     COMPUTE ANGLEN-1 = ANGLEN / Y
  4201     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4202     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4203     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4204     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4205        * WK5
  4206     MOVE WK3 TO CP-CALC-PREMIUM
  4207     GO TO 99999-RETURN
  4208     .
  4209 12000-CHECK-ME-CID.
  4210     IF (CP-COMPANY-ID EQUAL 'CID')
  4211        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4212        AND (CP-EARN-AS-NET-PAY)
  4213        CONTINUE
  4214     ELSE
  4215        GO TO 12000-CHECK-VT-TRUNC
  4216     END-IF
  4217     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4218     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4219     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4220     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4221     COMPUTE ANGLEN-1 = ANGLEN / Y
  4222     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4223     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4224     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4225        * WK5
  4226     MOVE WK3 TO CP-CALC-PREMIUM
  4227     GO TO 99999-RETURN
  4228     .
  4229 12000-CHECK-VT-TRUNC.
  4230
  4231     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4232        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4233        (CP-EARN-AS-NET-PAY) AND
  4234        (CP-TRUNCATED-LIFE)
  4235        NEXT SENTENCE
  4236     ELSE
  4237        GO TO 12000-CHECK-VT.
  4238
  4239      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4240
  4241      COMPUTE ANGLEN EQUAL WK1 / I.
  4242
  4243      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4244
  4245      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4246      COMPUTE WK9 EQUAL
  4247        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4248        ((.0054 - I) / (1 + I)).
  4249      COMPUTE WK7 EQUAL
  4250        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4251      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4252        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4253
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  79
* ELRATE.cbl
  4254      MOVE WK3 TO CP-CALC-PREMIUM.
  4255
  4256     GO TO 99999-RETURN.
  4257
  4258 12000-CHECK-VT.
  4259
  4260     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4261        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4262        (CP-EARN-AS-NET-PAY)
  4263        NEXT SENTENCE
  4264     ELSE
  4265        GO TO 12000-CHECK-MINN-WDS.
  4266
  4267      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4268
  4269      COMPUTE ANGLEN EQUAL WK1 / I.
  4270
  4271      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4272
  4273      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4274                        (ANGLEN-1 * I)) *
  4275
  4276                        (((1.0054 ** N - 1) /
  4277                        (1.0054 ** (N - 1) * .0054)) -
  4278
  4279                        ((V * (1 - 1.0054 ** N * VX)) /
  4280                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4281
  4282      MOVE WK3 TO CP-CALC-PREMIUM.
  4283
  4284     GO TO 99999-RETURN.
  4285
  4286 12000-CHECK-MINN-WDS.
  4287
  4288     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4289        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4290        (CP-EARN-AS-NET-PAY)
  4291        NEXT SENTENCE
  4292     ELSE
  4293        GO TO 12000-CHECK-MINN-BALL-LEV.
  4294
  4295     COMPUTE ANGLEN EQUAL WK1 / I.
  4296     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4297              (N / +12) * (2 / (N + 1)).
  4298     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4299         WK3 * ((N - ANGLEN) / I).
  4300
  4301      MOVE WK3 TO CP-CALC-PREMIUM.
  4302
  4303     GO TO 99999-RETURN.
  4304
  4305 12000-CHECK-MINN-BALL-LEV.
  4306
  4307     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4308        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4309        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4310        (CP-EARN-AS-REG-BALLOON)
  4311        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  80
* ELRATE.cbl
  4312     ELSE
  4313        GO TO 12000-CHECK-MINN-BALL.
  4314
  4315     COMPUTE ANGLEN EQUAL WK1 / I.
  4316
  4317     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4318
  4319     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4320        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4321
  4322     MOVE WK3 TO CP-CALC-PREMIUM.
  4323
  4324     GO TO 99999-RETURN.
  4325
  4326 12000-CHECK-MINN-BALL.
  4327
  4328     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4329        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4330        (CP-EARN-AS-REG-BALLOON)
  4331        NEXT SENTENCE
  4332     ELSE
  4333        GO TO 12000-CHECK-CID-MN-BALL.
  4334
  4335     COMPUTE ANGLEN EQUAL WK1 / I.
  4336     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4337
  4338     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4339     / +100 * (N - 1) / 12 * 2 / N *
  4340     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4341
  4342      MOVE WK3 TO CP-CALC-PREMIUM.
  4343
  4344     GO TO 99999-RETURN.
  4345
  4346 12000-CHECK-CID-MN-BALL.
  4347     IF (CP-COMPANY-ID EQUAL 'CID')
  4348        AND (CP-STATE-STD-ABBRV = 'MN')
  4349        AND (CP-CERT-EFF-DT > X'A4FF')
  4350        AND (CP-EARN-AS-REG-BALLOON)
  4351        CONTINUE
  4352     ELSE
  4353        GO TO 12000-CHECK-CID-MN-FARM
  4354     END-IF
  4355     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4356     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4357     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4358     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4359     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4360     COMPUTE V = 1 / (1 + I)
  4361     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4362     COMPUTE Y = (1 + (D * I) / +30)
  4363        / (1 + I)
  4364     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4365        * CP-PREMIUM-RATE / 1000
  4366*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4367*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4368*    ELSE
  4369*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  81
* ELRATE.cbl
  4370*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4371*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4372*       DISPLAY ' BALLOON TOP ' WK6
  4373*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4374*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4375*          / 100
  4376*       DISPLAY ' BALLOON BOTTOM ' WK7
  4377*       COMPUTE GR = WK6 / WK7
  4378*       DISPLAY ' BALLOON PAYMENT ' GR
  4379*    END-IF
  4380     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4381     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4382        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4383     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4384     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4385        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4386           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4387           * CP-PREMIUM-RATE / 1000
  4388     MOVE WK3                    TO CP-CALC-PREMIUM
  4389     GO TO 99999-RETURN.
  4390     .
  4391 12000-CHECK-CID-MN-FARM.
  4392
  4393     IF (CP-COMPANY-ID EQUAL 'CID')
  4394        AND (CP-STATE-STD-ABBRV = 'MN')
  4395        AND (CP-CERT-EFF-DT > X'A4FF')
  4396        AND (CP-EARN-AS-FARM-PLAN)
  4397        CONTINUE
  4398     ELSE
  4399        GO TO 12000-CHECK-NC-WDS
  4400     END-IF
  4401
  4402     EVALUATE CP-PMT-MODE
  4403        WHEN 'B'
  4404           MOVE +14              TO C-DAYS-IN-PMT-PER
  4405           MOVE +26              TO C-PMTS-PER-YEAR
  4406           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4407        WHEN 'S'
  4408           MOVE +15              TO C-DAYS-IN-PMT-PER
  4409           MOVE +24              TO C-PMTS-PER-YEAR
  4410           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4411        WHEN 'T'
  4412           MOVE +360             TO C-DAYS-IN-PMT-PER
  4413           MOVE +1               TO C-PMTS-PER-YEAR
  4414           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4415        WHEN 'W'
  4416           MOVE +7               TO C-DAYS-IN-PMT-PER
  4417           MOVE +52              TO C-PMTS-PER-YEAR
  4418           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4419        WHEN 'B'
  4420           MOVE +14              TO C-DAYS-IN-PMT-PER
  4421           MOVE +26              TO C-PMTS-PER-YEAR
  4422           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4423        WHEN OTHER
  4424           move cp-no-of-pmts    to c-tot-pmts
  4425           if cp-pay-frequency > zeros
  4426              compute c-pmts-per-year =
  4427                 12 / cp-pay-frequency
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  82
* ELRATE.cbl
  4428              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4429           else
  4430              MOVE +30           TO C-DAYS-IN-PMT-PER
  4431              MOVE +12           TO C-PMTS-PER-YEAR
  4432              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4433           end-if
  4434     END-EVALUATE
  4435
  4436     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4437     if i = zeros
  4438        move .0000000001         to i
  4439     end-if
  4440
  4441     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4442        C-DAYS-IN-PMT-PER)) / (1 + I)
  4443
  4444     compute cp-premium-rate =
  4445        cp-premium-rate * 12 / c-pmts-per-year / 10
  4446     move c-tot-pmts to n m
  4447     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4448     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4449     COMPUTE ANGLEN-1 = ANGLEN / Y
  4450     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4451
  4452     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4453        (cp-premium-rate / 100)
  4454
  4455
  4456     MOVE WK3                    TO CP-CALC-PREMIUM
  4457
  4458     GO TO 99999-RETURN.
  4459
  4460     .
  4461 12000-CHECK-NC-WDS.
  4462
  4463     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4464        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4465        (CP-EARN-AS-NET-PAY)
  4466        NEXT SENTENCE
  4467     ELSE
  4468        GO TO 12000-CHECK-NC-BALL-LEV.
  4469
  4470     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4471     COMPUTE ANGLEN EQUAL WK1 / I.
  4472     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4473              CP-PREMIUM-RATE / +100 *
  4474              N / +12 * 2 / (N + 1) *
  4475              (WK4 - ANGLEN) / (I * ANGLEN).
  4476
  4477      MOVE WK3 TO CP-CALC-PREMIUM.
  4478
  4479     GO TO 99999-RETURN.
  4480
  4481 12000-CHECK-NC-BALL-LEV.
  4482
  4483     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4484        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4485        (CP-DEVIATION-CODE EQUAL 'LEV') AND
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  83
* ELRATE.cbl
  4486        (CP-EARN-AS-REG-BALLOON)
  4487        NEXT SENTENCE
  4488     ELSE
  4489        GO TO 12000-CHECK-NC-BALL.
  4490
  4491     COMPUTE ANGLEN EQUAL WK1 / I.
  4492
  4493**** VX = 1 / (1 + I)**N.
  4494
  4495     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4496        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4497
  4498     MOVE WK3 TO CP-CALC-PREMIUM.
  4499
  4500     GO TO 99999-RETURN.
  4501
  4502 12000-CHECK-NC-BALL.
  4503
  4504     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4505        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4506        (CP-EARN-AS-REG-BALLOON)
  4507        NEXT SENTENCE
  4508     ELSE
  4509        GO TO 12000-CHECK-MINN-TRUNC.
  4510
  4511     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4512     COMPUTE ANGLEN EQUAL WK1 / I.
  4513     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4514**** VX = 1 / (1 + I)**N.
  4515
  4516     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4517     / +100 * (N - 1) / 12 * 2 / N *
  4518     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4519
  4520      MOVE WK3 TO CP-CALC-PREMIUM.
  4521
  4522     GO TO 99999-RETURN.
  4523
  4524 12000-CHECK-MINN-TRUNC.
  4525
  4526     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4527        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4528        (M GREATER THAN +63) AND
  4529        (CP-EARN-AS-NET-PAY) AND
  4530        (CP-TRUNCATED-LIFE)
  4531        NEXT SENTENCE
  4532     ELSE
  4533        GO TO 12000-CHECK-MINN.
  4534
  4535      COMPUTE ANGLEN EQUAL WK1 / I.
  4536      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4537
  4538      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4539
  4540      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4541       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4542       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4543
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  84
* ELRATE.cbl
  4544      MOVE WK3 TO CP-CALC-PREMIUM.
  4545
  4546     GO TO 99999-RETURN.
  4547
  4548 12000-CHECK-MINN.
  4549
  4550     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4551        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4552        (M GREATER THAN +63) AND
  4553        (CP-EARN-AS-NET-PAY)
  4554        NEXT SENTENCE
  4555     ELSE
  4556        GO TO 12000-CHECK-MONTANA-TRUNC.
  4557
  4558      COMPUTE ANGLEN EQUAL WK1 / I.
  4559
  4560      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4561
  4562      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4563       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4564       (((N - ANGLEN) / I) + (2 * N)).
  4565
  4566      MOVE WK3 TO CP-CALC-PREMIUM.
  4567
  4568     GO TO 99999-RETURN.
  4569
  4570 12000-CHECK-MONTANA-TRUNC.
  4571
  4572     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4573        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4574        (M GREATER THAN +63) AND
  4575        (CP-EARN-AS-NET-PAY) AND
  4576        (CP-TRUNCATED-LIFE)
  4577        NEXT SENTENCE
  4578     ELSE
  4579        GO TO 12000-CHECK-MONTANA.
  4580
  4581      COMPUTE ANGLEN EQUAL WK1 / I.
  4582      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4583
  4584      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4585
  4586      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4587      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4588       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4589
  4590      MOVE WK3 TO CP-CALC-PREMIUM.
  4591
  4592     GO TO 99999-RETURN.
  4593
  4594 12000-CHECK-MONTANA.
  4595
  4596     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4597        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4598        (M GREATER THAN +63) AND
  4599        (CP-EARN-AS-NET-PAY)
  4600        NEXT SENTENCE
  4601     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  85
* ELRATE.cbl
  4602        GO TO 12001-CONTINUE-NCL-TRUNC.
  4603
  4604      COMPUTE ANGLEN EQUAL WK1 / I.
  4605
  4606      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4607
  4608      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4609       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4610       (((N - ANGLEN) / I) + (4 * N)).
  4611
  4612      MOVE WK3 TO CP-CALC-PREMIUM.
  4613
  4614     GO TO 99999-RETURN.
  4615
  4616 12001-CONTINUE-NCL-TRUNC.
  4617
  4618     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4619        (CP-EARN-AS-NET-PAY) AND
  4620        (CP-TRUNCATED-LIFE)
  4621        NEXT SENTENCE
  4622     ELSE
  4623        GO TO 12001-CONTINUE-NCL.
  4624
  4625      COMPUTE ANGLEN EQUAL WK1 / I.
  4626      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4627
  4628      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4629
  4630      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4631      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4632      (ANGLEN-1 * (N + 1) * I).
  4633
  4634      MOVE WK3 TO CP-CALC-PREMIUM.
  4635
  4636     GO TO 99999-RETURN.
  4637
  4638 12001-CONTINUE-NCL.
  4639
  4640     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4641        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4642        (CP-EARN-AS-NET-PAY)
  4643        GO TO 12001-CHECK-NC-NET-PLUS3.
  4644
  4645     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4646        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4647        (CP-EARN-AS-NET-PAY)
  4648        GO TO 12001-CHECK-CA.
  4649
  4650     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4651        (CP-EARN-AS-NET-PAY)
  4652        NEXT SENTENCE
  4653     ELSE
  4654        GO TO 12000-CONTINUE-NET.
  4655
  4656      COMPUTE ANGLEN EQUAL WK1 / I.
  4657      MOVE ANGLEN                TO ANGLEN-1.
  4658
  4659      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  86
* ELRATE.cbl
  4660
  4661      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4662       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4663       ((N - ANGLEN) / I).
  4664
  4665      MOVE WK3 TO CP-CALC-PREMIUM.
  4666
  4667     GO TO 99999-RETURN.
  4668
  4669 12000-CONTINUE-NET.
  4670
  4671     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4672        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4673        (CP-EARN-AS-NET-PAY)
  4674        NEXT SENTENCE
  4675     ELSE
  4676        GO TO 12001-CONTINUE-MINN.
  4677
  4678      COMPUTE ANGLEN EQUAL WK6 / I.
  4679      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4680
  4681      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4682      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4683      COMPUTE WK3 EQUAL (WK3 / I) *
  4684       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4685
  4686      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4687         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4688
  4689      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4690
  4691      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4692         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4693         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4694
  4695      MOVE WK3 TO CP-CALC-PREMIUM.
  4696
  4697     GO TO 99999-RETURN.
  4698
  4699 12001-CONTINUE-MINN.
  4700
  4701     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4702        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4703        (CP-TRUNCATED-LIFE)
  4704        NEXT SENTENCE
  4705     ELSE
  4706        GO TO 12001-CHECK-RI-GTL.
  4707
  4708      COMPUTE ANGLEN EQUAL WK1 / I.
  4709      COMPUTE ANGLEM EQUAL WK2 / I.
  4710
  4711      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4712       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4713       * M / 2400) * 1000 + .5) / 1000000.
  4714
  4715      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4716       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4717
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  87
* ELRATE.cbl
  4718     GO TO 99999-RETURN.
  4719
  4720 12001-CHECK-RI-GTL.
  4721
  4722     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4723        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4724        (CP-EARN-AS-NET-PAY)
  4725        NEXT SENTENCE
  4726     ELSE
  4727        GO TO 12001-CHECK-RI-LEASE-GTL.
  4728
  4729      COMPUTE ANGLEN EQUAL WK1 / I.
  4730*     COMPUTE ANGLEM EQUAL WK2 / I.
  4731
  4732      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4733               (1 + WS-WORK-DIS-RATE * N).
  4734      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4735         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4736
  4737
  4738     GO TO 99999-RETURN.
  4739
  4740 12001-CHECK-RI-LEASE-GTL.
  4741
  4742     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4743        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4744        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4745        NEXT SENTENCE
  4746     ELSE
  4747        GO TO 12001-CHECK-OR-GTL.
  4748
  4749     COMPUTE ANGLEN EQUAL WK1 / I.
  4750
  4751     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4752        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4753                        /
  4754        (1000 * I * (1 + .0021 * N)).
  4755     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4756       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4757                            /
  4758       (1000 * (1 + .0027 * (N + 1))).
  4759
  4760     GO TO 99999-RETURN.
  4761
  4762 12001-CHECK-OR-GTL.
  4763
  4764     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4765        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4766        (CP-EARN-AS-NET-PAY)
  4767        NEXT SENTENCE
  4768     ELSE
  4769        GO TO 12001-CHECK-GA-GTL.
  4770
  4771     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4772     COMPUTE ANGLEN EQUAL WK1 / I.
  4773
  4774     IF M LESS THAN +64
  4775        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  88
* ELRATE.cbl
  4776         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4777                   /
  4778         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4779        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4780     ELSE
  4781        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4782        CP-PREMIUM-RATE * (1 + I))
  4783                  /
  4784        (+1000 * I * ANGLEN)
  4785        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4786*    MOVE WK3 TO CP-CALC-PREMIUM.
  4787     GO TO 99999-RETURN.
  4788
  4789 12001-CHECK-GA-GTL.
  4790
  4791     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4792        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4793        (CP-EARN-AS-NET-PAY)
  4794*       (CP-TRUNCATED-LIFE)
  4795        NEXT SENTENCE
  4796     ELSE
  4797        GO TO 12001-CHECK-MA-GTL.
  4798
  4799     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4800     COMPUTE ANGLEN EQUAL WK1 / I.
  4801
  4802     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4803     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4804      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4805     MOVE WK3 TO CP-CALC-PREMIUM.
  4806
  4807     GO TO 99999-RETURN.
  4808
  4809 12001-CHECK-MA-GTL.
  4810
  4811     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4812        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4813        (CP-EARN-AS-NET-PAY) AND
  4814        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4815        NEXT SENTENCE
  4816     ELSE
  4817        GO TO 12001-CHECK-NV-NET.
  4818
  4819     COMPUTE ANGLEN EQUAL WK1 / I.
  4820
  4821     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4822      CP-ALTERNATE-BENEFIT * N.
  4823
  4824     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4825     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4826
  4827     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4828     WK7 * (N - ANGLEN) / I.
  4829     MOVE WK3 TO CP-CALC-PREMIUM.
  4830
  4831     GO TO 99999-RETURN.
  4832
  4833 12001-CHECK-NV-NET.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  89
* ELRATE.cbl
  4834     IF (CP-COMPANY-ID EQUAL 'CID')
  4835        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4836        AND (CP-EARN-AS-NET-PAY)
  4837        CONTINUE
  4838     ELSE
  4839        GO TO 12001-CHECK-MN-NET
  4840     END-IF
  4841     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4842     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4843     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4844                   / (1 + I)
  4845     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4846     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4847     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4848        (CP-PREMIUM-RATE * K-I / 1000)
  4849     MOVE WK3                    TO CP-CALC-PREMIUM
  4850     GO TO 99999-RETURN
  4851      .
  4852 12001-CHECK-MN-NET.
  4853     IF (CP-COMPANY-ID EQUAL 'CID')
  4854        AND (CP-STATE-STD-ABBRV = 'MN')
  4855        AND (CP-EARN-AS-NET-PAY)
  4856        AND (NOT CP-LEVEL-LIFE)
  4857        AND (WS-DISCOUNT-OPTION = '1')
  4858        CONTINUE
  4859     ELSE
  4860        GO TO 12001-CHECK-NC-NET
  4861     END-IF
  4862     if i = .0000000001
  4863        compute wk4 = cp-original-benefit / n
  4864        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  4865           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  4866        move wk3 to cp-calc-premium
  4867        go to 99999-return
  4868     end-if
  4869     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4870     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4871     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4872                   / (1 + I)
  4873     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4874     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4875     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4876        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4877     MOVE WK3                    TO CP-CALC-PREMIUM
  4878     GO TO 99999-RETURN
  4879      .
  4880 12001-CHECK-NC-NET.
  4881
  4882     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4883        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4884        (CP-EARN-AS-NET-PAY)
  4885        NEXT SENTENCE
  4886     ELSE
  4887        GO TO 12001-CHECK-NC-NET-PLUS3.
  4888
  4889      COMPUTE ANGLEN EQUAL WK1 / I.
  4890      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4891
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  90
* ELRATE.cbl
  4892      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4893          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4894          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4895          N * (CP-PREMIUM-RATE / 1000)).
  4896
  4897      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4898          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4899
  4900      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4901          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4902          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4903          (ANGLEN * 2))
  4904
  4905      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4906
  4907      IF ANGLEN IS NOT LESS THAN WK7
  4908          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4909              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4910          COMPUTE WK3 ROUNDED =
  4911              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4912
  4913     MOVE WK3 TO CP-CALC-PREMIUM.
  4914
  4915     GO TO 99999-RETURN.
  4916
  4917 12001-CHECK-NC-NET-PLUS3.
  4918
  4919     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4920        (CP-EARN-AS-NET-PAY) AND
  4921        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  4922        NEXT SENTENCE
  4923     ELSE
  4924        GO TO 12001-CHECK-CA.
  4925
  4926     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4927     MOVE ' ' TO DC-OPTION-CODE.
  4928     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4929
  4930     IF DATE-CONVERSION-ERROR
  4931        MOVE '2'                 TO CP-RETURN-CODE
  4932        MOVE ZEROS               TO FACTOR
  4933                                    CP-CALC-PREMIUM
  4934         GO TO 99999-RETURN.
  4935
  4936     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4937        NEXT SENTENCE
  4938     ELSE
  4939        GO TO 12001-CONTINUE-NET.
  4940
  4941     COMPUTE ANGLEN EQUAL WK1 / I.
  4942     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4943
  4944     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4945
  4946     COMPUTE NC-R = 20 *
  4947                    ((NC-LR * ORIGINAL-TERM) / 12)
  4948                          / (ORIGINAL-TERM + 1).
  4949
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  91
* ELRATE.cbl
  4950     COMPUTE NC-OB = NC-R / 1000.
  4951
  4952     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4953                    (NC-OB * ORIGINAL-TERM * 3).
  4954
  4955     IF CP-EXT-CHG-LF
  4956         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4957     ELSE
  4958         MOVE 30                 TO  NC-BIG-D.
  4959
  4960     COMPUTE NC-LITTLE-D = (1 + I) /
  4961             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4962
  4963     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4964             (ANGLEN * NC-LITTLE-D ).
  4965
  4966     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4967
  4968     GO TO 99999-RETURN.
  4969
  4970 12001-CHECK-CA.
  4971
  4972     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4973        (WS-DISCOUNT-OPTION = '6')
  4974        NEXT SENTENCE
  4975     ELSE
  4976        GO TO 12001-CHECK-GTL-IA.
  4977
  4978     COMPUTE CA-J = CA-DISCOUNT / 12.
  4979     COMPUTE ANGLEN EQUAL WK1 / I.
  4980     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4981     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4982     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4983     COMPUTE CA-VI = (1 + I)** -1.
  4984     COMPUTE CP-CALC-PREMIUM =
  4985         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4986         ((1 + CA-J) / I) *
  4987         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4988         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4989         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4990
  4991     GO TO 99999-RETURN.
  4992
  4993 12001-CHECK-GTL-IA.
  4994
  4995     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4996        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4997        (CP-EARN-AS-NET-PAY)
  4998        NEXT SENTENCE
  4999     ELSE
  5000        GO TO 12001-CHECK-CID-TRN-VA.
  5001
  5002***************************************************************
  5003
  5004     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  5005
  5006     IF GTL-IA-ODD-DAYS = ZEROS
  5007         MOVE ZERO               TO  GTL-IA-SGN
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  92
* ELRATE.cbl
  5008     ELSE
  5009         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  5010             MOVE +1             TO  GTL-IA-SGN
  5011         ELSE
  5012             MOVE -1             TO  GTL-IA-SGN.
  5013
  5014     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  5015     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  5016
  5017     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  5018                          GTL-IA-SGN.
  5019
  5020     COMPUTE ANGLEN EQUAL WK1 / I.
  5021     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5022
  5023     IF GTL-IA-ODF NOT = ZERO
  5024         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  5025         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  5026
  5027     COMPUTE GTL-IA-DIVIDEND =
  5028           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  5029                             (ANGLEN - ANGLEN-M))) *
  5030           ((K1 + I) * CP-PREMIUM-RATE *
  5031                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  5032
  5033     COMPUTE GTL-IA-DIVISOR =
  5034      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  5035
  5036     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  5037
  5038     COMPUTE CP-CALC-PREMIUM =
  5039                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  5040     GO TO 99999-RETURN.
  5041
  5042
  5043 12001-CHECK-CID-TRN-VA.
  5044
  5045     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5046        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  5047        (CP-EARN-AS-NET-PAY) AND
  5048        (CP-TRUNCATED-LIFE) AND
  5049        (CP-STATE-STD-ABBRV = CP-STATE)
  5050        CONTINUE
  5051     ELSE
  5052        GO TO 12001-CHECK-CID-TX
  5053     END-IF
  5054
  5055     COMPUTE ANGLEN EQUAL WK1 / I
  5056     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5057     IF WS-WORK-DIS-RATE = ZEROS
  5058        CONTINUE
  5059     ELSE
  5060        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5061        COMPUTE WK7 = (1 / I) *
  5062              (((WK4 ** M - 1) / (WK4 - 1)) -
  5063              ((WK4 ** M * SX - VX) /
  5064              (WK4 * (1 + I) - 1))) *
  5065              (CP-PREMIUM-RATE / 1000)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  93
* ELRATE.cbl
  5066        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5067        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5068        COMPUTE CP-CALC-PREMIUM =
  5069           WK8 *  ((WK4 * ANGLEN) / 100)
  5070     END-IF
  5071
  5072     GO TO 99999-RETURN
  5073
  5074     .
  5075
  5076 12001-CHECK-CID-TX.
  5077     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5078        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5079        (CP-EARN-AS-NET-PAY) AND
  5080        (WS-WORK-DIS-RATE > ZEROS) AND
  5081        (CP-STATE-STD-ABBRV = CP-STATE)
  5082        CONTINUE
  5083     ELSE
  5084        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5085     END-IF
  5086* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5087     COMPUTE K-I = 1 + (1 * I)
  5088     COMPUTE ANGLEN EQUAL WK1 / I
  5089     COMPUTE ANGLEM EQUAL WK2 / I
  5090     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5091     IF WS-WORK-DIS-RATE = ZEROS
  5092        CONTINUE
  5093     ELSE
  5094        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5095        COMPUTE WK7 = (K-I / I) *
  5096              (((WK4 ** M - 1) / (WK4 - 1)) -
  5097*             ((WK4 ** M * SX - VX) /
  5098              ((WK4 ** M * SX) - VX) /
  5099*             (WK4 * (1 + I) - 1))) *
  5100              (WK4 * (1 + I) - 1)) *
  5101              (CP-PREMIUM-RATE / 1000)
  5102        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5103        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5104        COMPUTE CP-CALC-PREMIUM =
  5105           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5106     END-IF
  5107
  5108     GO TO 99999-RETURN
  5109     .
  5110 12001-CHECK-CID-LEV-MN-NEW.
  5111*    IF (CP-COMPANY-ID EQUAL 'CID')
  5112*       AND (CP-STATE-STD-ABBRV = 'MN')
  5113*       AND (CP-EARN-AS-NET-PAY)
  5114*       AND (CP-LEVEL-LIFE)
  5115*       AND (CP-CERT-EFF-DT > X'A4FF')
  5116*       CONTINUE
  5117*    ELSE
  5118*       GO TO 12001-CHECK-CID-LEV-MN
  5119*    END-IF
  5120*
  5121*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5122*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5123*    MOVE '1'                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  94
* ELRATE.cbl
  5124*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5125*
  5126*    IF DATE-CONVERSION-ERROR
  5127*       MOVE '2'                 TO CP-RETURN-CODE
  5128*       MOVE ZEROS               TO FACTOR
  5129*                                   CP-CALC-PREMIUM
  5130*       GO TO 99999-RETURN
  5131*    END-IF
  5132*
  5133*    COMPUTE I = CP-LOAN-APR / 100
  5134*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5135*
  5136*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5137*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5138*      * 12 / 360 * D)
  5139*
  5140*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5141*       * 12 / 360 * D
  5142*
  5143*    GO TO 99999-RETURN
  5144      .
  5145 12001-CHECK-CID-LEV-MN.
  5146
  5147     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5148        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5149        (CP-EARN-AS-NET-PAY) AND
  5150        (CP-LEVEL-LIFE) AND
  5151        (CP-STATE-STD-ABBRV = CP-STATE)
  5152        CONTINUE
  5153     ELSE
  5154        GO TO 12001-CHECK-CID-LEV-CA
  5155     END-IF
  5156
  5157     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5158         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5159         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5160
  5161     GO TO 99999-RETURN
  5162
  5163      .
  5164 12001-CHECK-CID-LEV-CA.
  5165
  5166     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5167        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5168        (CP-EARN-AS-NET-PAY) AND
  5169        (CP-LEVEL-LIFE) AND
  5170        (CP-STATE-STD-ABBRV = CP-STATE)
  5171        CONTINUE
  5172     ELSE
  5173        GO TO 12001-CHECK-CID-TRN-CA
  5174     END-IF
  5175
  5176     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5177     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5178     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5179     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5180     COMPUTE CP-CALC-PREMIUM =
  5181          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  95
* ELRATE.cbl
  5182          (CP-PREMIUM-RATE / 1000)) /
  5183          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5184
  5185     GO TO 99999-RETURN
  5186
  5187      .
  5188 12001-CHECK-CID-TRN-CA.
  5189
  5190     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5191        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5192        (CP-EARN-AS-NET-PAY) AND
  5193        (CP-TRUNCATED-LIFE) AND
  5194        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5195        (WS-DISCOUNT-OPTION NOT = ' ')
  5196        CONTINUE
  5197     ELSE
  5198        GO TO 12001-CHECK-CID-TRN-MT
  5199     END-IF
  5200
  5201     COMPUTE ANGLEN EQUAL WK1 / I
  5202     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5203     IF WS-WORK-DIS-RATE = ZEROS
  5204        CONTINUE
  5205     ELSE
  5206        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5207        COMPUTE WK7 = (1 / I) *
  5208              (((WK4 ** M - 1) / (WK4 - 1)) -
  5209              ((WK4 ** M * SX - VX) /
  5210              (WK4 * (1 + I) - 1))) *
  5211              (CP-PREMIUM-RATE / 1000)
  5212        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5213        COMPUTE CP-CALC-PREMIUM =
  5214           WK4 *  WK7
  5215     END-IF
  5216
  5217     GO TO 99999-RETURN
  5218
  5219      .
  5220 12001-CHECK-CID-TRN-MT.
  5221
  5222     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5223        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5224                   OR
  5225        ((CP-STATE-STD-ABBRV = 'IN') AND
  5226        (CP-CERT-EFF-DT > X'9A7F'))
  5227                   OR
  5228        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5229        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5230        (CP-EARN-AS-NET-PAY) AND
  5231        (CP-TRUNCATED-LIFE) AND
  5232        (CP-STATE-STD-ABBRV = CP-STATE)
  5233        CONTINUE
  5234     ELSE
  5235        GO TO 12001-CHECK-CID-MT
  5236     END-IF
  5237
  5238* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5239     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  96
* ELRATE.cbl
  5240        MOVE 0                   TO K-I
  5241     ELSE
  5242        MOVE 2                   TO K-I
  5243     END-IF
  5244     COMPUTE CP-TERM-OR-EXT-DAYS =
  5245           CP-TERM-OR-EXT-DAYS + 30
  5246
  5247     COMPUTE ANGLEN EQUAL WK1 / I
  5248     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5249     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5250                   / (1 + I)
  5251     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5252     IF WS-WORK-DIS-RATE = ZEROS
  5253        CONTINUE
  5254     ELSE
  5255        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5256*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5257        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5258              (((WK4 ** M - 1) / (WK4 - 1)) -
  5259              ((WK4 ** M * SX - VX) /
  5260              (WK4 * (1 + I) - 1))) *
  5261              (CP-PREMIUM-RATE / 1000)
  5262        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5263*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5264        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5265        COMPUTE CP-CALC-PREMIUM =
  5266           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5267*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5268     END-IF
  5269
  5270     GO TO 99999-RETURN
  5271
  5272     .
  5273 12001-CHECK-CID-MT.
  5274
  5275     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5276        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5277                                OR 'VT')
  5278                   OR
  5279        ((CP-STATE-STD-ABBRV = 'IN') AND
  5280        (CP-CERT-EFF-DT > X'9A7F'))
  5281                   OR
  5282        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5283        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5284        (CP-EARN-AS-NET-PAY) AND
  5285        (CP-STATE-STD-ABBRV = CP-STATE)
  5286        CONTINUE
  5287     ELSE
  5288        GO TO 12001-CHECK-DCC-DD
  5289     END-IF
  5290
  5291     COMPUTE CP-TERM-OR-EXT-DAYS =
  5292           CP-TERM-OR-EXT-DAYS + 30
  5293
  5294* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5295     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5296        MOVE 0                   TO K-I
  5297     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  97
* ELRATE.cbl
  5298        IF CP-STATE-STD-ABBRV = 'NJ'
  5299           MOVE 1                TO K-I
  5300        ELSE
  5301           MOVE 2                TO K-I
  5302        END-IF
  5303     END-IF
  5304     COMPUTE ANGLEN EQUAL WK1 / I
  5305     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5306     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5307                   / (1 + I)
  5308     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5309     IF WS-WORK-DIS-RATE = ZEROS
  5310        CONTINUE
  5311     ELSE
  5312        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5313*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5314        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5315              (((WK4 ** N - 1) / (WK4 - 1)) -
  5316              ((WK4 ** N - SV) /
  5317              (WK4 * (1 + I) - 1))) *
  5318              (CP-PREMIUM-RATE / 1000)
  5319        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5320*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5321        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5322        COMPUTE CP-CALC-PREMIUM =
  5323           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5324*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5325     END-IF
  5326
  5327     GO TO 99999-RETURN
  5328
  5329     .
  5330 12001-CHECK-DCC-DD.
  5331     IF (CP-COMPANY-ID EQUAL 'DCC')
  5332        AND (CP-EARN-AS-NET-PAY)
  5333        AND (CP-BEN-CATEGORY = 'D')
  5334        CONTINUE
  5335     ELSE
  5336        GO TO 12001-CHECK-DCC-NET
  5337     END-IF
  5338
  5339     COMPUTE CP-TERM-OR-EXT-DAYS =
  5340           CP-TERM-OR-EXT-DAYS + 30
  5341
  5342     COMPUTE ANGLEN EQUAL WK1 / I.
  5343     COMPUTE ANGLEM EQUAL WK2 / I.
  5344     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5345
  5346     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5347           / (1 + I)
  5348     COMPUTE GR     = ANGLEN / ODF
  5349*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5350*      CP-RATE-DEV-PCT
  5351     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5352     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5353       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5354     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5355     MOVE WK3                    TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  98
* ELRATE.cbl
  5356
  5357     GO TO 99999-RETURN
  5358
  5359     .
  5360 12001-CHECK-DCC-NET.
  5361
  5362     IF (CP-COMPANY-ID EQUAL 'DCC')
  5363        AND (CP-EARN-AS-NET-PAY)
  5364        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5365             AND 'H' AND 'S' AND 'P')
  5366        CONTINUE
  5367     ELSE
  5368        GO TO 12001-CHECK-DCC-PNET
  5369     END-IF
  5370
  5371     COMPUTE CP-TERM-OR-EXT-DAYS =
  5372           CP-TERM-OR-EXT-DAYS + 30
  5373
  5374     COMPUTE ANGLEN EQUAL WK1 / I.
  5375     COMPUTE ANGLEM EQUAL WK2 / I.
  5376     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5377
  5378     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5379           / (1 + I)
  5380     COMPUTE GR     = ANGLEN / ODF
  5381     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5382     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5383       CP-RATE-DEV-PCT
  5384     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5385*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5386
  5387     COMPUTE WK8 = CP-PREMIUM-RATE *
  5388        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5389     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5390     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5391     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5392       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5393     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5394     MOVE WK3                    TO CP-CALC-PREMIUM
  5395
  5396     GO TO 99999-RETURN
  5397
  5398     .
  5399 12001-CHECK-DCC-PNET.
  5400     IF (CP-COMPANY-ID EQUAL 'DCC')
  5401        AND (CP-EARN-AS-NET-PAY)
  5402        AND (CP-BENEFIT-CD (1:1) = 'P')
  5403        CONTINUE
  5404     ELSE
  5405        GO TO 12001-CHECK-DCC-MNET
  5406     END-IF
  5407     IF CP-NO-OF-PMTS NOT NUMERIC
  5408        MOVE +0                  TO CP-NO-OF-PMTS
  5409     END-IF
  5410     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5411        AND ' ' AND 'M'
  5412        MOVE ' '                 TO CP-PMT-MODE
  5413     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page  99
* ELRATE.cbl
  5414******************************************************************
  5415***   Default is monthly, use loan term for rate and amort     ***
  5416******************************************************************
  5417     move cp-loan-term         to c-tot-pmts
  5418     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5419     MOVE +12                  TO C-PMTS-PER-YEAR
  5420******************************************************************
  5421
  5422     evaluate true
  5423        when cp-pmt-mode = 'W'
  5424           MOVE +52              TO C-PMTS-PER-YEAR
  5425           compute c-tot-pmts = cp-loan-term /
  5426              12 * c-pmts-per-year
  5427           MOVE +7               TO C-DAYS-IN-PMT-PER
  5428        when cp-pmt-mode = 'B'
  5429           MOVE +26              TO C-PMTS-PER-YEAR
  5430           compute c-tot-pmts = cp-loan-term /
  5431              12 * c-pmts-per-year
  5432           MOVE +14              TO C-DAYS-IN-PMT-PER
  5433     end-evaluate
  5434     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5435     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5436        C-DAYS-IN-PMT-PER)) / (1 + I)
  5437     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5438*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5439     COMPUTE ANGLEN-1 = ANGLEN / Y
  5440     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5441     IF CP-RATE-DEV-PCT NOT = ZEROS
  5442        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5443           CP-PREMIUM-RATE
  5444     END-IF
  5445     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5446     GO TO 99999-RETURN
  5447     .
  5448 12001-CHECK-DCC-MNET.
  5449
  5450     IF (CP-COMPANY-ID EQUAL 'DCC')
  5451        AND (CP-EARN-AS-NET-PAY)
  5452        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5453        CONTINUE
  5454     ELSE
  5455        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5456     END-IF
  5457
  5458*    COMPUTE ANGLEN EQUAL WK1 / I.
  5459*    COMPUTE ANGLEM EQUAL WK2 / I.
  5460*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5461
  5462     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5463     MOVE WK3                    TO CP-CALC-PREMIUM
  5464
  5465     GO TO 99999-RETURN
  5466
  5467     .
  5468 12001-CHECK-DCC-MNET-LF-BAL.
  5469
  5470     IF (CP-COMPANY-ID EQUAL 'DCC')
  5471        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 100
* ELRATE.cbl
  5472        AND (CP-BENEFIT-CD (1:1) = 'N')
  5473        AND (CP-BEN-CATEGORY NOT = 'N')
  5474        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5475        CONTINUE
  5476     ELSE
  5477        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5478     END-IF
  5479
  5480     IF CP-RATE-DEV-PCT NOT = ZEROS
  5481        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5482           CP-PREMIUM-RATE
  5483     END-IF
  5484*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5485     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5486        / (1 + I)
  5487     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5488     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5489     COMPUTE WK2 = (1 + J) ** (M * -1)
  5490     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5491     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5492          ** ((M - 1) * -1))) / J)
  5493     COMPUTE ANGLEM = ((1 - ((1 + J)
  5494          ** (M * -1))) / J) / OD
  5495     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5496        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5497        / ANGLEM-1
  5498     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5499          ** ((N - M) * -1))) / I)
  5500     MOVE +0                     TO WK3
  5501     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5502        (WS-COUNTER > M)
  5503        COMPUTE ANGLEM = (1 - ((1 + J)
  5504          ** ((M - WS-COUNTER) * -1))) / J
  5505        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5506        COMPUTE WK5-CSL = (RA * ANGLEM)
  5507        + (CP-ALTERNATE-BENEFIT * WK2)
  5508        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5509     END-PERFORM
  5510     MOVE WK3                    TO CP-CALC-PREMIUM
  5511
  5512     GO TO 99999-RETURN
  5513
  5514     .
  5515 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5516
  5517     IF (CP-COMPANY-ID EQUAL 'DCC')
  5518        AND (CP-EARN-AS-NET-PAY)
  5519        AND (CP-BENEFIT-CD (1:1) = 'S')
  5520        AND (CP-BEN-CATEGORY NOT = 'N')
  5521        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5522        CONTINUE
  5523     ELSE
  5524        GO TO 12001-CHECK-DCC-MNET-LF
  5525     END-IF
  5526
  5527     IF CP-RATE-DEV-PCT NOT = ZEROS
  5528        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5529           CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 101
* ELRATE.cbl
  5530     END-IF
  5531     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5532     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5533          ** ((M - 1) * -1))) / K)
  5534     COMPUTE ANGLEM = ((1 - ((1 + K)
  5535          ** (M * -1))) / K)
  5536     MOVE CP-MONTHLY-PAYMENT     TO RA
  5537     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5538        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5539        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5540        CP-PREMIUM-RATE / 1000
  5541     MOVE WK3                    TO CP-CALC-PREMIUM
  5542
  5543     GO TO 99999-RETURN
  5544
  5545     .
  5546 12001-CHECK-DCC-MNET-LF.
  5547
  5548     IF (CP-COMPANY-ID EQUAL 'DCC')
  5549        AND (CP-EARN-AS-NET-PAY)
  5550        AND (CP-BENEFIT-CD (1:1) = 'N')
  5551        AND (CP-BEN-CATEGORY NOT = 'N')
  5552        CONTINUE
  5553     ELSE
  5554        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5555     END-IF
  5556
  5557     IF CP-RATE-DEV-PCT NOT = ZEROS
  5558        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5559           CP-PREMIUM-RATE
  5560     END-IF
  5561*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5562     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5563        / (1 + I)
  5564     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5565     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5566     COMPUTE WK2 = (1 + J) ** (M * -1)
  5567     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5568     COMPUTE ANGLEM = ((1 - ((1 + J)
  5569          ** (M * -1))) / J) / OD
  5570     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5571     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5572          ** ((N - M) * -1))) / I)
  5573     MOVE +0                     TO WK3
  5574     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5575        (WS-COUNTER > M)
  5576        COMPUTE ANGLEM = (1 - ((1 + J)
  5577          ** ((M - WS-COUNTER + 1) * -1))) / J
  5578        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5579        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5580        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5581     END-PERFORM
  5582     MOVE WK3                    TO CP-CALC-PREMIUM
  5583
  5584     GO TO 99999-RETURN
  5585
  5586     .
  5587 12001-CHECK-DCC-MNET-SUMLF.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 102
* ELRATE.cbl
  5588
  5589     IF (CP-COMPANY-ID EQUAL 'DCC')
  5590        AND (CP-EARN-AS-NET-PAY)
  5591        AND (CP-BENEFIT-CD (1:1) = 'S')
  5592        AND (CP-BEN-CATEGORY NOT = 'N')
  5593        CONTINUE
  5594     ELSE
  5595        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5596     END-IF
  5597
  5598     IF CP-RATE-DEV-PCT NOT = ZEROS
  5599        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5600           CP-PREMIUM-RATE
  5601     END-IF
  5602     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5603     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5604        / (1 + K)
  5605     COMPUTE ANGLEN-M = (WK5 / I)
  5606     COMPUTE WK2 = (1 + K) ** (M * -1)
  5607     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5608     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5609     COMPUTE ANGLEM = ((1 - ((1 + K)
  5610          ** (M * -1))) / K) / Y
  5611     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5612     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5613        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5614        - 1)) / K) * RA
  5615     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5616        + (CP-DAYS-TO-1ST-PMT - +30)
  5617        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5618        +0 / 1000 * 12 / 12)
  5619     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5620        * (12 / 12)
  5621     MOVE WK3                    TO CP-CALC-PREMIUM
  5622
  5623     GO TO 99999-RETURN
  5624
  5625     .
  5626 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5627
  5628     IF (CP-COMPANY-ID EQUAL 'DCC')
  5629        AND (CP-EARN-AS-NET-PAY)
  5630        AND (CP-BENEFIT-CD (1:1) = 'N')
  5631        AND (CP-BEN-CATEGORY = 'N')
  5632        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5633        CONTINUE
  5634     ELSE
  5635        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5636     END-IF
  5637
  5638*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5639     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5640        / (1 + I)
  5641     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5642     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5643     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5644     COMPUTE WK2 = (1 + J) ** (M * -1)
  5645     COMPUTE ANGLEN-M = ANGLEN-M * WK2
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 103
* ELRATE.cbl
  5646     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5647          ** ((M - 1) * -1))) / J)
  5648     COMPUTE ANGLEM = ((1 - ((1 + J)
  5649          ** (M * -1))) / J) / OD
  5650     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5651        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5652        / ANGLEM-1
  5653     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5654          ** ((N - M) * -1))) / I)
  5655     MOVE +0                     TO WK3
  5656     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5657        (WS-COUNTER > M)
  5658        COMPUTE ANGLEM = (1 - ((1 + J)
  5659          ** ((M - WS-COUNTER) * -1))) / J
  5660        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5661        COMPUTE WK5-CSL = (RA * ANGLEM)
  5662        + (CP-ALTERNATE-BENEFIT * WK2)
  5663        COMPUTE WK3 = WK3 +
  5664         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5665        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5666          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5667          (CP-DCC-AH-RATE / 1000)
  5668     END-PERFORM
  5669     MOVE WK3                    TO CP-CALC-PREMIUM
  5670
  5671     GO TO 99999-RETURN
  5672
  5673     .
  5674 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5675
  5676     IF (CP-COMPANY-ID EQUAL 'DCC')
  5677        AND (CP-EARN-AS-NET-PAY)
  5678        AND (CP-BENEFIT-CD (1:1) = 'S')
  5679        AND (CP-BEN-CATEGORY = 'N')
  5680        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5681        CONTINUE
  5682     ELSE
  5683        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5684     END-IF
  5685
  5686     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5687     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5688          ** ((M - 1) * -1))) / K)
  5689     COMPUTE ANGLEM = ((1 - ((1 + K)
  5690          ** (M * -1))) / K)
  5691     MOVE CP-MONTHLY-PAYMENT     TO RA
  5692     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5693        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5694        * CP-DCC-AH-RATE / 1000))
  5695        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5696        CP-DCC-LF-RATE / 1000
  5697     MOVE WK3                    TO CP-LF-PREM
  5698     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5699        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5700        * CP-DCC-AH-RATE / 1000
  5701     COMPUTE WK3 = WK3 + WK5-CSL
  5702     MOVE WK3                    TO CP-CALC-PREMIUM
  5703
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 104
* ELRATE.cbl
  5704     GO TO 99999-RETURN
  5705      .
  5706 12001-CHECK-DCC-MNET-TOT-N.
  5707
  5708     IF (CP-COMPANY-ID EQUAL 'DCC')
  5709        AND (CP-EARN-AS-NET-PAY)
  5710        AND (CP-BENEFIT-CD (1:1) = 'N')
  5711        AND (CP-BEN-CATEGORY = 'N')
  5712        CONTINUE
  5713     ELSE
  5714        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5715     END-IF
  5716
  5717*    I = APR/1200
  5718*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5719*    RA = PAYMENT AMOUNT
  5720*    WK5-CSL = THE BALANCE (PAY OFF )
  5721*    WK3 = THE ACCUMULATED PREMIUM
  5722*    WK2 = (1 + I) ^ (m * -1)
  5723*    OD  = GAMMA
  5724*
  5725*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5726     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5727        / (1 + I)
  5728     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5729     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5730        (CP-DCC-AH-RATE / +1000)
  5731     COMPUTE WK2 = (1 + J) ** (M * -1)
  5732     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5733     COMPUTE ANGLEM = ((1 - ((1 + J)
  5734          ** (M * -1))) / J) / OD
  5735     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5736     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5737          ** ((N - M) * -1))) / I)
  5738     MOVE +0                     TO WK3
  5739     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5740        (WS-COUNTER > M)
  5741        COMPUTE ANGLEM = (1 - ((1 + J)
  5742          ** ((M - WS-COUNTER + 1) * -1))) / J
  5743        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5744        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5745        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5746           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5747     END-PERFORM
  5748     MOVE WK3                    TO CP-CALC-PREMIUM
  5749
  5750     GO TO 99999-RETURN
  5751
  5752     .
  5753 12001-CHECK-DCC-MNET-TOT-S.
  5754
  5755     IF (CP-COMPANY-ID EQUAL 'DCC')
  5756        AND (CP-EARN-AS-NET-PAY)
  5757        AND (CP-BENEFIT-CD (1:1) = 'S')
  5758        AND (CP-BEN-CATEGORY = 'N')
  5759        CONTINUE
  5760     ELSE
  5761        GO TO 12001-CONTINUE-NET
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 105
* ELRATE.cbl
  5762     END-IF
  5763
  5764*    I = APR/1200
  5765*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5766*    RA = PAYMENT AMOUNT
  5767*    WK5-CSL = THE BALANCE (PAY OFF )
  5768*    WK3 = THE ACCUMULATED PREMIUM
  5769*    WK2 = (1 + I) ^ (m * -1)
  5770*    OD  = GAMMA
  5771*
  5772     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5773     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5774        / (1 + J)
  5775     COMPUTE ANGLEM = ((1 - ((1 + J)
  5776          ** (M * -1))) / J) / OD
  5777     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5778          ** ((N - M) * -1))) / I)
  5779          * (1 + J) ** (-1 * M)
  5780     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5781     MOVE CP-MONTHLY-PAYMENT     TO RA
  5782     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5783        / +30)
  5784     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5785        ** (WK1) - 1)) / J) * RA
  5786     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5787        + (CP-DAYS-TO-1ST-PMT - +30)
  5788        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5789        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5790     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5791        (12 / 12)
  5792     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5793        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5794        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5795     COMPUTE WK3 = WK3 + WK5-CSL
  5796     MOVE WK3                    TO CP-CALC-PREMIUM
  5797     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5798     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5799        / (1 + K)
  5800     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5801          ** ((N - M) * -1))) / I)
  5802     COMPUTE WK2 = (1 + K) ** (M * -1)
  5803     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5804     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5805     COMPUTE ANGLEM = ((1 - ((1 + K)
  5806          ** (M * -1))) / K) / Y
  5807*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5808     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5809        ((1 + K) ** (M + 1 / Y
  5810        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5811        - 1)) / K) * RA
  5812     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5813        + (CP-DAYS-TO-1ST-PMT - +30)
  5814        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5815        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5816     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5817        * (12 / 12)
  5818     MOVE WK3                    TO CP-LF-PREM
  5819
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 106
* ELRATE.cbl
  5820     GO TO 99999-RETURN
  5821
  5822     .
  5823 12001-CONTINUE-NET.
  5824
  5825     IF NET-STD
  5826        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5827*          OR 'DCC'
  5828         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5829         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5830         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5831         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5832                               * ((1 + N) / (1 + M))
  5833         if (i = .0000000001)
  5834            and (wk3 = zeros)
  5835            move 1               to wk3
  5836         end-if
  5837        ELSE
  5838         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5839         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5840         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5841         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5842
  5843     IF NET-SMP
  5844         COMPUTE N2 = N * N
  5845         COMPUTE N3 = N2 * N
  5846         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5847         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5848         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5849         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5850         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5851
  5852     IF NPO-PRUDENTIAL
  5853       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5854           VARYING WS-COUNTER FROM 1 BY 1
  5855               UNTIL WS-COUNTER = N
  5856       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5857       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5858
  5859     MOVE WK3 TO FACTOR.
  5860
  5861     GO TO 99999-RETURN.
  5862
  5863 12100-PRU-CALC.
  5864     IF WS-COUNTER = 1
  5865         COMPUTE PWK = (I + 1)
  5866     ELSE
  5867         COMPUTE PWK = PWK * (I + 1).
  5868
  5869 12199-EXIT.
  5870      EXIT.
  5871
  5872 99000-ERROR.
  5873     MOVE +9999.999999999 TO N-P-FACTOR.
  5874     MOVE '4'             TO CP-RETURN-CODE.
  5875
  5876     GO TO 99999-EXIT.
  5877
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:42 Page 107
* ELRATE.cbl
  5878 99999-RETURN.
  5879     MOVE FACTOR          TO N-P-FACTOR.
  5880
  5881 99999-EXIT.
  5882      EXIT.
  5883 99999-DUMMY-STOP-RUN.
  5884
  5885* GOBACK.
  5886     MOVE '9%                    "   ' TO DFHEIV0
  5887     MOVE 'ELRATE' TO DFHEIV1
  5888     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5889     GOBACK.
  5890
  5891
  5892 9999-DFHBACK SECTION.
  5893     MOVE '9%                    "   ' TO DFHEIV0
  5894     MOVE 'ELRATE' TO DFHEIV1
  5895     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5896     GOBACK.
  5897 9999-DFHEXIT.
  5898     IF DFHEIGDJ EQUAL 0001
  5899         NEXT SENTENCE
  5900     ELSE IF DFHEIGDJ EQUAL 2
  5901         GO TO 9999-RATE-NOTFND,
  5902               9999-RATE-NOTOPEN,
  5903               9999-RATE-NOTFND
  5904         DEPENDING ON DFHEIGDI.
  5905     MOVE '9%                    "   ' TO DFHEIV0
  5906     MOVE 'ELRATE' TO DFHEIV1
  5907     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5908     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2556     Code:       52603
