* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38******************************************************************
    39
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   3
* EL131.cbl
    41 ENVIRONMENT DIVISION.
    42
    43 DATA DIVISION.
    44
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    51 77  s1                          pic s999 comp-3 value+0.
    52 77  s2                          pic s999 comp-3 value+0.
    53 77  a1                          pic s999 comp-3 value+0.
    54 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    55 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    56 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    57 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    58 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    59 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    60 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    61 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    62     88  ERPDEF-FOUND                 VALUE 'Y'.
    63
    64 01  LCP-TIME-OF-DAY-XX.
    65     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    66     05  FILLER                    PIC 99.
    67 01  LCP-CICS-TIME                 PIC 9(15).
    68*                            COPY ELCSCTM.
    69******************************************************************
    70*                                                                *
    71*                                                                *
    72*                            ELCSCTM                             *
    73*                            VMOD=2.001                          *
    74*                                                                *
    75*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    76*                                                                *
    77******************************************************************
    78 01  SECURITY-MESSAGE.
    79     12  FILLER                          PIC X(30)
    80            VALUE '** LOGIC SECURITY VIOLATION -'.
    81     12  SM-READ                         PIC X(6).
    82     12  FILLER                          PIC X(5)
    83            VALUE ' PGM='.
    84     12  SM-PGM                          PIC X(6).
    85     12  FILLER                          PIC X(5)
    86            VALUE ' OPR='.
    87     12  SM-PROCESSOR-ID                 PIC X(4).
    88     12  FILLER                          PIC X(6)
    89            VALUE ' TERM='.
    90     12  SM-TERMID                       PIC X(4).
    91     12  FILLER                          PIC XX   VALUE SPACE.
    92     12  SM-JUL-DATE                     PIC 9(5).
    93     12  FILLER                          PIC X    VALUE SPACE.
    94     12  SM-TIME                         PIC 99.99.
    95
    96
    97*                            COPY ELCSCRTY.
    98******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   4
* EL131.cbl
    99*                                                                *
   100*                                                                *
   101*                            ELCSCRTY                            *
   102*                            VMOD=2.001                          *
   103*                                                                *
   104*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   105*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   106*        SAVED IN PI-SECURITY-ADDRESS.                           *
   107*                                                                *
   108******************************************************************
   109 01  SECURITY-CONTROL.
   110     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   111     12  FILLER                       PIC XX    VALUE 'SC'.
   112     12  SC-CREDIT-CODES.
   113         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   114             20  SC-CREDIT-DISPLAY    PIC X.
   115             20  SC-CREDIT-UPDATE     PIC X.
   116     12  SC-CLAIMS-CODES.
   117         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   118             20  SC-CLAIMS-DISPLAY    PIC X.
   119             20  SC-CLAIMS-UPDATE     PIC X.
   120
   121*                            COPY ELCNWA.
   122*****************************************************************
   123*                                                               *
   124*                                                               *
   125*                            ELCNWA.                            *
   126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   127*                            VMOD=2.003                         *
   128*                                                               *
   129*            M O V E   N A M E   W O R K   A R E A.             *
   130*                                                               *
   131*****************************************************************.
   132
   133 01  WS-NAME-WORK-AREA.
   134     05  WS-INSURED-LAST-NAME        PIC X(15).
   135     05  WS-INSURED-1ST-NAME         PIC X(12).
   136     05  WS-INSURED-MID-INIT         PIC X.
   137
   138     05  WS-NAME-WORK.
   139         10  WS-NW                   PIC X
   140             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   141
   142     05  WS-NAME-WORK2.
   143         10  WS-NW2                  PIC X
   144             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   145                                        NWA-INDEX0.
   146
   147     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   148                                     COMP-3.
   149
   150
   151 01  ws-dcc-error-line.
   152     05  filler occurs 15.
   153         10  ws-error-no        pic x(4).
   154 01  WS-DATE-AREA.
   155     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   156     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   5
* EL131.cbl
   157     12  SAVE-DATE-CCYYMMDD.
   158         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   159         16  SAVE-DATE-YMD.
   160             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   161             20  FILLER         PIC X(4)    VALUE SPACES.
   162
   163 01  WS-BLANK                   PIC X       VALUE ' '.
   164
   165 01  CSO-WORK-FIELDS.
   166     05  WS-HOLD-CLAIM-STATUS    PIC X.
   167
   168 01  LITERALS-NUMBERS.
   169     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   170     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   171     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   172     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   173     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   174     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   175     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   176     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   177
   178     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   179     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   180     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   181     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   182     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   183     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   184     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   185     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   186     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   187     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   188
   189     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   190
   191     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   192
   193     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   194     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   195     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   196     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   197     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   198     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   199     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   200     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   201     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   202     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   203     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   204
   205     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   206     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   207     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   208     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   209         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   210     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   211     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   212     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   213     12  WS-ICD-CODE-1           PIC X(8).
   214     12  WS-ICD-CODE-2           PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   6
* EL131.cbl
   215     12  WS-CLAIM-SEQU.
   216         16  FILLER              PIC X VALUE '('.
   217         16  WS-CURRENT-SEQU     PIC Z9.
   218         16  FILLER              PIC X(04) VALUE ' OF '.
   219         16  WS-OF-SEQU          PIC Z9.
   220         16  FILLER              PIC X VALUE ')'.
   221     12  WS-EDIT-BEN-CODE        PIC XX.
   222         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   223                                          '90' THRU '99'.
   224
   225     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   226     12  WS-EDIT-NUMBER          PIC ZZZ9.
   227
   228     12  WS-RESPONSE             PIC S9(8)   COMP.
   229         88  WS-RESP-NORMAL              VALUE +00.
   230         88  WS-RESP-ERROR               VALUE +01.
   231         88  WS-RESP-NOTFND              VALUE +13.
   232         88  WS-RESP-DUPKEY              VALUE +15.
   233         88  WS-RESP-NOTOPEN             VALUE +19.
   234         88  WS-RESP-ENDFILE             VALUE +20.
   235
   236     12  WS-MOS-PAID             PIC 999.
   237     12  WS-ODD-DAYS             PIC 99.
   238     12  WS-REM-MOS              PIC 999.
   239     12  WS-REM-DAYS             PIC 99.
   240     12  WS-TERM-IN-DAYS         PIC 9(4).
   241     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   242
   243     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   244     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   245     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   246     12  WS-RESET-SW             PIC X       VALUE 'N'.
   247     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   248     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   249     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   250
   251 01  DMD-DATE-YYYYMMDD.
   252     12  DMD-DECADE          PIC XX      VALUE SPACES.
   253     12  DMD-YYMMDD.
   254         16  DMD-YY          PIC XX      VALUE SPACES.
   255         16  DMD-MM          PIC XX      VALUE SPACES.
   256         16  DMD-DD          PIC XX      VALUE SPACES.
   257
   258 01  DMD-DATE-MMDDYYYY.
   259     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   260     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   261     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   262     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   263     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   264     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   265
   266 01  WS-MAIL-CODE.
   267     12  FILLER              PIC X.
   268     12  DMD-MAIL-CODE.
   269         16  WS-MAIL-4       PIC X(4).
   270         16  WS-MAIL-5       PIC X.
   271     12  FILLER              PIC X(4).
   272
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   7
* EL131.cbl
   273     12  W-NAME-LAST             PIC  X(15).
   274     12  W-NAME-FIRST            PIC  X(15).
   275     12  W-NAME-MIDDLE.
   276         16  FILLER              PIC  X.
   277         16  W-NAME-MIDDLE-2     PIC  X.
   278         16  FILLER              PIC  X(13).
   279
   280*    COPY ELCDCTB.
   281******************************************************************
   282*                                                                *
   283*                                                                *
   284*                            ELCDCTB.                            *
   285*                            VMOD=2.002                          *
   286*                                                                *
   287*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   288*       COMMUNICATIONS AREA                                      *
   289*                                                                *
   290******************************************************************
   291 01  DCT-COMMUNICATION-AREA.
   292     12  DCT-BILLING-BANK-ID      PIC  X(05).
   293     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   294     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   295     12  DCT-PRODUCT-CODE         PIC  X(02).
   296     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   297     12  DCT-RETURN-CODE          PIC  X(02).
   298     12  DCT-MAIL-CODE            PIC  X(05).
   299     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   300     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   8
* EL131.cbl
   302 01  ERROR-SWITCHES.
   303     12  ERROR-SWITCH            PIC X.
   304         88  SCREEN-ERROR                    VALUE 'X'.
   305     12  MSTR-KEY-SWITCH         PIC X.
   306         88  MSTR-KEY-CHANGED                VALUE 'X'.
   307     12  CERT-KEY-SWITCH         PIC X.
   308*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   309         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   310*********SET TO Y IF PRIMARY KEY WILL CHANGE
   311         88  CERT-KEY-CHANGED                VALUE 'Y'.
   312     12  MSTR-SWITCH             PIC X.
   313         88  MSTR-UPDATES                    VALUE 'X'.
   314     12  CERT-SWITCH             PIC X.
   315         88  CERT-UPDATES                    VALUE 'X'.
   316     12  UPDATE-SWITCH           PIC X.
   317         88  UPDATES-PRESENT                 VALUE 'X'.
   318     12  TRLR-SWITCH             PIC X.
   319         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   320         88  UPDATE-MADE                     VALUE 'Y'.
   321     12  NINETY-TRLR-SWITCH      PIC X.
   322         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   323     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   324         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   325     12  EARNINGS-CALC-SWITCH    PIC X.
   326         88  TEX-REG                         VALUE '4'.
   327         88  NET-PAY                         VALUE '5'.
   328     12  DLYACTV-SW              PIC X       VALUE 'N'.
   329         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   9
* EL131.cbl
   331 01  EDIT-WORK-AREA.
   332     12  COUNT-2                 PIC 9.
   333     12  CALL-PGM                PIC X(8).
   334     12  TRANS-ID                PIC X(4).
   335     12  CHECK-PFKEYS            PIC 99.
   336     12  CHECK-MAINT             PIC X.
   337         88  ADD-ALPHA-RECORD                VALUE 'A'.
   338         88  CHANGE-CLAIM                    VALUE 'C'.
   339         88  DELETE-CLAIM                    VALUE 'D'.
   340         88  CHANGE-NAME                     VALUE 'N'.
   341         88  VALID-OPTIONS                   VALUE 'A' 'C'
   342                                                   'D' 'N'.
   343
   344     12  HOLD-BENEFIT            PIC XX.
   345     12  HOLD-FREQ               PIC XX.
   346     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   347     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   348     12  HOLD-PDTHRU             PIC XX.
   349     12  HOLD-ADDON              PIC XX.
   350     12  HOLD-NODAYS             PIC 9(4).
   351     12  HOLD-NOPMTS             PIC 9(3).
   352     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   353     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   354     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   355     12  HOLD-BIRTH              PIC XX.
   356     12  HOLD-END                PIC XX.
   357     12  HOLD-EFF                PIC XX.
   358     12  HOLD-ENTRY              PIC XX.
   359     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   360     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   361     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   362     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   363     12  HOLD-LF-CV-CAN          PIC XX.
   364     12  HOLD-AH-CV-CAN          PIC XX.
   365     12  DIVIDE-QUOT             PIC 9(3).
   366     12  DIVIDE-REM              PIC 9(3).
   367
   368     12  WS-ALPHA-DATE.
   369         16  WS-ALPHA-YEAR.
   370             20  WS-ALPHA-YY-1   PIC 99.
   371             20  WS-ALPHA-YY-2   PIC 99.
   372         16  WS-ALPHA-MM         PIC 99.
   373         16  WS-ALPHA-DD         PIC 99.
   374
   375     12  BUILD-VALID-DATE.
   376         16  BUILD-MONTH         PIC 99.
   377         16  BUILD-DAY           PIC 99.
   378         16  BUILD-YEAR          PIC 99.
   379     12  DEEDIT-MMYY-INPUT.
   380         16  FILLER              PIC X.
   381         16  DEEDIT-MONTH        PIC XX.
   382         16  DEEDIT-YEAR         PIC XX.
   383     12  DEEDIT-BEN              PIC 9(9)V99.
   384     12  DEEDIT-DATE-INPUT.
   385         16  FILLER              PIC XX.
   386         16  DEEDIT-DATE         PIC X(6).
   387     12  WORK-DATE-MDY.
   388         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  10
* EL131.cbl
   389         16  FILLER              PIC X(4).
   390         16  YEAR-WORK           PIC XX.
   391     12  WORK-DATE-MY.
   392         16  WORK-MONTH          PIC XX.
   393         16  WORK-SLASH          PIC X       VALUE '/'.
   394         16  WORK-YEAR           PIC XX.
   395     12  HOLD-DATE.
   396         16  HOLD-MONTH          PIC 99.
   397         16  FILLER              PIC X(4).
   398         16  HOLD-YEAR           PIC 99.
   399     12  SPLIT-INFO-LINE-1.
   400         16  SPLIT-INFO-DESC     PIC X(15).
   401         16  FILLER              PIC X(5)    VALUE ' OLD='.
   402         16  SPLIT-INFO-OLD      PIC X(40).
   403     12  EFF-TERM-MO             PIC 9(4).
   404     12  CURR-MO                 PIC 9(4).
   405     12  WS-BIN-CURRENT-DT       PIC XX.
   406     12  WS-CALC-METHOD          PIC X.
   407     12  WS-INITIALS.
   408         16  WS-INIT-1           PIC X.
   409         16  WS-INIT-2           PIC X.
   410     12  WS-REIN-TABLE.
   411         16  WS-REIN-1           PIC X.
   412         16  WS-REIN-2           PIC X.
   413         16  WS-REIN-3           PIC X.
   414     12  PI-KEY.
   415         16  PI-TERM             PIC X(4).
   416         16  PI-QUAL             PIC X(4).
   417     12  CHECK-KEY               PIC X(20).
   418     12  SAVE-ACCT-KEY           PIC X(20).
   419     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   420     12  WS-SOC-SEC-NUMBER.
   421         16  WS-SOC-SEC-NO       PIC 9(9).
   422         16  WS-SOC-SEC-BLANK    PIC X(2).
   423     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   424         16  WS-SSN-1-3          PIC 9(3).
   425         16  WS-SSN-DASH1        PIC X(1).
   426         16  WS-SSN-4-5          PIC 9(2).
   427         16  WS-SSN-DASH2        PIC X(1).
   428         16  WS-SSN-6-9          PIC 9(4).
   429     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   430     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   431
   432 01  WS-SAVE-FIELDS.
   433     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   434     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   435     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   436     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   437     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   438     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   439     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   440     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   441     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   442     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   443     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   444     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   445     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   446     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  11
* EL131.cbl
   447     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   448     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   449     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   450     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   451     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   452     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   453     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   454     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   455     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   456     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   457     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   458     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   459     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   460     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   461     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   462     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   463     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   464     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   465     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   466     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   467     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   468     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   469     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   470     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   471     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   472     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   473     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   474     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   475     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   477     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   479     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   481     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   483     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   485     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   487     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   488
   489 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   490     12  M                   PIC S9(7)V99           VALUE ZEROS.
   491     12  L                   PIC S9(7)V99           VALUE ZEROS.
   492     12  N                   PIC S9(3)              VALUE ZEROS.
   493     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   494     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   495     12  I                   PIC S99V9(5)           VALUE ZEROS.
   496     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   497     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   498     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   499     12  R                   PIC S9(3)              VALUE ZEROS.
   500     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   501     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   502     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   503     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   504     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  12
* EL131.cbl
   505     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   506     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   507     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   508     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   509
   510 01  TERM-CALC-WORK-AREA.
   511     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   512     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   513     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   514     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   515     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   516     12  V-EXPONENTS.
   517        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   518     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   519
   520 01  TIME-IN.
   521     12  UN-HOURS                PIC XX.
   522     12  UN-MINUTES              PIC XX.
   523     12  FILLER                  PIC XX.
   524
   525 01  TIME-OUT.
   526     12  FOR-HOURS               PIC XX.
   527     12  FILLER                  PIC X       VALUE '.'.
   528     12  FOR-MINUTES             PIC XX.
   529
   530 01  ERROR-NUMBERS.
   531     12  ER-0000                 PIC X(4)    VALUE '0000'.
   532     12  ER-0004                 PIC X(4)    VALUE '0004'.
   533     12  ER-0008                 PIC X(4)    VALUE '0008'.
   534     12  ER-0023                 PIC X(4)    VALUE '0023'.
   535     12  ER-0029                 PIC X(4)    VALUE '0029'.
   536     12  ER-0068                 PIC X(4)    VALUE '0068'.
   537     12  ER-0070                 PIC X(4)    VALUE '0070'.
   538     12  ER-0149                 PIC X(4)    VALUE '0149'.
   539     12  ER-0154                 PIC X(4)    VALUE '0154'.
   540     12  ER-0169                 PIC X(4)    VALUE '0169'.
   541     12  ER-0192                 PIC X(4)    VALUE '0192'.
   542     12  ER-0199                 PIC X(4)    VALUE '0199'.
   543     12  ER-0203                 PIC X(4)    VALUE '0203'.
   544     12  ER-0204                 PIC X(4)    VALUE '0204'.
   545     12  ER-0205                 PIC X(4)    VALUE '0205'.
   546     12  ER-0206                 PIC X(4)    VALUE '0206'.
   547     12  ER-0208                 PIC X(4)    VALUE '0208'.
   548     12  ER-0210                 PIC X(4)    VALUE '0210'.
   549     12  ER-0215                 PIC X(4)    VALUE '0215'.
   550     12  ER-0219                 PIC X(4)    VALUE '0219'.
   551     12  ER-0220                 PIC X(4)    VALUE '0220'.
   552     12  ER-0222                 PIC X(4)    VALUE '0222'.
   553     12  ER-0223                 PIC X(4)    VALUE '0223'.
   554     12  ER-0224                 PIC X(4)    VALUE '0224'.
   555     12  ER-0227                 PIC X(4)    VALUE '0227'.
   556     12  ER-0230                 PIC X(4)    VALUE '0230'.
   557     12  ER-0232                 PIC X(4)    VALUE '0232'.
   558     12  ER-0233                 PIC X(4)    VALUE '0233'.
   559     12  ER-0236                 PIC X(4)    VALUE '0236'.
   560     12  ER-0237                 PIC X(4)    VALUE '0237'.
   561     12  ER-0238                 PIC X(4)    VALUE '0238'.
   562     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  13
* EL131.cbl
   563     12  ER-0241                 PIC X(4)    VALUE '0241'.
   564     12  ER-0243                 PIC X(4)    VALUE '0243'.
   565     12  ER-0244                 PIC X(4)    VALUE '0244'.
   566     12  ER-0246                 PIC X(4)    VALUE '0246'.
   567     12  ER-0247                 PIC X(4)    VALUE '0247'.
   568     12  ER-0248                 PIC X(4)    VALUE '0248'.
   569     12  ER-0250                 PIC X(4)    VALUE '0250'.
   570     12  ER-0251                 PIC X(4)    VALUE '0251'.
   571     12  ER-0253                 PIC X(4)    VALUE '0253'.
   572     12  ER-0256                 PIC X(4)    VALUE '0256'.
   573     12  ER-0257                 PIC X(4)    VALUE '0257'.
   574     12  ER-0258                 PIC X(4)    VALUE '0258'.
   575     12  ER-0259                 PIC X(4)    VALUE '0259'.
   576     12  ER-0260                 PIC X(4)    VALUE '0260'.
   577     12  ER-0261                 PIC X(4)    VALUE '0261'.
   578     12  ER-0262                 PIC X(4)    VALUE '0262'.
   579     12  ER-0263                 PIC X(4)    VALUE '0263'.
   580     12  ER-0273                 PIC X(4)    VALUE '0273'.
   581     12  ER-0274                 PIC X(4)    VALUE '0274'.
   582     12  ER-0276                 PIC X(4)    VALUE '0276'.
   583     12  ER-0282                 PIC X(4)    VALUE '0282'.
   584     12  ER-0283                 PIC X(4)    VALUE '0283'.
   585     12  ER-0309                 PIC X(4)    VALUE '0309'.
   586     12  ER-0310                 PIC X(4)    VALUE '0310'.
   587     12  ER-0311                 PIC X(4)    VALUE '0311'.
   588     12  ER-0333                 PIC X(4)    VALUE '0333'.
   589     12  ER-0360                 PIC X(4)    VALUE '0360'.
   590     12  ER-0377                 PIC X(4)    VALUE '0377'.
   591     12  ER-0402                 PIC X(4)    VALUE '0402'.
   592     12  ER-0416                 PIC X(4)    VALUE '0416'.
   593     12  ER-0426                 PIC X(4)    VALUE '0426'.
   594     12  ER-0427                 PIC X(4)    VALUE '0427'.
   595     12  ER-0428                 PIC X(4)    VALUE '0428'.
   596     12  ER-0429                 PIC X(4)    VALUE '0429'.
   597     12  ER-0430                 PIC X(4)    VALUE '0430'.
   598     12  ER-0458                 PIC X(4)    VALUE '0458'.
   599     12  ER-0475                 PIC X(4)    VALUE '0475'.
   600     12  ER-0491                 PIC X(4)    VALUE '0491'.
   601     12  ER-0509                 PIC X(4)    VALUE '0509'.
   602     12  ER-0510                 PIC X(4)    VALUE '0510'.
   603     12  ER-0511                 PIC X(4)    VALUE '0511'.
   604     12  ER-0512                 PIC X(4)    VALUE '0512'.
   605     12  ER-0519                 PIC X(4)    VALUE '0519'.
   606     12  ER-0520                 PIC X(4)    VALUE '0520'.
   607     12  ER-0521                 PIC X(4)    VALUE '0521'.
   608     12  ER-0547                 PIC X(4)    VALUE '0547'.
   609     12  ER-0548                 PIC X(4)    VALUE '0548'.
   610     12  ER-0549                 PIC X(4)    VALUE '0549'.
   611     12  ER-0565                 PIC X(4)    VALUE '0565'.
   612     12  ER-0598                 PIC X(4)    VALUE '0598'.
   613     12  ER-0639                 PIC X(4)    VALUE '0639'.
   614     12  ER-0797                 PIC X(4)    VALUE '0797'.
   615     12  ER-0802                 PIC X(4)    VALUE '0802'.
   616     12  ER-0803                 PIC X(4)    VALUE '0803'.
   617     12  ER-0849                 PIC X(4)    VALUE '0849'.
   618     12  ER-0885                 PIC X(4)    VALUE '0885'.
   619     12  ER-0887                 PIC X(4)    VALUE '0887'.
   620     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  14
* EL131.cbl
   621     12  ER-0921                 PIC X(4)    VALUE '0921'.
   622     12  ER-0938                 PIC X(4)    VALUE '0938'.
   623     12  ER-0946                 PIC X(4)    VALUE '0946'.
   624     12  ER-0947                 PIC X(4)    VALUE '0947'.
   625     12  ER-0948                 PIC X(4)    VALUE '0948'.
   626     12  ER-0949                 PIC X(4)    VALUE '0949'.
   627     12  ER-0950                 PIC X(4)    VALUE '0950'.
   628     12  ER-0951                 PIC X(4)    VALUE '0951'.
   629     12  ER-0954                 PIC X(4)    VALUE '0954'.
   630     12  ER-0974                 PIC X(4)    VALUE '0974'.
   631     12  ER-0975                 PIC X(4)    VALUE '0975'.
   632     12  ER-0992                 PIC X(4)    VALUE '0992'.
   633     12  ER-1651                 PIC X(4)    VALUE '1651'.
   634     12  ER-1652                 PIC X(4)    VALUE '1652'.
   635     12  ER-1653                 PIC X(4)    VALUE '1653'.
   636     12  ER-1654                 PIC X(4)    VALUE '1654'.
   637     12  ER-1655                 PIC X(4)    VALUE '1655'.
   638     12  er-1656                 pic x(4)    value '1656'.
   639     12  ER-1661                 PIC X(4)    VALUE '1661'.
   640     12  ER-1662                 PIC X(4)    VALUE '1662'.
   641     12  ER-1663                 PIC X(4)    VALUE '1663'.
   642     12  ER-1773                 PIC X(4)    VALUE '1773'.
   643     12  ER-2280                 PIC X(4)    VALUE '2280'.
   644     12  ER-2878                 PIC X(4)    VALUE '2878'.
   645     12  ER-7641                 PIC X(4)    VALUE '7641'.
   646     12  ER-7642                 PIC X(4)    VALUE '7642'.
   647     12  ER-7650                 PIC X(4)    VALUE '7650'.
   648     12  ER-7651                 PIC X(4)    VALUE '7651'.
   649     12  ER-7687                 PIC X(4)    VALUE '7687'.
   650     12  ER-7689                 PIC X(4)    VALUE '7689'.
   651     12  ER-7690                 PIC X(4)    VALUE '7690'.
   652     12  ER-7691                 PIC X(4)    VALUE '7691'.
   653     12  ER-8003                 PIC X(4)    VALUE '8003'.
   654     12  ER-8051                 PIC X(4)    VALUE '8051'.
   655     12  ER-8052                 PIC X(4)    VALUE '8052'.
   656     12  ER-8053                 PIC X(4)    VALUE '8053'.
   657     12  ER-8054                 PIC X(4)    VALUE '8054'.
   658     12  ER-8055                 PIC X(4)    VALUE '8055'.
   659     12  ER-8056                 PIC X(4)    VALUE '8056'.
   660     12  ER-8057                 PIC X(4)    VALUE '8057'.
   661     12  ER-8058                 PIC X(4)    VALUE '8058'.
   662     12  ER-8059                 PIC X(4)    VALUE '8059'.
   663     12  ER-8060                 PIC X(4)    VALUE '8060'.
   664     12  ER-8061                 PIC X(4)    VALUE '8061'.
   665     12  ER-8062                 PIC X(4)    VALUE '8062'.
   666     12  ER-8063                 PIC X(4)    VALUE '8063'.
   667     12  ER-8064                 PIC X(4)    VALUE '8064'.
   668     12  ER-8065                 PIC X(4)    VALUE '8065'.
   669     12  ER-8066                 PIC X(4)    VALUE '8066'.
   670     12  ER-8152                 PIC X(4)    VALUE '8152'.
   671     12  ER-8153                 PIC X(4)    VALUE '8153'.
   672     12  ER-8154                 PIC X(4)    VALUE '8154'.
   673     12  ER-8155                 PIC X(4)    VALUE '8155'.
   674 01  ERPDEF-KEY-SAVE             PIC X(18).
   675 01  ERPDEF-KEY.
   676     12  ERPDEF-COMPANY-CD       PIC X.
   677     12  ERPDEF-STATE            PIC XX.
   678     12  ERPDEF-PROD-CD          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  15
* EL131.cbl
   679     12  F                       PIC X(7).
   680     12  ERPDEF-BEN-TYPE         PIC X.
   681     12  ERPDEF-BEN-CODE         PIC XX.
   682     12  ERPDEF-EXP-DT           PIC XX.
   683 01  MSTR-KEY.
   684     12  COMPANY-CODE            PIC X.
   685     12  CARRIER-CODE            PIC X.
   686     12  CLAIM-NO                PIC X(7).
   687     12  CERT-NO.
   688         16  CERT-NO-PRIME       PIC X(10).
   689         16  CERT-NO-SUFX        PIC X.
   690
   691 01  WS-SAVE-CLAIM-KEY.
   692     12  WS-SAVE-COMPANY-CD      PIC X.
   693     12  WS-SAVE-CARRIER         PIC X.
   694     12  WS-SAVE-CLAIM-NO        PIC X(7).
   695     12  WS-SAVE-CERT-NO.
   696         16  WS-CERT-NO-PRIME    PIC X(10).
   697         16  WS-CERT-NO-SUFX     PIC X.
   698
   699 01  CERT-KEY.
   700     12  CERT-COMPANY-CODE       PIC X.
   701     12  CERT-CARRIER            PIC X.
   702     12  CERT-GROUP              PIC X(6).
   703     12  CERT-STATE              PIC XX.
   704     12  CERT-ACCOUNT            PIC X(10).
   705     12  CERT-DATE               PIC XX.
   706     12  CERT-CERT.
   707         16  CERT-CERT-PRIME     PIC X(10).
   708         16  CERT-CERT-SUFX      PIC X.
   709
   710 01  ELCRTT-KEY.
   711     05  CTRLR-COMP-CD       PIC X.
   712     05  CTRLR-CARRIER       PIC X.
   713     05  CTRLR-GROUPING      PIC X(6).
   714     05  CTRLR-STATE         PIC X(2).
   715     05  CTRLR-ACCOUNT       PIC X(10).
   716     05  CTRLR-EFF-DT        PIC XX.
   717     05  CTRLR-CERT-NO       PIC X(11).
   718     05  CTRLR-REC-TYPE      PIC X.
   719 01  NOTE-KEY.
   720     12  NOTE-COMP-CD            PIC X.
   721     12  NOTE-CERT-KEY.
   722         16  NOTE-CARRIER        PIC X.
   723         16  NOTE-GROUP          PIC X(6).
   724         16  NOTE-STATE          PIC XX.
   725         16  NOTE-ACCOUNT        PIC X(10).
   726         16  NOTE-DATE           PIC XX.
   727         16  NOTE-CERT-NO        PIC X(11).
   728
   729 01  TRLR-KEY.
   730     12  TRLR-MAIN-KEY.
   731         16  TRLR-COMPANY-CD     PIC X.
   732         16  TRLR-CARRIER        PIC X.
   733         16  TRLR-CLAIM-NO       PIC X(07).
   734         16  TRLR-CERT-NO        PIC X(11).
   735     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   736
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  16
* EL131.cbl
   737 01  BENEFIT-KEY.
   738     12  BEN-CO-ID               PIC X(3).
   739     12  BEN-REC-TYPE            PIC X.
   740     12  FILLER                  PIC XX.
   741     12  BEN-ACC-CD              PIC XX.
   742     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   743
   744 01  CNTL-KEY.
   745     12  CNTL-CO-ID              PIC X(3).
   746     12  CNTL-REC-TYPE           PIC X.
   747     12  CNTL-PROC-ID            PIC X(4).
   748     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   749         16  CNTL-STATE-NUMBER   PIC XX.
   750         16  FILLER              PIC XX.
   751     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   752         16  FILLER              PIC X(3).
   753         16  CNTL-CARRIER        PIC X.
   754     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   755
   756 01  ACTQ-KEY                    PIC X(20).
   757
   758 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   759
   760 01  CHKQ-KEY.
   761     12  CHKQ-COMPANY-CODE       PIC X.
   762     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   763     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   764
   765 01  ARCH-KEY.
   766     12  ARCH-COMPANY-CODE       PIC X.
   767     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   768     12  ARCH-RECORD-TYPE        PIC X.
   769     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   770
   771 01  ACCT-KEY.
   772     05  ACCT-PARTIAL-KEY.
   773         12  ACCT-COMPANY-CODE   PIC X.
   774         12  ACCT-CARRIER        PIC X.
   775         12  ACCT-GROUP          PIC X(6).
   776         12  ACCT-STATE          PIC XX.
   777         12  ACCT-ACCOUNT        PIC X(10).
   778     05  ACCT-DATE               PIC XX.
   779
   780 01  WS-ELBENE-KEY.
   781     12  WS-ELBENE-COMPANY-CD    PIC X.
   782     12  WS-ELBENE-RECORD-TYPE   PIC X.
   783     12  WS-ELBENE-ID            PIC X(10).
   784
   785 01  ELALPH-KEY.
   786     12  ELALPH-COMPANY-CD       PIC X.
   787     12  ELALPH-SOURCE           PIC X.
   788     12  ELALPH-NAME.
   789         16  ELALPH-LAST-NAME    PIC X(15).
   790         16  ELALPH-FIRST-NAME.
   791             20  ELALPH-FIRST-INIT   PIC X.
   792             20  FILLER              PIC X(11).
   793         16  ELALPH-MIDDLE-INIT  PIC X.
   794     12  ELALPH-DATE             PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  17
* EL131.cbl
   795     12  ELALPH-TIME             PIC S9(04)    COMP.
   796
   797 01  COMP-LENGTHS.
   798     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   799     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   800     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   801     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   802     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   803     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   804     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   805     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   806     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   807     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   808     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   809     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   810     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   811     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  18
* EL131.cbl
   813*                                COPY ELCLNKLT.
   814******************************************************************
   815*                                                                *
   816*                                                                *
   817*                           ELCLNKLT                             *
   818*                            VMOD=2.003                          *
   819*                                                                *
   820*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   821*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   822*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   823*                                                                *
   824*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   825*   COMPLETING THE REQUIRED FIELDS.                              *
   826*                                                                *
   827*   THE CALLING PROGRAM SHOULD CHECK:                            *
   828*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   829*                              9999 INDICATES AN UNKNOWN ABEND   *
   830*                                   WAS DETECTED.                *
   831*                              ALL OTHER VALUES ARE NORMAL ERROR *
   832*                              CODES FOUND IN THE ERROR FILE.    *
   833******************************************************************
   834 01  W-1523-LINKDATA.
   835     12  W-1523-COMMON-PI-DATA.
   836         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   837         16  FILLER              PIC  X(67).
   838         16  W-1523-COMPANY-CD   PIC  X(01).
   839         16  FILLER              PIC  X(10).
   840         16  W-1523-CONTROL-IN-PROGRESS.
   841             20  W-1523-CARRIER  PIC  X(01).
   842             20  W-1523-GROUPING PIC  X(06).
   843             20  W-1523-STATE    PIC  X(02).
   844             20  W-1523-ACCOUNT  PIC  X(10).
   845             20  W-1523-CLAIM-CERT-GRP.
   846                 24  W-1523-CLAIM-NO
   847                                 PIC  X(07).
   848                 24  W-1523-CERT-NO.
   849                     28  W-1523-CERT-PRIME
   850                                 PIC  X(10).
   851                     28  W-1523-CERT-SFX
   852                                 PIC  X(01).
   853                 24  W-1523-CERT-EFF-DT
   854                                 PIC  X(02).
   855         16  FILLER              PIC X(265).
   856
   857     12  W-1523-WORK-AREA.
   858         16  W-1523-FORM-NUMBER  PIC  X(04).
   859         16  W-1523-NUMBER-COPIES
   860                                 PIC  9(01).
   861         16  W-1523-ADDR-TYPE    PIC  X(02).
   862         16  W-1523-FOLLOW-UP-DATE
   863                                 PIC  X(02).
   864         16  W-1523-RESEND-DATE  PIC  X(02).
   865         16  W-1523-ERROR-CODE   PIC  9(04).
   866             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   867             88  W-1523-FATAL-ERROR
   868                                    VALUES  0006 0013 0042
   869                                            0154 0168 0169
   870                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  19
* EL131.cbl
   871                                            0179 0186 0281
   872                                            0332 2055 3697
   873                                            3698 3699 3770
   874                                            3771 3772 7675
   875                                            9106 9808 9883
   876                                            9887.
   877             88  W-1523-STOP-ERRORS
   878                                    VALUES  0013 0042 0154
   879                                            0168 0169 0172
   880                                            0281 0332 2055
   881                                            3698 3699 7675
   882                                            9106 9808 9883
   883                                            9999.
   884         16  W-1523-REASON       PIC  X(70).
   885         16  W-1523-ARCHIVE-NUMBER
   886                                 PIC  9(08).
   887     12  W-1523-POINTER-AREA.
   888         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   889         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   890         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   891         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   892         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  20
* EL131.cbl
   894*                                COPY ELCINTF.
   895******************************************************************
   896*                                                                *
   897*                                                                *
   898*                            ELCINTF.                            *
   899*                            VMOD=2.017                          *
   900*                                                                *
   901*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   902*                                                                *
   903*       LENGTH = 1024                                            *
   904*                                                                *
   905******************************************************************
   906*                   C H A N G E   L O G
   907*
   908* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   909*-----------------------------------------------------------------
   910*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   911* EFFECTIVE    NUMBER
   912*-----------------------------------------------------------------
   913* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   914******************************************************************
   915 01  PROGRAM-INTERFACE-BLOCK.
   916     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   917     12  PI-CALLING-PROGRAM              PIC X(8).
   918     12  PI-SAVED-PROGRAM-1              PIC X(8).
   919     12  PI-SAVED-PROGRAM-2              PIC X(8).
   920     12  PI-SAVED-PROGRAM-3              PIC X(8).
   921     12  PI-SAVED-PROGRAM-4              PIC X(8).
   922     12  PI-SAVED-PROGRAM-5              PIC X(8).
   923     12  PI-SAVED-PROGRAM-6              PIC X(8).
   924     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   925     12  PI-COMPANY-ID                   PIC XXX.
   926     12  PI-COMPANY-CD                   PIC X.
   927
   928     12  PI-COMPANY-PASSWORD             PIC X(8).
   929
   930     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   931
   932     12  PI-CONTROL-IN-PROGRESS.
   933         16  PI-CARRIER                  PIC X.
   934         16  PI-GROUPING                 PIC X(6).
   935         16  PI-STATE                    PIC XX.
   936         16  PI-ACCOUNT                  PIC X(10).
   937         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   938                                         PIC X(10).
   939         16  PI-CLAIM-CERT-GRP.
   940             20  PI-CLAIM-NO             PIC X(7).
   941             20  PI-CERT-NO.
   942                 25  PI-CERT-PRIME       PIC X(10).
   943                 25  PI-CERT-SFX         PIC X.
   944             20  PI-CERT-EFF-DT          PIC XX.
   945         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   946             20  PI-PLAN-CODE            PIC X(2).
   947             20  PI-REVISION-NUMBER      PIC X(3).
   948             20  PI-PLAN-EFF-DT          PIC X(2).
   949             20  PI-PLAN-EXP-DT          PIC X(2).
   950             20  FILLER                  PIC X(11).
   951         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  21
* EL131.cbl
   952             20  PI-OE-REFERENCE-1.
   953                 25  PI-OE-REF-1-PRIME   PIC X(18).
   954                 25  PI-OE-REF-1-SUFF    PIC XX.
   955
   956     12  PI-SESSION-IN-PROGRESS          PIC X.
   957         88  CLAIM-SESSION                   VALUE '1'.
   958         88  CREDIT-SESSION                  VALUE '2'.
   959         88  WARRANTY-SESSION                VALUE '3'.
   960         88  MORTGAGE-SESSION                VALUE '4'.
   961         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   962
   963
   964*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   965
   966     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   967     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   968
   969     12  PI-CREDIT-USER                  PIC X.
   970         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   971         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   972
   973     12  PI-CLAIM-USER                   PIC X.
   974         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   975         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   976
   977     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   978         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   979         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   980         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   981         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   982         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   983
   984     12  PI-PROCESSOR-ID                 PIC X(4).
   985
   986     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   987
   988     12  PI-MEMBER-CAPTION               PIC X(10).
   989
   990     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   991         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   992
   993     12  PI-LIFE-OVERRIDE-L1             PIC X.
   994     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   995     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   996     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   997
   998     12  PI-AH-OVERRIDE-L1               PIC X.
   999     12  PI-AH-OVERRIDE-L2               PIC XX.
  1000     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1001     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1002
  1003     12  PI-NEW-SYSTEM                   PIC X(2).
  1004
  1005     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1006     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1007         88  PI-USES-PAID-TO                 VALUE '1'.
  1008     12  PI-CRDTCRD-SYSTEM.
  1009         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  22
* EL131.cbl
  1010             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1011             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1012         16  PI-CC-MONTH-END-DT          PIC XX.
  1013     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1014
  1015     12  PI-OE-REFERENCE-2.
  1016         16  PI-OE-REF-2-PRIME           PIC X(10).
  1017         16  PI-OE-REF-2-SUFF            PIC X.
  1018
  1019     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1020
  1021     12  PI-LANGUAGE-TYPE                PIC X.
  1022             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1023             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1024             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1025
  1026     12  PI-POLICY-LINKAGE-IND           PIC X.
  1027         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1028         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1029                                                   LOW-VALUES.
  1030
  1031     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1032     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1033         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1034         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1035
  1036     12  PI-PROCESSOR-CSR-IND            PIC X.
  1037         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1038         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1039
  1040     12  FILLER                          PIC X(3).
  1041
  1042     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1043
  1044     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1045         PI-SYSTEM-LEVEL.
  1046
  1047         16  PI-ENTRY-CODES.
  1048             20  PI-ENTRY-CD-1           PIC X.
  1049             20  PI-ENTRY-CD-2           PIC X.
  1050
  1051         16  PI-RETURN-CODES.
  1052             20  PI-RETURN-CD-1          PIC X.
  1053             20  PI-RETURN-CD-2          PIC X.
  1054
  1055         16  PI-UPDATE-STATUS-SAVE.
  1056             20  PI-UPDATE-BY            PIC X(4).
  1057             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1058
  1059         16  PI-LOWER-CASE-LETTERS       PIC X.
  1060             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1061
  1062*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1063*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1064*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1065
  1066         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1067             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  23
* EL131.cbl
  1068             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1069             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1070             88  ACCNT-CNTL                  VALUE '3'.
  1071             88  CARR-ACCNT-CNTL             VALUE '4'.
  1072
  1073         16  PI-PROCESSOR-CAP-LIST.
  1074             20  PI-SYSTEM-CONTROLS.
  1075                24 PI-SYSTEM-DISPLAY     PIC X.
  1076                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1077                24 PI-SYSTEM-MODIFY      PIC X.
  1078                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1079             20  FILLER                  PIC XX.
  1080             20  PI-DISPLAY-CAP          PIC X.
  1081                 88  DISPLAY-CAP             VALUE 'Y'.
  1082             20  PI-MODIFY-CAP           PIC X.
  1083                 88  MODIFY-CAP              VALUE 'Y'.
  1084             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1085                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1086             20  PI-FORCE-CAP            PIC X.
  1087                 88  FORCE-CAP               VALUE 'Y'.
  1088
  1089         16  PI-PROGRAM-CONTROLS.
  1090             20  PI-PGM-PRINT-OPT        PIC X.
  1091             20  PI-PGM-FORMAT-OPT       PIC X.
  1092             20  PI-PGM-PROCESS-OPT      PIC X.
  1093             20  PI-PGM-TOTALS-OPT       PIC X.
  1094
  1095         16  PI-HELP-INTERFACE.
  1096             20  PI-LAST-ERROR-NO        PIC X(4).
  1097             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1098
  1099         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1100             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1101
  1102         16  PI-CR-CONTROL-IN-PROGRESS.
  1103             20  PI-CR-CARRIER           PIC X.
  1104             20  PI-CR-GROUPING          PIC X(6).
  1105             20  PI-CR-STATE             PIC XX.
  1106             20  PI-CR-ACCOUNT           PIC X(10).
  1107             20  PI-CR-FIN-RESP          PIC X(10).
  1108             20  PI-CR-TYPE              PIC X.
  1109
  1110         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1111
  1112         16  PI-CR-MONTH-END-DT          PIC XX.
  1113
  1114         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1115             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1116             88  PI-ZERO-CARRIER             VALUE '1'.
  1117             88  PI-ZERO-GROUPING            VALUE '2'.
  1118             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1119
  1120         16  PI-CARRIER-SECURITY         PIC X.
  1121             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1122
  1123         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1124             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1125             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  24
* EL131.cbl
  1126
  1127         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1128             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1129                                         INDEXED BY PI-ACCESS-NDX
  1130                                         PIC X.
  1131
  1132         16  PI-GA-BILLING-CONTROL       PIC X.
  1133             88  PI-GA-BILLING               VALUE '1'.
  1134
  1135         16  PI-MAIL-PROCESSING          PIC X.
  1136             88  PI-MAIL-YES                 VALUE 'Y'.
  1137
  1138         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1139
  1140         16  PI-AR-SYSTEM.
  1141             20  PI-AR-PROCESSING-CNTL   PIC X.
  1142                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1143             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1144             20  PI-AR-MONTH-END-DT      PIC XX.
  1145
  1146         16  PI-MP-SYSTEM.
  1147             20  PI-MORTGAGE-USER            PIC X.
  1148                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1149                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1150             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1151                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1152                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1153                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1154                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1155                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1156             20  PI-MP-MONTH-END-DT          PIC XX.
  1157             20  PI-MP-REFERENCE-NO.
  1158                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1159                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1160
  1161         16  PI-LABEL-CONTROL            PIC X(01).
  1162             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1163             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1164
  1165         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1166             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1167
  1168         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1169             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1170             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1171
  1172         16  FILLER                      PIC X(14).
  1173
  1174     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1175******************************************************************
  1176     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1177         16  PI-NO-PMTS                    PIC 9(4).
  1178         16  PI-CERT-SWITCH                PIC X.
  1179             88  CREATED-CERT              VALUE '2'.
  1180         16  PI-PREM-TYPE                  PIC X.
  1181         16  PI-SAVE-CERT-NO.
  1182             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1183             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  25
* EL131.cbl
  1184         16  FILLER                        PIC X(46).
  1185         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1186         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1187         16  PI-REC-FOUND-SW               PIC X.
  1188         16  PI-LETTER-SW                  PIC X.
  1189         16  PI-PREV-TRLR-KEY              PIC X(22).
  1190         16  pi-claim-type                 pic x.
  1191         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1192         16  pi-approval-level             pic x.
  1193         16  FILLER                        PIC X(543).
  1194
  1195 01  SAVE-RECORD                 PIC X(450).
  1196
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  26
* EL131.cbl
  1198*                                COPY ELCLOGOF SUPPRESS.
  1199******************************************************************
  1200*                                                                *
  1201*                                                                *
  1202*                            ELCLOGOF.                           *
  1203*                            VMOD=2.001                          *
  1204*                                                                *
  1205*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1206*                                                                *
  1207******************************************************************
  1208 01  CLASIC-LOGOFF.
  1209     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1210     12  LOGOFF-TEXT.
  1211         16  FILLER          PIC X(5)    VALUE SPACES.
  1212         16  LOGOFF-MSG.
  1213             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1214             20  FILLER      PIC X       VALUE SPACES.
  1215             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1216         16  FILLER          PIC X(80)
  1217           VALUE '* YOU ARE NOW LOGGED OFF'.
  1218         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1219         16  FILLER          PIC X       VALUE QUOTE.
  1220         16  LOGOFF-SYS-MSG  PIC X(17)
  1221           VALUE 'S CLAS-IC SYSTEM '.
  1222     12  TEXT-MESSAGES.
  1223         16  UNACCESS-MSG    PIC X(29)
  1224             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1225         16  PGMIDERR-MSG    PIC X(17)
  1226             VALUE 'PROGRAM NOT FOUND'.
  1227
  1228*                                COPY ELCATTR SUPPRESS.
  1229******************************************************************
  1230*                                                                *
  1231*                            ELCATTR.                            *
  1232*                            VMOD=2.001                          *
  1233*                                                                *
  1234*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1235*                                                                *
  1236*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1237*                                                                *
  1238*                   POS 1   P=PROTECTED                          *
  1239*                           U=UNPROTECTED                        *
  1240*                           S=ASKIP                              *
  1241*                   POS 2   A=ALPHA/NUMERIC                      *
  1242*                           N=NUMERIC                            *
  1243*                   POS 3   N=NORMAL                             *
  1244*                           B=BRIGHT                             *
  1245*                           D=DARK                               *
  1246*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1247*                           OF=MODIFIED DATA TAG OFF             *
  1248*                                                                *
  1249*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1250******************************************************************
  1251 01  ATTRIBUTE-LIST.
  1252     12  AL-PABOF            PIC X       VALUE 'Y'.
  1253     12  AL-PABON            PIC X       VALUE 'Z'.
  1254     12  AL-PADOF            PIC X       VALUE '%'.
  1255     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  27
* EL131.cbl
  1256     12  AL-PANOF            PIC X       VALUE '-'.
  1257     12  AL-PANON            PIC X       VALUE '/'.
  1258     12  AL-SABOF            PIC X       VALUE '8'.
  1259     12  AL-SABON            PIC X       VALUE '9'.
  1260     12  AL-SADOF            PIC X       VALUE '@'.
  1261     12  AL-SADON            PIC X       VALUE QUOTE.
  1262     12  AL-SANOF            PIC X       VALUE '0'.
  1263     12  AL-SANON            PIC X       VALUE '1'.
  1264     12  AL-UABOF            PIC X       VALUE 'H'.
  1265     12  AL-UABON            PIC X       VALUE 'I'.
  1266     12  AL-UADOF            PIC X       VALUE '<'.
  1267     12  AL-UADON            PIC X       VALUE '('.
  1268     12  AL-UANOF            PIC X       VALUE ' '.
  1269     12  AL-UANON            PIC X       VALUE 'A'.
  1270     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1271     12  AL-UNBON            PIC X       VALUE 'R'.
  1272     12  AL-UNDOF            PIC X       VALUE '*'.
  1273     12  AL-UNDON            PIC X       VALUE ')'.
  1274     12  AL-UNNOF            PIC X       VALUE '&'.
  1275     12  AL-UNNON            PIC X       VALUE 'J'.
  1276
  1277*                                COPY ELCAID SUPPRESS.
  1278******************************************************************
  1279*                                                                *
  1280*                            ELCAID.                             *
  1281*                            VMOD=2.001                          *
  1282*                                                                *
  1283*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1284*                                                                *
  1285*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1286*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1287******************************************************************
  1288
  1289 01  DFHAID.
  1290   02  DFHNULL   PIC  X  VALUE  ' '.
  1291   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1292   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1293   02  DFHPEN    PIC  X  VALUE  '='.
  1294   02  DFHOPID   PIC  X  VALUE  'W'.
  1295   02  DFHPA1    PIC  X  VALUE  '%'.
  1296   02  DFHPA2    PIC  X  VALUE  '>'.
  1297   02  DFHPA3    PIC  X  VALUE  ','.
  1298   02  DFHPF1    PIC  X  VALUE  '1'.
  1299   02  DFHPF2    PIC  X  VALUE  '2'.
  1300   02  DFHPF3    PIC  X  VALUE  '3'.
  1301   02  DFHPF4    PIC  X  VALUE  '4'.
  1302   02  DFHPF5    PIC  X  VALUE  '5'.
  1303   02  DFHPF6    PIC  X  VALUE  '6'.
  1304   02  DFHPF7    PIC  X  VALUE  '7'.
  1305   02  DFHPF8    PIC  X  VALUE  '8'.
  1306   02  DFHPF9    PIC  X  VALUE  '9'.
  1307   02  DFHPF10   PIC  X  VALUE  ':'.
  1308   02  DFHPF11   PIC  X  VALUE  '#'.
  1309   02  DFHPF12   PIC  X  VALUE  '@'.
  1310   02  DFHPF13   PIC  X  VALUE  'A'.
  1311   02  DFHPF14   PIC  X  VALUE  'B'.
  1312   02  DFHPF15   PIC  X  VALUE  'C'.
  1313   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  28
* EL131.cbl
  1314   02  DFHPF17   PIC  X  VALUE  'E'.
  1315   02  DFHPF18   PIC  X  VALUE  'F'.
  1316   02  DFHPF19   PIC  X  VALUE  'G'.
  1317   02  DFHPF20   PIC  X  VALUE  'H'.
  1318   02  DFHPF21   PIC  X  VALUE  'I'.
  1319*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1320   02  DFHPF22   PIC  X  VALUE  '['.
  1321   02  DFHPF23   PIC  X  VALUE  '.'.
  1322   02  DFHPF24   PIC  X  VALUE  '<'.
  1323   02  DFHMSRE   PIC  X  VALUE  'X'.
  1324   02  DFHSTRF   PIC  X  VALUE  'h'.
  1325   02  DFHTRIG   PIC  X  VALUE  '"'.
  1326 01  FILLER REDEFINES DFHAID.
  1327     12  FILLER                  PIC X(8).
  1328     12  AID-KEYS OCCURS 24 TIMES.
  1329         16  FILLER              PIC X.
  1330
  1331*                                COPY EL131S.
  1332 01  EL131AI.
  1333     05  FILLER            PIC  X(0012).
  1334*    -------------------------------
  1335     05  DATEL PIC S9(0004) COMP.
  1336     05  DATEF PIC  X(0001).
  1337     05  FILLER REDEFINES DATEF.
  1338         10  DATEA PIC  X(0001).
  1339     05  DATEI PIC  X(0008).
  1340*    -------------------------------
  1341     05  TIMEL PIC S9(0004) COMP.
  1342     05  TIMEF PIC  X(0001).
  1343     05  FILLER REDEFINES TIMEF.
  1344         10  TIMEA PIC  X(0001).
  1345     05  TIMEI PIC  X(0005).
  1346*    -------------------------------
  1347     05  SEQUL PIC S9(0004) COMP.
  1348     05  SEQUF PIC  X(0001).
  1349     05  FILLER REDEFINES SEQUF.
  1350         10  SEQUA PIC  X(0001).
  1351     05  SEQUI PIC  X(0010).
  1352*    -------------------------------
  1353     05  COMPL PIC S9(0004) COMP.
  1354     05  COMPF PIC  X(0001).
  1355     05  FILLER REDEFINES COMPF.
  1356         10  COMPA PIC  X(0001).
  1357     05  COMPI PIC  X(0003).
  1358*    -------------------------------
  1359     05  USERIDL PIC S9(0004) COMP.
  1360     05  USERIDF PIC  X(0001).
  1361     05  FILLER REDEFINES USERIDF.
  1362         10  USERIDA PIC  X(0001).
  1363     05  USERIDI PIC  X(0004).
  1364*    -------------------------------
  1365     05  CCNOL PIC S9(0004) COMP.
  1366     05  CCNOF PIC  X(0001).
  1367     05  FILLER REDEFINES CCNOF.
  1368         10  CCNOA PIC  X(0001).
  1369     05  CCNOI PIC  X(0016).
  1370*    -------------------------------
  1371     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  29
* EL131.cbl
  1372     05  MAINTF PIC  X(0001).
  1373     05  FILLER REDEFINES MAINTF.
  1374         10  MAINTA PIC  X(0001).
  1375     05  MAINTI PIC  X(0001).
  1376*    -------------------------------
  1377     05  CLAIML PIC S9(0004) COMP.
  1378     05  CLAIMF PIC  X(0001).
  1379     05  FILLER REDEFINES CLAIMF.
  1380         10  CLAIMA PIC  X(0001).
  1381     05  CLAIMI PIC  X(0007).
  1382*    -------------------------------
  1383     05  CARRL PIC S9(0004) COMP.
  1384     05  CARRF PIC  X(0001).
  1385     05  FILLER REDEFINES CARRF.
  1386         10  CARRA PIC  X(0001).
  1387     05  CARRI PIC  X(0001).
  1388*    -------------------------------
  1389     05  CERTL PIC S9(0004) COMP.
  1390     05  CERTF PIC  X(0001).
  1391     05  FILLER REDEFINES CERTF.
  1392         10  CERTA PIC  X(0001).
  1393     05  CERTI PIC  X(0010).
  1394*    -------------------------------
  1395     05  SUFXL PIC S9(0004) COMP.
  1396     05  SUFXF PIC  X(0001).
  1397     05  FILLER REDEFINES SUFXF.
  1398         10  SUFXA PIC  X(0001).
  1399     05  SUFXI PIC  X(0001).
  1400*    -------------------------------
  1401     05  TYPEL PIC S9(0004) COMP.
  1402     05  TYPEF PIC  X(0001).
  1403     05  FILLER REDEFINES TYPEF.
  1404         10  TYPEA PIC  X(0001).
  1405     05  TYPEI PIC  X(0001).
  1406*    -------------------------------
  1407     05  LABEL1L PIC S9(0004) COMP.
  1408     05  LABEL1F PIC  X(0001).
  1409     05  FILLER REDEFINES LABEL1F.
  1410         10  LABEL1A PIC  X(0001).
  1411     05  LABEL1I PIC  X(0011).
  1412*    -------------------------------
  1413     05  PCERTNOL PIC S9(0004) COMP.
  1414     05  PCERTNOF PIC  X(0001).
  1415     05  FILLER REDEFINES PCERTNOF.
  1416         10  PCERTNOA PIC  X(0001).
  1417     05  PCERTNOI PIC  X(0010).
  1418*    -------------------------------
  1419     05  PSUFXL PIC S9(0004) COMP.
  1420     05  PSUFXF PIC  X(0001).
  1421     05  FILLER REDEFINES PSUFXF.
  1422         10  PSUFXA PIC  X(0001).
  1423     05  PSUFXI PIC  X(0001).
  1424*    -------------------------------
  1425     05  STATUSL PIC S9(0004) COMP.
  1426     05  STATUSF PIC  X(0001).
  1427     05  FILLER REDEFINES STATUSF.
  1428         10  STATUSA PIC  X(0001).
  1429     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  30
* EL131.cbl
  1430*    -------------------------------
  1431     05  INCL PIC S9(0004) COMP.
  1432     05  INCF PIC  X(0001).
  1433     05  FILLER REDEFINES INCF.
  1434         10  INCA PIC  X(0001).
  1435     05  INCI PIC  X(0008).
  1436*    -------------------------------
  1437     05  REPL PIC S9(0004) COMP.
  1438     05  REPF PIC  X(0001).
  1439     05  FILLER REDEFINES REPF.
  1440         10  REPA PIC  X(0001).
  1441     05  REPI PIC  X(0008).
  1442*    -------------------------------
  1443     05  ICD1L PIC S9(0004) COMP.
  1444     05  ICD1F PIC  X(0001).
  1445     05  FILLER REDEFINES ICD1F.
  1446         10  ICD1A PIC  X(0001).
  1447     05  ICD1I PIC  X(0008).
  1448*    -------------------------------
  1449     05  ICD2L PIC S9(0004) COMP.
  1450     05  ICD2F PIC  X(0001).
  1451     05  FILLER REDEFINES ICD2F.
  1452         10  ICD2A PIC  X(0001).
  1453     05  ICD2I PIC  X(0008).
  1454*    -------------------------------
  1455     05  DIAGL PIC S9(0004) COMP.
  1456     05  DIAGF PIC  X(0001).
  1457     05  FILLER REDEFINES DIAGF.
  1458         10  DIAGA PIC  X(0001).
  1459     05  DIAGI PIC  X(0060).
  1460*    -------------------------------
  1461     05  ACCSWL PIC S9(0004) COMP.
  1462     05  ACCSWF PIC  X(0001).
  1463     05  FILLER REDEFINES ACCSWF.
  1464         10  ACCSWA PIC  X(0001).
  1465     05  ACCSWI PIC  X(0001).
  1466*    -------------------------------
  1467     05  BENEL PIC S9(0004) COMP.
  1468     05  BENEF PIC  X(0001).
  1469     05  FILLER REDEFINES BENEF.
  1470         10  BENEA PIC  X(0001).
  1471     05  BENEI PIC  X(0010).
  1472*    -------------------------------
  1473     05  BIRTHL PIC S9(0004) COMP.
  1474     05  BIRTHF PIC  X(0001).
  1475     05  FILLER REDEFINES BIRTHF.
  1476         10  BIRTHA PIC  X(0001).
  1477     05  BIRTHI PIC  X(0008).
  1478*    -------------------------------
  1479     05  SOCIALL PIC S9(0004) COMP.
  1480     05  SOCIALF PIC  X(0001).
  1481     05  FILLER REDEFINES SOCIALF.
  1482         10  SOCIALA PIC  X(0001).
  1483     05  SOCIALI PIC  X(0011).
  1484*    -------------------------------
  1485     05  SEXL PIC S9(0004) COMP.
  1486     05  SEXF PIC  X(0001).
  1487     05  FILLER REDEFINES SEXF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  31
* EL131.cbl
  1488         10  SEXA PIC  X(0001).
  1489     05  SEXI PIC  X(0001).
  1490*    -------------------------------
  1491     05  MLNAMEL PIC S9(0004) COMP.
  1492     05  MLNAMEF PIC  X(0001).
  1493     05  FILLER REDEFINES MLNAMEF.
  1494         10  MLNAMEA PIC  X(0001).
  1495     05  MLNAMEI PIC  X(0015).
  1496*    -------------------------------
  1497     05  MFNAMEL PIC S9(0004) COMP.
  1498     05  MFNAMEF PIC  X(0001).
  1499     05  FILLER REDEFINES MFNAMEF.
  1500         10  MFNAMEA PIC  X(0001).
  1501     05  MFNAMEI PIC  X(0012).
  1502*    -------------------------------
  1503     05  MMINITL PIC S9(0004) COMP.
  1504     05  MMINITF PIC  X(0001).
  1505     05  FILLER REDEFINES MMINITF.
  1506         10  MMINITA PIC  X(0001).
  1507     05  MMINITI PIC  X(0001).
  1508*    -------------------------------
  1509     05  LOANNOL PIC S9(0004) COMP.
  1510     05  LOANNOF PIC  X(0001).
  1511     05  FILLER REDEFINES LOANNOF.
  1512         10  LOANNOA PIC  X(0001).
  1513     05  LOANNOI PIC  X(0008).
  1514*    -------------------------------
  1515     05  CRTLNMEL PIC S9(0004) COMP.
  1516     05  CRTLNMEF PIC  X(0001).
  1517     05  FILLER REDEFINES CRTLNMEF.
  1518         10  CRTLNMEA PIC  X(0001).
  1519     05  CRTLNMEI PIC  X(0015).
  1520*    -------------------------------
  1521     05  CRTFNMEL PIC S9(0004) COMP.
  1522     05  CRTFNMEF PIC  X(0001).
  1523     05  FILLER REDEFINES CRTFNMEF.
  1524         10  CRTFNMEA PIC  X(0001).
  1525     05  CRTFNMEI PIC  X(0012).
  1526*    -------------------------------
  1527     05  CRTINITL PIC S9(0004) COMP.
  1528     05  CRTINITF PIC  X(0001).
  1529     05  FILLER REDEFINES CRTINITF.
  1530         10  CRTINITA PIC  X(0001).
  1531     05  CRTINITI PIC  X(0001).
  1532*    -------------------------------
  1533     05  LOANBALL PIC S9(0004) COMP.
  1534     05  LOANBALF PIC  X(0001).
  1535     05  FILLER REDEFINES LOANBALF.
  1536         10  LOANBALA PIC  X(0001).
  1537     05  LOANBALI PIC  9(7)V99.
  1538*    -------------------------------
  1539     05  PROCL PIC S9(0004) COMP.
  1540     05  PROCF PIC  X(0001).
  1541     05  FILLER REDEFINES PROCF.
  1542         10  PROCA PIC  X(0001).
  1543     05  PROCI PIC  X(0004).
  1544*    -------------------------------
  1545     05  SUPVL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  32
* EL131.cbl
  1546     05  SUPVF PIC  X(0001).
  1547     05  FILLER REDEFINES SUPVF.
  1548         10  SUPVA PIC  X(0001).
  1549     05  SUPVI PIC  X(0001).
  1550*    -------------------------------
  1551     05  PRICDL PIC S9(0004) COMP.
  1552     05  PRICDF PIC  X(0001).
  1553     05  FILLER REDEFINES PRICDF.
  1554         10  PRICDA PIC  X(0001).
  1555     05  PRICDI PIC  X(0001).
  1556*    -------------------------------
  1557     05  CRITPL PIC S9(0004) COMP.
  1558     05  CRITPF PIC  X(0001).
  1559     05  FILLER REDEFINES CRITPF.
  1560         10  CRITPA PIC  X(0001).
  1561     05  CRITPI PIC  X(0002).
  1562*    -------------------------------
  1563     05  CRITPTL PIC S9(0004) COMP.
  1564     05  CRITPTF PIC  X(0001).
  1565     05  FILLER REDEFINES CRITPTF.
  1566         10  CRITPTA PIC  X(0001).
  1567     05  CRITPTI PIC  X(0001).
  1568*    -------------------------------
  1569     05  RTWMOSL PIC S9(0004) COMP.
  1570     05  RTWMOSF PIC  X(0001).
  1571     05  FILLER REDEFINES RTWMOSF.
  1572         10  RTWMOSA PIC  X(0001).
  1573     05  RTWMOSI PIC  X(0002).
  1574*    -------------------------------
  1575     05  FILETOL PIC S9(0004) COMP.
  1576     05  FILETOF PIC  X(0001).
  1577     05  FILLER REDEFINES FILETOF.
  1578         10  FILETOA PIC  X(0001).
  1579     05  FILETOI PIC  X(0004).
  1580*    -------------------------------
  1581     05  PTHRHDGL PIC S9(0004) COMP.
  1582     05  PTHRHDGF PIC  X(0001).
  1583     05  FILLER REDEFINES PTHRHDGF.
  1584         10  PTHRHDGA PIC  X(0001).
  1585     05  PTHRHDGI PIC  X(0010).
  1586*    -------------------------------
  1587     05  PDTHRUL PIC S9(0004) COMP.
  1588     05  PDTHRUF PIC  X(0001).
  1589     05  FILLER REDEFINES PDTHRUF.
  1590         10  PDTHRUA PIC  X(0001).
  1591     05  PDTHRUI PIC  X(0008).
  1592*    -------------------------------
  1593     05  PDAMTL PIC S9(0004) COMP.
  1594     05  PDAMTF PIC  X(0001).
  1595     05  FILLER REDEFINES PDAMTF.
  1596         10  PDAMTA PIC  X(0001).
  1597     05  PDAMTI PIC  9(7)V99.
  1598*    -------------------------------
  1599     05  NODAYSL PIC S9(0004) COMP.
  1600     05  NODAYSF PIC  X(0001).
  1601     05  FILLER REDEFINES NODAYSF.
  1602         10  NODAYSA PIC  X(0001).
  1603     05  NODAYSI PIC  9(5).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  33
* EL131.cbl
  1604*    -------------------------------
  1605     05  NOPMTSL PIC S9(0004) COMP.
  1606     05  NOPMTSF PIC  X(0001).
  1607     05  FILLER REDEFINES NOPMTSF.
  1608         10  NOPMTSA PIC  X(0001).
  1609     05  NOPMTSI PIC  9(4).
  1610*    -------------------------------
  1611     05  FORMTYPL PIC S9(0004) COMP.
  1612     05  FORMTYPF PIC  X(0001).
  1613     05  FILLER REDEFINES FORMTYPF.
  1614         10  FORMTYPA PIC  X(0001).
  1615     05  FORMTYPI PIC  X(0001).
  1616*    -------------------------------
  1617     05  ESTL PIC S9(0004) COMP.
  1618     05  ESTF PIC  X(0001).
  1619     05  FILLER REDEFINES ESTF.
  1620         10  ESTA PIC  X(0001).
  1621     05  ESTI PIC  X(0008).
  1622*    -------------------------------
  1623     05  AUIDL PIC S9(0004) COMP.
  1624     05  AUIDF PIC  X(0001).
  1625     05  FILLER REDEFINES AUIDF.
  1626         10  AUIDA PIC  X(0001).
  1627     05  AUIDI PIC  X(0004).
  1628*    -------------------------------
  1629     05  OCCL PIC S9(0004) COMP.
  1630     05  OCCF PIC  X(0001).
  1631     05  FILLER REDEFINES OCCF.
  1632         10  OCCA PIC  X(0001).
  1633     05  OCCI PIC  X(0006).
  1634*    -------------------------------
  1635     05  MNTDTL PIC S9(0004) COMP.
  1636     05  MNTDTF PIC  X(0001).
  1637     05  FILLER REDEFINES MNTDTF.
  1638         10  MNTDTA PIC  X(0001).
  1639     05  MNTDTI PIC  X(0008).
  1640*    -------------------------------
  1641     05  MNTTYPEL PIC S9(0004) COMP.
  1642     05  MNTTYPEF PIC  X(0001).
  1643     05  FILLER REDEFINES MNTTYPEF.
  1644         10  MNTTYPEA PIC  X(0001).
  1645     05  MNTTYPEI PIC  X(0006).
  1646*    -------------------------------
  1647     05  CERTCARL PIC S9(0004) COMP.
  1648     05  CERTCARF PIC  X(0001).
  1649     05  FILLER REDEFINES CERTCARF.
  1650         10  CERTCARA PIC  X(0001).
  1651     05  CERTCARI PIC  X(0001).
  1652*    -------------------------------
  1653     05  CERTGRPL PIC S9(0004) COMP.
  1654     05  CERTGRPF PIC  X(0001).
  1655     05  FILLER REDEFINES CERTGRPF.
  1656         10  CERTGRPA PIC  X(0001).
  1657     05  CERTGRPI PIC  X(0006).
  1658*    -------------------------------
  1659     05  CERTSTL PIC S9(0004) COMP.
  1660     05  CERTSTF PIC  X(0001).
  1661     05  FILLER REDEFINES CERTSTF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  34
* EL131.cbl
  1662         10  CERTSTA PIC  X(0001).
  1663     05  CERTSTI PIC  X(0002).
  1664*    -------------------------------
  1665     05  CERTACTL PIC S9(0004) COMP.
  1666     05  CERTACTF PIC  X(0001).
  1667     05  FILLER REDEFINES CERTACTF.
  1668         10  CERTACTA PIC  X(0001).
  1669     05  CERTACTI PIC  X(0010).
  1670*    -------------------------------
  1671     05  CERTEFFL PIC S9(0004) COMP.
  1672     05  CERTEFFF PIC  X(0001).
  1673     05  FILLER REDEFINES CERTEFFF.
  1674         10  CERTEFFA PIC  X(0001).
  1675     05  CERTEFFI PIC  X(0008).
  1676*    -------------------------------
  1677     05  ISSAGEL PIC S9(0004) COMP.
  1678     05  ISSAGEF PIC  X(0001).
  1679     05  FILLER REDEFINES ISSAGEF.
  1680         10  ISSAGEA PIC  X(0001).
  1681     05  ISSAGEI PIC  X(0002).
  1682*    -------------------------------
  1683     05  APRL PIC S9(0004) COMP.
  1684     05  APRF PIC  X(0001).
  1685     05  FILLER REDEFINES APRF.
  1686         10  APRA PIC  X(0001).
  1687     05  APRI PIC  9(4)V9(4).
  1688*    -------------------------------
  1689     05  PMTFREQL PIC S9(0004) COMP.
  1690     05  PMTFREQF PIC  X(0001).
  1691     05  FILLER REDEFINES PMTFREQF.
  1692         10  PMTFREQA PIC  X(0001).
  1693     05  PMTFREQI PIC  99.
  1694*    -------------------------------
  1695     05  INDGRPL PIC S9(0004) COMP.
  1696     05  INDGRPF PIC  X(0001).
  1697     05  FILLER REDEFINES INDGRPF.
  1698         10  INDGRPA PIC  X(0001).
  1699     05  INDGRPI PIC  X(0001).
  1700*    -------------------------------
  1701     05  PREMTYPL PIC S9(0004) COMP.
  1702     05  PREMTYPF PIC  X(0001).
  1703     05  FILLER REDEFINES PREMTYPF.
  1704         10  PREMTYPA PIC  X(0001).
  1705     05  PREMTYPI PIC  X(0001).
  1706*    -------------------------------
  1707     05  REINCDL PIC S9(0004) COMP.
  1708     05  REINCDF PIC  X(0001).
  1709     05  FILLER REDEFINES REINCDF.
  1710         10  REINCDA PIC  X(0001).
  1711     05  REINCDI PIC  X(0001).
  1712*    -------------------------------
  1713     05  JNTLNMEL PIC S9(0004) COMP.
  1714     05  JNTLNMEF PIC  X(0001).
  1715     05  FILLER REDEFINES JNTLNMEF.
  1716         10  JNTLNMEA PIC  X(0001).
  1717     05  JNTLNMEI PIC  X(0015).
  1718*    -------------------------------
  1719     05  JNTFNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  35
* EL131.cbl
  1720     05  JNTFNMEF PIC  X(0001).
  1721     05  FILLER REDEFINES JNTFNMEF.
  1722         10  JNTFNMEA PIC  X(0001).
  1723     05  JNTFNMEI PIC  X(0012).
  1724*    -------------------------------
  1725     05  JNTINITL PIC S9(0004) COMP.
  1726     05  JNTINITF PIC  X(0001).
  1727     05  FILLER REDEFINES JNTINITF.
  1728         10  JNTINITA PIC  X(0001).
  1729     05  JNTINITI PIC  X(0001).
  1730*    -------------------------------
  1731     05  JNTAGEL PIC S9(0004) COMP.
  1732     05  JNTAGEF PIC  X(0001).
  1733     05  FILLER REDEFINES JNTAGEF.
  1734         10  JNTAGEA PIC  X(0001).
  1735     05  JNTAGEI PIC  X(0002).
  1736*    -------------------------------
  1737     05  ADDONDTL PIC S9(0004) COMP.
  1738     05  ADDONDTF PIC  X(0001).
  1739     05  FILLER REDEFINES ADDONDTF.
  1740         10  ADDONDTA PIC  X(0001).
  1741     05  ADDONDTI PIC  X(0008).
  1742*    -------------------------------
  1743     05  LCVDSCRL PIC S9(0004) COMP.
  1744     05  LCVDSCRF PIC  X(0001).
  1745     05  FILLER REDEFINES LCVDSCRF.
  1746         10  LCVDSCRA PIC  X(0001).
  1747     05  LCVDSCRI PIC  X(0006).
  1748*    -------------------------------
  1749     05  LCVKINDL PIC S9(0004) COMP.
  1750     05  LCVKINDF PIC  X(0001).
  1751     05  FILLER REDEFINES LCVKINDF.
  1752         10  LCVKINDA PIC  X(0001).
  1753     05  LCVKINDI PIC  X(0003).
  1754*    -------------------------------
  1755     05  LCVCDL PIC S9(0004) COMP.
  1756     05  LCVCDF PIC  X(0001).
  1757     05  FILLER REDEFINES LCVCDF.
  1758         10  LCVCDA PIC  X(0001).
  1759     05  LCVCDI PIC  X(0002).
  1760*    -------------------------------
  1761     05  LCVOTRML PIC S9(0004) COMP.
  1762     05  LCVOTRMF PIC  X(0001).
  1763     05  FILLER REDEFINES LCVOTRMF.
  1764         10  LCVOTRMA PIC  X(0001).
  1765     05  LCVOTRMI PIC  999.
  1766*    -------------------------------
  1767     05  LCVRTRML PIC S9(0004) COMP.
  1768     05  LCVRTRMF PIC  X(0001).
  1769     05  FILLER REDEFINES LCVRTRMF.
  1770         10  LCVRTRMA PIC  X(0001).
  1771     05  LCVRTRMI PIC  X(0003).
  1772*    -------------------------------
  1773     05  LCVRATEL PIC S9(0004) COMP.
  1774     05  LCVRATEF PIC  X(0001).
  1775     05  FILLER REDEFINES LCVRATEF.
  1776         10  LCVRATEA PIC  X(0001).
  1777     05  LCVRATEI PIC  9999V99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  36
* EL131.cbl
  1778*    -------------------------------
  1779     05  LCVBENEL PIC S9(0004) COMP.
  1780     05  LCVBENEF PIC  X(0001).
  1781     05  FILLER REDEFINES LCVBENEF.
  1782         10  LCVBENEA PIC  X(0001).
  1783     05  LCVBENEI PIC  9(9)V99.
  1784*    -------------------------------
  1785     05  LCVFORML PIC S9(0004) COMP.
  1786     05  LCVFORMF PIC  X(0001).
  1787     05  FILLER REDEFINES LCVFORMF.
  1788         10  LCVFORMA PIC  X(0001).
  1789     05  LCVFORMI PIC  X(0012).
  1790*    -------------------------------
  1791     05  LCVCNDTL PIC S9(0004) COMP.
  1792     05  LCVCNDTF PIC  X(0001).
  1793     05  FILLER REDEFINES LCVCNDTF.
  1794         10  LCVCNDTA PIC  X(0001).
  1795     05  LCVCNDTI PIC  X(0008).
  1796*    -------------------------------
  1797     05  LCVEXITL PIC S9(0004) COMP.
  1798     05  LCVEXITF PIC  X(0001).
  1799     05  FILLER REDEFINES LCVEXITF.
  1800         10  LCVEXITA PIC  X(0001).
  1801     05  LCVEXITI PIC  X(0008).
  1802*    -------------------------------
  1803     05  LCVSTATL PIC S9(0004) COMP.
  1804     05  LCVSTATF PIC  X(0001).
  1805     05  FILLER REDEFINES LCVSTATF.
  1806         10  LCVSTATA PIC  X(0001).
  1807     05  LCVSTATI PIC  X(0006).
  1808*    -------------------------------
  1809     05  ACVDSCRL PIC S9(0004) COMP.
  1810     05  ACVDSCRF PIC  X(0001).
  1811     05  FILLER REDEFINES ACVDSCRF.
  1812         10  ACVDSCRA PIC  X(0001).
  1813     05  ACVDSCRI PIC  X(0006).
  1814*    -------------------------------
  1815     05  ACVKINDL PIC S9(0004) COMP.
  1816     05  ACVKINDF PIC  X(0001).
  1817     05  FILLER REDEFINES ACVKINDF.
  1818         10  ACVKINDA PIC  X(0001).
  1819     05  ACVKINDI PIC  X(0003).
  1820*    -------------------------------
  1821     05  ACVCDL PIC S9(0004) COMP.
  1822     05  ACVCDF PIC  X(0001).
  1823     05  FILLER REDEFINES ACVCDF.
  1824         10  ACVCDA PIC  X(0001).
  1825     05  ACVCDI PIC  X(0002).
  1826*    -------------------------------
  1827     05  ACVOTRML PIC S9(0004) COMP.
  1828     05  ACVOTRMF PIC  X(0001).
  1829     05  FILLER REDEFINES ACVOTRMF.
  1830         10  ACVOTRMA PIC  X(0001).
  1831     05  ACVOTRMI PIC  999.
  1832*    -------------------------------
  1833     05  ACVRTRML PIC S9(0004) COMP.
  1834     05  ACVRTRMF PIC  X(0001).
  1835     05  FILLER REDEFINES ACVRTRMF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  37
* EL131.cbl
  1836         10  ACVRTRMA PIC  X(0001).
  1837     05  ACVRTRMI PIC  X(0003).
  1838*    -------------------------------
  1839     05  ACVRATEL PIC S9(0004) COMP.
  1840     05  ACVRATEF PIC  X(0001).
  1841     05  FILLER REDEFINES ACVRATEF.
  1842         10  ACVRATEA PIC  X(0001).
  1843     05  ACVRATEI PIC  9999V99.
  1844*    -------------------------------
  1845     05  ACVBENEL PIC S9(0004) COMP.
  1846     05  ACVBENEF PIC  X(0001).
  1847     05  FILLER REDEFINES ACVBENEF.
  1848         10  ACVBENEA PIC  X(0001).
  1849     05  ACVBENEI PIC  9(9)V99.
  1850*    -------------------------------
  1851     05  ACVFORML PIC S9(0004) COMP.
  1852     05  ACVFORMF PIC  X(0001).
  1853     05  FILLER REDEFINES ACVFORMF.
  1854         10  ACVFORMA PIC  X(0001).
  1855     05  ACVFORMI PIC  X(0012).
  1856*    -------------------------------
  1857     05  ACVCNDTL PIC S9(0004) COMP.
  1858     05  ACVCNDTF PIC  X(0001).
  1859     05  FILLER REDEFINES ACVCNDTF.
  1860         10  ACVCNDTA PIC  X(0001).
  1861     05  ACVCNDTI PIC  X(0008).
  1862*    -------------------------------
  1863     05  ACVEXITL PIC S9(0004) COMP.
  1864     05  ACVEXITF PIC  X(0001).
  1865     05  FILLER REDEFINES ACVEXITF.
  1866         10  ACVEXITA PIC  X(0001).
  1867     05  ACVEXITI PIC  X(0008).
  1868*    -------------------------------
  1869     05  ACVSTATL PIC S9(0004) COMP.
  1870     05  ACVSTATF PIC  X(0001).
  1871     05  FILLER REDEFINES ACVSTATF.
  1872         10  ACVSTATA PIC  X(0001).
  1873     05  ACVSTATI PIC  X(0006).
  1874*    -------------------------------
  1875     05  LABEL2L PIC S9(0004) COMP.
  1876     05  LABEL2F PIC  X(0001).
  1877     05  FILLER REDEFINES LABEL2F.
  1878         10  LABEL2A PIC  X(0001).
  1879     05  LABEL2I PIC  X(0014).
  1880*    -------------------------------
  1881     05  BCERT1L PIC S9(0004) COMP.
  1882     05  BCERT1F PIC  X(0001).
  1883     05  FILLER REDEFINES BCERT1F.
  1884         10  BCERT1A PIC  X(0001).
  1885     05  BCERT1I PIC  X(0010).
  1886*    -------------------------------
  1887     05  BSUFX1L PIC S9(0004) COMP.
  1888     05  BSUFX1F PIC  X(0001).
  1889     05  FILLER REDEFINES BSUFX1F.
  1890         10  BSUFX1A PIC  X(0001).
  1891     05  BSUFX1I PIC  X(0001).
  1892*    -------------------------------
  1893     05  BCERT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  38
* EL131.cbl
  1894     05  BCERT2F PIC  X(0001).
  1895     05  FILLER REDEFINES BCERT2F.
  1896         10  BCERT2A PIC  X(0001).
  1897     05  BCERT2I PIC  X(0010).
  1898*    -------------------------------
  1899     05  BSUFX2L PIC S9(0004) COMP.
  1900     05  BSUFX2F PIC  X(0001).
  1901     05  FILLER REDEFINES BSUFX2F.
  1902         10  BSUFX2A PIC  X(0001).
  1903     05  BSUFX2I PIC  X(0001).
  1904*    -------------------------------
  1905     05  BCERT3L PIC S9(0004) COMP.
  1906     05  BCERT3F PIC  X(0001).
  1907     05  FILLER REDEFINES BCERT3F.
  1908         10  BCERT3A PIC  X(0001).
  1909     05  BCERT3I PIC  X(0010).
  1910*    -------------------------------
  1911     05  BSUFX3L PIC S9(0004) COMP.
  1912     05  BSUFX3F PIC  X(0001).
  1913     05  FILLER REDEFINES BSUFX3F.
  1914         10  BSUFX3A PIC  X(0001).
  1915     05  BSUFX3I PIC  X(0001).
  1916*    -------------------------------
  1917     05  BCERT4L PIC S9(0004) COMP.
  1918     05  BCERT4F PIC  X(0001).
  1919     05  FILLER REDEFINES BCERT4F.
  1920         10  BCERT4A PIC  X(0001).
  1921     05  BCERT4I PIC  X(0010).
  1922*    -------------------------------
  1923     05  BSUFX4L PIC S9(0004) COMP.
  1924     05  BSUFX4F PIC  X(0001).
  1925     05  FILLER REDEFINES BSUFX4F.
  1926         10  BSUFX4A PIC  X(0001).
  1927     05  BSUFX4I PIC  X(0001).
  1928*    -------------------------------
  1929     05  BCERT5L PIC S9(0004) COMP.
  1930     05  BCERT5F PIC  X(0001).
  1931     05  FILLER REDEFINES BCERT5F.
  1932         10  BCERT5A PIC  X(0001).
  1933     05  BCERT5I PIC  X(0010).
  1934*    -------------------------------
  1935     05  BSUFX5L PIC S9(0004) COMP.
  1936     05  BSUFX5F PIC  X(0001).
  1937     05  FILLER REDEFINES BSUFX5F.
  1938         10  BSUFX5A PIC  X(0001).
  1939     05  BSUFX5I PIC  X(0001).
  1940*    -------------------------------
  1941     05  MSG1L PIC S9(0004) COMP.
  1942     05  MSG1F PIC  X(0001).
  1943     05  FILLER REDEFINES MSG1F.
  1944         10  MSG1A PIC  X(0001).
  1945     05  MSG1I PIC  X(0072).
  1946*    -------------------------------
  1947     05  MSG2L PIC S9(0004) COMP.
  1948     05  MSG2F PIC  X(0001).
  1949     05  FILLER REDEFINES MSG2F.
  1950         10  MSG2A PIC  X(0001).
  1951     05  MSG2I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  39
* EL131.cbl
  1952*    -------------------------------
  1953     05  PFKEYL PIC S9(0004) COMP.
  1954     05  PFKEYF PIC  X(0001).
  1955     05  FILLER REDEFINES PFKEYF.
  1956         10  PFKEYA PIC  X(0001).
  1957     05  PFKEYI PIC  99.
  1958*    -------------------------------
  1959     05  PFKEY6L PIC S9(0004) COMP.
  1960     05  PFKEY6F PIC  X(0001).
  1961     05  FILLER REDEFINES PFKEY6F.
  1962         10  PFKEY6A PIC  X(0001).
  1963     05  PFKEY6I PIC  X(0016).
  1964 01  EL131AO REDEFINES EL131AI.
  1965     05  FILLER            PIC  X(0012).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  DATEO PIC  X(0008).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  TIMEO PIC  99.99.
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  SEQUO PIC  X(0010).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  COMPO PIC  X(0003).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  USERIDO PIC  X(0004).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  CCNOO PIC  X(0016).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  MAINTO PIC  X(0001).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  CLAIMO PIC  X(0007).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  CARRO PIC  X(0001).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  CERTO PIC  X(0010).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  SUFXO PIC  X(0001).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  TYPEO PIC  X(0001).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LABEL1O PIC  X(0011).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  PCERTNOO PIC  X(0010).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  40
* EL131.cbl
  2010     05  PSUFXO PIC  X(0001).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  STATUSO PIC  X(0006).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  INCO PIC  X(0008).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  REPO PIC  X(0008).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  ICD1O PIC  X(0008).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  ICD2O PIC  X(0008).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  DIAGO PIC  X(0060).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACCSWO PIC  X(0001).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  BENEO PIC  X(0010).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  BIRTHO PIC  X(0008).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  SOCIALO PIC  X(0011).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  SEXO PIC  X(0001).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  MLNAMEO PIC  X(0015).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  MFNAMEO PIC  X(0012).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  MMINITO PIC  X(0001).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  LOANNOO PIC  X(0008).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  CRTLNMEO PIC  X(0015).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  CRTFNMEO PIC  X(0012).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  CRTINITO PIC  X(0001).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  LOANBALO PIC  ZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  41
* EL131.cbl
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  PROCO PIC  X(0004).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  SUPVO PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  PRICDO PIC  X(0001).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  CRITPO PIC  X(0002).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  CRITPTO PIC  X(0001).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  RTWMOSO PIC  X(0002).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  FILETOO PIC  X(0004).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  PTHRHDGO PIC  X(0010).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  PDTHRUO PIC  X(0008).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  PDAMTO PIC  Z(06).99.
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  NODAYSO PIC  ZZZ99.
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  NOPMTSO PIC  ZZ99.
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  FORMTYPO PIC  X(0001).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  ESTO PIC  X(0008).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  AUIDO PIC  X(0004).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  OCCO PIC  X(0006).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  MNTDTO PIC  X(0008).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  MNTTYPEO PIC  X(0006).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  CERTCARO PIC  X(0001).
  2125*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  42
* EL131.cbl
  2126     05  FILLER            PIC  X(0003).
  2127     05  CERTGRPO PIC  X(0006).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  CERTSTO PIC  X(0002).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  CERTACTO PIC  X(0010).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  CERTEFFO PIC  X(0008).
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  ISSAGEO PIC  X(0002).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  APRO PIC  9(3).9(4).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  PMTFREQO PIC  99.
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  INDGRPO PIC  X(0001).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  PREMTYPO PIC  X(0001).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  REINCDO PIC  X(0001).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  JNTLNMEO PIC  X(0015).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  JNTFNMEO PIC  X(0012).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  JNTINITO PIC  X(0001).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  JNTAGEO PIC  X(0002).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  ADDONDTO PIC  X(0008).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  LCVDSCRO PIC  X(0006).
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  LCVKINDO PIC  X(0003).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  LCVCDO PIC  X(0002).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  LCVOTRMO PIC  999.
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  43
* EL131.cbl
  2184     05  LCVRTRMO PIC  999.
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  LCVRATEO PIC  ZZZ.ZZ.
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  LCVFORMO PIC  X(0012).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  LCVCNDTO PIC  X(0008).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  LCVEXITO PIC  X(0008).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  LCVSTATO PIC  X(0006).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  ACVDSCRO PIC  X(0006).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  ACVKINDO PIC  X(0003).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  ACVCDO PIC  X(0002).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  ACVOTRMO PIC  999.
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  ACVRTRMO PIC  999.
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  ACVRATEO PIC  ZZZ.ZZ.
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  ACVFORMO PIC  X(0012).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  ACVCNDTO PIC  X(0008).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  ACVEXITO PIC  X(0008).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  ACVSTATO PIC  X(0006).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  LABEL2O PIC  X(0014).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  BCERT1O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  44
* EL131.cbl
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  BSUFX1O PIC  X(0001).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  BCERT2O PIC  X(0010).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  BSUFX2O PIC  X(0001).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  BCERT3O PIC  X(0010).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  BSUFX3O PIC  X(0001).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  BCERT4O PIC  X(0010).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  BSUFX4O PIC  X(0001).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  BCERT5O PIC  X(0010).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  BSUFX5O PIC  X(0001).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  MSG1O PIC  X(0072).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  MSG2O PIC  X(0072).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  PFKEYO PIC  X(0002).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  PFKEY6O PIC  X(0016).
  2281*    -------------------------------
  2282
  2283*                                COPY ELCEMIB SUPPRESS.
  2284******************************************************************
  2285*                                                                *
  2286*                                                                *
  2287*                            ELCEMIB.                            *
  2288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2289*                            VMOD=2.005                          *
  2290*                                                                *
  2291*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2292*                                                                *
  2293******************************************************************
  2294 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2295     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2296     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2297     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2298     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2299     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  45
* EL131.cbl
  2300     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2301     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2302     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2303     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2304         88  EMI-NO-ERRORS                    VALUE '1'.
  2305         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2306         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2307     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2308         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2309     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2310         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2311         88  EMI-AREA1-FULL                   VALUE '2'.
  2312     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2313         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2314         88  EMI-AREA2-FULL                   VALUE '2'.
  2315     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2316         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2317         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2318         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2319         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2320         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2321     12  EMI-ERROR-LINES.
  2322         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2323         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2324         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2325         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2326             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2327                 24  EMI-ERR-NUM         PIC X(4).
  2328                 24  EMI-FILLER          PIC X.
  2329                 24  EMI-SEV             PIC X.
  2330                 24  FILLER              PIC X.
  2331             20  FILLER                  PIC X(02).
  2332     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2333         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2334             20  EMI-ERROR-NUMBER    PIC X(4).
  2335             20  EMI-FILL            PIC X.
  2336             20  EMI-SEVERITY        PIC X.
  2337             20  FILLER              PIC X.
  2338             20  EMI-ERROR-TEXT.
  2339                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2340                 24  FILLER          PIC X(55).
  2341     12  EMI-SEVERITY-SAVE           PIC X.
  2342         88  EMI-NOTE                    VALUE 'N'.
  2343         88  EMI-WARNING                 VALUE 'W'.
  2344         88  EMI-FORCABLE                VALUE 'F'.
  2345         88  EMI-FATAL                   VALUE 'X'.
  2346     12  EMI-MESSAGE-FLAG            PIC X.
  2347         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2348         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2349     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2350     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2351         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2352         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2353         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2354     12  emi-claim-no                pic x(7).
  2355     12  emi-claim-type              pic x(6).
  2356     12  FILLER                      PIC X(124)  VALUE SPACES.
  2357     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  46
* EL131.cbl
  2358     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2359     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2360     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2361
  2362*                                COPY ELCJPFX SUPPRESS.
  2363******************************************************************
  2364*                                                                *
  2365*                                                                *
  2366*                            ELCJPFX.                            *
  2367*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2368*                            VMOD=2.002                          *
  2369*                                                                *
  2370*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2371*                                                                *
  2372*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2373*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2374*        ELCNTL - CONTROL FILE                                   *
  2375*        ELMSTR - CLAIM MASTERS                                  *
  2376*        ELTRLR - ACTIVITY TRAILERS                              *
  2377*        ELCHKQ - CHECK QUE                                      *
  2378******************************************************************
  2379 01  JOURNAL-RECORD.
  2380     12  jp-date                     pic s9(5) comp-3.
  2381     12  jp-time                     pic s9(7) comp-3.
  2382     12  JP-USER-ID                  PIC X(4).
  2383     12  JP-FILE-ID                  PIC X(8).
  2384     12  JP-PROGRAM-ID               PIC X(8).
  2385     12  JP-RECORD-TYPE              PIC X.
  2386         88 JP-ADD              VALUE 'A'.
  2387         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2388         88 JP-AFTER-CHANGE     VALUE 'C'.
  2389         88 JP-DELETE           VALUE 'D'.
  2390         88 JP-GENERIC-DELETE   VALUE 'G'.
  2391         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2392         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2393     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2394     12  JP-RECORD-AREA
  2395
  2396
  2397                                 PIC X(750).
  2398
  2399*                                COPY ELCCALC.
  2400******************************************************************
  2401*                                                                *
  2402*                           ELCCALC.                            *
  2403*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2404*                            VMOD=2.025                          *
  2405*                                                                *
  2406*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2407*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2408*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2409*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2410*                                                                *
  2411*  PASSED TO ELRTRM                                              *
  2412*  -----------------                                             *
  2413*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2414*  ORIGINAL TERM                                                 *
  2415*  BEGINNING DATE                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  47
* EL131.cbl
  2416*  ENDING DATE                                                   *
  2417*  COMPANY I.D.                                                  *
  2418*  ACCOUNT MASTER USER FIELD                                     *
  2419*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2420*  FREE LOOK DAYS                                                *
  2421*                                                                *
  2422*  RETURNED FROM ELRTRM                                          *
  2423*  ---------------------                                         *
  2424*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2425*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2426*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2427*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2428*----------------------------------------------------------------*
  2429*  PASSED TO ELRAMT                                              *
  2430*  ----------------                                              *
  2431*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2432*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2433*  ORIGINAL AMOUNT                                               *
  2434*  ALTERNATE BENEFIT (BALLON)                                    *
  2435*  A.P.R. - NET PAY ONLY                                         *
  2436*  METHOD
  2437*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2438*  COMPANY I.D.                                                  *
  2439*  BENEFIT TYPE                                                  *
  2440*                                                                *
  2441*  RETURNED FROM ELRAMT                                          *
  2442*  --------------------                                          *
  2443*  REMAINING AMOUNT 1 - CURRENT                                  *
  2444*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2445*  REMAINING AMOUNT FACTOR
  2446*----------------------------------------------------------------*
  2447*  PASSED TO ELRESV                                              *
  2448*  -----------------                                             *
  2449*  CERTIFICATE EFFECTIVE DATE                                    *
  2450*  VALUATION DATE                                                *
  2451*  PAID THRU DATE                                                *
  2452*  BENEFIT                                                       *
  2453*  INCURRED DATE                                                 *
  2454*  REPORTED DATE                                                 *
  2455*  ISSUE AGE                                                     *
  2456*  TERM                                                          *
  2457*  CDT PERCENT                                                   *
  2458*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2459* *CLAIM TYPE (LIFE, A/H)                                        *
  2460* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2461* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2462*                                                                *
  2463*  RETURNED FROM ELRESV                                          *
  2464*  --------------------                                          *
  2465*  CDT TABLE USED                                                *
  2466*  CDT FACTOR USED                                               *
  2467*  PAY TO CURRENT RESERVE                                        *
  2468*  I.B.N.R. - A/H ONLY                                           *
  2469*  FUTURE (ACCRUED) AH ONLY                                      *
  2470*----------------------------------------------------------------*
  2471*  PASSED TO ELRATE                                              *
  2472*  ----------------                                              *
  2473*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  48
* EL131.cbl
  2474*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2475*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2476*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2477*  STATE CODE (CLIENT DEFINED)                                   *
  2478*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2479*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2480*  DEVIATION CODE                                                *
  2481*  ISSUE AGE                                                     *
  2482*  ORIGINAL BENEFIT AMOUNT                                       *
  2483*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2484*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2485*  BENEFIT KIND (LIFE OR A/H)                                    *
  2486*  A.P.R.                                                        *
  2487*  METHOD
  2488*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2489*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2490*  COMPANY I.D. (3 CHARACTER)                                    *
  2491*  BENEFIT CODE                                                  *
  2492*  BENEFIT OVERRIDE CODE                                         *
  2493*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2494*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2495*  JOINT INDICATOR (CSL ONLY)                                    *
  2496*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2497*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2498*                                                                *
  2499*  RETURNED FROM ELRATE                                          *
  2500*  --------------------                                          *
  2501*  CALCULATED PREMIUM                                            *
  2502*  PREMIUM RATE                                                  *
  2503*  MORTALITY CODE                                                *
  2504*  MAX ATTAINED AGE                                              *
  2505*  MAX AGE                                                       *
  2506*  MAX TERM                                                      *
  2507*  MAX MONTHLY BENEFIT                                           *
  2508*  MAX TOTAL BENIFIT                                             *
  2509*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2510*----------------------------------------------------------------*
  2511*  PASSED TO ELRFND                                              *
  2512*  ----------------                                              *
  2513*  CERT ISSUE DATE                                               *
  2514*  REFUND DATE                                                   *
  2515*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2516*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2517*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2518*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2519*  STATE CODE (CLIENT DEFINED)                                   *
  2520*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2521*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2522*  DEVIATION CODE                                                *
  2523*  ISSUE AGE                                                     *
  2524*  ORIGINAL BENEFIT AMOUNT                                       *
  2525*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2526*  PROCESS TYPE (CANCEL)                                         *
  2527*  BENEFIT KIND (LIFE OR A/H)                                    *
  2528*  A.P.R.                                                        *
  2529*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2530*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2531*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  49
* EL131.cbl
  2532*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2533*  COMPANY I.D. (3 CHARACTER)                                    *
  2534*  BENEFIT CODE                                                  *
  2535*  BENEFIT OVERRIDE CODE                                         *
  2536*                                                                *
  2537*  RETURNED FROM ELRFND                                          *
  2538*  --------------------                                          *
  2539*  CALCULATED REFUND                                             *
  2540*----------------------------------------------------------------*
  2541*  PASSED TO ELEARN                                              *
  2542*  ----------------                                              *
  2543*  CERT ISSUE DATE                                               *
  2544*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2545*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2546*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2547*  STATE CODE (CLIENT DEFINED)                                   *
  2548*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2549*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2550*  DEVIATION CODE                                                *
  2551*  ISSUE AGE                                                     *
  2552*  ORIGINAL BENEFIT AMOUNT                                       *
  2553*  BENEFIT KIND (LIFE OR A/H)                                    *
  2554*  A.P.R.                                                        *
  2555*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2556*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2557*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2558*  COMPANY I.D. (3 CHARACTER)                                    *
  2559*  BENEFIT CODE                                                  *
  2560*  BENEFIT OVERRIDE CODE                                         *
  2561*                                                                *
  2562*  RETURNED FROM ELEARN                                          *
  2563*  --------------------                                          *
  2564*  INDICATED  EARNINGS                                           *
  2565*----------------------------------------------------------------*
  2566*                 LENGTH = 450                                   *
  2567*                                                                *
  2568******************************************************************
  2569******************************************************************
  2570*                   C H A N G E   L O G
  2571*
  2572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2573*-----------------------------------------------------------------
  2574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2575* EFFECTIVE    NUMBER
  2576*-----------------------------------------------------------------
  2577* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2578* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2579* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2580* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2581* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2582* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2583* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2584* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2585* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2586******************************************************************
  2587
  2588 01  CALCULATION-PASS-AREA.
  2589     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  50
* EL131.cbl
  2590                                     COMP.
  2591
  2592     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2593       88  NO-CP-ERROR                             VALUE ZERO.
  2594       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2595                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2596       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2597       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2598       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2599       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2600       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2601       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2602       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2603       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2604       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2605       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2606       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2607       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2608       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2609       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2610       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2611       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2612       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2613
  2614     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2615       88  NO-CP-ERROR-2                           VALUE ZERO.
  2616***********************  INPUT AREAS ****************************
  2617
  2618     12  CP-CALCULATION-AREA.
  2619         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2620         16  CP-CERT-EFF-DT        PIC XX.
  2621         16  CP-VALUATION-DT       PIC XX.
  2622         16  CP-PAID-THRU-DT       PIC XX.
  2623         16  CP-BENEFIT-TYPE       PIC X.
  2624           88  CP-AH                               VALUE 'A' 'D'
  2625                                                   'I' 'U'.
  2626           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2627           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2628         16  CP-INCURRED-DT        PIC XX.
  2629         16  CP-REPORTED-DT        PIC XX.
  2630         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2631         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2632         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2633                                     COMP-3.
  2634         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2635                                     COMP-3.
  2636         16  CP-CDT-METHOD         PIC X.
  2637           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2638           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2639           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2640         16  CP-CLAIM-TYPE         PIC X.
  2641           88  CP-AH-CLAIM                         VALUE 'A'.
  2642           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2643         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2644                                     COMP-3.
  2645         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2646                                     COMP-3.
  2647         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  51
* EL131.cbl
  2648                                     COMP-3.
  2649         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2650                                     COMP-3.
  2651         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2652                                     COMP-3.
  2653         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2654                                     COMP-3.
  2655         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2656                                     COMP-3.
  2657         16  CP-REM-TERM-METHOD    PIC X.
  2658           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2659           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2660           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2661           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2662           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2663           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2664           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2665         16  CP-EARNING-METHOD     PIC X.
  2666           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2667           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2668           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2669           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2670           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2671           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2672           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2673           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2674           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2675           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2676           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2677           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2678           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2679           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2680         16  CP-PROCESS-TYPE       PIC X.
  2681           88  CP-CLAIM                            VALUE '1'.
  2682           88  CP-CANCEL                           VALUE '2'.
  2683           88  CP-ISSUE                            VALUE '3'.
  2684         16  CP-SPECIAL-CALC-CD    PIC X.
  2685           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2686           88  CP-1-MTH-INTEREST               VALUE ' '.
  2687           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2688           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2689           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2690           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2691           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2692           88  CP-FARM-PLAN                    VALUE 'F'.
  2693           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2694           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2695           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2696           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2697           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2698           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2699           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2700           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2701           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2702           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2703                                                     'W' 'X'.
  2704           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2705           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  52
* EL131.cbl
  2706           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2707           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2708           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2709           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2710           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2711           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2712           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2713           88  CP-CSL-METH-1                   VALUE '5'.
  2714           88  CP-CSL-METH-2                   VALUE '6'.
  2715           88  CP-CSL-METH-3                   VALUE '7'.
  2716           88  CP-CSL-METH-4                   VALUE '8'.
  2717
  2718         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2719                                     COMP-3.
  2720         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2721         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2722         16  CP-STATE              PIC XX          VALUE SPACE.
  2723         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2724         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2725           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2726               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2727         16  CP-R78-OPTION         PIC X.
  2728           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2729           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2730
  2731         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2732         16  CP-IBNR-RESERVE-SW    PIC X.
  2733         16  CP-CLAIM-STATUS       PIC X.
  2734         16  CP-RATE-FILE          PIC X.
  2735         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2736                                     COMP-3.
  2737
  2738         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2739         16  CP-AH-OVERRIDE-CODE   PIC X.
  2740
  2741         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2742                                     COMP-3.
  2743         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2744                                   PIC S9(5)V99 COMP-3.
  2745         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2746                                     COMP-3.
  2747         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2748                                     COMP-3.
  2749         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2750                                     COMP-3.
  2751         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2752                                  PIC S9(7)V99 COMP-3.
  2753
  2754         16  CP-PAID-FROM-DATE     PIC X(02).
  2755         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2756         16  CP-EXT-DAYS-CALC      PIC X.
  2757           88  CP-EXT-NO-CHG                   VALUE ' '.
  2758           88  CP-EXT-CHG-LF                   VALUE '1'.
  2759           88  CP-EXT-CHG-AH                   VALUE '2'.
  2760           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2761         16  CP-DOMICILE-STATE     PIC XX.
  2762         16  CP-CARRIER            PIC X.
  2763         16  CP-REIN-FLAG          PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  53
* EL131.cbl
  2764         16  CP-REM-TRM-CALC-OPTION PIC X.
  2765           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2766                      '2' '3' '4' '5'.
  2767           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2768           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2769           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2770           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2771           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2772           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2773           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2774           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2775         16  CP-SIG-SWITCH         PIC X.
  2776         16  CP-RATING-METHOD      PIC X.
  2777           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2778           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2779           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2780           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2781           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2782           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2783           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2784           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2785           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2786         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2787                                     COMP-3.
  2788         16  CP-BEN-CATEGORY       PIC X.
  2789         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2790         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2791                                   PIC S99V9(5) COMP-3.
  2792         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2793         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2794                                   PIC S99V9(5) COMP-3.
  2795         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2796         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2797         16  CP-EXPIRE-DT          PIC XX.
  2798         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2799         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2800         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2801         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2802         16  CP-DDF-SPEC-CALC      PIC X.
  2803             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2804             88  CP-CALC-CLP              VALUE 'C'.
  2805         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2806         16  CP-CANCEL-REASON      PIC X.
  2807         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2808         16  CP-PMT-MODE           PIC X.
  2809         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2810         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2811         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2812         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2813         16  FILLER                PIC X.
  2814
  2815***************    OUTPUT FROM ELRESV   ************************
  2816
  2817         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2818
  2819         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  54
* EL131.cbl
  2822                                     COMP-3.
  2823         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2824                                     COMP-3.
  2825         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2826                                     COMP-3.
  2827         16  FILLER                PIC X(09).
  2828***************    OUTPUT FROM ELRTRM   *************************
  2829
  2830         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2831                                     COMP-3.
  2832         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2833                                     COMP-3.
  2834         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2835                                     COMP-3.
  2836         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2837                                     COMP-3.
  2838         16  FILLER                PIC X(12).
  2839
  2840***************    OUTPUT FROM ELRAMT   *************************
  2841
  2842         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2843                                     COMP-3.
  2844         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2845                                     COMP-3.
  2846         16  FILLER                PIC X(12).
  2847
  2848***************    OUTPUT FROM ELRATE   *************************
  2849
  2850         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2851                                     COMP-3.
  2852         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2853                                     COMP-3.
  2854         16  CP-MORTALITY-CODE     PIC X(4).
  2855         16  CP-RATE-EDIT-FLAG     PIC X.
  2856             88  CP-RATES-NEED-APR                  VALUE '1'.
  2857         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2858                                     COMP-3.
  2859         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2860         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2861         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2862                                   PIC S9(7)V99 COMP-3.
  2863         16  FILLER                PIC X(07).
  2864
  2865***************    OUTPUT FROM ELRFND   *************************
  2866
  2867         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2868                                     COMP-3.
  2869         16  CP-REFUND-TYPE-USED   PIC X.
  2870           88  CP-R-AS-R78                         VALUE '1'.
  2871           88  CP-R-AS-PRORATA                     VALUE '2'.
  2872           88  CP-R-AS-CALIF                       VALUE '3'.
  2873           88  CP-R-AS-TEXAS                       VALUE '4'.
  2874           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2875           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2876           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2877           88  CP-R-AS-MEAN                        VALUE '8'.
  2878           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2879           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  55
* EL131.cbl
  2880           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2881           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2882           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2883           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2884         16  FILLER                PIC X(12).
  2885
  2886***************    OUTPUT FROM ELEARN   *************************
  2887
  2888         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2889                                     COMP-3.
  2890         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2891                                     COMP-3.
  2892         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2893                                     COMP-3.
  2894         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2895                                     COMP-3.
  2896         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2897                                     COMP-3.
  2898         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2899                                     COMP-3.
  2900         16  CP-EARNING-TYPE-USED  PIC X.
  2901           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2902           88  CP-E-AS-R78                         VALUE '1'.
  2903           88  CP-E-AS-PRORATA                     VALUE '2'.
  2904           88  CP-E-AS-TEXAS                       VALUE '4'.
  2905           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2906           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2907           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2908           88  CP-E-AS-MEAN                        VALUE '8'.
  2909           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2910         16  FILLER                PIC X(12).
  2911
  2912***************    OUTPUT FROM ELPMNT   *************************
  2913
  2914         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2915                                     COMP-3.
  2916         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2917                                     COMP-3.
  2918         16  FILLER                PIC X(12).
  2919
  2920***************   MISC WORK AREAS    *****************************
  2921         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2922                                     COMP-3.
  2923         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2924                                     COMP-3.
  2925         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2926                                     COMP-3.
  2927         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2928                                     COMP-3.
  2929         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2930                                     COMP-3.
  2931         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2932                                     COMP-3.
  2933         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2934             88  OPEN-RATE-FILE                   VALUE 'O'.
  2935             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2936             88  IO-ERROR                         VALUE 'E'.
  2937
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  56
* EL131.cbl
  2938         16  CP-FIRST-PAY-DATE     PIC XX.
  2939
  2940         16  CP-JOINT-INDICATOR    PIC X.
  2941
  2942         16  CP-RESERVE-REMAINING-TERM
  2943                                   PIC S9(4)V9    VALUE ZERO
  2944                                     COMP-3.
  2945
  2946         16  CP-INSURED-BIRTH-DT   PIC XX.
  2947
  2948         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2949                                     COMP-3.
  2950
  2951         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2952                                     COMP-3.
  2953
  2954         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2955                                     COMP-3.
  2956
  2957         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2958                                     COMP-3.
  2959
  2960         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2961                                     COMP-3.
  2962
  2963         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2964                                     COMP-3.
  2965
  2966         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2967                                     COMP-3.
  2968
  2969         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2970             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2971
  2972         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2973                                     COMP-3.
  2974         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2975                                     COMP-3.
  2976         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2977         16  FILLER                PIC X(15).
  2978******************************************************************
  2979
  2980*                                COPY ELCDATE.
  2981******************************************************************
  2982*                                                                *
  2983*                                                                *
  2984*                            ELCDATE.                            *
  2985*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2986*                            VMOD=2.003
  2987*                                                                *
  2988*                                                                *
  2989*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2990*                 LENGTH = 200                                   *
  2991******************************************************************
  2992
  2993 01  DATE-CONVERSION-DATA.
  2994     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2995     12  DC-OPTION-CODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  57
* EL131.cbl
  2996         88  BIN-TO-GREG                VALUE ' '.
  2997         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2998         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2999         88  YMD-GREG-TO-BIN            VALUE '3'.
  3000         88  MDY-GREG-TO-BIN            VALUE '4'.
  3001         88  JULIAN-TO-BIN              VALUE '5'.
  3002         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3003         88  FIND-CENTURY               VALUE '7'.
  3004         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3005         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3006         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3007         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3008         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3009         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3010         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3011         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3012         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3013         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3014         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3015         88  BIN-3-TO-GREG              VALUE 'I'.
  3016         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3017         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3018         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3019         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3020         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3021         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3022         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3023         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3024         88  THREE-CHARACTER-BIN
  3025                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3026         88  GREGORIAN-TO-BIN
  3027                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3028         88  BIN-TO-GREGORIAN
  3029                  VALUES ' ' '1' 'I' '8' 'G'.
  3030         88  JULIAN-TO-BINARY
  3031                  VALUES '5' 'C' 'E' 'F'.
  3032     12  DC-ERROR-CODE                 PIC X.
  3033         88  NO-CONVERSION-ERROR        VALUE ' '.
  3034         88  DATE-CONVERSION-ERROR
  3035                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3036         88  DATE-IS-ZERO               VALUE '1'.
  3037         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3038         88  DATE-IS-INVALID            VALUE '3'.
  3039         88  DATE1-GREATER-DATE2        VALUE '4'.
  3040         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3041         88  DATE-INVALID-OPTION        VALUE '9'.
  3042         88  INVALID-CENTURY            VALUE 'A'.
  3043         88  ONLY-CENTURY               VALUE 'B'.
  3044         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3045         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3046     12  DC-END-OF-MONTH               PIC X.
  3047         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3048     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3049         88  USE-NORMAL-PROCESS         VALUE ' '.
  3050         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3051         88  ADJUST-UP-100-YRS          VALUE '2'.
  3052     12  FILLER                        PIC X.
  3053     12  DC-CONVERSION-DATES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  58
* EL131.cbl
  3054         16  DC-BIN-DATE-1             PIC XX.
  3055         16  DC-BIN-DATE-2             PIC XX.
  3056         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3057         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3058                       DC-GREG-DATE-1-EDIT.
  3059             20  DC-EDIT1-MONTH        PIC 99.
  3060             20  SLASH1-1              PIC X.
  3061             20  DC-EDIT1-DAY          PIC 99.
  3062             20  SLASH1-2              PIC X.
  3063             20  DC-EDIT1-YEAR         PIC 99.
  3064         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3065         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3066                     DC-GREG-DATE-2-EDIT.
  3067             20  DC-EDIT2-MONTH        PIC 99.
  3068             20  SLASH2-1              PIC X.
  3069             20  DC-EDIT2-DAY          PIC 99.
  3070             20  SLASH2-2              PIC X.
  3071             20  DC-EDIT2-YEAR         PIC 99.
  3072         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3073         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3074                     DC-GREG-DATE-1-YMD.
  3075             20  DC-YMD-YEAR           PIC 99.
  3076             20  DC-YMD-MONTH          PIC 99.
  3077             20  DC-YMD-DAY            PIC 99.
  3078         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3079         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3080                      DC-GREG-DATE-1-MDY.
  3081             20  DC-MDY-MONTH          PIC 99.
  3082             20  DC-MDY-DAY            PIC 99.
  3083             20  DC-MDY-YEAR           PIC 99.
  3084         16  DC-GREG-DATE-1-ALPHA.
  3085             20  DC-ALPHA-MONTH        PIC X(10).
  3086             20  DC-ALPHA-DAY          PIC 99.
  3087             20  FILLER                PIC XX.
  3088             20  DC-ALPHA-CENTURY.
  3089                 24 DC-ALPHA-CEN-N     PIC 99.
  3090             20  DC-ALPHA-YEAR         PIC 99.
  3091         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3092         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3093         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3094         16  DC-JULIAN-DATE            PIC 9(05).
  3095         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3096                                       PIC 9(05).
  3097         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3098             20  DC-JULIAN-YEAR        PIC 99.
  3099             20  DC-JULIAN-DAYS        PIC 999.
  3100         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3101         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3102         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3103     12  DATE-CONVERSION-VARIBLES.
  3104         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3105         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3106             20  FILLER                PIC 9(3).
  3107             20  HOLD-CEN-1-CCYY.
  3108                 24  HOLD-CEN-1-CC     PIC 99.
  3109                 24  HOLD-CEN-1-YY     PIC 99.
  3110             20  HOLD-CEN-1-MO         PIC 99.
  3111             20  HOLD-CEN-1-DA         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  59
* EL131.cbl
  3112         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3113             20  HOLD-CEN-1-R-MO       PIC 99.
  3114             20  HOLD-CEN-1-R-DA       PIC 99.
  3115             20  HOLD-CEN-1-R-CCYY.
  3116                 24  HOLD-CEN-1-R-CC   PIC 99.
  3117                 24  HOLD-CEN-1-R-YY   PIC 99.
  3118             20  FILLER                PIC 9(3).
  3119         16  HOLD-CENTURY-1-X.
  3120             20  FILLER                PIC X(3)  VALUE SPACES.
  3121             20  HOLD-CEN-1-X-CCYY.
  3122                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3123                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3124             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3125             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3126         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3127             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3128             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3129             20  HOLD-CEN-1-R-X-CCYY.
  3130                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3131                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3132             20  FILLER                PIC XXX.
  3133         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3134         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3135         16  DC-JULIAN-DATE-1          PIC 9(07).
  3136         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3137             20  DC-JULIAN-1-CCYY.
  3138                 24  DC-JULIAN-1-CC    PIC 99.
  3139                 24  DC-JULIAN-1-YR    PIC 99.
  3140             20  DC-JULIAN-DA-1        PIC 999.
  3141         16  DC-JULIAN-DATE-2          PIC 9(07).
  3142         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3143             20  DC-JULIAN-2-CCYY.
  3144                 24  DC-JULIAN-2-CC    PIC 99.
  3145                 24  DC-JULIAN-2-YR    PIC 99.
  3146             20  DC-JULIAN-DA-2        PIC 999.
  3147         16  DC-GREG-DATE-A-EDIT.
  3148             20  DC-EDITA-MONTH        PIC 99.
  3149             20  SLASHA-1              PIC X VALUE '/'.
  3150             20  DC-EDITA-DAY          PIC 99.
  3151             20  SLASHA-2              PIC X VALUE '/'.
  3152             20  DC-EDITA-CCYY.
  3153                 24  DC-EDITA-CENT     PIC 99.
  3154                 24  DC-EDITA-YEAR     PIC 99.
  3155         16  DC-GREG-DATE-B-EDIT.
  3156             20  DC-EDITB-MONTH        PIC 99.
  3157             20  SLASHB-1              PIC X VALUE '/'.
  3158             20  DC-EDITB-DAY          PIC 99.
  3159             20  SLASHB-2              PIC X VALUE '/'.
  3160             20  DC-EDITB-CCYY.
  3161                 24  DC-EDITB-CENT     PIC 99.
  3162                 24  DC-EDITB-YEAR     PIC 99.
  3163         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3164         16  DC-GREG-DATE-CYMD-R REDEFINES
  3165                              DC-GREG-DATE-CYMD.
  3166             20  DC-CYMD-CEN           PIC 99.
  3167             20  DC-CYMD-YEAR          PIC 99.
  3168             20  DC-CYMD-MONTH         PIC 99.
  3169             20  DC-CYMD-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  60
* EL131.cbl
  3170         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3171         16  DC-GREG-DATE-MDCY-R REDEFINES
  3172                              DC-GREG-DATE-MDCY.
  3173             20  DC-MDCY-MONTH         PIC 99.
  3174             20  DC-MDCY-DAY           PIC 99.
  3175             20  DC-MDCY-CEN           PIC 99.
  3176             20  DC-MDCY-YEAR          PIC 99.
  3177    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3178        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3179    12  DC-EL310-DATE                  PIC X(21).
  3180    12  FILLER                         PIC X(28).
  3181
  3182*                                COPY ELCDMO.
  3183******************************************************************
  3184*                                                                *
  3185*                                                                *
  3186*                            ELCDMO.                             *
  3187*                            VMOD=2.004                          *
  3188*                                                                *
  3189*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3190*        COMMUNICATION AREA                                      *
  3191*   FILE TYPE = NA                                               *
  3192*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3193*                                                                *
  3194******************************************************************
  3195 01  DMO-COMMUNICATION-AREA.
  3196     12  DM-RECORD-TYPE                  PIC  X(02).
  3197             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3198             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3199             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3200     12  DM-DIST-CODE                    PIC  X(04).
  3201     12  DM-MAIL-CODE                    PIC  X(05).
  3202     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3203     12  DM-INSURED-NAME                 PIC  X(30).
  3204     12  DM-CLAIM-NO                     PIC  X(07).
  3205     12  DM-CLAIM-TYPE                   PIC  X.
  3206
  3207     12  DM-STATUS-DATA-AREA.
  3208         16  DM-CLAIM-STATUS             PIC  X.
  3209             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3210             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3211             88  DM-CLOSED                        VALUE '3'.
  3212             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3213             88  DM-DEFAULT                       VALUE '9'.
  3214         16  DM-STATUS-DATE              PIC  X(08).
  3215******YYYYMMDD
  3216         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3217             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3218             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3219             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3220             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3221             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3222             88  DM-RE-OPENED                     VALUE 'R'.
  3223             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3224             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3225             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3226         16  DM-STAT-CARRIER             PIC X.
  3227
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  61
* EL131.cbl
  3228     12  DM-DRAFT-DATA-AREA.
  3229         16  DM-PAYMENT-TYPE             PIC  X.
  3230             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3231         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3232         16  DM-PAYMENT-DATE             PIC  X(08).
  3233******YYYYMMDD
  3234         16  DM-CERT-NO                  PIC  X(11).
  3235         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3236         16  DM-CARRIER                  PIC  X.
  3237
  3238     12  DM-RETURN-CODE                  PIC  XX.
  3239*                                COPY ERCPDEF.
  3240******************************************************************
  3241*                                                                *
  3242*                                                                *
  3243*                            ERCPDEF.                            *
  3244*                                                                *
  3245*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3246*                                                                *
  3247*    FILE TYPE = VSAM,KSDS                                       *
  3248*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3249*                                                                *
  3250*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3251*                                                                *
  3252*    LOG = YES                                                   *
  3253*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3254******************************************************************
  3255 01  PRODUCT-MASTER.
  3256    12  PD-RECORD-ID                 PIC X(02).
  3257        88  VALID-PD-ID                  VALUE 'PD'.
  3258    12  PD-CONTROL-PRIMARY.
  3259        16  PD-COMPANY-CD            PIC X.
  3260        16  PD-STATE                 PIC XX.
  3261        16  PD-PRODUCT-CD            PIC XXX.
  3262        16  PD-FILLER                PIC X(7).
  3263        16  PD-BEN-TYPE              PIC X.
  3264        16  PD-BEN-CODE              PIC XX.
  3265        16  PD-PROD-EXP-DT           PIC XX.
  3266    12  FILLER                       PIC X(50).
  3267    12  PD-PRODUCT-DATA OCCURS 8.
  3268        16  PD-PROD-CODE             PIC X.
  3269            88  PD-PROD-LIFE           VALUE 'L'.
  3270            88  PD-PROD-PROP           VALUE 'P'.
  3271            88  PD-PROD-AH             VALUE 'A'.
  3272            88  PD-PROD-IU             VALUE 'I'.
  3273            88  PD-PROD-GAP            VALUE 'G'.
  3274        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3275        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3276        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3277        16  PD-MAX-TERM              PIC S999        COMP-3.
  3278        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3279        16  FILLER                   PIC X.
  3280        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3281        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3282        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3283        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3284        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3285        16  PD-REC-CRIT-PERIOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  62
* EL131.cbl
  3286        16  PD-RTW-MOS               PIC 99.
  3287        16  FILLER                   PIC X(5).
  3288    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3289    12  PD-TERM-LIMITS OCCURS 15.
  3290        16  PD-LOW-TERM              PIC S999        COMP-3.
  3291        16  PD-HI-TERM               PIC S999        COMP-3.
  3292*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3293    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3294        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3295        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3296    12  PD-EARN-FACTORS.
  3297        16  FILLER OCCURS 15.
  3298            20  FILLER OCCURS 15.
  3299                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3300    12  PD-PRODUCT-DESC              PIC X(80).
  3301    12  PD-TRUNCATED                 PIC X.
  3302    12  FILLER                       PIC X(59).
  3303    12  PD-MAINT-INFORMATION.
  3304        16  PD-LAST-MAINT-DT         PIC X(02).
  3305        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3306        16  PD-LAST-MAINT-BY         PIC X(04).
  3307*                                COPY ELCCRTT.
  3308******************************************************************
  3309*                                                                *
  3310*                            ELCCRTT.                            *
  3311*                                                                *
  3312*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3313*                                                                *
  3314*   FILE TYPE = VSAM,KSDS                                        *
  3315*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3316*                                                                *
  3317*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3318*                                                                *
  3319*   LOG = YES                                                    *
  3320*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3321******************************************************************
  3322*                   C H A N G E   L O G
  3323*
  3324* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3325*-----------------------------------------------------------------
  3326*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3327* EFFECTIVE    NUMBER
  3328*-----------------------------------------------------------------
  3329* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3330* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3331* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3332* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3333* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3334******************************************************************
  3335
  3336 01  CERTIFICATE-TRAILERS.
  3337     12  CS-RECORD-ID                      PIC XX.
  3338         88  VALID-CS-ID                      VALUE 'CS'.
  3339
  3340     12  CS-CONTROL-PRIMARY.
  3341         16  CS-COMPANY-CD                 PIC X.
  3342         16  CS-CARRIER                    PIC X.
  3343         16  CS-GROUPING                   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  63
* EL131.cbl
  3344         16  CS-STATE                      PIC XX.
  3345         16  CS-ACCOUNT                    PIC X(10).
  3346         16  CS-CERT-EFF-DT                PIC XX.
  3347         16  CS-CERT-NO.
  3348             20  CS-CERT-PRIME             PIC X(10).
  3349             20  CS-CERT-SFX               PIC X.
  3350         16  CS-TRAILER-TYPE               PIC X.
  3351             88  COMM-TRLR           VALUE 'A'.
  3352             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3353             88  CERT-DATA-TRLR      VALUE 'C'.
  3354
  3355     12  CS-DATA-AREA                      PIC X(516).
  3356
  3357     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3358         16  CS-BANK-COMMISSION-AREA.
  3359             20  CS-BANK-COMMS       OCCURS 10.
  3360                 24  CS-AGT                PIC X(10).
  3361                 24  CS-COM-TYP            PIC X.
  3362                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3363                 24  CS-RECALC-LV-INDIC    PIC X.
  3364                 24  FILLER                PIC X(10).
  3365         16  FILLER                        PIC X(256).
  3366
  3367     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3368****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3369****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  3370         16  CS-MB-CLAIM-DATA OCCURS 2.
  3371             20  FILLER OCCURS 10.
  3372                 24  CS-CLAIM-TYPE         PIC X.
  3373                     88  CS-AH-CLM           VALUE 'A'.
  3374                     88  CS-IU-CLM           VALUE 'I'.
  3375                     88  CS-GP-CLM           VALUE 'G'.
  3376                     88  CS-LF-CLM           VALUE 'L'.
  3377                     88  CS-PR-CLM           VALUE 'P'.
  3378                 24  CS-BANK               PIC S999 COMP-3.
  3379                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  3380                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  3381                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  3382         16  FILLER                        PIC X(216).
  3383     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3384         16  CS-VIN-NUMBER                 PIC X(17).
  3385         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3386         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3387         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3388         16  FILLER                        PIC X(496).
  3389******************************************************************
  3390
  3391****************************************************************
  3392*
  3393* Copyright (c) 2007 by Clerity Solutions, Inc.
  3394* All rights reserved.
  3395*
  3396****************************************************************
  3397 01  DFHEIV.
  3398   02  DFHEIV0               PIC X(35).
  3399   02  DFHEIV1               PIC X(08).
  3400   02  DFHEIV2               PIC X(08).
  3401   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  64
* EL131.cbl
  3402   02  DFHEIV4               PIC X(06).
  3403   02  DFHEIV5               PIC X(04).
  3404   02  DFHEIV6               PIC X(04).
  3405   02  DFHEIV7               PIC X(02).
  3406   02  DFHEIV8               PIC X(02).
  3407   02  DFHEIV9               PIC X(01).
  3408   02  DFHEIV10              PIC S9(7) COMP-3.
  3409   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3410   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3411   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3412   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3413   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3414   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3415   02  DFHEIV17              PIC X(04).
  3416   02  DFHEIV18              PIC X(04).
  3417   02  DFHEIV19              PIC X(04).
  3418   02  DFHEIV20              USAGE IS POINTER.
  3419   02  DFHEIV21              USAGE IS POINTER.
  3420   02  DFHEIV22              USAGE IS POINTER.
  3421   02  DFHEIV23              USAGE IS POINTER.
  3422   02  DFHEIV24              USAGE IS POINTER.
  3423   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3424   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3425   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3426   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3427   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3428   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3429   02  FILLER                PIC X(02).
  3430   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3431   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3432   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3433   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3434   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3435 LINKAGE  SECTION.
  3436*****************************************************************
  3437*                                                               *
  3438* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3439* All rights reserved.                                          *
  3440*                                                               *
  3441*****************************************************************
  3442 01  dfheiblk.
  3443     02  eibtime          pic s9(7) comp-3.
  3444     02  eibdate          pic s9(7) comp-3.
  3445     02  eibtrnid         pic x(4).
  3446     02  eibtaskn         pic s9(7) comp-3.
  3447     02  eibtrmid         pic x(4).
  3448     02  dfheigdi         pic s9(4) comp.
  3449     02  eibcposn         pic s9(4) comp.
  3450     02  eibcalen         pic s9(4) comp.
  3451     02  eibaid           pic x(1).
  3452     02  eibfiller1       pic x(1).
  3453     02  eibfn            pic x(2).
  3454     02  eibfiller2       pic x(2).
  3455     02  eibrcode         pic x(6).
  3456     02  eibfiller3       pic x(2).
  3457     02  eibds            pic x(8).
  3458     02  eibreqid         pic x(8).
  3459     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  65
* EL131.cbl
  3460     02  eibsync          pic x(1).
  3461     02  eibfree          pic x(1).
  3462     02  eibrecv          pic x(1).
  3463     02  eibsend          pic x(1).
  3464     02  eibatt           pic x(1).
  3465     02  eibeoc           pic x(1).
  3466     02  eibfmh           pic x(1).
  3467     02  eibcompl         pic x(1).
  3468     02  eibsig           pic x(1).
  3469     02  eibconf          pic x(1).
  3470     02  eiberr           pic x(1).
  3471     02  eibrldbk         pic x(1).
  3472     02  eiberrcd         pic x(4).
  3473     02  eibsynrb         pic x(1).
  3474     02  eibnodat         pic x(1).
  3475     02  eibfiller5       pic x(2).
  3476     02  eibresp          pic 9(09) comp.
  3477     02  eibresp2         pic 9(09) comp.
  3478     02  dfheigdj         pic s9(4) comp.
  3479     02  dfheigdk         pic s9(4) comp.
  3480 01  DFHCOMMAREA                 PIC X(1024).
  3481
  3482*                                COPY ELCMSTR.
  3483******************************************************************
  3484*                                                                *
  3485*                            ELCMSTR.                            *
  3486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3487*                            VMOD=2.012                          *
  3488*                                                                *
  3489*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3490*                                                                *
  3491*   FILE TYPE = VSAM,KSDS                                        *
  3492*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3493*                                                                *
  3494*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3495*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3496*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3497*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3498*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3499*                                                 RKP=75,LEN=21  *
  3500*                                                                *
  3501*   **** NOTE ****                                               *
  3502*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3503*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3504*                                                                *
  3505*   LOG = YES                                                    *
  3506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3507******************************************************************
  3508*                   C H A N G E   L O G
  3509*
  3510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3511*-----------------------------------------------------------------
  3512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3513* EFFECTIVE    NUMBER
  3514*-----------------------------------------------------------------
  3515* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3516* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3517* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  66
* EL131.cbl
  3518******************************************************************
  3519 01  CLAIM-MASTER.
  3520     12  CL-RECORD-ID                PIC XX.
  3521         88  VALID-CL-ID         VALUE 'CL'.
  3522
  3523     12  CL-CONTROL-PRIMARY.
  3524         16  CL-COMPANY-CD           PIC X.
  3525         16  CL-CARRIER              PIC X.
  3526         16  CL-CLAIM-NO             PIC X(7).
  3527         16  CL-CERT-NO.
  3528             20  CL-CERT-PRIME       PIC X(10).
  3529             20  CL-CERT-SFX         PIC X.
  3530
  3531     12  CL-CONTROL-BY-NAME.
  3532         16  CL-COMPANY-CD-A1        PIC X.
  3533         16  CL-INSURED-LAST-NAME    PIC X(15).
  3534         16  CL-INSURED-NAME.
  3535             20  CL-INSURED-1ST-NAME PIC X(12).
  3536             20  CL-INSURED-MID-INIT PIC X.
  3537
  3538     12  CL-CONTROL-BY-SSN.
  3539         16  CL-COMPANY-CD-A2        PIC X.
  3540         16  CL-SOC-SEC-NO.
  3541             20  CL-SSN-STATE        PIC XX.
  3542             20  CL-SSN-ACCOUNT      PIC X(6).
  3543             20  CL-SSN-LN3          PIC X(3).
  3544
  3545     12  CL-CONTROL-BY-CERT-NO.
  3546         16  CL-COMPANY-CD-A4        PIC X.
  3547         16  CL-CERT-NO-A4.
  3548             20  CL-CERT-A4-PRIME    PIC X(10).
  3549             20  CL-CERT-A4-SFX      PIC X.
  3550
  3551     12  CL-CONTROL-BY-CCN.
  3552         16  CL-COMPANY-CD-A5        PIC X.
  3553         16  CL-CCN-A5.
  3554             20  CL-CCN.
  3555                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3556                 24  CL-CCN-PRIME-A5 PIC X(12).
  3557             20  CL-CCN-FILLER-A5    PIC X(4).
  3558
  3559     12  CL-INSURED-PROFILE-DATA.
  3560         16  CL-INSURED-BIRTH-DT     PIC XX.
  3561         16  CL-INSURED-SEX-CD       PIC X.
  3562             88  INSURED-IS-MALE        VALUE 'M'.
  3563             88  INSURED-IS-FEMALE      VALUE 'F'.
  3564             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3565         16  CL-INSURED-OCC-CD       PIC X(6).
  3566         16  FILLER                  PIC X(5).
  3567
  3568     12  CL-PROCESSING-INFO.
  3569         16  CL-PROCESSOR-ID         PIC X(4).
  3570         16  CL-CLAIM-STATUS         PIC X.
  3571             88  CLAIM-IS-OPEN          VALUE 'O'.
  3572             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3573         16  CL-CLAIM-TYPE           PIC X.
  3574*            88  AH-CLAIM               VALUE 'A'.
  3575*            88  LIFE-CLAIM             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  67
* EL131.cbl
  3576*            88  PROPERTY-CLAIM         VALUE 'P'.
  3577*            88  IUI-CLAIM              VALUE 'I'.
  3578*            88  GAP-CLAIM              VALUE 'G'.
  3579         16  CL-CLAIM-PREM-TYPE      PIC X.
  3580             88  SINGLE-PREMIUM         VALUE '1'.
  3581             88  O-B-COVERAGE           VALUE '2'.
  3582             88  OPEN-END-COVERAGE      VALUE '3'.
  3583         16  CL-INCURRED-DT          PIC XX.
  3584         16  CL-REPORTED-DT          PIC XX.
  3585         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3586         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3587         16  CL-LAST-PMT-DT          PIC XX.
  3588         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3589         16  CL-PAID-THRU-DT         PIC XX.
  3590         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3591         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3592         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3593         16  CL-PMT-CALC-METHOD      PIC X.
  3594             88  CL-360-DAY-YR          VALUE '1'.
  3595             88  CL-365-DAY-YR          VALUE '2'.
  3596             88  CL-FULL-MONTHS         VALUE '3'.
  3597         16  CL-CAUSE-CD             PIC X(6).
  3598
  3599         16  CL-PRIME-CERT-NO.
  3600             20  CL-PRIME-CERT-PRIME PIC X(10).
  3601             20  CL-PRIME-CERT-SFX   PIC X.
  3602
  3603         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3604             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3605             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3606
  3607         16  CL-MICROFILM-NO         PIC X(10).
  3608         16  CL-PROG-FORM-TYPE       PIC X.
  3609         16  CL-LAST-ADD-ON-DT       PIC XX.
  3610
  3611         16  CL-LAST-REOPEN-DT       PIC XX.
  3612         16  CL-LAST-CLOSE-DT        PIC XX.
  3613         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3614             88  FINAL-PAID             VALUE '1'.
  3615             88  CLAIM-DENIED           VALUE '2'.
  3616             88  AUTO-CLOSE             VALUE '3'.
  3617             88  MANUAL-CLOSE           VALUE '4'.
  3618             88  BENEFITS-CHANGED       VALUE 'C'.
  3619             88  SETUP-ERRORS           VALUE 'E'.
  3620         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3621         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3622         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3623             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3624         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3625         16  FILLER                  PIC X.
  3626
  3627     12  CL-CERTIFICATE-DATA.
  3628         16  CL-CERT-ORIGIN          PIC X.
  3629             88  CERT-WAS-ONLINE        VALUE '1'.
  3630             88  CERT-WAS-CREATED       VALUE '2'.
  3631             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3632         16  CL-CERT-KEY-DATA.
  3633             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  68
* EL131.cbl
  3634             20  CL-CERT-GROUPING    PIC X(6).
  3635             20  CL-CERT-STATE       PIC XX.
  3636             20  CL-CERT-ACCOUNT.
  3637                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3638                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3639             20  CL-CERT-EFF-DT      PIC XX.
  3640
  3641     12  CL-STATUS-CONTROLS.
  3642         16  CL-PRIORITY-CD          PIC X.
  3643             88  CONFIDENTIAL-DATA      VALUE '8'.
  3644             88  HIGHEST-PRIORITY       VALUE '9'.
  3645         16  CL-SUPV-ATTN-CD         PIC X.
  3646             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3647             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3648         16  CL-PURGED-DT            PIC XX.
  3649         16  CL-RESTORED-DT          PIC XX.
  3650         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3651         16  CL-NEXT-RESEND-DT       PIC XX.
  3652         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3653         16  CL-CRITICAL-PERIOD      PIC 99.
  3654*        16  FILLER                  PIC XX.
  3655         16  CL-LAST-MAINT-DT        PIC XX.
  3656         16  CL-LAST-MAINT-USER      PIC X(4).
  3657         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3658         16  CL-LAST-MAINT-TYPE      PIC X.
  3659             88  CLAIM-SET-UP           VALUE ' '.
  3660             88  PAYMENT-MADE           VALUE '1'.
  3661             88  LETTER-SENT            VALUE '2'.
  3662             88  MASTER-WAS-ALTERED     VALUE '3'.
  3663             88  MASTER-WAS-RESTORED    VALUE '4'.
  3664             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3665             88  FILE-CONVERTED         VALUE '6'.
  3666             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3667             88  ERROR-CORRECTION       VALUE 'E'.
  3668         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3669         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3670         16  CL-BENEFICIARY          PIC X(10).
  3671         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3672         16  CL-DENIAL-TYPE          PIC X.
  3673             88  CL-TYPE-DENIAL          VALUE '1'.
  3674             88  CL-TYPE-RESCISSION      VALUE '2'.
  3675             88  CL-TYPE-REFORMATION     VALUE '3'.
  3676             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3677             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3678         16  CL-CRIT-PER-RECURRENT   PIC X.
  3679         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3680         16  CL-RTW-DT               PIC XX.
  3681
  3682     12  CL-TRAILER-CONTROLS.
  3683         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3684             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3685             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3686             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3687         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3688         16  FILLER                  PIC XX.
  3689         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3690         16  CL-ADDRESS-TRAILER-CNT.
  3691             20  CL-INSURED-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  69
* EL131.cbl
  3692                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3693             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3694                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3695             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3696                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3697             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3698                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3699             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3700                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3701             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3702                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3703             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3704                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3705
  3706     12  CL-CV-REFERENCE-NO.
  3707         16  CL-CV-REFNO-PRIME       PIC X(18).
  3708         16  CL-CV-REFNO-SFX         PIC XX.
  3709
  3710     12  CL-FILE-LOCATION            PIC X(4).
  3711
  3712     12  CL-PROCESS-ERRORS.
  3713         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3714             88  NO-FATAL-ERRORS        VALUE ZERO.
  3715         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3716             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3717
  3718     12  CL-PRODUCT-CD               PIC X.
  3719
  3720     12  CL-CURRENT-KEY-DATA.
  3721         16  CL-CURRENT-CARRIER      PIC X.
  3722         16  CL-CURRENT-GROUPING     PIC X(6).
  3723         16  CL-CURRENT-STATE        PIC XX.
  3724         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3725
  3726     12  CL-ASSOCIATES               PIC X.
  3727         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3728         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3729         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3730         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3731
  3732     12  CL-ACTIVITY-CODE            PIC 99.
  3733     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3734     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3735
  3736     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3737     12  CL-LAG-REPORT-CODE          PIC 9.
  3738     12  CL-LOAN-TYPE                PIC XX.
  3739     12  CL-LEGAL-STATE              PIC XX.
  3740
  3741     12  CL-YESNOSW                  PIC X.
  3742     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3743         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3744         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3745         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3746     12  cl-insured-claim            pic x.
  3747         88  cl-claim-on-primary         value 'P'.
  3748         88  cl-claim-on-secondary       value 'S'.
  3749     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  70
* EL131.cbl
  3750
  3751*                                COPY ELCCERT.
  3752******************************************************************
  3753*                                                                *
  3754*                            ELCCERT.                            *
  3755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3756*                            VMOD=2.013                          *
  3757*                                                                *
  3758*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3759*                                                                *
  3760*   FILE TYPE = VSAM,KSDS                                        *
  3761*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3762*                                                                *
  3763*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3764*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3765*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3766*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3767*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3768*                                                                *
  3769*   LOG = YES                                                    *
  3770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3771******************************************************************
  3772*                   C H A N G E   L O G
  3773*
  3774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3775*-----------------------------------------------------------------
  3776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3777* EFFECTIVE    NUMBER
  3778*-----------------------------------------------------------------
  3779* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3780* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3781* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3782* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3783* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3784* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3785* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3786* 032612  CR2011110200001  PEMA  AHL CHANGES
  3787******************************************************************
  3788
  3789 01  CERTIFICATE-MASTER.
  3790     12  CM-RECORD-ID                      PIC XX.
  3791         88  VALID-CM-ID                      VALUE 'CM'.
  3792
  3793     12  CM-CONTROL-PRIMARY.
  3794         16  CM-COMPANY-CD                 PIC X.
  3795         16  CM-CARRIER                    PIC X.
  3796         16  CM-GROUPING.
  3797             20  CM-GROUPING-PREFIX        PIC X(3).
  3798             20  CM-GROUPING-PRIME         PIC X(3).
  3799         16  CM-STATE                      PIC XX.
  3800         16  CM-ACCOUNT.
  3801             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3802             20  CM-ACCOUNT-PRIME          PIC X(6).
  3803         16  CM-CERT-EFF-DT                PIC XX.
  3804         16  CM-CERT-NO.
  3805             20  CM-CERT-PRIME             PIC X(10).
  3806             20  CM-CERT-SFX               PIC X.
  3807
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  71
* EL131.cbl
  3808     12  CM-CONTROL-BY-NAME.
  3809         16  CM-COMPANY-CD-A1              PIC X.
  3810         16  CM-INSURED-LAST-NAME          PIC X(15).
  3811         16  CM-INSURED-INITIALS.
  3812             20  CM-INSURED-INITIAL1       PIC X.
  3813             20  CM-INSURED-INITIAL2       PIC X.
  3814
  3815     12  CM-CONTROL-BY-SSN.
  3816         16  CM-COMPANY-CD-A2              PIC X.
  3817         16  CM-SOC-SEC-NO.
  3818             20  CM-SSN-STATE              PIC XX.
  3819             20  CM-SSN-ACCOUNT            PIC X(6).
  3820             20  CM-SSN-LN3.
  3821                 25  CM-INSURED-INITIALS-A2.
  3822                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3823                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3824                 25 CM-PART-LAST-NAME-A2         PIC X.
  3825
  3826     12  CM-CONTROL-BY-CERT-NO.
  3827         16  CM-COMPANY-CD-A4              PIC X.
  3828         16  CM-CERT-NO-A4                 PIC X(11).
  3829
  3830     12  CM-CONTROL-BY-MEMB.
  3831         16  CM-COMPANY-CD-A5              PIC X.
  3832         16  CM-MEMBER-NO.
  3833             20  CM-MEMB-STATE             PIC XX.
  3834             20  CM-MEMB-ACCOUNT           PIC X(6).
  3835             20  CM-MEMB-LN4.
  3836                 25  CM-INSURED-INITIALS-A5.
  3837                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3838                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3839                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3840
  3841     12  CM-INSURED-PROFILE-DATA.
  3842         16  CM-INSURED-FIRST-NAME.
  3843             20  CM-INSURED-1ST-INIT       PIC X.
  3844             20  FILLER                    PIC X(9).
  3845         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3846         16  CM-INSURED-SEX                PIC X.
  3847             88  CM-SEX-MALE                  VALUE 'M'.
  3848             88  CM-SEX-FEMAL                 VALUE 'F'.
  3849         16  CM-INSURED-JOINT-AGE          PIC 99.
  3850         16  CM-JOINT-INSURED-NAME.
  3851             20  CM-JT-LAST-NAME           PIC X(15).
  3852             20  CM-JT-FIRST-NAME.
  3853                 24  CM-JT-1ST-INIT        PIC X.
  3854                 24  FILLER                PIC X(9).
  3855             20  CM-JT-INITIAL             PIC X.
  3856
  3857     12  CM-LIFE-DATA.
  3858         16  CM-LF-BENEFIT-CD              PIC XX.
  3859         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3860         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3861         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3862         16  CM-LF-DEV-CODE                PIC XXX.
  3863         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3864         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3865         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  72
* EL131.cbl
  3866         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3867         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3868         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3869         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3870         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3871         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3872         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3873         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3874         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3875         16  FILLER                        PIC XX.
  3876
  3877     12  CM-AH-DATA.
  3878         16  CM-AH-BENEFIT-CD              PIC XX.
  3879         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3880         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3881         16  CM-AH-DEV-CODE                PIC XXX.
  3882         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3883         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3884         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3885         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3886         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3887         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3888         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3889         16  CM-AH-PAID-THRU-DT            PIC XX.
  3890             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3891         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3892         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3893         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3894         16  FILLER                        PIC X.
  3895
  3896     12  CM-LOAN-INFORMATION.
  3897         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3898         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3899                                           PIC S9(5)V99  COMP-3.
  3900         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3901         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3902         16  CM-PAY-FREQUENCY              PIC S99.
  3903         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3904         16  CM-RATE-CLASS                 PIC XX.
  3905         16  CM-BENEFICIARY                PIC X(25).
  3906         16  CM-POLICY-FORM-NO             PIC X(12).
  3907         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3908         16  CM-LAST-ADD-ON-DT             PIC XX.
  3909         16  CM-DEDUCTIBLE-AMOUNTS.
  3910             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3911             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3912         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3913             20  CM-RESIDENT-STATE         PIC XX.
  3914             20  CM-RATE-CODE              PIC X(4).
  3915             20  FILLER                    PIC XX.
  3916         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3917             20  CM-LOAN-OFFICER           PIC X(5).
  3918             20  FILLER                    PIC XXX.
  3919         16  CM-CSR-CODE                   PIC XXX.
  3920         16  CM-UNDERWRITING-CODE          PIC X.
  3921             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3922         16  CM-POST-CARD-IND              PIC X.
  3923         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  73
* EL131.cbl
  3924         16  CM-PREMIUM-TYPE               PIC X.
  3925             88  CM-SING-PRM                  VALUE '1'.
  3926             88  CM-O-B-COVERAGE              VALUE '2'.
  3927             88  CM-OPEN-END                  VALUE '3'.
  3928         16  CM-IND-GRP-TYPE               PIC X.
  3929             88  CM-INDIVIDUAL                VALUE 'I'.
  3930             88  CM-GROUP                     VALUE 'G'.
  3931         16  CM-SKIP-CODE                  PIC X.
  3932             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3933             88  SKIP-JULY                    VALUE '1'.
  3934             88  SKIP-AUGUST                  VALUE '2'.
  3935             88  SKIP-SEPTEMBER               VALUE '3'.
  3936             88  SKIP-JULY-AUG                VALUE '4'.
  3937             88  SKIP-AUG-SEPT                VALUE '5'.
  3938             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3939             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3940             88  SKIP-JUNE                    VALUE '8'.
  3941             88  SKIP-JUNE-JULY               VALUE '9'.
  3942             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3943             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3944         16  CM-PAYMENT-MODE               PIC X.
  3945             88  PAY-MONTHLY                  VALUE SPACE.
  3946             88  PAY-WEEKLY                   VALUE '1'.
  3947             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3948             88  PAY-BI-WEEKLY                VALUE '3'.
  3949             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3950         16  CM-LOAN-NUMBER                PIC X(8).
  3951         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3952         16  CM-OLD-LOF                    PIC XXX.
  3953*        16  CM-LOAN-OFFICER               PIC XXX.
  3954         16  CM-REIN-TABLE                 PIC XXX.
  3955         16  CM-SPECIAL-REIN-CODE          PIC X.
  3956         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3957         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3958         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3959
  3960     12  CM-STATUS-DATA.
  3961         16  CM-ENTRY-STATUS               PIC X.
  3962         16  CM-ENTRY-DT                   PIC XX.
  3963
  3964         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3965         16  CM-LF-CANCEL-DT               PIC XX.
  3966         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3967
  3968         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3969         16  CM-LF-DEATH-DT                PIC XX.
  3970         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3971
  3972         16  CM-LF-CURRENT-STATUS          PIC X.
  3973             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3974                                                'M' '4' '5' '9'.
  3975             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3976             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3977             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3978             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3979             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3980             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3981             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  74
* EL131.cbl
  3982             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3983             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3984             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3985             88  CM-LF-DECLINED               VALUE 'D'.
  3986             88  CM-LF-VOIDED                 VALUE 'V'.
  3987
  3988         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3989         16  CM-AH-CANCEL-DT               PIC XX.
  3990         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3991
  3992         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3993         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3994         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3995
  3996         16  CM-AH-CURRENT-STATUS          PIC X.
  3997             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3998                                                'M' '4' '5' '9'.
  3999             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4000             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4001             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4002             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4003             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4004             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4005             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4006             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4007             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4008             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4009             88  CM-AH-DECLINED               VALUE 'D'.
  4010             88  CM-AH-VOIDED                 VALUE 'V'.
  4011
  4012         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4013             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4014             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4015             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4016         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4017
  4018         16  CM-ENTRY-BATCH                PIC X(6).
  4019         16  CM-LF-EXIT-BATCH              PIC X(6).
  4020         16  CM-AH-EXIT-BATCH              PIC X(6).
  4021         16  CM-LAST-MONTH-END             PIC XX.
  4022
  4023     12  CM-NOTE-SW                        PIC X.
  4024         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4025         88  CERT-NOTES-PRESENT               VALUE '1'.
  4026         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4027         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4028         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4029         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4030         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4031         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4032     12  CM-COMP-EXCP-SW                   PIC X.
  4033         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4034         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4035     12  CM-INSURED-ADDRESS-SW             PIC X.
  4036         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4037         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4038
  4039*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  75
* EL131.cbl
  4040     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4041     12  FILLER                            PIC X.
  4042
  4043*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4044     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4045     12  FILLER                            PIC X.
  4046*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4047     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4048
  4049     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4050         88  CERT-ADDED-BATCH                 VALUE ' '.
  4051         88  CERT-ADDED-ONLINE                VALUE '1'.
  4052         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4053         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4054         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4055     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4056         88  CERT-AS-LOADED                   VALUE ' '.
  4057         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4058         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4059         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4060         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4061         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4062         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4063         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4064
  4065     12  CM-ACCOUNT-COMM-PCTS.
  4066         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4067         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4068
  4069     12  CM-USER-FIELD                     PIC X.
  4070     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4071     12  CM-CLP-STATE                      PIC XX.
  4072     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4073     12  CM-USER-RESERVED                  PIC XXX.
  4074     12  FILLER REDEFINES CM-USER-RESERVED.
  4075         16  CM-AH-CLASS-CD                PIC XX.
  4076         16  F                             PIC X.
  4077******************************************************************
  4078
  4079*                                COPY ELCTRLR.
  4080******************************************************************
  4081*                                                                *
  4082*                            ELCTRLR.                            *
  4083*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4084*                            VMOD=2.014                          *
  4085*                                                                *
  4086*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4087*                                                                *
  4088*   FILE TYPE = VSAM,KSDS                                        *
  4089*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4090*                                                                *
  4091*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4092*       ALTERNATE INDEX = NONE                                   *
  4093*                                                                *
  4094*   LOG = YES                                                    *
  4095*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4096******************************************************************
  4097*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  76
* EL131.cbl
  4098*
  4099* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4100*-----------------------------------------------------------------
  4101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4102* EFFECTIVE    NUMBER
  4103*-----------------------------------------------------------------
  4104* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4105* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4106* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4107* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4108* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4109* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4110* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4111* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4112* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4113* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4114* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4115* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4116* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4117* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4118* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4119* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4120* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4121* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4122* 040814    2014030500002  AJRA  ADD ICD CODES
  4123******************************************************************
  4124 01  ACTIVITY-TRAILERS.
  4125     12  AT-RECORD-ID                    PIC XX.
  4126         88  VALID-AT-ID                       VALUE 'AT'.
  4127
  4128     12  AT-CONTROL-PRIMARY.
  4129         16  AT-COMPANY-CD               PIC X.
  4130         16  AT-CARRIER                  PIC X.
  4131         16  AT-CLAIM-NO                 PIC X(7).
  4132         16  AT-CERT-NO.
  4133             20  AT-CERT-PRIME           PIC X(10).
  4134             20  AT-CERT-SFX             PIC X.
  4135         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4136             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4137             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4138             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4139             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4140             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4141             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4142             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4143             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4144             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4145             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4146             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4147             88  AT-BENEFICIARY-TRL           VALUE +91.
  4148             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4149             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4150             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4151             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4152
  4153     12  AT-TRAILER-TYPE                 PIC X.
  4154         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4155         88  PAYMENT-TR                       VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  77
* EL131.cbl
  4156         88  AUTO-PAY-TR                      VALUE '3'.
  4157         88  CORRESPONDENCE-TR                VALUE '4'.
  4158         88  ADDRESS-TR                       VALUE '5'.
  4159         88  GENERAL-INFO-TR                  VALUE '6'.
  4160         88  AUTO-PROMPT-TR                   VALUE '7'.
  4161         88  DENIAL-TR                        VALUE '8'.
  4162         88  INCURRED-CHG-TR                  VALUE '9'.
  4163         88  FORM-CONTROL-TR                  VALUE 'A'.
  4164
  4165     12  AT-RECORDED-DT                  PIC XX.
  4166     12  AT-RECORDED-BY                  PIC X(4).
  4167     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4168
  4169     12  AT-TRAILER-BODY                 PIC X(165).
  4170
  4171     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4172         16  AT-RESERVE-CONTROLS.
  4173             20  AT-MANUAL-SW            PIC X.
  4174                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4175             20  AT-FUTURE-SW            PIC X.
  4176                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4177             20  AT-PTC-SW               PIC X.
  4178                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4179             20  AT-IBNR-SW              PIC X.
  4180                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4181             20  AT-PTC-LF-SW            PIC X.
  4182                 88  AT-LF-PTC-USED          VALUE '1'.
  4183             20  AT-CDT-ACCESS-METHOD    PIC X.
  4184                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4185                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4186                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4187             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4188         16  AT-LAST-COMPUTED-DT         PIC XX.
  4189         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4190         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4191         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4192         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4193         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4194         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4195         16  AT-EXPENSE-CONTROLS.
  4196             20  AT-EXPENSE-METHOD       PIC X.
  4197                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4198                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4199                 88  PERCENT-OF-PMT           VALUE '3'.
  4200                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4201             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4202             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4203         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4204         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4205
  4206         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4207         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4208
  4209*        16  FILLER                      PIC X(53).
  4210         16  FILLER                      PIC X(47).
  4211
  4212         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4213         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  78
* EL131.cbl
  4214
  4215         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4216             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4217             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4218*                    C = CLOSED
  4219*                    O = OPEN
  4220             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4221*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4222
  4223     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4224         16  AT-PAYMENT-TYPE             PIC X.
  4225             88  PARTIAL-PAYMENT                VALUE '1'.
  4226             88  FINAL-PAYMENT                  VALUE '2'.
  4227             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4228             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4229             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4230             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4231             88  VOIDED-PAYMENT                 VALUE '9'.
  4232             88  TRANSFER                       VALUE 'T'.
  4233             88  LIFE-INTEREST                  VALUE 'I'.
  4234
  4235         16  AT-CLAIM-TYPE               PIC X.
  4236             88  PAID-FOR-AH                    VALUE 'A'.
  4237             88  PAID-FOR-LIFE                  VALUE 'L'.
  4238             88  PAID-FOR-IUI                   VALUE 'I'.
  4239             88  PAID-FOR-GAP                   VALUE 'G'.
  4240         16  AT-CLAIM-PREM-TYPE          PIC X.
  4241             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4242             88  AT-O-B-COVERAGE                VALUE '2'.
  4243             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4244         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4245         16  AT-CHECK-NO                 PIC X(7).
  4246         16  AT-PAID-FROM-DT             PIC XX.
  4247         16  AT-PAID-THRU-DT             PIC XX.
  4248         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4249         16  FILLER                      PIC X.
  4250         16  AT-PAYEES-NAME              PIC X(30).
  4251         16  AT-PAYMENT-ORIGIN           PIC X.
  4252             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4253             88  ONLINE-AUTO-PMT                VALUE '2'.
  4254             88  OFFLINE-PMT                    VALUE '3'.
  4255         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4256         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4257         16  AT-VOID-DATA.
  4258             20  AT-VOID-DT              PIC XX.
  4259*00144       20  AT-VOID-REASON          PIC X(30).
  4260             20  AT-VOID-REASON          PIC X(26).
  4261         16  AT-PMT-APPROVED-BY          PIC X(04).
  4262         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4263         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4264         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4265                                         PIC S99V9(5)  COMP-3.
  4266         16  AT-CREDIT-INTERFACE.
  4267             20  AT-PMT-SELECT-DT        PIC XX.
  4268                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4269             20  AT-PMT-ACCEPT-DT        PIC XX.
  4270                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4271             20  AT-VOID-SELECT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  79
* EL131.cbl
  4272                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4273             20  AT-VOID-ACCEPT-DT       PIC XX.
  4274                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4275
  4276         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4277                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4278                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4279         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4280
  4281         16  AT-FORCE-CONTROL            PIC X.
  4282             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4283         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4284         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4285         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4286         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4287         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4288         16  AT-BENEFIT-TYPE             PIC X.
  4289
  4290         16  AT-EXPENSE-TYPE             PIC X.
  4291         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4292
  4293         16  AT-PAYEE-TYPE-CD.
  4294             20  AT-PAYEE-TYPE           PIC X.
  4295                 88  INSURED-PAID           VALUE 'I'.
  4296                 88  BENEFICIARY-PAID       VALUE 'B'.
  4297                 88  ACCOUNT-PAID           VALUE 'A'.
  4298                 88  OTHER-1-PAID           VALUE 'O'.
  4299                 88  OTHER-2-PAID           VALUE 'Q'.
  4300                 88  DOCTOR-PAID            VALUE 'P'.
  4301                 88  EMPLOYER-PAID          VALUE 'E'.
  4302             20  AT-PAYEE-SEQ            PIC X.
  4303
  4304         16  AT-CASH-PAYMENT             PIC X.
  4305         16  AT-GROUPED-PAYMENT          PIC X.
  4306         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4307         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4308         16  AT-APPROVED-LEVEL           PIC X.
  4309         16  AT-VOID-TYPE                PIC X.
  4310             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4311             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4312         16  AT-AIG-UNEMP-IND            PIC X.
  4313             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4314         16  AT-ASSOCIATES               PIC X.
  4315             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4316             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4317
  4318         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4319         16  AT-CV-PMT-CODE              PIC X.
  4320             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4321             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4322             88  FULL-ADD-PAYMENT           VALUE '3'.
  4323             88  HALF-ADD-PAYMENT           VALUE '4'.
  4324             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4325             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4326             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4327             88  ADDL-PAYMENT               VALUE '8'.
  4328
  4329         16  AT-EOB-CODE1                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  80
* EL131.cbl
  4330         16  AT-EOB-CODE2                PIC XXX.
  4331         16  AT-EOB-CODE3                PIC XXX.
  4332         16  FILLER REDEFINES AT-EOB-CODE3.
  4333             20  AT-PRINT-CLM-FORM       PIC X.
  4334             20  AT-PRINT-SURVEY         PIC X.
  4335             20  AT-SPECIAL-RELEASE      PIC X.
  4336         16  AT-EOB-CODE4                PIC XXX.
  4337         16  FILLER REDEFINES AT-EOB-CODE4.
  4338             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4339             20  FILLER                  PIC X.
  4340         16  AT-EOB-CODE5                PIC XXX.
  4341         16  FILLER REDEFINES AT-EOB-CODE5.
  4342             20  AT-PMT-PROOF-DT         PIC XX.
  4343             20  FILLER                  PIC X.
  4344
  4345         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4346             88  AT-PRINT-EOB            VALUE 'Y'.
  4347
  4348         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4349         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4350
  4351     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4352         16  AT-SCHEDULE-START-DT        PIC XX.
  4353         16  AT-SCHEDULE-END-DT          PIC XX.
  4354         16  AT-TERMINATED-DT            PIC XX.
  4355         16  AT-LAST-PMT-TYPE            PIC X.
  4356             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4357             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4358         16  AT-FIRST-PMT-DATA.
  4359             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4360             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4361             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4362         16  AT-REGULAR-PMT-DATA.
  4363             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4364             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4365             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4366         16  AT-AUTO-PAYEE-CD.
  4367             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4368                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4369                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4370                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4371                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4372                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4373             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4374         16  AT-AUTO-PAY-DAY             PIC 99.
  4375         16  AT-AUTO-CASH                PIC X.
  4376             88  AT-CASH                      VALUE 'Y'.
  4377             88  AT-NON-CASH                  VALUE 'N'.
  4378*        16  FILLER                      PIC X(129).
  4379         16  AT-AUTO-END-LETTER          PIC X(4).
  4380         16  FILLER                      PIC X(125).
  4381
  4382         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4383         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4384
  4385     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4386         16  AT-LETTER-SENT-DT           PIC XX.
  4387         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  81
* EL131.cbl
  4388         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4389         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4390         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4391         16  AT-LETTER-ORIGIN            PIC X.
  4392             88  ONLINE-CREATION              VALUE '1' '3'.
  4393             88  OFFLINE-CREATION             VALUE '2' '4'.
  4394             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4395             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4396         16  AT-STD-LETTER-FORM          PIC X(4).
  4397         16  AT-REASON-TEXT              PIC X(70).
  4398         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4399         16  AT-ADDRESEE-TYPE            PIC X.
  4400              88  INSURED-ADDRESEE            VALUE 'I'.
  4401              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4402              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4403              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4404              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4405              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4406              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4407         16  AT-ADDRESSEE-NAME           PIC X(30).
  4408         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4409         16  AT-RESEND-PRINT-DATE        PIC XX.
  4410         16  AT-CORR-SOL-UNSOL           PIC X.
  4411         16  AT-LETTER-PURGED-DT         PIC XX.
  4412*
  4413*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4414*
  4415         16  AT-CSO-REDEFINITION.
  4416             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4417             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4418             20  AT-LETTER-TO-BENE       PIC X(1).
  4419             20  AT-STOP-LETTER-DT       PIC X(2).
  4420             20  FILLER                  PIC X(19).
  4421*             20  FILLER                  PIC X(27).
  4422             20  AT-CSO-LETTER-STATUS    PIC X.
  4423                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4424                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4425                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4426             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4427             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4428*
  4429*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4430*
  4431*        16  FILLER                      PIC X(26).
  4432*
  4433*        16  AT-DMD-BSR-CODE             PIC X.
  4434*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4435*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4436*
  4437*        16  AT-DMD-LETTER-STATUS        PIC X.
  4438*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4439*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4440*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4441*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4442*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4443
  4444         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4445         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  82
* EL131.cbl
  4446
  4447     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4448         16  AT-ADDRESS-TYPE             PIC X.
  4449             88  INSURED-ADDRESS               VALUE 'I'.
  4450             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4451             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4452             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4453             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4454             88  OTHER-ADDRESS-1               VALUE 'O'.
  4455             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4456         16  AT-MAIL-TO-NAME             PIC X(30).
  4457         16  AT-ADDRESS-LINE-1           PIC X(30).
  4458         16  AT-ADDRESS-LINE-2           PIC X(30).
  4459         16  AT-CITY-STATE.
  4460             20  AT-CITY                 PIC X(28).
  4461             20  AT-STATE                PIC XX.
  4462         16  AT-ZIP.
  4463             20  AT-ZIP-CODE.
  4464                 24  AT-ZIP-1ST          PIC X.
  4465                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4466                 24  FILLER              PIC X(4).
  4467             20  AT-ZIP-PLUS4            PIC X(4).
  4468         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4469             20  AT-CAN-POSTAL-1         PIC XXX.
  4470             20  AT-CAN-POSTAL-2         PIC XXX.
  4471             20  FILLER                  PIC XXX.
  4472         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4473*         16  FILLER                      PIC X(23).
  4474         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4475         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4476         16  FILLER                      PIC X(13).
  4477         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4478         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4479
  4480     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4481         16  AT-INFO-LINE-1              PIC X(60).
  4482         16  FILLER REDEFINES AT-INFO-LINE-1.
  4483             20  AT-NOTE-ERROR-NO OCCURS 15
  4484                                         PIC X(4).
  4485         16  AT-INFO-LINE-2              PIC X(60).
  4486         16  FILLER REDEFINES AT-INFO-LINE-2.
  4487             20  AT-ICD-CODE-1           PIC X(8).
  4488             20  AT-ICD-CODE-2           PIC X(8).
  4489             20  FILLER                  PIC X(44).
  4490         16  AT-INFO-TRAILER-TYPE        PIC X.
  4491             88  AT-ERRORS-NOTE          VALUE 'E'.
  4492             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4493             88  AT-CALL-NOTE            VALUE 'C'.
  4494             88  AT-MAINT-NOTE           VALUE 'M'.
  4495             88  AT-CERT-CHANGE          VALUE 'X'.
  4496             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4497             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4498             88  AT-CERT-CANCELLED       VALUE 'T'.
  4499         16  AT-CALL-TYPE                PIC X.
  4500             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4501             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4502         16  AT-NOTE-CONTINUATION        PIC X.
  4503             88  AT-CONTINUED-NOTE       VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  83
* EL131.cbl
  4504         16  AT-EOB-CODES-EXIST          PIC X.
  4505             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4506         16  FILLER                      PIC X(35).
  4507         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4508         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4509
  4510     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4511         16  AT-PROMPT-LINE-1            PIC X(60).
  4512         16  AT-PROMPT-LINE-2            PIC X(60).
  4513         16  AT-PROMPT-START-DT          PIC XX.
  4514         16  AT-PROMPT-END-DT            PIC XX.
  4515         16  FILLER                      PIC X(35).
  4516         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4517         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4518
  4519     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4520         16  AT-DENIAL-INFO-1            PIC X(60).
  4521         16  AT-DENIAL-INFO-2            PIC X(60).
  4522         16  AT-DENIAL-DT                PIC XX.
  4523         16  AT-RETRACTION-DT            PIC XX.
  4524         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4525*         16  FILLER                      PIC X(31).
  4526         16  AT-DENIAL-PROOF-DT          PIC XX.
  4527         16  FILLER                      PIC X(29).
  4528         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4529         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4530
  4531     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4532         16  AT-OLD-INCURRED-DT          PIC XX.
  4533         16  AT-OLD-REPORTED-DT          PIC XX.
  4534         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4535         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4536         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4537         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4538         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4539         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4540         16  FILLER                      PIC X(26).
  4541         16  AT-OLD-DIAG-CODE            PIC X(6).
  4542         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4543         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4544         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4545         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4546         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4547         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4548         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4549         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4550         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4551         16  FILLER                      PIC X(9).
  4552         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4553
  4554     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4555         16  AT-FORM-SEND-ON-DT          PIC XX.
  4556         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4557         16  AT-FORM-RE-SEND-DT          PIC XX.
  4558         16  AT-FORM-ANSWERED-DT         PIC XX.
  4559         16  AT-FORM-PRINTED-DT          PIC XX.
  4560         16  AT-FORM-REPRINT-DT          PIC XX.
  4561         16  AT-FORM-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  84
* EL131.cbl
  4562             88  INITIAL-FORM                  VALUE '1'.
  4563             88  PROGRESS-FORM                 VALUE '2'.
  4564         16  AT-INSTRUCT-LN-1            PIC X(28).
  4565         16  AT-INSTRUCT-LN-2            PIC X(28).
  4566         16  AT-INSTRUCT-LN-3            PIC X(28).
  4567         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4568         16  AT-FORM-ADDRESS             PIC X.
  4569             88  FORM-TO-INSURED              VALUE 'I'.
  4570             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4571             88  FORM-TO-OTHER-1              VALUE 'O'.
  4572             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4573         16  AT-RELATED-1.
  4574             20 AT-REL-CARR-1            PIC X.
  4575             20 AT-REL-CLAIM-1           PIC X(7).
  4576             20 AT-REL-CERT-1            PIC X(11).
  4577         16  AT-RELATED-2.
  4578             20 AT-REL-CARR-2            PIC X.
  4579             20 AT-REL-CLAIM-2           PIC X(7).
  4580             20 AT-REL-CERT-2            PIC X(11).
  4581         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4582         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4583         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4584         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4585         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4586         16  AT-STOP-FORM-DT             PIC X(2).
  4587
  4588         16  FILLER                      PIC X(09).
  4589         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4590         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4591******************************************************************
  4592
  4593*                                COPY ELCCNTL.
  4594******************************************************************
  4595*                                                                *
  4596*                                                                *
  4597*                            ELCCNTL.                            *
  4598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4599*                            VMOD=2.059                          *
  4600*                                                                *
  4601*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4602*                                                                *
  4603*   FILE TYPE = VSAM,KSDS                                        *
  4604*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4605*                                                                *
  4606*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4607*       ALTERNATE INDEX = NONE                                   *
  4608*                                                                *
  4609*   LOG = YES                                                    *
  4610*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4611******************************************************************
  4612*                   C H A N G E   L O G
  4613*
  4614* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4615*-----------------------------------------------------------------
  4616*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4617* EFFECTIVE    NUMBER
  4618*-----------------------------------------------------------------
  4619* 082503                   PEMA  ADD BENEFIT GROUP
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  85
* EL131.cbl
  4620* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4621* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4622* 092705    2005050300006  PEMA  ADD SPP LEASES
  4623* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4624* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4625* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4626* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4627* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4628* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4629* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4630* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4631* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4632******************************************************************
  4633*
  4634 01  CONTROL-FILE.
  4635     12  CF-RECORD-ID                       PIC XX.
  4636         88  VALID-CF-ID                        VALUE 'CF'.
  4637
  4638     12  CF-CONTROL-PRIMARY.
  4639         16  CF-COMPANY-ID                  PIC XXX.
  4640         16  CF-RECORD-TYPE                 PIC X.
  4641             88  CF-COMPANY-MASTER              VALUE '1'.
  4642             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4643             88  CF-STATE-MASTER                VALUE '3'.
  4644             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4645             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4646             88  CF-CARRIER-MASTER              VALUE '6'.
  4647             88  CF-MORTALITY-MASTER            VALUE '7'.
  4648             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4649             88  CF-TERMINAL-MASTER             VALUE '9'.
  4650             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4651             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4652             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4653             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4654             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4655             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4656             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4657             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4658             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4659         16  CF-ACCESS-CD-GENL              PIC X(4).
  4660         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4661             20  CF-PROCESSOR               PIC X(4).
  4662         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4663             20  CF-STATE-CODE              PIC XX.
  4664             20  FILLER                     PIC XX.
  4665         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4666             20  FILLER                     PIC XX.
  4667             20  CF-HI-BEN-IN-REC           PIC XX.
  4668         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4669             20  FILLER                     PIC XXX.
  4670             20  CF-CARRIER-CNTL            PIC X.
  4671         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4672             20  FILLER                     PIC XX.
  4673             20  CF-HI-TYPE-IN-REC          PIC 99.
  4674         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4675             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4676                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4677             20  CF-CRDB-BENEFIT-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  86
* EL131.cbl
  4678             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4679         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4680             20  FILLER                     PIC X.
  4681             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4682         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4683             20  FILLER                     PIC XX.
  4684             20  CF-MORTGAGE-PLAN           PIC XX.
  4685         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4686
  4687     12  CF-LAST-MAINT-DT                   PIC XX.
  4688     12  CF-LAST-MAINT-BY                   PIC X(4).
  4689     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4690
  4691     12  CF-RECORD-BODY                     PIC X(728).
  4692
  4693
  4694****************************************************************
  4695*             COMPANY MASTER RECORD                            *
  4696****************************************************************
  4697
  4698     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4699         16  CF-COMPANY-ADDRESS.
  4700             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4701             20  CF-CL-IN-CARE-OF           PIC X(30).
  4702             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4703             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4704             20  CF-CL-CITY-STATE           PIC X(30).
  4705             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4706             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4707         16  CF-COMPANY-CD                  PIC X.
  4708         16  CF-COMPANY-PASSWORD            PIC X(8).
  4709         16  CF-SECURITY-OPTION             PIC X.
  4710             88  ALL-SECURITY                   VALUE '1'.
  4711             88  COMPANY-VERIFY                 VALUE '2'.
  4712             88  PROCESSOR-VERIFY               VALUE '3'.
  4713             88  NO-SECURITY                    VALUE '4'.
  4714             88  ALL-BUT-TERM                   VALUE '5'.
  4715         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4716             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4717         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4718             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4719         16  CF-INFORCE-LOCATION            PIC X.
  4720             88  CERTS-ARE-ONLINE               VALUE '1'.
  4721             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4722             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4723         16  CF-LOWER-CASE-LETTERS          PIC X.
  4724         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4725             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4726             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4727             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4728             88  CF-ACCNT-CNTL                  VALUE '3'.
  4729             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4730
  4731         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4732         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4733
  4734         16  CF-LGX-CREDIT-USER             PIC X.
  4735             88  CO-IS-NOT-USER                 VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  87
* EL131.cbl
  4736             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4737
  4738         16 CF-CREDIT-CALC-CODES.
  4739             20  CF-CR-REM-TERM-CALC PIC X.
  4740               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4741               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4742               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4743               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4744               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4745               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4746               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4747             20  CF-CR-R78-METHOD           PIC X.
  4748               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4749               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4750
  4751         16  CF-CLAIM-CONTROL-COUNTS.
  4752             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4753                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4754
  4755             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4756                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4757
  4758             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4759                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4760
  4761             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4762                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4763
  4764         16  CF-CURRENT-MONTH-END           PIC XX.
  4765
  4766         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4767             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4768             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4769             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4770             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4771                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4772                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4773             20  CF-CO-PREM-REJECT-SW       PIC X.
  4774                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4775                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4776             20  CF-CO-REF-REJECT-SW        PIC X.
  4777                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4778                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4779
  4780         16  CF-CO-REPORTING-DT             PIC XX.
  4781         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4782         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4783           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4784           88  CF-CO-MONTH-END                  VALUE '1'.
  4785
  4786         16  CF-LGX-CLAIM-USER              PIC X.
  4787             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4788             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4789
  4790         16  CF-CREDIT-EDIT-CONTROLS.
  4791             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4792             20  CF-MIN-AGE                 PIC 99.
  4793             20  CF-DEFAULT-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  88
* EL131.cbl
  4794             20  CF-MIN-TERM                PIC S999      COMP-3.
  4795             20  CF-MAX-TERM                PIC S999      COMP-3.
  4796             20  CF-DEFAULT-SEX             PIC X.
  4797             20  CF-JOINT-AGE-INPUT         PIC X.
  4798                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4799             20  CF-BIRTH-DATE-INPUT        PIC X.
  4800                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4801             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4802                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4803                 88  CF-ZERO-CARRIER            VALUE '1'.
  4804                 88  CF-ZERO-GROUPING           VALUE '2'.
  4805                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4806             20  CF-EDIT-SW                 PIC X.
  4807                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4808             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4809             20  CF-CR-PR-METHOD            PIC X.
  4810               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4811               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4812             20  FILLER                     PIC X.
  4813
  4814         16  CF-CREDIT-MISC-CONTROLS.
  4815             20  CF-REIN-TABLE-SW           PIC X.
  4816                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4817             20  CF-COMP-TABLE-SW           PIC X.
  4818                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4819             20  CF-EXPERIENCE-RETENTION-AGE
  4820                                            PIC S9        COMP-3.
  4821             20  CF-CONVERSION-DT           PIC XX.
  4822             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4823             20  CF-RUN-FREQUENCY-SW        PIC X.
  4824                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4825                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4826
  4827             20  CF-CR-CHECK-NO-CONTROL.
  4828                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4829                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4830                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4831                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4832                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4833                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4834
  4835                 24  CF-CR-CHECK-COUNT       REDEFINES
  4836                     CF-CR-CHECK-COUNTER      PIC X(4).
  4837
  4838                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4839                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4840
  4841                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4842                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4843                 24  CF-MAIL-PROCESSING       PIC X.
  4844                     88  MAIL-PROCESSING          VALUE 'Y'.
  4845
  4846         16  CF-MISC-SYSTEM-CONTROL.
  4847             20  CF-SYSTEM-C                 PIC X.
  4848                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4849             20  CF-SYSTEM-D                 PIC X.
  4850                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4851             20  CF-SOC-SEC-NO-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  89
* EL131.cbl
  4852                 88  SOC-SEC-NO-USED             VALUE '1'.
  4853             20  CF-MEMBER-NO-SW             PIC X.
  4854                 88  MEMBER-NO-USED              VALUE '1'.
  4855             20  CF-TAX-ID-NUMBER            PIC X(11).
  4856             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4857             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4858                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4859                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4860                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4861                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4862             20  CF-SYSTEM-E                 PIC X.
  4863                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4864
  4865         16  CF-LGX-LIFE-USER               PIC X.
  4866             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4867             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4868
  4869         16  CF-CR-MONTH-END-DT             PIC XX.
  4870
  4871         16  CF-FILE-MAINT-DATES.
  4872             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4873                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4874             20  CF-LAST-BATCH       REDEFINES
  4875                 CF-LAST-BATCH-NO               PIC X(4).
  4876             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4877             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4878             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4879             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4880             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4881             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4882             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4883             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4884             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4885             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4886
  4887         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4888         16  FILLER                         PIC X.
  4889
  4890         16  CF-ALT-MORT-CODE               PIC X(4).
  4891         16  CF-MEMBER-CAPTION              PIC X(10).
  4892
  4893         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4894             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4895             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4896             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4897             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4898             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4899
  4900         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4901
  4902         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4903         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4904         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4905         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4906
  4907         16  CF-AH-OVERRIDE-L1              PIC X.
  4908         16  CF-AH-OVERRIDE-L2              PIC XX.
  4909         16  CF-AH-OVERRIDE-L6              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  90
* EL131.cbl
  4910         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4911
  4912         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4913         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4914
  4915         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4916         16  CF-AR-LAST-EL860-DT            PIC XX.
  4917         16  CF-MP-MONTH-END-DT             PIC XX.
  4918
  4919         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4920         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4921             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4922
  4923         16  CF-AR-MONTH-END-DT             PIC XX.
  4924
  4925         16  CF-CRDTCRD-USER                PIC X.
  4926             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4927             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4928
  4929         16  CF-CC-MONTH-END-DT             PIC XX.
  4930
  4931         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4932
  4933         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4934             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4935             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4936             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4937         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4938         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4939         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4940         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4941             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4942             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4943         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4944         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4945         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4946             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4947         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4948
  4949         16  CF-CL-ZIP-CODE.
  4950             20  CF-CL-ZIP-PRIME.
  4951                 24  CF-CL-ZIP-1ST          PIC X.
  4952                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4953                 24  FILLER                 PIC X(4).
  4954             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4955         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4956             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4957             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4958             20  FILLER                     PIC XXX.
  4959
  4960         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4961         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4962         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4963         16  CF-CO-OPTION-START-DATE        PIC XX.
  4964         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4965           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4966                                                      '3' '4'.
  4967           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  91
* EL131.cbl
  4968           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4969           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4970           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4971           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4972           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4973
  4974         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4975
  4976         16  CF-PAYMENT-APPROVAL-LEVELS.
  4977             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4978             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4979             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4980             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4981             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4982             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4983
  4984         16  CF-END-USER-REPORTING-USER     PIC X.
  4985             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4986             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4987
  4988         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4989             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4990             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4991
  4992         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4993
  4994         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4995         16  FILLER                         PIC X.
  4996
  4997         16  CF-CREDIT-ARCHIVE-CNTL.
  4998             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4999             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5000             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5001
  5002         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5003
  5004         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5005             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5006             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5007
  5008         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5009             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5010             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5011
  5012         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5013
  5014         16  CF-CO-ACH-ID-CODE              PIC  X.
  5015             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5016             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5017             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5018         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5019         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5020         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5021         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5022         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5023         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5024         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5025         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  92
* EL131.cbl
  5026         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5027                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5028         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5029                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5030
  5031         16  CF-CO-OVER-SHORT.
  5032             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5033             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5034
  5035*         16  FILLER                         PIC X(102).
  5036         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5037             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5038             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5039
  5040         16  CF-AH-APPROVAL-DAYS.
  5041             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5042             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5043             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5044             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5045
  5046         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5047
  5048         16  CF-APPROV-LEV-5.
  5049             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5050             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5051             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5052
  5053         16  FILLER                         PIC X(68).
  5054****************************************************************
  5055*             PROCESSOR/USER RECORD                            *
  5056****************************************************************
  5057
  5058     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5059         16  CF-PROCESSOR-NAME              PIC X(30).
  5060         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5061         16  CF-PROCESSOR-TITLE             PIC X(26).
  5062         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5063                 88  MESSAGE-YES                VALUE 'Y'.
  5064                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5065
  5066*****************************************************
  5067****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5068****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5069****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5070****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5071*****************************************************
  5072
  5073         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5074             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5075             20  CF-APPLICATION-FORCE       PIC X.
  5076             20  CF-INDIVIDUAL-APP.
  5077                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5078                     28  CF-BROWSE-APP      PIC X.
  5079                     28  CF-UPDATE-APP      PIC X.
  5080
  5081         16  CF-CURRENT-TERM-ON             PIC X(4).
  5082         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5083             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  93
* EL131.cbl
  5084             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5085             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5086             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5087             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5088             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5089             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5090         16  CF-PROCESSOR-CARRIER           PIC X.
  5091             88  NO-CARRIER-SECURITY            VALUE ' '.
  5092         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5093             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5094         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5095             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5096         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5097             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5098
  5099         16  CF-PROC-SYS-ACCESS-SW.
  5100             20  CF-PROC-CREDIT-CLAIMS-SW.
  5101                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5102                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5103                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5104                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5105             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5106                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5107                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5108             20  CF-PROC-LIFE-GNRLDGR-SW.
  5109                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5110                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5111                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5112                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5113             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5114                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5115                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5116         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5117             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5118             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5119         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5120
  5121         16  CF-APPROVAL-LEVEL                  PIC X.
  5122             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5123             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5124             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5125             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5126             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5127
  5128         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5129
  5130         16  CF-LANGUAGE-TYPE                   PIC X.
  5131             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5132             88  CF-LANG-IS-FR                      VALUE 'F'.
  5133
  5134         16  CF-CSR-IND                         PIC X.
  5135         16  FILLER                             PIC X(239).
  5136
  5137****************************************************************
  5138*             PROCESSOR/REMINDERS RECORD                       *
  5139****************************************************************
  5140
  5141     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  94
* EL131.cbl
  5142         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5143             20  CF-START-REMIND-DT         PIC XX.
  5144             20  CF-END-REMIND-DT           PIC XX.
  5145             20  CF-REMINDER-TEXT           PIC X(50).
  5146         16  FILLER                         PIC X(296).
  5147
  5148
  5149****************************************************************
  5150*             STATE MASTER RECORD                              *
  5151****************************************************************
  5152
  5153     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5154         16  CF-STATE-ABBREVIATION          PIC XX.
  5155         16  CF-STATE-NAME                  PIC X(25).
  5156         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5157         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5158             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5159             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5160             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5161             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5162                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5163                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5164             20  CF-ST-PREM-REJECT-SW       PIC X.
  5165                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5166                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5167             20  CF-ST-REF-REJECT-SW        PIC X.
  5168                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5169                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5170         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5171         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5172         16  CF-ST-REFUND-RULES.
  5173             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5174             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5175             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5176         16  CF-ST-FST-PMT-EXTENSION.
  5177             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5178             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5179                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5180                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5181                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5182                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5183         16  CF-ST-STATE-CALL.
  5184             20  CF-ST-CALL-UNEARNED        PIC X.
  5185             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5186             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5187         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5188             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5189             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5190         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5191         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5192         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5193         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5194         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5195         16  FILLER                         PIC X.
  5196         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5197             20  CF-ST-BENEFIT-CD           PIC XX.
  5198             20  CF-ST-BENEFIT-KIND         PIC X.
  5199                 88  CF-ST-LIFE-KIND            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  95
* EL131.cbl
  5200                 88  CF-ST-AH-KIND              VALUE 'A'.
  5201             20  CF-ST-REM-TERM-CALC        PIC X.
  5202                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5203                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5204                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5205                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5206                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5207                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5208                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5209                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5210
  5211             20  CF-ST-REFUND-CALC          PIC X.
  5212                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5213                 88  ST-REFD-BY-R78             VALUE '1'.
  5214                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5215                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5216                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5217                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5218                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5219                 88  ST-REFD-UTAH               VALUE '7'.
  5220                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5221                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5222                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5223
  5224             20  CF-ST-EARNING-CALC         PIC X.
  5225                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5226                 88  ST-EARN-BY-R78             VALUE '1'.
  5227                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5228                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5229                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5230                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5231                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5232                 88  ST-EARN-MEAN               VALUE '8'.
  5233                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5234
  5235             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5236                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5237                 88  ST-OVRD-BY-R78             VALUE '1'.
  5238                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5239                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5240                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5241                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5242                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5243                 88  ST-OVRD-MEAN               VALUE '8'.
  5244                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5245             20  FILLER                     PIC X.
  5246
  5247         16  CF-ST-COMMISSION-CAPS.
  5248             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5249             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5250             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5251             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5252         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5253                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5254
  5255         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5256
  5257         16  CF-ST-STATUTORY-INTEREST.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  96
* EL131.cbl
  5258             20  CF-ST-STAT-DATE-FROM       PIC X.
  5259                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5260                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5261             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5262             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5263             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5264             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5265             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5266
  5267         16  CF-ST-OVER-SHORT.
  5268             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5269             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5270
  5271         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5272
  5273         16  CF-ST-RT-CALC                  PIC X.
  5274
  5275         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5276         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5277         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5278         16  CF-ST-RF-LR-CALC               PIC X.
  5279         16  CF-ST-RF-LL-CALC               PIC X.
  5280         16  CF-ST-RF-LN-CALC               PIC X.
  5281         16  CF-ST-RF-AH-CALC               PIC X.
  5282         16  CF-ST-RF-CP-CALC               PIC X.
  5283*        16  FILLER                         PIC X(206).
  5284*CIDMOD         16  FILLER                         PIC X(192).
  5285         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5286             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5287         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5288         16  CF-ST-VFY-2ND-BENE             PIC X.
  5289         16  CF-ST-CAUSAL-STATE             PIC X.
  5290         16  FILLER                         PIC X(185).
  5291
  5292****************************************************************
  5293*             BENEFIT MASTER RECORD                            *
  5294****************************************************************
  5295
  5296     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5297         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5298             20  CF-BENEFIT-CODE            PIC XX.
  5299             20  CF-BENEFIT-NUMERIC  REDEFINES
  5300                 CF-BENEFIT-CODE            PIC XX.
  5301             20  CF-BENEFIT-ALPHA           PIC XXX.
  5302             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5303             20  CF-BENEFIT-COMMENT         PIC X(10).
  5304
  5305             20  CF-LF-COVERAGE-TYPE        PIC X.
  5306                 88  CF-REDUCING                VALUE 'R'.
  5307                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5308
  5309             20  CF-SPECIAL-CALC-CD         PIC X.
  5310                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5311                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5312                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5313                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5314                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5315                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  97
* EL131.cbl
  5316                 88  CF-FARM-PLAN               VALUE 'F'.
  5317                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5318                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5319                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5320                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5321                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5322                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5323                 88  CF-PRUDENTIAL              VALUE 'P'.
  5324                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5325                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5326                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5327                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5328                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5329                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5330
  5331             20  CF-JOINT-INDICATOR         PIC X.
  5332                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5333
  5334*            20  FILLER                     PIC X(12).
  5335             20  FILLER                     PIC X(11).
  5336             20  CF-BENEFIT-CATEGORY        PIC X.
  5337             20  CF-LOAN-TYPE               PIC X(8).
  5338
  5339             20  CF-CO-REM-TERM-CALC        PIC X.
  5340                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5341                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5342                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5343                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5344                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5345
  5346             20  CF-CO-EARNINGS-CALC        PIC X.
  5347                 88  CO-EARN-BY-R78             VALUE '1'.
  5348                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5349                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5350                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5351                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5352                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5353                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5354                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5355
  5356             20  CF-CO-REFUND-CALC          PIC X.
  5357                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5358                 88  CO-REFD-BY-R78             VALUE '1'.
  5359                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5360                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5361                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5362                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5363                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5364                 88  CO-REFD-MEAN               VALUE '8'.
  5365                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5366                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5367                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5368
  5369             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5370                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5371                 88  CO-OVRD-BY-R78             VALUE '1'.
  5372                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5373                 88  CO-OVRD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  98
* EL131.cbl
  5374                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5375                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5376                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5377                 88  CO-OVRD-MEAN               VALUE '8'.
  5378                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5379
  5380             20  CF-CO-BEN-I-G-CD           PIC X.
  5381                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5382                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5383                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5384
  5385         16  FILLER                         PIC X(304).
  5386
  5387
  5388****************************************************************
  5389*             CARRIER MASTER RECORD                            *
  5390****************************************************************
  5391
  5392     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5393         16  CF-ADDRESS-DATA.
  5394             20  CF-MAIL-TO-NAME            PIC X(30).
  5395             20  CF-IN-CARE-OF              PIC X(30).
  5396             20  CF-ADDRESS-LINE-1          PIC X(30).
  5397             20  CF-ADDRESS-LINE-2          PIC X(30).
  5398             20  CF-CITY-STATE              PIC X(30).
  5399             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5400             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5401
  5402         16  CF-CLAIM-NO-CONTROL.
  5403             20  CF-CLAIM-NO-METHOD         PIC X.
  5404                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5405                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5406                 88  CLAIM-NO-SEQ               VALUE '3'.
  5407                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5408             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5409                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5410                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5411                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5412
  5413         16  CF-CHECK-NO-CONTROL.
  5414             20  CF-CHECK-NO-METHOD         PIC X.
  5415                 88  CHECK-NO-MANUAL            VALUE '1'.
  5416                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5417                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5418                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5419             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5420                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5421
  5422         16  CF-DOMICILE-STATE              PIC XX.
  5423
  5424         16  CF-EXPENSE-CONTROLS.
  5425             20  CF-EXPENSE-METHOD          PIC X.
  5426                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5427                 88  DOLLARS-PER-PMT            VALUE '2'.
  5428                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5429                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5430             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5431             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  99
* EL131.cbl
  5432
  5433         16  CF-CORRESPONDENCE-CONTROL.
  5434             20  CF-LETTER-RESEND-OPT       PIC X.
  5435                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5436                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5437             20  FILLER                     PIC X(4).
  5438
  5439         16  CF-RESERVE-CONTROLS.
  5440             20  CF-MANUAL-SW               PIC X.
  5441                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5442             20  CF-FUTURE-SW               PIC X.
  5443                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5444             20  CF-PTC-SW                  PIC X.
  5445                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5446             20  CF-IBNR-SW                 PIC X.
  5447                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5448             20  CF-PTC-LF-SW               PIC X.
  5449                 88  CF-LF-PTC-USED             VALUE '1'.
  5450             20  CF-CDT-ACCESS-METHOD       PIC X.
  5451                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5452                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5453                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5454             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5455
  5456         16  CF-CLAIM-CALC-METHOD           PIC X.
  5457             88  360-PLUS-MONTHS                VALUE '1'.
  5458             88  365-PLUS-MONTHS                VALUE '2'.
  5459             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5460             88  360-DAILY                      VALUE '4'.
  5461             88  365-DAILY                      VALUE '5'.
  5462
  5463         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5464         16  FILLER                         PIC X(11).
  5465
  5466         16  CF-LIMIT-AMOUNTS.
  5467             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5468             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5469             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5470             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5471             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5472             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5473             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5474             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5475             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5476             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5477
  5478         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5479         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5480         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5481
  5482         16  CF-ZIP-CODE.
  5483             20  CF-ZIP-PRIME.
  5484                 24  CF-ZIP-1ST             PIC X.
  5485                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5486                 24  FILLER                 PIC X(4).
  5487             20  CF-ZIP-PLUS4               PIC X(4).
  5488         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5489             20  CF-CAN-POSTAL-1            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 100
* EL131.cbl
  5490             20  CF-CAN-POSTAL-2            PIC XXX.
  5491             20  FILLER                     PIC XXX.
  5492
  5493         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5494         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5495         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5496
  5497         16  CF-RATING-SWITCH               PIC X.
  5498             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5499             88  CF-NO-RATING                   VALUE 'N'.
  5500
  5501         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5502
  5503         16  CF-CARRIER-OVER-SHORT.
  5504             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5505             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5506
  5507         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5508         16  CF-SECPAY-SWITCH               PIC X.
  5509             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5510             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5511         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5512         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5513         16  FILLER                         PIC X(444).
  5514*        16  FILLER                         PIC X(452).
  5515
  5516
  5517****************************************************************
  5518*             MORTALITY MASTER RECORD                          *
  5519****************************************************************
  5520
  5521     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5522         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5523                                INDEXED BY CF-MORT-NDX.
  5524             20  CF-MORT-TABLE              PIC X(5).
  5525             20  CF-MORT-TABLE-TYPE         PIC X.
  5526                 88  CF-MORT-JOINT              VALUE 'J'.
  5527                 88  CF-MORT-SINGLE             VALUE 'S'.
  5528                 88  CF-MORT-COMBINED           VALUE 'C'.
  5529                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5530                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5531             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5532             20  CF-MORT-AGE-METHOD         PIC XX.
  5533                 88  CF-AGE-LAST                VALUE 'AL'.
  5534                 88  CF-AGE-NEAR                VALUE 'AN'.
  5535             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5536             20  CF-MORT-ADJUSTMENT-DIRECTION
  5537                                            PIC X.
  5538                 88  CF-MINUS                   VALUE '-'.
  5539                 88  CF-PLUS                    VALUE '+'.
  5540             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5541             20  CF-MORT-JOINT-CODE         PIC X.
  5542                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5543             20  CF-MORT-PC-Q               PIC X.
  5544                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5545             20  CF-MORT-TABLE-CODE         PIC X(4).
  5546             20  CF-MORT-COMMENTS           PIC X(15).
  5547             20  FILLER                     PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 101
* EL131.cbl
  5548
  5549         16  FILLER                         PIC X(251).
  5550
  5551
  5552****************************************************************
  5553*             BUSSINESS TYPE MASTER RECORD                     *
  5554****************************************************************
  5555
  5556     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5557* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5558* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5559* AND RECORD 05 IS TYPES 81-99
  5560         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5561             20  CF-BUSINESS-TITLE          PIC  X(19).
  5562             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5563                                            PIC S9V9(4) COMP-3.
  5564             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5565             20  FILLER                     PIC  X.
  5566         16  FILLER                         PIC  X(248).
  5567
  5568
  5569****************************************************************
  5570*             TERMINAL MASTER RECORD                           *
  5571****************************************************************
  5572
  5573     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5574
  5575         16  CF-COMPANY-TERMINALS.
  5576             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5577                                  PIC X(4).
  5578         16  FILLER               PIC X(248).
  5579
  5580
  5581****************************************************************
  5582*             LIFE EDIT MASTER RECORD                          *
  5583****************************************************************
  5584
  5585     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5586         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5587             20  CF-LIFE-CODE-IN            PIC XX.
  5588             20  CF-LIFE-CODE-OUT           PIC XX.
  5589         16  FILLER                         PIC X(248).
  5590
  5591
  5592****************************************************************
  5593*             AH EDIT MASTER RECORD                            *
  5594****************************************************************
  5595
  5596     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5597         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5598             20  CF-AH-CODE-IN              PIC XXX.
  5599             20  CF-AH-CODE-OUT             PIC XX.
  5600         16  FILLER                         PIC X(248).
  5601
  5602
  5603****************************************************************
  5604*             CREDIBILITY TABLES                               *
  5605****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 102
* EL131.cbl
  5606
  5607     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5608         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5609                             INDEXED BY CF-CRDB-NDX.
  5610             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5611             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5612             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5613         16  FILLER                         PIC  X(332).
  5614
  5615
  5616****************************************************************
  5617*             REPORT CUSTOMIZATION RECORD                      *
  5618****************************************************************
  5619
  5620     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5621         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5622             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5623             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5624             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5625**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5626****       A T-TRANSFER.                                   ****
  5627             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5628
  5629         16  FILLER                         PIC XX.
  5630
  5631         16  CF-CARRIER-CNTL-OPT.
  5632             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5633                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5634                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5635             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5636                                            PIC X.
  5637         16  CF-GROUP-CNTL-OPT.
  5638             20  CF-GROUP-OPT-SEQ           PIC 9.
  5639                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5640                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5641             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5642                                            PIC X(6).
  5643         16  CF-STATE-CNTL-OPT.
  5644             20  CF-STATE-OPT-SEQ           PIC 9.
  5645                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5646                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5647             20  CF-STATE-SELECT OCCURS 3 TIMES
  5648                                            PIC XX.
  5649         16  CF-ACCOUNT-CNTL-OPT.
  5650             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5651                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5652                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5653             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5654                                            PIC X(10).
  5655         16  CF-BUS-TYP-CNTL-OPT.
  5656             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5657                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5658                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5659             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5660                                            PIC XX.
  5661         16  CF-LF-TYP-CNTL-OPT.
  5662             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5663                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 103
* EL131.cbl
  5664                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5665             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5666                                            PIC XX.
  5667         16  CF-AH-TYP-CNTL-OPT.
  5668             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5669                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5670                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5671             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5672                                            PIC XX.
  5673         16  CF-REPTCD1-CNTL-OPT.
  5674             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5675                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5676                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5677             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5678                                            PIC X(10).
  5679         16  CF-REPTCD2-CNTL-OPT.
  5680             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5681                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5682                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5683             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5684                                            PIC X(10).
  5685         16  CF-USER1-CNTL-OPT.
  5686             20  CF-USER1-OPT-SEQ           PIC 9.
  5687                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5688                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5689             20  CF-USER1-SELECT OCCURS 3 TIMES
  5690                                            PIC X(10).
  5691         16  CF-USER2-CNTL-OPT.
  5692             20  CF-USER2-OPT-SEQ           PIC 9.
  5693                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5694                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5695             20  CF-USER2-SELECT OCCURS 3 TIMES
  5696                                            PIC X(10).
  5697         16  CF-USER3-CNTL-OPT.
  5698             20  CF-USER3-OPT-SEQ           PIC 9.
  5699                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5700                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5701             20  CF-USER3-SELECT OCCURS 3 TIMES
  5702                                            PIC X(10).
  5703         16  CF-USER4-CNTL-OPT.
  5704             20  CF-USER4-OPT-SEQ           PIC 9.
  5705                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5706                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5707             20  CF-USER4-SELECT OCCURS 3 TIMES
  5708                                            PIC X(10).
  5709         16  CF-USER5-CNTL-OPT.
  5710             20  CF-USER5-OPT-SEQ           PIC 9.
  5711                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5712                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5713             20  CF-USER5-SELECT OCCURS 3 TIMES
  5714                                            PIC X(10).
  5715         16  CF-REINS-CNTL-OPT.
  5716             20  CF-REINS-OPT-SEQ           PIC 9.
  5717                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5718                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5719             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5720                 24  CF-REINS-PRIME         PIC XXX.
  5721                 24  CF-REINS-SUB           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 104
* EL131.cbl
  5722
  5723         16  CF-AGENT-CNTL-OPT.
  5724             20  CF-AGENT-OPT-SEQ           PIC 9.
  5725                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5726                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5727             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5728                                            PIC X(10).
  5729
  5730         16  FILLER                         PIC X(43).
  5731
  5732         16  CF-LOSS-RATIO-SELECT.
  5733             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5734             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5735         16  CF-ENTRY-DATE-SELECT.
  5736             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5737             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5738         16  CF-EFFECTIVE-DATE-SELECT.
  5739             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5740             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5741
  5742         16  CF-EXCEPTION-LIST-IND          PIC X.
  5743             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5744
  5745         16  FILLER                         PIC X(318).
  5746
  5747****************************************************************
  5748*                  EXCEPTION REPORTING RECORD                  *
  5749****************************************************************
  5750
  5751     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5752         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5753             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5754
  5755         16  CF-COMBINED-LIFE-AH-OPT.
  5756             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5757             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5758             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5759             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5760
  5761         16  CF-LIFE-OPT.
  5762             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5763             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5764             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5765             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5766             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5767             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5768             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5769             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5770             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5771             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5772
  5773         16  CF-AH-OPT.
  5774             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5775             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5776             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5777             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5778             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5779             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 105
* EL131.cbl
  5780             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5781             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5782             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5783             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5784
  5785         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5786             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5787             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5788             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5789
  5790         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5791
  5792         16  FILLER                         PIC X(673).
  5793
  5794
  5795****************************************************************
  5796*             MORTGAGE SYSTEM PLAN RECORD                      *
  5797****************************************************************
  5798
  5799     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5800         16  CF-PLAN-TYPE                   PIC X.
  5801             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5802             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5803             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5804         16  CF-PLAN-ABBREV                 PIC XXX.
  5805         16  CF-PLAN-DESCRIPT               PIC X(10).
  5806         16  CF-PLAN-NOTES                  PIC X(20).
  5807         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5808         16  CF-PLAN-UNDERWRITING.
  5809             20  CF-PLAN-TERM-DATA.
  5810                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5811                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5812             20  CF-PLAN-AGE-DATA.
  5813                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5814                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5815                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5816             20  CF-PLAN-BENEFIT-DATA.
  5817                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5818                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5819                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5820                                            PIC S9(7)V99  COMP-3.
  5821         16  CF-PLAN-POLICY-FORMS.
  5822             20  CF-POLICY-FORM             PIC X(12).
  5823             20  CF-MASTER-APPLICATION      PIC X(12).
  5824             20  CF-MASTER-POLICY           PIC X(12).
  5825         16  CF-PLAN-RATING.
  5826             20  CF-RATE-CODE               PIC X(5).
  5827             20  CF-SEX-RATING              PIC X.
  5828                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5829                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5830             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5831             20  CF-SUB-STD-TYPE            PIC X.
  5832                 88  CF-PCT-OF-PREM            VALUE '1'.
  5833                 88  CF-PCT-OF-BENE            VALUE '2'.
  5834         16  CF-PLAN-PREM-TOLERANCES.
  5835             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5836             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5837         16  CF-PLAN-PYMT-TOLERANCES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 106
* EL131.cbl
  5838             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5839             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5840         16  CF-PLAN-MISC-DATA.
  5841             20  FILLER                     PIC X.
  5842             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5843             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5844         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5845         16  CF-PLAN-IND-GRP                PIC X.
  5846             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5847                                                     '1'.
  5848             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5849                                                     '2'.
  5850         16  CF-MIB-SEARCH-SW               PIC X.
  5851             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5852             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5853             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5854             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5855         16  CF-ALPHA-SEARCH-SW             PIC X.
  5856             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5857             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5858             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5859             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5860             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5861             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5862             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5863             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5864             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5865             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5866                                                     'A' 'B' 'C'
  5867                                                     'X' 'Y' 'Z'.
  5868         16  CF-EFF-DT-RULE-SW              PIC X.
  5869             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5870             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5871             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5872             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5873             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5874         16  FILLER                         PIC X(4).
  5875         16  CF-HEALTH-QUESTIONS            PIC X.
  5876             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5877         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5878         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5879         16  CF-PLAN-SNGL-JNT               PIC X.
  5880             88  CF-COMBINED-PLAN              VALUE 'C'.
  5881             88  CF-JNT-PLAN                   VALUE 'J'.
  5882             88  CF-SNGL-PLAN                  VALUE 'S'.
  5883         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5884         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5885         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5886         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5887         16  CF-RERATE-CNTL                 PIC  X.
  5888             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5889             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5890             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5891             88  CF-AUTO-RECALC                 VALUE '4'.
  5892         16  CF-BENEFIT-TYPE                PIC  X.
  5893             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5894             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5895         16  CF-POLICY-FEE                  PIC S999V99
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 107
* EL131.cbl
  5896                                                    COMP-3.
  5897         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5898         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5899         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5900         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5901         16  FILLER                         PIC  X(32).
  5902         16  CF-TERMINATION-FORM            PIC  X(04).
  5903         16  FILLER                         PIC  X(08).
  5904         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5905                                                       COMP-3.
  5906         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5907         16  CF-ISSUE-LETTER                PIC  X(4).
  5908         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5909         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5910             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5911             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5912         16  CF-MP-REFUND-CALC              PIC X.
  5913             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5914             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5915             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5916             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5917             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5918             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5919             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5920             88  CF-MP-REFD-MEAN                VALUE '8'.
  5921         16  CF-ALT-RATE-CODE               PIC  X(5).
  5922
  5923
  5924         16  FILLER                         PIC X(498).
  5925****************************************************************
  5926*             MORTGAGE COMPANY MASTER RECORD                   *
  5927****************************************************************
  5928
  5929     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5930         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5931         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5932             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5933             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5934             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5935             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5936             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5937
  5938         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5939         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5940         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5941         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5942         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5943
  5944         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5945             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5946         16  CF-MP-RECON-USE-IND            PIC X(1).
  5947             88  CF-MP-USE-RECON             VALUE 'Y'.
  5948         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5949             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5950         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5951             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5952             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5953         16  FILLER                         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 108
* EL131.cbl
  5954         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5955             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5956         16  CF-MORTG-MIB-VERSION           PIC X.
  5957             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5958             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5959             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5960         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5961             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5962                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5963             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5964                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5965             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5966                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5967             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5968                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5969             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5970                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5971             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5972                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5973         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5974         16  FILLER                         PIC X(7).
  5975         16  CF-MORTG-DESTINATION-SYMBOL.
  5976             20  CF-MORTG-MIB-COMM          PIC X(5).
  5977             20  CF-MORTG-MIB-TERM          PIC X(5).
  5978         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5979             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5980         16  FILLER                         PIC X(03).
  5981         16  CF-MP-CHECK-NO-CONTROL.
  5982             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5983                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5984                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5985                                                ' ' LOW-VALUES.
  5986                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5987                                               VALUE '3'.
  5988         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5989         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5990         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5991             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5992                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5993             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5994                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5995             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5996                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5997             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5998                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5999             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6000                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6001             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6002                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6003         16  CF-MORTG-BILLING-AREA.
  6004             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6005                                            PIC X.
  6006         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6007         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6008         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6009         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6010             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6011             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 109
* EL131.cbl
  6012         16  FILLER                         PIC X.
  6013         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6014             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6015             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6016         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6017         16  FILLER                         PIC X(8).
  6018         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6019         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6020         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6021         16  CF-ACH-COMPANY-ID.
  6022             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6023                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6024                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6025                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6026             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6027         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6028             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6029         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6030             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6031             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6032         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6033         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6034         16  FILLER                         PIC X(536).
  6035
  6036****************************************************************
  6037*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6038****************************************************************
  6039
  6040     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6041         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6042             20  CF-FEMALE-HEIGHT.
  6043                 24  CF-FEMALE-FT           PIC 99.
  6044                 24  CF-FEMALE-IN           PIC 99.
  6045             20  CF-FEMALE-MIN-WT           PIC 999.
  6046             20  CF-FEMALE-MAX-WT           PIC 999.
  6047         16  FILLER                         PIC X(428).
  6048
  6049     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6050         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6051             20  CF-MALE-HEIGHT.
  6052                 24  CF-MALE-FT             PIC 99.
  6053                 24  CF-MALE-IN             PIC 99.
  6054             20  CF-MALE-MIN-WT             PIC 999.
  6055             20  CF-MALE-MAX-WT             PIC 999.
  6056         16  FILLER                         PIC X(428).
  6057******************************************************************
  6058*             AUTOMATIC ACTIVITY RECORD                          *
  6059******************************************************************
  6060     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6061         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6062             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6063             20  CF-SYS-LETTER-ID           PIC X(04).
  6064             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6065             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6066             20  CF-SYS-RESET-SW            PIC X(01).
  6067             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6068             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6069
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 110
* EL131.cbl
  6070         16  FILLER                         PIC X(50).
  6071
  6072         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6073             20  CF-USER-ACTIVE-SW          PIC X(01).
  6074             20  CF-USER-LETTER-ID          PIC X(04).
  6075             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6076             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6077             20  CF-USER-RESET-SW           PIC X(01).
  6078             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6079             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6080             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6081
  6082         16  FILLER                         PIC X(246).
  6083
  6084*                                COPY ELCACTQ.
  6085******************************************************************
  6086*                                                                *
  6087*                            ELCACTQ.                            *
  6088*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6089*                            VMOD=2.004                          *
  6090*                                                                *
  6091*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6092*                                                                *
  6093*   FILE TYPE = VSAM,KSDS                                        *
  6094*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6095*                                                                *
  6096*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6097*       ALTERNATE INDEX = NONE                                   *
  6098*                                                                *
  6099*   LOG = YES                                                    *
  6100*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6101*                                                                *
  6102*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6103******************************************************************
  6104
  6105 01  ACTIVITY-QUE.
  6106     12  AQ-RECORD-ID                PIC XX.
  6107         88  VALID-AQ-ID                VALUE 'AQ'.
  6108
  6109     12  AQ-CONTROL-PRIMARY.
  6110         16  AQ-COMPANY-CD           PIC X.
  6111         16  AQ-CARRIER              PIC X.
  6112         16  AQ-CLAIM-NO             PIC X(7).
  6113         16  AQ-CERT-NO.
  6114             20  AQ-CERT-PRIME       PIC X(10).
  6115             20  AQ-CERT-SFX         PIC X.
  6116
  6117     12  AQ-PENDING-ACTIVITY-FLAGS.
  6118         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6119         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6120             88  PENDING-PAYMENTS       VALUE '1'.
  6121         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6122             88  PENDING-FULL-PRINT     VALUE '1'.
  6123             88  PENDING-PART-PRINT     VALUE '2'.
  6124         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6125             88  PENDING-LETTERS        VALUE '1'.
  6126         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6127             88  PENDING-RESTORE        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 111
* EL131.cbl
  6128             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6129
  6130     12  FILLER                      PIC X(20).
  6131
  6132     12  AQ-RESEND-DATE              PIC XX.
  6133     12  AQ-FOLLOWUP-DATE            PIC XX.
  6134     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6135     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6136     12  AQ-AUTO-LETTER              PIC X(4).
  6137     12  FILLER                      PIC XX.
  6138     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6139*****************************************************************
  6140
  6141*                                COPY ERCACCT.
  6142******************************************************************
  6143*                                                                *
  6144*                                                                *
  6145*                            ERCACCT                             *
  6146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6147*                            VMOD=2.031                          *
  6148*                                                                *
  6149*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6150*                                                                *
  6151*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6152*   VSAM ACCOUNT MASTER FILES.                                   *
  6153*                                                                *
  6154*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6155*                                                                *
  6156*   FILE TYPE = VSAM,KSDS                                        *
  6157*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6158*                                                                *
  6159*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6160*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6161*                                                                *
  6162*   LOG = NO                                                     *
  6163*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6164*                                                                *
  6165*                                                                *
  6166******************************************************************
  6167*                   C H A N G E   L O G
  6168*
  6169* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6170*-----------------------------------------------------------------
  6171*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6172* EFFECTIVE    NUMBER
  6173*-----------------------------------------------------------------
  6174* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6175* 092705    2005050300006  PEMA  ADD SPP LEASES
  6176* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6177* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6178* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6179* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6180* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6181******************************************************************
  6182
  6183 01  ACCOUNT-MASTER.
  6184     12  AM-RECORD-ID                      PIC XX.
  6185         88  VALID-AM-ID                      VALUE 'AM'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 112
* EL131.cbl
  6186
  6187     12  AM-CONTROL-PRIMARY.
  6188         16  AM-COMPANY-CD                 PIC X.
  6189         16  AM-MSTR-CNTRL.
  6190             20  AM-CONTROL-A.
  6191                 24  AM-CARRIER            PIC X.
  6192                 24  AM-GROUPING.
  6193                     28 AM-GROUPING-PREFIX PIC XXX.
  6194                     28 AM-GROUPING-PRIME  PIC XXX.
  6195                 24  AM-STATE              PIC XX.
  6196                 24  AM-ACCOUNT.
  6197                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6198                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6199             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6200                                           PIC X(19).
  6201             20  AM-CNTRL-B.
  6202                 24  AM-EXPIRATION-DT      PIC XX.
  6203                 24  FILLER                PIC X(4).
  6204             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6205                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6206
  6207     12  AM-CONTROL-BY-VAR-GRP.
  6208         16  AM-COMPANY-CD-A1              PIC X.
  6209         16  AM-VG-CARRIER                 PIC X.
  6210         16  AM-VG-GROUPING                PIC X(6).
  6211         16  AM-VG-STATE                   PIC XX.
  6212         16  AM-VG-ACCOUNT                 PIC X(10).
  6213         16  AM-VG-DATE.
  6214             20  AM-VG-EXPIRATION-DT       PIC XX.
  6215             20  FILLER                    PIC X(4).
  6216         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6217                                           PIC 9(11)      COMP-3.
  6218     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6219         16  FILLER                        PIC X(10).
  6220         16  AM-VG-KEY3.
  6221             20  AM-VG3-ACCOUNT            PIC X(10).
  6222             20  AM-VG3-EXP-DT             PIC XX.
  6223         16  FILLER                        PIC X(4).
  6224     12  AM-MAINT-INFORMATION.
  6225         16  AM-LAST-MAINT-DT              PIC XX.
  6226         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6227         16  AM-LAST-MAINT-USER            PIC X(4).
  6228         16  FILLER                        PIC XX.
  6229
  6230     12  AM-EFFECTIVE-DT                   PIC XX.
  6231     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6232
  6233     12  AM-PREV-DATES  COMP-3.
  6234         16  AM-PREV-EXP-DT                PIC 9(11).
  6235         16  AM-PREV-EFF-DT                PIC 9(11).
  6236
  6237     12  AM-REPORT-CODE-1                  PIC X(10).
  6238     12  AM-REPORT-CODE-2                  PIC X(10).
  6239
  6240     12  AM-CITY-CODE                      PIC X(4).
  6241     12  AM-COUNTY-PARISH                  PIC X(6).
  6242
  6243     12  AM-NAME                           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 113
* EL131.cbl
  6244     12  AM-PERSON                         PIC X(30).
  6245     12  AM-ADDRS                          PIC X(30).
  6246     12  AM-CITY.
  6247         16  AM-ADDR-CITY                  PIC X(28).
  6248         16  AM-ADDR-STATE                 PIC XX.
  6249     12  AM-ZIP.
  6250         16  AM-ZIP-PRIME.
  6251             20  AM-ZIP-PRI-1ST            PIC X.
  6252                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6253             20  FILLER                    PIC X(4).
  6254         16  AM-ZIP-PLUS4                  PIC X(4).
  6255     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6256         16  AM-CAN-POSTAL-1               PIC XXX.
  6257         16  AM-CAN-POSTAL-2               PIC XXX.
  6258         16  FILLER                        PIC XXX.
  6259     12  AM-TEL-NO.
  6260         16  AM-AREA-CODE                  PIC 999.
  6261         16  AM-TEL-PRE                    PIC 999.
  6262         16  AM-TEL-NBR                    PIC 9(4).
  6263     12  AM-TEL-LOC                        PIC X.
  6264         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6265         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6266
  6267     12  AM-COMM-STRUCTURE.
  6268         16  AM-DEFN-1.
  6269             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6270                 24  AM-AGT.
  6271                     28  AM-AGT-PREFIX     PIC X(4).
  6272                     28  AM-AGT-PRIME      PIC X(6).
  6273                 24  AM-COM-TYP            PIC X.
  6274                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6275                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6276                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6277                 24  AM-RECALC-LV-INDIC    PIC X.
  6278                 24  AM-RETRO-LV-INDIC     PIC X.
  6279                 24  AM-GL-CODES           PIC X.
  6280                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6281                 24  FILLER                PIC X(01).
  6282         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6283             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6284                 24  FILLER                PIC X(11).
  6285                 24  AM-L-COMA             PIC XXX.
  6286                 24  AM-J-COMA             PIC XXX.
  6287                 24  AM-A-COMA             PIC XXX.
  6288                 24  FILLER                PIC X(6).
  6289
  6290     12  AM-COMM-CHANGE-STATUS             PIC X.
  6291         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6292
  6293     12  AM-CSR-CODE                       PIC X(4).
  6294
  6295     12  AM-BILLING-STATUS                 PIC X.
  6296         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6297         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6298     12  AM-AUTO-REFUND-SW                 PIC X.
  6299         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6300         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6301     12  AM-GPCD                           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 114
* EL131.cbl
  6302     12  AM-IG                             PIC X.
  6303         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6304         88  AM-HAS-GROUP                     VALUE '2'.
  6305     12  AM-STATUS                         PIC X.
  6306         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6307         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6308         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6309         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6310         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6311         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6312     12  AM-REMIT-TO                       PIC 99.
  6313     12  AM-ID-NO                          PIC X(11).
  6314
  6315     12  AM-CAL-TABLE                      PIC XX.
  6316     12  AM-LF-DEVIATION                   PIC XXX.
  6317     12  AM-AH-DEVIATION                   PIC XXX.
  6318     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6319     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6320     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6321     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6322     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6323     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6324
  6325     12  AM-USER-FIELDS.
  6326         16  AM-FLD-1                      PIC XX.
  6327         16  AM-FLD-2                      PIC XX.
  6328         16  AM-FLD-3                      PIC XX.
  6329         16  AM-FLD-4                      PIC XX.
  6330         16  AM-FLD-5                      PIC XX.
  6331
  6332     12  AM-1ST-PROD-DATE.
  6333         16  AM-1ST-PROD-YR                PIC XX.
  6334         16  AM-1ST-PROD-MO                PIC XX.
  6335         16  AM-1ST-PROD-DA                PIC XX.
  6336     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6337     12  AM-CERTS-PURGED-DATE.
  6338         16  AM-PUR-YR                     PIC XX.
  6339         16  AM-PUR-MO                     PIC XX.
  6340         16  AM-PUR-DA                     PIC XX.
  6341     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6342     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6343     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6344     12  AM-INACTIVE-DATE.
  6345         16  AM-INA-MO                     PIC 99.
  6346         16  AM-INA-DA                     PIC 99.
  6347         16  AM-INA-YR                     PIC 99.
  6348     12  AM-AR-HI-CERT-DATE                PIC XX.
  6349
  6350     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6351     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6352
  6353     12  AM-OB-PAYMENT-MODE                PIC X.
  6354         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6355         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6356         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6357         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6358
  6359     12  AM-AH-ONLY-INDICATOR              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 115
* EL131.cbl
  6360         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6361         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6362
  6363     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6364
  6365     12  AM-OVER-SHORT.
  6366         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6367         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6368
  6369     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6370     12  AM-DCC-CLP-STATE                  PIC XX.
  6371
  6372     12  AM-RECALC-COMM                    PIC X.
  6373     12  AM-RECALC-REIN                    PIC X.
  6374
  6375     12  AM-REI-TABLE                      PIC XXX.
  6376     12  AM-REI-ET-LF                      PIC X.
  6377     12  AM-REI-ET-AH                      PIC X.
  6378     12  AM-REI-PE-LF                      PIC X.
  6379     12  AM-REI-PE-AH                      PIC X.
  6380     12  AM-REI-PRT-ST                     PIC X.
  6381     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6382     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6383     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6384     12  AM-REI-GROUP-A                    PIC X(6).
  6385     12  AM-REI-MORT                       PIC X(4).
  6386     12  AM-REI-PRT-OW                     PIC X.
  6387     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6388     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6389     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6390     12  AM-REI-GROUP-B                    PIC X(6).
  6391
  6392     12  AM-TRUST-TYPE                     PIC X(2).
  6393
  6394     12  AM-EMPLOYER-STMT-USED             PIC X.
  6395     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6396
  6397     12  AM-STD-AH-TYPE                    PIC XX.
  6398     12  AM-EARN-METHODS.
  6399         16  AM-EARN-METHOD-R              PIC X.
  6400             88 AM-REF-RL-R78                 VALUE 'R'.
  6401             88 AM-REF-RL-PR                  VALUE 'P'.
  6402             88 AM-REF-RL-MEAN                VALUE 'M'.
  6403             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6404         16  AM-EARN-METHOD-L              PIC X.
  6405             88 AM-REF-LL-R78                 VALUE 'R'.
  6406             88 AM-REF-LL-PR                  VALUE 'P'.
  6407             88 AM-REF-LL-MEAN                VALUE 'M'.
  6408             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6409         16  AM-EARN-METHOD-A              PIC X.
  6410             88 AM-REF-AH-R78                 VALUE 'R'.
  6411             88 AM-REF-AH-PR                  VALUE 'P'.
  6412             88 AM-REF-AH-MEAN                VALUE 'M'.
  6413             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6414             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6415             88 AM-REF-AH-NET                 VALUE 'N'.
  6416
  6417     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 116
* EL131.cbl
  6418     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6419     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6420
  6421     12  AM-RET-Y-N                        PIC X.
  6422     12  AM-RET-P-E                        PIC X.
  6423     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6424     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6425     12  AM-RET-GRP                        PIC X(6).
  6426     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6427         16  AM-POOL-PRIME                 PIC XXX.
  6428         16  AM-POOL-SUB                   PIC XXX.
  6429     12  AM-RETRO-EARNINGS.
  6430         16  AM-RET-EARN-R                 PIC X.
  6431         16  AM-RET-EARN-L                 PIC X.
  6432         16  AM-RET-EARN-A                 PIC X.
  6433     12  AM-RET-ST-TAX-USE                 PIC X.
  6434         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6435         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6436     12  AM-RETRO-BEG-EARNINGS.
  6437         16  AM-RET-BEG-EARN-R             PIC X.
  6438         16  AM-RET-BEG-EARN-L             PIC X.
  6439         16  AM-RET-BEG-EARN-A             PIC X.
  6440     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6441     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6442
  6443     12  AM-USER-SELECT-OPTIONS.
  6444         16  AM-USER-SELECT-1              PIC X(10).
  6445         16  AM-USER-SELECT-2              PIC X(10).
  6446         16  AM-USER-SELECT-3              PIC X(10).
  6447         16  AM-USER-SELECT-4              PIC X(10).
  6448         16  AM-USER-SELECT-5              PIC X(10).
  6449
  6450     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6451
  6452     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6453
  6454     12  AM-RPT045A-SWITCH                 PIC X.
  6455         88  RPT045A-OFF                   VALUE 'N'.
  6456
  6457     12  AM-INSURANCE-LIMITS.
  6458         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6459         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6460
  6461     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6462         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6463
  6464     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6465         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6466         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6467
  6468     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6469
  6470     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6471     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6472     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6473     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6474     12  AM-DCC-UEF-STATE                  PIC XX.
  6475     12  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 117
* EL131.cbl
  6476     12  AM-REPORT-CODE-3                  PIC X(10).
  6477*    12  FILLER                            PIC X(22).
  6478
  6479     12  AM-RESERVE-DATE.
  6480         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6481         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6482         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6483
  6484     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6485     12  AM-NOTIFICATION-TYPES.
  6486         16  AM-NOTIF-OF-LETTERS           PIC X.
  6487         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6488         16  AM-NOTIF-OF-REPORTS           PIC X.
  6489         16  AM-NOTIF-OF-STATUS            PIC X.
  6490
  6491     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6492         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6493         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6494         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6495         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6496
  6497     12  AM-BENEFIT-CONTROLS.
  6498         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6499             20  AM-BENEFIT-CODE           PIC XX.
  6500             20  AM-BENEFIT-TYPE           PIC X.
  6501             20  AM-BENEFIT-REVISION       PIC XXX.
  6502             20  AM-BENEFIT-REM-TERM       PIC X.
  6503             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6504             20  FILLER                    PIC XX.
  6505         16  FILLER                        PIC X(80).
  6506
  6507     12  AM-TRANSFER-DATA.
  6508         16  AM-TRANSFERRED-FROM.
  6509             20  AM-TRNFROM-CARRIER        PIC X.
  6510             20  AM-TRNFROM-GROUPING.
  6511                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6512                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6513             20  AM-TRNFROM-STATE          PIC XX.
  6514             20  AM-TRNFROM-ACCOUNT.
  6515                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6516                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6517             20  AM-TRNFROM-DTE            PIC XX.
  6518         16  AM-TRANSFERRED-TO.
  6519             20  AM-TRNTO-CARRIER          PIC X.
  6520             20  AM-TRNTO-GROUPING.
  6521                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6522                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6523             20  AM-TRNTO-STATE            PIC XX.
  6524             20  AM-TRNTO-ACCOUNT.
  6525                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6526                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6527             20  AM-TRNTO-DTE              PIC XX.
  6528         16  FILLER                        PIC X(10).
  6529
  6530     12  AM-SAVED-REMIT-TO                 PIC 99.
  6531
  6532     12  AM-COMM-STRUCTURE-SAVED.
  6533         16  AM-DEFN-1-SAVED.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 118
* EL131.cbl
  6534             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6535                 24  AM-AGT-SV             PIC X(10).
  6536                 24  AM-COM-TYP-SV         PIC X.
  6537                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6538                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6539                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6540                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6541                 24  FILLER                PIC X.
  6542                 24  AM-GL-CODES-SV        PIC X.
  6543                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6544                 24  FILLER                PIC X.
  6545         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6546             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6547                 24  FILLER                PIC X(11).
  6548                 24  AM-L-COMA-SV          PIC XXX.
  6549                 24  AM-J-COMA-SV          PIC XXX.
  6550                 24  AM-A-COMA-SV          PIC XXX.
  6551                 24  FILLER                PIC X(6).
  6552
  6553     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6554         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6555            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6556            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6557            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6558
  6559     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6560     12  FILLER                            PIC X(120).
  6561
  6562     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6563         16  AM-CONTROL-NAME               PIC X(30).
  6564         16  AM-EXECUTIVE-ONE.
  6565             20  AM-EXEC1-NAME             PIC X(15).
  6566             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6567                                                          COMP-3.
  6568             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6569                                                          COMP-3.
  6570         16  AM-EXECUTIVE-TWO.
  6571             20  AM-EXEC2-NAME             PIC X(15).
  6572             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6573                                                          COMP-3.
  6574             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6575                                                          COMP-3.
  6576
  6577     12  AM-RETRO-ADDITIONAL-DATA.
  6578         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6579         16  AM-RETRO-PREM-P-E             PIC X.
  6580         16  AM-RETRO-CLMS-P-I             PIC X.
  6581         16  AM-RETRO-RET-BRACKET-LF.
  6582             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6583                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6584                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6585             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6586                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6587                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6588             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6589                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6590                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6591         16  AM-RETRO-RET-BRACKET-AH.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 119
* EL131.cbl
  6592             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6593                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6594                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6595                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6596             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6597                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6598                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6599             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6600                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6601                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6602
  6603     12  AM-COMMENTS.
  6604         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6605
  6606     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6607         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6608         16  AM-FLI-BILLING-CODE           PIC X.
  6609         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6610         16  AM-FLI-UNITED-IDENT           PIC X.
  6611         16  AM-FLI-INTEREST-LOST-DATA.
  6612             20  AM-FLI-BANK-NO            PIC X(5).
  6613             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6614             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6615             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6616         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6617             20  AM-FLI-AGT                PIC X(9).
  6618             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6619             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6620         16  FILLER                        PIC X(102).
  6621
  6622     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6623         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6624             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6625             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6626             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6627             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6628             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6629         16  FILLER                          PIC X(10).
  6630******************************************************************
  6631
  6632*                                COPY ELCCHKQ.
  6633******************************************************************
  6634*                                                                *
  6635*                                                                *
  6636*                            ELCCHKQ.                            *
  6637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6638*                            VMOD=2.007                          *
  6639*                                                                *
  6640*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6641*                                                                *
  6642*   FILE TYPE = VSAM,KSDS                                        *
  6643*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6644*                                                                *
  6645*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6646*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6647*                                                                *
  6648*   LOG = YES                                                    *
  6649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 120
* EL131.cbl
  6650******************************************************************
  6651 01  CHECK-QUE.
  6652     12  CQ-RECORD-ID                PIC XX.
  6653         88  VALID-CQ-ID         VALUE 'CQ'.
  6654
  6655     12  CQ-CONTROL-PRIMARY.
  6656         16  CQ-COMPANY-CD           PIC X.
  6657         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6658         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6659
  6660     12  CQ-CONTROL-BY-PAYEE.
  6661         16  CQ-CONTROL-BY-NUMBER.
  6662             20  CQ-COMPANY-CD-A1     PIC X.
  6663             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6664         16  CQ-PAYEE-CARRIER        PIC X.
  6665         16  CQ-PAYEE-GROUPING       PIC X(6).
  6666         16  CQ-PAYEE-STATE          PIC XX.
  6667         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6668         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6669
  6670     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6671         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6672         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6673         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6674         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6675         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6676         16  FILLER                  PIC X(3).
  6677
  6678     12  CQ-ENTRY-TYPE               PIC X.
  6679             88  CHECK-ON-QUE           VALUE 'Q'.
  6680             88  ALIGNMENT-CHECK        VALUE 'A'.
  6681             88  SPOILED-CHECK          VALUE 'S'.
  6682             88  PAYMENT-ABORTED        VALUE 'X'.
  6683
  6684     12  CQ-CLAIM-MAST-CNTL.
  6685         16  CQ-CARRIER              PIC X.
  6686         16  CQ-CLAIM-NO             PIC X(7).
  6687         16  CQ-CERT-NO.
  6688             20  CQ-CERT-PRIME       PIC X(10).
  6689             20  CQ-CERT-SFX         PIC X.
  6690         16  CQ-CLAIM-TYPE           PIC X.
  6691             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6692             88  CQ-AH-CLAIM            VALUE 'A'.
  6693         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6694             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6695             88  CQ-O-B-COVERAGE        VALUE '2'.
  6696             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6697
  6698     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6699     12  CQ-CHECK-NUMBER             PIC X(7).
  6700     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6701     12  CQ-PAYMENT-TYPE             PIC X.
  6702             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6703             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6704             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6705             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6706             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6707             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 121
* EL131.cbl
  6708             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6709             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6710     12  CQ-VOID-INDICATOR           PIC X.
  6711             88  CHECK-IS-STOPPED          VALUE 'S'.
  6712             88  CHECK-IS-VOID             VALUE 'V'.
  6713     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6714     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6715     12  CQ-CHECK-BY-USER            PIC X(4).
  6716     12  CQ-PRE-NUMBERING-SW         PIC X.
  6717       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6718       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6719
  6720     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6721     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6722     12  CQ-LEDGER-FLAG              PIC X(01).
  6723     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6724     12  CQ-LAST-UPDATED-DT          PIC XX.
  6725     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6726     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6727
  6728     12  FILLER                      PIC X(04).
  6729
  6730******************************************************************
  6731
  6732*                                COPY ELCARCH.
  6733******************************************************************
  6734*                                                                *
  6735*                            ELCARCH.                            *
  6736*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6737*                            VMOD=2.007                          *
  6738*                                                                *
  6739*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6740*                                                                *
  6741*   FILE TYPE = VSAM,KSDS                                        *
  6742*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6743*                                                                *
  6744*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6745*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6746*                                                                *
  6747*   LOG = NO                                                     *
  6748*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6749*                                                                *
  6750*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6751******************************************************************
  6752 01  LETTER-ARCHIVE.
  6753     12  LA-RECORD-ID                PIC XX.
  6754         88  VALID-LA-ID                VALUE 'LA'.
  6755
  6756     12  LA-CONTROL-PRIMARY.
  6757         16  LA-COMPANY-CD           PIC X.
  6758         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6759         16  LA-RECORD-TYPE          PIC X.
  6760             88  LA-HEADER-DATA         VALUE '1'.
  6761             88  LA-ADDRESS-DATA        VALUE '2'.
  6762             88  LA-TEXT-DATA           VALUE '3'.
  6763             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6764         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6765
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 122
* EL131.cbl
  6766     12  LA-CONTROL-BY-TYPE.
  6767         16  LA-COMPANY-CD-A1        PIC X.
  6768         16  LA-RECORD-TYPE-A1       PIC X.
  6769         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6770         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6771
  6772     12  LA-TEXT-RECORD.
  6773         16  LA-SKIP-CONTROL         PIC XX.
  6774             88  NO-LINES-SKIPPED       VALUE SPACES.
  6775             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6776         16  LA-TEXT-LINE            PIC X(70).
  6777
  6778     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6779         16  FILLER                  PIC XX.
  6780         16  LA-ADDRESS-LINE         PIC X(30).
  6781         16  FILLER                  PIC X(40).
  6782
  6783     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6784         16  FILLER                  PIC XX.
  6785         16  LA-CARRIER              PIC X.
  6786         16  LA-CLAIM-NO             PIC X(7).
  6787         16  LA-CERT-NO.
  6788             20  LA-CERT-PRIME       PIC X(10).
  6789             20  LA-CERT-SFX         PIC X.
  6790         16  LA-NO-OF-COPIES         PIC S9.
  6791         16  LA-RESEND-DATE          PIC XX.
  6792         16  LA-PROCESSOR-CD         PIC X(4).
  6793         16  LA-CREATION-DT          PIC XX.
  6794         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6795         16  LA-RESEND-PRINT-DATE    PIC XX.
  6796         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6797         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6798*
  6799* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6800*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6801*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6802*   I        20  LA-DMD-RES-ST           PIC XX.
  6803*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6804*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6805*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6806*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6807*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6808*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6809*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6810*   I        20  LA-DMD-UND-CODE         PIC XX.
  6811*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6812*   V    16  FILLER                  PIC X(15).
  6813* -----
  6814*
  6815* REINSERTED  CSO  MODS
  6816*
  6817         16  FILLER.
  6818             20  FILLER                  PIC X(29).
  6819             20  LA-CSO-LETTER-STATUS    PIC X.
  6820                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6821                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6822                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6823             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 123
* EL131.cbl
  6824             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6825*
  6826
  6827     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6828         16  FILLER                  PIC XX.
  6829         16  LA4-CARRIER             PIC X.
  6830         16  LA4-CLAIM-NO            PIC X(7).
  6831         16  LA4-CERT-NO.
  6832             20  LA4-CERT-PRIME      PIC X(10).
  6833             20  LA4-CERT-SFX        PIC X.
  6834         16  LA4-NO-OF-COPIES        PIC S9.
  6835         16  LA4-RESEND-DATE         PIC XX.
  6836         16  LA4-PROCESSOR-CD        PIC X(4).
  6837         16  LA4-CREATION-DT         PIC XX.
  6838         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6839         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6840         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6841         16  LA4-FORM-TYPE           PIC X.
  6842             88  LA4-INITIAL-FORM    VALUE '1'.
  6843             88  LA4-PROGRESS-FORM   VALUE '2'.
  6844         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6845         16  LA4-STATE               PIC X(02).
  6846         16  FILLER                  PIC X(31).
  6847******************************************************************
  6848
  6849*                                COPY ELCBENE.
  6850******************************************************************
  6851*                                                                *
  6852*                            ELCBENE.                            *
  6853*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6854*                            VMOD=2.006                          *
  6855*                                                                *
  6856*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6857*                                                                *
  6858*   FILE TYPE = VSAM,KSDS                                        *
  6859*   RECORD SIZE = 500   RECFORM = FIX                            *
  6860*                                                                *
  6861*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6862*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6863*                                                                *
  6864*   LOG = YES                                                    *
  6865*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6866*                                                                *
  6867*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6868******************************************************************
  6869
  6870 01  BENEFICIARY-MASTER.
  6871     12  BE-RECORD-ID                PIC XX.
  6872         88  VALID-BE-ID                VALUE 'BE'.
  6873
  6874     12  BE-CONTROL-PRIMARY.
  6875         16  BE-COMPANY-CD           PIC X.
  6876         16  BE-RECORD-TYPE          PIC X.
  6877             88  BENEFICIARY-RECORD  VALUE 'B'.
  6878             88  ADJUSTOR-RECORD     VALUE 'A'.
  6879         16  BE-BENEFICIARY          PIC X(10).
  6880     12  BE-CONTROL-BY-NAME.
  6881         16  BE-COMPANY-CD-A1        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 124
* EL131.cbl
  6882         16  BE-RECORD-TYPE-A1       PIC X.
  6883         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6884         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6885
  6886     12  BE-LAST-MAINT-DT            PIC XX.
  6887     12  BE-LAST-MAINT-BY            PIC X(4).
  6888     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6889
  6890     12  BE-ADDRESS-DATA.
  6891         16  BE-MAIL-TO-NAME         PIC X(30).
  6892         16  BE-ADDRESS-LINE-1       PIC X(30).
  6893         16  BE-ADDRESS-LINE-2       PIC X(30).
  6894         16  BE-ADDRESS-LINE-3       PIC X(30).
  6895         16  BE-CITY-STATE.
  6896             20  BE-CITY             PIC X(28).
  6897             20  BE-STATE            PIC XX.
  6898         16  BE-ZIP-CODE.
  6899             20  BE-ZIP-PRIME.
  6900                 24  BE-ZIP-1ST      PIC X.
  6901                     88  BE-CANADIAN-POST-CODE
  6902                                         VALUE 'A' THRU 'Z'.
  6903                 24  FILLER          PIC X(4).
  6904             20  BE-ZIP-PLUS4        PIC X(4).
  6905         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6906             20  BE-CAN-POSTAL-1     PIC XXX.
  6907             20  BE-CAN-POSTAL-2     PIC XXX.
  6908             20  FILLER              PIC XXX.
  6909         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6910         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6911
  6912******************************************************************
  6913*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6914*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6915******************************************************************
  6916     12  BE-CARRIER                  PIC X.
  6917
  6918     12  BE-ADDRESS-DATA2.
  6919         16  BE-MAIL-TO-NAME2        PIC X(30).
  6920         16  BE-ADDRESS-LINE-12      PIC X(30).
  6921         16  BE-ADDRESS-LINE-22      PIC X(30).
  6922         16  BE-ADDRESS-LINE-32      PIC X(30).
  6923         16  BE-CITY-STATE2.
  6924             20  BE-CITY2            PIC X(28).
  6925             20  BE-STATE2           PIC XX.
  6926         16  BE-ZIP-CODE2.
  6927             20  BE-ZIP-PRIME2.
  6928                 24  BE-ZIP-1ST2     PIC X.
  6929                     88  BE-CANADIAN-POST-CODE2
  6930                                         VALUE 'A' THRU 'Z'.
  6931                 24  FILLER          PIC X(4).
  6932             20  BE-ZIP-PLUS42       PIC X(4).
  6933         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6934             20  BE-CAN-POSTAL-12    PIC XXX.
  6935             20  BE-CAN-POSTAL-22    PIC XXX.
  6936             20  FILLER              PIC XXX.
  6937         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6938         16  BE-BILLING-STMT-DATA.
  6939             20  BE-BSR              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 125
* EL131.cbl
  6940                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6941                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6942             20  BE-BSR-FROM         PIC X(30).
  6943             20  BE-BSR-DEPT         PIC X(30).
  6944             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6945             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6946             20  BE-OUTPUT-TYPE      PIC X.
  6947                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6948                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6949
  6950     12  FILLER                      PIC X(28).
  6951******************************************************************
  6952
  6953*                                COPY ELCDAR.
  6954******************************************************************
  6955*                                                                *
  6956*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6957*   FILE TYPE = VSAM,KSDS                                        *
  6958*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6959*   BASE CLUSTER = DLYACTV                                       *
  6960*   LOG = YES                                                    *
  6961*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6962*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6963*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6964*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6965*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6966*               BY PROGRAM "LGINFCE".                            *
  6967*                                                                *
  6968******************************************************************
  6969 01  DAILY-ACTIVITY-RECORD.
  6970     05  DA-KEY.
  6971         10  DA-COMP-CD          PIC X.
  6972         10  DA-CARRIER          PIC X.
  6973         10  DA-CLAIM-NO         PIC X(7).
  6974         10  DA-CERT-NO.
  6975             15  DA-CERT-PRIME   PIC X(10).
  6976             15  DA-CERT-SFX     PIC X.
  6977     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6978     05  DA-RECORD-TYPE          PIC X.
  6979     05  FILLER                  PIC X(2).
  6980******************************************************************
  6981
  6982*                                COPY ELCALPH.
  6983******************************************************************
  6984*                                                                *
  6985*                            ELCALPH.                            *
  6986*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6987*                            VMOD=2.003                          *
  6988*                                                                *
  6989*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6990*                                                                *
  6991*   FILE TYPE = VSAM,KSDS                                        *
  6992*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6993*                                                                *
  6994*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6995*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6996*                                                                *
  6997*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 126
* EL131.cbl
  6998*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6999*                                                                *
  7000*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7001******************************************************************
  7002
  7003 01  ALPHA-INDEX.
  7004     12  AI-RECORD-ID                         PIC XX.
  7005         88  VALID-AI-ID                  VALUE 'AI'.
  7006     12  AI-CONTROL-PRIMARY.
  7007         16  AI-COMPANY-CD                     PIC X.
  7008         16  AI-SOURCE                         PIC X.
  7009             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7010             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7011         16  AI-NAME.
  7012             20  AI-LAST-NAME                  PIC X(15).
  7013             20  AI-FIRST-NAME.
  7014                 24  AI-FIRST-INITIAL          PIC X.
  7015                 24  FILLER                    PIC X(11).
  7016             20  AI-MIDDLE-INIT                PIC X.
  7017         16  AI-DATE                           PIC X(8).
  7018         16  AI-TIME                           PIC S9(07) COMP-3.
  7019
  7020     12  AI-CONTROL-BY-ADMIN-KEY.
  7021         16  AI-CM-COMPANY-CD                  PIC X.
  7022         16  AI-CM-SOURCE                      PIC X.
  7023         16  AI-CM-CARRIER                     PIC X.
  7024         16  AI-CM-GROUPING.
  7025             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7026             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7027         16  AI-CM-STATE                       PIC XX.
  7028         16  AI-CM-PRODUCER.
  7029             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7030             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7031         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7032         16  AI-CM-CERTIFICATE-NUMBER.
  7033             20  AI-CM-CERT-PRIME              PIC X(10).
  7034             20  AI-CM-CERT-SFX                PIC X.
  7035         16  AI-CM-DATE                        PIC X(8).
  7036         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7037         16  FILLER                            PIC X(11).
  7038
  7039     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7040         AI-CONTROL-BY-ADMIN-KEY.
  7041         16  AI-CL-COMPANY-CD                  PIC X.
  7042         16  AI-CL-SOURCE                      PIC X.
  7043         16  AI-CL-CARRIER                     PIC X.
  7044         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7045         16  AI-CL-CERTIFICATE-NUMBER.
  7046             20  AI-CL-CERT-PRIME              PIC X(10).
  7047             20  AI-CL-CERT-SFX                PIC X.
  7048         16  AI-CL-DATE                        PIC X(8).
  7049         16  AI-CL-INCURRED-DATE               PIC XX.
  7050         16  AI-CL-CLOSE-DATE                  PIC XX.
  7051         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7052         16  AI-CREDIT-CARD-NUMBER.
  7053             20  AI-CCN.
  7054                 24  AI-CCN-PREFIX             PIC X(4).
  7055                 24  AI-CCN-PRIME              PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 127
* EL131.cbl
  7056             20  AI-CCN-FILLER                 PIC X(4).
  7057
  7058     12  AI-MAINT-INFO.
  7059         16  AI-LAST-MAINT-BY                  PIC X(4).
  7060         16  AI-LAST-MAINT-DT                  PIC XX.
  7061         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7062
  7063     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7064
  7065     12  FILLER                                PIC X(15).
  7066
  7067
  7068*                                COPY ERCDMDNT.
  7069******************************************************************
  7070*                                                                *
  7071*                            ERCDMDNT                            *
  7072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7073*                            VMOD=2.005                          *
  7074*                                                                *
  7075*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7076*                                                                *
  7077*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7078*                                                                *
  7079*        FILE TYPE= VSAM,KSDS                                    *
  7080*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7081*                                                                *
  7082*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7083*                                                                *
  7084*        LOG = YES                                               *
  7085*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7086*                                                                *
  7087******************************************************************
  7088
  7089 01  CERTIFICATE-NOTE.
  7090     12  CN-RECORD-ID                     PIC  XX.
  7091         88  VALID-CN-ID                      VALUE 'CN'.
  7092
  7093     12  CN-CONTROL-PRIMARY.
  7094         16  CN-COMPANY-CD                PIC X.
  7095         16  CN-CERT-KEY.
  7096             20  CN-CARRIER               PIC X.
  7097             20  CN-GROUPING.
  7098                 24  CN-GROUPING-PREFIX   PIC XXX.
  7099                 24  CN-GROUPING-PRIME    PIC XXX.
  7100             20  CN-STATE                 PIC XX.
  7101             20  CN-ACCOUNT.
  7102                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7103                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7104             20  CN-CERT-EFF-DT           PIC XX.
  7105             20  CN-CERT-NO.
  7106                 24  CN-CERT-PRIME        PIC X(10).
  7107                 24  CN-CERT-SFX          PIC X.
  7108
  7109     12  CN-BILLING-START-LINE-NO         PIC 99.
  7110     12  CN-BILLING-END-LINE-NO           PIC 99.
  7111
  7112     12  CN-LINES.
  7113         16  CN-LINE                      PIC X(77)  OCCURS 10.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 128
* EL131.cbl
  7114
  7115     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7116         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7117         16  CN-CSI-GENERAL-DATA-AREA.
  7118             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7119
  7120         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7121             CN-CSI-GENERAL-DATA-AREA.
  7122             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7123             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7124             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7125             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7126             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7127             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7128             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7129             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7130             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7131             20  FILLER                       PIC XX.
  7132             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7133             20  FILLER                       PIC X(38).
  7134
  7135         16  CN-CSI-PRODUCT-DATA-AREA.
  7136             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7137
  7138         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7139             CN-CSI-PRODUCT-DATA-AREA.
  7140             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7141             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7142             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7143             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7144             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7145             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7146             20  FILLER                   PIC XX.
  7147             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7148             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7149             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7150             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7151             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7152             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7153             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7154             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7155             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7156             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7157             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7158             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7159             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7160             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7161             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7162             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7163             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7164             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7165             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7166             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7167             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7168             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7169             20  FILLER                   PIC X(25).
  7170
  7171         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 129
* EL131.cbl
  7172             CN-CSI-CREDIT-CARD-DATA.
  7173             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7174             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7175             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7176             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7177             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7178             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7179             20  FILLER                   PIC XX.
  7180             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7181             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7182             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7183             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7184             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7185             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7186             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7187             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7188             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7189             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7190             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7191             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7192             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7193             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7194             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7195             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7196             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7197             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7198             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7199             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7200             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7201             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7202             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7203             20  FILLER                   PIC X(17).
  7204
  7205         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7206             CN-CSI-FAMILY-LEAVE-DATA.
  7207             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7208             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7209             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7210             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7211             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7212             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7213             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7214             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7215             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7216             20  CN-CSI-SL-INT-ON-PROCEEDS
  7217                                          PIC S9(5)V99  COMP-3.
  7218             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7219             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7220             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7221             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7222             20  CN-CSI-SL-POLICY-BENEFITS
  7223                                          PIC S9(5)V99  COMP-3.
  7224             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7225             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7226             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7227             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7228             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7229             20  CN-CSI-SL-PREM-MODE      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 130
* EL131.cbl
  7230             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7231             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7232             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7233             20  CN-CSI-SL-STATE-NOT      PIC X.
  7234             20  FILLER                   PIC XX.
  7235
  7236         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7237             CN-CSI-SENIOR-LIFE-DATA.
  7238             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7239             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7240             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7241                                          PIC S9(5)V99  COMP-3.
  7242             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7243             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7244             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7245             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7246             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7247             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7248             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7249             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7250             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7251             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7252             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7253             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7254             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7255             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7256             20  CN-CSI-PP-REPAIR         PIC X.
  7257             20  CN-CSI-PP-REPLACE        PIC X.
  7258             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7259             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7260             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7261             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7262             20  FILLER                   PIC X(5).
  7263
  7264         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7265             CN-CSI-PURCH-PROP-DATA.
  7266             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7267             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7268             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7269             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7270             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7271             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7272             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7273             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7274             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7275             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7276             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7277             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7278             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7279             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7280             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7281             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7282             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7283             20  CN-CSI-EW-REPLACE        PIC X.
  7284             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7285             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7286             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7287             20  CN-CSI-EW-TERM-AGE       PIC 999.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 131
* EL131.cbl
  7288             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7289             20  FILLER                   PIC X(4).
  7290
  7291     12  CN-LAST-MAINT-DT                 PIC XX.
  7292     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7293     12  CN-LAST-MAINT-USER               PIC X(4).
  7294     12  FILLER                           PIC X(6).
  7295
  7296******************************************************************
  7297
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 132
* EL131.cbl
  7299 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7300                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7301                          CONTROL-FILE ACTIVITY-QUE
  7302                          ACCOUNT-MASTER CHECK-QUE
  7303                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7304                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7305                          CERTIFICATE-NOTE.
  7306 0000-DFHEXIT SECTION.
  7307     MOVE '9#                    $   ' TO DFHEIV0.
  7308     MOVE 'EL131' TO DFHEIV1.
  7309     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7310
  7311     IF EIBCALEN = ZERO
  7312         GO TO 8800-UNAUTHORIZED-ACCESS.
  7313
  7314     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7315     MOVE '5'                    TO DC-OPTION-CODE.
  7316     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7317     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7318     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7319     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7320
  7321     IF SAVE-DATE-YY GREATER 70
  7322         MOVE 19                 TO SAVE-DATE-CC
  7323      ELSE
  7324         MOVE 20                 TO SAVE-DATE-CC.
  7325
  7326
  7327* EXEC CICS HANDLE CONDITION
  7328*        PGMIDERR (8820-XCTL-ERROR)
  7329*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7330*        ERROR    (9990-ABEND)
  7331*    END-EXEC.
  7332*    MOVE '"$LI.                 ! " #00007322' TO DFHEIV0
  7333     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7335     MOVE X'2220233030303037333232' TO DFHEIV0(25:11)
  7336     CALL 'kxdfhei1' USING DFHEIV0
  7337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7338
  7339
  7340     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7341     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7342     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7343
  7344     INITIALIZE    EDIT-WORK-AREA.
  7345     MOVE '/'                    TO WORK-SLASH.
  7346     MOVE SPACES                 TO ERROR-SWITCHES.
  7347
  7348     MOVE TRAN-ID                TO TRANS-ID.
  7349     MOVE EIBTRMID               TO PI-TERM.
  7350     MOVE MAP-ID                 TO PI-QUAL.
  7351
  7352     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7353
  7354     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7355         MOVE LOW-VALUES         TO EL131AO
  7356         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 133
* EL131.cbl
  7357         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7358         MOVE -1                 TO MAINTL
  7359         GO TO 8110-SEND-DATA.
  7360
  7361     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7362         MOVE LOW-VALUES         TO EL131AO
  7363         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7364         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7365         MOVE 'X'                TO PI-RETURN-CD-1
  7366         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7367         MOVE -1                 TO MAINTL
  7368         IF WS-RETURNED-FROM = XCTL-EL114
  7369             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7370         END-IF
  7371         GO TO 8100-SEND-MAP.
  7372
  7373     IF EIBAID = DFHCLEAR
  7374         GO TO 8200-RETURN-PRIOR.
  7375
  7376     IF PI-PROCESSOR-ID = 'LGXX'
  7377         NEXT SENTENCE
  7378     ELSE
  7379
  7380* EXEC CICS READQ TS
  7381*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7382*            INTO    (SECURITY-CONTROL)
  7383*            LENGTH  (SC-COMM-LENGTH)
  7384*            ITEM    (SC-ITEM)
  7385*        END-EXEC
  7386*    MOVE '*$II   L              ''   #00007367' TO DFHEIV0
  7387     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7389     MOVE X'2020233030303037333637' TO DFHEIV0(25:11)
  7390     CALL 'kxdfhei1' USING DFHEIV0,
  7391           PI-SECURITY-TEMP-STORE-ID,
  7392           SECURITY-CONTROL,
  7393           SC-COMM-LENGTH,
  7394           SC-ITEM,
  7395           DFHEIV99,
  7396           DFHEIV99
  7397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7398         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7399         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7400         IF NOT DISPLAY-CAP
  7401             MOVE 'READ'               TO  SM-READ
  7402             PERFORM 9995-SECURITY-VIOLATION
  7403             MOVE ER-0070              TO  EMI-ERROR
  7404             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7405             GO TO 8100-SEND-MAP.
  7406
  7407
  7408* EXEC CICS RECEIVE
  7409*        MAP    ('EL131A')
  7410*        MAPSET ('EL131S')
  7411*    END-EXEC.
  7412     MOVE 'EL131A' TO DFHEIV1
  7413     MOVE 'EL131S' TO DFHEIV2
  7414*    MOVE '8"T                   ''   #00007382' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 134
* EL131.cbl
  7415     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7416     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7417     MOVE X'2020233030303037333832' TO DFHEIV0(25:11)
  7418     CALL 'kxdfhei1' USING DFHEIV0,
  7419           DFHEIV1,
  7420           EL131AI,
  7421           DFHEIV99,
  7422           DFHEIV2,
  7423           DFHEIV99,
  7424           DFHEIV99
  7425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7426
  7427
  7428     IF PFKEYL GREATER THAN ZERO
  7429         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7430
  7431     IF SCREEN-ERROR
  7432         MOVE ER-0004 TO EMI-ERROR
  7433         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7434         MOVE -1 TO MAINTL
  7435         GO TO 8110-SEND-DATA.
  7436
  7437     IF EIBAID = DFHPF3
  7438         GO TO 8500-TRLR-MNT.
  7439
  7440     IF EIBAID = DFHPF4
  7441         GO TO 8600-ADDR-MNT.
  7442
  7443     IF EIBAID = DFHPF5
  7444         GO TO 8700-CERT-MNT.
  7445
  7446     IF PI-COMPANY-ID = 'DMD'
  7447       IF EIBAID = DFHPF6
  7448         GO TO 8750-DMD-CLM-FIX.
  7449
  7450     IF EIBAID = DFHPF7
  7451         GO TO 4000-FORCE-ERRORS.
  7452
  7453     IF EIBAID = DFHPF12
  7454         GO TO 8300-GET-HELP.
  7455
  7456     IF EIBAID = DFHPF15
  7457         GO TO 8725-BENEFICIARY-MNT
  7458     END-IF.
  7459
  7460     IF EIBAID = DFHPF23
  7461         GO TO 8810-PF23-ENTERED.
  7462
  7463     IF EIBAID = DFHPF24
  7464         GO TO 8400-RETURN-MASTER.
  7465
  7466     IF EIBAID NOT = DFHENTER
  7467         MOVE ER-0029            TO EMI-ERROR
  7468         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7469         MOVE -1                 TO MAINTL
  7470         GO TO 8110-SEND-DATA.
  7471
  7472     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 135
* EL131.cbl
  7473         MOVE ER-0311            TO EMI-ERROR
  7474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7475         MOVE -1                 TO MAINTL
  7476         GO TO 8110-SEND-DATA.
  7477
  7478     IF MAINTI = 'A'
  7479         GO TO 0500-ADD-ALPHA-ONLY.
  7480
  7481     IF MAINTI = 'N'
  7482         GO TO 0600-CHANGE-NAME.
  7483
  7484     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7485
  7486     IF SCREEN-ERROR
  7487         GO TO 8110-SEND-DATA.
  7488
  7489     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7490         MOVE ER-0276            TO EMI-ERROR
  7491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7492         MOVE -1                 TO MAINTL
  7493         GO TO 8110-SEND-DATA.
  7494
  7495     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7496
  7497     IF SCREEN-ERROR
  7498         GO TO 8110-SEND-DATA.
  7499
  7500     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7501
  7502     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7503
  7504     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7505         GO TO 8110-SEND-DATA.
  7506
  7507     IF EMI-FATAL-CTR GREATER THAN ZERO
  7508         GO TO 8110-SEND-DATA.
  7509
  7510     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7511
  7512     IF WS-OPEN-CLOSE-SW = 'Y'
  7513         IF PI-LETTER-SW = 'Y'
  7514             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7515             MOVE 'T'            TO  CNTL-REC-TYPE
  7516             MOVE SPACES         TO  CNTL-PROC-ID
  7517             MOVE +0             TO  CNTL-SEQ-NO
  7518
  7519* EXEC CICS READ
  7520*                DATASET   (CNTL-FILE-ID)
  7521*                RIDFLD    (CNTL-KEY)
  7522*                SET       (ADDRESS OF CONTROL-FILE)
  7523*            END-EXEC
  7524*    MOVE '&"S        E          (   #00007477' TO DFHEIV0
  7525     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7526     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7527     MOVE X'2020233030303037343737' TO DFHEIV0(25:11)
  7528     CALL 'kxdfhei1' USING DFHEIV0,
  7529           CNTL-FILE-ID,
  7530           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 136
* EL131.cbl
  7531           DFHEIV99,
  7532           CNTL-KEY,
  7533           DFHEIV99,
  7534           DFHEIV99,
  7535           DFHEIV99
  7536     SET ADDRESS OF CONTROL-FILE TO
  7537         DFHEIV20
  7538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7539             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7540
  7541     MOVE ER-0000                TO EMI-ERROR.
  7542     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7543
  7544     MOVE SPACE                  TO MAINTO.
  7545     MOVE -1                     TO MAINTL.
  7546     GO TO 8100-SEND-MAP.
  7547
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 137
* EL131.cbl
  7549 0100-UPDATE-PI.
  7550
  7551     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7552     IF WS-RETURNED-FROM = XCTL-EL114
  7553***sometimes there is crap in positions 7-10 when no code was sele
  7554        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7555          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7556        END-IF
  7557     END-IF.
  7558
  7559     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7560         GO TO 0110-UPDATE-UP.
  7561
  7562     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7563     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7564     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7565     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7566     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7567     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7568     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7569     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7570     GO TO 0120-UPDATE-PI-EXIT.
  7571
  7572 0110-UPDATE-UP.
  7573     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7574     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7575     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7576     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7577     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7578     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7579     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7580     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7581
  7582
  7583* EXEC CICS HANDLE CONDITION
  7584*         QIDERR    (0130-TS-ERROR)
  7585*         ITEMERR   (0130-TS-ERROR)
  7586*    END-EXEC.
  7587*    MOVE '"$N<                  ! # #00007525' TO DFHEIV0
  7588     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7589     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7590     MOVE X'2320233030303037353235' TO DFHEIV0(25:11)
  7591     CALL 'kxdfhei1' USING DFHEIV0
  7592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7593
  7594
  7595     IF WS-RETURNED-FROM = XCTL-EL114
  7596
  7597* EXEC CICS READQ TS
  7598*            QUEUE    (PI-KEY)
  7599*            INTO     (EL131AI)
  7600*            LENGTH   (MAP-LENGTH)
  7601*       END-EXEC
  7602*    MOVE '*$I    L              ''   #00007531' TO DFHEIV0
  7603     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7604     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7605     MOVE X'2020233030303037353331' TO DFHEIV0(25:11)
  7606     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 138
* EL131.cbl
  7607           PI-KEY,
  7608           EL131AI,
  7609           MAP-LENGTH,
  7610           DFHEIV99,
  7611           DFHEIV99,
  7612           DFHEIV99
  7613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7614
  7615        IF WS-SAVE-BENEFICIARY > SPACES
  7616            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7617            MOVE +10            TO BENEL
  7618            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7619        END-IF
  7620        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7621     END-IF.
  7622
  7623
  7624* EXEC CICS READQ TS
  7625*         QUEUE    (PI-KEY)
  7626*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7627*         LENGTH   (PI-COMM-LENGTH)
  7628*    END-EXEC.
  7629*    MOVE '*$I    L              ''   #00007545' TO DFHEIV0
  7630     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7632     MOVE X'2020233030303037353435' TO DFHEIV0(25:11)
  7633     CALL 'kxdfhei1' USING DFHEIV0,
  7634           PI-KEY,
  7635           PROGRAM-INTERFACE-BLOCK,
  7636           PI-COMM-LENGTH,
  7637           DFHEIV99,
  7638           DFHEIV99,
  7639           DFHEIV99
  7640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7641
  7642
  7643
  7644* EXEC CICS DELETEQ TS
  7645*         QUEUE    (PI-KEY)
  7646*    END-EXEC.
  7647*    MOVE '*&                    #   #00007551' TO DFHEIV0
  7648     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7649     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7650     MOVE X'2020233030303037353531' TO DFHEIV0(25:11)
  7651     CALL 'kxdfhei1' USING DFHEIV0,
  7652           PI-KEY,
  7653           DFHEIV99
  7654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7655
  7656
  7657 0120-UPDATE-PI-EXIT.
  7658     EXIT.
  7659
  7660 0130-TS-ERROR.
  7661     MOVE LOW-VALUES             TO EL131AO.
  7662     MOVE ER-0192                TO EMI-ERROR.
  7663
  7664     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 139
* EL131.cbl
  7665
  7666     GO TO 8100-SEND-MAP.
  7667
  7668 0200-TRANS-PF.
  7669     IF EIBAID NOT = DFHENTER
  7670         MOVE 'X'                TO ERROR-SWITCH
  7671         GO TO 0210-EXIT.
  7672
  7673     IF PFKEYI NOT NUMERIC
  7674         MOVE 'X'                TO ERROR-SWITCH
  7675         GO TO 0210-EXIT.
  7676
  7677     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7678
  7679     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7680         MOVE 'X' TO ERROR-SWITCH
  7681         GO TO 0210-EXIT.
  7682
  7683     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7684
  7685 0210-EXIT.
  7686     EXIT.
  7687
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 140
* EL131.cbl
  7689 0500-ADD-ALPHA-ONLY.
  7690******************************************************************
  7691*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7692*    RECORD.                                                     *
  7693******************************************************************
  7694
  7695     IF MLNAMEL = +0 AND
  7696        MFNAMEL = +0 AND
  7697        MMINITL = +0
  7698         MOVE ER-0797                TO  EMI-ERROR
  7699         MOVE -1                     TO  MAINTL
  7700         MOVE AL-UABON               TO  MAINTA
  7701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7702         GO TO 8110-SEND-DATA.
  7703
  7704     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7705     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7706     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7707     MOVE PI-CERT-NO                 TO  CERT-NO.
  7708
  7709
  7710* EXEC CICS READ
  7711*        DATASET   (CLMS-FILE-ID)
  7712*        RIDFLD    (MSTR-KEY)
  7713*        SET       (ADDRESS OF CLAIM-MASTER)
  7714*    END-EXEC.
  7715*    MOVE '&"S        E          (   #00007607' TO DFHEIV0
  7716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7718     MOVE X'2020233030303037363037' TO DFHEIV0(25:11)
  7719     CALL 'kxdfhei1' USING DFHEIV0,
  7720           CLMS-FILE-ID,
  7721           DFHEIV20,
  7722           DFHEIV99,
  7723           MSTR-KEY,
  7724           DFHEIV99,
  7725           DFHEIV99,
  7726           DFHEIV99
  7727     SET ADDRESS OF CLAIM-MASTER TO
  7728         DFHEIV20
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732
  7733* EXEC CICS GETMAIN
  7734*        SET       (ADDRESS OF ALPHA-INDEX)
  7735*        LENGTH    (ALPH-LENGTH)
  7736*        INITIMG   (GETMAIN-SPACE)
  7737*    END-EXEC.
  7738*    MOVE ',"IL                  $   #00007613' TO DFHEIV0
  7739     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7740     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7741     MOVE X'2020233030303037363133' TO DFHEIV0(25:11)
  7742     CALL 'kxdfhei1' USING DFHEIV0,
  7743           DFHEIV20,
  7744           ALPH-LENGTH,
  7745           GETMAIN-SPACE
  7746     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 141
* EL131.cbl
  7747         DFHEIV20
  7748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7749
  7750
  7751     MOVE 'AI'                       TO  AI-RECORD-ID.
  7752     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7753                                         AI-CL-COMPANY-CD.
  7754     MOVE 'C'                        TO  AI-SOURCE
  7755                                         AI-CL-SOURCE.
  7756
  7757     IF MLNAMEL IS GREATER THAN +0
  7758         MOVE MLNAMEI                TO  AI-LAST-NAME
  7759     ELSE
  7760         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7761
  7762     IF MFNAMEL IS GREATER THAN +0
  7763         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7764     ELSE
  7765         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7766
  7767     IF MMINITL IS GREATER THAN +0
  7768         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7769     ELSE
  7770         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7771
  7772     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7773     MOVE '5'                        TO  DC-OPTION-CODE.
  7774     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7775     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7776     IF BUILD-YEAR IS GREATER THAN 50
  7777         MOVE '19'                   TO  WS-ALPHA-YY-1
  7778         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7779         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7780         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7781     ELSE
  7782         MOVE '20'                   TO  WS-ALPHA-YY-1
  7783         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7784         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7785         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7786
  7787     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7788                                         AI-CL-DATE.
  7789
  7790     MOVE EIBTIME                    TO  AI-TIME
  7791                                         AI-CL-TIME.
  7792
  7793     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7794     MOVE 'C'                        TO  AI-CL-SOURCE.
  7795     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7796     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7797     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7798     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7799     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7800
  7801     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7802     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7803     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7804
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 142
* EL131.cbl
  7805
  7806* EXEC CICS WRITE
  7807*        DATASET   (ALPH-FILE-ID)
  7808*        RIDFLD    (AI-CONTROL-PRIMARY)
  7809*        FROM      (ALPHA-INDEX)
  7810*    END-EXEC.
  7811     MOVE LENGTH OF
  7812      ALPHA-INDEX
  7813       TO DFHEIV11
  7814*    MOVE '&$ L                  ''   #00007673' TO DFHEIV0
  7815     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7816     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7817     MOVE X'2020233030303037363733' TO DFHEIV0(25:11)
  7818     CALL 'kxdfhei1' USING DFHEIV0,
  7819           ALPH-FILE-ID,
  7820           ALPHA-INDEX,
  7821           DFHEIV11,
  7822           AI-CONTROL-PRIMARY,
  7823           DFHEIV99,
  7824           DFHEIV99
  7825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7826
  7827
  7828     MOVE LOW-VALUES                 TO  EL131AO.
  7829     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7830     MOVE ER-0000                    TO  EMI-ERROR.
  7831     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7832     MOVE -1                         TO  MAINTL.
  7833     GO TO 8100-SEND-MAP.
  7834
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 143
* EL131.cbl
  7836 0600-CHANGE-NAME.
  7837******************************************************************
  7838*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7839*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7840******************************************************************
  7841
  7842     IF MLNAMEL = +0 AND
  7843        MFNAMEL = +0 AND
  7844        MMINITL = +0
  7845         MOVE ER-0276                TO  EMI-ERROR
  7846         MOVE -1                     TO  MAINTL
  7847         MOVE AL-UABON               TO  MAINTA
  7848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7849         GO TO 8110-SEND-DATA.
  7850
  7851     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7852     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7853     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7854     MOVE PI-CERT-NO                 TO  CERT-NO.
  7855
  7856
  7857* EXEC CICS READ
  7858*        DATASET   (CLMS-FILE-ID)
  7859*        RIDFLD    (MSTR-KEY)
  7860*        SET       (ADDRESS OF CLAIM-MASTER)
  7861*    END-EXEC.
  7862*    MOVE '&"S        E          (   #00007707' TO DFHEIV0
  7863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7865     MOVE X'2020233030303037373037' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           CLMS-FILE-ID,
  7868           DFHEIV20,
  7869           DFHEIV99,
  7870           MSTR-KEY,
  7871           DFHEIV99,
  7872           DFHEIV99,
  7873           DFHEIV99
  7874     SET ADDRESS OF CLAIM-MASTER TO
  7875         DFHEIV20
  7876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7877
  7878
  7879
  7880* EXEC CICS GETMAIN
  7881*        SET       (ADDRESS OF ALPHA-INDEX)
  7882*        LENGTH    (ALPH-LENGTH)
  7883*        INITIMG   (GETMAIN-SPACE)
  7884*    END-EXEC.
  7885*    MOVE ',"IL                  $   #00007713' TO DFHEIV0
  7886     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7887     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7888     MOVE X'2020233030303037373133' TO DFHEIV0(25:11)
  7889     CALL 'kxdfhei1' USING DFHEIV0,
  7890           DFHEIV20,
  7891           ALPH-LENGTH,
  7892           GETMAIN-SPACE
  7893     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 144
* EL131.cbl
  7894         DFHEIV20
  7895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7896
  7897
  7898     MOVE 'AI'                       TO  AI-RECORD-ID.
  7899     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7900                                         AI-CL-COMPANY-CD.
  7901     MOVE 'C'                        TO  AI-SOURCE
  7902                                         AI-CL-SOURCE.
  7903
  7904     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7905     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7906     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7907
  7908     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7909     MOVE '5'                        TO  DC-OPTION-CODE.
  7910     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7911     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7912     IF BUILD-YEAR IS GREATER THAN 50
  7913         MOVE '19'                   TO  WS-ALPHA-YY-1
  7914         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7915         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7916         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7917     ELSE
  7918         MOVE '20'                   TO  WS-ALPHA-YY-1
  7919         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7920         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7921         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7922
  7923     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7924                                         AI-CL-DATE.
  7925
  7926     MOVE EIBTIME                    TO  AI-TIME
  7927                                         AI-CL-TIME.
  7928
  7929     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7930     MOVE 'C'                        TO  AI-CL-SOURCE.
  7931     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7932     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7933     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7934     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7935     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7936
  7937     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7938     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7939     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7940
  7941     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7942         MOVE 'Y'                TO CL-YESNOSW
  7943     END-IF.
  7944
  7945
  7946* EXEC CICS WRITE
  7947*        DATASET   (ALPH-FILE-ID)
  7948*        RIDFLD    (AI-CONTROL-PRIMARY)
  7949*        FROM      (ALPHA-INDEX)
  7950*    END-EXEC.
  7951     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 145
* EL131.cbl
  7952      ALPHA-INDEX
  7953       TO DFHEIV11
  7954*    MOVE '&$ L                  ''   #00007766' TO DFHEIV0
  7955     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7956     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7957     MOVE X'2020233030303037373636' TO DFHEIV0(25:11)
  7958     CALL 'kxdfhei1' USING DFHEIV0,
  7959           ALPH-FILE-ID,
  7960           ALPHA-INDEX,
  7961           DFHEIV11,
  7962           AI-CONTROL-PRIMARY,
  7963           DFHEIV99,
  7964           DFHEIV99
  7965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7966
  7967
  7968
  7969* EXEC CICS READ
  7970*        DATASET   (CLMS-FILE-ID)
  7971*        RIDFLD    (MSTR-KEY)
  7972*        SET       (ADDRESS OF CLAIM-MASTER)
  7973*        UPDATE
  7974*    END-EXEC.
  7975*    MOVE '&"S        EU         (   #00007772' TO DFHEIV0
  7976     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7977     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7978     MOVE X'2020233030303037373732' TO DFHEIV0(25:11)
  7979     CALL 'kxdfhei1' USING DFHEIV0,
  7980           CLMS-FILE-ID,
  7981           DFHEIV20,
  7982           DFHEIV99,
  7983           MSTR-KEY,
  7984           DFHEIV99,
  7985           DFHEIV99,
  7986           DFHEIV99
  7987     SET ADDRESS OF CLAIM-MASTER TO
  7988         DFHEIV20
  7989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7990
  7991
  7992     if (cl-priority-cd = '8')
  7993        and (pi-processor-id not = 'PEMA'and 'JMS '
  7994             AND 'AMWA' AND 'KMSB')
  7995        MOVE ER-8003             TO EMI-ERROR
  7996        PERFORM 9900-ERROR-FORMAT
  7997                                 THRU 9900-EXIT
  7998        MOVE -1                  TO MAINTL
  7999        GO TO 8110-SEND-DATA
  8000     end-if
  8001
  8002     IF MLNAMEL IS GREATER THAN +0
  8003         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8004
  8005     IF MFNAMEL IS GREATER THAN +0
  8006         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8007
  8008     IF MMINITL IS GREATER THAN +0
  8009         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 146
* EL131.cbl
  8010
  8011     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8012     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8013     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8014     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8015
  8016     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8017         MOVE 'Y'                TO CL-YESNOSW
  8018     END-IF.
  8019
  8020
  8021* EXEC CICS HANDLE CONDITION
  8022*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8023*    END-EXEC.
  8024*    MOVE '"$$                   ! $ #00007807' TO DFHEIV0
  8025     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8027     MOVE X'2420233030303037383037' TO DFHEIV0(25:11)
  8028     CALL 'kxdfhei1' USING DFHEIV0
  8029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8030
  8031
  8032
  8033* EXEC CICS REWRITE
  8034*        DATASET   (CLMS-FILE-ID)
  8035*        FROM      (CLAIM-MASTER)
  8036*    END-EXEC.
  8037     MOVE LENGTH OF
  8038      CLAIM-MASTER
  8039       TO DFHEIV11
  8040*    MOVE '&& L                  %   #00007811' TO DFHEIV0
  8041     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8042     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8043     MOVE X'2020233030303037383131' TO DFHEIV0(25:11)
  8044     CALL 'kxdfhei1' USING DFHEIV0,
  8045           CLMS-FILE-ID,
  8046           CLAIM-MASTER,
  8047           DFHEIV11,
  8048           DFHEIV99
  8049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8050
  8051
  8052 0600-CONTINUE-NAME-UPDATE.
  8053
  8054     MOVE LOW-VALUES                 TO  EL131AO.
  8055     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8056     MOVE ER-0000                    TO  EMI-ERROR.
  8057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8058     MOVE -1                         TO  MAINTL.
  8059     GO TO 8100-SEND-MAP.
  8060
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 147
* EL131.cbl
  8062 1000-EDIT-SCREEN.
  8063
  8064     MOVE MAINTI                 TO CHECK-MAINT.
  8065
  8066     IF NOT VALID-OPTIONS
  8067         MOVE 'X'                TO ERROR-SWITCH
  8068         MOVE -1                 TO MAINTL
  8069         MOVE AL-UABON           TO MAINTA
  8070         MOVE ER-0023            TO EMI-ERROR
  8071         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8072         GO TO 1010-EXIT.
  8073
  8074     IF NOT MODIFY-CAP
  8075         MOVE 'UPDATE'           TO  SM-READ
  8076         PERFORM 9995-SECURITY-VIOLATION
  8077         MOVE ER-0070               TO  EMI-ERROR
  8078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8079         GO TO 8100-SEND-MAP.
  8080
  8081     IF DELETE-CLAIM
  8082         MOVE AL-UANON TO MAINTA
  8083         GO TO 1010-EXIT.
  8084
  8085     MOVE AL-UANON               TO MAINTA.
  8086
  8087     IF CCNOI GREATER THAN LOW-VALUES
  8088         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8089
  8090     IF PI-COMPANY-ID = 'CSL'
  8091        CONTINUE
  8092     ELSE
  8093        IF TYPEL > ZERO
  8094           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8095              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8096                    PI-LIFE-OVERRIDE-L1))
  8097                       OR
  8098              ((PI-COMPANY-ID = 'DCC')
  8099              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8100                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  8101              MOVE AL-UANON      TO TYPEA
  8102              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8103           ELSE
  8104              MOVE ER-0199       TO EMI-ERROR
  8105              PERFORM 9900-ERROR-FORMAT
  8106                                 THRU 9900-EXIT
  8107              MOVE AL-UABON      TO TYPEA
  8108              MOVE -1            TO TYPEL
  8109              MOVE 'X'           TO ERROR-SWITCH
  8110           END-IF
  8111        ELSE
  8112           MOVE AL-UANOF         TO TYPEA
  8113        END-IF
  8114     END-IF
  8115     IF STATUSI GREATER THAN LOW-VALUES
  8116         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8117             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8118             MOVE AL-UANON       TO STATUSA
  8119             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 148
* EL131.cbl
  8120             MOVE 'Y'            TO DLYACTV-SW
  8121         ELSE
  8122             MOVE ER-0333        TO EMI-ERROR
  8123             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8124             MOVE AL-UABON       TO STATUSA
  8125             MOVE -1             TO STATUSL
  8126             MOVE 'X'            TO ERROR-SWITCH
  8127         END-IF
  8128     ELSE
  8129         MOVE SPACE              TO TRLR-SWITCH
  8130         MOVE 'N'                TO DLYACTV-SW
  8131         MOVE AL-UANOF           TO STATUSA.
  8132
  8133     IF PROCI GREATER THAN LOW-VALUES
  8134         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8135     ELSE
  8136         MOVE AL-UANOF TO PROCA.
  8137
  8138     IF SEXI GREATER THAN LOW-VALUES
  8139         IF SEXI = 'F' OR 'M'
  8140             MOVE AL-UANON       TO SEXA
  8141             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8142           ELSE
  8143             MOVE ER-0219        TO EMI-ERROR
  8144             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8145             MOVE AL-UABON       TO SEXA
  8146             MOVE -1             TO SEXL
  8147             MOVE 'X'            TO ERROR-SWITCH
  8148       ELSE
  8149         MOVE AL-UANOF           TO SEXA.
  8150
  8151     IF BIRTHL = +0
  8152         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8153         MOVE AL-UANOF           TO  BIRTHA
  8154         GO TO 1000-CONTINUE-EDITS.
  8155
  8156     IF BIRTHI = SPACES
  8157         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8158         MOVE 'X'                TO  UPDATE-SWITCH
  8159                                     MSTR-SWITCH
  8160         GO TO 1000-CONTINUE-EDITS.
  8161
  8162     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8163     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8164     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8165     MOVE '4'                    TO  DC-OPTION-CODE.
  8166     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8167     IF DATE-CONVERSION-ERROR
  8168         MOVE ER-0220            TO  EMI-ERROR
  8169         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8170         MOVE AL-UABON           TO  BIRTHA
  8171         MOVE -1                 TO  BIRTHL
  8172         MOVE 'X'                TO  ERROR-SWITCH
  8173         GO TO 1000-CONTINUE-EDITS.
  8174
  8175******************************************************************
  8176**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8177**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 149
* EL131.cbl
  8178**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8179******************************************************************
  8180     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8181         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8182         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8183         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8184         MOVE '4'                TO  DC-OPTION-CODE
  8185         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8186         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8187                                     DC-ELAPSED-DAYS
  8188         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8189         IF DATE-CONVERSION-ERROR
  8190             MOVE ER-0220        TO  EMI-ERROR
  8191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8192             MOVE AL-UABON       TO  BIRTHA
  8193             MOVE -1             TO  BIRTHL
  8194             MOVE 'X'            TO  ERROR-SWITCH
  8195             GO TO 1000-CONTINUE-EDITS.
  8196
  8197     MOVE AL-UANON               TO  BIRTHA.
  8198     MOVE 'X'                    TO  UPDATE-SWITCH
  8199                                     MSTR-SWITCH.
  8200     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8201     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8202     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8203
  8204 1000-CONTINUE-EDITS.
  8205
  8206     IF SOCIALI GREATER THAN LOW-VALUES
  8207         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8208         IF WS-SOC-SEC-NO NUMERIC AND
  8209           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8210             NEXT SENTENCE
  8211         ELSE
  8212            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8213               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8214               WS-SSN-DASH2 = '-'
  8215                 NEXT SENTENCE
  8216            ELSE
  8217                 MOVE ER-0887        TO  EMI-ERROR
  8218                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8219                 MOVE AL-UABON       TO  SOCIALA
  8220                 MOVE -1             TO  SOCIALL
  8221                 MOVE 'X'            TO  ERROR-SWITCH
  8222            END-IF
  8223        END-IF
  8224     END-IF.
  8225
  8226     IF SOCIALI GREATER THAN LOW-VALUES
  8227         MOVE AL-UANON           TO SOCIALA
  8228         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8229     ELSE
  8230         MOVE AL-UANOF           TO SOCIALA.
  8231
  8232     IF OCCI GREATER THAN LOW-VALUES
  8233         MOVE AL-UANON           TO OCCA
  8234         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8235     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 150
* EL131.cbl
  8236         MOVE AL-UANOF           TO OCCA.
  8237
  8238     IF BENEL NOT GREATER THAN ZERO
  8239            GO TO 1005-CONTINUE-EDITS.
  8240
  8241     IF BENEI = SPACES
  8242        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8243           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8244           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8245           IF AUTO-PAY-TO-BENE = 'Y'
  8246               MOVE ER-1773      TO  EMI-ERROR
  8247               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8248               MOVE 'X'          TO ERROR-SWITCH
  8249               MOVE AL-UABON     TO BENEA
  8250               MOVE -1           TO BENEL
  8251           ELSE
  8252               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8253           END-IF
  8254        ELSE
  8255           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8256        END-IF
  8257        GO TO 1005-CONTINUE-EDITS.
  8258
  8259
  8260* EXEC CICS HANDLE CONDITION
  8261*        NOTFND (1004-BENE-NOT-FOUND)
  8262*    END-EXEC.
  8263*    MOVE '"$I                   ! % #00008023' TO DFHEIV0
  8264     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8265     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8266     MOVE X'2520233030303038303233' TO DFHEIV0(25:11)
  8267     CALL 'kxdfhei1' USING DFHEIV0
  8268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8269
  8270
  8271     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8272     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8273     MOVE BENEI                  TO  WS-ELBENE-ID.
  8274
  8275
  8276* EXEC CICS READ
  8277*        DATASET ('ELBENE')
  8278*        RIDFLD  (WS-ELBENE-KEY)
  8279*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8280*    END-EXEC.
  8281     MOVE 'ELBENE' TO DFHEIV1
  8282*    MOVE '&"S        E          (   #00008031' TO DFHEIV0
  8283     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8285     MOVE X'2020233030303038303331' TO DFHEIV0(25:11)
  8286     CALL 'kxdfhei1' USING DFHEIV0,
  8287           DFHEIV1,
  8288           DFHEIV20,
  8289           DFHEIV99,
  8290           WS-ELBENE-KEY,
  8291           DFHEIV99,
  8292           DFHEIV99,
  8293           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 151
* EL131.cbl
  8294     SET ADDRESS OF BENEFICIARY-MASTER TO
  8295         DFHEIV20
  8296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8297
  8298
  8299     MOVE AL-UANON               TO  BENEA.
  8300     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8301
  8302     GO TO 1005-CONTINUE-EDITS.
  8303
  8304 1004-BENE-NOT-FOUND.
  8305     MOVE ER-0565                TO  EMI-ERROR.
  8306
  8307     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8308     MOVE 'X'                    TO ERROR-SWITCH.
  8309     MOVE AL-UABON               TO BENEA.
  8310     MOVE -1                     TO BENEL.
  8311
  8312 1005-CONTINUE-EDITS.
  8313
  8314     IF DIAGI GREATER THAN LOW-VALUES
  8315         MOVE AL-UANON           TO DIAGA
  8316         MOVE 'X'                TO UPDATE-SWITCH
  8317                                    NINETY-TRLR-SWITCH
  8318     ELSE
  8319         MOVE AL-UANOF           TO DIAGA.
  8320
  8321     IF ICD1I GREATER THAN LOW-VALUES
  8322         IF (ICD1I GREATER THAN SPACES) AND
  8323            (ICD1I(4:1) NOT = '.')
  8324             IF ICD1I(4:1) = ' '
  8325                 MOVE '.' TO ICD1I(4:1)
  8326             ELSE
  8327                 IF ICD1I(8:1) = ' '
  8328                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8329                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8330                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8331                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8332                     MOVE '.'        TO ICD1I(4:1)
  8333                 END-IF
  8334             END-IF
  8335         END-IF
  8336         IF (ICD1I GREATER THAN SPACES) AND
  8337            (ICD1I(1:1) NOT > ' ' OR
  8338             ICD1I(2:1) NOT > ' ' OR
  8339             ICD1I(3:1) NOT > ' ' OR
  8340             ICD1I(4:1) NOT = '.')
  8341              MOVE ER-0992        TO  EMI-ERROR
  8342              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8343              MOVE 'X'            TO ERROR-SWITCH
  8344              MOVE AL-UABON       TO ICD1A
  8345              MOVE -1             TO ICD1L
  8346         ELSE
  8347             MOVE AL-UANON       TO ICD1A
  8348             MOVE 'X'            TO UPDATE-SWITCH
  8349                                    NINETY-TRLR-SWITCH
  8350         END-IF
  8351     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 152
* EL131.cbl
  8352         MOVE AL-UANOF           TO ICD1A
  8353     END-IF.
  8354
  8355     IF ICD2I GREATER THAN LOW-VALUES
  8356         IF (ICD2I GREATER THAN SPACES) AND
  8357            (ICD2I(4:1) NOT = '.')
  8358             IF ICD2I(4:1) = ' '
  8359                 MOVE '.' TO ICD2I(4:1)
  8360             ELSE
  8361                 IF ICD2I(8:1) = ' '
  8362                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8363                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8364                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8365                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8366                     MOVE '.'        TO ICD2I(4:1)
  8367                 END-IF
  8368             END-IF
  8369         END-IF
  8370         IF (ICD2I GREATER THAN SPACES) AND
  8371            (ICD2I(1:1) NOT > ' ' OR
  8372             ICD2I(2:1) NOT > ' ' OR
  8373             ICD2I(3:1) NOT > ' ' OR
  8374             ICD2I(4:1) NOT = '.')
  8375              MOVE ER-0992        TO EMI-ERROR
  8376              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8377              MOVE 'X'            TO ERROR-SWITCH
  8378              MOVE AL-UABON       TO ICD2A
  8379              MOVE -1             TO ICD2L
  8380         ELSE
  8381             MOVE AL-UANON       TO ICD2A
  8382             MOVE 'X'            TO UPDATE-SWITCH
  8383                                    NINETY-TRLR-SWITCH
  8384         END-IF
  8385     ELSE
  8386         MOVE AL-UANOF           TO ICD2A
  8387     END-IF.
  8388
  8389*    IF CAUSEI GREATER THAN LOW-VALUES
  8390*        MOVE AL-UANON           TO CAUSEA
  8391*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8392*    ELSE
  8393*        MOVE AL-UANOF           TO CAUSEA.
  8394
  8395*    IF ENDL GREATER THAN ZERO
  8396*        MOVE LOW-VALUES         TO HOLD-END
  8397*        IF ENDI = SPACES
  8398*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8399*        ELSE
  8400*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8401*            EXEC CICS BIF DEEDIT
  8402*                FIELD    (DEEDIT-DATE-INPUT)
  8403*                LENGTH   (DATE-LENGTH)
  8404*            END-EXEC
  8405*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8406*            MOVE '4'            TO DC-OPTION-CODE
  8407*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8408*            IF NOT DATE-CONVERSION-ERROR
  8409*                MOVE DC-BIN-DATE-1      TO HOLD-END
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 153
* EL131.cbl
  8410*                MOVE AL-UANON   TO ENDA
  8411*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8412*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8413*            ELSE
  8414*                MOVE ER-0224    TO EMI-ERROR
  8415*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8416*                MOVE AL-UABON   TO ENDA
  8417*                MOVE -1         TO ENDL
  8418*                MOVE 'X'        TO ERROR-SWITCH
  8419*      ELSE
  8420*          MOVE AL-UANOF         TO ENDA.
  8421
  8422     IF INCL GREATER THAN ZERO
  8423         MOVE LOW-VALUES         TO HOLD-INCUR
  8424         IF INCI = SPACES
  8425             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8426         ELSE
  8427             MOVE INCI           TO DEEDIT-DATE-INPUT
  8428
  8429* EXEC CICS BIF DEEDIT
  8430*                FIELD    (DEEDIT-DATE-INPUT)
  8431*                LENGTH   (DATE-LENGTH)
  8432*            END-EXEC
  8433*    MOVE '@"L                   #   #00008166' TO DFHEIV0
  8434     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8435     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8436     MOVE X'2020233030303038313636' TO DFHEIV0(25:11)
  8437     CALL 'kxdfhei1' USING DFHEIV0,
  8438           DEEDIT-DATE-INPUT,
  8439           DATE-LENGTH
  8440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8441             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8442             MOVE '4'            TO DC-OPTION-CODE
  8443             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8444             IF NOT DATE-CONVERSION-ERROR
  8445                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8446                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8447                 MOVE AL-UANON           TO INCA
  8448                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8449             ELSE
  8450                 MOVE ER-0222    TO EMI-ERROR
  8451                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8452                 MOVE AL-UABON   TO INCA
  8453                 MOVE -1         TO INCL
  8454                 MOVE 'X'        TO ERROR-SWITCH
  8455       ELSE
  8456           IF PI-NO-PMTS = ZEROS
  8457               MOVE AL-UANOF     TO INCA.
  8458
  8459     IF REPL GREATER THAN ZERO
  8460         MOVE LOW-VALUES         TO HOLD-REPORTED
  8461         IF REPI = SPACES
  8462             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8463         ELSE
  8464             MOVE REPI           TO DEEDIT-DATE-INPUT
  8465
  8466* EXEC CICS BIF DEEDIT
  8467*                FIELD    (DEEDIT-DATE-INPUT)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 154
* EL131.cbl
  8468*                LENGTH   (DATE-LENGTH)
  8469*            END-EXEC
  8470*    MOVE '@"L                   #   #00008194' TO DFHEIV0
  8471     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8472     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8473     MOVE X'2020233030303038313934' TO DFHEIV0(25:11)
  8474     CALL 'kxdfhei1' USING DFHEIV0,
  8475           DEEDIT-DATE-INPUT,
  8476           DATE-LENGTH
  8477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8478             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8479             MOVE '4'            TO DC-OPTION-CODE
  8480             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8481             IF NOT DATE-CONVERSION-ERROR
  8482                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8483                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8484                 MOVE AL-UANON   TO REPA
  8485                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8486             ELSE
  8487                 MOVE ER-0223    TO EMI-ERROR
  8488                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8489                 MOVE AL-UABON   TO REPA
  8490                 MOVE -1         TO REPL
  8491                 MOVE 'X'        TO ERROR-SWITCH
  8492       ELSE
  8493         MOVE AL-UANOF TO REPA.
  8494
  8495     IF PDTHRUI GREATER THAN LOW-VALUES
  8496        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8497        IF PDTHRUI = SPACES
  8498           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8499        ELSE
  8500           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8501
  8502* EXEC CICS BIF DEEDIT
  8503*               FIELD    (DEEDIT-DATE-INPUT)
  8504*               LENGTH   (DATE-LENGTH)
  8505*          END-EXEC
  8506*    MOVE '@"L                   #   #00008221' TO DFHEIV0
  8507     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8509     MOVE X'2020233030303038323231' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0,
  8511           DEEDIT-DATE-INPUT,
  8512           DATE-LENGTH
  8513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8514           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8515           MOVE '4'            TO DC-OPTION-CODE
  8516           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8517           IF NOT DATE-CONVERSION-ERROR
  8518              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8519              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8520              MOVE AL-UANON   TO PDTHRUA
  8521              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8522              IF PI-USES-PAID-TO
  8523                 MOVE '6'            TO DC-OPTION-CODE
  8524                 MOVE -1             TO DC-ELAPSED-DAYS
  8525                 MOVE +0             TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 155
* EL131.cbl
  8526                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8527                 IF NO-CONVERSION-ERROR
  8528                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8529                 ELSE
  8530                    NEXT SENTENCE
  8531              ELSE
  8532                 NEXT SENTENCE
  8533           ELSE
  8534              MOVE ER-0475    TO EMI-ERROR
  8535              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8536              MOVE AL-UABON   TO PDTHRUA
  8537              MOVE -1         TO PDTHRUL
  8538              MOVE 'X'        TO ERROR-SWITCH
  8539     ELSE
  8540        IF MODIFY-CAP
  8541           MOVE AL-UANOF        TO PDTHRUA.
  8542
  8543     IF PDAMTL GREATER THAN +0
  8544         MOVE ZEROS              TO HOLD-PDAMT
  8545
  8546* EXEC CICS BIF DEEDIT
  8547*            FIELD    (PDAMTI)
  8548*            LENGTH   (9)
  8549*        END-EXEC
  8550     MOVE 9
  8551       TO DFHEIV11
  8552*    MOVE '@"L                   #   #00008256' TO DFHEIV0
  8553     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8555     MOVE X'2020233030303038323536' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           PDAMTI,
  8558           DFHEIV11
  8559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8560         IF PDAMTI NUMERIC
  8561             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8562             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8563             MOVE AL-UNNON       TO PDAMTA
  8564         ELSE
  8565             MOVE ER-0547        TO EMI-ERROR
  8566             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8567             MOVE AL-UNBON       TO PDAMTA
  8568             MOVE -1             TO PDAMTL
  8569             MOVE 'X'            TO ERROR-SWITCH
  8570     ELSE
  8571         IF MODIFY-CAP
  8572            MOVE AL-UNNOF        TO PDAMTA.
  8573
  8574     IF NODAYSI GREATER THAN LOW-VALUES
  8575         MOVE ZEROS              TO HOLD-NODAYS
  8576
  8577* EXEC CICS BIF DEEDIT
  8578*            FIELD (NODAYSI)
  8579*            LENGTH (5)
  8580*        END-EXEC
  8581     MOVE 5
  8582       TO DFHEIV11
  8583*    MOVE '@"L                   #   #00008276' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 156
* EL131.cbl
  8584     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8585     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8586     MOVE X'2020233030303038323736' TO DFHEIV0(25:11)
  8587     CALL 'kxdfhei1' USING DFHEIV0,
  8588           NODAYSI,
  8589           DFHEIV11
  8590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8591         IF NODAYSI NUMERIC
  8592             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8593             MOVE AL-UNNON       TO NODAYSA
  8594             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8595         ELSE
  8596             MOVE ER-0491        TO EMI-ERROR
  8597             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8598             MOVE AL-UNBON       TO NODAYSA
  8599             MOVE -1             TO NODAYSL
  8600             MOVE 'X'            TO ERROR-SWITCH
  8601     ELSE
  8602         IF MODIFY-CAP
  8603            MOVE AL-UNNOF        TO NODAYSA.
  8604
  8605     IF NOPMTSI GREATER THAN LOW-VALUES
  8606         MOVE ZEROS              TO HOLD-NOPMTS
  8607
  8608* EXEC CICS BIF DEEDIT
  8609*            FIELD (NOPMTSI)
  8610*            LENGTH (4)
  8611*        END-EXEC
  8612     MOVE 4
  8613       TO DFHEIV11
  8614*    MOVE '@"L                   #   #00008296' TO DFHEIV0
  8615     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8616     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8617     MOVE X'2020233030303038323936' TO DFHEIV0(25:11)
  8618     CALL 'kxdfhei1' USING DFHEIV0,
  8619           NOPMTSI,
  8620           DFHEIV11
  8621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8622         IF NOPMTSI NUMERIC
  8623             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8624             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8625             MOVE AL-UNNON       TO NOPMTSA
  8626           ELSE
  8627             MOVE ER-0548        TO EMI-ERROR
  8628             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8629             MOVE AL-UNBON       TO NOPMTSA
  8630             MOVE -1             TO NOPMTSL
  8631             MOVE 'X'            TO ERROR-SWITCH
  8632       ELSE
  8633         IF MODIFY-CAP
  8634            MOVE AL-UNNOF        TO NOPMTSA.
  8635
  8636     IF FORMTYPI GREATER THAN LOW-VALUES
  8637         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8638             MOVE AL-UANON       TO FORMTYPA
  8639             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8640           ELSE
  8641             MOVE ER-7650        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 157
* EL131.cbl
  8642             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8643             MOVE AL-UABON       TO FORMTYPA
  8644             MOVE -1             TO FORMTYPL
  8645             MOVE 'X'            TO ERROR-SWITCH
  8646       ELSE
  8647         MOVE AL-UANOF           TO FORMTYPA.
  8648
  8649     IF PRICDL GREATER THAN ZERO
  8650         IF (PRICDI = ' ') OR
  8651            (PRICDI GREATER THAN ZERO   AND
  8652             PRICDI NOT GREATER THAN '9')
  8653             MOVE AL-UANON       TO PRICDA
  8654             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8655         ELSE
  8656             MOVE ER-0274        TO EMI-ERROR
  8657             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8658             MOVE AL-UABON       TO PRICDA
  8659             MOVE -1             TO PRICDL
  8660             MOVE 'X'            TO ERROR-SWITCH
  8661     ELSE
  8662         MOVE AL-UANOF TO PRICDA.
  8663
  8664     IF PI-COMPANY-ID = 'DMD'
  8665     IF PRICDL GREATER THAN ZERO
  8666       IF SYSTEM-MODIFY-CAP  OR
  8667          PI-PROCESSOR-ID = 'LGXX'
  8668             NEXT SENTENCE
  8669           ELSE
  8670            IF CL-PRIORITY-CD = '9'  OR
  8671               PRICDI         = '9'
  8672                  MOVE ER-0938        TO EMI-ERROR
  8673                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8674                  MOVE AL-UABON       TO PRICDA
  8675                  MOVE -1             TO PRICDL
  8676                  MOVE 'X'            TO ERROR-SWITCH.
  8677
  8678     IF FILETOL GREATER THAN ZERO
  8679         MOVE AL-UANON           TO FILETOA
  8680         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8681     ELSE
  8682         MOVE AL-UANOF TO FILETOA.
  8683
  8684     IF SUPVL GREATER THAN ZERO
  8685         IF SUPVI = 'Y' OR 'N' OR SPACE
  8686             MOVE AL-UANON       TO SUPVA
  8687             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8688         ELSE
  8689             MOVE ER-0230        TO EMI-ERROR
  8690             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8691             MOVE AL-UABON       TO SUPVA
  8692             MOVE -1             TO SUPVL
  8693             MOVE 'X'            TO ERROR-SWITCH
  8694     ELSE
  8695         MOVE AL-UANOF           TO SUPVA.
  8696
  8697     IF MLNAMEL GREATER THAN ZERO
  8698         IF MLNAMEI GREATER THAN SPACES
  8699            MOVE AL-UANON        TO MLNAMEA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 158
* EL131.cbl
  8700            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8701                                     MSTR-KEY-SWITCH
  8702         ELSE
  8703            MOVE ER-0236         TO EMI-ERROR
  8704            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8705            MOVE AL-UABON        TO MLNAMEA
  8706            MOVE -1              TO MLNAMEL
  8707            MOVE 'X'             TO ERROR-SWITCH
  8708     ELSE
  8709         MOVE AL-UANOF           TO MLNAMEA.
  8710
  8711     IF MFNAMEI GREATER THAN LOW-VALUES
  8712         MOVE AL-UANON           TO MFNAMEA
  8713         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8714     ELSE
  8715         MOVE AL-UANOF           TO MFNAMEA.
  8716
  8717     IF MMINITI GREATER THAN LOW-VALUES
  8718         MOVE AL-UANON           TO MMINITA
  8719         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8720     ELSE
  8721         MOVE AL-UANOF           TO MMINITA.
  8722
  8723     IF CRTLNMEI GREATER THAN LOW-VALUES
  8724         IF CRTLNMEI NOT = SPACES
  8725            MOVE AL-UANON        TO CRTLNMEA
  8726            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8727                                     CERT-KEY-SWITCH
  8728        ELSE
  8729            MOVE ER-0236         TO EMI-ERROR
  8730            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8731            MOVE AL-UABON        TO CRTLNMEA
  8732            MOVE -1              TO CRTLNMEL
  8733            MOVE 'X'             TO ERROR-SWITCH
  8734     ELSE
  8735         MOVE AL-UANOF           TO CRTLNMEA.
  8736
  8737     IF CRTFNMEI GREATER THAN LOW-VALUES
  8738         MOVE AL-UANON           TO CRTFNMEA
  8739         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8740     ELSE
  8741         MOVE AL-UANOF           TO CRTFNMEA.
  8742
  8743     IF CRTINITI GREATER THAN LOW-VALUES
  8744         MOVE AL-UANON           TO CRTINITA
  8745         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8746     ELSE
  8747         MOVE AL-UANOF           TO CRTINITA.
  8748
  8749     IF ISSAGEL GREATER THAN ZERO
  8750         IF ISSAGEI NUMERIC
  8751            MOVE AL-UANON        TO ISSAGEA
  8752            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8753         ELSE
  8754            MOVE ER-0237         TO EMI-ERROR
  8755            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8756            MOVE AL-UABON        TO ISSAGEA
  8757            MOVE -1              TO ISSAGEL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 159
* EL131.cbl
  8758            MOVE 'X'             TO ERROR-SWITCH
  8759     ELSE
  8760         MOVE AL-UANOF           TO ISSAGEA.
  8761
  8762     IF JNTFNMEI GREATER THAN LOW-VALUES
  8763         MOVE AL-UANON           TO JNTFNMEA
  8764         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8765     ELSE
  8766         MOVE AL-UANOF           TO JNTFNMEA.
  8767
  8768     IF JNTLNMEI GREATER THAN LOW-VALUES
  8769         MOVE AL-UANON           TO JNTLNMEA
  8770         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8771     ELSE
  8772         MOVE AL-UANOF           TO JNTLNMEA.
  8773
  8774     IF JNTINITI GREATER THAN LOW-VALUES
  8775         MOVE AL-UANON           TO JNTINITA
  8776         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8777     ELSE
  8778         MOVE AL-UANOF           TO JNTINITA.
  8779
  8780     IF JNTAGEL GREATER THAN ZERO
  8781         IF JNTAGEI NUMERIC
  8782            MOVE AL-UANON        TO JNTAGEA
  8783            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8784         ELSE
  8785            MOVE ER-0238         TO EMI-ERROR
  8786            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8787            MOVE AL-UABON        TO JNTAGEA
  8788            MOVE -1              TO JNTAGEL
  8789            MOVE 'X'             TO ERROR-SWITCH
  8790     ELSE
  8791         MOVE AL-UANOF           TO JNTAGEA.
  8792
  8793     IF ADDONDTI GREATER THAN LOW-VALUES
  8794         MOVE LOW-VALUES         TO HOLD-ADDON
  8795         IF ADDONDTI = SPACES
  8796             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8797         ELSE
  8798             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8799
  8800* EXEC CICS BIF DEEDIT
  8801*                FIELD    (DEEDIT-DATE-INPUT)
  8802*                LENGTH   (DATE-LENGTH)
  8803*            END-EXEC
  8804*    MOVE '@"L                   #   #00008477' TO DFHEIV0
  8805     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8806     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8807     MOVE X'2020233030303038343737' TO DFHEIV0(25:11)
  8808     CALL 'kxdfhei1' USING DFHEIV0,
  8809           DEEDIT-DATE-INPUT,
  8810           DATE-LENGTH
  8811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8812             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8813             MOVE '4'            TO DC-OPTION-CODE
  8814             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8815             IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 160
* EL131.cbl
  8816                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8817                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8818                                                  CERT-SWITCH
  8819                 MOVE AL-UANON   TO ADDONDTA
  8820                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8821             ELSE
  8822                 MOVE ER-7651    TO EMI-ERROR
  8823                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8824                 MOVE AL-UABON   TO ADDONDTA
  8825                 MOVE -1         TO ADDONDTL
  8826                 MOVE 'X'        TO ERROR-SWITCH
  8827       ELSE
  8828         MOVE AL-UANOF TO ADDONDTA.
  8829
  8830     IF LCVCDI GREATER THAN LOW-VALUES
  8831         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8832         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8833     ELSE
  8834         MOVE AL-UANOF           TO LCVCDA.
  8835
  8836     IF ACVCDI GREATER THAN LOW-VALUES
  8837         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8838         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8839     ELSE
  8840         MOVE AL-UANOF           TO ACVCDA.
  8841
  8842     IF LCVOTRMI GREATER THAN LOW-VALUES
  8843
  8844* EXEC CICS BIF DEEDIT
  8845*            FIELD (LCVOTRMI)
  8846*            LENGTH(3)
  8847*        END-EXEC
  8848     MOVE 3
  8849       TO DFHEIV11
  8850*    MOVE '@"L                   #   #00008512' TO DFHEIV0
  8851     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8852     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8853     MOVE X'2020233030303038353132' TO DFHEIV0(25:11)
  8854     CALL 'kxdfhei1' USING DFHEIV0,
  8855           LCVOTRMI,
  8856           DFHEIV11
  8857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8858         IF LCVOTRMI IS NUMERIC
  8859             MOVE LCVOTRMI       TO LCVOTRMO
  8860             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8861             MOVE AL-UANON       TO LCVOTRMA
  8862         ELSE
  8863             MOVE ER-0241        TO EMI-ERROR
  8864             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8865             MOVE AL-UNBON       TO LCVOTRMA
  8866             MOVE 'X'            TO ERROR-SWITCH
  8867             MOVE -1             TO LCVOTRML
  8868     ELSE
  8869         MOVE AL-UANOF           TO LCVOTRMA.
  8870
  8871     IF ACVOTRMI GREATER THAN LOW-VALUES
  8872
  8873* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 161
* EL131.cbl
  8874*            FIELD (ACVOTRMI)
  8875*            LENGTH(3)
  8876*        END-EXEC
  8877     MOVE 3
  8878       TO DFHEIV11
  8879*    MOVE '@"L                   #   #00008530' TO DFHEIV0
  8880     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8881     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8882     MOVE X'2020233030303038353330' TO DFHEIV0(25:11)
  8883     CALL 'kxdfhei1' USING DFHEIV0,
  8884           ACVOTRMI,
  8885           DFHEIV11
  8886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8887         IF ACVOTRMI IS NUMERIC
  8888             MOVE ACVOTRMI       TO ACVOTRMO
  8889             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8890             MOVE AL-UANON       TO ACVOTRMA
  8891         ELSE
  8892             MOVE ER-0241        TO EMI-ERROR
  8893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8894             MOVE AL-UNBON       TO ACVOTRMA
  8895             MOVE 'X'            TO ERROR-SWITCH
  8896             MOVE -1             TO ACVOTRML
  8897     ELSE
  8898         MOVE AL-UANOF           TO ACVOTRMA.
  8899
  8900     IF LCVRATEL GREATER THAN +0
  8901
  8902* EXEC CICS BIF DEEDIT
  8903*            FIELD (LCVRATEI)
  8904*            LENGTH(6)
  8905*        END-EXEC
  8906     MOVE 6
  8907       TO DFHEIV11
  8908*    MOVE '@"L                   #   #00008548' TO DFHEIV0
  8909     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8910     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8911     MOVE X'2020233030303038353438' TO DFHEIV0(25:11)
  8912     CALL 'kxdfhei1' USING DFHEIV0,
  8913           LCVRATEI,
  8914           DFHEIV11
  8915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8916         IF LCVRATEI IS NUMERIC
  8917             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8918             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8919             MOVE AL-UNNON       TO LCVRATEA
  8920         ELSE
  8921             MOVE ER-2280        TO EMI-ERROR
  8922             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8923             MOVE AL-UNBON       TO LCVRATEA
  8924             MOVE 'X'            TO ERROR-SWITCH
  8925             MOVE -1             TO LCVRATEL
  8926     ELSE
  8927         MOVE AL-UNNOF           TO LCVRATEA.
  8928
  8929     IF ACVRATEL GREATER THAN +0
  8930
  8931* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 162
* EL131.cbl
  8932*            FIELD (ACVRATEI)
  8933*            LENGTH(6)
  8934*        END-EXEC
  8935     MOVE 6
  8936       TO DFHEIV11
  8937*    MOVE '@"L                   #   #00008566' TO DFHEIV0
  8938     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038353636' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           ACVRATEI,
  8943           DFHEIV11
  8944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8945         IF ACVRATEI IS NUMERIC
  8946             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  8947             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8948             MOVE AL-UNNON       TO ACVRATEA
  8949         ELSE
  8950             MOVE ER-2280        TO EMI-ERROR
  8951             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8952             MOVE AL-UNBON       TO ACVRATEA
  8953             MOVE 'X'            TO ERROR-SWITCH
  8954             MOVE -1             TO ACVRATEL
  8955     ELSE
  8956         MOVE AL-UNNOF           TO ACVRATEA.
  8957
  8958     IF LCVBENEL GREATER THAN ZERO
  8959
  8960* EXEC CICS BIF DEEDIT
  8961*            FIELD (LCVBENEI)
  8962*            LENGTH (11)
  8963*        END-EXEC
  8964     MOVE 11
  8965       TO DFHEIV11
  8966*    MOVE '@"L                   #   #00008584' TO DFHEIV0
  8967     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8968     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8969     MOVE X'2020233030303038353834' TO DFHEIV0(25:11)
  8970     CALL 'kxdfhei1' USING DFHEIV0,
  8971           LCVBENEI,
  8972           DFHEIV11
  8973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8974         IF LCVBENEI IS NUMERIC
  8975            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8976            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8977            MOVE AL-UNNON        TO LCVBENEA
  8978         ELSE
  8979            MOVE ER-0243         TO EMI-ERROR
  8980            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8981            MOVE AL-UNBON        TO LCVBENEA
  8982            MOVE -1              TO LCVBENEL
  8983            MOVE 'X'             TO ERROR-SWITCH
  8984     ELSE
  8985         MOVE AL-UANOF           TO LCVBENEA.
  8986
  8987     IF ACVBENEL GREATER THAN ZERO
  8988
  8989* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 163
* EL131.cbl
  8990*            FIELD (ACVBENEI)
  8991*            LENGTH (11)
  8992*        END-EXEC
  8993     MOVE 11
  8994       TO DFHEIV11
  8995*    MOVE '@"L                   #   #00008602' TO DFHEIV0
  8996     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8997     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8998     MOVE X'2020233030303038363032' TO DFHEIV0(25:11)
  8999     CALL 'kxdfhei1' USING DFHEIV0,
  9000           ACVBENEI,
  9001           DFHEIV11
  9002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9003         IF ACVBENEI IS NUMERIC
  9004            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9005            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9006            MOVE AL-UNNON        TO ACVBENEA
  9007         ELSE
  9008            MOVE ER-0243         TO EMI-ERROR
  9009            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9010            MOVE AL-UNBON        TO ACVBENEA
  9011            MOVE -1              TO ACVBENEL
  9012            MOVE 'X'             TO ERROR-SWITCH
  9013     ELSE
  9014         MOVE AL-UANOF           TO ACVBENEA.
  9015
  9016     IF LCVFORMI GREATER THAN LOW-VALUES
  9017        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9018        MOVE AL-UANON            TO LCVFORMA
  9019     ELSE
  9020        MOVE AL-UANOF            TO LCVFORMA.
  9021
  9022     IF ACVFORMI GREATER THAN LOW-VALUES
  9023        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9024        MOVE AL-UANON            TO ACVFORMA
  9025     ELSE
  9026        MOVE AL-UANOF            TO ACVFORMA.
  9027
  9028     IF LCVCNDTL GREATER THAN ZERO
  9029         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9030         IF LCVCNDTI = SPACES
  9031             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9032         ELSE
  9033             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9034             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9035             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9036             MOVE '4'            TO DC-OPTION-CODE
  9037             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9038             IF NOT DATE-CONVERSION-ERROR
  9039                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9040                 MOVE AL-UANON   TO LCVCNDTA
  9041                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9042                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9043             ELSE
  9044                 MOVE ER-0246    TO EMI-ERROR
  9045                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9046                 MOVE AL-UABON   TO LCVCNDTA
  9047                 MOVE -1         TO LCVCNDTL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 164
* EL131.cbl
  9048                 MOVE 'X'        TO ERROR-SWITCH
  9049     ELSE
  9050         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9051         MOVE AL-UANOF           TO LCVCNDTA.
  9052
  9053     IF ACVCNDTL GREATER THAN ZERO
  9054         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9055         IF ACVCNDTI = SPACES
  9056             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9057         ELSE
  9058             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9059             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9060             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9061             MOVE '4'            TO DC-OPTION-CODE
  9062             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9063             IF NOT DATE-CONVERSION-ERROR
  9064                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9065                 MOVE AL-UANON   TO ACVCNDTA
  9066                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9067                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9068             ELSE
  9069                 MOVE ER-0246    TO EMI-ERROR
  9070                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9071                 MOVE AL-UABON   TO ACVCNDTA
  9072                 MOVE -1         TO ACVCNDTL
  9073                 MOVE 'X'        TO ERROR-SWITCH
  9074     ELSE
  9075         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9076         MOVE AL-UANOF           TO ACVCNDTA.
  9077
  9078     IF APRL GREATER THAN +0
  9079
  9080* EXEC CICS BIF DEEDIT
  9081*            FIELD    (APRI)
  9082*            LENGTH   (8)
  9083*        END-EXEC
  9084     MOVE 8
  9085       TO DFHEIV11
  9086*    MOVE '@"L                   #   #00008682' TO DFHEIV0
  9087     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9088     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9089     MOVE X'2020233030303038363832' TO DFHEIV0(25:11)
  9090     CALL 'kxdfhei1' USING DFHEIV0,
  9091           APRI,
  9092           DFHEIV11
  9093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9094         IF APRI NUMERIC
  9095            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9096            MOVE APRI            TO HOLD-APR APRO
  9097            MOVE AL-UANON        TO APRA
  9098          ELSE
  9099            MOVE ER-0259         TO EMI-ERROR
  9100            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9101            MOVE AL-UABON        TO APRA
  9102            MOVE -1              TO APRL
  9103            MOVE 'X'             TO ERROR-SWITCH
  9104     ELSE
  9105         MOVE AL-UANOF           TO APRA.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 165
* EL131.cbl
  9106
  9107     IF PMTFREQL GREATER THAN ZERO
  9108
  9109* EXEC CICS BIF DEEDIT
  9110*            FIELD    (PMTFREQI)
  9111*            LENGTH   (2)
  9112*        END-EXEC
  9113     MOVE 2
  9114       TO DFHEIV11
  9115*    MOVE '@"L                   #   #00008700' TO DFHEIV0
  9116     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9117     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9118     MOVE X'2020233030303038373030' TO DFHEIV0(25:11)
  9119     CALL 'kxdfhei1' USING DFHEIV0,
  9120           PMTFREQI,
  9121           DFHEIV11
  9122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9123         IF PMTFREQI NUMERIC
  9124            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9125            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9126            MOVE AL-UANON        TO PMTFREQA
  9127          ELSE
  9128            MOVE ER-0427         TO EMI-ERROR
  9129            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9130            MOVE AL-UABON        TO PMTFREQA
  9131            MOVE -1              TO PMTFREQL
  9132            MOVE 'X'             TO ERROR-SWITCH
  9133     ELSE
  9134         MOVE AL-UANOF           TO PMTFREQA.
  9135
  9136     IF INDGRPL GREATER THAN ZERO
  9137         IF INDGRPI = 'I' OR 'G' OR SPACE
  9138             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9139             MOVE AL-UANON       TO INDGRPA
  9140          ELSE
  9141             MOVE ER-0260        TO EMI-ERROR
  9142             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9143             MOVE AL-UABON       TO INDGRPA
  9144             MOVE -1             TO INDGRPL
  9145             MOVE 'X'            TO ERROR-SWITCH
  9146     ELSE
  9147         MOVE AL-UANOF           TO INDGRPA.
  9148
  9149     IF PREMTYPL GREATER THAN ZERO
  9150         IF PREMTYPI = '1' OR '2' OR '3'
  9151            MOVE PREMTYPI        TO PI-PREM-TYPE
  9152            MOVE AL-UNNON        TO PREMTYPA
  9153            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9154          ELSE
  9155            MOVE ER-0227         TO EMI-ERROR
  9156            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9157            MOVE AL-UNBON        TO PREMTYPA
  9158            MOVE -1              TO PREMTYPL
  9159            MOVE 'X'             TO ERROR-SWITCH
  9160     ELSE
  9161         MOVE AL-UANOF           TO PREMTYPA.
  9162
  9163     IF LOANBALL GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 166
* EL131.cbl
  9164
  9165* EXEC CICS BIF DEEDIT
  9166*             FIELD    (LOANBALI)
  9167*             LENGTH   (9)
  9168*        END-EXEC
  9169     MOVE 9
  9170       TO DFHEIV11
  9171*    MOVE '@"L                   #   #00008745' TO DFHEIV0
  9172     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9173     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9174     MOVE X'2020233030303038373435' TO DFHEIV0(25:11)
  9175     CALL 'kxdfhei1' USING DFHEIV0,
  9176           LOANBALI,
  9177           DFHEIV11
  9178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9179         IF LOANBALI NUMERIC
  9180             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9181             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9182             MOVE AL-UNNON TO LOANBALA
  9183         ELSE
  9184             MOVE ER-0639        TO EMI-ERROR
  9185             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9186             MOVE AL-UNBON       TO LOANBALA
  9187             MOVE -1             TO LOANBALL
  9188             MOVE 'X'            TO ERROR-SWITCH
  9189     ELSE
  9190         MOVE AL-UNNOF           TO LOANBALA.
  9191
  9192     IF LOANNOL GREATER THAN ZERO
  9193        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9194        MOVE AL-UANON            TO LOANNOA
  9195     ELSE
  9196        MOVE AL-UANOF            TO LOANNOA.
  9197
  9198     IF REINCDI GREATER THAN LOW-VALUES
  9199        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9200        MOVE AL-UANON            TO REINCDA
  9201     ELSE
  9202        MOVE AL-UANOF            TO REINCDA.
  9203
  9204     IF CERTI GREATER THAN LOW-VALUES
  9205         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9206     ELSE
  9207         MOVE AL-UANOF           TO CERTA.
  9208
  9209     IF CERTEFFI GREATER THAN LOW-VALUES
  9210         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9211     ELSE
  9212         MOVE AL-UANOF           TO CERTEFFA.
  9213
  9214     IF CERTACTI GREATER THAN LOW-VALUES
  9215         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9216     ELSE
  9217         MOVE AL-UANOF           TO CERTACTA.
  9218
  9219     IF CERTSTI GREATER THAN LOW-VALUES
  9220         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9221     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 167
* EL131.cbl
  9222         MOVE AL-UANOF           TO CERTSTA.
  9223
  9224     IF CERTCARI GREATER THAN LOW-VALUES
  9225         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9226     ELSE
  9227         MOVE AL-UANOF           TO CERTCARA.
  9228
  9229     IF DLYACTV-RECORD-NEEDED
  9230         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9231                 1150-EXIT
  9232     END-IF.
  9233
  9234     IF CERTEFFI GREATER LOW-VALUES OR
  9235        CERTACTI GREATER LOW-VALUES OR
  9236        CERTSTI  GREATER LOW-VALUES OR
  9237        CERTCARI GREATER LOW-VALUES OR
  9238        CERTGRPI GREATER LOW-VALUES
  9239        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9240
  9241*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9242*      IF PI-PREM-TYPE NOT = '1'  AND
  9243*         PI-NO-PMTS = ZEROS
  9244*          IF LOANBALL GREATER +0 OR
  9245*             ACVBENEL GREATER +0
  9246*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9247
  9248     if accswl > zeros
  9249        if accswi = 'Y' OR 'N'
  9250           MOVE 'X'              TO UPDATE-SWITCH
  9251                                    MSTR-SWITCH
  9252           MOVE AL-UANON         TO accswa
  9253        else
  9254           move er-1656          to emi-error
  9255           PERFORM 9900-ERROR-FORMAT
  9256                                 THRU 9900-EXIT
  9257           move al-uabon         to accswa
  9258           move -1               to accswl
  9259           move 'X'              to error-switch
  9260           move al-uanof         to accswa
  9261        end-if
  9262     end-if
  9263     IF CERTL = ZEROS AND
  9264        SUFXL = ZEROS
  9265          GO TO 1010-EXIT.
  9266
  9267     IF CERTL GREATER THAN ZEROS
  9268         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9269             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9270             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9271             MOVE 'X'            TO ERROR-SWITCH
  9272             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9273
  9274     IF SUFXL GREATER THAN ZEROS
  9275         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9276             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9277             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9278             MOVE 'X'            TO ERROR-SWITCH
  9279             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 168
* EL131.cbl
  9280
  9281 1010-EXIT.
  9282     EXIT.
  9283
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 169
* EL131.cbl
  9285 1120-EDIT-PROC.
  9286     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9287     MOVE '2'                    TO CNTL-REC-TYPE.
  9288     MOVE PROCI                  TO CNTL-PROC-ID.
  9289     MOVE ZERO                   TO CNTL-SEQ-NO.
  9290
  9291
  9292* EXEC CICS HANDLE CONDITION
  9293*         NOTFND    (1120-CNTL-NOTFND)
  9294*    END-EXEC.
  9295*    MOVE '"$I                   ! & #00008861' TO DFHEIV0
  9296     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9298     MOVE X'2620233030303038383631' TO DFHEIV0(25:11)
  9299     CALL 'kxdfhei1' USING DFHEIV0
  9300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9301
  9302
  9303
  9304* EXEC CICS READ
  9305*         SET      (ADDRESS OF CONTROL-FILE)
  9306*         DATASET  (CNTL-FILE-ID)
  9307*         RIDFLD   (CNTL-KEY)
  9308*    END-EXEC.
  9309*    MOVE '&"S        E          (   #00008865' TO DFHEIV0
  9310     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9311     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9312     MOVE X'2020233030303038383635' TO DFHEIV0(25:11)
  9313     CALL 'kxdfhei1' USING DFHEIV0,
  9314           CNTL-FILE-ID,
  9315           DFHEIV20,
  9316           DFHEIV99,
  9317           CNTL-KEY,
  9318           DFHEIV99,
  9319           DFHEIV99,
  9320           DFHEIV99
  9321     SET ADDRESS OF CONTROL-FILE TO
  9322         DFHEIV20
  9323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9324
  9325
  9326     MOVE AL-UANON               TO PROCA.
  9327     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9328     GO TO 1120-EXIT.
  9329
  9330 1120-CNTL-NOTFND.
  9331     MOVE ER-0273                TO EMI-ERROR.
  9332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9333     MOVE AL-UABON               TO PROCA.
  9334     MOVE -1                     TO PROCL.
  9335     MOVE 'X'                    TO ERROR-SWITCH.
  9336
  9337 1120-EXIT.
  9338     EXIT.
  9339
  9340*************************************************************
  9341*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9342*************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 170
* EL131.cbl
  9343
  9344 1150-OUTPUT-ACTIVITY-RECORD.
  9345
  9346
  9347* EXEC CICS GETMAIN
  9348*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9349*        LENGTH (25)
  9350*        INITIMG (WS-BLANK)
  9351*    END-EXEC.
  9352     MOVE 25
  9353       TO DFHEIV11
  9354*    MOVE ',"IL                  $   #00008891' TO DFHEIV0
  9355     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9356     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9357     MOVE X'2020233030303038383931' TO DFHEIV0(25:11)
  9358     CALL 'kxdfhei1' USING DFHEIV0,
  9359           DFHEIV20,
  9360           DFHEIV11,
  9361           WS-BLANK
  9362     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9363         DFHEIV20
  9364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9365
  9366
  9367     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9368     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9369     MOVE PI-CARRIER             TO DA-CARRIER.
  9370     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9371     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9372     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9373     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9374
  9375
  9376* EXEC CICS HANDLE CONDITION
  9377*        NOTOPEN (1150-NOTOPEN-ERROR)
  9378*        DUPREC (1150-EXIT)
  9379*    END-EXEC.
  9380*    MOVE '"$J%                  ! '' #00008905' TO DFHEIV0
  9381     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9383     MOVE X'2720233030303038393035' TO DFHEIV0(25:11)
  9384     CALL 'kxdfhei1' USING DFHEIV0
  9385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9386
  9387     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9388     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9389     MOVE 'A'                    TO JP-RECORD-TYPE.
  9390     MOVE +48                    TO JOURNAL-LENGTH.
  9391
  9392
  9393* EXEC CICS WRITE
  9394*        DATASET ('DLYACTV')
  9395*        RIDFLD (DA-KEY)
  9396*        FROM (DAILY-ACTIVITY-RECORD)
  9397*        LENGTH (25)
  9398*    END-EXEC.
  9399     MOVE 'DLYACTV' TO DFHEIV1
  9400     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 171
* EL131.cbl
  9401       TO DFHEIV11
  9402*    MOVE '&$ L                  ''   #00008914' TO DFHEIV0
  9403     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9404     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9405     MOVE X'2020233030303038393134' TO DFHEIV0(25:11)
  9406     CALL 'kxdfhei1' USING DFHEIV0,
  9407           DFHEIV1,
  9408           DAILY-ACTIVITY-RECORD,
  9409           DFHEIV11,
  9410           DA-KEY,
  9411           DFHEIV99,
  9412           DFHEIV99
  9413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9414
  9415
  9416     GO TO 1150-EXIT.
  9417
  9418 1150-NOTOPEN-ERROR.
  9419
  9420     MOVE '2955'                 TO EMI-ERROR.
  9421     MOVE -1                     TO MAINTL.
  9422     MOVE AL-UANON               TO MAINTA.
  9423     MOVE 'X'                    TO ERROR-SWITCH.
  9424     PERFORM 9900-ERROR-FORMAT THRU
  9425             9900-EXIT.
  9426
  9427 1150-EXIT.
  9428     EXIT.
  9429
  9430*************************************************************
  9431*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9432*************************************************************
  9433
  9434 1240-EDIT-LIFE-CODE.
  9435
  9436     IF INVALID-BENEFIT-CODE
  9437         GO TO 1240-SET-ERROR.
  9438
  9439     MOVE SPACES                 TO BENEFIT-KEY.
  9440     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9441     MOVE '4'                    TO BEN-REC-TYPE.
  9442     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9443     MOVE ZERO                   TO BEN-SEQ-NO.
  9444
  9445
  9446* EXEC CICS READ GTEQ
  9447*         DATASET  (CNTL-FILE-ID)
  9448*         RIDFLD   (BENEFIT-KEY)
  9449*         SET      (ADDRESS OF CONTROL-FILE)
  9450*    END-EXEC.
  9451*    MOVE '&"S        G          (   #00008950' TO DFHEIV0
  9452     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9454     MOVE X'2020233030303038393530' TO DFHEIV0(25:11)
  9455     CALL 'kxdfhei1' USING DFHEIV0,
  9456           CNTL-FILE-ID,
  9457           DFHEIV20,
  9458           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 172
* EL131.cbl
  9459           BENEFIT-KEY,
  9460           DFHEIV99,
  9461           DFHEIV99,
  9462           DFHEIV99
  9463     SET ADDRESS OF CONTROL-FILE TO
  9464         DFHEIV20
  9465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9466
  9467
  9468     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9469        CF-RECORD-TYPE NOT = '4'
  9470         GO TO 1240-SET-ERROR.
  9471
  9472     MOVE ZERO                   TO COUNT-2.
  9473     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9474
  9475     IF SCREEN-ERROR
  9476         GO TO 1240-SET-ERROR.
  9477
  9478 1240-SET-CODE-SWITCHES.
  9479     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9480     MOVE AL-UANON               TO LCVCDA.
  9481     GO TO 1240-EXIT.
  9482
  9483 1240-SET-ERROR.
  9484     MOVE ER-0240                TO EMI-ERROR.
  9485     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9486     MOVE 'X'                    TO ERROR-SWITCH.
  9487     MOVE AL-UABON               TO LCVCDA.
  9488     MOVE -1                     TO LCVCDL.
  9489
  9490 1240-EXIT.
  9491     EXIT.
  9492
  9493 1310-EDIT-AH-CODE.
  9494     IF INVALID-BENEFIT-CODE
  9495         GO TO 1310-SET-ERROR.
  9496
  9497     MOVE SPACES                 TO BENEFIT-KEY.
  9498     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9499     MOVE '5'                    TO BEN-REC-TYPE.
  9500     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9501     MOVE ZERO                   TO BEN-SEQ-NO.
  9502
  9503
  9504* EXEC CICS READ GTEQ
  9505*         DATASET  (CNTL-FILE-ID)
  9506*         RIDFLD   (BENEFIT-KEY)
  9507*         SET      (ADDRESS OF CONTROL-FILE)
  9508*    END-EXEC.
  9509*    MOVE '&"S        G          (   #00008991' TO DFHEIV0
  9510     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9511     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9512     MOVE X'2020233030303038393931' TO DFHEIV0(25:11)
  9513     CALL 'kxdfhei1' USING DFHEIV0,
  9514           CNTL-FILE-ID,
  9515           DFHEIV20,
  9516           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 173
* EL131.cbl
  9517           BENEFIT-KEY,
  9518           DFHEIV99,
  9519           DFHEIV99,
  9520           DFHEIV99
  9521     SET ADDRESS OF CONTROL-FILE TO
  9522         DFHEIV20
  9523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9524
  9525
  9526     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9527        CF-RECORD-TYPE NOT = '5'
  9528         GO TO 1310-SET-ERROR.
  9529
  9530     MOVE ZERO                   TO COUNT-2.
  9531     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9532     IF SCREEN-ERROR
  9533         GO TO 1310-SET-ERROR.
  9534
  9535 1310-SET-CODE-SWITCHES.
  9536     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9537     MOVE AL-UANON               TO ACVCDA.
  9538     GO TO 1310-EXIT.
  9539
  9540 1310-SET-ERROR.
  9541     MOVE ER-0250                TO EMI-ERROR.
  9542     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9543     MOVE AL-UABON               TO ACVCDA.
  9544     MOVE 'X'                    TO ERROR-SWITCH.
  9545     MOVE -1                     TO ACVCDL.
  9546
  9547 1310-EXIT.
  9548     EXIT.
  9549
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 174
* EL131.cbl
  9551 1460-EDIT-CERT-NO.
  9552     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9553     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9554
  9555     IF WS-SAVE-CERT-NO = SPACES
  9556         MOVE ER-0203            TO EMI-ERROR
  9557         GO TO 1460-CERT-NO-ERROR.
  9558
  9559     IF WS-CERT-NO-PRIME = SPACES AND
  9560        WS-CERT-NO-SUFX GREATER THAN SPACE
  9561            MOVE ER-0210         TO EMI-ERROR
  9562            GO TO 1460-CERT-NO-ERROR.
  9563
  9564     MOVE 'X'                    TO UPDATE-SWITCH.
  9565     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9566     MOVE AL-UANON               TO CERTA.
  9567
  9568     IF SUFXL IS GREATER THAN 0
  9569         MOVE AL-UANON           TO SUFXA.
  9570
  9571     GO TO 1460-EXIT.
  9572
  9573 1460-CERT-NO-ERROR.
  9574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9575     MOVE AL-UABON               TO SUFXA.
  9576     MOVE AL-UABON               TO CERTA.
  9577     MOVE -1                     TO CERTL.
  9578     MOVE 'X'                    TO ERROR-SWITCH.
  9579
  9580 1460-EXIT.
  9581     EXIT.
  9582
  9583 1470-EDIT-EFF.
  9584     IF CERTEFFI = SPACES
  9585         GO TO 1470-DATE-ERROR.
  9586
  9587     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9588     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9589     IF DEEDIT-DATE = ZERO
  9590         GO TO 1470-DATE-ERROR.
  9591
  9592     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9593     MOVE '4'                    TO DC-OPTION-CODE.
  9594     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9595     IF NOT DATE-CONVERSION-ERROR
  9596         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9597         MOVE AL-UANON           TO CERTEFFA
  9598         MOVE 'X'                TO UPDATE-SWITCH
  9599         MOVE 'Y'                TO CERT-KEY-SWITCH
  9600         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9601         GO TO 1470-EXIT.
  9602
  9603 1470-DATE-ERROR.
  9604     MOVE ER-0215                TO EMI-ERROR.
  9605     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9606     MOVE AL-UABON               TO CERTEFFA.
  9607     MOVE -1                     TO CERTEFFL.
  9608     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 175
* EL131.cbl
  9609
  9610 1470-EXIT.
  9611     EXIT.
  9612
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 176
* EL131.cbl
  9614 1480-EDIT-ACCT.
  9615     IF CERTACTI = SPACES
  9616         MOVE ER-0232            TO EMI-ERROR
  9617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9618         MOVE AL-UABON           TO CERTACTA
  9619         MOVE -1                 TO CERTACTL
  9620         MOVE 'X'                TO ERROR-SWITCH
  9621     ELSE
  9622         MOVE 'X'                TO UPDATE-SWITCH
  9623         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9624
  9625 1480-EXIT.
  9626     EXIT.
  9627
  9628 1490-EDIT-STATE.
  9629     IF CERTSTI = SPACES
  9630         MOVE ER-0233            TO EMI-ERROR
  9631         GO TO 1490-STATE-ERROR.
  9632
  9633     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9634     MOVE '3'                    TO CNTL-REC-TYPE.
  9635     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9636     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9637     MOVE ZERO                   TO CNTL-SEQ-NO.
  9638
  9639
  9640* EXEC CICS HANDLE CONDITION
  9641*         NOTFND (1490-STATE-NOTFND)
  9642*    END-EXEC.
  9643*    MOVE '"$I                   ! ( #00009110' TO DFHEIV0
  9644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9646     MOVE X'2820233030303039313130' TO DFHEIV0(25:11)
  9647     CALL 'kxdfhei1' USING DFHEIV0
  9648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9649
  9650
  9651
  9652* EXEC CICS READ
  9653*         SET        (ADDRESS OF CONTROL-FILE)
  9654*         DATASET    ('ELCNTL')
  9655*         RIDFLD     (CNTL-KEY)
  9656*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9657*         GENERIC
  9658*    END-EXEC.
  9659     MOVE 'ELCNTL' TO DFHEIV1
  9660*    MOVE '&"S  KG    E          (   #00009114' TO DFHEIV0
  9661     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9663     MOVE X'2020233030303039313134' TO DFHEIV0(25:11)
  9664     CALL 'kxdfhei1' USING DFHEIV0,
  9665           DFHEIV1,
  9666           DFHEIV20,
  9667           DFHEIV99,
  9668           CNTL-KEY,
  9669           CNTL-GENERIC-LENGTH,
  9670           DFHEIV99,
  9671           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 177
* EL131.cbl
  9672     SET ADDRESS OF CONTROL-FILE TO
  9673         DFHEIV20
  9674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9675
  9676
  9677     MOVE AL-UANON               TO CERTSTA.
  9678     MOVE 'X'                    TO UPDATE-SWITCH.
  9679     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9680     GO TO 1490-EXIT.
  9681
  9682 1490-STATE-NOTFND.
  9683     MOVE ER-0149                TO EMI-ERROR.
  9684
  9685 1490-STATE-ERROR.
  9686     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9687     MOVE AL-UABON               TO CERTSTA.
  9688     MOVE -1                     TO CERTSTL.
  9689     MOVE 'X'                    TO ERROR-SWITCH.
  9690
  9691 1490-EXIT.
  9692     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 178
* EL131.cbl
  9694 1500-EDIT-CARR.
  9695     IF CERTCARI = SPACES
  9696         GO TO 1500-CARR-NOTFND.
  9697
  9698     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9699     MOVE '6'                    TO CNTL-REC-TYPE.
  9700     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9701     MOVE CERTCARI               TO CNTL-CARRIER.
  9702     MOVE ZERO                   TO CNTL-SEQ-NO.
  9703
  9704
  9705* EXEC CICS HANDLE CONDITION
  9706*         NOTFND   (1500-CARR-NOTFND)
  9707*    END-EXEC.
  9708*    MOVE '"$I                   ! ) #00009149' TO DFHEIV0
  9709     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9711     MOVE X'2920233030303039313439' TO DFHEIV0(25:11)
  9712     CALL 'kxdfhei1' USING DFHEIV0
  9713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9714
  9715
  9716
  9717* EXEC CICS READ
  9718*         SET        (ADDRESS OF CONTROL-FILE)
  9719*         DATASET    ('ELCNTL')
  9720*         RIDFLD     (CNTL-KEY)
  9721*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9722*         GENERIC
  9723*    END-EXEC.
  9724     MOVE 'ELCNTL' TO DFHEIV1
  9725*    MOVE '&"S  KG    E          (   #00009153' TO DFHEIV0
  9726     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9728     MOVE X'2020233030303039313533' TO DFHEIV0(25:11)
  9729     CALL 'kxdfhei1' USING DFHEIV0,
  9730           DFHEIV1,
  9731           DFHEIV20,
  9732           DFHEIV99,
  9733           CNTL-KEY,
  9734           CNTL-GENERIC-LENGTH,
  9735           DFHEIV99,
  9736           DFHEIV99
  9737     SET ADDRESS OF CONTROL-FILE TO
  9738         DFHEIV20
  9739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9740
  9741
  9742     MOVE AL-UANON               TO CERTCARA.
  9743     MOVE 'X'                    TO UPDATE-SWITCH.
  9744     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9745     GO TO 1500-EXIT.
  9746
  9747 1500-CARR-NOTFND.
  9748     MOVE ER-0360                TO EMI-ERROR.
  9749     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9750     MOVE AL-UABON               TO CERTCARA.
  9751     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 179
* EL131.cbl
  9752     MOVE 'X'                    TO ERROR-SWITCH.
  9753
  9754 1500-EXIT.
  9755     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 180
* EL131.cbl
  9757 1510-DEEDIT-DATE.
  9758
  9759* EXEC CICS BIF DEEDIT
  9760*         FIELD    (DEEDIT-DATE-INPUT)
  9761*         LENGTH   (DATE-LENGTH)
  9762*    END-EXEC.
  9763*    MOVE '@"L                   #   #00009177' TO DFHEIV0
  9764     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9765     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9766     MOVE X'2020233030303039313737' TO DFHEIV0(25:11)
  9767     CALL 'kxdfhei1' USING DFHEIV0,
  9768           DEEDIT-DATE-INPUT,
  9769           DATE-LENGTH
  9770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9771
  9772
  9773 1510-EXIT.
  9774     EXIT.
  9775
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 181
* EL131.cbl
  9777 1620-VERIFY-ACCT.
  9778
  9779     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9780     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9781     MOVE PI-GROUPING            TO ACCT-GROUP.
  9782     MOVE PI-STATE               TO ACCT-STATE.
  9783     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9784
  9785     IF CERTEFFI GREATER THAN LOW-VALUES
  9786         MOVE HOLD-EFF           TO ACCT-DATE
  9787     ELSE
  9788         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9789
  9790     IF CERTACTI GREATER THAN LOW-VALUES
  9791         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9792     IF CERTSTI GREATER THAN LOW-VALUES
  9793         MOVE CERTSTI            TO  ACCT-STATE.
  9794     IF CERTCARI GREATER THAN LOW-VALUES
  9795         MOVE CERTCARI           TO  ACCT-CARRIER.
  9796     IF CERTGRPI GREATER THAN LOW-VALUES
  9797         MOVE CERTGRPI           TO ACCT-GROUP.
  9798
  9799     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9800
  9801
  9802* EXEC CICS HANDLE CONDITION
  9803*         NOTFND  (1620-ACCT-NOTFND)
  9804*    END-EXEC.
  9805*    MOVE '"$I                   ! * #00009210' TO DFHEIV0
  9806     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9807     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9808     MOVE X'2A20233030303039323130' TO DFHEIV0(25:11)
  9809     CALL 'kxdfhei1' USING DFHEIV0
  9810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9811
  9812
  9813
  9814* EXEC CICS STARTBR
  9815*         DATASET   (ACCT-FILE-ID)
  9816*         RIDFLD    (ACCT-KEY)
  9817*    END-EXEC.
  9818     MOVE 0
  9819       TO DFHEIV11
  9820*    MOVE '&,         G          &   #00009214' TO DFHEIV0
  9821     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9822     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9823     MOVE X'2020233030303039323134' TO DFHEIV0(25:11)
  9824     CALL 'kxdfhei1' USING DFHEIV0,
  9825           ACCT-FILE-ID,
  9826           ACCT-KEY,
  9827           DFHEIV99,
  9828           DFHEIV11,
  9829           DFHEIV99
  9830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9831
  9832
  9833 1620-ACCT-LOOP.
  9834
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 182
* EL131.cbl
  9835
  9836* EXEC CICS READNEXT
  9837*         DATASET  (ACCT-FILE-ID)
  9838*         RIDFLD   (ACCT-KEY)
  9839*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9840*    END-EXEC.
  9841     MOVE 0
  9842       TO DFHEIV11
  9843*    MOVE '&.S                   )   #00009221' TO DFHEIV0
  9844     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9845     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9846     MOVE X'2020233030303039323231' TO DFHEIV0(25:11)
  9847     CALL 'kxdfhei1' USING DFHEIV0,
  9848           ACCT-FILE-ID,
  9849           DFHEIV20,
  9850           DFHEIV99,
  9851           ACCT-KEY,
  9852           DFHEIV99,
  9853           DFHEIV11,
  9854           DFHEIV99,
  9855           DFHEIV99
  9856     SET ADDRESS OF ACCOUNT-MASTER TO
  9857         DFHEIV20
  9858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9859
  9860
  9861     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9862         GO TO 1620-ACCT-NOTFND.
  9863
  9864     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9865        HOLD-EFF     LESS AM-EXPIRATION-DT
  9866         NEXT SENTENCE
  9867     ELSE
  9868         GO TO 1620-ACCT-LOOP.
  9869
  9870     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9871         GO TO 1620-ACCT-END-BROWSE.
  9872
  9873     IF LOANBALL GREATER THAN +0
  9874         IF AM-MAX-TOT-BEN NUMERIC  AND
  9875            AM-MAX-TOT-BEN GREATER THAN ZERO
  9876             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9877                 MOVE AL-UNBON     TO LOANBALA
  9878                 MOVE -1           TO LOANBALL
  9879                 MOVE 'X'          TO ERROR-SWITCH
  9880                 MOVE ER-7641      TO EMI-ERROR
  9881                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9882
  9883     IF ACVBENEL GREATER THAN +0
  9884         IF AM-MAX-MON-BEN NUMERIC  AND
  9885            AM-MAX-MON-BEN GREATER THAN ZERO
  9886             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9887                 MOVE AL-UNBON     TO ACVBENEA
  9888                 MOVE -1           TO ACVBENEL
  9889                 MOVE 'X'          TO ERROR-SWITCH
  9890                 MOVE ER-7642      TO EMI-ERROR
  9891                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9892
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 183
* EL131.cbl
  9893 1620-ACCT-END-BROWSE.
  9894
  9895
  9896* EXEC CICS ENDBR
  9897*         DATASET (ACCT-FILE-ID)
  9898*    END-EXEC.
  9899     MOVE 0
  9900       TO DFHEIV11
  9901*    MOVE '&2                    $   #00009261' TO DFHEIV0
  9902     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9904     MOVE X'2020233030303039323631' TO DFHEIV0(25:11)
  9905     CALL 'kxdfhei1' USING DFHEIV0,
  9906           ACCT-FILE-ID,
  9907           DFHEIV11,
  9908           DFHEIV99
  9909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9910
  9911
  9912     GO TO 1620-EXIT.
  9913
  9914 1620-ACCT-NOTFND.
  9915
  9916     MOVE -1                     TO MAINTL.
  9917     MOVE 'X'                    TO ERROR-SWITCH.
  9918     MOVE ER-0426                TO EMI-ERROR.
  9919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9920
  9921 1620-EXIT.
  9922     EXIT.
  9923
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 184
* EL131.cbl
  9925 2000-UPDATE-CLAIM.
  9926
  9927     MOVE SPACES                 TO ERROR-SWITCH.
  9928     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9929     MOVE PI-CARRIER             TO CARRIER-CODE.
  9930     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9931     MOVE PI-CERT-NO             TO CERT-NO.
  9932
  9933     IF DELETE-CLAIM
  9934         GO TO 3000-DELETE-CLAIM.
  9935
  9936     IF  NOT MODIFY-CAP
  9937         MOVE ER-0070            TO EMI-ERROR
  9938         MOVE 'X'                TO ERROR-SWITCH
  9939         MOVE -1                 TO MAINTL
  9940         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9941         GO TO 2000-EXIT.
  9942
  9943     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9944     MOVE ZERO                   TO TRLR-SEQ-NO.
  9945
  9946
  9947* EXEC CICS READ UPDATE
  9948*         SET       (ADDRESS OF CLAIM-MASTER)
  9949*         DATASET   (CLMS-FILE-ID)
  9950*         RIDFLD    (MSTR-KEY)
  9951*    END-EXEC.
  9952*    MOVE '&"S        EU         (   #00009299' TO DFHEIV0
  9953     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9954     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9955     MOVE X'2020233030303039323939' TO DFHEIV0(25:11)
  9956     CALL 'kxdfhei1' USING DFHEIV0,
  9957           CLMS-FILE-ID,
  9958           DFHEIV20,
  9959           DFHEIV99,
  9960           MSTR-KEY,
  9961           DFHEIV99,
  9962           DFHEIV99,
  9963           DFHEIV99
  9964     SET ADDRESS OF CLAIM-MASTER TO
  9965         DFHEIV20
  9966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9967
  9968
  9969     if (incl > zeros)
  9970        and (cl-no-of-pmts-made > 0)
  9971        and (hold-incur > low-values)
  9972        and (hold-incur not = cl-incurred-dt)
  9973        if hold-incur > cl-incurred-dt
  9974           move cl-incurred-dt   to dc-bin-date-1
  9975           move hold-incur       to dc-bin-date-2
  9976        else
  9977           move hold-incur       to dc-bin-date-1
  9978           move cl-incurred-dt   to dc-bin-date-2
  9979        end-if
  9980        move '1'                 to dc-option-code
  9981        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9982        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 185
* EL131.cbl
  9983           MOVE ER-1663             TO EMI-ERROR
  9984           PERFORM 9900-ERROR-FORMAT
  9985                                 THRU 9900-EXIT
  9986           MOVE -1                  TO MAINTL
  9987           GO TO 8110-SEND-DATA
  9988        end-if
  9989     end-if
  9990     IF (CL-PRIORITY-CD = '8')
  9991        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  9992             AND 'AMWA' AND 'KMSB')
  9993        MOVE ER-8003             TO EMI-ERROR
  9994        PERFORM 9900-ERROR-FORMAT
  9995                                 THRU 9900-EXIT
  9996        MOVE -1                  TO MAINTL
  9997        GO TO 8110-SEND-DATA
  9998     END-IF
  9999
 10000     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10001         MOVE ER-0068            TO EMI-ERROR
 10002         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10003         GO TO 2000-EXIT.
 10004
 10005     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10006         MOVE ER-0068            TO EMI-ERROR
 10007         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10008         GO TO 2000-EXIT.
 10009
 10010     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10011         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10012
 10013     IF CL-PURGED-DT NOT = LOW-VALUES
 10014         MOVE ER-7691            TO EMI-ERROR
 10015         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10016         GO TO 2000-EXIT.
 10017
 10018     IF CERT-KEY-CHANGED
 10019         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10020
 10021     IF SCREEN-ERROR
 10022         MOVE ER-0068            TO EMI-ERROR
 10023         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10024         GO TO 2000-EXIT.
 10025
 10026     IF NINETY-TRLR-UPDATED
 10027         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10028
 10029     IF MSTR-KEY-CHANGED
 10030         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10031        ELSE
 10032         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10033
 10034     IF TRLR-UPDATE-REQUIRED
 10035         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10036
 10037 2000-CHECK-CERT.
 10038     IF NOT CERT-UPDATES
 10039         GO TO 2000-EXIT.
 10040
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 186
* EL131.cbl
 10041     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10042     MOVE PI-CARRIER             TO CERT-CARRIER.
 10043     MOVE PI-GROUPING            TO CERT-GROUP.
 10044     MOVE PI-STATE               TO CERT-STATE.
 10045     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10046     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10047     MOVE PI-CERT-NO             TO CERT-CERT.
 10048
 10049     IF CERT-ALT-KEY-CHANGED
 10050         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10051     ELSE
 10052         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10053
 10054 2000-EXIT.
 10055     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 187
* EL131.cbl
 10057 2010-RELEASE-REC.
 10058
 10059* EXEC CICS UNLOCK
 10060*         DATASET  (CLMS-FILE-ID)
 10061*    END-EXEC
 10062*    MOVE '&*                    #   #00009394' TO DFHEIV0
 10063     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10064     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10065     MOVE X'2020233030303039333934' TO DFHEIV0(25:11)
 10066     CALL 'kxdfhei1' USING DFHEIV0,
 10067           CLMS-FILE-ID,
 10068           DFHEIV99
 10069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10070
 10071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10072     MOVE 'X'                    TO ERROR-SWITCH.
 10073
 10074 2010-EXIT.
 10075     EXIT.
 10076
 10077 2020-NORMAL-UPDATE.
 10078     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10079
 10080     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10081
 10082     IF WS-OPEN-CLOSE-SW = 'Y'
 10083       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10084       IF PI-REC-FOUND-SW = 'Y'
 10085         IF CL-ACTIVITY-CODE = 09
 10086           NEXT SENTENCE
 10087         ELSE
 10088           IF WS-RESET-SW = 'Y'
 10089             IF CL-CLAIM-STATUS = 'C'
 10090               MOVE 07               TO  CL-ACTIVITY-CODE
 10091               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10092               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10093             ELSE
 10094               MOVE 08               TO  CL-ACTIVITY-CODE
 10095               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10096               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10097
 10098     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10099         MOVE 'Y'                TO CL-YESNOSW
 10100     END-IF.
 10101
 10102     if pi-company-id = 'DCC'
 10103        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10104        perform 2120-check-pdef  thru 2120-exit
 10105     end-if
 10106
 10107* EXEC CICS HANDLE CONDITION
 10108*         DUPKEY   (2020-EXIT)
 10109*    END-EXEC.
 10110*    MOVE '"$$                   ! + #00009433' TO DFHEIV0
 10111     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10113     MOVE X'2B20233030303039343333' TO DFHEIV0(25:11)
 10114     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 188
* EL131.cbl
 10115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10116
 10117
 10118
 10119* EXEC CICS REWRITE
 10120*         DATASET   (CLMS-FILE-ID)
 10121*         FROM      (CLAIM-MASTER)
 10122*    END-EXEC.
 10123     MOVE LENGTH OF
 10124      CLAIM-MASTER
 10125       TO DFHEIV11
 10126*    MOVE '&& L                  %   #00009437' TO DFHEIV0
 10127     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10128     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10129     MOVE X'2020233030303039343337' TO DFHEIV0(25:11)
 10130     CALL 'kxdfhei1' USING DFHEIV0,
 10131           CLMS-FILE-ID,
 10132           CLAIM-MASTER,
 10133           DFHEIV11,
 10134           DFHEIV99
 10135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10136
 10137
 10138 2020-EXIT.
 10139     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 189
* EL131.cbl
 10141 2030-KEY-UPDATE.
 10142     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10143
 10144
 10145* EXEC CICS DELETE
 10146*        DATASET  (CLMS-FILE-ID)
 10147*    END-EXEC.
 10148*    MOVE '&(                    &   #00009448' TO DFHEIV0
 10149     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10150     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10151     MOVE X'2020233030303039343438' TO DFHEIV0(25:11)
 10152     CALL 'kxdfhei1' USING DFHEIV0,
 10153           CLMS-FILE-ID,
 10154           DFHEIV99,
 10155           DFHEIV99,
 10156           DFHEIV99,
 10157           DFHEIV99
 10158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10159
 10160
 10161
 10162* EXEC CICS GETMAIN
 10163*         SET      (ADDRESS OF CLAIM-MASTER)
 10164*         LENGTH   (MSTR-LENGTH)
 10165*         INITIMG  (GETMAIN-SPACE)
 10166*    END-EXEC.
 10167*    MOVE ',"IL                  $   #00009452' TO DFHEIV0
 10168     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10169     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10170     MOVE X'2020233030303039343532' TO DFHEIV0(25:11)
 10171     CALL 'kxdfhei1' USING DFHEIV0,
 10172           DFHEIV20,
 10173           MSTR-LENGTH,
 10174           GETMAIN-SPACE
 10175     SET ADDRESS OF CLAIM-MASTER TO
 10176         DFHEIV20
 10177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10178
 10179
 10180     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10181
 10182     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10183
 10184     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10185
 10186     IF WS-OPEN-CLOSE-SW = 'Y'
 10187       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10188         IF PI-REC-FOUND-SW = 'Y'
 10189           IF CL-ACTIVITY-CODE = 09
 10190             NEXT SENTENCE
 10191           ELSE
 10192             IF WS-RESET-SW = 'Y'
 10193               IF CL-CLAIM-STATUS = 'C'
 10194                 MOVE 07             TO  CL-ACTIVITY-CODE
 10195                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10196                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10197               ELSE
 10198                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 190
* EL131.cbl
 10199                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10200                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10201
 10202
 10203* EXEC CICS HANDLE CONDITION
 10204*         DUPKEY    (2030-EXIT)
 10205*    END-EXEC.
 10206*    MOVE '"$$                   ! , #00009480' TO DFHEIV0
 10207     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10209     MOVE X'2C20233030303039343830' TO DFHEIV0(25:11)
 10210     CALL 'kxdfhei1' USING DFHEIV0
 10211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10212
 10213
 10214** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10215*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10216
 10217     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10218         MOVE 'Y'                TO CL-YESNOSW
 10219     END-IF.
 10220
 10221
 10222* EXEC CICS WRITE
 10223*         DATASET   (CLMS-FILE-ID)
 10224*         RIDFLD    (MSTR-KEY)
 10225*         FROM      (CLAIM-MASTER)
 10226*    END-EXEC.
 10227     MOVE LENGTH OF
 10228      CLAIM-MASTER
 10229       TO DFHEIV11
 10230*    MOVE '&$ L                  ''   #00009491' TO DFHEIV0
 10231     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10233     MOVE X'2020233030303039343931' TO DFHEIV0(25:11)
 10234     CALL 'kxdfhei1' USING DFHEIV0,
 10235           CLMS-FILE-ID,
 10236           CLAIM-MASTER,
 10237           DFHEIV11,
 10238           MSTR-KEY,
 10239           DFHEIV99,
 10240           DFHEIV99
 10241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10242
 10243
 10244 2030-EXIT.
 10245     EXIT.
 10246
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 191
* EL131.cbl
 10248 2040-NORMAL-UPDATE.
 10249
 10250* EXEC CICS READ UPDATE
 10251*         DATASET  (CERT-FILE-ID)
 10252*         RIDFLD   (CERT-KEY)
 10253*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10254*    END-EXEC.
 10255*    MOVE '&"S        EU         (   #00009502' TO DFHEIV0
 10256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10257     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10258     MOVE X'2020233030303039353032' TO DFHEIV0(25:11)
 10259     CALL 'kxdfhei1' USING DFHEIV0,
 10260           CERT-FILE-ID,
 10261           DFHEIV20,
 10262           DFHEIV99,
 10263           CERT-KEY,
 10264           DFHEIV99,
 10265           DFHEIV99,
 10266           DFHEIV99
 10267     SET ADDRESS OF CERTIFICATE-MASTER TO
 10268         DFHEIV20
 10269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10270
 10271
 10272     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10273
 10274
 10275* EXEC CICS HANDLE CONDITION
 10276*         DUPKEY   (2040-EXIT)
 10277*    END-EXEC.
 10278*    MOVE '"$$                   ! - #00009510' TO DFHEIV0
 10279     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10281     MOVE X'2D20233030303039353130' TO DFHEIV0(25:11)
 10282     CALL 'kxdfhei1' USING DFHEIV0
 10283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10284
 10285
 10286
 10287* EXEC CICS REWRITE
 10288*         DATASET  (CERT-FILE-ID)
 10289*         FROM     (CERTIFICATE-MASTER)
 10290*    END-EXEC.
 10291     MOVE LENGTH OF
 10292      CERTIFICATE-MASTER
 10293       TO DFHEIV11
 10294*    MOVE '&& L                  %   #00009514' TO DFHEIV0
 10295     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10296     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10297     MOVE X'2020233030303039353134' TO DFHEIV0(25:11)
 10298     CALL 'kxdfhei1' USING DFHEIV0,
 10299           CERT-FILE-ID,
 10300           CERTIFICATE-MASTER,
 10301           DFHEIV11,
 10302           DFHEIV99
 10303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10304
 10305
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 192
* EL131.cbl
 10306 2040-EXIT.
 10307     EXIT.
 10308
 10309 2050-KEY-UPDATE.
 10310
 10311* EXEC CICS READ UPDATE
 10312*         DATASET  (CERT-FILE-ID)
 10313*         RIDFLD   (CERT-KEY)
 10314*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10315*    END-EXEC.
 10316*    MOVE '&"S        EU         (   #00009523' TO DFHEIV0
 10317     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10318     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10319     MOVE X'2020233030303039353233' TO DFHEIV0(25:11)
 10320     CALL 'kxdfhei1' USING DFHEIV0,
 10321           CERT-FILE-ID,
 10322           DFHEIV20,
 10323           DFHEIV99,
 10324           CERT-KEY,
 10325           DFHEIV99,
 10326           DFHEIV99,
 10327           DFHEIV99
 10328     SET ADDRESS OF CERTIFICATE-MASTER TO
 10329         DFHEIV20
 10330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10331
 10332
 10333     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10334
 10335
 10336* EXEC CICS DELETE
 10337*         DATASET   (CERT-FILE-ID)
 10338*    END-EXEC.
 10339*    MOVE '&(                    &   #00009531' TO DFHEIV0
 10340     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10341     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10342     MOVE X'2020233030303039353331' TO DFHEIV0(25:11)
 10343     CALL 'kxdfhei1' USING DFHEIV0,
 10344           CERT-FILE-ID,
 10345           DFHEIV99,
 10346           DFHEIV99,
 10347           DFHEIV99,
 10348           DFHEIV99
 10349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10350
 10351
 10352
 10353* EXEC CICS GETMAIN
 10354*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10355*         LENGTH    (CERT-LENGTH)
 10356*         INITIMG   (GETMAIN-SPACE)
 10357*    END-EXEC.
 10358*    MOVE ',"IL                  $   #00009535' TO DFHEIV0
 10359     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10360     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10361     MOVE X'2020233030303039353335' TO DFHEIV0(25:11)
 10362     CALL 'kxdfhei1' USING DFHEIV0,
 10363           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 193
* EL131.cbl
 10364           CERT-LENGTH,
 10365           GETMAIN-SPACE
 10366     SET ADDRESS OF CERTIFICATE-MASTER TO
 10367         DFHEIV20
 10368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10369
 10370
 10371     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10372
 10373     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10374
 10375
 10376* EXEC CICS HANDLE CONDITION
 10377*         DUPKEY (2050-EXIT)
 10378*    END-EXEC.
 10379*    MOVE '"$$                   ! . #00009545' TO DFHEIV0
 10380     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10382     MOVE X'2E20233030303039353435' TO DFHEIV0(25:11)
 10383     CALL 'kxdfhei1' USING DFHEIV0
 10384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10385
 10386
 10387
 10388* EXEC CICS WRITE
 10389*         DATASET  (CERT-FILE-ID)
 10390*         RIDFLD   (CERT-KEY)
 10391*         FROM     (CERTIFICATE-MASTER)
 10392*    END-EXEC.
 10393     MOVE LENGTH OF
 10394      CERTIFICATE-MASTER
 10395       TO DFHEIV11
 10396*    MOVE '&$ L                  ''   #00009549' TO DFHEIV0
 10397     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10398     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10399     MOVE X'2020233030303039353439' TO DFHEIV0(25:11)
 10400     CALL 'kxdfhei1' USING DFHEIV0,
 10401           CERT-FILE-ID,
 10402           CERTIFICATE-MASTER,
 10403           DFHEIV11,
 10404           CERT-KEY,
 10405           DFHEIV99,
 10406           DFHEIV99
 10407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10408
 10409
 10410 2050-EXIT.
 10411     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 194
* EL131.cbl
 10413 2060-CHANGE-CERT.
 10414     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10415     MOVE PI-CARRIER             TO CERT-CARRIER.
 10416     MOVE PI-GROUPING            TO CERT-GROUP.
 10417     MOVE PI-STATE               TO CERT-STATE.
 10418     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10419     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10420     MOVE PI-CERT-NO             TO CERT-CERT.
 10421     IF CERTEFFI GREATER THAN LOW-VALUES
 10422         MOVE HOLD-EFF           TO CERT-DATE.
 10423     IF CERTACTI GREATER THAN LOW-VALUES
 10424         MOVE CERTACTI           TO CERT-ACCOUNT.
 10425     IF CERTSTI GREATER THAN LOW-VALUES
 10426         MOVE CERTSTI            TO CERT-STATE.
 10427     IF CERTCARI GREATER THAN LOW-VALUES
 10428         MOVE CERTCARI           TO CERT-CARRIER.
 10429     IF CERTGRPI GREATER THAN LOW-VALUES
 10430         MOVE CERTGRPI           TO CERT-GROUP.
 10431     IF CERTI GREATER THAN LOW-VALUES
 10432         MOVE CERTI              TO CERT-CERT-PRIME.
 10433     IF SUFXI GREATER THAN LOW-VALUES
 10434         MOVE SUFXI              TO CERT-CERT-SUFX.
 10435
 10436
 10437* EXEC CICS HANDLE CONDITION
 10438*         NOTFND   (2060-CERT-NOTFND)
 10439*    END-EXEC.
 10440*    MOVE '"$I                   ! / #00009581' TO DFHEIV0
 10441     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10443     MOVE X'2F20233030303039353831' TO DFHEIV0(25:11)
 10444     CALL 'kxdfhei1' USING DFHEIV0
 10445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10446
 10447
 10448
 10449* EXEC CICS READ UPDATE
 10450*         DATASET  (CERT-FILE-ID)
 10451*         RIDFLD   (CERT-KEY)
 10452*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10453*    END-EXEC.
 10454*    MOVE '&"S        EU         (   #00009585' TO DFHEIV0
 10455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10456     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10457     MOVE X'2020233030303039353835' TO DFHEIV0(25:11)
 10458     CALL 'kxdfhei1' USING DFHEIV0,
 10459           CERT-FILE-ID,
 10460           DFHEIV20,
 10461           DFHEIV99,
 10462           CERT-KEY,
 10463           DFHEIV99,
 10464           DFHEIV99,
 10465           DFHEIV99
 10466     SET ADDRESS OF CERTIFICATE-MASTER TO
 10467         DFHEIV20
 10468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10469
 10470
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 195
* EL131.cbl
 10471     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10472
 10473     IF CM-CLAIM-INTERFACE-SW = SPACES
 10474        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10475
 10476
 10477* EXEC CICS HANDLE CONDITION
 10478*         DUPKEY   (2060-DUPKEY)
 10479*    END-EXEC.
 10480*    MOVE '"$$                   ! 0 #00009596' TO DFHEIV0
 10481     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10482     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10483     MOVE X'3020233030303039353936' TO DFHEIV0(25:11)
 10484     CALL 'kxdfhei1' USING DFHEIV0
 10485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10486
 10487
 10488
 10489* EXEC CICS REWRITE
 10490*         DATASET  (CERT-FILE-ID)
 10491*         FROM     (CERTIFICATE-MASTER)
 10492*    END-EXEC.
 10493     MOVE LENGTH OF
 10494      CERTIFICATE-MASTER
 10495       TO DFHEIV11
 10496*    MOVE '&& L                  %   #00009600' TO DFHEIV0
 10497     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10498     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10499     MOVE X'2020233030303039363030' TO DFHEIV0(25:11)
 10500     CALL 'kxdfhei1' USING DFHEIV0,
 10501           CERT-FILE-ID,
 10502           CERTIFICATE-MASTER,
 10503           DFHEIV11,
 10504           DFHEIV99
 10505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10506
 10507
 10508 2060-DUPKEY.
 10509
 10510     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10511
 10512 2060-CHANGE-TRLR-ACTQ.
 10513     IF SCREEN-ERROR
 10514         GO TO 2060-EXIT.
 10515
 10516     IF CERTI    GREATER LOW-VALUES OR
 10517        SUFXI    GREATER LOW-VALUES OR
 10518        CERTCARI GREATER LOW-VALUES
 10519         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10520         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10521
 10522     MOVE SPACES                 TO CERT-KEY-SWITCH
 10523                                    CERT-SWITCH
 10524                                    TRLR-SWITCH
 10525                                    NINETY-TRLR-SWITCH.
 10526     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10527     GO TO 2060-EXIT.
 10528
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 196
* EL131.cbl
 10529 2060-CERT-NOTFND.
 10530     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10531
 10532     IF WS-REC-FOUND-SW = 'N'
 10533         MOVE ER-0206            TO  EMI-ERROR
 10534         MOVE -1                 TO  MAINTL
 10535         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10536
 10537* EXEC CICS UNLOCK
 10538*            DATASET   (CLMS-FILE-ID)
 10539*        END-EXEC
 10540*    MOVE '&*                    #   #00009633' TO DFHEIV0
 10541     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10542     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10543     MOVE X'2020233030303039363333' TO DFHEIV0(25:11)
 10544     CALL 'kxdfhei1' USING DFHEIV0,
 10545           CLMS-FILE-ID,
 10546           DFHEIV99
 10547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10548         GO TO 8110-SEND-DATA.
 10549
 10550     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10551
 10552     GO TO 2060-CHANGE-TRLR-ACTQ.
 10553
 10554 2060-EXIT.
 10555     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 197
* EL131.cbl
 10557 2070-CHECK-OLD.
 10558
 10559
 10560* EXEC CICS HANDLE CONDITION
 10561*        NOTFND   (2070-NOT-FOUND)
 10562*    END-EXEC.
 10563*    MOVE '"$I                   ! 1 #00009647' TO DFHEIV0
 10564     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10566     MOVE X'3120233030303039363437' TO DFHEIV0(25:11)
 10567     CALL 'kxdfhei1' USING DFHEIV0
 10568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10569
 10570
 10571     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10572     MOVE PI-CARRIER             TO CERT-CARRIER.
 10573     MOVE PI-GROUPING            TO CERT-GROUP.
 10574     MOVE PI-STATE               TO CERT-STATE.
 10575     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10576     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10577     MOVE PI-CERT-NO             TO CERT-CERT.
 10578
 10579
 10580* EXEC CICS READ UPDATE
 10581*         DATASET  (CERT-FILE-ID)
 10582*         RIDFLD   (CERT-KEY)
 10583*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10584*    END-EXEC.
 10585*    MOVE '&"S        EU         (   #00009659' TO DFHEIV0
 10586     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10587     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10588     MOVE X'2020233030303039363539' TO DFHEIV0(25:11)
 10589     CALL 'kxdfhei1' USING DFHEIV0,
 10590           CERT-FILE-ID,
 10591           DFHEIV20,
 10592           DFHEIV99,
 10593           CERT-KEY,
 10594           DFHEIV99,
 10595           DFHEIV99,
 10596           DFHEIV99
 10597     SET ADDRESS OF CERTIFICATE-MASTER TO
 10598         DFHEIV20
 10599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10600
 10601
 10602     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10603     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10604     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10605
 10606     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10607         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10608
 10609     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10610       AND
 10611        CERT-WAS-CREATED-FOR-CLAIM
 10612         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10613
 10614* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 198
* EL131.cbl
 10615*             DATASET   (CERT-FILE-ID)
 10616*        END-EXEC
 10617*    MOVE '&(                    &   #00009676' TO DFHEIV0
 10618     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10619     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10620     MOVE X'2020233030303039363736' TO DFHEIV0(25:11)
 10621     CALL 'kxdfhei1' USING DFHEIV0,
 10622           CERT-FILE-ID,
 10623           DFHEIV99,
 10624           DFHEIV99,
 10625           DFHEIV99,
 10626           DFHEIV99
 10627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10628         GO TO 2070-EXIT.
 10629
 10630     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10631         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10632
 10633
 10634* EXEC CICS HANDLE CONDITION
 10635*         DUPKEY   (2070-EXIT)
 10636*    END-EXEC.
 10637*    MOVE '"$$                   ! 2 #00009684' TO DFHEIV0
 10638     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10640     MOVE X'3220233030303039363834' TO DFHEIV0(25:11)
 10641     CALL 'kxdfhei1' USING DFHEIV0
 10642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10643
 10644
 10645
 10646* EXEC CICS REWRITE
 10647*         DATASET  (CERT-FILE-ID)
 10648*         FROM     (CERTIFICATE-MASTER)
 10649*    END-EXEC.
 10650     MOVE LENGTH OF
 10651      CERTIFICATE-MASTER
 10652       TO DFHEIV11
 10653*    MOVE '&& L                  %   #00009688' TO DFHEIV0
 10654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10656     MOVE X'2020233030303039363838' TO DFHEIV0(25:11)
 10657     CALL 'kxdfhei1' USING DFHEIV0,
 10658           CERT-FILE-ID,
 10659           CERTIFICATE-MASTER,
 10660           DFHEIV11,
 10661           DFHEIV99
 10662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10663
 10664
 10665     GO TO 2070-EXIT.
 10666
 10667 2070-NOT-FOUND.
 10668     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10669
 10670 2070-EXIT.
 10671     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 199
* EL131.cbl
 10673 2080-CREATE-CERT.
 10674
 10675* EXEC CICS GETMAIN
 10676*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10677*         LENGTH    (CERT-LENGTH)
 10678*         INITIMG   (GETMAIN-SPACE)
 10679*    END-EXEC.
 10680*    MOVE ',"IL                  $   #00009702' TO DFHEIV0
 10681     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10682     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10683     MOVE X'2020233030303039373032' TO DFHEIV0(25:11)
 10684     CALL 'kxdfhei1' USING DFHEIV0,
 10685           DFHEIV20,
 10686           CERT-LENGTH,
 10687           GETMAIN-SPACE
 10688     SET ADDRESS OF CERTIFICATE-MASTER TO
 10689         DFHEIV20
 10690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10691
 10692
 10693     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10694
 10695     IF CERTEFFI GREATER THAN LOW-VALUES
 10696         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10697                                    DC-BIN-DATE-1
 10698         MOVE '6'                TO DC-OPTION-CODE
 10699         MOVE +1                 TO DC-ELAPSED-MONTHS
 10700         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10701         IF NO-CONVERSION-ERROR
 10702             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10703
 10704     IF CERTACTI GREATER THAN LOW-VALUES
 10705         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10706     IF CERTSTI GREATER THAN LOW-VALUES
 10707         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10708     IF CERTCARI GREATER THAN LOW-VALUES
 10709         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10710     IF CERTGRPI GREATER THAN LOW-VALUES
 10711         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10712     IF CERTI GREATER THAN LOW-VALUES
 10713         MOVE CERTI              TO CERT-CERT-PRIME
 10714                                    CM-CERT-PRIME
 10715         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10716
 10717     IF SUFXI GREATER THAN LOW-VALUES
 10718         MOVE SUFXI              TO CERT-CERT-SUFX
 10719                                    CM-CERT-SFX
 10720         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10721
 10722     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10723
 10724     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10725
 10726     MOVE SPACES                 TO CM-ENTRY-BATCH
 10727                                    CM-LF-EXIT-BATCH
 10728                                    CM-AH-EXIT-BATCH
 10729                                    CM-CREDIT-INTERFACE-SW-1
 10730                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 200
* EL131.cbl
 10731
 10732     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10733                               '9' OR 'D' OR 'V'
 10734         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10735
 10736     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10737                               '9' OR 'D' OR 'V'
 10738         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10739
 10740     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10741                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10742     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10743
 10744
 10745* EXEC CICS HANDLE CONDITION
 10746*         DUPKEY (2080-EXIT)
 10747*    END-EXEC.
 10748*    MOVE '"$$                   ! 3 #00009759' TO DFHEIV0
 10749     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10751     MOVE X'3320233030303039373539' TO DFHEIV0(25:11)
 10752     CALL 'kxdfhei1' USING DFHEIV0
 10753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10754
 10755
 10756
 10757* EXEC CICS WRITE
 10758*         DATASET  (CERT-FILE-ID)
 10759*         RIDFLD   (CERT-KEY)
 10760*         FROM     (CERTIFICATE-MASTER)
 10761*    END-EXEC.
 10762     MOVE LENGTH OF
 10763      CERTIFICATE-MASTER
 10764       TO DFHEIV11
 10765*    MOVE '&$ L                  ''   #00009763' TO DFHEIV0
 10766     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10767     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10768     MOVE X'2020233030303039373633' TO DFHEIV0(25:11)
 10769     CALL 'kxdfhei1' USING DFHEIV0,
 10770           CERT-FILE-ID,
 10771           CERTIFICATE-MASTER,
 10772           DFHEIV11,
 10773           CERT-KEY,
 10774           DFHEIV99,
 10775           DFHEIV99
 10776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10777
 10778
 10779 2080-EXIT.
 10780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 201
* EL131.cbl
 10782 2100-MOVE-MSTR.
 10783     IF TYPEI GREATER THAN LOW-VALUES
 10784         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10785
 10786     IF STATUSI = LOW-VALUES
 10787         GO TO 2100-NO-STATUS-CHANGE.
 10788
 10789     IF STATUSI = 'OPEN' OR 'O'
 10790         IF CL-CLAIM-STATUS = 'O'
 10791             MOVE SPACES         TO TRLR-SWITCH
 10792                 GO TO 2100-NO-STATUS-CHANGE.
 10793
 10794     IF STATUSI = 'CLOSED' OR 'C'
 10795         IF CL-CLAIM-STATUS = 'C'
 10796             MOVE SPACES         TO TRLR-SWITCH
 10797                 GO TO 2100-NO-STATUS-CHANGE.
 10798
 10799     IF PI-COMPANY-ID = 'DMD'
 10800        IF STATUSI = 'OPEN' OR 'O'
 10801           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10802              MOVE ZERO       TO STATUSL
 10803              MOVE LOW-VALUES TO STATUSI
 10804              GO TO 2100-NO-STATUS-CHANGE.
 10805
 10806     IF PI-COMPANY-ID = 'DMD'
 10807         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10808
 10809     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10810
 10811 2100-NO-STATUS-CHANGE.
 10812
 10813     IF CCNOI GREATER THAN LOW-VALUES
 10814         MOVE CCNOI              TO CL-CCN.
 10815
 10816     IF PROCI GREATER THAN LOW-VALUES
 10817         MOVE PROCI              TO CL-PROCESSOR-ID.
 10818
 10819     if accswi > low-values
 10820        and accswi = 'Y' OR 'N'
 10821        move accswi              to cl-accident-claim-sw
 10822     end-if
 10823     IF SEXI GREATER THAN LOW-VALUES
 10824         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10825
 10826     IF BIRTHI GREATER THAN LOW-VALUES
 10827         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10828
 10829     IF SOCIALI GREATER THAN LOW-VALUES
 10830       AND
 10831        SOCIALI = SPACES
 10832         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10833         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10834         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10835     ELSE
 10836         IF SOCIALI GREATER THAN LOW-VALUES
 10837             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10838
 10839     IF OCCI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 202
* EL131.cbl
 10840         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10841
 10842     IF BENEL GREATER THAN ZERO
 10843         MOVE BENEI              TO CL-BENEFICIARY.
 10844
 10845     IF DIAGI GREATER THAN LOW-VALUES
 10846         MOVE DIAGI              TO WS-DIAGNOSIS.
 10847
 10848     IF ICD1I GREATER THAN LOW-VALUES
 10849         MOVE ICD1I              TO WS-ICD-CODE-1
 10850     END-IF.
 10851
 10852     IF ICD2I GREATER THAN LOW-VALUES
 10853         MOVE ICD2I              TO WS-ICD-CODE-2
 10854     END-IF.
 10855
 10856     IF PREMTYPI GREATER THAN LOW-VALUES
 10857         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10858
 10859*    IF CAUSEI GREATER THAN LOW-VALUES
 10860*        MOVE CAUSEI             TO CL-CAUSE-CD.
 10861
 10862*    IF ENDI GREATER THAN LOW-VALUES
 10863*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10864
 10865     IF PDTHRUI GREATER THAN LOW-VALUES
 10866        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10867
 10868     IF PDAMTL GREATER THAN +0
 10869        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10870
 10871     IF NODAYSI GREATER THAN LOW-VALUES
 10872        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10873
 10874     IF NOPMTSI GREATER THAN LOW-VALUES
 10875        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10876
 10877     IF FORMTYPI GREATER THAN LOW-VALUES
 10878        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10879
 10880     IF INCI GREATER THAN LOW-VALUES
 10881        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10882
 10883     IF REPI GREATER THAN LOW-VALUES
 10884        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10885
 10886     IF ADDONDTI GREATER THAN LOW-VALUES
 10887        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10888
 10889     IF PRICDI GREATER THAN LOW-VALUES
 10890         MOVE PRICDI             TO CL-PRIORITY-CD.
 10891
 10892     IF CRITPTL > ZEROS
 10893        MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 10894     END-IF
 10895
 10896     IF RTWMOSL > ZEROS
 10897        MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 203
* EL131.cbl
 10898     END-IF
 10899     IF FILETOI GREATER THAN LOW-VALUES
 10900         MOVE FILETOI            TO CL-FILE-LOCATION.
 10901
 10902     IF SUPVI GREATER THAN LOW-VALUES
 10903         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10904
 10905     IF MLNAMEI GREATER THAN LOW-VALUES
 10906         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10907
 10908     IF MFNAMEI GREATER THAN LOW-VALUES
 10909         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10910
 10911     IF MMINITI GREATER THAN LOW-VALUES
 10912         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10913
 10914     IF CERTEFFI GREATER THAN LOW-VALUES
 10915         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10916
 10917     IF CERTACTI GREATER THAN LOW-VALUES
 10918         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10919
 10920     IF CERTSTI GREATER THAN LOW-VALUES
 10921         MOVE CERTSTI            TO CL-CERT-STATE.
 10922
 10923     IF CERTCARI GREATER THAN LOW-VALUES
 10924         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10925                                    CL-CARRIER.
 10926
 10927     IF CERTGRPI GREATER THAN LOW-VALUES
 10928         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10929
 10930     IF CERTI GREATER THAN LOW-VALUES
 10931         MOVE CERTI              TO CERT-NO-PRIME.
 10932
 10933     IF SUFXI GREATER THAN LOW-VALUES
 10934         MOVE SUFXI              TO CERT-NO-SUFX.
 10935
 10936     MOVE CERT-NO                TO CL-CERT-NO
 10937                                    CL-CERT-NO-A4.
 10938
 10939     IF PI-COMPANY-ID = 'FLA'
 10940          NEXT SENTENCE
 10941     ELSE
 10942         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10943         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10944         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10945         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10946
 10947     IF TRLR-UPDATE-REQUIRED
 10948        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10949        MOVE ZEROS              TO TRLR-SEQ-NO
 10950
 10951* EXEC CICS READ
 10952*            DATASET   (TRLR-FILE-ID)
 10953*            RIDFLD    (TRLR-KEY)
 10954*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10955*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 204
* EL131.cbl
 10956*    MOVE '&"S        E          (   #00009940' TO DFHEIV0
 10957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10959     MOVE X'2020233030303039393430' TO DFHEIV0(25:11)
 10960     CALL 'kxdfhei1' USING DFHEIV0,
 10961           TRLR-FILE-ID,
 10962           DFHEIV20,
 10963           DFHEIV99,
 10964           TRLR-KEY,
 10965           DFHEIV99,
 10966           DFHEIV99,
 10967           DFHEIV99
 10968     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10969         DFHEIV20
 10970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10971        IF AT-TRAILER-TYPE = '1'
 10972           MOVE +1 TO MISC-SUB
 10973           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10974           MISC-SUB GREATER THAN +6 OR
 10975           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10976           IF MISC-SUB GREATER THAN +1
 10977              SUBTRACT +1 FROM MISC-SUB
 10978              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10979                 GO TO 2100-BYPASS-LAST-UPDATE.
 10980
 10981     IF TRLR-UPDATE-REQUIRED AND
 10982        CLAIM-IS-OPEN
 10983         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10984     ELSE
 10985         IF TRLR-UPDATE-REQUIRED AND
 10986            CLAIM-IS-CLOSED
 10987             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10988             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10989
 10990 2100-BYPASS-LAST-UPDATE.
 10991     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10992     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10993
 10994     GO TO 2100-EXIT.
 10995
 10996 2100-BUMP-OPEN-CLOSE-HIST.
 10997     ADD +1                      TO MISC-SUB.
 10998
 10999 2100-EXIT.
 11000     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 205
* EL131.cbl
 11002 2120-check-pdef.
 11003
 11004
 11005     move +0                     to s1
 11006     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11007     move spaces                 to ws-dcc-error-line
 11008     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11009     IF ERPDEF-FOUND
 11010        perform 2130-check-trlr  thru 2130-exit
 11011        move +1                  to s1
 11012*       if cl-accident-claim-sw = ' '
 11013*          move er-1655             to ws-error-no (s1)
 11014*          add +1 to s1
 11015*       end-if
 11016        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11017        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11018        MOVE '1'                 TO DC-OPTION-CODE
 11019        MOVE +0                  TO DC-ELAPSED-MONTHS
 11020                                    DC-ELAPSED-DAYS
 11021        PERFORM 9800-CONVERT-DATE
 11022                                 THRU 9800-EXIT
 11023        IF NO-CONVERSION-ERROR
 11024           MOVE DC-ELAPSED-MONTHS
 11025                                 TO WS-MONTHS-BETWEEN
 11026           IF DC-ELAPSED-DAYS > 1
 11027              ADD 1 TO WS-MONTHS-BETWEEN
 11028           END-IF
 11029        ELSE
 11030           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11031        END-IF
 11032        IF (WS-EXCL-PERIOD = ZEROS)
 11033           OR (WS-MONTHS-BETWEEN = ZEROS)
 11034           CONTINUE
 11035        ELSE
 11036           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11037              MOVE ER-1651       TO ws-error-no (s1)
 11038              add +1             to s1
 11039           END-IF
 11040        END-IF
 11041        IF (WS-COV-ENDS = ZEROS)
 11042           OR (WS-MONTHS-BETWEEN = ZEROS)
 11043           CONTINUE
 11044        ELSE
 11045           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11046              MOVE -1            TO MAINTL
 11047              MOVE ER-1653       TO ws-error-no (s1)
 11048              add +1 to s1
 11049           END-IF
 11050        END-IF
 11051        IF (WS-ACC-PERIOD = ZEROS)
 11052           OR (WS-MONTHS-BETWEEN = ZEROS)
 11053           CONTINUE
 11054        ELSE
 11055           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
 11056              and (cl-accident-claim-sw = ' ')
 11057              move er-1655       to ws-error-no (s1)
 11058              add +1             to s1
 11059           end-if
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 206
* EL131.cbl
 11060           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11061              if cl-accident-claim-sw not = 'Y'
 11062                 MOVE ER-1652    TO ws-error-no (s1)
 11063              else
 11064                 move er-1662    to ws-error-no (s1)
 11065              end-if
 11066              MOVE -1            TO MAINTL
 11067              add +1             to s1
 11068           END-IF
 11069        END-IF
 11070        if cl-claim-type  = 'I'
 11071           move er-1661          to ws-error-no (s1)
 11072           add +1                to s1
 11073        end-if
 11074        perform 2130-check-trlr  thru 2130-exit
 11075     END-IF
 11076
 11077     .
 11078 2120-exit.
 11079     exit.
 11080
 11081 2130-check-trlr.
 11082
 11083     evaluate true
 11084        when s1 = +0
 11085           move cl-control-primary
 11086                                 to trlr-key
 11087           MOVE +95              TO TRLR-SEQ-NO
 11088
 11089* EXEC CICS READ
 11090*             update
 11091*             DATASET  ('ELTRLR')
 11092*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11093*             RIDFLD   (TRLR-KEY)
 11094*             RESP     (WS-RESPONSE)
 11095*          END-EXEC
 11096     MOVE 'ELTRLR' TO DFHEIV1
 11097*    MOVE '&"S        EU         (  N#00010062' TO DFHEIV0
 11098     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11099     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11100     MOVE X'204E233030303130303632' TO DFHEIV0(25:11)
 11101     CALL 'kxdfhei1' USING DFHEIV0,
 11102           DFHEIV1,
 11103           DFHEIV20,
 11104           DFHEIV99,
 11105           TRLR-KEY,
 11106           DFHEIV99,
 11107           DFHEIV99,
 11108           DFHEIV99
 11109     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11110         DFHEIV20
 11111     MOVE EIBRESP  TO WS-RESPONSE
 11112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11113           if ws-resp-normal
 11114              move spaces        to at-info-line-1
 11115           end-if
 11116        when s1 = +1
 11117           if ws-resp-normal
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 207
* EL131.cbl
 11118
 11119* exec cics rewrite
 11120*                dataset   ('ELTRLR')
 11121*                from      (activity-trailers)
 11122*             end-exec
 11123     MOVE LENGTH OF
 11124      activity-trailers
 11125       TO DFHEIV11
 11126     MOVE 'ELTRLR' TO DFHEIV1
 11127*    MOVE '&& L                  %   #00010074' TO DFHEIV0
 11128     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11129     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11130     MOVE X'2020233030303130303734' TO DFHEIV0(25:11)
 11131     CALL 'kxdfhei1' USING DFHEIV0,
 11132           DFHEIV1,
 11133           activity-trailers,
 11134           DFHEIV11,
 11135           DFHEIV99
 11136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11137           end-if
 11138        when s1 > +1
 11139           if ws-resp-normal
 11140              move ws-dcc-error-line
 11141                                 to at-info-line-1
 11142
 11143* exec cics rewrite
 11144*                dataset   ('ELTRLR')
 11145*                from      (activity-trailers)
 11146*             end-exec
 11147     MOVE LENGTH OF
 11148      activity-trailers
 11149       TO DFHEIV11
 11150     MOVE 'ELTRLR' TO DFHEIV1
 11151*    MOVE '&& L                  %   #00010083' TO DFHEIV0
 11152     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11153     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11154     MOVE X'2020233030303130303833' TO DFHEIV0(25:11)
 11155     CALL 'kxdfhei1' USING DFHEIV0,
 11156           DFHEIV1,
 11157           activity-trailers,
 11158           DFHEIV11,
 11159           DFHEIV99
 11160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11161           else
 11162
 11163* EXEC CICS GETMAIN
 11164*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11165*                LENGTH   (TRLR-LENGTH)
 11166*                INITIMG  (GETMAIN-SPACE)
 11167*             END-EXEC
 11168*    MOVE ',"IL                  $   #00010088' TO DFHEIV0
 11169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11171     MOVE X'2020233030303130303838' TO DFHEIV0(25:11)
 11172     CALL 'kxdfhei1' USING DFHEIV0,
 11173           DFHEIV20,
 11174           TRLR-LENGTH,
 11175           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 208
* EL131.cbl
 11176     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11177         DFHEIV20
 11178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11179              move 'AT'          to at-record-id
 11180              move cl-control-primary
 11181                                 to at-control-primary
 11182              move +95           to at-sequence-no
 11183              move '6'           to at-trailer-type
 11184              move ws-dcc-error-line
 11185                                 to at-info-line-1
 11186              move 'E'           to at-info-trailer-type
 11187              move save-bin-date to at-recorded-dt
 11188                                    at-gen-info-last-maint-dt
 11189              move pi-processor-id
 11190                                 to at-recorded-by
 11191                                    at-gen-info-last-updated-by
 11192              move eibtime       to at-last-maint-hhmmss
 11193
 11194* exec cics write
 11195*                dataset   ('ELTRLR')
 11196*                from      (activity-trailers)
 11197*                ridfld    (trlr-key)
 11198*             end-exec
 11199     MOVE LENGTH OF
 11200      activity-trailers
 11201       TO DFHEIV11
 11202     MOVE 'ELTRLR' TO DFHEIV1
 11203*    MOVE '&$ L                  ''   #00010107' TO DFHEIV0
 11204     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11205     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11206     MOVE X'2020233030303130313037' TO DFHEIV0(25:11)
 11207     CALL 'kxdfhei1' USING DFHEIV0,
 11208           DFHEIV1,
 11209           activity-trailers,
 11210           DFHEIV11,
 11211           trlr-key,
 11212           DFHEIV99,
 11213           DFHEIV99
 11214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11215              perform varying s1 from +1 by +1 until
 11216                 ws-error-no (s1) = spaces
 11217                 move ws-error-no (s1)
 11218                                 to emi-error
 11219                 PERFORM 9900-ERROR-FORMAT
 11220                                 THRU 9900-EXIT
 11221              end-perform
 11222           end-if
 11223     end-evaluate
 11224
 11225     .
 11226 2130-exit.
 11227     exit.
 11228 2200-MOVE-CERT.
 11229     IF CRTLNMEI GREATER THAN LOW-VALUES
 11230         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11231
 11232     IF CRTFNMEI GREATER THAN LOW-VALUES
 11233         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 209
* EL131.cbl
 11234         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11235
 11236     IF CRTINITI GREATER THAN LOW-VALUES
 11237         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11238
 11239     IF CM-INSURED-INITIALS = SPACES
 11240         MOVE '**'               TO CM-INSURED-INITIALS.
 11241
 11242     IF ISSAGEI GREATER THAN LOW-VALUES
 11243         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11244
 11245     IF JNTFNMEI GREATER THAN LOW-VALUES
 11246         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11247
 11248     IF JNTLNMEI GREATER THAN LOW-VALUES
 11249         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11250
 11251     IF JNTINITI GREATER THAN LOW-VALUES
 11252         MOVE JNTINITI           TO CM-JT-INITIAL.
 11253
 11254     IF JNTAGEI GREATER THAN LOW-VALUES
 11255         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11256
 11257     IF ADDONDTI GREATER THAN LOW-VALUES
 11258        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11259
 11260     IF LCVCDI GREATER THAN LOW-VALUES
 11261        IF LCVCDI = SPACES OR ZEROS
 11262           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11263        ELSE
 11264           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11265
 11266     IF LCVOTRMI GREATER THAN LOW-VALUES
 11267         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11268
 11269     IF LCVRATEL GREATER THAN +0
 11270         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11271
 11272     IF LCVBENEL GREATER THAN +0
 11273         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11274
 11275     IF LCVFORMI GREATER THAN LOW-VALUES
 11276         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11277
 11278     IF LCVCNDTI = LOW-VALUES
 11279        GO TO 2210-SET-STATUS.
 11280
 11281     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11282        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11283        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11284        GO TO 2210-SET-STATUS.
 11285
 11286     IF CM-LF-CURRENT-STATUS = '7'
 11287        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11288        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11289        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11290                                    CM-LF-DEATH-DT
 11291        GO TO 2210-SET-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 210
* EL131.cbl
 11292
 11293     IF CM-LF-CURRENT-STATUS = '8'
 11294        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11295        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11296                                    CM-LF-CANCEL-DT.
 11297
 11298 2210-SET-STATUS.
 11299
 11300     IF CM-LF-CURRENT-STATUS = SPACES
 11301         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11302
 11303     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11304         MOVE '6'                TO DC-OPTION-CODE
 11305         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11306         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11307         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11308         IF NO-CONVERSION-ERROR
 11309             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11310         ELSE
 11311             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11312     ELSE
 11313         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11314
 11315 2215-PROCESS-AH-SIDE.
 11316
 11317     IF ACVCDI GREATER THAN LOW-VALUES
 11318        IF ACVCDI = SPACES OR ZEROS
 11319           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11320        ELSE
 11321           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11322
 11323     IF ACVOTRMI GREATER THAN LOW-VALUES
 11324         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11325
 11326     IF ACVRATEL GREATER THAN +0
 11327         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11328
 11329     IF ACVBENEL GREATER THAN +0
 11330         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 11331                                    PI-PAYMENT-AMT.
 11332
 11333     IF ACVFORMI GREATER THAN LOW-VALUES
 11334         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11335
 11336     IF ACVCNDTI = LOW-VALUES
 11337        GO TO 2220-SET-STATUS.
 11338
 11339     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11340        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11341        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11342        GO TO 2220-SET-STATUS.
 11343
 11344     IF CM-AH-CURRENT-STATUS = '6'
 11345        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11346                                 TO CM-AH-CURRENT-STATUS
 11347        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11348        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11349                                    CM-AH-SETTLEMENT-DT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 211
* EL131.cbl
 11350        GO TO 2220-SET-STATUS.
 11351
 11352     IF CM-AH-CURRENT-STATUS = '8'
 11353        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11354        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11355                                    CM-AH-CANCEL-DT.
 11356
 11357 2220-SET-STATUS.
 11358     IF CM-AH-CURRENT-STATUS = SPACES
 11359         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11360
 11361     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11362         MOVE '6'                TO DC-OPTION-CODE
 11363         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11364         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11365         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11366         IF NO-CONVERSION-ERROR
 11367             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11368         ELSE
 11369             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11370     ELSE
 11371         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11372
 11373 2225-FINISH-CERT.
 11374     IF APRL GREATER THAN +0
 11375         MOVE HOLD-APR           TO CM-LOAN-APR.
 11376
 11377     IF PMTFREQI GREATER THAN LOW-VALUES
 11378         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11379
 11380     IF INDGRPI GREATER THAN LOW-VALUES
 11381         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11382
 11383     IF LOANNOI GREATER THAN LOW-VALUES
 11384        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11385
 11386     IF LOANBALL GREATER THAN +0
 11387        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11388
 11389     IF PREMTYPI GREATER THAN LOW-VALUES
 11390         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11391
 11392     IF REINCDI GREATER THAN LOW-VALUES
 11393         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11394                                    WS-REIN-1
 11395                                    WS-REIN-2
 11396                                    WS-REIN-3
 11397         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11398
 11399     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11400
 11401     MOVE ZEROS                  TO CM-LOAN-TERM
 11402                                    CM-LIFE-COMM-PCT
 11403                                    CM-AH-COMM-PCT.
 11404
 11405*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11406*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11407*         PI-NO-PMTS = ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 212
* EL131.cbl
 11408*          IF LOANBALL GREATER THAN +0          OR
 11409*             ACVBENEL GREATER THAN +0          OR
 11410*             APRL     GREATER THAN +0          OR
 11411*             LCVRATEL GREATER THAN +0          OR
 11412*             ACVRATEL GREATER THAN +0
 11413*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11414
 11415 2200-EXIT.
 11416     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 213
* EL131.cbl
 11418 2300-UPDATE-TRLR.
 11419     MOVE ZERO                   TO TRLR-SEQ-NO.
 11420
 11421* EXEC CICS READ UPDATE
 11422*         DATASET  (TRLR-FILE-ID)
 11423*         RIDFLD   (TRLR-KEY)
 11424*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11425*    END-EXEC.
 11426*    MOVE '&"S        EU         (   #00010317' TO DFHEIV0
 11427     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11428     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11429     MOVE X'2020233030303130333137' TO DFHEIV0(25:11)
 11430     CALL 'kxdfhei1' USING DFHEIV0,
 11431           TRLR-FILE-ID,
 11432           DFHEIV20,
 11433           DFHEIV99,
 11434           TRLR-KEY,
 11435           DFHEIV99,
 11436           DFHEIV99,
 11437           DFHEIV99
 11438     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11439         DFHEIV20
 11440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11441
 11442
 11443     MOVE ZERO                   TO COUNT-2.
 11444
 11445     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11446         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11447
 11448     IF NOT UPDATE-MADE
 11449         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11450
 11451
 11452* EXEC CICS REWRITE
 11453*         DATASET  (TRLR-FILE-ID)
 11454*         FROM     (ACTIVITY-TRAILERS)
 11455*    END-EXEC.
 11456     MOVE LENGTH OF
 11457      ACTIVITY-TRAILERS
 11458       TO DFHEIV11
 11459*    MOVE '&& L                  %   #00010331' TO DFHEIV0
 11460     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11461     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11462     MOVE X'2020233030303130333331' TO DFHEIV0(25:11)
 11463     CALL 'kxdfhei1' USING DFHEIV0,
 11464           TRLR-FILE-ID,
 11465           ACTIVITY-TRAILERS,
 11466           DFHEIV11,
 11467           DFHEIV99
 11468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11469
 11470
 11471 2300-EXIT.
 11472     EXIT.
 11473
 11474 2310-INS-STATUS.
 11475     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 214
* EL131.cbl
 11476     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11477         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11478         MOVE 'Y'                TO TRLR-SWITCH.
 11479
 11480 2310-EXIT.
 11481     EXIT.
 11482
 11483 2320-SHIFT-STATUS.
 11484     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11485        MOVE 6                   TO COUNT-2
 11486        GO TO 2320-EXIT.
 11487
 11488     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11489     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11490     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11491     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11492     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11493     MOVE 6       TO COUNT-2.
 11494     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11495
 11496 2320-EXIT.
 11497     EXIT.
 11498
 11499 2330-ADD-UPDATE.
 11500
 11501     IF COUNT-2 GREATER THAN 1
 11502        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11503        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11504           GO TO 2330-EXIT.
 11505
 11506     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11507                                   AT-RESERVES-LAST-MAINT-DT
 11508
 11509     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11510     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11511     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11512     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11513
 11514 2330-EXIT.
 11515     EXIT.
 11516
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 215
* EL131.cbl
 11518 2400-UPDATE-TRLR.
 11519
 11520* EXEC CICS HANDLE CONDITION
 11521*         NOTFND    (2400-TRLR-NOTFND)
 11522*         ENDFILE   (2410-EXIT)
 11523*    END-EXEC.
 11524*    MOVE '"$I''                  ! 4 #00010384' TO DFHEIV0
 11525     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11527     MOVE X'3420233030303130333834' TO DFHEIV0(25:11)
 11528     CALL 'kxdfhei1' USING DFHEIV0
 11529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11530
 11531
 11532
 11533* EXEC CICS STARTBR
 11534*        DATASET (TRLR-FILE-ID)
 11535*        RIDFLD  (TRLR-KEY)
 11536*    END-EXEC.
 11537     MOVE 0
 11538       TO DFHEIV11
 11539*    MOVE '&,         G          &   #00010389' TO DFHEIV0
 11540     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11542     MOVE X'2020233030303130333839' TO DFHEIV0(25:11)
 11543     CALL 'kxdfhei1' USING DFHEIV0,
 11544           TRLR-FILE-ID,
 11545           TRLR-KEY,
 11546           DFHEIV99,
 11547           DFHEIV11,
 11548           DFHEIV99
 11549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11550
 11551
 11552
 11553* EXEC CICS GETMAIN
 11554*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11555*         LENGTH    (TRLR-LENGTH)
 11556*         INITIMG   (GETMAIN-SPACE)
 11557*    END-EXEC.
 11558*    MOVE ',"IL                  $   #00010394' TO DFHEIV0
 11559     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11560     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11561     MOVE X'2020233030303130333934' TO DFHEIV0(25:11)
 11562     CALL 'kxdfhei1' USING DFHEIV0,
 11563           DFHEIV20,
 11564           TRLR-LENGTH,
 11565           GETMAIN-SPACE
 11566     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11567         DFHEIV20
 11568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11569
 11570
 11571     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 11572
 11573
 11574* EXEC CICS ENDBR
 11575*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 216
* EL131.cbl
 11576*    END-EXEC.
 11577     MOVE 0
 11578       TO DFHEIV11
 11579*    MOVE '&2                    $   #00010402' TO DFHEIV0
 11580     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11581     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11582     MOVE X'2020233030303130343032' TO DFHEIV0(25:11)
 11583     CALL 'kxdfhei1' USING DFHEIV0,
 11584           TRLR-FILE-ID,
 11585           DFHEIV11,
 11586           DFHEIV99
 11587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11588
 11589
 11590     GO TO 2400-EXIT.
 11591
 11592 2400-TRLR-NOTFND.
 11593     MOVE ER-0205                TO EMI-ERROR.
 11594     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11595     MOVE 'X'                    TO ERROR-SWITCH.
 11596
 11597 2400-EXIT.
 11598     EXIT.
 11599
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 217
* EL131.cbl
 11601 2410-CHANGE-TRLR.
 11602
 11603* EXEC CICS READNEXT
 11604*        DATASET (TRLR-FILE-ID)
 11605*        RIDFLD  (TRLR-KEY)
 11606*        INTO    (ACTIVITY-TRAILERS)
 11607*    END-EXEC.
 11608     MOVE LENGTH OF
 11609      ACTIVITY-TRAILERS
 11610       TO DFHEIV12
 11611     MOVE 0
 11612       TO DFHEIV11
 11613*    MOVE '&.IL                  )   #00010418' TO DFHEIV0
 11614     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11615     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11616     MOVE X'2020233030303130343138' TO DFHEIV0(25:11)
 11617     CALL 'kxdfhei1' USING DFHEIV0,
 11618           TRLR-FILE-ID,
 11619           ACTIVITY-TRAILERS,
 11620           DFHEIV12,
 11621           TRLR-KEY,
 11622           DFHEIV99,
 11623           DFHEIV11,
 11624           DFHEIV99,
 11625           DFHEIV99
 11626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11627
 11628
 11629     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 11630        GO TO 2410-CHANGE-TRLR.
 11631
 11632     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 11633                                    CHECK-KEY.
 11634
 11635     IF CHECK-KEY NOT = MSTR-KEY
 11636         GO TO 2410-EXIT.
 11637
 11638
 11639* EXEC CICS ENDBR
 11640*        DATASET (TRLR-FILE-ID)
 11641*    END-EXEC.
 11642     MOVE 0
 11643       TO DFHEIV11
 11644*    MOVE '&2                    $   #00010433' TO DFHEIV0
 11645     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11646     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11647     MOVE X'2020233030303130343333' TO DFHEIV0(25:11)
 11648     CALL 'kxdfhei1' USING DFHEIV0,
 11649           TRLR-FILE-ID,
 11650           DFHEIV11,
 11651           DFHEIV99
 11652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11653
 11654
 11655
 11656* EXEC CICS READ UPDATE
 11657*        DATASET (TRLR-FILE-ID)
 11658*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 218
* EL131.cbl
 11659*        INTO    (ACTIVITY-TRAILERS)
 11660*    END-EXEC.
 11661     MOVE LENGTH OF
 11662      ACTIVITY-TRAILERS
 11663       TO DFHEIV11
 11664*    MOVE '&"IL       EU         (   #00010437' TO DFHEIV0
 11665     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11666     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11667     MOVE X'2020233030303130343337' TO DFHEIV0(25:11)
 11668     CALL 'kxdfhei1' USING DFHEIV0,
 11669           TRLR-FILE-ID,
 11670           ACTIVITY-TRAILERS,
 11671           DFHEIV11,
 11672           TRLR-KEY,
 11673           DFHEIV99,
 11674           DFHEIV99,
 11675           DFHEIV99
 11676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11677
 11678
 11679
 11680* EXEC CICS DELETE
 11681*        DATASET (TRLR-FILE-ID)
 11682*    END-EXEC.
 11683*    MOVE '&(                    &   #00010443' TO DFHEIV0
 11684     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11685     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11686     MOVE X'2020233030303130343433' TO DFHEIV0(25:11)
 11687     CALL 'kxdfhei1' USING DFHEIV0,
 11688           TRLR-FILE-ID,
 11689           DFHEIV99,
 11690           DFHEIV99,
 11691           DFHEIV99,
 11692           DFHEIV99
 11693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11694
 11695
 11696     IF AT-SEQUENCE-NO = ZERO AND
 11697        TRLR-UPDATE-REQUIRED
 11698         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 11699
 11700     IF CERTI GREATER THAN LOW-VALUES
 11701        MOVE CERTI               TO AT-CERT-PRIME.
 11702
 11703     IF SUFXI GREATER THAN LOW-VALUES
 11704        MOVE SUFXI               TO AT-CERT-SFX.
 11705
 11706     IF CERTCARI GREATER THAN LOW-VALUES
 11707        MOVE CERTCARI            TO AT-CARRIER.
 11708
 11709     IF PAYMENT-TR
 11710        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 11711           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 11712              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 11713
 11714     IF CORRESPONDENCE-TR
 11715        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11716           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 219
* EL131.cbl
 11717
 11718
 11719* EXEC CICS WRITE
 11720*         DATASET  (TRLR-FILE-ID)
 11721*         RIDFLD   (AT-CONTROL-PRIMARY)
 11722*         FROM     (ACTIVITY-TRAILERS)
 11723*    END-EXEC.
 11724     MOVE LENGTH OF
 11725      ACTIVITY-TRAILERS
 11726       TO DFHEIV11
 11727*    MOVE '&$ L                  ''   #00010469' TO DFHEIV0
 11728     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11729     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11730     MOVE X'2020233030303130343639' TO DFHEIV0(25:11)
 11731     CALL 'kxdfhei1' USING DFHEIV0,
 11732           TRLR-FILE-ID,
 11733           ACTIVITY-TRAILERS,
 11734           DFHEIV11,
 11735           AT-CONTROL-PRIMARY,
 11736           DFHEIV99,
 11737           DFHEIV99
 11738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11739
 11740
 11741
 11742* EXEC CICS STARTBR
 11743*         DATASET  (TRLR-FILE-ID)
 11744*         RIDFLD   (TRLR-KEY)
 11745*    END-EXEC.
 11746     MOVE 0
 11747       TO DFHEIV11
 11748*    MOVE '&,         G          &   #00010475' TO DFHEIV0
 11749     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11751     MOVE X'2020233030303130343735' TO DFHEIV0(25:11)
 11752     CALL 'kxdfhei1' USING DFHEIV0,
 11753           TRLR-FILE-ID,
 11754           TRLR-KEY,
 11755           DFHEIV99,
 11756           DFHEIV11,
 11757           DFHEIV99
 11758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11759
 11760
 11761     GO TO 2410-CHANGE-TRLR.
 11762
 11763 2410-EXIT.
 11764     EXIT.
 11765
 11766 2420-UPDATE-TRLR.
 11767     MOVE ZERO TO COUNT-2.
 11768     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11769         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11770
 11771     IF NOT UPDATE-MADE
 11772         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11773
 11774 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 220
* EL131.cbl
 11775     EXIT.
 11776
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 221
* EL131.cbl
 11778 2425-UPDATE-NINETY-TRLR.
 11779
 11780     MOVE +90                    TO TRLR-SEQ-NO.
 11781
 11782
 11783* EXEC CICS HANDLE CONDITION
 11784*         NOTFND    (2425-NINETY-NOTFND)
 11785*         ENDFILE   (2425-NINETY-NOTFND)
 11786*    END-EXEC.
 11787*    MOVE '"$I''                  ! 5 #00010501' TO DFHEIV0
 11788     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11790     MOVE X'3520233030303130353031' TO DFHEIV0(25:11)
 11791     CALL 'kxdfhei1' USING DFHEIV0
 11792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11793
 11794
 11795
 11796* EXEC CICS READ UPDATE
 11797*        DATASET (TRLR-FILE-ID)
 11798*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11799*        RIDFLD  (TRLR-KEY)
 11800*    END-EXEC.
 11801*    MOVE '&"S        EU         (   #00010506' TO DFHEIV0
 11802     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11803     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11804     MOVE X'2020233030303130353036' TO DFHEIV0(25:11)
 11805     CALL 'kxdfhei1' USING DFHEIV0,
 11806           TRLR-FILE-ID,
 11807           DFHEIV20,
 11808           DFHEIV99,
 11809           TRLR-KEY,
 11810           DFHEIV99,
 11811           DFHEIV99,
 11812           DFHEIV99
 11813     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11814         DFHEIV20
 11815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11816
 11817
 11818     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11819     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 11820     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 11821
 11822     IF DIAGI GREATER THAN LOW-VALUES
 11823         MOVE DIAGI             TO AT-INFO-LINE-1
 11824     END-IF.
 11825
 11826     IF ICD1I GREATER THAN LOW-VALUES
 11827         MOVE ICD1I             TO AT-ICD-CODE-1
 11828     END-IF.
 11829
 11830     IF ICD2I GREATER THAN LOW-VALUES
 11831         MOVE ICD2I             TO AT-ICD-CODE-2
 11832     END-IF.
 11833
 11834
 11835* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 222
* EL131.cbl
 11836*        DATASET (TRLR-FILE-ID)
 11837*        FROM    (ACTIVITY-TRAILERS)
 11838*    END-EXEC.
 11839     MOVE LENGTH OF
 11840      ACTIVITY-TRAILERS
 11841       TO DFHEIV11
 11842*    MOVE '&& L                  %   #00010528' TO DFHEIV0
 11843     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11844     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11845     MOVE X'2020233030303130353238' TO DFHEIV0(25:11)
 11846     CALL 'kxdfhei1' USING DFHEIV0,
 11847           TRLR-FILE-ID,
 11848           ACTIVITY-TRAILERS,
 11849           DFHEIV11,
 11850           DFHEIV99
 11851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11852
 11853
 11854     IF DIAGI GREATER THAN LOW-VALUES
 11855       AND DIAGI NOT = WS-DIAGNOSIS
 11856         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11857         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11858         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11859
 11860     IF ICD1I GREATER THAN LOW-VALUES
 11861       AND ICD1I NOT = WS-ICD-CODE-1
 11862         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 11863         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 11864         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 11865     END-IF.
 11866
 11867     IF ICD2I GREATER THAN LOW-VALUES
 11868       AND ICD2I NOT = WS-ICD-CODE-2
 11869         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 11870         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 11871         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 11872     END-IF.
 11873
 11874     GO TO 2425-EXIT.
 11875
 11876 2425-NINETY-NOTFND.
 11877
 11878
 11879* EXEC CICS GETMAIN
 11880*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11881*         LENGTH    (TRLR-LENGTH)
 11882*         INITIMG   (GETMAIN-SPACE)
 11883*    END-EXEC.
 11884*    MOVE ',"IL                  $   #00010557' TO DFHEIV0
 11885     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11886     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11887     MOVE X'2020233030303130353537' TO DFHEIV0(25:11)
 11888     CALL 'kxdfhei1' USING DFHEIV0,
 11889           DFHEIV20,
 11890           TRLR-LENGTH,
 11891           GETMAIN-SPACE
 11892     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11893         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 223
* EL131.cbl
 11894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11895
 11896
 11897     MOVE +90                  TO TRLR-SEQ-NO.
 11898     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11899
 11900     MOVE 'AT'                 TO AT-RECORD-ID
 11901     MOVE '6'                  TO AT-TRAILER-TYPE
 11902     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11903                                  AT-GEN-INFO-LAST-MAINT-DT
 11904     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11905                                  AT-GEN-INFO-LAST-UPDATED-BY
 11906     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11907     MOVE DIAGI                TO AT-INFO-LINE-1.
 11908     MOVE ICD1I                TO AT-ICD-CODE-1.
 11909     MOVE ICD2I                TO AT-ICD-CODE-2.
 11910
 11911
 11912* EXEC CICS WRITE
 11913*        DATASET (TRLR-FILE-ID)
 11914*        FROM    (ACTIVITY-TRAILERS)
 11915*        RIDFLD  (TRLR-KEY)
 11916*    END-EXEC.
 11917     MOVE LENGTH OF
 11918      ACTIVITY-TRAILERS
 11919       TO DFHEIV11
 11920*    MOVE '&$ L                  ''   #00010577' TO DFHEIV0
 11921     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11922     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11923     MOVE X'2020233030303130353737' TO DFHEIV0(25:11)
 11924     CALL 'kxdfhei1' USING DFHEIV0,
 11925           TRLR-FILE-ID,
 11926           ACTIVITY-TRAILERS,
 11927           DFHEIV11,
 11928           TRLR-KEY,
 11929           DFHEIV99,
 11930           DFHEIV99
 11931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11932
 11933
 11934 2425-EXIT.
 11935     EXIT.
 11936
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 224
* EL131.cbl
 11938 2430-UPDATE-ACTQ.
 11939
 11940* EXEC CICS HANDLE CONDITION
 11941*         NOTFND    (2430-EXIT)
 11942*         ENDFILE   (2440-EXIT)
 11943*    END-EXEC.
 11944*    MOVE '"$I''                  ! 6 #00010588' TO DFHEIV0
 11945     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11947     MOVE X'3620233030303130353838' TO DFHEIV0(25:11)
 11948     CALL 'kxdfhei1' USING DFHEIV0
 11949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11950
 11951
 11952
 11953* EXEC CICS STARTBR
 11954*         DATASET  (ACTQ-FILE-ID)
 11955*         RIDFLD   (ACTQ-KEY)
 11956*    END-EXEC.
 11957     MOVE 0
 11958       TO DFHEIV11
 11959*    MOVE '&,         G          &   #00010593' TO DFHEIV0
 11960     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11961     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11962     MOVE X'2020233030303130353933' TO DFHEIV0(25:11)
 11963     CALL 'kxdfhei1' USING DFHEIV0,
 11964           ACTQ-FILE-ID,
 11965           ACTQ-KEY,
 11966           DFHEIV99,
 11967           DFHEIV11,
 11968           DFHEIV99
 11969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11970
 11971
 11972
 11973* EXEC CICS GETMAIN
 11974*         SET      (ADDRESS OF ACTIVITY-QUE)
 11975*         LENGTH   (ACTQ-LENGTH)
 11976*         INITIMG  (GETMAIN-SPACE)
 11977*    END-EXEC.
 11978*    MOVE ',"IL                  $   #00010598' TO DFHEIV0
 11979     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11980     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11981     MOVE X'2020233030303130353938' TO DFHEIV0(25:11)
 11982     CALL 'kxdfhei1' USING DFHEIV0,
 11983           DFHEIV20,
 11984           ACTQ-LENGTH,
 11985           GETMAIN-SPACE
 11986     SET ADDRESS OF ACTIVITY-QUE TO
 11987         DFHEIV20
 11988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11989
 11990
 11991     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11992
 11993 2430-EXIT.
 11994     EXIT.
 11995
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 225
* EL131.cbl
 11996 2440-CHANGE-ACTQ.
 11997
 11998
 11999* EXEC CICS READNEXT
 12000*         DATASET  (ACTQ-FILE-ID)
 12001*         RIDFLD   (ACTQ-KEY)
 12002*         INTO     (ACTIVITY-QUE)
 12003*    END-EXEC.
 12004     MOVE LENGTH OF
 12005      ACTIVITY-QUE
 12006       TO DFHEIV12
 12007     MOVE 0
 12008       TO DFHEIV11
 12009*    MOVE '&.IL                  )   #00010611' TO DFHEIV0
 12010     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12011     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12012     MOVE X'2020233030303130363131' TO DFHEIV0(25:11)
 12013     CALL 'kxdfhei1' USING DFHEIV0,
 12014           ACTQ-FILE-ID,
 12015           ACTIVITY-QUE,
 12016           DFHEIV12,
 12017           ACTQ-KEY,
 12018           DFHEIV99,
 12019           DFHEIV11,
 12020           DFHEIV99,
 12021           DFHEIV99
 12022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12023
 12024
 12025
 12026* EXEC CICS ENDBR
 12027*         DATASET (ACTQ-FILE-ID)
 12028*    END-EXEC.
 12029     MOVE 0
 12030       TO DFHEIV11
 12031*    MOVE '&2                    $   #00010617' TO DFHEIV0
 12032     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12033     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12034     MOVE X'2020233030303130363137' TO DFHEIV0(25:11)
 12035     CALL 'kxdfhei1' USING DFHEIV0,
 12036           ACTQ-FILE-ID,
 12037           DFHEIV11,
 12038           DFHEIV99
 12039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12040
 12041
 12042     IF ACTQ-KEY NOT = MSTR-KEY
 12043         GO TO 2440-EXIT.
 12044
 12045
 12046* EXEC CICS READ UPDATE
 12047*         DATASET  (ACTQ-FILE-ID)
 12048*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12049*         SET      (ADDRESS OF ACTIVITY-QUE)
 12050*    END-EXEC.
 12051*    MOVE '&"S        EU         (   #00010624' TO DFHEIV0
 12052     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12053     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 226
* EL131.cbl
 12054     MOVE X'2020233030303130363234' TO DFHEIV0(25:11)
 12055     CALL 'kxdfhei1' USING DFHEIV0,
 12056           ACTQ-FILE-ID,
 12057           DFHEIV20,
 12058           DFHEIV99,
 12059           AQ-CONTROL-PRIMARY,
 12060           DFHEIV99,
 12061           DFHEIV99,
 12062           DFHEIV99
 12063     SET ADDRESS OF ACTIVITY-QUE TO
 12064         DFHEIV20
 12065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12066
 12067
 12068     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12069
 12070
 12071* EXEC CICS DELETE
 12072*         DATASET (ACTQ-FILE-ID)
 12073*    END-EXEC.
 12074*    MOVE '&(                    &   #00010632' TO DFHEIV0
 12075     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12076     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12077     MOVE X'2020233030303130363332' TO DFHEIV0(25:11)
 12078     CALL 'kxdfhei1' USING DFHEIV0,
 12079           ACTQ-FILE-ID,
 12080           DFHEIV99,
 12081           DFHEIV99,
 12082           DFHEIV99,
 12083           DFHEIV99
 12084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12085
 12086
 12087     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12088     IF CERTI GREATER THAN LOW-VALUES
 12089        MOVE CERTI               TO AQ-CERT-PRIME.
 12090     IF SUFXI GREATER THAN LOW-VALUES
 12091        MOVE SUFXI               TO AQ-CERT-SFX.
 12092     IF CERTCARI GREATER THAN LOW-VALUES
 12093        MOVE CERTCARI            TO AQ-CARRIER.
 12094
 12095
 12096* EXEC CICS HANDLE CONDITION
 12097*         DUPREC   (2440-EXIT)
 12098*    END-EXEC.
 12099*    MOVE '"$%                   ! 7 #00010644' TO DFHEIV0
 12100     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12102     MOVE X'3720233030303130363434' TO DFHEIV0(25:11)
 12103     CALL 'kxdfhei1' USING DFHEIV0
 12104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12105
 12106
 12107
 12108* EXEC CICS WRITE
 12109*         DATASET  (ACTQ-FILE-ID)
 12110*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12111*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 227
* EL131.cbl
 12112*    END-EXEC.
 12113     MOVE LENGTH OF
 12114      ACTIVITY-QUE
 12115       TO DFHEIV11
 12116*    MOVE '&$ L                  ''   #00010648' TO DFHEIV0
 12117     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12118     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12119     MOVE X'2020233030303130363438' TO DFHEIV0(25:11)
 12120     CALL 'kxdfhei1' USING DFHEIV0,
 12121           ACTQ-FILE-ID,
 12122           ACTIVITY-QUE,
 12123           DFHEIV11,
 12124           AQ-CONTROL-PRIMARY,
 12125           DFHEIV99,
 12126           DFHEIV99
 12127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12128
 12129
 12130 2440-EXIT.
 12131     EXIT.
 12132
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 228
* EL131.cbl
 12134 2460-UPDATE-CHECKQ.
 12135
 12136* EXEC CICS HANDLE CONDITION
 12137*         NOTFND   (2460-EXIT)
 12138*    END-EXEC.
 12139*    MOVE '"$I                   ! 8 #00010659' TO DFHEIV0
 12140     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12142     MOVE X'3820233030303130363539' TO DFHEIV0(25:11)
 12143     CALL 'kxdfhei1' USING DFHEIV0
 12144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12145
 12146
 12147     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12148     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12149     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12150
 12151
 12152* EXEC CICS READ UPDATE
 12153*         DATASET   (CHKQ-FILE-ID)
 12154*         RIDFLD    (CHKQ-KEY)
 12155*         SET       (ADDRESS OF CHECK-QUE)
 12156*    END-EXEC.
 12157*    MOVE '&"S        EU         (   #00010667' TO DFHEIV0
 12158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12159     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12160     MOVE X'2020233030303130363637' TO DFHEIV0(25:11)
 12161     CALL 'kxdfhei1' USING DFHEIV0,
 12162           CHKQ-FILE-ID,
 12163           DFHEIV20,
 12164           DFHEIV99,
 12165           CHKQ-KEY,
 12166           DFHEIV99,
 12167           DFHEIV99,
 12168           DFHEIV99
 12169     SET ADDRESS OF CHECK-QUE TO
 12170         DFHEIV20
 12171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12172
 12173
 12174     IF CERTI GREATER THAN LOW-VALUES
 12175        MOVE CERTI               TO CQ-CERT-PRIME.
 12176     IF SUFXI GREATER THAN LOW-VALUES
 12177        MOVE SUFXI               TO CQ-CERT-SFX.
 12178     IF CERTCARI GREATER THAN LOW-VALUES
 12179        MOVE CERTCARI            TO CQ-CARRIER.
 12180
 12181
 12182* EXEC CICS REWRITE
 12183*         DATASET  (CHKQ-FILE-ID)
 12184*         FROM     (CHECK-QUE)
 12185*    END-EXEC.
 12186     MOVE LENGTH OF
 12187      CHECK-QUE
 12188       TO DFHEIV11
 12189*    MOVE '&& L                  %   #00010680' TO DFHEIV0
 12190     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12191     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 229
* EL131.cbl
 12192     MOVE X'2020233030303130363830' TO DFHEIV0(25:11)
 12193     CALL 'kxdfhei1' USING DFHEIV0,
 12194           CHKQ-FILE-ID,
 12195           CHECK-QUE,
 12196           DFHEIV11,
 12197           DFHEIV99
 12198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12199
 12200
 12201 2460-EXIT.
 12202     EXIT.
 12203
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 230
* EL131.cbl
 12205 2475-UPDATE-LETTER.
 12206
 12207* EXEC CICS HANDLE CONDITION
 12208*         NOTFND   (2475-EXIT)
 12209*    END-EXEC.
 12210*    MOVE '"$I                   ! 9 #00010690' TO DFHEIV0
 12211     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12213     MOVE X'3920233030303130363930' TO DFHEIV0(25:11)
 12214     CALL 'kxdfhei1' USING DFHEIV0
 12215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12216
 12217
 12218     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12219     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12220     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12221     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12222
 12223
 12224* EXEC CICS READ UPDATE
 12225*         DATASET   (ARCH-FILE-ID)
 12226*         RIDFLD    (ARCH-KEY)
 12227*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12228*    END-EXEC.
 12229*    MOVE '&"S        EU         (   #00010699' TO DFHEIV0
 12230     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12231     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12232     MOVE X'2020233030303130363939' TO DFHEIV0(25:11)
 12233     CALL 'kxdfhei1' USING DFHEIV0,
 12234           ARCH-FILE-ID,
 12235           DFHEIV20,
 12236           DFHEIV99,
 12237           ARCH-KEY,
 12238           DFHEIV99,
 12239           DFHEIV99,
 12240           DFHEIV99
 12241     SET ADDRESS OF LETTER-ARCHIVE TO
 12242         DFHEIV20
 12243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12244
 12245
 12246* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12247* TO THIS MASTER-KEY INFORMATION.
 12248
 12249     IF LA-CARRIER  = CARRIER-CODE AND
 12250        LA-CLAIM-NO = CLAIM-NO     AND
 12251        LA-CERT-NO  = CERT-NO
 12252        NEXT SENTENCE
 12253     ELSE
 12254        GO TO 2475-UNLOCK.
 12255
 12256     IF CERTI GREATER THAN LOW-VALUES
 12257        MOVE CERTI               TO LA-CERT-PRIME.
 12258     IF SUFXI GREATER THAN LOW-VALUES
 12259        MOVE SUFXI               TO LA-CERT-SFX.
 12260     IF CERTCARI GREATER THAN LOW-VALUES
 12261        MOVE CERTCARI            TO LA-CARRIER.
 12262
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 231
* EL131.cbl
 12263
 12264* EXEC CICS REWRITE
 12265*         DATASET  (ARCH-FILE-ID)
 12266*         FROM     (LETTER-ARCHIVE)
 12267*    END-EXEC.
 12268     MOVE LENGTH OF
 12269      LETTER-ARCHIVE
 12270       TO DFHEIV11
 12271*    MOVE '&& L                  %   #00010722' TO DFHEIV0
 12272     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12273     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12274     MOVE X'2020233030303130373232' TO DFHEIV0(25:11)
 12275     CALL 'kxdfhei1' USING DFHEIV0,
 12276           ARCH-FILE-ID,
 12277           LETTER-ARCHIVE,
 12278           DFHEIV11,
 12279           DFHEIV99
 12280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12281
 12282
 12283     GO TO 2475-EXIT.
 12284
 12285 2475-UNLOCK.
 12286
 12287* EXEC CICS UNLOCK
 12288*         DATASET  (ARCH-FILE-ID)
 12289*    END-EXEC.
 12290*    MOVE '&*                    #   #00010730' TO DFHEIV0
 12291     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12292     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12293     MOVE X'2020233030303130373330' TO DFHEIV0(25:11)
 12294     CALL 'kxdfhei1' USING DFHEIV0,
 12295           ARCH-FILE-ID,
 12296           DFHEIV99
 12297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12298
 12299
 12300 2475-EXIT.
 12301     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 232
* EL131.cbl
 12303 2600-CREATE-MAINT-NOTE.
 12304     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12305     MOVE '1'                    TO CNTL-REC-TYPE.
 12306     MOVE SPACES                 TO CNTL-PROC-ID.
 12307     MOVE ZERO                   TO CNTL-SEQ-NO.
 12308
 12309
 12310* EXEC CICS READ
 12311*         SET        (ADDRESS OF CONTROL-FILE)
 12312*         DATASET    ('ELCNTL')
 12313*         RIDFLD     (CNTL-KEY)
 12314*    END-EXEC.
 12315     MOVE 'ELCNTL' TO DFHEIV1
 12316*    MOVE '&"S        E          (   #00010743' TO DFHEIV0
 12317     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12318     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12319     MOVE X'2020233030303130373433' TO DFHEIV0(25:11)
 12320     CALL 'kxdfhei1' USING DFHEIV0,
 12321           DFHEIV1,
 12322           DFHEIV20,
 12323           DFHEIV99,
 12324           CNTL-KEY,
 12325           DFHEIV99,
 12326           DFHEIV99,
 12327           DFHEIV99
 12328     SET ADDRESS OF CONTROL-FILE TO
 12329         DFHEIV20
 12330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12331
 12332
 12333     IF CO-NO-USE-AUDIT-CHANGES
 12334         GO TO 2600-EXIT.
 12335
 12336     IF PROCL GREATER ZERO
 12337     IF PROCI NOT = LOW-VALUES
 12338     IF PROCI NOT = CL-PROCESSOR-ID
 12339         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12340         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12341         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12342
 12343     IF SEXL GREATER ZERO
 12344     IF SEXI NOT = LOW-VALUES
 12345     IF SEXI NOT = CL-INSURED-SEX-CD
 12346         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12347         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12348         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12349
 12350     IF BIRTHL GREATER ZERO
 12351     IF HOLD-BIRTH NOT = LOW-VALUES
 12352     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12353         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12354         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12355         MOVE SPACES               TO DC-OPTION-CODE
 12356         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12357         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12358         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12359
 12360     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 233
* EL131.cbl
 12361     IF SOCIALI NOT = LOW-VALUES
 12362     IF SOCIALI NOT = CL-SOC-SEC-NO
 12363         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12364         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12365         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12366
 12367     IF OCCL GREATER ZERO
 12368     IF OCCI NOT = LOW-VALUES
 12369     IF OCCI NOT = CL-INSURED-OCC-CD
 12370         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12371         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12372         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12373
 12374     IF BENEL GREATER ZERO
 12375     IF BENEI NOT = LOW-VALUES
 12376     IF BENEI NOT = CL-BENEFICIARY
 12377         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12378         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12379         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12380
 12381     IF PREMTYPL GREATER ZERO
 12382     IF PREMTYPI NOT = LOW-VALUES
 12383     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12384         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12385         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12386         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12387
 12388*    IF CAUSEL GREATER ZERO
 12389*    IF CAUSEI NOT = LOW-VALUES
 12390*    IF CAUSEI NOT = CL-CAUSE-CD
 12391*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12392*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12393*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12394
 12395*    IF ENDL GREATER ZERO
 12396*    IF HOLD-END NOT = LOW-VALUES
 12397*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12398*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 12399*        MOVE CL-EST-END-OF-DISAB-DT
 12400*                                  TO DC-BIN-DATE-1
 12401*        MOVE SPACES               TO DC-OPTION-CODE
 12402*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12403*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12404*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12405
 12406     IF PDTHRUL GREATER ZERO
 12407     IF HOLD-PDTHRU NOT = LOW-VALUES
 12408     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12409         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12410         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12411         MOVE SPACES               TO DC-OPTION-CODE
 12412         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12413         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12414         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12415
 12416     IF PDAMTL GREATER ZERO
 12417     IF HOLD-PDAMT NOT = ZEROS
 12418     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 234
* EL131.cbl
 12419         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12420         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12421         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12422         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12423
 12424     IF NODAYSL GREATER ZERO
 12425     IF HOLD-NODAYS NOT = ZEROS
 12426     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12427         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12428         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12429         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12430         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12431
 12432     IF NOPMTSL GREATER ZERO
 12433     IF HOLD-NOPMTS NOT = ZEROS
 12434     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12435         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12436         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12437         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12438         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12439
 12440     IF FORMTYPL GREATER ZERO
 12441     IF FORMTYPI NOT = LOW-VALUES
 12442     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12443         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12444         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12445         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12446
 12447     IF REPL GREATER ZERO
 12448     IF HOLD-REPORTED NOT = LOW-VALUES
 12449     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12450         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12451         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12452         MOVE SPACES               TO DC-OPTION-CODE
 12453         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12454         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12455         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12456
 12457     IF ADDONDTL GREATER ZERO
 12458     IF HOLD-ADDON NOT = LOW-VALUES
 12459     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12460         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12461         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12462         MOVE SPACES               TO DC-OPTION-CODE
 12463         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12464         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12465         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12466
 12467     IF PRICDL GREATER ZERO
 12468     IF PRICDI NOT = LOW-VALUES
 12469     IF PRICDI NOT = CL-PRIORITY-CD
 12470         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12471         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12472         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12473
 12474     IF FILETOL GREATER ZERO
 12475     IF FILETOI NOT = LOW-VALUES
 12476     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 235
* EL131.cbl
 12477         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12478         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12479         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12480
 12481     IF SUPVL GREATER ZERO
 12482     IF SUPVI NOT = LOW-VALUES
 12483     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12484         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12485         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12486         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12487     IF (CRITPTL > ZERO)
 12488        AND (CRITPTI NOT = LOW-VALUES)
 12489        AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12490        MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12491        MOVE CL-CRIT-PER-RECURRENT
 12492                                 TO SPLIT-INFO-OLD
 12493        PERFORM 2650-WRITE-MAINT-NOTE
 12494                                 THRU 2650-EXIT
 12495     END-IF
 12496
 12497     IF (RTWMOSL > ZERO)
 12498        AND (RTWMOSI NOT = LOW-VALUES)
 12499        AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12500        MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12501        MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12502        PERFORM 2650-WRITE-MAINT-NOTE
 12503                                 THRU 2650-EXIT
 12504     END-IF
 12505     IF MLNAMEL GREATER ZERO
 12506     IF MLNAMEI NOT = LOW-VALUES
 12507     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12508         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12509         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12510         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12511
 12512     IF MFNAMEL GREATER ZERO
 12513     IF MFNAMEI NOT = LOW-VALUES
 12514     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12515         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12516         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12517         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12518
 12519     IF MMINITL GREATER ZERO
 12520     IF MMINITI NOT = LOW-VALUES
 12521     IF MMINITI NOT = CL-INSURED-MID-INIT
 12522         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12523         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12524         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12525
 12526     IF CERTEFFL GREATER ZERO
 12527     IF HOLD-EFF NOT = LOW-VALUES
 12528     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12529         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12530         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12531         MOVE SPACES               TO DC-OPTION-CODE
 12532         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12533         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12534         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 236
* EL131.cbl
 12535
 12536     IF CERTACTL GREATER ZERO
 12537     IF CERTACTI NOT = LOW-VALUES
 12538     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12539         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12540         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12541         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12542
 12543     IF CERTSTL GREATER ZERO
 12544     IF CERTSTI NOT = LOW-VALUES
 12545     IF CERTSTI NOT = CL-CERT-STATE
 12546         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 12547         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 12548         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12549
 12550     IF CERTCARL GREATER ZERO
 12551     IF CERTCARI NOT = LOW-VALUES
 12552     IF CERTCARI NOT = CL-CERT-CARRIER
 12553         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 12554         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 12555         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12556
 12557     IF CERTGRPL GREATER ZERO
 12558     IF CERTGRPI NOT = LOW-VALUES
 12559     IF CERTGRPI NOT = CL-CERT-GROUPING
 12560         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 12561         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 12562         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12563
 12564     IF CERTL GREATER ZERO OR
 12565        SUFXL GREATER ZERO
 12566     IF (CERTI NOT = LOW-VALUES AND
 12567                     CL-CERT-PRIME)
 12568                OR
 12569        (SUFXI NOT = LOW-VALUES AND
 12570                     CL-CERT-SFX)
 12571         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 12572         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 12573         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12574     IF incl > zeros
 12575        IF (HOLD-INCUR NOT = LOW-VALUES)
 12576           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 12577           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 12578           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 12579           MOVE SPACES           TO DC-OPTION-CODE
 12580           PERFORM 9800-CONVERT-DATE
 12581                                 THRU 9800-EXIT
 12582           MOVE DC-GREG-DATE-1-EDIT
 12583                                 TO SPLIT-INFO-OLD
 12584           PERFORM 2650-WRITE-MAINT-NOTE
 12585                                 THRU 2650-EXIT
 12586        END-IF
 12587     END-IF
 12588     .
 12589 2600-EXIT.
 12590      EXIT.
 12591
 12592 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 237
* EL131.cbl
 12593
 12594* EXEC CICS GETMAIN
 12595*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12596*         LENGTH   (TRLR-LENGTH)
 12597*         INITIMG  (GETMAIN-SPACE)
 12598*    END-EXEC.
 12599*    MOVE ',"IL                  $   #00011009' TO DFHEIV0
 12600     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12601     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12602     MOVE X'2020233030303131303039' TO DFHEIV0(25:11)
 12603     CALL 'kxdfhei1' USING DFHEIV0,
 12604           DFHEIV20,
 12605           TRLR-LENGTH,
 12606           GETMAIN-SPACE
 12607     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12608         DFHEIV20
 12609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12610
 12611
 12612
 12613* EXEC CICS HANDLE CONDITION
 12614*         DUPREC   (2650-EXIT)
 12615*    END-EXEC.
 12616*    MOVE '"$%                   ! : #00011015' TO DFHEIV0
 12617     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12619     MOVE X'3A20233030303131303135' TO DFHEIV0(25:11)
 12620     CALL 'kxdfhei1' USING DFHEIV0
 12621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12622
 12623
 12624     MOVE SPACES             TO ACTIVITY-TRAILERS.
 12625
 12626     IF CERTL GREATER ZERO
 12627         MOVE CERTI          TO CL-CERT-PRIME.
 12628
 12629     IF SUFXL GREATER ZERO
 12630         MOVE SUFXI          TO CL-CERT-SFX.
 12631
 12632     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 12633
 12634     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 12635     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 12636
 12637     MOVE 'AT'               TO AT-RECORD-ID.
 12638
 12639     MOVE '6'                TO AT-TRAILER-TYPE.
 12640     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 12641                                AT-GEN-INFO-LAST-MAINT-DT.
 12642     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 12643                                AT-GEN-INFO-LAST-UPDATED-BY.
 12644     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 12645     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 12646     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 12647
 12648
 12649* EXEC CICS WRITE
 12650*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 238
* EL131.cbl
 12651*         RIDFLD   (AT-CONTROL-PRIMARY)
 12652*         FROM     (ACTIVITY-TRAILERS)
 12653*    END-EXEC.
 12654     MOVE LENGTH OF
 12655      ACTIVITY-TRAILERS
 12656       TO DFHEIV11
 12657*    MOVE '&$ L                  ''   #00011043' TO DFHEIV0
 12658     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12659     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12660     MOVE X'2020233030303131303433' TO DFHEIV0(25:11)
 12661     CALL 'kxdfhei1' USING DFHEIV0,
 12662           TRLR-FILE-ID,
 12663           ACTIVITY-TRAILERS,
 12664           DFHEIV11,
 12665           AT-CONTROL-PRIMARY,
 12666           DFHEIV99,
 12667           DFHEIV99
 12668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12669
 12670
 12671 2650-EXIT.
 12672      EXIT.
 12673
 12674 2800-CHECK-AUTO-PAY.
 12675
 12676     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 12677     MOVE PI-CARRIER         TO TRLR-CARRIER.
 12678     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 12679     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 12680     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 12681
 12682
 12683* EXEC CICS HANDLE CONDITION
 12684*         NOTFND    (2800-EXIT)
 12685*         ENDFILE   (2800-EXIT)
 12686*    END-EXEC.
 12687*    MOVE '"$I''                  ! ; #00011060' TO DFHEIV0
 12688     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12690     MOVE X'3B20233030303131303630' TO DFHEIV0(25:11)
 12691     CALL 'kxdfhei1' USING DFHEIV0
 12692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12693
 12694
 12695
 12696* EXEC CICS READ
 12697*        DATASET (TRLR-FILE-ID)
 12698*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12699*        RIDFLD  (TRLR-KEY)
 12700*    END-EXEC.
 12701*    MOVE '&"S        E          (   #00011065' TO DFHEIV0
 12702     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12704     MOVE X'2020233030303131303635' TO DFHEIV0(25:11)
 12705     CALL 'kxdfhei1' USING DFHEIV0,
 12706           TRLR-FILE-ID,
 12707           DFHEIV20,
 12708           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 239
* EL131.cbl
 12709           TRLR-KEY,
 12710           DFHEIV99,
 12711           DFHEIV99,
 12712           DFHEIV99
 12713     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12714         DFHEIV20
 12715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12716
 12717
 12718     IF BENEFICIARY-PAID-AUTO
 12719         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 12720     END-IF.
 12721
 12722 2800-EXIT.
 12723      EXIT.
 12724
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 240
* EL131.cbl
 12726 3000-DELETE-CLAIM.
 12727     IF  NOT MODIFY-CAP
 12728         MOVE ER-0070            TO EMI-ERROR
 12729         MOVE -1                 TO MAINTL
 12730         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12731         GO TO 8110-SEND-DATA.
 12732
 12733
 12734* EXEC CICS READ
 12735*         SET      (ADDRESS OF CLAIM-MASTER)
 12736*         DATASET  (CLMS-FILE-ID)
 12737*         RIDFLD   (MSTR-KEY)
 12738*    END-EXEC.
 12739*    MOVE '&"S        E          (   #00011086' TO DFHEIV0
 12740     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12742     MOVE X'2020233030303131303836' TO DFHEIV0(25:11)
 12743     CALL 'kxdfhei1' USING DFHEIV0,
 12744           CLMS-FILE-ID,
 12745           DFHEIV20,
 12746           DFHEIV99,
 12747           MSTR-KEY,
 12748           DFHEIV99,
 12749           DFHEIV99,
 12750           DFHEIV99
 12751     SET ADDRESS OF CLAIM-MASTER TO
 12752         DFHEIV20
 12753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12754
 12755
 12756     IF CL-1ST-TRL-AVAIL
 12757         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 12758     ELSE
 12759        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 12760        MOVE 0                   TO TRLR-SEQ-NO
 12761
 12762* EXEC CICS STARTBR
 12763*            DATASET (TRLR-FILE-ID)
 12764*            RIDFLD  (TRLR-KEY)
 12765*        END-EXEC
 12766     MOVE 0
 12767       TO DFHEIV11
 12768*    MOVE '&,         G          &   #00011097' TO DFHEIV0
 12769     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12770     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12771     MOVE X'2020233030303131303937' TO DFHEIV0(25:11)
 12772     CALL 'kxdfhei1' USING DFHEIV0,
 12773           TRLR-FILE-ID,
 12774           TRLR-KEY,
 12775           DFHEIV99,
 12776           DFHEIV11,
 12777           DFHEIV99
 12778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12779         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 12780
 12781* EXEC CICS ENDBR
 12782*            DATASET (TRLR-FILE-ID)
 12783*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 241
* EL131.cbl
 12784     MOVE 0
 12785       TO DFHEIV11
 12786*    MOVE '&2                    $   #00011102' TO DFHEIV0
 12787     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12788     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12789     MOVE X'2020233030303131313032' TO DFHEIV0(25:11)
 12790     CALL 'kxdfhei1' USING DFHEIV0,
 12791           TRLR-FILE-ID,
 12792           DFHEIV11,
 12793           DFHEIV99
 12794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12795        IF SCREEN-ERROR
 12796            MOVE ER-0208         TO EMI-ERROR
 12797            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12798            MOVE -1              TO MAINTL
 12799            GO TO 8110-SEND-DATA
 12800        ELSE
 12801            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 12802
 12803     IF SCREEN-ERROR
 12804         MOVE -1                 TO MAINTL
 12805         GO TO 8110-SEND-DATA.
 12806
 12807     MOVE -1                     TO ONE-OR-MIN1.
 12808     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 12809
 12810     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 12811         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 12812                                    WS-SAVE-CLAIM-KEY
 12813         MOVE +1                 TO ONE-OR-MIN1
 12814         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 12815
 12816     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 12817
 12818     MOVE LOW-VALUES             TO EL131AO.
 12819     MOVE ER-0000                TO EMI-ERROR.
 12820     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12821     MOVE 'X'                    TO PI-RETURN-CD-1.
 12822     MOVE -1                     TO MAINTL.
 12823     GO TO 8100-SEND-MAP.
 12824
 12825 3010-DEL-MSTR-TRLR.
 12826
 12827* EXEC CICS READ UPDATE
 12828*         SET       (ADDRESS OF CLAIM-MASTER)
 12829*         DATASET   (CLMS-FILE-ID)
 12830*         RIDFLD    (MSTR-KEY)
 12831*    END-EXEC.
 12832*    MOVE '&"S        EU         (   #00011136' TO DFHEIV0
 12833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12834     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12835     MOVE X'2020233030303131313336' TO DFHEIV0(25:11)
 12836     CALL 'kxdfhei1' USING DFHEIV0,
 12837           CLMS-FILE-ID,
 12838           DFHEIV20,
 12839           DFHEIV99,
 12840           MSTR-KEY,
 12841           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 242
* EL131.cbl
 12842           DFHEIV99,
 12843           DFHEIV99
 12844     SET ADDRESS OF CLAIM-MASTER TO
 12845         DFHEIV20
 12846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12847
 12848
 12849     if (cl-priority-cd = '8')
 12850        and (pi-processor-id not = 'PEMA' and 'JMS '
 12851             AND 'AMWA')
 12852        MOVE ER-8003             TO EMI-ERROR
 12853        PERFORM 9900-ERROR-FORMAT
 12854                                 THRU 9900-EXIT
 12855        MOVE -1                  TO MAINTL
 12856        GO TO 8110-SEND-DATA
 12857     end-if
 12858
 12859     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 12860     MOVE ZERO                   TO TRLR-SEQ-NO.
 12861
 12862
 12863* EXEC CICS HANDLE CONDITION
 12864*         NOTFND    (3010-DEL-ACTQ)
 12865*         ENDFILE   (3040-EXIT)
 12866*    END-EXEC.
 12867*    MOVE '"$I''                  ! < #00011155' TO DFHEIV0
 12868     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12870     MOVE X'3C20233030303131313535' TO DFHEIV0(25:11)
 12871     CALL 'kxdfhei1' USING DFHEIV0
 12872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12873
 12874
 12875     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12876
 12877 3010-DEL-ACTQ.
 12878
 12879
 12880* EXEC CICS HANDLE CONDITION
 12881*         NOTFND    (3010-NO-ACTIVITY)
 12882*         ENDFILE   (3050-EXIT)
 12883*    END-EXEC.
 12884*    MOVE '"$I''                  ! = #00011164' TO DFHEIV0
 12885     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12887     MOVE X'3D20233030303131313634' TO DFHEIV0(25:11)
 12888     CALL 'kxdfhei1' USING DFHEIV0
 12889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12890
 12891
 12892
 12893* EXEC CICS STARTBR
 12894*         DATASET  (ACTQ-FILE-ID)
 12895*         RIDFLD   (ACTQ-KEY)
 12896*    END-EXEC.
 12897     MOVE 0
 12898       TO DFHEIV11
 12899*    MOVE '&,         G          &   #00011169' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 243
* EL131.cbl
 12900     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12901     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12902     MOVE X'2020233030303131313639' TO DFHEIV0(25:11)
 12903     CALL 'kxdfhei1' USING DFHEIV0,
 12904           ACTQ-FILE-ID,
 12905           ACTQ-KEY,
 12906           DFHEIV99,
 12907           DFHEIV11,
 12908           DFHEIV99
 12909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12910
 12911
 12912
 12913* EXEC CICS GETMAIN
 12914*         SET      (ADDRESS OF ACTIVITY-QUE)
 12915*         LENGTH   (ACTQ-LENGTH)
 12916*         INITIMG  (GETMAIN-SPACE)
 12917*    END-EXEC.
 12918*    MOVE ',"IL                  $   #00011174' TO DFHEIV0
 12919     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12921     MOVE X'2020233030303131313734' TO DFHEIV0(25:11)
 12922     CALL 'kxdfhei1' USING DFHEIV0,
 12923           DFHEIV20,
 12924           ACTQ-LENGTH,
 12925           GETMAIN-SPACE
 12926     SET ADDRESS OF ACTIVITY-QUE TO
 12927         DFHEIV20
 12928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12929
 12930
 12931     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12932
 12933
 12934* EXEC CICS ENDBR
 12935*         DATASET (ACTQ-FILE-ID)
 12936*    END-EXEC.
 12937     MOVE 0
 12938       TO DFHEIV11
 12939*    MOVE '&2                    $   #00011182' TO DFHEIV0
 12940     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12941     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12942     MOVE X'2020233030303131313832' TO DFHEIV0(25:11)
 12943     CALL 'kxdfhei1' USING DFHEIV0,
 12944           ACTQ-FILE-ID,
 12945           DFHEIV11,
 12946           DFHEIV99
 12947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12948
 12949
 12950 3010-NO-ACTIVITY.
 12951
 12952
 12953* EXEC CICS HANDLE CONDITION
 12954*        NOTFND   (3010-CERT-NOT-FOUND)
 12955*    END-EXEC.
 12956*    MOVE '"$I                   ! > #00011188' TO DFHEIV0
 12957     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 244
* EL131.cbl
 12958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12959     MOVE X'3E20233030303131313838' TO DFHEIV0(25:11)
 12960     CALL 'kxdfhei1' USING DFHEIV0
 12961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12962
 12963
 12964     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12965     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12966     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12967     MOVE CL-CERT-STATE          TO CERT-STATE.
 12968     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12969     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12970     MOVE CL-CERT-NO             TO CERT-CERT.
 12971
 12972
 12973* EXEC CICS READ
 12974*        DATASET   (CERT-FILE-ID)
 12975*        RIDFLD    (CERT-KEY)
 12976*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12977*    END-EXEC.
 12978*    MOVE '&"S        E          (   #00011200' TO DFHEIV0
 12979     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12980     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12981     MOVE X'2020233030303131323030' TO DFHEIV0(25:11)
 12982     CALL 'kxdfhei1' USING DFHEIV0,
 12983           CERT-FILE-ID,
 12984           DFHEIV20,
 12985           DFHEIV99,
 12986           CERT-KEY,
 12987           DFHEIV99,
 12988           DFHEIV99,
 12989           DFHEIV99
 12990     SET ADDRESS OF CERTIFICATE-MASTER TO
 12991         DFHEIV20
 12992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12993
 12994
 12995     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12996       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12997         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12998     ELSE
 12999         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13000
 13001  3010-UPDATE-CERT-TRLR.
 13002
 13003      MOVE CERT-KEY              TO ELCRTT-KEY
 13004      MOVE 'B'                   TO CTRLR-REC-TYPE
 13005
 13006* EXEC CICS READ
 13007*        UPDATE
 13008*        DATASET   ('ELCRTT')
 13009*        RIDFLD    (ELCRTT-KEY)
 13010*        INTO      (CERTIFICATE-TRAILERS)
 13011*        RESP      (WS-RESPONSE)
 13012*     END-EXEC
 13013     MOVE LENGTH OF
 13014      CERTIFICATE-TRAILERS
 13015       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 245
* EL131.cbl
 13016     MOVE 'ELCRTT' TO DFHEIV1
 13017*    MOVE '&"IL       EU         (  N#00011216' TO DFHEIV0
 13018     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13019     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13020     MOVE X'204E233030303131323136' TO DFHEIV0(25:11)
 13021     CALL 'kxdfhei1' USING DFHEIV0,
 13022           DFHEIV1,
 13023           CERTIFICATE-TRAILERS,
 13024           DFHEIV11,
 13025           ELCRTT-KEY,
 13026           DFHEIV99,
 13027           DFHEIV99,
 13028           DFHEIV99
 13029     MOVE EIBRESP  TO WS-RESPONSE
 13030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13031      IF WS-RESP-NORMAL
 13032*    if cl-insured-claim = 'S'
 13033*       move +2 to s1
 13034*    else
 13035*       MOVE +1 to s1
 13036*    end-if
 13037
 13038     move +1 to s1
 13039     evaluate cl-claim-type
 13040        when 'A'
 13041           move +1 to s2
 13042        when 'I'
 13043           move +2 to s2
 13044        when 'G'
 13045           move +3 to s2
 13046        when 'L'
 13047           move +4 to s2
 13048        when 'P'
 13049           move +5 to s2
 13050     end-evaluate
 13051     SUBTRACT +1 FROM CS-NO-OF-CLAIMS (S1 S2)
 13052     IF CS-NO-OF-CLAIMS (S1 S2) < ZEROS
 13053        MOVE ZEROS               TO CS-NO-OF-CLAIMS (S1 S2)
 13054     END-IF
 13055     if cs-no-of-claims (s1 s2) = zeros
 13056        move spaces              to cs-claim-type (s1 s2)
 13057     end-if
 13058
 13059
 13060* EXEC CICS REWRITE
 13061*       DATASET   ('ELCRTT')
 13062*       FROM      (CERTIFICATE-TRAILERS)
 13063*    END-EXEC
 13064     MOVE LENGTH OF
 13065      CERTIFICATE-TRAILERS
 13066       TO DFHEIV11
 13067     MOVE 'ELCRTT' TO DFHEIV1
 13068*    MOVE '&& L                  %   #00011251' TO DFHEIV0
 13069     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13070     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13071     MOVE X'2020233030303131323531' TO DFHEIV0(25:11)
 13072     CALL 'kxdfhei1' USING DFHEIV0,
 13073           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 246
* EL131.cbl
 13074           CERTIFICATE-TRAILERS,
 13075           DFHEIV11,
 13076           DFHEIV99
 13077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13078     .
 13079 3010-CERT-NOT-FOUND.
 13080
 13081
 13082* EXEC CICS DELETE
 13083*        DATASET  (CLMS-FILE-ID)
 13084*    END-EXEC.
 13085*    MOVE '&(                    &   #00011258' TO DFHEIV0
 13086     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13087     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13088     MOVE X'2020233030303131323538' TO DFHEIV0(25:11)
 13089     CALL 'kxdfhei1' USING DFHEIV0,
 13090           CLMS-FILE-ID,
 13091           DFHEIV99,
 13092           DFHEIV99,
 13093           DFHEIV99,
 13094           DFHEIV99
 13095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13096
 13097
 13098 3010-EXIT.
 13099      EXIT.
 13100
 13101 3020-UPDATE-CERT.
 13102
 13103* EXEC CICS READ UPDATE
 13104*         DATASET  (CERT-FILE-ID)
 13105*         RIDFLD   (CERT-KEY)
 13106*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13107*    END-EXEC.
 13108*    MOVE '&"S        EU         (   #00011266' TO DFHEIV0
 13109     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13110     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13111     MOVE X'2020233030303131323636' TO DFHEIV0(25:11)
 13112     CALL 'kxdfhei1' USING DFHEIV0,
 13113           CERT-FILE-ID,
 13114           DFHEIV20,
 13115           DFHEIV99,
 13116           CERT-KEY,
 13117           DFHEIV99,
 13118           DFHEIV99,
 13119           DFHEIV99
 13120     SET ADDRESS OF CERTIFICATE-MASTER TO
 13121         DFHEIV20
 13122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13123
 13124
 13125     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13126
 13127
 13128* EXEC CICS HANDLE CONDITION
 13129*         DUPKEY   (3020-EXIT)
 13130*    END-EXEC.
 13131*    MOVE '"$$                   ! ? #00011274' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 247
* EL131.cbl
 13132     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13134     MOVE X'3F20233030303131323734' TO DFHEIV0(25:11)
 13135     CALL 'kxdfhei1' USING DFHEIV0
 13136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13137
 13138
 13139
 13140* EXEC CICS REWRITE
 13141*         DATASET  (CERT-FILE-ID)
 13142*         FROM     (CERTIFICATE-MASTER)
 13143*    END-EXEC.
 13144     MOVE LENGTH OF
 13145      CERTIFICATE-MASTER
 13146       TO DFHEIV11
 13147*    MOVE '&& L                  %   #00011278' TO DFHEIV0
 13148     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13149     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13150     MOVE X'2020233030303131323738' TO DFHEIV0(25:11)
 13151     CALL 'kxdfhei1' USING DFHEIV0,
 13152           CERT-FILE-ID,
 13153           CERTIFICATE-MASTER,
 13154           DFHEIV11,
 13155           DFHEIV99
 13156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13157
 13158
 13159 3020-EXIT.
 13160     EXIT.
 13161
 13162 3030-DELETE-CERT.
 13163
 13164* EXEC CICS READ UPDATE
 13165*         DATASET  (CERT-FILE-ID)
 13166*         RIDFLD   (CERT-KEY)
 13167*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13168*    END-EXEC.
 13169*    MOVE '&"S        EU         (   #00011287' TO DFHEIV0
 13170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13171     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13172     MOVE X'2020233030303131323837' TO DFHEIV0(25:11)
 13173     CALL 'kxdfhei1' USING DFHEIV0,
 13174           CERT-FILE-ID,
 13175           DFHEIV20,
 13176           DFHEIV99,
 13177           CERT-KEY,
 13178           DFHEIV99,
 13179           DFHEIV99,
 13180           DFHEIV99
 13181     SET ADDRESS OF CERTIFICATE-MASTER TO
 13182         DFHEIV20
 13183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13184
 13185
 13186
 13187* EXEC CICS DELETE
 13188*         DATASET   (CERT-FILE-ID)
 13189*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 248
* EL131.cbl
 13190*    MOVE '&(                    &   #00011293' TO DFHEIV0
 13191     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13192     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13193     MOVE X'2020233030303131323933' TO DFHEIV0(25:11)
 13194     CALL 'kxdfhei1' USING DFHEIV0,
 13195           CERT-FILE-ID,
 13196           DFHEIV99,
 13197           DFHEIV99,
 13198           DFHEIV99,
 13199           DFHEIV99
 13200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13201
 13202
 13203 3030-EXIT.
 13204     EXIT.
 13205
 13206 3040-DELETE-TRLR.
 13207
 13208* EXEC CICS READ
 13209*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13210*         DATASET  (TRLR-FILE-ID)
 13211*         RIDFLD   (TRLR-KEY)
 13212*         GTEQ
 13213*    END-EXEC.
 13214*    MOVE '&"S        G          (   #00011301' TO DFHEIV0
 13215     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13217     MOVE X'2020233030303131333031' TO DFHEIV0(25:11)
 13218     CALL 'kxdfhei1' USING DFHEIV0,
 13219           TRLR-FILE-ID,
 13220           DFHEIV20,
 13221           DFHEIV99,
 13222           TRLR-KEY,
 13223           DFHEIV99,
 13224           DFHEIV99,
 13225           DFHEIV99
 13226     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13227         DFHEIV20
 13228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13229
 13230
 13231     IF PI-COMPANY-CD = AT-COMPANY-CD
 13232        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13233        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13234           GO TO 3040-EXIT
 13235        ELSE
 13236           NEXT SENTENCE
 13237     ELSE
 13238        GO TO 3040-EXIT.
 13239
 13240
 13241* EXEC CICS DELETE
 13242*         DATASET  (TRLR-FILE-ID)
 13243*         RIDFLD   (TRLR-KEY)
 13244*    END-EXEC.
 13245*    MOVE '&(  R                 &   #00011317' TO DFHEIV0
 13246     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13247     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 249
* EL131.cbl
 13248     MOVE X'2020233030303131333137' TO DFHEIV0(25:11)
 13249     CALL 'kxdfhei1' USING DFHEIV0,
 13250           TRLR-FILE-ID,
 13251           TRLR-KEY,
 13252           DFHEIV99,
 13253           DFHEIV99,
 13254           DFHEIV99
 13255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13256
 13257
 13258     GO TO 3040-DELETE-TRLR.
 13259
 13260 3040-EXIT.
 13261     EXIT.
 13262
 13263 3050-DELETE-ACTQ.
 13264
 13265* EXEC CICS READNEXT
 13266*         DATASET  (ACTQ-FILE-ID)
 13267*         RIDFLD   (ACTQ-KEY)
 13268*         INTO     (ACTIVITY-QUE)
 13269*    END-EXEC.
 13270     MOVE LENGTH OF
 13271      ACTIVITY-QUE
 13272       TO DFHEIV12
 13273     MOVE 0
 13274       TO DFHEIV11
 13275*    MOVE '&.IL                  )   #00011328' TO DFHEIV0
 13276     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13277     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13278     MOVE X'2020233030303131333238' TO DFHEIV0(25:11)
 13279     CALL 'kxdfhei1' USING DFHEIV0,
 13280           ACTQ-FILE-ID,
 13281           ACTIVITY-QUE,
 13282           DFHEIV12,
 13283           ACTQ-KEY,
 13284           DFHEIV99,
 13285           DFHEIV11,
 13286           DFHEIV99,
 13287           DFHEIV99
 13288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13289
 13290
 13291     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13292         GO TO 3050-EXIT.
 13293
 13294
 13295* EXEC CICS ENDBR
 13296*         DATASET  (ACTQ-FILE-ID)
 13297*    END-EXEC.
 13298     MOVE 0
 13299       TO DFHEIV11
 13300*    MOVE '&2                    $   #00011337' TO DFHEIV0
 13301     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13302     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13303     MOVE X'2020233030303131333337' TO DFHEIV0(25:11)
 13304     CALL 'kxdfhei1' USING DFHEIV0,
 13305           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 250
* EL131.cbl
 13306           DFHEIV11,
 13307           DFHEIV99
 13308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13309
 13310
 13311
 13312* EXEC CICS DELETE
 13313*         DATASET   (ACTQ-FILE-ID)
 13314*         RIDFLD    (ACTQ-KEY)
 13315*    END-EXEC.
 13316*    MOVE '&(  R                 &   #00011341' TO DFHEIV0
 13317     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13318     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13319     MOVE X'2020233030303131333431' TO DFHEIV0(25:11)
 13320     CALL 'kxdfhei1' USING DFHEIV0,
 13321           ACTQ-FILE-ID,
 13322           ACTQ-KEY,
 13323           DFHEIV99,
 13324           DFHEIV99,
 13325           DFHEIV99
 13326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13327
 13328
 13329
 13330* EXEC CICS STARTBR
 13331*         DATASET   (ACTQ-FILE-ID)
 13332*         RIDFLD    (ACTQ-KEY)
 13333*    END-EXEC.
 13334     MOVE 0
 13335       TO DFHEIV11
 13336*    MOVE '&,         G          &   #00011346' TO DFHEIV0
 13337     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13338     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13339     MOVE X'2020233030303131333436' TO DFHEIV0(25:11)
 13340     CALL 'kxdfhei1' USING DFHEIV0,
 13341           ACTQ-FILE-ID,
 13342           ACTQ-KEY,
 13343           DFHEIV99,
 13344           DFHEIV11,
 13345           DFHEIV99
 13346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13347
 13348
 13349     GO TO 3050-DELETE-ACTQ.
 13350
 13351 3050-EXIT.
 13352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 251
* EL131.cbl
 13354 3060-READ-TRLR.
 13355
 13356* EXEC CICS HANDLE CONDITION
 13357*         NOTFND    (3060-EXIT)
 13358*         ENDFILE   (3060-EXIT)
 13359*    END-EXEC.
 13360*    MOVE '"$I''                  ! @ #00011357' TO DFHEIV0
 13361     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13363     MOVE X'4020233030303131333537' TO DFHEIV0(25:11)
 13364     CALL 'kxdfhei1' USING DFHEIV0
 13365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13366
 13367
 13368 3060-LOOP.
 13369
 13370* EXEC CICS READNEXT
 13371*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13372*         DATASET  (TRLR-FILE-ID)
 13373*         RIDFLD   (TRLR-KEY)
 13374*    END-EXEC.
 13375     MOVE 0
 13376       TO DFHEIV11
 13377*    MOVE '&.S                   )   #00011363' TO DFHEIV0
 13378     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13379     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13380     MOVE X'2020233030303131333633' TO DFHEIV0(25:11)
 13381     CALL 'kxdfhei1' USING DFHEIV0,
 13382           TRLR-FILE-ID,
 13383           DFHEIV20,
 13384           DFHEIV99,
 13385           TRLR-KEY,
 13386           DFHEIV99,
 13387           DFHEIV11,
 13388           DFHEIV99,
 13389           DFHEIV99
 13390     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13391         DFHEIV20
 13392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13393
 13394
 13395     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13396         GO TO 3060-EXIT.
 13397
 13398     IF FORM-CONTROL-TR
 13399         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13400             NEXT SENTENCE
 13401         ELSE
 13402             MOVE 'X'            TO ERROR-SWITCH
 13403             GO TO 3060-EXIT
 13404     ELSE
 13405         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13406            MOVE 'X'                 TO ERROR-SWITCH
 13407            GO TO 3060-EXIT.
 13408
 13409     GO TO 3060-LOOP.
 13410
 13411 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 252
* EL131.cbl
 13412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 253
* EL131.cbl
 13414 3997-GET-ERPDEF.
 13415
 13416     move cl-company-cd          to cert-company-code
 13417     move cl-cert-key-data       to cert-key (2:21)
 13418     move cl-cert-no             to cert-cert
 13419
 13420
 13421* EXEC CICS READ
 13422*        DATASET   (CERT-FILE-ID)
 13423*        RIDFLD    (CERT-KEY)
 13424*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13425*        resp      (ws-response)
 13426*    END-EXEC
 13427*    MOVE '&"S        E          (  N#00011394' TO DFHEIV0
 13428     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13430     MOVE X'204E233030303131333934' TO DFHEIV0(25:11)
 13431     CALL 'kxdfhei1' USING DFHEIV0,
 13432           CERT-FILE-ID,
 13433           DFHEIV20,
 13434           DFHEIV99,
 13435           CERT-KEY,
 13436           DFHEIV99,
 13437           DFHEIV99,
 13438           DFHEIV99
 13439     SET ADDRESS OF CERTIFICATE-MASTER TO
 13440         DFHEIV20
 13441     MOVE EIBRESP  TO ws-response
 13442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13443
 13444     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 13445                                    WS-ERPDEF-SW
 13446     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13447                                    WS-CRIT-PER-RTW-MOS
 13448
 13449     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13450     MOVE CM-STATE               TO ERPDEF-STATE
 13451     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13452     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 13453     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
 13454     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13455     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13456
 13457
 13458* EXEC CICS STARTBR
 13459*        DATASET  ('ERPDEF')
 13460*        RIDFLD   (ERPDEF-KEY)
 13461*        GTEQ
 13462*        RESP     (WS-RESPONSE)
 13463*    END-EXEC
 13464     MOVE 'ERPDEF' TO DFHEIV1
 13465     MOVE 0
 13466       TO DFHEIV11
 13467*    MOVE '&,         G          &  N#00011414' TO DFHEIV0
 13468     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13469     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13470     MOVE X'204E233030303131343134' TO DFHEIV0(25:11)
 13471     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 254
* EL131.cbl
 13472           DFHEIV1,
 13473           ERPDEF-KEY,
 13474           DFHEIV99,
 13475           DFHEIV11,
 13476           DFHEIV99
 13477     MOVE EIBRESP  TO WS-RESPONSE
 13478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13479
 13480     IF WS-RESP-NORMAL
 13481
 13482* EXEC CICS READNEXT
 13483*          DATASET  ('ERPDEF')
 13484*          INTO     (PRODUCT-MASTER)
 13485*          RIDFLD   (ERPDEF-KEY)
 13486*          RESP     (WS-RESPONSE)
 13487*       END-EXEC
 13488     MOVE LENGTH OF
 13489      PRODUCT-MASTER
 13490       TO DFHEIV12
 13491     MOVE 'ERPDEF' TO DFHEIV1
 13492     MOVE 0
 13493       TO DFHEIV11
 13494*    MOVE '&.IL                  )  N#00011422' TO DFHEIV0
 13495     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13496     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13497     MOVE X'204E233030303131343232' TO DFHEIV0(25:11)
 13498     CALL 'kxdfhei1' USING DFHEIV0,
 13499           DFHEIV1,
 13500           PRODUCT-MASTER,
 13501           DFHEIV12,
 13502           ERPDEF-KEY,
 13503           DFHEIV99,
 13504           DFHEIV11,
 13505           DFHEIV99,
 13506           DFHEIV99
 13507     MOVE EIBRESP  TO WS-RESPONSE
 13508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13509        IF WS-RESP-NORMAL
 13510           IF (ERPDEF-KEY-SAVE (1:16) =
 13511              PD-CONTROL-PRIMARY (1:16))
 13512              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13513              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13514                 (A1 > +8)
 13515                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13516              END-PERFORM
 13517              IF A1 < +9
 13518                 SET ERPDEF-FOUND TO TRUE
 13519                 MOVE PD-CRIT-PERIOD (A1)
 13520                              TO WS-CRITICAL-PERIOD
 13521                 MOVE PD-REC-CRIT-PERIOD (A1)
 13522                              TO WS-CRIT-PER-RECURRENT
 13523                 IF PD-RTW-MOS (A1) NUMERIC
 13524                    MOVE PD-RTW-MOS (A1)
 13525                              TO WS-CRIT-PER-RTW-MOS
 13526                 ELSE
 13527                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13528                 END-IF
 13529                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 255
* EL131.cbl
 13530                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13531                                 TO WS-EXCL-PERIOD
 13532                 END-IF
 13533                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 13534                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 13535                                 TO WS-COV-ENDS
 13536                 END-IF
 13537                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 13538                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 13539                                 TO WS-ACC-PERIOD
 13540                 END-IF
 13541              END-IF
 13542           END-IF
 13543        END-IF
 13544     END-IF
 13545
 13546     .
 13547 3997-EXIT.
 13548     EXIT.
 13549 4000-FORCE-ERRORS.
 13550     IF PI-RETURN-CD-1 = 'X'
 13551         MOVE ER-0311            TO EMI-ERROR
 13552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13553         MOVE -1                 TO MAINTL
 13554         GO TO 8110-SEND-DATA.
 13555
 13556     IF NOT FORCE-CAP
 13557         MOVE ER-0416            TO EMI-ERROR
 13558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13559         MOVE -1                 TO MAINTL
 13560         GO TO 8110-SEND-DATA.
 13561
 13562     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 13563     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 13564     IF EMI-FATAL-CTR GREATER THAN ZERO
 13565         GO TO 4000-FATAL-ERRORS.
 13566
 13567     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 13568
 13569     IF EMI-FATAL-CTR GREATER THAN ZERO
 13570         GO TO 4000-FATAL-ERRORS.
 13571
 13572     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 13573
 13574     IF EMI-FATAL-CTR GREATER THAN ZERO
 13575         GO TO 4000-FATAL-ERRORS.
 13576
 13577     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 13578     MOVE AL-UANOF               TO CERTA.
 13579     MOVE ER-0000 TO EMI-ERROR.
 13580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13581
 13582 4000-FATAL-ERRORS.
 13583     MOVE -1                     TO MAINTL.
 13584     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 256
* EL131.cbl
 13586
 13587 4100-SAVE-CHANGES.
 13588     IF MAINTL > 0
 13589         MOVE MAINTI  TO WS-SAVE-MAINTI
 13590         MOVE MAINTL  TO WS-SAVE-MAINTL
 13591     END-IF
 13592     IF STATUSL > 0
 13593         MOVE STATUSI  TO WS-SAVE-STATUSI
 13594         MOVE STATUSL  TO WS-SAVE-STATUSL
 13595     END-IF
 13596     IF REPL > 0
 13597         MOVE REPI  TO WS-SAVE-REPI
 13598         MOVE REPL  TO WS-SAVE-REPL
 13599     END-IF
 13600*    IF CAUSEL > 0
 13601*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 13602*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 13603*    END-IF
 13604*    IF ENDL > 0
 13605*        MOVE ENDI  TO WS-SAVE-ENDI
 13606*        MOVE ENDL  TO WS-SAVE-ENDL
 13607*    END-IF
 13608     IF DIAGL > 0
 13609         MOVE DIAGI  TO WS-SAVE-DIAGI
 13610         MOVE DIAGL  TO WS-SAVE-DIAGL
 13611     END-IF
 13612     IF ICD1L > 0
 13613         MOVE ICD1I  TO WS-SAVE-ICD1I
 13614         MOVE ICD1L  TO WS-SAVE-ICD1L
 13615     END-IF
 13616     IF ICD2L > 0
 13617         MOVE ICD2I  TO WS-SAVE-ICD2I
 13618         MOVE ICD2L  TO WS-SAVE-ICD2L
 13619     END-IF
 13620     IF BENEL > 0
 13621         MOVE BENEI  TO WS-SAVE-BENEI
 13622         MOVE BENEL  TO WS-SAVE-BENEL
 13623     END-IF
 13624     IF BIRTHL > 0
 13625         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 13626         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 13627     END-IF
 13628     IF SOCIALL > 0
 13629         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 13630         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 13631     END-IF
 13632     IF SEXL > 0
 13633         MOVE SEXI  TO WS-SAVE-SEXI
 13634         MOVE SEXL  TO WS-SAVE-SEXL
 13635     END-IF
 13636     IF MLNAMEL > 0
 13637         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 13638         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 13639     END-IF
 13640     IF MFNAMEL > 0
 13641         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 13642         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 13643     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 257
* EL131.cbl
 13644     IF MMINITL > 0
 13645         MOVE MMINITI  TO WS-SAVE-MMINITI
 13646         MOVE MMINITL  TO WS-SAVE-MMINITL
 13647     END-IF
 13648     IF LOANNOL > 0
 13649         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 13650         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 13651     END-IF
 13652     IF LOANBALL > 0
 13653         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 13654         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 13655     END-IF
 13656     IF PROCL > 0
 13657         MOVE PROCI  TO WS-SAVE-PROCI
 13658         MOVE PROCL  TO WS-SAVE-PROCL
 13659     END-IF
 13660     IF SUPVL > 0
 13661         MOVE SUPVI  TO WS-SAVE-SUPVI
 13662         MOVE SUPVL  TO WS-SAVE-SUPVL
 13663     END-IF
 13664     IF PRICDL > 0
 13665         MOVE PRICDI  TO WS-SAVE-PRICDI
 13666         MOVE PRICDL  TO WS-SAVE-PRICDL
 13667     END-IF
 13668     IF FILETOL > 0
 13669         MOVE FILETOI  TO WS-SAVE-FILETOI
 13670         MOVE FILETOL  TO WS-SAVE-FILETOL
 13671     END-IF
 13672     IF PDTHRUL > 0
 13673         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 13674         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 13675     END-IF
 13676     IF PDAMTL > 0
 13677         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 13678         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 13679     END-IF
 13680     IF NODAYSL > 0
 13681         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 13682         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 13683     END-IF
 13684     IF NOPMTSL > 0
 13685         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 13686         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 13687     END-IF
 13688     IF FORMTYPL > 0
 13689         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 13690         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 13691     END-IF
 13692     IF OCCL > 0
 13693         MOVE OCCI  TO WS-SAVE-OCCI
 13694         MOVE OCCL  TO WS-SAVE-OCCL
 13695     END-IF.
 13696 4100-EXIT.
 13697      EXIT.
 13698
 13699 4200-LOAD-CHANGES.
 13700     IF WS-SAVE-MAINTL > 0
 13701         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 258
* EL131.cbl
 13702         MOVE WS-SAVE-MAINTL  TO MAINTL
 13703         MOVE AL-UANON        TO MAINTA
 13704     END-IF
 13705     IF WS-SAVE-STATUSL > 0
 13706         MOVE WS-SAVE-STATUSI  TO STATUSI
 13707         MOVE WS-SAVE-STATUSL  TO STATUSL
 13708         MOVE AL-UANON         TO STATUSA
 13709     END-IF
 13710     IF WS-SAVE-REPL > 0
 13711         MOVE WS-SAVE-REPI  TO REPI
 13712         MOVE WS-SAVE-REPL  TO REPL
 13713         MOVE AL-UANON      TO REPA
 13714     END-IF
 13715*    IF WS-SAVE-CAUSEL > 0
 13716*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 13717*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 13718*        MOVE AL-UANON        TO CAUSEA
 13719*    END-IF
 13720*    IF WS-SAVE-ENDL > 0
 13721*        MOVE WS-SAVE-ENDI  TO ENDI
 13722*        MOVE WS-SAVE-ENDL  TO ENDL
 13723*        MOVE AL-UANON      TO ENDA
 13724*    END-IF
 13725     IF WS-SAVE-DIAGL > 0
 13726         MOVE WS-SAVE-DIAGI  TO DIAGI
 13727         MOVE WS-SAVE-DIAGL  TO DIAGL
 13728         MOVE AL-UANON       TO DIAGA
 13729     END-IF
 13730     IF WS-SAVE-ICD1L > 0
 13731         MOVE WS-SAVE-ICD1I  TO ICD1I
 13732         MOVE WS-SAVE-ICD1L  TO ICD1L
 13733         MOVE AL-UANON       TO ICD1A
 13734     END-IF
 13735     IF WS-SAVE-ICD2L > 0
 13736         MOVE WS-SAVE-ICD2I  TO ICD2I
 13737         MOVE WS-SAVE-ICD2L  TO ICD2L
 13738         MOVE AL-UANON       TO ICD2A
 13739     END-IF
 13740     IF WS-SAVE-BENEL > 0
 13741         MOVE WS-SAVE-BENEI  TO BENEI
 13742         MOVE WS-SAVE-BENEL  TO BENEL
 13743         MOVE AL-UANON       TO BENEA
 13744     END-IF
 13745     IF WS-SAVE-BIRTHL > 0
 13746         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 13747         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 13748         MOVE AL-UANON        TO BIRTHA
 13749     END-IF
 13750     IF WS-SAVE-SOCIALL > 0
 13751         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 13752         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 13753         MOVE AL-UANON         TO SOCIALA
 13754     END-IF
 13755     IF WS-SAVE-SEXL > 0
 13756         MOVE WS-SAVE-SEXI  TO SEXI
 13757         MOVE WS-SAVE-SEXL  TO SEXL
 13758         MOVE AL-UANON      TO SEXA
 13759     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 259
* EL131.cbl
 13760     IF WS-SAVE-MLNAMEL > 0
 13761         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 13762         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 13763         MOVE AL-UANON         TO MLNAMEA
 13764     END-IF
 13765     IF WS-SAVE-MFNAMEL > 0
 13766         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 13767         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 13768         MOVE AL-UANON         TO MFNAMEA
 13769     END-IF
 13770     IF WS-SAVE-MMINITL > 0
 13771         MOVE WS-SAVE-MMINITI  TO MMINITI
 13772         MOVE WS-SAVE-MMINITL  TO MMINITL
 13773         MOVE AL-UANON         TO MMINITA
 13774     END-IF
 13775     IF WS-SAVE-LOANNOL > 0
 13776         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 13777         MOVE WS-SAVE-LOANNOL  TO LOANNOL
 13778         MOVE AL-UANON         TO LOANNOA
 13779     END-IF
 13780     IF WS-SAVE-LOANBALL > 0
 13781         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 13782         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 13783         MOVE AL-UANON          TO LOANBALA
 13784     END-IF
 13785     IF WS-SAVE-PROCL > 0
 13786         MOVE WS-SAVE-PROCI  TO PROCI
 13787         MOVE WS-SAVE-PROCL  TO PROCL
 13788         MOVE AL-UANON       TO PROCA
 13789     END-IF
 13790     IF WS-SAVE-SUPVL > 0
 13791         MOVE WS-SAVE-SUPVI  TO SUPVI
 13792         MOVE WS-SAVE-SUPVL  TO SUPVL
 13793         MOVE AL-UANON       TO SUPVA
 13794     END-IF
 13795     IF WS-SAVE-PRICDL > 0
 13796         MOVE WS-SAVE-PRICDI  TO PRICDI
 13797         MOVE WS-SAVE-PRICDL  TO PRICDL
 13798         MOVE AL-UANON        TO PRICDA
 13799     END-IF
 13800     IF WS-SAVE-FILETOL > 0
 13801         MOVE WS-SAVE-FILETOI  TO FILETOI
 13802         MOVE WS-SAVE-FILETOL  TO FILETOL
 13803         MOVE AL-UANON         TO FILETOA
 13804     END-IF
 13805     IF WS-SAVE-PDTHRUL > 0
 13806         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 13807         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 13808         MOVE AL-UANON         TO PDTHRUA
 13809     END-IF
 13810     IF WS-SAVE-PDAMTL > 0
 13811         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 13812         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 13813         MOVE AL-UANON        TO PDAMTA
 13814     END-IF
 13815     IF WS-SAVE-NODAYSL > 0
 13816         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 13817         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 260
* EL131.cbl
 13818         MOVE AL-UANON         TO NODAYSA
 13819     END-IF
 13820     IF WS-SAVE-NOPMTSL > 0
 13821         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 13822         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 13823         MOVE AL-UANON         TO NOPMTSA
 13824     END-IF
 13825     IF WS-SAVE-FORMTYPL > 0
 13826         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 13827         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 13828         MOVE AL-UANON          TO FORMTYPA
 13829     END-IF
 13830     IF WS-SAVE-OCCL > 0
 13831         MOVE WS-SAVE-OCCI  TO OCCI
 13832         MOVE WS-SAVE-OCCL  TO OCCL
 13833         MOVE AL-UANON      TO OCCA
 13834     END-IF.
 13835 4200-EXIT.
 13836      EXIT.
 13837
 13838 5000-BUILD-MAP.
 13839     IF PI-RETURN-CD-1 = SPACE
 13840         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 13841
 13842     MOVE SPACE                  TO PI-RETURN-CD-1.
 13843
 13844     MOVE LOW-VALUES             TO EL131AI.
 13845
 13846     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 13847     MOVE PI-CARRIER             TO CARRIER-CODE.
 13848     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 13849     MOVE PI-CERT-NO             TO CERT-NO.
 13850
 13851 5000-READ-CLAIM-MASTER.
 13852
 13853
 13854* EXEC CICS READ
 13855*         SET      (ADDRESS OF CLAIM-MASTER)
 13856*         DATASET  (CLMS-FILE-ID)
 13857*         RIDFLD   (MSTR-KEY)
 13858*    END-EXEC.
 13859*    MOVE '&"S        E          (   #00011772' TO DFHEIV0
 13860     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13861     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13862     MOVE X'2020233030303131373732' TO DFHEIV0(25:11)
 13863     CALL 'kxdfhei1' USING DFHEIV0,
 13864           CLMS-FILE-ID,
 13865           DFHEIV20,
 13866           DFHEIV99,
 13867           MSTR-KEY,
 13868           DFHEIV99,
 13869           DFHEIV99,
 13870           DFHEIV99
 13871     SET ADDRESS OF CLAIM-MASTER TO
 13872         DFHEIV20
 13873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13874
 13875
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 261
* EL131.cbl
 13876     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 13877
 13878 5000-READ-DIAGNOSIS-TRAILER.
 13879
 13880
 13881* EXEC CICS HANDLE CONDITION
 13882*         NOTFND (5000-TRLR-NOT-FOUND)
 13883*    END-EXEC.
 13884*    MOVE '"$I                   ! A #00011782' TO DFHEIV0
 13885     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13887     MOVE X'4120233030303131373832' TO DFHEIV0(25:11)
 13888     CALL 'kxdfhei1' USING DFHEIV0
 13889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13890
 13891
 13892     MOVE MSTR-KEY               TO TRLR-KEY.
 13893     MOVE NINETY                 TO TRLR-SEQ-NO.
 13894
 13895
 13896* EXEC CICS READ
 13897*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13898*         DATASET  (TRLR-FILE-ID)
 13899*         RIDFLD   (TRLR-KEY)
 13900*    END-EXEC.
 13901*    MOVE '&"S        E          (   #00011789' TO DFHEIV0
 13902     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13904     MOVE X'2020233030303131373839' TO DFHEIV0(25:11)
 13905     CALL 'kxdfhei1' USING DFHEIV0,
 13906           TRLR-FILE-ID,
 13907           DFHEIV20,
 13908           DFHEIV99,
 13909           TRLR-KEY,
 13910           DFHEIV99,
 13911           DFHEIV99,
 13912           DFHEIV99
 13913     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13914         DFHEIV20
 13915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13916
 13917
 13918     MOVE AT-INFO-LINE-1         TO DIAGO.
 13919     MOVE AT-ICD-CODE-1          TO ICD1O.
 13920     MOVE AT-ICD-CODE-2          TO ICD2O.
 13921
 13922 5000-READ-CERTIFICATE-MASTER.
 13923
 13924     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 13925     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 13926     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 13927     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 13928     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 13929     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 13930     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 13931
 13932
 13933* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 262
* EL131.cbl
 13934*         NOTFND (5000-CERT-NOT-FOUND)
 13935*    END-EXEC.
 13936*    MOVE '"$I                   ! B #00011809' TO DFHEIV0
 13937     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13939     MOVE X'4220233030303131383039' TO DFHEIV0(25:11)
 13940     CALL 'kxdfhei1' USING DFHEIV0
 13941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13942
 13943
 13944
 13945* EXEC CICS READ
 13946*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13947*         DATASET  (CERT-FILE-ID)
 13948*         RIDFLD   (CERT-KEY)
 13949*    END-EXEC.
 13950*    MOVE '&"S        E          (   #00011813' TO DFHEIV0
 13951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13953     MOVE X'2020233030303131383133' TO DFHEIV0(25:11)
 13954     CALL 'kxdfhei1' USING DFHEIV0,
 13955           CERT-FILE-ID,
 13956           DFHEIV20,
 13957           DFHEIV99,
 13958           CERT-KEY,
 13959           DFHEIV99,
 13960           DFHEIV99,
 13961           DFHEIV99
 13962     SET ADDRESS OF CERTIFICATE-MASTER TO
 13963         DFHEIV20
 13964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13965
 13966
 13967     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 13968     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 13969
 13970     GO TO 5000-EXIT.
 13971
 13972 5000-TRLR-NOT-FOUND.
 13973     MOVE ER-7687                TO EMI-ERROR.
 13974     MOVE -1                     TO DIAGL.
 13975     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13976     GO TO 5000-EXIT.
 13977
 13978 5000-CERT-NOT-FOUND.
 13979     MOVE ER-0206                TO EMI-ERROR.
 13980     MOVE -1                     TO CERTL.
 13981     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13982
 13983 5000-EXIT.
 13984     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 263
* EL131.cbl
 13986 5010-RESET-PI-AREA.
 13987     IF CERTI GREATER THAN LOW-VALUES
 13988         MOVE CERTI              TO PI-CERT-PRIME.
 13989
 13990     IF SUFXI GREATER THAN LOW-VALUES
 13991         MOVE SUFXI              TO PI-CERT-SFX.
 13992
 13993     IF CERTEFFI GREATER THAN LOW-VALUES
 13994         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 13995
 13996     IF CERTACTI GREATER THAN LOW-VALUES
 13997         MOVE CERTACTI           TO PI-ACCOUNT.
 13998
 13999     IF CERTSTI GREATER THAN LOW-VALUES
 14000         MOVE CERTSTI            TO PI-STATE.
 14001
 14002     IF CERTCARI GREATER THAN LOW-VALUES
 14003         MOVE CERTCARI           TO PI-CARRIER.
 14004
 14005     IF CERTGRPI GREATER THAN LOW-VALUES
 14006         MOVE CERTGRPI           TO PI-GROUPING.
 14007
 14008 5010-EXIT.
 14009     EXIT.
 14010
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 264
* EL131.cbl
 14012 5020-MOVE-MSTR.
 14013
 14014     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14015     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14016     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14017     MOVE AL-SABON               TO SEQUA.
 14018     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14019     MOVE CL-CLAIM-TYPE          TO TYPEO
 14020                                    pi-claim-type
 14021
 14022     IF CL-TOTAL-PAID-AMT  = +0 AND
 14023        CL-LAST-PMT-AMT    = +0 AND
 14024        CL-NO-OF-PMTS-MADE = +0
 14025          MOVE AL-UANON          TO TYPEA.
 14026
 14027     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14028     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14029     MOVE CL-CERT-PRIME          TO CERTO.
 14030     MOVE CL-CERT-SFX            TO SUFXO.
 14031     MOVE CL-CERT-CARRIER        TO CARRO.
 14032
 14033     IF CL-CLAIM-STATUS = 'C'
 14034         MOVE 'CLOSED'           TO STATUSO
 14035     ELSE
 14036         MOVE 'OPEN  '           TO STATUSO.
 14037
 14038     move cl-accident-claim-sw   to accswo
 14039     MOVE CL-PROCESSOR-ID        TO PROCO.
 14040
 14041     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14042     MOVE CL-CCN                 TO CCNOO.
 14043
 14044     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14045     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14046     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14047     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14048
 14049     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14050         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14051         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14052         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14053         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14054     ELSE
 14055         MOVE SPACES             TO BIRTHO.
 14056
 14057     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14058        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14059         NEXT SENTENCE
 14060       ELSE
 14061         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14062
 14063     IF PI-COMPANY-ID = 'DMD'
 14064       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 14065          IF SOCIALO = SPACES OR LOW-VALUES
 14066            MOVE ER-0885         TO EMI-ERROR
 14067            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14068
 14069     MOVE CL-INSURED-OCC-CD      TO OCCO.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 265
* EL131.cbl
 14070*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14071
 14072*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14073*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14074*        MOVE SPACES                 TO DC-OPTION-CODE
 14075*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14076*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14077*    ELSE
 14078*        MOVE SPACES             TO ENDO.
 14079
 14080     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14081        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14082        MOVE SPACES             TO DC-OPTION-CODE
 14083        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14084        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14085        IF PI-USES-PAID-TO
 14086           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14087           MOVE '6'                TO DC-OPTION-CODE
 14088           MOVE +1                 TO DC-ELAPSED-DAYS
 14089           MOVE +0                 TO DC-ELAPSED-MONTHS
 14090           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14091           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14092        ELSE
 14093           NEXT SENTENCE
 14094     ELSE
 14095        MOVE SPACES             TO PDTHRUO.
 14096
 14097     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14098     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14099     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14100     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14101
 14102     IF MODIFY-CAP
 14103        MOVE AL-UNNOF            TO PDAMTA
 14104                                    NODAYSA
 14105                                    NOPMTSA
 14106        MOVE AL-UANOF            TO PDTHRUA.
 14107     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14108     MOVE '2'                    TO CNTL-REC-TYPE
 14109     MOVE +0                     TO CNTL-SEQ-NO
 14110     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14111
 14112
 14113* EXEC CICS READ
 14114*         DATASET  (CNTL-FILE-ID)
 14115*         SET      (ADDRESS OF CONTROL-FILE)
 14116*         RIDFLD   (CNTL-KEY)
 14117*         RESP     (WS-RESPONSE)
 14118*    END-EXEC
 14119*    MOVE '&"S        E          (  N#00011964' TO DFHEIV0
 14120     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14122     MOVE X'204E233030303131393634' TO DFHEIV0(25:11)
 14123     CALL 'kxdfhei1' USING DFHEIV0,
 14124           CNTL-FILE-ID,
 14125           DFHEIV20,
 14126           DFHEIV99,
 14127           CNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 266
* EL131.cbl
 14128           DFHEIV99,
 14129           DFHEIV99,
 14130           DFHEIV99
 14131     SET ADDRESS OF CONTROL-FILE TO
 14132         DFHEIV20
 14133     MOVE EIBRESP  TO WS-RESPONSE
 14134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14135
 14136     IF WS-RESP-NORMAL
 14137        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14138     end-if
 14139     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14140         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14141         MOVE SPACES             TO DC-OPTION-CODE
 14142         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14143         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14144     ELSE
 14145         MOVE SPACES             TO INCO.
 14146
 14147     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14148        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14149        MOVE AL-UANOF            TO INCA
 14150     end-if
 14151     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14152
 14153     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14154         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14155         MOVE SPACES             TO DC-OPTION-CODE
 14156         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14157         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14158     ELSE
 14159         MOVE SPACES             TO REPO.
 14160
 14161     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14162         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14163         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14164         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14165         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14166     ELSE
 14167         MOVE SPACES             TO ESTO.
 14168
 14169     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14170         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14171         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14172         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14173         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14174     ELSE
 14175         MOVE SPACES             TO MNTDTO.
 14176
 14177
 14178     IF CL-LAST-MAINT-TYPE = SPACE
 14179         MOVE 'SET-UP'           TO MNTTYPEO
 14180     ELSE
 14181     IF CL-LAST-MAINT-TYPE = '1'
 14182         MOVE 'PAYMNT'           TO MNTTYPEO
 14183     ELSE
 14184     IF CL-LAST-MAINT-TYPE = '2'
 14185         MOVE 'LETTER'           TO MNTTYPEO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 267
* EL131.cbl
 14186     ELSE
 14187     IF CL-LAST-MAINT-TYPE = '3'
 14188         MOVE 'UPDATE'           TO MNTTYPEO
 14189     ELSE
 14190     IF CL-LAST-MAINT-TYPE = '4'
 14191         MOVE 'RESTOR'           TO MNTTYPEO
 14192     ELSE
 14193     IF CL-LAST-MAINT-TYPE = '5'
 14194         MOVE 'INC DT'           TO MNTTYPEO
 14195     ELSE
 14196     IF CL-LAST-MAINT-TYPE = '6'
 14197         MOVE ' CONV'            TO MNTTYPEO
 14198     ELSE
 14199     IF CL-LAST-MAINT-TYPE = 'C'
 14200         MOVE 'CHGBEN'           TO MNTTYPEO
 14201     ELSE
 14202     IF CL-LAST-MAINT-TYPE = 'E'
 14203         MOVE 'ERRCOR'           TO MNTTYPEO
 14204     ELSE
 14205         MOVE SPACES             TO MNTTYPEO.
 14206
 14207     MOVE CL-BENEFICIARY         TO BENEO.
 14208     MOVE CL-FILE-LOCATION       TO FILETOO.
 14209     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14210        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14211     END-IF
 14212     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14213     MOVE CL-CRIT-PER-RECURRENT
 14214                                 TO CRITPTO
 14215     IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14216        MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14217     END-IF
 14218     MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14219     MOVE CL-PRIORITY-CD         TO PRICDO.
 14220     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14221     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14222     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14223     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14224
 14225 5020-EXIT.
 14226     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 268
* EL131.cbl
 14228 5030-MOVE-CERT.
 14229
 14230     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14231         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14232         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14233         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14234         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14235       ELSE
 14236         MOVE SPACES             TO CERTEFFO
 14237         MOVE ZERO               TO HOLD-DATE.
 14238
 14239     MOVE CM-ACCOUNT             TO CERTACTO.
 14240     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14241     MOVE CM-GROUPING            TO CERTGRPO.
 14242     MOVE CM-CARRIER             TO CERTCARO.
 14243     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14244     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14245     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14246     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14247     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14248     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14249     MOVE CM-JT-INITIAL          TO JNTINITO.
 14250     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14251
 14252*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14253     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14254     MOVE '3'                    TO CNTL-REC-TYPE.
 14255     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14256     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14257     MOVE ZERO                   TO CNTL-SEQ-NO.
 14258
 14259
 14260* EXEC CICS READ
 14261*         SET        (ADDRESS OF CONTROL-FILE)
 14262*         DATASET    ('ELCNTL')
 14263*         RIDFLD     (CNTL-KEY)
 14264*         RESP       (WS-RESPONSE)
 14265*    END-EXEC.
 14266     MOVE 'ELCNTL' TO DFHEIV1
 14267*    MOVE '&"S        E          (  N#00012094' TO DFHEIV0
 14268     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14269     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14270     MOVE X'204E233030303132303934' TO DFHEIV0(25:11)
 14271     CALL 'kxdfhei1' USING DFHEIV0,
 14272           DFHEIV1,
 14273           DFHEIV20,
 14274           DFHEIV99,
 14275           CNTL-KEY,
 14276           DFHEIV99,
 14277           DFHEIV99,
 14278           DFHEIV99
 14279     SET ADDRESS OF CONTROL-FILE TO
 14280         DFHEIV20
 14281     MOVE EIBRESP  TO WS-RESPONSE
 14282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14283
 14284
 14285     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 269
* EL131.cbl
 14286        MOVE ZERO                TO CP-FREE-LOOK
 14287     ELSE
 14288        MOVE CF-ST-FREE-LOOK-PERIOD
 14289                                 TO CP-FREE-LOOK.
 14290
 14291     IF CM-LF-BENEFIT-CD = '00'
 14292        GO TO 5030-MOVE-CERT-AH.
 14293
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 270
* EL131.cbl
 14295     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14296     MOVE '5'                    TO DC-OPTION-CODE
 14297     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14298     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14299     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14300     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14301     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 14302     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14303     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14304     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 14305     MOVE '4'                    TO CP-REM-TERM-METHOD
 14306     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 14307     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14308     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14309
 14310     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14311     IF CM-LF-PREMIUM-RATE NUMERIC
 14312         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14313     ELSE
 14314         MOVE ZEROS              TO LCVRATEO.
 14315
 14316     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14317         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 14318
 14319     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 14320
 14321     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 14322
 14323     IF CM-LF-CURRENT-STATUS = '8'
 14324        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14325            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14326            MOVE ' '             TO DC-OPTION-CODE
 14327            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14328            IF NOT DATE-CONVERSION-ERROR
 14329                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14330
 14331     IF CM-LF-CURRENT-STATUS = '7'
 14332        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14333            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 14334            MOVE ' '             TO DC-OPTION-CODE
 14335            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14336            IF NOT DATE-CONVERSION-ERROR
 14337                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14338
 14339     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14340         MOVE ' '                TO DC-OPTION-CODE
 14341         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 14342         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14343         IF NOT DATE-CONVERSION-ERROR
 14344             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 14345             MOVE HOLD-MONTH     TO WORK-MONTH
 14346             MOVE HOLD-YEAR      TO WORK-YEAR
 14347             MOVE WORK-DATE-MY   TO LCVEXITO.
 14348
 14349     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14350        IF CP-REMAINING-TERM-3 = ZEROS
 14351           MOVE 'EXPIRED'        TO LCVSTATO
 14352        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 271
* EL131.cbl
 14353           MOVE 'ACTIVE'         TO LCVSTATO.
 14354
 14355     IF CM-LF-CURRENT-STATUS = '2'
 14356        MOVE 'PEND   '           TO LCVSTATO.
 14357     IF CM-LF-CURRENT-STATUS = '3'
 14358        MOVE 'RESTORE'           TO LCVSTATO.
 14359     IF CM-LF-CURRENT-STATUS = '5'
 14360        MOVE 'REISSUE'           TO LCVSTATO.
 14361     IF CM-LF-CURRENT-STATUS = '6'
 14362        MOVE 'LMP DIS'           TO LCVSTATO.
 14363     IF CM-LF-CURRENT-STATUS = '7'
 14364        MOVE 'DEATH  '           TO LCVSTATO.
 14365     IF CM-LF-CURRENT-STATUS = '8'
 14366        MOVE 'CANCEL '           TO LCVSTATO.
 14367     IF CM-LF-CURRENT-STATUS = '9'
 14368        MOVE 'RE-ONLY'           TO LCVSTATO.
 14369     IF CM-LF-CURRENT-STATUS = 'V'
 14370        MOVE 'VOID   '           TO LCVSTATO.
 14371     IF CM-LF-CURRENT-STATUS = 'D'
 14372        MOVE 'DECLINE'           TO LCVSTATO.
 14373
 14374     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14375     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14376     MOVE '4'                    TO BEN-REC-TYPE.
 14377     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 14378     MOVE ZERO                   TO BEN-SEQ-NO.
 14379
 14380
 14381* EXEC CICS READ GTEQ
 14382*         DATASET  (CNTL-FILE-ID)
 14383*         RIDFLD   (BENEFIT-KEY)
 14384*         SET      (ADDRESS OF CONTROL-FILE)
 14385*    END-EXEC.
 14386*    MOVE '&"S        G          (   #00012196' TO DFHEIV0
 14387     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14389     MOVE X'2020233030303132313936' TO DFHEIV0(25:11)
 14390     CALL 'kxdfhei1' USING DFHEIV0,
 14391           CNTL-FILE-ID,
 14392           DFHEIV20,
 14393           DFHEIV99,
 14394           BENEFIT-KEY,
 14395           DFHEIV99,
 14396           DFHEIV99,
 14397           DFHEIV99
 14398     SET ADDRESS OF CONTROL-FILE TO
 14399         DFHEIV20
 14400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14401
 14402
 14403     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14404        CF-RECORD-TYPE NOT = '4'
 14405         MOVE ER-0240            TO EMI-ERROR
 14406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14407         GO TO 5030-MOVE-CERT-FINISH.
 14408
 14409     MOVE ZERO                   TO COUNT-2.
 14410     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 272
* EL131.cbl
 14411
 14412     IF SCREEN-ERROR
 14413         MOVE ER-0282            TO EMI-ERROR
 14414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14415        ELSE
 14416         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 14417
 14418 5030-MOVE-CERT-AH.
 14419
 14420     IF CM-LF-BENEFIT-CD = '00'
 14421         IF CM-AH-BENEFIT-CD = '00'
 14422             GO TO 5030-MOVE-CERT-FINISH.
 14423
 14424     IF CM-AH-BENEFIT-CD = '00'
 14425        MOVE SPACES             TO ACVKINDO
 14426        COMPUTE PI-PAYMENT-AMT =
 14427                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 14428        GO TO 5030-MOVE-CERT-FINISH.
 14429
 14430     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14431     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 14432     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 14433     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 14434     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14435     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14436     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14437     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 14438
 14439**DMD **********************************************
 14440     IF PI-COMPANY-ID = 'DMD'
 14441         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 14442                                   CM-PMT-EXTENSION-DAYS
 14443         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 14444                                      CL-NO-OF-DAYS-PAID
 14445         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 14446             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 14447         MOVE WS-REM-MOS         TO ACVRTRMO
 14448                                    CP-REMAINING-TERM-3
 14449*        MOVE WS-REM-DAYS        TO DAYSPO
 14450         GO TO 5030-SKIP-RTRM.
 14451**DMD **********************************************
 14452
 14453     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14454     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14455     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14456     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14457
 14458 5030-SKIP-RTRM.
 14459     IF CM-AH-PREMIUM-RATE NUMERIC
 14460         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14461     ELSE
 14462         MOVE ZEROS              TO ACVRATEO.
 14463
 14464     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 14465     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 14466
 14467     IF CM-AH-CURRENT-STATUS = '8'
 14468        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 273
* EL131.cbl
 14469            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14470            MOVE ' '             TO DC-OPTION-CODE
 14471            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14472            IF NOT DATE-CONVERSION-ERROR
 14473                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14474
 14475     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14476        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14477            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 14478            MOVE ' '             TO DC-OPTION-CODE
 14479            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14480            IF NOT DATE-CONVERSION-ERROR
 14481                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14482
 14483     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14484        IF CP-REMAINING-TERM-3 = ZEROS
 14485           MOVE 'EXPIRED'        TO ACVSTATO
 14486        ELSE
 14487           MOVE 'ACTIVE'         TO ACVSTATO.
 14488
 14489     IF CM-AH-CURRENT-STATUS = '2'
 14490        MOVE 'PEND   '           TO ACVSTATO.
 14491     IF CM-AH-CURRENT-STATUS = '3'
 14492        MOVE 'RESTORE'           TO ACVSTATO.
 14493     IF CM-AH-CURRENT-STATUS = '5'
 14494        MOVE 'REISSUE'           TO ACVSTATO.
 14495     IF CM-AH-CURRENT-STATUS = '6'
 14496        MOVE 'LMP DIS'           TO ACVSTATO.
 14497     IF CM-AH-CURRENT-STATUS = '7'
 14498        MOVE 'DEATH  '           TO ACVSTATO.
 14499     IF CM-AH-CURRENT-STATUS = '8'
 14500        MOVE 'CANCEL '           TO ACVSTATO.
 14501     IF CM-AH-CURRENT-STATUS = '9'
 14502        MOVE 'RE-ONLY'           TO ACVSTATO.
 14503     IF CM-AH-CURRENT-STATUS = 'V'
 14504        MOVE 'VOID   '           TO ACVSTATO.
 14505     IF CM-AH-CURRENT-STATUS = '9'
 14506        MOVE 'DECLINE'           TO ACVSTATO.
 14507
 14508     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14509         MOVE ' '                TO DC-OPTION-CODE
 14510         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14511         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14512         IF NOT DATE-CONVERSION-ERROR
 14513             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 14514             MOVE HOLD-MONTH     TO WORK-MONTH
 14515             MOVE HOLD-YEAR      TO WORK-YEAR
 14516             MOVE WORK-DATE-MY   TO ACVEXITO.
 14517
 14518     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14519
 14520     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14521     MOVE '5'                    TO BEN-REC-TYPE.
 14522     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 14523     MOVE ZERO                   TO BEN-SEQ-NO.
 14524
 14525
 14526* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 274
* EL131.cbl
 14527*         DATASET  (CNTL-FILE-ID)
 14528*         RIDFLD   (BENEFIT-KEY)
 14529*         SET      (ADDRESS OF CONTROL-FILE)
 14530*    END-EXEC.
 14531*    MOVE '&"S        G          (   #00012324' TO DFHEIV0
 14532     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14534     MOVE X'2020233030303132333234' TO DFHEIV0(25:11)
 14535     CALL 'kxdfhei1' USING DFHEIV0,
 14536           CNTL-FILE-ID,
 14537           DFHEIV20,
 14538           DFHEIV99,
 14539           BENEFIT-KEY,
 14540           DFHEIV99,
 14541           DFHEIV99,
 14542           DFHEIV99
 14543     SET ADDRESS OF CONTROL-FILE TO
 14544         DFHEIV20
 14545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14546
 14547
 14548     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14549        CF-RECORD-TYPE NOT = '5'
 14550         MOVE ER-0250            TO EMI-ERROR
 14551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14552         GO TO 5030-MOVE-CERT-FINISH.
 14553
 14554     MOVE ZERO                   TO COUNT-2.
 14555     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 14556
 14557     IF SCREEN-ERROR
 14558         MOVE ER-0283            TO EMI-ERROR
 14559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14560       ELSE
 14561         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 14562
 14563 5030-MOVE-CERT-FINISH.
 14564
 14565     MOVE CM-LOAN-APR            TO APRO.
 14566     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14567     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14568     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 14569     MOVE CM-LOAN-NUMBER         TO LOANNOO
 14570     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 14571     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 14572
 14573     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 14574         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14575         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14576         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14577         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 14578     ELSE
 14579         MOVE SPACES               TO ADDONDTO.
 14580
 14581     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 14582
 14583 5030-EXIT.
 14584     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 275
* EL131.cbl
 14586 5040-FIND-BENEFIT.
 14587     ADD 1                       TO COUNT-2.
 14588     IF COUNT-2 GREATER THAN 8
 14589         GO TO 5050-BENEFIT-NOTFND.
 14590
 14591     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 14592         GO TO 5060-EXIT.
 14593
 14594     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 14595         GO TO 5050-BENEFIT-NOTFND.
 14596
 14597     GO TO 5040-FIND-BENEFIT.
 14598
 14599 5050-BENEFIT-NOTFND.
 14600     MOVE 'X'                    TO ERROR-SWITCH.
 14601
 14602 5060-EXIT.
 14603     EXIT.
 14604
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 276
* EL131.cbl
 14606 6000-CALCULATE-CERT-TERM.
 14607
 14608     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 14609         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 14610     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 14611         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 14612     IF CM-LOAN-APR NOT NUMERIC
 14613         MOVE ZEROS              TO CM-LOAN-APR.
 14614
 14615*    IF WS-CALC-METHOD  = 'G'
 14616         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 14617*     ELSE
 14618*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 14619
 14620     IF N GREATER 120
 14621         MOVE 120                TO N.
 14622
 14623     MOVE '6'                    TO DC-OPTION-CODE.
 14624     MOVE N                      TO DC-ELAPSED-MONTHS.
 14625     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14626     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 14627
 14628     IF CM-LF-BENEFIT-CD NOT = ZERO
 14629         MOVE N                  TO CM-LF-ORIG-TERM
 14630         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 14631         IF NO-CONVERSION-ERROR
 14632             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 14633
 14634     IF CM-AH-BENEFIT-CD NOT = ZERO
 14635         MOVE N                  TO CM-AH-ORIG-TERM
 14636         IF NO-CONVERSION-ERROR
 14637             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 14638
 14639 6000-EXIT.
 14640      EXIT.
 14641
 14642 6100-CALC-GROSS-TERM.
 14643     MOVE CM-LOAN-BALANCE         TO L.
 14644     MOVE PI-PAYMENT-AMT          TO M.
 14645
 14646     COMPUTE N = L / M.
 14647     IF N LESS 1
 14648         MOVE 1  TO N.
 14649
 14650     IF CM-LF-BENEFIT-CD NOT = ZERO
 14651         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 14652     ELSE
 14653         MOVE ZEROS               TO WS-LF-RATE.
 14654
 14655     IF CM-AH-BENEFIT-CD NOT = ZERO
 14656         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 14657     ELSE
 14658         MOVE ZEROS               TO WS-AH-RATE.
 14659
 14660     COMPUTE I = CM-LOAN-APR / +1200.
 14661
 14662 6105-LOOP.
 14663     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 277
* EL131.cbl
 14664         GO TO 6200-EXIT.
 14665     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 14666     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 14667         ADD 1 TO N
 14668         GO TO 6105-LOOP.
 14669
 14670 6200-EXIT.
 14671      EXIT.
 14672
 14673 6210-CALC-LEFT-RIGHTONE.
 14674      MOVE L         TO LEFT-TOT-1.
 14675      SUBTRACT 1 FROM N.
 14676      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14677      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 14678      ADD 1 TO N.
 14679 6211-CALC-TERM1.
 14680      MOVE N         TO TERM1.
 14681      MULTIPLY M BY TERM1.
 14682 6212-LOOP.
 14683      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 14684      ADD 1 TO A-N.
 14685      MULTIPLY A-N BY TERM1.
 14686      SUBTRACT 1 FROM A-N.
 14687      ADD TERM1 TO LEFT-TOT-1.
 14688 6213-CALC-TERM2.
 14689      MOVE M         TO TERM2.
 14690      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 14691      MULTIPLY IA-N BY TERM2.
 14692      SUBTRACT TERM2 FROM LEFT-TOT-1.
 14693 6215-CALC-RIGHTONE.
 14694      MOVE M         TO RIGHT-TOT-1.
 14695      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14696      MULTIPLY A-N BY RIGHT-TOT-1.
 14697 6220-EXIT.
 14698      EXIT.
 14699
 14700 6300-CALC-A-N.
 14701     IF N LESS 1
 14702         MOVE 0     TO A-N
 14703         GO TO 6300-EXIT.
 14704     IF I = 0
 14705         MOVE .00001 TO I.
 14706     ADD 1 TO I.
 14707     DIVIDE I INTO 1 GIVING V.
 14708     SUBTRACT 1 FROM I.
 14709     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14710     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 14711     DIVIDE I INTO TERM3 GIVING A-N.
 14712 6300-EXIT.
 14713      EXIT.
 14714
 14715 6350-CALC-IA-N.
 14716     IF N LESS 1
 14717         MOVE 0      TO IA-N
 14718         GO TO 6400-EXIT.
 14719     ADD 1 TO N.
 14720     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14721     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 278
* EL131.cbl
 14722     MULTIPLY N BY V-EX-N GIVING TERM3.
 14723     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 14724     SUBTRACT V FROM 1 GIVING TERM4.
 14725     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 14726 6400-EXIT.
 14727      EXIT.
 14728
 14729 6450-CALC-V-EX-N.
 14730     IF N LESS 1
 14731         MOVE 1    TO V-EX-N
 14732         GO TO 6490-EXIT.
 14733     MOVE N        TO NV-STORE.
 14734     IF V-EX-ONETIME = 1  OR
 14735        V NOT = V-EXPONENT (1)
 14736          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 14737 6460-LOOP.
 14738     IF N GREATER 248
 14739         MOVE 248 TO N.
 14740     IF N = 1
 14741         MOVE V               TO V-EX-N
 14742      ELSE
 14743         MOVE V-EXPONENT (N)  TO V-EX-N.
 14744     GO TO 6490-EXIT.
 14745
 14746 6470-BUILD-V-EX-TABLE.
 14747     MOVE 2      TO N.
 14748     MOVE V      TO V-EXPONENT (1)
 14749                    V-EX-N.
 14750 6471-LOOP.
 14751     MULTIPLY V BY V-EX-N.
 14752     MOVE V-EX-N   TO V-EXPONENT (N).
 14753     ADD 1 TO N.
 14754     IF N LESS 248
 14755         GO TO 6471-LOOP.
 14756     MOVE NV-STORE     TO N.
 14757     MOVE 0            TO V-EX-ONETIME.
 14758 6480-EXIT.
 14759      EXIT.
 14760
 14761 6490-EXIT.
 14762      EXIT.
 14763
 14764 6500-CALC-NET-TERM.
 14765     MOVE CM-LOAN-BALANCE         TO L.
 14766     MOVE PI-PAYMENT-AMT          TO M.
 14767
 14768     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 14769     IF WS-REMAIN GREATER ZERO
 14770         ADD 1 TO N.
 14771     IF N = 0
 14772         MOVE 1 TO N.
 14773
 14774 6700-EXIT.
 14775      EXIT.
 14776
 14777 6999-CALC-TERM-EXIT.
 14778     EXIT.
 14779
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 279
* EL131.cbl
 14781 7000-RESET-ATTRIBUTE.
 14782
 14783     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 14784                                    CERTSTA   CERTCARA
 14785                                    CERTGRPA.
 14786     MOVE -1                     TO CERTCARL.
 14787
 14788 7000-EXIT.
 14789     EXIT.
 14790
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 280
* EL131.cbl
 14792 7600-BROWSE-CLAIM.
 14793
 14794
 14795* EXEC CICS READ
 14796*        DATASET(CLMS-FILE-ID)
 14797*        SET    (ADDRESS OF CLAIM-MASTER)
 14798*        RIDFLD (MSTR-KEY)
 14799*        GENERIC
 14800*        EQUAL
 14801*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14802*    END-EXEC.
 14803*    MOVE '&"S  KG    E          (   #00012576' TO DFHEIV0
 14804     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14806     MOVE X'2020233030303132353736' TO DFHEIV0(25:11)
 14807     CALL 'kxdfhei1' USING DFHEIV0,
 14808           CLMS-FILE-ID,
 14809           DFHEIV20,
 14810           DFHEIV99,
 14811           MSTR-KEY,
 14812           ELMSTR-GENERIC-LENGTH,
 14813           DFHEIV99,
 14814           DFHEIV99
 14815     SET ADDRESS OF CLAIM-MASTER TO
 14816         DFHEIV20
 14817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14818
 14819
 14820     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 14821
 14822     if cl-assoc-cert-total = 0
 14823        move 1 to cl-assoc-cert-total
 14824     end-if
 14825     IF CL-ASSOC-CERT-SEQU = 0
 14826        MOVE 1 TO CL-ASSOC-CERT-SEQU
 14827     END-IF
 14828
 14829     IF CL-ASSOC-CERT-TOTAL = 1
 14830         MOVE AL-SADOF           TO BCERT1A
 14831                                    BSUFX1A
 14832                                    BCERT2A
 14833                                    BSUFX2A
 14834                                    BCERT3A
 14835                                    BSUFX3A
 14836                                    BCERT4A
 14837                                    BSUFX4A
 14838                                    BCERT5A
 14839                                    BSUFX5A
 14840                                    PCERTNOA
 14841                                    PSUFXA
 14842                                    LABEL1A
 14843                                    LABEL2A
 14844         GO TO 7699-EXIT.
 14845
 14846 7610-BROWSE-CLAIM-LOOP.
 14847
 14848     MOVE LOW-VALUES             TO BCERT1O
 14849                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 281
* EL131.cbl
 14850                                    BCERT2O
 14851                                    BSUFX2O
 14852                                    BCERT3O
 14853                                    BSUFX3O
 14854                                    BCERT4O
 14855                                    BSUFX4O
 14856                                    BCERT5O
 14857                                    BSUFX5O.
 14858
 14859
 14860* EXEC CICS HANDLE CONDITION
 14861*        ENDFILE  (7630-END-BROWSE)
 14862*    END-EXEC.
 14863*    MOVE '"$''                   ! C #00012624' TO DFHEIV0
 14864     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14866     MOVE X'4320233030303132363234' TO DFHEIV0(25:11)
 14867     CALL 'kxdfhei1' USING DFHEIV0
 14868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14869
 14870
 14871
 14872* EXEC CICS STARTBR
 14873*        DATASET    (CLMS-FILE-ID)
 14874*        RIDFLD     (MSTR-KEY)
 14875*    END-EXEC.
 14876     MOVE 0
 14877       TO DFHEIV11
 14878*    MOVE '&,         G          &   #00012628' TO DFHEIV0
 14879     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14880     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14881     MOVE X'2020233030303132363238' TO DFHEIV0(25:11)
 14882     CALL 'kxdfhei1' USING DFHEIV0,
 14883           CLMS-FILE-ID,
 14884           MSTR-KEY,
 14885           DFHEIV99,
 14886           DFHEIV11,
 14887           DFHEIV99
 14888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14889
 14890
 14891     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14892
 14893 7620-READ-CLAIM-LOOP.
 14894
 14895
 14896* EXEC CICS READNEXT
 14897*        DATASET   (CLMS-FILE-ID)
 14898*        SET       (ADDRESS OF CLAIM-MASTER)
 14899*        RIDFLD    (MSTR-KEY)
 14900*    END-EXEC.
 14901     MOVE 0
 14902       TO DFHEIV11
 14903*    MOVE '&.S                   )   #00012637' TO DFHEIV0
 14904     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14905     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14906     MOVE X'2020233030303132363337' TO DFHEIV0(25:11)
 14907     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 282
* EL131.cbl
 14908           CLMS-FILE-ID,
 14909           DFHEIV20,
 14910           DFHEIV99,
 14911           MSTR-KEY,
 14912           DFHEIV99,
 14913           DFHEIV11,
 14914           DFHEIV99,
 14915           DFHEIV99
 14916     SET ADDRESS OF CLAIM-MASTER TO
 14917         DFHEIV20
 14918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14919
 14920
 14921     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 14922        CL-CARRIER     NOT = CARRI           OR
 14923        CL-CLAIM-NO    NOT = CLAIMI
 14924        GO TO 7630-END-BROWSE.
 14925
 14926     IF WS-ASSOCIATED-CERTS = 1
 14927         MOVE CL-CERT-PRIME      TO BCERT1O
 14928         MOVE CL-CERT-SFX        TO BSUFX1O.
 14929
 14930     IF WS-ASSOCIATED-CERTS = 2
 14931         MOVE CL-CERT-PRIME      TO BCERT2O
 14932         MOVE CL-CERT-SFX        TO BSUFX2O.
 14933
 14934     IF WS-ASSOCIATED-CERTS = 3
 14935         MOVE CL-CERT-PRIME      TO BCERT3O
 14936         MOVE CL-CERT-SFX        TO BSUFX3O.
 14937
 14938     IF WS-ASSOCIATED-CERTS = 4
 14939         MOVE CL-CERT-PRIME      TO BCERT4O
 14940         MOVE CL-CERT-SFX        TO BSUFX4O.
 14941
 14942     IF WS-ASSOCIATED-CERTS = 5
 14943         MOVE CL-CERT-PRIME      TO BCERT5O
 14944         MOVE CL-CERT-SFX        TO BSUFX5O
 14945     ELSE
 14946         ADD +1                  TO WS-ASSOCIATED-CERTS
 14947         GO TO 7620-READ-CLAIM-LOOP.
 14948
 14949 7630-END-BROWSE.
 14950
 14951
 14952* EXEC CICS ENDBR
 14953*        DATASET   (CLMS-FILE-ID)
 14954*    END-EXEC.
 14955     MOVE 0
 14956       TO DFHEIV11
 14957*    MOVE '&2                    $   #00012673' TO DFHEIV0
 14958     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14959     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14960     MOVE X'2020233030303132363733' TO DFHEIV0(25:11)
 14961     CALL 'kxdfhei1' USING DFHEIV0,
 14962           CLMS-FILE-ID,
 14963           DFHEIV11,
 14964           DFHEIV99
 14965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 283
* EL131.cbl
 14966
 14967
 14968 7640-HIGHLIGHT-CERT-DISPLAYED.
 14969
 14970     MOVE AL-SANON               TO BCERT1A
 14971                                    BSUFX1A
 14972                                    BCERT2A
 14973                                    BSUFX2A
 14974                                    BCERT3A
 14975                                    BSUFX3A
 14976                                    BCERT4A
 14977                                    BSUFX4A
 14978                                    BCERT5A
 14979                                    BSUFX5A.
 14980
 14981     IF BCERT1O = CERTI AND
 14982        BSUFX1O = SUFXI
 14983            MOVE AL-SABON        TO BCERT1A
 14984                                    BSUFX1A.
 14985
 14986     IF BCERT2O = CERTI AND
 14987        BSUFX2O = SUFXI
 14988            MOVE AL-SABON        TO BCERT2A
 14989                                    BSUFX2A.
 14990
 14991     IF BCERT3O = CERTI AND
 14992        BSUFX3O = SUFXI
 14993            MOVE AL-SABON        TO BCERT3A
 14994                                    BSUFX3A.
 14995
 14996     IF BCERT4O = CERTI AND
 14997        BSUFX4O = SUFXI
 14998            MOVE AL-SABON        TO BCERT4A
 14999                                    BSUFX4A.
 15000
 15001     IF BCERT5O = CERTI AND
 15002        BSUFX5O = SUFXI
 15003            MOVE AL-SABON        TO BCERT5A
 15004                                    BSUFX5A.
 15005
 15006 7699-EXIT.
 15007     EXIT.
 15008
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 284
* EL131.cbl
 15010 7700-CHECK-SEQUENCE.
 15011
 15012
 15013* EXEC CICS HANDLE CONDITION
 15014*        ENDFILE  (7799-EXIT)
 15015*        NOTFND   (7799-EXIT)
 15016*    END-EXEC.
 15017*    MOVE '"$''I                  ! D #00012721' TO DFHEIV0
 15018     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15019     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15020     MOVE X'4420233030303132373231' TO DFHEIV0(25:11)
 15021     CALL 'kxdfhei1' USING DFHEIV0
 15022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15023
 15024
 15025
 15026* EXEC CICS READ
 15027*        DATASET(CLMS-FILE-ID)
 15028*        SET    (ADDRESS OF CLAIM-MASTER)
 15029*        RIDFLD (MSTR-KEY)
 15030*        GENERIC
 15031*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15032*    END-EXEC.
 15033*    MOVE '&"S  KG    E          (   #00012726' TO DFHEIV0
 15034     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15036     MOVE X'2020233030303132373236' TO DFHEIV0(25:11)
 15037     CALL 'kxdfhei1' USING DFHEIV0,
 15038           CLMS-FILE-ID,
 15039           DFHEIV20,
 15040           DFHEIV99,
 15041           MSTR-KEY,
 15042           ELMSTR-GENERIC-LENGTH,
 15043           DFHEIV99,
 15044           DFHEIV99
 15045     SET ADDRESS OF CLAIM-MASTER TO
 15046         DFHEIV20
 15047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15048
 15049
 15050     COMPUTE WS-ASSOC-CERT-TOTAL =
 15051             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15052
 15053     GO TO 7799-EXIT.
 15054
 15055 7710-RESEQUENCE-CLAIMS.
 15056
 15057
 15058* EXEC CICS HANDLE CONDITION
 15059*        ENDFILE  (7799-EXIT)
 15060*    END-EXEC.
 15061*    MOVE '"$''                   ! E #00012741' TO DFHEIV0
 15062     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15063     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15064     MOVE X'4520233030303132373431' TO DFHEIV0(25:11)
 15065     CALL 'kxdfhei1' USING DFHEIV0
 15066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15067
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 285
* EL131.cbl
 15068
 15069
 15070* EXEC CICS STARTBR
 15071*        DATASET(CLMS-FILE-ID)
 15072*        RIDFLD (MSTR-KEY)
 15073*    END-EXEC.
 15074     MOVE 0
 15075       TO DFHEIV11
 15076*    MOVE '&,         G          &   #00012745' TO DFHEIV0
 15077     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15078     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15079     MOVE X'2020233030303132373435' TO DFHEIV0(25:11)
 15080     CALL 'kxdfhei1' USING DFHEIV0,
 15081           CLMS-FILE-ID,
 15082           MSTR-KEY,
 15083           DFHEIV99,
 15084           DFHEIV11,
 15085           DFHEIV99
 15086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15087
 15088
 15089     COMPUTE WS-ASSOC-CERT-SEQU =
 15090             WS-ASSOC-CERT-SEQU + 1.
 15091
 15092     COMPUTE WS-READNEXT-SWITCH =
 15093             WS-READNEXT-SWITCH + 1.
 15094
 15095 7720-READ-CLAIM-LOOP.
 15096
 15097
 15098* EXEC CICS READNEXT
 15099*        DATASET(CLMS-FILE-ID)
 15100*        SET    (ADDRESS OF CLAIM-MASTER)
 15101*        RIDFLD (MSTR-KEY)
 15102*    END-EXEC.
 15103     MOVE 0
 15104       TO DFHEIV11
 15105*    MOVE '&.S                   )   #00012758' TO DFHEIV0
 15106     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15107     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15108     MOVE X'2020233030303132373538' TO DFHEIV0(25:11)
 15109     CALL 'kxdfhei1' USING DFHEIV0,
 15110           CLMS-FILE-ID,
 15111           DFHEIV20,
 15112           DFHEIV99,
 15113           MSTR-KEY,
 15114           DFHEIV99,
 15115           DFHEIV11,
 15116           DFHEIV99,
 15117           DFHEIV99
 15118     SET ADDRESS OF CLAIM-MASTER TO
 15119         DFHEIV20
 15120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15121
 15122
 15123     IF WS-READNEXT-SWITCH = 1
 15124         ADD 1                   TO WS-READNEXT-SWITCH
 15125         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 286
* EL131.cbl
 15126
 15127 7730-END-BROWSE.
 15128
 15129
 15130* EXEC CICS ENDBR
 15131*        DATASET(CLMS-FILE-ID)
 15132*    END-EXEC.
 15133     MOVE 0
 15134       TO DFHEIV11
 15135*    MOVE '&2                    $   #00012770' TO DFHEIV0
 15136     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15137     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15138     MOVE X'2020233030303132373730' TO DFHEIV0(25:11)
 15139     CALL 'kxdfhei1' USING DFHEIV0,
 15140           CLMS-FILE-ID,
 15141           DFHEIV11,
 15142           DFHEIV99
 15143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15144
 15145
 15146 7740-READ-CLAIM-UPDATE.
 15147
 15148     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15149        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15150        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15151        GO TO 7799-EXIT
 15152     ELSE
 15153        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15154
 15155
 15156* EXEC CICS READ
 15157*        DATASET(CLMS-FILE-ID)
 15158*        SET    (ADDRESS OF CLAIM-MASTER)
 15159*        RIDFLD (MSTR-KEY)
 15160*        UPDATE
 15161*    END-EXEC.
 15162*    MOVE '&"S        EU         (   #00012783' TO DFHEIV0
 15163     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15164     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15165     MOVE X'2020233030303132373833' TO DFHEIV0(25:11)
 15166     CALL 'kxdfhei1' USING DFHEIV0,
 15167           CLMS-FILE-ID,
 15168           DFHEIV20,
 15169           DFHEIV99,
 15170           MSTR-KEY,
 15171           DFHEIV99,
 15172           DFHEIV99,
 15173           DFHEIV99
 15174     SET ADDRESS OF CLAIM-MASTER TO
 15175         DFHEIV20
 15176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15177
 15178
 15179     if (cl-priority-cd = '8')
 15180        and (pi-processor-id not = 'PEMA' and 'JMS '
 15181             AND 'AMWA')
 15182        MOVE ER-8003             TO EMI-ERROR
 15183        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 287
* EL131.cbl
 15184                                 THRU 9900-EXIT
 15185        MOVE -1                  TO MAINTL
 15186        GO TO 8110-SEND-DATA
 15187     end-if
 15188
 15189     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15190         MOVE 'Y'                TO CL-YESNOSW
 15191     END-IF.
 15192
 15193     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15194     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15195
 15196
 15197* EXEC CICS REWRITE
 15198*         DATASET(CLMS-FILE-ID)
 15199*         FROM   (CLAIM-MASTER)
 15200*    END-EXEC.
 15201     MOVE LENGTH OF
 15202      CLAIM-MASTER
 15203       TO DFHEIV11
 15204*    MOVE '&& L                  %   #00012807' TO DFHEIV0
 15205     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15206     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15207     MOVE X'2020233030303132383037' TO DFHEIV0(25:11)
 15208     CALL 'kxdfhei1' USING DFHEIV0,
 15209           CLMS-FILE-ID,
 15210           CLAIM-MASTER,
 15211           DFHEIV11,
 15212           DFHEIV99
 15213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15214
 15215
 15216     GO TO 7710-RESEQUENCE-CLAIMS.
 15217
 15218 7799-EXIT.
 15219     EXIT.
 15220
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 288
* EL131.cbl
 15222 7800-CHECK-AUTO-ACTIVITY.
 15223
 15224
 15225* EXEC CICS HANDLE CONDITION
 15226*        NOTFND   (7800-NOT-FOUND)
 15227*    END-EXEC.
 15228*    MOVE '"$I                   ! F #00012820' TO DFHEIV0
 15229     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15231     MOVE X'4620233030303132383230' TO DFHEIV0(25:11)
 15232     CALL 'kxdfhei1' USING DFHEIV0
 15233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15234
 15235
 15236     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15237     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15238     MOVE SPACES                     TO  CNTL-PROC-ID.
 15239     MOVE +0                         TO  CNTL-SEQ-NO.
 15240
 15241
 15242* EXEC CICS READ
 15243*        DATASET   (CNTL-FILE-ID)
 15244*        RIDFLD    (CNTL-KEY)
 15245*        SET       (ADDRESS OF CONTROL-FILE)
 15246*    END-EXEC.
 15247*    MOVE '&"S        E          (   #00012829' TO DFHEIV0
 15248     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15249     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15250     MOVE X'2020233030303132383239' TO DFHEIV0(25:11)
 15251     CALL 'kxdfhei1' USING DFHEIV0,
 15252           CNTL-FILE-ID,
 15253           DFHEIV20,
 15254           DFHEIV99,
 15255           CNTL-KEY,
 15256           DFHEIV99,
 15257           DFHEIV99,
 15258           DFHEIV99
 15259     SET ADDRESS OF CONTROL-FILE TO
 15260         DFHEIV20
 15261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15262
 15263
 15264     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15265         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15266
 15267     IF CL-ACTIVITY-CODE NOT = ZEROS
 15268         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15269         IF MISC-SUB IS GREATER THAN +9
 15270             SUBTRACT +9 FROM MISC-SUB
 15271             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15272         ELSE
 15273             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15274     ELSE
 15275         MOVE 'Y'                              TO  WS-RESET-SW.
 15276
 15277     IF STATUSI = 'C' OR 'CLOSED'
 15278         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15279             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 289
* EL131.cbl
 15280                                         PI-LETTER-SW
 15281             GO TO 7800-EXIT.
 15282
 15283     IF STATUSI = 'C' OR 'CLOSED'
 15284         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15285             MOVE 'N'                TO  PI-LETTER-SW
 15286         ELSE
 15287             MOVE 'Y'                TO  PI-LETTER-SW.
 15288
 15289     IF STATUSI = 'O' OR 'OPEN'
 15290         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15291             MOVE 'N'                TO  PI-REC-FOUND-SW
 15292                                         PI-LETTER-SW
 15293             GO TO 7800-EXIT.
 15294
 15295     IF STATUSI = 'O' OR 'OPEN'
 15296         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15297             MOVE 'N'                TO  PI-LETTER-SW
 15298         ELSE
 15299             MOVE 'Y'                TO  PI-LETTER-SW.
 15300
 15301     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 15302     GO TO 7800-EXIT.
 15303
 15304 7800-NOT-FOUND.
 15305
 15306     MOVE 'N'                        TO  PI-REC-FOUND-SW
 15307                                         PI-LETTER-SW.
 15308
 15309 7800-EXIT.
 15310     EXIT.
 15311
 15312 7850-AUTO-LETTER-WRITER.
 15313
 15314     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 15315     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 15316
 15317     IF STATUSI = 'C' OR 'CLOSED'
 15318         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 15319     ELSE
 15320         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 15321
 15322     IF STATUSI = 'C' OR 'CLOSED'
 15323         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 15324             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15325             MOVE '6'                TO  DC-OPTION-CODE
 15326             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 15327             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15328             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15329             IF NO-CONVERSION-ERROR
 15330                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15331             ELSE
 15332                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15333
 15334     IF STATUSI = 'C' OR 'CLOSED'
 15335         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 15336             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15337             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 290
* EL131.cbl
 15338             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 15339             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15340             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15341             IF NO-CONVERSION-ERROR
 15342                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15343             ELSE
 15344                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15345
 15346     IF STATUSI = 'O' OR 'OPEN'
 15347         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 15348             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15349             MOVE '6'                TO  DC-OPTION-CODE
 15350             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 15351             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15352             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15353             IF NO-CONVERSION-ERROR
 15354                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15355             ELSE
 15356                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15357
 15358     IF STATUSI = 'O' OR 'OPEN'
 15359         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 15360             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15361             MOVE '6'                TO  DC-OPTION-CODE
 15362             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 15363             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15364             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15365             IF NO-CONVERSION-ERROR
 15366                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15367             ELSE
 15368                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15369
 15370
 15371* EXEC CICS LINK
 15372*        PROGRAM    (LINK-1523)
 15373*        COMMAREA   (W-1523-LINKDATA)
 15374*        LENGTH     (W-1523-COMM-LENGTH)
 15375*    END-EXEC.
 15376*    MOVE '."C                   (   #00012941' TO DFHEIV0
 15377     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15379     MOVE X'2020233030303132393431' TO DFHEIV0(25:11)
 15380     CALL 'kxdfhei1' USING DFHEIV0,
 15381           LINK-1523,
 15382           W-1523-LINKDATA,
 15383           W-1523-COMM-LENGTH,
 15384           DFHEIV99,
 15385           DFHEIV99,
 15386           DFHEIV99,
 15387           DFHEIV99
 15388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15389
 15390
 15391     IF W-1523-ERROR-CODE = ZEROS
 15392         GO TO 7850-EXIT.
 15393
 15394     IF W-1523-FATAL-ERROR
 15395         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 291
* EL131.cbl
 15396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15397
 15398     IF W-1523-ERROR-CODE = 0191
 15399         MOVE ER-0803                TO  EMI-ERROR
 15400         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15401
 15402 7850-EXIT.
 15403     EXIT.
 15404
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 292
* EL131.cbl
 15406 8000-CREATE-DMO-REC.
 15407     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 15408     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 15409     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 15410
 15411
 15412* EXEC CICS HANDLE CONDITION
 15413*         NOTFND   (8000-NOTE-NOT-FOUND)
 15414*    END-EXEC.
 15415*    MOVE '"$I                   ! G #00012967' TO DFHEIV0
 15416     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15418     MOVE X'4720233030303132393637' TO DFHEIV0(25:11)
 15419     CALL 'kxdfhei1' USING DFHEIV0
 15420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15421
 15422
 15423
 15424* EXEC CICS READ
 15425*         DATASET(NOTE-FILE-ID)
 15426*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 15427*         RIDFLD (NOTE-KEY)
 15428*    END-EXEC.
 15429*    MOVE '&"S        E          (   #00012971' TO DFHEIV0
 15430     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15432     MOVE X'2020233030303132393731' TO DFHEIV0(25:11)
 15433     CALL 'kxdfhei1' USING DFHEIV0,
 15434           NOTE-FILE-ID,
 15435           DFHEIV20,
 15436           DFHEIV99,
 15437           NOTE-KEY,
 15438           DFHEIV99,
 15439           DFHEIV99,
 15440           DFHEIV99
 15441     SET ADDRESS OF CERTIFICATE-NOTE TO
 15442         DFHEIV20
 15443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15444
 15445
 15446     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 15447     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 15448     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 15449
 15450     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 15451         MOVE 'CC'               TO DCT-PRODUCT-CODE
 15452     ELSE
 15453         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 15454
 15455     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 15456     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 15457
 15458
 15459* EXEC CICS LINK
 15460*        PROGRAM    ('DLO006')
 15461*        COMMAREA   (DCT-COMMUNICATION-AREA)
 15462*        LENGTH     (WS-DCT-LENGTH)
 15463*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 293
* EL131.cbl
 15464     MOVE 'DLO006' TO DFHEIV1
 15465*    MOVE '."C                   (   #00012989' TO DFHEIV0
 15466     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15468     MOVE X'2020233030303132393839' TO DFHEIV0(25:11)
 15469     CALL 'kxdfhei1' USING DFHEIV0,
 15470           DFHEIV1,
 15471           DCT-COMMUNICATION-AREA,
 15472           WS-DCT-LENGTH,
 15473           DFHEIV99,
 15474           DFHEIV99,
 15475           DFHEIV99,
 15476           DFHEIV99
 15477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15478
 15479
 15480     IF  DCT-RETURN-CODE = 'OK'
 15481         GO TO 8000-CONT.
 15482
 15483     IF DCT-RETURN-CODE = '01' OR '02'
 15484         GO TO 8000-EXIT.
 15485
 15486     IF DCT-RETURN-CODE = '03'
 15487         MOVE ER-0951            TO EMI-ERROR
 15488         MOVE -1                 TO MAINTL
 15489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15490         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15491         GO TO 8110-SEND-DATA.
 15492
 15493     IF DCT-RETURN-CODE = '04'
 15494         MOVE ER-0946            TO EMI-ERROR
 15495         MOVE -1                 TO MAINTL
 15496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15497         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15498         GO TO 8110-SEND-DATA.
 15499
 15500     IF DCT-RETURN-CODE = '05'
 15501         MOVE ER-0947            TO EMI-ERROR
 15502         MOVE -1                 TO MAINTL
 15503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15504         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15505         GO TO 8110-SEND-DATA.
 15506
 15507     IF DCT-RETURN-CODE = '06'
 15508         MOVE ER-0921            TO EMI-ERROR
 15509         MOVE -1                 TO MAINTL
 15510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15511         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15512         GO TO 8110-SEND-DATA.
 15513
 15514     IF DCT-RETURN-CODE = '07'
 15515         MOVE ER-0919            TO EMI-ERROR
 15516         MOVE -1                 TO MAINTL
 15517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15518         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15519         GO TO 8110-SEND-DATA.
 15520
 15521     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 294
* EL131.cbl
 15522         MOVE ER-0948            TO EMI-ERROR
 15523         MOVE -1                 TO MAINTL
 15524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15525         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15526         GO TO 8110-SEND-DATA.
 15527
 15528     IF DCT-RETURN-CODE = 'N1'
 15529         MOVE ER-0950            TO EMI-ERROR
 15530         MOVE -1                 TO MAINTL
 15531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15532         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15533         GO TO 8110-SEND-DATA.
 15534
 15535     IF DCT-RETURN-CODE = 'E1'
 15536         MOVE ER-0974            TO EMI-ERROR
 15537         MOVE -1                 TO MAINTL
 15538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15539         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15540         GO TO 8110-SEND-DATA.
 15541
 15542     IF DCT-RETURN-CODE = 'E2'
 15543         MOVE ER-0975            TO EMI-ERROR
 15544         MOVE -1                 TO MAINTL
 15545         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15546         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15547         GO TO 8110-SEND-DATA.
 15548
 15549     IF DCT-RETURN-CODE NOT = 'OK'
 15550         MOVE ER-0949            TO EMI-ERROR
 15551         MOVE -1                 TO MAINTL
 15552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15553         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15554         GO TO 8110-SEND-DATA.
 15555
 15556 8000-CONT.
 15557
 15558     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 15559     MOVE 'CS'                   TO DM-RECORD-TYPE.
 15560     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 15561     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 15562     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 15563     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 15564     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 15565     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 15566
 15567     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 15568     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 15569     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 15570     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 15571     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 15572
 15573     IF STATUSI = 'OPEN' OR 'O'
 15574         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 15575      ELSE
 15576         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 15577
 15578     IF STATUSI = 'OPEN' OR 'O'
 15579        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 295
* EL131.cbl
 15580         MOVE '1'                TO DM-CLAIM-STATUS
 15581      ELSE
 15582         MOVE '2'                TO DM-CLAIM-STATUS.
 15583
 15584     IF STATUSI = 'CLOSED' OR 'C'
 15585        IF NOT FINAL-PAID
 15586         MOVE '3'                TO DM-CLAIM-STATUS
 15587      ELSE
 15588         MOVE '4'                TO DM-CLAIM-STATUS.
 15589
 15590     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 15591
 15592
 15593* EXEC CICS LINK
 15594*        PROGRAM    ('DLO025')
 15595*        COMMAREA   (DMO-COMMUNICATION-AREA)
 15596*        LENGTH     (WS-DMO-LENGTH)
 15597*    END-EXEC.
 15598     MOVE 'DLO025' TO DFHEIV1
 15599*    MOVE '."C                   (   #00013107' TO DFHEIV0
 15600     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15602     MOVE X'2020233030303133313037' TO DFHEIV0(25:11)
 15603     CALL 'kxdfhei1' USING DFHEIV0,
 15604           DFHEIV1,
 15605           DMO-COMMUNICATION-AREA,
 15606           WS-DMO-LENGTH,
 15607           DFHEIV99,
 15608           DFHEIV99,
 15609           DFHEIV99,
 15610           DFHEIV99
 15611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15612
 15613
 15614     IF  DM-RETURN-CODE = 'OK'
 15615         GO TO 8000-EXIT.
 15616
 15617     IF DM-RETURN-CODE = '01'
 15618         MOVE ER-8051            TO EMI-ERROR
 15619         MOVE -1                 TO MAINTL
 15620         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15621         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15622         GO TO 8110-SEND-DATA.
 15623
 15624     IF DM-RETURN-CODE = '02'
 15625         MOVE ER-8052            TO EMI-ERROR
 15626         MOVE -1                 TO MAINTL
 15627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15628         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15629         GO TO 8110-SEND-DATA.
 15630
 15631     IF DM-RETURN-CODE = '03'
 15632         MOVE ER-8053            TO EMI-ERROR
 15633         MOVE -1                 TO MAINTL
 15634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15635         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15636         GO TO 8110-SEND-DATA.
 15637
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 296
* EL131.cbl
 15638     IF DM-RETURN-CODE = '04'
 15639         MOVE ER-8054            TO EMI-ERROR
 15640         MOVE -1                 TO MAINTL
 15641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15642         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15643         GO TO 8110-SEND-DATA.
 15644
 15645     IF DM-RETURN-CODE = '05'
 15646         MOVE ER-8055            TO EMI-ERROR
 15647         MOVE -1                 TO MAINTL
 15648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15649         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15650         GO TO 8110-SEND-DATA.
 15651
 15652     IF DM-RETURN-CODE = '06'
 15653         MOVE ER-8056            TO EMI-ERROR
 15654         MOVE -1                 TO MAINTL
 15655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15656         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15657         GO TO 8110-SEND-DATA.
 15658
 15659     IF DM-RETURN-CODE = '07'
 15660         MOVE ER-8057            TO EMI-ERROR
 15661         MOVE -1                 TO MAINTL
 15662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15663         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15664         GO TO 8110-SEND-DATA.
 15665
 15666     IF DM-RETURN-CODE = '08'
 15667         MOVE ER-8058            TO EMI-ERROR
 15668         MOVE -1                 TO MAINTL
 15669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15670         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15671         GO TO 8110-SEND-DATA.
 15672
 15673     IF DM-RETURN-CODE = '09'
 15674         MOVE ER-8059            TO EMI-ERROR
 15675         MOVE -1                 TO MAINTL
 15676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15677         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15678         GO TO 8110-SEND-DATA.
 15679
 15680     IF DM-RETURN-CODE = '10'
 15681         MOVE ER-8060            TO EMI-ERROR
 15682         MOVE -1                 TO MAINTL
 15683         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15684         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15685         GO TO 8110-SEND-DATA.
 15686
 15687     IF DM-RETURN-CODE = '11'
 15688         MOVE ER-8061            TO EMI-ERROR
 15689         MOVE -1                 TO MAINTL
 15690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15691         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15692         GO TO 8110-SEND-DATA.
 15693
 15694     IF DM-RETURN-CODE = '12'
 15695         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 297
* EL131.cbl
 15696         MOVE -1                 TO MAINTL
 15697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15698         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15699         GO TO 8110-SEND-DATA.
 15700
 15701     IF DM-RETURN-CODE = '13'
 15702         MOVE ER-8063            TO EMI-ERROR
 15703         MOVE -1                 TO MAINTL
 15704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15705         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15706         GO TO 8110-SEND-DATA.
 15707
 15708     IF DM-RETURN-CODE = '14'
 15709         MOVE ER-8064            TO EMI-ERROR
 15710         MOVE -1                 TO MAINTL
 15711         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15712         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15713         GO TO 8110-SEND-DATA.
 15714
 15715     IF DM-RETURN-CODE = '15'
 15716         MOVE ER-8065            TO EMI-ERROR
 15717         MOVE -1                 TO MAINTL
 15718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15719         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15720         GO TO 8110-SEND-DATA.
 15721
 15722     IF DM-RETURN-CODE = '16'
 15723         MOVE ER-8154            TO EMI-ERROR
 15724         MOVE -1                 TO MAINTL
 15725         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15726         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15727         GO TO 8110-SEND-DATA.
 15728
 15729     IF DM-RETURN-CODE = '17'
 15730         MOVE ER-8155            TO EMI-ERROR
 15731         MOVE -1                 TO MAINTL
 15732         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15733         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15734         GO TO 8110-SEND-DATA.
 15735
 15736     IF DM-RETURN-CODE = 'N1'
 15737         MOVE ER-8152            TO EMI-ERROR
 15738         MOVE -1                 TO MAINTL
 15739         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15740         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15741         GO TO 8110-SEND-DATA.
 15742
 15743     IF DM-RETURN-CODE = 'E1'
 15744         MOVE ER-8153            TO EMI-ERROR
 15745         MOVE -1                 TO MAINTL
 15746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15747         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15748         GO TO 8110-SEND-DATA.
 15749
 15750     MOVE ER-8066                TO EMI-ERROR.
 15751     MOVE -1                     TO MAINTL.
 15752     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15753     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 298
* EL131.cbl
 15754     GO TO 8110-SEND-DATA.
 15755
 15756 8000-NOTE-NOT-FOUND.
 15757
 15758* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15759*    MOVE '6"R                   !   #00013256' TO DFHEIV0
 15760     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15762     MOVE X'2020233030303133323536' TO DFHEIV0(25:11)
 15763     CALL 'kxdfhei1' USING DFHEIV0
 15764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15765
 15766     MOVE ER-0954                TO EMI-ERROR.
 15767     MOVE -1                     TO MAINTL.
 15768     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15769     GO TO 8110-SEND-DATA.
 15770
 15771 8000-EXIT.
 15772     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 299
* EL131.cbl
 15774 8050-FORMAT-LAST-NAME-1ST.
 15775*****************************************************************
 15776*             M O V E   N A M E   R O U T I N E                 *
 15777*                                                               *
 15778*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15779*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15780*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 15781*                                                               *
 15782*                  FIELD               VALUE                    *
 15783*                  -----               -----                    *
 15784*           W-NAME-LAST    (CL15)      SMITH                    *
 15785*           W-NAME-FIRST   (CL15)      JOHN                     *
 15786*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15787*                                                               *
 15788*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 15789*                SMITH, JOHN ALLEN                              *
 15790*                     OR                                        *
 15791*                SMITH, JOHN A.                                 *
 15792*                                                               *
 15793*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 15794*     COPYBOOK, ELCNWA.                                         *
 15795*****************************************************************.
 15796
 15797     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15798     MOVE ZERO                   TO WS-NAME-SW.
 15799     SET NWA-INDEX               TO +1.
 15800
 15801     IF W-NAME-LAST   = SPACES  AND
 15802        W-NAME-MIDDLE = SPACES
 15803          MOVE +1                TO WS-NAME-SW.
 15804
 15805     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15806     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15807
 15808     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15809     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15810
 15811     SET NWA-INDEX UP BY +1.
 15812
 15813     IF W-NAME-MIDDLE NOT = SPACES
 15814         IF W-NAME-MIDDLE-2 = SPACES
 15815             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15816             SET NWA-INDEX UP BY +1
 15817             MOVE '.'            TO WS-NW (NWA-INDEX)
 15818             SET NWA-INDEX UP BY +2
 15819         ELSE
 15820             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15821             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15822
 15823 8050-EXIT.
 15824     EXIT.
 15825
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 300
* EL131.cbl
 15827 8060-MOVE-NAME.
 15828     IF WS-NAME-SW GREATER THAN +1
 15829         GO TO 8060-EXIT.
 15830
 15831     IF WS-NAME-WORK2 = SPACES
 15832         GO TO 8060-EXIT.
 15833
 15834     SET NWA-INDEX2            TO +1.
 15835     SET NWA-INDEX3            TO +2.
 15836
 15837 8060-MOVE-NAME-CYCLE.
 15838     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15839
 15840     IF NWA-INDEX LESS THAN +30
 15841         SET NWA-INDEX UP BY +1
 15842     ELSE
 15843         ADD +2 TO  WS-NAME-SW
 15844         GO TO 8060-EXIT.
 15845
 15846     IF NWA-INDEX2 LESS THAN +20
 15847         SET NWA-INDEX3 UP BY +1
 15848         SET NWA-INDEX2 UP BY +1.
 15849
 15850     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 15851        WS-NW2 (NWA-INDEX3) = SPACES
 15852         IF WS-NAME-SW = ZERO
 15853             MOVE ','            TO WS-NW (NWA-INDEX)
 15854             SET NWA-INDEX UP BY +2
 15855             MOVE +1             TO WS-NAME-SW
 15856             GO TO 8060-EXIT
 15857         ELSE
 15858             GO TO 8060-EXIT.
 15859
 15860     GO TO 8060-MOVE-NAME-CYCLE.
 15861
 15862 8060-EXIT.
 15863     EXIT.
 15864
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 301
* EL131.cbl
 15866
 15867 8070-UNLOCK-CLAIM-MSTR.
 15868
 15869* EXEC CICS UNLOCK
 15870*        DATASET   (CLMS-FILE-ID)
 15871*    END-EXEC.
 15872*    MOVE '&*                    #   #00013359' TO DFHEIV0
 15873     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15874     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15875     MOVE X'2020233030303133333539' TO DFHEIV0(25:11)
 15876     CALL 'kxdfhei1' USING DFHEIV0,
 15877           CLMS-FILE-ID,
 15878           DFHEIV99
 15879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15880
 15881
 15882 8070-EXIT.
 15883      EXIT.
 15884
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 302
* EL131.cbl
 15886 8100-SEND-MAP.
 15887     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15888
 15889     IF NOT PI-NO-CARRIER-SECURITY
 15890        MOVE AL-SANOF            TO CERTCARA.
 15891     IF NOT PI-NO-ACCOUNT-SECURITY
 15892        MOVE AL-SANOF            TO CERTACTA.
 15893
 15894     IF PI-PROCESSOR-ID = 'LGXX'
 15895        MOVE AL-UANON            TO CCNOA.
 15896
 15897     IF PI-COMPANY-ID = 'DMD'
 15898        NEXT SENTENCE
 15899     ELSE
 15900        MOVE AL-SADOF            TO PFKEY6A.
 15901
 15902     IF PI-USES-PAID-TO
 15903        MOVE 'PAID TO  :' TO PTHRHDGO.
 15904
 15905
 15906* EXEC CICS SEND
 15907*         MAP     ('EL131A')
 15908*         MAPSET  ('EL131S')
 15909*         ERASE
 15910*         FREEKB
 15911*         CURSOR
 15912*    END-EXEC.
 15913     MOVE 'EL131A' TO DFHEIV1
 15914     MOVE -1
 15915       TO DFHEIV11
 15916     MOVE 'EL131S' TO DFHEIV2
 15917*    MOVE '8$     CT  E F  H     ,   #00013386' TO DFHEIV0
 15918     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15919     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15920     MOVE X'2020233030303133333836' TO DFHEIV0(25:11)
 15921     CALL 'kxdfhei1' USING DFHEIV0,
 15922           DFHEIV1,
 15923           EL131AO,
 15924           DFHEIV99,
 15925           DFHEIV2,
 15926           DFHEIV99,
 15927           DFHEIV99,
 15928           DFHEIV99,
 15929           DFHEIV11,
 15930           DFHEIV99,
 15931           DFHEIV99,
 15932           DFHEIV99
 15933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15934
 15935
 15936     GO TO 9000-RETURN-TRANS.
 15937
 15938 8110-SEND-DATA.
 15939     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15940
 15941     IF PI-USES-PAID-TO
 15942        MOVE 'PAID TO  :' TO PTHRHDGO.
 15943
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 303
* EL131.cbl
 15944     IF PI-PROCESSOR-ID = 'LGXX'
 15945        MOVE AL-UANON            TO CCNOA.
 15946
 15947     IF PI-COMPANY-ID = 'DMD'
 15948        NEXT SENTENCE
 15949     ELSE
 15950        MOVE AL-SADOF            TO PFKEY6A.
 15951
 15952
 15953* EXEC CICS SEND
 15954*         MAP      ('EL131A')
 15955*         MAPSET   ('EL131S')
 15956*         DATAONLY
 15957*         FREEKB
 15958*         CURSOR
 15959*    END-EXEC.
 15960     MOVE 'EL131A' TO DFHEIV1
 15961     MOVE -1
 15962       TO DFHEIV11
 15963     MOVE 'EL131S' TO DFHEIV2
 15964*    MOVE '8$D    CT    F  H     ,   #00013410' TO DFHEIV0
 15965     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15966     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15967     MOVE X'2020233030303133343130' TO DFHEIV0(25:11)
 15968     CALL 'kxdfhei1' USING DFHEIV0,
 15969           DFHEIV1,
 15970           EL131AO,
 15971           DFHEIV99,
 15972           DFHEIV2,
 15973           DFHEIV99,
 15974           DFHEIV99,
 15975           DFHEIV99,
 15976           DFHEIV11,
 15977           DFHEIV99,
 15978           DFHEIV99,
 15979           DFHEIV99
 15980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15981
 15982
 15983     GO TO 9000-RETURN-TRANS.
 15984
 15985 8120-FORMAT-TIME-DATE.
 15986     perform 8140-check-for-prev-errors
 15987                                 thru 8140-exit
 15988     IF SKIP-ATTRIBUTE = 'Y'
 15989        MOVE SPACES              TO SKIP-ATTRIBUTE
 15990        MOVE ER-0598             TO EMI-ERROR
 15991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15992        GO TO 8125-SKIP-ATTRIBUTE.
 15993
 15994*     IF PI-COMPANY-ID = 'DMD'
 15995      IF PI-PROCESSOR-ID <> 'EMER'
 15996         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 15997                                    CERTCARA  CERTGRPA CERTA SUFXA
 15998
 15999     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16000                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 16001                                    JNTINITA  JNTAGEA   APRA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 304
* EL131.cbl
 16002                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16003                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16004                                    LCVEXITA  LCVSTATA  LCVKINDA
 16005                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16006                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16007                                    ACVEXITA  ACVSTATA  ACVKINDA
 16008                                    PMTFREQA  INDGRPA   PREMTYPA
 16009                                    REINCDA   LCVRATEA  ACVRATEA
 16010                                    ADDONDTA.
 16011
 16012*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16013*       IF PI-COMPANY-ID = 'DMD'
 16014*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16015*                                   SUFXA
 16016*                                   PDAMTA    NODAYSA   NOPMTSA
 16017*                                   INCA      OCCA
 16018*          IF NOT SYSTEM-MODIFY-CAP
 16019*              MOVE AL-SANOF         TO PDTHRUA.
 16020
 16021     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16022         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16023
 16024 8125-SKIP-ATTRIBUTE.
 16025
 16026     MOVE SAVE-DATE              TO DATEO.
 16027
 16028* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16029*    END-EXEC
 16030*    MOVE '0"A                   "   #00013462' TO DFHEIV0
 16031     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16032     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16033     MOVE X'2020233030303133343632' TO DFHEIV0(25:11)
 16034     CALL 'kxdfhei1' USING DFHEIV0,
 16035           LCP-CICS-TIME
 16036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16037
 16038* EXEC CICS FORMATTIME
 16039*              ABSTIME(LCP-CICS-TIME)
 16040*              TIME(LCP-TIME-OF-DAY-XX)
 16041*    END-EXEC
 16042*    MOVE 'j$(     (             #   #00013464' TO DFHEIV0
 16043     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16044     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16045     MOVE X'2020233030303133343634' TO DFHEIV0(25:11)
 16046     CALL 'kxdfhei1' USING DFHEIV0,
 16047           LCP-CICS-TIME,
 16048           LCP-TIME-OF-DAY-XX
 16049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16050     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16051     MOVE UN-HOURS               TO FOR-HOURS.
 16052     MOVE UN-MINUTES             TO FOR-MINUTES.
 16053     MOVE TIME-OUT               TO TIMEO.
 16054     MOVE PI-COMPANY-ID          TO COMPO.
 16055     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16056     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16057     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16058     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 16059     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 305
* EL131.cbl
 16060
 16061 8130-EXIT.
 16062     EXIT.
 16063
 16064 8140-check-for-prev-errors.
 16065
 16066     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16067     MOVE PI-CARRIER             TO trlr-carrier
 16068     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16069     MOVE PI-CERT-NO             TO trlr-cert-no
 16070     MOVE +95                    TO TRLR-SEQ-NO
 16071
 16072
 16073* EXEC CICS READ
 16074*       DATASET  ('ELTRLR')
 16075*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16076*       RIDFLD   (TRLR-KEY)
 16077*       RESP     (WS-RESPONSE)
 16078*    END-EXEC
 16079     MOVE 'ELTRLR' TO DFHEIV1
 16080*    MOVE '&"S        E          (  N#00013490' TO DFHEIV0
 16081     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16083     MOVE X'204E233030303133343930' TO DFHEIV0(25:11)
 16084     CALL 'kxdfhei1' USING DFHEIV0,
 16085           DFHEIV1,
 16086           DFHEIV20,
 16087           DFHEIV99,
 16088           TRLR-KEY,
 16089           DFHEIV99,
 16090           DFHEIV99,
 16091           DFHEIV99
 16092     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16093         DFHEIV20
 16094     MOVE EIBRESP  TO WS-RESPONSE
 16095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16096
 16097     if ws-resp-normal
 16098        perform varying s1 from +1 by +1 until
 16099           at-note-error-no (s1) = spaces
 16100           if at-note-error-no (s1) = '1652'
 16101              continue
 16102           else
 16103              move at-note-error-no (s1)
 16104                                 to emi-error
 16105              move -1 to maintl
 16106              if at-note-error-no (s1) = '1653'
 16107                 evaluate true
 16108                    when pi-claim-type = 'L'
 16109                       move '  LF  '
 16110                        to emi-claim-type
 16111                    when pi-claim-type = 'I'
 16112                       move '  IU  '
 16113                        to emi-claim-type
 16114                    when other
 16115                       move '  AH  '
 16116                        to emi-claim-type
 16117                 end-evaluate
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 306
* EL131.cbl
 16118              end-if
 16119              PERFORM 9900-ERROR-FORMAT
 16120                                 THRU 9900-EXIT
 16121           end-if
 16122*          if at-note-error-no (s1) = '1653'
 16123*             perform varying emi-sub from 1 by 1 until
 16124*                emi-sub > 3
 16125*                if emi-error-number (emi-sub) = '1653'
 16126*                   evaluate true
 16127*                      when pi-claim-type = 'L'
 16128*                         move '  LF  '
 16129*                          to emi-claim-type
 16130*                      when pi-claim-type = 'I'
 16131*                         move '  IU  '
 16132*                          to emi-claim-type
 16133*                      when other
 16134*                         move '  AH  '
 16135*                          to emi-claim-type
 16136*                   end-evaluate
 16137*                end-if
 16138*             end-perform
 16139*          end-if
 16140        end-perform
 16141     else
 16142        display ' resp not normal ' ws-response ' '
 16143        trlr-key (2:19)
 16144     end-if
 16145
 16146     .
 16147 8140-exit.
 16148     exit.
 16149 8150-ENTERED-CLAIM-NOTFOUND.
 16150
 16151     MOVE ER-0204                TO EMI-ERROR.
 16152     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16153     MOVE -1                     TO MAINTL.
 16154     GO TO 8100-SEND-MAP.
 16155
 16156 8200-RETURN-PRIOR.
 16157     MOVE SPACE                  TO PI-RETURN-CD-1.
 16158     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16159     GO TO 9200-XCTL.
 16160
 16161 8300-GET-HELP.
 16162     MOVE XCTL-EL010             TO CALL-PGM.
 16163     GO TO 9200-XCTL.
 16164
 16165 8400-RETURN-MASTER.
 16166     MOVE SPACE                  TO PI-RETURN-CD-1.
 16167     MOVE XCTL-EL126             TO CALL-PGM.
 16168     GO TO 9200-XCTL.
 16169
 16170 8500-TRLR-MNT.
 16171     IF PI-RETURN-CD-1 = 'X'
 16172         MOVE ER-0311            TO EMI-ERROR
 16173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16174         MOVE -1                 TO MAINTL
 16175         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 307
* EL131.cbl
 16176
 16177
 16178* EXEC CICS WRITEQ TS
 16179*         QUEUE     (PI-KEY)
 16180*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16181*         LENGTH    (PI-COMM-LENGTH)
 16182*    END-EXEC.
 16183*    MOVE '*"                    ''   #00013577' TO DFHEIV0
 16184     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16185     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16186     MOVE X'2020233030303133353737' TO DFHEIV0(25:11)
 16187     CALL 'kxdfhei1' USING DFHEIV0,
 16188           PI-KEY,
 16189           PROGRAM-INTERFACE-BLOCK,
 16190           PI-COMM-LENGTH,
 16191           DFHEIV99,
 16192           DFHEIV99,
 16193           DFHEIV99
 16194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16195
 16196
 16197     MOVE XCTL-EL142             TO CALL-PGM.
 16198     GO TO 9200-XCTL.
 16199
 16200 8600-ADDR-MNT.
 16201     IF PI-RETURN-CD-1 = 'X'
 16202         MOVE ER-0311            TO EMI-ERROR
 16203         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16204         MOVE -1                 TO MAINTL
 16205         GO TO 8110-SEND-DATA.
 16206
 16207
 16208* EXEC CICS WRITEQ TS
 16209*         QUEUE     (PI-KEY)
 16210*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16211*         LENGTH    (PI-COMM-LENGTH)
 16212*    END-EXEC.
 16213*    MOVE '*"                    ''   #00013593' TO DFHEIV0
 16214     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16215     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16216     MOVE X'2020233030303133353933' TO DFHEIV0(25:11)
 16217     CALL 'kxdfhei1' USING DFHEIV0,
 16218           PI-KEY,
 16219           PROGRAM-INTERFACE-BLOCK,
 16220           PI-COMM-LENGTH,
 16221           DFHEIV99,
 16222           DFHEIV99,
 16223           DFHEIV99
 16224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16225
 16226
 16227     MOVE XCTL-EL141             TO CALL-PGM.
 16228     GO TO 9200-XCTL.
 16229
 16230 8700-CERT-MNT.
 16231     IF PI-RETURN-CD-1 = 'X'
 16232         MOVE ER-7690            TO EMI-ERROR
 16233         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 308
* EL131.cbl
 16234         MOVE -1                 TO MAINTL
 16235         GO TO 8110-SEND-DATA.
 16236
 16237
 16238* EXEC CICS WRITEQ TS
 16239*         QUEUE     (PI-KEY)
 16240*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16241*         LENGTH    (PI-COMM-LENGTH)
 16242*    END-EXEC.
 16243*    MOVE '*"                    ''   #00013609' TO DFHEIV0
 16244     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16245     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16246     MOVE X'2020233030303133363039' TO DFHEIV0(25:11)
 16247     CALL 'kxdfhei1' USING DFHEIV0,
 16248           PI-KEY,
 16249           PROGRAM-INTERFACE-BLOCK,
 16250           PI-COMM-LENGTH,
 16251           DFHEIV99,
 16252           DFHEIV99,
 16253           DFHEIV99
 16254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16255
 16256
 16257     MOVE XCTL-EL1273            TO CALL-PGM.
 16258     GO TO 9200-XCTL.
 16259
 16260 8725-BENEFICIARY-MNT.
 16261     IF PI-RETURN-CD-1 = 'X'
 16262         MOVE ER-0311            TO EMI-ERROR
 16263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16264         MOVE -1                 TO MAINTL
 16265         GO TO 8110-SEND-DATA.
 16266
 16267
 16268* EXEC CICS WRITEQ TS
 16269*         QUEUE     (PI-KEY)
 16270*         FROM      (EL131AI)
 16271*         LENGTH    (MAP-LENGTH)
 16272*    END-EXEC.
 16273*    MOVE '*"                    ''   #00013625' TO DFHEIV0
 16274     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16275     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16276     MOVE X'2020233030303133363235' TO DFHEIV0(25:11)
 16277     CALL 'kxdfhei1' USING DFHEIV0,
 16278           PI-KEY,
 16279           EL131AI,
 16280           MAP-LENGTH,
 16281           DFHEIV99,
 16282           DFHEIV99,
 16283           DFHEIV99
 16284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16285
 16286
 16287
 16288* EXEC CICS WRITEQ TS
 16289*         QUEUE     (PI-KEY)
 16290*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16291*         LENGTH    (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 309
* EL131.cbl
 16292*    END-EXEC.
 16293*    MOVE '*"                    ''   #00013631' TO DFHEIV0
 16294     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16295     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16296     MOVE X'2020233030303133363331' TO DFHEIV0(25:11)
 16297     CALL 'kxdfhei1' USING DFHEIV0,
 16298           PI-KEY,
 16299           PROGRAM-INTERFACE-BLOCK,
 16300           PI-COMM-LENGTH,
 16301           DFHEIV99,
 16302           DFHEIV99,
 16303           DFHEIV99
 16304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16305
 16306
 16307     MOVE XCTL-EL114             TO CALL-PGM.
 16308     GO TO 9200-XCTL.
 16309
 16310 8750-DMD-CLM-FIX.
 16311
 16312* EXEC CICS WRITEQ TS
 16313*         QUEUE     (PI-KEY)
 16314*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16315*         LENGTH    (PI-COMM-LENGTH)
 16316*    END-EXEC.
 16317*    MOVE '*"                    ''   #00013641' TO DFHEIV0
 16318     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16319     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16320     MOVE X'2020233030303133363431' TO DFHEIV0(25:11)
 16321     CALL 'kxdfhei1' USING DFHEIV0,
 16322           PI-KEY,
 16323           PROGRAM-INTERFACE-BLOCK,
 16324           PI-COMM-LENGTH,
 16325           DFHEIV99,
 16326           DFHEIV99,
 16327           DFHEIV99
 16328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16329
 16330
 16331     MOVE XCTL-EL400DMD          TO CALL-PGM.
 16332     GO TO 9200-XCTL.
 16333
 16334 8800-UNAUTHORIZED-ACCESS.
 16335     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16336     GO TO 8990-SEND-TEXT.
 16337
 16338 8810-PF23-ENTERED.
 16339     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 16340     MOVE XCTL-EL005             TO CALL-PGM.
 16341     GO TO 9200-XCTL.
 16342
 16343 8820-XCTL-ERROR.
 16344
 16345* EXEC CICS HANDLE CONDITION
 16346*        PGMIDERR (8990-SEND-TEXT)
 16347*    END-EXEC.
 16348*    MOVE '"$L                   ! H #00013660' TO DFHEIV0
 16349     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 310
* EL131.cbl
 16350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16351     MOVE X'4820233030303133363630' TO DFHEIV0(25:11)
 16352     CALL 'kxdfhei1' USING DFHEIV0
 16353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16354
 16355
 16356     MOVE SPACE                 TO PI-ENTRY-CD-1.
 16357     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 16358     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 16359     MOVE XCTL-EL005            TO CALL-PGM.
 16360     GO TO 9200-XCTL.
 16361
 16362 8990-SEND-TEXT.
 16363
 16364* EXEC CICS SEND TEXT
 16365*         FROM      (LOGOFF-TEXT)
 16366*         LENGTH    (LOGOFF-LENGTH)
 16367*         ERASE
 16368*         FREEKB
 16369*    END-EXEC.
 16370*    MOVE '8&      T  E F  H   F -   #00013671' TO DFHEIV0
 16371     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16372     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16373     MOVE X'2020233030303133363731' TO DFHEIV0(25:11)
 16374     CALL 'kxdfhei1' USING DFHEIV0,
 16375           LOGOFF-TEXT,
 16376           LOGOFF-LENGTH,
 16377           DFHEIV99,
 16378           DFHEIV99,
 16379           DFHEIV99,
 16380           DFHEIV99,
 16381           DFHEIV99,
 16382           DFHEIV99,
 16383           DFHEIV99,
 16384           DFHEIV99,
 16385           DFHEIV99,
 16386           DFHEIV99
 16387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16388
 16389
 16390     GO TO 9100-RETURN-CICS.
 16391
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 311
* EL131.cbl
 16393 9000-RETURN-TRANS.
 16394
 16395* EXEC CICS RETURN
 16396*         TRANSID   (TRANS-ID)
 16397*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16398*         LENGTH    (PI-COMM-LENGTH)
 16399*    END-EXEC.
 16400*    MOVE '.(CT                  ''   #00013682' TO DFHEIV0
 16401     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16402     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16403     MOVE X'2020233030303133363832' TO DFHEIV0(25:11)
 16404     CALL 'kxdfhei1' USING DFHEIV0,
 16405           TRANS-ID,
 16406           PROGRAM-INTERFACE-BLOCK,
 16407           PI-COMM-LENGTH,
 16408           DFHEIV99,
 16409           DFHEIV99,
 16410           DFHEIV99
 16411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16412
 16413
 16414
 16415* GOBACK.
 16416     MOVE '9%                    "   ' TO DFHEIV0
 16417     MOVE 'EL131' TO DFHEIV1
 16418     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16419     GOBACK.
 16420
 16421 9100-RETURN-CICS.
 16422
 16423* EXEC CICS RETURN
 16424*    END-EXEC.
 16425*    MOVE '.(                    ''   #00013691' TO DFHEIV0
 16426     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16428     MOVE X'2020233030303133363931' TO DFHEIV0(25:11)
 16429     CALL 'kxdfhei1' USING DFHEIV0,
 16430           DFHEIV99,
 16431           DFHEIV99,
 16432           DFHEIV99,
 16433           DFHEIV99,
 16434           DFHEIV99,
 16435           DFHEIV99
 16436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16437
 16438
 16439
 16440* GOBACK.
 16441     MOVE '9%                    "   ' TO DFHEIV0
 16442     MOVE 'EL131' TO DFHEIV1
 16443     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16444     GOBACK.
 16445
 16446 9200-XCTL.
 16447
 16448* EXEC CICS XCTL
 16449*         PROGRAM    (CALL-PGM)
 16450*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 312
* EL131.cbl
 16451*         LENGTH     (PI-COMM-LENGTH)
 16452*    END-EXEC.
 16453*    MOVE '.$C                   %   #00013697' TO DFHEIV0
 16454     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16455     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16456     MOVE X'2020233030303133363937' TO DFHEIV0(25:11)
 16457     CALL 'kxdfhei1' USING DFHEIV0,
 16458           CALL-PGM,
 16459           PROGRAM-INTERFACE-BLOCK,
 16460           PI-COMM-LENGTH,
 16461           DFHEIV99
 16462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16463
 16464
 16465 9700-LINK-RTRM-FILE-ID.
 16466
 16467* EXEC CICS LINK
 16468*        PROGRAM  (RTRM-FILE-ID)
 16469*        COMMAREA (CALCULATION-PASS-AREA)
 16470*        LENGTH   (CP-COMM-LENGTH)
 16471*    END-EXEC.
 16472*    MOVE '."C                   (   #00013704' TO DFHEIV0
 16473     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16474     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16475     MOVE X'2020233030303133373034' TO DFHEIV0(25:11)
 16476     CALL 'kxdfhei1' USING DFHEIV0,
 16477           RTRM-FILE-ID,
 16478           CALCULATION-PASS-AREA,
 16479           CP-COMM-LENGTH,
 16480           DFHEIV99,
 16481           DFHEIV99,
 16482           DFHEIV99,
 16483           DFHEIV99
 16484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16485
 16486
 16487 9700-EXIT.
 16488      EXIT.
 16489
 16490 9800-CONVERT-DATE.
 16491     MOVE SPACES TO DC-ERROR-CODE.
 16492
 16493* EXEC CICS LINK
 16494*         PROGRAM    (DATE-CONV)
 16495*         COMMAREA   (DATE-CONVERSION-DATA)
 16496*         LENGTH     (DC-COMM-LENGTH)
 16497*    END-EXEC.
 16498*    MOVE '."C                   (   #00013715' TO DFHEIV0
 16499     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16501     MOVE X'2020233030303133373135' TO DFHEIV0(25:11)
 16502     CALL 'kxdfhei1' USING DFHEIV0,
 16503           DATE-CONV,
 16504           DATE-CONVERSION-DATA,
 16505           DC-COMM-LENGTH,
 16506           DFHEIV99,
 16507           DFHEIV99,
 16508           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 313
* EL131.cbl
 16509           DFHEIV99
 16510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16511
 16512
 16513 9800-EXIT.
 16514     EXIT.
 16515
 16516 9900-ERROR-FORMAT.
 16517
 16518* EXEC CICS LINK
 16519*         PROGRAM    (XCTL-EL001)
 16520*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 16521*         LENGTH     (EMI-COMM-LENGTH)
 16522*    END-EXEC.
 16523*    MOVE '."C                   (   #00013725' TO DFHEIV0
 16524     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16526     MOVE X'2020233030303133373235' TO DFHEIV0(25:11)
 16527     CALL 'kxdfhei1' USING DFHEIV0,
 16528           XCTL-EL001,
 16529           ERROR-MESSAGE-INTERFACE-BLOCK,
 16530           EMI-COMM-LENGTH,
 16531           DFHEIV99,
 16532           DFHEIV99,
 16533           DFHEIV99,
 16534           DFHEIV99
 16535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16536
 16537
 16538 9900-EXIT.
 16539     EXIT.
 16540
 16541 9990-ABEND.
 16542     MOVE DFHEIBLK               TO EMI-LINE1.
 16543
 16544* EXEC CICS LINK
 16545*         PROGRAM   (XCTL-EL004)
 16546*         COMMAREA  (EMI-LINE1)
 16547*         LENGTH    (72)
 16548*     END-EXEC.
 16549     MOVE 72
 16550       TO DFHEIV11
 16551*    MOVE '."C                   (   #00013736' TO DFHEIV0
 16552     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16554     MOVE X'2020233030303133373336' TO DFHEIV0(25:11)
 16555     CALL 'kxdfhei1' USING DFHEIV0,
 16556           XCTL-EL004,
 16557           EMI-LINE1,
 16558           DFHEIV11,
 16559           DFHEIV99,
 16560           DFHEIV99,
 16561           DFHEIV99,
 16562           DFHEIV99
 16563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16564
 16565
 16566     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 314
* EL131.cbl
 16567
 16568     GO TO 8110-SEND-DATA.
 16569
 16570 9995-SECURITY-VIOLATION.
 16571*           COPY ELCSCTP.
 16572******************************************************************
 16573*                                                                *
 16574*                            ELCSCTP                             *
 16575*                            VMOD=2.001                          *
 16576*                                                                *
 16577*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16578******************************************************************
 16579
 16580
 16581     MOVE EIBDATE          TO SM-JUL-DATE.
 16582     MOVE EIBTRMID         TO SM-TERMID.
 16583     MOVE THIS-PGM         TO SM-PGM.
 16584     MOVE EIBTIME          TO TIME-IN.
 16585     MOVE TIME-OUT         TO SM-TIME.
 16586     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16587
 16588
 16589* EXEC CICS LINK
 16590*         PROGRAM  ('EL003')
 16591*         COMMAREA (SECURITY-MESSAGE)
 16592*         LENGTH   (80)
 16593*    END-EXEC.
 16594     MOVE 'EL003' TO DFHEIV1
 16595     MOVE 80
 16596       TO DFHEIV11
 16597*    MOVE '."C                   (   #00013764' TO DFHEIV0
 16598     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16600     MOVE X'2020233030303133373634' TO DFHEIV0(25:11)
 16601     CALL 'kxdfhei1' USING DFHEIV0,
 16602           DFHEIV1,
 16603           SECURITY-MESSAGE,
 16604           DFHEIV11,
 16605           DFHEIV99,
 16606           DFHEIV99,
 16607           DFHEIV99,
 16608           DFHEIV99
 16609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16610
 16611
 16612******************************************************************
 16613
 16614
 16615
 16616 9999-DFHBACK SECTION.
 16617     MOVE '9%                    "   ' TO DFHEIV0
 16618     MOVE 'EL131' TO DFHEIV1
 16619     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16620     GOBACK.
 16621 9999-DFHEXIT.
 16622     IF DFHEIGDJ EQUAL 0001
 16623         NEXT SENTENCE
 16624     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 315
* EL131.cbl
 16625         GO TO 8820-XCTL-ERROR,
 16626               8150-ENTERED-CLAIM-NOTFOUND,
 16627               9990-ABEND
 16628         DEPENDING ON DFHEIGDI
 16629     ELSE IF DFHEIGDJ EQUAL 3
 16630         GO TO 0130-TS-ERROR,
 16631               0130-TS-ERROR
 16632         DEPENDING ON DFHEIGDI
 16633     ELSE IF DFHEIGDJ EQUAL 4
 16634         GO TO 0600-CONTINUE-NAME-UPDATE
 16635         DEPENDING ON DFHEIGDI
 16636     ELSE IF DFHEIGDJ EQUAL 5
 16637         GO TO 1004-BENE-NOT-FOUND
 16638         DEPENDING ON DFHEIGDI
 16639     ELSE IF DFHEIGDJ EQUAL 6
 16640         GO TO 1120-CNTL-NOTFND
 16641         DEPENDING ON DFHEIGDI
 16642     ELSE IF DFHEIGDJ EQUAL 7
 16643         GO TO 1150-NOTOPEN-ERROR,
 16644               1150-EXIT
 16645         DEPENDING ON DFHEIGDI
 16646     ELSE IF DFHEIGDJ EQUAL 8
 16647         GO TO 1490-STATE-NOTFND
 16648         DEPENDING ON DFHEIGDI
 16649     ELSE IF DFHEIGDJ EQUAL 9
 16650         GO TO 1500-CARR-NOTFND
 16651         DEPENDING ON DFHEIGDI
 16652     ELSE IF DFHEIGDJ EQUAL 10
 16653         GO TO 1620-ACCT-NOTFND
 16654         DEPENDING ON DFHEIGDI
 16655     ELSE IF DFHEIGDJ EQUAL 11
 16656         GO TO 2020-EXIT
 16657         DEPENDING ON DFHEIGDI
 16658     ELSE IF DFHEIGDJ EQUAL 12
 16659         GO TO 2030-EXIT
 16660         DEPENDING ON DFHEIGDI
 16661     ELSE IF DFHEIGDJ EQUAL 13
 16662         GO TO 2040-EXIT
 16663         DEPENDING ON DFHEIGDI
 16664     ELSE IF DFHEIGDJ EQUAL 14
 16665         GO TO 2050-EXIT
 16666         DEPENDING ON DFHEIGDI
 16667     ELSE IF DFHEIGDJ EQUAL 15
 16668         GO TO 2060-CERT-NOTFND
 16669         DEPENDING ON DFHEIGDI
 16670     ELSE IF DFHEIGDJ EQUAL 16
 16671         GO TO 2060-DUPKEY
 16672         DEPENDING ON DFHEIGDI
 16673     ELSE IF DFHEIGDJ EQUAL 17
 16674         GO TO 2070-NOT-FOUND
 16675         DEPENDING ON DFHEIGDI
 16676     ELSE IF DFHEIGDJ EQUAL 18
 16677         GO TO 2070-EXIT
 16678         DEPENDING ON DFHEIGDI
 16679     ELSE IF DFHEIGDJ EQUAL 19
 16680         GO TO 2080-EXIT
 16681         DEPENDING ON DFHEIGDI
 16682     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 316
* EL131.cbl
 16683         GO TO 2400-TRLR-NOTFND,
 16684               2410-EXIT
 16685         DEPENDING ON DFHEIGDI
 16686     ELSE IF DFHEIGDJ EQUAL 21
 16687         GO TO 2425-NINETY-NOTFND,
 16688               2425-NINETY-NOTFND
 16689         DEPENDING ON DFHEIGDI
 16690     ELSE IF DFHEIGDJ EQUAL 22
 16691         GO TO 2430-EXIT,
 16692               2440-EXIT
 16693         DEPENDING ON DFHEIGDI
 16694     ELSE IF DFHEIGDJ EQUAL 23
 16695         GO TO 2440-EXIT
 16696         DEPENDING ON DFHEIGDI
 16697     ELSE IF DFHEIGDJ EQUAL 24
 16698         GO TO 2460-EXIT
 16699         DEPENDING ON DFHEIGDI
 16700     ELSE IF DFHEIGDJ EQUAL 25
 16701         GO TO 2475-EXIT
 16702         DEPENDING ON DFHEIGDI
 16703     ELSE IF DFHEIGDJ EQUAL 26
 16704         GO TO 2650-EXIT
 16705         DEPENDING ON DFHEIGDI
 16706     ELSE IF DFHEIGDJ EQUAL 27
 16707         GO TO 2800-EXIT,
 16708               2800-EXIT
 16709         DEPENDING ON DFHEIGDI
 16710     ELSE IF DFHEIGDJ EQUAL 28
 16711         GO TO 3010-DEL-ACTQ,
 16712               3040-EXIT
 16713         DEPENDING ON DFHEIGDI
 16714     ELSE IF DFHEIGDJ EQUAL 29
 16715         GO TO 3010-NO-ACTIVITY,
 16716               3050-EXIT
 16717         DEPENDING ON DFHEIGDI
 16718     ELSE IF DFHEIGDJ EQUAL 30
 16719         GO TO 3010-CERT-NOT-FOUND
 16720         DEPENDING ON DFHEIGDI
 16721     ELSE IF DFHEIGDJ EQUAL 31
 16722         GO TO 3020-EXIT
 16723         DEPENDING ON DFHEIGDI
 16724     ELSE IF DFHEIGDJ EQUAL 32
 16725         GO TO 3060-EXIT,
 16726               3060-EXIT
 16727         DEPENDING ON DFHEIGDI
 16728     ELSE IF DFHEIGDJ EQUAL 33
 16729         GO TO 5000-TRLR-NOT-FOUND
 16730         DEPENDING ON DFHEIGDI
 16731     ELSE IF DFHEIGDJ EQUAL 34
 16732         GO TO 5000-CERT-NOT-FOUND
 16733         DEPENDING ON DFHEIGDI
 16734     ELSE IF DFHEIGDJ EQUAL 35
 16735         GO TO 7630-END-BROWSE
 16736         DEPENDING ON DFHEIGDI
 16737     ELSE IF DFHEIGDJ EQUAL 36
 16738         GO TO 7799-EXIT,
 16739               7799-EXIT
 16740         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 317
* EL131.cbl
 16741     ELSE IF DFHEIGDJ EQUAL 37
 16742         GO TO 7799-EXIT
 16743         DEPENDING ON DFHEIGDI
 16744     ELSE IF DFHEIGDJ EQUAL 38
 16745         GO TO 7800-NOT-FOUND
 16746         DEPENDING ON DFHEIGDI
 16747     ELSE IF DFHEIGDJ EQUAL 39
 16748         GO TO 8000-NOTE-NOT-FOUND
 16749         DEPENDING ON DFHEIGDI
 16750     ELSE IF DFHEIGDJ EQUAL 40
 16751         GO TO 8990-SEND-TEXT
 16752         DEPENDING ON DFHEIGDI.
 16753     MOVE '9%                    "   ' TO DFHEIV0
 16754     MOVE 'EL131' TO DFHEIV1
 16755     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16756     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13468     Code:       57119
