* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    45* 121417  IR2017121200001  PEMA  Correct assignment of ben period
    46* 011118  CR2016052500002  TANA  Add Message for pre-existing
    47* 052918  CR2018031500002  TANA  Add Message for filing time limit
    48* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    49******************************************************************
    50
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   3
* EL130.cbl
    52 ENVIRONMENT DIVISION.
    53 DATA DIVISION.
    54 WORKING-STORAGE SECTION.
    55 01  DFH-START PIC X(04).
    56 77  FILLER  PIC X(32)  VALUE '********************************'.
    57 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    58 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    59 77  A1                          PIC S999 COMP-3 VALUE +0.
    60 77  E1                          PIC S999 COMP-3 VALUE +0.
    61 77  s1                          pic s999 comp-3 value +0.
    62 77  s2                          pic s999 comp-3 value +0.
    63 77  P1                          PIC S999 COMP-3 VALUE +0.
    64 77  P2                          PIC S999 COMP-3 VALUE +0.
    65 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    66 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    67 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    68 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    69 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    70 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    71 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    72 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    73     88  ERPDEF-FOUND                 VALUE 'Y'.
    74 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    75 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    76 77  ws-dcc-product-code         pic xxx value spaces.
    77 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    78 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    79 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    80 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    81 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    82 77  ws-zero-bens-avail          pic x value ' '.
    83 77  WS-PRE-EXISTING-PER         PIC 99    VALUE ZEROS.
    84*    COPY ELCSCTM.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCTM                             *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    92*                                                                *
    93******************************************************************
    94 01  SECURITY-MESSAGE.
    95     12  FILLER                          PIC X(30)
    96            VALUE '** LOGIC SECURITY VIOLATION -'.
    97     12  SM-READ                         PIC X(6).
    98     12  FILLER                          PIC X(5)
    99            VALUE ' PGM='.
   100     12  SM-PGM                          PIC X(6).
   101     12  FILLER                          PIC X(5)
   102            VALUE ' OPR='.
   103     12  SM-PROCESSOR-ID                 PIC X(4).
   104     12  FILLER                          PIC X(6)
   105            VALUE ' TERM='.
   106     12  SM-TERMID                       PIC X(4).
   107     12  FILLER                          PIC XX   VALUE SPACE.
   108     12  SM-JUL-DATE                     PIC 9(5).
   109     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   4
* EL130.cbl
   110     12  SM-TIME                         PIC 99.99.
   111
   112
   113*    COPY ELCSCRTY.
   114******************************************************************
   115*                                                                *
   116*                                                                *
   117*                            ELCSCRTY                            *
   118*                            VMOD=2.001                          *
   119*                                                                *
   120*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   121*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   122*        SAVED IN PI-SECURITY-ADDRESS.                           *
   123*                                                                *
   124******************************************************************
   125 01  SECURITY-CONTROL.
   126     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   127     12  FILLER                       PIC XX    VALUE 'SC'.
   128     12  SC-CREDIT-CODES.
   129         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   130             20  SC-CREDIT-DISPLAY    PIC X.
   131             20  SC-CREDIT-UPDATE     PIC X.
   132     12  SC-CLAIMS-CODES.
   133         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   134             20  SC-CLAIMS-DISPLAY    PIC X.
   135             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   5
* EL130.cbl
   137 01  WS-DATE-AREA.
   138     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   139     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   140     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   141
   142 01  ws-dcc-error-line.
   143     05  filler occurs 15.
   144         10  ws-error-no        pic x(4).
   145 01  WS-CRI-SSN-WORK-AREA.
   146     05  WS-CRI-SOC-SEC-NO.
   147         10  WS-SS-REPT-CD       PIC X(5).
   148         10  WS-SS-LAST-NAME     PIC X(5).
   149         10  WS-SS-INITIAL       PIC X.
   150
   151     05  WS-CRI-REPORT-CODE.
   152         10  FILLER              PIC X(5).
   153         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   154
   155     05  WS-CRI-LAST-NAME.
   156         10  WS-CRI-NAME-MOVE    PIC X(5).
   157         10  FILLER              PIC X(10).
   158
   159 01  STANDARD-AREAS.
   160     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   161     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   162     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   163     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   164     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   165     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   166     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   167     12  PGM-NAME            PIC X(8).
   168     12  TIME-IN             PIC S9(7).
   169     12  TIME-OUT-R  REDEFINES TIME-IN.
   170         16  FILLER          PIC X.
   171         16  TIME-OUT        PIC 99V99.
   172         16  FILLER          PIC X(2).
   173     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   174     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   175     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   176     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   177     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   178     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   179     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   180     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   181     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   182     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   183     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   184     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   185     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   186     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   187     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   188     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   189     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   190     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   191     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   192     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   193     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   194     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   6
* EL130.cbl
   195     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   196     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   197     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   198     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   199     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   200     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   201     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   202     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   203     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   204     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   205     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   206     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   207     12  FILE-ID             PIC X(8).
   208     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   209     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   210     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   211     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   212     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   213     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   214     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   215     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   216     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   217
   218 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   219     12  M                   PIC S9(7)V99           VALUE ZEROS.
   220     12  L                   PIC S9(7)V99           VALUE ZEROS.
   221     12  N                   PIC S9(3)              VALUE ZEROS.
   222     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   223     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   224     12  I                   PIC S99V9(5)           VALUE ZEROS.
   225     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   226     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   227     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   228     12  R                   PIC S9(3)              VALUE ZEROS.
   229     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   230     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   231     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   232     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   233     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   234     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   235     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   236     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   237     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   238
   239 01  TERM-CALC-WORK-AREA.
   240     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   241     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   242     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   243     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   244     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   245     12  V-EXPONENTS.
   246        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   247     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   248
   249 01  MISC-WORK-AREAS.
   250     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   251     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   252     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   7
* EL130.cbl
   253     12  QID.
   254         16  QID-TERM        PIC X(4).
   255         16  FILLER          PIC X(4)    VALUE '130A'.
   256     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   257     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   258     12  WS-GROUP-NO.
   259         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   260         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   261
   262     12  WS-RESPONSE         PIC S9(8)   COMP.
   263         88  WS-RESP-NORMAL              VALUE +00.
   264         88  WS-RESP-ERROR               VALUE +01.
   265         88  WS-RESP-NOTFND              VALUE +13.
   266         88  WS-RESP-DUPKEY              VALUE +15.
   267         88  WS-RESP-NOTOPEN             VALUE +19.
   268         88  WS-RESP-ENDFILE             VALUE +20.
   269
   270***************************************************************
   271*                                                             *
   272*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   273*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   274*    CHANGES WITH IN MAP EL130A.                              *
   275*                                                             *
   276***************************************************************
   277
   278     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   279     12  WS-SAVE-CLAIM-MASTER.
   280         16  FILLER                    PIC XX.
   281         16  WS-SAVE-CLAIM-KEY.
   282             20  WS-SAVE-COMPANY-CD    PIC X.
   283             20  WS-SAVE-CARRIER       PIC X.
   284             20  WS-SAVE-CLAIM-NO      PIC X(7).
   285             20  WS-SAVE-CERT-NO       PIC X(11).
   286         16  FILLER                    PIC X(328).
   287     12  SAVE-CURRENT-DATE         PIC XX.
   288     12  SAVE-CONTROL              PIC X(39).
   289     12  SAVE-ERACCT-KEY           PIC X(26).
   290     12  SAVE-COUNTER              PIC S9(8)   COMP.
   291     12  SAVE-METHOD               PIC X.
   292     12  SAVE-COMPANY-ID           PIC XXX.
   293     12  SAVE-COMPANY-CD           PIC X.
   294     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   295     12  SAVE-CREDIT-USER          PIC X.
   296     12  SAVE-CLAIM-USER           PIC X.
   297     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   298     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   299     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   300     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   301     12  SAVE-AH-OVERRIDE-L1       PIC X.
   302     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   303     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   304     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   305     12  FILLER                    PIC X.
   306*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   307     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   308     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   309     12  SAVE-EL127-TO-EL130-CNTRL.
   310         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   8
* EL130.cbl
   311         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   312         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   313             20  SAVE-EL127-CARRIER  PIC X.
   314             20  SAVE-EL127-GROUPING PIC X(6).
   315             20  SAVE-EL127-STATE    PIC X(2).
   316             20  SAVE-EL127-ACCOUNT  PIC X(10).
   317             20  SAVE-EL127-CERT-NO  PIC X(11).
   318             20  SAVE-EL127-EFF-DT   PIC XX.
   319     12  SAVE-EL659-TO-EL130-CNTRL.
   320         16  SAVE-EL659-CARRIER    PIC X.
   321         16  SAVE-EL659-GROUPING   PIC X(6).
   322         16  SAVE-EL659-STATE      PIC XX.
   323         16  SAVE-EL659-ACCOUNT    PIC X(10).
   324     12  DIVIDE-QUOT               PIC 999.
   325     12  DIVIDE-REM                PIC 999.
   326     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   327     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   328     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   329     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   330     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   331     12  WS-RESERVE-CONTROLS       PIC X(9).
   332     12  WS-EXPENSE-CONTROLS       PIC X(7).
   333     12  WS-REIN-TABLE.
   334         16  WS-REIN-1             PIC X            VALUE SPACE.
   335         16  WS-REIN-2             PIC X            VALUE SPACE.
   336         16  WS-REIN-3             PIC X            VALUE SPACE.
   337     12  WS-BENE-CALC-METHOD       PIC X.
   338     12  ws-lf-joint-indicator     pic x.
   339     12  ws-ah-joint-indicator     pic x.
   340     12  WS-EARNINGS-CALC          PIC X.
   341     12  WS-LF-EARNINGS-CALC       PIC X.
   342         88 TEX-REG                VALUE '4'.
   343         88 NET-PAY                VALUE '5'.
   344     12  WS-AH-EARNINGS-CALC       PIC X.
   345     12  WS-SPECIAL-CALC-CD        PIC X(01).
   346     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   347     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   348     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   349     12  WS-ICD-CODE-1             PIC X(8).
   350     12  WS-ICD-CODE-2             PIC X(8).
   351     12  WS-CLAIM-NUMBER.
   352         16  WS-CN-PREFIX.
   353             20  WS-CN-PRF-A PIC X.
   354             20  WS-CN-PRF-B PIC X.
   355         16  WS-CN-NUMBER    PIC 9(5).
   356     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   357     12  WS-CLAIM-SEQU.
   358         16  FILLER          PIC X    VALUE '('.
   359         16  WS-CURRENT-SEQU PIC Z9.
   360         16  FILLER          PIC X(4) VALUE ' OF '.
   361         16  WS-OF-SEQU      PIC Z9.
   362         16  FILLER          PIC X    VALUE ')'.
   363     12  DATE-WORK.
   364       14  FILLER                PIC XX.
   365       14  DATE-MM               PIC XX.
   366       14  DATE-DD               PIC XX.
   367       14  DATE-YY               PIC XX.
   368     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page   9
* EL130.cbl
   369         16  CURR-MM.
   370           18  CURR-M1           PIC 9.
   371           18  CURR-M2           PIC 9.
   372         16  FILLER              PIC X(5).
   373         16  CURR-YEAR           PIC 9.
   374     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   375     12  SUB                     PIC 99.
   376     12  MY-DATE.
   377         16  MY-MM               PIC XX.
   378         16  FILLER              PIC X VALUE '/'.
   379         16  MY-YY               PIC XX.
   380
   381     12  WS-EDIT-BEN-CODE        PIC XX.
   382         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   383                                          '90' THRU '99'.
   384
   385     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   386     12  WS-BEN-HOLD             PIC XX.
   387     12  WS-BEN-ALPHA-HOLD.
   388         15  WS-BEN-ALPHA-2      PIC XX.
   389         15  WS-BEN-ALPHA-1      PIC X.
   390     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   391     12  WS-REC-TYPE             PIC X.
   392     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   393     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   394     12  ARCH-NUMBER             PIC S9(8)   COMP.
   395     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   396         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   397         88  REIN-REC-FOUND                  VALUE 'Y'.
   398
   399     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   400     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   401
   402
   403 01  CSO-WORK-FIELDS.
   404     12  WS-BLANK            PIC X       VALUE ' '.
   405
   406     12  WS-MA-CONTROL-PRIMARY.
   407         16  WS-MA-COMPANY-CD        PIC  X.
   408         16  WS-MA-CARRIER           PIC  X.
   409         16  WS-MA-GROUPING          PIC  X(6).
   410         16  WS-MA-STATE             PIC  XX.
   411         16  WS-MA-ACCOUNT           PIC  X(10).
   412         16  WS-MA-CERT-EFF-DT       PIC  XX.
   413         16  WS-MA-CERT-NO.
   414             20  WS-MA-CERT-PRIME    PIC  X(10).
   415             20  WS-MA-CERT-SFX      PIC  X.
   416
   417     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   418     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   419     12  WS-SOC-SEC-NUMBER.
   420         16  WS-SOC-SEC-NO       PIC 9(9).
   421         16  WS-SOC-SEC-BLANK    PIC X(2).
   422     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   423         16  WS-SSN-1-3          PIC 9(3).
   424         16  WS-SSN-DASH1        PIC X(1).
   425         16  WS-SSN-4-5          PIC 9(2).
   426         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  10
* EL130.cbl
   427         16  WS-SSN-6-9          PIC 9(4).
   428
   429     12  WS-DIAG-VIN-MSG.
   430         16  FILLER          PIC X(11)
   431             VALUE 'VIN NUMBER '.
   432         16  WS-DIAG-VIN     PIC X(17).
   433
   434     12  WS-VERIFY-NOTE      PIC X(34)
   435         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   436
   437     12  WS-CAUSAL-NOTE      PIC X(40)
   438         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   439
   440     12  WS-VFY-SSN-NOTE     PIC X(25)
   441         VALUE 'SSN VERIFICATION REQUIRED'.
   442
   443     12  WS-FILING-NOTE     PIC X(30)
   444         VALUE 'FILING TIME LIMIT EXCEEDED'.
   445
   446 01  MAP-DATE-AREAS.
   447     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   448     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   449     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   450     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   451     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   452     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   453     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   454     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   455     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   456     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   457     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   458     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   459     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   460     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   461     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   462     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   463     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   464     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   465     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   466         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   467     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   468     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   469     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   470     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   471
   472 01  ACCESS-KEYS.
   473     12  ELACTQ-KEY.
   474         16  ELACTQ-COMPANY-CD       PIC X.
   475         16  ELACTQ-CARRIER          PIC X.
   476         16  ELACTQ-CLAIM-NO         PIC X(7).
   477         16  ELACTQ-CERT-NO          PIC X(11).
   478     12  ELMSTR-KEY.
   479         16  MSTR-COMP-CD            PIC X.
   480         16  MSTR-CARRIER            PIC X.
   481         16  MSTR-CLAIM-NO           PIC X(7).
   482         16  MSTR-CERT-NO.
   483             20  MSTR-CERT-NO-PRIME  PIC X(10).
   484             20  MSTR-CERT-NO-SUFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  11
* EL130.cbl
   485     12  SAVE-ELMSTR-KEY.
   486         16  SAVE-COMP-CD            PIC X.
   487         16  SAVE-CARRIER            PIC X.
   488         16  SAVE-CLAIM-NO           PIC X(7).
   489         16  SAVE-CERT-NO.
   490             20  SAVE-CERT-NO-PRIME  PIC X(10).
   491             20  SAVE-CERT-NO-SUFX   PIC X.
   492     12  ELMSTR5-KEY.
   493         16  MSTR5-COMP-CD           PIC X.
   494         16  MSTR5-CERT-NO.
   495             20  MSTR5-CERT-NO-PRIME PIC X(10).
   496             20  MSTR5-CERT-NO-SUFX  PIC X.
   497     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   498         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   499         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   500         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   501     12  ELCNTL-KEY.
   502         16  CNTL-COMP-ID    PIC X(3).
   503         16  CNTL-REC-TYPE   PIC X.
   504         16  CNTL-ACCESS.
   505             20  FILLER      PIC XX.
   506             20  CNTL-BENEFIT.
   507                 24  FILLER  PIC X.
   508                 24  CNTL-CARRIER PIC X.
   509         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   510     12  ELCERT-KEY.
   511         16  CERT-COMP-CD    PIC X.
   512         16  CERT-CARRIER    PIC X.
   513         16  CERT-GROUPING   PIC X(6).
   514         16  CERT-STATE      PIC X(2).
   515         16  CERT-ACCOUNT.
   516             20  CERT-ACCOUNT-PREFIX PIC X(4).
   517             20  CERT-ACCOUNT-PRIME  PIC X(6).
   518         16  CERT-EFF-DT     PIC XX.
   519         16  CERT-CERT-NO.
   520             20  CERT-CERT-NO-PRIME  PIC X(10).
   521             20  CERT-CERT-NO-SUFX   PIC X.
   522     12  ELCERT-KEY-5.
   523         16  CERT-COMP-CD-5      PIC X.
   524         16  CERT-CERT-5.
   525             20  CERT-CERT-5-PRIME   PIC X(10).
   526             20  CERT-CERT-5-SUFX    PIC X.
   527     12  ERACCT-KEY.
   528         16  ACCT-COMP-CD    PIC X.
   529         16  ACCT-CARRIER    PIC X.
   530         16  ACCT-GROUPING   PIC X(6).
   531         16  ACCT-STATE      PIC X(2).
   532         16  ACCT-ACCOUNT    PIC X(10).
   533         16  ACCT-EXP-DT     PIC XX.
   534     12  ELTRLR-KEY.
   535         16  TRLR-COMP-CD    PIC X.
   536         16  TRLR-CARRIER    PIC X.
   537         16  TRLR-CLAIM-NO   PIC X(7).
   538         16  TRLR-CERT-NO.
   539             20  TRLR-CERT-NO-PRIME  PIC X(10).
   540             20  TRLR-CERT-NO-SUFX   PIC X.
   541         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   542         16  TRLR-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  12
* EL130.cbl
   543     12  ELBENE-KEY.
   544         16  BENE-COMP-CD    PIC X.
   545         16  BENE-RCD-TYPE   PIC X.
   546         16  BENE-CODE       PIC X(10).
   547     12  ERREIN-KEY.
   548         16  REIN-COMP-CD        PIC X(01).
   549         16  REIN-TYPE           PIC X(01).
   550         16  REIN-TABLE-CO.
   551             20  REIN-CODE-1     PIC X(01).
   552             20  REIN-CODE-2     PIC X(01).
   553             20  REIN-CODE-3     PIC X(01).
   554         16  FILLER              PIC X(03).
   555     12  ELCRTT-KEY.
   556         16  CTRLR-COMP-CD       PIC X.
   557         16  CTRLR-CARRIER       PIC X.
   558         16  CTRLR-GROUPING      PIC X(6).
   559         16  CTRLR-STATE         PIC X(2).
   560         16  CTRLR-ACCOUNT       PIC X(10).
   561         16  CTRLR-EFF-DT        PIC XX.
   562         16  CTRLR-CERT-NO       PIC X(11).
   563         16  CTRLR-REC-TYPE      PIC X.
   564 01  ws-acct-found-sw            pic x value ' '.
   565     88  acct-found                value 'Y'.
   566 01  ERPDEF-KEY-SAVE             PIC X(18).
   567 01  ERPDEF-KEY.
   568     12  ERPDEF-COMPANY-CD       PIC X.
   569     12  ERPDEF-STATE            PIC XX.
   570     12  ERPDEF-PROD-CD          PIC XXX.
   571     12  F                       PIC X(7).
   572     12  ERPDEF-BEN-TYPE         PIC X.
   573     12  ERPDEF-BEN-CODE         PIC XX.
   574     12  ERPDEF-EXP-DT           PIC XX.
   575 01  ERROR-MESSAGES.
   576     12  ER-0000                 PIC X(4)  VALUE '0000'.
   577     12  ER-0004                 PIC X(4)  VALUE '0004'.
   578     12  ER-0019                 PIC X(4)  VALUE '0019'.
   579     12  ER-0023                 PIC X(4)  VALUE '0023'.
   580     12  ER-0029                 PIC X(4)  VALUE '0029'.
   581     12  ER-0033                 PIC X(4)  VALUE '0033'.
   582     12  ER-0068                 PIC X(4)  VALUE '0068'.
   583     12  ER-0070                 PIC X(4)  VALUE '0070'.
   584     12  ER-0194                 PIC X(4)  VALUE '0194'.
   585     12  ER-0202                 PIC X(4)  VALUE '0202'.
   586     12  ER-0203                 PIC X(4)  VALUE '0203'.
   587     12  ER-0204                 PIC X(4)  VALUE '0204'.
   588     12  ER-0205                 PIC X(4)  VALUE '0205'.
   589     12  ER-0206                 PIC X(4)  VALUE '0206'.
   590     12  ER-0207                 PIC X(4)  VALUE '0207'.
   591     12  ER-0213                 PIC X(4)  VALUE '0213'.
   592     12  ER-0214                 PIC X(4)  VALUE '0214'.
   593     12  ER-0217                 PIC X(4)  VALUE '0217'.
   594     12  ER-0219                 PIC X(4)  VALUE '0219'.
   595     12  ER-0220                 PIC X(4)  VALUE '0220'.
   596     12  ER-0221                 PIC X(4)  VALUE '0221'.
   597     12  ER-0222                 PIC X(4)  VALUE '0222'.
   598     12  ER-0223                 PIC X(4)  VALUE '0223'.
   599     12  ER-0224                 PIC X(4)  VALUE '0224'.
   600     12  ER-0225                 PIC X(4)  VALUE '0225'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  13
* EL130.cbl
   601     12  ER-0226                 PIC X(4)  VALUE '0226'.
   602     12  ER-0227                 PIC X(4)  VALUE '0227'.
   603     12  ER-0229                 PIC X(4)  VALUE '0229'.
   604     12  ER-0230                 PIC X(4)  VALUE '0230'.
   605     12  ER-0231                 PIC X(4)  VALUE '0231'.
   606     12  ER-0232                 PIC X(4)  VALUE '0232'.
   607     12  ER-0233                 PIC X(4)  VALUE '0233'.
   608     12  ER-0234                 PIC X(4)  VALUE '0234'.
   609     12  ER-0235                 PIC X(4)  VALUE '0235'.
   610     12  ER-0236                 PIC X(4)  VALUE '0236'.
   611     12  ER-0237                 PIC X(4)  VALUE '0237'.
   612     12  ER-0238                 PIC X(4)  VALUE '0238'.
   613     12  ER-0239                 PIC X(4)  VALUE '0239'.
   614     12  ER-0240                 PIC X(4)  VALUE '0240'.
   615     12  ER-0241                 PIC X(4)  VALUE '0241'.
   616     12  ER-0243                 PIC X(4)  VALUE '0243'.
   617     12  ER-0244                 PIC X(4)  VALUE '0244'.
   618     12  ER-0245                 PIC X(4)  VALUE '0245'.
   619     12  ER-0246                 PIC X(4)  VALUE '0246'.
   620     12  ER-0247                 PIC X(4)  VALUE '0247'.
   621     12  ER-0248                 PIC X(4)  VALUE '0248'.
   622     12  ER-0250                 PIC X(4)  VALUE '0250'.
   623     12  ER-0251                 PIC X(4)  VALUE '0251'.
   624     12  ER-0252                 PIC X(4)  VALUE '0252'.
   625     12  ER-0253                 PIC X(4)  VALUE '0253'.
   626     12  ER-0254                 PIC X(4)  VALUE '0254'.
   627     12  ER-0257                 PIC X(4)  VALUE '0257'.
   628     12  ER-0258                 PIC X(4)  VALUE '0258'.
   629     12  ER-0260                 PIC X(4)  VALUE '0260'.
   630     12  ER-0261                 PIC X(4)  VALUE '0261'.
   631     12  ER-0263                 PIC X(4)  VALUE '0263'.
   632     12  ER-0264                 PIC X(4)  VALUE '0264'.
   633     12  ER-0265                 PIC X(4)  VALUE '0265'.
   634     12  ER-0266                 PIC X(4)  VALUE '0266'.
   635     12  ER-0267                 PIC X(4)  VALUE '0267'.
   636     12  ER-0334                 PIC X(4)  VALUE '0334'.
   637     12  ER-0337                 PIC X(4)  VALUE '0337'.
   638     12  ER-0412                 PIC X(4)  VALUE '0412'.
   639     12  ER-0413                 PIC X(4)  VALUE '0413'.
   640     12  ER-0428                 PIC X(4)  VALUE '0428'.
   641     12  ER-0429                 PIC X(4)  VALUE '0429'.
   642     12  ER-0430                 PIC X(4)  VALUE '0430'.
   643     12  ER-0433                 PIC X(4)  VALUE '0433'.
   644     12  ER-0434                 PIC X(4)  VALUE '0434'.
   645     12  ER-0458                 PIC X(4)  VALUE '0458'.
   646     12  ER-0489                 PIC X(4)  VALUE '0489'.
   647     12  ER-0509                 PIC X(4)  VALUE '0509'.
   648     12  ER-0510                 PIC X(4)  VALUE '0510'.
   649     12  ER-0511                 PIC X(4)  VALUE '0511'.
   650     12  ER-0512                 PIC X(4)  VALUE '0512'.
   651     12  ER-0516                 PIC X(4)  VALUE '0516'.
   652     12  ER-0517                 PIC X(4)  VALUE '0517'.
   653     12  ER-0518                 PIC X(4)  VALUE '0518'.
   654     12  ER-0519                 PIC X(4)  VALUE '0519'.
   655     12  ER-0520                 PIC X(4)  VALUE '0520'.
   656     12  ER-0521                 PIC X(4)  VALUE '0521'.
   657     12  ER-0522                 PIC X(4)  VALUE '0522'.
   658     12  ER-0523                 PIC X(4)  VALUE '0523'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  14
* EL130.cbl
   659     12  ER-0544                 PIC X(4)  VALUE '0544'.
   660     12  ER-0546                 PIC X(4)  VALUE '0546'.
   661     12  ER-0558                 PIC X(4)  VALUE '0558'.
   662     12  ER-0560                 PIC X(4)  VALUE '0560'.
   663     12  ER-0562                 PIC X(4)  VALUE '0562'.
   664     12  ER-0565                 PIC X(4)  VALUE '0565'.
   665     12  ER-0569                 PIC X(4)  VALUE '0569'.
   666     12  ER-0693                 PIC X(4)  VALUE '0693'.
   667     12  ER-0715                 PIC X(4)  VALUE '0715'.
   668     12  ER-0840                 PIC X(4)  VALUE '0840'.
   669     12  ER-0841                 PIC X(4)  VALUE '0841'.
   670     12  ER-0842                 PIC X(4)  VALUE '0842'.
   671     12  ER-0843                 PIC X(4)  VALUE '0843'.
   672     12  ER-0878                 PIC X(4)  VALUE '0878'.
   673     12  ER-0887                 PIC X(4)  VALUE '0887'.
   674     12  ER-0992                 PIC X(4)  VALUE '0992'.
   675     12  ER-1651                 PIC X(4)  VALUE '1651'.
   676     12  ER-1652                 PIC X(4)  VALUE '1652'.
   677     12  ER-1653                 PIC X(4)  VALUE '1653'.
   678     12  ER-1654                 PIC X(4)  VALUE '1654'.
   679     12  ER-1655                 PIC X(4)  VALUE '1655'.
   680     12  er-1659                 pic x(4)  value '1659'.
   681     12  er-1660                 pic x(4)  value '1660'.
   682     12  er-1661                 pic x(4)  value '1661'.
   683     12  er-1671                 pic x(4)  value '1671'.
   684     12  er-1672                 pic x(4)  value '1672'.
   685     12  er-1673                 pic x(4)  value '1673'.
   686     12  er-1675                 pic x(4)  value '1675'.
   687     12  er-1676                 pic x(4)  value '1676'.
   688     12  ER-1677                 PIC X(4)  VALUE '1677'.
   689     12  ER-1679                 PIC X(4)  VALUE '1679'.
   690     12  ER-2280                 PIC X(4)  VALUE '2280'.
   691     12  ER-2370                 PIC X(4)  VALUE '2370'.
   692     12  ER-2371                 PIC X(4)  VALUE '2371'.
   693     12  ER-2378                 PIC X(4)  VALUE '2378'.
   694     12  ER-2380                 PIC X(4)  VALUE '2380'.
   695     12  ER-2566                 PIC X(4)  VALUE '2566'.
   696     12  ER-2848                 PIC X(4)  VALUE '2848'.
   697     12  ER-3548                 PIC X(4)  VALUE '3548'.
   698     12  ER-7008                 PIC X(4)  VALUE '7008'.
   699     12  ER-7319                 PIC X(4)  VALUE '7319'.
   700     12  ER-7321                 PIC X(4)  VALUE '7321'.
   701     12  ER-7352                 PIC X(4)  VALUE '7352'.
   702     12  ER-7353                 PIC X(4)  VALUE '7353'.
   703     12  ER-7572                 PIC X(4)  VALUE '7572'.
   704     12  ER-7575                 PIC X(4)  VALUE '7575'.
   705     12  ER-7577                 PIC X(4)  VALUE '7577'.
   706     12  ER-7582                 PIC X(4)  VALUE '7582'.
   707     12  ER-7634                 PIC X(4)  VALUE '7634'.
   708     12  ER-7635                 PIC X(4)  VALUE '7635'.
   709     12  ER-7636                 PIC X(4)  VALUE '7636'.
   710     12  ER-7637                 PIC X(4)  VALUE '7637'.
   711     12  ER-7638                 PIC X(4)  VALUE '7638'.
   712     12  ER-7639                 PIC X(4)  VALUE '7639'.
   713     12  ER-7640                 PIC X(4)  VALUE '7640'.
   714     12  ER-7641                 PIC X(4)  VALUE '7641'.
   715     12  ER-7642                 PIC X(4)  VALUE '7642'.
   716     12  ER-7643                 PIC X(4)  VALUE '7643'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  15
* EL130.cbl
   717     12  ER-7646                 PIC X(4)  VALUE '7646'.
   718     12  ER-7647                 PIC X(4)  VALUE '7647'.
   719     12  ER-7648                 PIC X(4)  VALUE '7648'.
   720     12  ER-7649                 PIC X(4)  VALUE '7649'.
   721     12  ER-7651                 PIC X(4)  VALUE '7651'.
   722     12  ER-7670                 PIC X(4)  VALUE '7670'.
   723     12  ER-7671                 PIC X(4)  VALUE '7671'.
   724     12  ER-7686                 PIC X(4)  VALUE '7686'.
   725     12  ER-7688                 PIC X(4)  VALUE '7688'.
   726     12  ER-7689                 PIC X(4)  VALUE '7689'.
   727     12  ER-7691                 PIC X(4)  VALUE '7691'.
   728*    COPY ERCPDEF.
   729******************************************************************
   730*                                                                *
   731*                                                                *
   732*                            ERCPDEF.                            *
   733*                                                                *
   734*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   735*                                                                *
   736*    FILE TYPE = VSAM,KSDS                                       *
   737*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   738*                                                                *
   739*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   740*                                                                *
   741*    LOG = YES                                                   *
   742*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   743******************************************************************
   744*                   C H A N G E   L O G
   745*
   746* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   747*-----------------------------------------------------------------
   748*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   749* EFFECTIVE    NUMBER
   750*-----------------------------------------------------------------
   751* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   752* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   753* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   754******************************************************************
   755 01  PRODUCT-MASTER.
   756    12  PD-RECORD-ID                 PIC X(02).
   757        88  VALID-PD-ID                  VALUE 'PD'.
   758    12  PD-CONTROL-PRIMARY.
   759        16  PD-COMPANY-CD            PIC X.
   760        16  PD-STATE                 PIC XX.
   761        16  PD-PRODUCT-CD            PIC XXX.
   762        16  PD-FILLER                PIC X(7).
   763        16  PD-BEN-TYPE              PIC X.
   764        16  PD-BEN-CODE              PIC XX.
   765        16  PD-PROD-EXP-DT           PIC XX.
   766    12  FILLER                       PIC X(50).
   767    12  PD-PRODUCT-DATA OCCURS 8.
   768        16  PD-PROD-CODE             PIC X.
   769            88  PD-PROD-LIFE           VALUE 'L'.
   770            88  PD-PROD-PROP           VALUE 'P'.
   771            88  PD-PROD-AH             VALUE 'A'.
   772            88  PD-PROD-IU             VALUE 'I'.
   773            88  PD-PROD-GAP            VALUE 'G'.
   774            88  PD-PROD-FAML           VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  16
* EL130.cbl
   775        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   776        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   777        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   778        16  PD-MAX-TERM              PIC S999        COMP-3.
   779        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   780        16  FILLER                   PIC X.
   781        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   782        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   783        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   784        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   785        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   786        16  PD-REC-CRIT-PERIOD       PIC 99.
   787        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   788            20  PD-RECURRING-YN      PIC X.
   789            20  FILLER               PIC X.
   790        16  PD-RTW-MOS               PIC 99.
   791        16  PD-MAX-EXTENSION         PIC 99.
   792        16  pd-ben-pct               pic sv999 comp-3.
   793*       16  FILLER                   PIC XX.
   794    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   795    12  PD-TERM-LIMITS OCCURS 15.
   796        16  PD-LOW-TERM              PIC S999        COMP-3.
   797        16  PD-HI-TERM               PIC S999        COMP-3.
   798*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   799    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   800        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   801        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   802    12  PD-EARN-FACTORS.
   803        16  FILLER OCCURS 15.
   804            20  FILLER OCCURS 15.
   805                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   806    12  PD-PRODUCT-DESC              PIC X(80).
   807    12  PD-TRUNCATED                 PIC X.
   808    12  FILLER                       PIC X(59).
   809    12  PD-MAINT-INFORMATION.
   810        16  PD-LAST-MAINT-DT         PIC X(02).
   811        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   812        16  PD-LAST-MAINT-BY         PIC X(04).
   813*    COPY ELCLNKLT.
   814******************************************************************
   815*                                                                *
   816*                                                                *
   817*                           ELCLNKLT                             *
   818*                            VMOD=2.003                          *
   819*                                                                *
   820*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   821*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   822*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   823*                                                                *
   824*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   825*   COMPLETING THE REQUIRED FIELDS.                              *
   826*                                                                *
   827*   THE CALLING PROGRAM SHOULD CHECK:                            *
   828*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   829*                              9999 INDICATES AN UNKNOWN ABEND   *
   830*                                   WAS DETECTED.                *
   831*                              ALL OTHER VALUES ARE NORMAL ERROR *
   832*                              CODES FOUND IN THE ERROR FILE.    *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  17
* EL130.cbl
   833******************************************************************
   834 01  W-1523-LINKDATA.
   835     12  W-1523-COMMON-PI-DATA.
   836         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   837         16  FILLER              PIC  X(67).
   838         16  W-1523-COMPANY-CD   PIC  X(01).
   839         16  FILLER              PIC  X(10).
   840         16  W-1523-CONTROL-IN-PROGRESS.
   841             20  W-1523-CARRIER  PIC  X(01).
   842             20  W-1523-GROUPING PIC  X(06).
   843             20  W-1523-STATE    PIC  X(02).
   844             20  W-1523-ACCOUNT  PIC  X(10).
   845             20  W-1523-CLAIM-CERT-GRP.
   846                 24  W-1523-CLAIM-NO
   847                                 PIC  X(07).
   848                 24  W-1523-CERT-NO.
   849                     28  W-1523-CERT-PRIME
   850                                 PIC  X(10).
   851                     28  W-1523-CERT-SFX
   852                                 PIC  X(01).
   853                 24  W-1523-CERT-EFF-DT
   854                                 PIC  X(02).
   855         16  FILLER              PIC X(265).
   856
   857     12  W-1523-WORK-AREA.
   858         16  W-1523-FORM-NUMBER  PIC  X(04).
   859         16  W-1523-NUMBER-COPIES
   860                                 PIC  9(01).
   861         16  W-1523-ADDR-TYPE    PIC  X(02).
   862         16  W-1523-FOLLOW-UP-DATE
   863                                 PIC  X(02).
   864         16  W-1523-RESEND-DATE  PIC  X(02).
   865         16  W-1523-ERROR-CODE   PIC  9(04).
   866             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   867             88  W-1523-FATAL-ERROR
   868                                    VALUES  0006 0013 0042
   869                                            0154 0168 0169
   870                                            0176 9999 0172
   871                                            0179 0186 0281
   872                                            0332 2055 3697
   873                                            3698 3699 3770
   874                                            3771 3772 7675
   875                                            9106 9808 9883
   876                                            9887.
   877             88  W-1523-STOP-ERRORS
   878                                    VALUES  0013 0042 0154
   879                                            0168 0169 0172
   880                                            0281 0332 2055
   881                                            3698 3699 7675
   882                                            9106 9808 9883
   883                                            9999.
   884         16  W-1523-REASON       PIC  X(70).
   885         16  W-1523-ARCHIVE-NUMBER
   886                                 PIC  9(08).
   887     12  W-1523-POINTER-AREA.
   888         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   889         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   890         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  18
* EL130.cbl
   891         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   892         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  19
* EL130.cbl
   894*    COPY ELCINTF.
   895******************************************************************
   896*                                                                *
   897*                                                                *
   898*                            ELCINTF.                            *
   899*                            VMOD=2.017                          *
   900*                                                                *
   901*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   902*                                                                *
   903*       LENGTH = 1024                                            *
   904*                                                                *
   905******************************************************************
   906*                   C H A N G E   L O G
   907*
   908* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   909*-----------------------------------------------------------------
   910*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   911* EFFECTIVE    NUMBER
   912*-----------------------------------------------------------------
   913* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   914******************************************************************
   915 01  PROGRAM-INTERFACE-BLOCK.
   916     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   917     12  PI-CALLING-PROGRAM              PIC X(8).
   918     12  PI-SAVED-PROGRAM-1              PIC X(8).
   919     12  PI-SAVED-PROGRAM-2              PIC X(8).
   920     12  PI-SAVED-PROGRAM-3              PIC X(8).
   921     12  PI-SAVED-PROGRAM-4              PIC X(8).
   922     12  PI-SAVED-PROGRAM-5              PIC X(8).
   923     12  PI-SAVED-PROGRAM-6              PIC X(8).
   924     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   925     12  PI-COMPANY-ID                   PIC XXX.
   926     12  PI-COMPANY-CD                   PIC X.
   927
   928     12  PI-COMPANY-PASSWORD             PIC X(8).
   929
   930     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   931
   932     12  PI-CONTROL-IN-PROGRESS.
   933         16  PI-CARRIER                  PIC X.
   934         16  PI-GROUPING                 PIC X(6).
   935         16  PI-STATE                    PIC XX.
   936         16  PI-ACCOUNT                  PIC X(10).
   937         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   938                                         PIC X(10).
   939         16  PI-CLAIM-CERT-GRP.
   940             20  PI-CLAIM-NO             PIC X(7).
   941             20  PI-CERT-NO.
   942                 25  PI-CERT-PRIME       PIC X(10).
   943                 25  PI-CERT-SFX         PIC X.
   944             20  PI-CERT-EFF-DT          PIC XX.
   945         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   946             20  PI-PLAN-CODE            PIC X(2).
   947             20  PI-REVISION-NUMBER      PIC X(3).
   948             20  PI-PLAN-EFF-DT          PIC X(2).
   949             20  PI-PLAN-EXP-DT          PIC X(2).
   950             20  FILLER                  PIC X(11).
   951         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  20
* EL130.cbl
   952             20  PI-OE-REFERENCE-1.
   953                 25  PI-OE-REF-1-PRIME   PIC X(18).
   954                 25  PI-OE-REF-1-SUFF    PIC XX.
   955
   956     12  PI-SESSION-IN-PROGRESS          PIC X.
   957         88  CLAIM-SESSION                   VALUE '1'.
   958         88  CREDIT-SESSION                  VALUE '2'.
   959         88  WARRANTY-SESSION                VALUE '3'.
   960         88  MORTGAGE-SESSION                VALUE '4'.
   961         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   962
   963
   964*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   965
   966     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   967     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   968
   969     12  PI-CREDIT-USER                  PIC X.
   970         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   971         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   972
   973     12  PI-CLAIM-USER                   PIC X.
   974         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   975         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   976
   977     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   978         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   979         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   980         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   981         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   982         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   983
   984     12  PI-PROCESSOR-ID                 PIC X(4).
   985
   986     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   987
   988     12  PI-MEMBER-CAPTION               PIC X(10).
   989
   990     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   991         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   992
   993     12  PI-LIFE-OVERRIDE-L1             PIC X.
   994     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   995     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   996     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   997
   998     12  PI-AH-OVERRIDE-L1               PIC X.
   999     12  PI-AH-OVERRIDE-L2               PIC XX.
  1000     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1001     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1002
  1003     12  PI-NEW-SYSTEM                   PIC X(2).
  1004
  1005     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1006     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1007         88  PI-USES-PAID-TO                 VALUE '1'.
  1008     12  PI-CRDTCRD-SYSTEM.
  1009         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  21
* EL130.cbl
  1010             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1011             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1012         16  PI-CC-MONTH-END-DT          PIC XX.
  1013     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1014
  1015     12  PI-OE-REFERENCE-2.
  1016         16  PI-OE-REF-2-PRIME           PIC X(10).
  1017         16  PI-OE-REF-2-SUFF            PIC X.
  1018
  1019     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1020
  1021     12  PI-LANGUAGE-TYPE                PIC X.
  1022             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1023             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1024             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1025
  1026     12  PI-POLICY-LINKAGE-IND           PIC X.
  1027         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1028         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1029                                                   LOW-VALUES.
  1030
  1031     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1032     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1033         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1034         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1035
  1036     12  PI-PROCESSOR-CSR-IND            PIC X.
  1037         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1038         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1039
  1040     12  FILLER                          PIC X(3).
  1041
  1042     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1043
  1044     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1045         PI-SYSTEM-LEVEL.
  1046
  1047         16  PI-ENTRY-CODES.
  1048             20  PI-ENTRY-CD-1           PIC X.
  1049             20  PI-ENTRY-CD-2           PIC X.
  1050
  1051         16  PI-RETURN-CODES.
  1052             20  PI-RETURN-CD-1          PIC X.
  1053             20  PI-RETURN-CD-2          PIC X.
  1054
  1055         16  PI-UPDATE-STATUS-SAVE.
  1056             20  PI-UPDATE-BY            PIC X(4).
  1057             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1058
  1059         16  PI-LOWER-CASE-LETTERS       PIC X.
  1060             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1061
  1062*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1063*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1064*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1065
  1066         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1067             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  22
* EL130.cbl
  1068             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1069             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1070             88  ACCNT-CNTL                  VALUE '3'.
  1071             88  CARR-ACCNT-CNTL             VALUE '4'.
  1072
  1073         16  PI-PROCESSOR-CAP-LIST.
  1074             20  PI-SYSTEM-CONTROLS.
  1075                24 PI-SYSTEM-DISPLAY     PIC X.
  1076                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1077                24 PI-SYSTEM-MODIFY      PIC X.
  1078                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1079             20  FILLER                  PIC XX.
  1080             20  PI-DISPLAY-CAP          PIC X.
  1081                 88  DISPLAY-CAP             VALUE 'Y'.
  1082             20  PI-MODIFY-CAP           PIC X.
  1083                 88  MODIFY-CAP              VALUE 'Y'.
  1084             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1085                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1086             20  PI-FORCE-CAP            PIC X.
  1087                 88  FORCE-CAP               VALUE 'Y'.
  1088
  1089         16  PI-PROGRAM-CONTROLS.
  1090             20  PI-PGM-PRINT-OPT        PIC X.
  1091             20  PI-PGM-FORMAT-OPT       PIC X.
  1092             20  PI-PGM-PROCESS-OPT      PIC X.
  1093             20  PI-PGM-TOTALS-OPT       PIC X.
  1094
  1095         16  PI-HELP-INTERFACE.
  1096             20  PI-LAST-ERROR-NO        PIC X(4).
  1097             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1098
  1099         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1100             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1101
  1102         16  PI-CR-CONTROL-IN-PROGRESS.
  1103             20  PI-CR-CARRIER           PIC X.
  1104             20  PI-CR-GROUPING          PIC X(6).
  1105             20  PI-CR-STATE             PIC XX.
  1106             20  PI-CR-ACCOUNT           PIC X(10).
  1107             20  PI-CR-FIN-RESP          PIC X(10).
  1108             20  PI-CR-TYPE              PIC X.
  1109
  1110         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1111
  1112         16  PI-CR-MONTH-END-DT          PIC XX.
  1113
  1114         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1115             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1116             88  PI-ZERO-CARRIER             VALUE '1'.
  1117             88  PI-ZERO-GROUPING            VALUE '2'.
  1118             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1119
  1120         16  PI-CARRIER-SECURITY         PIC X.
  1121             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1122
  1123         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1124             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1125             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  23
* EL130.cbl
  1126
  1127         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1128             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1129                                         INDEXED BY PI-ACCESS-NDX
  1130                                         PIC X.
  1131
  1132         16  PI-GA-BILLING-CONTROL       PIC X.
  1133             88  PI-GA-BILLING               VALUE '1'.
  1134
  1135         16  PI-MAIL-PROCESSING          PIC X.
  1136             88  PI-MAIL-YES                 VALUE 'Y'.
  1137
  1138         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1139
  1140         16  PI-AR-SYSTEM.
  1141             20  PI-AR-PROCESSING-CNTL   PIC X.
  1142                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1143             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1144             20  PI-AR-MONTH-END-DT      PIC XX.
  1145
  1146         16  PI-MP-SYSTEM.
  1147             20  PI-MORTGAGE-USER            PIC X.
  1148                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1149                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1150             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1151                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1152                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1153                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1154                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1155                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1156             20  PI-MP-MONTH-END-DT          PIC XX.
  1157             20  PI-MP-REFERENCE-NO.
  1158                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1159                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1160
  1161         16  PI-LABEL-CONTROL            PIC X(01).
  1162             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1163             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1164
  1165         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1166             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1167
  1168         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1169             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1170             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1171
  1172         16  FILLER                      PIC X(14).
  1173
  1174     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1175******************************************************************
  1176     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1177         16  PI-MSTR-DT               PIC XX.
  1178         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1179         16  PI-TRLR-DT               PIC XX.
  1180         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1181         16  PI-LAST-CLAIM            PIC X(7).
  1182         16  PI-LAST-CARR             PIC X.
  1183         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  24
* EL130.cbl
  1184             20  PI-LAST-CERT-PRIME   PIC X(10).
  1185             20  PI-LAST-CERT-SUFX    PIC X.
  1186         16  PI-LAST-CLAIM-TYPE       PIC X.
  1187         16  PI-CURSOR                PIC S9(4)   COMP.
  1188         16  PI-SAVE-CERT.
  1189             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1190             20  PI-SAVE-CERT-SUFX    PIC X.
  1191         16  PI-SAVE-EFFDT            PIC X(2).
  1192         16  PI-SAVE-ACCOUNT          PIC X(10).
  1193         16  PI-INCURR-SW             PIC X.
  1194         16  PI-PRT-OPT               PIC X.
  1195         16  PI-ALT-PRT               PIC X(4).
  1196         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1197             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1198         16  FILLER                   PIC X(272).
  1199         16  PI-EL127-TO-EL130-CNTRL.
  1200             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1201             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1202             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1203                 24  PI-EL127-CARRIER        PIC X.
  1204                 24  PI-EL127-GROUPING       PIC X(6).
  1205                 24  PI-EL127-STATE          PIC X(2).
  1206                 24  PI-EL127-ACCOUNT        PIC X(10).
  1207                 24  PI-EL127-CERT-NO.
  1208                     28  PI-EL127-CERT-PRIME PIC X(10).
  1209                     28  PI-EL127-CERT-SUFX  PIC X.
  1210                 24  PI-EL127-EFF-DT         PIC XX.
  1211*        16  FILLER                          PIC X(50).
  1212         16  FILLER                          PIC X(31).
  1213         16  PI-EL659-TO-EL130-CNTRL.
  1214             20  PI-EL659-CARRIER            PIC X.
  1215             20  PI-EL659-GROUPING           PIC X(6).
  1216             20  PI-EL659-STATE              PIC XX.
  1217             20  PI-EL659-ACCOUNT            PIC X(10).
  1218
  1219         16  FILLER                          PIC X(19).
  1220
  1221         16  PI-SAVE-INCUR-DT                PIC X(02).
  1222         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1223*         16  FILLER                          PIC X(65).
  1224         16  PI-ST-VFY-2ND-BENE              PIC X.
  1225         16  PI-ST-CAUSAL-STATE              PIC X.
  1226         16  pi-dcc-max-benefits             pic s999 comp-3.
  1227         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1228         16  pi-emi-sub                      pic 99.
  1229         16  FILLER                          PIC X(53).
  1230
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  25
* EL130.cbl
  1232*    COPY EL130S.
  1233 01  EL130AI.
  1234     05  FILLER            PIC  X(0012).
  1235*    -------------------------------
  1236     05  RUNDTEL PIC S9(0004) COMP.
  1237     05  RUNDTEF PIC  X(0001).
  1238     05  FILLER REDEFINES RUNDTEF.
  1239         10  RUNDTEA PIC  X(0001).
  1240     05  RUNDTEI PIC  X(0008).
  1241*    -------------------------------
  1242     05  RUNTIMEL PIC S9(0004) COMP.
  1243     05  RUNTIMEF PIC  X(0001).
  1244     05  FILLER REDEFINES RUNTIMEF.
  1245         10  RUNTIMEA PIC  X(0001).
  1246     05  RUNTIMEI PIC  X(0005).
  1247*    -------------------------------
  1248     05  COMPL PIC S9(0004) COMP.
  1249     05  COMPF PIC  X(0001).
  1250     05  FILLER REDEFINES COMPF.
  1251         10  COMPA PIC  X(0001).
  1252     05  COMPI PIC  X(0003).
  1253*    -------------------------------
  1254     05  SEQUL PIC S9(0004) COMP.
  1255     05  SEQUF PIC  X(0001).
  1256     05  FILLER REDEFINES SEQUF.
  1257         10  SEQUA PIC  X(0001).
  1258     05  SEQUI PIC  X(0010).
  1259*    -------------------------------
  1260     05  MAINTL PIC S9(0004) COMP.
  1261     05  MAINTF PIC  X(0001).
  1262     05  FILLER REDEFINES MAINTF.
  1263         10  MAINTA PIC  X(0001).
  1264     05  MAINTI PIC  X(0001).
  1265*    -------------------------------
  1266     05  CLMNOL PIC S9(0004) COMP.
  1267     05  CLMNOF PIC  X(0001).
  1268     05  FILLER REDEFINES CLMNOF.
  1269         10  CLMNOA PIC  X(0001).
  1270     05  CLMNOI PIC  X(0007).
  1271*    -------------------------------
  1272     05  CLMCARRL PIC S9(0004) COMP.
  1273     05  CLMCARRF PIC  X(0001).
  1274     05  FILLER REDEFINES CLMCARRF.
  1275         10  CLMCARRA PIC  X(0001).
  1276     05  CLMCARRI PIC  X(0001).
  1277*    -------------------------------
  1278     05  CLMTYPEL PIC S9(0004) COMP.
  1279     05  CLMTYPEF PIC  X(0001).
  1280     05  FILLER REDEFINES CLMTYPEF.
  1281         10  CLMTYPEA PIC  X(0001).
  1282     05  CLMTYPEI PIC  X(0001).
  1283*    -------------------------------
  1284     05  CERTNOL PIC S9(0004) COMP.
  1285     05  CERTNOF PIC  X(0001).
  1286     05  FILLER REDEFINES CERTNOF.
  1287         10  CERTNOA PIC  X(0001).
  1288     05  CERTNOI PIC  X(0010).
  1289*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  26
* EL130.cbl
  1290     05  SUFXL PIC S9(0004) COMP.
  1291     05  SUFXF PIC  X(0001).
  1292     05  FILLER REDEFINES SUFXF.
  1293         10  SUFXA PIC  X(0001).
  1294     05  SUFXI PIC  X(0001).
  1295*    -------------------------------
  1296     05  PCERTNOL PIC S9(0004) COMP.
  1297     05  PCERTNOF PIC  X(0001).
  1298     05  FILLER REDEFINES PCERTNOF.
  1299         10  PCERTNOA PIC  X(0001).
  1300     05  PCERTNOI PIC  X(0010).
  1301*    -------------------------------
  1302     05  PSUFXL PIC S9(0004) COMP.
  1303     05  PSUFXF PIC  X(0001).
  1304     05  FILLER REDEFINES PSUFXF.
  1305         10  PSUFXA PIC  X(0001).
  1306     05  PSUFXI PIC  X(0001).
  1307*    -------------------------------
  1308     05  INCURL PIC S9(0004) COMP.
  1309     05  INCURF PIC  X(0001).
  1310     05  FILLER REDEFINES INCURF.
  1311         10  INCURA PIC  X(0001).
  1312     05  INCURI PIC  X(0008).
  1313*    -------------------------------
  1314     05  REPORTL PIC S9(0004) COMP.
  1315     05  REPORTF PIC  X(0001).
  1316     05  FILLER REDEFINES REPORTF.
  1317         10  REPORTA PIC  X(0001).
  1318     05  REPORTI PIC  X(0008).
  1319*    -------------------------------
  1320     05  ICD1L PIC S9(0004) COMP.
  1321     05  ICD1F PIC  X(0001).
  1322     05  FILLER REDEFINES ICD1F.
  1323         10  ICD1A PIC  X(0001).
  1324     05  ICD1I PIC  X(0008).
  1325*    -------------------------------
  1326     05  ICD2L PIC S9(0004) COMP.
  1327     05  ICD2F PIC  X(0001).
  1328     05  FILLER REDEFINES ICD2F.
  1329         10  ICD2A PIC  X(0001).
  1330     05  ICD2I PIC  X(0008).
  1331*    -------------------------------
  1332     05  DIAGL PIC S9(0004) COMP.
  1333     05  DIAGF PIC  X(0001).
  1334     05  FILLER REDEFINES DIAGF.
  1335         10  DIAGA PIC  X(0001).
  1336     05  DIAGI PIC  X(0060).
  1337*    -------------------------------
  1338     05  BENECDL PIC S9(0004) COMP.
  1339     05  BENECDF PIC  X(0001).
  1340     05  FILLER REDEFINES BENECDF.
  1341         10  BENECDA PIC  X(0001).
  1342     05  BENECDI PIC  X(0010).
  1343*    -------------------------------
  1344     05  BIRTHDTL PIC S9(0004) COMP.
  1345     05  BIRTHDTF PIC  X(0001).
  1346     05  FILLER REDEFINES BIRTHDTF.
  1347         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  27
* EL130.cbl
  1348     05  BIRTHDTI PIC  X(0008).
  1349*    -------------------------------
  1350     05  SSNL PIC S9(0004) COMP.
  1351     05  SSNF PIC  X(0001).
  1352     05  FILLER REDEFINES SSNF.
  1353         10  SSNA PIC  X(0001).
  1354     05  SSNI PIC  X(0011).
  1355*    -------------------------------
  1356     05  SEXL PIC S9(0004) COMP.
  1357     05  SEXF PIC  X(0001).
  1358     05  FILLER REDEFINES SEXF.
  1359         10  SEXA PIC  X(0001).
  1360     05  SEXI PIC  X(0001).
  1361*    -------------------------------
  1362     05  INSTYPEL PIC S9(0004) COMP.
  1363     05  INSTYPEF PIC  X(0001).
  1364     05  FILLER REDEFINES INSTYPEF.
  1365         10  INSTYPEA PIC  X(0001).
  1366     05  INSTYPEI PIC  X(0001).
  1367*    -------------------------------
  1368     05  LSTNMEL PIC S9(0004) COMP.
  1369     05  LSTNMEF PIC  X(0001).
  1370     05  FILLER REDEFINES LSTNMEF.
  1371         10  LSTNMEA PIC  X(0001).
  1372     05  LSTNMEI PIC  X(0015).
  1373*    -------------------------------
  1374     05  FSTNMEL PIC S9(0004) COMP.
  1375     05  FSTNMEF PIC  X(0001).
  1376     05  FILLER REDEFINES FSTNMEF.
  1377         10  FSTNMEA PIC  X(0001).
  1378     05  FSTNMEI PIC  X(0012).
  1379*    -------------------------------
  1380     05  INITL PIC S9(0004) COMP.
  1381     05  INITF PIC  X(0001).
  1382     05  FILLER REDEFINES INITF.
  1383         10  INITA PIC  X(0001).
  1384     05  INITI PIC  X(0001).
  1385*    -------------------------------
  1386     05  LOANNOL PIC S9(0004) COMP.
  1387     05  LOANNOF PIC  X(0001).
  1388     05  FILLER REDEFINES LOANNOF.
  1389         10  LOANNOA PIC  X(0001).
  1390     05  LOANNOI PIC  X(0008).
  1391*    -------------------------------
  1392     05  CRTLNMEL PIC S9(0004) COMP.
  1393     05  CRTLNMEF PIC  X(0001).
  1394     05  FILLER REDEFINES CRTLNMEF.
  1395         10  CRTLNMEA PIC  X(0001).
  1396     05  CRTLNMEI PIC  X(0015).
  1397*    -------------------------------
  1398     05  CRTFNMEL PIC S9(0004) COMP.
  1399     05  CRTFNMEF PIC  X(0001).
  1400     05  FILLER REDEFINES CRTFNMEF.
  1401         10  CRTFNMEA PIC  X(0001).
  1402     05  CRTFNMEI PIC  X(0012).
  1403*    -------------------------------
  1404     05  CRTINITL PIC S9(0004) COMP.
  1405     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  28
* EL130.cbl
  1406     05  FILLER REDEFINES CRTINITF.
  1407         10  CRTINITA PIC  X(0001).
  1408     05  CRTINITI PIC  X(0001).
  1409*    -------------------------------
  1410     05  LOANBALL PIC S9(0004) COMP.
  1411     05  LOANBALF PIC  X(0001).
  1412     05  FILLER REDEFINES LOANBALF.
  1413         10  LOANBALA PIC  X(0001).
  1414     05  LOANBALI PIC  9(7)V99.
  1415*    -------------------------------
  1416     05  MANRSVL PIC S9(0004) COMP.
  1417     05  MANRSVF PIC  X(0001).
  1418     05  FILLER REDEFINES MANRSVF.
  1419         10  MANRSVA PIC  X(0001).
  1420     05  MANRSVI PIC  9(7)V99.
  1421*    -------------------------------
  1422     05  SUPVL PIC S9(0004) COMP.
  1423     05  SUPVF PIC  X(0001).
  1424     05  FILLER REDEFINES SUPVF.
  1425         10  SUPVA PIC  X(0001).
  1426     05  SUPVI PIC  X(0001).
  1427*    -------------------------------
  1428     05  PRICDL PIC S9(0004) COMP.
  1429     05  PRICDF PIC  X(0001).
  1430     05  FILLER REDEFINES PRICDF.
  1431         10  PRICDA PIC  X(0001).
  1432     05  PRICDI PIC  X(0001).
  1433*    -------------------------------
  1434     05  PRODL PIC S9(0004) COMP.
  1435     05  PRODF PIC  X(0001).
  1436     05  FILLER REDEFINES PRODF.
  1437         10  PRODA PIC  X(0001).
  1438     05  PRODI PIC  X(0008).
  1439*    -------------------------------
  1440     05  PRODCDL PIC S9(0004) COMP.
  1441     05  PRODCDF PIC  X(0001).
  1442     05  FILLER REDEFINES PRODCDF.
  1443         10  PRODCDA PIC  X(0001).
  1444     05  PRODCDI PIC  X(0001).
  1445*    -------------------------------
  1446     05  FILETOL PIC S9(0004) COMP.
  1447     05  FILETOF PIC  X(0001).
  1448     05  FILLER REDEFINES FILETOF.
  1449         10  FILETOA PIC  X(0001).
  1450     05  FILETOI PIC  X(0004).
  1451*    -------------------------------
  1452     05  PROCCDL PIC S9(0004) COMP.
  1453     05  PROCCDF PIC  X(0001).
  1454     05  FILLER REDEFINES PROCCDF.
  1455         10  PROCCDA PIC  X(0001).
  1456     05  PROCCDI PIC  X(0004).
  1457*    -------------------------------
  1458     05  RELCLML PIC S9(0004) COMP.
  1459     05  RELCLMF PIC  X(0001).
  1460     05  FILLER REDEFINES RELCLMF.
  1461         10  RELCLMA PIC  X(0001).
  1462     05  RELCLMI PIC  X(0007).
  1463*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  29
* EL130.cbl
  1464     05  PRTOPTL PIC S9(0004) COMP.
  1465     05  PRTOPTF PIC  X(0001).
  1466     05  FILLER REDEFINES PRTOPTF.
  1467         10  PRTOPTA PIC  X(0001).
  1468     05  PRTOPTI PIC  X(0001).
  1469*    -------------------------------
  1470     05  ALTPRTL PIC S9(0004) COMP.
  1471     05  ALTPRTF PIC  X(0001).
  1472     05  FILLER REDEFINES ALTPRTF.
  1473         10  ALTPRTA PIC  X(0001).
  1474     05  ALTPRTI PIC  X(0004).
  1475*    -------------------------------
  1476     05  CERTMTL PIC S9(0004) COMP.
  1477     05  CERTMTF PIC  X(0001).
  1478     05  FILLER REDEFINES CERTMTF.
  1479         10  CERTMTA PIC  X(0001).
  1480     05  CERTMTI PIC  X(0001).
  1481*    -------------------------------
  1482     05  CRTCARRL PIC S9(0004) COMP.
  1483     05  CRTCARRF PIC  X(0001).
  1484     05  FILLER REDEFINES CRTCARRF.
  1485         10  CRTCARRA PIC  X(0001).
  1486     05  CRTCARRI PIC  X(0001).
  1487*    -------------------------------
  1488     05  GROUPL PIC S9(0004) COMP.
  1489     05  GROUPF PIC  X(0001).
  1490     05  FILLER REDEFINES GROUPF.
  1491         10  GROUPA PIC  X(0001).
  1492     05  GROUPI PIC  X(0006).
  1493*    -------------------------------
  1494     05  STATEL PIC S9(0004) COMP.
  1495     05  STATEF PIC  X(0001).
  1496     05  FILLER REDEFINES STATEF.
  1497         10  STATEA PIC  X(0001).
  1498     05  STATEI PIC  X(0002).
  1499*    -------------------------------
  1500     05  ACCOUNTL PIC S9(0004) COMP.
  1501     05  ACCOUNTF PIC  X(0001).
  1502     05  FILLER REDEFINES ACCOUNTF.
  1503         10  ACCOUNTA PIC  X(0001).
  1504     05  ACCOUNTI PIC  X(0010).
  1505*    -------------------------------
  1506     05  EFFDTL PIC S9(0004) COMP.
  1507     05  EFFDTF PIC  X(0001).
  1508     05  FILLER REDEFINES EFFDTF.
  1509         10  EFFDTA PIC  X(0001).
  1510     05  EFFDTI PIC  X(0008).
  1511*    -------------------------------
  1512     05  CRTSSNL PIC S9(0004) COMP.
  1513     05  CRTSSNF PIC  X(0001).
  1514     05  FILLER REDEFINES CRTSSNF.
  1515         10  CRTSSNA PIC  X(0001).
  1516     05  CRTSSNI PIC  X(0011).
  1517*    -------------------------------
  1518     05  MEMCAPL PIC S9(0004) COMP.
  1519     05  MEMCAPF PIC  X(0001).
  1520     05  FILLER REDEFINES MEMCAPF.
  1521         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  30
* EL130.cbl
  1522     05  MEMCAPI PIC  X(0010).
  1523*    -------------------------------
  1524     05  MEMBERL PIC S9(0004) COMP.
  1525     05  MEMBERF PIC  X(0001).
  1526     05  FILLER REDEFINES MEMBERF.
  1527         10  MEMBERA PIC  X(0001).
  1528     05  MEMBERI PIC  X(0012).
  1529*    -------------------------------
  1530     05  REINCDL PIC S9(0004) COMP.
  1531     05  REINCDF PIC  X(0001).
  1532     05  FILLER REDEFINES REINCDF.
  1533         10  REINCDA PIC  X(0001).
  1534     05  REINCDI PIC  X(0001).
  1535*    -------------------------------
  1536     05  ISSAGEL PIC S9(0004) COMP.
  1537     05  ISSAGEF PIC  X(0001).
  1538     05  FILLER REDEFINES ISSAGEF.
  1539         10  ISSAGEA PIC  X(0001).
  1540     05  ISSAGEI PIC  X(0002).
  1541*    -------------------------------
  1542     05  APRL PIC S9(0004) COMP.
  1543     05  APRF PIC  X(0001).
  1544     05  FILLER REDEFINES APRF.
  1545         10  APRA PIC  X(0001).
  1546     05  APRI PIC  9(4)V9(4).
  1547*    -------------------------------
  1548     05  PMTFREQL PIC S9(0004) COMP.
  1549     05  PMTFREQF PIC  X(0001).
  1550     05  FILLER REDEFINES PMTFREQF.
  1551         10  PMTFREQA PIC  X(0001).
  1552     05  PMTFREQI PIC  99.
  1553*    -------------------------------
  1554     05  INDGRPL PIC S9(0004) COMP.
  1555     05  INDGRPF PIC  X(0001).
  1556     05  FILLER REDEFINES INDGRPF.
  1557         10  INDGRPA PIC  X(0001).
  1558     05  INDGRPI PIC  X(0001).
  1559*    -------------------------------
  1560     05  PREMTYPL PIC S9(0004) COMP.
  1561     05  PREMTYPF PIC  X(0001).
  1562     05  FILLER REDEFINES PREMTYPF.
  1563         10  PREMTYPA PIC  X(0001).
  1564     05  PREMTYPI PIC  X(0001).
  1565*    -------------------------------
  1566     05  ADDONDTL PIC S9(0004) COMP.
  1567     05  ADDONDTF PIC  X(0001).
  1568     05  FILLER REDEFINES ADDONDTF.
  1569         10  ADDONDTA PIC  X(0001).
  1570     05  ADDONDTI PIC  X(0008).
  1571*    -------------------------------
  1572     05  JNTLNMEL PIC S9(0004) COMP.
  1573     05  JNTLNMEF PIC  X(0001).
  1574     05  FILLER REDEFINES JNTLNMEF.
  1575         10  JNTLNMEA PIC  X(0001).
  1576     05  JNTLNMEI PIC  X(0015).
  1577*    -------------------------------
  1578     05  JNTFNMEL PIC S9(0004) COMP.
  1579     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  31
* EL130.cbl
  1580     05  FILLER REDEFINES JNTFNMEF.
  1581         10  JNTFNMEA PIC  X(0001).
  1582     05  JNTFNMEI PIC  X(0002).
  1583*    -------------------------------
  1584     05  JNTINITL PIC S9(0004) COMP.
  1585     05  JNTINITF PIC  X(0001).
  1586     05  FILLER REDEFINES JNTINITF.
  1587         10  JNTINITA PIC  X(0001).
  1588     05  JNTINITI PIC  X(0001).
  1589*    -------------------------------
  1590     05  JNTAGEL PIC S9(0004) COMP.
  1591     05  JNTAGEF PIC  X(0001).
  1592     05  FILLER REDEFINES JNTAGEF.
  1593         10  JNTAGEA PIC  X(0001).
  1594     05  JNTAGEI PIC  X(0002).
  1595*    -------------------------------
  1596     05  LCVDSCRL PIC S9(0004) COMP.
  1597     05  LCVDSCRF PIC  X(0001).
  1598     05  FILLER REDEFINES LCVDSCRF.
  1599         10  LCVDSCRA PIC  X(0001).
  1600     05  LCVDSCRI PIC  X(0006).
  1601*    -------------------------------
  1602     05  LCVKINDL PIC S9(0004) COMP.
  1603     05  LCVKINDF PIC  X(0001).
  1604     05  FILLER REDEFINES LCVKINDF.
  1605         10  LCVKINDA PIC  X(0001).
  1606     05  LCVKINDI PIC  X(0003).
  1607*    -------------------------------
  1608     05  LCVCDL PIC S9(0004) COMP.
  1609     05  LCVCDF PIC  X(0001).
  1610     05  FILLER REDEFINES LCVCDF.
  1611         10  LCVCDA PIC  X(0001).
  1612     05  LCVCDI PIC  X(0002).
  1613*    -------------------------------
  1614     05  LCVOTRML PIC S9(0004) COMP.
  1615     05  LCVOTRMF PIC  X(0001).
  1616     05  FILLER REDEFINES LCVOTRMF.
  1617         10  LCVOTRMA PIC  X(0001).
  1618     05  LCVOTRMI PIC  999.
  1619*    -------------------------------
  1620     05  LCVRTRML PIC S9(0004) COMP.
  1621     05  LCVRTRMF PIC  X(0001).
  1622     05  FILLER REDEFINES LCVRTRMF.
  1623         10  LCVRTRMA PIC  X(0001).
  1624     05  LCVRTRMI PIC  X(0003).
  1625*    -------------------------------
  1626     05  LCVRATEL PIC S9(0004) COMP.
  1627     05  LCVRATEF PIC  X(0001).
  1628     05  FILLER REDEFINES LCVRATEF.
  1629         10  LCVRATEA PIC  X(0001).
  1630     05  LCVRATEI PIC  9999V99.
  1631*    -------------------------------
  1632     05  LCVBENEL PIC S9(0004) COMP.
  1633     05  LCVBENEF PIC  X(0001).
  1634     05  FILLER REDEFINES LCVBENEF.
  1635         10  LCVBENEA PIC  X(0001).
  1636     05  LCVBENEI PIC  9(9)V99.
  1637*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  32
* EL130.cbl
  1638     05  LCVFORML PIC S9(0004) COMP.
  1639     05  LCVFORMF PIC  X(0001).
  1640     05  FILLER REDEFINES LCVFORMF.
  1641         10  LCVFORMA PIC  X(0001).
  1642     05  LCVFORMI PIC  X(0012).
  1643*    -------------------------------
  1644     05  LCVCNDTL PIC S9(0004) COMP.
  1645     05  LCVCNDTF PIC  X(0001).
  1646     05  FILLER REDEFINES LCVCNDTF.
  1647         10  LCVCNDTA PIC  X(0001).
  1648     05  LCVCNDTI PIC  X(0008).
  1649*    -------------------------------
  1650     05  LCVEXITL PIC S9(0004) COMP.
  1651     05  LCVEXITF PIC  X(0001).
  1652     05  FILLER REDEFINES LCVEXITF.
  1653         10  LCVEXITA PIC  X(0001).
  1654     05  LCVEXITI PIC  X(0008).
  1655*    -------------------------------
  1656     05  LCVSTATL PIC S9(0004) COMP.
  1657     05  LCVSTATF PIC  X(0001).
  1658     05  FILLER REDEFINES LCVSTATF.
  1659         10  LCVSTATA PIC  X(0001).
  1660     05  LCVSTATI PIC  X(0006).
  1661*    -------------------------------
  1662     05  ACVDSCRL PIC S9(0004) COMP.
  1663     05  ACVDSCRF PIC  X(0001).
  1664     05  FILLER REDEFINES ACVDSCRF.
  1665         10  ACVDSCRA PIC  X(0001).
  1666     05  ACVDSCRI PIC  X(0006).
  1667*    -------------------------------
  1668     05  ACVKINDL PIC S9(0004) COMP.
  1669     05  ACVKINDF PIC  X(0001).
  1670     05  FILLER REDEFINES ACVKINDF.
  1671         10  ACVKINDA PIC  X(0001).
  1672     05  ACVKINDI PIC  X(0003).
  1673*    -------------------------------
  1674     05  ACVCDL PIC S9(0004) COMP.
  1675     05  ACVCDF PIC  X(0001).
  1676     05  FILLER REDEFINES ACVCDF.
  1677         10  ACVCDA PIC  X(0001).
  1678     05  ACVCDI PIC  X(0002).
  1679*    -------------------------------
  1680     05  ACVOTRML PIC S9(0004) COMP.
  1681     05  ACVOTRMF PIC  X(0001).
  1682     05  FILLER REDEFINES ACVOTRMF.
  1683         10  ACVOTRMA PIC  X(0001).
  1684     05  ACVOTRMI PIC  999.
  1685*    -------------------------------
  1686     05  ACVRTRML PIC S9(0004) COMP.
  1687     05  ACVRTRMF PIC  X(0001).
  1688     05  FILLER REDEFINES ACVRTRMF.
  1689         10  ACVRTRMA PIC  X(0001).
  1690     05  ACVRTRMI PIC  X(0003).
  1691*    -------------------------------
  1692     05  ACVRATEL PIC S9(0004) COMP.
  1693     05  ACVRATEF PIC  X(0001).
  1694     05  FILLER REDEFINES ACVRATEF.
  1695         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  33
* EL130.cbl
  1696     05  ACVRATEI PIC  9999V99.
  1697*    -------------------------------
  1698     05  ACVBENEL PIC S9(0004) COMP.
  1699     05  ACVBENEF PIC  X(0001).
  1700     05  FILLER REDEFINES ACVBENEF.
  1701         10  ACVBENEA PIC  X(0001).
  1702     05  ACVBENEI PIC  9(9)V99.
  1703*    -------------------------------
  1704     05  ACVFORML PIC S9(0004) COMP.
  1705     05  ACVFORMF PIC  X(0001).
  1706     05  FILLER REDEFINES ACVFORMF.
  1707         10  ACVFORMA PIC  X(0001).
  1708     05  ACVFORMI PIC  X(0012).
  1709*    -------------------------------
  1710     05  ACVCNDTL PIC S9(0004) COMP.
  1711     05  ACVCNDTF PIC  X(0001).
  1712     05  FILLER REDEFINES ACVCNDTF.
  1713         10  ACVCNDTA PIC  X(0001).
  1714     05  ACVCNDTI PIC  X(0008).
  1715*    -------------------------------
  1716     05  ACVEXITL PIC S9(0004) COMP.
  1717     05  ACVEXITF PIC  X(0001).
  1718     05  FILLER REDEFINES ACVEXITF.
  1719         10  ACVEXITA PIC  X(0001).
  1720     05  ACVEXITI PIC  X(0008).
  1721*    -------------------------------
  1722     05  ACVSTATL PIC S9(0004) COMP.
  1723     05  ACVSTATF PIC  X(0001).
  1724     05  FILLER REDEFINES ACVSTATF.
  1725         10  ACVSTATA PIC  X(0001).
  1726     05  ACVSTATI PIC  X(0006).
  1727*    -------------------------------
  1728     05  ERRMSG1L PIC S9(0004) COMP.
  1729     05  ERRMSG1F PIC  X(0001).
  1730     05  FILLER REDEFINES ERRMSG1F.
  1731         10  ERRMSG1A PIC  X(0001).
  1732     05  ERRMSG1I PIC  X(0072).
  1733*    -------------------------------
  1734     05  ERRMSG2L PIC S9(0004) COMP.
  1735     05  ERRMSG2F PIC  X(0001).
  1736     05  FILLER REDEFINES ERRMSG2F.
  1737         10  ERRMSG2A PIC  X(0001).
  1738     05  ERRMSG2I PIC  X(0072).
  1739*    -------------------------------
  1740     05  BCERT1L PIC S9(0004) COMP.
  1741     05  BCERT1F PIC  X(0001).
  1742     05  FILLER REDEFINES BCERT1F.
  1743         10  BCERT1A PIC  X(0001).
  1744     05  BCERT1I PIC  X(0010).
  1745*    -------------------------------
  1746     05  BSUFX1L PIC S9(0004) COMP.
  1747     05  BSUFX1F PIC  X(0001).
  1748     05  FILLER REDEFINES BSUFX1F.
  1749         10  BSUFX1A PIC  X(0001).
  1750     05  BSUFX1I PIC  X(0001).
  1751*    -------------------------------
  1752     05  BCERT2L PIC S9(0004) COMP.
  1753     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  34
* EL130.cbl
  1754     05  FILLER REDEFINES BCERT2F.
  1755         10  BCERT2A PIC  X(0001).
  1756     05  BCERT2I PIC  X(0010).
  1757*    -------------------------------
  1758     05  BSUFX2L PIC S9(0004) COMP.
  1759     05  BSUFX2F PIC  X(0001).
  1760     05  FILLER REDEFINES BSUFX2F.
  1761         10  BSUFX2A PIC  X(0001).
  1762     05  BSUFX2I PIC  X(0001).
  1763*    -------------------------------
  1764     05  BCERT3L PIC S9(0004) COMP.
  1765     05  BCERT3F PIC  X(0001).
  1766     05  FILLER REDEFINES BCERT3F.
  1767         10  BCERT3A PIC  X(0001).
  1768     05  BCERT3I PIC  X(0010).
  1769*    -------------------------------
  1770     05  BSUFX3L PIC S9(0004) COMP.
  1771     05  BSUFX3F PIC  X(0001).
  1772     05  FILLER REDEFINES BSUFX3F.
  1773         10  BSUFX3A PIC  X(0001).
  1774     05  BSUFX3I PIC  X(0001).
  1775*    -------------------------------
  1776     05  BCERT4L PIC S9(0004) COMP.
  1777     05  BCERT4F PIC  X(0001).
  1778     05  FILLER REDEFINES BCERT4F.
  1779         10  BCERT4A PIC  X(0001).
  1780     05  BCERT4I PIC  X(0010).
  1781*    -------------------------------
  1782     05  BSUFX4L PIC S9(0004) COMP.
  1783     05  BSUFX4F PIC  X(0001).
  1784     05  FILLER REDEFINES BSUFX4F.
  1785         10  BSUFX4A PIC  X(0001).
  1786     05  BSUFX4I PIC  X(0001).
  1787*    -------------------------------
  1788     05  BCERT5L PIC S9(0004) COMP.
  1789     05  BCERT5F PIC  X(0001).
  1790     05  FILLER REDEFINES BCERT5F.
  1791         10  BCERT5A PIC  X(0001).
  1792     05  BCERT5I PIC  X(0010).
  1793*    -------------------------------
  1794     05  BSUFX5L PIC S9(0004) COMP.
  1795     05  BSUFX5F PIC  X(0001).
  1796     05  FILLER REDEFINES BSUFX5F.
  1797         10  BSUFX5A PIC  X(0001).
  1798     05  BSUFX5I PIC  X(0001).
  1799*    -------------------------------
  1800     05  ENTERPFL PIC S9(0004) COMP.
  1801     05  ENTERPFF PIC  X(0001).
  1802     05  FILLER REDEFINES ENTERPFF.
  1803         10  ENTERPFA PIC  X(0001).
  1804     05  ENTERPFI PIC  99.
  1805*    -------------------------------
  1806     05  PF5L PIC S9(0004) COMP.
  1807     05  PF5F PIC  X(0001).
  1808     05  FILLER REDEFINES PF5F.
  1809         10  PF5A PIC  X(0001).
  1810     05  PF5I PIC  X(0013).
  1811 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  35
* EL130.cbl
  1812     05  FILLER            PIC  X(0012).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  RUNDTEO PIC  X(0008).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  RUNTIMEO PIC  99.99.
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  COMPO PIC  X(0003).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  SEQUO PIC  X(0010).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  MAINTO PIC  X(0001).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  CLMNOO PIC  X(0007).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  CLMCARRO PIC  X(0001).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  CLMTYPEO PIC  X(0001).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  CERTNOO PIC  X(0010).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  SUFXO PIC  X(0001).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  PCERTNOO PIC  X(0010).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  PSUFXO PIC  X(0001).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  INCURO PIC  X(0008).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  REPORTO PIC  X(0008).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  ICD1O PIC  X(0008).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ICD2O PIC  X(0008).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  DIAGO PIC  X(0060).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  BENECDO PIC  X(0010).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  36
* EL130.cbl
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  SSNO PIC  X(0011).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  SEXO PIC  X(0001).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  INSTYPEO PIC  X(0001).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  LSTNMEO PIC  X(0015).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  FSTNMEO PIC  X(0012).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  INITO PIC  X(0001).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  LOANNOO PIC  X(0008).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  CRTLNMEO PIC  X(0015).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  CRTFNMEO PIC  X(0012).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  CRTINITO PIC  X(0001).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  LOANBALO PIC  ZZZZZ9.99.
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  MANRSVO PIC  Z(5)9.99.
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  SUPVO PIC  X(0001).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  PRICDO PIC  X(0001).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  PRODO PIC  X(0008).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  PRODCDO PIC  X(0001).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  FILETOO PIC  X(0004).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  PROCCDO PIC  X(0004).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  RELCLMO PIC  X(0007).
  1927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  37
* EL130.cbl
  1928     05  FILLER            PIC  X(0003).
  1929     05  PRTOPTO PIC  X(0001).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  ALTPRTO PIC  X(0004).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  CERTMTO PIC  X(0001).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  CRTCARRO PIC  X(0001).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  GROUPO PIC  X(0006).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  STATEO PIC  X(0002).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  ACCOUNTO PIC  X(0010).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  EFFDTO PIC  X(0008).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  CRTSSNO PIC  X(0011).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  MEMCAPO PIC  X(0010).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  MEMBERO PIC  X(0012).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  REINCDO PIC  X(0001).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  ISSAGEO PIC  X(0002).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  APRO PIC  9(3).9(4).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  PMTFREQO PIC  99.
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  INDGRPO PIC  X(0001).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  PREMTYPO PIC  X(0001).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  ADDONDTO PIC  X(0008).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  JNTLNMEO PIC  X(0015).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  38
* EL130.cbl
  1986     05  JNTFNMEO PIC  X(0002).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  JNTINITO PIC  X(0001).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  JNTAGEO PIC  X(0002).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  LCVDSCRO PIC  X(0006).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  LCVKINDO PIC  X(0003).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  LCVCDO PIC  X(0002).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LCVOTRMO PIC  999.
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  LCVRTRMO PIC  ZZZ.
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  LCVRATEO PIC  ZZZ.ZZ.
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  LCVFORMO PIC  X(0012).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  LCVCNDTO PIC  X(0008).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  LCVEXITO PIC  X(0008).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  LCVSTATO PIC  X(0006).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  ACVDSCRO PIC  X(0006).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACVKINDO PIC  X(0003).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACVCDO PIC  X(0002).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  ACVOTRMO PIC  999.
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  ACVRTRMO PIC  ZZZ.
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  39
* EL130.cbl
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  ACVFORMO PIC  X(0012).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  ACVCNDTO PIC  X(0008).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  ACVEXITO PIC  X(0008).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  ACVSTATO PIC  X(0006).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  ERRMSG1O PIC  X(0072).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  ERRMSG2O PIC  X(0072).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  BCERT1O PIC  X(0010).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BSUFX1O PIC  X(0001).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BCERT2O PIC  X(0010).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BSUFX2O PIC  X(0001).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BCERT3O PIC  X(0010).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  BSUFX3O PIC  X(0001).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  BCERT4O PIC  X(0010).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  BSUFX4O PIC  X(0001).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  BCERT5O PIC  X(0010).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  BSUFX5O PIC  X(0001).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  ENTERPFO PIC  X(0002).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  PF5O PIC  X(0013).
  2101*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  40
* EL130.cbl
  2103*    COPY ELCDATE.
  2104******************************************************************
  2105*                                                                *
  2106*                                                                *
  2107*                            ELCDATE.                            *
  2108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2109*                            VMOD=2.003
  2110*                                                                *
  2111*                                                                *
  2112*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2113*                 LENGTH = 200                                   *
  2114******************************************************************
  2115
  2116 01  DATE-CONVERSION-DATA.
  2117     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2118     12  DC-OPTION-CODE                PIC X.
  2119         88  BIN-TO-GREG                VALUE ' '.
  2120         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2121         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2122         88  YMD-GREG-TO-BIN            VALUE '3'.
  2123         88  MDY-GREG-TO-BIN            VALUE '4'.
  2124         88  JULIAN-TO-BIN              VALUE '5'.
  2125         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2126         88  FIND-CENTURY               VALUE '7'.
  2127         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2128         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2129         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2130         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2131         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2132         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2133         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2134         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2135         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2136         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2137         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2138         88  BIN-3-TO-GREG              VALUE 'I'.
  2139         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2140         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2141         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2142         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2143         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2144         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2145         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2146         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2147         88  THREE-CHARACTER-BIN
  2148                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2149         88  GREGORIAN-TO-BIN
  2150                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2151         88  BIN-TO-GREGORIAN
  2152                  VALUES ' ' '1' 'I' '8' 'G'.
  2153         88  JULIAN-TO-BINARY
  2154                  VALUES '5' 'C' 'E' 'F'.
  2155     12  DC-ERROR-CODE                 PIC X.
  2156         88  NO-CONVERSION-ERROR        VALUE ' '.
  2157         88  DATE-CONVERSION-ERROR
  2158                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2159         88  DATE-IS-ZERO               VALUE '1'.
  2160         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  41
* EL130.cbl
  2161         88  DATE-IS-INVALID            VALUE '3'.
  2162         88  DATE1-GREATER-DATE2        VALUE '4'.
  2163         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2164         88  DATE-INVALID-OPTION        VALUE '9'.
  2165         88  INVALID-CENTURY            VALUE 'A'.
  2166         88  ONLY-CENTURY               VALUE 'B'.
  2167         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2168         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2169     12  DC-END-OF-MONTH               PIC X.
  2170         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2171     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2172         88  USE-NORMAL-PROCESS         VALUE ' '.
  2173         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2174         88  ADJUST-UP-100-YRS          VALUE '2'.
  2175     12  FILLER                        PIC X.
  2176     12  DC-CONVERSION-DATES.
  2177         16  DC-BIN-DATE-1             PIC XX.
  2178         16  DC-BIN-DATE-2             PIC XX.
  2179         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2180         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2181                       DC-GREG-DATE-1-EDIT.
  2182             20  DC-EDIT1-MONTH        PIC 99.
  2183             20  SLASH1-1              PIC X.
  2184             20  DC-EDIT1-DAY          PIC 99.
  2185             20  SLASH1-2              PIC X.
  2186             20  DC-EDIT1-YEAR         PIC 99.
  2187         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2188         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2189                     DC-GREG-DATE-2-EDIT.
  2190             20  DC-EDIT2-MONTH        PIC 99.
  2191             20  SLASH2-1              PIC X.
  2192             20  DC-EDIT2-DAY          PIC 99.
  2193             20  SLASH2-2              PIC X.
  2194             20  DC-EDIT2-YEAR         PIC 99.
  2195         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2196         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2197                     DC-GREG-DATE-1-YMD.
  2198             20  DC-YMD-YEAR           PIC 99.
  2199             20  DC-YMD-MONTH          PIC 99.
  2200             20  DC-YMD-DAY            PIC 99.
  2201         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2202         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2203                      DC-GREG-DATE-1-MDY.
  2204             20  DC-MDY-MONTH          PIC 99.
  2205             20  DC-MDY-DAY            PIC 99.
  2206             20  DC-MDY-YEAR           PIC 99.
  2207         16  DC-GREG-DATE-1-ALPHA.
  2208             20  DC-ALPHA-MONTH        PIC X(10).
  2209             20  DC-ALPHA-DAY          PIC 99.
  2210             20  FILLER                PIC XX.
  2211             20  DC-ALPHA-CENTURY.
  2212                 24 DC-ALPHA-CEN-N     PIC 99.
  2213             20  DC-ALPHA-YEAR         PIC 99.
  2214         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2215         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2216         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2217         16  DC-JULIAN-DATE            PIC 9(05).
  2218         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  42
* EL130.cbl
  2219                                       PIC 9(05).
  2220         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2221             20  DC-JULIAN-YEAR        PIC 99.
  2222             20  DC-JULIAN-DAYS        PIC 999.
  2223         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2224         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2225         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2226     12  DATE-CONVERSION-VARIBLES.
  2227         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2228         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2229             20  FILLER                PIC 9(3).
  2230             20  HOLD-CEN-1-CCYY.
  2231                 24  HOLD-CEN-1-CC     PIC 99.
  2232                 24  HOLD-CEN-1-YY     PIC 99.
  2233             20  HOLD-CEN-1-MO         PIC 99.
  2234             20  HOLD-CEN-1-DA         PIC 99.
  2235         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2236             20  HOLD-CEN-1-R-MO       PIC 99.
  2237             20  HOLD-CEN-1-R-DA       PIC 99.
  2238             20  HOLD-CEN-1-R-CCYY.
  2239                 24  HOLD-CEN-1-R-CC   PIC 99.
  2240                 24  HOLD-CEN-1-R-YY   PIC 99.
  2241             20  FILLER                PIC 9(3).
  2242         16  HOLD-CENTURY-1-X.
  2243             20  FILLER                PIC X(3)  VALUE SPACES.
  2244             20  HOLD-CEN-1-X-CCYY.
  2245                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2246                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2247             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2248             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2249         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2250             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2251             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2252             20  HOLD-CEN-1-R-X-CCYY.
  2253                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2254                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2255             20  FILLER                PIC XXX.
  2256         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2257         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2258         16  DC-JULIAN-DATE-1          PIC 9(07).
  2259         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2260             20  DC-JULIAN-1-CCYY.
  2261                 24  DC-JULIAN-1-CC    PIC 99.
  2262                 24  DC-JULIAN-1-YR    PIC 99.
  2263             20  DC-JULIAN-DA-1        PIC 999.
  2264         16  DC-JULIAN-DATE-2          PIC 9(07).
  2265         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2266             20  DC-JULIAN-2-CCYY.
  2267                 24  DC-JULIAN-2-CC    PIC 99.
  2268                 24  DC-JULIAN-2-YR    PIC 99.
  2269             20  DC-JULIAN-DA-2        PIC 999.
  2270         16  DC-GREG-DATE-A-EDIT.
  2271             20  DC-EDITA-MONTH        PIC 99.
  2272             20  SLASHA-1              PIC X VALUE '/'.
  2273             20  DC-EDITA-DAY          PIC 99.
  2274             20  SLASHA-2              PIC X VALUE '/'.
  2275             20  DC-EDITA-CCYY.
  2276                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  43
* EL130.cbl
  2277                 24  DC-EDITA-YEAR     PIC 99.
  2278         16  DC-GREG-DATE-B-EDIT.
  2279             20  DC-EDITB-MONTH        PIC 99.
  2280             20  SLASHB-1              PIC X VALUE '/'.
  2281             20  DC-EDITB-DAY          PIC 99.
  2282             20  SLASHB-2              PIC X VALUE '/'.
  2283             20  DC-EDITB-CCYY.
  2284                 24  DC-EDITB-CENT     PIC 99.
  2285                 24  DC-EDITB-YEAR     PIC 99.
  2286         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2287         16  DC-GREG-DATE-CYMD-R REDEFINES
  2288                              DC-GREG-DATE-CYMD.
  2289             20  DC-CYMD-CEN           PIC 99.
  2290             20  DC-CYMD-YEAR          PIC 99.
  2291             20  DC-CYMD-MONTH         PIC 99.
  2292             20  DC-CYMD-DAY           PIC 99.
  2293         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2294         16  DC-GREG-DATE-MDCY-R REDEFINES
  2295                              DC-GREG-DATE-MDCY.
  2296             20  DC-MDCY-MONTH         PIC 99.
  2297             20  DC-MDCY-DAY           PIC 99.
  2298             20  DC-MDCY-CEN           PIC 99.
  2299             20  DC-MDCY-YEAR          PIC 99.
  2300    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2301        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2302    12  DC-EL310-DATE                  PIC X(21).
  2303    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  44
* EL130.cbl
  2305*    COPY ELCCALC.
  2306******************************************************************
  2307*                                                                *
  2308*                           ELCCALC.                            *
  2309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2310*                            VMOD=2.025                          *
  2311*                                                                *
  2312*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2313*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2314*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2315*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2316*                                                                *
  2317*  PASSED TO ELRTRM                                              *
  2318*  -----------------                                             *
  2319*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2320*  ORIGINAL TERM                                                 *
  2321*  BEGINNING DATE                                                *
  2322*  ENDING DATE                                                   *
  2323*  COMPANY I.D.                                                  *
  2324*  ACCOUNT MASTER USER FIELD                                     *
  2325*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2326*  FREE LOOK DAYS                                                *
  2327*                                                                *
  2328*  RETURNED FROM ELRTRM                                          *
  2329*  ---------------------                                         *
  2330*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2331*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2332*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2333*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2334*----------------------------------------------------------------*
  2335*  PASSED TO ELRAMT                                              *
  2336*  ----------------                                              *
  2337*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2338*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2339*  ORIGINAL AMOUNT                                               *
  2340*  ALTERNATE BENEFIT (BALLON)                                    *
  2341*  A.P.R. - NET PAY ONLY                                         *
  2342*  METHOD
  2343*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2344*  COMPANY I.D.                                                  *
  2345*  BENEFIT TYPE                                                  *
  2346*                                                                *
  2347*  RETURNED FROM ELRAMT                                          *
  2348*  --------------------                                          *
  2349*  REMAINING AMOUNT 1 - CURRENT                                  *
  2350*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2351*  REMAINING AMOUNT FACTOR
  2352*----------------------------------------------------------------*
  2353*  PASSED TO ELRESV                                              *
  2354*  -----------------                                             *
  2355*  CERTIFICATE EFFECTIVE DATE                                    *
  2356*  VALUATION DATE                                                *
  2357*  PAID THRU DATE                                                *
  2358*  BENEFIT                                                       *
  2359*  INCURRED DATE                                                 *
  2360*  REPORTED DATE                                                 *
  2361*  ISSUE AGE                                                     *
  2362*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  45
* EL130.cbl
  2363*  CDT PERCENT                                                   *
  2364*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2365* *CLAIM TYPE (LIFE, A/H)                                        *
  2366* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2367* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2368*                                                                *
  2369*  RETURNED FROM ELRESV                                          *
  2370*  --------------------                                          *
  2371*  CDT TABLE USED                                                *
  2372*  CDT FACTOR USED                                               *
  2373*  PAY TO CURRENT RESERVE                                        *
  2374*  I.B.N.R. - A/H ONLY                                           *
  2375*  FUTURE (ACCRUED) AH ONLY                                      *
  2376*----------------------------------------------------------------*
  2377*  PASSED TO ELRATE                                              *
  2378*  ----------------                                              *
  2379*  CERT ISSUE DATE                                               *
  2380*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2381*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2382*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2383*  STATE CODE (CLIENT DEFINED)                                   *
  2384*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2385*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2386*  DEVIATION CODE                                                *
  2387*  ISSUE AGE                                                     *
  2388*  ORIGINAL BENEFIT AMOUNT                                       *
  2389*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2390*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2391*  BENEFIT KIND (LIFE OR A/H)                                    *
  2392*  A.P.R.                                                        *
  2393*  METHOD
  2394*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2395*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2396*  COMPANY I.D. (3 CHARACTER)                                    *
  2397*  BENEFIT CODE                                                  *
  2398*  BENEFIT OVERRIDE CODE                                         *
  2399*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2400*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2401*  JOINT INDICATOR (CSL ONLY)                                    *
  2402*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2403*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2404*                                                                *
  2405*  RETURNED FROM ELRATE                                          *
  2406*  --------------------                                          *
  2407*  CALCULATED PREMIUM                                            *
  2408*  PREMIUM RATE                                                  *
  2409*  MORTALITY CODE                                                *
  2410*  MAX ATTAINED AGE                                              *
  2411*  MAX AGE                                                       *
  2412*  MAX TERM                                                      *
  2413*  MAX MONTHLY BENEFIT                                           *
  2414*  MAX TOTAL BENIFIT                                             *
  2415*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2416*----------------------------------------------------------------*
  2417*  PASSED TO ELRFND                                              *
  2418*  ----------------                                              *
  2419*  CERT ISSUE DATE                                               *
  2420*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  46
* EL130.cbl
  2421*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2422*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2423*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2424*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2425*  STATE CODE (CLIENT DEFINED)                                   *
  2426*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2427*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2428*  DEVIATION CODE                                                *
  2429*  ISSUE AGE                                                     *
  2430*  ORIGINAL BENEFIT AMOUNT                                       *
  2431*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2432*  PROCESS TYPE (CANCEL)                                         *
  2433*  BENEFIT KIND (LIFE OR A/H)                                    *
  2434*  A.P.R.                                                        *
  2435*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2436*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2437*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2438*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2439*  COMPANY I.D. (3 CHARACTER)                                    *
  2440*  BENEFIT CODE                                                  *
  2441*  BENEFIT OVERRIDE CODE                                         *
  2442*                                                                *
  2443*  RETURNED FROM ELRFND                                          *
  2444*  --------------------                                          *
  2445*  CALCULATED REFUND                                             *
  2446*----------------------------------------------------------------*
  2447*  PASSED TO ELEARN                                              *
  2448*  ----------------                                              *
  2449*  CERT ISSUE DATE                                               *
  2450*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2451*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2452*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2453*  STATE CODE (CLIENT DEFINED)                                   *
  2454*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2455*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2456*  DEVIATION CODE                                                *
  2457*  ISSUE AGE                                                     *
  2458*  ORIGINAL BENEFIT AMOUNT                                       *
  2459*  BENEFIT KIND (LIFE OR A/H)                                    *
  2460*  A.P.R.                                                        *
  2461*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2462*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2463*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2464*  COMPANY I.D. (3 CHARACTER)                                    *
  2465*  BENEFIT CODE                                                  *
  2466*  BENEFIT OVERRIDE CODE                                         *
  2467*                                                                *
  2468*  RETURNED FROM ELEARN                                          *
  2469*  --------------------                                          *
  2470*  INDICATED  EARNINGS                                           *
  2471*----------------------------------------------------------------*
  2472*                 LENGTH = 450                                   *
  2473*                                                                *
  2474******************************************************************
  2475******************************************************************
  2476*                   C H A N G E   L O G
  2477*
  2478* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  47
* EL130.cbl
  2479*-----------------------------------------------------------------
  2480*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2481* EFFECTIVE    NUMBER
  2482*-----------------------------------------------------------------
  2483* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2484* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2485* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2486* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2487* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2488* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2489* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2490* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2491* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2492* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2493* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2494******************************************************************
  2495
  2496 01  CALCULATION-PASS-AREA.
  2497     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2498                                     COMP.
  2499
  2500     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2501       88  NO-CP-ERROR                             VALUE ZERO.
  2502       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2503                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2504       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2505       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2506       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2507       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2508       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2509       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2510       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2511       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2512       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2513       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2514       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2515       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2516       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2517       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2518       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2519       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2520       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2521
  2522     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2523       88  NO-CP-ERROR-2                           VALUE ZERO.
  2524***********************  INPUT AREAS ****************************
  2525
  2526     12  CP-CALCULATION-AREA.
  2527         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2528         16  CP-CERT-EFF-DT        PIC XX.
  2529         16  CP-VALUATION-DT       PIC XX.
  2530         16  CP-PAID-THRU-DT       PIC XX.
  2531         16  CP-BENEFIT-TYPE       PIC X.
  2532           88  CP-AH                               VALUE 'A' 'D'
  2533                                                   'I' 'U'.
  2534           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2535           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2536         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  48
* EL130.cbl
  2537         16  CP-REPORTED-DT        PIC XX.
  2538         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2539         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2540         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2541                                     COMP-3.
  2542         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2543                                     COMP-3.
  2544         16  CP-CDT-METHOD         PIC X.
  2545           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2546           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2547           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2548         16  CP-CLAIM-TYPE         PIC X.
  2549           88  CP-AH-CLAIM                         VALUE 'A'.
  2550           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2551         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2552                                     COMP-3.
  2553         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2554                                     COMP-3.
  2555         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2556                                     COMP-3.
  2557         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2558                                     COMP-3.
  2559         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2562                                     COMP-3.
  2563         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2564                                     COMP-3.
  2565         16  CP-REM-TERM-METHOD    PIC X.
  2566           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2567           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2568           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2569           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2570           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2571           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2572           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2573         16  CP-EARNING-METHOD     PIC X.
  2574           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2575           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2576           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2577           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2578           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2579           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2580           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2581           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2582           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2583           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2584           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2585           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2586           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2587           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2588         16  CP-PROCESS-TYPE       PIC X.
  2589           88  CP-CLAIM                            VALUE '1'.
  2590           88  CP-CANCEL                           VALUE '2'.
  2591           88  CP-ISSUE                            VALUE '3'.
  2592         16  CP-SPECIAL-CALC-CD    PIC X.
  2593           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2594           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  49
* EL130.cbl
  2595           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2596           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2597           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2598           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2599           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2600           88  CP-FARM-PLAN                    VALUE 'F'.
  2601           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2602           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2603           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2604           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2605           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2606           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2607           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2608           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2609           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2610           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2611                                                     'W' 'X'.
  2612           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2613           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2614           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2615           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2616           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2617           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2618           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2619           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2620           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2621           88  CP-CSL-METH-1                   VALUE '5'.
  2622           88  CP-CSL-METH-2                   VALUE '6'.
  2623           88  CP-CSL-METH-3                   VALUE '7'.
  2624           88  CP-CSL-METH-4                   VALUE '8'.
  2625
  2626         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2627                                     COMP-3.
  2628         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2629         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2630         16  CP-STATE              PIC XX          VALUE SPACE.
  2631         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2632         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2633           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2634               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2635         16  CP-R78-OPTION         PIC X.
  2636           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2637           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2638
  2639         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2640         16  CP-IBNR-RESERVE-SW    PIC X.
  2641         16  CP-CLAIM-STATUS       PIC X.
  2642         16  CP-RATE-FILE          PIC X.
  2643         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2644                                     COMP-3.
  2645
  2646         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2647         16  CP-AH-OVERRIDE-CODE   PIC X.
  2648
  2649         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2650                                     COMP-3.
  2651         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2652                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  50
* EL130.cbl
  2653         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2654                                     COMP-3.
  2655         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2656                                     COMP-3.
  2657         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2658                                     COMP-3.
  2659         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2660                                  PIC S9(7)V99 COMP-3.
  2661
  2662         16  CP-PAID-FROM-DATE     PIC X(02).
  2663         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2664         16  CP-EXT-DAYS-CALC      PIC X.
  2665           88  CP-EXT-NO-CHG                   VALUE ' '.
  2666           88  CP-EXT-CHG-LF                   VALUE '1'.
  2667           88  CP-EXT-CHG-AH                   VALUE '2'.
  2668           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2669         16  CP-DOMICILE-STATE     PIC XX.
  2670         16  CP-CARRIER            PIC X.
  2671         16  CP-REIN-FLAG          PIC X.
  2672         16  CP-REM-TRM-CALC-OPTION PIC X.
  2673           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2674                      '2' '3' '4' '5'.
  2675           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2676           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2677           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2678           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2679           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2680           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2681           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2682           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2683         16  CP-SIG-SWITCH         PIC X.
  2684         16  CP-RATING-METHOD      PIC X.
  2685           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2686           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2687           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2688           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2689           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2690           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2691           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2692           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2693           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2694         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2695                                     COMP-3.
  2696         16  CP-BEN-CATEGORY       PIC X.
  2697         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2698         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2699                                   PIC S99V9(5) COMP-3.
  2700         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2701         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2702                                   PIC S99V9(5) COMP-3.
  2703         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2704         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2705         16  CP-EXPIRE-DT          PIC XX.
  2706         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2707         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2708         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2709         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2710         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  51
* EL130.cbl
  2711             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2712             88  CP-CALC-CLP              VALUE 'C'.
  2713         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2714         16  CP-CANCEL-REASON      PIC X.
  2715         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2716         16  CP-PMT-MODE           PIC X.
  2717         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2718         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2719         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2720         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2721         16  FILLER                PIC X.
  2722
  2723***************    OUTPUT FROM ELRESV   ************************
  2724
  2725         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2726
  2727         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2728                                     COMP-3.
  2729         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2730                                     COMP-3.
  2731         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2732                                     COMP-3.
  2733         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2734                                     COMP-3.
  2735         16  FILLER                PIC X(09).
  2736***************    OUTPUT FROM ELRTRM   *************************
  2737
  2738         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2739                                     COMP-3.
  2740         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2741                                     COMP-3.
  2742         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2743                                     COMP-3.
  2744         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2745                                     COMP-3.
  2746         16  FILLER                PIC X(12).
  2747
  2748***************    OUTPUT FROM ELRAMT   *************************
  2749
  2750         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2751                                     COMP-3.
  2752         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2753                                     COMP-3.
  2754         16  FILLER                PIC X(12).
  2755
  2756***************    OUTPUT FROM ELRATE   *************************
  2757
  2758         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2759                                     COMP-3.
  2760         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2761                                     COMP-3.
  2762         16  CP-MORTALITY-CODE     PIC X(4).
  2763         16  CP-RATE-EDIT-FLAG     PIC X.
  2764             88  CP-RATES-NEED-APR                  VALUE '1'.
  2765         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2766                                     COMP-3.
  2767         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2768         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  52
* EL130.cbl
  2769         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2770                                   PIC S9(7)V99 COMP-3.
  2771         16  FILLER                PIC X(07).
  2772
  2773***************    OUTPUT FROM ELRFND   *************************
  2774
  2775         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2776                                     COMP-3.
  2777         16  CP-REFUND-TYPE-USED   PIC X.
  2778           88  CP-R-AS-R78                         VALUE '1'.
  2779           88  CP-R-AS-PRORATA                     VALUE '2'.
  2780           88  CP-R-AS-CALIF                       VALUE '3'.
  2781           88  CP-R-AS-TEXAS                       VALUE '4'.
  2782           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2783           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2784           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2785           88  CP-R-AS-MEAN                        VALUE '8'.
  2786           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2787           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2788           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2789           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2790           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2791           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2792         16  FILLER                PIC X(12).
  2793
  2794***************    OUTPUT FROM ELEARN   *************************
  2795
  2796         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2797                                     COMP-3.
  2798         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2799                                     COMP-3.
  2800         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2801                                     COMP-3.
  2802         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2803                                     COMP-3.
  2804         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2805                                     COMP-3.
  2806         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2807                                     COMP-3.
  2808         16  CP-EARNING-TYPE-USED  PIC X.
  2809           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2810           88  CP-E-AS-R78                         VALUE '1'.
  2811           88  CP-E-AS-PRORATA                     VALUE '2'.
  2812           88  CP-E-AS-TEXAS                       VALUE '4'.
  2813           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2814           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2815           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2816           88  CP-E-AS-MEAN                        VALUE '8'.
  2817           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2818         16  FILLER                PIC X(12).
  2819
  2820***************    OUTPUT FROM ELPMNT   *************************
  2821
  2822         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2823                                     COMP-3.
  2824         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2825                                     COMP-3.
  2826         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  53
* EL130.cbl
  2827
  2828***************   MISC WORK AREAS    *****************************
  2829         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2830                                     COMP-3.
  2831         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2832                                     COMP-3.
  2833         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2834                                     COMP-3.
  2835         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2836                                     COMP-3.
  2837         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2838                                     COMP-3.
  2839         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2840                                     COMP-3.
  2841         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2842             88  OPEN-RATE-FILE                   VALUE 'O'.
  2843             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2844             88  IO-ERROR                         VALUE 'E'.
  2845
  2846         16  CP-FIRST-PAY-DATE     PIC XX.
  2847
  2848         16  CP-JOINT-INDICATOR    PIC X.
  2849
  2850         16  CP-RESERVE-REMAINING-TERM
  2851                                   PIC S9(4)V9    VALUE ZERO
  2852                                     COMP-3.
  2853
  2854         16  CP-INSURED-BIRTH-DT   PIC XX.
  2855
  2856         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2857                                     COMP-3.
  2858
  2859         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2860                                     COMP-3.
  2861
  2862         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2863                                     COMP-3.
  2864
  2865         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2866                                     COMP-3.
  2867
  2868         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2869                                     COMP-3.
  2870
  2871         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2872                                     COMP-3.
  2873
  2874         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2875                                     COMP-3.
  2876
  2877         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2878             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2879
  2880         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2881                                     COMP-3.
  2882         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2883                                     COMP-3.
  2884         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  54
* EL130.cbl
  2885         16  cp-extra-periods      pic 9 value zeros.
  2886         16  cp-net-only-state     pic x value spaces.
  2887         16  FILLER                PIC X(13).
  2888******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  55
* EL130.cbl
  2890*    COPY ELCLOGOF.
  2891******************************************************************
  2892*                                                                *
  2893*                                                                *
  2894*                            ELCLOGOF.                           *
  2895*                            VMOD=2.001                          *
  2896*                                                                *
  2897*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2898*                                                                *
  2899******************************************************************
  2900 01  CLASIC-LOGOFF.
  2901     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2902     12  LOGOFF-TEXT.
  2903         16  FILLER          PIC X(5)    VALUE SPACES.
  2904         16  LOGOFF-MSG.
  2905             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2906             20  FILLER      PIC X       VALUE SPACES.
  2907             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2908         16  FILLER          PIC X(80)
  2909           VALUE '* YOU ARE NOW LOGGED OFF'.
  2910         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2911         16  FILLER          PIC X       VALUE QUOTE.
  2912         16  LOGOFF-SYS-MSG  PIC X(17)
  2913           VALUE 'S CLAS-IC SYSTEM '.
  2914     12  TEXT-MESSAGES.
  2915         16  UNACCESS-MSG    PIC X(29)
  2916             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2917         16  PGMIDERR-MSG    PIC X(17)
  2918             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  56
* EL130.cbl
  2920*    COPY ELCATTR.
  2921******************************************************************
  2922*                                                                *
  2923*                            ELCATTR.                            *
  2924*                            VMOD=2.001                          *
  2925*                                                                *
  2926*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2927*                                                                *
  2928*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2929*                                                                *
  2930*                   POS 1   P=PROTECTED                          *
  2931*                           U=UNPROTECTED                        *
  2932*                           S=ASKIP                              *
  2933*                   POS 2   A=ALPHA/NUMERIC                      *
  2934*                           N=NUMERIC                            *
  2935*                   POS 3   N=NORMAL                             *
  2936*                           B=BRIGHT                             *
  2937*                           D=DARK                               *
  2938*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2939*                           OF=MODIFIED DATA TAG OFF             *
  2940*                                                                *
  2941*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2942******************************************************************
  2943 01  ATTRIBUTE-LIST.
  2944     12  AL-PABOF            PIC X       VALUE 'Y'.
  2945     12  AL-PABON            PIC X       VALUE 'Z'.
  2946     12  AL-PADOF            PIC X       VALUE '%'.
  2947     12  AL-PADON            PIC X       VALUE '_'.
  2948     12  AL-PANOF            PIC X       VALUE '-'.
  2949     12  AL-PANON            PIC X       VALUE '/'.
  2950     12  AL-SABOF            PIC X       VALUE '8'.
  2951     12  AL-SABON            PIC X       VALUE '9'.
  2952     12  AL-SADOF            PIC X       VALUE '@'.
  2953     12  AL-SADON            PIC X       VALUE QUOTE.
  2954     12  AL-SANOF            PIC X       VALUE '0'.
  2955     12  AL-SANON            PIC X       VALUE '1'.
  2956     12  AL-UABOF            PIC X       VALUE 'H'.
  2957     12  AL-UABON            PIC X       VALUE 'I'.
  2958     12  AL-UADOF            PIC X       VALUE '<'.
  2959     12  AL-UADON            PIC X       VALUE '('.
  2960     12  AL-UANOF            PIC X       VALUE ' '.
  2961     12  AL-UANON            PIC X       VALUE 'A'.
  2962     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2963     12  AL-UNBON            PIC X       VALUE 'R'.
  2964     12  AL-UNDOF            PIC X       VALUE '*'.
  2965     12  AL-UNDON            PIC X       VALUE ')'.
  2966     12  AL-UNNOF            PIC X       VALUE '&'.
  2967     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  57
* EL130.cbl
  2969*    COPY ELCEMIB.
  2970******************************************************************
  2971*                                                                *
  2972*                                                                *
  2973*                            ELCEMIB.                            *
  2974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2975*                            VMOD=2.005                          *
  2976*                                                                *
  2977*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2978*                                                                *
  2979******************************************************************
  2980 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2981     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2982     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2983     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2984     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2985     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2986     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2987     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2988     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2989     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2990         88  EMI-NO-ERRORS                    VALUE '1'.
  2991         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2992         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2993     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2994         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2995     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2996         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2997         88  EMI-AREA1-FULL                   VALUE '2'.
  2998     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2999         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3000         88  EMI-AREA2-FULL                   VALUE '2'.
  3001     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3002         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3003         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3004         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3005         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3006         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3007     12  EMI-ERROR-LINES.
  3008         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3009         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3010         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3011         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3012             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3013                 24  EMI-ERR-NUM         PIC X(4).
  3014                 24  EMI-FILLER          PIC X.
  3015                 24  EMI-SEV             PIC X.
  3016                 24  FILLER              PIC X.
  3017             20  FILLER                  PIC X(02).
  3018     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3019         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3020             20  EMI-ERROR-NUMBER    PIC X(4).
  3021             20  EMI-FILL            PIC X.
  3022             20  EMI-SEVERITY        PIC X.
  3023             20  FILLER              PIC X.
  3024             20  EMI-ERROR-TEXT.
  3025                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3026                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  58
* EL130.cbl
  3027     12  EMI-SEVERITY-SAVE           PIC X.
  3028         88  EMI-NOTE                    VALUE 'N'.
  3029         88  EMI-WARNING                 VALUE 'W'.
  3030         88  EMI-FORCABLE                VALUE 'F'.
  3031         88  EMI-FATAL                   VALUE 'X'.
  3032     12  EMI-MESSAGE-FLAG            PIC X.
  3033         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3034         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3035     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3036     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3037         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3038         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3039         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3040     12  emi-claim-no                pic x(7).
  3041     12  emi-claim-type              pic x(6).
  3042     12  FILLER                      PIC X(124)  VALUE SPACES.
  3043     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3044     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3045     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3046     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  59
* EL130.cbl
  3048*    COPY ELCJPFX.
  3049******************************************************************
  3050*                                                                *
  3051*                                                                *
  3052*                            ELCJPFX.                            *
  3053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3054*                            VMOD=2.002                          *
  3055*                                                                *
  3056*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3057*                                                                *
  3058*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3059*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3060*        ELCNTL - CONTROL FILE                                   *
  3061*        ELMSTR - CLAIM MASTERS                                  *
  3062*        ELTRLR - ACTIVITY TRAILERS                              *
  3063*        ELCHKQ - CHECK QUE                                      *
  3064******************************************************************
  3065 01  JOURNAL-RECORD.
  3066     12  jp-date                     pic s9(5) comp-3.
  3067     12  jp-time                     pic s9(7) comp-3.
  3068     12  JP-USER-ID                  PIC X(4).
  3069     12  JP-FILE-ID                  PIC X(8).
  3070     12  JP-PROGRAM-ID               PIC X(8).
  3071     12  JP-RECORD-TYPE              PIC X.
  3072         88 JP-ADD              VALUE 'A'.
  3073         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3074         88 JP-AFTER-CHANGE     VALUE 'C'.
  3075         88 JP-DELETE           VALUE 'D'.
  3076         88 JP-GENERIC-DELETE   VALUE 'G'.
  3077         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3078         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3079     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3080     12  JP-RECORD-AREA
  3081
  3082
  3083         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  60
* EL130.cbl
  3085*    COPY ELCAID.
  3086******************************************************************
  3087*                                                                *
  3088*                            ELCAID.                             *
  3089*                            VMOD=2.001                          *
  3090*                                                                *
  3091*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3092*                                                                *
  3093*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3094*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3095******************************************************************
  3096
  3097 01  DFHAID.
  3098   02  DFHNULL   PIC  X  VALUE  ' '.
  3099   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3100   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3101   02  DFHPEN    PIC  X  VALUE  '='.
  3102   02  DFHOPID   PIC  X  VALUE  'W'.
  3103   02  DFHPA1    PIC  X  VALUE  '%'.
  3104   02  DFHPA2    PIC  X  VALUE  '>'.
  3105   02  DFHPA3    PIC  X  VALUE  ','.
  3106   02  DFHPF1    PIC  X  VALUE  '1'.
  3107   02  DFHPF2    PIC  X  VALUE  '2'.
  3108   02  DFHPF3    PIC  X  VALUE  '3'.
  3109   02  DFHPF4    PIC  X  VALUE  '4'.
  3110   02  DFHPF5    PIC  X  VALUE  '5'.
  3111   02  DFHPF6    PIC  X  VALUE  '6'.
  3112   02  DFHPF7    PIC  X  VALUE  '7'.
  3113   02  DFHPF8    PIC  X  VALUE  '8'.
  3114   02  DFHPF9    PIC  X  VALUE  '9'.
  3115   02  DFHPF10   PIC  X  VALUE  ':'.
  3116   02  DFHPF11   PIC  X  VALUE  '#'.
  3117   02  DFHPF12   PIC  X  VALUE  '@'.
  3118   02  DFHPF13   PIC  X  VALUE  'A'.
  3119   02  DFHPF14   PIC  X  VALUE  'B'.
  3120   02  DFHPF15   PIC  X  VALUE  'C'.
  3121   02  DFHPF16   PIC  X  VALUE  'D'.
  3122   02  DFHPF17   PIC  X  VALUE  'E'.
  3123   02  DFHPF18   PIC  X  VALUE  'F'.
  3124   02  DFHPF19   PIC  X  VALUE  'G'.
  3125   02  DFHPF20   PIC  X  VALUE  'H'.
  3126   02  DFHPF21   PIC  X  VALUE  'I'.
  3127*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3128   02  DFHPF22   PIC  X  VALUE  '['.
  3129   02  DFHPF23   PIC  X  VALUE  '.'.
  3130   02  DFHPF24   PIC  X  VALUE  '<'.
  3131   02  DFHMSRE   PIC  X  VALUE  'X'.
  3132   02  DFHSTRF   PIC  X  VALUE  'h'.
  3133   02  DFHTRIG   PIC  X  VALUE  '"'.
  3134
  3135 01  FILLER    REDEFINES DFHAID.
  3136     12  FILLER              PIC X(8).
  3137     12  PF-VALUES           PIC X       OCCURS 12.
  3138
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  61
* EL130.cbl
  3140****************************************************************
  3141*
  3142* Copyright (c) 2007-2013 Dell Inc.
  3143* All rights reserved.
  3144*
  3145****************************************************************
  3146 01  DFHEIV.
  3147   02  DFHEIV0               PIC X(35).
  3148   02  DFHEIV1               PIC X(08).
  3149   02  DFHEIV2               PIC X(08).
  3150   02  DFHEIV3               PIC X(08).
  3151   02  DFHEIV4               PIC X(06).
  3152   02  DFHEIV5               PIC X(04).
  3153   02  DFHEIV6               PIC X(04).
  3154   02  DFHEIV7               PIC X(02).
  3155   02  DFHEIV8               PIC X(02).
  3156   02  DFHEIV9               PIC X(01).
  3157   02  DFHEIV10              PIC S9(7) COMP-3.
  3158   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3159   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3160   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3161   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3162   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3163   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3164   02  DFHEIV17              PIC X(04).
  3165   02  DFHEIV18              PIC X(04).
  3166   02  DFHEIV19              PIC X(04).
  3167   02  DFHEIV20              USAGE IS POINTER.
  3168   02  DFHEIV21              USAGE IS POINTER.
  3169   02  DFHEIV22              USAGE IS POINTER.
  3170   02  DFHEIV23              USAGE IS POINTER.
  3171   02  DFHEIV24              USAGE IS POINTER.
  3172   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3173   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3174   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3175   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3176   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3177   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3178   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3179   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3180   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3181   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3182   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3183   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3184   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3185   02  FILLER                PIC X(02).
  3186   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3187   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3188   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3189   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3190   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3191   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3192   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3193 LINKAGE  SECTION.
  3194*****************************************************************
  3195*                                                               *
  3196* Copyright (c) 2007-2013 Dell Inc.                             *
  3197* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  62
* EL130.cbl
  3198*                                                               *
  3199*****************************************************************
  3200 01  dfheiblk.
  3201     02  eibtime          pic s9(7) comp-3.
  3202     02  eibdate          pic s9(7) comp-3.
  3203     02  eibtrnid         pic x(4).
  3204     02  eibtaskn         pic s9(7) comp-3.
  3205     02  eibtrmid         pic x(4).
  3206     02  dfheigdi         pic s9(4) comp.
  3207     02  eibcposn         pic s9(4) comp.
  3208     02  eibcalen         pic s9(4) comp.
  3209     02  eibaid           pic x(1).
  3210     02  eibfiller1       pic x(1).
  3211     02  eibfn            pic x(2).
  3212     02  eibfiller2       pic x(2).
  3213     02  eibrcode         pic x(6).
  3214     02  eibfiller3       pic x(2).
  3215     02  eibds            pic x(8).
  3216     02  eibreqid         pic x(8).
  3217     02  eibrsrce         pic x(8).
  3218     02  eibsync          pic x(1).
  3219     02  eibfree          pic x(1).
  3220     02  eibrecv          pic x(1).
  3221     02  eibsend          pic x(1).
  3222     02  eibatt           pic x(1).
  3223     02  eibeoc           pic x(1).
  3224     02  eibfmh           pic x(1).
  3225     02  eibcompl         pic x(1).
  3226     02  eibsig           pic x(1).
  3227     02  eibconf          pic x(1).
  3228     02  eiberr           pic x(1).
  3229     02  eibrldbk         pic x(1).
  3230     02  eiberrcd         pic x(4).
  3231     02  eibsynrb         pic x(1).
  3232     02  eibnodat         pic x(1).
  3233     02  eibfiller5       pic x(2).
  3234     02  eibresp          pic s9(8) comp.
  3235     02  eibresp2         pic s9(8) comp.
  3236     02  dfheigdj         pic s9(4) comp.
  3237     02  dfheigdk         pic s9(4) comp.
  3238
  3239 01  DFHCOMMAREA             PIC X(1024).
  3240
  3241*01 PARMLIST .
  3242*    02  FILLER              PIC S9(8)   COMP.
  3243*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3244*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3245*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3246*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3247*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3248*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3249*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3250*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3251*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  63
* EL130.cbl
  3253*    COPY ELCMSTR.
  3254******************************************************************
  3255*                                                                *
  3256*                            ELCMSTR.                            *
  3257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3258*                            VMOD=2.012                          *
  3259*                                                                *
  3260*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3261*                                                                *
  3262*   FILE TYPE = VSAM,KSDS                                        *
  3263*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3264*                                                                *
  3265*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3266*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3267*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3268*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3269*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3270*                                                 RKP=75,LEN=21  *
  3271*                                                                *
  3272*   **** NOTE ****                                               *
  3273*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3274*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3275*                                                                *
  3276*   LOG = YES                                                    *
  3277*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3278******************************************************************
  3279*                   C H A N G E   L O G
  3280*
  3281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3282*-----------------------------------------------------------------
  3283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3284* EFFECTIVE    NUMBER
  3285*-----------------------------------------------------------------
  3286* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3287* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3288* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3289* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3290* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3291* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3292******************************************************************
  3293 01  CLAIM-MASTER.
  3294     12  CL-RECORD-ID                PIC XX.
  3295         88  VALID-CL-ID         VALUE 'CL'.
  3296
  3297     12  CL-CONTROL-PRIMARY.
  3298         16  CL-COMPANY-CD           PIC X.
  3299         16  CL-CARRIER              PIC X.
  3300         16  CL-CLAIM-NO             PIC X(7).
  3301         16  CL-CERT-NO.
  3302             20  CL-CERT-PRIME       PIC X(10).
  3303             20  CL-CERT-SFX         PIC X.
  3304
  3305     12  CL-CONTROL-BY-NAME.
  3306         16  CL-COMPANY-CD-A1        PIC X.
  3307         16  CL-INSURED-LAST-NAME    PIC X(15).
  3308         16  CL-INSURED-NAME.
  3309             20  CL-INSURED-1ST-NAME PIC X(12).
  3310             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  64
* EL130.cbl
  3311
  3312     12  CL-CONTROL-BY-SSN.
  3313         16  CL-COMPANY-CD-A2        PIC X.
  3314         16  CL-SOC-SEC-NO.
  3315             20  CL-SSN-STATE        PIC XX.
  3316             20  CL-SSN-ACCOUNT      PIC X(6).
  3317             20  CL-SSN-LN3          PIC X(3).
  3318
  3319     12  CL-CONTROL-BY-CERT-NO.
  3320         16  CL-COMPANY-CD-A4        PIC X.
  3321         16  CL-CERT-NO-A4.
  3322             20  CL-CERT-A4-PRIME    PIC X(10).
  3323             20  CL-CERT-A4-SFX      PIC X.
  3324
  3325     12  CL-CONTROL-BY-CCN.
  3326         16  CL-COMPANY-CD-A5        PIC X.
  3327         16  CL-CCN-A5.
  3328             20  CL-CCN.
  3329                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3330                 24  CL-CCN-PRIME-A5 PIC X(12).
  3331             20  CL-CCN-FILLER-A5    PIC X(4).
  3332
  3333     12  CL-INSURED-PROFILE-DATA.
  3334         16  CL-INSURED-BIRTH-DT     PIC XX.
  3335         16  CL-INSURED-SEX-CD       PIC X.
  3336             88  INSURED-IS-MALE        VALUE 'M'.
  3337             88  INSURED-IS-FEMALE      VALUE 'F'.
  3338             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3339         16  CL-INSURED-OCC-CD       PIC X(6).
  3340         16  FILLER                  PIC X(5).
  3341
  3342     12  CL-PROCESSING-INFO.
  3343         16  CL-PROCESSOR-ID         PIC X(4).
  3344         16  CL-CLAIM-STATUS         PIC X.
  3345             88  CLAIM-IS-OPEN          VALUE 'O'.
  3346             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3347         16  CL-CLAIM-TYPE           PIC X.
  3348*            88  AH-CLAIM               VALUE 'A'.
  3349*            88  LIFE-CLAIM             VALUE 'L'.
  3350*            88  PROPERTY-CLAIM         VALUE 'P'.
  3351*            88  IUI-CLAIM              VALUE 'I'.
  3352*            88  GAP-CLAIM              VALUE 'G'.
  3353*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3354         16  CL-CLAIM-PREM-TYPE      PIC X.
  3355             88  SINGLE-PREMIUM         VALUE '1'.
  3356             88  O-B-COVERAGE           VALUE '2'.
  3357             88  OPEN-END-COVERAGE      VALUE '3'.
  3358         16  CL-INCURRED-DT          PIC XX.
  3359         16  CL-REPORTED-DT          PIC XX.
  3360         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3361         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3362         16  CL-LAST-PMT-DT          PIC XX.
  3363         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3364         16  CL-PAID-THRU-DT         PIC XX.
  3365         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3366         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3367         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3368         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  65
* EL130.cbl
  3369             88  CL-360-DAY-YR          VALUE '1'.
  3370             88  CL-365-DAY-YR          VALUE '2'.
  3371             88  CL-FULL-MONTHS         VALUE '3'.
  3372         16  CL-CAUSE-CD             PIC X(6).
  3373
  3374         16  CL-PRIME-CERT-NO.
  3375             20  CL-PRIME-CERT-PRIME PIC X(10).
  3376             20  CL-PRIME-CERT-SFX   PIC X.
  3377
  3378         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3379             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3380             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3381
  3382         16  CL-MICROFILM-NO         PIC X(10).
  3383         16  FILLER REDEFINES CL-MICROFILM-NO.
  3384             20  CL-BENEFIT-PERIOD   PIC 99.
  3385             20  FILLER              PIC X(8).
  3386         16  CL-PROG-FORM-TYPE       PIC X.
  3387         16  CL-LAST-ADD-ON-DT       PIC XX.
  3388
  3389         16  CL-LAST-REOPEN-DT       PIC XX.
  3390         16  CL-LAST-CLOSE-DT        PIC XX.
  3391         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3392             88  FINAL-PAID             VALUE '1'.
  3393             88  CLAIM-DENIED           VALUE '2'.
  3394             88  AUTO-CLOSE             VALUE '3'.
  3395             88  MANUAL-CLOSE           VALUE '4'.
  3396             88  BENEFITS-CHANGED       VALUE 'C'.
  3397             88  SETUP-ERRORS           VALUE 'E'.
  3398         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3399         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3400         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3401             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3402         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3403         16  FILLER                  PIC X.
  3404
  3405     12  CL-CERTIFICATE-DATA.
  3406         16  CL-CERT-ORIGIN          PIC X.
  3407             88  CERT-WAS-ONLINE        VALUE '1'.
  3408             88  CERT-WAS-CREATED       VALUE '2'.
  3409             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3410         16  CL-CERT-KEY-DATA.
  3411             20  CL-CERT-CARRIER     PIC X.
  3412             20  CL-CERT-GROUPING    PIC X(6).
  3413             20  CL-CERT-STATE       PIC XX.
  3414             20  CL-CERT-ACCOUNT.
  3415                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3416                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3417             20  CL-CERT-EFF-DT      PIC XX.
  3418
  3419     12  CL-STATUS-CONTROLS.
  3420         16  CL-PRIORITY-CD          PIC X.
  3421             88  CONFIDENTIAL-DATA      VALUE '8'.
  3422             88  HIGHEST-PRIORITY       VALUE '9'.
  3423         16  CL-SUPV-ATTN-CD         PIC X.
  3424             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3425             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3426         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  66
* EL130.cbl
  3427         16  CL-RESTORED-DT          PIC XX.
  3428         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3429         16  CL-NEXT-RESEND-DT       PIC XX.
  3430         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3431         16  CL-CRITICAL-PERIOD      PIC 99.
  3432*        16  FILLER                  PIC XX.
  3433         16  CL-LAST-MAINT-DT        PIC XX.
  3434         16  CL-LAST-MAINT-USER      PIC X(4).
  3435         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3436         16  CL-LAST-MAINT-TYPE      PIC X.
  3437             88  CLAIM-SET-UP           VALUE ' '.
  3438             88  PAYMENT-MADE           VALUE '1'.
  3439             88  LETTER-SENT            VALUE '2'.
  3440             88  MASTER-WAS-ALTERED     VALUE '3'.
  3441             88  MASTER-WAS-RESTORED    VALUE '4'.
  3442             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3443             88  FILE-CONVERTED         VALUE '6'.
  3444             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3445             88  ERROR-CORRECTION       VALUE 'E'.
  3446         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3447         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3448         16  CL-BENEFICIARY          PIC X(10).
  3449         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3450         16  CL-DENIAL-TYPE          PIC X.
  3451             88  CL-TYPE-DENIAL          VALUE '1'.
  3452             88  CL-TYPE-RESCISSION      VALUE '2'.
  3453             88  CL-TYPE-REFORMATION     VALUE '3'.
  3454             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3455             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3456         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3457         16  filler                  pic x(3).
  3458*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3459*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3460*        16  CL-RTW-DT               PIC XX.
  3461
  3462     12  CL-TRAILER-CONTROLS.
  3463         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3464             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3465             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3466             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3467         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3468         16  FILLER                  PIC XX.
  3469         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3470         16  CL-ADDRESS-TRAILER-CNT.
  3471             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3472                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3473             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3474                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3475             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3476                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3477             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3478                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3479             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3480                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3481             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3482                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3483             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3484                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  67
* EL130.cbl
  3485
  3486     12  CL-CV-REFERENCE-NO.
  3487         16  CL-CV-REFNO-PRIME       PIC X(18).
  3488         16  CL-CV-REFNO-SFX         PIC XX.
  3489
  3490     12  CL-FILE-LOCATION            PIC X(4).
  3491
  3492     12  CL-PROCESS-ERRORS.
  3493         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3494             88  NO-FATAL-ERRORS        VALUE ZERO.
  3495         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3496             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3497
  3498     12  CL-PRODUCT-CD               PIC X.
  3499
  3500     12  CL-CURRENT-KEY-DATA.
  3501         16  CL-CURRENT-CARRIER      PIC X.
  3502         16  CL-CURRENT-GROUPING     PIC X(6).
  3503         16  CL-CURRENT-STATE        PIC XX.
  3504         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3505
  3506     12  CL-ASSOCIATES               PIC X.
  3507         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3508         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3509         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3510         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3511
  3512     12  CL-ACTIVITY-CODE            PIC 99.
  3513     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3514     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3515
  3516     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3517     12  CL-LAG-REPORT-CODE          PIC 9.
  3518     12  CL-LOAN-TYPE                PIC XX.
  3519     12  CL-LEGAL-STATE              PIC XX.
  3520
  3521     12  CL-YESNOSW                  PIC X.
  3522     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3523         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3524         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3525         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3526     12  cl-insured-type             pic x.
  3527         88  cl-claim-on-primary         value 'P'.
  3528         88  cl-claim-on-co-borrower     value 'C'.
  3529     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  68
* EL130.cbl
  3531*    COPY ELCCNTL.
  3532******************************************************************
  3533*                                                                *
  3534*                                                                *
  3535*                            ELCCNTL.                            *
  3536*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3537*                            VMOD=2.059                          *
  3538*                                                                *
  3539*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3540*                                                                *
  3541*   FILE TYPE = VSAM,KSDS                                        *
  3542*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3543*                                                                *
  3544*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3545*       ALTERNATE INDEX = NONE                                   *
  3546*                                                                *
  3547*   LOG = YES                                                    *
  3548*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3549******************************************************************
  3550*                   C H A N G E   L O G
  3551*
  3552* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3553*-----------------------------------------------------------------
  3554*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3555* EFFECTIVE    NUMBER
  3556*-----------------------------------------------------------------
  3557* 082503                   PEMA  ADD BENEFIT GROUP
  3558* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3559* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3560* 092705    2005050300006  PEMA  ADD SPP LEASES
  3561* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3562* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3563* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3564* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3565* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3566* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3567* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3568* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3569* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3570* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3571* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3572******************************************************************
  3573*
  3574 01  CONTROL-FILE.
  3575     12  CF-RECORD-ID                       PIC XX.
  3576         88  VALID-CF-ID                        VALUE 'CF'.
  3577
  3578     12  CF-CONTROL-PRIMARY.
  3579         16  CF-COMPANY-ID                  PIC XXX.
  3580         16  CF-RECORD-TYPE                 PIC X.
  3581             88  CF-COMPANY-MASTER              VALUE '1'.
  3582             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3583             88  CF-STATE-MASTER                VALUE '3'.
  3584             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3585             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3586             88  CF-CARRIER-MASTER              VALUE '6'.
  3587             88  CF-MORTALITY-MASTER            VALUE '7'.
  3588             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  69
* EL130.cbl
  3589             88  CF-TERMINAL-MASTER             VALUE '9'.
  3590             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3591             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3592             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3593             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3594             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3595             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3596             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3597             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3598             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3599         16  CF-ACCESS-CD-GENL              PIC X(4).
  3600         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3601             20  CF-PROCESSOR               PIC X(4).
  3602         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3603             20  CF-STATE-CODE              PIC XX.
  3604             20  FILLER                     PIC XX.
  3605         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3606             20  FILLER                     PIC XX.
  3607             20  CF-HI-BEN-IN-REC           PIC XX.
  3608         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3609             20  FILLER                     PIC XXX.
  3610             20  CF-CARRIER-CNTL            PIC X.
  3611         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3612             20  FILLER                     PIC XX.
  3613             20  CF-HI-TYPE-IN-REC          PIC 99.
  3614         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3615             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3616                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3617             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3618             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3619         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3620             20  FILLER                     PIC X.
  3621             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3622         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3623             20  FILLER                     PIC XX.
  3624             20  CF-MORTGAGE-PLAN           PIC XX.
  3625         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3626
  3627     12  CF-LAST-MAINT-DT                   PIC XX.
  3628     12  CF-LAST-MAINT-BY                   PIC X(4).
  3629     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3630
  3631     12  CF-RECORD-BODY                     PIC X(728).
  3632
  3633
  3634****************************************************************
  3635*             COMPANY MASTER RECORD                            *
  3636****************************************************************
  3637
  3638     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3639         16  CF-COMPANY-ADDRESS.
  3640             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3641             20  CF-CL-IN-CARE-OF           PIC X(30).
  3642             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3643             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3644             20  CF-CL-CITY-STATE           PIC X(30).
  3645             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3646             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  70
* EL130.cbl
  3647         16  CF-COMPANY-CD                  PIC X.
  3648         16  CF-COMPANY-PASSWORD            PIC X(8).
  3649         16  CF-SECURITY-OPTION             PIC X.
  3650             88  ALL-SECURITY                   VALUE '1'.
  3651             88  COMPANY-VERIFY                 VALUE '2'.
  3652             88  PROCESSOR-VERIFY               VALUE '3'.
  3653             88  NO-SECURITY                    VALUE '4'.
  3654             88  ALL-BUT-TERM                   VALUE '5'.
  3655         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3656             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3657         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3658             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3659         16  CF-INFORCE-LOCATION            PIC X.
  3660             88  CERTS-ARE-ONLINE               VALUE '1'.
  3661             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3662             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3663         16  CF-LOWER-CASE-LETTERS          PIC X.
  3664         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3665             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3666             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3667             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3668             88  CF-ACCNT-CNTL                  VALUE '3'.
  3669             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3670
  3671         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3672         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3673
  3674         16  CF-LGX-CREDIT-USER             PIC X.
  3675             88  CO-IS-NOT-USER                 VALUE 'N'.
  3676             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3677
  3678         16 CF-CREDIT-CALC-CODES.
  3679             20  CF-CR-REM-TERM-CALC PIC X.
  3680               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3681               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3682               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3683               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3684               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3685               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3686               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3687             20  CF-CR-R78-METHOD           PIC X.
  3688               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3689               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3690
  3691         16  CF-CLAIM-CONTROL-COUNTS.
  3692             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3693                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3694
  3695             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3696                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3697
  3698             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3699                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3700
  3701             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3702                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3703
  3704         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  71
* EL130.cbl
  3705
  3706         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3707             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3708             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3709             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3710             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3711                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3712                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3713             20  CF-CO-PREM-REJECT-SW       PIC X.
  3714                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3715                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3716             20  CF-CO-REF-REJECT-SW        PIC X.
  3717                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3718                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3719
  3720         16  CF-CO-REPORTING-DT             PIC XX.
  3721         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3722         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3723           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3724           88  CF-CO-MONTH-END                  VALUE '1'.
  3725
  3726         16  CF-LGX-CLAIM-USER              PIC X.
  3727             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3728             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3729
  3730         16  CF-CREDIT-EDIT-CONTROLS.
  3731             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3732             20  CF-MIN-AGE                 PIC 99.
  3733             20  CF-DEFAULT-AGE             PIC 99.
  3734             20  CF-MIN-TERM                PIC S999      COMP-3.
  3735             20  CF-MAX-TERM                PIC S999      COMP-3.
  3736             20  CF-DEFAULT-SEX             PIC X.
  3737             20  CF-JOINT-AGE-INPUT         PIC X.
  3738                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3739             20  CF-BIRTH-DATE-INPUT        PIC X.
  3740                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3741             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3742                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3743                 88  CF-ZERO-CARRIER            VALUE '1'.
  3744                 88  CF-ZERO-GROUPING           VALUE '2'.
  3745                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3746             20  CF-EDIT-SW                 PIC X.
  3747                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3748             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3749             20  CF-CR-PR-METHOD            PIC X.
  3750               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3751               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3752             20  FILLER                     PIC X.
  3753
  3754         16  CF-CREDIT-MISC-CONTROLS.
  3755             20  CF-REIN-TABLE-SW           PIC X.
  3756                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3757             20  CF-COMP-TABLE-SW           PIC X.
  3758                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3759             20  CF-EXPERIENCE-RETENTION-AGE
  3760                                            PIC S9        COMP-3.
  3761             20  CF-CONVERSION-DT           PIC XX.
  3762             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  72
* EL130.cbl
  3763             20  CF-RUN-FREQUENCY-SW        PIC X.
  3764                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3765                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3766
  3767             20  CF-CR-CHECK-NO-CONTROL.
  3768                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3769                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3770                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3771                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3772                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3773                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3774
  3775                 24  CF-CR-CHECK-COUNT       REDEFINES
  3776                     CF-CR-CHECK-COUNTER      PIC X(4).
  3777
  3778                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3779                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3780
  3781                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3782                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3783                 24  CF-MAIL-PROCESSING       PIC X.
  3784                     88  MAIL-PROCESSING          VALUE 'Y'.
  3785
  3786         16  CF-MISC-SYSTEM-CONTROL.
  3787             20  CF-SYSTEM-C                 PIC X.
  3788                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3789             20  CF-SYSTEM-D                 PIC X.
  3790                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3791             20  CF-SOC-SEC-NO-SW            PIC X.
  3792                 88  SOC-SEC-NO-USED             VALUE '1'.
  3793             20  CF-MEMBER-NO-SW             PIC X.
  3794                 88  MEMBER-NO-USED              VALUE '1'.
  3795             20  CF-TAX-ID-NUMBER            PIC X(11).
  3796             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3797             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3798                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3799                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3800                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3801                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3802             20  CF-SYSTEM-E                 PIC X.
  3803                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3804
  3805         16  CF-LGX-LIFE-USER               PIC X.
  3806             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3807             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3808
  3809         16  CF-CR-MONTH-END-DT             PIC XX.
  3810
  3811         16  CF-FILE-MAINT-DATES.
  3812             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3813                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3814             20  CF-LAST-BATCH       REDEFINES
  3815                 CF-LAST-BATCH-NO               PIC X(4).
  3816             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3817             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3818             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3819             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3820             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  73
* EL130.cbl
  3821             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3822             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3823             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3824             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3825             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3826
  3827         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3828         16  FILLER                         PIC X.
  3829
  3830         16  CF-ALT-MORT-CODE               PIC X(4).
  3831         16  CF-MEMBER-CAPTION              PIC X(10).
  3832
  3833         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3834             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3835             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3836             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3837             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3838             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3839
  3840         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3841
  3842         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3843         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3844         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3845         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3846
  3847         16  CF-AH-OVERRIDE-L1              PIC X.
  3848         16  CF-AH-OVERRIDE-L2              PIC XX.
  3849         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3850         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3851
  3852         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3853         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3854
  3855         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3856         16  CF-AR-LAST-EL860-DT            PIC XX.
  3857         16  CF-MP-MONTH-END-DT             PIC XX.
  3858
  3859         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3860         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3861             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3862
  3863         16  CF-AR-MONTH-END-DT             PIC XX.
  3864
  3865         16  CF-CRDTCRD-USER                PIC X.
  3866             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3867             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3868
  3869         16  CF-CC-MONTH-END-DT             PIC XX.
  3870
  3871         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3872
  3873         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3874             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3875             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3876             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3877         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3878         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  74
* EL130.cbl
  3879         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3880         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3881             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3882             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3883         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3884         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3885         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3886             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3887         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3888
  3889         16  CF-CL-ZIP-CODE.
  3890             20  CF-CL-ZIP-PRIME.
  3891                 24  CF-CL-ZIP-1ST          PIC X.
  3892                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3893                 24  FILLER                 PIC X(4).
  3894             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3895         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3896             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3897             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3898             20  FILLER                     PIC XXX.
  3899
  3900         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3901         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3902         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3903         16  CF-CO-OPTION-START-DATE        PIC XX.
  3904         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3905           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3906                                                      '3' '4'.
  3907           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3908           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3909           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3910           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3911           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3912           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3913
  3914         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3915
  3916         16  CF-PAYMENT-APPROVAL-LEVELS.
  3917             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3918             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3919             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3920             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3921             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3922             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3923
  3924         16  CF-END-USER-REPORTING-USER     PIC X.
  3925             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3926             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3927
  3928         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3929             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3930             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3931
  3932         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3933
  3934         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3935         16  FILLER                         PIC X.
  3936
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  75
* EL130.cbl
  3937         16  CF-CREDIT-ARCHIVE-CNTL.
  3938             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3939             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3940             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3941
  3942         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3943
  3944         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3945             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3946             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3947
  3948         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3949             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3950             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3951
  3952         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3953
  3954         16  CF-CO-ACH-ID-CODE              PIC  X.
  3955             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3956             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3957             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3958         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3959         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3960         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3961         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3962         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3963         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3964         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3965         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3966         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3967                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3968         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3969                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3970
  3971         16  CF-CO-OVER-SHORT.
  3972             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3973             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3974
  3975*         16  FILLER                         PIC X(102).
  3976         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3977             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3978             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3979
  3980         16  CF-AH-APPROVAL-DAYS.
  3981             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3982             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3983             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3984             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3985
  3986         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3987
  3988         16  CF-APPROV-LEV-5.
  3989             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3990             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3991             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3992
  3993         16  FILLER                         PIC X(68).
  3994****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  76
* EL130.cbl
  3995*             PROCESSOR/USER RECORD                            *
  3996****************************************************************
  3997
  3998     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3999         16  CF-PROCESSOR-NAME              PIC X(30).
  4000         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4001         16  CF-PROCESSOR-TITLE             PIC X(26).
  4002         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4003                 88  MESSAGE-YES                VALUE 'Y'.
  4004                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4005
  4006*****************************************************
  4007****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4008****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4009****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4010****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4011*****************************************************
  4012
  4013         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4014             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4015             20  CF-APPLICATION-FORCE       PIC X.
  4016             20  CF-INDIVIDUAL-APP.
  4017                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4018                     28  CF-BROWSE-APP      PIC X.
  4019                     28  CF-UPDATE-APP      PIC X.
  4020
  4021         16  CF-CURRENT-TERM-ON             PIC X(4).
  4022         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4023             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4024             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4025             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4026             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4027             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4028             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4029             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4030         16  CF-PROCESSOR-CARRIER           PIC X.
  4031             88  NO-CARRIER-SECURITY            VALUE ' '.
  4032         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4033             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4034         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4035             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4036         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4037             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4038
  4039         16  CF-PROC-SYS-ACCESS-SW.
  4040             20  CF-PROC-CREDIT-CLAIMS-SW.
  4041                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4042                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4043                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4044                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4045             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4046                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4047                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4048             20  CF-PROC-LIFE-GNRLDGR-SW.
  4049                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4050                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4051                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4052                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  77
* EL130.cbl
  4053             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4054                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4055                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4056         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4057             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4058             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4059         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4060
  4061         16  CF-APPROVAL-LEVEL                  PIC X.
  4062             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4063             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4064             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4065             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4066             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4067
  4068         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4069
  4070         16  CF-LANGUAGE-TYPE                   PIC X.
  4071             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4072             88  CF-LANG-IS-FR                      VALUE 'F'.
  4073
  4074         16  CF-CSR-IND                         PIC X.
  4075         16  FILLER                             PIC X(239).
  4076
  4077****************************************************************
  4078*             PROCESSOR/REMINDERS RECORD                       *
  4079****************************************************************
  4080
  4081     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4082         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4083             20  CF-START-REMIND-DT         PIC XX.
  4084             20  CF-END-REMIND-DT           PIC XX.
  4085             20  CF-REMINDER-TEXT           PIC X(50).
  4086         16  FILLER                         PIC X(296).
  4087
  4088
  4089****************************************************************
  4090*             STATE MASTER RECORD                              *
  4091****************************************************************
  4092
  4093     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4094         16  CF-STATE-ABBREVIATION          PIC XX.
  4095         16  CF-STATE-NAME                  PIC X(25).
  4096         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4097         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4098             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4099             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4100             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4101             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4102                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4103                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4104             20  CF-ST-PREM-REJECT-SW       PIC X.
  4105                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4106                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4107             20  CF-ST-REF-REJECT-SW        PIC X.
  4108                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4109                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4110         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  78
* EL130.cbl
  4111         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4112         16  CF-ST-REFUND-RULES.
  4113             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4114             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4115             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4116         16  CF-ST-FST-PMT-EXTENSION.
  4117             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4118             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4119                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4120                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4121                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4122                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4123         16  CF-ST-STATE-CALL.
  4124             20  CF-ST-CALL-UNEARNED        PIC X.
  4125             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4126             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4127         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4128             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4129             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4130         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4131         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4132         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4133         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4134         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4135         16  FILLER                         PIC X.
  4136         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4137             20  CF-ST-BENEFIT-CD           PIC XX.
  4138             20  CF-ST-BENEFIT-KIND         PIC X.
  4139                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4140                 88  CF-ST-AH-KIND              VALUE 'A'.
  4141             20  CF-ST-REM-TERM-CALC        PIC X.
  4142                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4143                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4144                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4145                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4146                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4147                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4148                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4149                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4150
  4151             20  CF-ST-REFUND-CALC          PIC X.
  4152                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4153                 88  ST-REFD-BY-R78             VALUE '1'.
  4154                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4155                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4156                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4157                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4158                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4159                 88  ST-REFD-UTAH               VALUE '7'.
  4160                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4161                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4162                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4163
  4164             20  CF-ST-EARNING-CALC         PIC X.
  4165                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4166                 88  ST-EARN-BY-R78             VALUE '1'.
  4167                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4168                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  79
* EL130.cbl
  4169                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4170                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4171                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4172                 88  ST-EARN-MEAN               VALUE '8'.
  4173                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4174
  4175             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4176                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4177                 88  ST-OVRD-BY-R78             VALUE '1'.
  4178                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4179                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4180                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4181                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4182                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4183                 88  ST-OVRD-MEAN               VALUE '8'.
  4184                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4185             20  cf-st-extra-periods        pic 9.
  4186*            20  FILLER                     PIC X.
  4187
  4188         16  CF-ST-COMMISSION-CAPS.
  4189             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4190             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4191             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4192             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4193         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4194                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4195                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4196                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4197
  4198         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4199
  4200         16  CF-ST-STATUTORY-INTEREST.
  4201             20  CF-ST-STAT-DATE-FROM       PIC X.
  4202                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4203                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4204             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4205             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4206             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4207             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4208             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4209
  4210         16  CF-ST-OVER-SHORT.
  4211             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4212             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4213
  4214         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4215
  4216         16  CF-ST-RT-CALC                  PIC X.
  4217
  4218         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4219         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4220         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4221         16  CF-ST-RF-LR-CALC               PIC X.
  4222         16  CF-ST-RF-LL-CALC               PIC X.
  4223         16  CF-ST-RF-LN-CALC               PIC X.
  4224         16  CF-ST-RF-AH-CALC               PIC X.
  4225         16  CF-ST-RF-CP-CALC               PIC X.
  4226*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  80
* EL130.cbl
  4227*CIDMOD         16  FILLER                         PIC X(192).
  4228         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4229             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4230         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4231         16  CF-ST-VFY-2ND-BENE             PIC X.
  4232         16  CF-ST-CAUSAL-STATE             PIC X.
  4233         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4234         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4235         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4236             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4237         16  CF-ST-NET-ONLY-STATE           PIC X.
  4238             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4239         16  cf-commission-cap-required     pic x.
  4240         16  CF-ST-GA-COMMISSION-CAPS.
  4241             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4242             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4243             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4244             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4245         16  CF-ST-TOT-COMMISSION-CAPS.
  4246             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4247             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4248             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4249             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4250         16  FILLER                         PIC X(156).
  4251
  4252****************************************************************
  4253*             BENEFIT MASTER RECORD                            *
  4254****************************************************************
  4255
  4256     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4257         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4258             20  CF-BENEFIT-CODE            PIC XX.
  4259             20  CF-BENEFIT-NUMERIC  REDEFINES
  4260                 CF-BENEFIT-CODE            PIC XX.
  4261             20  CF-BENEFIT-ALPHA           PIC XXX.
  4262             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4263             20  CF-BENEFIT-COMMENT         PIC X(10).
  4264
  4265             20  CF-LF-COVERAGE-TYPE        PIC X.
  4266                 88  CF-REDUCING                VALUE 'R'.
  4267                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4268
  4269             20  CF-SPECIAL-CALC-CD         PIC X.
  4270                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4271                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4272                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4273                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4274                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4275                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4276                 88  CF-FARM-PLAN               VALUE 'F'.
  4277                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4278                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4279                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4280                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4281                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4282                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4283                 88  CF-PRUDENTIAL              VALUE 'P'.
  4284                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  81
* EL130.cbl
  4285                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4286                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4287                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4288                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4289                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4290
  4291             20  CF-JOINT-INDICATOR         PIC X.
  4292                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4293
  4294*            20  FILLER                     PIC X(12).
  4295             20  cf-maximum-benefits        pic s999 comp-3.
  4296             20  FILLER                     PIC X(09).
  4297             20  CF-BENEFIT-CATEGORY        PIC X.
  4298             20  CF-LOAN-TYPE               PIC X(8).
  4299
  4300             20  CF-CO-REM-TERM-CALC        PIC X.
  4301                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4302                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4303                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4304                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4305                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4306
  4307             20  CF-CO-EARNINGS-CALC        PIC X.
  4308                 88  CO-EARN-BY-R78             VALUE '1'.
  4309                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4310                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4311                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4312                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4313                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4314                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4315                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4316
  4317             20  CF-CO-REFUND-CALC          PIC X.
  4318                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4319                 88  CO-REFD-BY-R78             VALUE '1'.
  4320                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4321                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4322                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4323                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4324                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4325                 88  CO-REFD-MEAN               VALUE '8'.
  4326                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4327                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4328                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4329
  4330             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4331                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4332                 88  CO-OVRD-BY-R78             VALUE '1'.
  4333                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4334                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4335                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4336                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4337                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4338                 88  CO-OVRD-MEAN               VALUE '8'.
  4339                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4340
  4341             20  CF-CO-BEN-I-G-CD           PIC X.
  4342                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  82
* EL130.cbl
  4343                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4344                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4345
  4346         16  FILLER                         PIC X(304).
  4347
  4348
  4349****************************************************************
  4350*             CARRIER MASTER RECORD                            *
  4351****************************************************************
  4352
  4353     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4354         16  CF-ADDRESS-DATA.
  4355             20  CF-MAIL-TO-NAME            PIC X(30).
  4356             20  CF-IN-CARE-OF              PIC X(30).
  4357             20  CF-ADDRESS-LINE-1          PIC X(30).
  4358             20  CF-ADDRESS-LINE-2          PIC X(30).
  4359             20  CF-CITY-STATE              PIC X(30).
  4360             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4361             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4362
  4363         16  CF-CLAIM-NO-CONTROL.
  4364             20  CF-CLAIM-NO-METHOD         PIC X.
  4365                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4366                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4367                 88  CLAIM-NO-SEQ               VALUE '3'.
  4368                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4369             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4370                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4371                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4372                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4373
  4374         16  CF-CHECK-NO-CONTROL.
  4375             20  CF-CHECK-NO-METHOD         PIC X.
  4376                 88  CHECK-NO-MANUAL            VALUE '1'.
  4377                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4378                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4379                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4380             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4381                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4382
  4383         16  CF-DOMICILE-STATE              PIC XX.
  4384
  4385         16  CF-EXPENSE-CONTROLS.
  4386             20  CF-EXPENSE-METHOD          PIC X.
  4387                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4388                 88  DOLLARS-PER-PMT            VALUE '2'.
  4389                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4390                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4391             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4392             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4393
  4394         16  CF-CORRESPONDENCE-CONTROL.
  4395             20  CF-LETTER-RESEND-OPT       PIC X.
  4396                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4397                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4398             20  FILLER                     PIC X(4).
  4399
  4400         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  83
* EL130.cbl
  4401             20  CF-MANUAL-SW               PIC X.
  4402                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4403             20  CF-FUTURE-SW               PIC X.
  4404                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4405             20  CF-PTC-SW                  PIC X.
  4406                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4407             20  CF-IBNR-SW                 PIC X.
  4408                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4409             20  CF-PTC-LF-SW               PIC X.
  4410                 88  CF-LF-PTC-USED             VALUE '1'.
  4411             20  CF-CDT-ACCESS-METHOD       PIC X.
  4412                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4413                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4414                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4415             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4416
  4417         16  CF-CLAIM-CALC-METHOD           PIC X.
  4418             88  360-PLUS-MONTHS                VALUE '1'.
  4419             88  365-PLUS-MONTHS                VALUE '2'.
  4420             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4421             88  360-DAILY                      VALUE '4'.
  4422             88  365-DAILY                      VALUE '5'.
  4423
  4424         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4425         16  FILLER                         PIC X(11).
  4426
  4427         16  CF-LIMIT-AMOUNTS.
  4428             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4429             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4430             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4431             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4432             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4433             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4434             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4435             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4436             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4437             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4438
  4439         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4440         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4441         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4442
  4443         16  CF-ZIP-CODE.
  4444             20  CF-ZIP-PRIME.
  4445                 24  CF-ZIP-1ST             PIC X.
  4446                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4447                 24  FILLER                 PIC X(4).
  4448             20  CF-ZIP-PLUS4               PIC X(4).
  4449         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4450             20  CF-CAN-POSTAL-1            PIC XXX.
  4451             20  CF-CAN-POSTAL-2            PIC XXX.
  4452             20  FILLER                     PIC XXX.
  4453
  4454         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4455         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4456         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4457
  4458         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  84
* EL130.cbl
  4459             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4460             88  CF-NO-RATING                   VALUE 'N'.
  4461
  4462         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4463
  4464         16  CF-CARRIER-OVER-SHORT.
  4465             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4466             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4467
  4468         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4469         16  CF-SECPAY-SWITCH               PIC X.
  4470             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4471             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4472         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4473         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4474         16  FILLER                         PIC X(444).
  4475*        16  FILLER                         PIC X(452).
  4476
  4477
  4478****************************************************************
  4479*             MORTALITY MASTER RECORD                          *
  4480****************************************************************
  4481
  4482     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4483         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4484                                INDEXED BY CF-MORT-NDX.
  4485             20  CF-MORT-TABLE              PIC X(5).
  4486             20  CF-MORT-TABLE-TYPE         PIC X.
  4487                 88  CF-MORT-JOINT              VALUE 'J'.
  4488                 88  CF-MORT-SINGLE             VALUE 'S'.
  4489                 88  CF-MORT-COMBINED           VALUE 'C'.
  4490                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4491                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4492             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4493             20  CF-MORT-AGE-METHOD         PIC XX.
  4494                 88  CF-AGE-LAST                VALUE 'AL'.
  4495                 88  CF-AGE-NEAR                VALUE 'AN'.
  4496             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4497             20  CF-MORT-ADJUSTMENT-DIRECTION
  4498                                            PIC X.
  4499                 88  CF-MINUS                   VALUE '-'.
  4500                 88  CF-PLUS                    VALUE '+'.
  4501             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4502             20  CF-MORT-JOINT-CODE         PIC X.
  4503                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4504             20  CF-MORT-PC-Q               PIC X.
  4505                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4506             20  CF-MORT-TABLE-CODE         PIC X(4).
  4507             20  CF-MORT-COMMENTS           PIC X(15).
  4508             20  FILLER                     PIC X(14).
  4509
  4510         16  FILLER                         PIC X(251).
  4511
  4512
  4513****************************************************************
  4514*             BUSSINESS TYPE MASTER RECORD                     *
  4515****************************************************************
  4516
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  85
* EL130.cbl
  4517     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4518* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4519* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4520* AND RECORD 05 IS TYPES 81-99
  4521         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4522             20  CF-BUSINESS-TITLE          PIC  X(19).
  4523             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4524                                            PIC S9V9(4) COMP-3.
  4525             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4526             20  FILLER                     PIC  X.
  4527         16  FILLER                         PIC  X(248).
  4528
  4529
  4530****************************************************************
  4531*             TERMINAL MASTER RECORD                           *
  4532****************************************************************
  4533
  4534     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4535
  4536         16  CF-COMPANY-TERMINALS.
  4537             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4538                                  PIC X(4).
  4539         16  FILLER               PIC X(248).
  4540
  4541
  4542****************************************************************
  4543*             LIFE EDIT MASTER RECORD                          *
  4544****************************************************************
  4545
  4546     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4547         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4548             20  CF-LIFE-CODE-IN            PIC XX.
  4549             20  CF-LIFE-CODE-OUT           PIC XX.
  4550         16  FILLER                         PIC X(248).
  4551
  4552
  4553****************************************************************
  4554*             AH EDIT MASTER RECORD                            *
  4555****************************************************************
  4556
  4557     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4558         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4559             20  CF-AH-CODE-IN              PIC XXX.
  4560             20  CF-AH-CODE-OUT             PIC XX.
  4561         16  FILLER                         PIC X(248).
  4562
  4563
  4564****************************************************************
  4565*             CREDIBILITY TABLES                               *
  4566****************************************************************
  4567
  4568     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4569         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4570                             INDEXED BY CF-CRDB-NDX.
  4571             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4572             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4573             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4574         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  86
* EL130.cbl
  4575
  4576
  4577****************************************************************
  4578*             REPORT CUSTOMIZATION RECORD                      *
  4579****************************************************************
  4580
  4581     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4582         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4583             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4584             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4585             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4586**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4587****       A T-TRANSFER.                                   ****
  4588             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4589
  4590         16  FILLER                         PIC XX.
  4591
  4592         16  CF-CARRIER-CNTL-OPT.
  4593             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4594                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4595                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4596             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4597                                            PIC X.
  4598         16  CF-GROUP-CNTL-OPT.
  4599             20  CF-GROUP-OPT-SEQ           PIC 9.
  4600                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4601                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4602             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4603                                            PIC X(6).
  4604         16  CF-STATE-CNTL-OPT.
  4605             20  CF-STATE-OPT-SEQ           PIC 9.
  4606                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4607                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4608             20  CF-STATE-SELECT OCCURS 3 TIMES
  4609                                            PIC XX.
  4610         16  CF-ACCOUNT-CNTL-OPT.
  4611             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4612                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4613                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4614             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4615                                            PIC X(10).
  4616         16  CF-BUS-TYP-CNTL-OPT.
  4617             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4618                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4619                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4620             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4621                                            PIC XX.
  4622         16  CF-LF-TYP-CNTL-OPT.
  4623             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4624                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4625                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4626             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4627                                            PIC XX.
  4628         16  CF-AH-TYP-CNTL-OPT.
  4629             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4630                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4631                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4632             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  87
* EL130.cbl
  4633                                            PIC XX.
  4634         16  CF-REPTCD1-CNTL-OPT.
  4635             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4636                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4637                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4638             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4639                                            PIC X(10).
  4640         16  CF-REPTCD2-CNTL-OPT.
  4641             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4642                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4643                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4644             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4645                                            PIC X(10).
  4646         16  CF-USER1-CNTL-OPT.
  4647             20  CF-USER1-OPT-SEQ           PIC 9.
  4648                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4649                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4650             20  CF-USER1-SELECT OCCURS 3 TIMES
  4651                                            PIC X(10).
  4652         16  CF-USER2-CNTL-OPT.
  4653             20  CF-USER2-OPT-SEQ           PIC 9.
  4654                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4655                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4656             20  CF-USER2-SELECT OCCURS 3 TIMES
  4657                                            PIC X(10).
  4658         16  CF-USER3-CNTL-OPT.
  4659             20  CF-USER3-OPT-SEQ           PIC 9.
  4660                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4661                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4662             20  CF-USER3-SELECT OCCURS 3 TIMES
  4663                                            PIC X(10).
  4664         16  CF-USER4-CNTL-OPT.
  4665             20  CF-USER4-OPT-SEQ           PIC 9.
  4666                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4667                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4668             20  CF-USER4-SELECT OCCURS 3 TIMES
  4669                                            PIC X(10).
  4670         16  CF-USER5-CNTL-OPT.
  4671             20  CF-USER5-OPT-SEQ           PIC 9.
  4672                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4673                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4674             20  CF-USER5-SELECT OCCURS 3 TIMES
  4675                                            PIC X(10).
  4676         16  CF-REINS-CNTL-OPT.
  4677             20  CF-REINS-OPT-SEQ           PIC 9.
  4678                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4679                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4680             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4681                 24  CF-REINS-PRIME         PIC XXX.
  4682                 24  CF-REINS-SUB           PIC XXX.
  4683
  4684         16  CF-AGENT-CNTL-OPT.
  4685             20  CF-AGENT-OPT-SEQ           PIC 9.
  4686                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4687                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4688             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4689                                            PIC X(10).
  4690
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  88
* EL130.cbl
  4691         16  FILLER                         PIC X(43).
  4692
  4693         16  CF-LOSS-RATIO-SELECT.
  4694             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4695             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4696         16  CF-ENTRY-DATE-SELECT.
  4697             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4698             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4699         16  CF-EFFECTIVE-DATE-SELECT.
  4700             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4701             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4702
  4703         16  CF-EXCEPTION-LIST-IND          PIC X.
  4704             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4705
  4706         16  FILLER                         PIC X(318).
  4707
  4708****************************************************************
  4709*                  EXCEPTION REPORTING RECORD                  *
  4710****************************************************************
  4711
  4712     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4713         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4714             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4715
  4716         16  CF-COMBINED-LIFE-AH-OPT.
  4717             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4718             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4719             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4720             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4721
  4722         16  CF-LIFE-OPT.
  4723             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4724             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4725             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4726             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4727             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4728             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4729             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4730             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4731             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4732             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4733
  4734         16  CF-AH-OPT.
  4735             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4736             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4737             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4738             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4739             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4740             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4741             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4742             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4743             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4744             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4745
  4746         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4747             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4748             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  89
* EL130.cbl
  4749             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4750
  4751         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4752
  4753         16  FILLER                         PIC X(673).
  4754
  4755
  4756****************************************************************
  4757*             MORTGAGE SYSTEM PLAN RECORD                      *
  4758****************************************************************
  4759
  4760     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4761         16  CF-PLAN-TYPE                   PIC X.
  4762             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4763             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4764             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4765         16  CF-PLAN-ABBREV                 PIC XXX.
  4766         16  CF-PLAN-DESCRIPT               PIC X(10).
  4767         16  CF-PLAN-NOTES                  PIC X(20).
  4768         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4769         16  CF-PLAN-UNDERWRITING.
  4770             20  CF-PLAN-TERM-DATA.
  4771                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4772                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4773             20  CF-PLAN-AGE-DATA.
  4774                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4775                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4776                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4777             20  CF-PLAN-BENEFIT-DATA.
  4778                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4779                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4780                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4781                                            PIC S9(7)V99  COMP-3.
  4782         16  CF-PLAN-POLICY-FORMS.
  4783             20  CF-POLICY-FORM             PIC X(12).
  4784             20  CF-MASTER-APPLICATION      PIC X(12).
  4785             20  CF-MASTER-POLICY           PIC X(12).
  4786         16  CF-PLAN-RATING.
  4787             20  CF-RATE-CODE               PIC X(5).
  4788             20  CF-SEX-RATING              PIC X.
  4789                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4790                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4791             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4792             20  CF-SUB-STD-TYPE            PIC X.
  4793                 88  CF-PCT-OF-PREM            VALUE '1'.
  4794                 88  CF-PCT-OF-BENE            VALUE '2'.
  4795         16  CF-PLAN-PREM-TOLERANCES.
  4796             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4797             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4798         16  CF-PLAN-PYMT-TOLERANCES.
  4799             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4800             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4801         16  CF-PLAN-MISC-DATA.
  4802             20  FILLER                     PIC X.
  4803             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4804             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4805         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4806         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  90
* EL130.cbl
  4807             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4808                                                     '1'.
  4809             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4810                                                     '2'.
  4811         16  CF-MIB-SEARCH-SW               PIC X.
  4812             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4813             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4814             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4815             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4816         16  CF-ALPHA-SEARCH-SW             PIC X.
  4817             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4818             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4819             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4820             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4821             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4822             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4823             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4824             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4825             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4826             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4827                                                     'A' 'B' 'C'
  4828                                                     'X' 'Y' 'Z'.
  4829         16  CF-EFF-DT-RULE-SW              PIC X.
  4830             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4831             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4832             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4833             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4834             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4835         16  FILLER                         PIC X(4).
  4836         16  CF-HEALTH-QUESTIONS            PIC X.
  4837             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4838         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4839         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4840         16  CF-PLAN-SNGL-JNT               PIC X.
  4841             88  CF-COMBINED-PLAN              VALUE 'C'.
  4842             88  CF-JNT-PLAN                   VALUE 'J'.
  4843             88  CF-SNGL-PLAN                  VALUE 'S'.
  4844         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4845         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4846         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4847         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4848         16  CF-RERATE-CNTL                 PIC  X.
  4849             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4850             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4851             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4852             88  CF-AUTO-RECALC                 VALUE '4'.
  4853         16  CF-BENEFIT-TYPE                PIC  X.
  4854             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4855             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4856         16  CF-POLICY-FEE                  PIC S999V99
  4857                                                    COMP-3.
  4858         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4859         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4860         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4861         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4862         16  FILLER                         PIC  X(32).
  4863         16  CF-TERMINATION-FORM            PIC  X(04).
  4864         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  91
* EL130.cbl
  4865         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4866                                                       COMP-3.
  4867         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4868         16  CF-ISSUE-LETTER                PIC  X(4).
  4869         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4870         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4871             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4872             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4873         16  CF-MP-REFUND-CALC              PIC X.
  4874             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4875             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4876             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4877             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4878             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4879             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4880             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4881             88  CF-MP-REFD-MEAN                VALUE '8'.
  4882         16  CF-ALT-RATE-CODE               PIC  X(5).
  4883
  4884
  4885         16  FILLER                         PIC X(498).
  4886****************************************************************
  4887*             MORTGAGE COMPANY MASTER RECORD                   *
  4888****************************************************************
  4889
  4890     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4891         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4892         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4893             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4894             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4895             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4896             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4897             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4898
  4899         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4900         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4901         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4902         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4903         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4904
  4905         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4906             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4907         16  CF-MP-RECON-USE-IND            PIC X(1).
  4908             88  CF-MP-USE-RECON             VALUE 'Y'.
  4909         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4910             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4911         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4912             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4913             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4914         16  FILLER                         PIC X(1).
  4915         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4916             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4917         16  CF-MORTG-MIB-VERSION           PIC X.
  4918             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4919             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4920             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4921         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4922             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  92
* EL130.cbl
  4923                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4924             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4925                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4926             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4927                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4928             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4929                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4930             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4931                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4932             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4933                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4934         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4935         16  FILLER                         PIC X(7).
  4936         16  CF-MORTG-DESTINATION-SYMBOL.
  4937             20  CF-MORTG-MIB-COMM          PIC X(5).
  4938             20  CF-MORTG-MIB-TERM          PIC X(5).
  4939         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4940             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4941         16  FILLER                         PIC X(03).
  4942         16  CF-MP-CHECK-NO-CONTROL.
  4943             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4944                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4945                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4946                                                ' ' LOW-VALUES.
  4947                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4948                                               VALUE '3'.
  4949         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4950         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4951         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4952             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4953                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4954             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4955                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4956             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4957                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4958             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4959                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4960             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4961                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4962             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4963                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4964         16  CF-MORTG-BILLING-AREA.
  4965             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4966                                            PIC X.
  4967         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4968         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4969         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4970         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4971             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4972             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4973         16  FILLER                         PIC X.
  4974         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4975             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4976             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4977         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4978         16  FILLER                         PIC X(8).
  4979         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4980         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  93
* EL130.cbl
  4981         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4982         16  CF-ACH-COMPANY-ID.
  4983             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4984                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4985                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4986                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4987             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4988         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4989             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4990         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4991             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4992             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4993         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4994         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4995         16  FILLER                         PIC X(536).
  4996
  4997****************************************************************
  4998*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4999****************************************************************
  5000
  5001     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5002         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5003             20  CF-FEMALE-HEIGHT.
  5004                 24  CF-FEMALE-FT           PIC 99.
  5005                 24  CF-FEMALE-IN           PIC 99.
  5006             20  CF-FEMALE-MIN-WT           PIC 999.
  5007             20  CF-FEMALE-MAX-WT           PIC 999.
  5008         16  FILLER                         PIC X(428).
  5009
  5010     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5011         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5012             20  CF-MALE-HEIGHT.
  5013                 24  CF-MALE-FT             PIC 99.
  5014                 24  CF-MALE-IN             PIC 99.
  5015             20  CF-MALE-MIN-WT             PIC 999.
  5016             20  CF-MALE-MAX-WT             PIC 999.
  5017         16  FILLER                         PIC X(428).
  5018******************************************************************
  5019*             AUTOMATIC ACTIVITY RECORD                          *
  5020******************************************************************
  5021     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5022         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5023             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5024             20  CF-SYS-LETTER-ID           PIC X(04).
  5025             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5026             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5027             20  CF-SYS-RESET-SW            PIC X(01).
  5028             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5029             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5030
  5031         16  FILLER                         PIC X(50).
  5032
  5033         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5034             20  CF-USER-ACTIVE-SW          PIC X(01).
  5035             20  CF-USER-LETTER-ID          PIC X(04).
  5036             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5037             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5038             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  94
* EL130.cbl
  5039             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5040             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5041             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5042
  5043         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  95
* EL130.cbl
  5045*    COPY ELCCERT.
  5046******************************************************************
  5047*                                                                *
  5048*                            ELCCERT.                            *
  5049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5050*                            VMOD=2.013                          *
  5051*                                                                *
  5052*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5053*                                                                *
  5054*   FILE TYPE = VSAM,KSDS                                        *
  5055*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5056*                                                                *
  5057*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5058*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5059*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5060*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5061*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5062*                                                                *
  5063*   LOG = YES                                                    *
  5064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5065******************************************************************
  5066*                   C H A N G E   L O G
  5067*
  5068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5069*-----------------------------------------------------------------
  5070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5071* EFFECTIVE    NUMBER
  5072*-----------------------------------------------------------------
  5073* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5074* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5075* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5076* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5077* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5078* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5079* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5080* 032612  CR2011110200001  PEMA  AHL CHANGES
  5081* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5082* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5083* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5084******************************************************************
  5085
  5086 01  CERTIFICATE-MASTER.
  5087     12  CM-RECORD-ID                      PIC XX.
  5088         88  VALID-CM-ID                      VALUE 'CM'.
  5089
  5090     12  CM-CONTROL-PRIMARY.
  5091         16  CM-COMPANY-CD                 PIC X.
  5092         16  CM-CARRIER                    PIC X.
  5093         16  CM-GROUPING.
  5094             20  CM-GROUPING-PREFIX        PIC X(3).
  5095             20  CM-GROUPING-PRIME         PIC X(3).
  5096         16  CM-STATE                      PIC XX.
  5097         16  CM-ACCOUNT.
  5098             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5099             20  CM-ACCOUNT-PRIME          PIC X(6).
  5100         16  CM-CERT-EFF-DT                PIC XX.
  5101         16  CM-CERT-NO.
  5102             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  96
* EL130.cbl
  5103             20  CM-CERT-SFX               PIC X.
  5104
  5105     12  CM-CONTROL-BY-NAME.
  5106         16  CM-COMPANY-CD-A1              PIC X.
  5107         16  CM-INSURED-LAST-NAME          PIC X(15).
  5108         16  CM-INSURED-INITIALS.
  5109             20  CM-INSURED-INITIAL1       PIC X.
  5110             20  CM-INSURED-INITIAL2       PIC X.
  5111
  5112     12  CM-CONTROL-BY-SSN.
  5113         16  CM-COMPANY-CD-A2              PIC X.
  5114         16  CM-SOC-SEC-NO.
  5115             20  CM-SSN-STATE              PIC XX.
  5116             20  CM-SSN-ACCOUNT            PIC X(6).
  5117             20  CM-SSN-LN3.
  5118                 25  CM-INSURED-INITIALS-A2.
  5119                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5120                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5121                 25 CM-PART-LAST-NAME-A2         PIC X.
  5122
  5123     12  CM-CONTROL-BY-CERT-NO.
  5124         16  CM-COMPANY-CD-A4              PIC X.
  5125         16  CM-CERT-NO-A4                 PIC X(11).
  5126
  5127     12  CM-CONTROL-BY-MEMB.
  5128         16  CM-COMPANY-CD-A5              PIC X.
  5129         16  CM-MEMBER-NO.
  5130             20  CM-MEMB-STATE             PIC XX.
  5131             20  CM-MEMB-ACCOUNT           PIC X(6).
  5132             20  CM-MEMB-LN4.
  5133                 25  CM-INSURED-INITIALS-A5.
  5134                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5135                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5136                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5137
  5138     12  CM-INSURED-PROFILE-DATA.
  5139         16  CM-INSURED-FIRST-NAME.
  5140             20  CM-INSURED-1ST-INIT       PIC X.
  5141             20  FILLER                    PIC X(9).
  5142         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5143         16  CM-INSURED-SEX                PIC X.
  5144             88  CM-SEX-MALE                  VALUE 'M'.
  5145             88  CM-SEX-FEMAL                 VALUE 'F'.
  5146         16  CM-INSURED-JOINT-AGE          PIC 99.
  5147         16  CM-JOINT-INSURED-NAME.
  5148             20  CM-JT-LAST-NAME           PIC X(15).
  5149             20  CM-JT-FIRST-NAME.
  5150                 24  CM-JT-1ST-INIT        PIC X.
  5151                 24  FILLER                PIC X(9).
  5152             20  CM-JT-INITIAL             PIC X.
  5153
  5154     12  CM-LIFE-DATA.
  5155         16  CM-LF-BENEFIT-CD              PIC XX.
  5156         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5157         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5158         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5159         16  CM-LF-DEV-CODE                PIC XXX.
  5160         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  97
* EL130.cbl
  5161         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5162         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5163         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5164         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5165         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5166         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5167         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5168         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5169         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5170         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5171         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5172         16  cm-temp-epiq                  pic xx.
  5173             88  EPIQ-CLASS                  value 'EQ'.
  5174*        16  FILLER                        PIC XX.
  5175
  5176     12  CM-AH-DATA.
  5177         16  CM-AH-BENEFIT-CD              PIC XX.
  5178         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5179         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5180         16  CM-AH-DEV-CODE                PIC XXX.
  5181         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5182         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5183         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5184         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5185         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5186         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5187         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5188         16  CM-AH-PAID-THRU-DT            PIC XX.
  5189             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5190         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5191         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5192         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5193         16  FILLER                        PIC X.
  5194
  5195     12  CM-LOAN-INFORMATION.
  5196         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5197         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5198                                           PIC S9(5)V99  COMP-3.
  5199         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5200         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5201         16  CM-PAY-FREQUENCY              PIC S99.
  5202         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5203         16  CM-RATE-CLASS                 PIC XX.
  5204         16  CM-BENEFICIARY                PIC X(25).
  5205         16  CM-POLICY-FORM-NO             PIC X(12).
  5206         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5207         16  CM-LAST-ADD-ON-DT             PIC XX.
  5208         16  CM-DEDUCTIBLE-AMOUNTS.
  5209             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5210             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5211         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5212             20  CM-RESIDENT-STATE         PIC XX.
  5213             20  CM-RATE-CODE              PIC X(4).
  5214             20  FILLER                    PIC XX.
  5215         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5216             20  CM-LOAN-OFFICER           PIC X(5).
  5217             20  FILLER                    PIC XXX.
  5218         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  98
* EL130.cbl
  5219         16  CM-UNDERWRITING-CODE          PIC X.
  5220             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5221         16  CM-POST-CARD-IND              PIC X.
  5222         16  CM-REF-INTERFACE-SW           PIC X.
  5223         16  CM-PREMIUM-TYPE               PIC X.
  5224             88  CM-SING-PRM                  VALUE '1'.
  5225             88  CM-O-B-COVERAGE              VALUE '2'.
  5226             88  CM-OPEN-END                  VALUE '3'.
  5227         16  CM-IND-GRP-TYPE               PIC X.
  5228             88  CM-INDIVIDUAL                VALUE 'I'.
  5229             88  CM-GROUP                     VALUE 'G'.
  5230         16  CM-SKIP-CODE                  PIC X.
  5231             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5232             88  SKIP-JULY                    VALUE '1'.
  5233             88  SKIP-AUGUST                  VALUE '2'.
  5234             88  SKIP-SEPTEMBER               VALUE '3'.
  5235             88  SKIP-JULY-AUG                VALUE '4'.
  5236             88  SKIP-AUG-SEPT                VALUE '5'.
  5237             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5238             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5239             88  SKIP-JUNE                    VALUE '8'.
  5240             88  SKIP-JUNE-JULY               VALUE '9'.
  5241             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5242             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5243         16  CM-PAYMENT-MODE               PIC X.
  5244             88  PAY-MONTHLY                  VALUE SPACE.
  5245             88  PAY-WEEKLY                   VALUE '1'.
  5246             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5247             88  PAY-BI-WEEKLY                VALUE '3'.
  5248             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5249         16  CM-LOAN-NUMBER                PIC X(8).
  5250         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5251         16  CM-OLD-LOF                    PIC XXX.
  5252*        16  CM-LOAN-OFFICER               PIC XXX.
  5253         16  CM-REIN-TABLE                 PIC XXX.
  5254         16  CM-SPECIAL-REIN-CODE          PIC X.
  5255         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5256         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5257         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5258
  5259     12  CM-STATUS-DATA.
  5260         16  CM-ENTRY-STATUS               PIC X.
  5261         16  CM-ENTRY-DT                   PIC XX.
  5262
  5263         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5264         16  CM-LF-CANCEL-DT               PIC XX.
  5265         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5266
  5267         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5268         16  CM-LF-DEATH-DT                PIC XX.
  5269         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5270
  5271         16  CM-LF-CURRENT-STATUS          PIC X.
  5272             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5273                                                'M' '4' '5' '9'.
  5274             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5275             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5276             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page  99
* EL130.cbl
  5277             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5278             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5279             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5280             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5281             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5282             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5283             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5284             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5285             88  CM-LF-DECLINED               VALUE 'D'.
  5286             88  CM-LF-VOIDED                 VALUE 'V'.
  5287
  5288         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5289         16  CM-AH-CANCEL-DT               PIC XX.
  5290         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5291
  5292         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5293         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5294         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5295
  5296         16  CM-AH-CURRENT-STATUS          PIC X.
  5297             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5298                                                'M' '4' '5' '9'.
  5299             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5300             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5301             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5302             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5303             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5304             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5305             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5306             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5307             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5308             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5309             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5310             88  CM-AH-DECLINED               VALUE 'D'.
  5311             88  CM-AH-VOIDED                 VALUE 'V'.
  5312
  5313         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5314             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5315             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5316             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5317         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5318
  5319         16  CM-ENTRY-BATCH                PIC X(6).
  5320         16  CM-LF-EXIT-BATCH              PIC X(6).
  5321         16  CM-AH-EXIT-BATCH              PIC X(6).
  5322         16  CM-LAST-MONTH-END             PIC XX.
  5323
  5324     12  CM-NOTE-SW                        PIC X.
  5325         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5326         88  CERT-NOTES-PRESENT               VALUE '1'.
  5327         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5328         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5329         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5330         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5331         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5332         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5333     12  CM-COMP-EXCP-SW                   PIC X.
  5334         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 100
* EL130.cbl
  5335         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5336     12  CM-INSURED-ADDRESS-SW             PIC X.
  5337         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5338         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5339
  5340*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5341     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5342     12  FILLER                            PIC X.
  5343
  5344*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5345     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5346     12  FILLER                            PIC X.
  5347*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5348     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5349
  5350     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5351         88  CERT-ADDED-BATCH                 VALUE ' '.
  5352         88  CERT-ADDED-ONLINE                VALUE '1'.
  5353         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5354         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5355         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5356     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5357         88  CERT-AS-LOADED                   VALUE ' '.
  5358         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5359         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5360         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5361         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5362         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5363         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5364         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5365
  5366     12  CM-ACCOUNT-COMM-PCTS.
  5367         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5368         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5369
  5370     12  CM-USER-FIELD                     PIC X.
  5371     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5372     12  CM-CLP-STATE                      PIC XX.
  5373     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5374     12  CM-USER-RESERVED                  PIC XXX.
  5375     12  FILLER REDEFINES CM-USER-RESERVED.
  5376         16  CM-AH-CLASS-CD                PIC XX.
  5377         16  F                             PIC X.
  5378******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 101
* EL130.cbl
  5380*    COPY ERCACCT.
  5381******************************************************************
  5382*                                                                *
  5383*                                                                *
  5384*                            ERCACCT                             *
  5385*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5386*                            VMOD=2.031                          *
  5387*                                                                *
  5388*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5389*                                                                *
  5390*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5391*   VSAM ACCOUNT MASTER FILES.                                   *
  5392*                                                                *
  5393*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5394*                                                                *
  5395*   FILE TYPE = VSAM,KSDS                                        *
  5396*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5397*                                                                *
  5398*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5399*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5400*                                                                *
  5401*   LOG = NO                                                     *
  5402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5403*                                                                *
  5404*                                                                *
  5405******************************************************************
  5406*                   C H A N G E   L O G
  5407*
  5408* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5409*-----------------------------------------------------------------
  5410*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5411* EFFECTIVE    NUMBER
  5412*-----------------------------------------------------------------
  5413* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5414* 092705    2005050300006  PEMA  ADD SPP LEASES
  5415* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5416* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5417* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5418* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5419* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5420* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5421******************************************************************
  5422
  5423 01  ACCOUNT-MASTER.
  5424     12  AM-RECORD-ID                      PIC XX.
  5425         88  VALID-AM-ID                      VALUE 'AM'.
  5426
  5427     12  AM-CONTROL-PRIMARY.
  5428         16  AM-COMPANY-CD                 PIC X.
  5429         16  AM-MSTR-CNTRL.
  5430             20  AM-CONTROL-A.
  5431                 24  AM-CARRIER            PIC X.
  5432                 24  AM-GROUPING.
  5433                     28 AM-GROUPING-PREFIX PIC XXX.
  5434                     28 AM-GROUPING-PRIME  PIC XXX.
  5435                 24  AM-STATE              PIC XX.
  5436                 24  AM-ACCOUNT.
  5437                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 102
* EL130.cbl
  5438                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5439             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5440                                           PIC X(19).
  5441             20  AM-CNTRL-B.
  5442                 24  AM-EXPIRATION-DT      PIC XX.
  5443                 24  FILLER                PIC X(4).
  5444             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5445                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5446
  5447     12  AM-CONTROL-BY-VAR-GRP.
  5448         16  AM-COMPANY-CD-A1              PIC X.
  5449         16  AM-VG-CARRIER                 PIC X.
  5450         16  AM-VG-GROUPING                PIC X(6).
  5451         16  AM-VG-STATE                   PIC XX.
  5452         16  AM-VG-ACCOUNT                 PIC X(10).
  5453         16  AM-VG-DATE.
  5454             20  AM-VG-EXPIRATION-DT       PIC XX.
  5455             20  FILLER                    PIC X(4).
  5456         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5457                                           PIC 9(11)      COMP-3.
  5458     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5459         16  FILLER                        PIC X(10).
  5460         16  AM-VG-KEY3.
  5461             20  AM-VG3-ACCOUNT            PIC X(10).
  5462             20  AM-VG3-EXP-DT             PIC XX.
  5463         16  FILLER                        PIC X(4).
  5464     12  AM-MAINT-INFORMATION.
  5465         16  AM-LAST-MAINT-DT              PIC XX.
  5466         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5467         16  AM-LAST-MAINT-USER            PIC X(4).
  5468         16  FILLER                        PIC XX.
  5469
  5470     12  AM-EFFECTIVE-DT                   PIC XX.
  5471     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5472
  5473     12  AM-PREV-DATES  COMP-3.
  5474         16  AM-PREV-EXP-DT                PIC 9(11).
  5475         16  AM-PREV-EFF-DT                PIC 9(11).
  5476
  5477     12  AM-REPORT-CODE-1                  PIC X(10).
  5478     12  AM-REPORT-CODE-2                  PIC X(10).
  5479
  5480     12  AM-CITY-CODE                      PIC X(4).
  5481     12  AM-COUNTY-PARISH                  PIC X(6).
  5482
  5483     12  AM-NAME                           PIC X(30).
  5484     12  AM-PERSON                         PIC X(30).
  5485     12  AM-ADDRS                          PIC X(30).
  5486     12  AM-CITY.
  5487         16  AM-ADDR-CITY                  PIC X(28).
  5488         16  AM-ADDR-STATE                 PIC XX.
  5489     12  AM-ZIP.
  5490         16  AM-ZIP-PRIME.
  5491             20  AM-ZIP-PRI-1ST            PIC X.
  5492                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5493             20  FILLER                    PIC X(4).
  5494         16  AM-ZIP-PLUS4                  PIC X(4).
  5495     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 103
* EL130.cbl
  5496         16  AM-CAN-POSTAL-1               PIC XXX.
  5497         16  AM-CAN-POSTAL-2               PIC XXX.
  5498         16  FILLER                        PIC XXX.
  5499     12  AM-TEL-NO.
  5500         16  AM-AREA-CODE                  PIC 999.
  5501         16  AM-TEL-PRE                    PIC 999.
  5502         16  AM-TEL-NBR                    PIC 9(4).
  5503     12  AM-TEL-LOC                        PIC X.
  5504         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5505         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5506
  5507     12  AM-COMM-STRUCTURE.
  5508         16  AM-DEFN-1.
  5509             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5510                 24  AM-AGT.
  5511                     28  AM-AGT-PREFIX     PIC X(4).
  5512                     28  AM-AGT-PRIME      PIC X(6).
  5513                 24  AM-COM-TYP            PIC X.
  5514                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5515                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5516                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5517                 24  AM-RECALC-LV-INDIC    PIC X.
  5518                 24  AM-RETRO-LV-INDIC     PIC X.
  5519                 24  AM-GL-CODES           PIC X.
  5520                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5521                 24  FILLER                PIC X(01).
  5522         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5523             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5524                 24  FILLER                PIC X(11).
  5525                 24  AM-L-COMA             PIC XXX.
  5526                 24  AM-J-COMA             PIC XXX.
  5527                 24  AM-A-COMA             PIC XXX.
  5528                 24  FILLER                PIC X(6).
  5529
  5530     12  AM-COMM-CHANGE-STATUS             PIC X.
  5531         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5532
  5533     12  AM-CSR-CODE                       PIC X(4).
  5534
  5535     12  AM-BILLING-STATUS                 PIC X.
  5536         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5537         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5538     12  AM-AUTO-REFUND-SW                 PIC X.
  5539         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5540         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5541     12  AM-GPCD                           PIC 99.
  5542     12  AM-IG                             PIC X.
  5543         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5544         88  AM-HAS-GROUP                     VALUE '2'.
  5545     12  AM-STATUS                         PIC X.
  5546         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5547         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5548         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5549         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5550         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5551         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5552         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5553         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 104
* EL130.cbl
  5554         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5555         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5556     12  AM-REMIT-TO                       PIC 99.
  5557     12  AM-ID-NO                          PIC X(11).
  5558
  5559     12  AM-CAL-TABLE                      PIC XX.
  5560     12  AM-LF-DEVIATION                   PIC XXX.
  5561     12  AM-AH-DEVIATION                   PIC XXX.
  5562     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5563     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5564     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5565     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5566     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5567     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5568
  5569     12  AM-USER-FIELDS.
  5570         16  AM-FLD-1                      PIC XX.
  5571         16  AM-FLD-2                      PIC XX.
  5572         16  AM-FLD-3                      PIC XX.
  5573         16  AM-FLD-4                      PIC XX.
  5574         16  AM-FLD-5                      PIC XX.
  5575
  5576     12  AM-1ST-PROD-DATE.
  5577         16  AM-1ST-PROD-YR                PIC XX.
  5578         16  AM-1ST-PROD-MO                PIC XX.
  5579         16  AM-1ST-PROD-DA                PIC XX.
  5580     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5581     12  AM-CERTS-PURGED-DATE.
  5582         16  AM-PUR-YR                     PIC XX.
  5583         16  AM-PUR-MO                     PIC XX.
  5584         16  AM-PUR-DA                     PIC XX.
  5585     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5586     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5587     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5588     12  AM-INACTIVE-DATE.
  5589         16  AM-INA-MO                     PIC 99.
  5590         16  AM-INA-DA                     PIC 99.
  5591         16  AM-INA-YR                     PIC 99.
  5592     12  AM-AR-HI-CERT-DATE                PIC XX.
  5593
  5594     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5595     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5596
  5597     12  AM-OB-PAYMENT-MODE                PIC X.
  5598         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5599         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5600         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5601         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5602
  5603     12  AM-AH-ONLY-INDICATOR              PIC X.
  5604         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5605         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5606
  5607     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5608
  5609     12  AM-OVER-SHORT.
  5610         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5611         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 105
* EL130.cbl
  5612
  5613     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5614     12  AM-DCC-CLP-STATE                  PIC XX.
  5615
  5616     12  AM-RECALC-COMM                    PIC X.
  5617     12  AM-RECALC-REIN                    PIC X.
  5618
  5619     12  AM-REI-TABLE                      PIC XXX.
  5620     12  AM-REI-ET-LF                      PIC X.
  5621     12  AM-REI-ET-AH                      PIC X.
  5622     12  AM-REI-PE-LF                      PIC X.
  5623     12  AM-REI-PE-AH                      PIC X.
  5624     12  AM-REI-PRT-ST                     PIC X.
  5625     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5626     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5627     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5628     12  AM-REI-GROUP-A                    PIC X(6).
  5629     12  AM-REI-MORT                       PIC X(4).
  5630     12  AM-REI-PRT-OW                     PIC X.
  5631     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5632     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5633     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5634     12  AM-REI-GROUP-B                    PIC X(6).
  5635
  5636     12  AM-TRUST-TYPE                     PIC X(2).
  5637
  5638     12  AM-EMPLOYER-STMT-USED             PIC X.
  5639     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5640
  5641     12  AM-STD-AH-TYPE                    PIC XX.
  5642     12  AM-EARN-METHODS.
  5643         16  AM-EARN-METHOD-R              PIC X.
  5644             88 AM-REF-RL-R78                 VALUE 'R'.
  5645             88 AM-REF-RL-PR                  VALUE 'P'.
  5646             88 AM-REF-RL-MEAN                VALUE 'M'.
  5647             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5648         16  AM-EARN-METHOD-L              PIC X.
  5649             88 AM-REF-LL-R78                 VALUE 'R'.
  5650             88 AM-REF-LL-PR                  VALUE 'P'.
  5651             88 AM-REF-LL-MEAN                VALUE 'M'.
  5652             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5653         16  AM-EARN-METHOD-A              PIC X.
  5654             88 AM-REF-AH-R78                 VALUE 'R'.
  5655             88 AM-REF-AH-PR                  VALUE 'P'.
  5656             88 AM-REF-AH-MEAN                VALUE 'M'.
  5657             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5658             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5659             88 AM-REF-AH-NET                 VALUE 'N'.
  5660
  5661     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5662     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5663     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5664
  5665     12  AM-RET-Y-N                        PIC X.
  5666     12  AM-RET-P-E                        PIC X.
  5667     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5668     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5669     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 106
* EL130.cbl
  5670     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5671         16  AM-POOL-PRIME                 PIC XXX.
  5672         16  AM-POOL-SUB                   PIC XXX.
  5673     12  AM-RETRO-EARNINGS.
  5674         16  AM-RET-EARN-R                 PIC X.
  5675         16  AM-RET-EARN-L                 PIC X.
  5676         16  AM-RET-EARN-A                 PIC X.
  5677     12  AM-RET-ST-TAX-USE                 PIC X.
  5678         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5679         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5680     12  AM-RETRO-BEG-EARNINGS.
  5681         16  AM-RET-BEG-EARN-R             PIC X.
  5682         16  AM-RET-BEG-EARN-L             PIC X.
  5683         16  AM-RET-BEG-EARN-A             PIC X.
  5684     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5685     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5686
  5687     12  AM-USER-SELECT-OPTIONS.
  5688         16  AM-USER-SELECT-1              PIC X(10).
  5689         16  AM-USER-SELECT-2              PIC X(10).
  5690         16  AM-USER-SELECT-3              PIC X(10).
  5691         16  AM-USER-SELECT-4              PIC X(10).
  5692         16  AM-USER-SELECT-5              PIC X(10).
  5693
  5694     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5695
  5696     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5697
  5698     12  AM-RPT045A-SWITCH                 PIC X.
  5699         88  RPT045A-OFF                   VALUE 'N'.
  5700
  5701     12  AM-INSURANCE-LIMITS.
  5702         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5703         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5704
  5705     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5706         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5707
  5708     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5709         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5710         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5711
  5712     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5713
  5714     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5715     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5716     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5717     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5718     12  AM-DCC-UEF-STATE                  PIC XX.
  5719     12  FILLER                            PIC XXX.
  5720     12  AM-REPORT-CODE-3                  PIC X(10).
  5721*    12  FILLER                            PIC X(22).
  5722
  5723     12  AM-RESERVE-DATE.
  5724         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5725         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5726         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5727
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 107
* EL130.cbl
  5728     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5729     12  AM-NOTIFICATION-TYPES.
  5730         16  AM-NOTIF-OF-LETTERS           PIC X.
  5731         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5732         16  AM-NOTIF-OF-REPORTS           PIC X.
  5733         16  AM-NOTIF-OF-STATUS            PIC X.
  5734
  5735     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5736         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5737         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5738         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5739         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5740
  5741     12  AM-BENEFIT-CONTROLS.
  5742         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5743             20  AM-BENEFIT-CODE           PIC XX.
  5744             20  AM-BENEFIT-TYPE           PIC X.
  5745             20  AM-BENEFIT-REVISION       PIC XXX.
  5746             20  AM-BENEFIT-REM-TERM       PIC X.
  5747             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5748             20  FILLER                    PIC XX.
  5749         16  FILLER                        PIC X(80).
  5750
  5751     12  AM-TRANSFER-DATA.
  5752         16  AM-TRANSFERRED-FROM.
  5753             20  AM-TRNFROM-CARRIER        PIC X.
  5754             20  AM-TRNFROM-GROUPING.
  5755                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5756                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5757             20  AM-TRNFROM-STATE          PIC XX.
  5758             20  AM-TRNFROM-ACCOUNT.
  5759                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5760                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5761             20  AM-TRNFROM-DTE            PIC XX.
  5762         16  AM-TRANSFERRED-TO.
  5763             20  AM-TRNTO-CARRIER          PIC X.
  5764             20  AM-TRNTO-GROUPING.
  5765                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5766                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5767             20  AM-TRNTO-STATE            PIC XX.
  5768             20  AM-TRNTO-ACCOUNT.
  5769                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5770                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5771             20  AM-TRNTO-DTE              PIC XX.
  5772         16  FILLER                        PIC X(10).
  5773
  5774     12  AM-SAVED-REMIT-TO                 PIC 99.
  5775
  5776     12  AM-COMM-STRUCTURE-SAVED.
  5777         16  AM-DEFN-1-SAVED.
  5778             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5779                 24  AM-AGT-SV             PIC X(10).
  5780                 24  AM-COM-TYP-SV         PIC X.
  5781                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5782                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5783                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5784                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5785                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 108
* EL130.cbl
  5786                 24  AM-GL-CODES-SV        PIC X.
  5787                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5788                 24  FILLER                PIC X.
  5789         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5790             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5791                 24  FILLER                PIC X(11).
  5792                 24  AM-L-COMA-SV          PIC XXX.
  5793                 24  AM-J-COMA-SV          PIC XXX.
  5794                 24  AM-A-COMA-SV          PIC XXX.
  5795                 24  FILLER                PIC X(6).
  5796
  5797     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5798         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5799            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5800            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5801            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5802
  5803     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5804     12  FILLER                            PIC X(120).
  5805
  5806     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5807         16  AM-CONTROL-NAME               PIC X(30).
  5808         16  AM-EXECUTIVE-ONE.
  5809             20  AM-EXEC1-NAME             PIC X(15).
  5810             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5811                                                          COMP-3.
  5812             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5813                                                          COMP-3.
  5814         16  AM-EXECUTIVE-TWO.
  5815             20  AM-EXEC2-NAME             PIC X(15).
  5816             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5817                                                          COMP-3.
  5818             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5819                                                          COMP-3.
  5820
  5821     12  AM-RETRO-ADDITIONAL-DATA.
  5822         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5823         16  AM-RETRO-PREM-P-E             PIC X.
  5824         16  AM-RETRO-CLMS-P-I             PIC X.
  5825         16  AM-RETRO-RET-BRACKET-LF.
  5826             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5827                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5828                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5829             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5830                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5831                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5832             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5833                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5834                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5835         16  AM-RETRO-RET-BRACKET-AH.
  5836             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5837                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5838                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5839                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5840             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5841                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5842                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5843             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 109
* EL130.cbl
  5844                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5845                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5846
  5847     12  AM-COMMENTS.
  5848         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5849
  5850     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5851         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5852         16  AM-FLI-BILLING-CODE           PIC X.
  5853         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5854         16  AM-FLI-UNITED-IDENT           PIC X.
  5855         16  AM-FLI-INTEREST-LOST-DATA.
  5856             20  AM-FLI-BANK-NO            PIC X(5).
  5857             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5858             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5859             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5860         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5861             20  AM-FLI-AGT                PIC X(9).
  5862             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5863             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5864         16  FILLER                        PIC X(102).
  5865
  5866     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5867         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5868             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5869             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5870             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5871             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5872             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5873         16  FILLER                          PIC X(10).
  5874******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 110
* EL130.cbl
  5876*    COPY ELCTRLR.
  5877******************************************************************
  5878*                                                                *
  5879*                            ELCTRLR.                            *
  5880*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5881*                            VMOD=2.014                          *
  5882*                                                                *
  5883*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5884*                                                                *
  5885*   FILE TYPE = VSAM,KSDS                                        *
  5886*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5887*                                                                *
  5888*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5889*       ALTERNATE INDEX = NONE                                   *
  5890*                                                                *
  5891*   LOG = YES                                                    *
  5892*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5893******************************************************************
  5894*                   C H A N G E   L O G
  5895*
  5896* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5897*-----------------------------------------------------------------
  5898*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5899* EFFECTIVE    NUMBER
  5900*-----------------------------------------------------------------
  5901* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5902* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5903* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5904* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5905* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5906* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5907* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5908* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5909* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5910* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5911* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5912* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5913* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5914* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5915* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5916* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5917* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5918* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5919* 040814    2014030500002  AJRA  ADD ICD CODES
  5920* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5921* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5922* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  5923******************************************************************
  5924 01  ACTIVITY-TRAILERS.
  5925     12  AT-RECORD-ID                    PIC XX.
  5926         88  VALID-AT-ID                       VALUE 'AT'.
  5927
  5928     12  AT-CONTROL-PRIMARY.
  5929         16  AT-COMPANY-CD               PIC X.
  5930         16  AT-CARRIER                  PIC X.
  5931         16  AT-CLAIM-NO                 PIC X(7).
  5932         16  AT-CERT-NO.
  5933             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 111
* EL130.cbl
  5934             20  AT-CERT-SFX             PIC X.
  5935         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5936             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5937             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5938             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5939             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5940             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5941             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5942             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5943             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5944             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5945             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5946             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5947             88  AT-BENEFICIARY-TRL           VALUE +91.
  5948             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5949             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5950             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5951             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5952
  5953     12  AT-TRAILER-TYPE                 PIC X.
  5954         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5955         88  PAYMENT-TR                       VALUE '2'.
  5956         88  AUTO-PAY-TR                      VALUE '3'.
  5957         88  CORRESPONDENCE-TR                VALUE '4'.
  5958         88  ADDRESS-TR                       VALUE '5'.
  5959         88  GENERAL-INFO-TR                  VALUE '6'.
  5960         88  AUTO-PROMPT-TR                   VALUE '7'.
  5961         88  DENIAL-TR                        VALUE '8'.
  5962         88  INCURRED-CHG-TR                  VALUE '9'.
  5963         88  FORM-CONTROL-TR                  VALUE 'A'.
  5964
  5965     12  AT-RECORDED-DT                  PIC XX.
  5966     12  AT-RECORDED-BY                  PIC X(4).
  5967     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5968
  5969     12  AT-TRAILER-BODY                 PIC X(165).
  5970
  5971     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5972         16  AT-RESERVE-CONTROLS.
  5973             20  AT-MANUAL-SW            PIC X.
  5974                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5975             20  AT-FUTURE-SW            PIC X.
  5976                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5977             20  AT-PTC-SW               PIC X.
  5978                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5979             20  AT-IBNR-SW              PIC X.
  5980                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5981             20  AT-PTC-LF-SW            PIC X.
  5982                 88  AT-LF-PTC-USED          VALUE '1'.
  5983             20  AT-CDT-ACCESS-METHOD    PIC X.
  5984                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5985                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5986                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5987             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5988         16  AT-LAST-COMPUTED-DT         PIC XX.
  5989         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5990         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5991         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 112
* EL130.cbl
  5992         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5993         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5994         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5995         16  AT-EXPENSE-CONTROLS.
  5996             20  AT-EXPENSE-METHOD       PIC X.
  5997                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5998                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5999                 88  PERCENT-OF-PMT           VALUE '3'.
  6000                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6001             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6002             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6003         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6004         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6005
  6006         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6007         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6008
  6009*        16  FILLER                      PIC X(53).
  6010         16  FILLER                      PIC X(47).
  6011
  6012         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6013         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6014
  6015         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6016             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6017             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6018*                    C = CLOSED
  6019*                    O = OPEN
  6020             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6021*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6022
  6023     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6024         16  AT-PAYMENT-TYPE             PIC X.
  6025             88  PARTIAL-PAYMENT                VALUE '1'.
  6026             88  FINAL-PAYMENT                  VALUE '2'.
  6027             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6028             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6029             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6030             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6031             88  VOIDED-PAYMENT                 VALUE '9'.
  6032             88  TRANSFER                       VALUE 'T'.
  6033             88  LIFE-INTEREST                  VALUE 'I'.
  6034
  6035         16  AT-CLAIM-TYPE               PIC X.
  6036             88  PAID-FOR-AH                    VALUE 'A'.
  6037             88  PAID-FOR-LIFE                  VALUE 'L'.
  6038             88  PAID-FOR-IUI                   VALUE 'I'.
  6039             88  PAID-FOR-GAP                   VALUE 'G'.
  6040             88  PAID-FOR-FAM                   VALUE 'F'.
  6041         16  AT-CLAIM-PREM-TYPE          PIC X.
  6042             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6043             88  AT-O-B-COVERAGE                VALUE '2'.
  6044             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6045         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6046         16  AT-CHECK-NO                 PIC X(7).
  6047         16  AT-PAID-FROM-DT             PIC XX.
  6048         16  AT-PAID-THRU-DT             PIC XX.
  6049         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 113
* EL130.cbl
  6050         16  AT-ACH-PAYMENT              PIC X.
  6051*        16  FILLER                      PIC X.
  6052         16  AT-PAYEES-NAME              PIC X(30).
  6053         16  AT-PAYMENT-ORIGIN           PIC X.
  6054             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6055             88  ONLINE-AUTO-PMT                VALUE '2'.
  6056             88  OFFLINE-PMT                    VALUE '3'.
  6057         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6058         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6059         16  AT-VOID-DATA.
  6060             20  AT-VOID-DT              PIC XX.
  6061*00144       20  AT-VOID-REASON          PIC X(30).
  6062             20  AT-VOID-REASON          PIC X(26).
  6063         16  AT-PMT-APPROVED-BY          PIC X(04).
  6064         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6065         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6066         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6067                                         PIC S99V9(5)  COMP-3.
  6068         16  AT-CREDIT-INTERFACE.
  6069             20  AT-PMT-SELECT-DT        PIC XX.
  6070                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6071             20  AT-PMT-ACCEPT-DT        PIC XX.
  6072                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6073             20  AT-VOID-SELECT-DT       PIC XX.
  6074                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6075             20  AT-VOID-ACCEPT-DT       PIC XX.
  6076                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6077
  6078         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6079                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6080                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6081         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6082
  6083         16  AT-FORCE-CONTROL            PIC X.
  6084             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6085         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6086         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6087         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6088         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6089         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6090         16  AT-BENEFIT-TYPE             PIC X.
  6091
  6092         16  AT-EXPENSE-TYPE             PIC X.
  6093         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6094
  6095         16  AT-PAYEE-TYPE-CD.
  6096             20  AT-PAYEE-TYPE           PIC X.
  6097                 88  INSURED-PAID           VALUE 'I'.
  6098                 88  BENEFICIARY-PAID       VALUE 'B'.
  6099                 88  ACCOUNT-PAID           VALUE 'A'.
  6100                 88  OTHER-1-PAID           VALUE 'O'.
  6101                 88  OTHER-2-PAID           VALUE 'Q'.
  6102                 88  DOCTOR-PAID            VALUE 'P'.
  6103                 88  EMPLOYER-PAID          VALUE 'E'.
  6104             20  AT-PAYEE-SEQ            PIC X.
  6105
  6106         16  AT-CASH-PAYMENT             PIC X.
  6107         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 114
* EL130.cbl
  6108         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6109         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6110         16  AT-APPROVED-LEVEL           PIC X.
  6111         16  AT-VOID-TYPE                PIC X.
  6112             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6113             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6114         16  AT-AIG-UNEMP-IND            PIC X.
  6115             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6116         16  AT-ASSOCIATES               PIC X.
  6117             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6118             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6119
  6120         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6121         16  AT-CV-PMT-CODE              PIC X.
  6122             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6123             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6124             88  FULL-ADD-PAYMENT           VALUE '3'.
  6125             88  HALF-ADD-PAYMENT           VALUE '4'.
  6126             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6127             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6128             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6129             88  ADDL-PAYMENT               VALUE '8'.
  6130
  6131         16  AT-EOB-CODE1                PIC XXX.
  6132         16  AT-EOB-CODE2                PIC XXX.
  6133         16  AT-EOB-CODE3                PIC XXX.
  6134         16  FILLER REDEFINES AT-EOB-CODE3.
  6135             20  AT-PRINT-CLM-FORM       PIC X.
  6136             20  AT-PRINT-SURVEY         PIC X.
  6137             20  AT-SPECIAL-RELEASE      PIC X.
  6138         16  AT-EOB-CODE4                PIC XXX.
  6139         16  FILLER REDEFINES AT-EOB-CODE4.
  6140             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6141             20  FILLER                  PIC X.
  6142         16  AT-EOB-CODE5                PIC XXX.
  6143         16  FILLER REDEFINES AT-EOB-CODE5.
  6144             20  AT-PMT-PROOF-DT         PIC XX.
  6145             20  FILLER                  PIC X.
  6146
  6147         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6148             88  AT-PRINT-EOB            VALUE 'Y'.
  6149
  6150         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6151         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6152
  6153     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6154         16  AT-SCHEDULE-START-DT        PIC XX.
  6155         16  AT-SCHEDULE-END-DT          PIC XX.
  6156         16  AT-TERMINATED-DT            PIC XX.
  6157         16  AT-LAST-PMT-TYPE            PIC X.
  6158             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6159             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6160         16  AT-FIRST-PMT-DATA.
  6161             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6162             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6163             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6164         16  AT-REGULAR-PMT-DATA.
  6165             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 115
* EL130.cbl
  6166             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6167             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6168         16  AT-AUTO-PAYEE-CD.
  6169             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6170                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6171                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6172                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6173                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6174                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6175             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6176         16  AT-AUTO-PAY-DAY             PIC 99.
  6177         16  AT-AUTO-CASH                PIC X.
  6178             88  AT-CASH                      VALUE 'Y'.
  6179             88  AT-NON-CASH                  VALUE 'N'.
  6180*        16  FILLER                      PIC X(129).
  6181         16  AT-AUTO-END-LETTER          PIC X(4).
  6182         16  FILLER                      PIC X(125).
  6183
  6184         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6185         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6186
  6187     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6188         16  AT-LETTER-SENT-DT           PIC XX.
  6189         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6190         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6191         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6192         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6193         16  AT-LETTER-ORIGIN            PIC X.
  6194             88  ONLINE-CREATION              VALUE '1' '3'.
  6195             88  OFFLINE-CREATION             VALUE '2' '4'.
  6196             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6197             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6198         16  AT-STD-LETTER-FORM          PIC X(4).
  6199         16  AT-REASON-TEXT              PIC X(70).
  6200         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6201         16  AT-ADDRESEE-TYPE            PIC X.
  6202              88  INSURED-ADDRESEE            VALUE 'I'.
  6203              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6204              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6205              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6206              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6207              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6208              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6209         16  AT-ADDRESSEE-NAME           PIC X(30).
  6210         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6211         16  AT-RESEND-PRINT-DATE        PIC XX.
  6212         16  AT-CORR-SOL-UNSOL           PIC X.
  6213         16  AT-LETTER-PURGED-DT         PIC XX.
  6214*
  6215*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6216*
  6217         16  AT-CSO-REDEFINITION.
  6218             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6219             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6220             20  AT-LETTER-TO-BENE       PIC X(1).
  6221             20  AT-STOP-LETTER-DT       PIC X(2).
  6222             20  AT-AUTH-RCVD            PIC X(1).
  6223             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 116
* EL130.cbl
  6224*             20  FILLER                  PIC X(27).
  6225             20  AT-CSO-LETTER-STATUS    PIC X.
  6226                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6227                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6228                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6229             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6230             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6231*
  6232*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6233*
  6234*        16  FILLER                      PIC X(26).
  6235*
  6236*        16  AT-DMD-BSR-CODE             PIC X.
  6237*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6238*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6239*
  6240*        16  AT-DMD-LETTER-STATUS        PIC X.
  6241*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6242*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6243*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6244*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6245*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6246
  6247         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6248         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6249
  6250     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6251         16  AT-ADDRESS-TYPE             PIC X.
  6252             88  INSURED-ADDRESS               VALUE 'I'.
  6253             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6254             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6255             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6256             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6257             88  OTHER-ADDRESS-1               VALUE 'O'.
  6258             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6259         16  AT-MAIL-TO-NAME             PIC X(30).
  6260         16  AT-ADDRESS-LINE-1           PIC X(30).
  6261         16  AT-ADDRESS-LINE-2           PIC X(30).
  6262         16  AT-CITY-STATE.
  6263             20  AT-CITY                 PIC X(28).
  6264             20  AT-STATE                PIC XX.
  6265         16  AT-ZIP.
  6266             20  AT-ZIP-CODE.
  6267                 24  AT-ZIP-1ST          PIC X.
  6268                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6269                 24  FILLER              PIC X(4).
  6270             20  AT-ZIP-PLUS4            PIC X(4).
  6271         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6272             20  AT-CAN-POSTAL-1         PIC XXX.
  6273             20  AT-CAN-POSTAL-2         PIC XXX.
  6274             20  FILLER                  PIC XXX.
  6275         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6276*         16  FILLER                      PIC X(23).
  6277         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6278         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6279         16  FILLER                      PIC X(13).
  6280         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6281         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 117
* EL130.cbl
  6282
  6283     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6284         16  AT-INFO-LINE-1              PIC X(60).
  6285         16  FILLER REDEFINES AT-INFO-LINE-1.
  6286             20  AT-NOTE-ERROR-NO OCCURS 15
  6287                                         PIC X(4).
  6288         16  AT-INFO-LINE-2              PIC X(60).
  6289         16  FILLER REDEFINES AT-INFO-LINE-2.
  6290             20  AT-ICD-CODE-1           PIC X(8).
  6291             20  AT-ICD-CODE-2           PIC X(8).
  6292             20  FILLER                  PIC X(44).
  6293         16  AT-INFO-TRAILER-TYPE        PIC X.
  6294             88  AT-ERRORS-NOTE          VALUE 'E'.
  6295             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6296             88  AT-CALL-NOTE            VALUE 'C'.
  6297             88  AT-MAINT-NOTE           VALUE 'M'.
  6298             88  AT-CERT-CHANGE          VALUE 'X'.
  6299             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6300             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6301             88  AT-CERT-CANCELLED       VALUE 'T'.
  6302         16  AT-CALL-TYPE                PIC X.
  6303             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6304             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6305         16  AT-NOTE-CONTINUATION        PIC X.
  6306             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6307         16  AT-EOB-CODES-EXIST          PIC X.
  6308             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6309         16  FILLER                      PIC X(35).
  6310         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6311         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6312
  6313     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6314         16  AT-PROMPT-LINE-1            PIC X(60).
  6315         16  AT-PROMPT-LINE-2            PIC X(60).
  6316         16  AT-PROMPT-START-DT          PIC XX.
  6317         16  AT-PROMPT-END-DT            PIC XX.
  6318         16  FILLER                      PIC X(35).
  6319         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6320         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6321
  6322     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6323         16  AT-DENIAL-INFO-1            PIC X(60).
  6324         16  AT-DENIAL-INFO-2            PIC X(60).
  6325         16  AT-DENIAL-DT                PIC XX.
  6326         16  AT-RETRACTION-DT            PIC XX.
  6327         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6328*         16  FILLER                      PIC X(31).
  6329         16  AT-DENIAL-PROOF-DT          PIC XX.
  6330         16  FILLER                      PIC X(29).
  6331         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6332         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6333
  6334     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6335         16  AT-OLD-INCURRED-DT          PIC XX.
  6336         16  AT-OLD-REPORTED-DT          PIC XX.
  6337         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6338         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6339         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 118
* EL130.cbl
  6340         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6341         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6342         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6343         16  FILLER                      PIC X(26).
  6344         16  AT-OLD-DIAG-CODE            PIC X(6).
  6345         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6346         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6347         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6348         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6349         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6350         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6351         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6352         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6353         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6354         16  FILLER                      PIC X(9).
  6355         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6356
  6357     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6358         16  AT-FORM-SEND-ON-DT          PIC XX.
  6359         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6360         16  AT-FORM-RE-SEND-DT          PIC XX.
  6361         16  AT-FORM-ANSWERED-DT         PIC XX.
  6362         16  AT-FORM-PRINTED-DT          PIC XX.
  6363         16  AT-FORM-REPRINT-DT          PIC XX.
  6364         16  AT-FORM-TYPE                PIC X.
  6365             88  INITIAL-FORM                  VALUE '1'.
  6366             88  PROGRESS-FORM                 VALUE '2'.
  6367         16  AT-INSTRUCT-LN-1            PIC X(28).
  6368         16  AT-INSTRUCT-LN-2            PIC X(28).
  6369         16  AT-INSTRUCT-LN-3            PIC X(28).
  6370         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6371         16  AT-FORM-ADDRESS             PIC X.
  6372             88  FORM-TO-INSURED              VALUE 'I'.
  6373             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6374             88  FORM-TO-OTHER-1              VALUE 'O'.
  6375             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6376         16  AT-RELATED-1.
  6377             20 AT-REL-CARR-1            PIC X.
  6378             20 AT-REL-CLAIM-1           PIC X(7).
  6379             20 AT-REL-CERT-1            PIC X(11).
  6380         16  AT-RELATED-2.
  6381             20 AT-REL-CARR-2            PIC X.
  6382             20 AT-REL-CLAIM-2           PIC X(7).
  6383             20 AT-REL-CERT-2            PIC X(11).
  6384         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6385         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6386         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6387         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6388         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6389         16  AT-STOP-FORM-DT             PIC X(2).
  6390
  6391         16  FILLER                      PIC X(09).
  6392         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6393         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6394******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 119
* EL130.cbl
  6396*    COPY ELCBENE.
  6397******************************************************************
  6398*                                                                *
  6399*                            ELCBENE.                            *
  6400*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6401*                            VMOD=2.006                          *
  6402*                                                                *
  6403*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6404*                                                                *
  6405*   FILE TYPE = VSAM,KSDS                                        *
  6406*   RECORD SIZE = 500   RECFORM = FIX                            *
  6407*                                                                *
  6408*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6409*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6410*                                                                *
  6411*   LOG = YES                                                    *
  6412*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6413*                                                                *
  6414*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6415******************************************************************
  6416*                   C H A N G E   L O G
  6417*
  6418* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6419*-----------------------------------------------------------------
  6420*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6421* EFFECTIVE    NUMBER
  6422*-----------------------------------------------------------------
  6423* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6424* 082317  CR2017082100003  PEMA  Add sub type
  6425******************************************************************
  6426
  6427 01  BENEFICIARY-MASTER.
  6428     12  BE-RECORD-ID                PIC XX.
  6429         88  VALID-BE-ID                VALUE 'BE'.
  6430
  6431     12  BE-CONTROL-PRIMARY.
  6432         16  BE-COMPANY-CD           PIC X.
  6433         16  BE-RECORD-TYPE          PIC X.
  6434             88  BENEFICIARY-RECORD  VALUE 'B'.
  6435             88  ADJUSTOR-RECORD     VALUE 'A'.
  6436         16  BE-BENEFICIARY          PIC X(10).
  6437     12  BE-CONTROL-BY-NAME.
  6438         16  BE-COMPANY-CD-A1        PIC X.
  6439         16  BE-RECORD-TYPE-A1       PIC X.
  6440         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6441         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6442
  6443     12  BE-LAST-MAINT-DT            PIC XX.
  6444     12  BE-LAST-MAINT-BY            PIC X(4).
  6445     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6446
  6447     12  BE-ADDRESS-DATA.
  6448         16  BE-MAIL-TO-NAME         PIC X(30).
  6449         16  BE-ADDRESS-LINE-1       PIC X(30).
  6450         16  BE-ADDRESS-LINE-2       PIC X(30).
  6451         16  BE-ADDRESS-LINE-3       PIC X(30).
  6452         16  BE-CITY-STATE.
  6453             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 120
* EL130.cbl
  6454             20  BE-STATE            PIC XX.
  6455         16  BE-ZIP-CODE.
  6456             20  BE-ZIP-PRIME.
  6457                 24  BE-ZIP-1ST      PIC X.
  6458                     88  BE-CANADIAN-POST-CODE
  6459                                         VALUE 'A' THRU 'Z'.
  6460                 24  FILLER          PIC X(4).
  6461             20  BE-ZIP-PLUS4        PIC X(4).
  6462         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6463             20  BE-CAN-POSTAL-1     PIC XXX.
  6464             20  BE-CAN-POSTAL-2     PIC XXX.
  6465             20  FILLER              PIC XXX.
  6466         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6467         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6468
  6469******************************************************************
  6470*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6471*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6472******************************************************************
  6473     12  BE-CARRIER                  PIC X.
  6474
  6475     12  BE-ADDRESS-DATA2.
  6476         16  BE-MAIL-TO-NAME2        PIC X(30).
  6477         16  BE-ADDRESS-LINE-12      PIC X(30).
  6478         16  BE-ADDRESS-LINE-22      PIC X(30).
  6479         16  BE-ADDRESS-LINE-32      PIC X(30).
  6480         16  BE-CITY-STATE2.
  6481             20  BE-CITY2            PIC X(28).
  6482             20  BE-STATE2           PIC XX.
  6483         16  BE-ZIP-CODE2.
  6484             20  BE-ZIP-PRIME2.
  6485                 24  BE-ZIP-1ST2     PIC X.
  6486                     88  BE-CANADIAN-POST-CODE2
  6487                                         VALUE 'A' THRU 'Z'.
  6488                 24  FILLER          PIC X(4).
  6489             20  BE-ZIP-PLUS42       PIC X(4).
  6490         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6491             20  BE-CAN-POSTAL-12    PIC XXX.
  6492             20  BE-CAN-POSTAL-22    PIC XXX.
  6493             20  FILLER              PIC XXX.
  6494         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6495         16  BE-ACH-DATA.
  6496             20  BE-ACH-YES-OR-NO    PIC X.
  6497                 88  BE-ON-ACH       VALUE 'Y'.
  6498                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6499             20  BE-ACH-ABA-ROUTING-NUMBER
  6500                                     PIC X(15).
  6501             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6502                                     PIC X(20).
  6503             20  BE-ACH-SUB-TYPE     PIC XX.
  6504             20  FILLER              PIC X(23).
  6505         16  BE-BILLING-STMT-DATA.
  6506*            20  BE-BSR              PIC X.
  6507*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  6508*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6509*            20  BE-BSR-FROM         PIC X(30).
  6510*            20  BE-BSR-DEPT         PIC X(30).
  6511             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 121
* EL130.cbl
  6512             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6513             20  BE-OUTPUT-TYPE      PIC X.
  6514                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6515                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6516
  6517     12  FILLER                      PIC X(28).
  6518******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 122
* EL130.cbl
  6520*    COPY ELCDAR.
  6521******************************************************************
  6522*                                                                *
  6523*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6524*   FILE TYPE = VSAM,KSDS                                        *
  6525*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6526*   BASE CLUSTER = DLYACTV                                       *
  6527*   LOG = YES                                                    *
  6528*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6529*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6530*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6531*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6532*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6533*               BY PROGRAM "LGINFCE".                            *
  6534*                                                                *
  6535******************************************************************
  6536 01  DAILY-ACTIVITY-RECORD.
  6537     05  DA-KEY.
  6538         10  DA-COMP-CD          PIC X.
  6539         10  DA-CARRIER          PIC X.
  6540         10  DA-CLAIM-NO         PIC X(7).
  6541         10  DA-CERT-NO.
  6542             15  DA-CERT-PRIME   PIC X(10).
  6543             15  DA-CERT-SFX     PIC X.
  6544     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6545     05  DA-RECORD-TYPE          PIC X.
  6546     05  FILLER                  PIC X(2).
  6547******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 123
* EL130.cbl
  6549*    COPY ELCACTQ.
  6550******************************************************************
  6551*                                                                *
  6552*                            ELCACTQ.                            *
  6553*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6554*                            VMOD=2.004                          *
  6555*                                                                *
  6556*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6557*                                                                *
  6558*   FILE TYPE = VSAM,KSDS                                        *
  6559*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6560*                                                                *
  6561*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6562*       ALTERNATE INDEX = NONE                                   *
  6563*                                                                *
  6564*   LOG = YES                                                    *
  6565*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6566*                                                                *
  6567*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6568******************************************************************
  6569
  6570 01  ACTIVITY-QUE.
  6571     12  AQ-RECORD-ID                PIC XX.
  6572         88  VALID-AQ-ID                VALUE 'AQ'.
  6573
  6574     12  AQ-CONTROL-PRIMARY.
  6575         16  AQ-COMPANY-CD           PIC X.
  6576         16  AQ-CARRIER              PIC X.
  6577         16  AQ-CLAIM-NO             PIC X(7).
  6578         16  AQ-CERT-NO.
  6579             20  AQ-CERT-PRIME       PIC X(10).
  6580             20  AQ-CERT-SFX         PIC X.
  6581
  6582     12  AQ-PENDING-ACTIVITY-FLAGS.
  6583         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6584         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6585             88  PENDING-PAYMENTS       VALUE '1'.
  6586         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6587             88  PENDING-FULL-PRINT     VALUE '1'.
  6588             88  PENDING-PART-PRINT     VALUE '2'.
  6589         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6590             88  PENDING-LETTERS        VALUE '1'.
  6591         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6592             88  PENDING-RESTORE        VALUE 'C'.
  6593             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6594
  6595     12  FILLER                      PIC X(20).
  6596
  6597     12  AQ-RESEND-DATE              PIC XX.
  6598     12  AQ-FOLLOWUP-DATE            PIC XX.
  6599     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6600     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6601     12  AQ-AUTO-LETTER              PIC X(4).
  6602     12  FILLER                      PIC XX.
  6603     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6604*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 124
* EL130.cbl
  6606*    COPY ELCARCH.
  6607******************************************************************
  6608*                                                                *
  6609*                            ELCARCH.                            *
  6610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6611*                            VMOD=2.007                          *
  6612*                                                                *
  6613*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6614*                                                                *
  6615*   FILE TYPE = VSAM,KSDS                                        *
  6616*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6617*                                                                *
  6618*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6619*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6620*                                                                *
  6621*   LOG = NO                                                     *
  6622*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6623*                                                                *
  6624*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6625******************************************************************
  6626 01  LETTER-ARCHIVE.
  6627     12  LA-RECORD-ID                PIC XX.
  6628         88  VALID-LA-ID                VALUE 'LA'.
  6629
  6630     12  LA-CONTROL-PRIMARY.
  6631         16  LA-COMPANY-CD           PIC X.
  6632         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6633         16  LA-RECORD-TYPE          PIC X.
  6634             88  LA-HEADER-DATA         VALUE '1'.
  6635             88  LA-ADDRESS-DATA        VALUE '2'.
  6636             88  LA-TEXT-DATA           VALUE '3'.
  6637             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6638         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6639
  6640     12  LA-CONTROL-BY-TYPE.
  6641         16  LA-COMPANY-CD-A1        PIC X.
  6642         16  LA-RECORD-TYPE-A1       PIC X.
  6643         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6644         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6645
  6646     12  LA-TEXT-RECORD.
  6647         16  LA-SKIP-CONTROL         PIC XX.
  6648             88  NO-LINES-SKIPPED       VALUE SPACES.
  6649             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6650         16  LA-TEXT-LINE            PIC X(70).
  6651
  6652     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6653         16  FILLER                  PIC XX.
  6654         16  LA-ADDRESS-LINE         PIC X(30).
  6655         16  FILLER                  PIC X(40).
  6656
  6657     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6658         16  FILLER                  PIC XX.
  6659         16  LA-CARRIER              PIC X.
  6660         16  LA-CLAIM-NO             PIC X(7).
  6661         16  LA-CERT-NO.
  6662             20  LA-CERT-PRIME       PIC X(10).
  6663             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 125
* EL130.cbl
  6664         16  LA-NO-OF-COPIES         PIC S9.
  6665         16  LA-RESEND-DATE          PIC XX.
  6666         16  LA-PROCESSOR-CD         PIC X(4).
  6667         16  LA-CREATION-DT          PIC XX.
  6668         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6669         16  LA-RESEND-PRINT-DATE    PIC XX.
  6670         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6671         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6672*
  6673* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6674*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6675*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6676*   I        20  LA-DMD-RES-ST           PIC XX.
  6677*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6678*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6679*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6680*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6681*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6682*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6683*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6684*   I        20  LA-DMD-UND-CODE         PIC XX.
  6685*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6686*   V    16  FILLER                  PIC X(15).
  6687* -----
  6688*
  6689* REINSERTED  CSO  MODS
  6690*
  6691         16  FILLER.
  6692             20  FILLER                  PIC X(29).
  6693             20  LA-CSO-LETTER-STATUS    PIC X.
  6694                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6695                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6696                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6697             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6698             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6699*
  6700
  6701     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6702         16  FILLER                  PIC XX.
  6703         16  LA4-CARRIER             PIC X.
  6704         16  LA4-CLAIM-NO            PIC X(7).
  6705         16  LA4-CERT-NO.
  6706             20  LA4-CERT-PRIME      PIC X(10).
  6707             20  LA4-CERT-SFX        PIC X.
  6708         16  LA4-NO-OF-COPIES        PIC S9.
  6709         16  LA4-RESEND-DATE         PIC XX.
  6710         16  LA4-PROCESSOR-CD        PIC X(4).
  6711         16  LA4-CREATION-DT         PIC XX.
  6712         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6713         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6714         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6715         16  LA4-FORM-TYPE           PIC X.
  6716             88  LA4-INITIAL-FORM    VALUE '1'.
  6717             88  LA4-PROGRESS-FORM   VALUE '2'.
  6718         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6719         16  LA4-STATE               PIC X(02).
  6720         16  FILLER                  PIC X(31).
  6721******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 126
* EL130.cbl
  6723*    COPY ERCREIN.
  6724******************************************************************
  6725*                                                                *
  6726*                            ERCREIN                             *
  6727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6728*                            VMOD=2.010                          *
  6729*                                                                *
  6730*   ONLINE CREDIT SYSTEM                                         *
  6731*                                                                *
  6732*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6733*                                                                *
  6734*   FILE TYPE = VSAM,KSDS                                        *
  6735*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6736*                                                                *
  6737*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6738*       ALTERNATE PATH = NONE                                    *
  6739*                                                                *
  6740*   LOG = NO                                                     *
  6741*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6742*                                                                *
  6743******************************************************************
  6744*                   C H A N G E   L O G
  6745*
  6746* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6747*-----------------------------------------------------------------
  6748*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6749* EFFECTIVE    NUMBER
  6750*-----------------------------------------------------------------
  6751* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6752* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6753******************************************************************
  6754 01  REINSURANCE-RECORD.
  6755     12  RE-RECORD-ID                      PIC XX.
  6756         88  VALID-RE-ID                      VALUE 'RE'.
  6757
  6758     12  RE-CONTROL-PRIMARY.
  6759         16  RE-COMPANY-CD                 PIC X.
  6760         16  RE-KEY.
  6761             20  RE-CODE                   PIC X.
  6762                 88  RE-TABLE-RECORD          VALUE 'A'.
  6763                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6764             20  RE-TABLE                  PIC XXX.
  6765             20  FILLER                    PIC XXX.
  6766         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6767             20  FILLER                    PIC X.
  6768             20  RE-COMPANY.
  6769                 24  RE-COMP-PRIME         PIC XXX.
  6770                 24  RE-COMP-SUB           PIC XXX.
  6771
  6772     12  RE-MAINT-INFORMATION.
  6773         16  RE-LAST-MAINT-DT              PIC XX.
  6774         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6775         16  RE-LAST-MAINT-USER            PIC X(4).
  6776         16  FILLER                        PIC X(10).
  6777
  6778     12  RE-TABLE-DATA.
  6779         16  RE-100-COMP                   PIC 99.
  6780
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 127
* EL130.cbl
  6781         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6782             20  RE-REI-COMP-NO.
  6783                 24  RE-REI-COMP           PIC XXX.
  6784                 24  RE-REI-COMP-SUB       PIC XXX.
  6785             20  RE-LF-QC                  PIC X.
  6786             20  RE-AH-QC                  PIC X.
  6787             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6788             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6789             20  RE-LFAGE-LO               PIC 99.
  6790             20  RE-LFAGE-HI               PIC 99.
  6791             20  RE-AHAGE-LO               PIC 99.
  6792             20  RE-AHAGE-HI               PIC 99.
  6793             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6794             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6795             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6796             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6797             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6798             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6799             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6800             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6801             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6802             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6803             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6804             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6805             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6806             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6807             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6808             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6809             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6810             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6811             20  RE-LF-BEN-CODE            PIC X.
  6812             20  RE-AH-BEN-CODE            PIC X.
  6813             20  RE-INTERACTIVE            PIC X.
  6814             20  RE-REMAINING              PIC X.
  6815             20  RE-LF-RUNOFF-SW           PIC X.
  6816             20  RE-AH-RUNOFF-SW           PIC X.
  6817             20  FILLER                    PIC X(19).
  6818
  6819         16  RE-COMP-INFO-END              PIC X(6).
  6820         16  RE-NSP-ST-CD-LF               PIC XX.
  6821         16  RE-NSP-ST-CD-AH               PIC XX.
  6822         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6823             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6824
  6825         16  FILLER                        PIC X(27).
  6826
  6827     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6828         16  RE-NAME                       PIC X(30).
  6829         16  RE-LF-PE                      PIC X.
  6830         16  RE-AH-PE                      PIC X.
  6831         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6832         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6833         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6834         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6835         16  RE-PRT-ST                     PIC X.
  6836         16  RE-PRT-OW                     PIC X.
  6837         16  RE-MORT-CODE                  PIC X(4).
  6838         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 128
* EL130.cbl
  6839         16  RE-ZERO-LF-FEE                PIC X.
  6840         16  RE-ZERO-AH-FEE                PIC X.
  6841         16  RE-CEDE-NAME                  PIC X(30).
  6842         16  RE-LF-COMM                    PIC X.
  6843         16  RE-AH-COMM                    PIC X.
  6844         16  RE-LF-TAX                     PIC X.
  6845         16  RE-AH-TAX                     PIC X.
  6846         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6847         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6848         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6849
  6850         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6851             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6852
  6853         16  RE-LF-CEDING-FEE-BRACKETS.
  6854             20  RE-LF-FEE-METHOD          PIC X.
  6855                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6856                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6857                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6858                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6859             20  RE-LF-FEE-BASIS           PIC X.
  6860                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6861                 88  RE-LF-NET-CEDED               VALUE '2'.
  6862                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6863                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6864                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6865                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6866                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6867                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6868             20  FILLER                    PIC XXX.
  6869             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6870                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6871                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6872
  6873         16  RE-AH-CEDING-FEE-BRACKETS.
  6874             20  RE-AH-FEE-METHOD          PIC X.
  6875                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6876                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6877                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6878                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6879             20  RE-AH-FEE-BASIS           PIC X.
  6880                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6881                 88  RE-AH-NET-CEDED               VALUE '2'.
  6882                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6883                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6884                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6885                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6886                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6887                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6888             20  FILLER                    PIC XXX.
  6889             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6890                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6891                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6892
  6893         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6894
  6895         16  RE-OLD-CEDING-STMT            PIC X.
  6896
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 129
* EL130.cbl
  6897         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6898         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6899         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6900         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6901         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6902         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6903         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6904         16  RE-MORT-SW                    PIC X.
  6905         16  RE-CEDING-TYPE-FLAG           PIC X.
  6906             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6907             88  RE-CEDED                          VALUE 'C'.
  6908             88  RE-ASSUMED                        VALUE 'A'.
  6909             88  RE-PHANTOM                        VALUE 'P'.
  6910
  6911         16  RE-CEDING-STMT-OPT-A          PIC X.
  6912             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6913         16  RE-CEDING-STMT-OPT-B          PIC X.
  6914             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6915         16  RE-CEDING-STMT-OPT-C          PIC X.
  6916             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6917         16  RE-CEDING-STMT-OPT-D          PIC X.
  6918             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6919         16  RE-CEDING-STMT-OPT-E          PIC X.
  6920             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6921
  6922         16  RE-PRT-CRSV                   PIC X.
  6923
  6924         16  RE-GL-CENTER                  PIC X(4).
  6925
  6926         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6927
  6928         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6929
  6930         16  RE-EARN-STOP-CODE             PIC X.
  6931             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6932             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6933
  6934         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6935             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6936
  6937         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6938         16  FILLER                        PIC X(2281).
  6939
  6940         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6941
  6942******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 130
* EL130.cbl
  6944*    COPY ERCMAIL.
  6945******************************************************************
  6946*                                                                *
  6947*                                                                *
  6948*                            ERCMAIL                             *
  6949*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6950*                            VMOD=2.003                          *
  6951*                                                                *
  6952*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6953*                                                                *
  6954*   FILE TYPE = VSAM,KSDS                                        *
  6955*   RECORD SIZE = 374   RECFORM = FIX                            *
  6956*                                                                *
  6957*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6958*   ALTERNATE PATH    = NOT USED                                 *
  6959*                                                                *
  6960*   LOG = YES                                                    *
  6961*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6962******************************************************************
  6963*                   C H A N G E   L O G
  6964*
  6965* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6966*-----------------------------------------------------------------
  6967*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6968* EFFECTIVE    NUMBER
  6969*-----------------------------------------------------------------
  6970* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6971* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6972* 111108                   PEMA  ADD CRED BENE ADDR2
  6973******************************************************************
  6974
  6975 01  MAILING-DATA.
  6976     12  MA-RECORD-ID                      PIC XX.
  6977         88  VALID-MA-ID                       VALUE 'MA'.
  6978
  6979     12  MA-CONTROL-PRIMARY.
  6980         16  MA-COMPANY-CD                 PIC X.
  6981         16  MA-CARRIER                    PIC X.
  6982         16  MA-GROUPING.
  6983             20  MA-GROUPING-PREFIX        PIC XXX.
  6984             20  MA-GROUPING-PRIME         PIC XXX.
  6985         16  MA-STATE                      PIC XX.
  6986         16  MA-ACCOUNT.
  6987             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6988             20  MA-ACCOUNT-PRIME          PIC X(6).
  6989         16  MA-CERT-EFF-DT                PIC XX.
  6990         16  MA-CERT-NO.
  6991             20  MA-CERT-PRIME             PIC X(10).
  6992             20  MA-CERT-SFX               PIC X.
  6993
  6994     12  FILLER                            PIC XX.
  6995
  6996     12  MA-ACCESS-CONTROL.
  6997         16  MA-SOURCE-SYSTEM              PIC XX.
  6998             88  MA-FROM-CREDIT                VALUE 'CR'.
  6999             88  MA-FROM-VSI                   VALUE 'VS'.
  7000             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7001             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 131
* EL130.cbl
  7002         16  MA-RECORD-ADD-DT              PIC XX.
  7003         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7004         16  MA-LAST-MAINT-DT              PIC XX.
  7005         16  MA-LAST-MAINT-BY              PIC XXXX.
  7006         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7007
  7008     12  MA-PROFILE-INFO.
  7009         16  MA-QUALIFY-CODE-1             PIC XX.
  7010         16  MA-QUALIFY-CODE-2             PIC XX.
  7011         16  MA-QUALIFY-CODE-3             PIC XX.
  7012         16  MA-QUALIFY-CODE-4             PIC XX.
  7013         16  MA-QUALIFY-CODE-5             PIC XX.
  7014
  7015         16  MA-INSURED-LAST-NAME          PIC X(15).
  7016         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7017         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7018         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7019         16  MA-INSURED-BIRTH-DT           PIC XX.
  7020         16  MA-INSURED-SEX                PIC X.
  7021             88  MA-SEX-MALE                   VALUE 'M'.
  7022             88  MA-SEX-FEMALE                 VALUE 'F'.
  7023         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7024
  7025         16  MA-ADDRESS-CORRECTED          PIC X.
  7026         16  MA-JOINT-BIRTH-DT             PIC XX.
  7027*        16  FILLER                        PIC X(12).
  7028
  7029         16  MA-ADDRESS-LINE-1             PIC X(30).
  7030         16  MA-ADDRESS-LINE-2             PIC X(30).
  7031         16  MA-CITY-STATE.
  7032             20  MA-CITY                   PIC X(28).
  7033             20  MA-ADDR-STATE             PIC XX.
  7034         16  MA-ZIP.
  7035             20  MA-ZIP-CODE.
  7036                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7037                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7038                 24  FILLER                PIC X(4).
  7039             20  MA-ZIP-PLUS4              PIC X(4).
  7040         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7041             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7042             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7043             20  FILLER                    PIC X(3).
  7044
  7045         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7046
  7047         16  FILLER                        PIC XXX.
  7048*        16  FILLER                        PIC X(10).
  7049
  7050     12  MA-CRED-BENE-INFO.
  7051         16  MA-CRED-BENE-NAME                 PIC X(25).
  7052         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7053         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7054         16  MA-CRED-BENE-CTYST.
  7055             20  MA-CRED-BENE-CITY             PIC X(28).
  7056             20  MA-CRED-BENE-STATE            PIC XX.
  7057         16  MA-CRED-BENE-ZIP.
  7058             20  MA-CB-ZIP-CODE.
  7059                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 132
* EL130.cbl
  7060                     88  MA-CB-CANADIAN-POST-CODE
  7061                                           VALUE 'A' THRU 'Z'.
  7062                 24  FILLER                    PIC X(4).
  7063             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7064         16  MA-CB-CANADIAN-POSTAL-CODE
  7065                            REDEFINES MA-CRED-BENE-ZIP.
  7066             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7067             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7068             20  FILLER                        PIC X(3).
  7069     12  MA-POST-CARD-MAIL-DATA.
  7070         16  MA-MAIL-DATA OCCURS 7.
  7071             20  MA-MAIL-TYPE              PIC X.
  7072                 88  MA-12MO-MAILING           VALUE '1'.
  7073                 88  MA-EXP-MAILING            VALUE '2'.
  7074             20  MA-MAIL-STATUS            PIC X.
  7075                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7076                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7077                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7078             20  MA-MAIL-DATE              PIC XX.
  7079     12  FILLER                            PIC XX.
  7080     12  FILLER                            PIC XX.
  7081*    12  FILLER                            PIC X(30).
  7082******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 133
* EL130.cbl
  7084*    COPY ELCCRTT.
  7085******************************************************************
  7086*                                                                *
  7087*                            ELCCRTT.                            *
  7088*                                                                *
  7089*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7090*                                                                *
  7091*   FILE TYPE = VSAM,KSDS                                        *
  7092*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7093*                                                                *
  7094*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7095*                                                                *
  7096*   LOG = YES                                                    *
  7097*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7098******************************************************************
  7099*                   C H A N G E   L O G
  7100*
  7101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7102*-----------------------------------------------------------------
  7103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7104* EFFECTIVE    NUMBER
  7105*-----------------------------------------------------------------
  7106* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7107* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7108* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7109* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7110* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7111* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7112* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7113* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7114* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7115******************************************************************
  7116
  7117 01  CERTIFICATE-TRAILERS.
  7118     12  CS-RECORD-ID                      PIC XX.
  7119         88  VALID-CS-ID                      VALUE 'CS'.
  7120
  7121     12  CS-CONTROL-PRIMARY.
  7122         16  CS-COMPANY-CD                 PIC X.
  7123         16  CS-CARRIER                    PIC X.
  7124         16  CS-GROUPING                   PIC X(6).
  7125         16  CS-STATE                      PIC XX.
  7126         16  CS-ACCOUNT                    PIC X(10).
  7127         16  CS-CERT-EFF-DT                PIC XX.
  7128         16  CS-CERT-NO.
  7129             20  CS-CERT-PRIME             PIC X(10).
  7130             20  CS-CERT-SFX               PIC X.
  7131         16  CS-TRAILER-TYPE               PIC X.
  7132             88  COMM-TRLR           VALUE 'A'.
  7133             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7134             88  CERT-DATA-TRLR      VALUE 'C'.
  7135
  7136     12  CS-DATA-AREA                      PIC X(516).
  7137
  7138     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7139         16  CS-BANK-COMMISSION-AREA.
  7140             20  CS-BANK-COMMS       OCCURS 10.
  7141                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 134
* EL130.cbl
  7142                 24  CS-COM-TYP            PIC X.
  7143                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7144                 24  CS-RECALC-LV-INDIC    PIC X.
  7145                 24  FILLER                PIC X(10).
  7146         16  FILLER                        PIC X(256).
  7147
  7148     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7149****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7150         16  CS-MB-CLAIM-DATA OCCURS 24.
  7151             20  CS-CLAIM-NO               PIC X(7).
  7152             20  CS-CLAIM-TYPE             PIC X.
  7153                 88  CS-AH-CLM               VALUE 'A'.
  7154                 88  CS-IU-CLM               VALUE 'I'.
  7155                 88  CS-GP-CLM               VALUE 'G'.
  7156                 88  CS-LF-CLM               VALUE 'L'.
  7157                 88  CS-PR-CLM               VALUE 'P'.
  7158                 88  CS-FL-CLM               VALUE 'F'.
  7159             20  CS-INSURED-TYPE           PIC X.
  7160                 88  CS-PRIM-INSURED          VALUE 'P'.
  7161                 88  CS-CO-BORROWER           VALUE 'C'.
  7162             20  CS-BENEFIT-PERIOD         PIC 99.
  7163             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7164             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7165             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7166         16  FILLER                        PIC X(12).
  7167     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7168         16  CS-VIN-NUMBER                 PIC X(17).
  7169         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7170         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7171         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7172         16  cs-agent-name.
  7173             20  cs-agent-fname            pic x(20).
  7174             20  cs-agent-mi               pic x.
  7175             20  cs-agent-lname            pic x(25).
  7176         16  cs-license-no                 pic x(15).
  7177         16  cs-npn-number                 pic x(10).
  7178         16  cs-agent-edit-status          pic x.
  7179             88  cs-ae-refer-to-manager      value 'M'.
  7180             88  cs-ae-cover-sheet           value 'C'.
  7181             88  cs-ae-sig-form              value 'S'.
  7182             88  cs-ae-verified              value 'V'.
  7183             88  cs-unidentified-signature   value 'U'.
  7184             88  cs-cert-returned            value 'R'.
  7185             88  cs-accept-no-commission     value 'N'.
  7186         16  cs-year                       pic 9999.
  7187         16  cs-make                       pic x(20).
  7188         16  cs-model                      pic x(20).
  7189         16  cs-future                     pic x(20).
  7190         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7191         16  FILLER                        PIC X(356). *> was 420
  7192*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 135
* EL130.cbl
  7194
  7195 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7196                          CONTROL-FILE CERTIFICATE-MASTER
  7197                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7198                          BENEFICIARY-MASTER
  7199                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7200                          LETTER-ARCHIVE REINSURANCE-RECORD
  7201                          MAILING-DATA CERTIFICATE-TRAILERS.
  7202 0000-DFHEXIT SECTION.
  7203     MOVE '9#                    $   ' TO DFHEIV0.
  7204     MOVE 'EL130' TO DFHEIV1.
  7205     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7206     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7207     MOVE '5'                    TO DC-OPTION-CODE.
  7208     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7209     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7210     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7211
  7212     IF EIBCALEN = ZERO
  7213         GO TO 8800-UNAUTHORIZED-ACCESS
  7214     END-IF.
  7215
  7216     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7217     MOVE EIBTRMID               TO QID-TERM.
  7218     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7219     move spaces                 to emi-error-lines
  7220     MOVE '2'                    TO EMI-SWITCH2.
  7221     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7222     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7223
  7224
  7225* EXEC CICS HANDLE CONDITION
  7226*        QIDERR     (0100-TEST-ENTRY)
  7227*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7228*        PGMIDERR   (9600-PGMID-ERROR)
  7229*        TERMIDERR  (8820-TERM-ERROR)
  7230*        TRANSIDERR (8830-TRAN-ERROR)
  7231*        ERROR      (9990-ABEND)
  7232*    END-EXEC.
  7233*    MOVE '"$N?L[\.              ! " #00007220' TO DFHEIV0
  7234     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7236     MOVE X'2220233030303037323230' TO DFHEIV0(25:11)
  7237     CALL 'kxdfhei1' USING DFHEIV0
  7238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7239
  7240
  7241     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7242        PI-CALLING-PROGRAM   = XCTL-6592
  7243         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7244     ELSE
  7245         MOVE SPACES             TO RETURNED-FROM
  7246     END-IF.
  7247
  7248     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7249         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7250             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7251             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 136
* EL130.cbl
  7252             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7253             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7254             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7255             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7256             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7257             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7258         ELSE
  7259             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7260             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7261             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7262             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7263             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7264             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7265             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7266             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7267         END-IF
  7268     END-IF.
  7269
  7270     IF EIBTRNID = TRANS-ID
  7271         IF EIBAID = DFHCLEAR
  7272             GO TO 9400-CLEAR
  7273         ELSE
  7274             GO TO 0200-RECEIVE
  7275         END-IF
  7276     END-IF.
  7277
  7278     IF RETURNED-FROM NOT = SPACES
  7279         GO TO 0600-RECOVER-TEMP-STORAGE
  7280     END-IF.
  7281
  7282     MOVE LOW-VALUES TO EL130AO.
  7283     move zeros to pi-dcc-max-amt
  7284                   pi-dcc-max-benefits
  7285
  7286
  7287
  7288* EXEC CICS DELETEQ TS
  7289*         QUEUE   (QID)
  7290*    END-EXEC.
  7291*    MOVE '*&                    #   #00007275' TO DFHEIV0
  7292     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7293     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7294     MOVE X'2020233030303037323735' TO DFHEIV0(25:11)
  7295     CALL 'kxdfhei1' USING DFHEIV0,
  7296           QID,
  7297           DFHEIV99
  7298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7299
  7300
  7301 0100-TEST-ENTRY.
  7302     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7303         GO TO 0650-FROM-EL127
  7304     ELSE
  7305         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7306                                    PI-CERT-PROCESSED
  7307                                    PI-LETTER-ERROR-CODE
  7308     END-IF.
  7309
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 137
* EL130.cbl
  7310     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7311         GO TO 0640-FROM-EL132
  7312     END-IF.
  7313
  7314     GO TO 8100-SEND-INITIAL-MAP.
  7315
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 138
* EL130.cbl
  7317 0200-RECEIVE.
  7318     MOVE LOW-VALUES             TO EL130AI.
  7319
  7320     IF PI-PROCESSOR-ID = 'LGXX'
  7321*        NEXT SENTENCE
  7322         CONTINUE
  7323     ELSE
  7324
  7325* EXEC CICS READQ TS
  7326*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7327*            INTO    (SECURITY-CONTROL)
  7328*            LENGTH  (SC-COMM-LENGTH)
  7329*            ITEM    (SC-ITEM)
  7330*        END-EXEC
  7331*    MOVE '*$II   L              ''   #00007302' TO DFHEIV0
  7332     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7333     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7334     MOVE X'2020233030303037333032' TO DFHEIV0(25:11)
  7335     CALL 'kxdfhei1' USING DFHEIV0,
  7336           PI-SECURITY-TEMP-STORE-ID,
  7337           SECURITY-CONTROL,
  7338           SC-COMM-LENGTH,
  7339           SC-ITEM,
  7340           DFHEIV99,
  7341           DFHEIV99
  7342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7343         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7344         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7345         IF NOT DISPLAY-CAP
  7346             MOVE 'READ'              TO  SM-READ
  7347             PERFORM 9995-SECURITY-VIOLATION
  7348             MOVE ER-0070             TO  EMI-ERROR
  7349             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7350             GO TO 8100-SEND-INITIAL-MAP
  7351         END-IF
  7352     END-IF.
  7353
  7354     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7355         MOVE ER-7008 TO EMI-ERROR
  7356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7357         MOVE -1 TO MAINTL
  7358         GO TO 8200-SEND-DATAONLY
  7359     END-IF.
  7360
  7361
  7362
  7363* EXEC CICS RECEIVE
  7364*         MAP     (MAP-NAME)
  7365*         MAPSET  (MAPSET-NAME)
  7366*         INTO    (EL130AI)
  7367*    END-EXEC.
  7368     MOVE LENGTH OF
  7369      EL130AI
  7370       TO DFHEIV11
  7371*    MOVE '8"T I  L              ''   #00007327' TO DFHEIV0
  7372     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7373     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7374     MOVE X'2020233030303037333237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 139
* EL130.cbl
  7375     CALL 'kxdfhei1' USING DFHEIV0,
  7376           MAP-NAME,
  7377           EL130AI,
  7378           DFHEIV11,
  7379           MAPSET-NAME,
  7380           DFHEIV99,
  7381           DFHEIV99
  7382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7383
  7384
  7385     IF NOT PI-NO-CARRIER-SECURITY
  7386        MOVE +1                  TO CLMCARRL
  7387        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7388     END-IF.
  7389
  7390     IF ENTERPFL = ZERO
  7391         GO TO 0300-CHECK-PFKEYS
  7392     END-IF.
  7393
  7394     IF EIBAID NOT = DFHENTER
  7395         MOVE ER-0004            TO EMI-ERROR
  7396         GO TO 0320-INPUT-ERROR
  7397     END-IF.
  7398
  7399     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7400         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7401     ELSE
  7402         MOVE ER-0029            TO EMI-ERROR
  7403         GO TO 0320-INPUT-ERROR
  7404     END-IF.
  7405
  7406 0300-CHECK-PFKEYS.
  7407     IF EIBAID = DFHPF23
  7408         GO TO 8810-PF23
  7409     END-IF.
  7410
  7411     IF EIBAID = DFHPF24
  7412         GO TO 9200-RETURN-MAIN-MENU
  7413     END-IF.
  7414
  7415     IF EIBAID = DFHPF12
  7416         GO TO 9500-PF12
  7417     END-IF.
  7418
  7419     IF EIBAID = DFHPF3
  7420         MOVE SPACES              TO MAINTI
  7421         MOVE ZEROS               TO MAINTL
  7422         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7423         MOVE XCTL-127            TO PGM-NAME
  7424         GO TO 9300-XCTL
  7425     END-IF.
  7426
  7427     IF EIBAID = DFHPF4
  7428         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7429         MOVE XCTL-132            TO PGM-NAME
  7430         GO TO 9300-XCTL
  7431     END-IF.
  7432
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 140
* EL130.cbl
  7433     IF EIBAID = DFHPF13
  7434         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7435             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7436             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7437             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7438             MOVE PI-STATE            TO  PI-CR-STATE
  7439             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7440             MOVE XCTL-650            TO  PGM-NAME
  7441             GO TO 9300-XCTL
  7442         ELSE
  7443             MOVE -1                  TO  ENTERPFL
  7444             MOVE ER-2566             TO  EMI-ERROR
  7445             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7446             GO TO 8100-SEND-INITIAL-MAP
  7447         END-IF
  7448     END-IF.
  7449
  7450     IF EIBAID = DFHPF5
  7451         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7452             ADD +1 TO PI-CERT-PROCESSED
  7453             GO TO 0650-FROM-EL127
  7454         ELSE
  7455             MOVE ER-7686         TO EMI-ERROR
  7456             GO TO 0320-INPUT-ERROR
  7457         END-IF
  7458     END-IF.
  7459
  7460     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7461         GO TO 0800-TEST-PREVIOUS-CONTROL
  7462     END-IF.
  7463
  7464     IF PI-HAS-CLAS-IC-CRDTCRD
  7465         IF EIBAID = DFHPF10
  7466             MOVE XCTL-725          TO PGM-NAME
  7467             GO TO 9300-XCTL
  7468         END-IF
  7469     END-IF.
  7470
  7471     IF EIBAID = DFHPF14
  7472         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7473         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7474         MOVE XCTL-659            TO PGM-NAME
  7475         GO TO 9300-XCTL
  7476     END-IF.
  7477
  7478     IF EIBAID = DFHPF15
  7479         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7480         MOVE XCTL-114            TO PGM-NAME
  7481         GO TO 9300-XCTL
  7482     END-IF.
  7483
  7484*    IF EIBAID = DFHPF11
  7485*       GO TO 0600-RECOVER-TEMP-STORAGE
  7486*    END-IF
  7487     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7488         GO TO 0330-EDIT-DATA
  7489     END-IF.
  7490
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 141
* EL130.cbl
  7491     MOVE ER-0029                TO EMI-ERROR.
  7492
  7493 0320-INPUT-ERROR.
  7494     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7495
  7496     MOVE AL-UNBON               TO ENTERPFA.
  7497
  7498     IF ENTERPFL = ZERO
  7499         MOVE -1                 TO MAINTL
  7500     ELSE
  7501         MOVE -1                 TO ENTERPFL
  7502     END-IF.
  7503
  7504     GO TO 8200-SEND-DATAONLY.
  7505
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 142
* EL130.cbl
  7507 0330-EDIT-DATA.
  7508
  7509     IF MAINTI = 'S'
  7510         IF PRTOPTL GREATER THAN 0
  7511             IF PRTOPTI NOT = 'N' AND 'L'
  7512                 MOVE AL-UABON   TO  PRTOPTA
  7513                 MOVE -1         TO  PRTOPTL
  7514                 MOVE ER-0334    TO  EMI-ERROR
  7515                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7516                 GO TO 8200-SEND-DATAONLY
  7517             ELSE
  7518                 IF PRTOPTI = 'L'
  7519                     GO TO 0400-CREATE-ELACTQ
  7520                 ELSE
  7521                     GO TO 0480-PRINT-NOW
  7522                 END-IF
  7523             END-IF
  7524         ELSE
  7525             GO TO 1000-SHOW-CLAIM
  7526         END-IF
  7527     END-IF.
  7528
  7529     IF NOT MODIFY-CAP
  7530         MOVE 'UPDATE'       TO  SM-READ
  7531         PERFORM 9995-SECURITY-VIOLATION
  7532         MOVE ER-0070        TO  EMI-ERROR
  7533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7534         GO TO 8100-SEND-INITIAL-MAP
  7535     END-IF.
  7536
  7537     IF MAINTI = 'D'
  7538         GO TO 2000-DELETE-CLAIM
  7539     END-IF.
  7540
  7541     IF MAINTI = 'A'
  7542         GO TO 3000-ADD-CLAIM
  7543     END-IF.
  7544
  7545     IF MAINTI = 'I'
  7546         GO TO 5000-INCURRED-CHANGE
  7547     END-IF.
  7548
  7549     MOVE ER-0023                TO EMI-ERROR.
  7550     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7551     MOVE -1                     TO MAINTL.
  7552     MOVE AL-UABON               TO MAINTA.
  7553
  7554     GO TO 8200-SEND-DATAONLY.
  7555
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 143
* EL130.cbl
  7557 0400-CREATE-ELACTQ.
  7558     IF CLMNOI   = PI-LAST-CLAIM      AND
  7559        CLMCARRI = PI-LAST-CARR       AND
  7560        CERTNOI  = PI-LAST-CERT-PRIME AND
  7561        SUFXI    = PI-LAST-CERT-SUFX
  7562         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7563         MOVE PI-LAST-CARR       TO PI-CARRIER
  7564         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7565     ELSE
  7566         MOVE ER-0207            TO EMI-ERROR
  7567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7568         MOVE -1                 TO MAINTL
  7569         GO TO 8200-SEND-DATAONLY
  7570     END-IF.
  7571
  7572     IF (NOT PI-NO-CARRIER-SECURITY OR
  7573         NOT PI-NO-ACCOUNT-SECURITY)
  7574         MOVE AL-UABON      TO  PRTOPTA
  7575         MOVE -1            TO  PRTOPTL
  7576         MOVE ER-2378       TO  EMI-ERROR
  7577         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7578         GO TO 8200-SEND-DATAONLY
  7579     END-IF.
  7580
  7581     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7582     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7583     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7584     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7585
  7586
  7587
  7588* EXEC CICS HANDLE CONDITION
  7589*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7590*    END-EXEC.
  7591*    MOVE '"$I                   ! # #00007535' TO DFHEIV0
  7592     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7593     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7594     MOVE X'2320233030303037353335' TO DFHEIV0(25:11)
  7595     CALL 'kxdfhei1' USING DFHEIV0
  7596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7597
  7598
  7599
  7600
  7601* EXEC CICS READ
  7602*         UPDATE
  7603*         DATASET    (ELACTQ-DSID)
  7604*         SET        (ADDRESS OF ACTIVITY-QUE)
  7605*         RIDFLD     (ELACTQ-KEY)
  7606*    END-EXEC.
  7607*    MOVE '&"S        EU         (   #00007540' TO DFHEIV0
  7608     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7609     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7610     MOVE X'2020233030303037353430' TO DFHEIV0(25:11)
  7611     CALL 'kxdfhei1' USING DFHEIV0,
  7612           ELACTQ-DSID,
  7613           DFHEIV20,
  7614           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 144
* EL130.cbl
  7615           ELACTQ-KEY,
  7616           DFHEIV99,
  7617           DFHEIV99,
  7618           DFHEIV99
  7619     SET ADDRESS OF ACTIVITY-QUE TO
  7620         DFHEIV20
  7621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7622
  7623
  7624     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7625     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7626
  7627
  7628
  7629* EXEC CICS REWRITE
  7630*         DATASET     (ELACTQ-DSID)
  7631*         FROM        (ACTIVITY-QUE)
  7632*    END-EXEC.
  7633     MOVE LENGTH OF
  7634      ACTIVITY-QUE
  7635       TO DFHEIV11
  7636*    MOVE '&& L                  %   #00007551' TO DFHEIV0
  7637     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7638     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7639     MOVE X'2020233030303037353531' TO DFHEIV0(25:11)
  7640     CALL 'kxdfhei1' USING DFHEIV0,
  7641           ELACTQ-DSID,
  7642           ACTIVITY-QUE,
  7643           DFHEIV11,
  7644           DFHEIV99
  7645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7646
  7647
  7648     GO TO 0470-STATUS-FINISH.
  7649
  7650 0450-ADD-ELACTQ-RECORD.
  7651
  7652
  7653* EXEC CICS GETMAIN
  7654*        SET     (ADDRESS OF ACTIVITY-QUE)
  7655*        LENGTH  (ELACTQ-LENGTH)
  7656*        INITIMG (GETMAIN-SPACE)
  7657*    END-EXEC.
  7658*    MOVE ',"IL                  $   #00007560' TO DFHEIV0
  7659     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7660     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7661     MOVE X'2020233030303037353630' TO DFHEIV0(25:11)
  7662     CALL 'kxdfhei1' USING DFHEIV0,
  7663           DFHEIV20,
  7664           ELACTQ-LENGTH,
  7665           GETMAIN-SPACE
  7666     SET ADDRESS OF ACTIVITY-QUE TO
  7667         DFHEIV20
  7668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7669
  7670
  7671     MOVE 'AQ'              TO AQ-RECORD-ID.
  7672     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 145
* EL130.cbl
  7673     MOVE +0                TO AQ-PAYMENT-COUNTER
  7674                               AQ-PMT-UNAPPROVED-COUNT.
  7675     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7676                               AQ-FOLLOWUP-DATE.
  7677     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7678     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7679
  7680
  7681
  7682* EXEC CICS WRITE
  7683*         DATASET     (ELACTQ-DSID)
  7684*         FROM        (ACTIVITY-QUE)
  7685*         RIDFLD      (ELACTQ-KEY)
  7686*    END-EXEC.
  7687     MOVE LENGTH OF
  7688      ACTIVITY-QUE
  7689       TO DFHEIV11
  7690*    MOVE '&$ L                  ''   #00007576' TO DFHEIV0
  7691     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7693     MOVE X'2020233030303037353736' TO DFHEIV0(25:11)
  7694     CALL 'kxdfhei1' USING DFHEIV0,
  7695           ELACTQ-DSID,
  7696           ACTIVITY-QUE,
  7697           DFHEIV11,
  7698           ELACTQ-KEY,
  7699           DFHEIV99,
  7700           DFHEIV99
  7701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7702
  7703
  7704 0470-STATUS-FINISH.
  7705     MOVE AL-UANOF               TO  PRTOPTA
  7706                                     ALTPRTA.
  7707
  7708     MOVE SPACES                 TO  PRTOPTO
  7709                                     ALTPRTO.
  7710
  7711     MOVE ER-0000                TO EMI-ERROR.
  7712     MOVE -1                     TO MAINTL.
  7713     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7714     GO TO 8100-SEND-INITIAL-MAP.
  7715
  7716 0480-PRINT-NOW.
  7717
  7718
  7719* EXEC CICS HANDLE CONDITION
  7720*        TERMIDERR   (8820-TERM-ERROR)
  7721*        TRANSIDERR  (8830-TRAN-ERROR)
  7722*    END-EXEC.
  7723*    MOVE '"$[\                  ! $ #00007596' TO DFHEIV0
  7724     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7726     MOVE X'2420233030303037353936' TO DFHEIV0(25:11)
  7727     CALL 'kxdfhei1' USING DFHEIV0
  7728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7729
  7730
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 146
* EL130.cbl
  7731     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7732     MOVE '1'                    TO  CNTL-REC-TYPE.
  7733     MOVE SPACES                 TO  CNTL-ACCESS.
  7734     MOVE +0                     TO  CNTL-SEQ-NO.
  7735     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7736
  7737     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7738
  7739     IF CF-FORMS-PRINTER-ID = SPACES
  7740         IF ALTPRTL NOT GREATER THAN 0
  7741             MOVE ER-0337        TO  EMI-ERROR
  7742             MOVE -1             TO  ALTPRTL
  7743             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7744             GO TO 8200-SEND-DATAONLY
  7745         END-IF
  7746     END-IF.
  7747
  7748     IF ALTPRTL GREATER THAN 0
  7749         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7750     END-IF.
  7751
  7752     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7753     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7754     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7755
  7756
  7757
  7758* EXEC CICS START
  7759*        TRANSID   (START-TRANS-ID)
  7760*        TERMID    (CF-FORMS-PRINTER-ID)
  7761*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7762*        LENGTH    (PI-COMM-LENGTH)
  7763*    END-EXEC.
  7764*    MOVE '0( LFT                1   #00007627' TO DFHEIV0
  7765     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7766     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7767     MOVE X'2020233030303037363237' TO DFHEIV0(25:11)
  7768     CALL 'kxdfhei1' USING DFHEIV0,
  7769           DFHEIV99,
  7770           START-TRANS-ID,
  7771           DFHEIV99,
  7772           PROGRAM-INTERFACE-BLOCK,
  7773           PI-COMM-LENGTH,
  7774           CF-FORMS-PRINTER-ID,
  7775           DFHEIV99,
  7776           DFHEIV99,
  7777           DFHEIV99,
  7778           DFHEIV99,
  7779           DFHEIV99,
  7780           DFHEIV99,
  7781           DFHEIV99,
  7782           DFHEIV99,
  7783           DFHEIV99,
  7784           DFHEIV99
  7785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7786
  7787
  7788     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 147
* EL130.cbl
  7789                                     ALTPRTA.
  7790
  7791     MOVE SPACES                 TO  PRTOPTO
  7792                                     ALTPRTO.
  7793
  7794     MOVE ER-0000                TO  EMI-ERROR.
  7795     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7796     MOVE -1                     TO  MAINTL.
  7797     GO TO 8100-SEND-INITIAL-MAP.
  7798
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 148
* EL130.cbl
  7800 0500-CREATE-TEMP-STORAGE.
  7801     MOVE EIBCPOSN               TO PI-CURSOR.
  7802
  7803    move emi-line1               to errmsg1o
  7804    move emi-line2               to errmsg2o
  7805    move emi-sub                 to pi-emi-sub
  7806
  7807
  7808* EXEC CICS WRITEQ TS
  7809*        QUEUE   (QID)
  7810*        FROM    (EL130AI)
  7811*        LENGTH  (QID-MAP-LENGTH)
  7812*    END-EXEC.
  7813*    MOVE '*"     L              ''   #00007653' TO DFHEIV0
  7814     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7815     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7816     MOVE X'2020233030303037363533' TO DFHEIV0(25:11)
  7817     CALL 'kxdfhei1' USING DFHEIV0,
  7818           QID,
  7819           EL130AI,
  7820           QID-MAP-LENGTH,
  7821           DFHEIV99,
  7822           DFHEIV99,
  7823           DFHEIV99
  7824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7825
  7826
  7827
  7828
  7829* EXEC CICS WRITEQ TS
  7830*        QUEUE    (QID)
  7831*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7832*        LENGTH   (PI-COMM-LENGTH)
  7833*    END-EXEC.
  7834*    MOVE '*"     L              ''   #00007660' TO DFHEIV0
  7835     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7837     MOVE X'2020233030303037363630' TO DFHEIV0(25:11)
  7838     CALL 'kxdfhei1' USING DFHEIV0,
  7839           QID,
  7840           PROGRAM-INTERFACE-BLOCK,
  7841           PI-COMM-LENGTH,
  7842           DFHEIV99,
  7843           DFHEIV99,
  7844           DFHEIV99
  7845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7846
  7847
  7848 0599-EXIT.
  7849      EXIT.
  7850
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 149
* EL130.cbl
  7852 0600-RECOVER-TEMP-STORAGE.
  7853     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7854     MOVE PI-EL127-TO-EL130-CNTRL
  7855                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7856     MOVE PI-EL659-TO-EL130-CNTRL
  7857                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7858     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7859     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7860     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7861     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7862     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7863     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7864     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7865     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7866     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7867     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7868     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7869     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7870     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7871     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7872     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7873     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7874                                 TO SAVE-BENEFICIARY
  7875
  7876
  7877
  7878* EXEC CICS HANDLE CONDITION
  7879*        NOTFND  (0660-NOT-FOUND)
  7880*        QIDERR  (0670-QIDERR)
  7881*    END-EXEC.
  7882*    MOVE '"$IN                  ! % #00007695' TO DFHEIV0
  7883     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7885     MOVE X'2520233030303037363935' TO DFHEIV0(25:11)
  7886     CALL 'kxdfhei1' USING DFHEIV0
  7887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7888
  7889
  7890
  7891
  7892* EXEC CICS READQ TS
  7893*        QUEUE    (QID)
  7894*        INTO     (EL130AI)
  7895*        LENGTH   (QID-MAP-LENGTH)
  7896*    END-EXEC.
  7897*    MOVE '*$I    L              ''   #00007701' TO DFHEIV0
  7898     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7899     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7900     MOVE X'2020233030303037373031' TO DFHEIV0(25:11)
  7901     CALL 'kxdfhei1' USING DFHEIV0,
  7902           QID,
  7903           EL130AI,
  7904           QID-MAP-LENGTH,
  7905           DFHEIV99,
  7906           DFHEIV99,
  7907           DFHEIV99
  7908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7909
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 150
* EL130.cbl
  7910
  7911     IF RETURNED-FROM = XCTL-131
  7912        IF CLAIM-DELETED-BY-EL131
  7913            MOVE LOW-VALUES      TO CERTNOI
  7914                                    SUFXI
  7915            MOVE ZEROS           TO CERTNOL
  7916                                    SUFXL
  7917         END-IF
  7918     END-IF.
  7919
  7920     IF RETURNED-FROM = XCTL-131
  7921         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7922         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7923                                    PI-CERT-PROCESSED
  7924     ELSE
  7925
  7926
  7927* EXEC CICS READQ TS
  7928*             QUEUE   (QID)
  7929*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7930*             LENGTH  (PI-COMM-LENGTH)
  7931*        END-EXEC
  7932*    MOVE '*$I    L              ''   #00007722' TO DFHEIV0
  7933     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7934     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7935     MOVE X'2020233030303037373232' TO DFHEIV0(25:11)
  7936     CALL 'kxdfhei1' USING DFHEIV0,
  7937           QID,
  7938           PROGRAM-INTERFACE-BLOCK,
  7939           PI-COMM-LENGTH,
  7940           DFHEIV99,
  7941           DFHEIV99,
  7942           DFHEIV99
  7943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7944     END-IF.
  7945
  7946
  7947* EXEC CICS DELETEQ TS
  7948*        QUEUE   (QID)
  7949*    END-EXEC.
  7950*    MOVE '*&                    #   #00007729' TO DFHEIV0
  7951     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7952     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7953     MOVE X'2020233030303037373239' TO DFHEIV0(25:11)
  7954     CALL 'kxdfhei1' USING DFHEIV0,
  7955           QID,
  7956           DFHEIV99
  7957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7958
  7959
  7960     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7961
  7962     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7963         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7964         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7965         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7966         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7967         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 151
* EL130.cbl
  7968         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7969         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7970         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7971         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7972         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7973         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7974         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7975         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7976         MOVE SAVE-CERT-ACCESS-CONTROL
  7977                                    TO PI-CERT-ACCESS-CONTROL
  7978         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7979                                    TO PI-CARRIER-CONTROL-LEVEL
  7980     END-IF.
  7981
  7982*    IF EIBAID = DFHPF11
  7983*       move errmsg1i            to emi-line1
  7984*       move errmsg2i            to emi-line2
  7985*       move pi-emi-sub          to emi-sub
  7986*       go to 8200-SEND-DATAONLY
  7987*    end-if
  7988     IF RETURNED-FROM = XCTL-127
  7989         MOVE SAVE-EL127-TO-EL130-CNTRL
  7990                                 TO PI-EL127-TO-EL130-CNTRL
  7991     END-IF.
  7992
  7993     IF RETURNED-FROM = XCTL-6592
  7994        MOVE SAVE-EL659-TO-EL130-CNTRL
  7995                                 TO PI-EL659-TO-EL130-CNTRL
  7996     END-IF.
  7997
  7998     IF RETURNED-FROM = XCTL-114
  7999        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  8000           MOVE SAVE-BENEFICIARY TO BENECDI
  8001           MOVE +10              TO BENECDL
  8002           MOVE -1               TO BIRTHDTL
  8003        END-IF
  8004     END-IF.
  8005     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  8006
  8007     IF MAINTL NOT = ZERO
  8008         MOVE AL-UANON           TO MAINTA
  8009     END-IF.
  8010
  8011     IF ENTERPFL NOT = ZERO
  8012         MOVE AL-UNNON           TO ENTERPFA
  8013     END-IF.
  8014
  8015     IF RETURNED-FROM = XCTL-127
  8016         GO TO 0650-FROM-EL127
  8017     END-IF.
  8018
  8019     IF RETURNED-FROM = XCTL-132
  8020         GO TO 0640-FROM-EL132
  8021     END-IF.
  8022
  8023     IF RETURNED-FROM = XCTL-650
  8024         MOVE AL-SABON           TO PF5A
  8025         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 152
* EL130.cbl
  8026     END-IF.
  8027
  8028     IF RETURNED-FROM = XCTL-6592
  8029         GO TO 0630-FROM-EL6592
  8030     END-IF.
  8031
  8032     IF MAINTI = 'S' OR 'I'
  8033        GO TO 1000-SHOW-CLAIM
  8034     END-IF.
  8035
  8036     GO TO 8100-SEND-INITIAL-MAP.
  8037
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 153
* EL130.cbl
  8039 0630-FROM-EL6592.
  8040     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  8041     MOVE PI-EL659-GROUPING      TO GROUPO.
  8042     MOVE PI-EL659-STATE         TO STATEO.
  8043     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  8044
  8045     MOVE AL-UANON               TO CRTCARRA
  8046                                    GROUPA
  8047                                    STATEA
  8048                                    ACCOUNTA.
  8049     GO TO 8100-SEND-INITIAL-MAP.
  8050
  8051 0640-FROM-EL132.
  8052     IF PI-CLAIM-NO = SPACES
  8053         GO TO 0645-NO-CLAIM-SELECTED
  8054     END-IF.
  8055
  8056     MOVE LOW-VALUES             TO EL130AI.
  8057     MOVE 'MSTR'                 TO FILE-SWITCH.
  8058     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8059     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8060     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  8061                                    CLMNOO.
  8062     MOVE AL-UANON               TO CLMNOA.
  8063     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8064
  8065
  8066
  8067* EXEC CICS HANDLE CONDITION
  8068*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8069*    END-EXEC.
  8070*    MOVE '"$I                   ! & #00007839' TO DFHEIV0
  8071     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8073     MOVE X'2620233030303037383339' TO DFHEIV0(25:11)
  8074     CALL 'kxdfhei1' USING DFHEIV0
  8075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8076
  8077
  8078     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8079     MOVE 'X'                    TO CLAIM-SWITCH.
  8080     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8081     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8082     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8083     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8084     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8085     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8086
  8087     MOVE ER-0213                TO EMI-ERROR.
  8088     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8089     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8090     GO TO 8100-SEND-INITIAL-MAP.
  8091
  8092 0645-NO-CLAIM-SELECTED.
  8093
  8094     IF MAINTI = 'S' OR 'I'
  8095        GO TO 1000-SHOW-CLAIM
  8096     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 154
* EL130.cbl
  8097
  8098     GO TO 8100-SEND-INITIAL-MAP.
  8099
  8100 0650-FROM-EL127.
  8101
  8102     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8103         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8104                                    PI-CERT-PROCESSED
  8105     END-IF.
  8106
  8107     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8108         MOVE +1                 TO PI-CERT-SELECT-CNT
  8109                                    PI-CERT-PROCESSED
  8110         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8111         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8112         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8113         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8114         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8115         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8116     END-IF.
  8117
  8118     IF PI-CERT-SELECT-CNT = ZERO
  8119         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8120             MOVE CERTNOI        TO PI-CERT-NO
  8121             MOVE SUFXI          TO PI-CERT-SFX
  8122             GO TO 3000-READ-CERT
  8123         ELSE
  8124             GO TO 8100-SEND-INITIAL-MAP
  8125         END-IF
  8126     END-IF.
  8127
  8128     MOVE AL-SABON               TO PF5A.
  8129
  8130     IF PI-CERT-PROCESSED = 1
  8131         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8132     END-IF.
  8133
  8134     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8135     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8136
  8137     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8138     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8139                                 TO CERT-CARRIER
  8140                                    PI-CARRIER.
  8141     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8142                                 TO CERT-GROUPING
  8143                                    PI-GROUPING.
  8144     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8145                                 TO CERT-STATE
  8146                                    PI-STATE.
  8147     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8148                                 TO CERT-ACCOUNT
  8149                                    PI-ACCOUNT.
  8150     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8151                                 TO CERT-EFF-DT
  8152                                    PI-CERT-EFF-DT.
  8153     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8154                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 155
* EL130.cbl
  8155                                    PI-CERT-NO.
  8156
  8157     MOVE 'CERT'                 TO FILE-SWITCH.
  8158     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8159
  8160     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8161     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8162     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8163
  8164     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8165         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8166         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8167         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8168         IF INCURRED-DATE-MATCH
  8169             MOVE ER-7352        TO EMI-ERROR
  8170             MOVE -1             TO CERTNOL
  8171             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8172         ELSE
  8173             IF NO-CLAIMS-FOR-CERT
  8174                 MOVE ER-7353    TO EMI-ERROR
  8175                 MOVE -1         TO CERTNOL
  8176                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8177             ELSE
  8178                 MOVE ER-0558    TO EMI-ERROR
  8179                 MOVE -1         TO CERTNOL
  8180                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8181             END-IF
  8182         END-IF
  8183     END-IF.
  8184
  8185     MOVE SPACES                 TO PI-PRT-OPT
  8186                                    PI-ALT-PRT.
  8187
  8188     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8189
  8190     if (ws-lf-joint-indicator not = 'J')
  8191        and (ws-ah-joint-indicator not = 'J')
  8192        move 'P'                 to INSTYPEO
  8193        MOVE AL-UANON            TO INSTYPEA
  8194     end-if
  8195     IF LSTNMEL NOT GREATER ZERO
  8196        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8197         MOVE CRTLNMEI           TO  LSTNMEO
  8198         MOVE CRTFNMEI           TO  FSTNMEO
  8199         MOVE CRTINITI           TO  INITO
  8200         MOVE AL-UANON           TO  LSTNMEA
  8201                                     FSTNMEA
  8202                                     INITA
  8203     END-IF.
  8204
  8205     IF SSNL GREATER ZERO
  8206         GO TO 0655-SKIP-SOCIAL-SECURITY
  8207     END-IF.
  8208
  8209     IF CRTSSNI = SPACES OR LOW-VALUES
  8210         GO TO 0655-SKIP-SOCIAL-SECURITY
  8211     END-IF.
  8212
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 156
* EL130.cbl
  8213     IF CM-SSN-STATE   = CM-STATE AND
  8214        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8215            GO TO 0655-SKIP-SOCIAL-SECURITY
  8216     END-IF.
  8217
  8218     MOVE CRTSSNI                TO SSNO
  8219     MOVE AL-UANON               TO SSNA.
  8220
  8221 0655-SKIP-SOCIAL-SECURITY.
  8222
  8223     IF CLMCARRL NOT = ZERO  AND
  8224        CLMCARRI NOT = CRTCARRI
  8225        MOVE ER-0562             TO EMI-ERROR
  8226        MOVE AL-UABON            TO CLMCARRA
  8227        MOVE -1                  TO CLMCARRL
  8228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8229     END-IF.
  8230
  8231     IF CLMCARRL = ZERO
  8232        MOVE AL-UANON            TO CLMCARRA
  8233        MOVE CRTCARRI            TO CLMCARRI
  8234     END-IF.
  8235
  8236     MOVE 'A'                    TO MAINTO.
  8237     MOVE AL-UANON               TO MAINTA.
  8238
  8239     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8240        GO TO 8100-SEND-INITIAL-MAP
  8241     ELSE
  8242        GO TO 8150-SEND-MAP-CURSOR
  8243     END-IF.
  8244
  8245 0660-NOT-FOUND.
  8246     MOVE ER-0214                TO EMI-ERROR.
  8247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8248     GO TO 8100-SEND-INITIAL-MAP.
  8249
  8250 0670-QIDERR.
  8251     MOVE ER-0033                TO EMI-ERROR.
  8252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8253     GO TO 8100-SEND-INITIAL-MAP.
  8254
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 157
* EL130.cbl
  8256 0680-PLUG-SELECTED-CERTS.
  8257
  8258     MOVE AL-SANON               TO BCERT1A
  8259                                    BSUFX1A
  8260                                    BCERT2A
  8261                                    BSUFX2A
  8262                                    BCERT3A
  8263                                    BSUFX3A
  8264                                    BCERT4A
  8265                                    BSUFX4A
  8266                                    BCERT5A
  8267                                    BSUFX5A.
  8268
  8269     IF PCERTNOO = SPACES OR LOW-VALUES
  8270         MOVE PI-EL127-CERT-PRIME (1)
  8271                                 TO PCERTNOO
  8272         MOVE PI-EL127-CERT-SUFX  (1)
  8273                                 TO PSUFXO
  8274     END-IF.
  8275
  8276     MOVE PI-EL127-CERT-PRIME (1)
  8277                                 TO BCERT1O.
  8278     MOVE PI-EL127-CERT-SUFX  (1)
  8279                                 TO BSUFX1O.
  8280
  8281     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8282         MOVE PI-EL127-CERT-PRIME (2)
  8283                                 TO BCERT2O
  8284         MOVE PI-EL127-CERT-SUFX  (2)
  8285                                 TO BSUFX2O
  8286     ELSE
  8287         MOVE LOW-VALUES         TO BCERT2O
  8288                                    BSUFX2O
  8289     END-IF.
  8290
  8291     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8292         MOVE PI-EL127-CERT-PRIME (3)
  8293                                 TO BCERT3O
  8294         MOVE PI-EL127-CERT-SUFX  (3)
  8295                                 TO BSUFX3O
  8296     ELSE
  8297         MOVE LOW-VALUES         TO BCERT3O
  8298                                    BSUFX3O
  8299     END-IF.
  8300
  8301     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8302         MOVE PI-EL127-CERT-PRIME (4)
  8303                                 TO BCERT4O
  8304         MOVE PI-EL127-CERT-SUFX  (4)
  8305                                 TO BSUFX4O
  8306     ELSE
  8307         MOVE LOW-VALUES         TO BCERT4O
  8308                                    BSUFX4O
  8309     END-IF.
  8310
  8311     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8312         MOVE PI-EL127-CERT-PRIME (5)
  8313                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 158
* EL130.cbl
  8314         MOVE PI-EL127-CERT-SUFX  (5)
  8315                                 TO BSUFX5O
  8316     ELSE
  8317         MOVE LOW-VALUES         TO BCERT5O
  8318                                    BSUFX5O
  8319     END-IF.
  8320
  8321 0680-EXIT.
  8322     EXIT.
  8323
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 159
* EL130.cbl
  8325 0690-HIGHLIGHT-CERTS.
  8326
  8327     MOVE AL-UANON               TO PCERTNOA
  8328                                    PSUFXA.
  8329
  8330     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8331        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8332            MOVE AL-SABON        TO BCERT1A
  8333                                    BSUFX1A
  8334     ELSE
  8335         MOVE AL-SANON           TO BCERT1A
  8336                                    BSUFX1A
  8337     END-IF.
  8338
  8339     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8340        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8341            MOVE AL-SABON        TO BCERT2A
  8342                                    BSUFX2A
  8343     ELSE
  8344         MOVE AL-SANON           TO BCERT2A
  8345                                    BSUFX2A
  8346     END-IF.
  8347
  8348     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8349        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8350            MOVE AL-SABON        TO BCERT3A
  8351                                    BSUFX3A
  8352     ELSE
  8353         MOVE AL-SANON           TO BCERT3A
  8354                                    BSUFX3A
  8355     END-IF.
  8356
  8357     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8358        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8359            MOVE AL-SABON        TO BCERT4A
  8360                                    BSUFX4A
  8361     ELSE
  8362         MOVE AL-SANON           TO BCERT4A
  8363                                    BSUFX4A
  8364     END-IF.
  8365
  8366     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8367        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8368            MOVE AL-SABON        TO BCERT5A
  8369                                    BSUFX5A
  8370     ELSE
  8371         MOVE AL-SANON           TO BCERT5A
  8372                                    BSUFX5A
  8373     END-IF.
  8374
  8375 0690-EXIT.
  8376     EXIT.
  8377
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 160
* EL130.cbl
  8379 0800-TEST-PREVIOUS-CONTROL.
  8380     IF CLMNOI   = PI-LAST-CLAIM       AND
  8381        CLMCARRI = PI-LAST-CARR        AND
  8382        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8383        SUFXI    = PI-LAST-CERT-SUFX
  8384*        NEXT SENTENCE
  8385         CONTINUE
  8386     ELSE
  8387         MOVE ER-0207            TO EMI-ERROR
  8388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8389         MOVE -1                 TO MAINTL
  8390         GO TO 8200-SEND-DATAONLY
  8391     END-IF.
  8392
  8393     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8394
  8395     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8396     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8397     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8398
  8399     IF EIBAID = DFHPF7
  8400         MOVE XCTL-157           TO PGM-NAME
  8401     END-IF.
  8402
  8403     IF EIBAID = DFHPF8
  8404         MOVE XCTL-141           TO PGM-NAME
  8405     END-IF.
  8406
  8407     IF EIBAID = DFHPF9
  8408        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8409                                    PI-SAVED-PROGRAM-2
  8410                                    PI-SAVED-PROGRAM-3
  8411                                    PI-SAVED-PROGRAM-4
  8412                                    PI-SAVED-PROGRAM-5
  8413                                    PI-SAVED-PROGRAM-6
  8414        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8415        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8416        MOVE XCTL-150            TO PGM-NAME
  8417     END-IF.
  8418
  8419     GO TO 9300-XCTL.
  8420
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 161
* EL130.cbl
  8422 1000-SHOW-CLAIM.
  8423
  8424     IF CLMNOL = ZERO
  8425         MOVE -1                 TO CLMNOL
  8426         MOVE AL-UABON           TO CLMNOA
  8427         MOVE ER-0202            TO EMI-ERROR
  8428         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8429     ELSE
  8430         MOVE AL-UANON           TO CLMNOA
  8431     END-IF.
  8432
  8433     IF PI-NO-CARRIER-SECURITY
  8434        IF CLMCARRL = ZERO
  8435             MOVE -1             TO CLMCARRL
  8436             MOVE AL-UABON       TO CLMCARRA
  8437             MOVE ER-0194        TO EMI-ERROR
  8438             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8439         ELSE
  8440             MOVE AL-UANON       TO CLMCARRA
  8441         END-IF
  8442     END-IF.
  8443
  8444     IF SUFXL = ZERO
  8445         MOVE SPACES             TO SUFXI
  8446         MOVE AL-UANON           TO SUFXA
  8447     ELSE
  8448         MOVE AL-UANON           TO SUFXA
  8449     END-IF.
  8450
  8451     IF NOT EMI-NO-ERRORS
  8452         GO TO 1050-SEND-CHECK
  8453     END-IF.
  8454
  8455
  8456
  8457* EXEC CICS HANDLE CONDITION
  8458*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8459*    END-EXEC.
  8460*    MOVE '"$I                   ! '' #00008221' TO DFHEIV0
  8461     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8463     MOVE X'2720233030303038323231' TO DFHEIV0(25:11)
  8464     CALL 'kxdfhei1' USING DFHEIV0
  8465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8466
  8467
  8468     MOVE 'MSTR'                 TO FILE-SWITCH
  8469     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8470
  8471     MOVE CLMCARRI               TO MSTR-CARRIER.
  8472     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8473
  8474     IF CERTNOL = ZERO     OR
  8475        CERTNOI = SPACES   OR
  8476        CERTNOI = LOW-VALUES
  8477         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8478         MOVE AL-SANON        TO CERTNOA
  8479                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 162
* EL130.cbl
  8480     ELSE
  8481         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8482     END-IF.
  8483
  8484     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8485     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8486
  8487
  8488
  8489* EXEC CICS HANDLE CONDITION
  8490*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8491*    END-EXEC.
  8492*    MOVE '"$I                   ! ( #00008245' TO DFHEIV0
  8493     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8495     MOVE X'2820233030303038323435' TO DFHEIV0(25:11)
  8496     CALL 'kxdfhei1' USING DFHEIV0
  8497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8498
  8499
  8500     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8501
  8502     IF NOT PI-NO-ACCOUNT-SECURITY
  8503         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8504           MOVE ER-2371          TO EMI-ERROR
  8505           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8506           MOVE -1               TO MAINTL
  8507           GO TO 8200-SEND-DATAONLY
  8508         END-IF
  8509     END-IF.
  8510
  8511
  8512
  8513* EXEC CICS HANDLE CONDITION
  8514*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8515*    END-EXEC.
  8516*    MOVE '"$I                   ! ) #00008261' TO DFHEIV0
  8517     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8519     MOVE X'2920233030303038323631' TO DFHEIV0(25:11)
  8520     CALL 'kxdfhei1' USING DFHEIV0
  8521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8522
  8523
  8524     MOVE 'Y'                    TO CLAIM-SWITCH.
  8525     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8526     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8527     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8528     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8529     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8530
  8531 1000-SHOW-END-OF-PERFORM.
  8532
  8533     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8534     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8535     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8536     MOVE CL-CERT-STATE          TO CERT-STATE.
  8537     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 163
* EL130.cbl
  8538     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8539     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8540
  8541     MOVE 'CERT'                 TO FILE-SWITCH.
  8542
  8543     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8544
  8545     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8546     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8547     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8548     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8549     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8550     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8551     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8552     MOVE CLMCARRI               TO PI-LAST-CARR.
  8553
  8554     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8555
  8556     IF MAINTI = 'I'
  8557         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8558                 BIRTHDTA  LSTNMEA   RELCLMA
  8559                 LOANNOA   LOANBALA  BENECDA
  8560         MOVE AL-SANON TO  SSNA
  8561         MOVE SPACES   TO  INCURI    REPORTI
  8562         MOVE 'Y'      TO PI-INCURR-SW
  8563         MOVE ER-0522  TO EMI-ERROR
  8564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8565     ELSE
  8566         MOVE ' '      TO PI-INCURR-SW
  8567     END-IF.
  8568
  8569     MOVE -1                     TO MAINTL.
  8570     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8571     MOVE CERT-GROUPING          TO PI-GROUPING.
  8572     MOVE CERT-STATE             TO PI-STATE.
  8573     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8574     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8575     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8576     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8577
  8578     IF RETURNED-FROM NOT = SPACES
  8579         GO TO 8100-SEND-INITIAL-MAP
  8580     ELSE
  8581         GO TO 8200-SEND-DATAONLY
  8582     END-IF.
  8583
  8584 1025-SHOW-RECORD-NOT-FOUND.
  8585
  8586     IF FILE-SWITCH = 'MSTR'
  8587         MOVE ER-0204            TO EMI-ERROR
  8588     ELSE
  8589         IF FILE-SWITCH = 'TRLR'
  8590             MOVE ER-0205        TO EMI-ERROR
  8591         ELSE
  8592             MOVE ER-0206        TO EMI-ERROR
  8593         END-IF
  8594     END-IF.
  8595
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 164
* EL130.cbl
  8596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8597
  8598 1050-SEND-CHECK.
  8599
  8600     IF RETURNED-FROM NOT = SPACES
  8601         GO TO 8100-SEND-INITIAL-MAP
  8602     ELSE
  8603         MOVE -1                 TO MAINTL
  8604         GO TO 8200-SEND-DATAONLY
  8605     END-IF.
  8606
  8607 2000-DELETE-CLAIM.
  8608     IF NOT MODIFY-CAP
  8609         MOVE ER-0070            TO EMI-ERROR
  8610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8611         MOVE -1                 TO MAINTL
  8612         GO TO 8200-SEND-DATAONLY
  8613     END-IF.
  8614
  8615     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8616        CLMCARRI NOT = PI-LAST-CARR        OR
  8617        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8618        SUFXI    NOT = PI-LAST-CERT-SUFX
  8619         MOVE ER-0207            TO EMI-ERROR
  8620         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8621         MOVE -1                 TO MAINTL
  8622         GO TO 8200-SEND-DATAONLY
  8623     END-IF.
  8624
  8625
  8626
  8627* EXEC CICS HANDLE CONDITION
  8628*        NOTFND   (2050-DELETE-NOT-FOUND)
  8629*    END-EXEC.
  8630*    MOVE '"$I                   ! * #00008367' TO DFHEIV0
  8631     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8633     MOVE X'2A20233030303038333637' TO DFHEIV0(25:11)
  8634     CALL 'kxdfhei1' USING DFHEIV0
  8635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8636
  8637
  8638     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8639
  8640     MOVE CLMCARRI               TO MSTR-CARRIER.
  8641     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8642     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8643     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8644
  8645     MOVE 'MSTR'                 TO FILE-SWITCH.
  8646     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8647
  8648     MOVE 'Y'                    TO CLAIM-SWITCH.
  8649
  8650     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8651        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8652         MOVE ER-0068        TO EMI-ERROR
  8653         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 165
* EL130.cbl
  8654         MOVE -1             TO MAINTL
  8655         GO TO 8200-SEND-DATAONLY
  8656     END-IF.
  8657
  8658     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8659         MOVE ER-0569            TO EMI-ERROR
  8660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8661         MOVE -1                 TO MAINTL
  8662         GO TO 8200-SEND-DATAONLY
  8663     END-IF.
  8664
  8665     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8666         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8667     END-IF.
  8668
  8669     IF CL-PURGED-DT NOT = LOW-VALUES
  8670         MOVE ER-7691            TO EMI-ERROR
  8671         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8672         MOVE -1                 TO MAINTL
  8673         GO TO 8200-SEND-DATAONLY
  8674     END-IF.
  8675
  8676     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8677     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8678     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8679     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8680     MOVE +0                     TO TRLR-SEQ-NO.
  8681     MOVE '1'                    TO TRLR-TYPE.
  8682
  8683     MOVE 'TRLR'                 TO FILE-SWITCH.
  8684
  8685
  8686
  8687* EXEC CICS READ
  8688*        UPDATE
  8689*        DATASET  (ELTRLR-DSID)
  8690*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8691*        RIDFLD   (ELTRLR-KEY)
  8692*    END-EXEC.
  8693*    MOVE '&"S        EU         (   #00008419' TO DFHEIV0
  8694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8696     MOVE X'2020233030303038343139' TO DFHEIV0(25:11)
  8697     CALL 'kxdfhei1' USING DFHEIV0,
  8698           ELTRLR-DSID,
  8699           DFHEIV20,
  8700           DFHEIV99,
  8701           ELTRLR-KEY,
  8702           DFHEIV99,
  8703           DFHEIV99,
  8704           DFHEIV99
  8705     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8706         DFHEIV20
  8707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8708
  8709
  8710     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8711        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 166
* EL130.cbl
  8712         MOVE ER-0068        TO EMI-ERROR
  8713         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8714         MOVE -1             TO MAINTL
  8715         GO TO 8200-SEND-DATAONLY
  8716     END-IF.
  8717
  8718
  8719
  8720* EXEC CICS DELETE
  8721*        DATASET   (ELTRLR-DSID)
  8722*    END-EXEC.
  8723*    MOVE '&(                    &   #00008435' TO DFHEIV0
  8724     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8725     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8726     MOVE X'2020233030303038343335' TO DFHEIV0(25:11)
  8727     CALL 'kxdfhei1' USING DFHEIV0,
  8728           ELTRLR-DSID,
  8729           DFHEIV99,
  8730           DFHEIV99,
  8731           DFHEIV99,
  8732           DFHEIV99
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8734
  8735
  8736     MOVE +90                    TO TRLR-SEQ-NO.
  8737     MOVE '6'                    TO TRLR-TYPE.
  8738
  8739
  8740
  8741* EXEC CICS READ
  8742*        UPDATE
  8743*        DATASET  (ELTRLR-DSID)
  8744*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8745*        RIDFLD   (ELTRLR-KEY)
  8746*    END-EXEC.
  8747*    MOVE '&"S        EU         (   #00008443' TO DFHEIV0
  8748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8749     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8750     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
  8751     CALL 'kxdfhei1' USING DFHEIV0,
  8752           ELTRLR-DSID,
  8753           DFHEIV20,
  8754           DFHEIV99,
  8755           ELTRLR-KEY,
  8756           DFHEIV99,
  8757           DFHEIV99,
  8758           DFHEIV99
  8759     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8760         DFHEIV20
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8762
  8763
  8764
  8765
  8766* EXEC CICS DELETE
  8767*        DATASET   (ELTRLR-DSID)
  8768*    END-EXEC.
  8769*    MOVE '&(                    &   #00008451' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 167
* EL130.cbl
  8770     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8771     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8772     MOVE X'2020233030303038343531' TO DFHEIV0(25:11)
  8773     CALL 'kxdfhei1' USING DFHEIV0,
  8774           ELTRLR-DSID,
  8775           DFHEIV99,
  8776           DFHEIV99,
  8777           DFHEIV99,
  8778           DFHEIV99
  8779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8780
  8781
  8782     MOVE +91                    TO TRLR-SEQ-NO.
  8783     MOVE '6'                    TO TRLR-TYPE.
  8784
  8785
  8786
  8787* EXEC CICS READ
  8788*        UPDATE
  8789*        DATASET  (ELTRLR-DSID)
  8790*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8791*        RIDFLD   (ELTRLR-KEY)
  8792*        RESP     (WS-RESPONSE)
  8793*    END-EXEC
  8794*    MOVE '&"S        EU         (  N#00008459' TO DFHEIV0
  8795     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8796     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8797     MOVE X'204E233030303038343539' TO DFHEIV0(25:11)
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           ELTRLR-DSID,
  8800           DFHEIV20,
  8801           DFHEIV99,
  8802           ELTRLR-KEY,
  8803           DFHEIV99,
  8804           DFHEIV99,
  8805           DFHEIV99
  8806     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8807         DFHEIV20
  8808     MOVE EIBRESP  TO WS-RESPONSE
  8809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8810
  8811     IF WS-RESP-NORMAL
  8812
  8813* EXEC CICS DELETE
  8814*          DATASET   (ELTRLR-DSID)
  8815*       END-EXEC
  8816*    MOVE '&(                    &   #00008468' TO DFHEIV0
  8817     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8819     MOVE X'2020233030303038343638' TO DFHEIV0(25:11)
  8820     CALL 'kxdfhei1' USING DFHEIV0,
  8821           ELTRLR-DSID,
  8822           DFHEIV99,
  8823           DFHEIV99,
  8824           DFHEIV99,
  8825           DFHEIV99
  8826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8827     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 168
* EL130.cbl
  8828
  8829     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8830     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8831     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8832     MOVE CL-CERT-STATE          TO CERT-STATE.
  8833     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8834     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8835     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8836
  8837     MOVE 'CERT'                 TO FILE-SWITCH.
  8838
  8839     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8840
  8841     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8842
  8843     IF WS-NUM-HOLD NOT = +0
  8844         GO TO 2005-REWRITE-CERT
  8845     END-IF.
  8846
  8847     IF NOT CERT-WAS-CREATED
  8848         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8849         GO TO 2005-REWRITE-CERT
  8850     END-IF.
  8851
  8852
  8853
  8854* EXEC CICS DELETE
  8855*        DATASET   (ELCERT-DSID)
  8856*    END-EXEC.
  8857*    MOVE '&(                    &   #00008497' TO DFHEIV0
  8858     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8859     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8860     MOVE X'2020233030303038343937' TO DFHEIV0(25:11)
  8861     CALL 'kxdfhei1' USING DFHEIV0,
  8862           ELCERT-DSID,
  8863           DFHEIV99,
  8864           DFHEIV99,
  8865           DFHEIV99,
  8866           DFHEIV99
  8867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8868
  8869
  8870     GO TO 2010-DELETE-CL.
  8871
  8872 2005-REWRITE-CERT.
  8873
  8874     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8875
  8876
  8877
  8878* EXEC CICS HANDLE CONDITION
  8879*         DUPKEY   (2010-DELETE-CL)
  8880*    END-EXEC.
  8881*    MOVE '"$$                   ! + #00008508' TO DFHEIV0
  8882     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8883     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8884     MOVE X'2B20233030303038353038' TO DFHEIV0(25:11)
  8885     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 169
* EL130.cbl
  8886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8887
  8888
  8889
  8890
  8891* EXEC CICS REWRITE
  8892*        DATASET  (ELCERT-DSID)
  8893*        FROM     (CERTIFICATE-MASTER)
  8894*    END-EXEC.
  8895     MOVE LENGTH OF
  8896      CERTIFICATE-MASTER
  8897       TO DFHEIV11
  8898*    MOVE '&& L                  %   #00008513' TO DFHEIV0
  8899     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8900     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8901     MOVE X'2020233030303038353133' TO DFHEIV0(25:11)
  8902     CALL 'kxdfhei1' USING DFHEIV0,
  8903           ELCERT-DSID,
  8904           CERTIFICATE-MASTER,
  8905           DFHEIV11,
  8906           DFHEIV99
  8907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8908
  8909
  8910 2010-DELETE-CL.
  8911
  8912
  8913
  8914* EXEC CICS DELETE
  8915*        DATASET  (ELMSTR-DSID)
  8916*    END-EXEC.
  8917*    MOVE '&(                    &   #00008521' TO DFHEIV0
  8918     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8919     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8920     MOVE X'2020233030303038353231' TO DFHEIV0(25:11)
  8921     CALL 'kxdfhei1' USING DFHEIV0,
  8922           ELMSTR-DSID,
  8923           DFHEIV99,
  8924           DFHEIV99,
  8925           DFHEIV99,
  8926           DFHEIV99
  8927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8928
  8929
  8930     MOVE -1                     TO ONE-OR-MIN1.
  8931     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8932
  8933     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8934         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8935                                    WS-SAVE-CLAIM-KEY
  8936         MOVE +1                 TO ONE-OR-MIN1
  8937         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8938     END-IF.
  8939
  8940     MOVE ER-0000                TO EMI-ERROR.
  8941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8942     MOVE LOW-VALUES             TO EL130AO.
  8943     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 170
* EL130.cbl
  8944     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8945     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8946                                    PI-CERT-PROCESSED
  8947                                    PI-LETTER-ERROR-CODE.
  8948     GO TO 8100-SEND-INITIAL-MAP.
  8949
  8950 2050-DELETE-NOT-FOUND.
  8951     IF FILE-SWITCH = 'MSTR'
  8952         MOVE -1                 TO CLMNOL
  8953         MOVE ER-0204            TO EMI-ERROR
  8954     ELSE
  8955         IF FILE-SWITCH = 'TRLR'
  8956             MOVE -1             TO MAINTL
  8957             MOVE ER-0205        TO EMI-ERROR
  8958         ELSE
  8959             MOVE -1             TO CERTNOL
  8960             MOVE ER-0206        TO EMI-ERROR
  8961         END-IF
  8962     END-IF.
  8963
  8964     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8965     GO TO 8200-SEND-DATAONLY.
  8966
  8967 3000-ADD-CLAIM.
  8968     IF NOT MODIFY-CAP
  8969         MOVE ER-0070            TO EMI-ERROR
  8970         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8971         MOVE -1                 TO MAINTL
  8972         GO TO 8200-SEND-DATAONLY
  8973     END-IF.
  8974
  8975     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8976
  8977     IF CERTMTI = 'S'
  8978         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8979            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8980            WS-EFFDT = PI-SAVE-EFFDT       AND
  8981            ACCOUNTI = PI-SAVE-ACCOUNT
  8982             IF EMI-ERROR = 0
  8983                 GO TO 3010-TEST-FOR-ERRORS
  8984             ELSE
  8985                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8986                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8987                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8988                 MOVE PI-STATE         TO  CERT-STATE
  8989                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8990                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8991                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8992
  8993
  8994* EXEC CICS HANDLE CONDITION
  8995*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8996*                END-EXEC
  8997*    MOVE '"$I                   ! , #00008588' TO DFHEIV0
  8998     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9000     MOVE X'2C20233030303038353838' TO DFHEIV0(25:11)
  9001     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 171
* EL130.cbl
  9002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9003                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  9004                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  9005                 GO TO 3010-TEST-FOR-ERRORS
  9006             END-IF
  9007         END-IF
  9008     END-IF.
  9009
  9010     IF CERTMTI = 'A'
  9011         IF NOT PI-NO-CARRIER-SECURITY OR
  9012             NOT PI-NO-ACCOUNT-SECURITY
  9013             MOVE ER-2370          TO EMI-ERROR
  9014             MOVE -1               TO MAINTL
  9015             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9016             GO TO 8200-SEND-DATAONLY
  9017         ELSE
  9018             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  9019             GO TO 3010-TEST-FOR-ERRORS
  9020         END-IF
  9021     END-IF.
  9022
  9023     IF CERTNOL = ZEROS
  9024        GO TO 3010-TEST-FOR-ERRORS
  9025     END-IF.
  9026
  9027 3000-READ-CERT.
  9028
  9029     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  9030                                    MSTR5-COMP-CD.
  9031     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  9032                                    MSTR5-CERT-NO-PRIME.
  9033     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  9034                                    MSTR5-CERT-NO-SUFX.
  9035
  9036
  9037
  9038* EXEC CICS HANDLE CONDITION
  9039*         DUPKEY   (3008-DUP-ERROR)
  9040*         NOTFND   (3009-NOT-FOUND)
  9041*    END-EXEC
  9042*    MOVE '"$$I                  ! - #00008625' TO DFHEIV0
  9043     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  9044     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9045     MOVE X'2D20233030303038363235' TO DFHEIV0(25:11)
  9046     CALL 'kxdfhei1' USING DFHEIV0
  9047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9048
  9049     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  9050
  9051     IF NOT PI-NO-ACCOUNT-SECURITY
  9052         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  9053             MOVE ER-2371          TO EMI-ERROR
  9054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9055             MOVE -1               TO MAINTL
  9056             GO TO 8200-SEND-DATAONLY
  9057         END-IF
  9058     END-IF.
  9059
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 172
* EL130.cbl
  9060     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  9061     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  9062     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  9063     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  9064     MOVE CM-CARRIER             TO PI-CARRIER.
  9065     MOVE CM-GROUPING            TO PI-GROUPING.
  9066     MOVE CM-STATE               TO PI-STATE.
  9067     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9068     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9069     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9070     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9071
  9072     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9073         IF LSTNMEO = SPACES OR LOW-VALUES
  9074             MOVE CRTLNMEI       TO  LSTNMEO
  9075             MOVE AL-UANON       TO  LSTNMEA
  9076         END-IF
  9077     END-IF.
  9078
  9079     MOVE 'S'                    TO CERTMTO.
  9080*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9081     MOVE AL-SANON               TO CERTNOA.
  9082     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9083                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9084     IF EMI-NO-ERRORS
  9085         MOVE -1                  TO MAINTL
  9086     END-IF.
  9087
  9088     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9089         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9090         IF INCURRED-DATE-MATCH
  9091             MOVE ER-7352         TO EMI-ERROR
  9092             MOVE -1              TO CERTNOL
  9093             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9094         ELSE
  9095             IF NO-CLAIMS-FOR-CERT
  9096                 MOVE ER-7353     TO EMI-ERROR
  9097                 MOVE -1          TO CERTNOL
  9098                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9099             ELSE
  9100                 MOVE ER-0558     TO EMI-ERROR
  9101                 MOVE -1          TO CERTNOL
  9102                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9103                 GO TO 3010-TEST-FOR-ERRORS
  9104             END-IF
  9105         END-IF
  9106     END-IF.
  9107
  9108 3007-SEND-SCREEN.
  9109     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9110         GO TO 8150-SEND-MAP-CURSOR
  9111     ELSE
  9112         GO TO 8200-SEND-DATAONLY
  9113     END-IF.
  9114
  9115 3008-DUP-ERROR.
  9116     MOVE ER-0560                TO EMI-ERROR.
  9117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 173
* EL130.cbl
  9118     MOVE -1                     TO CERTNOL.
  9119     GO TO 3007-SEND-SCREEN.
  9120
  9121 3009-NOT-FOUND.
  9122     MOVE ER-0214                TO EMI-ERROR.
  9123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9124     MOVE -1                     TO CERTNOL.
  9125     GO TO 3007-SEND-SCREEN.
  9126
  9127 3010-TEST-FOR-ERRORS.
  9128
  9129     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9130     perform 6500-get-acct    thru 6500-exit
  9131     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9132*     perform 6500-get-acct    thru 6500-exit
  9133
  9134     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9135     move +0                     to e1
  9136     move spaces                 to ws-dcc-error-line
  9137     move ' '                    to ws-zero-bens-avail
  9138
  9139     if ws-dcc-product-code not = spaces
  9140        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9141        IF ERPDEF-FOUND
  9142           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9143           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9144           MOVE '1'              TO DC-OPTION-CODE
  9145           MOVE +0               TO DC-ELAPSED-MONTHS
  9146                                    DC-ELAPSED-DAYS
  9147           PERFORM 9700-LINK-DATE-CONVERT
  9148                                 THRU 9700-EXIT
  9149           IF NO-CONVERSION-ERROR
  9150              MOVE DC-ELAPSED-MONTHS
  9151                                 TO WS-MONTHS-BETWEEN
  9152              IF DC-ELAPSED-DAYS > 1
  9153                 ADD 1 TO WS-MONTHS-BETWEEN
  9154              END-IF
  9155           ELSE
  9156              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9157           END-IF
  9158
  9159           evaluate true
  9160              when (ws-excl-period not = zeros)
  9161                 and (ws-months-between <= ws-excl-period)
  9162                 MOVE -1         TO MAINTL
  9163                 add +1          to e1
  9164                 move 'Y'        to ws-zero-bens-avail
  9165                 MOVE ER-1651    TO EMI-ERROR
  9166                                    ws-error-no (e1)
  9167                 PERFORM 9900-ERROR-FORMAT
  9168                                 THRU 9900-EXIT
  9169              when (ws-cov-ends not = zeros)
  9170                 and (ws-months-between > ws-cov-ends)
  9171                 MOVE -1         TO MAINTL
  9172                 add +1          to e1
  9173                 move 'Y'        to ws-zero-bens-avail
  9174                 MOVE ER-1653    TO EMI-ERROR
  9175                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 174
* EL130.cbl
  9176                 evaluate true
  9177                    when clmtypei = 'L'
  9178                       move '  LF  ' to emi-claim-type
  9179                    when clmtypei = 'I'
  9180                       move '  IU  ' to emi-claim-type
  9181                    when clmtypei = 'F'
  9182                       move '  FL  ' to emi-claim-type
  9183                    when other
  9184                       move '  AH  ' to emi-claim-type
  9185                 end-evaluate
  9186                 PERFORM 9900-ERROR-FORMAT
  9187                                 THRU 9900-EXIT
  9188              when (ws-acc-period not = zeros)
  9189                 and (ws-months-between <= ws-acc-period)
  9190                 MOVE -1         TO MAINTL
  9191                 add +1          to e1
  9192                 MOVE ER-1652    TO EMI-ERROR
  9193                                    ws-error-no (e1)
  9194                 PERFORM 9900-ERROR-FORMAT
  9195                                 THRU 9900-EXIT
  9196                 add +1          to e1
  9197                 move er-1655    to emi-error
  9198                                    ws-error-no (e1)
  9199                 PERFORM 9900-ERROR-FORMAT
  9200                                 THRU 9900-EXIT
  9201              when clmtypei = 'I'
  9202                 add +1          to e1
  9203                 move er-1661    to emi-error
  9204                                    ws-error-no (e1)
  9205                 PERFORM 9900-ERROR-FORMAT
  9206                                 THRU 9900-EXIT
  9207           end-evaluate
  9208           IF (WS-PRE-EXISTING-PER NOT = ZEROS)
  9209              AND (WS-MONTHS-BETWEEN <= WS-PRE-EXISTING-PER)
  9210              MOVE -1         TO MAINTL
  9211              ADD +1          TO E1
  9212              MOVE ER-1677    TO EMI-ERROR
  9213                                 WS-ERROR-NO (E1)
  9214              PERFORM 9900-ERROR-FORMAT
  9215                              THRU 9900-EXIT
  9216           END-IF
  9217        END-IF
  9218*       perform 3996-read-cert-claim-trailer
  9219*                                thru 3996-exit
  9220     END-IF
  9221     perform 3996-read-cert-claim-trailer
  9222                                 thru 3996-exit
  9223     IF CERTMTI NOT = 'A'
  9224         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9225             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9226             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9227             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9228             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9229             IF INCURRED-DATE-MATCH
  9230                 MOVE ER-7352         TO EMI-ERROR
  9231                 MOVE -1              TO CERTNOL
  9232                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9233             ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 175
* EL130.cbl
  9234                 IF NO-CLAIMS-FOR-CERT
  9235                     MOVE ER-7353     TO EMI-ERROR
  9236                     MOVE -1          TO CERTNOL
  9237                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9238                 ELSE
  9239                     MOVE ER-0558     TO EMI-ERROR
  9240                     MOVE -1          TO CERTNOL
  9241                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9242                 END-IF
  9243             END-IF
  9244         END-IF
  9245     END-IF.
  9246
  9247     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9248         MOVE ER-0433             TO EMI-ERROR
  9249         MOVE -1                  TO MAINTL
  9250         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9251         GO TO 8200-SEND-DATAONLY
  9252     END-IF.
  9253
  9254     IF (EMI-NO-ERRORS)
  9255        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9256         GO TO 3015-TRY-TO-BUILD
  9257     END-IF.
  9258
  9259     IF EIBAID = DFHPF6
  9260         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9261             MOVE ER-0434         TO EMI-ERROR
  9262             MOVE -1              TO MAINTL
  9263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9264             GO TO 8200-SEND-DATAONLY
  9265         ELSE
  9266             MOVE +1              TO INCURL
  9267             GO TO 3015-TRY-TO-BUILD
  9268         END-IF
  9269     END-IF.
  9270
  9271     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9272         GO TO 8150-SEND-MAP-CURSOR
  9273     ELSE
  9274         GO TO 8200-SEND-DATAONLY
  9275     END-IF.
  9276
  9277 3015-TRY-TO-BUILD.
  9278     IF CLMNOL EQUAL ZERO
  9279         GO TO 3030-BUILD-CONT
  9280     END-IF.
  9281
  9282
  9283
  9284* EXEC CICS HANDLE CONDITION
  9285*        NOTFND   (3030-BUILD-CONT)
  9286*    END-EXEC.
  9287*    MOVE '"$I                   ! . #00008864' TO DFHEIV0
  9288     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9290     MOVE X'2E20233030303038383634' TO DFHEIV0(25:11)
  9291     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 176
* EL130.cbl
  9292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9293
  9294
  9295     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9296
  9297     MOVE CLMCARRI               TO MSTR-CARRIER.
  9298     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9299     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9300     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9301
  9302     MOVE 'MSTR'                 TO FILE-SWITCH.
  9303
  9304     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9305
  9306     MOVE ER-0221                TO EMI-ERROR.
  9307
  9308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9309     MOVE -1                     TO MAINTL.
  9310     GO TO 8200-SEND-DATAONLY.
  9311
  9312 3030-BUILD-CONT.
  9313     IF (CERTMTI NOT = 'A')
  9314        and (pi-company-id not = 'DCC' and 'VPP')
  9315         GO TO 3060-BUILD-CONT
  9316     END-IF.
  9317
  9318
  9319
  9320* EXEC CICS HANDLE CONDITION
  9321*        NOTFND   (3033-ACCT-NOT-FOUND)
  9322*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9323*    END-EXEC.
  9324*    MOVE '"$I''                  ! / #00008892' TO DFHEIV0
  9325     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9326     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9327     MOVE X'2F20233030303038383932' TO DFHEIV0(25:11)
  9328     CALL 'kxdfhei1' USING DFHEIV0
  9329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9330
  9331
  9332     MOVE SPACES                 TO ERACCT-KEY.
  9333
  9334     IF CARR-GROUP-ST-ACCNT-CNTL
  9335         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9336         MOVE CRTCARRI           TO ACCT-CARRIER
  9337         MOVE GROUPI             TO ACCT-GROUPING
  9338         MOVE STATEI             TO ACCT-STATE
  9339         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9340         GO TO 3031-MOVE-ACCT-KEY
  9341     END-IF.
  9342
  9343     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9344     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9345
  9346     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9347         MOVE STATEI             TO ACCT-STATE
  9348     END-IF.
  9349
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 177
* EL130.cbl
  9350     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9351         MOVE CRTCARRI           TO ACCT-CARRIER
  9352     END-IF.
  9353
  9354 3031-MOVE-ACCT-KEY.
  9355     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9356
  9357
  9358
  9359* EXEC CICS STARTBR
  9360*        DATASET     (ERACCT2-DSID)
  9361*        RIDFLD      (SAVE-ERACCT-KEY)
  9362*        GENERIC
  9363*        KEYLENGTH   (20)
  9364*    END-EXEC.
  9365     MOVE 20
  9366       TO DFHEIV11
  9367     MOVE 0
  9368       TO DFHEIV12
  9369*    MOVE '&,   KG    G          &   #00008923' TO DFHEIV0
  9370     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9371     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9372     MOVE X'2020233030303038393233' TO DFHEIV0(25:11)
  9373     CALL 'kxdfhei1' USING DFHEIV0,
  9374           ERACCT2-DSID,
  9375           SAVE-ERACCT-KEY,
  9376           DFHEIV11,
  9377           DFHEIV12,
  9378           DFHEIV99
  9379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9380
  9381
  9382
  9383
  9384* EXEC CICS HANDLE CONDITION
  9385*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9386*    END-EXEC.
  9387*    MOVE '"$''                   ! 0 #00008931' TO DFHEIV0
  9388     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9390     MOVE X'3020233030303038393331' TO DFHEIV0(25:11)
  9391     CALL 'kxdfhei1' USING DFHEIV0
  9392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9393
  9394
  9395 3031-READ-ACCT-LOOP.
  9396
  9397
  9398* EXEC CICS READNEXT
  9399*        DATASET   (ERACCT2-DSID)
  9400*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9401*        RIDFLD    (SAVE-ERACCT-KEY)
  9402*    END-EXEC.
  9403     MOVE 0
  9404       TO DFHEIV11
  9405*    MOVE '&.S                   )   #00008937' TO DFHEIV0
  9406     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9407     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 178
* EL130.cbl
  9408     MOVE X'2020233030303038393337' TO DFHEIV0(25:11)
  9409     CALL 'kxdfhei1' USING DFHEIV0,
  9410           ERACCT2-DSID,
  9411           DFHEIV20,
  9412           DFHEIV99,
  9413           SAVE-ERACCT-KEY,
  9414           DFHEIV99,
  9415           DFHEIV11,
  9416           DFHEIV99,
  9417           DFHEIV99
  9418     SET ADDRESS OF ACCOUNT-MASTER TO
  9419         DFHEIV20
  9420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9421
  9422
  9423     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9424        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9425        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9426        ACCT-STATE    NOT = AM-VG-STATE       OR
  9427        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9428         GO TO 3033-ACCT-NOT-FOUND
  9429     END-IF.
  9430
  9431     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9432        WS-EFFDT LESS AM-EXPIRATION-DT
  9433         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9434         MOVE AM-CARRIER       TO CERT-CARRIER
  9435         MOVE AM-GROUPING      TO CERT-GROUPING
  9436         MOVE AM-STATE         TO CERT-STATE
  9437         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9438         MOVE WS-EFFDT         TO CERT-EFF-DT
  9439         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9440         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9441         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9442         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9443     END-IF.
  9444
  9445     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9446         GO TO 3031-READ-ACCT-LOOP
  9447     END-IF.
  9448
  9449 3032-NOT-IN-DT-RANGE.
  9450     MOVE ER-0226                TO EMI-ERROR.
  9451     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9452     MOVE -1                     TO EFFDTL.
  9453     GO TO 8200-SEND-DATAONLY.
  9454
  9455 3033-ACCT-NOT-FOUND.
  9456     MOVE ER-0226 TO EMI-ERROR.
  9457     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9458     MOVE -1                     TO ACCOUNTL.
  9459     GO TO 8200-SEND-DATAONLY.
  9460
  9461 3034-CHECK-EMPLOYER-STATEMENT.
  9462
  9463     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9464*        NEXT SENTENCE
  9465         CONTINUE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 179
* EL130.cbl
  9466     ELSE
  9467         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9468     END-IF.
  9469
  9470     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9471     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9472     MOVE '1'                    TO  DC-OPTION-CODE.
  9473     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9474                                     DC-ELAPSED-DAYS.
  9475     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9476
  9477     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9478         DC-ELAPSED-DAYS LESS THAN +31)
  9479                      OR
  9480        (AM-EMPLOYER-STMT-USED = '2' AND
  9481         DC-ELAPSED-DAYS LESS THAN +61)
  9482                      OR
  9483        (AM-EMPLOYER-STMT-USED = '3' AND
  9484         DC-ELAPSED-DAYS LESS THAN +91)
  9485            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9486     END-IF.
  9487
  9488 3034-CHECK-ACCOUNT-LIMITS.
  9489
  9490     IF CERTMTI NOT = 'A'
  9491         GO TO 3060-BUILD-CONT
  9492     END-IF.
  9493
  9494     IF AM-STATUS NOT = '0'
  9495         MOVE ER-0225                TO EMI-ERROR
  9496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9497         MOVE -1                     TO ACCOUNTL
  9498     END-IF.
  9499
  9500     IF EIBAID = DFHPF6
  9501         IF EMI-FATAL-CTR NOT = ZERO
  9502             MOVE ER-0434         TO EMI-ERROR
  9503             MOVE -1              TO MAINTL
  9504             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9505             GO TO 8200-SEND-DATAONLY
  9506         END-IF
  9507     END-IF.
  9508
  9509*    IF PI-COMPANY-ID NOT = 'CRI'
  9510*        GO TO 3035-END-BROWSE
  9511*    END-IF.
  9512
  9513 3035-END-BROWSE.
  9514
  9515
  9516* EXEC CICS ENDBR
  9517*        DATASET    (ERACCT2-DSID)
  9518*    END-EXEC.
  9519     MOVE 0
  9520       TO DFHEIV11
  9521*    MOVE '&2                    $   #00009035' TO DFHEIV0
  9522     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 180
* EL130.cbl
  9524     MOVE X'2020233030303039303335' TO DFHEIV0(25:11)
  9525     CALL 'kxdfhei1' USING DFHEIV0,
  9526           ERACCT2-DSID,
  9527           DFHEIV11,
  9528           DFHEIV99
  9529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9530
  9531
  9532 3040-CHECK-CERT-ALREADY-ON.
  9533
  9534
  9535* EXEC CICS HANDLE CONDITION
  9536*        NOTFND   (3070-BUILD-CONT)
  9537*    END-EXEC.
  9538*    MOVE '"$I                   ! 1 #00009041' TO DFHEIV0
  9539     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9541     MOVE X'3120233030303039303431' TO DFHEIV0(25:11)
  9542     CALL 'kxdfhei1' USING DFHEIV0
  9543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9544
  9545
  9546     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9547
  9548     MOVE ER-0229                TO EMI-ERROR.
  9549     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9550     MOVE -1                     TO MAINTL.
  9551     GO TO 8200-SEND-DATAONLY.
  9552
  9553 3060-BUILD-CONT.
  9554     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9555     MOVE CRTCARRI               TO CERT-CARRIER.
  9556     MOVE GROUPI                 TO CERT-GROUPING.
  9557     MOVE STATEI                 TO CERT-STATE.
  9558     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9559     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9560     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9561     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9562
  9563
  9564
  9565* EXEC CICS HANDLE CONDITION
  9566*        NOTFND  (3065-CERT-NOT-FOUND)
  9567*    END-EXEC.
  9568*    MOVE '"$I                   ! 2 #00009063' TO DFHEIV0
  9569     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9571     MOVE X'3220233030303039303633' TO DFHEIV0(25:11)
  9572     CALL 'kxdfhei1' USING DFHEIV0
  9573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9574
  9575
  9576     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9577
  9578     GO TO 3070-BUILD-CONT.
  9579
  9580 3065-CERT-NOT-FOUND.
  9581     MOVE ER-0244                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 181
* EL130.cbl
  9582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9583     MOVE -1                     TO CERTNOL.
  9584     GO TO 8200-SEND-DATAONLY.
  9585
  9586 3070-BUILD-CONT.
  9587     IF CLMNOL NOT = ZERO
  9588         GO TO 3200-BUILD-ZERO-TRAILER
  9589     END-IF.
  9590
  9591     MOVE SPACES                 TO ELCNTL-KEY.
  9592
  9593     IF CONTROL-IS-ACTUAL-CARRIER
  9594         MOVE PI-CARRIER         TO CNTL-CARRIER
  9595     ELSE
  9596         MOVE PI-CARRIER-CONTROL-LEVEL
  9597                                 TO CNTL-CARRIER
  9598     END-IF.
  9599
  9600     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9601     MOVE '6'                    TO CNTL-REC-TYPE.
  9602     MOVE +0                     TO CNTL-SEQ-NO.
  9603
  9604
  9605
  9606* EXEC CICS HANDLE CONDITION
  9607*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9608*    END-EXEC.
  9609*    MOVE '"$I                   ! 3 #00009096' TO DFHEIV0
  9610     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9612     MOVE X'3320233030303039303936' TO DFHEIV0(25:11)
  9613     CALL 'kxdfhei1' USING DFHEIV0
  9614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9615
  9616
  9617
  9618
  9619* EXEC CICS READ
  9620*        UPDATE
  9621*        DATASET   (ELCNTL-DSID)
  9622*        SET       (ADDRESS OF CONTROL-FILE)
  9623*        RIDFLD    (ELCNTL-KEY)
  9624*    END-EXEC.
  9625*    MOVE '&"S        EU         (   #00009101' TO DFHEIV0
  9626     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9627     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9628     MOVE X'2020233030303039313031' TO DFHEIV0(25:11)
  9629     CALL 'kxdfhei1' USING DFHEIV0,
  9630           ELCNTL-DSID,
  9631           DFHEIV20,
  9632           DFHEIV99,
  9633           ELCNTL-KEY,
  9634           DFHEIV99,
  9635           DFHEIV99,
  9636           DFHEIV99
  9637     SET ADDRESS OF CONTROL-FILE TO
  9638         DFHEIV20
  9639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 182
* EL130.cbl
  9640
  9641
  9642     IF CLAIM-NO-MANUAL
  9643         GO TO 3120-CLAIM-MUST-BE-INPUT
  9644     END-IF.
  9645
  9646     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9647     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9648
  9649     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9650         CONTINUE
  9651     ELSE
  9652         GO TO 3080-ASSIGN-LOOP
  9653     END-IF.
  9654
  9655
  9656
  9657* EXEC CICS UNLOCK
  9658*        DATASET   (ELCNTL-DSID)
  9659*    END-EXEC.
  9660*    MOVE '&*                    #   #00009122' TO DFHEIV0
  9661     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9662     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9663     MOVE X'2020233030303039313232' TO DFHEIV0(25:11)
  9664     CALL 'kxdfhei1' USING DFHEIV0,
  9665           ELCNTL-DSID,
  9666           DFHEIV99
  9667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9668
  9669
  9670     MOVE '1'                    TO CNTL-REC-TYPE.
  9671     MOVE SPACES                 TO CNTL-ACCESS.
  9672
  9673     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9674
  9675
  9676
  9677* EXEC CICS HANDLE CONDITION
  9678*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9679*    END-EXEC.
  9680*    MOVE '"$I                   ! 4 #00009132' TO DFHEIV0
  9681     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9683     MOVE X'3420233030303039313332' TO DFHEIV0(25:11)
  9684     CALL 'kxdfhei1' USING DFHEIV0
  9685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9686
  9687
  9688     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9689
  9690     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9691
  9692 3080-ASSIGN-LOOP.
  9693     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9694        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9695         MOVE +0                 TO SAVE-COUNTER
  9696     END-IF.
  9697
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 183
* EL130.cbl
  9698     ADD +1 TO SAVE-COUNTER.
  9699
  9700     IF SAVE-METHOD  = '3'
  9701         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9702         GO TO 3090-SET-COMP
  9703     END-IF.
  9704
  9705     IF SAVE-METHOD  = '4'
  9706         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9707         MOVE CLMCARRI           TO WS-CN-PRF-A
  9708         GO TO 3090-SET-COMP
  9709     END-IF.
  9710
  9711     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9712     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9713     MOVE SAVE-DATE              TO CURR-DATE.
  9714
  9715     IF CURR-MM LESS '10'
  9716         MOVE CURR-M2             TO WS-CN-PRF-B
  9717     END-IF.
  9718
  9719     IF CURR-MM = '10'
  9720        MOVE 'A'                 TO WS-CN-PRF-B
  9721     END-IF.
  9722     IF CURR-MM = '11'
  9723        MOVE 'B'                 TO WS-CN-PRF-B
  9724     END-IF.
  9725     IF CURR-MM = '12'
  9726        MOVE 'C'                 TO WS-CN-PRF-B
  9727     END-IF.
  9728
  9729     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9730
  9731 3090-SET-COMP.
  9732
  9733     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9734     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9735                                    CLMNOO.
  9736     MOVE AL-UANON               TO CLMNOA.
  9737     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9738     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9739     MOVE CLMCARRI               TO MSTR-CARRIER.
  9740
  9741
  9742
  9743* EXEC CICS HANDLE CONDITION
  9744*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9745*    END-EXEC.
  9746*    MOVE '"$I                   ! 5 #00009190' TO DFHEIV0
  9747     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9749     MOVE X'3520233030303039313930' TO DFHEIV0(25:11)
  9750     CALL 'kxdfhei1' USING DFHEIV0
  9751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9752
  9753
  9754     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9755
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 184
* EL130.cbl
  9756     GO TO 3080-ASSIGN-LOOP.
  9757
  9758 3100-CARRIER-NOT-FOUND.
  9759     MOVE ER-0252                TO EMI-ERROR.
  9760     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9761     MOVE -1                     TO CLMCARRL.
  9762     GO TO 8200-SEND-DATAONLY.
  9763
  9764 3110-COMPANY-NOT-FOUND.
  9765     MOVE ER-0254                TO EMI-ERROR.
  9766     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9767     MOVE -1                     TO MAINTL.
  9768     GO TO 8200-SEND-DATAONLY.
  9769
  9770 3120-CLAIM-MUST-BE-INPUT.
  9771     MOVE ER-0264                TO EMI-ERROR.
  9772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9773     MOVE -1                     TO CLMNOL.
  9774     GO TO 8200-SEND-DATAONLY.
  9775
  9776 3200-BUILD-ZERO-TRAILER.
  9777
  9778
  9779* EXEC CICS HANDLE CONDITION
  9780*        NOTFND
  9781*    END-EXEC.
  9782*    MOVE '"$                   ! 6 #00009218' TO DFHEIV0
  9783     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9785     MOVE X'3620233030303039323138' TO DFHEIV0(25:11)
  9786     CALL 'kxdfhei1' USING DFHEIV0
  9787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9788
  9789
  9790
  9791
  9792* EXEC CICS GETMAIN
  9793*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9794*        LENGTH  (ELTRLR-LENGTH)
  9795*    END-EXEC.
  9796*    MOVE '," L                  $   #00009223' TO DFHEIV0
  9797     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9798     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9799     MOVE X'2020233030303039323233' TO DFHEIV0(25:11)
  9800     CALL 'kxdfhei1' USING DFHEIV0,
  9801           DFHEIV20,
  9802           ELTRLR-LENGTH,
  9803           DFHEIV99
  9804     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9805         DFHEIV20
  9806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9807
  9808
  9809     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9810     MOVE 'AT'                   TO AT-RECORD-ID.
  9811
  9812     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9813     MOVE CLMCARRI               TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 185
* EL130.cbl
  9814     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9815     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9816     MOVE +0                     TO AT-SEQUENCE-NO.
  9817     MOVE '1'                    TO AT-TRAILER-TYPE.
  9818
  9819     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9820     MOVE '5'                    TO DC-OPTION-CODE.
  9821     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9822     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9823                                    AT-RESERVES-LAST-MAINT-DT.
  9824
  9825     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9826                                    AT-RESERVES-LAST-UPDATED-BY.
  9827
  9828     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9829
  9830     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9831
  9832     MOVE +0                     TO AT-FUTURE-RESERVE
  9833                                    AT-IBNR-RESERVE
  9834                                    AT-PAY-CURRENT-RESERVE
  9835                                    AT-INITIAL-MANUAL-RESERVE
  9836                                    AT-CURRENT-MANUAL-RESERVE
  9837                                    AT-ITD-LIFE-REFUNDS
  9838                                    AT-ITD-AH-REFUNDS
  9839                                    AT-ITD-ADDITIONAL-RESERVE.
  9840
  9841     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9842
  9843     IF MANRSVL NOT = ZERO
  9844         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9845                                    AT-CURRENT-MANUAL-RESERVE
  9846     END-IF.
  9847
  9848     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9849
  9850     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9851                                    AT-ITD-CHARGEABLE-EXPENSE.
  9852
  9853     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9854     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9855     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9856
  9857
  9858
  9859* EXEC CICS WRITE
  9860*        DATASET   (ELTRLR-DSID)
  9861*        FROM      (ACTIVITY-TRAILERS)
  9862*        RIDFLD    (AT-CONTROL-PRIMARY)
  9863*    END-EXEC.
  9864     MOVE LENGTH OF
  9865      ACTIVITY-TRAILERS
  9866       TO DFHEIV11
  9867*    MOVE '&$ L                  ''   #00009277' TO DFHEIV0
  9868     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9870     MOVE X'2020233030303039323737' TO DFHEIV0(25:11)
  9871     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 186
* EL130.cbl
  9872           ELTRLR-DSID,
  9873           ACTIVITY-TRAILERS,
  9874           DFHEIV11,
  9875           AT-CONTROL-PRIMARY,
  9876           DFHEIV99,
  9877           DFHEIV99
  9878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9879
  9880
  9881     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9882
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 187
* EL130.cbl
  9884
  9885 3250-BUILD-I1-ADDRESS-TRAILER.
  9886
  9887     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9888     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9889     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9890     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9891     MOVE GROUPI                 TO WS-MA-GROUPING.
  9892     MOVE STATEI                 TO WS-MA-STATE.
  9893     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9894     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9895     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9896     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9897
  9898
  9899* EXEC CICS HANDLE CONDITION
  9900*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9901*    END-EXEC.
  9902*    MOVE '"$I                   ! 7 #00009300' TO DFHEIV0
  9903     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9904     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9905     MOVE X'3720233030303039333030' TO DFHEIV0(25:11)
  9906     CALL 'kxdfhei1' USING DFHEIV0
  9907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9908
  9909
  9910
  9911* EXEC CICS READ
  9912*        EQUAL
  9913*        DATASET   (ERMAIL-DSID)
  9914*        SET       (ADDRESS OF MAILING-DATA)
  9915*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9916*    END-EXEC.
  9917*    MOVE '&"S        E          (   #00009304' TO DFHEIV0
  9918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9920     MOVE X'2020233030303039333034' TO DFHEIV0(25:11)
  9921     CALL 'kxdfhei1' USING DFHEIV0,
  9922           ERMAIL-DSID,
  9923           DFHEIV20,
  9924           DFHEIV99,
  9925           WS-MA-CONTROL-PRIMARY,
  9926           DFHEIV99,
  9927           DFHEIV99,
  9928           DFHEIV99
  9929     SET ADDRESS OF MAILING-DATA TO
  9930         DFHEIV20
  9931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9932
  9933
  9934     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9935         GO TO 3290-NO-INSURED-ADDRESS
  9936     END-IF.
  9937
  9938     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9939     MOVE 'AT'                   TO AT-RECORD-ID.
  9940
  9941     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 188
* EL130.cbl
  9942     MOVE CLMCARRI               TO AT-CARRIER.
  9943     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9944     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9945     MOVE +1                     TO AT-SEQUENCE-NO.
  9946     MOVE '5'                    TO AT-TRAILER-TYPE.
  9947
  9948     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9949     IF MA-INSURED-MIDDLE-INIT > SPACES
  9950        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9951               ' ' DELIMITED BY SIZE
  9952               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9953               ' ' DELIMITED BY SIZE
  9954               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9955        INTO AT-MAIL-TO-NAME
  9956     ELSE
  9957        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9958               ' ' DELIMITED BY SIZE
  9959               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9960        INTO AT-MAIL-TO-NAME
  9961     END-IF.
  9962     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9963     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9964*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9965     MOVE MA-CITY                TO AT-CITY
  9966     MOVE MA-ADDR-STATE          TO AT-STATE
  9967     MOVE MA-ZIP                 TO AT-ZIP
  9968     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9969
  9970     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9971                                    AT-ADDRESS-LAST-MAINT-DT.
  9972
  9973     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9974                                    AT-ADDRESS-LAST-UPDATED-BY.
  9975
  9976     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9977
  9978
  9979* EXEC CICS WRITE
  9980*        DATASET   (ELTRLR-DSID)
  9981*        FROM      (ACTIVITY-TRAILERS)
  9982*        RIDFLD    (AT-CONTROL-PRIMARY)
  9983*    END-EXEC.
  9984     MOVE LENGTH OF
  9985      ACTIVITY-TRAILERS
  9986       TO DFHEIV11
  9987*    MOVE '&$ L                  ''   #00009355' TO DFHEIV0
  9988     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9990     MOVE X'2020233030303039333535' TO DFHEIV0(25:11)
  9991     CALL 'kxdfhei1' USING DFHEIV0,
  9992           ELTRLR-DSID,
  9993           ACTIVITY-TRAILERS,
  9994           DFHEIV11,
  9995           AT-CONTROL-PRIMARY,
  9996           DFHEIV99,
  9997           DFHEIV99
  9998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9999
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 189
* EL130.cbl
 10000
 10001     ADD +1                      TO WS-INSURED-ADDR-CNT.
 10002     GO TO 3300-BUILD-NINETY-TRAILER.
 10003
 10004 3290-NO-INSURED-ADDRESS.
 10005      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
 10006
 10007 3300-BUILD-NINETY-TRAILER.
 10008
 10009     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10010     MOVE 'AT'                   TO AT-RECORD-ID.
 10011
 10012     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10013     MOVE CLMCARRI               TO AT-CARRIER.
 10014
 10015     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10016     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10017     MOVE +90                    TO AT-SEQUENCE-NO.
 10018     MOVE '6'                    TO AT-TRAILER-TYPE.
 10019
 10020     IF DIAGL NOT = ZERO
 10021         MOVE DIAGI              TO AT-INFO-LINE-1
 10022     END-IF.
 10023
 10024     IF ICD1L NOT = ZERO
 10025         MOVE ICD1I              TO AT-ICD-CODE-1
 10026     END-IF.
 10027
 10028     IF ICD2L NOT = ZERO
 10029         MOVE ICD2I              TO AT-ICD-CODE-2
 10030     END-IF.
 10031
 10032     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10033                                    AT-GEN-INFO-LAST-MAINT-DT.
 10034
 10035     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10036                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10037     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10038
 10039
 10040
 10041* EXEC CICS WRITE
 10042*        DATASET   (ELTRLR-DSID)
 10043*        FROM      (ACTIVITY-TRAILERS)
 10044*        RIDFLD    (AT-CONTROL-PRIMARY)
 10045*    END-EXEC.
 10046     MOVE LENGTH OF
 10047      ACTIVITY-TRAILERS
 10048       TO DFHEIV11
 10049*    MOVE '&$ L                  ''   #00009400' TO DFHEIV0
 10050     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10051     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10052     MOVE X'2020233030303039343030' TO DFHEIV0(25:11)
 10053     CALL 'kxdfhei1' USING DFHEIV0,
 10054           ELTRLR-DSID,
 10055           ACTIVITY-TRAILERS,
 10056           DFHEIV11,
 10057           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 190
* EL130.cbl
 10058           DFHEIV99,
 10059           DFHEIV99
 10060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10061
 10062
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 191
* EL130.cbl
 10064 3400-CHECK-CERT-MAINT.
 10065
 10066     IF CERTMTI = 'A'
 10067         GO TO 3600-BUILD-NEW-CERT
 10068     END-IF.
 10069
 10070     IF NO-CLAIM-ATTACHED
 10071         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
 10072     END-IF.
 10073
 10074     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
 10075
 10076     IF CM-LF-CURRENT-STATUS = '2' OR
 10077        CM-AH-CURRENT-STATUS = '2'
 10078         GO TO 3400-REWRITE-CERT
 10079     END-IF.
 10080
 10081     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10082
 10083 3400-REWRITE-CERT.
 10084
 10085
 10086
 10087* EXEC CICS HANDLE CONDITION
 10088*        DUPKEY (3410-DUP-KEY)
 10089*    END-EXEC.
 10090*    MOVE '"$$                   ! 8 #00009429' TO DFHEIV0
 10091     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10093     MOVE X'3820233030303039343239' TO DFHEIV0(25:11)
 10094     CALL 'kxdfhei1' USING DFHEIV0
 10095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10096
 10097
 10098
 10099
 10100* EXEC CICS REWRITE
 10101*        DATASET   (ELCERT-DSID)
 10102*        FROM      (CERTIFICATE-MASTER)
 10103*    END-EXEC.
 10104     MOVE LENGTH OF
 10105      CERTIFICATE-MASTER
 10106       TO DFHEIV11
 10107*    MOVE '&& L                  %   #00009434' TO DFHEIV0
 10108     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10109     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10110     MOVE X'2020233030303039343334' TO DFHEIV0(25:11)
 10111     CALL 'kxdfhei1' USING DFHEIV0,
 10112           ELCERT-DSID,
 10113           CERTIFICATE-MASTER,
 10114           DFHEIV11,
 10115           DFHEIV99
 10116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10117
 10118
 10119 3410-DUP-KEY.
 10120     GO TO 3800-BUILD-NEW-CLAIM.
 10121
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 192
* EL130.cbl
 10122 3600-BUILD-NEW-CERT.
 10123
 10124
 10125* EXEC CICS GETMAIN
 10126*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10127*        LENGTH   (ELCERT-LENGTH)
 10128*    END-EXEC.
 10129*    MOVE '," L                  $   #00009444' TO DFHEIV0
 10130     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10131     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10132     MOVE X'2020233030303039343434' TO DFHEIV0(25:11)
 10133     CALL 'kxdfhei1' USING DFHEIV0,
 10134           DFHEIV20,
 10135           ELCERT-LENGTH,
 10136           DFHEIV99
 10137     SET ADDRESS OF CERTIFICATE-MASTER TO
 10138         DFHEIV20
 10139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10140
 10141
 10142     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10143
 10144     MOVE 'CM'                   TO CM-RECORD-ID.
 10145
 10146     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10147                                    CM-COMPANY-CD-A1
 10148                                    CM-COMPANY-CD-A2
 10149                                    CM-COMPANY-CD-A4
 10150                                    CM-COMPANY-CD-A5.
 10151
 10152     MOVE CERT-CARRIER           TO CM-CARRIER.
 10153     MOVE CERT-GROUPING          TO CM-GROUPING.
 10154     MOVE CERT-STATE             TO CM-STATE.
 10155     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10156     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10157     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10158
 10159     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10160                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10161                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10162                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10163                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10164                       CM-LIVES              CM-LOAN-TERM
 10165                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10166                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10167                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10168                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10169                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10170                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10171                       CM-LF-ALT-PREMIUM-RATE
 10172                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10173                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10174                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10175                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10176                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10177
 10178     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10179                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 193
* EL130.cbl
 10180                                    CM-AH-SETTLEMENT-DT
 10181                                    CM-AH-CANCEL-EXIT-DT
 10182                                    CM-AH-SETTLEMENT-EXIT-DT
 10183                                    CM-LF-LOAN-EXPIRE-DT
 10184                                    CM-LF-CANCEL-DT
 10185                                    CM-LF-DEATH-DT
 10186                                    CM-LF-CANCEL-EXIT-DT
 10187                                    CM-LF-DEATH-EXIT-DT
 10188                                    CM-LAST-ADD-ON-DT
 10189                                    CM-ENTRY-DT.
 10190
 10191     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10192     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10193     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10194
 10195     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10196                                    CM-PART-LAST-NAME-A2
 10197                                    CM-PART-LAST-NAME-A5.
 10198
 10199     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10200                                    CM-INSURED-INITIAL1-A2
 10201                                    CM-INSURED-INITIAL1-A5
 10202                                    CM-INSURED-FIRST-NAME.
 10203
 10204     IF CRTINITL GREATER ZERO
 10205         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10206                                    CM-INSURED-INITIAL2-A2
 10207                                    CM-INSURED-INITIAL2-A5
 10208     ELSE
 10209         MOVE SPACES             TO CM-INSURED-INITIAL2
 10210                                    CM-INSURED-INITIAL2-A2
 10211                                    CM-INSURED-INITIAL2-A5
 10212     END-IF.
 10213
 10214     IF CM-INSURED-INITIALS = SPACES
 10215         MOVE '**'               TO CM-INSURED-INITIALS
 10216     END-IF.
 10217
 10218     IF MEMBERL GREATER ZERO
 10219         MOVE MEMBERI              TO CM-MEMBER-NO
 10220     ELSE
 10221         MOVE CERT-STATE           TO CM-MEMB-STATE
 10222         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10223         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10224         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10225     END-IF.
 10226
 10227     IF JNTLNMEL GREATER ZERO
 10228         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10229     END-IF.
 10230
 10231     IF JNTFNMEL GREATER ZERO
 10232         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10233     END-IF.
 10234
 10235     IF JNTINITL GREATER ZERO
 10236         MOVE JNTINITI           TO CM-JT-INITIAL
 10237     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 194
* EL130.cbl
 10238
 10239     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10240
 10241
 10242
 10243* EXEC CICS HANDLE CONDITION
 10244*        DUPKEY   (3690-CERT-WRITTEN)
 10245*    END-EXEC.
 10246*    MOVE '"$$                   ! 9 #00009549' TO DFHEIV0
 10247     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10249     MOVE X'3920233030303039353439' TO DFHEIV0(25:11)
 10250     CALL 'kxdfhei1' USING DFHEIV0
 10251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10252
 10253
 10254
 10255
 10256* EXEC CICS WRITE
 10257*        DATASET   (ELCERT-DSID)
 10258*        FROM      (CERTIFICATE-MASTER)
 10259*        RIDFLD    (CM-CONTROL-PRIMARY)
 10260*    END-EXEC.
 10261     MOVE LENGTH OF
 10262      CERTIFICATE-MASTER
 10263       TO DFHEIV11
 10264*    MOVE '&$ L                  ''   #00009554' TO DFHEIV0
 10265     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10267     MOVE X'2020233030303039353534' TO DFHEIV0(25:11)
 10268     CALL 'kxdfhei1' USING DFHEIV0,
 10269           ELCERT-DSID,
 10270           CERTIFICATE-MASTER,
 10271           DFHEIV11,
 10272           CM-CONTROL-PRIMARY,
 10273           DFHEIV99,
 10274           DFHEIV99
 10275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10276
 10277
 10278 3690-CERT-WRITTEN.
 10279
 10280     GO TO 3800-BUILD-NEW-CLAIM.
 10281
 10282 3690-EXIT.
 10283      EXIT.
 10284
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 195
* EL130.cbl
 10286 3700-BUILD-CERT.
 10287
 10288     IF CERTMTI NOT = 'A'
 10289         GO TO 3700-FINISH-CERT-BUILD
 10290     END-IF.
 10291
 10292     IF CERTMTI = 'A'
 10293         IF LCVCDL = ZEROS
 10294             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10295                                    CM-LF-ORIG-TERM
 10296                                    CM-LF-BENEFIT-AMT
 10297                                    CM-LF-PREMIUM-RATE
 10298             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10299         END-IF
 10300     END-IF.
 10301
 10302     IF LCVCDL GREATER ZERO
 10303         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10304     END-IF.
 10305
 10306     IF LCVOTRML GREATER ZERO
 10307         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10308     END-IF.
 10309
 10310     IF LCVBENEL GREATER ZERO
 10311         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10312     END-IF.
 10313
 10314     IF LCVRATEL GREATER ZERO
 10315         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10316     END-IF.
 10317
 10318     IF WS-EXPIRE NOT = LOW-VALUES
 10319         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10320     END-IF.
 10321
 10322     IF LCVFORML GREATER ZERO
 10323         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10324     END-IF.
 10325
 10326     IF LCVCNDTL = ZERO
 10327        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10328     END-IF.
 10329
 10330     IF WS-LCVCNDT NOT = LOW-VALUES
 10331        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10332        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10333        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10334     END-IF.
 10335
 10336     IF CM-LF-CURRENT-STATUS = '7'
 10337        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10338        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10339        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10340                                    CM-LF-DEATH-DT
 10341        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10342     END-IF.
 10343
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 196
* EL130.cbl
 10344     IF CM-LF-CURRENT-STATUS = '8'
 10345        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10346        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10347     END-IF.
 10348
 10349 3700-BUILD-AH-COVERAGE-SIDE.
 10350
 10351     IF CERTMTI = 'A'
 10352         IF ACVCDL = ZEROS
 10353             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10354                                    CM-AH-ORIG-TERM
 10355                                    CM-AH-BENEFIT-AMT
 10356                                    CM-AH-PREMIUM-RATE
 10357             GO TO 3700-COVERAGE-BUILT
 10358         END-IF
 10359     END-IF.
 10360
 10361     IF ACVCDL GREATER ZERO
 10362         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10363     END-IF.
 10364
 10365     IF ACVOTRML GREATER ZERO
 10366         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10367     END-IF.
 10368
 10369     IF ACVBENEL GREATER ZERO
 10370         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10371     END-IF.
 10372
 10373     IF ACVRATEL GREATER ZERO
 10374         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10375     END-IF.
 10376
 10377     IF WS-EXPIRE NOT = LOW-VALUES
 10378         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10379     END-IF.
 10380
 10381     IF ACVFORML GREATER ZERO
 10382         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10383     END-IF.
 10384
 10385     IF ACVCNDTL = ZERO
 10386        GO TO 3700-COVERAGE-BUILT
 10387     END-IF.
 10388
 10389     IF WS-ACVCNDT NOT = LOW-VALUES
 10390        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10391        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10392        GO TO 3700-COVERAGE-BUILT
 10393     END-IF.
 10394
 10395     IF CM-AH-CURRENT-STATUS = '6'
 10396        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10397        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10398        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10399        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10400        GO TO 3700-COVERAGE-BUILT
 10401     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 197
* EL130.cbl
 10402
 10403     IF CM-AH-CURRENT-STATUS = '8'
 10404        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10405        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10406     END-IF.
 10407
 10408 3700-COVERAGE-BUILT.
 10409     IF ISSAGEL GREATER ZERO
 10410         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10411     END-IF.
 10412
 10413     IF JNTAGEL GREATER ZERO
 10414         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10415     END-IF.
 10416
 10417     IF SEXL GREATER ZERO
 10418         MOVE SEXI               TO CM-INSURED-SEX
 10419     END-IF.
 10420
 10421     IF APRL GREATER ZERO
 10422         MOVE WS-APR             TO CM-LOAN-APR
 10423     END-IF.
 10424
 10425     IF PMTFREQL GREATER ZERO
 10426         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10427     END-IF.
 10428
 10429     IF INDGRPL GREATER ZERO
 10430         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10431     END-IF.
 10432
 10433     IF CERTMTI = 'A'
 10434         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10435     END-IF.
 10436
 10437     IF REINCDL GREATER ZERO
 10438         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10439                                    WS-REIN-1
 10440                                    WS-REIN-2
 10441                                    WS-REIN-3
 10442         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10443     END-IF.
 10444
 10445     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10446         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10447     END-IF.
 10448
 10449     IF CRTSSNL GREATER ZERO
 10450         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10451     ELSE
 10452         IF SSNL GREATER ZERO
 10453             MOVE SSNI           TO CM-SOC-SEC-NO
 10454         END-IF
 10455     END-IF.
 10456
 10457     IF CRTSSNL = ZERO AND
 10458        SSNL    = ZERO
 10459         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 198
* EL130.cbl
 10460         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10461         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10462         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10463     END-IF.
 10464
 10465     IF CM-LF-CURRENT-STATUS = SPACES
 10466         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10467     END-IF.
 10468
 10469     IF CM-AH-CURRENT-STATUS = SPACES
 10470         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10471     END-IF.
 10472
 10473     IF CERTMTI = 'A'
 10474         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10475     END-IF.
 10476
 10477 3700-FINISH-CERT-BUILD.
 10478
 10479     IF LOANNOL GREATER ZERO
 10480         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10481     END-IF.
 10482
 10483     IF LOANBALL GREATER ZERO
 10484         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10485     END-IF.
 10486
 10487     IF PREMTYPL GREATER ZERO
 10488         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10489     END-IF.
 10490
 10491 3700-EXIT.
 10492      EXIT.
 10493
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 199
* EL130.cbl
 10495 3800-BUILD-NEW-CLAIM.
 10496
 10497*************************************************************
 10498*****           START OF ACTIVITY FILE PROCESSING          **
 10499*************************************************************
 10500     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10501         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10502                 6700-EXIT
 10503     END-IF.
 10504*************************************************************
 10505*****            END OF ACTIVITY FILE PROCESSING           **
 10506*************************************************************
 10507
 10508
 10509
 10510
 10511* EXEC CICS GETMAIN
 10512*        SET     (ADDRESS OF CLAIM-MASTER)
 10513*        LENGTH  (ELMSTR-LENGTH)
 10514*    END-EXEC.
 10515*    MOVE '," L                  $   #00009792' TO DFHEIV0
 10516     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10517     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10518     MOVE X'2020233030303039373932' TO DFHEIV0(25:11)
 10519     CALL 'kxdfhei1' USING DFHEIV0,
 10520           DFHEIV20,
 10521           ELMSTR-LENGTH,
 10522           DFHEIV99
 10523     SET ADDRESS OF CLAIM-MASTER TO
 10524         DFHEIV20
 10525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10526
 10527
 10528     MOVE SPACES TO CLAIM-MASTER.
 10529
 10530     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10531         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10532         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10533         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10534         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10535         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10536         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10537         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10538
 10539     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10540             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10541             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10542             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10543             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10544             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10545             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10546             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10547             CL-FORCEABLE-ERROR-CNT.
 10548
 10549     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10550
 10551     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10552                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 200
* EL130.cbl
 10553                                    CL-LAG-REPORT-CODE
 10554                                    CL-CRITICAL-PERIOD
 10555*                                   CL-CRIT-PER-RTW-MOS
 10556     move 01                     to cl-benefit-period
 10557
 10558     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10559     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10560
 10561     IF BENECDL NOT = ZEROS
 10562        MOVE BENECDI             TO CL-BENEFICIARY
 10563     END-IF.
 10564
 10565     MOVE 'CL'                   TO CL-RECORD-ID.
 10566     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10567
 10568     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10569                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10570                             CL-COMPANY-CD-A5.
 10571
 10572     MOVE CLMCARRI               TO CL-CARRIER.
 10573
 10574     IF CLMNOL = ZERO
 10575         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10576     ELSE
 10577         MOVE CLMNOI             TO CL-CLAIM-NO
 10578     END-IF.
 10579
 10580     MOVE CERTNOI                TO CL-CERT-PRIME
 10581                                    CL-CERT-A4-PRIME.
 10582
 10583     MOVE SUFXI                  TO CL-CERT-SFX
 10584                                    CL-CERT-A4-SFX.
 10585
 10586     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10587
 10588     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10589
 10590     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10591
 10592     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10593
 10594     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10595     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10596
 10597     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10598
 10599     IF CERTMTI = 'A'
 10600         MOVE '2'                TO CL-CERT-ORIGIN
 10601     ELSE
 10602         MOVE '1'                TO CL-CERT-ORIGIN
 10603     END-IF.
 10604
 10605     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10606     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10607     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10608     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10609     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10610
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 201
* EL130.cbl
 10611 3820-REWRITE-CONTROL-FILE.
 10612
 10613     IF CLMNOL GREATER ZERO
 10614         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10615     END-IF.
 10616
 10617     IF CF-RECORD-TYPE = '6'
 10618         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10619     ELSE
 10620         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10621     END-IF.
 10622
 10623
 10624
 10625* EXEC CICS REWRITE
 10626*        DATASET   (ELCNTL-DSID)
 10627*        FROM      (CONTROL-FILE)
 10628*    END-EXEC.
 10629     MOVE LENGTH OF
 10630      CONTROL-FILE
 10631       TO DFHEIV11
 10632*    MOVE '&& L                  %   #00009893' TO DFHEIV0
 10633     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10634     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10635     MOVE X'2020233030303039383933' TO DFHEIV0(25:11)
 10636     CALL 'kxdfhei1' USING DFHEIV0,
 10637           ELCNTL-DSID,
 10638           CONTROL-FILE,
 10639           DFHEIV11,
 10640           DFHEIV99
 10641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10642
 10643
 10644 3830-SEQUENCE-CLAIM-RECORDS.
 10645
 10646     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10647     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10648     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10649
 10650     IF WS-ASSOC-CERT-TOTAL = ZERO
 10651         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10652                                    CL-ASSOC-CERT-TOTAL
 10653         GO TO 3840-WRITE-CLAIM-MASTER
 10654     END-IF.
 10655
 10656     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10657         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10658     ELSE
 10659         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10660     END-IF.
 10661
 10662     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10663     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10664     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10665
 10666 3840-WRITE-CLAIM-MASTER.
 10667
 10668     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 202
* EL130.cbl
 10669     IF WS-REC-FOUND-SW = 'Y'
 10670         MOVE 01                 TO  CL-ACTIVITY-CODE
 10671         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10672         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10673     END-IF.
 10674
 10675
 10676
 10677* EXEC CICS HANDLE CONDITION
 10678*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10679*    END-EXEC.
 10680*    MOVE '"$$                   ! : #00009930' TO DFHEIV0
 10681     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10683     MOVE X'3A20233030303039393330' TO DFHEIV0(25:11)
 10684     CALL 'kxdfhei1' USING DFHEIV0
 10685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10686
 10687
 10688** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10689     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10690
 10691
 10692*       CL-CERT-NO
 10693*    IF CL-COMPANY-CD = X'04'
 10694*    ELSE
 10695*       IF CL-COMPANY-CD = X'05'
 10696*       ELSE
 10697*       END-IF
 10698*    END-IF
 10699
 10700* EXEC CICS WRITE
 10701*        DATASET   (ELMSTR-DSID)
 10702*        FROM      (CLAIM-MASTER)
 10703*        RIDFLD    (CL-CONTROL-PRIMARY)
 10704*    END-EXEC.
 10705     MOVE LENGTH OF
 10706      CLAIM-MASTER
 10707       TO DFHEIV11
 10708*    MOVE '&$ L                  ''   #00009950' TO DFHEIV0
 10709     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10710     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10711     MOVE X'2020233030303039393530' TO DFHEIV0(25:11)
 10712     CALL 'kxdfhei1' USING DFHEIV0,
 10713           ELMSTR-DSID,
 10714           CLAIM-MASTER,
 10715           DFHEIV11,
 10716           CL-CONTROL-PRIMARY,
 10717           DFHEIV99,
 10718           DFHEIV99
 10719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10720
 10721
 10722 3850-CLAIM-MSTR-WRITTEN.
 10723
 10724     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10725         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10726     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 203
* EL130.cbl
 10727
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 204
* EL130.cbl
 10729 3990-ADD-DONE.
 10730*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10731*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10732*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10733*                                  EMI-ERROR-LINES.
 10734
 10735     IF CLMNOL = ZERO
 10736         move spaces             to emi-claim-no
 10737         MOVE ER-0265            TO EMI-ERROR
 10738         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10739         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10740                                    PI-LAST-CLAIM
 10741     ELSE
 10742         MOVE CLMNOI             TO PI-LAST-CLAIM
 10743                                    MSTR-CLAIM-NO
 10744         MOVE ER-0000            TO EMI-ERROR
 10745         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10746     END-IF.
 10747
 10748     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10749       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10750         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10751         MOVE ER-7575            TO EMI-ERROR
 10752         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10753     END-IF.
 10754
 10755     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10756       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10757         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10758         MOVE ER-7582            TO EMI-ERROR
 10759         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10760     END-IF.
 10761
 10762     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 10763        PERFORM 3991-CHECK-2-YEAR-CONTESTABLE THRU 3991-EXIT
 10764     END-IF.
 10765     IF WS-NO-INSURED-ADDRESS = 'Y'
 10766         MOVE ER-3548            TO EMI-ERROR
 10767         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10768     END-IF.
 10769
 10770     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10771       (PI-ST-CAUSAL-STATE = 'L' AND
 10772              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10773       (PI-ST-CAUSAL-STATE = 'A' AND
 10774              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10775         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10776         MOVE ER-7577            TO EMI-ERROR
 10777         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10778     END-IF.
 10779     if pi-company-id = 'DCC' OR 'VPP'
 10780        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10781                                 THRU 3994C-EXIT
 10782     end-if
 10783     IF CLMTYPEI = PI-AH-OVERRIDE-L1
 10784       AND PI-COMPANY-ID = 'CID'
 10785        SET ELAPSED-BETWEEN-BIN TO TRUE
 10786        MOVE ZERO               TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 205
* EL130.cbl
 10787                                   DC-ELAPSED-DAYS
 10788
 10789        MOVE CL-INCURRED-DT  TO DC-BIN-DATE-1
 10790        MOVE WS-TODAY-DT TO DC-BIN-DATE-2
 10791        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10792        IF DC-ODD-DAYS-OVER > ZERO
 10793           ADD 1 TO DC-ELAPSED-MONTHS
 10794        END-IF
 10795
 10796        IF PI-STATE = 'HI'
 10797          AND DC-ELAPSED-MONTHS <= 18
 10798           CONTINUE
 10799        ELSE
 10800           IF DC-ELAPSED-MONTHS > 15
 10801              MOVE ER-7572            TO EMI-ERROR
 10802              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10803              PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10804           END-IF
 10805        END-IF
 10806
 10807     END-IF.
 10808     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10809     MOVE CLMCARRI                   TO  PI-CARRIER.
 10810     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10811     MOVE SUFXI                      TO  PI-CERT-SFX.
 10812
 10813     IF WS-LETTER-SW = 'Y'
 10814         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10815         IF W-1523-ERROR-CODE NOT = ZEROS
 10816             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10817             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10818         END-IF
 10819     END-IF.
 10820
 10821     perform 3998-update-cert-claim-trailer
 10822                                 thru 3998-exit
 10823     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10824     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10825     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10826     MOVE CLMCARRI               TO PI-LAST-CARR.
 10827
 10828     IF PRTOPTL GREATER THAN 0
 10829         MOVE PRTOPTI            TO PI-PRT-OPT
 10830     END-IF.
 10831     IF ALTPRTL GREATER THAN 0
 10832         MOVE ALTPRTI            TO PI-ALT-PRT
 10833     END-IF.
 10834
 10835     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10836         MOVE LOW-VALUES         TO EL130AI
 10837         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10838         MOVE AL-SANON           TO CERTNOA
 10839         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10840         MOVE AL-SANON           TO SUFXA
 10841         MOVE PI-LAST-CARR       TO CLMCARRO
 10842         MOVE AL-UANON           TO CLMCARRA
 10843         MOVE PI-LAST-CLAIM      TO CLMNOO
 10844         MOVE AL-UANON           TO CLMNOA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 206
* EL130.cbl
 10845         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10846         MOVE AL-UANON           TO CLMTYPEA
 10847     ELSE
 10848         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10849         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10850     END-IF.
 10851
 10852     IF PI-PRT-OPT = 'N' OR 'L'
 10853         MOVE PI-PRT-OPT         TO PRTOPTO
 10854         MOVE 1                  TO PRTOPTL
 10855     END-IF.
 10856
 10857     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10858         MOVE PI-ALT-PRT         TO ALTPRTO
 10859         MOVE 4                  TO ALTPRTL
 10860     END-IF.
 10861
 10862     IF PRTOPTL GREATER THAN 0
 10863         IF PRTOPTI = 'L'
 10864             GO TO 0400-CREATE-ELACTQ
 10865         ELSE
 10866             GO TO 0480-PRINT-NOW
 10867         END-IF
 10868     END-IF.
 10869     move 'S'                    to mainti
 10870     PERFORM 0500-CREATE-TEMP-STORAGE
 10871                                 THRU 0599-EXIT
 10872     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10873         GO TO 8100-SEND-INITIAL-MAP
 10874     ELSE
 10875         MOVE LOW-VALUES         TO MAINTO
 10876         MOVE -1                 TO MAINTL
 10877         GO TO 8200-SEND-DATAONLY
 10878     END-IF.
 10879
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 207
* EL130.cbl
 10881 3991-CHECK-2-YEAR-CONTESTABLE.
 10882     SET ELAPSED-BETWEEN-BIN TO TRUE
 10883     MOVE ZERO               TO DC-ELAPSED-MONTHS
 10884                                DC-ELAPSED-DAYS
 10885
 10886     MOVE PI-SAVE-EFFDT  TO DC-BIN-DATE-1.
 10887     MOVE CL-INCURRED-DT TO DC-BIN-DATE-2.
 10888     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10889     IF DC-ODD-DAYS-OVER > ZERO
 10890        ADD 1 TO DC-ELAPSED-MONTHS
 10891     END-IF
 10892
 10893     IF DC-ELAPSED-MONTHS <= 24
 10894        MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 10895        MOVE ZERO           TO DC-ELAPSED-MONTHS
 10896                               DC-ELAPSED-DAYS
 10897        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10898        IF DC-ODD-DAYS-OVER > ZERO
 10899           ADD 1 TO DC-ELAPSED-MONTHS
 10900        END-IF
 10901        IF DC-ELAPSED-MONTHS > 24
 10902           MOVE ER-1679            TO EMI-ERROR
 10903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10904           PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10905        END-IF
 10906     END-IF.
 10907
 10908 3991-EXIT.
 10909     EXIT.
 10910 3992-BUILD-TRAILER.
 10911
 10912     MOVE SPACES             TO AT-GENERAL-INFO-TR
 10913     INITIALIZE AT-GENERAL-INFO-TR
 10914     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 10915     MOVE 'AT'               TO AT-RECORD-ID
 10916     IF EMI-ERROR = ER-7572
 10917        MOVE +97             TO AT-SEQUENCE-NO
 10918     ELSE
 10919        MOVE +96             TO AT-SEQUENCE-NO
 10920     END-IF
 10921     MOVE '6'                TO AT-TRAILER-TYPE
 10922     MOVE WS-TODAY-DT        TO AT-RECORDED-DT
 10923                                AT-GEN-INFO-LAST-MAINT-DT
 10924     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 10925                                AT-GEN-INFO-LAST-UPDATED-BY
 10926     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 10927
 10928     IF EMI-ERROR = ER-7572
 10929        MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 10930     ELSE
 10931        MOVE EMI-LINE2 TO AT-INFO-LINE-1
 10932     END-IF
 10933     MOVE SPACES             TO AT-INFO-LINE-2.
 10934
 10935 3992-WRITE.
 10936
 10937
 10938* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 208
* EL130.cbl
 10939*        DUPREC    (3992-DUPREC)
 10940*    END-EXEC.
 10941*    MOVE '"$%                   ! ; #00010171' TO DFHEIV0
 10942     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10944     MOVE X'3B20233030303130313731' TO DFHEIV0(25:11)
 10945     CALL 'kxdfhei1' USING DFHEIV0
 10946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10947
 10948
 10949
 10950* EXEC CICS WRITE
 10951*         DATASET     ('ELTRLR')
 10952*         FROM        (ACTIVITY-TRAILERS)
 10953*         RIDFLD      (AT-CONTROL-PRIMARY)
 10954*     END-EXEC.
 10955     MOVE LENGTH OF
 10956      ACTIVITY-TRAILERS
 10957       TO DFHEIV11
 10958     MOVE 'ELTRLR' TO DFHEIV1
 10959*    MOVE '&$ L                  ''   #00010175' TO DFHEIV0
 10960     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10961     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10962     MOVE X'2020233030303130313735' TO DFHEIV0(25:11)
 10963     CALL 'kxdfhei1' USING DFHEIV0,
 10964           DFHEIV1,
 10965           ACTIVITY-TRAILERS,
 10966           DFHEIV11,
 10967           AT-CONTROL-PRIMARY,
 10968           DFHEIV99,
 10969           DFHEIV99
 10970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10971
 10972
 10973     GO TO 3992-EXIT.
 10974
 10975 3992-DUPREC.
 10976     SUBTRACT +1 FROM AT-SEQUENCE-NO.
 10977     GO TO 3992-WRITE.
 10978
 10979 3992-EXIT.
 10980     EXIT.
 10981 3993-MODIFY-SCREEN-ATTRB.
 10982
 10983     IF CERTMTL GREATER ZERO
 10984         MOVE AL-UANON           TO CERTMTA
 10985     END-IF.
 10986
 10987     IF EFFDTL GREATER ZERO
 10988         MOVE AL-UANON           TO EFFDTA
 10989     END-IF.
 10990
 10991     IF ACCOUNTL GREATER ZERO
 10992         MOVE AL-UANON           TO ACCOUNTA
 10993     END-IF.
 10994
 10995     IF STATEL GREATER ZERO
 10996         MOVE AL-UANON           TO STATEA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 209
* EL130.cbl
 10997     END-IF.
 10998
 10999     IF CRTCARRL GREATER ZERO
 11000         MOVE AL-UANON           TO CRTCARRA
 11001     END-IF.
 11002
 11003     IF GROUPL GREATER ZERO
 11004         MOVE AL-UANON           TO GROUPA
 11005     END-IF.
 11006
 11007     IF CRTLNMEL GREATER ZERO
 11008         MOVE AL-UANON           TO CRTLNMEA
 11009     END-IF.
 11010
 11011     IF CRTFNMEL GREATER ZERO
 11012         MOVE AL-UANON           TO CRTFNMEA
 11013     END-IF.
 11014
 11015     IF CRTINITL GREATER ZERO
 11016         MOVE AL-UANON           TO CRTINITA
 11017     END-IF.
 11018
 11019     IF ISSAGEL GREATER ZERO
 11020         MOVE AL-UNNON           TO ISSAGEA
 11021     END-IF.
 11022
 11023     IF JNTLNMEL GREATER ZERO
 11024         MOVE AL-UANON           TO JNTLNMEA
 11025     END-IF.
 11026
 11027     IF JNTFNMEL GREATER ZERO
 11028         MOVE AL-UANON           TO JNTFNMEA
 11029     END-IF.
 11030
 11031     IF JNTINITL GREATER ZERO
 11032         MOVE AL-UANON           TO JNTINITA
 11033     END-IF.
 11034
 11035     IF JNTAGEL GREATER ZERO
 11036         MOVE AL-UNNON           TO JNTAGEA
 11037     END-IF.
 11038
 11039     IF CRTSSNL GREATER ZERO
 11040         MOVE AL-UANON           TO CRTSSNA
 11041     END-IF.
 11042
 11043     IF ACVDSCRL GREATER ZERO
 11044         MOVE AL-SANON           TO ACVDSCRA
 11045     END-IF.
 11046
 11047     IF ACVKINDL GREATER ZERO
 11048         MOVE AL-SANON           TO ACVKINDA
 11049     END-IF.
 11050
 11051     IF ACVCDL GREATER ZERO
 11052         MOVE AL-UANON           TO ACVCDA
 11053     END-IF.
 11054
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 210
* EL130.cbl
 11055     IF ACVOTRML GREATER ZERO
 11056         MOVE AL-UNNON           TO ACVOTRMA
 11057     END-IF.
 11058
 11059     IF ACVRTRML GREATER ZERO
 11060         MOVE AL-UNNON           TO ACVRTRMA
 11061     END-IF.
 11062
 11063     IF ACVRATEL GREATER ZERO
 11064         MOVE AL-UNNON           TO ACVRATEA
 11065     END-IF.
 11066
 11067     IF ACVBENEL GREATER ZERO
 11068         MOVE AL-UNNON           TO ACVBENEA
 11069     END-IF.
 11070
 11071     IF ACVFORML GREATER ZERO
 11072         MOVE AL-UANON           TO ACVFORMA
 11073     END-IF.
 11074
 11075     IF ACVCNDTL GREATER ZERO
 11076         MOVE AL-UANON           TO ACVCNDTA
 11077     END-IF.
 11078
 11079     IF ACVEXITL GREATER ZERO
 11080         MOVE AL-UANON           TO ACVEXITA
 11081     END-IF.
 11082
 11083     IF ACVSTATL GREATER ZERO
 11084         MOVE AL-UANON           TO ACVSTATA
 11085     END-IF.
 11086
 11087     IF LCVDSCRL GREATER ZERO
 11088         MOVE AL-SANON           TO LCVDSCRA
 11089     END-IF.
 11090
 11091     IF LCVKINDL GREATER ZERO
 11092         MOVE AL-SANON           TO LCVKINDA
 11093     END-IF.
 11094
 11095     IF LCVCDL GREATER ZERO
 11096         MOVE AL-UANON           TO LCVCDA
 11097     END-IF.
 11098
 11099     IF LCVOTRML GREATER ZERO
 11100         MOVE AL-UNNON           TO LCVOTRMA
 11101     END-IF.
 11102
 11103     IF LCVRTRML GREATER ZERO
 11104         MOVE AL-UNNON           TO LCVRTRMA
 11105     END-IF.
 11106
 11107     IF LCVRATEL GREATER ZERO
 11108         MOVE AL-UNNON           TO LCVRATEA
 11109     END-IF.
 11110
 11111     IF LCVBENEL GREATER ZERO
 11112         MOVE AL-UNNON           TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 211
* EL130.cbl
 11113     END-IF.
 11114
 11115     IF LCVFORML GREATER ZERO
 11116         MOVE AL-UANON           TO LCVFORMA
 11117     END-IF.
 11118
 11119     IF LCVCNDTL GREATER ZERO
 11120         MOVE AL-UANON           TO LCVCNDTA
 11121     END-IF.
 11122
 11123     IF LCVEXITL GREATER ZERO
 11124         MOVE AL-UANON           TO LCVEXITA
 11125     END-IF.
 11126
 11127     IF LCVSTATL GREATER ZERO
 11128         MOVE AL-UANON           TO LCVSTATA
 11129     END-IF.
 11130
 11131     IF MEMCAPL GREATER ZERO
 11132         MOVE AL-UANON           TO MEMCAPA
 11133     END-IF.
 11134
 11135     IF APRL GREATER ZERO
 11136         MOVE AL-UNNON           TO APRA
 11137     END-IF.
 11138
 11139     IF PMTFREQL GREATER ZERO
 11140         MOVE AL-UNNON           TO PMTFREQA
 11141     END-IF.
 11142
 11143     IF INDGRPL GREATER ZERO
 11144         MOVE AL-UANON           TO INDGRPA
 11145     END-IF.
 11146
 11147     IF PREMTYPL GREATER ZERO
 11148         MOVE AL-UANON           TO PREMTYPA
 11149     END-IF.
 11150
 11151     IF REINCDL GREATER ZERO
 11152         MOVE AL-UANON           TO REINCDA
 11153     END-IF.
 11154
 11155     IF ADDONDTL GREATER ZERO
 11156         MOVE AL-UANON           TO ADDONDTA
 11157     END-IF.
 11158
 11159     IF MEMBERL GREATER ZERO
 11160         MOVE AL-UANON           TO MEMBERA
 11161     END-IF.
 11162
 11163     IF BCERT1L GREATER ZERO
 11164         MOVE AL-SANON           TO BCERT1A
 11165                                    BSUFX1A
 11166     END-IF.
 11167
 11168     IF BCERT2L GREATER ZERO
 11169         MOVE AL-SANON           TO BCERT2A
 11170                                    BSUFX2A
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 212
* EL130.cbl
 11171     END-IF.
 11172
 11173     IF BCERT3L GREATER ZERO
 11174         MOVE AL-SANON           TO BCERT3A
 11175                                    BSUFX3A
 11176     END-IF.
 11177
 11178     IF BCERT4L GREATER ZERO
 11179         MOVE AL-SANON           TO BCERT4A
 11180                                    BSUFX4A
 11181     END-IF.
 11182
 11183     IF BCERT5L GREATER ZERO
 11184         MOVE AL-SANON           TO BCERT5A
 11185                                    BSUFX5A
 11186     END-IF.
 11187
 11188 3993-MODIFY-CLAIM-ATTRB.
 11189
 11190     IF PCERTNOL GREATER ZERO
 11191         MOVE AL-UANON           TO PCERTNOA
 11192     END-IF.
 11193
 11194     IF PSUFXL GREATER ZERO
 11195         MOVE AL-UANON           TO PSUFXA
 11196     END-IF.
 11197
 11198     IF LSTNMEL GREATER ZERO
 11199         MOVE AL-UANON           TO LSTNMEA
 11200     END-IF.
 11201
 11202     IF FSTNMEL GREATER ZERO
 11203         MOVE AL-UANON           TO FSTNMEA
 11204     END-IF.
 11205
 11206     IF INITL GREATER ZERO
 11207         MOVE AL-UANON           TO INITA
 11208     END-IF.
 11209
 11210     IF SEXL GREATER ZERO
 11211         MOVE AL-UANON           TO SEXA
 11212     END-IF.
 11213
 11214     IF BIRTHDTL GREATER ZERO
 11215         MOVE AL-UANON           TO BIRTHDTA
 11216     END-IF.
 11217
 11218     IF SSNL GREATER ZERO
 11219         MOVE AL-UANON           TO SSNA
 11220     END-IF.
 11221
 11222     IF INCURL GREATER ZERO
 11223         MOVE AL-UANON           TO INCURA
 11224     END-IF.
 11225
 11226     IF REPORTL GREATER ZERO
 11227         MOVE AL-UANON           TO REPORTA
 11228     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 213
* EL130.cbl
 11229
 11230*    IF ESTENDL GREATER ZERO
 11231*        MOVE AL-UANON           TO ESTENDA
 11232*    END-IF.
 11233
 11234     IF DIAGL GREATER ZERO
 11235         MOVE AL-UANON           TO DIAGA
 11236     END-IF.
 11237*
 11238     IF ICD1L GREATER ZERO
 11239         MOVE AL-UANON           TO ICD1A
 11240     END-IF.
 11241
 11242     IF ICD2L GREATER ZERO
 11243         MOVE AL-UANON           TO ICD2A
 11244     END-IF.
 11245
 11246*    IF CAUSEL GREATER ZERO
 11247*        MOVE AL-UANON           TO CAUSEA
 11248*    END-IF.
 11249
 11250     IF MANRSVL GREATER ZERO
 11251         MOVE AL-UNNON           TO MANRSVA
 11252     END-IF.
 11253
 11254     IF RELCLML GREATER ZERO
 11255         MOVE AL-UANON           TO RELCLMA
 11256     END-IF.
 11257
 11258     IF LOANNOL GREATER ZERO
 11259         MOVE AL-UANON           TO LOANNOA
 11260     END-IF.
 11261
 11262     IF LOANBALL GREATER ZERO
 11263         MOVE AL-UNNON           TO LOANBALA
 11264     END-IF.
 11265
 11266     IF PROCCDL GREATER ZERO
 11267         MOVE AL-UANON           TO PROCCDA
 11268     END-IF.
 11269
 11270     IF BENECDL GREATER THAN ZERO
 11271         MOVE AL-UANON           TO  BENECDA
 11272     END-IF.
 11273
 11274     IF PRICDL GREATER ZERO
 11275         MOVE AL-UANON           TO PRICDA
 11276     END-IF.
 11277
 11278     IF SUPVL GREATER ZERO
 11279         MOVE AL-UANON           TO SUPVA
 11280     END-IF.
 11281
 11282     IF FILETOL GREATER ZERO
 11283         MOVE AL-UANON           TO FILETOA
 11284     END-IF.
 11285
 11286
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 214
* EL130.cbl
 11287 3993-MODIFY-CLAIM-KEY-ATTRB.
 11288
 11289     IF CLMNOL GREATER ZERO
 11290         MOVE AL-UANON           TO CLMNOA
 11291     END-IF.
 11292
 11293     IF CLMCARRL GREATER ZERO
 11294         MOVE AL-UANON           TO CLMCARRA
 11295     END-IF.
 11296
 11297     IF CLMTYPEL GREATER ZERO
 11298         MOVE AL-UANON           TO CLMTYPEA
 11299     END-IF.
 11300
 11301     IF CERTNOL GREATER ZERO
 11302         MOVE AL-SANON           TO CERTNOA
 11303     END-IF.
 11304
 11305     IF SUFXL GREATER ZERO
 11306         MOVE AL-SANON           TO SUFXA
 11307     END-IF.
 11308
 11309 3993-EXIT.
 11310     EXIT.
 11311
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 215
* EL130.cbl
 11313 3994-BUILD-NINETY-THREE-TRAILER.
 11314
 11315     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11316     MOVE 'AT'                   TO AT-RECORD-ID.
 11317
 11318     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11319     MOVE CLMCARRI               TO AT-CARRIER.
 11320
 11321     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11322     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11323     MOVE +93                    TO AT-SEQUENCE-NO.
 11324     MOVE '6'                    TO AT-TRAILER-TYPE.
 11325     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11326
 11327     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11328         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11329     ELSE
 11330         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11331     END-IF
 11332
 11333     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11334                                    AT-GEN-INFO-LAST-MAINT-DT.
 11335
 11336     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11337                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11338     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11339
 11340
 11341
 11342* EXEC CICS WRITE
 11343*        DATASET   (ELTRLR-DSID)
 11344*        FROM      (ACTIVITY-TRAILERS)
 11345*        RIDFLD    (AT-CONTROL-PRIMARY)
 11346*    END-EXEC.
 11347     MOVE LENGTH OF
 11348      ACTIVITY-TRAILERS
 11349       TO DFHEIV11
 11350*    MOVE '&$ L                  ''   #00010549' TO DFHEIV0
 11351     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11352     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11353     MOVE X'2020233030303130353439' TO DFHEIV0(25:11)
 11354     CALL 'kxdfhei1' USING DFHEIV0,
 11355           ELTRLR-DSID,
 11356           ACTIVITY-TRAILERS,
 11357           DFHEIV11,
 11358           AT-CONTROL-PRIMARY,
 11359           DFHEIV99,
 11360           DFHEIV99
 11361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11362
 11363
 11364 3994-EXIT.
 11365     EXIT.
 11366
 11367 3994B-BUILD-NINETY-FOUR-TRAILER.
 11368
 11369     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11370     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 216
* EL130.cbl
 11371
 11372     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11373     MOVE CLMCARRI               TO AT-CARRIER.
 11374
 11375     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11376     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11377     MOVE +94                    TO AT-SEQUENCE-NO.
 11378     MOVE '6'                    TO AT-TRAILER-TYPE.
 11379     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11380
 11381     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11382
 11383     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11384                                    AT-GEN-INFO-LAST-MAINT-DT.
 11385
 11386     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11387                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11388     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11389
 11390
 11391
 11392* EXEC CICS WRITE
 11393*        DATASET   (ELTRLR-DSID)
 11394*        FROM      (ACTIVITY-TRAILERS)
 11395*        RIDFLD    (AT-CONTROL-PRIMARY)
 11396*    END-EXEC.
 11397     MOVE LENGTH OF
 11398      ACTIVITY-TRAILERS
 11399       TO DFHEIV11
 11400*    MOVE '&$ L                  ''   #00010582' TO DFHEIV0
 11401     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11402     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11403     MOVE X'2020233030303130353832' TO DFHEIV0(25:11)
 11404     CALL 'kxdfhei1' USING DFHEIV0,
 11405           ELTRLR-DSID,
 11406           ACTIVITY-TRAILERS,
 11407           DFHEIV11,
 11408           AT-CONTROL-PRIMARY,
 11409           DFHEIV99,
 11410           DFHEIV99
 11411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11412
 11413
 11414 3994B-EXIT.
 11415     EXIT.
 11416 3994C-BUILD-NINETY-FIVE-TRAILER.
 11417
 11418     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11419     MOVE 'AT'                   TO AT-RECORD-ID
 11420
 11421     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11422     MOVE CLMCARRI               TO AT-CARRIER
 11423
 11424     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11425     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11426     MOVE +95                    TO AT-SEQUENCE-NO
 11427     MOVE '6'                    TO AT-TRAILER-TYPE
 11428     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 217
* EL130.cbl
 11429
 11430     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11431                                    AT-GEN-INFO-LAST-MAINT-DT
 11432
 11433     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11434                                    AT-GEN-INFO-LAST-UPDATED-BY
 11435     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11436
 11437     perform varying e1 from +1 by +1 until
 11438        ws-error-no (e1) = spaces
 11439        move ws-error-no (e1)    to at-note-error-no (e1)
 11440     end-perform
 11441
 11442     if at-info-line-1 not = spaces
 11443
 11444* EXEC CICS WRITE
 11445*          DATASET  (ELTRLR-DSID)
 11446*          FROM     (ACTIVITY-TRAILERS)
 11447*          RIDFLD   (AT-CONTROL-PRIMARY)
 11448*       END-EXEC
 11449     MOVE LENGTH OF
 11450      ACTIVITY-TRAILERS
 11451       TO DFHEIV11
 11452*    MOVE '&$ L                  ''   #00010617' TO DFHEIV0
 11453     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11454     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11455     MOVE X'2020233030303130363137' TO DFHEIV0(25:11)
 11456     CALL 'kxdfhei1' USING DFHEIV0,
 11457           ELTRLR-DSID,
 11458           ACTIVITY-TRAILERS,
 11459           DFHEIV11,
 11460           AT-CONTROL-PRIMARY,
 11461           DFHEIV99,
 11462           DFHEIV99
 11463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11464     end-if
 11465
 11466     .
 11467 3994C-EXIT.
 11468     EXIT.
 11469 3995-BUILD-CLAIM-RECORD.
 11470     IF PROCCDL GREATER ZERO
 11471         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11472     ELSE
 11473         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11474     END-IF.
 11475
 11476     IF FSTNMEL GREATER ZERO
 11477         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11478     END-IF.
 11479
 11480     IF INITL GREATER ZERO
 11481         MOVE INITI              TO CL-INSURED-MID-INIT
 11482     END-IF.
 11483
 11484     IF BIRTHDTL GREATER ZERO
 11485         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11486     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 218
* EL130.cbl
 11487
 11488     IF SEXL GREATER ZERO
 11489         MOVE SEXI               TO CL-INSURED-SEX-CD
 11490     END-IF.
 11491
 11492     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11493
 11494*    IF CLMTYPEL GREATER ZERO
 11495     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11496*    END-IF.
 11497
 11498     IF PREMTYPL GREATER ZERO
 11499         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11500     END-IF.
 11501
 11502     IF INCURL GREATER ZERO
 11503         MOVE WS-INCUR           TO CL-INCURRED-DT
 11504     END-IF.
 11505
 11506     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11507        AND (ERPDEF-FOUND)
 11508        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11509*       MOVE WS-CRIT-PER-RECURRENT
 11510*                                TO CL-CRIT-PER-RECURRENT
 11511*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11512        if ws-crit-per-recurrent > 01
 11513           move zeros            to cl-benefit-period
 11514        end-if
 11515     ELSE
 11516        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11517           MOVE CM-LF-CRITICAL-PERIOD
 11518                                 TO CL-CRITICAL-PERIOD
 11519        ELSE
 11520           MOVE CM-AH-CRITICAL-PERIOD
 11521                                 TO CL-CRITICAL-PERIOD
 11522        END-IF
 11523     END-IF
 11524
 11525     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11526        COMPUTE DC-ELAPSED-MONTHS =
 11527           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11528        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11529        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11530        MOVE '6'                 TO DC-OPTION-CODE
 11531        PERFORM 9700-LINK-DATE-CONVERT
 11532                                 THRU 9700-EXIT
 11533        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11534     END-IF
 11535
 11536     if instypel > zero
 11537        move instypei            to cl-insured-type
 11538     end-if
 11539     IF REPORTL GREATER ZERO
 11540         MOVE WS-REPORT          TO CL-REPORTED-DT
 11541     END-IF.
 11542
 11543     IF EIBAID = DFHPF6
 11544         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 219
* EL130.cbl
 11545             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11546                 IF EMI-FORCABLE-CTR = +1
 11547                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11548                 END-IF
 11549         END-IF
 11550     END-IF.
 11551
 11552*    IF ESTENDL GREATER ZERO
 11553*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11554*    END-IF.
 11555
 11556     IF ADDONDTL GREATER ZERO
 11557         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11558     END-IF.
 11559
 11560*    IF CAUSEL GREATER ZERO
 11561*        MOVE CAUSEI             TO CL-CAUSE-CD
 11562*    END-IF.
 11563
 11564     IF SSNL GREATER ZERO
 11565         MOVE SSNI               TO CL-SOC-SEC-NO
 11566     ELSE
 11567         MOVE CERT-STATE         TO CL-SSN-STATE
 11568         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11569         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11570     END-IF.
 11571
 11572     IF PRICDL GREATER ZERO
 11573         MOVE PRICDI             TO CL-PRIORITY-CD
 11574     END-IF.
 11575
 11576     IF SUPVL GREATER ZERO
 11577         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11578     END-IF.
 11579
 11580     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11581     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11582     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11583
 11584     IF RELCLML GREATER ZERO
 11585         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11586     END-IF.
 11587
 11588     IF FILETOL GREATER ZERO
 11589         MOVE FILETOI            TO CL-FILE-LOCATION
 11590     END-IF.
 11591
 11592 3995-EXIT.
 11593      EXIT.
 11594 3996-read-cert-claim-trailer.
 11595
 11596     move cm-ah-benefit-amt      to ws-monthly-benefit
 11597     if (pi-dcc-max-amt < ws-monthly-benefit)
 11598        and (pi-dcc-max-amt not = zeros)
 11599        move pi-dcc-max-amt      to ws-monthly-benefit
 11600     end-if
 11601
 11602     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 220
* EL130.cbl
 11603     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11604     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11605     MOVE CM-STATE               TO CTRLR-STATE
 11606     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11607     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11608     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11609     MOVE 'B'                    TO CTRLR-REC-TYPE
 11610
 11611* EXEC CICS READ
 11612*       DATASET  (ELCRTT-DSID)
 11613*       set     (address of CERTIFICATE-TRAILERS)
 11614*       RIDFLD   (ELCRTT-KEY)
 11615*       RESP     (WS-RESPONSE)
 11616*    END-EXEC
 11617*    MOVE '&"S        E          (  N#00010768' TO DFHEIV0
 11618     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11620     MOVE X'204E233030303130373638' TO DFHEIV0(25:11)
 11621     CALL 'kxdfhei1' USING DFHEIV0,
 11622           ELCRTT-DSID,
 11623           DFHEIV20,
 11624           DFHEIV99,
 11625           ELCRTT-KEY,
 11626           DFHEIV99,
 11627           DFHEIV99,
 11628           DFHEIV99
 11629     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11630         DFHEIV20
 11631     MOVE EIBRESP  TO WS-RESPONSE
 11632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11633***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11634***                                                            ***
 11635***  This may need some work here. I think I should accumulate ***
 11636***  all the claims with the same claim type?????????          ***
 11637***                                                            ***
 11638***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11639     IF WS-RESP-NORMAL
 11640        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11641        perform varying s1 from +1 by +1 until
 11642           (s1 > +24)
 11643           or (cs-claim-no (s1) = spaces)
 11644           if cs-claim-type (s1) = clmtypei
 11645              move er-1659       to ws-error-no (e1)
 11646              compute ws-tot-days-paid =
 11647                 ws-tot-days-paid + cs-days-paid (s1)
 11648              compute ws-tot-amt-paid =
 11649                 ws-tot-amt-paid + cs-total-paid (s1)
 11650           end-if
 11651        end-perform
 11652*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11653*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11654*           and (pi-dcc-max-benefits not = zeros)
 11655*           add +1                to e1
 11656*           MOVE ER-1660          TO EMI-ERROR
 11657*                                    ws-error-no (e1)
 11658*           PERFORM 9900-ERROR-FORMAT
 11659*                                 THRU 9900-EXIT
 11660*        end-if
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 221
* EL130.cbl
 11661     end-if
 11662**       if instypei = 'P'
 11663**          move +1 to s1
 11664**       else
 11665**          MOVE +2 to s1
 11666**       end-if
 11667*
 11668*        move +1 to s1
 11669*        evaluate clmtypei
 11670*           when 'A'
 11671*              move +1 to s2
 11672*           when 'I'
 11673*              move +2 to s2
 11674*           when 'G'
 11675*              move +3 to s2
 11676*           when 'L'
 11677*              move +4 to s2
 11678*           when 'P'
 11679*              move +5 to s2
 11680*        end-evaluate
 11681*        if cs-claim-type (s1 s2) = clmtypei
 11682*           if cs-no-of-claims (s1 s2) > zeros
 11683*              move er-1659       to ws-error-no (e1)
 11684*           end-if
 11685*           compute WS-BENEFITS-PREV-PAID =
 11686*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11687*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11688*              and (pi-dcc-max-benefits not = zeros)
 11689*              add +1             to e1
 11690*              MOVE ER-1660       TO EMI-ERROR
 11691*                                    ws-error-no (e1)
 11692*              PERFORM 9900-ERROR-FORMAT
 11693*                                 THRU 9900-EXIT
 11694*           end-if
 11695*        end-if
 11696*     end-if
 11697
 11698     .
 11699 3996-exit.
 11700     exit.
 11701
 11702 3997-GET-ERPDEF.
 11703
 11704     if cm-clp-state = spaces or low-values or zeros
 11705        move cm-state            to cm-clp-state
 11706     end-if
 11707     MOVE SPACES                 TO WS-ERPDEF-SW
 11708     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11709                                    WS-CRIT-PER-RTW-MOS
 11710                                    WS-CRIT-PER-RECURRENT
 11711
 11712     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11713     MOVE CM-clp-state        TO ERPDEF-STATE
 11714     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11715***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11716***                                                            ***
 11717***  If they set up a claim where there is no coverage on the  ***
 11718***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 222
* EL130.cbl
 11719***  some funky stuff here.                                    ***
 11720***                                                            ***
 11721***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11722
 11723     evaluate true
 11724        when (clmtypei = 'L' or 'P')
 11725           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11726              and 'CU')
 11727           move 'L'              to erpdef-ben-type
 11728           move cm-lf-benefit-cd to erpdef-ben-code
 11729        when (clmtypei not = 'L' and 'P')
 11730           and (cm-ah-benefit-cd not = '00' and '  ')
 11731           move 'A'              to erpdef-ben-type
 11732           move cm-ah-benefit-cd to erpdef-ben-code
 11733        when (clmtypei not = 'L' and 'P')
 11734           and (cm-ah-benefit-cd = '00' or '  ')
 11735           move 'L'              to erpdef-ben-type
 11736           move cm-lf-benefit-cd to erpdef-ben-code
 11737        when (clmtypei = 'L' or 'P')
 11738           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11739           move 'A'              to erpdef-ben-type
 11740           move cm-ah-benefit-cd to erpdef-ben-code
 11741        when other
 11742           move 'A'              to erpdef-ben-type
 11743           move cm-ah-benefit-cd to erpdef-ben-code
 11744     end-evaluate
 11745*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11746*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11747     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11748     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11749
 11750
 11751* EXEC CICS STARTBR
 11752*        DATASET  ('ERPDEF')
 11753*        RIDFLD   (ERPDEF-KEY)
 11754*        GTEQ
 11755*        RESP     (WS-RESPONSE)
 11756*    END-EXEC
 11757     MOVE 'ERPDEF' TO DFHEIV1
 11758     MOVE 0
 11759       TO DFHEIV11
 11760*    MOVE '&,         G          &  N#00010891' TO DFHEIV0
 11761     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11762     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11763     MOVE X'204E233030303130383931' TO DFHEIV0(25:11)
 11764     CALL 'kxdfhei1' USING DFHEIV0,
 11765           DFHEIV1,
 11766           ERPDEF-KEY,
 11767           DFHEIV99,
 11768           DFHEIV11,
 11769           DFHEIV99
 11770     MOVE EIBRESP  TO WS-RESPONSE
 11771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11772
 11773     IF WS-RESP-NORMAL
 11774
 11775* EXEC CICS READNEXT
 11776*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 223
* EL130.cbl
 11777*          INTO     (PRODUCT-MASTER)
 11778*          RIDFLD   (ERPDEF-KEY)
 11779*          RESP     (WS-RESPONSE)
 11780*       END-EXEC
 11781     MOVE LENGTH OF
 11782      PRODUCT-MASTER
 11783       TO DFHEIV12
 11784     MOVE 'ERPDEF' TO DFHEIV1
 11785     MOVE 0
 11786       TO DFHEIV11
 11787*    MOVE '&.IL                  )  N#00010899' TO DFHEIV0
 11788     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11789     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11790     MOVE X'204E233030303130383939' TO DFHEIV0(25:11)
 11791     CALL 'kxdfhei1' USING DFHEIV0,
 11792           DFHEIV1,
 11793           PRODUCT-MASTER,
 11794           DFHEIV12,
 11795           ERPDEF-KEY,
 11796           DFHEIV99,
 11797           DFHEIV11,
 11798           DFHEIV99,
 11799           DFHEIV99
 11800     MOVE EIBRESP  TO WS-RESPONSE
 11801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11802
 11803        IF WS-RESP-NORMAL
 11804           IF (ERPDEF-KEY-SAVE (1:16) =
 11805              PD-CONTROL-PRIMARY (1:16))
 11806              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11807
 11808              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11809                 (A1 > +8)
 11810                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11811              END-PERFORM
 11812              IF A1 < +9
 11813                 SET ERPDEF-FOUND TO TRUE
 11814                 move pd-max-amt (a1)
 11815                              to pi-dcc-max-amt
 11816                 MOVE PD-CRIT-PERIOD (A1)
 11817                              TO WS-MAX-BENEFITS
 11818                                 pi-dcc-max-benefits
 11819                 if pd-rec-crit-period (a1) not numeric
 11820                    move 01      to pd-rec-crit-period (a1)
 11821                 end-if
 11822                 MOVE PD-REC-CRIT-PERIOD (A1)
 11823                              TO WS-CRIT-PER-RECURRENT
 11824                 IF PD-RTW-MOS (A1) NUMERIC
 11825                    MOVE PD-RTW-MOS (A1)
 11826                              TO WS-CRIT-PER-RTW-MOS
 11827                 ELSE
 11828                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11829                 END-IF
 11830                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11831                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11832                                 TO WS-EXCL-PERIOD
 11833                 END-IF
 11834                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 224
* EL130.cbl
 11835                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11836                                 TO WS-COV-ENDS
 11837                 END-IF
 11838                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11839                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11840                                 TO WS-ACC-PERIOD
 11841                 END-IF
 11842                 IF PD-PRE-EXIST-EXCL-TYPE (A1) NUMERIC
 11843                    MOVE PD-PRE-EXIST-EXCL-TYPE (A1)
 11844                                 TO WS-PRE-EXISTING-PER
 11845                 END-IF
 11846              else
 11847                 MOVE -1         TO MAINTL
 11848                 move er-1673    to emi-error
 11849                 PERFORM 9900-ERROR-FORMAT
 11850                                 THRU 9900-EXIT
 11851              END-IF
 11852           else
 11853              MOVE -1            TO MAINTL
 11854              move er-1671       to emi-error
 11855              PERFORM 9900-ERROR-FORMAT
 11856                                 THRU 9900-EXIT
 11857           END-IF
 11858        END-IF
 11859     END-IF
 11860
 11861     .
 11862 3997-EXIT.
 11863     EXIT.
 11864
 11865 3998-update-cert-claim-trailer.
 11866
 11867
 11868* EXEC CICS GETMAIN
 11869*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11870*       LENGTH   (ELCRTT-LENGTH)
 11871*       INITIMG  (GETMAIN-SPACE)
 11872*    END-EXEC
 11873*    MOVE ',"IL                  $   #00010970' TO DFHEIV0
 11874     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11875     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11876     MOVE X'2020233030303130393730' TO DFHEIV0(25:11)
 11877     CALL 'kxdfhei1' USING DFHEIV0,
 11878           DFHEIV20,
 11879           ELCRTT-LENGTH,
 11880           GETMAIN-SPACE
 11881     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11882         DFHEIV20
 11883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11884
 11885     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11886     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11887     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11888     MOVE CM-STATE         TO CTRLR-STATE
 11889     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11890     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11891     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11892     MOVE 'B'              TO CTRLR-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 225
* EL130.cbl
 11893
 11894* EXEC CICS READ
 11895*       UPDATE
 11896*       DATASET  (ELCRTT-DSID)
 11897*       into     (CERTIFICATE-TRAILERS)
 11898*       RIDFLD   (ELCRTT-KEY)
 11899*       RESP     (WS-RESPONSE)
 11900*    END-EXEC
 11901     MOVE LENGTH OF
 11902      CERTIFICATE-TRAILERS
 11903       TO DFHEIV11
 11904*    MOVE '&"IL       EU         (  N#00010984' TO DFHEIV0
 11905     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11906     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11907     MOVE X'204E233030303130393834' TO DFHEIV0(25:11)
 11908     CALL 'kxdfhei1' USING DFHEIV0,
 11909           ELCRTT-DSID,
 11910           CERTIFICATE-TRAILERS,
 11911           DFHEIV11,
 11912           ELCRTT-KEY,
 11913           DFHEIV99,
 11914           DFHEIV99,
 11915           DFHEIV99
 11916     MOVE EIBRESP  TO WS-RESPONSE
 11917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11918     IF WS-RESP-NORMAL
 11919        perform varying s1 from +1 by +1 until
 11920           (s1 > +24)
 11921           or (cs-claim-no (s1) = spaces)
 11922        end-perform
 11923        if s1 < +25
 11924           perform 3999-upd-crt-trlr thru 3999-exit
 11925
 11926* EXEC CICS REWRITE
 11927*             DATASET  (ELCRTT-DSID)
 11928*             from     (CERTIFICATE-TRAILERS)
 11929*             RESP     (WS-RESPONSE)
 11930*          END-EXEC
 11931     MOVE LENGTH OF
 11932      CERTIFICATE-TRAILERS
 11933       TO DFHEIV11
 11934*    MOVE '&& L                  %  N#00010998' TO DFHEIV0
 11935     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11936     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11937     MOVE X'204E233030303130393938' TO DFHEIV0(25:11)
 11938     CALL 'kxdfhei1' USING DFHEIV0,
 11939           ELCRTT-DSID,
 11940           CERTIFICATE-TRAILERS,
 11941           DFHEIV11,
 11942           DFHEIV99
 11943     MOVE EIBRESP  TO WS-RESPONSE
 11944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11945        end-if
 11946     else
 11947        if ws-resp-notfnd
 11948           move 'CS'             to certificate-trailers
 11949           move cm-control-primary to cs-control-primary
 11950           move 'B'              to cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 226
* EL130.cbl
 11951           perform varying s1 from +1 by +1 until s1 > +24
 11952              move zeros         to cs-days-paid (s1)
 11953                                    cs-total-paid (s1)
 11954                                    cs-benefit-period (s1)
 11955                                    cs-remaining-bens (s1)
 11956           end-perform
 11957           move +1               to s1
 11958           perform 3999-upd-crt-trlr
 11959                                 thru 3999-exit
 11960
 11961* EXEC CICS WRITE
 11962*             DATASET  (ELCRTT-DSID)
 11963*             from     (CERTIFICATE-TRAILERS)
 11964*             RIDFLD   (cs-control-primary)
 11965*             RESP     (WS-RESPONSE)
 11966*          END-EXEC
 11967     MOVE LENGTH OF
 11968      CERTIFICATE-TRAILERS
 11969       TO DFHEIV11
 11970*    MOVE '&$ L                  ''  N#00011018' TO DFHEIV0
 11971     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11973     MOVE X'204E233030303131303138' TO DFHEIV0(25:11)
 11974     CALL 'kxdfhei1' USING DFHEIV0,
 11975           ELCRTT-DSID,
 11976           CERTIFICATE-TRAILERS,
 11977           DFHEIV11,
 11978           cs-control-primary,
 11979           DFHEIV99,
 11980           DFHEIV99
 11981     MOVE EIBRESP  TO WS-RESPONSE
 11982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11983        end-if
 11984     END-IF
 11985
 11986     .
 11987 3998-exit.
 11988     exit.
 11989
 11990 3999-upd-crt-trlr.
 11991     move clmnoi                 to cs-claim-no       (s1)
 11992     move clmtypei               to cs-claim-type     (s1)
 11993     move instypei               to cs-insured-type   (s1)
 11994     if ws-crit-per-recurrent > 01
 11995        move zeros               to cs-benefit-period(s1)
 11996     else
 11997        move 01                  to cs-benefit-period(s1)
 11998     end-if
 11999*    move cl-benefit-period      to cs-benefit-period (s1)
 12000*    move cl-critical-period     to cs-remaining-bens (s1)
 12001     move zeros                  to cs-remaining-bens (s1)
 12002     .
 12003 3999-exit.
 12004     exit.
 12005 4000-CALCULATE-CERT-TERM.
 12006
 12007     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 12008
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 227
* EL130.cbl
 12009     MOVE N                      TO WS-TERM.
 12010
 12011     IF WS-TERM GREATER 120
 12012         MOVE 120                TO WS-TERM
 12013     END-IF.
 12014
 12015 4000-CALC-TERM-EXIT.
 12016      EXIT.
 12017
 12018 4100-CALC-GROSS-TERM.
 12019     MOVE HOLD-LOAN-BAL           TO L.
 12020     MOVE WS-ACVBENE              TO M.
 12021     COMPUTE N = L / M.
 12022     IF N LESS 1
 12023         MOVE 1  TO N
 12024     END-IF.
 12025
 12026     IF LCVCDL GREATER ZERO
 12027         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 12028     ELSE
 12029         MOVE ZEROS               TO WS-LF-RATE
 12030     END-IF.
 12031
 12032     IF ACVCDL GREATER ZERO
 12033         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 12034     ELSE
 12035         MOVE ZEROS               TO WS-AH-RATE
 12036     END-IF.
 12037
 12038     COMPUTE I = WS-APR / +1200.
 12039
 12040 4105-LOOP.
 12041     IF N GREATER 240
 12042         GO TO 4200-EXIT
 12043     END-IF.
 12044
 12045     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 12046
 12047     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 12048         ADD 1 TO N
 12049         GO TO 4105-LOOP
 12050     END-IF.
 12051
 12052 4200-EXIT.
 12053      EXIT.
 12054
 12055 4210-CALC-LEFT-RIGHTONE.
 12056      MOVE L         TO LEFT-TOT-1.
 12057      SUBTRACT 1 FROM N.
 12058      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12059      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 12060      ADD 1 TO N.
 12061
 12062 4211-CALC-TERM1.
 12063      MOVE N         TO TERM1.
 12064      MULTIPLY M BY TERM1.
 12065
 12066 4212-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 228
* EL130.cbl
 12067      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 12068      ADD 1 TO A-N.
 12069      MULTIPLY A-N BY TERM1.
 12070      SUBTRACT 1 FROM A-N.
 12071      ADD TERM1 TO LEFT-TOT-1.
 12072
 12073 4213-CALC-TERM2.
 12074      MOVE M         TO TERM2.
 12075      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 12076      MULTIPLY IA-N BY TERM2.
 12077      SUBTRACT TERM2 FROM LEFT-TOT-1.
 12078
 12079 4215-CALC-RIGHTONE.
 12080      MOVE M         TO RIGHT-TOT-1.
 12081      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12082      MULTIPLY A-N BY RIGHT-TOT-1.
 12083
 12084 4220-EXIT.
 12085      EXIT.
 12086
 12087 4300-CALC-A-N.
 12088     IF N LESS 1
 12089         MOVE 0     TO A-N
 12090         GO TO 4300-EXIT
 12091     END-IF.
 12092
 12093     IF I = 0
 12094         MOVE .00001 TO I
 12095     END-IF.
 12096
 12097     ADD 1 TO I.
 12098     DIVIDE I INTO 1 GIVING V.
 12099     SUBTRACT 1 FROM I.
 12100     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12101     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 12102     DIVIDE I INTO TERM3 GIVING A-N.
 12103
 12104 4300-EXIT.
 12105      EXIT.
 12106
 12107 4350-CALC-IA-N.
 12108     IF N LESS 1
 12109         MOVE 0      TO IA-N
 12110         GO TO 4400-EXIT
 12111     END-IF.
 12112
 12113     ADD 1 TO N.
 12114     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12115     SUBTRACT 1 FROM N.
 12116     MULTIPLY N BY V-EX-N GIVING TERM3.
 12117     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 12118     SUBTRACT V FROM 1 GIVING TERM4.
 12119     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 12120
 12121 4400-EXIT.
 12122      EXIT.
 12123
 12124 4450-CALC-V-EX-N.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 229
* EL130.cbl
 12125     IF N LESS 1
 12126         MOVE 1    TO V-EX-N
 12127         GO TO 4490-EXIT
 12128     END-IF.
 12129
 12130     MOVE N        TO NV-STORE.
 12131
 12132     IF V-EX-ONETIME = 1  OR
 12133        V NOT = V-EXPONENT (1)
 12134          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 12135     END-IF.
 12136
 12137 4460-LOOP.
 12138     IF N GREATER 248
 12139         MOVE 248 TO N
 12140     END-IF.
 12141
 12142     IF N = 1
 12143         MOVE V               TO V-EX-N
 12144     ELSE
 12145         MOVE V-EXPONENT (N)  TO V-EX-N
 12146     END-IF.
 12147
 12148     GO TO 4490-EXIT.
 12149
 12150 4470-BUILD-V-EX-TABLE.
 12151     MOVE 2      TO N.
 12152     MOVE V      TO V-EXPONENT (1)
 12153                    V-EX-N.
 12154
 12155 4471-LOOP.
 12156     MULTIPLY V BY V-EX-N.
 12157     MOVE V-EX-N   TO V-EXPONENT (N).
 12158
 12159     ADD 1 TO N.
 12160     IF N LESS 248
 12161         GO TO 4471-LOOP
 12162     END-IF.
 12163
 12164     MOVE NV-STORE     TO N.
 12165     MOVE ZERO         TO V-EX-ONETIME.
 12166
 12167 4480-EXIT.
 12168      EXIT.
 12169
 12170 4490-EXIT.
 12171      EXIT.
 12172
 12173 4500-CALC-NET-TERM.
 12174     MOVE HOLD-LOAN-BAL           TO L.
 12175     MOVE WS-ACVBENE              TO M.
 12176     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 12177
 12178     IF WS-REMAIN GREATER ZERO
 12179         ADD 1 TO N
 12180     END-IF.
 12181
 12182     IF N = 0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 230
* EL130.cbl
 12183         MOVE 1 TO N
 12184     END-IF.
 12185
 12186 4700-EXIT.
 12187      EXIT.
 12188
 12189 4999-CALC-TERM-EXIT.
 12190     EXIT.
 12191
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 231
* EL130.cbl
 12193 5000-INCURRED-CHANGE.
 12194     IF NOT MODIFY-CAP
 12195         MOVE ER-0070            TO EMI-ERROR
 12196         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12197         MOVE -1                 TO MAINTL
 12198         GO TO 8200-SEND-DATAONLY
 12199     END-IF.
 12200
 12201     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 12202        CLMCARRI     NOT = PI-LAST-CARR        OR
 12203        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 12204        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 12205        PI-INCURR-SW NOT = 'Y'
 12206          GO TO 1000-SHOW-CLAIM
 12207     END-IF.
 12208
 12209     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12210     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12211     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12212
 12213     IF EMI-NO-ERRORS
 12214         GO TO 5000-TRY-TO-BUILD
 12215     END-IF.
 12216
 12217     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12218        MOVE ER-0433             TO EMI-ERROR
 12219        MOVE -1                  TO MAINTL
 12220        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12221        GO TO 8200-SEND-DATAONLY
 12222     END-IF.
 12223
 12224     IF EIBAID = DFHPF6
 12225         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12226            MOVE ER-0434         TO EMI-ERROR
 12227            MOVE -1              TO MAINTL
 12228            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12229            GO TO 8200-SEND-DATAONLY
 12230         ELSE
 12231            MOVE +1              TO INCURL
 12232            GO TO 5000-TRY-TO-BUILD
 12233         END-IF
 12234     END-IF.
 12235
 12236     GO TO 8200-SEND-DATAONLY.
 12237
 12238 5000-TRY-TO-BUILD.
 12239
 12240     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12241
 12242     MOVE CLMCARRI               TO MSTR-CARRIER.
 12243
 12244     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12245     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12246     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12247
 12248     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12249
 12250     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 232
* EL130.cbl
 12251         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12252     END-IF.
 12253
 12254     IF CL-PURGED-DT NOT = LOW-VALUES
 12255
 12256
 12257* EXEC CICS UNLOCK
 12258*            DATASET   (ELMSTR-DSID)
 12259*        END-EXEC
 12260*    MOVE '&*                    #   #00011297' TO DFHEIV0
 12261     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12262     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12263     MOVE X'2020233030303131323937' TO DFHEIV0(25:11)
 12264     CALL 'kxdfhei1' USING DFHEIV0,
 12265           ELMSTR-DSID,
 12266           DFHEIV99
 12267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12268         MOVE ER-7691            TO EMI-ERROR
 12269         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12270         MOVE -1                 TO MAINTL
 12271         GO TO 8200-SEND-DATAONLY
 12272     END-IF.
 12273
 12274     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12275
 12276
 12277* EXEC CICS UNLOCK
 12278*            DATASET   (ELMSTR-DSID)
 12279*       END-EXEC
 12280*    MOVE '&*                    #   #00011308' TO DFHEIV0
 12281     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12282     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12283     MOVE X'2020233030303131333038' TO DFHEIV0(25:11)
 12284     CALL 'kxdfhei1' USING DFHEIV0,
 12285           ELMSTR-DSID,
 12286           DFHEIV99
 12287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12288         MOVE ER-0523             TO EMI-ERROR
 12289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12290         MOVE -1                  TO MAINTL
 12291         GO TO 8200-SEND-DATAONLY
 12292     END-IF.
 12293
 12294     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12295
 12296     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12297     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12298     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12299     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12300     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12301
 12302     IF MANRSVL GREATER ZERO
 12303        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12304                                    AT-CURRENT-MANUAL-RESERVE
 12305     END-IF.
 12306     MOVE 1                      TO SUB.
 12307
 12308 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 233
* EL130.cbl
 12309     IF SUB = 1
 12310        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12311        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12312        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12313     ELSE
 12314        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12315        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12316                                    AT-OPEN-CLOSE-REASON (SUB)
 12317     END-IF.
 12318
 12319     IF SUB NOT = 6
 12320        ADD 1                    TO SUB
 12321        GO TO 5010-LOOP
 12322     END-IF.
 12323
 12324 5020-UPDATE.
 12325
 12326     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12327
 12328     IF DIAGL = ZERO
 12329       AND ICD1L = ZERO
 12330       AND ICD2L = ZERO
 12331         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12332         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12333         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12334         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12335         GO TO 5025-BYPASS-UPDATE
 12336     END-IF.
 12337
 12338     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12339
 12340     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12341     IF DIAGL NOT = ZERO
 12342         MOVE DIAGI              TO AT-INFO-LINE-1
 12343     END-IF.
 12344
 12345     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12346     IF ICD1L NOT = ZERO
 12347         MOVE ICD1I              TO AT-ICD-CODE-1
 12348     END-IF.
 12349
 12350     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12351     IF ICD2L NOT = ZERO
 12352         MOVE ICD2I              TO AT-ICD-CODE-2
 12353     END-IF.
 12354
 12355     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12356
 12357 5025-BYPASS-UPDATE.
 12358
 12359
 12360
 12361* EXEC CICS GETMAIN
 12362*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12363*        LENGTH   (ELTRLR-LENGTH)
 12364*    END-EXEC.
 12365*    MOVE '," L                  $   #00011383' TO DFHEIV0
 12366     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 234
* EL130.cbl
 12367     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12368     MOVE X'2020233030303131333833' TO DFHEIV0(25:11)
 12369     CALL 'kxdfhei1' USING DFHEIV0,
 12370           DFHEIV20,
 12371           ELTRLR-LENGTH,
 12372           DFHEIV99
 12373     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12374         DFHEIV20
 12375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12376
 12377
 12378     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12379     MOVE 'AT'                   TO AT-RECORD-ID.
 12380
 12381     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12382     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12383     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12384     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12385     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12386     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12387     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12388     MOVE '9'                    TO AT-TRAILER-TYPE.
 12389     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12390     MOVE '5'                    TO DC-OPTION-CODE.
 12391     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12392     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12393
 12394     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12395     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12396
 12397     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12398     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12399     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12400     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12401     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12402     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12403     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12404     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12405     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12406     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12407     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12408     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12409
 12410     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12411     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12412     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12413     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12414     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12415
 12416
 12417
 12418* EXEC CICS WRITE
 12419*        DATASET   (ELTRLR-DSID)
 12420*        FROM      (ACTIVITY-TRAILERS)
 12421*        RIDFLD    (AT-CONTROL-PRIMARY)
 12422*    END-EXEC.
 12423     MOVE LENGTH OF
 12424      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 235
* EL130.cbl
 12425       TO DFHEIV11
 12426*    MOVE '&$ L                  ''   #00011427' TO DFHEIV0
 12427     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12428     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12429     MOVE X'2020233030303131343237' TO DFHEIV0(25:11)
 12430     CALL 'kxdfhei1' USING DFHEIV0,
 12431           ELTRLR-DSID,
 12432           ACTIVITY-TRAILERS,
 12433           DFHEIV11,
 12434           AT-CONTROL-PRIMARY,
 12435           DFHEIV99,
 12436           DFHEIV99
 12437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12438
 12439
 12440     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12441     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12442     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12443     MOVE CL-CERT-STATE          TO CERT-STATE.
 12444     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12445     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12446     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12447
 12448
 12449
 12450* EXEC CICS HANDLE CONDITION
 12451*        NOTFND   (5050-CERT-NOT-FOUND)
 12452*    END-EXEC.
 12453*    MOVE '"$I                   ! < #00011442' TO DFHEIV0
 12454     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12456     MOVE X'3C20233030303131343432' TO DFHEIV0(25:11)
 12457     CALL 'kxdfhei1' USING DFHEIV0
 12458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12459
 12460
 12461     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12462
 12463     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12464
 12465
 12466
 12467* EXEC CICS HANDLE CONDITION
 12468*         DUPKEY   (5030-CERT-WRITTEN)
 12469*    END-EXEC.
 12470*    MOVE '"$$                   ! = #00011451' TO DFHEIV0
 12471     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12473     MOVE X'3D20233030303131343531' TO DFHEIV0(25:11)
 12474     CALL 'kxdfhei1' USING DFHEIV0
 12475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12476
 12477
 12478
 12479
 12480* EXEC CICS REWRITE
 12481*        DATASET  (ELCERT-DSID)
 12482*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 236
* EL130.cbl
 12483*    END-EXEC.
 12484     MOVE LENGTH OF
 12485      CERTIFICATE-MASTER
 12486       TO DFHEIV11
 12487*    MOVE '&& L                  %   #00011456' TO DFHEIV0
 12488     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12489     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12490     MOVE X'2020233030303131343536' TO DFHEIV0(25:11)
 12491     CALL 'kxdfhei1' USING DFHEIV0,
 12492           ELCERT-DSID,
 12493           CERTIFICATE-MASTER,
 12494           DFHEIV11,
 12495           DFHEIV99
 12496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12497
 12498
 12499 5030-CERT-WRITTEN.
 12500
 12501     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12502                                    CL-INCURRED-DT
 12503                                    CL-REPORTED-DT
 12504                                    CL-EST-END-OF-DISAB-DT
 12505                                    CL-PAID-THRU-DT.
 12506
 12507     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12508                                    CL-NO-OF-PMTS-MADE
 12509                                    CL-NO-OF-DAYS-PAID.
 12510
 12511     IF CLAIM-IS-CLOSED
 12512        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12513        MOVE 'O'                 TO CL-CLAIM-STATUS
 12514     END-IF.
 12515
 12516     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12517     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12518     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12519
 12520
 12521
 12522* EXEC CICS HANDLE CONDITION
 12523*         DUPKEY   (5035-CLAIM-WRITTEN)
 12524*    END-EXEC.
 12525*    MOVE '"$$                   ! > #00011483' TO DFHEIV0
 12526     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12528     MOVE X'3E20233030303131343833' TO DFHEIV0(25:11)
 12529     CALL 'kxdfhei1' USING DFHEIV0
 12530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12531
 12532
 12533
 12534
 12535* EXEC CICS REWRITE
 12536*        DATASET   (ELMSTR-DSID)
 12537*        FROM      (CLAIM-MASTER)
 12538*    END-EXEC.
 12539     MOVE LENGTH OF
 12540      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 237
* EL130.cbl
 12541       TO DFHEIV11
 12542*    MOVE '&& L                  %   #00011488' TO DFHEIV0
 12543     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12544     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12545     MOVE X'2020233030303131343838' TO DFHEIV0(25:11)
 12546     CALL 'kxdfhei1' USING DFHEIV0,
 12547           ELMSTR-DSID,
 12548           CLAIM-MASTER,
 12549           DFHEIV11,
 12550           DFHEIV99
 12551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12552
 12553
 12554 5035-CLAIM-WRITTEN.
 12555
 12556     MOVE ER-0000                TO EMI-ERROR.
 12557     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12558
 12559     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12560     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12561     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12562     MOVE CLMCARRI               TO PI-LAST-CARR.
 12563
 12564     IF PRTOPTL GREATER ZERO
 12565         MOVE PRTOPTI            TO PI-PRT-OPT
 12566     END-IF.
 12567
 12568     IF ALTPRTL GREATER ZERO
 12569         MOVE ALTPRTI            TO PI-ALT-PRT
 12570     END-IF.
 12571
 12572     MOVE LOW-VALUES             TO EL130AI.
 12573
 12574     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12575     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12576     MOVE PI-LAST-CARR           TO CLMCARRO.
 12577     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12578
 12579     IF PI-PRT-OPT = 'N' OR 'L'
 12580         MOVE PI-PRT-OPT         TO PRTOPTO
 12581         MOVE 1                  TO PRTOPTL
 12582     END-IF.
 12583
 12584     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12585         MOVE PI-ALT-PRT         TO ALTPRTO
 12586         MOVE 4                  TO ALTPRTL
 12587     END-IF.
 12588
 12589     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12590     MOVE AL-SANON               TO CERTNOA SUFXA.
 12591
 12592     MOVE SPACES                 TO PI-INCURR-SW.
 12593
 12594     IF PRTOPTL GREATER ZERO
 12595         IF PRTOPTI = 'L'
 12596             GO TO 0400-CREATE-ELACTQ
 12597         ELSE
 12598             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 238
* EL130.cbl
 12599         END-IF
 12600     END-IF.
 12601
 12602     GO TO 8100-SEND-INITIAL-MAP.
 12603
 12604 5050-CERT-NOT-FOUND.
 12605
 12606     MOVE ER-0244                TO EMI-ERROR.
 12607     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12608     MOVE -1                     TO CERTNOL.
 12609     GO TO 8200-SEND-DATAONLY.
 12610
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 239
* EL130.cbl
 12612 5500-BUILD-FORM-TRAILER.
 12613*************************************************************
 12614*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12615*************************************************************
 12616
 12617     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12618
 12619     IF  WS-BEN-ALPHA-2 = '30'
 12620         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12621         MOVE '6'                TO DC-OPTION-CODE
 12622         IF CL-CARRIER = 'C'
 12623             MOVE +14            TO DC-ELAPSED-DAYS
 12624             MOVE +0             TO DC-ELAPSED-MONTHS
 12625             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12626             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12627         ELSE
 12628             MOVE +21            TO DC-ELAPSED-DAYS
 12629             MOVE +0             TO DC-ELAPSED-MONTHS
 12630             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12631             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12632         END-IF
 12633     END-IF.
 12634
 12635
 12636
 12637* EXEC CICS GETMAIN
 12638*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12639*         LENGTH   (ELTRLR-LENGTH)
 12640*         INITIMG  (GETMAIN-SPACE)
 12641*    END-EXEC.
 12642*    MOVE ',"IL                  $   #00011575' TO DFHEIV0
 12643     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12644     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12645     MOVE X'2020233030303131353735' TO DFHEIV0(25:11)
 12646     CALL 'kxdfhei1' USING DFHEIV0,
 12647           DFHEIV20,
 12648           ELTRLR-LENGTH,
 12649           GETMAIN-SPACE
 12650     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12651         DFHEIV20
 12652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12653
 12654
 12655     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12656     MOVE 'AT'                   TO AT-RECORD-ID.
 12657
 12658     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12659     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12660     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12661     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12662                                    AT-FORM-LAST-MAINT-DT.
 12663     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12664                                    AT-FORM-LAST-UPDATED-BY.
 12665     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12666     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12667     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12668                                    AT-FORM-RE-SEND-DT
 12669                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 240
* EL130.cbl
 12670                                    AT-EMP-FORM-ANSWERED-DT
 12671                                    AT-PHY-FORM-ANSWERED-DT
 12672                                    AT-EMP-FORM-SEND-ON-DT
 12673                                    AT-FORM-PRINTED-DT
 12674                                    AT-FORM-REPRINT-DT.
 12675     MOVE '1'                    TO AT-FORM-TYPE.
 12676
 12677     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12678                                    AT-INSTRUCT-LN-2
 12679                                    AT-INSTRUCT-LN-3.
 12680
 12681     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12682     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12683
 12684     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12685
 12686     IF AM-EMPLOYER-STMT-USED = 'Y'
 12687        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12688     END-IF.
 12689
 12690
 12691
 12692* EXEC CICS WRITE
 12693*         DATASET  (ELTRLR-DSID)
 12694*         FROM     (ACTIVITY-TRAILERS)
 12695*         RIDFLD   (AT-CONTROL-PRIMARY)
 12696*    END-EXEC.
 12697     MOVE LENGTH OF
 12698      ACTIVITY-TRAILERS
 12699       TO DFHEIV11
 12700*    MOVE '&$ L                  ''   #00011617' TO DFHEIV0
 12701     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12703     MOVE X'2020233030303131363137' TO DFHEIV0(25:11)
 12704     CALL 'kxdfhei1' USING DFHEIV0,
 12705           ELTRLR-DSID,
 12706           ACTIVITY-TRAILERS,
 12707           DFHEIV11,
 12708           AT-CONTROL-PRIMARY,
 12709           DFHEIV99,
 12710           DFHEIV99
 12711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12712
 12713
 12714 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 241
* EL130.cbl
 12716*************************************************************
 12717*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12718*************************************************************
 12719
 12720 5700-BUILD-ARCHIVE-HEADER.
 12721
 12722     MOVE '1'                    TO CNTL-REC-TYPE.
 12723     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12724     MOVE SPACES                 TO CNTL-ACCESS.
 12725
 12726
 12727
 12728* EXEC CICS READ
 12729*         DATASET  (ELCNTL-DSID)
 12730*         SET      (ADDRESS OF CONTROL-FILE)
 12731*         RIDFLD   (ELCNTL-KEY)
 12732*         UPDATE
 12733*    END-EXEC.
 12734*    MOVE '&"S        EU         (   #00011636' TO DFHEIV0
 12735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12736     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12737     MOVE X'2020233030303131363336' TO DFHEIV0(25:11)
 12738     CALL 'kxdfhei1' USING DFHEIV0,
 12739           ELCNTL-DSID,
 12740           DFHEIV20,
 12741           DFHEIV99,
 12742           ELCNTL-KEY,
 12743           DFHEIV99,
 12744           DFHEIV99,
 12745           DFHEIV99
 12746     SET ADDRESS OF CONTROL-FILE TO
 12747         DFHEIV20
 12748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12749
 12750
 12751     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12752
 12753     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12754
 12755
 12756
 12757* EXEC CICS REWRITE
 12758*         FROM     (CONTROL-FILE)
 12759*         DATASET  (ELCNTL-DSID)
 12760*    END-EXEC.
 12761     MOVE LENGTH OF
 12762      CONTROL-FILE
 12763       TO DFHEIV11
 12764*    MOVE '&& L                  %   #00011648' TO DFHEIV0
 12765     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12766     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12767     MOVE X'2020233030303131363438' TO DFHEIV0(25:11)
 12768     CALL 'kxdfhei1' USING DFHEIV0,
 12769           ELCNTL-DSID,
 12770           CONTROL-FILE,
 12771           DFHEIV11,
 12772           DFHEIV99
 12773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 242
* EL130.cbl
 12774
 12775
 12776
 12777
 12778* EXEC CICS HANDLE CONDITION
 12779*         NOTOPEN  (9990-ABEND)
 12780*         DUPKEY   (5799-EXIT)
 12781*    END-EXEC.
 12782*    MOVE '"$J$                  ! ? #00011654' TO DFHEIV0
 12783     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12785     MOVE X'3F20233030303131363534' TO DFHEIV0(25:11)
 12786     CALL 'kxdfhei1' USING DFHEIV0
 12787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12788
 12789
 12790
 12791
 12792* EXEC CICS GETMAIN
 12793*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12794*         LENGTH  (ELARCH-LENGTH)
 12795*    END-EXEC.
 12796*    MOVE '," L                  $   #00011660' TO DFHEIV0
 12797     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12798     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12799     MOVE X'2020233030303131363630' TO DFHEIV0(25:11)
 12800     CALL 'kxdfhei1' USING DFHEIV0,
 12801           DFHEIV20,
 12802           ELARCH-LENGTH,
 12803           DFHEIV99
 12804     SET ADDRESS OF LETTER-ARCHIVE TO
 12805         DFHEIV20
 12806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12807
 12808
 12809     MOVE SPACES                 TO LETTER-ARCHIVE.
 12810     MOVE 'LA'                   TO LA-RECORD-ID.
 12811     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12812                                    LA-ARCHIVE-NO-A1.
 12813     MOVE '4'                    TO LA-RECORD-TYPE
 12814                                    LA-RECORD-TYPE-A1.
 12815     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12816                                    LA-LINE-SEQ-NO-A1.
 12817     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12818                                    LA-COMPANY-CD-A1.
 12819     MOVE CL-CARRIER             TO LA4-CARRIER.
 12820     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12821     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12822     MOVE CL-CERT-STATE          TO LA4-STATE.
 12823     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12824     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12825     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12826     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12827                                    LA4-RESEND-PRINT-DATE
 12828                                    LA4-FORM-REM-PRINT-DT
 12829                                    LA4-RESEND-DATE.
 12830     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12831     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 243
* EL130.cbl
 12832
 12833
 12834
 12835* EXEC CICS WRITE
 12836*         DATASET  (ELARCH-DSID)
 12837*         FROM     (LETTER-ARCHIVE)
 12838*         RIDFLD   (LA-CONTROL-PRIMARY)
 12839*    END-EXEC.
 12840     MOVE LENGTH OF
 12841      LETTER-ARCHIVE
 12842       TO DFHEIV11
 12843*    MOVE '&$ L                  ''   #00011690' TO DFHEIV0
 12844     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12845     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12846     MOVE X'2020233030303131363930' TO DFHEIV0(25:11)
 12847     CALL 'kxdfhei1' USING DFHEIV0,
 12848           ELARCH-DSID,
 12849           LETTER-ARCHIVE,
 12850           DFHEIV11,
 12851           LA-CONTROL-PRIMARY,
 12852           DFHEIV99,
 12853           DFHEIV99
 12854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12855
 12856
 12857 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 244
* EL130.cbl
 12859 6000-EDIT-CLAIM-DATA.
 12860
 12861     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12862     MOVE '2'                    TO DC-OPTION-CODE.
 12863     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12864     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12865
 12866     IF MAINTL NOT = ZERO
 12867         MOVE AL-UANON           TO MAINTA
 12868     END-IF
 12869
 12870     IF CLMNOL GREATER ZERO
 12871         IF CLMNOI = SPACES OR LOW-VALUES
 12872             MOVE -1             TO CLMNOL
 12873             MOVE AL-UABON       TO CLMNOA
 12874             MOVE ER-7688        TO EMI-ERROR
 12875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12876         ELSE
 12877             MOVE AL-UANON       TO CLMNOA
 12878         END-IF
 12879     END-IF.
 12880
 12881     IF CERTNOL = ZERO
 12882         MOVE -1                 TO CERTNOL
 12883         MOVE AL-SABON           TO CERTNOA
 12884         MOVE ER-0203            TO EMI-ERROR
 12885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12886     ELSE
 12887         MOVE AL-SANON           TO CERTNOA
 12888     END-IF.
 12889
 12890     IF SUFXL = ZERO
 12891         MOVE SPACES             TO SUFXI
 12892         MOVE AL-SANON           TO SUFXA
 12893     ELSE
 12894         MOVE AL-SANON           TO SUFXA
 12895     END-IF.
 12896
 12897     IF CLMCARRL = ZERO
 12898         MOVE -1                 TO CLMCARRL
 12899         MOVE ER-0194            TO EMI-ERROR
 12900         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12901     ELSE
 12902         MOVE CLMCARRI           TO PI-CARRIER
 12903         IF PI-NO-CARRIER-SECURITY
 12904             MOVE AL-UANON       TO CLMCARRA
 12905         END-IF
 12906     END-IF.
 12907
 12908     IF CLMTYPEL > ZERO
 12909        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12910           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12911              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12912                        OR
 12913           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12914           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12915              AND PI-AH-OVERRIDE-L1))
 12916              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 245
* EL130.cbl
 12917              MOVE AL-UABON       TO CLMTYPEA
 12918              MOVE ER-7634        TO EMI-ERROR
 12919              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12920        ELSE
 12921           MOVE AL-UANON       TO CLMTYPEA
 12922        END-IF
 12923     ELSE
 12924        IF MAINTI = 'A'
 12925           MOVE -1             TO CLMTYPEL
 12926           MOVE AL-UABON       TO CLMTYPEA
 12927           MOVE ER-0546        TO EMI-ERROR
 12928           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12929        END-IF
 12930     END-IF
 12931     if instypel > ZERO
 12932        if instypei = 'P' OR 'C'
 12933           move al-uanon         to instypea
 12934        else
 12935           MOVE -1               TO INSTYPEL
 12936           MOVE AL-UABON         TO INSTYPEA
 12937           MOVE ER-1654          TO EMI-ERROR
 12938           PERFORM 9900-ERROR-FORMAT
 12939                                 THRU 9900-EXIT
 12940        END-IF
 12941     ELSE
 12942        IF MAINTI = 'A'
 12943           MOVE -1               TO INSTYPEL
 12944           MOVE AL-UABON         TO INSTYPEA
 12945           MOVE ER-1654          TO EMI-ERROR
 12946           PERFORM 9900-ERROR-FORMAT
 12947                                 THRU 9900-EXIT
 12948        END-IF
 12949     END-IF
 12950     if (instypel <> zeros)
 12951        and (emi-error not = er-1654)
 12952        and (instypei = 'C')
 12953        and (crtfnmei = fstnmei)
 12954        move er-1675             to emi-error
 12955        MOVE -1                  TO INSTYPEL
 12956        MOVE AL-UABON            TO INSTYPEA
 12957        PERFORM 9900-ERROR-FORMAT
 12958                                 THRU 9900-EXIT
 12959    end-if
 12960     if (instypel <> zeros)
 12961        and (emi-error not = er-1654)
 12962        and (instypei = 'P')
 12963        and (crtfnmei <> fstnmei)
 12964        move er-1676             to emi-error
 12965        MOVE -1                  TO INSTYPEL
 12966        MOVE AL-UABON            TO INSTYPEA
 12967        PERFORM 9900-ERROR-FORMAT
 12968                                 THRU 9900-EXIT
 12969    end-if
 12970     IF PCERTNOL = ZERO
 12971        MOVE CERTNOI             TO PCERTNOI
 12972        MOVE CERTNOL             TO PCERTNOL
 12973        MOVE AL-UANON            TO PCERTNOA
 12974     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 246
* EL130.cbl
 12975        MOVE AL-UANON            TO PCERTNOA
 12976     END-IF.
 12977
 12978     IF PSUFXL = ZERO
 12979        MOVE SUFXI               TO PSUFXI
 12980        MOVE SUFXL               TO PSUFXL
 12981        MOVE AL-UANON            TO PSUFXA
 12982     ELSE
 12983        MOVE AL-UANON            TO PSUFXA
 12984     END-IF.
 12985
 12986     IF MAINTI = 'I'
 12987         GO TO 6020-EDIT
 12988     END-IF.
 12989
 12990     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12991         MOVE -1                 TO LSTNMEL
 12992         MOVE ER-0236            TO EMI-ERROR
 12993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12994     ELSE
 12995         MOVE AL-UANON           TO LSTNMEA
 12996     END-IF.
 12997     if fstnmel not = zeros
 12998        move al-uanon            to fstnmea
 12999     end-if
 13000     IF SEXL > ZEROS
 13001        IF SEXI = 'M' OR 'F'
 13002           move al-uanon         to sexa
 13003           CONTINUE
 13004        ELSE
 13005           MOVE -1               TO SEXL
 13006           MOVE AL-UABON         TO SEXA
 13007           MOVE ER-0219          TO EMI-ERROR
 13008           PERFORM 9900-ERROR-FORMAT
 13009                                 THRU 9900-EXIT
 13010        END-IF
 13011     ELSE
 13012        IF MAINTI = 'A'
 13013           MOVE -1               TO SEXL
 13014           MOVE AL-UABON         TO SEXA
 13015           MOVE ER-0219          TO EMI-ERROR
 13016           PERFORM 9900-ERROR-FORMAT
 13017                                 THRU 9900-EXIT
 13018        END-IF
 13019     END-IF
 13020     IF SSNL GREATER THAN ZERO
 13021         MOVE SSNI TO WS-SOC-SEC-NUMBER
 13022         IF WS-SOC-SEC-NO NUMERIC AND
 13023           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 13024             NEXT SENTENCE
 13025         ELSE
 13026            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 13027               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 13028               WS-SSN-DASH2 = '-'
 13029                 NEXT SENTENCE
 13030            ELSE
 13031                 MOVE ER-0887        TO  EMI-ERROR
 13032                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 247
* EL130.cbl
 13033                 MOVE AL-UABON       TO  SSNA
 13034                 MOVE -1             TO  SSNL
 13035            END-IF
 13036        END-IF
 13037     END-IF.
 13038
 13039     IF BIRTHDTL = ZERO
 13040         GO TO 6020-EDIT
 13041     END-IF.
 13042
 13043     IF BIRTHDTL GREATER ZERO
 13044         MOVE BIRTHDTI           TO DATE-WORK
 13045         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13046         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13047         MOVE '4'                TO DC-OPTION-CODE
 13048         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13049         IF DATE-CONVERSION-ERROR
 13050             MOVE AL-UABON       TO BIRTHDTA
 13051             MOVE -1             TO BIRTHDTL
 13052             MOVE ER-0220        TO EMI-ERROR
 13053             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13054             GO TO 6020-EDIT
 13055         END-IF
 13056     END-IF.
 13057
 13058******************************************************************
 13059**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 13060**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 13061**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 13062******************************************************************
 13063
 13064     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 13065         MOVE BIRTHDTI           TO  DATE-WORK
 13066         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13067         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 13068         MOVE '4'                TO  DC-OPTION-CODE
 13069         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 13070         MOVE +0                 TO  DC-ELAPSED-MONTHS
 13071                                     DC-ELAPSED-DAYS
 13072         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13073         IF DATE-CONVERSION-ERROR
 13074             MOVE AL-UABON       TO  BIRTHDTA
 13075             MOVE -1             TO  BIRTHDTL
 13076             MOVE ER-0220        TO  EMI-ERROR
 13077             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13078             GO TO 6020-EDIT
 13079         END-IF
 13080     END-IF.
 13081
 13082     MOVE AL-UANON               TO  BIRTHDTA.
 13083     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 13084     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 13085     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 13086
 13087 6020-EDIT.
 13088     IF INCURL GREATER ZERO
 13089         MOVE INCURI             TO DATE-WORK
 13090         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 248
* EL130.cbl
 13091         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13092         MOVE '4'                TO DC-OPTION-CODE
 13093         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13094         IF DATE-CONVERSION-ERROR
 13095             MOVE AL-UABON       TO INCURA
 13096             MOVE -1             TO INCURL
 13097             MOVE ER-0222        TO EMI-ERROR
 13098             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13099         ELSE
 13100             MOVE AL-UANON       TO INCURA
 13101             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 13102             MOVE DC-BIN-DATE-1  TO WS-INCUR
 13103                                    PI-SAVE-INCUR-DT
 13104             IF WS-INCUR GREATER THAN WS-TODAY-DT
 13105                 MOVE ER-0511     TO EMI-ERROR
 13106                 MOVE -1          TO INCURL
 13107                 MOVE AL-UABON    TO INCURA
 13108                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13109             ELSE
 13110*                NEXT SENTENCE
 13111                 CONTINUE
 13112             END-IF
 13113         END-IF
 13114     ELSE
 13115         MOVE ER-0516         TO EMI-ERROR
 13116         MOVE AL-UABON        TO INCURA
 13117         MOVE -1              TO INCURL
 13118         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13119     END-IF.
 13120
 13121     IF REPORTL GREATER ZERO
 13122         MOVE REPORTI            TO DATE-WORK
 13123         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13124         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13125         MOVE '4'                TO DC-OPTION-CODE
 13126         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13127         IF DATE-CONVERSION-ERROR
 13128             MOVE AL-UABON       TO REPORTA
 13129             MOVE -1             TO REPORTL
 13130             MOVE ER-0223        TO EMI-ERROR
 13131             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13132         ELSE
 13133             MOVE AL-UANON       TO REPORTA
 13134             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 13135             MOVE DC-BIN-DATE-1  TO WS-REPORT
 13136             IF WS-REPORT GREATER THAN WS-TODAY-DT
 13137                 MOVE ER-0512     TO EMI-ERROR
 13138                 MOVE -1          TO REPORTL
 13139                 MOVE AL-UABON    TO REPORTA
 13140                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13141             ELSE
 13142*                NEXT SENTENCE
 13143                 CONTINUE
 13144             END-IF
 13145         END-IF
 13146     ELSE
 13147         MOVE ER-0517         TO EMI-ERROR
 13148         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 249
* EL130.cbl
 13149         MOVE AL-UABON        TO REPORTA
 13150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13151     END-IF.
 13152
 13153     IF WS-REPORT NOT = LOW-VALUES
 13154         IF WS-INCUR GREATER THAN WS-REPORT
 13155             MOVE AL-UABON       TO REPORTA
 13156             MOVE -1             TO REPORTL
 13157             MOVE ER-0509        TO EMI-ERROR
 13158             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13159         END-IF
 13160     END-IF.
 13161
 13162     IF ICD1L GREATER THAN ZERO
 13163         IF (ICD1I GREATER THAN SPACES) AND
 13164            (ICD1I(4:1) NOT = '.')
 13165             IF ICD1I(4:1) = ' '
 13166                 MOVE '.' TO ICD1I(4:1)
 13167             ELSE
 13168                 IF ICD1I(8:1) = ' '
 13169                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 13170                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 13171                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 13172                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 13173                     MOVE '.'        TO ICD1I(4:1)
 13174                 END-IF
 13175             END-IF
 13176         END-IF
 13177         IF (ICD1I GREATER THAN SPACES) AND
 13178            (ICD1I(1:1) NOT > ' ' OR
 13179             ICD1I(2:1) NOT > ' ' OR
 13180             ICD1I(3:1) NOT > ' ' OR
 13181             ICD1I(4:1) NOT = '.')
 13182              MOVE ER-0992        TO  EMI-ERROR
 13183              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13184              MOVE AL-UABON       TO ICD1A
 13185              MOVE -1             TO ICD1L
 13186         END-IF
 13187     END-IF.
 13188
 13189     IF ICD2L GREATER THAN ZERO
 13190         IF (ICD2I GREATER THAN SPACES) AND
 13191            (ICD2I(4:1) NOT = '.')
 13192             IF ICD2I(4:1) = ' '
 13193                 MOVE '.' TO ICD2I(4:1)
 13194             ELSE
 13195                 IF ICD2I(8:1) = ' '
 13196                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 13197                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 13198                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 13199                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 13200                     MOVE '.'        TO ICD2I(4:1)
 13201                 END-IF
 13202             END-IF
 13203         END-IF
 13204         IF (ICD2I GREATER THAN SPACES) AND
 13205            (ICD2I(1:1) NOT > ' ' OR
 13206             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 250
* EL130.cbl
 13207             ICD2I(3:1) NOT > ' ' OR
 13208             ICD2I(4:1) NOT = '.')
 13209              MOVE ER-0992        TO  EMI-ERROR
 13210              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13211              MOVE AL-UABON       TO ICD2A
 13212              MOVE -1             TO ICD2L
 13213         END-IF
 13214     END-IF
 13215
 13216*    IF ESTENDL GREATER ZERO
 13217*        MOVE ESTENDI            TO DATE-WORK
 13218*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13219*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13220*        MOVE '4'                TO DC-OPTION-CODE
 13221*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13222*        IF DATE-CONVERSION-ERROR
 13223*            MOVE AL-UABON       TO ESTENDA
 13224*            MOVE -1             TO ESTENDL
 13225*            MOVE ER-0224        TO EMI-ERROR
 13226*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13227*        ELSE
 13228*            MOVE AL-UANON       TO ESTENDA
 13229*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13230*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13231*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13232*               MOVE AL-UABON    TO ESTENDA
 13233*               MOVE -1          TO ESTENDL
 13234*               MOVE ER-0544     TO EMI-ERROR
 13235*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13236*            END-IF
 13237*        END-IF
 13238*    END-IF.
 13239*
 13240*    IF WS-ESTEND NOT = LOW-VALUES
 13241*        IF WS-INCUR GREATER THAN WS-ESTEND
 13242*            MOVE AL-UABON       TO ESTENDA
 13243*            MOVE -1             TO ESTENDL
 13244*            MOVE ER-0510        TO EMI-ERROR
 13245*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13246*        END-IF
 13247*    END-IF.
 13248
 13249     IF PRTOPTL GREATER ZERO
 13250         IF PRTOPTI NOT = 'N' AND 'L'
 13251             MOVE AL-UABON       TO PRTOPTA
 13252             MOVE -1             TO PRTOPTL
 13253             MOVE ER-0334        TO EMI-ERROR
 13254             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13255         END-IF
 13256     END-IF.
 13257
 13258     IF MANRSVL GREATER ZERO
 13259
 13260* EXEC CICS BIF DEEDIT
 13261*            FIELD   (MANRSVI)
 13262*            LENGTH  (9)
 13263*        END-EXEC
 13264     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 251
* EL130.cbl
 13265       TO DFHEIV11
 13266*    MOVE '@"L                   #   #00012098' TO DFHEIV0
 13267     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13268     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13269     MOVE X'2020233030303132303938' TO DFHEIV0(25:11)
 13270     CALL 'kxdfhei1' USING DFHEIV0,
 13271           MANRSVI,
 13272           DFHEIV11
 13273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13274         IF MANRSVI NOT NUMERIC
 13275             MOVE AL-UNBON       TO MANRSVA
 13276             MOVE -1             TO MANRSVL
 13277             MOVE ER-0489        TO EMI-ERROR
 13278             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13279         ELSE
 13280             MOVE AL-UNNON       TO MANRSVA
 13281             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13282         END-IF
 13283     END-IF.
 13284
 13285     MOVE SPACES                 TO ELCNTL-KEY.
 13286
 13287     IF CONTROL-IS-ACTUAL-CARRIER
 13288         MOVE PI-CARRIER         TO CNTL-CARRIER
 13289     ELSE
 13290         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13291     END-IF.
 13292
 13293     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13294     MOVE '6'                    TO CNTL-REC-TYPE.
 13295     MOVE +0                     TO CNTL-SEQ-NO.
 13296
 13297
 13298
 13299* EXEC CICS HANDLE CONDITION
 13300*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13301*    END-EXEC.
 13302*    MOVE '"$I                   ! @ #00012126' TO DFHEIV0
 13303     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13305     MOVE X'4020233030303132313236' TO DFHEIV0(25:11)
 13306     CALL 'kxdfhei1' USING DFHEIV0
 13307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13308
 13309
 13310     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13311
 13312     IF NOT CF-MANUAL-RESERVES-USED AND
 13313           WS-MANRSV GREATER ZERO
 13314         MOVE ER-0518             TO EMI-ERROR
 13315         MOVE -1                  TO MANRSVL
 13316         MOVE AL-UNBON            TO MANRSVA
 13317         MOVE ZEROS               TO WS-MANRSV
 13318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13319     END-IF.
 13320
 13321     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13322     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 252
* EL130.cbl
 13323
 13324     IF SUPVL GREATER ZERO
 13325         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13326             MOVE -1             TO SUPVL
 13327             MOVE AL-UABON       TO SUPVA
 13328             MOVE ER-0230        TO EMI-ERROR
 13329             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13330         ELSE
 13331             MOVE AL-UANON       TO SUPVA
 13332         END-IF
 13333     END-IF.
 13334
 13335     IF PROCCDL = ZERO
 13336        GO TO 6050-CONTINUE-EDITS
 13337     END-IF.
 13338
 13339     MOVE SPACES                 TO ELCNTL-KEY.
 13340     MOVE PROCCDI                TO CNTL-ACCESS.
 13341
 13342     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13343     MOVE '2'                    TO CNTL-REC-TYPE.
 13344     MOVE +0                     TO CNTL-SEQ-NO.
 13345
 13346
 13347
 13348* EXEC CICS HANDLE CONDITION
 13349*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13350*    END-EXEC.
 13351*    MOVE '"$I                   ! A #00012167' TO DFHEIV0
 13352     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13354     MOVE X'4120233030303132313637' TO DFHEIV0(25:11)
 13355     CALL 'kxdfhei1' USING DFHEIV0
 13356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13357
 13358
 13359     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13360
 13361     GO TO 6050-CONTINUE-EDITS.
 13362
 13363 6040-NO-PROCESSOR-RECORD.
 13364     MOVE ER-0019                TO EMI-ERROR.
 13365     MOVE -1                     TO PROCCDL.
 13366     MOVE AL-UABON               TO PROCCDA.
 13367     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13368
 13369 6050-CONTINUE-EDITS.
 13370     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13371           GO TO 6070-CONTINUE-EDITS
 13372     END-IF.
 13373
 13374     MOVE BENECDI                TO BENE-CODE.
 13375     MOVE 'B'                    TO BENE-RCD-TYPE.
 13376     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13377
 13378
 13379
 13380* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 253
* EL130.cbl
 13381*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13382*    END-EXEC.
 13383*    MOVE '"$I                   ! B #00012191' TO DFHEIV0
 13384     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13386     MOVE X'4220233030303132313931' TO DFHEIV0(25:11)
 13387     CALL 'kxdfhei1' USING DFHEIV0
 13388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13389
 13390
 13391
 13392* EXEC CICS READ
 13393*         DATASET   (ELBENE-DSID)
 13394*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13395*         RIDFLD    (ELBENE-KEY)
 13396*    END-EXEC.
 13397*    MOVE '&"S        E          (   #00012195' TO DFHEIV0
 13398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13400     MOVE X'2020233030303132313935' TO DFHEIV0(25:11)
 13401     CALL 'kxdfhei1' USING DFHEIV0,
 13402           ELBENE-DSID,
 13403           DFHEIV20,
 13404           DFHEIV99,
 13405           ELBENE-KEY,
 13406           DFHEIV99,
 13407           DFHEIV99,
 13408           DFHEIV99
 13409     SET ADDRESS OF BENEFICIARY-MASTER TO
 13410         DFHEIV20
 13411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13412
 13413
 13414     GO TO 6070-CONTINUE-EDITS.
 13415
 13416 6060-NO-BENEFICIARY-RECORD.
 13417     MOVE ER-0565                TO EMI-ERROR.
 13418     MOVE -1                     TO BENECDL.
 13419     MOVE AL-UABON               TO BENECDA.
 13420     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13421
 13422
 13423 6070-CONTINUE-EDITS.
 13424     IF CERTMTL GREATER ZERO
 13425         IF CERTMTI NOT = 'A' AND 'S'
 13426             MOVE -1             TO CERTMTL
 13427             MOVE AL-UABON       TO CERTMTA
 13428             MOVE ER-0267        TO EMI-ERROR
 13429             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13430         ELSE
 13431             MOVE AL-UANON       TO CERTMTA
 13432         END-IF
 13433     ELSE
 13434         GO TO 6000-EXIT
 13435     END-IF.
 13436
 13437     IF EFFDTL GREATER ZERO
 13438         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 254
* EL130.cbl
 13439         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13440         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13441         MOVE '4'                TO DC-OPTION-CODE
 13442         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13443         IF DATE-CONVERSION-ERROR
 13444             MOVE AL-UABON       TO EFFDTA
 13445             MOVE -1             TO EFFDTL
 13446             MOVE ER-0231        TO EMI-ERROR
 13447             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13448         ELSE
 13449             MOVE AL-UANON       TO EFFDTA
 13450             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13451             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13452         END-IF
 13453     ELSE
 13454         MOVE ER-0231            TO EMI-ERROR
 13455         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13456         MOVE -1                 TO EFFDTL
 13457         MOVE AL-UABON           TO EFFDTA
 13458     END-IF.
 13459
 13460     IF ACCOUNTL = ZERO
 13461         MOVE ER-0232            TO EMI-ERROR
 13462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13463         MOVE AL-UABON           TO ACCOUNTA
 13464         MOVE -1                 TO ACCOUNTL
 13465     ELSE
 13466         MOVE AL-UANON           TO ACCOUNTA
 13467     END-IF.
 13468
 13469     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13470        (STATEL = ZERO)
 13471         MOVE ER-0233        TO EMI-ERROR
 13472         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13473         MOVE AL-UABON       TO STATEA
 13474         MOVE -1             TO STATEL
 13475     ELSE
 13476         MOVE AL-UANON       TO STATEA
 13477     END-IF.
 13478
 13479     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13480        (CRTCARRL = ZERO)
 13481         MOVE ER-0234        TO EMI-ERROR
 13482         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13483         MOVE AL-UABON       TO CRTCARRA
 13484         MOVE -1             TO CRTCARRL
 13485     ELSE
 13486         MOVE AL-UANON       TO CRTCARRA
 13487     END-IF.
 13488
 13489     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13490        GROUPL = ZERO
 13491         MOVE ER-0235            TO EMI-ERROR
 13492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13493         MOVE AL-UABON           TO GROUPA
 13494         MOVE -1                 TO GROUPL
 13495     ELSE
 13496         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 255
* EL130.cbl
 13497     END-IF.
 13498
 13499     IF CRTLNMEL = ZERO
 13500         IF LSTNMEI = SPACES OR LOW-VALUES
 13501             MOVE ER-0236            TO  EMI-ERROR
 13502             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13503             MOVE AL-UABON           TO  CRTLNMEA
 13504             MOVE -1                 TO  CRTLNMEL
 13505         ELSE
 13506             MOVE LSTNMEI            TO  CRTLNMEI
 13507             MOVE AL-UANON           TO  CRTLNMEA
 13508         END-IF
 13509     ELSE
 13510         MOVE AL-UANON               TO  CRTLNMEA
 13511     END-IF.
 13512
 13513     IF CRTFNMEL = ZERO
 13514         IF FSTNMEI = SPACES OR LOW-VALUES
 13515*            NEXT SENTENCE
 13516             CONTINUE
 13517         ELSE
 13518             MOVE FSTNMEI            TO  CRTFNMEI
 13519             MOVE AL-UANON           TO  CRTFNMEA
 13520         END-IF
 13521     END-IF.
 13522
 13523     IF CRTINITL = ZERO
 13524         IF INITI = SPACES OR LOW-VALUES
 13525*            NEXT SENTENCE
 13526             CONTINUE
 13527         ELSE
 13528             MOVE INITI              TO  CRTINITI
 13529             MOVE AL-UANON           TO  CRTINITA
 13530         END-IF
 13531     END-IF.
 13532
 13533 6000-EXIT.
 13534     EXIT.
 13535
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 256
* EL130.cbl
 13537 6200-EDIT-CERT-DATA.
 13538     IF ISSAGEL GREATER ZERO
 13539         IF ISSAGEI NOT NUMERIC
 13540             MOVE ER-0237        TO EMI-ERROR
 13541             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13542             MOVE -1             TO ISSAGEL
 13543             MOVE AL-UNBON       TO ISSAGEA
 13544         ELSE
 13545             MOVE AL-UNNON       TO ISSAGEA
 13546         END-IF
 13547     END-IF.
 13548
 13549     IF JNTAGEL GREATER ZERO
 13550         IF JNTAGEI NOT NUMERIC
 13551             MOVE ER-0238        TO EMI-ERROR
 13552             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13553             MOVE -1             TO JNTAGEL
 13554             MOVE AL-UNBON       TO JNTAGEA
 13555         ELSE
 13556             MOVE AL-UNNON       TO JNTAGEA
 13557         END-IF
 13558     END-IF.
 13559
 13560     IF LCVCDL GREATER ZERO
 13561         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13562         IF INVALID-BENEFIT-CODE
 13563             MOVE ER-7635        TO EMI-ERROR
 13564             MOVE -1             TO LCVCDL
 13565             MOVE AL-UABON       TO LCVCDA
 13566             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13567         ELSE
 13568             MOVE LCVCDI         TO WS-BEN-HOLD
 13569             MOVE '4'            TO WS-REC-TYPE
 13570             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13571             IF WS-BEN-ALPHA-HOLD = SPACES
 13572                MOVE ER-7635     TO EMI-ERROR
 13573                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13574                MOVE -1          TO LCVCDL
 13575                MOVE AL-UABON    TO LCVCDA
 13576             ELSE
 13577                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13578                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13579                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13580                MOVE AL-UANON           TO LCVCDA
 13581             END-IF
 13582         END-IF
 13583     END-IF.
 13584
 13585     IF ACVCDL GREATER ZERO
 13586         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13587         IF INVALID-BENEFIT-CODE
 13588             MOVE ER-7635        TO EMI-ERROR
 13589             MOVE -1             TO ACVCDL
 13590             MOVE AL-UABON       TO ACVCDA
 13591             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13592         ELSE
 13593             MOVE ACVCDI         TO WS-BEN-HOLD
 13594             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 257
* EL130.cbl
 13595             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13596             IF WS-BEN-ALPHA-HOLD = SPACES
 13597                MOVE ER-7635     TO EMI-ERROR
 13598                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13599                MOVE -1          TO ACVCDL
 13600                MOVE AL-UABON    TO ACVCDA
 13601             ELSE
 13602                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13603                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13604                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13605                MOVE AL-UANON           TO ACVCDA
 13606             END-IF
 13607         END-IF
 13608     END-IF.
 13609
 13610     IF LCVOTRML GREATER ZERO
 13611         IF LCVOTRMI NOT NUMERIC
 13612             MOVE ER-7636        TO EMI-ERROR
 13613             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13614             MOVE -1             TO LCVOTRML
 13615             MOVE AL-UNBON       TO LCVOTRMA
 13616         ELSE
 13617             MOVE AL-UNNON       TO LCVOTRMA
 13618         END-IF
 13619     END-IF.
 13620
 13621     IF ACVOTRML GREATER ZERO
 13622         IF ACVOTRMI NOT NUMERIC
 13623             MOVE ER-7636        TO EMI-ERROR
 13624             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13625             MOVE -1             TO ACVOTRML
 13626             MOVE AL-UNBON       TO ACVOTRMA
 13627         ELSE
 13628             MOVE AL-UNNON       TO ACVOTRMA
 13629         END-IF
 13630     END-IF.
 13631
 13632     IF LCVRATEL GREATER ZERO
 13633
 13634* EXEC CICS BIF DEEDIT
 13635*            FIELD    (LCVRATEI)
 13636*            LENGTH   (06)
 13637*        END-EXEC
 13638     MOVE 06
 13639       TO DFHEIV11
 13640*    MOVE '@"L                   #   #00012420' TO DFHEIV0
 13641     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13642     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13643     MOVE X'2020233030303132343230' TO DFHEIV0(25:11)
 13644     CALL 'kxdfhei1' USING DFHEIV0,
 13645           LCVRATEI,
 13646           DFHEIV11
 13647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13648         IF LCVRATEI NOT NUMERIC
 13649             MOVE AL-UNBON       TO LCVRATEA
 13650             MOVE -1             TO LCVRATEL
 13651             MOVE ER-2280        TO EMI-ERROR
 13652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 258
* EL130.cbl
 13653         ELSE
 13654             MOVE AL-UNNON       TO LCVRATEA
 13655             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13656         END-IF
 13657     END-IF.
 13658
 13659     IF ACVRATEL GREATER ZERO
 13660
 13661* EXEC CICS BIF DEEDIT
 13662*            FIELD    (ACVRATEI)
 13663*            LENGTH   (06)
 13664*        END-EXEC
 13665     MOVE 06
 13666       TO DFHEIV11
 13667*    MOVE '@"L                   #   #00012436' TO DFHEIV0
 13668     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13669     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13670     MOVE X'2020233030303132343336' TO DFHEIV0(25:11)
 13671     CALL 'kxdfhei1' USING DFHEIV0,
 13672           ACVRATEI,
 13673           DFHEIV11
 13674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13675         IF ACVRATEI NOT NUMERIC
 13676             MOVE AL-UNBON       TO ACVRATEA
 13677             MOVE -1             TO ACVRATEL
 13678             MOVE ER-2280        TO EMI-ERROR
 13679             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13680         ELSE
 13681             MOVE AL-UNNON       TO ACVRATEA
 13682             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13683         END-IF
 13684     END-IF.
 13685
 13686     IF LCVBENEL GREATER ZERO
 13687
 13688* EXEC CICS BIF DEEDIT
 13689*            FIELD    (LCVBENEI)
 13690*            LENGTH   (11)
 13691*        END-EXEC
 13692     MOVE 11
 13693       TO DFHEIV11
 13694*    MOVE '@"L                   #   #00012452' TO DFHEIV0
 13695     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13696     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13697     MOVE X'2020233030303132343532' TO DFHEIV0(25:11)
 13698     CALL 'kxdfhei1' USING DFHEIV0,
 13699           LCVBENEI,
 13700           DFHEIV11
 13701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13702         IF LCVBENEI NOT NUMERIC
 13703             MOVE AL-UNBON       TO LCVBENEA
 13704             MOVE -1             TO LCVBENEL
 13705             MOVE ER-7637        TO EMI-ERROR
 13706             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13707         ELSE
 13708             MOVE AL-UNNON       TO LCVBENEA
 13709             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13710         END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 259
* EL130.cbl
 13711     END-IF.
 13712
 13713     IF ACVBENEL GREATER ZERO
 13714
 13715* EXEC CICS BIF DEEDIT
 13716*            FIELD    (ACVBENEI)
 13717*            LENGTH   (11)
 13718*        END-EXEC
 13719     MOVE 11
 13720       TO DFHEIV11
 13721*    MOVE '@"L                   #   #00012468' TO DFHEIV0
 13722     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13723     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13724     MOVE X'2020233030303132343638' TO DFHEIV0(25:11)
 13725     CALL 'kxdfhei1' USING DFHEIV0,
 13726           ACVBENEI,
 13727           DFHEIV11
 13728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13729         IF ACVBENEI NOT NUMERIC
 13730             MOVE AL-UNBON       TO ACVBENEA
 13731             MOVE -1             TO ACVBENEL
 13732             MOVE ER-7637        TO EMI-ERROR
 13733             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13734         ELSE
 13735             MOVE AL-UNNON       TO ACVBENEA
 13736             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13737         END-IF
 13738     END-IF.
 13739
 13740     IF LCVCNDTL GREATER ZERO
 13741         IF LCVCNDTI NOT = SPACES
 13742             MOVE LCVCNDTI        TO DATE-WORK
 13743             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13744             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13745             MOVE '4'             TO DC-OPTION-CODE
 13746             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13747             IF DATE-CONVERSION-ERROR
 13748                 MOVE AL-UABON    TO LCVCNDTA
 13749                 MOVE -1          TO LCVCNDTL
 13750                 MOVE ER-7638     TO EMI-ERROR
 13751                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13752             ELSE
 13753                 MOVE AL-UANON    TO LCVCNDTA
 13754                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13755                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13756             END-IF
 13757         END-IF
 13758     END-IF.
 13759
 13760     IF ACVCNDTL GREATER ZERO
 13761         IF ACVCNDTI NOT = SPACES
 13762             MOVE ACVCNDTI        TO DATE-WORK
 13763             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13764             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13765             MOVE '4'             TO DC-OPTION-CODE
 13766             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13767             IF DATE-CONVERSION-ERROR
 13768                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 260
* EL130.cbl
 13769                 MOVE -1          TO ACVCNDTL
 13770                 MOVE ER-7638     TO EMI-ERROR
 13771                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13772             ELSE
 13773                 MOVE AL-UANON    TO ACVCNDTA
 13774                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13775                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13776             END-IF
 13777         END-IF
 13778     END-IF.
 13779
 13780     IF ADDONDTL GREATER ZERO
 13781         MOVE ADDONDTI        TO DATE-WORK
 13782         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13783         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13784         MOVE '4'             TO DC-OPTION-CODE
 13785         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13786         IF DATE-CONVERSION-ERROR
 13787             MOVE AL-UABON    TO ADDONDTA
 13788             MOVE -1          TO ADDONDTL
 13789             MOVE ER-7651     TO EMI-ERROR
 13790             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13791         ELSE
 13792             MOVE AL-UANON    TO ADDONDTA
 13793             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13794             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13795         END-IF
 13796     END-IF.
 13797
 13798     IF APRL GREATER ZERO
 13799
 13800* EXEC CICS BIF DEEDIT
 13801*            FIELD    (APRI)
 13802*            LENGTH   (8)
 13803*        END-EXEC
 13804     MOVE 8
 13805       TO DFHEIV11
 13806*    MOVE '@"L                   #   #00012542' TO DFHEIV0
 13807     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13808     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13809     MOVE X'2020233030303132353432' TO DFHEIV0(25:11)
 13810     CALL 'kxdfhei1' USING DFHEIV0,
 13811           APRI,
 13812           DFHEIV11
 13813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13814         IF APRI NOT NUMERIC
 13815             MOVE AL-UNBON       TO APRA
 13816             MOVE -1             TO APRL
 13817             MOVE ER-0248        TO EMI-ERROR
 13818             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13819         ELSE
 13820             MOVE AL-UNNON       TO APRA
 13821             MOVE APRI           TO WS-APR APRO
 13822         END-IF
 13823     END-IF.
 13824
 13825     IF PMTFREQL GREATER ZERO
 13826
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 261
* EL130.cbl
 13827* EXEC CICS BIF DEEDIT
 13828*            FIELD   (PMTFREQI)
 13829*            LENGTH  (2)
 13830*        END-EXEC
 13831     MOVE 2
 13832       TO DFHEIV11
 13833*    MOVE '@"L                   #   #00012558' TO DFHEIV0
 13834     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13835     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13836     MOVE X'2020233030303132353538' TO DFHEIV0(25:11)
 13837     CALL 'kxdfhei1' USING DFHEIV0,
 13838           PMTFREQI,
 13839           DFHEIV11
 13840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13841         IF PMTFREQI NOT NUMERIC
 13842             MOVE -1             TO PMTFREQL
 13843             MOVE AL-UNBON       TO PMTFREQA
 13844             MOVE ER-0258        TO EMI-ERROR
 13845             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13846         ELSE
 13847             MOVE AL-UNNON       TO PMTFREQA
 13848             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13849         END-IF
 13850     END-IF.
 13851
 13852     IF INDGRPL GREATER ZERO
 13853         IF INDGRPI = 'I' OR 'G'
 13854             MOVE AL-UANON       TO INDGRPA
 13855         ELSE
 13856             MOVE -1 TO INDGRPL
 13857             MOVE AL-UABON       TO INDGRPA
 13858             MOVE ER-0260        TO EMI-ERROR
 13859             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13860         END-IF
 13861     END-IF.
 13862
 13863     IF LOANBALL GREATER ZERO
 13864         MOVE LOANBALI           TO DEEDIT-FIELD
 13865
 13866* EXEC CICS BIF DEEDIT
 13867*            FIELD   (DEEDIT-FIELD)
 13868*            LENGTH  (12)
 13869*        END-EXEC
 13870     MOVE 12
 13871       TO DFHEIV11
 13872*    MOVE '@"L                   #   #00012586' TO DFHEIV0
 13873     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13874     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13875     MOVE X'2020233030303132353836' TO DFHEIV0(25:11)
 13876     CALL 'kxdfhei1' USING DFHEIV0,
 13877           DEEDIT-FIELD,
 13878           DFHEIV11
 13879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13880         IF DEEDIT-FIELD NOT NUMERIC
 13881             MOVE AL-UNBON       TO LOANBALA
 13882             MOVE -1             TO LOANBALL
 13883             MOVE ER-0247        TO EMI-ERROR
 13884             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 262
* EL130.cbl
 13885         ELSE
 13886             MOVE AL-UNNON       TO LOANBALA
 13887             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13888         END-IF
 13889     END-IF.
 13890
 13891     IF PREMTYPL GREATER ZERO
 13892         IF (PREMTYPI = '1' OR '2' OR '3')
 13893             MOVE AL-UANON       TO PREMTYPA
 13894         ELSE
 13895             MOVE -1             TO PREMTYPL
 13896             MOVE AL-UABON       TO PREMTYPA
 13897             MOVE ER-0227        TO EMI-ERROR
 13898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13899         END-IF
 13900     END-IF.
 13901
 13902     IF REINCDL GREATER ZERO
 13903         MOVE LOW-VALUES         TO  ERREIN-KEY
 13904         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13905         MOVE REINCDI            TO  REIN-CODE-1
 13906                                     REIN-CODE-2
 13907                                     REIN-CODE-3
 13908         MOVE 'A'                TO  REIN-TYPE
 13909         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13910         IF REIN-REC-NOT-FOUND
 13911             MOVE ER-0266        TO  EMI-ERROR
 13912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13913             MOVE -1             TO  REINCDL
 13914             MOVE AL-UABON       TO  REINCDA
 13915         ELSE
 13916             MOVE AL-UANON       TO  REINCDA
 13917         END-IF
 13918     END-IF.
 13919
 13920     IF CERTMTI NOT = 'A'
 13921        GO TO 6200-EXIT
 13922     END-IF.
 13923
 13924     IF PREMTYPI = '1'
 13925         IF LCVCDL GREATER ZERO
 13926             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13927                 MOVE ER-0841        TO  EMI-ERROR
 13928                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13929                 MOVE -1             TO  PREMTYPL
 13930                 MOVE AL-UABON       TO  PREMTYPA
 13931             END-IF
 13932         END-IF
 13933     END-IF.
 13934
 13935     IF PREMTYPI = '1'
 13936         IF ACVCDL GREATER ZERO
 13937             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13938                 MOVE ER-0841        TO  EMI-ERROR
 13939                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13940                 MOVE -1             TO  PREMTYPL
 13941                 MOVE AL-UABON       TO  PREMTYPA
 13942             END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 263
* EL130.cbl
 13943         END-IF
 13944     END-IF.
 13945
 13946     IF PREMTYPI = '2'
 13947         IF LCVCDL GREATER ZERO
 13948             IF (PI-COMPANY-ID = 'HAN') AND
 13949                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13950                        OR
 13951                 WS-LF-SPECIAL-CALC-CD = 'O'
 13952*                NEXT SENTENCE
 13953                 CONTINUE
 13954             ELSE
 13955                 MOVE ER-0840        TO  EMI-ERROR
 13956                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13957                 MOVE -1             TO  PREMTYPL
 13958                 MOVE AL-UABON       TO  PREMTYPA
 13959             END-IF
 13960         END-IF
 13961     END-IF.
 13962
 13963     IF PREMTYPI = '2'
 13964         IF ACVCDL GREATER ZERO
 13965             IF (PI-COMPANY-ID = 'HAN')  AND
 13966                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13967                        OR
 13968                 WS-AH-SPECIAL-CALC-CD = 'O'
 13969*                NEXT SENTENCE
 13970                 CONTINUE
 13971             ELSE
 13972                 MOVE ER-0840        TO  EMI-ERROR
 13973                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13974                 MOVE -1             TO  PREMTYPL
 13975                 MOVE AL-UABON       TO  PREMTYPA
 13976             END-IF
 13977         END-IF
 13978     END-IF.
 13979
 13980     IF LCVCDL = ZEROS
 13981        GO TO 6200-EXIT
 13982     END-IF.
 13983
 13984     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13985         IF PMTFREQI NOT = ZEROS
 13986             MOVE ER-0428        TO EMI-ERROR
 13987             MOVE -1             TO PMTFREQL
 13988             MOVE AL-UNBON       TO PMTFREQA
 13989             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13990             GO TO 6200-CHECK-APR
 13991         END-IF
 13992     END-IF.
 13993
 13994     IF PMTFREQL = ZEROS AND TEX-REG
 13995         MOVE ER-0429            TO EMI-ERROR
 13996         MOVE -1                 TO PMTFREQL
 13997         MOVE AL-UNBON           TO PMTFREQA
 13998         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13999         GO TO 6200-CHECK-APR
 14000     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 264
* EL130.cbl
 14001
 14002     IF LCVOTRMI NOT NUMERIC
 14003         GO TO 6200-CHECK-APR
 14004     END-IF.
 14005
 14006     IF WS-PMTFREQ NOT = ZERO
 14007         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 14008         GIVING DIVIDE-QUOT
 14009         REMAINDER DIVIDE-REM
 14010         IF DIVIDE-REM GREATER ZERO
 14011             MOVE ER-0430            TO EMI-ERROR
 14012             MOVE -1                 TO PMTFREQL
 14013             MOVE AL-UNBON           TO PMTFREQA
 14014             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14015         END-IF
 14016     END-IF.
 14017
 14018 6200-CHECK-APR.
 14019     IF NET-PAY AND APRL = ZEROS
 14020        MOVE ER-0257             TO EMI-ERROR
 14021        MOVE -1                  TO APRL
 14022        MOVE AL-UABON            TO APRA
 14023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14024     END-IF.
 14025
 14026 6200-EXIT.
 14027     EXIT.
 14028
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 265
* EL130.cbl
 14030 6300-REQUIRED-CERT-EDIT.
 14031
 14032     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14033        GO TO 6300-REQUIRED-AH-EDIT
 14034     END-IF
 14035
 14036     IF LCVCDL = ZERO
 14037        MOVE ER-7639             TO EMI-ERROR
 14038        MOVE -1                  TO LCVCDL
 14039        MOVE AL-UABON            TO LCVCDA
 14040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14041     END-IF.
 14042
 14043     IF LCVOTRML = ZERO
 14044        MOVE ER-7670             TO EMI-ERROR
 14045        MOVE -1                  TO LCVOTRML
 14046        MOVE AL-UNBON            TO LCVOTRMA
 14047        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14048     END-IF.
 14049
 14050     IF LCVBENEL = ZERO
 14051        MOVE ER-7671             TO EMI-ERROR
 14052        MOVE -1                  TO LCVBENEL
 14053        MOVE AL-UNBON            TO LCVBENEA
 14054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14055     END-IF.
 14056
 14057     GO TO 6399-EXIT.
 14058
 14059 6300-REQUIRED-AH-EDIT.
 14060
 14061     IF ACVCDL = ZERO
 14062        MOVE ER-7639             TO EMI-ERROR
 14063        MOVE -1                  TO ACVCDL
 14064        MOVE AL-UABON            TO ACVCDA
 14065        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14066     END-IF.
 14067
 14068     IF ACVOTRML = ZERO
 14069         MOVE ER-7670             TO EMI-ERROR
 14070         MOVE -1                  TO ACVOTRML
 14071         MOVE AL-UNBON            TO ACVOTRMA
 14072         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14073     END-IF.
 14074
 14075     IF ACVBENEL = ZERO
 14076        MOVE ER-7671             TO EMI-ERROR
 14077        MOVE -1                  TO ACVBENEL
 14078        MOVE AL-UNBON            TO ACVBENEA
 14079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14080     END-IF.
 14081
 14082 6399-EXIT.
 14083      EXIT.
 14084
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 266
* EL130.cbl
 14086 6400-TEST-CLAIM-REASONABILITY.
 14087
 14088     IF WS-INCUR = LOW-VALUES
 14089        GO TO 6499-EXIT
 14090     END-IF.
 14091
 14092     IF WS-EFFDT NOT = LOW-VALUES
 14093         IF WS-INCUR LESS WS-EFFDT
 14094             MOVE ER-0458          TO EMI-ERROR
 14095             MOVE -1               TO INCURL
 14096             MOVE AL-UABON         TO INCURA
 14097             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14098         END-IF
 14099     END-IF.
 14100
 14101     IF CERTMTI = 'A'
 14102        GO TO 6460-TEST-NEW-CERT
 14103     END-IF.
 14104
 14105     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 14106     MOVE CRTCARRI               TO CERT-CARRIER.
 14107     MOVE GROUPI                 TO CERT-GROUPING.
 14108     MOVE STATEI                 TO CERT-STATE.
 14109     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 14110     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 14111     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 14112
 14113
 14114
 14115* EXEC CICS HANDLE CONDITION
 14116*         DUPKEY   (6499-EXIT)
 14117*         NOTFND   (6499-EXIT)
 14118*    END-EXEC.
 14119*    MOVE '"$$I                  ! C #00012824' TO DFHEIV0
 14120     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 14121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14122     MOVE X'4320233030303132383234' TO DFHEIV0(25:11)
 14123     CALL 'kxdfhei1' USING DFHEIV0
 14124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14125
 14126
 14127     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 14128
 14129     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 14130        'I' OR 'G' OR 'F')
 14131        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14132     ELSE
 14133        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14134     END-IF.
 14135
 14136     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14137     MOVE '6'                    TO DC-OPTION-CODE.
 14138     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14139
 14140     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 14141        and (dc-elapsed-months > zeros)
 14142        MOVE ER-0519             TO EMI-ERROR
 14143        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 267
* EL130.cbl
 14144        MOVE AL-UABON            TO INCURA
 14145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14146     END-IF.
 14147
 14148     IF CLMCARRI NOT = CRTCARRI
 14149        MOVE ER-0562             TO EMI-ERROR
 14150        MOVE AL-UABON            TO CLMCARRA
 14151        MOVE -1                  TO CLMCARRL
 14152        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14153     END-IF.
 14154
 14155     if (pi-company-id = 'DCC' OR 'VPP')
 14156        and (ws-dcc-product-code <> spaces)
 14157        continue
 14158     else
 14159      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 14160        CM-AH-BENEFIT-CD = '00')
 14161                  OR
 14162        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14163        CM-LF-BENEFIT-CD = '00')
 14164         MOVE ER-0521         TO EMI-ERROR
 14165         MOVE AL-UABON        TO CLMTYPEA
 14166         MOVE -1              TO CLMTYPEL
 14167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14168      END-IF
 14169     end-if
 14170*    IF CLMTYPEI = 'I' AND
 14171*       CM-AH-CRITICAL-PERIOD = +0
 14172*        MOVE ER-0521         TO EMI-ERROR
 14173*        MOVE AL-UABON        TO CLMTYPEA
 14174*        MOVE -1              TO CLMTYPEL
 14175*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14176*    END-IF
 14177
 14178*    IF PI-COMPANY-ID = 'CRI'
 14179*        IF MAINTI = 'A'
 14180*            IF CERT-PEND-ISSUE-ERROR  OR
 14181*               CERT-PEND-ISSUE-RETURNED
 14182*                MOVE -1                 TO CERTNOL
 14183*                MOVE AL-UABON           TO CERTNOA
 14184*                MOVE ER-7640            TO EMI-ERROR
 14185*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14186*            END-IF
 14187*        END-IF
 14188*    END-IF.
 14189
 14190     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 14191         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14192         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 14193             GO TO 6450-DATE-ERROR
 14194         END-IF
 14195     END-IF.
 14196
 14197     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 14198         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14199         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 14200             GO TO 6450-DATE-ERROR
 14201         END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 268
* EL130.cbl
 14202     END-IF.
 14203
 14204     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14205         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 14206             GO TO 6450-DATE-ERROR
 14207         END-IF
 14208     END-IF.
 14209
 14210     GO TO 6499-EXIT.
 14211
 14212 6450-DATE-ERROR.
 14213     MOVE ER-0520                TO EMI-ERROR.
 14214     MOVE -1                     TO INCURL.
 14215     MOVE AL-UABON               TO INCURA.
 14216     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14217
 14218*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14219*       (EMI-SEVERITY-SAVE = 'X')
 14220*        ADD 1                TO EMI-FORCABLE-CTR
 14221*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14222*    END-IF.
 14223
 14224     GO TO 6499-EXIT.
 14225
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 269
* EL130.cbl
 14227 6460-TEST-NEW-CERT.
 14228
 14229     IF NOT EMI-NO-ERRORS
 14230        GO TO 6499-EXIT
 14231     END-IF.
 14232
 14233     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14234
 14235     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14236          OR 'F') AND
 14237         ACVOTRML GREATER ZERO)
 14238        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14239     END-IF.
 14240
 14241     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14242         LCVOTRML GREATER ZERO
 14243        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14244     END-IF.
 14245
 14246     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14247
 14248*    IF PI-COMPANY-ID = 'HAN'
 14249*        IF ADDONDTL GREATER ZERO
 14250*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14251*            IF CLMTYPEI = 'A'
 14252*                IF ACVOTRMI NOT = ZEROS
 14253*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14254*                ELSE
 14255*                    NEXT SENTENCE
 14256*                    CONTINUE
 14257*                END-IF
 14258*            ELSE
 14259*                IF LCVOTRMI NOT = ZEROS
 14260*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14261*                END-IF
 14262*            END-IF
 14263*        END-IF
 14264*    END-IF.
 14265
 14266     MOVE '6'                    TO DC-OPTION-CODE.
 14267     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14268
 14269     IF NO-CONVERSION-ERROR
 14270         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14271     END-IF.
 14272
 14273     IF WS-INCUR GREATER THAN WS-EXPIRE
 14274        MOVE ER-0519             TO EMI-ERROR
 14275        MOVE -1                  TO INCURL
 14276        MOVE AL-UABON            TO INCURA
 14277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14278     END-IF.
 14279
 14280     IF CLMCARRI NOT = CRTCARRI
 14281        MOVE ER-0562             TO EMI-ERROR
 14282        MOVE AL-UABON            TO CLMCARRA
 14283        MOVE -1                  TO CLMCARRL
 14284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 270
* EL130.cbl
 14285     END-IF.
 14286
 14287     if (pi-company-id = 'DCC' OR 'VPP')
 14288        and (ws-dcc-product-code <> spaces)
 14289        continue
 14290     else
 14291        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14292           and (ACVCDL = ZEROS)
 14293           MOVE ER-0521          TO EMI-ERROR
 14294           MOVE AL-UABON         TO CLMTYPEA
 14295           MOVE -1               TO CLMTYPEL
 14296           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14297        END-IF
 14298     end-if
 14299
 14300     if (pi-company-id = 'DCC' OR 'VPP')
 14301        and (ws-dcc-product-code <> spaces)
 14302        continue
 14303     else
 14304        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14305           and (LCVCDL = ZEROS)
 14306           MOVE ER-0521          TO EMI-ERROR
 14307           MOVE AL-UABON         TO CLMTYPEA
 14308           MOVE -1               TO CLMTYPEL
 14309           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14310        END-IF
 14311     end-if
 14312
 14313     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14314         IF LCVCNDTL GREATER ZERO
 14315             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14316                 GO TO 6450-DATE-ERROR
 14317             END-IF
 14318         END-IF
 14319     END-IF.
 14320
 14321     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14322         IF ACVCNDTL GREATER ZERO
 14323             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14324                 GO TO 6450-DATE-ERROR
 14325             END-IF
 14326         END-IF
 14327     END-IF.
 14328
 14329 6499-EXIT.
 14330     EXIT.
 14331 6500-get-acct.
 14332
 14333     MOVE SPACES                 TO ERACCT-KEY
 14334                                    ws-dcc-product-code
 14335                                    ws-acct-found-sw
 14336
 14337     IF CARR-GROUP-ST-ACCNT-CNTL
 14338        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14339        MOVE CRTCARRI            TO ACCT-CARRIER
 14340        MOVE GROUPI              TO ACCT-GROUPING
 14341        MOVE STATEI              TO ACCT-STATE
 14342        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 271
* EL130.cbl
 14343        GO TO 6500-startbr
 14344     END-IF
 14345
 14346     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14347     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14348
 14349     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14350        MOVE STATEI             TO ACCT-STATE
 14351     END-IF
 14352
 14353     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14354        MOVE CRTCARRI           TO ACCT-CARRIER
 14355     END-IF
 14356
 14357     .
 14358 6500-startbr.
 14359
 14360     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14361
 14362
 14363* EXEC CICS STARTBR
 14364*       DATASET     (ERACCT2-DSID)
 14365*       RIDFLD      (SAVE-ERACCT-KEY)
 14366*       GENERIC
 14367*       KEYLENGTH   (20)
 14368*       resp        (ws-response)
 14369*    END-EXEC
 14370     MOVE 20
 14371       TO DFHEIV11
 14372     MOVE 0
 14373       TO DFHEIV12
 14374*    MOVE '&,   KG    G          &  N#00013064' TO DFHEIV0
 14375     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14376     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14377     MOVE X'204E233030303133303634' TO DFHEIV0(25:11)
 14378     CALL 'kxdfhei1' USING DFHEIV0,
 14379           ERACCT2-DSID,
 14380           SAVE-ERACCT-KEY,
 14381           DFHEIV11,
 14382           DFHEIV12,
 14383           DFHEIV99
 14384     MOVE EIBRESP  TO ws-response
 14385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14386
 14387     if not ws-resp-normal
 14388        go to 6500-exit
 14389     end-if
 14390
 14391     .
 14392 6500-readnext.
 14393
 14394
 14395* EXEC CICS READNEXT
 14396*       DATASET   (ERACCT2-DSID)
 14397*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14398*       RIDFLD    (SAVE-ERACCT-KEY)
 14399*    END-EXEC
 14400     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 272
* EL130.cbl
 14401       TO DFHEIV11
 14402*    MOVE '&.S                   )   #00013079' TO DFHEIV0
 14403     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14404     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14405     MOVE X'2020233030303133303739' TO DFHEIV0(25:11)
 14406     CALL 'kxdfhei1' USING DFHEIV0,
 14407           ERACCT2-DSID,
 14408           DFHEIV20,
 14409           DFHEIV99,
 14410           SAVE-ERACCT-KEY,
 14411           DFHEIV99,
 14412           DFHEIV11,
 14413           DFHEIV99,
 14414           DFHEIV99
 14415     SET ADDRESS OF ACCOUNT-MASTER TO
 14416         DFHEIV20
 14417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14418
 14419     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14420        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14421        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14422        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14423        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14424        go to 6500-endbr
 14425     END-IF
 14426
 14427     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14428        and (WS-EFFDT < AM-EXPIRATION-DT)
 14429        set acct-found to true
 14430        MOVE AM-dcc-product-code to ws-dcc-product-code
 14431        GO TO 6500-endbr
 14432     END-IF
 14433
 14434     IF WS-EFFDT >= AM-EXPIRATION-DT
 14435         GO TO 6500-readnext
 14436     END-IF
 14437
 14438     .
 14439 6500-endbr.
 14440
 14441
 14442* EXEC CICS ENDBR
 14443*        DATASET    (ERACCT2-DSID)
 14444*    END-EXEC
 14445     MOVE 0
 14446       TO DFHEIV11
 14447*    MOVE '&2                    $   #00013107' TO DFHEIV0
 14448     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14449     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14450     MOVE X'2020233030303133313037' TO DFHEIV0(25:11)
 14451     CALL 'kxdfhei1' USING DFHEIV0,
 14452           ERACCT2-DSID,
 14453           DFHEIV11,
 14454           DFHEIV99
 14455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14456
 14457     .
 14458 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 273
* EL130.cbl
 14459     exit.
 14460 6600-CHECK-AUTO-ACTIVITY.
 14461
 14462
 14463* EXEC CICS HANDLE CONDITION
 14464*        NOTFND   (6600-NOT-FOUND)
 14465*    END-EXEC.
 14466*    MOVE '"$I                   ! D #00013116' TO DFHEIV0
 14467     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14469     MOVE X'4420233030303133313136' TO DFHEIV0(25:11)
 14470     CALL 'kxdfhei1' USING DFHEIV0
 14471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14472
 14473
 14474     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14475     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14476     MOVE SPACES                     TO  CNTL-ACCESS.
 14477     MOVE +0                         TO  CNTL-SEQ-NO.
 14478
 14479     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14480
 14481     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14482         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14483                                         WS-LETTER-SW
 14484         GO TO 6600-EXIT
 14485     END-IF.
 14486
 14487     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14488         MOVE 'N'                     TO  WS-LETTER-SW
 14489     ELSE
 14490         MOVE 'Y'                     TO  WS-LETTER-SW
 14491     END-IF.
 14492
 14493     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14494     GO TO 6600-EXIT.
 14495
 14496 6600-START-AUTO-LETTER-WRITER.
 14497
 14498     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14499     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14500
 14501     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14502
 14503     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14504         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14505         MOVE '6'                     TO  DC-OPTION-CODE
 14506         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14507         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14508         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14509         IF NO-CONVERSION-ERROR
 14510             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14511         ELSE
 14512             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14513         END-IF
 14514     END-IF.
 14515
 14516     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 274
* EL130.cbl
 14517         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14518         MOVE '6'                     TO  DC-OPTION-CODE
 14519         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14520         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14521         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14522         IF NO-CONVERSION-ERROR
 14523             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14524         ELSE
 14525             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14526         END-IF
 14527     END-IF.
 14528
 14529
 14530
 14531* EXEC CICS LINK
 14532*        PROGRAM    (LINK-1523)
 14533*        COMMAREA   (W-1523-LINKDATA)
 14534*        LENGTH     (W-1523-COMM-LENGTH)
 14535*    END-EXEC.
 14536*    MOVE '."C                   (   #00013176' TO DFHEIV0
 14537     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14539     MOVE X'2020233030303133313736' TO DFHEIV0(25:11)
 14540     CALL 'kxdfhei1' USING DFHEIV0,
 14541           LINK-1523,
 14542           W-1523-LINKDATA,
 14543           W-1523-COMM-LENGTH,
 14544           DFHEIV99,
 14545           DFHEIV99,
 14546           DFHEIV99,
 14547           DFHEIV99
 14548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14549
 14550
 14551     GO TO 6600-EXIT.
 14552
 14553 6600-NOT-FOUND.
 14554     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14555
 14556 6600-EXIT.
 14557     EXIT.
 14558
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 275
* EL130.cbl
 14559/
 14560*************************************************************
 14561*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14562*************************************************************
 14563
 14564 6700-OUTPUT-ACTIVITY-RECORD.
 14565
 14566
 14567
 14568* EXEC CICS GETMAIN
 14569*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14570*        LENGTH (DLYACTV-LENGTH)
 14571*        INITIMG (WS-BLANK)
 14572*    END-EXEC.
 14573*    MOVE ',"IL                  $   #00013198' TO DFHEIV0
 14574     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14575     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14576     MOVE X'2020233030303133313938' TO DFHEIV0(25:11)
 14577     CALL 'kxdfhei1' USING DFHEIV0,
 14578           DFHEIV20,
 14579           DLYACTV-LENGTH,
 14580           WS-BLANK
 14581     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14582         DFHEIV20
 14583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14584
 14585
 14586     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14587     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14588     MOVE CLMCARRI               TO DA-CARRIER.
 14589     IF CLMNOL EQUAL ZERO
 14590         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14591     ELSE
 14592         MOVE CLMNOI             TO DA-CLAIM-NO
 14593     END-IF.
 14594     MOVE CERTNOI                TO DA-CERT-PRIME.
 14595     MOVE SUFXI                  TO DA-CERT-SFX.
 14596     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14597     MOVE 'A'                    TO DA-RECORD-TYPE.
 14598
 14599
 14600* EXEC CICS HANDLE CONDITION
 14601*        NOTOPEN (6700-NOTOPEN-ERROR)
 14602*        DUPREC (6700-EXIT)
 14603*    END-EXEC.
 14604*    MOVE '"$J%                  ! E #00013217' TO DFHEIV0
 14605     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14607     MOVE X'4520233030303133323137' TO DFHEIV0(25:11)
 14608     CALL 'kxdfhei1' USING DFHEIV0
 14609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14610
 14611
 14612
 14613* EXEC CICS WRITE
 14614*        DATASET (DLYACTV-DSID)
 14615*        RIDFLD (DA-KEY)
 14616*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 276
* EL130.cbl
 14617*        LENGTH (DLYACTV-LENGTH)
 14618*    END-EXEC.
 14619*    MOVE '&$ L                  ''   #00013222' TO DFHEIV0
 14620     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14621     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14622     MOVE X'2020233030303133323232' TO DFHEIV0(25:11)
 14623     CALL 'kxdfhei1' USING DFHEIV0,
 14624           DLYACTV-DSID,
 14625           DAILY-ACTIVITY-RECORD,
 14626           DLYACTV-LENGTH,
 14627           DA-KEY,
 14628           DFHEIV99,
 14629           DFHEIV99
 14630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14631
 14632     GO TO 6700-EXIT.
 14633
 14634 6700-NOTOPEN-ERROR.
 14635     MOVE '2955'                 TO EMI-ERROR.
 14636     MOVE -1                     TO MAINTL.
 14637     MOVE AL-UANON               TO MAINTA.
 14638     PERFORM 9900-ERROR-FORMAT THRU
 14639             9900-EXIT.
 14640     GO TO 8200-SEND-DATAONLY.
 14641
 14642 6700-EXIT.
 14643     EXIT.
 14644
 14645*************************************************************
 14646*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14647*************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 277
* EL130.cbl
 14648/
 14649 6990-DEEDIT-DATE.
 14650
 14651
 14652* EXEC CICS BIF DEEDIT
 14653*        FIELD   (DATE-WORK)
 14654*        LENGTH  (8)
 14655*    END-EXEC.
 14656     MOVE 8
 14657       TO DFHEIV11
 14658*    MOVE '@"L                   #   #00013247' TO DFHEIV0
 14659     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14660     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14661     MOVE X'2020233030303133323437' TO DFHEIV0(25:11)
 14662     CALL 'kxdfhei1' USING DFHEIV0,
 14663           DATE-WORK,
 14664           DFHEIV11
 14665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14666
 14667 6990-EXIT.
 14668     EXIT.
 14669
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 278
* EL130.cbl
 14671 7000-BUILD-OUTPUT-MAP.
 14672
 14673     IF CLAIM-SWITCH = 'N'
 14674         GO TO 7050-BUILD-MAP-CERT-DATA
 14675     END-IF.
 14676
 14677     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14678         MOVE SPACES                 TO SEQUO
 14679         MOVE AL-SABOF               TO SEQUA
 14680     ELSE
 14681         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14682         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14683         MOVE WS-CLAIM-SEQU          TO SEQUO
 14684         MOVE AL-SABON               TO SEQUA
 14685     END-IF.
 14686
 14687     MOVE CL-CARRIER             TO CLMCARRO.
 14688     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14689     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14690     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14691     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14692     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14693     MOVE CL-INSURED-MID-INIT    TO INITO.
 14694     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14695     move cl-insured-type        to instypeo
 14696*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14697
 14698     MOVE AL-UANON               TO CLMCARRA
 14699                                    CLMTYPEA
 14700                                    PCERTNOA
 14701                                    PSUFXA
 14702                                    LSTNMEA
 14703                                    FSTNMEA
 14704                                    INITA
 14705                                    SEXA
 14706
 14707     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14708
 14709     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14710         MOVE ' '                 TO DC-OPTION-CODE
 14711         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14712         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14713         IF NOT DATE-CONVERSION-ERROR
 14714             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14715             MOVE AL-UANON            TO BIRTHDTA
 14716         END-IF
 14717     END-IF.
 14718
 14719     MOVE CL-SOC-SEC-NO          TO SSNO.
 14720     MOVE AL-UANON               TO SSNA.
 14721
 14722     IF CL-INCURRED-DT NOT = LOW-VALUES
 14723         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14724         MOVE ' '                TO DC-OPTION-CODE
 14725         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14726         IF NOT DATE-CONVERSION-ERROR
 14727             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14728             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 279
* EL130.cbl
 14729         END-IF
 14730     END-IF.
 14731
 14732     IF CL-REPORTED-DT NOT = LOW-VALUES
 14733         MOVE ' '                TO DC-OPTION-CODE
 14734         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14735         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14736         IF NOT DATE-CONVERSION-ERROR
 14737             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14738             MOVE AL-UANON            TO REPORTA
 14739         END-IF
 14740     END-IF.
 14741
 14742*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14743*        MOVE ' '                 TO DC-OPTION-CODE
 14744*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14745*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14746*        IF NOT DATE-CONVERSION-ERROR
 14747*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14748*            MOVE AL-UANON            TO ESTENDA
 14749*        END-IF
 14750*    END-IF.
 14751
 14752     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14753     MOVE WS-ICD-CODE-1          TO ICD1O.
 14754     MOVE WS-ICD-CODE-2          TO ICD2O.
 14755*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14756     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14757     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14758     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14759     MOVE CL-PRIORITY-CD         TO PRICDO.
 14760     MOVE AL-UANON               TO DIAGA
 14761                                    ICD1A
 14762                                    ICD2A
 14763*                                   CAUSEA
 14764                                    RELCLMA
 14765                                    PROCCDA
 14766                                    PRICDA.
 14767     MOVE AL-UNNON               TO MANRSVA.
 14768
 14769*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14770*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14771*        MOVE AL-UANON               TO PRODCDA
 14772*    END-IF.
 14773
 14774     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14775     MOVE CL-FILE-LOCATION       TO FILETOO.
 14776     MOVE CL-BENEFICIARY         TO BENECDO.
 14777     MOVE AL-UANON               TO SUPVA
 14778                                    FILETOA
 14779                                    BENECDA.
 14780
 14781     IF CLAIM-SWITCH = 'X'
 14782         GO TO 7099-EXIT
 14783     END-IF.
 14784
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 280
* EL130.cbl
 14786 7050-BUILD-MAP-CERT-DATA.
 14787     MOVE CM-CERT-PRIME          TO CERTNOO.
 14788     MOVE CM-CERT-SFX            TO SUFXO.
 14789     MOVE AL-SANON               TO CERTNOA
 14790                                    SUFXA.
 14791
 14792     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14793         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14794         MOVE ' '                TO DC-OPTION-CODE
 14795         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14796         IF NOT DATE-CONVERSION-ERROR
 14797             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14798         END-IF
 14799     END-IF.
 14800
 14801     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14802     MOVE CM-STATE               TO STATEO.
 14803     MOVE CM-CARRIER             TO CRTCARRO.
 14804     MOVE CM-GROUPING            TO GROUPO.
 14805     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14806     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14807     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14808     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14809     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14810     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14811     MOVE CM-JT-INITIAL          TO JNTINITO.
 14812     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14813     MOVE AL-UANON               TO ACCOUNTA
 14814                                    STATEA
 14815                                    CRTCARRA
 14816                                    GROUPA
 14817                                    CRTLNMEA
 14818                                    CRTFNMEA
 14819                                    CRTINITA
 14820                                    JNTLNMEA
 14821                                    JNTFNMEA
 14822                                    JNTINITA.
 14823     MOVE AL-UNNON               TO ISSAGEA
 14824                                    JNTAGEA.
 14825
 14826     IF CM-SSN-STATE   = CM-STATE AND
 14827        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14828*        NEXT SENTENCE
 14829         CONTINUE
 14830     ELSE
 14831         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14832     END-IF.
 14833
 14834     MOVE AL-UANON               TO CRTSSNA.
 14835
 14836     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14837     MOVE '2'                    TO DC-OPTION-CODE.
 14838     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14839     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14840
 14841*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14842     MOVE SPACES                 TO ELCNTL-KEY.
 14843     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 281
* EL130.cbl
 14844     MOVE '3'                    TO CNTL-REC-TYPE.
 14845     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14846     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14847
 14848
 14849
 14850* EXEC CICS READ
 14851*        DATASET  (ELCNTL-DSID)
 14852*        SET      (ADDRESS OF CONTROL-FILE)
 14853*        RIDFLD   (ELCNTL-KEY)
 14854*        RESP     (WS-RESPONSE)
 14855*    END-EXEC.
 14856*    MOVE '&"S        E          (  N#00013433' TO DFHEIV0
 14857     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14858     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14859     MOVE X'204E233030303133343333' TO DFHEIV0(25:11)
 14860     CALL 'kxdfhei1' USING DFHEIV0,
 14861           ELCNTL-DSID,
 14862           DFHEIV20,
 14863           DFHEIV99,
 14864           ELCNTL-KEY,
 14865           DFHEIV99,
 14866           DFHEIV99,
 14867           DFHEIV99
 14868     SET ADDRESS OF CONTROL-FILE TO
 14869         DFHEIV20
 14870     MOVE EIBRESP  TO WS-RESPONSE
 14871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14872
 14873
 14874     IF WS-RESP-NOTFND
 14875          MOVE ER-2848           TO EMI-ERROR
 14876          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14877          GO TO 8100-SEND-INITIAL-MAP
 14878     END-IF.
 14879
 14880     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14881     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14882     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 282
* EL130.cbl
 14884     IF CM-LF-BENEFIT-CD = '00'
 14885         MOVE ZEROS              TO LCVOTRMO
 14886                                    LCVRTRMO
 14887                                    LCVRATEO
 14888                                    LCVBENEO
 14889         MOVE SPACES             TO LCVDSCRO
 14890                                    LCVCDO
 14891                                    LCVKINDO
 14892                                    LCVFORMO
 14893                                    LCVCNDTO
 14894                                    LCVEXITO
 14895                                    LCVSTATO
 14896         IF CLMTYPEL GREATER THAN ZERO AND
 14897            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14898                MOVE ER-0521     TO EMI-ERROR
 14899                MOVE AL-UABON    TO CLMTYPEA
 14900                MOVE -1          TO CLMTYPEL
 14901                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14902                GO TO 7060-FILL-AH-COVERAGE
 14903         ELSE
 14904             GO TO 7060-FILL-AH-COVERAGE
 14905         END-IF
 14906     END-IF.
 14907
 14908     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14909     MOVE AL-UANON               TO LCVDSCRA.
 14910     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14911     MOVE '4'                    TO WS-REC-TYPE.
 14912     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14913     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14914     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14915     MOVE AL-UANON               TO LCVCDA.
 14916     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14917                                    CP-ORIGINAL-TERM.
 14918     MOVE AL-UNNON               TO LCVOTRMA.
 14919     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14920     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14921     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14922     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14923     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14924     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14925
 14926     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14927     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14928
 14929     IF CM-LF-PREMIUM-RATE NUMERIC
 14930         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14931     ELSE
 14932         MOVE ZEROS              TO LCVRATEO
 14933     END-IF.
 14934
 14935     MOVE AL-UNNON               TO LCVRATEA.
 14936
 14937     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14938         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14939     END-IF.
 14940
 14941     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 283
* EL130.cbl
 14942
 14943     MOVE AL-UNNON               TO LCVBENEA.
 14944
 14945     IF CM-POLICY-FORM-NO NOT = SPACES
 14946         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14947     ELSE
 14948         MOVE WS-FORM-HOLD       TO LCVFORMO
 14949     END-IF.
 14950
 14951     MOVE SPACES                 TO WS-FORM-HOLD.
 14952     MOVE 'L'                    TO WS-REC-TYPE.
 14953     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14954
 14955     IF WS-FORM-HOLD NOT = SPACES
 14956         MOVE WS-FORM-HOLD       TO LCVFORMO
 14957         MOVE AL-UANON           TO LCVFORMA
 14958     END-IF.
 14959
 14960     IF CM-LF-CURRENT-STATUS = '8'
 14961         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14962             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14963             MOVE ' '             TO DC-OPTION-CODE
 14964             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14965             IF NOT DATE-CONVERSION-ERROR
 14966                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14967                 MOVE AL-UANON            TO LCVCNDTA
 14968             END-IF
 14969         END-IF
 14970     END-IF.
 14971
 14972     IF CM-LF-CURRENT-STATUS = '7'
 14973         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14974             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14975             MOVE ' '            TO DC-OPTION-CODE
 14976             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14977             IF NOT DATE-CONVERSION-ERROR
 14978                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14979                 MOVE AL-UANON   TO LCVCNDTA
 14980             END-IF
 14981         END-IF
 14982     END-IF.
 14983
 14984     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14985         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14986             MOVE ' '            TO DC-OPTION-CODE
 14987             MOVE CM-LF-DEATH-EXIT-DT
 14988                                 TO DC-BIN-DATE-1
 14989             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14990             IF NOT DATE-CONVERSION-ERROR
 14991                 MOVE DC-GREG-DATE-1-EDIT
 14992                                 TO LCVEXITO
 14993             END-IF
 14994         END-IF
 14995     END-IF.
 14996
 14997     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14998         IF CP-REMAINING-TERM-3 = ZEROS
 14999             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 284
* EL130.cbl
 15000         ELSE
 15001             MOVE 'ACTIVE'       TO LCVSTATO
 15002         END-IF
 15003     END-IF.
 15004
 15005     IF CM-LF-CURRENT-STATUS = '2'
 15006        MOVE 'PEND  '            TO LCVSTATO
 15007     END-IF.
 15008     IF CM-LF-CURRENT-STATUS = '3'
 15009        MOVE 'RESTORE'           TO LCVSTATO
 15010     END-IF.
 15011     IF CM-LF-CURRENT-STATUS = '5'
 15012        MOVE 'REISSUE'           TO LCVSTATO
 15013     END-IF.
 15014     IF CM-LF-CURRENT-STATUS = '6'
 15015        MOVE 'LMP DIS'           TO LCVSTATO
 15016     END-IF.
 15017     IF CM-LF-CURRENT-STATUS = '7'
 15018        MOVE 'DEATH  '           TO LCVSTATO
 15019     END-IF.
 15020     IF CM-LF-CURRENT-STATUS = '8'
 15021        MOVE 'CANCEL '           TO LCVSTATO
 15022     END-IF.
 15023     IF CM-LF-CURRENT-STATUS = '9'
 15024        MOVE 'RE-ONLY'           TO LCVSTATO
 15025     END-IF.
 15026     IF CM-LF-CURRENT-STATUS = 'V'
 15027        MOVE 'VOID   '           TO LCVSTATO
 15028     END-IF.
 15029     IF CM-LF-CURRENT-STATUS = 'D'
 15030        MOVE 'DECLINE'           TO LCVSTATO
 15031     END-IF.
 15032
 15033     IF PI-COMPANY-ID = 'CID'
 15034         IF CM-LF-BENEFIT-CD >= '2O' AND
 15035            CM-LF-BENEFIT-CD <= '2V'
 15036             MOVE ER-0878       TO EMI-ERROR
 15037             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15038         END-IF
 15039     END-IF.
 15040
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 285
* EL130.cbl
 15042 7060-FILL-AH-COVERAGE.
 15043
 15044     IF CM-AH-BENEFIT-CD = '00'
 15045         MOVE ZEROS              TO ACVOTRMO
 15046                                    ACVRTRMO
 15047                                    ACVRATEO
 15048                                    ACVBENEO
 15049         MOVE SPACES             TO ACVDSCRO
 15050                                    ACVCDO
 15051                                    ACVKINDO
 15052                                    ACVFORMO
 15053                                    ACVCNDTO
 15054                                    ACVEXITO
 15055                                    ACVSTATO
 15056         IF (CLMTYPEL GREATER THAN ZERO AND
 15057             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 15058             MOVE ER-0521     TO EMI-ERROR
 15059             MOVE AL-UABON    TO CLMTYPEA
 15060             MOVE -1          TO CLMTYPEL
 15061             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15062             GO TO 7070-BUILD-MAP-FINISH
 15063         ELSE
 15064             GO TO 7070-BUILD-MAP-FINISH
 15065         END-IF
 15066     END-IF.
 15067
 15068     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15069     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 15070     MOVE AL-UANON               TO ACVDSCRA
 15071                                    ACVCDA.
 15072     MOVE '5'                    TO WS-REC-TYPE.
 15073     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 15074     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 15075
 15076     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 15077                                    CP-ORIGINAL-TERM.
 15078     MOVE AL-UNNON               TO ACVOTRMA.
 15079
 15080     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15081     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15082     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 15083     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15084     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15085     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15086
 15087     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15088     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15089
 15090     IF CM-AH-PREMIUM-RATE NUMERIC
 15091         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15092     ELSE
 15093         MOVE ZEROS              TO ACVRATEO
 15094     END-IF.
 15095
 15096     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 15097     MOVE AL-UNNON               TO ACVRATEA
 15098                                    ACVBENEA.
 15099
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 286
* EL130.cbl
 15100     IF CM-POLICY-FORM-NO NOT = SPACES
 15101         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 15102     ELSE
 15103         MOVE WS-FORM-HOLD       TO ACVFORMO
 15104         MOVE SPACES TO WS-FORM-HOLD
 15105         MOVE 'A'                TO WS-REC-TYPE
 15106         PERFORM 7400-READ-STATE THRU 7499-EXIT
 15107         IF WS-FORM-HOLD NOT = SPACES
 15108             MOVE WS-FORM-HOLD   TO ACVFORMO
 15109         END-IF
 15110     END-IF.
 15111
 15112     MOVE AL-UANON               TO ACVFORMA.
 15113
 15114     IF CM-AH-CURRENT-STATUS = '8'
 15115         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 15116             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15117             MOVE ' '             TO DC-OPTION-CODE
 15118             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15119             IF NOT DATE-CONVERSION-ERROR
 15120                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15121                MOVE AL-UANON    TO ACVCNDTA
 15122             END-IF
 15123         END-IF
 15124     END-IF.
 15125
 15126     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15127         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15128             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 15129             MOVE ' '             TO DC-OPTION-CODE
 15130             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15131             IF NOT DATE-CONVERSION-ERROR
 15132                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15133                MOVE AL-UANON            TO ACVCNDTA
 15134             END-IF
 15135         END-IF
 15136     END-IF.
 15137
 15138     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15139         MOVE ' '                TO DC-OPTION-CODE
 15140         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15141         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15142         IF NOT DATE-CONVERSION-ERROR
 15143             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 15144         END-IF
 15145     END-IF.
 15146
 15147     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15148         IF CP-REMAINING-TERM-3 = ZEROS
 15149             MOVE 'EXPIRED'      TO ACVSTATO
 15150         ELSE
 15151             MOVE 'ACTIVE'       TO ACVSTATO
 15152         END-IF
 15153     END-IF.
 15154
 15155     IF CM-AH-CURRENT-STATUS = '2'
 15156         MOVE 'PEND  '           TO ACVSTATO
 15157     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 287
* EL130.cbl
 15158     IF CM-AH-CURRENT-STATUS = '3'
 15159         MOVE 'RESTORE'          TO ACVSTATO
 15160     END-IF.
 15161     IF CM-AH-CURRENT-STATUS = '5'
 15162         MOVE 'REISSUE'          TO ACVSTATO
 15163     END-IF.
 15164     IF CM-AH-CURRENT-STATUS = '6'
 15165         MOVE 'LMP DIS'          TO ACVSTATO
 15166     END-IF.
 15167     IF CM-AH-CURRENT-STATUS = '7'
 15168         MOVE 'DEATH  '          TO ACVSTATO
 15169     END-IF.
 15170     IF CM-AH-CURRENT-STATUS = '8'
 15171         MOVE 'CANCEL '          TO ACVSTATO
 15172     END-IF.
 15173     IF CM-AH-CURRENT-STATUS = '9'
 15174         MOVE 'RE-ONLY'          TO ACVSTATO
 15175     END-IF.
 15176     IF CM-AH-CURRENT-STATUS = 'V'
 15177         MOVE 'VOID   '          TO ACVSTATO
 15178     END-IF.
 15179     IF CM-AH-CURRENT-STATUS = 'D'
 15180         MOVE 'DECLINE'          TO ACVSTATO
 15181     END-IF.
 15182
 15183     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 15184        IF CM-ACCOUNT (9:2) = 'BI'
 15185           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 15186           MOVE CM-CARRIER       TO CTRLR-CARRIER
 15187           MOVE CM-GROUPING      TO CTRLR-GROUPING
 15188           MOVE CM-STATE         TO CTRLR-STATE
 15189           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 15190           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 15191           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 15192           MOVE 'C'              TO CTRLR-REC-TYPE
 15193
 15194* EXEC CICS READ
 15195*            DATASET  (ELCRTT-DSID)
 15196*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 15197*            RIDFLD   (ELCRTT-KEY)
 15198*            RESP     (WS-RESPONSE)
 15199*          END-EXEC
 15200*    MOVE '&"S        E          (  N#00013759' TO DFHEIV0
 15201     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15203     MOVE X'204E233030303133373539' TO DFHEIV0(25:11)
 15204     CALL 'kxdfhei1' USING DFHEIV0,
 15205           ELCRTT-DSID,
 15206           DFHEIV20,
 15207           DFHEIV99,
 15208           ELCRTT-KEY,
 15209           DFHEIV99,
 15210           DFHEIV99,
 15211           DFHEIV99
 15212     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15213         DFHEIV20
 15214     MOVE EIBRESP  TO WS-RESPONSE
 15215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 288
* EL130.cbl
 15216           IF WS-RESP-NORMAL
 15217               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15218               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15219               MOVE AL-UANON        TO DIAGA
 15220           END-IF
 15221        END-IF
 15222     END-IF.
 15223
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 289
* EL130.cbl
 15225 7070-BUILD-MAP-FINISH.
 15226     MOVE CM-LOAN-APR            TO APRO.
 15227     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15228     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15229     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15230     MOVE AL-UNNON               TO APRA
 15231                                    PMTFREQA.
 15232     MOVE AL-UANON               TO INDGRPA
 15233                                    PREMTYPA.
 15234
 15235     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15236         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15237         MOVE AL-UANON               TO REINCDA
 15238     END-IF.
 15239
 15240     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15241*        NEXT SENTENCE
 15242         CONTINUE
 15243     ELSE
 15244         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15245         MOVE ' '                TO DC-OPTION-CODE
 15246         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15247         IF NOT DATE-CONVERSION-ERROR
 15248             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15249             MOVE AL-UANON            TO ADDONDTA
 15250         END-IF
 15251     END-IF.
 15252
 15253     IF CLAIM-SWITCH = 'N'
 15254         IF SEXL = ZEROS
 15255             MOVE CM-INSURED-SEX TO SEXO
 15256*            MOVE AL-UANON       TO SEXA
 15257         END-IF
 15258     END-IF.
 15259
 15260     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15261         MOVE CM-MEMBER-NO       TO MEMBERO
 15262         MOVE AL-UANON           TO MEMBERA
 15263     END-IF.
 15264
 15265     IF MAINTI = 'A'
 15266         IF (LOANNOL = ZEROS OR
 15267             EIBAID = DFHPF5)
 15268             MOVE CM-LOAN-NUMBER TO LOANNOO
 15269             MOVE AL-UANON       TO LOANNOA
 15270         ELSE
 15271*            NEXT SENTENCE
 15272             CONTINUE
 15273         END-IF
 15274     ELSE
 15275         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15276         MOVE AL-UANON           TO LOANNOA
 15277     END-IF.
 15278
 15279     IF MAINTI = 'A'
 15280         IF (LOANBALL = ZEROS OR
 15281             EIBAID = DFHPF5)
 15282             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 290
* EL130.cbl
 15283             MOVE AL-UNNON       TO LOANBALA
 15284         ELSE
 15285*            NEXT SENTENCE
 15286             CONTINUE
 15287         END-IF
 15288     ELSE
 15289         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15290         MOVE AL-UNNON           TO LOANBALA
 15291     END-IF.
 15292
 15293     IF CM-PREMIUM-TYPE NOT = '3'
 15294         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15295             PERFORM 7200-PROTECT-CERT-FIELDS
 15296         ELSE
 15297             PERFORM 7300-RESET-KEY-ATTRBS
 15298         END-IF
 15299     ELSE
 15300         PERFORM 7300-RESET-KEY-ATTRBS
 15301     END-IF.
 15302
 15303*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15304*        NEXT SENTENCE
 15305*        CONTINUE
 15306*    ELSE
 15307         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15308*    END-IF.
 15309
 15310 7099-EXIT.
 15311     EXIT.
 15312
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 291
* EL130.cbl
 15314 7100-READ-BENEFIT.
 15315
 15316
 15317* EXEC CICS HANDLE CONDITION
 15318*         NOTFND   (7120-NOT-FOUND)
 15319*    END-EXEC.
 15320*    MOVE '"$I                   ! F #00013865' TO DFHEIV0
 15321     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15323     MOVE X'4620233030303133383635' TO DFHEIV0(25:11)
 15324     CALL 'kxdfhei1' USING DFHEIV0
 15325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15326
 15327
 15328     MOVE SPACES                 TO ELCNTL-KEY.
 15329     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15330     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15331     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15332     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15333
 15334 7105-READ-FILE.
 15335     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15336
 15337     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15338        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15339          GO TO 7120-NOT-FOUND
 15340     END-IF.
 15341
 15342     MOVE 1                      TO SUB.
 15343 7110-LOOP.
 15344     IF SUB = 9
 15345         GO TO 7120-NOT-FOUND
 15346     END-IF.
 15347
 15348     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15349         ADD 1                   TO SUB
 15350         GO TO 7110-LOOP
 15351     END-IF.
 15352
 15353     if ws-rec-type = '4'
 15354        move cf-joint-indicator (sub)
 15355                                 to ws-lf-joint-indicator
 15356     else
 15357        move cf-joint-indicator (sub)
 15358                                 to ws-ah-joint-indicator
 15359     end-if
 15360     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15361     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15362     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15363
 15364     GO TO 7199-EXIT.
 15365
 15366 7120-NOT-FOUND.
 15367     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15368                                    WS-FORM-HOLD.
 15369
 15370 7199-EXIT.
 15371      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 292
* EL130.cbl
 15372
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 293
* EL130.cbl
 15374 7200-PROTECT-CERT-FIELDS.
 15375     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15376                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15377                                LCVFORMA ACVFORMA JNTLNMEA
 15378                                JNTFNMEA JNTINITA.
 15379
 15380     IF CM-LF-CURRENT-STATUS = '2' OR
 15381        CM-AH-CURRENT-STATUS = '2'
 15382         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15383     END-IF.
 15384
 15385     MOVE AL-SANOF TO
 15386            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15387            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15388            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15389            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15390            LCVRATEA   ACVRATEA.
 15391
 15392     MOVE 'S'                    TO CERTMTI.
 15393
 15394 7300-RESET-KEY-ATTRBS.
 15395     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15396                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15397                                LCVFORMA ACVFORMA JNTLNMEA
 15398                                JNTFNMEA JNTINITA.
 15399
 15400     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15401         MOVE AL-SANOF           TO REINCDA
 15402     END-IF.
 15403
 15404     MOVE 'S'                    TO CERTMTI.
 15405
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 294
* EL130.cbl
 15407 7400-READ-STATE.
 15408
 15409
 15410* EXEC CICS HANDLE CONDITION
 15411*         NOTFND   (7499-EXIT)
 15412*    END-EXEC.
 15413*    MOVE '"$I                   ! G #00013950' TO DFHEIV0
 15414     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15416     MOVE X'4720233030303133393530' TO DFHEIV0(25:11)
 15417     CALL 'kxdfhei1' USING DFHEIV0
 15418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15419
 15420
 15421     MOVE SPACES                 TO ELCNTL-KEY.
 15422     MOVE CM-STATE               TO CNTL-ACCESS.
 15423     MOVE '3'                    TO CNTL-REC-TYPE.
 15424     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15425     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15426
 15427     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15428
 15429     MOVE 1                      TO SUB.
 15430
 15431 7410-LOOP.
 15432     IF SUB = 21
 15433        GO TO 7499-EXIT
 15434     END-IF.
 15435
 15436*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15437*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15438*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15439*        GO TO 7499-EXIT.
 15440
 15441     ADD 1                       TO SUB.
 15442     GO TO 7410-LOOP.
 15443
 15444 7499-EXIT.
 15445      EXIT.
 15446
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 295
* EL130.cbl
 15448 7500-BROWSE-FOR-DUPLICATE.
 15449
 15450     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15451
 15452
 15453
 15454* EXEC CICS HANDLE CONDITION
 15455*        NOTFND   (7500-EXIT)
 15456*        DUPKEY   (7500-DUPLICATE-KEY)
 15457*        ENDFILE  (7500-EXIT)
 15458*    END-EXEC.
 15459*    MOVE '"$I$''                 ! H #00013986' TO DFHEIV0
 15460     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15462     MOVE X'4820233030303133393836' TO DFHEIV0(25:11)
 15463     CALL 'kxdfhei1' USING DFHEIV0
 15464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15465
 15466
 15467
 15468
 15469* EXEC CICS STARTBR
 15470*        DATASET    (ELMSTR5-DSID)
 15471*        RIDFLD     (ELMSTR5-KEY)
 15472*    END-EXEC.
 15473     MOVE 0
 15474       TO DFHEIV11
 15475*    MOVE '&,         G          &   #00013993' TO DFHEIV0
 15476     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15477     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15478     MOVE X'2020233030303133393933' TO DFHEIV0(25:11)
 15479     CALL 'kxdfhei1' USING DFHEIV0,
 15480           ELMSTR5-DSID,
 15481           ELMSTR5-KEY,
 15482           DFHEIV99,
 15483           DFHEIV11,
 15484           DFHEIV99
 15485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15486
 15487
 15488
 15489
 15490* EXEC CICS HANDLE CONDITION
 15491*        ENDFILE  (7500-END-BROWSE)
 15492*    END-EXEC.
 15493*    MOVE '"$''                   ! I #00013999' TO DFHEIV0
 15494     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15496     MOVE X'4920233030303133393939' TO DFHEIV0(25:11)
 15497     CALL 'kxdfhei1' USING DFHEIV0
 15498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15499
 15500
 15501 7500-READ-CLAIM-LOOP.
 15502
 15503
 15504
 15505* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 296
* EL130.cbl
 15506*        DATASET   (ELMSTR5-DSID)
 15507*        SET       (ADDRESS OF CLAIM-MASTER)
 15508*        RIDFLD    (ELMSTR5-KEY)
 15509*    END-EXEC.
 15510     MOVE 0
 15511       TO DFHEIV11
 15512*    MOVE '&.S                   )   #00014006' TO DFHEIV0
 15513     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15514     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15515     MOVE X'2020233030303134303036' TO DFHEIV0(25:11)
 15516     CALL 'kxdfhei1' USING DFHEIV0,
 15517           ELMSTR5-DSID,
 15518           DFHEIV20,
 15519           DFHEIV99,
 15520           ELMSTR5-KEY,
 15521           DFHEIV99,
 15522           DFHEIV11,
 15523           DFHEIV99,
 15524           DFHEIV99
 15525     SET ADDRESS OF CLAIM-MASTER TO
 15526         DFHEIV20
 15527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15528
 15529
 15530 7500-DUPLICATE-KEY.
 15531
 15532     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15533        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15534        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15535        CL-CERT-STATE     NOT = CM-STATE       OR
 15536        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15537        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15538        CL-CERT-NO        NOT = CM-CERT-NO
 15539           GO TO 7500-CHECK-MATCH-COUNT
 15540     END-IF.
 15541
 15542     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15543
 15544     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15545        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15546        GO TO 7500-END-BROWSE
 15547     ELSE
 15548        GO TO 7500-READ-CLAIM-LOOP
 15549     END-IF.
 15550
 15551 7500-CHECK-MATCH-COUNT.
 15552
 15553     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15554        CL-CERT-NO    = CM-CERT-NO
 15555          GO TO 7500-READ-CLAIM-LOOP
 15556     END-IF.
 15557
 15558 7500-END-BROWSE.
 15559
 15560
 15561
 15562* EXEC CICS ENDBR
 15563*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 297
* EL130.cbl
 15564*    END-EXEC.
 15565     MOVE 0
 15566       TO DFHEIV11
 15567*    MOVE '&2                    $   #00014043' TO DFHEIV0
 15568     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15569     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15570     MOVE X'2020233030303134303433' TO DFHEIV0(25:11)
 15571     CALL 'kxdfhei1' USING DFHEIV0,
 15572           ELMSTR5-DSID,
 15573           DFHEIV11,
 15574           DFHEIV99
 15575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15576
 15577
 15578 7500-EXIT.
 15579     EXIT.
 15580
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 298
* EL130.cbl
 15582 7550-FALL-THRU-PARA.
 15583
 15584
 15585
 15586* EXEC CICS DUMP
 15587*         DUMPCODE ('E130')
 15588*         TASK
 15589*    END-EXEC.
 15590     MOVE 'E130' TO DFHEIV5
 15591*    MOVE '<"   T                $   #00014054' TO DFHEIV0
 15592     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15594     MOVE X'2020233030303134303534' TO DFHEIV0(25:11)
 15595     CALL 'kxdfhei1' USING DFHEIV0,
 15596           DFHEIV5,
 15597           DFHEIV99,
 15598           DFHEIV99
 15599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15600
 15601
 15602
 15603
 15604* EXEC CICS RETURN
 15605*    END-EXEC.
 15606*    MOVE '.(                    ''   #00014060' TO DFHEIV0
 15607     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15608     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15609     MOVE X'2020233030303134303630' TO DFHEIV0(25:11)
 15610     CALL 'kxdfhei1' USING DFHEIV0,
 15611           DFHEIV99,
 15612           DFHEIV99,
 15613           DFHEIV99,
 15614           DFHEIV99,
 15615           DFHEIV99,
 15616           DFHEIV99
 15617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15618
 15619
 15620 7600-BROWSE-CLAIM.
 15621
 15622
 15623
 15624* EXEC CICS READ
 15625*        DATASET(ELMSTR-DSID)
 15626*        SET    (ADDRESS OF CLAIM-MASTER)
 15627*        RIDFLD (ELMSTR-KEY)
 15628*        GENERIC
 15629*        EQUAL
 15630*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15631*    END-EXEC.
 15632*    MOVE '&"S  KG    E          (   #00014066' TO DFHEIV0
 15633     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15634     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15635     MOVE X'2020233030303134303636' TO DFHEIV0(25:11)
 15636     CALL 'kxdfhei1' USING DFHEIV0,
 15637           ELMSTR-DSID,
 15638           DFHEIV20,
 15639           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 299
* EL130.cbl
 15640           ELMSTR-KEY,
 15641           ELMSTR-GENERIC-LENGTH,
 15642           DFHEIV99,
 15643           DFHEIV99
 15644     SET ADDRESS OF CLAIM-MASTER TO
 15645         DFHEIV20
 15646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15647
 15648
 15649     MOVE CL-CERT-PRIME          TO CERTNOI.
 15650     MOVE CL-CERT-SFX            TO SUFXI.
 15651
 15652 7610-BROWSE-CLAIM-LOOP.
 15653
 15654     MOVE LOW-VALUES             TO BCERT1O
 15655                                    BSUFX1O
 15656                                    BCERT2O
 15657                                    BSUFX2O
 15658                                    BCERT3O
 15659                                    BSUFX3O
 15660                                    BCERT4O
 15661                                    BSUFX4O
 15662                                    BCERT5O
 15663                                    BSUFX5O.
 15664
 15665     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15666
 15667
 15668
 15669* EXEC CICS HANDLE CONDITION
 15670*        ENDFILE  (7630-END-BROWSE)
 15671*    END-EXEC.
 15672*    MOVE '"$''                   ! J #00014094' TO DFHEIV0
 15673     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15674     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15675     MOVE X'4A20233030303134303934' TO DFHEIV0(25:11)
 15676     CALL 'kxdfhei1' USING DFHEIV0
 15677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15678
 15679
 15680
 15681
 15682* EXEC CICS STARTBR
 15683*        DATASET    (ELMSTR-DSID)
 15684*        RIDFLD     (ELMSTR-KEY)
 15685*    END-EXEC.
 15686     MOVE 0
 15687       TO DFHEIV11
 15688*    MOVE '&,         G          &   #00014099' TO DFHEIV0
 15689     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15690     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15691     MOVE X'2020233030303134303939' TO DFHEIV0(25:11)
 15692     CALL 'kxdfhei1' USING DFHEIV0,
 15693           ELMSTR-DSID,
 15694           ELMSTR-KEY,
 15695           DFHEIV99,
 15696           DFHEIV11,
 15697           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 300
* EL130.cbl
 15698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15699
 15700
 15701     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15702
 15703 7620-READ-CLAIM-LOOP.
 15704
 15705
 15706
 15707* EXEC CICS READNEXT
 15708*        DATASET   (ELMSTR-DSID)
 15709*        SET       (ADDRESS OF CLAIM-MASTER)
 15710*        RIDFLD    (ELMSTR-KEY)
 15711*    END-EXEC.
 15712     MOVE 0
 15713       TO DFHEIV11
 15714*    MOVE '&.S                   )   #00014109' TO DFHEIV0
 15715     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15716     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15717     MOVE X'2020233030303134313039' TO DFHEIV0(25:11)
 15718     CALL 'kxdfhei1' USING DFHEIV0,
 15719           ELMSTR-DSID,
 15720           DFHEIV20,
 15721           DFHEIV99,
 15722           ELMSTR-KEY,
 15723           DFHEIV99,
 15724           DFHEIV11,
 15725           DFHEIV99,
 15726           DFHEIV99
 15727     SET ADDRESS OF CLAIM-MASTER TO
 15728         DFHEIV20
 15729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15730
 15731
 15732     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15733        CL-CARRIER     NOT = CLMCARRI       OR
 15734        CL-CLAIM-NO    NOT = CLMNOI
 15735          GO TO 7630-END-BROWSE
 15736     END-IF.
 15737
 15738     IF WS-ASSOCIATED-CERTS = 1
 15739         MOVE CL-CERT-PRIME      TO BCERT1O
 15740         MOVE CL-CERT-SFX        TO BSUFX1O
 15741     END-IF.
 15742
 15743     IF WS-ASSOCIATED-CERTS = 2
 15744         MOVE CL-CERT-PRIME      TO BCERT2O
 15745         MOVE CL-CERT-SFX        TO BSUFX2O
 15746     END-IF.
 15747
 15748     IF WS-ASSOCIATED-CERTS = 3
 15749         MOVE CL-CERT-PRIME      TO BCERT3O
 15750         MOVE CL-CERT-SFX        TO BSUFX3O
 15751     END-IF.
 15752
 15753     IF WS-ASSOCIATED-CERTS = 4
 15754         MOVE CL-CERT-PRIME      TO BCERT4O
 15755         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 301
* EL130.cbl
 15756     END-IF.
 15757
 15758     IF WS-ASSOCIATED-CERTS = 5
 15759         MOVE CL-CERT-PRIME      TO BCERT5O
 15760         MOVE CL-CERT-SFX        TO BSUFX5O
 15761     ELSE
 15762         ADD +1                  TO WS-ASSOCIATED-CERTS
 15763         GO TO 7620-READ-CLAIM-LOOP
 15764     END-IF.
 15765
 15766 7630-END-BROWSE.
 15767
 15768
 15769
 15770* EXEC CICS ENDBR
 15771*        DATASET   (ELMSTR-DSID)
 15772*    END-EXEC.
 15773     MOVE 0
 15774       TO DFHEIV11
 15775*    MOVE '&2                    $   #00014152' TO DFHEIV0
 15776     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15777     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15778     MOVE X'2020233030303134313532' TO DFHEIV0(25:11)
 15779     CALL 'kxdfhei1' USING DFHEIV0,
 15780           ELMSTR-DSID,
 15781           DFHEIV11,
 15782           DFHEIV99
 15783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15784
 15785
 15786 7640-HIGHLIGHT-CERT-DISPLAYED.
 15787
 15788     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15789     MOVE AL-SANON               TO BCERT1A
 15790                                    BSUFX1A
 15791                                    BCERT2A
 15792                                    BSUFX2A
 15793                                    BCERT3A
 15794                                    BSUFX3A
 15795                                    BCERT4A
 15796                                    BSUFX4A
 15797                                    BCERT5A
 15798                                    BSUFX5A.
 15799
 15800     IF BCERT1O = CERTNOI AND
 15801        BSUFX1O = SUFXI
 15802            MOVE AL-SABON        TO BCERT1A
 15803                                    BSUFX1A
 15804     END-IF.
 15805
 15806     IF BCERT2O = CERTNOI AND
 15807        BSUFX2O = SUFXI
 15808            MOVE AL-SABON        TO BCERT2A
 15809                                    BSUFX2A
 15810     END-IF.
 15811
 15812     IF BCERT3O = CERTNOI AND
 15813        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 302
* EL130.cbl
 15814            MOVE AL-SABON        TO BCERT3A
 15815                                    BSUFX3A
 15816     END-IF.
 15817
 15818     IF BCERT4O = CERTNOI AND
 15819        BSUFX4O = SUFXI
 15820            MOVE AL-SABON        TO BCERT4A
 15821                                    BSUFX4A
 15822     END-IF.
 15823
 15824     IF BCERT5O = CERTNOI AND
 15825        BSUFX5O = SUFXI
 15826            MOVE AL-SABON        TO BCERT5A
 15827                                    BSUFX5A
 15828     END-IF.
 15829
 15830 7699-EXIT.
 15831     EXIT.
 15832
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 303
* EL130.cbl
 15834 7700-CHECK-SEQUENCE.
 15835
 15836
 15837
 15838* EXEC CICS HANDLE CONDITION
 15839*        ENDFILE  (7799-EXIT)
 15840*        NOTFND   (7799-EXIT)
 15841*    END-EXEC.
 15842*    MOVE '"$''I                  ! K #00014207' TO DFHEIV0
 15843     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15845     MOVE X'4B20233030303134323037' TO DFHEIV0(25:11)
 15846     CALL 'kxdfhei1' USING DFHEIV0
 15847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15848
 15849
 15850
 15851
 15852* EXEC CICS READ
 15853*        DATASET(ELMSTR-DSID)
 15854*        SET    (ADDRESS OF CLAIM-MASTER)
 15855*        RIDFLD (ELMSTR-KEY)
 15856*        GENERIC
 15857*        EQUAL
 15858*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15859*    END-EXEC.
 15860*    MOVE '&"S  KG    E          (   #00014213' TO DFHEIV0
 15861     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15863     MOVE X'2020233030303134323133' TO DFHEIV0(25:11)
 15864     CALL 'kxdfhei1' USING DFHEIV0,
 15865           ELMSTR-DSID,
 15866           DFHEIV20,
 15867           DFHEIV99,
 15868           ELMSTR-KEY,
 15869           ELMSTR-GENERIC-LENGTH,
 15870           DFHEIV99,
 15871           DFHEIV99
 15872     SET ADDRESS OF CLAIM-MASTER TO
 15873         DFHEIV20
 15874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15875
 15876
 15877     COMPUTE WS-ASSOC-CERT-TOTAL =
 15878             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15879
 15880     GO TO 7799-EXIT.
 15881
 15882 7710-RESEQUENCE-CLAIMS.
 15883
 15884
 15885
 15886* EXEC CICS HANDLE CONDITION
 15887*        ENDFILE  (7790-END-BROWSE)
 15888*    END-EXEC.
 15889*    MOVE '"$''                   ! L #00014230' TO DFHEIV0
 15890     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 304
* EL130.cbl
 15892     MOVE X'4C20233030303134323330' TO DFHEIV0(25:11)
 15893     CALL 'kxdfhei1' USING DFHEIV0
 15894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15895
 15896
 15897
 15898
 15899* EXEC CICS STARTBR
 15900*        DATASET    (ELMSTR-DSID)
 15901*        RIDFLD     (ELMSTR-KEY)
 15902*    END-EXEC.
 15903     MOVE 0
 15904       TO DFHEIV11
 15905*    MOVE '&,         G          &   #00014235' TO DFHEIV0
 15906     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15907     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15908     MOVE X'2020233030303134323335' TO DFHEIV0(25:11)
 15909     CALL 'kxdfhei1' USING DFHEIV0,
 15910           ELMSTR-DSID,
 15911           ELMSTR-KEY,
 15912           DFHEIV99,
 15913           DFHEIV11,
 15914           DFHEIV99
 15915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15916
 15917
 15918     ADD +1 TO WS-ASSOC-CERT-SEQU
 15919               WS-READNEXT-SWITCH.
 15920
 15921 7720-READ-CLAIM-LOOP.
 15922
 15923
 15924
 15925* EXEC CICS READNEXT
 15926*        DATASET   (ELMSTR-DSID)
 15927*        SET       (ADDRESS OF CLAIM-MASTER)
 15928*        RIDFLD    (ELMSTR-KEY)
 15929*    END-EXEC.
 15930     MOVE 0
 15931       TO DFHEIV11
 15932*    MOVE '&.S                   )   #00014246' TO DFHEIV0
 15933     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15934     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15935     MOVE X'2020233030303134323436' TO DFHEIV0(25:11)
 15936     CALL 'kxdfhei1' USING DFHEIV0,
 15937           ELMSTR-DSID,
 15938           DFHEIV20,
 15939           DFHEIV99,
 15940           ELMSTR-KEY,
 15941           DFHEIV99,
 15942           DFHEIV11,
 15943           DFHEIV99,
 15944           DFHEIV99
 15945     SET ADDRESS OF CLAIM-MASTER TO
 15946         DFHEIV20
 15947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15948
 15949
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 305
* EL130.cbl
 15950     IF WS-READNEXT-SWITCH = 1
 15951         ADD 1 TO WS-READNEXT-SWITCH
 15952         GO TO 7720-READ-CLAIM-LOOP
 15953     END-IF.
 15954
 15955 7730-END-BROWSE.
 15956
 15957
 15958
 15959* EXEC CICS ENDBR
 15960*        DATASET   (ELMSTR-DSID)
 15961*    END-EXEC.
 15962     MOVE 0
 15963       TO DFHEIV11
 15964*    MOVE '&2                    $   #00014260' TO DFHEIV0
 15965     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15966     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15967     MOVE X'2020233030303134323630' TO DFHEIV0(25:11)
 15968     CALL 'kxdfhei1' USING DFHEIV0,
 15969           ELMSTR-DSID,
 15970           DFHEIV11,
 15971           DFHEIV99
 15972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15973
 15974
 15975 7740-READ-CLAIM-UPDATE.
 15976
 15977     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15978        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15979        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15980          GO TO 7799-EXIT
 15981     ELSE
 15982          MOVE ZERO              TO WS-READNEXT-SWITCH
 15983     END-IF.
 15984
 15985
 15986
 15987* EXEC CICS READ
 15988*        DATASET(ELMSTR-DSID)
 15989*        SET    (ADDRESS OF CLAIM-MASTER)
 15990*        RIDFLD (ELMSTR-KEY)
 15991*        UPDATE
 15992*    END-EXEC.
 15993*    MOVE '&"S        EU         (   #00014275' TO DFHEIV0
 15994     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15995     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15996     MOVE X'2020233030303134323735' TO DFHEIV0(25:11)
 15997     CALL 'kxdfhei1' USING DFHEIV0,
 15998           ELMSTR-DSID,
 15999           DFHEIV20,
 16000           DFHEIV99,
 16001           ELMSTR-KEY,
 16002           DFHEIV99,
 16003           DFHEIV99,
 16004           DFHEIV99
 16005     SET ADDRESS OF CLAIM-MASTER TO
 16006         DFHEIV20
 16007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 306
* EL130.cbl
 16008
 16009
 16010     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16011     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16012
 16013
 16014
 16015* EXEC CICS REWRITE
 16016*         DATASET     (ELMSTR-DSID)
 16017*         FROM        (CLAIM-MASTER)
 16018*    END-EXEC.
 16019     MOVE LENGTH OF
 16020      CLAIM-MASTER
 16021       TO DFHEIV11
 16022*    MOVE '&& L                  %   #00014286' TO DFHEIV0
 16023     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16024     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16025     MOVE X'2020233030303134323836' TO DFHEIV0(25:11)
 16026     CALL 'kxdfhei1' USING DFHEIV0,
 16027           ELMSTR-DSID,
 16028           CLAIM-MASTER,
 16029           DFHEIV11,
 16030           DFHEIV99
 16031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16032
 16033
 16034     GO TO 7710-RESEQUENCE-CLAIMS.
 16035
 16036 7790-END-BROWSE.
 16037
 16038
 16039
 16040* EXEC CICS ENDBR
 16041*        DATASET   (ELMSTR-DSID)
 16042*    END-EXEC.
 16043     MOVE 0
 16044       TO DFHEIV11
 16045*    MOVE '&2                    $   #00014296' TO DFHEIV0
 16046     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16047     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16048     MOVE X'2020233030303134323936' TO DFHEIV0(25:11)
 16049     CALL 'kxdfhei1' USING DFHEIV0,
 16050           ELMSTR-DSID,
 16051           DFHEIV11,
 16052           DFHEIV99
 16053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16054
 16055
 16056 7799-EXIT.
 16057     EXIT.
 16058
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 307
* EL130.cbl
 16060************************************************
 16061*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 16062************************************************
 16063
 16064 7900-READ-ACTV-UPDATE.
 16065     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16066     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16067     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16068     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16069     MOVE +0                     TO TRLR-SEQ-NO.
 16070     MOVE '1'                    TO TRLR-TYPE.
 16071     GO TO 7900-READ-TRAILER-UPDATE.
 16072
 16073 7900-READ-NINETY-UPDATE.
 16074     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16075     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16076     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16077     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16078     MOVE +90                    TO TRLR-SEQ-NO.
 16079     MOVE '6'                    TO TRLR-TYPE.
 16080
 16081 7900-READ-TRAILER-UPDATE.
 16082
 16083
 16084* EXEC CICS READ  UPDATE
 16085*        DATASET    (ELTRLR-DSID)
 16086*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 16087*        RIDFLD     (ELTRLR-KEY)
 16088*    END-EXEC.
 16089*    MOVE '&"S        EU         (   #00014327' TO DFHEIV0
 16090     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16091     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16092     MOVE X'2020233030303134333237' TO DFHEIV0(25:11)
 16093     CALL 'kxdfhei1' USING DFHEIV0,
 16094           ELTRLR-DSID,
 16095           DFHEIV20,
 16096           DFHEIV99,
 16097           ELTRLR-KEY,
 16098           DFHEIV99,
 16099           DFHEIV99,
 16100           DFHEIV99
 16101     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16102         DFHEIV20
 16103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16104
 16105
 16106 7900-EXIT.
 16107      EXIT.
 16108
 16109 7910-READ-ACTV.
 16110     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16111     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16112     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16113     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16114     MOVE +0                     TO TRLR-SEQ-NO.
 16115     MOVE '1'                    TO TRLR-TYPE.
 16116     GO TO 7910-READ-TRAILER.
 16117
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 308
* EL130.cbl
 16118 7910-READ-NINETY.
 16119     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16120     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16121     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16122     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16123     MOVE +90                    TO TRLR-SEQ-NO.
 16124     MOVE '6'                    TO TRLR-TYPE.
 16125
 16126 7910-READ-TRAILER.
 16127     MOVE 'TRLR'                 TO FILE-SWITCH.
 16128
 16129
 16130
 16131* EXEC CICS READ
 16132*        DATASET   (ELTRLR-DSID)
 16133*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16134*        RIDFLD    (ELTRLR-KEY)
 16135*    END-EXEC.
 16136*    MOVE '&"S        E          (   #00014357' TO DFHEIV0
 16137     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16139     MOVE X'2020233030303134333537' TO DFHEIV0(25:11)
 16140     CALL 'kxdfhei1' USING DFHEIV0,
 16141           ELTRLR-DSID,
 16142           DFHEIV20,
 16143           DFHEIV99,
 16144           ELTRLR-KEY,
 16145           DFHEIV99,
 16146           DFHEIV99,
 16147           DFHEIV99
 16148     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16149         DFHEIV20
 16150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16151
 16152
 16153 7910-EXIT.
 16154      EXIT.
 16155
 16156 7915-REWRITE-TRAILER.
 16157
 16158
 16159* EXEC CICS REWRITE
 16160*        DATASET   (ELTRLR-DSID)
 16161*        FROM      (ACTIVITY-TRAILERS)
 16162*    END-EXEC.
 16163     MOVE LENGTH OF
 16164      ACTIVITY-TRAILERS
 16165       TO DFHEIV11
 16166*    MOVE '&& L                  %   #00014368' TO DFHEIV0
 16167     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16168     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16169     MOVE X'2020233030303134333638' TO DFHEIV0(25:11)
 16170     CALL 'kxdfhei1' USING DFHEIV0,
 16171           ELTRLR-DSID,
 16172           ACTIVITY-TRAILERS,
 16173           DFHEIV11,
 16174           DFHEIV99
 16175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 309
* EL130.cbl
 16176
 16177
 16178 7915-EXIT.
 16179      EXIT.
 16180
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 310
* EL130.cbl
 16182********************************************
 16183*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 16184********************************************
 16185
 16186 7920-READ-CLAIM-UPDATE.
 16187
 16188
 16189
 16190* EXEC CICS READ
 16191*        UPDATE
 16192*        DATASET   (ELMSTR-DSID)
 16193*        SET       (ADDRESS OF CLAIM-MASTER)
 16194*        RIDFLD    (ELMSTR-KEY)
 16195*    END-EXEC.
 16196*    MOVE '&"S        EU         (   #00014384' TO DFHEIV0
 16197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16198     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16199     MOVE X'2020233030303134333834' TO DFHEIV0(25:11)
 16200     CALL 'kxdfhei1' USING DFHEIV0,
 16201           ELMSTR-DSID,
 16202           DFHEIV20,
 16203           DFHEIV99,
 16204           ELMSTR-KEY,
 16205           DFHEIV99,
 16206           DFHEIV99,
 16207           DFHEIV99
 16208     SET ADDRESS OF CLAIM-MASTER TO
 16209         DFHEIV20
 16210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16211
 16212
 16213 7920-EXIT.
 16214      EXIT.
 16215
 16216 7950-READ-CLAIM.
 16217
 16218
 16219* EXEC CICS READ
 16220*        DATASET   (ELMSTR-DSID)
 16221*        SET       (ADDRESS OF CLAIM-MASTER)
 16222*        RIDFLD    (ELMSTR-KEY)
 16223*    END-EXEC.
 16224*    MOVE '&"S        E          (   #00014396' TO DFHEIV0
 16225     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16226     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16227     MOVE X'2020233030303134333936' TO DFHEIV0(25:11)
 16228     CALL 'kxdfhei1' USING DFHEIV0,
 16229           ELMSTR-DSID,
 16230           DFHEIV20,
 16231           DFHEIV99,
 16232           ELMSTR-KEY,
 16233           DFHEIV99,
 16234           DFHEIV99,
 16235           DFHEIV99
 16236     SET ADDRESS OF CLAIM-MASTER TO
 16237         DFHEIV20
 16238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16239
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 311
* EL130.cbl
 16240
 16241 7950-EXIT.
 16242      EXIT.
 16243
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 312
* EL130.cbl
 16245***************************************
 16246*  I/O REQUESTS AGAINST CONTROL FILE  *
 16247***************************************
 16248
 16249 7960-READ-CNTL-UPDATE.
 16250
 16251
 16252* EXEC CICS READ
 16253*        UPDATE
 16254*        DATASET  (ELCNTL-DSID)
 16255*        SET      (ADDRESS OF CONTROL-FILE)
 16256*        RIDFLD   (ELCNTL-KEY)
 16257*    END-EXEC.
 16258*    MOVE '&"S        EU         (   #00014412' TO DFHEIV0
 16259     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16260     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16261     MOVE X'2020233030303134343132' TO DFHEIV0(25:11)
 16262     CALL 'kxdfhei1' USING DFHEIV0,
 16263           ELCNTL-DSID,
 16264           DFHEIV20,
 16265           DFHEIV99,
 16266           ELCNTL-KEY,
 16267           DFHEIV99,
 16268           DFHEIV99,
 16269           DFHEIV99
 16270     SET ADDRESS OF CONTROL-FILE TO
 16271         DFHEIV20
 16272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16273
 16274
 16275 7960-EXIT.
 16276      EXIT.
 16277
 16278 7970-READ-CNTL.
 16279
 16280
 16281* EXEC CICS READ
 16282*        DATASET  (ELCNTL-DSID)
 16283*        SET      (ADDRESS OF CONTROL-FILE)
 16284*        RIDFLD   (ELCNTL-KEY)
 16285*    END-EXEC.
 16286*    MOVE '&"S        E          (   #00014424' TO DFHEIV0
 16287     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16289     MOVE X'2020233030303134343234' TO DFHEIV0(25:11)
 16290     CALL 'kxdfhei1' USING DFHEIV0,
 16291           ELCNTL-DSID,
 16292           DFHEIV20,
 16293           DFHEIV99,
 16294           ELCNTL-KEY,
 16295           DFHEIV99,
 16296           DFHEIV99,
 16297           DFHEIV99
 16298     SET ADDRESS OF CONTROL-FILE TO
 16299         DFHEIV20
 16300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16301
 16302
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 313
* EL130.cbl
 16303 7970-EXIT.
 16304      EXIT.
 16305
 16306 7975-READ-CNTL-GTEQ.
 16307
 16308
 16309* EXEC CICS READ
 16310*         DATASET   (ELCNTL-DSID)
 16311*         SET       (ADDRESS OF CONTROL-FILE)
 16312*         RIDFLD    (ELCNTL-KEY)
 16313*         GTEQ
 16314*     END-EXEC.
 16315*    MOVE '&"S        G          (   #00014435' TO DFHEIV0
 16316     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16318     MOVE X'2020233030303134343335' TO DFHEIV0(25:11)
 16319     CALL 'kxdfhei1' USING DFHEIV0,
 16320           ELCNTL-DSID,
 16321           DFHEIV20,
 16322           DFHEIV99,
 16323           ELCNTL-KEY,
 16324           DFHEIV99,
 16325           DFHEIV99,
 16326           DFHEIV99
 16327     SET ADDRESS OF CONTROL-FILE TO
 16328         DFHEIV20
 16329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16330
 16331
 16332 7975-EXIT.
 16333      EXIT.
 16334
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 314
* EL130.cbl
 16336**************************************************
 16337*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16338**************************************************
 16339
 16340 7980-READ-CERT5.
 16341
 16342
 16343* EXEC CICS READ
 16344*         DATASET  (ELCERT5-DSID)
 16345*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16346*         RIDFLD   (ELCERT-KEY-5)
 16347*     END-EXEC.
 16348*    MOVE '&"S        E          (   #00014452' TO DFHEIV0
 16349     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16351     MOVE X'2020233030303134343532' TO DFHEIV0(25:11)
 16352     CALL 'kxdfhei1' USING DFHEIV0,
 16353           ELCERT5-DSID,
 16354           DFHEIV20,
 16355           DFHEIV99,
 16356           ELCERT-KEY-5,
 16357           DFHEIV99,
 16358           DFHEIV99,
 16359           DFHEIV99
 16360     SET ADDRESS OF CERTIFICATE-MASTER TO
 16361         DFHEIV20
 16362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16363
 16364
 16365 7980-EXIT.
 16366      EXIT.
 16367
 16368 7930-READ-CERT-UPDATE.
 16369
 16370
 16371* EXEC CICS READ
 16372*        DATASET  (ELCERT-DSID)
 16373*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16374*        RIDFLD   (ELCERT-KEY)
 16375*        UPDATE
 16376*    END-EXEC.
 16377*    MOVE '&"S        EU         (   #00014463' TO DFHEIV0
 16378     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16379     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16380     MOVE X'2020233030303134343633' TO DFHEIV0(25:11)
 16381     CALL 'kxdfhei1' USING DFHEIV0,
 16382           ELCERT-DSID,
 16383           DFHEIV20,
 16384           DFHEIV99,
 16385           ELCERT-KEY,
 16386           DFHEIV99,
 16387           DFHEIV99,
 16388           DFHEIV99
 16389     SET ADDRESS OF CERTIFICATE-MASTER TO
 16390         DFHEIV20
 16391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16392
 16393
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 315
* EL130.cbl
 16394 7930-EXIT.
 16395      EXIT.
 16396
 16397 7940-READ-CERT.
 16398
 16399
 16400* EXEC CICS READ
 16401*        DATASET  (ELCERT-DSID)
 16402*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16403*        RIDFLD   (ELCERT-KEY)
 16404*    END-EXEC.
 16405*    MOVE '&"S        E          (   #00014475' TO DFHEIV0
 16406     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16408     MOVE X'2020233030303134343735' TO DFHEIV0(25:11)
 16409     CALL 'kxdfhei1' USING DFHEIV0,
 16410           ELCERT-DSID,
 16411           DFHEIV20,
 16412           DFHEIV99,
 16413           ELCERT-KEY,
 16414           DFHEIV99,
 16415           DFHEIV99,
 16416           DFHEIV99
 16417     SET ADDRESS OF CERTIFICATE-MASTER TO
 16418         DFHEIV20
 16419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16420
 16421
 16422 7940-EXIT.
 16423      EXIT.
 16424
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 316
* EL130.cbl
 16426**************************************************
 16427*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16428**************************************************
 16429
 16430 7991-READ-BENE.
 16431
 16432
 16433* EXEC CICS READ
 16434*         DATASET   (ELBENE-DSID)
 16435*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16436*         RIDFLD    (ELBENE-KEY)
 16437*     END-EXEC.
 16438*    MOVE '&"S        E          (   #00014491' TO DFHEIV0
 16439     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16441     MOVE X'2020233030303134343931' TO DFHEIV0(25:11)
 16442     CALL 'kxdfhei1' USING DFHEIV0,
 16443           ELBENE-DSID,
 16444           DFHEIV20,
 16445           DFHEIV99,
 16446           ELBENE-KEY,
 16447           DFHEIV99,
 16448           DFHEIV99,
 16449           DFHEIV99
 16450     SET ADDRESS OF BENEFICIARY-MASTER TO
 16451         DFHEIV20
 16452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16453
 16454
 16455 7991-EXIT.
 16456      EXIT.
 16457
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 317
* EL130.cbl
 16459**************************************************
 16460*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16461**************************************************
 16462
 16463 7992-READ-REIN.
 16464
 16465
 16466
 16467* EXEC CICS HANDLE CONDITION
 16468*        NOTFND   (7992-NOT-FOUND)
 16469*    END-EXEC.
 16470*    MOVE '"$I                   ! M #00014508' TO DFHEIV0
 16471     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16473     MOVE X'4D20233030303134353038' TO DFHEIV0(25:11)
 16474     CALL 'kxdfhei1' USING DFHEIV0
 16475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16476
 16477
 16478
 16479
 16480* EXEC CICS READ
 16481*        DATASET   (ERREIN-DSID)
 16482*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16483*        RIDFLD    (ERREIN-KEY)
 16484*    END-EXEC.
 16485*    MOVE '&"S        E          (   #00014513' TO DFHEIV0
 16486     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16487     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16488     MOVE X'2020233030303134353133' TO DFHEIV0(25:11)
 16489     CALL 'kxdfhei1' USING DFHEIV0,
 16490           ERREIN-DSID,
 16491           DFHEIV20,
 16492           DFHEIV99,
 16493           ERREIN-KEY,
 16494           DFHEIV99,
 16495           DFHEIV99,
 16496           DFHEIV99
 16497     SET ADDRESS OF REINSURANCE-RECORD TO
 16498         DFHEIV20
 16499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16500
 16501
 16502     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16503
 16504     GO TO 7992-EXIT.
 16505
 16506 7992-NOT-FOUND.
 16507     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16508
 16509 7992-EXIT.
 16510     EXIT.
 16511
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 318
* EL130.cbl
 16513 8000-LOAD-ERROR-MESSAGES.
 16514     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16515
 16516     IF EMI-NO-ERRORS
 16517         GO TO 8000-EXIT
 16518     END-IF.
 16519
 16520     perform varying e1 from +1 by +1 until e1 > +3
 16521        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16522                                or '1655' or '1660'
 16523           move 'W'              to emi-severity (e1)
 16524        end-if
 16525     end-perform
 16526     IF EMI-NUMBER-OF-LINES = 1
 16527         MOVE EMI-LINE1          TO ERRMSG1O
 16528         GO TO 8000-EXIT
 16529     END-IF.
 16530
 16531     IF EMI-NUMBER-OF-LINES = 2
 16532          MOVE EMI-LINE1         TO ERRMSG1O
 16533          MOVE EMI-LINE2         TO ERRMSG2O
 16534          GO TO 8000-EXIT
 16535     END-IF.
 16536
 16537     MOVE EMI-LINE1              TO ERRMSG1O.
 16538
 16539 8000-EXIT.
 16540     EXIT.
 16541
 16542 8100-SEND-INITIAL-MAP.
 16543     MOVE SAVE-DATE              TO RUNDTEO.
 16544     MOVE EIBTIME                TO TIME-IN.
 16545     MOVE TIME-OUT               TO RUNTIMEO.
 16546     IF EIBAID = DFHPF11
 16547        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16549     end-if
 16550     IF RETURNED-FROM = XCTL-114
 16551        CONTINUE
 16552     ELSE
 16553        MOVE -1                  TO MAINTL
 16554     END-IF.
 16555
 16556*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16557         MOVE SPACES             TO PRODO.
 16558         MOVE AL-SANOF           TO PRODCDA.
 16559*    END-IF.
 16560
 16561     MOVE PI-COMPANY-ID          TO COMPO.
 16562     MOVE AL-PABOF               TO COMPA.
 16563     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16564     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16565     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16566
 16567     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16568
 16569     IF NOT PI-NO-CARRIER-SECURITY
 16570        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 319
* EL130.cbl
 16571        MOVE AL-SABOF            TO CLMCARRA
 16572     END-IF.
 16573
 16574     IF PI-PROCESSOR-ID = 'PEMA'
 16575        MOVE AL-UANON            TO CERTNOA
 16576                                    SUFXA
 16577     END-IF.
 16578*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16579*        NEXT SENTENCE
 16580*        CONTINUE
 16581*    ELSE
 16582         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16583*    END-IF.
 16584
 16585
 16586
 16587* EXEC CICS SEND
 16588*        MAP     (MAP-NAME)
 16589*        MAPSET  (MAPSET-NAME)
 16590*        FROM    (EL130AO)
 16591*        ERASE
 16592*        CURSOR
 16593*    END-EXEC.
 16594     MOVE LENGTH OF
 16595      EL130AO
 16596       TO DFHEIV12
 16597     MOVE -1
 16598       TO DFHEIV11
 16599*    MOVE '8$     CT  E    H L F ,   #00014603' TO DFHEIV0
 16600     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16601     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16602     MOVE X'2020233030303134363033' TO DFHEIV0(25:11)
 16603     CALL 'kxdfhei1' USING DFHEIV0,
 16604           MAP-NAME,
 16605           EL130AO,
 16606           DFHEIV12,
 16607           MAPSET-NAME,
 16608           DFHEIV99,
 16609           DFHEIV99,
 16610           DFHEIV99,
 16611           DFHEIV11,
 16612           DFHEIV99,
 16613           DFHEIV99,
 16614           DFHEIV99
 16615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16616
 16617
 16618     GO TO 9100-RETURN-TRAN.
 16619
 16620 8150-SEND-MAP-CURSOR.
 16621     MOVE SAVE-DATE              TO RUNDTEO.
 16622     MOVE EIBTIME                TO TIME-IN.
 16623     MOVE TIME-OUT               TO RUNTIMEO.
 16624     IF EIBAID = DFHPF11
 16625        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16626        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16627     end-if
 16628     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 320
* EL130.cbl
 16629     MOVE AL-PABOF               TO COMPA
 16630     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16631     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16632     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16633
 16634*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16635         MOVE SPACES             TO PRODO.
 16636         MOVE AL-SANOF           TO PRODCDA.
 16637*    END-IF.
 16638
 16639     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16640
 16641     IF NOT PI-NO-CARRIER-SECURITY
 16642         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16643         MOVE AL-SABOF            TO CLMCARRA
 16644     END-IF.
 16645
 16646     IF PI-PROCESSOR-ID = 'PEMA'
 16647        MOVE AL-UANON            TO CERTNOA
 16648                                    SUFXA
 16649     END-IF.
 16650*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16651*        NEXT SENTENCE
 16652*        CONTINUE
 16653*    ELSE
 16654         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16655*    END-IF.
 16656
 16657
 16658
 16659* EXEC CICS SEND
 16660*        MAP      (MAP-NAME)
 16661*        MAPSET   (MAPSET-NAME)
 16662*        FROM     (EL130AO)
 16663*        CURSOR   (PI-CURSOR)
 16664*        ERASE
 16665*    END-EXEC.
 16666     MOVE LENGTH OF
 16667      EL130AO
 16668       TO DFHEIV11
 16669*    MOVE '8$     CT  E    H L F ,   #00014651' TO DFHEIV0
 16670     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16671     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16672     MOVE X'2020233030303134363531' TO DFHEIV0(25:11)
 16673     CALL 'kxdfhei1' USING DFHEIV0,
 16674           MAP-NAME,
 16675           EL130AO,
 16676           DFHEIV11,
 16677           MAPSET-NAME,
 16678           DFHEIV99,
 16679           DFHEIV99,
 16680           DFHEIV99,
 16681           PI-CURSOR,
 16682           DFHEIV99,
 16683           DFHEIV99,
 16684           DFHEIV99
 16685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16686
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 321
* EL130.cbl
 16687
 16688     GO TO 9100-RETURN-TRAN.
 16689
 16690 8200-SEND-DATAONLY.
 16691     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16692
 16693     IF EIBAID = DFHPF11
 16694        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16695        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16696        go to 8100-send-initial-map
 16697     end-if
 16698*    IF EIBAID = DFHPF11
 16699*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16700*       move pi-last-claim       to emi-claim-no
 16701*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16702*       go to 8100-send-initial-map
 16703*    END-IF.
 16704     .
 16705 8200-BYPASS-ERROR.
 16706     MOVE SAVE-DATE              TO RUNDTEO.
 16707     MOVE EIBTIME                TO TIME-IN.
 16708     MOVE TIME-OUT               TO RUNTIMEO.
 16709     MOVE PI-COMPANY-ID          TO COMPO.
 16710     MOVE AL-PABOF               TO COMPA
 16711     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16712
 16713*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16714         MOVE SPACES             TO PRODO.
 16715         MOVE AL-SANOF           TO PRODCDA.
 16716*    END-IF.
 16717
 16718     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16719     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16720
 16721     IF PI-PROCESSOR-ID = 'PEMA'
 16722        MOVE AL-UANON            TO CERTNOA
 16723                                    SUFXA
 16724     END-IF.
 16725     IF NOT PI-NO-CARRIER-SECURITY
 16726        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16727        MOVE AL-SABOF            TO CLMCARRA
 16728     END-IF.
 16729
 16730*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16731*        NEXT SENTENCE
 16732*        CONTINUE
 16733*    ELSE
 16734         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16735*    END-IF.
 16736
 16737*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16738         MOVE AL-SANOF           TO PRODCDA.
 16739*    END-IF.
 16740
 16741
 16742
 16743* EXEC CICS SEND
 16744*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 322
* EL130.cbl
 16745*        MAPSET   (MAPSET-NAME)
 16746*        FROM     (EL130AO)
 16747*        DATAONLY
 16748*        CURSOR
 16749*    END-EXEC.
 16750     MOVE LENGTH OF
 16751      EL130AO
 16752       TO DFHEIV12
 16753     MOVE -1
 16754       TO DFHEIV11
 16755*    MOVE '8$D    CT       H L F ,   #00014713' TO DFHEIV0
 16756     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16757     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16758     MOVE X'2020233030303134373133' TO DFHEIV0(25:11)
 16759     CALL 'kxdfhei1' USING DFHEIV0,
 16760           MAP-NAME,
 16761           EL130AO,
 16762           DFHEIV12,
 16763           MAPSET-NAME,
 16764           DFHEIV99,
 16765           DFHEIV99,
 16766           DFHEIV99,
 16767           DFHEIV11,
 16768           DFHEIV99,
 16769           DFHEIV99,
 16770           DFHEIV99
 16771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16772
 16773
 16774     GO TO 9100-RETURN-TRAN.
 16775
 16776 8300-SEND-TEXT.
 16777
 16778
 16779* EXEC CICS SEND TEXT
 16780*        FROM     (LOGOFF-TEXT)
 16781*        LENGTH   (LOGOFF-LENGTH)
 16782*        ERASE
 16783*        FREEKB
 16784*    END-EXEC.
 16785*    MOVE '8&      T  E F  H   F -   #00014725' TO DFHEIV0
 16786     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16787     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16788     MOVE X'2020233030303134373235' TO DFHEIV0(25:11)
 16789     CALL 'kxdfhei1' USING DFHEIV0,
 16790           LOGOFF-TEXT,
 16791           LOGOFF-LENGTH,
 16792           DFHEIV99,
 16793           DFHEIV99,
 16794           DFHEIV99,
 16795           DFHEIV99,
 16796           DFHEIV99,
 16797           DFHEIV99,
 16798           DFHEIV99,
 16799           DFHEIV99,
 16800           DFHEIV99,
 16801           DFHEIV99
 16802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 323
* EL130.cbl
 16803
 16804
 16805
 16806
 16807* EXEC CICS RETURN
 16808*    END-EXEC.
 16809*    MOVE '.(                    ''   #00014733' TO DFHEIV0
 16810     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16812     MOVE X'2020233030303134373333' TO DFHEIV0(25:11)
 16813     CALL 'kxdfhei1' USING DFHEIV0,
 16814           DFHEIV99,
 16815           DFHEIV99,
 16816           DFHEIV99,
 16817           DFHEIV99,
 16818           DFHEIV99,
 16819           DFHEIV99
 16820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16821
 16822
 16823 8800-UNAUTHORIZED-ACCESS.
 16824     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16825     GO TO 8300-SEND-TEXT.
 16826
 16827 8810-PF23.
 16828     MOVE EIBAID TO PI-ENTRY-CD-1.
 16829     MOVE XCTL-005               TO PGM-NAME.
 16830     GO TO 9300-XCTL.
 16831
 16832 8820-TERM-ERROR.
 16833     MOVE ER-0412                TO EMI-ERROR.
 16834     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16835     MOVE -1                     TO MAINTL.
 16836     GO TO 8200-SEND-DATAONLY.
 16837
 16838 8830-TRAN-ERROR.
 16839     MOVE ER-0413                TO EMI-ERROR.
 16840     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16841     MOVE -1                     TO MAINTL.
 16842     GO TO 8200-SEND-DATAONLY.
 16843
 16844 9000-RETURN-CICS.
 16845
 16846
 16847* EXEC CICS RETURN
 16848*    END-EXEC.
 16849*    MOVE '.(                    ''   #00014759' TO DFHEIV0
 16850     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16851     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16852     MOVE X'2020233030303134373539' TO DFHEIV0(25:11)
 16853     CALL 'kxdfhei1' USING DFHEIV0,
 16854           DFHEIV99,
 16855           DFHEIV99,
 16856           DFHEIV99,
 16857           DFHEIV99,
 16858           DFHEIV99,
 16859           DFHEIV99
 16860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 324
* EL130.cbl
 16861
 16862
 16863 9100-RETURN-TRAN.
 16864     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16865     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16866
 16867
 16868
 16869* EXEC CICS RETURN
 16870*        TRANSID   (TRANS-ID)
 16871*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16872*        LENGTH    (PI-COMM-LENGTH)
 16873*    END-EXEC.
 16874*    MOVE '.(CT                  ''   #00014767' TO DFHEIV0
 16875     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16877     MOVE X'2020233030303134373637' TO DFHEIV0(25:11)
 16878     CALL 'kxdfhei1' USING DFHEIV0,
 16879           TRANS-ID,
 16880           PROGRAM-INTERFACE-BLOCK,
 16881           PI-COMM-LENGTH,
 16882           DFHEIV99,
 16883           DFHEIV99,
 16884           DFHEIV99
 16885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16886
 16887
 16888 9200-RETURN-MAIN-MENU.
 16889     MOVE XCTL-126               TO PGM-NAME.
 16890     GO TO 9300-XCTL.
 16891
 16892 9300-XCTL.
 16893
 16894
 16895* EXEC CICS XCTL
 16896*        PROGRAM   (PGM-NAME)
 16897*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16898*        LENGTH    (PI-COMM-LENGTH)
 16899*    END-EXEC.
 16900*    MOVE '.$C                   %   #00014779' TO DFHEIV0
 16901     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16902     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16903     MOVE X'2020233030303134373739' TO DFHEIV0(25:11)
 16904     CALL 'kxdfhei1' USING DFHEIV0,
 16905           PGM-NAME,
 16906           PROGRAM-INTERFACE-BLOCK,
 16907           PI-COMM-LENGTH,
 16908           DFHEIV99
 16909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16910
 16911
 16912 9400-CLEAR.
 16913     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16914     GO TO 9300-XCTL.
 16915
 16916 9500-PF12.
 16917     MOVE XCTL-010               TO PGM-NAME.
 16918     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 325
* EL130.cbl
 16919
 16920 9600-PGMID-ERROR.
 16921
 16922
 16923* EXEC CICS HANDLE CONDITION
 16924*        PGMIDERR  (8300-SEND-TEXT)
 16925*    END-EXEC.
 16926*    MOVE '"$L                   ! N #00014795' TO DFHEIV0
 16927     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16929     MOVE X'4E20233030303134373935' TO DFHEIV0(25:11)
 16930     CALL 'kxdfhei1' USING DFHEIV0
 16931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16932
 16933
 16934     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16935     MOVE ' '                    TO PI-ENTRY-CD-1.
 16936     MOVE XCTL-005               TO PGM-NAME.
 16937     MOVE PGM-NAME               TO LOGOFF-PGM.
 16938     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16939     GO TO 9300-XCTL.
 16940
 16941 9700-LINK-DATE-CONVERT.
 16942     MOVE LINK-ELDATCV           TO PGM-NAME.
 16943
 16944
 16945* EXEC CICS LINK
 16946*        PROGRAM    (PGM-NAME)
 16947*        COMMAREA   (DATE-CONVERSION-DATA)
 16948*        LENGTH     (DC-COMM-LENGTH)
 16949*    END-EXEC.
 16950*    MOVE '."C                   (   #00014809' TO DFHEIV0
 16951     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16953     MOVE X'2020233030303134383039' TO DFHEIV0(25:11)
 16954     CALL 'kxdfhei1' USING DFHEIV0,
 16955           PGM-NAME,
 16956           DATE-CONVERSION-DATA,
 16957           DC-COMM-LENGTH,
 16958           DFHEIV99,
 16959           DFHEIV99,
 16960           DFHEIV99,
 16961           DFHEIV99
 16962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16963
 16964
 16965 9700-EXIT.
 16966     EXIT.
 16967
 16968 9800-LINK-REM-TERM.
 16969     MOVE LINK-ELRTRM            TO PGM-NAME.
 16970
 16971
 16972* EXEC CICS LINK
 16973*        PROGRAM    (PGM-NAME)
 16974*        COMMAREA   (CALCULATION-PASS-AREA)
 16975*        LENGTH     (CP-COMM-LENGTH)
 16976*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 326
* EL130.cbl
 16977*    MOVE '."C                   (   #00014821' TO DFHEIV0
 16978     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16980     MOVE X'2020233030303134383231' TO DFHEIV0(25:11)
 16981     CALL 'kxdfhei1' USING DFHEIV0,
 16982           PGM-NAME,
 16983           CALCULATION-PASS-AREA,
 16984           CP-COMM-LENGTH,
 16985           DFHEIV99,
 16986           DFHEIV99,
 16987           DFHEIV99,
 16988           DFHEIV99
 16989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16990
 16991
 16992 9800-EXIT.
 16993     EXIT.
 16994
 16995 9900-ERROR-FORMAT.
 16996*    if emi-error = 1651 or 1652 or 1653 or 1655
 16997*       display ' 9900 error ' emi-error
 16998*       display emi-message-area (1)
 16999*       display emi-message-area (2)
 17000*       display emi-message-area (3)
 17001*    end-if
 17002     IF NOT EMI-ERRORS-COMPLETE
 17003         MOVE LINK-001           TO PGM-NAME
 17004
 17005* EXEC CICS LINK
 17006*            PROGRAM   (PGM-NAME)
 17007*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 17008*            LENGTH    (EMI-COMM-LENGTH)
 17009*        END-EXEC
 17010*    MOVE '."C                   (   #00014839' TO DFHEIV0
 17011     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17013     MOVE X'2020233030303134383339' TO DFHEIV0(25:11)
 17014     CALL 'kxdfhei1' USING DFHEIV0,
 17015           PGM-NAME,
 17016           ERROR-MESSAGE-INTERFACE-BLOCK,
 17017           EMI-COMM-LENGTH,
 17018           DFHEIV99,
 17019           DFHEIV99,
 17020           DFHEIV99,
 17021           DFHEIV99
 17022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17023         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 17024            subtract 1 from emi-fatal-ctr
 17025         end-if
 17026     END-IF.
 17027
 17028     .
 17029 9900-EXIT.
 17030     EXIT.
 17031
 17032 9990-ABEND.
 17033     MOVE -1                     TO MAINTL.
 17034     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 327
* EL130.cbl
 17035     MOVE DFHEIBLK               TO EMI-LINE1.
 17036
 17037
 17038* EXEC CICS LINK
 17039*        PROGRAM   (PGM-NAME)
 17040*        COMMAREA  (EMI-LINE1)
 17041*        LENGTH    (72)
 17042*    END-EXEC.
 17043     MOVE 72
 17044       TO DFHEIV11
 17045*    MOVE '."C                   (   #00014858' TO DFHEIV0
 17046     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17048     MOVE X'2020233030303134383538' TO DFHEIV0(25:11)
 17049     CALL 'kxdfhei1' USING DFHEIV0,
 17050           PGM-NAME,
 17051           EMI-LINE1,
 17052           DFHEIV11,
 17053           DFHEIV99,
 17054           DFHEIV99,
 17055           DFHEIV99,
 17056           DFHEIV99
 17057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17058
 17059
 17060     MOVE EMI-LINE1              TO ERRMSG2O.
 17061
 17062     GO TO 8200-BYPASS-ERROR.
 17063
 17064
 17065
 17066* GOBACK.
 17067     MOVE '9%                    "   ' TO DFHEIV0
 17068     MOVE 'EL130' TO DFHEIV1
 17069     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17070     GOBACK.
 17071
 17072 9995-SECURITY-VIOLATION.
 17073*             COPY ELCSCTP.
 17074******************************************************************
 17075*                                                                *
 17076*                            ELCSCTP                             *
 17077*                            VMOD=2.001                          *
 17078*                                                                *
 17079*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17080******************************************************************
 17081
 17082
 17083     MOVE EIBDATE          TO SM-JUL-DATE.
 17084     MOVE EIBTRMID         TO SM-TERMID.
 17085     MOVE THIS-PGM         TO SM-PGM.
 17086     MOVE EIBTIME          TO TIME-IN.
 17087     MOVE TIME-OUT         TO SM-TIME.
 17088     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17089
 17090
 17091* EXEC CICS LINK
 17092*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 328
* EL130.cbl
 17093*         COMMAREA (SECURITY-MESSAGE)
 17094*         LENGTH   (80)
 17095*    END-EXEC.
 17096     MOVE 'EL003' TO DFHEIV1
 17097     MOVE 80
 17098       TO DFHEIV11
 17099*    MOVE '."C                   (   #00014889' TO DFHEIV0
 17100     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17102     MOVE X'2020233030303134383839' TO DFHEIV0(25:11)
 17103     CALL 'kxdfhei1' USING DFHEIV0,
 17104           DFHEIV1,
 17105           SECURITY-MESSAGE,
 17106           DFHEIV11,
 17107           DFHEIV99,
 17108           DFHEIV99,
 17109           DFHEIV99,
 17110           DFHEIV99
 17111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17112
 17113
 17114******************************************************************
 17115
 17116
 17117 9995-EXIT.
 17118     EXIT.
 17119
 17120
 17121 9999-DFHBACK SECTION.
 17122     MOVE '9%                    "   ' TO DFHEIV0
 17123     MOVE 'EL130' TO DFHEIV1
 17124     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17125     GOBACK.
 17126 9999-DFHEXIT.
 17127     IF DFHEIGDJ EQUAL 0001
 17128         NEXT SENTENCE
 17129     ELSE IF DFHEIGDJ EQUAL 2
 17130         GO TO 0100-TEST-ENTRY,
 17131               8100-SEND-INITIAL-MAP,
 17132               9600-PGMID-ERROR,
 17133               8820-TERM-ERROR,
 17134               8830-TRAN-ERROR,
 17135               9990-ABEND
 17136         DEPENDING ON DFHEIGDI
 17137     ELSE IF DFHEIGDJ EQUAL 3
 17138         GO TO 0450-ADD-ELACTQ-RECORD
 17139         DEPENDING ON DFHEIGDI
 17140     ELSE IF DFHEIGDJ EQUAL 4
 17141         GO TO 8820-TERM-ERROR,
 17142               8830-TRAN-ERROR
 17143         DEPENDING ON DFHEIGDI
 17144     ELSE IF DFHEIGDJ EQUAL 5
 17145         GO TO 0660-NOT-FOUND,
 17146               0670-QIDERR
 17147         DEPENDING ON DFHEIGDI
 17148     ELSE IF DFHEIGDJ EQUAL 6
 17149         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17150         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 329
* EL130.cbl
 17151     ELSE IF DFHEIGDJ EQUAL 7
 17152         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17153         DEPENDING ON DFHEIGDI
 17154     ELSE IF DFHEIGDJ EQUAL 8
 17155         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17156         DEPENDING ON DFHEIGDI
 17157     ELSE IF DFHEIGDJ EQUAL 9
 17158         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17159         DEPENDING ON DFHEIGDI
 17160     ELSE IF DFHEIGDJ EQUAL 10
 17161         GO TO 2050-DELETE-NOT-FOUND
 17162         DEPENDING ON DFHEIGDI
 17163     ELSE IF DFHEIGDJ EQUAL 11
 17164         GO TO 2010-DELETE-CL
 17165         DEPENDING ON DFHEIGDI
 17166     ELSE IF DFHEIGDJ EQUAL 12
 17167         GO TO 3010-TEST-FOR-ERRORS
 17168         DEPENDING ON DFHEIGDI
 17169     ELSE IF DFHEIGDJ EQUAL 13
 17170         GO TO 3008-DUP-ERROR,
 17171               3009-NOT-FOUND
 17172         DEPENDING ON DFHEIGDI
 17173     ELSE IF DFHEIGDJ EQUAL 14
 17174         GO TO 3030-BUILD-CONT
 17175         DEPENDING ON DFHEIGDI
 17176     ELSE IF DFHEIGDJ EQUAL 15
 17177         GO TO 3033-ACCT-NOT-FOUND,
 17178               3033-ACCT-NOT-FOUND
 17179         DEPENDING ON DFHEIGDI
 17180     ELSE IF DFHEIGDJ EQUAL 16
 17181         GO TO 3032-NOT-IN-DT-RANGE
 17182         DEPENDING ON DFHEIGDI
 17183     ELSE IF DFHEIGDJ EQUAL 17
 17184         GO TO 3070-BUILD-CONT
 17185         DEPENDING ON DFHEIGDI
 17186     ELSE IF DFHEIGDJ EQUAL 18
 17187         GO TO 3065-CERT-NOT-FOUND
 17188         DEPENDING ON DFHEIGDI
 17189     ELSE IF DFHEIGDJ EQUAL 19
 17190         GO TO 3100-CARRIER-NOT-FOUND
 17191         DEPENDING ON DFHEIGDI
 17192     ELSE IF DFHEIGDJ EQUAL 20
 17193         GO TO 3110-COMPANY-NOT-FOUND
 17194         DEPENDING ON DFHEIGDI
 17195     ELSE IF DFHEIGDJ EQUAL 21
 17196         GO TO 3200-BUILD-ZERO-TRAILER
 17197         DEPENDING ON DFHEIGDI
 17198     ELSE IF DFHEIGDJ EQUAL 22
 17199         GO TO 9999-DFHBACK
 17200         DEPENDING ON DFHEIGDI
 17201     ELSE IF DFHEIGDJ EQUAL 23
 17202         GO TO 3290-NO-INSURED-ADDRESS
 17203         DEPENDING ON DFHEIGDI
 17204     ELSE IF DFHEIGDJ EQUAL 24
 17205         GO TO 3410-DUP-KEY
 17206         DEPENDING ON DFHEIGDI
 17207     ELSE IF DFHEIGDJ EQUAL 25
 17208         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 330
* EL130.cbl
 17209         DEPENDING ON DFHEIGDI
 17210     ELSE IF DFHEIGDJ EQUAL 26
 17211         GO TO 3850-CLAIM-MSTR-WRITTEN
 17212         DEPENDING ON DFHEIGDI
 17213     ELSE IF DFHEIGDJ EQUAL 27
 17214         GO TO 3992-DUPREC
 17215         DEPENDING ON DFHEIGDI
 17216     ELSE IF DFHEIGDJ EQUAL 28
 17217         GO TO 5050-CERT-NOT-FOUND
 17218         DEPENDING ON DFHEIGDI
 17219     ELSE IF DFHEIGDJ EQUAL 29
 17220         GO TO 5030-CERT-WRITTEN
 17221         DEPENDING ON DFHEIGDI
 17222     ELSE IF DFHEIGDJ EQUAL 30
 17223         GO TO 5035-CLAIM-WRITTEN
 17224         DEPENDING ON DFHEIGDI
 17225     ELSE IF DFHEIGDJ EQUAL 31
 17226         GO TO 9990-ABEND,
 17227               5799-EXIT
 17228         DEPENDING ON DFHEIGDI
 17229     ELSE IF DFHEIGDJ EQUAL 32
 17230         GO TO 3100-CARRIER-NOT-FOUND
 17231         DEPENDING ON DFHEIGDI
 17232     ELSE IF DFHEIGDJ EQUAL 33
 17233         GO TO 6040-NO-PROCESSOR-RECORD
 17234         DEPENDING ON DFHEIGDI
 17235     ELSE IF DFHEIGDJ EQUAL 34
 17236         GO TO 6060-NO-BENEFICIARY-RECORD
 17237         DEPENDING ON DFHEIGDI
 17238     ELSE IF DFHEIGDJ EQUAL 35
 17239         GO TO 6499-EXIT,
 17240               6499-EXIT
 17241         DEPENDING ON DFHEIGDI
 17242     ELSE IF DFHEIGDJ EQUAL 36
 17243         GO TO 6600-NOT-FOUND
 17244         DEPENDING ON DFHEIGDI
 17245     ELSE IF DFHEIGDJ EQUAL 37
 17246         GO TO 6700-NOTOPEN-ERROR,
 17247               6700-EXIT
 17248         DEPENDING ON DFHEIGDI
 17249     ELSE IF DFHEIGDJ EQUAL 38
 17250         GO TO 7120-NOT-FOUND
 17251         DEPENDING ON DFHEIGDI
 17252     ELSE IF DFHEIGDJ EQUAL 39
 17253         GO TO 7499-EXIT
 17254         DEPENDING ON DFHEIGDI
 17255     ELSE IF DFHEIGDJ EQUAL 40
 17256         GO TO 7500-EXIT,
 17257               7500-DUPLICATE-KEY,
 17258               7500-EXIT
 17259         DEPENDING ON DFHEIGDI
 17260     ELSE IF DFHEIGDJ EQUAL 41
 17261         GO TO 7500-END-BROWSE
 17262         DEPENDING ON DFHEIGDI
 17263     ELSE IF DFHEIGDJ EQUAL 42
 17264         GO TO 7630-END-BROWSE
 17265         DEPENDING ON DFHEIGDI
 17266     ELSE IF DFHEIGDJ EQUAL 43
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:28 Page 331
* EL130.cbl
 17267         GO TO 7799-EXIT,
 17268               7799-EXIT
 17269         DEPENDING ON DFHEIGDI
 17270     ELSE IF DFHEIGDJ EQUAL 44
 17271         GO TO 7790-END-BROWSE
 17272         DEPENDING ON DFHEIGDI
 17273     ELSE IF DFHEIGDJ EQUAL 45
 17274         GO TO 7992-NOT-FOUND
 17275         DEPENDING ON DFHEIGDI
 17276     ELSE IF DFHEIGDJ EQUAL 46
 17277         GO TO 8300-SEND-TEXT
 17278         DEPENDING ON DFHEIGDI.
 17279     MOVE '9%                    "   ' TO DFHEIV0
 17280     MOVE 'EL130' TO DFHEIV1
 17281     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17282     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12864     Code:       55050
