* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   3
* EL050.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63
    64 77  FILLER   PIC X(32) VALUE '********************************'.
    65 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    66 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    67
    68 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    69 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    70                                   USAGE POINTER.
    71 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    74                                   USAGE IS POINTER.
    75 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    77                                   USAGE IS POINTER.
    78 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    79 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    80                                   USAGE IS POINTER.
    81
    82 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    83 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    84                                   USAGE IS POINTER.
    85
    86*    COPY ELC50WS.
    87*****************************************************************
    88*                                                               *
    89*                            ELC50WS.                           *
    90*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    91*                            VMOD=2.061.                        *
    92*                                                               *
    93*   THIS IS THE WORKING STORAGE FOR EL050                       *
    94*                                   EL517                       *
    95*****************************************************************
    96******************************************************************
    97*                   C H A N G E   L O G
    98*
    99* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   100*-----------------------------------------------------------------
   101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   102* EFFECTIVE    NUMBER
   103*-----------------------------------------------------------------
   104* 123102                   PEMA  ADD DCC PROCESSING
   105* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   106* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   107* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   108* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   109* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   110* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   111* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   112* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   113* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   114* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   115* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   116* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   117* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   118* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   4
* EL050.cbl
   119* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   120* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   121* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   122* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   123* 030309  CR2009021700001  PEMA  ADD ER-2883
   124* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   125* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   126* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   127* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   128* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   129* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   130* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   131* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   132* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   133* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   134* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   135* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   136* 061412  CR2011022800001  AJRA  NAPERSOFT
   137* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   138* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   139* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   140* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   141* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   142* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   143* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   144* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   145* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   146* 091114  IR2014091000001  TANA  ADD ERROR 2898
   147* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   148* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   149* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   150*-----------------------------------------------------------------
   151
   152 01  WORK-AREAS.
   153
   154*****************************************************************
   155*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   156*****************************************************************
   157
   158     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   159     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   160     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   161     12  WS-NAME-EDIT-WORK-AREA.
   162         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   163         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   164             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   165         16  WS-WORK-NAME.
   166             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   167             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   168             20  FILLER           PIC X(10)     VALUE SPACES.
   169         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   170             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   171
   172*****************************************************************
   173*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   174*****************************************************************
   175
   176     12  WS-ERRESC-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   5
* EL050.cbl
   177         16 WS-ERRESC-SEARCH-KEY.
   178             20  WS-ERRESC-COMPANY-CD PIC  X.
   179             20  WS-ERRESC-CARRIER    PIC  X.
   180             20  WS-ERRESC-GROUP      PIC X(6).
   181             20  WS-ERRESC-STATE      PIC XX.
   182             20  WS-ERRESC-ACCOUNT    PIC X(10).
   183         16 WS-ERRESC-RESIDUAL-KEY.
   184             20  WS-ERRESC-AGENT      PIC X(10).
   185             20  WS-ERRESC-RES-STATE  PIC XX.
   186             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   187*                                          YYYYMMDD
   188     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   189     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   190
   191*RESIDENT STATE TAX MASTER(ERRESS)
   192*
   193     12  WS-ERRESS-KEY.
   194         16  WS-ERRESS-COMPANY-CD      PIC  X.
   195         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   196         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   197         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   198*                                          YYYYMMDD
   199
   200     12  WS-CONTRACT-DATE              PIC 9(8).
   201*                                          YYYYMMDD
   202     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   203     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   204         16 WS-YEAR-YY                 PIC   9999.
   205         16 FILLER                     PIC 9(4).
   206*                                          YYYYMMDD
   207     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   208     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   209     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   210     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   211
   212     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   213         88  DPRB-1ST-TIME                      VALUE ' '.
   214
   215*****************************************************************
   216*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   217*****************************************************************
   218
   219     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   220     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   221     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   223     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   224     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   225     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   226     12  ws-st-agent-sig-edit    pic x          value spaces.
   227     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   228     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   229     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   230     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   231         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   232         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   233     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   234         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   6
* EL050.cbl
   235         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   236     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   237
   238     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   239     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   240
   241     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   242     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   253     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   255     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   256     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   274     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   275     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   277     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   278     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   279     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   280     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   289     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   290     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   291     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   292     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   7
* EL050.cbl
   293     12  WS-2671-SW               PIC X         VALUE SPACE.
   294     12  WS-2672-SW               PIC X         VALUE SPACE.
   295     12  ws-9813-sw               pic x         value spaces.
   296     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   297         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   298     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   299         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   300     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   301
   302     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   303         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   304         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   305         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   306         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   307
   308     12  WS-CREDIT-EDIT-CONTROLS.
   309         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   310         16  WS-MIN-AGE           PIC 99                VALUE  0.
   311         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   312         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   313         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   314         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   315
   316     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   317     12  WS-AGE-FIELDS.
   318         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   319         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   320         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   321         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   322
   323     12  WS-SAVE-ALLOWABLE-BENEFIT.
   324         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   325         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   326         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   327         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   328         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   329         16  FILLER                      PIC XX.
   330
   331     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   332     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   333     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   334     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   335     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   336     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   337     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   338     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   339     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   340     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   341
   342     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   343     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   344     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   345     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   346     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   347     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   348     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   349     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   350         88  WS-REDUCING              VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   8
* EL050.cbl
   351         88  WS-LEVEL                 VALUE 'L' 'P'.
   352     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   353
   354     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   355     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   356     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   357     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   358     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   359     12  ws-ah-max-bens           pic 99        value zeros.
   360     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   361     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   362     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   363     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   364
   365     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   366     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   367     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   368     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   369     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   370     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   371     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   372     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   373     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   374     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   375     12  WS-ACCT-SIG-SW.
   376         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   377         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   378     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   379     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   380     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   382     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   385     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   387     12  WS-INITIALS.
   388         16  WS-INIT-1            PIC X         VALUE SPACES.
   389         16  WS-INIT-2            PIC X         VALUE SPACES.
   390
   391     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   392     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   393     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   394     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   395     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   396*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   397     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   401     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   403     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   404     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   405     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   406     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   407     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   408     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page   9
* EL050.cbl
   409     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   410     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   411     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   412     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   419******** FLA
   420     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   421     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   422     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   423     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   424     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   425********
   426     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   427     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   428     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   429     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   430     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   431     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   432     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   433     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   434     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   435     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   436
   437     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   438         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   439                                         '0' THRU '9'.
   440
   441     12  NUMBER-OF-MONTHS.
   442         16  SK-MO OCCURS 12 TIMES PIC X.
   443
   444     12  WS-WORK-DATE.
   445         16  WS-YEAR            PIC 99    VALUE 00.
   446         16  WS-MONTH           PIC 99    VALUE 00.
   447         16  WS-DAY             PIC 99    VALUE 00.
   448
   449     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   450     12  WS-WORK-CRIT-DEV       REDEFINES
   451         WS-WORK-LF-CRIT-PER    PIC X(03).
   452
   453     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   454     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   455
   456     12  WS-WORK-DATE-FROM.
   457         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X  VALUE SPACE.
   459         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   460         16  FILLER             PIC X         VALUE SPACE.
   461         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   462
   463     12  WS-WORK-DATE-THRU.
   464         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   465         16  FILLER             PIC X         VALUE SPACE.
   466         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  10
* EL050.cbl
   467         16  FILLER             PIC X         VALUE SPACE.
   468         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   469
   470     12  WS-LF-INPUT-CD.
   471         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   472         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   473
   474     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   475     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   476         16  WS-AH-INPUT-CD-1   PIC X.
   477         16  WS-AH-INPUT-CD-2-3 PIC XX.
   478
   479     12  WS-SWITCHES.
   480         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   481         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   482             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   483         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   484             88  BANK-ACCT-FOUND          VALUE 'Y'.
   485         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   486             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   487         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   488             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   489         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   490             88  COMP-MASTER-FOUND        VALUE 'Y'.
   491         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   492             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   493         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   494             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   495         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   496             88  STAT-MASTER-FOUND        VALUE 'Y'.
   497         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   498             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   499         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   500             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   501         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   502             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   503         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   504             88  FORM-MASTER-FOUND        VALUE 'Y'.
   505         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   506             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   507         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   508             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   509         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   510             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   511         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   512             88  NO-BENEFIT-FOUND         VALUE 'N'.
   513         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   514             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   515         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   516             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   517         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   518             88  AH-BENEFIT-FOUND         VALUE ' '.
   519             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   520         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   521             88  LF-BENEFIT-FOUND         VALUE ' '.
   522             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   523         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   524             88  NO-STATE-RECORD          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  11
* EL050.cbl
   525         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   526             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   527         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   528             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   529         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   530             88  CERT-WAS-FOUND           VALUE ' '.
   531             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   532         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   533             88  BROWSE-STARTED           VALUE 'Y'.
   534         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   535             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   536         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   537             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   538         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   539             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   540         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   541             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   542         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   543             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   544         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   545             88  APP-CERT-USED            VALUE 'Y' 'A'.
   546         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   547             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   548             88  FIRST-TIME-THROUGH       VALUE '1'.
   549             88  CTBL-NOT-FOUND           VALUE '2'.
   550
   551         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   552             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   553
   554         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   555             88  DLO-ERROR-FOUND          VALUE 'Y'.
   556
   557********FLA
   558     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   559     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   560********
   561     12  RC-SW-1                  PIC X           VALUE '0'.
   562     12  RC-SW-2                  PIC X           VALUE '0'.
   563     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   564     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   565     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   572     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   573     12  LIT-SPACES               PIC X           VALUE SPACES.
   574     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   575     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   576     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   577     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   578     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   579     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   580     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   581         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   582         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  12
* EL050.cbl
   583     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   584         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   585
   586 01  WS-EXTRA-PERIODS-BY-STATE.
   587     12  WS-INT-PERIODS          PIC 9.
   588     12  WS-EXTRA-PMTS           PIC 9.
   589 01  ws-net-only-state           pic x value 'N'.
   590 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   591     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   592     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   593 01  WS-CRI-SSN-WORK-AREA.
   594     05  WS-CRI-SOC-SEC-NO.
   595         10  WS-SS-REPT-CD       PIC X(5).
   596         10  WS-SS-LAST-NAME     PIC X(5).
   597         10  WS-SS-INITIAL       PIC X.
   598
   599     05  WS-CRI-REPORT-CODE.
   600         10  FILLER              PIC X(5).
   601         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   602
   603     05  WS-CRI-LAST-NAME.
   604         10  WS-CRI-NAME-MOVE    PIC X(5).
   605         10  FILLER              PIC X(10).
   606
   607 01  WS-NUM-TABLE                PIC X(26)  VALUE
   608     '12345678012345070923456789'.
   609 01  FILLER REDEFINES WS-NUM-TABLE.
   610     05  WS-NUM OCCURS 26        PIC 9.
   611 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   612 01  V1                          PIC S999 COMP-3.
   613 01  V2                          PIC S999 COMP-3.
   614 01  V3                          PIC S999 COMP-3.
   615 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   616 01  FILLER REDEFINES WS-WORK-VIN.
   617     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   618 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   619 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   620 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   621 01  WS-HEX-WORK.
   622     05  FILLER                  PIC X  VALUE LOW-VALUES.
   623     05  WS-HEX-BYTE             PIC X.
   624 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   625 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   626 01  WS-WORK-HIN-ROW-B.
   627     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   628
   629 01  ws-benefit-cd-chg-sw      pic x value spaces.
   630     88  benefit-code-chg           value 'Y'.
   631 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   632 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   633     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   634 01  WS-ROW-D-TABLE.
   635     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   636
   637 01  WS-HIN-TABLE-B.
   638     05  F                       PIC XX VALUE 'A2'.
   639     05  F                       PIC XX VALUE 'B3'.
   640     05  F                       PIC XX VALUE 'C4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  13
* EL050.cbl
   641     05  F                       PIC XX VALUE 'D5'.
   642     05  F                       PIC XX VALUE 'E6'.
   643     05  F                       PIC XX VALUE 'F7'.
   644     05  F                       PIC XX VALUE 'G8'.
   645     05  F                       PIC XX VALUE 'H9'.
   646     05  F                       PIC XX VALUE 'I1'.
   647     05  F                       PIC XX VALUE 'J2'.
   648     05  F                       PIC XX VALUE 'K3'.
   649     05  F                       PIC XX VALUE 'L4'.
   650     05  F                       PIC XX VALUE 'M5'.
   651     05  F                       PIC XX VALUE 'N6'.
   652     05  F                       PIC XX VALUE 'O0'.
   653     05  F                       PIC XX VALUE 'P7'.
   654     05  F                       PIC XX VALUE 'Q0'.
   655     05  F                       PIC XX VALUE 'R8'.
   656     05  F                       PIC XX VALUE 'S9'.
   657     05  F                       PIC XX VALUE 'T2'.
   658     05  F                       PIC XX VALUE 'U3'.
   659     05  F                       PIC XX VALUE 'V4'.
   660     05  F                       PIC XX VALUE 'W5'.
   661     05  F                       PIC XX VALUE 'X6'.
   662     05  F                       PIC XX VALUE 'Y7'.
   663     05  F                       PIC XX VALUE 'Z8'.
   664 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   665     05  WS-VAL-IN               PIC X.
   666     05  WS-VAL-OUT              PIC 9.
   667 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   668 01  WS-COMPARE-BINARY-DATES.
   669     05  WS-971231                PIC XX VALUE X'92FF'.
   670     05  WS-931231                PIC XX VALUE X'8CFF'.
   671     05  WS-791231                PIC XX VALUE X'77FF'.
   672     05  WS-771001                PIC XX VALUE X'74A1'.
   673     05  WS-820301                PIC XX VALUE X'7B41'.
   674     05  WS-831031                PIC XX VALUE X'7DBF'.
   675     05  WS-831231                PIC XX VALUE X'7DFF'.
   676     05  WS-810831                PIC XX VALUE X'7A7F'.
   677     05  WS-830901                PIC XX VALUE X'7D81'.
   678
   679 01  FILE-ACCESS-IDS.
   680     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   681     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   682     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   683     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   684     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   685     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   686     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   687     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   688     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   689     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   690     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   691     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   692     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   693     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   694     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   695     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   696     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   697 01  DD-IU-SW                    PIC X   VALUE ' '.
   698     88  DD-IU-PRESENT                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  14
* EL050.cbl
   699
   700 01  ACCESS-KEYS.
   701     12  ELMSTR-KEY.
   702         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   704     12  W-CLAIM-KEY.
   705         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   706         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   707
   708     12  ELCNTL-KEY.
   709         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   710         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   711         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   712         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   713
   714     12  ELCERT-KEY.
   715         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   716         16  CERT-CARRIER         PIC X       VALUE SPACE.
   717         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   718         16  CERT-STATE           PIC XX      VALUE SPACES.
   719         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   720         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   721         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   722
   723     12  ELCERT2-KEY.
   724         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   725         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   726
   727     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   728
   729     12  ELCERT-SAVE.
   730         16  FILLER                      PIC XX    VALUE SPACES.
   731
   732         16  WCS-CONTROL-PRIMARY.
   733             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   734             20  WCS-CARRIER             PIC X     VALUE SPACE.
   735             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   736             20  WCS-STATE               PIC XX    VALUE SPACES.
   737             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   738             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   739             20  WCS-CERT-NO.
   740                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   741                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   742
   743         16  CS-CONTROL-BY-NAME.
   744             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   745             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   746             20  CS-INSURED-INITIALS.
   747                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   748                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   749
   750         16  CS-CONTROL-BY-SSN.
   751             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   752             20  CS-SOC-SEC-NO.
   753                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   754                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   755                 24  CS-SSN-LN3.
   756                     28 CS-INSURED-INITIALS-A2   PIC XX
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  15
* EL050.cbl
   757                                     VALUE SPACES.
   758                     28 CS-PART-LAST-NAME-A2     PIC X
   759                                     VALUE SPACE.
   760
   761         16  CS-CONTROL-BY-CERT-NO.
   762             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   763             20  CS-CERT-NO-A4           PIC X(11)
   764                                     VALUE SPACES.
   765
   766         16  CS-CONTROL-BY-MEMB.
   767             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   768             20  CS-MEMBER-NO.
   769                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   770                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   771                 24  CS-MEMB-LN4.
   772                     28 CS-INSURED-INITIALS-A5   PIC XX
   773                                      VALUE SPACES.
   774                     28 CS-PART-LAST-NAME-A5     PIC XX
   775                                      VALUE SPACES.
   776
   777         16  FILLER              PIC X(360) VALUE SPACES.
   778
   779     12  ERACCT-KEY.
   780         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   782         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   783         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   784         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   785         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   786
   787     12  ERCOMP-KEY.
   788         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   789         16  COMP-CARRIER         PIC X     VALUE SPACES.
   790         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   791         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   792         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   793         16  COMP-TYPE            PIC X     VALUE SPACES.
   794
   795     12  ERLOFC-KEY.
   796         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   797         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   798         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   799         16  LOFC-STATE           PIC XX    VALUE SPACES.
   800         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   801         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   802
   803     12  WS-ELCRTT-KEY.
   804         16  WS-ELCRTT-PRIMARY       PIC X(33).
   805         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   806
   807     12  ERBXRF-KEY.
   808         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   809         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   810         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   811         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   812
   813     12  ERAGTC-KEY.
   814         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  16
* EL050.cbl
   815         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   816         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   817         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   818         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   819         16  AGTC-TYPE            PIC X     VALUE SPACES.
   820
   821     12  ERPLAN-KEY.
   822         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   823         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   824         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   825         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   826         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   827         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   828         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   829         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   830
   831     12  ERFORM-KEY.
   832         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   833         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   834         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   835         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   836
   837     12  ERREIN-KEY.
   838         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   839         16  REIN-TYPE            PIC X     VALUE SPACES.
   840         16  REIN-TABLE-CO.
   841             20  REIN-CODE-1      PIC X     VALUE SPACE.
   842             20  REIN-CODE-2      PIC X     VALUE SPACE.
   843             20  REIN-CODE-3      PIC X     VALUE SPACE.
   844         16  FILLER               PIC X(3)  VALUE SPACES.
   845
   846     12  ERCTBL-KEY.
   847         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   848         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   849         16  CTBL-CNTRL-2.
   850             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   851             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   852
   853     12  ELCRTO-KEY.
   854         16  ELCRTO-COMPANY-CD       PIC X.
   855         16  ELCRTO-CARRIER          PIC X.
   856         16  ELCRTO-GROUPING         PIC X(6).
   857         16  ELCRTO-STATE            PIC XX.
   858         16  ELCRTO-ACCOUNT          PIC X(10).
   859         16  ELCRTO-CERT-EFF-DT      PIC XX.
   860         16  ELCRTO-CERT-NO.
   861             20  ELCRTO-CERT-PRIME   PIC X(10).
   862             20  ELCRTO-CERT-SFX     PIC X.
   863         16  ELCRTO-RECORD-TYPE      PIC X.
   864         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   865
   866
   867     12  WS-ACCESS.
   868         16  FILLER               PIC XX    VALUE SPACES.
   869         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   870
   871     12  WS-CARR-ACCESS.
   872         16  FILLER               PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  17
* EL050.cbl
   873         16  WS-CARR              PIC X     VALUE SPACE.
   874*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   875*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   876     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   877         88  WS-DMD-LF-RATING   VALUE 'Y'.
   878         88  WS-DMD-AH-RATING   VALUE 'Y'.
   879         88  WS-DMD-NO-RATING   VALUE 'N'.
   880
   881     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   882         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   883                                         'NJ' 'NL'
   884                                         'PJ' 'PL'
   885                                         'SJ' 'SL'.
   886     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   887         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   888                                         'NI' 'NJ' 'NL' 'NU'
   889                                         'PJ' 'PL' 'PI' 'PU'
   890                                         'SI' 'SJ' 'SL' 'SU'
   891                                         'MX' 'MY' 'MZ'.
   892 01  ERPDEF-KEY-SAVE             PIC X(18).
   893 01  ERPDEF-KEY.
   894     12  ERPDEF-COMPANY-CD       PIC X.
   895     12  ERPDEF-STATE            PIC XX.
   896     12  ERPDEF-PROD-CD          PIC XXX.
   897     12  F                       PIC X(7).
   898     12  ERPDEF-BEN-TYPE         PIC X.
   899     12  ERPDEF-BEN-CODE         PIC XX.
   900     12  ERPDEF-EXP-DT           PIC XX.
   901
   902 01  ELSTAT-KEY-SAVE             PIC X(20).
   903 01  ELSTAT-KEY.
   904     12  ELSTAT-COMPANY-ID       PIC XXX.
   905     12  ELSTAT-CARRIER          PIC X.
   906     12  ELSTAT-GROUP            PIC X(6).
   907     12  ELSTAT-STATE            PIC XX.
   908     12  ELSTAT-EXP-DT           PIC 9(8).
   909 01  WS-ERROR-VALUES.
   910     12  ER-1570                     PIC S9(4)   VALUE +1570.
   911     12  ER-1571                     PIC S9(4)   VALUE +1571.
   912     12  er-1572                     pic s9(4)   value +1572.
   913     12  er-1573                     pic s9(4)   value +1573.
   914     12  er-1574                     pic s9(4)   value +1574.
   915     12  ER-1575                     PIC S9(4)   VALUE +1575.
   916     12  er-1576                     pic s9(4)   value +1576.
   917     12  er-1583                     pic s9(4)   value +1583.
   918     12  er-1743                     pic s9(4)   value +1743.
   919     12  er-1744                     pic s9(4)   value +1744.
   920     12  er-1745                     pic s9(4)   value +1745.
   921     12  er-1746                     pic s9(4)   value +1746.
   922     12  er-1747                     pic s9(4)   value +1747.
   923     12  er-1748                     pic s9(4)   value +1748.
   924     12  ER-1891                     PIC S9(4)   VALUE +1891.
   925     12  ER-1892                     PIC S9(4)   VALUE +1892.
   926     12  ER-1893                     PIC S9(4)   VALUE +1893.
   927     12  ER-1894                     PIC S9(4)   VALUE +1894.
   928     12  ER-1895                     PIC S9(4)   VALUE +1895.
   929     12  ER-1896                     PIC S9(4)   VALUE +1896.
   930     12  ER-1897                     PIC S9(4)   VALUE +1897.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  18
* EL050.cbl
   931     12  ER-1898                     PIC S9(4)   VALUE +1898.
   932     12  ER-1899                     PIC S9(4)   VALUE +1899.
   933     12  ER-1900                     PIC S9(4)   VALUE +1900.
   934     12  ER-1901                     PIC S9(4)   VALUE +1901.
   935     12  ER-1902                     PIC S9(4)   VALUE +1902.
   936     12  ER-1903                     PIC S9(4)   VALUE +1903.
   937     12  ER-1904                     PIC S9(4)   VALUE +1904.
   938     12  ER-1905                     PIC S9(4)   VALUE +1905.
   939     12  ER-1906                     PIC S9(4)   VALUE +1906.
   940     12  ER-1907                     PIC S9(4)   VALUE +1907.
   941     12  ER-1909                     PIC S9(4)   VALUE +1909.
   942     12  ER-1910                     PIC S9(4)   VALUE +1910.
   943     12  ER-1911                     PIC S9(4)   VALUE +1911.
   944     12  ER-1912                     PIC S9(4)   VALUE +1912.
   945     12  ER-1913                     PIC S9(4)   VALUE +1913.
   946     12  ER-1914                     PIC S9(4)   VALUE +1914.
   947     12  ER-1915                     PIC S9(4)   VALUE +1915.
   948     12  ER-1916                     PIC S9(4)   VALUE +1916.
   949     12  ER-1917                     PIC S9(4)   VALUE +1917.
   950     12  ER-1918                     PIC S9(4)   VALUE +1918.
   951     12  ER-1919                     PIC S9(4)   VALUE +1919.
   952     12  ER-1920                     PIC S9(4)   VALUE +1920.
   953     12  ER-1921                     PIC S9(4)   VALUE +1921.
   954     12  ER-1922                     PIC S9(4)   VALUE +1922.
   955     12  ER-1923                     PIC S9(4)   VALUE +1923.
   956     12  ER-1924                     PIC S9(4)   VALUE +1924.
   957     12  ER-1925                     PIC S9(4)   VALUE +1925.
   958     12  ER-1926                     PIC S9(4)   VALUE +1926.
   959     12  ER-1927                     PIC S9(4)   VALUE +1927.
   960     12  ER-2393                     PIC S9(4)   VALUE +2393.
   961     12  ER-2600                     PIC S9(4)   VALUE +2600.
   962     12  ER-2601                     PIC S9(4)   VALUE +2601.
   963     12  ER-2602                     PIC S9(4)   VALUE +2602.
   964     12  ER-2603                     PIC S9(4)   VALUE +2603.
   965     12  ER-2604                     PIC S9(4)   VALUE +2604.
   966     12  ER-2605                     PIC S9(4)   VALUE +2605.
   967     12  ER-2606                     PIC S9(4)   VALUE +2606.
   968     12  ER-2607                     PIC S9(4)   VALUE +2607.
   969     12  ER-2608                     PIC S9(4)   VALUE +2608.
   970     12  ER-2609                     PIC S9(4)   VALUE +2609.
   971     12  ER-2610                     PIC S9(4)   VALUE +2610.
   972     12  ER-2611                     PIC S9(4)   VALUE +2611.
   973     12  ER-2612                     PIC S9(4)   VALUE +2612.
   974     12  ER-2613                     PIC S9(4)   VALUE +2613.
   975     12  ER-2614                     PIC S9(4)   VALUE +2614.
   976     12  ER-2615                     PIC S9(4)   VALUE +2615.
   977     12  ER-2616                     PIC S9(4)   VALUE +2616.
   978     12  ER-2617                     PIC S9(4)   VALUE +2617.
   979     12  ER-2618                     PIC S9(4)   VALUE +2618.
   980     12  ER-2619                     PIC S9(4)   VALUE +2619.
   981     12  ER-2620                     PIC S9(4)   VALUE +2620.
   982     12  ER-2621                     PIC S9(4)   VALUE +2621.
   983     12  ER-2622                     PIC S9(4)   VALUE +2622.
   984     12  ER-2623                     PIC S9(4)   VALUE +2623.
   985     12  ER-2624                     PIC S9(4)   VALUE +2624.
   986     12  ER-2625                     PIC S9(4)   VALUE +2625.
   987     12  ER-2626                     PIC S9(4)   VALUE +2626.
   988     12  ER-2627                     PIC S9(4)   VALUE +2627.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  19
* EL050.cbl
   989     12  ER-2628                     PIC S9(4)   VALUE +2628.
   990     12  ER-2629                     PIC S9(4)   VALUE +2629.
   991     12  ER-2630                     PIC S9(4)   VALUE +2630.
   992     12  ER-2631                     PIC S9(4)   VALUE +2631.
   993     12  ER-2632                     PIC S9(4)   VALUE +2632.
   994     12  ER-2633                     PIC S9(4)   VALUE +2633.
   995     12  ER-2634                     PIC S9(4)   VALUE +2634.
   996     12  ER-2635                     PIC S9(4)   VALUE +2635.
   997     12  ER-2636                     PIC S9(4)   VALUE +2636.
   998     12  ER-2637                     PIC S9(4)   VALUE +2637.
   999     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1000     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1001     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1002     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1003     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1004     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1005     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1006     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1007     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1008     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1009     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1010     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1011     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1012     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1013     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1014     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1015     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1016     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1017     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1018     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1019     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1020     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1021     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1022     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1023     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1024     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1025     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1026     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1027     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1028     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1029     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1030     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1031     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1032     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1033     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1034     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1035     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1036     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1037     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1038     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1039     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1040     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1041     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1042     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1043     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1044     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1045     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1046     12  ER-2685                     PIC S9(4)   VALUE +2685.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  20
* EL050.cbl
  1047     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1048     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1049     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1050     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1051     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1052     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1053     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1054     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1055     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1056     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1057     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1058     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1059     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1060     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1061     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1062     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1063     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1064     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1065     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1066     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1067     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1068     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1069     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1070     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1071     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1072     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1073     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1074     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1075     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1076     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1077     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1078     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1079     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1080     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1081     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1082     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1083     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1084     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1085     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1086     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1087     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1088     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1089     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1090     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1091     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1092     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1093     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1094     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1095     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1096     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1097     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1098     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1099     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1100     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1101     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1102     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1103     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1104     12  ER-2753                     PIC S9(4)   VALUE +2753.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  21
* EL050.cbl
  1105     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1106     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1107     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1108     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1109     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1110     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1111     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1112     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1113     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1114     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1115     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1116     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1117     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1118     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1119     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1120     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1121     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1122     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1123     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1124     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1125     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1126     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1127     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1128     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1129     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1130     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1131     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1132     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1133     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1134     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1135     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1136     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1137     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1138     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1139     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1140     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1141     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1142     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1143     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1144     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1145     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1146     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1147     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1148     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1149     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1150     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1151     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1152     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1153     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1154     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1155     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1156     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1157     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1158     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1159     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1160     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1161     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1162     12  ER-2898                     PIC S9(4)   VALUE +2898.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  22
* EL050.cbl
  1163     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1164     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1165     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1166     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1167     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1168     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1169     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1170     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1171     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1172     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1173     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1174     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1175     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1176     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1177     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1178     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1179     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1180     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1181     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1182     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1183     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1184     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1185     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1186     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1187     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1188     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1189     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1190     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1191     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1192     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1193     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1194     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1195     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1196     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1197     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1198     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1199     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1200     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1201     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1202     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1203     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1204     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1205     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1206     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1207     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1208     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1209     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1210     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1211     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1212     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1213     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1214     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1215     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1216     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1217     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1218     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1219     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1220     12  ER-8080                     PIC S9(4)   VALUE +8080.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  23
* EL050.cbl
  1221     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1222     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1223     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1224     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1225     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1226     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1227     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1228     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1229     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1230     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1231     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1232     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1233     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1234     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1235     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1236     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1237     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1238     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1239     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1240     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1241     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1242     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1243     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1244     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1245     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1246     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1247     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1248     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1249     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1250     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1251     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1252     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1253     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1254     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1255     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1256     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1257     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1258     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1259     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1260     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1261     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1262     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1263     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1264     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1265     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1266     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1267     12  er-9823                     pic s9(4)   value +9823.
  1268     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1269******************************************************************
  1270***************   END OF ELC50WS     ****************************
  1271******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  24
* EL050.cbl
  1274 01  WORKING-STORAGE-WORK-AREAS.
  1275     12  WS-RESPONSE             PIC S9(8)  COMP.
  1276         88  WS-RESP-NORMAL           VALUE +00.
  1277         88  WS-RESP-ERROR            VALUE +01.
  1278         88  WS-RESP-NOTFND           VALUE +13.
  1279         88  WS-RESP-DUPREC           VALUE +14.
  1280         88  WS-RESP-ENDFILE          VALUE +20.
  1281     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1282     12  WORK-AREAS.
  1283         16  WK-CONV-GREG.
  1284             24  WCG-CENT             PIC XX.
  1285             24  WCG-REST             PIC X(4).
  1286         16  WORK-GREGORIAN-DATE.
  1287             24  WK-GREG-CENT         PIC XX.
  1288             24  WK-GREG-DATE-YYMMDD.
  1289                 28  WK-GREG-YYMM     PIC X(4).
  1290                 28  WK-GREG-DD       PIC XX.
  1291
  1292         16  WORK-SELECT-DATE.
  1293             24  WK-SELECT-CENT            PIC XX.
  1294             24  WK-SELECT-DATE-YYMMDD.
  1295                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1296                 28  FILLER                PIC XX.
  1297
  1298         16  WK-FORM-NO.
  1299             24  WK-FORM-BANK-ID       PIC X(5).
  1300             24  WK-FORM-UNDRWRTR      PIC X(1).
  1301             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1302
  1303         16  WK-MEMBER-NO.
  1304             24  WK-MEMBER-1-6        PIC X(6).
  1305             24  WK-MEMBER-7-12       PIC X(6).
  1306
  1307         16  WK-FULL-CERT-NO.
  1308             24  WK-CERT-POS-1-2      PIC X(2).
  1309             24  WK-CERT-POS-3        PIC X(1).
  1310             24  WK-CERT-POS-4        PIC X(1).
  1311             24  WK-CERT-POS-5-6      PIC X(2).
  1312             24  WK-CERT-POS-7        PIC X(1).
  1313             24  WK-CERT-POS-8-11     PIC X(4).
  1314
  1315         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1316             88  VALID-RATE-CODE        VALUE 'Y'.
  1317             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1318
  1319         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1320         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1321         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1322         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1323         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1324         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1325         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1326         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1327         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1328         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1329
  1330* DLO001
  1331 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  25
* EL050.cbl
  1332     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1333     12  DMPF-RETURN-CODE          PIC XX.
  1334         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1335         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1336         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1337         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1338         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1339         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1340
  1341* DLO002
  1342 01  WS-DLO-INTERNAL-POLICY-FORM.
  1343     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1344     12  DIPF-RETURN-CODE          PIC XX.
  1345         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1346         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1347         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1348         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1349         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1350         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1351
  1352* DLO003
  1353 01  WS-DLO-VALID-BANK-ID.
  1354     12  DVBI-BANK-ID              PIC X(5).
  1355     12  DVBI-BANK-ID-TYPE         PIC X.
  1356         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1357         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1358         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1359         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1360         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1361     12  DVBI-RETURN-CODE          PIC XX.
  1362         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1363         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1364         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1365         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1366         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1367         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1368         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1369         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1370         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1371
  1372* DLO007
  1373 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1374     12  DCUA-RES-STATE            PIC XX.
  1375     12  DCUA-BEN-TYPE             PIC XX.
  1376     12  DCUA-SYS-IDENT            PIC X.
  1377         88  DCUA-CLAIM                        VALUE 'C'.
  1378         88  DCUA-PREMIUM                      VALUE 'P'.
  1379     12  DCUA-COVERAGE-RULE        PIC X.
  1380     12  DCUA-CLIENT-ID            PIC X(10).
  1381     12  DCUA-EFF-DATE             PIC X(8).
  1382     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1383     12  DCUA-RETURN-CODE          PIC XX.
  1384         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1385     12  DCUA-CERT-NUMBER          PIC X(11).
  1386     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1387     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1388
  1389* DLO011
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  26
* EL050.cbl
  1390 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1391     12  DPRB-RATE-CODE            PIC X(4).
  1392     12  DPRB-COVERAGE-CATEG       PIC X.
  1393     12  DPRB-RETURN-CODE          PIC XX.
  1394         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1395         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1396         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1397         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1398         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1399         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1400         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1401         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1402         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1403     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1404     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1405     12  DPRB-BEN-TYPE             PIC XX.
  1406
  1407* DLO017
  1408 01  WS-DLO-VALID-RATE-CODE.
  1409     12  DVRC-RATE-CODE            PIC X(4).
  1410     12  DVRC-RETURN-CODE          PIC XX.
  1411         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1413         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1414         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1415         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1416         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1417
  1418* DLO019
  1419 01  WS-DLO-ORIG-COV-CAT.
  1420     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1421     12  DOCC-RETURN-CODE          PIC XX.
  1422     12  DOCC-ORIG-COV-CAT         PIC X.
  1423     12  DOCC-UNDERWITER           PIC XX.
  1424     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1425     12  DOCC-FILLER               PIC X(6).
  1426
  1427* DLO021
  1428 01  WS-DLO-VALID-LOAN-OFFICER.
  1429     12  DVLO-LOAN-OFFICER.
  1430         16  DVLO-BILL-TYPE        PIC X.
  1431         16  DVLO-BILL-SOURCE      PIC X.
  1432         16  DVLO-BATCH-TYPE       PIC X.
  1433     12  DVLO-RETURN-CODE          PIC XX.
  1434         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1435         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1436         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1437         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1438         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1439         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1440
  1441* DLO022
  1442 01  WS-DLO-VALID-STATE-CODE.
  1443     12  DVSC-STATE-CODE           PIC XX.
  1444     12  DVSC-RETURN-CODE          PIC XX.
  1445         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1446
  1447* DLO023
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  27
* EL050.cbl
  1448 01  WS-DLO-VALID-CODE-VALUES.
  1449     12  DVCV-SYSTEM-ID            PIC XX.
  1450         88  DVCV-CLAIMS                       VALUE 'CL'.
  1451         88  DVCV-CREDIT                       VALUE 'CR'.
  1452     12  DVCV-RECORD-TYPE          PIC XX.
  1453         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1454         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1455         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1456         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1457         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1458         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1459         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1460         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1461     12  DVCV-RECORD-KEY           PIC X(6).
  1462     12  DVCV-RETURN-CODE          PIC XX.
  1463         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1464         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1465         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1466         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1467         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1468         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1469         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1470     12  DVCV-CODE-DESC            PIC X(60).
  1471     12  DVCV-GEN-DESC-1           PIC X(20).
  1472     12  DVCV-GEN-DESC-2           PIC X(20).
  1473     12  DVCV-GEN-DESC-3           PIC X(20).
  1474
  1475 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1476 01  hldi-pass-area.
  1477     03  PA-VIN                  PIC X(17).
  1478     03  PA-ErrorCode            PIC X(10).
  1479     03  PA-ErrorDesc            PIC X(30).
  1480     03  PA-ModelYear            PIC 9(7).
  1481     03  PA-MakeName             PIC X(50).
  1482     03  PA-ModelName            PIC X(50).
  1483     03  PA-SeriesName           PIC X(50).
  1484****  this is for aggregate report.
  1485****  Length is erpndb + 100 of passed-key-area
  1486 01  ws-passed-key-length        pic s9(4) comp value +587.
  1487 01  ws-pass-to-pemaggo.
  1488     05  ws-passed-erpndb        pic x(585).
  1489     05  ws-exceed-limit-yn      pic x.
  1490     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  28
* EL050.cbl
  1492*    COPY ERCBXRF.
  1493******************************************************************
  1494*                                                                *
  1495*                                                                *
  1496*                            ERCBXRF                             *
  1497*                                                                *
  1498*   ONLINE CREDIT SYSTEM                                         *
  1499*                                                                *
  1500*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1501*                                                                *
  1502*   FILE TYPE = VSAM,KSDS                                        *
  1503*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1504*                                                                *
  1505*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1506*       ALTERNATE PATH = NONE                                    *
  1507*                                                                *
  1508*   LOG = NO                                                     *
  1509*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1510*                                                                *
  1511******************************************************************
  1512
  1513 01  BANK-CROSS-REFERENCE.
  1514     12  BK-RECORD-ID                PIC XX.
  1515         88  VALID-BK-ID             VALUE 'BK'.
  1516
  1517     12  BK-CONTROL-PRIMARY.
  1518         16  BK-COMPANY-CD           PIC X.
  1519         16  BK-CARRIER              PIC X.
  1520         16  BK-GROUPING             PIC X(6).
  1521         16  BK-BANK-NO              PIC X(10).
  1522
  1523     12  BK-MAINT-INFORMATION.
  1524         16  BK-LAST-MAINT-DT        PIC XX.
  1525         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1526         16  BK-LAST-MAINT-USER      PIC X(4).
  1527         16  FILLER                  PIC X(9).
  1528
  1529     12  FILLER                      PIC X(37).
  1530
  1531     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1532
  1533     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1534                            DEPENDING ON BK-BANK-POINTER-CNT.
  1535         16  BK-AM-ACCOUNT           PIC X(10).
  1536         16  BK-AM-EXP-DT            PIC XX.
  1537         16  BK-AM-EFF-DT            PIC XX.
  1538         16  BK-AM-STATE             PIC XX.
  1539         16  FILLER                  PIC X(20).
  1540
  1541******************************************************************
  1542
  1543*    COPY ERCCOMP.
  1544******************************************************************
  1545*                                                                *
  1546*                                                                *
  1547*                            ERCCOMP                             *
  1548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1549*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  29
* EL050.cbl
  1550*                                                                *
  1551*   ONLINE CREDIT SYSTEM                                         *
  1552*                                                                *
  1553*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1554*                                                                *
  1555*   FILE TYPE = VSAM,KSDS                                        *
  1556*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1557*                                                                *
  1558*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1559*       ALTERNATE PATH = NONE                                    *
  1560*                                                                *
  1561*   LOG = NO                                                     *
  1562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1563*                                                                *
  1564******************************************************************
  1565*                   C H A N G E   L O G
  1566*
  1567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1568*-----------------------------------------------------------------
  1569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1570* EFFECTIVE    NUMBER
  1571*-----------------------------------------------------------------
  1572* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1573* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1574* 092205    2005050300006  PEMA  ADD LEASE FEE
  1575* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1576* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1577* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1578* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1579* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1580* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1581******************************************************************
  1582
  1583 01  COMPENSATION-MASTER.
  1584     12  CO-RECORD-ID                          PIC XX.
  1585         88  VALID-CO-ID                          VALUE 'CO'.
  1586
  1587     12  CO-CONTROL-PRIMARY.
  1588         16  CO-COMPANY-CD                     PIC X.
  1589         16  CO-CONTROL.
  1590             20  CO-CTL-1.
  1591                 24  CO-CARR-GROUP.
  1592                     28  CO-CARRIER            PIC X.
  1593                     28  CO-GROUPING.
  1594                         32  CO-GROUP-PREFIX   PIC XXX.
  1595                         32  CO-GROUP-PRIME    PIC XXX.
  1596                 24  CO-RESP-NO.
  1597                     28  CO-RESP-PREFIX        PIC X(4).
  1598                     28  CO-RESP-PRIME         PIC X(6).
  1599             20  CO-CTL-2.
  1600                 24  CO-ACCOUNT.
  1601                     28  CO-ACCT-PREFIX        PIC X(4).
  1602                     28  CO-ACCT-PRIME         PIC X(6).
  1603         16  CO-TYPE                           PIC X.
  1604             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1605             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1606             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1607
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  30
* EL050.cbl
  1608     12  CO-MAINT-INFORMATION.
  1609         16  CO-LAST-MAINT-DT                  PIC XX.
  1610         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1611         16  CO-LAST-MAINT-USER                PIC X(4).
  1612     12  FILLER                                PIC XX.
  1613     12  CO-STMT-TYPE                          PIC XXX.
  1614     12  CO-COMP-TYPE                          PIC X.
  1615         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1616     12  CO-STMT-OWNER                         PIC X(4).
  1617     12  CO-BALANCE-CONTROL                    PIC X.
  1618         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1619         88  CO-NO-BALANCE                        VALUE 'N'.
  1620
  1621     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1622         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1623         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1624         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1625
  1626     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1627         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1628         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1629
  1630     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1631     12  CO-GA-DIRECT-DEP                      PIC X.
  1632     12  CO-FUTURE-SPACE                       PIC X.
  1633         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1634
  1635     12  CO-ACCT-NAME                          PIC X(30).
  1636     12  CO-MAIL-NAME                          PIC X(30).
  1637     12  CO-ADDR-1                             PIC X(30).
  1638     12  CO-ADDR-2                             PIC X(30).
  1639     12  CO-ADDR-3.
  1640         16  CO-ADDR-CITY                      PIC X(27).
  1641         16  CO-ADDR-STATE                     PIC XX.
  1642     12  CO-CSO-1099                           PIC X.
  1643     12  CO-ZIP.
  1644         16  CO-ZIP-PRIME.
  1645             20  CO-ZIP-PRI-1ST                PIC X.
  1646                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1647             20  FILLER                        PIC X(4).
  1648         16  CO-ZIP-PLUS4                      PIC X(4).
  1649     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1650         16  CO-CAN-POSTAL-1                   PIC XXX.
  1651         16  CO-CAN-POSTAL-2                   PIC XXX.
  1652         16  FILLER                            PIC XXX.
  1653     12  CO-SOC-SEC                            PIC X(13).
  1654     12  CO-TELEPHONE.
  1655         16  CO-AREA-CODE                      PIC XXX.
  1656         16  CO-PREFIX                         PIC XXX.
  1657         16  CO-PHONE                          PIC X(4).
  1658
  1659     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1660
  1661     12  CO-AR-BAL-LEVEL                       PIC X.
  1662         88  CO-AR-REF-LVL                        VALUE '1'.
  1663         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1664         88  CO-AR-BILL-LVL                       VALUE '2'.
  1665         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  31
* EL050.cbl
  1666         88  CO-AR-FR-LVL                         VALUE '4'.
  1667
  1668     12  CO-AR-NORMAL-PRINT                    PIC X.
  1669         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1670         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1671
  1672     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1673
  1674     12  CO-AR-REPORTING                       PIC X.
  1675         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1676         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1677
  1678     12  CO-AR-PULL-CHECK                      PIC X.
  1679         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1680         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1681
  1682     12  CO-AR-BALANCE-PRINT                   PIC X.
  1683         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1684
  1685     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1686         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1687         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1688         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1689
  1690     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1691
  1692     12  CO-USER-CODE                          PIC X.
  1693     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1694
  1695******************************************************************
  1696*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1697*    THE LAST MONTH END RUN.
  1698******************************************************************
  1699
  1700     12  CO-LAST-ACTIVITY-DATE.
  1701         16  CO-ACT-YEAR                       PIC 99.
  1702         16  CO-ACT-MONTH                      PIC 99.
  1703         16  CO-ACT-DAY                        PIC 99.
  1704
  1705     12  CO-LAST-STMT-DT.
  1706         16  CO-LAST-STMT-YEAR                 PIC 99.
  1707         16  CO-LAST-STMT-MONTH                PIC 99.
  1708         16  CO-LAST-STMT-DAY                  PIC 99.
  1709
  1710     12  CO-MO-END-TOTALS.
  1711         16  CO-MONTHLY-TOTALS.
  1712             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1713             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1714             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1715             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1716             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1717
  1718         16  CO-AGING-TOTALS.
  1719             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1720             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1721             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1722             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1723
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  32
* EL050.cbl
  1724         16  CO-YTD-TOTALS.
  1725             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1726             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1727
  1728         16  CO-OVER-UNDER-TOTALS.
  1729             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1730             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1731
  1732     12  CO-MISCELLANEOUS-TOTALS.
  1733         16  CO-FICA-TOTALS.
  1734             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1735             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1736
  1737         16  CO-CLAIM-TOTALS.
  1738             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1739             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1740
  1741******************************************************************
  1742*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1743*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1744******************************************************************
  1745
  1746     12  CO-CURRENT-TOTALS.
  1747         16  CO-CURRENT-LAST-STMT-DT.
  1748             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1749             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1750             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1751
  1752         16  CO-CURRENT-MONTHLY-TOTALS.
  1753             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1754             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1755             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1756             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1757             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1758
  1759         16  CO-CURRENT-AGING-TOTALS.
  1760             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1761             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1762             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1763             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1764
  1765         16  CO-CURRENT-YTD-TOTALS.
  1766             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1767             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1768
  1769     12  CO-PAID-COMM-TOTALS.
  1770         16  CO-YTD-PAID-COMMS.
  1771             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1772             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1773
  1774     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1775         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1776         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1777
  1778     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1779         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1780         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1781         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  33
* EL050.cbl
  1782         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1783         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1784         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1785         88  CO-FINAL-LETTER                  VALUE 'F'.
  1786         88  CO-RECONCILING                   VALUE 'R'.
  1787         88  CO-PHONE-CALL                    VALUE 'P'.
  1788         88  CO-LEGAL                         VALUE 'L'.
  1789         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1790         88  CO-WRITE-OFF                     VALUE 'W'.
  1791         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1792
  1793     12  CO-CSR-CODE                       PIC X(4).
  1794
  1795     12  CO-GA-STATUS-INFO.
  1796         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1797         16  CO-GA-TERMINATION-DT          PIC XX.
  1798         16  CO-GA-STATUS-CODE             PIC X.
  1799             88  CO-GA-ACTIVE                 VALUE 'A'.
  1800             88  CO-GA-INACTIVE               VALUE 'I'.
  1801             88  CO-GA-PENDING                VALUE 'P'.
  1802         16  CO-GA-COMMENTS.
  1803             20  CO-GA-COMMENT-1           PIC X(40).
  1804             20  CO-GA-COMMENT-2           PIC X(40).
  1805             20  CO-GA-COMMENT-3           PIC X(40).
  1806             20  CO-GA-COMMENT-4           PIC X(40).
  1807
  1808     12  CO-RPTCD2                         PIC X(10).
  1809     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1810         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1811         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1812
  1813     12  CO-TYPE-AGENT                     PIC X(01).
  1814         88  CO-CORPORATION                   VALUE 'C'.
  1815         88  CO-PARTNERSHIP                   VALUE 'P'.
  1816         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1817         88  CO-TRUST                         VALUE 'T'.
  1818         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1819
  1820     12  CO-FAXNO.
  1821         16  CO-FAX-AREA-CODE                  PIC XXX.
  1822         16  CO-FAX-PREFIX                     PIC XXX.
  1823         16  CO-FAX-PHONE                      PIC X(4).
  1824
  1825     12  CO-BANK-INFORMATION.
  1826         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1827         16  CO-BANK-TRANSIT-NON REDEFINES
  1828             CO-BANK-TRANSIT-NO                PIC 9(8).
  1829
  1830         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1831     12  CO-MISC-DEDUCT-INFO REDEFINES
  1832                  CO-BANK-INFORMATION.
  1833         16  CO-MD-GL-ACCT                     PIC X(10).
  1834         16  CO-MD-DIV                         PIC XX.
  1835         16  CO-MD-CENTER                      PIC X(4).
  1836         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1837         16  CO-CREATE-AP-CHECK                PIC X.
  1838         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1839         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  34
* EL050.cbl
  1840     12  CO-ACH-STATUS                         PIC X.
  1841         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1842         88  CO-ACH-PENDING                        VALUE 'P'.
  1843
  1844     12  CO-BILL-SW                            PIC X.
  1845     12  CO-CONTROL-NAME                       PIC X(30).
  1846     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1847     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1848     12  CO-CLP-STATE                          PIC XX.
  1849     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1850     12  CO-SPP-REFUND-EDIT                    PIC X.
  1851
  1852******************************************************************
  1853
  1854*    COPY ERCAGTC.
  1855******************************************************************
  1856*                                                                *
  1857*                                                                *
  1858*                            ERCAGTC                             *
  1859*                            VMOD=2.001                          *
  1860*                                                                *
  1861*   ONLINE CREDIT SYSTEM                                         *
  1862*                                                                *
  1863*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1864*                                                                *
  1865*   FILE TYPE = VSAM,KSDS                                        *
  1866*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1867*                                                                *
  1868*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1869*       ALTERNATE PATH = NONE                                    *
  1870*                                                                *
  1871*   LOG = NO                                                     *
  1872*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1873*                                                                *
  1874******************************************************************
  1875*                   C H A N G E   L O G
  1876*
  1877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1878*-----------------------------------------------------------------
  1879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1880* EFFECTIVE    NUMBER
  1881*-----------------------------------------------------------------
  1882* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1883* 111004                         NEW FILE AND COPYBOOK
  1884* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1885******************************************************************
  1886 01  AGENT-COMMISSIONS.
  1887     12  AG-RECORD-ID                          PIC XX.
  1888         88  VALID-CO-ID                          VALUE 'AG'.
  1889     12  AG-CONTROL-PRIMARY.
  1890         16  AG-COMPANY-CD                     PIC X.
  1891         16  AG-CONTROL.
  1892             20  AG-CTL-1.
  1893                 24  AG-CARR-GROUP.
  1894                     28  AG-CARRIER            PIC X.
  1895                     28  AG-GROUPING           PIC X(6).
  1896                 24  AG-BANK                   PIC X(10).
  1897             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  35
* EL050.cbl
  1898                 24  AG-EXP-DT                 PIC XX.
  1899         16  AG-TYPE                           PIC X.
  1900             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1901             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1902     12  AG-MAINT-INFORMATION.
  1903         16  AG-LAST-MAINT-DT                  PIC XX.
  1904         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1905         16  AG-LAST-MAINT-USER                PIC X(4).
  1906         16  FILLER                            PIC X(10).
  1907     12  AG-EFF-DT                             PIC XX.
  1908     12  AG-COMM-STRUCTURE.
  1909         16  AG-AGT-COMMS OCCURS 10.
  1910             20  AG-AGT                PIC X(10).
  1911             20  AG-COM-TYP            PIC X.
  1912             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1913             20  AG-RECALC-LV-INDIC    PIC X.
  1914             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1915             20  AG-LRCALC-LV-INDIC    PIC X.
  1916             20  FILLER                PIC X(05).
  1917     12  FILLER                  PIC X(145).
  1918******************************************************************
  1919*    COPY ERCRESS.
  1920******************************************************************
  1921*                                                                *
  1922*                            ERCRESS                             *
  1923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1924*                            VMOD=2.002                          *
  1925*                                                                *
  1926*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1927*                                                                *
  1928*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1929*   VSAM RESIDENT STATE TAX MASTER                              *
  1930*                                                                *
  1931*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1932*                                                                *
  1933*   FILE TYPE = VSAM,KSDS                                        *
  1934*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1935*                                                                *
  1936*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1937*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1938*                                                                *
  1939*   LOG = NO                                                     *
  1940*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1941*                                                                *
  1942*                                                                *
  1943******************************************************************
  1944
  1945 01  RESIDENT-STATE-TAX-MASTER.
  1946
  1947     10  ERRESS-PRIMARY-KEY.
  1948         15  RES-COMPANY-CD        PIC X.
  1949         15  RES-RESIDENT-STATE    PIC XX.
  1950         15  RES-COVERAGE-CATEGORY PIC X.
  1951         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1952*                                      YYYYMMDD
  1953*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1954
  1955     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  36
* EL050.cbl
  1956
  1957         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1958         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1959         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1960         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1961
  1962     10 RES-RECALC-SW              PIC   X.
  1963         88 RECALC                VALUE 'Y'.
  1964         88 NO-RECALC             VALUE 'N'.
  1965     10  RES-MAINT-BY              PIC X(4).
  1966     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1967     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1968*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  37
* EL050.cbl
  1970*    COPY ERCRESC.
  1971******************************************************************
  1972*                                                                *
  1973*                            ERCRESC                             *
  1974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1975*                            VMOD=2.003                          *
  1976*                                                                *
  1977*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1978*                                                                *
  1979*   FILE TYPE = VSAM,KSDS                                        *
  1980*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1981*                                                                *
  1982*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1983*       ALTERNATE PATH1 = NONE                                   *
  1984*                                                                *
  1985*   LOG = NO                                                     *
  1986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1987*                                                                *
  1988******************************************************************
  1989
  1990 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1991
  1992     10  ERRESC-RECORD-KEY.
  1993         15  RESC-COMPANY-CD           PIC   X.
  1994         15  RESC-CARRIER              PIC   X.
  1995         15  RESC-GROUP                PIC   X(6).
  1996         15  RESC-STATE                PIC   XX.
  1997         15  RESC-ACCOUNT              PIC   X(10).
  1998         15  RESC-AGENT                PIC   X(10).
  1999         15  RESC-RESIDENT-STATE       PIC   XX.
  2000         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2001*                                           YYYYMMDD
  2002     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2003
  2004     10  RESC-COMM-RECORD-DATA.
  2005         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2006             20 RESC-COVERAGE-CAT      PIC    X.
  2007             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2008             20 RESC-COMMISSION-TAB REDEFINES
  2009                RESC-COMMISSION-PER    PIC  XXX.
  2010
  2011     10  RESC-MAINT-BY                 PIC X(4).
  2012     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2013     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2014*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  38
* EL050.cbl
  2016*    COPY ERCPLAN.
  2017******************************************************************
  2018*                                                                *
  2019*                                                                *
  2020*                            ERCPLAN                             *
  2021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2022*                            VMOD=2.003                          *
  2023*                                                                *
  2024*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2025*                                                                *
  2026*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2027*   PLAN MASTER                                                  *
  2028*                                                                *
  2029*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2030*                                                                *
  2031*   FILE TYPE = VSAM,KSDS                                        *
  2032*   RECORD SIZE = 420   RECFORM = FIX                            *
  2033*                                                                *
  2034*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2035*       ALTERNATE PATH1 = N/A                                    *
  2036*                                                                *
  2037*   LOG = NO                                                     *
  2038*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2039*                                                                *
  2040*                                                                *
  2041******************************************************************
  2042
  2043 01  PLAN-MASTER.
  2044     12  PL-RECORD-ID                      PIC XX.
  2045         88  VALID-PL-ID                      VALUE 'PL'.
  2046
  2047     12  PL-CONTROL-PRIMARY.
  2048         16  PL-COMPANY-CD                 PIC X.
  2049         16  PL-MSTR-CNTRL.
  2050             20  PL-CONTROL-A.
  2051                 24  PL-CARRIER            PIC X.
  2052                 24  PL-GROUPING           PIC X(6).
  2053                 24  PL-STATE              PIC XX.
  2054                 24  PL-ACCOUNT            PIC X(10).
  2055             20  PL-BENEFIT-TYPE           PIC X.
  2056             20  PL-BENEFIT-CODE           PIC XX.
  2057             20  PL-REVISION-NO            PIC X(3).
  2058
  2059     12  PL-CONTROL-BY-VAR-GRP.
  2060         16  PL-COMPANY-CD-A1              PIC X.
  2061         16  PL-VG-CARRIER                 PIC X.
  2062         16  PL-VG-GROUPING                PIC X(6).
  2063         16  PL-VG-STATE                   PIC XX.
  2064         16  PL-VG-ACCOUNT                 PIC X(10).
  2065         16  PL-BENEFIT-TYPE-A1            PIC X.
  2066         16  PL-BENEFIT-CODE-A1            PIC XX.
  2067         16  PL-REVISION-NO-A1             PIC 999.
  2068
  2069     12  PL-MAINT-INFORMATION.
  2070         16  PL-LAST-MAINT-DT              PIC XX.
  2071         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2072         16  PL-LAST-MAINT-USER            PIC X(4).
  2073         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  39
* EL050.cbl
  2074
  2075     12  PL-LIABILITY-LIMITS.
  2076         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2077         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2078             20  PL-LM-AGE                 PIC S99        COMP-3.
  2079             20  PL-LM-DUR                 PIC S999       COMP-3.
  2080             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2081             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2082
  2083     12  FILLER                            PIC X(30).
  2084
  2085     12  PL-GL-ACCOUNT-NOS.
  2086         16  PL-PREMIUM-GL                 PIC X(8).
  2087         16  PL-COMM-GL                    PIC X(8).
  2088         16  PL-CLAIM-GL                   PIC X(8).
  2089     12  FILLER                            PIC X(24).
  2090     12  PL-TOLERANCES.
  2091         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2092         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2093         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2094         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2095         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2096         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2097     12  PL-OVER-SHORT.
  2098         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2099         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2100     12  FILLER                            PIC X(24).
  2101     12  PLAN-MISC.
  2102         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2103         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2104         16  PL-IG                         PIC X.
  2105         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2106         16  PL-POLICY-FORM                PIC X(12).
  2107         16  PL-EDIT-FOR-FORM              PIC X(01).
  2108         16  PL-DEV-CODE                   PIC XXX.
  2109         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2110         16  PL-CALC-METHOD                PIC X.
  2111         16  PL-BENEFIT-GROUP              PIC X(05).
  2112         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2113
  2114         16  FILLER                        PIC X(99).
  2115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  40
* EL050.cbl
  2117*    COPY ELCCERT.
  2118******************************************************************
  2119*                                                                *
  2120*                            ELCCERT.                            *
  2121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2122*                            VMOD=2.013                          *
  2123*                                                                *
  2124*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2125*                                                                *
  2126*   FILE TYPE = VSAM,KSDS                                        *
  2127*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2128*                                                                *
  2129*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2130*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2131*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2132*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2133*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2134*                                                                *
  2135*   LOG = YES                                                    *
  2136*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2137******************************************************************
  2138*                   C H A N G E   L O G
  2139*
  2140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2141*-----------------------------------------------------------------
  2142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2143* EFFECTIVE    NUMBER
  2144*-----------------------------------------------------------------
  2145* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2146* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2147* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2148* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2149* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2150* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2151* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2152* 032612  CR2011110200001  PEMA  AHL CHANGES
  2153* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2154* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2155******************************************************************
  2156
  2157 01  CERTIFICATE-MASTER.
  2158     12  CM-RECORD-ID                      PIC XX.
  2159         88  VALID-CM-ID                      VALUE 'CM'.
  2160
  2161     12  CM-CONTROL-PRIMARY.
  2162         16  CM-COMPANY-CD                 PIC X.
  2163         16  CM-CARRIER                    PIC X.
  2164         16  CM-GROUPING.
  2165             20  CM-GROUPING-PREFIX        PIC X(3).
  2166             20  CM-GROUPING-PRIME         PIC X(3).
  2167         16  CM-STATE                      PIC XX.
  2168         16  CM-ACCOUNT.
  2169             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2170             20  CM-ACCOUNT-PRIME          PIC X(6).
  2171         16  CM-CERT-EFF-DT                PIC XX.
  2172         16  CM-CERT-NO.
  2173             20  CM-CERT-PRIME             PIC X(10).
  2174             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  41
* EL050.cbl
  2175
  2176     12  CM-CONTROL-BY-NAME.
  2177         16  CM-COMPANY-CD-A1              PIC X.
  2178         16  CM-INSURED-LAST-NAME          PIC X(15).
  2179         16  CM-INSURED-INITIALS.
  2180             20  CM-INSURED-INITIAL1       PIC X.
  2181             20  CM-INSURED-INITIAL2       PIC X.
  2182
  2183     12  CM-CONTROL-BY-SSN.
  2184         16  CM-COMPANY-CD-A2              PIC X.
  2185         16  CM-SOC-SEC-NO.
  2186             20  CM-SSN-STATE              PIC XX.
  2187             20  CM-SSN-ACCOUNT            PIC X(6).
  2188             20  CM-SSN-LN3.
  2189                 25  CM-INSURED-INITIALS-A2.
  2190                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2191                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2192                 25 CM-PART-LAST-NAME-A2         PIC X.
  2193
  2194     12  CM-CONTROL-BY-CERT-NO.
  2195         16  CM-COMPANY-CD-A4              PIC X.
  2196         16  CM-CERT-NO-A4                 PIC X(11).
  2197
  2198     12  CM-CONTROL-BY-MEMB.
  2199         16  CM-COMPANY-CD-A5              PIC X.
  2200         16  CM-MEMBER-NO.
  2201             20  CM-MEMB-STATE             PIC XX.
  2202             20  CM-MEMB-ACCOUNT           PIC X(6).
  2203             20  CM-MEMB-LN4.
  2204                 25  CM-INSURED-INITIALS-A5.
  2205                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2206                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2207                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2208
  2209     12  CM-INSURED-PROFILE-DATA.
  2210         16  CM-INSURED-FIRST-NAME.
  2211             20  CM-INSURED-1ST-INIT       PIC X.
  2212             20  FILLER                    PIC X(9).
  2213         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2214         16  CM-INSURED-SEX                PIC X.
  2215             88  CM-SEX-MALE                  VALUE 'M'.
  2216             88  CM-SEX-FEMAL                 VALUE 'F'.
  2217         16  CM-INSURED-JOINT-AGE          PIC 99.
  2218         16  CM-JOINT-INSURED-NAME.
  2219             20  CM-JT-LAST-NAME           PIC X(15).
  2220             20  CM-JT-FIRST-NAME.
  2221                 24  CM-JT-1ST-INIT        PIC X.
  2222                 24  FILLER                PIC X(9).
  2223             20  CM-JT-INITIAL             PIC X.
  2224
  2225     12  CM-LIFE-DATA.
  2226         16  CM-LF-BENEFIT-CD              PIC XX.
  2227         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2228         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2229         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2230         16  CM-LF-DEV-CODE                PIC XXX.
  2231         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2232         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  42
* EL050.cbl
  2233         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2234         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2235         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2236         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2237         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2238         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2239         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2240         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2241         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2242         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2243         16  cm-temp-epiq                  pic xx.
  2244             88  EPIQ-CLASS                  value 'EQ'.
  2245*        16  FILLER                        PIC XX.
  2246
  2247     12  CM-AH-DATA.
  2248         16  CM-AH-BENEFIT-CD              PIC XX.
  2249         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2250         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2251         16  CM-AH-DEV-CODE                PIC XXX.
  2252         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2253         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2254         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2255         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2256         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2257         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2258         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2259         16  CM-AH-PAID-THRU-DT            PIC XX.
  2260             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2261         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2262         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2263         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2264         16  FILLER                        PIC X.
  2265
  2266     12  CM-LOAN-INFORMATION.
  2267         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2268         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2269                                           PIC S9(5)V99  COMP-3.
  2270         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2271         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2272         16  CM-PAY-FREQUENCY              PIC S99.
  2273         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2274         16  CM-RATE-CLASS                 PIC XX.
  2275         16  CM-BENEFICIARY                PIC X(25).
  2276         16  CM-POLICY-FORM-NO             PIC X(12).
  2277         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2278         16  CM-LAST-ADD-ON-DT             PIC XX.
  2279         16  CM-DEDUCTIBLE-AMOUNTS.
  2280             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2281             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2282         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2283             20  CM-RESIDENT-STATE         PIC XX.
  2284             20  CM-RATE-CODE              PIC X(4).
  2285             20  FILLER                    PIC XX.
  2286         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2287             20  CM-LOAN-OFFICER           PIC X(5).
  2288             20  FILLER                    PIC XXX.
  2289         16  CM-CSR-CODE                   PIC XXX.
  2290         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  43
* EL050.cbl
  2291             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2292         16  CM-POST-CARD-IND              PIC X.
  2293         16  CM-NH-INTERFACE-SW            PIC X.
  2294         16  CM-PREMIUM-TYPE               PIC X.
  2295             88  CM-SING-PRM                  VALUE '1'.
  2296             88  CM-O-B-COVERAGE              VALUE '2'.
  2297             88  CM-OPEN-END                  VALUE '3'.
  2298         16  CM-IND-GRP-TYPE               PIC X.
  2299             88  CM-INDIVIDUAL                VALUE 'I'.
  2300             88  CM-GROUP                     VALUE 'G'.
  2301         16  CM-SKIP-CODE                  PIC X.
  2302             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2303             88  SKIP-JULY                    VALUE '1'.
  2304             88  SKIP-AUGUST                  VALUE '2'.
  2305             88  SKIP-SEPTEMBER               VALUE '3'.
  2306             88  SKIP-JULY-AUG                VALUE '4'.
  2307             88  SKIP-AUG-SEPT                VALUE '5'.
  2308             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2309             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2310             88  SKIP-JUNE                    VALUE '8'.
  2311             88  SKIP-JUNE-JULY               VALUE '9'.
  2312             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2313             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2314         16  CM-PAYMENT-MODE               PIC X.
  2315             88  PAY-MONTHLY                  VALUE SPACE.
  2316             88  PAY-WEEKLY                   VALUE '1'.
  2317             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2318             88  PAY-BI-WEEKLY                VALUE '3'.
  2319             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2320         16  CM-LOAN-NUMBER                PIC X(8).
  2321         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2322         16  CM-OLD-LOF                    PIC XXX.
  2323*        16  CM-LOAN-OFFICER               PIC XXX.
  2324         16  CM-REIN-TABLE                 PIC XXX.
  2325         16  CM-SPECIAL-REIN-CODE          PIC X.
  2326         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2327         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2328         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2329
  2330     12  CM-STATUS-DATA.
  2331         16  CM-ENTRY-STATUS               PIC X.
  2332         16  CM-ENTRY-DT                   PIC XX.
  2333
  2334         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2335         16  CM-LF-CANCEL-DT               PIC XX.
  2336         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2337
  2338         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2339         16  CM-LF-DEATH-DT                PIC XX.
  2340         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2341
  2342         16  CM-LF-CURRENT-STATUS          PIC X.
  2343             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2344                                                'M' '4' '5' '9'.
  2345             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2346             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2347             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2348             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  44
* EL050.cbl
  2349             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2350             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2351             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2352             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2353             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2354             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2355             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2356             88  CM-LF-DECLINED               VALUE 'D'.
  2357             88  CM-LF-VOIDED                 VALUE 'V'.
  2358
  2359         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2360         16  CM-AH-CANCEL-DT               PIC XX.
  2361         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2362
  2363         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2364         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2365         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2366
  2367         16  CM-AH-CURRENT-STATUS          PIC X.
  2368             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2369                                                'M' '4' '5' '9'.
  2370             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2371             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2372             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2373             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2374             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2375             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2376             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2377             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2378             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2379             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2380             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2381             88  CM-AH-DECLINED               VALUE 'D'.
  2382             88  CM-AH-VOIDED                 VALUE 'V'.
  2383
  2384         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2385             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2386             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2387             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2388         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2389
  2390         16  CM-ENTRY-BATCH                PIC X(6).
  2391         16  CM-LF-EXIT-BATCH              PIC X(6).
  2392         16  CM-AH-EXIT-BATCH              PIC X(6).
  2393         16  CM-LAST-MONTH-END             PIC XX.
  2394
  2395     12  CM-NOTE-SW                        PIC X.
  2396         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2397         88  CERT-NOTES-PRESENT               VALUE '1'.
  2398         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2399         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2400         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2401         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2402         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2403         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2404     12  CM-COMP-EXCP-SW                   PIC X.
  2405         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2406         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  45
* EL050.cbl
  2407     12  CM-INSURED-ADDRESS-SW             PIC X.
  2408         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2409         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2410
  2411*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2412     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2413     12  FILLER                            PIC X.
  2414
  2415*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2416     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2417     12  FILLER                            PIC X.
  2418*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2419     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2420
  2421     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2422         88  CERT-ADDED-BATCH                 VALUE ' '.
  2423         88  CERT-ADDED-ONLINE                VALUE '1'.
  2424         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2425         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2426         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2427     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2428         88  CERT-AS-LOADED                   VALUE ' '.
  2429         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2430         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2431         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2432         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2433         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2434         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2435         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2436
  2437     12  CM-ACCOUNT-COMM-PCTS.
  2438         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2439         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2440
  2441     12  CM-USER-FIELD                     PIC X.
  2442     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2443     12  CM-CLP-STATE                      PIC XX.
  2444     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2445     12  CM-USER-RESERVED                  PIC XXX.
  2446     12  FILLER REDEFINES CM-USER-RESERVED.
  2447         16  CM-AH-CLASS-CD                PIC XX.
  2448         16  F                             PIC X.
  2449******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  46
* EL050.cbl
  2451*    COPY ERCMAIL.
  2452******************************************************************
  2453*                                                                *
  2454*                                                                *
  2455*                            ERCMAIL                             *
  2456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2457*                            VMOD=2.003                          *
  2458*                                                                *
  2459*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2460*                                                                *
  2461*   FILE TYPE = VSAM,KSDS                                        *
  2462*   RECORD SIZE = 374   RECFORM = FIX                            *
  2463*                                                                *
  2464*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2465*   ALTERNATE PATH    = NOT USED                                 *
  2466*                                                                *
  2467*   LOG = YES                                                    *
  2468*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2469******************************************************************
  2470*                   C H A N G E   L O G
  2471*
  2472* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2473*-----------------------------------------------------------------
  2474*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2475* EFFECTIVE    NUMBER
  2476*-----------------------------------------------------------------
  2477* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2478* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2479* 111108                   PEMA  ADD CRED BENE ADDR2
  2480******************************************************************
  2481
  2482 01  MAILING-DATA.
  2483     12  MA-RECORD-ID                      PIC XX.
  2484         88  VALID-MA-ID                       VALUE 'MA'.
  2485
  2486     12  MA-CONTROL-PRIMARY.
  2487         16  MA-COMPANY-CD                 PIC X.
  2488         16  MA-CARRIER                    PIC X.
  2489         16  MA-GROUPING.
  2490             20  MA-GROUPING-PREFIX        PIC XXX.
  2491             20  MA-GROUPING-PRIME         PIC XXX.
  2492         16  MA-STATE                      PIC XX.
  2493         16  MA-ACCOUNT.
  2494             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2495             20  MA-ACCOUNT-PRIME          PIC X(6).
  2496         16  MA-CERT-EFF-DT                PIC XX.
  2497         16  MA-CERT-NO.
  2498             20  MA-CERT-PRIME             PIC X(10).
  2499             20  MA-CERT-SFX               PIC X.
  2500
  2501     12  FILLER                            PIC XX.
  2502
  2503     12  MA-ACCESS-CONTROL.
  2504         16  MA-SOURCE-SYSTEM              PIC XX.
  2505             88  MA-FROM-CREDIT                VALUE 'CR'.
  2506             88  MA-FROM-VSI                   VALUE 'VS'.
  2507             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2508             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  47
* EL050.cbl
  2509         16  MA-RECORD-ADD-DT              PIC XX.
  2510         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2511         16  MA-LAST-MAINT-DT              PIC XX.
  2512         16  MA-LAST-MAINT-BY              PIC XXXX.
  2513         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2514
  2515     12  MA-PROFILE-INFO.
  2516         16  MA-QUALIFY-CODE-1             PIC XX.
  2517         16  MA-QUALIFY-CODE-2             PIC XX.
  2518         16  MA-QUALIFY-CODE-3             PIC XX.
  2519         16  MA-QUALIFY-CODE-4             PIC XX.
  2520         16  MA-QUALIFY-CODE-5             PIC XX.
  2521
  2522         16  MA-INSURED-LAST-NAME          PIC X(15).
  2523         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2524         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2525         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2526         16  MA-INSURED-BIRTH-DT           PIC XX.
  2527         16  MA-INSURED-SEX                PIC X.
  2528             88  MA-SEX-MALE                   VALUE 'M'.
  2529             88  MA-SEX-FEMALE                 VALUE 'F'.
  2530         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2531
  2532         16  MA-ADDRESS-CORRECTED          PIC X.
  2533         16  MA-JOINT-BIRTH-DT             PIC XX.
  2534*        16  FILLER                        PIC X(12).
  2535
  2536         16  MA-ADDRESS-LINE-1             PIC X(30).
  2537         16  MA-ADDRESS-LINE-2             PIC X(30).
  2538         16  MA-CITY-STATE.
  2539             20  MA-CITY                   PIC X(28).
  2540             20  MA-ADDR-STATE             PIC XX.
  2541         16  MA-ZIP.
  2542             20  MA-ZIP-CODE.
  2543                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2544                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2545                 24  FILLER                PIC X(4).
  2546             20  MA-ZIP-PLUS4              PIC X(4).
  2547         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2548             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2549             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2550             20  FILLER                    PIC X(3).
  2551
  2552         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2553
  2554         16  FILLER                        PIC XXX.
  2555*        16  FILLER                        PIC X(10).
  2556
  2557     12  MA-CRED-BENE-INFO.
  2558         16  MA-CRED-BENE-NAME                 PIC X(25).
  2559         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2560         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2561         16  MA-CRED-BENE-CTYST.
  2562             20  MA-CRED-BENE-CITY             PIC X(28).
  2563             20  MA-CRED-BENE-STATE            PIC XX.
  2564         16  MA-CRED-BENE-ZIP.
  2565             20  MA-CB-ZIP-CODE.
  2566                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  48
* EL050.cbl
  2567                     88  MA-CB-CANADIAN-POST-CODE
  2568                                           VALUE 'A' THRU 'Z'.
  2569                 24  FILLER                    PIC X(4).
  2570             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2571         16  MA-CB-CANADIAN-POSTAL-CODE
  2572                            REDEFINES MA-CRED-BENE-ZIP.
  2573             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2574             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2575             20  FILLER                        PIC X(3).
  2576     12  MA-POST-CARD-MAIL-DATA.
  2577         16  MA-MAIL-DATA OCCURS 7.
  2578             20  MA-MAIL-TYPE              PIC X.
  2579                 88  MA-12MO-MAILING           VALUE '1'.
  2580                 88  MA-EXP-MAILING            VALUE '2'.
  2581             20  MA-MAIL-STATUS            PIC X.
  2582                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2583                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2584                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2585             20  MA-MAIL-DATE              PIC XX.
  2586     12  FILLER                            PIC XX.
  2587     12  FILLER                            PIC XX.
  2588*    12  FILLER                            PIC X(30).
  2589******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  49
* EL050.cbl
  2591*    COPY ERCPNDM.
  2592******************************************************************
  2593*                                                                *
  2594*                                                                *
  2595*                            ERCPNDM                             *
  2596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2597*                            VMOD=2.003                          *
  2598*                                                                *
  2599*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2600*                                                                *
  2601*   FILE TYPE = VSAM,KSDS                                        *
  2602*   RECORD SIZE = 374   RECFORM = FIX                            *
  2603*                                                                *
  2604*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2605*   ALTERNATE PATH    = NOT USED                                 *
  2606*                                                                *
  2607*   LOG = YES                                                    *
  2608*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2609******************************************************************
  2610*                   C H A N G E   L O G
  2611*
  2612* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2613*-----------------------------------------------------------------
  2614*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2615* EFFECTIVE    NUMBER
  2616*-----------------------------------------------------------------
  2617* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2618* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2619* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2620******************************************************************
  2621
  2622 01  PENDING-MAILING-DATA.
  2623     12  PM-RECORD-ID                      PIC XX.
  2624         88  VALID-MA-ID                       VALUE 'PM'.
  2625
  2626     12  PM-CONTROL-PRIMARY.
  2627         16  PM-COMPANY-CD                 PIC X.
  2628         16  PM-ENTRY-BATCH                PIC X(6).
  2629         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2630         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2631
  2632     12  FILLER                            PIC X(14).
  2633
  2634     12  PM-ACCESS-CONTROL.
  2635         16  PM-SOURCE-SYSTEM              PIC XX.
  2636             88  PM-FROM-CREDIT                VALUE 'CR'.
  2637             88  PM-FROM-VSI                   VALUE 'VS'.
  2638             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2639             88  PM-FROM-OTHER                 VALUE 'OT'.
  2640         16  PM-RECORD-ADD-DT              PIC XX.
  2641         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2642         16  PM-LAST-MAINT-DT              PIC XX.
  2643         16  PM-LAST-MAINT-BY              PIC XXXX.
  2644         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2645
  2646     12  PM-PROFILE-INFO.
  2647         16  PM-QUALIFY-CODE-1             PIC XX.
  2648         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  50
* EL050.cbl
  2649         16  PM-QUALIFY-CODE-3             PIC XX.
  2650         16  PM-QUALIFY-CODE-4             PIC XX.
  2651         16  PM-QUALIFY-CODE-5             PIC XX.
  2652
  2653         16  PM-INSURED-LAST-NAME          PIC X(15).
  2654         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2655         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2656         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2657         16  PM-INSURED-BIRTH-DT           PIC XX.
  2658         16  PM-INSURED-SEX                PIC X.
  2659             88  PM-SEX-MALE                   VALUE 'M'.
  2660             88  PM-SEX-FEMALE                 VALUE 'F'.
  2661         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2662
  2663         16  PM-ADDRESS-CORRECTED          PIC X.
  2664         16  PM-JOINT-BIRTH-DT             PIC XX.
  2665*        16  FILLER                        PIC X(12).
  2666
  2667         16  PM-ADDRESS-LINE-1             PIC X(30).
  2668         16  PM-ADDRESS-LINE-2             PIC X(30).
  2669         16  PM-CITY-STATE.
  2670             20  PM-CITY                   PIC X(28).
  2671             20  PM-STATE                  PIC XX.
  2672         16  PM-ZIP.
  2673             20  PM-ZIP-CODE.
  2674                 24  PM-ZIP-1              PIC X.
  2675                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2676                 24  FILLER                PIC X(4).
  2677             20  PM-ZIP-PLUS4              PIC X(4).
  2678         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2679             20  PM-CAN-POST1              PIC XXX.
  2680             20  PM-CAN-POST2              PIC XXX.
  2681             20  FILLER                    PIC XXX.
  2682
  2683         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2684
  2685         16  FILLER                        PIC X(03).
  2686
  2687     12  PM-CRED-BENE-INFO.
  2688         16  PM-CRED-BENE-NAME             PIC X(25).
  2689         16  PM-CRED-BENE-ADDR             PIC X(30).
  2690         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2691         16  PM-CRED-BENE-CTYST.
  2692             20  PM-CRED-BENE-CITY         PIC X(28).
  2693             20  PM-CRED-BENE-STATE        PIC XX.
  2694         16  PM-CRED-BENE-ZIP.
  2695             20  PM-CB-ZIP-CODE.
  2696                 24  PM-CB-ZIP-1           PIC X.
  2697                     88  PM-CB-CANADIAN-POST-CODE
  2698                                  VALUE 'A' THRU 'Z'.
  2699                 24  FILLER                PIC X(4).
  2700             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2701         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2702             20  PM-CB-CAN-POST1           PIC XXX.
  2703             20  PM-CB-CAN-POST2           PIC XXX.
  2704             20  FILLER                    PIC XXX.
  2705     12  PM-POST-CARD-MAIL-DATA.
  2706         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  51
* EL050.cbl
  2707             20  PM-MAIL-TYPE              PIC X.
  2708                 88  PM-12MO-MAILING           VALUE '1'.
  2709                 88  PM-EXP-MAILING            VALUE '2'.
  2710             20  PM-MAIL-STATUS            PIC X.
  2711                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2712                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2713                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2714             20  PM-MAIL-DATE              PIC XX.
  2715     12  FILLER                            PIC XX.
  2716     12  FILLER                            PIC X(12).
  2717*    12  FILLER                            PIC X(30).
  2718
  2719******************************************************************
  2720*                                COPY ERCLOFC.
  2721******************************************************************
  2722*                                                                *
  2723*                                                                *
  2724*                            ERCLOFC                             *
  2725*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2726*                            VMOD=2.003                          *
  2727*                                                                *
  2728*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2729*                                                                *
  2730*   FILE TYPE = VSAM,KSDS                                        *
  2731*   RECORD SIZE = 670   RECFORM = FIX                            *
  2732*                                                                *
  2733*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2734*                                                                *
  2735*   LOG = YES                                                    *
  2736*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2737*                                                                *
  2738******************************************************************
  2739
  2740 01  LOAN-OFFICER-MASTER.
  2741     12  LO-RECORD-ID                PIC XX.
  2742         88  VALID-LO-ID                VALUE 'LO'.
  2743
  2744     12  LO-CONTROL-PRIMARY.
  2745         16  LO-COMPANY-CD           PIC X.
  2746         16  LO-CARRIER              PIC X.
  2747         16  LO-GROUPING.
  2748             20  LO-GROUPING-PREFIX  PIC XXX.
  2749             20  LO-GROUPING-PRIME   PIC XXX.
  2750         16  LO-STATE                PIC XX.
  2751         16  LO-ACCOUNT.
  2752             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2753             20  LO-ACCOUNT-PRIME    PIC X(6).
  2754         16  LO-OFFICER-CODE         PIC X(5).
  2755
  2756     12  LO-OFFICER-NAME             PIC X(30).
  2757
  2758     12  LO-LAST-MAINT-DT            PIC XX.
  2759     12  LO-LAST-USER                PIC X(4).
  2760     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2761
  2762     12  LO-COMP-CONTROL             PIC X.
  2763             88  LO-SHOW-COMP           VALUE 'Y'.
  2764             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  52
* EL050.cbl
  2765     12  LO-DETAIL-CONTROL           PIC X.
  2766             88  LO-PRINT-DETAIL        VALUE 'D'.
  2767             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2768
  2769     12  LO-SV-CARRIER               PIC X.
  2770     12  LO-SV-GROUPING              PIC X(6).
  2771     12  LO-SV-STATE                 PIC XX.
  2772
  2773     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2774     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2775
  2776     12  LO-OFFICER-INFO.
  2777         16  FILLER OCCURS 12 TIMES.
  2778             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2779             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2780             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2781             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2782             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2783             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2784             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2785             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2786     12  FILLER                      PIC X(198).
  2787******************************************************************
  2788*                                COPY ERCPDEF.
  2789******************************************************************
  2790*                                                                *
  2791*                                                                *
  2792*                            ERCPDEF.                            *
  2793*                                                                *
  2794*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2795*                                                                *
  2796*    FILE TYPE = VSAM,KSDS                                       *
  2797*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2798*                                                                *
  2799*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2800*                                                                *
  2801*    LOG = YES                                                   *
  2802*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2803******************************************************************
  2804*                   C H A N G E   L O G
  2805*
  2806* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2807*-----------------------------------------------------------------
  2808*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2809* EFFECTIVE    NUMBER
  2810*-----------------------------------------------------------------
  2811* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2812* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2813* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2814******************************************************************
  2815 01  PRODUCT-MASTER.
  2816    12  PD-RECORD-ID                 PIC X(02).
  2817        88  VALID-PD-ID                  VALUE 'PD'.
  2818    12  PD-CONTROL-PRIMARY.
  2819        16  PD-COMPANY-CD            PIC X.
  2820        16  PD-STATE                 PIC XX.
  2821        16  PD-PRODUCT-CD            PIC XXX.
  2822        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  53
* EL050.cbl
  2823        16  PD-BEN-TYPE              PIC X.
  2824        16  PD-BEN-CODE              PIC XX.
  2825        16  PD-PROD-EXP-DT           PIC XX.
  2826    12  FILLER                       PIC X(50).
  2827    12  PD-PRODUCT-DATA OCCURS 8.
  2828        16  PD-PROD-CODE             PIC X.
  2829            88  PD-PROD-LIFE           VALUE 'L'.
  2830            88  PD-PROD-PROP           VALUE 'P'.
  2831            88  PD-PROD-AH             VALUE 'A'.
  2832            88  PD-PROD-IU             VALUE 'I'.
  2833            88  PD-PROD-GAP            VALUE 'G'.
  2834            88  PD-PROD-FAML           VALUE 'F'.
  2835        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2836        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2837        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2838        16  PD-MAX-TERM              PIC S999        COMP-3.
  2839        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2840        16  FILLER                   PIC X.
  2841        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2842        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2843        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2844        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2845        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2846        16  PD-REC-CRIT-PERIOD       PIC 99.
  2847        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2848            20  PD-RECURRING-YN      PIC X.
  2849            20  FILLER               PIC X.
  2850        16  PD-RTW-MOS               PIC 99.
  2851        16  PD-MAX-EXTENSION         PIC 99.
  2852        16  pd-ben-pct               pic sv999 comp-3.
  2853*       16  FILLER                   PIC XX.
  2854    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2855    12  PD-TERM-LIMITS OCCURS 15.
  2856        16  PD-LOW-TERM              PIC S999        COMP-3.
  2857        16  PD-HI-TERM               PIC S999        COMP-3.
  2858*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2859    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2860        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2861        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2862    12  PD-EARN-FACTORS.
  2863        16  FILLER OCCURS 15.
  2864            20  FILLER OCCURS 15.
  2865                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2866    12  PD-PRODUCT-DESC              PIC X(80).
  2867    12  PD-TRUNCATED                 PIC X.
  2868    12  FILLER                       PIC X(59).
  2869    12  PD-MAINT-INFORMATION.
  2870        16  PD-LAST-MAINT-DT         PIC X(02).
  2871        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2872        16  PD-LAST-MAINT-BY         PIC X(04).
  2873*                                COPY ELCSTATE.
  2874******************************************************************
  2875*                                                                *
  2876*                                                                *
  2877*                            ELCSTATE.                           *
  2878*                                                                *
  2879*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2880*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  54
* EL050.cbl
  2881*   FILE TYPE = VSAM,KSDS                                        *
  2882*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2883*                                                                *
  2884*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2885*       ALTERNATE INDEX = NONE                                   *
  2886*                                                                *
  2887*   LOG = YES                                                    *
  2888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2889******************************************************************
  2890*                   C H A N G E   L O G
  2891*
  2892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2893*-----------------------------------------------------------------
  2894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2895* EFFECTIVE    NUMBER
  2896*-----------------------------------------------------------------
  2897* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2898******************************************************************
  2899*
  2900 01  STATE-FILE.
  2901     12  SF-RECORD-ID                       PIC XX.
  2902         88  VALID-CF-ID                        VALUE 'SF'.
  2903     12  SF-CONTROL-PRIMARY.
  2904         16  SF-COMPANY-ID                  PIC XXX.
  2905         16  SF-CARRIER-CODE                PIC X.
  2906         16  SF-GROUPING                    PIC X(6).
  2907         16  SF-STATE-CODE                  PIC XX.
  2908         16  SF-EXPIRE-DATE                 PIC 9(8).
  2909****************************************************************
  2910*             STATE CONTROLS
  2911****************************************************************
  2912     12  SF-LAST-MAINT-DT                   PIC XX.
  2913     12  SF-LAST-MAINT-BY                   PIC X(4).
  2914     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2915     12  SF-STATE-RT-CONTROLS.
  2916         16  SF-ST-RT-CALC                  PIC X.
  2917     12  SF-ST-TAX-CONTROLS.
  2918         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2919         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2920         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2921     12  SF-ST-REFUND-OPTIONS.
  2922         16  SF-ST-RF-LR-CALC               PIC X.
  2923         16  SF-ST-RF-LL-CALC               PIC X.
  2924         16  SF-ST-RF-LN-CALC               PIC X.
  2925         16  SF-ST-RF-AH-CALC               PIC X.
  2926         16  SF-ST-RF-CP-CALC               PIC X.
  2927     12  SF-ST-UNEARN-PREM-OPTIONS.
  2928         16  SF-ST-LUEP-R78                 PIC X.
  2929         16  SF-ST-LUEP-PRO                 PIC X.
  2930         16  SF-ST-LUEP-ST                  PIC X.
  2931         16  SF-ST-LUEP-DOM                 PIC X.
  2932         16  SF-ST-AUEP-R78                 PIC X.
  2933         16  SF-ST-AUEP-PRO                 PIC X.
  2934         16  SF-ST-AUEP-ST                  PIC X.
  2935         16  SF-ST-AUEP-DOM                 PIC X.
  2936         16  SF-ST-CUEP-R78                 PIC X.
  2937         16  SF-ST-CUEP-PRO                 PIC X.
  2938         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  55
* EL050.cbl
  2939         16  SF-ST-CUEP-DOM                 PIC X.
  2940     12  SF-ST-EARN-PREM-OPTIONS.
  2941         16  SF-ST-LEP-R78                  PIC X.
  2942         16  SF-ST-LEP-PRO                  PIC X.
  2943         16  SF-ST-LEP-ST                   PIC X.
  2944         16  SF-ST-LEP-DOM                  PIC X.
  2945         16  SF-ST-AEP-R78                  PIC X.
  2946         16  SF-ST-AEP-PRO                  PIC X.
  2947         16  SF-ST-AEP-ST                   PIC X.
  2948         16  SF-ST-AEP-DOM                  PIC X.
  2949         16  SF-ST-CEP-R78                  PIC X.
  2950         16  SF-ST-CEP-PRO                  PIC X.
  2951         16  SF-ST-CEP-ST                   PIC X.
  2952         16  SF-ST-CEP-DOM                  PIC X.
  2953     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  56
* EL050.cbl
  2955*    COPY ELCCRTT.
  2956******************************************************************
  2957*                                                                *
  2958*                            ELCCRTT.                            *
  2959*                                                                *
  2960*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2961*                                                                *
  2962*   FILE TYPE = VSAM,KSDS                                        *
  2963*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2964*                                                                *
  2965*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2966*                                                                *
  2967*   LOG = YES                                                    *
  2968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2969******************************************************************
  2970*                   C H A N G E   L O G
  2971*
  2972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2973*-----------------------------------------------------------------
  2974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2975* EFFECTIVE    NUMBER
  2976*-----------------------------------------------------------------
  2977* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2978* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2979* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2980* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2981* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2982* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2983* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2984* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2985* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2986******************************************************************
  2987
  2988 01  CERTIFICATE-TRAILERS.
  2989     12  CS-RECORD-ID                      PIC XX.
  2990         88  VALID-CS-ID                      VALUE 'CS'.
  2991
  2992     12  CS-CONTROL-PRIMARY.
  2993         16  CS-COMPANY-CD                 PIC X.
  2994         16  CS-CARRIER                    PIC X.
  2995         16  CS-GROUPING                   PIC X(6).
  2996         16  CS-STATE                      PIC XX.
  2997         16  CS-ACCOUNT                    PIC X(10).
  2998         16  CS-CERT-EFF-DT                PIC XX.
  2999         16  CS-CERT-NO.
  3000             20  CS-CERT-PRIME             PIC X(10).
  3001             20  CS-CERT-SFX               PIC X.
  3002         16  CS-TRAILER-TYPE               PIC X.
  3003             88  COMM-TRLR           VALUE 'A'.
  3004             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3005             88  CERT-DATA-TRLR      VALUE 'C'.
  3006
  3007     12  CS-DATA-AREA                      PIC X(516).
  3008
  3009     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3010         16  CS-BANK-COMMISSION-AREA.
  3011             20  CS-BANK-COMMS       OCCURS 10.
  3012                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  57
* EL050.cbl
  3013                 24  CS-COM-TYP            PIC X.
  3014                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3015                 24  CS-RECALC-LV-INDIC    PIC X.
  3016                 24  FILLER                PIC X(10).
  3017         16  FILLER                        PIC X(256).
  3018
  3019     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3020****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3021         16  CS-MB-CLAIM-DATA OCCURS 24.
  3022             20  CS-CLAIM-NO               PIC X(7).
  3023             20  CS-CLAIM-TYPE             PIC X.
  3024                 88  CS-AH-CLM               VALUE 'A'.
  3025                 88  CS-IU-CLM               VALUE 'I'.
  3026                 88  CS-GP-CLM               VALUE 'G'.
  3027                 88  CS-LF-CLM               VALUE 'L'.
  3028                 88  CS-PR-CLM               VALUE 'P'.
  3029                 88  CS-FL-CLM               VALUE 'F'.
  3030             20  CS-INSURED-TYPE           PIC X.
  3031                 88  CS-PRIM-INSURED          VALUE 'P'.
  3032                 88  CS-CO-BORROWER           VALUE 'C'.
  3033             20  CS-BENEFIT-PERIOD         PIC 99.
  3034             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3035             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3036             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3037         16  FILLER                        PIC X(12).
  3038     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3039         16  CS-VIN-NUMBER                 PIC X(17).
  3040         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3041         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3042         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3043         16  cs-agent-name.
  3044             20  cs-agent-fname            pic x(20).
  3045             20  cs-agent-mi               pic x.
  3046             20  cs-agent-lname            pic x(25).
  3047         16  cs-license-no                 pic x(15).
  3048         16  cs-npn-number                 pic x(10).
  3049         16  cs-agent-edit-status          pic x.
  3050             88  cs-ae-refer-to-manager      value 'M'.
  3051             88  cs-ae-cover-sheet           value 'C'.
  3052             88  cs-ae-sig-form              value 'S'.
  3053             88  cs-ae-verified              value 'V'.
  3054             88  cs-unidentified-signature   value 'U'.
  3055             88  cs-cert-returned            value 'R'.
  3056             88  cs-accept-no-commission     value 'N'.
  3057         16  cs-year                       pic 9999.
  3058         16  cs-make                       pic x(20).
  3059         16  cs-model                      pic x(20).
  3060         16  cs-future                     pic x(20).
  3061         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3062         16  FILLER                        PIC X(356). *> was 420
  3063*        16  FILLER                        PIC X(496).
  3064*    COPY ELCCRTO.
  3065******************************************************************
  3066*                                                                *
  3067*                            ELCCRTO.                            *
  3068*                                                                *
  3069*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3070*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  58
* EL050.cbl
  3071*   FILE TYPE = VSAM,KSDS                                        *
  3072*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3073*                                                                *
  3074*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3075*                                                                *
  3076*   LOG = YES                                                    *
  3077*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3078******************************************************************
  3079*                   C H A N G E   L O G
  3080*
  3081* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3082*-----------------------------------------------------------------
  3083*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3084* EFFECTIVE    NUMBER
  3085*-----------------------------------------------------------------
  3086* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3087* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3088* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3089* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3090* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3091******************************************************************
  3092 01  ORIGINAL-CERTIFICATE.
  3093     12  OC-RECORD-ID                      PIC XX.
  3094         88  VALID-OC-ID                      VALUE 'OC'.
  3095     12  OC-CONTROL-PRIMARY.
  3096         16  OC-COMPANY-CD                 PIC X.
  3097         16  OC-CARRIER                    PIC X.
  3098         16  OC-GROUPING                   PIC X(6).
  3099         16  OC-STATE                      PIC XX.
  3100         16  OC-ACCOUNT                    PIC X(10).
  3101         16  OC-CERT-EFF-DT                PIC XX.
  3102         16  OC-CERT-NO.
  3103             20  OC-CERT-PRIME             PIC X(10).
  3104             20  OC-CERT-SFX               PIC X.
  3105         16  OC-RECORD-TYPE                PIC X.
  3106         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3107     12  OC-LAST-MAINT-DT                  PIC XX.
  3108     12  OC-LAST-MAINT-BY                  PIC X(4).
  3109     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3110     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3111     12  FILLER                            PIC X(49).
  3112     12  OC-ORIG-REC.
  3113         16  OC-INS-LAST-NAME              PIC X(15).
  3114         16  OC-INS-FIRST-NAME             PIC X(10).
  3115         16  OC-INS-MIDDLE-INIT            PIC X.
  3116         16  OC-INS-AGE                    PIC S999     COMP-3.
  3117         16  OC-JNT-LAST-NAME              PIC X(15).
  3118         16  OC-JNT-FIRST-NAME             PIC X(10).
  3119         16  OC-JNT-MIDDLE-INIT            PIC X.
  3120         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3121         16  OC-LF-BENCD                   PIC XX.
  3122         16  OC-LF-TERM                    PIC S999      COMP-3.
  3123         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3124         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3125         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3126         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3127         16  OC-LF-EXP-DT                  PIC XX.
  3128         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  59
* EL050.cbl
  3129         16  OC-LF-CANCEL-DT               PIC XX.
  3130         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3131         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3132         16  OC-AH-BENCD                   PIC XX.
  3133         16  OC-AH-TERM                    PIC S999      COMP-3.
  3134         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3135         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3136         16  OC-AH-EXP-DT                  PIC XX.
  3137         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3138         16  OC-AH-CP                      PIC 99.
  3139         16  OC-AH-CANCEL-DT               PIC XX.
  3140         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3141         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3142         16  OC-CRED-BENE-NAME             PIC X(25).
  3143         16  OC-1ST-PMT-DT                 PIC XX.
  3144         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3145         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3146         16  OC-ISSUE-TRAN-IND             PIC X.
  3147         16  OC-CANCEL-TRAN-IND            PIC X.
  3148         16  FILLER                        PIC X(211).
  3149
  3150     12  FILLER                            PIC X(50).
  3151******************************************************************
  3152
  3153*    COPY ELCDATE.
  3154******************************************************************
  3155*                                                                *
  3156*                                                                *
  3157*                            ELCDATE.                            *
  3158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3159*                            VMOD=2.003
  3160*                                                                *
  3161*                                                                *
  3162*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3163*                 LENGTH = 200                                   *
  3164******************************************************************
  3165
  3166 01  DATE-CONVERSION-DATA.
  3167     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3168     12  DC-OPTION-CODE                PIC X.
  3169         88  BIN-TO-GREG                VALUE ' '.
  3170         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3171         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3172         88  YMD-GREG-TO-BIN            VALUE '3'.
  3173         88  MDY-GREG-TO-BIN            VALUE '4'.
  3174         88  JULIAN-TO-BIN              VALUE '5'.
  3175         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3176         88  FIND-CENTURY               VALUE '7'.
  3177         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3178         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3179         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3180         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3181         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3182         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3183         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3184         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3185         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3186         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  60
* EL050.cbl
  3187         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3188         88  BIN-3-TO-GREG              VALUE 'I'.
  3189         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3190         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3191         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3192         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3193         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3194         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3195         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3196         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3197         88  THREE-CHARACTER-BIN
  3198                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3199         88  GREGORIAN-TO-BIN
  3200                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3201         88  BIN-TO-GREGORIAN
  3202                  VALUES ' ' '1' 'I' '8' 'G'.
  3203         88  JULIAN-TO-BINARY
  3204                  VALUES '5' 'C' 'E' 'F'.
  3205     12  DC-ERROR-CODE                 PIC X.
  3206         88  NO-CONVERSION-ERROR        VALUE ' '.
  3207         88  DATE-CONVERSION-ERROR
  3208                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3209         88  DATE-IS-ZERO               VALUE '1'.
  3210         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3211         88  DATE-IS-INVALID            VALUE '3'.
  3212         88  DATE1-GREATER-DATE2        VALUE '4'.
  3213         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3214         88  DATE-INVALID-OPTION        VALUE '9'.
  3215         88  INVALID-CENTURY            VALUE 'A'.
  3216         88  ONLY-CENTURY               VALUE 'B'.
  3217         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3218         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3219     12  DC-END-OF-MONTH               PIC X.
  3220         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3221     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3222         88  USE-NORMAL-PROCESS         VALUE ' '.
  3223         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3224         88  ADJUST-UP-100-YRS          VALUE '2'.
  3225     12  FILLER                        PIC X.
  3226     12  DC-CONVERSION-DATES.
  3227         16  DC-BIN-DATE-1             PIC XX.
  3228         16  DC-BIN-DATE-2             PIC XX.
  3229         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3230         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3231                       DC-GREG-DATE-1-EDIT.
  3232             20  DC-EDIT1-MONTH        PIC 99.
  3233             20  SLASH1-1              PIC X.
  3234             20  DC-EDIT1-DAY          PIC 99.
  3235             20  SLASH1-2              PIC X.
  3236             20  DC-EDIT1-YEAR         PIC 99.
  3237         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3238         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3239                     DC-GREG-DATE-2-EDIT.
  3240             20  DC-EDIT2-MONTH        PIC 99.
  3241             20  SLASH2-1              PIC X.
  3242             20  DC-EDIT2-DAY          PIC 99.
  3243             20  SLASH2-2              PIC X.
  3244             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  61
* EL050.cbl
  3245         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3246         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3247                     DC-GREG-DATE-1-YMD.
  3248             20  DC-YMD-YEAR           PIC 99.
  3249             20  DC-YMD-MONTH          PIC 99.
  3250             20  DC-YMD-DAY            PIC 99.
  3251         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3252         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3253                      DC-GREG-DATE-1-MDY.
  3254             20  DC-MDY-MONTH          PIC 99.
  3255             20  DC-MDY-DAY            PIC 99.
  3256             20  DC-MDY-YEAR           PIC 99.
  3257         16  DC-GREG-DATE-1-ALPHA.
  3258             20  DC-ALPHA-MONTH        PIC X(10).
  3259             20  DC-ALPHA-DAY          PIC 99.
  3260             20  FILLER                PIC XX.
  3261             20  DC-ALPHA-CENTURY.
  3262                 24 DC-ALPHA-CEN-N     PIC 99.
  3263             20  DC-ALPHA-YEAR         PIC 99.
  3264         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3265         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3266         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3267         16  DC-JULIAN-DATE            PIC 9(05).
  3268         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3269                                       PIC 9(05).
  3270         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3271             20  DC-JULIAN-YEAR        PIC 99.
  3272             20  DC-JULIAN-DAYS        PIC 999.
  3273         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3274         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3275         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3276     12  DATE-CONVERSION-VARIBLES.
  3277         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3278         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3279             20  FILLER                PIC 9(3).
  3280             20  HOLD-CEN-1-CCYY.
  3281                 24  HOLD-CEN-1-CC     PIC 99.
  3282                 24  HOLD-CEN-1-YY     PIC 99.
  3283             20  HOLD-CEN-1-MO         PIC 99.
  3284             20  HOLD-CEN-1-DA         PIC 99.
  3285         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3286             20  HOLD-CEN-1-R-MO       PIC 99.
  3287             20  HOLD-CEN-1-R-DA       PIC 99.
  3288             20  HOLD-CEN-1-R-CCYY.
  3289                 24  HOLD-CEN-1-R-CC   PIC 99.
  3290                 24  HOLD-CEN-1-R-YY   PIC 99.
  3291             20  FILLER                PIC 9(3).
  3292         16  HOLD-CENTURY-1-X.
  3293             20  FILLER                PIC X(3)  VALUE SPACES.
  3294             20  HOLD-CEN-1-X-CCYY.
  3295                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3296                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3297             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3298             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3299         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3300             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3301             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3302             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  62
* EL050.cbl
  3303                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3304                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3305             20  FILLER                PIC XXX.
  3306         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3307         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3308         16  DC-JULIAN-DATE-1          PIC 9(07).
  3309         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3310             20  DC-JULIAN-1-CCYY.
  3311                 24  DC-JULIAN-1-CC    PIC 99.
  3312                 24  DC-JULIAN-1-YR    PIC 99.
  3313             20  DC-JULIAN-DA-1        PIC 999.
  3314         16  DC-JULIAN-DATE-2          PIC 9(07).
  3315         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3316             20  DC-JULIAN-2-CCYY.
  3317                 24  DC-JULIAN-2-CC    PIC 99.
  3318                 24  DC-JULIAN-2-YR    PIC 99.
  3319             20  DC-JULIAN-DA-2        PIC 999.
  3320         16  DC-GREG-DATE-A-EDIT.
  3321             20  DC-EDITA-MONTH        PIC 99.
  3322             20  SLASHA-1              PIC X VALUE '/'.
  3323             20  DC-EDITA-DAY          PIC 99.
  3324             20  SLASHA-2              PIC X VALUE '/'.
  3325             20  DC-EDITA-CCYY.
  3326                 24  DC-EDITA-CENT     PIC 99.
  3327                 24  DC-EDITA-YEAR     PIC 99.
  3328         16  DC-GREG-DATE-B-EDIT.
  3329             20  DC-EDITB-MONTH        PIC 99.
  3330             20  SLASHB-1              PIC X VALUE '/'.
  3331             20  DC-EDITB-DAY          PIC 99.
  3332             20  SLASHB-2              PIC X VALUE '/'.
  3333             20  DC-EDITB-CCYY.
  3334                 24  DC-EDITB-CENT     PIC 99.
  3335                 24  DC-EDITB-YEAR     PIC 99.
  3336         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3337         16  DC-GREG-DATE-CYMD-R REDEFINES
  3338                              DC-GREG-DATE-CYMD.
  3339             20  DC-CYMD-CEN           PIC 99.
  3340             20  DC-CYMD-YEAR          PIC 99.
  3341             20  DC-CYMD-MONTH         PIC 99.
  3342             20  DC-CYMD-DAY           PIC 99.
  3343         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3344         16  DC-GREG-DATE-MDCY-R REDEFINES
  3345                              DC-GREG-DATE-MDCY.
  3346             20  DC-MDCY-MONTH         PIC 99.
  3347             20  DC-MDCY-DAY           PIC 99.
  3348             20  DC-MDCY-CEN           PIC 99.
  3349             20  DC-MDCY-YEAR          PIC 99.
  3350    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3351        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3352    12  DC-EL310-DATE                  PIC X(21).
  3353    12  FILLER                         PIC X(28).
  3354
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  63
* EL050.cbl
  3356*    COPY ELCCALC.
  3357******************************************************************
  3358*                                                                *
  3359*                           ELCCALC.                            *
  3360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3361*                            VMOD=2.025                          *
  3362*                                                                *
  3363*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3364*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3365*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3366*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3367*                                                                *
  3368*  PASSED TO ELRTRM                                              *
  3369*  -----------------                                             *
  3370*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3371*  ORIGINAL TERM                                                 *
  3372*  BEGINNING DATE                                                *
  3373*  ENDING DATE                                                   *
  3374*  COMPANY I.D.                                                  *
  3375*  ACCOUNT MASTER USER FIELD                                     *
  3376*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3377*  FREE LOOK DAYS                                                *
  3378*                                                                *
  3379*  RETURNED FROM ELRTRM                                          *
  3380*  ---------------------                                         *
  3381*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3382*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3383*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3384*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3385*----------------------------------------------------------------*
  3386*  PASSED TO ELRAMT                                              *
  3387*  ----------------                                              *
  3388*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3389*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3390*  ORIGINAL AMOUNT                                               *
  3391*  ALTERNATE BENEFIT (BALLON)                                    *
  3392*  A.P.R. - NET PAY ONLY                                         *
  3393*  METHOD
  3394*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3395*  COMPANY I.D.                                                  *
  3396*  BENEFIT TYPE                                                  *
  3397*                                                                *
  3398*  RETURNED FROM ELRAMT                                          *
  3399*  --------------------                                          *
  3400*  REMAINING AMOUNT 1 - CURRENT                                  *
  3401*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3402*  REMAINING AMOUNT FACTOR
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRESV                                              *
  3405*  -----------------                                             *
  3406*  CERTIFICATE EFFECTIVE DATE                                    *
  3407*  VALUATION DATE                                                *
  3408*  PAID THRU DATE                                                *
  3409*  BENEFIT                                                       *
  3410*  INCURRED DATE                                                 *
  3411*  REPORTED DATE                                                 *
  3412*  ISSUE AGE                                                     *
  3413*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  64
* EL050.cbl
  3414*  CDT PERCENT                                                   *
  3415*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3416* *CLAIM TYPE (LIFE, A/H)                                        *
  3417* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3418* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3419*                                                                *
  3420*  RETURNED FROM ELRESV                                          *
  3421*  --------------------                                          *
  3422*  CDT TABLE USED                                                *
  3423*  CDT FACTOR USED                                               *
  3424*  PAY TO CURRENT RESERVE                                        *
  3425*  I.B.N.R. - A/H ONLY                                           *
  3426*  FUTURE (ACCRUED) AH ONLY                                      *
  3427*----------------------------------------------------------------*
  3428*  PASSED TO ELRATE                                              *
  3429*  ----------------                                              *
  3430*  CERT ISSUE DATE                                               *
  3431*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3432*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3433*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3434*  STATE CODE (CLIENT DEFINED)                                   *
  3435*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3436*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3437*  DEVIATION CODE                                                *
  3438*  ISSUE AGE                                                     *
  3439*  ORIGINAL BENEFIT AMOUNT                                       *
  3440*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3441*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3442*  BENEFIT KIND (LIFE OR A/H)                                    *
  3443*  A.P.R.                                                        *
  3444*  METHOD
  3445*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3446*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3447*  COMPANY I.D. (3 CHARACTER)                                    *
  3448*  BENEFIT CODE                                                  *
  3449*  BENEFIT OVERRIDE CODE                                         *
  3450*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3451*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3452*  JOINT INDICATOR (CSL ONLY)                                    *
  3453*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3454*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3455*                                                                *
  3456*  RETURNED FROM ELRATE                                          *
  3457*  --------------------                                          *
  3458*  CALCULATED PREMIUM                                            *
  3459*  PREMIUM RATE                                                  *
  3460*  MORTALITY CODE                                                *
  3461*  MAX ATTAINED AGE                                              *
  3462*  MAX AGE                                                       *
  3463*  MAX TERM                                                      *
  3464*  MAX MONTHLY BENEFIT                                           *
  3465*  MAX TOTAL BENIFIT                                             *
  3466*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3467*----------------------------------------------------------------*
  3468*  PASSED TO ELRFND                                              *
  3469*  ----------------                                              *
  3470*  CERT ISSUE DATE                                               *
  3471*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  65
* EL050.cbl
  3472*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3473*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3474*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3475*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3476*  STATE CODE (CLIENT DEFINED)                                   *
  3477*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3478*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3479*  DEVIATION CODE                                                *
  3480*  ISSUE AGE                                                     *
  3481*  ORIGINAL BENEFIT AMOUNT                                       *
  3482*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3483*  PROCESS TYPE (CANCEL)                                         *
  3484*  BENEFIT KIND (LIFE OR A/H)                                    *
  3485*  A.P.R.                                                        *
  3486*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3487*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3488*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3489*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3490*  COMPANY I.D. (3 CHARACTER)                                    *
  3491*  BENEFIT CODE                                                  *
  3492*  BENEFIT OVERRIDE CODE                                         *
  3493*                                                                *
  3494*  RETURNED FROM ELRFND                                          *
  3495*  --------------------                                          *
  3496*  CALCULATED REFUND                                             *
  3497*----------------------------------------------------------------*
  3498*  PASSED TO ELEARN                                              *
  3499*  ----------------                                              *
  3500*  CERT ISSUE DATE                                               *
  3501*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3502*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3503*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3504*  STATE CODE (CLIENT DEFINED)                                   *
  3505*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3506*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3507*  DEVIATION CODE                                                *
  3508*  ISSUE AGE                                                     *
  3509*  ORIGINAL BENEFIT AMOUNT                                       *
  3510*  BENEFIT KIND (LIFE OR A/H)                                    *
  3511*  A.P.R.                                                        *
  3512*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3513*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3514*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3515*  COMPANY I.D. (3 CHARACTER)                                    *
  3516*  BENEFIT CODE                                                  *
  3517*  BENEFIT OVERRIDE CODE                                         *
  3518*                                                                *
  3519*  RETURNED FROM ELEARN                                          *
  3520*  --------------------                                          *
  3521*  INDICATED  EARNINGS                                           *
  3522*----------------------------------------------------------------*
  3523*                 LENGTH = 450                                   *
  3524*                                                                *
  3525******************************************************************
  3526******************************************************************
  3527*                   C H A N G E   L O G
  3528*
  3529* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  66
* EL050.cbl
  3530*-----------------------------------------------------------------
  3531*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3532* EFFECTIVE    NUMBER
  3533*-----------------------------------------------------------------
  3534* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3535* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3536* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3537* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3538* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3539* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3540* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3541* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3542* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3543* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3544* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3545******************************************************************
  3546
  3547 01  CALCULATION-PASS-AREA.
  3548     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3549                                     COMP.
  3550
  3551     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3552       88  NO-CP-ERROR                             VALUE ZERO.
  3553       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3554                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3555       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3556       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3557       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3558       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3559       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3560       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3561       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3562       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3563       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3564       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3565       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3566       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3567       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3568       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3569       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3570       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3571       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3572
  3573     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3574       88  NO-CP-ERROR-2                           VALUE ZERO.
  3575***********************  INPUT AREAS ****************************
  3576
  3577     12  CP-CALCULATION-AREA.
  3578         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3579         16  CP-CERT-EFF-DT        PIC XX.
  3580         16  CP-VALUATION-DT       PIC XX.
  3581         16  CP-PAID-THRU-DT       PIC XX.
  3582         16  CP-BENEFIT-TYPE       PIC X.
  3583           88  CP-AH                               VALUE 'A' 'D'
  3584                                                   'I' 'U'.
  3585           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3586           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3587         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  67
* EL050.cbl
  3588         16  CP-REPORTED-DT        PIC XX.
  3589         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3590         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3591         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-CDT-METHOD         PIC X.
  3596           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3597           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3598           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3599         16  CP-CLAIM-TYPE         PIC X.
  3600           88  CP-AH-CLAIM                         VALUE 'A'.
  3601           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3602         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3605                                     COMP-3.
  3606         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3607                                     COMP-3.
  3608         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3609                                     COMP-3.
  3610         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3611                                     COMP-3.
  3612         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3613                                     COMP-3.
  3614         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3615                                     COMP-3.
  3616         16  CP-REM-TERM-METHOD    PIC X.
  3617           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3618           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3619           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3620           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3621           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3622           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3623           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3624         16  CP-EARNING-METHOD     PIC X.
  3625           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3626           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3627           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3628           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3629           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3630           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3631           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3632           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3633           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3634           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3635           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3636           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3637           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3638           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3639         16  CP-PROCESS-TYPE       PIC X.
  3640           88  CP-CLAIM                            VALUE '1'.
  3641           88  CP-CANCEL                           VALUE '2'.
  3642           88  CP-ISSUE                            VALUE '3'.
  3643         16  CP-SPECIAL-CALC-CD    PIC X.
  3644           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3645           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  68
* EL050.cbl
  3646           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3647           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3648           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3649           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3650           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3651           88  CP-FARM-PLAN                    VALUE 'F'.
  3652           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3653           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3654           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3655           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3656           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3657           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3658           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3659           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3660           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3661           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3662                                                     'W' 'X'.
  3663           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3664           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3665           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3666           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3667           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3668           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3669           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3670           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3671           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3672           88  CP-CSL-METH-1                   VALUE '5'.
  3673           88  CP-CSL-METH-2                   VALUE '6'.
  3674           88  CP-CSL-METH-3                   VALUE '7'.
  3675           88  CP-CSL-METH-4                   VALUE '8'.
  3676
  3677         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3680         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3681         16  CP-STATE              PIC XX          VALUE SPACE.
  3682         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3683         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3684           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3685               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3686         16  CP-R78-OPTION         PIC X.
  3687           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3688           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3689
  3690         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3691         16  CP-IBNR-RESERVE-SW    PIC X.
  3692         16  CP-CLAIM-STATUS       PIC X.
  3693         16  CP-RATE-FILE          PIC X.
  3694         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3695                                     COMP-3.
  3696
  3697         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3698         16  CP-AH-OVERRIDE-CODE   PIC X.
  3699
  3700         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3703                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  69
* EL050.cbl
  3704         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3709                                     COMP-3.
  3710         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3711                                  PIC S9(7)V99 COMP-3.
  3712
  3713         16  CP-PAID-FROM-DATE     PIC X(02).
  3714         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3715         16  CP-EXT-DAYS-CALC      PIC X.
  3716           88  CP-EXT-NO-CHG                   VALUE ' '.
  3717           88  CP-EXT-CHG-LF                   VALUE '1'.
  3718           88  CP-EXT-CHG-AH                   VALUE '2'.
  3719           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3720         16  CP-DOMICILE-STATE     PIC XX.
  3721         16  CP-CARRIER            PIC X.
  3722         16  CP-REIN-FLAG          PIC X.
  3723         16  CP-REM-TRM-CALC-OPTION PIC X.
  3724           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3725                      '2' '3' '4' '5'.
  3726           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3727           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3728           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3729           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3730           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3731           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3732           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3733           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3734         16  CP-SIG-SWITCH         PIC X.
  3735         16  CP-RATING-METHOD      PIC X.
  3736           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3737           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3738           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3739           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3740           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3741           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3742           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3743           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3744           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3745         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3746                                     COMP-3.
  3747         16  CP-BEN-CATEGORY       PIC X.
  3748         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3749         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3750                                   PIC S99V9(5) COMP-3.
  3751         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3752         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3753                                   PIC S99V9(5) COMP-3.
  3754         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3755         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3756         16  CP-EXPIRE-DT          PIC XX.
  3757         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3758         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3759         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3760         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3761         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  70
* EL050.cbl
  3762             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3763             88  CP-CALC-CLP              VALUE 'C'.
  3764         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3765         16  CP-CANCEL-REASON      PIC X.
  3766         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3767         16  CP-PMT-MODE           PIC X.
  3768         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3769         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3770         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3771         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3772         16  FILLER                PIC X.
  3773
  3774***************    OUTPUT FROM ELRESV   ************************
  3775
  3776         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3777
  3778         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3785                                     COMP-3.
  3786         16  FILLER                PIC X(09).
  3787***************    OUTPUT FROM ELRTRM   *************************
  3788
  3789         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3794                                     COMP-3.
  3795         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3796                                     COMP-3.
  3797         16  FILLER                PIC X(12).
  3798
  3799***************    OUTPUT FROM ELRAMT   *************************
  3800
  3801         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3804                                     COMP-3.
  3805         16  FILLER                PIC X(12).
  3806
  3807***************    OUTPUT FROM ELRATE   *************************
  3808
  3809         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-MORTALITY-CODE     PIC X(4).
  3814         16  CP-RATE-EDIT-FLAG     PIC X.
  3815             88  CP-RATES-NEED-APR                  VALUE '1'.
  3816         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3819         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  71
* EL050.cbl
  3820         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3821                                   PIC S9(7)V99 COMP-3.
  3822         16  FILLER                PIC X(07).
  3823
  3824***************    OUTPUT FROM ELRFND   *************************
  3825
  3826         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-REFUND-TYPE-USED   PIC X.
  3829           88  CP-R-AS-R78                         VALUE '1'.
  3830           88  CP-R-AS-PRORATA                     VALUE '2'.
  3831           88  CP-R-AS-CALIF                       VALUE '3'.
  3832           88  CP-R-AS-TEXAS                       VALUE '4'.
  3833           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3834           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3835           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3836           88  CP-R-AS-MEAN                        VALUE '8'.
  3837           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3838           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3839           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3840           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3841           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3842           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3843         16  FILLER                PIC X(12).
  3844
  3845***************    OUTPUT FROM ELEARN   *************************
  3846
  3847         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3848                                     COMP-3.
  3849         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3850                                     COMP-3.
  3851         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3852                                     COMP-3.
  3853         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3854                                     COMP-3.
  3855         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3858                                     COMP-3.
  3859         16  CP-EARNING-TYPE-USED  PIC X.
  3860           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3861           88  CP-E-AS-R78                         VALUE '1'.
  3862           88  CP-E-AS-PRORATA                     VALUE '2'.
  3863           88  CP-E-AS-TEXAS                       VALUE '4'.
  3864           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3865           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3866           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3867           88  CP-E-AS-MEAN                        VALUE '8'.
  3868           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3869         16  FILLER                PIC X(12).
  3870
  3871***************    OUTPUT FROM ELPMNT   *************************
  3872
  3873         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  72
* EL050.cbl
  3878
  3879***************   MISC WORK AREAS    *****************************
  3880         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3881                                     COMP-3.
  3882         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3883                                     COMP-3.
  3884         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3885                                     COMP-3.
  3886         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3887                                     COMP-3.
  3888         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3889                                     COMP-3.
  3890         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3891                                     COMP-3.
  3892         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3893             88  OPEN-RATE-FILE                   VALUE 'O'.
  3894             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3895             88  IO-ERROR                         VALUE 'E'.
  3896
  3897         16  CP-FIRST-PAY-DATE     PIC XX.
  3898
  3899         16  CP-JOINT-INDICATOR    PIC X.
  3900
  3901         16  CP-RESERVE-REMAINING-TERM
  3902                                   PIC S9(4)V9    VALUE ZERO
  3903                                     COMP-3.
  3904
  3905         16  CP-INSURED-BIRTH-DT   PIC XX.
  3906
  3907         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3908                                     COMP-3.
  3909
  3910         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3911                                     COMP-3.
  3912
  3913         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3914                                     COMP-3.
  3915
  3916         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3917                                     COMP-3.
  3918
  3919         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3920                                     COMP-3.
  3921
  3922         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3923                                     COMP-3.
  3924
  3925         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3926                                     COMP-3.
  3927
  3928         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3929             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3930
  3931         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3932                                     COMP-3.
  3933         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3934                                     COMP-3.
  3935         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  73
* EL050.cbl
  3936         16  cp-extra-periods      pic 9 value zeros.
  3937         16  cp-net-only-state     pic x value spaces.
  3938         16  FILLER                PIC X(13).
  3939******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  74
* EL050.cbl
  3941******************************************************************
  3942*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3943*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3944*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3945*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3946*** MODIFICATION.                                              ***
  3947*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3948*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3949******************************************************************
  3950*    COPY ERCPNDB.
  3951******************************************************************
  3952*                                                                *
  3953*                                                                *
  3954*                            ERCPNDB.                            *
  3955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3956*                            VMOD=2.025                          *
  3957*                                                                *
  3958*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3959*                                                                *
  3960******************************************************************
  3961*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3962*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3963******************************************************************
  3964*                                                                *
  3965*                                                                *
  3966*   FILE TYPE = VSAM,KSDS                                        *
  3967*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3968*                                                                *
  3969*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3970*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3971*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3972*                                                 RKP=13,LEN=36  *
  3973*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3974*                                      AND CHG-SEQ.)             *
  3975*                                                RKP=49,LEN=11   *
  3976*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3977*                                      AND CHG-SEQ.)             *
  3978*                                                RKP=60,LEN=15   *
  3979*                                                                *
  3980*   LOG = NO                                                     *
  3981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3982******************************************************************
  3983******************************************************************
  3984*                   C H A N G E   L O G
  3985*
  3986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3987*-----------------------------------------------------------------
  3988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3989* EFFECTIVE    NUMBER
  3990*-----------------------------------------------------------------
  3991* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3992* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3993* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3994* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3995* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3996* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3997* 032306                   PEMA  ADD BOW LOAN NUMBER
  3998* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  75
* EL050.cbl
  3999* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4000* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4001* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4002* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4003* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4004* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4005* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4006* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4007* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4008* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4009******************************************************************
  4010
  4011 01  PENDING-BUSINESS.
  4012     12  PB-RECORD-ID                     PIC XX.
  4013         88  VALID-PB-ID                        VALUE 'PB'.
  4014
  4015     12  PB-CONTROL-PRIMARY.
  4016         16  PB-COMPANY-CD                PIC X.
  4017         16  PB-ENTRY-BATCH               PIC X(6).
  4018         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4019         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4020
  4021     12  PB-CONTROL-BY-ACCOUNT.
  4022         16  PB-COMPANY-CD-A1             PIC X.
  4023         16  PB-CARRIER                   PIC X.
  4024         16  PB-GROUPING.
  4025             20  PB-GROUPING-PREFIX       PIC XXX.
  4026             20  PB-GROUPING-PRIME        PIC XXX.
  4027         16  PB-STATE                     PIC XX.
  4028         16  PB-ACCOUNT.
  4029             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4030             20  PB-ACCOUNT-PRIME         PIC X(6).
  4031         16  PB-CERT-EFF-DT               PIC XX.
  4032         16  PB-CERT-NO.
  4033             20  PB-CERT-PRIME            PIC X(10).
  4034             20  PB-CERT-SFX              PIC X.
  4035         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4036
  4037         16  PB-RECORD-TYPE               PIC X.
  4038             88  PB-MAILING-DATA                VALUE '0'.
  4039             88  PB-ISSUE                       VALUE '1'.
  4040             88  PB-CANCELLATION                VALUE '2'.
  4041             88  PB-BATCH-TRAILER               VALUE '9'.
  4042
  4043     12  PB-CONTROL-BY-ORIG-BATCH.
  4044         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4045         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4046         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4047         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4048
  4049     12  PB-CONTROL-BY-CSR.
  4050         16  PB-CSR-COMPANY-CD            PIC X.
  4051         16  PB-CSR-ID                    PIC X(4).
  4052         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4053         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4054         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4055******************************************************************
  4056*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  76
* EL050.cbl
  4057******************************************************************
  4058
  4059     12  PB-LAST-MAINT-DT                 PIC XX.
  4060     12  PB-LAST-MAINT-BY                 PIC X(4).
  4061     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4062
  4063     12  PB-RECORD-BODY                   PIC X(375).
  4064
  4065     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4066         16  PB-CERT-ORIGIN               PIC X.
  4067             88  CLASIC-CREATED-CERT         VALUE '1'.
  4068         16  PB-I-NAME.
  4069             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4070             20  PB-I-INSURED-FIRST-NAME.
  4071                 24  PB-I-INSURED-1ST-INIT PIC X.
  4072                 24  FILLER                PIC X(9).
  4073             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4074         16  PB-I-AGE                     PIC S99   COMP-3.
  4075         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4076         16  PB-I-BIRTHDAY                PIC XX.
  4077         16  PB-I-INSURED-SEX             PIC X.
  4078             88  PB-SEX-MALE     VALUE 'M'.
  4079             88  PB-SEX-FEMALE   VALUE 'F'.
  4080
  4081         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4082         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4083         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4084         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4085         16  PB-I-SKIP-CODE               PIC X.
  4086             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4087             88  PB-SKIP-JULY              VALUE '1'.
  4088             88  PB-SKIP-AUGUST            VALUE '2'.
  4089             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4090             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4091             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4092             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4093             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4094             88  PB-SKIP-JUNE              VALUE '8'.
  4095             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4096             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4097             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4098         16  PB-I-TERM-TYPE               PIC X.
  4099             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4100             88  PB-PAID-WEEKLY            VALUE 'W'.
  4101             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4102             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4103             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4104         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4105         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4106         16  PB-I-DATA-ENTRY-SW           PIC X.
  4107             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4108             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4109             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4110             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4111         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4112         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4113*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4114         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  77
* EL050.cbl
  4115         16  FILLER                       PIC X.
  4116
  4117         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4118             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4119             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4120                                                   '90' THRU '99'.
  4121         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4122                                          PIC XX.
  4123         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4124         16  PB-I-AMOUNT-FINANCED REDEFINES
  4125                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4126         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4127         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4128                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4129         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4130         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4131         16  PB-I-CLP-AMOUNT REDEFINES
  4132                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4133         16  PB-I-LF-CALC-FLAG            PIC X.
  4134             88 PB-COMP-LF-PREM               VALUE '?'.
  4135         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4136         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4137         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4138         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4139         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4140         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4141         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4142         16  PB-I-LF-ABBR                 PIC XXX.
  4143         16  PB-I-LF-INPUT-CD             PIC XX.
  4144
  4145         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4146             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4147             88  PB-INVALID-AH               VALUE '  ' '00'
  4148                                                   '90' THRU '99'.
  4149         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4150         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4151         16  PB-I-AH-CALC-FLAG            PIC X.
  4152             88 PB-COMP-AH-PREM                  VALUE '?'.
  4153         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4154         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4155         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4156         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4157         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4158         16  PB-I-AH-ABBR                 PIC XXX.
  4159         16  PB-I-AH-INPUT-CD             PIC XXX.
  4160
  4161         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4162         16  PB-I-REIN-TABLE              PIC XXX.
  4163         16  PB-I-BUSINESS-TYPE           PIC 99.
  4164         16  PB-I-INDV-GRP-CD             PIC X.
  4165         16  PB-I-MORT-CODE.
  4166             20  PB-I-TABLE               PIC X.
  4167             20  PB-I-INTEREST            PIC XX.
  4168             20  PB-I-MORT-TYP            PIC X.
  4169         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4170         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4171         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4172         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  78
* EL050.cbl
  4173         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4174         16  PB-I-SIG-SW                  PIC X.
  4175             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4176         16  PB-I-RATE-CLASS              PIC XX.
  4177         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4178         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4179         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4180         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4181         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4182         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4183         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4184         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4185         16  PB-I-OB-FLAG                 PIC X.
  4186             88  PB-I-OB                      VALUE 'B'.
  4187             88  PB-I-SUMMARY                 VALUE 'Z'.
  4188         16  PB-I-ENTRY-STATUS            PIC X.
  4189             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4190                                              'M' '5' '9' '2'.
  4191             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4192             88  PB-I-POLICY-PENDING          VALUE '2'.
  4193             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4194             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4195             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4196             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4197             88  PB-I-REIN-ONLY               VALUE '9'.
  4198             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4199             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4200             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4201             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4202         16  PB-I-INT-CODE                PIC X.
  4203             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4204             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4205         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4206         16  PB-I-SOC-SEC-NO              PIC X(11).
  4207         16  PB-I-MEMBER-NO               PIC X(12).
  4208         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4209*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4210         16  PB-I-OLD-LOF                 PIC XXX.
  4211         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4212         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4213         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4214         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4215         16  PB-I-LIFE-INDICATOR          PIC X.
  4216             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4217         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4218         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4219                                          PIC S9(5)V99    COMP-3.
  4220         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4221             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4222             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4223         16  PB-I-1ST-PMT-DT              PIC XX.
  4224         16  PB-I-JOINT-INSURED.
  4225             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4226             20 PB-I-JOINT-FIRST-NAME.
  4227                24  PB-I-JOINT-FIRST-INIT PIC X.
  4228                24  FILLER                PIC X(9).
  4229             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4230*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  79
* EL050.cbl
  4231         16  PB-I-BENEFICIARY-NAME.
  4232             20  PB-I-BANK-NUMBER         PIC X(10).
  4233             20  FILLER                   PIC X(15).
  4234         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4235         16  PB-I-REFERENCE               PIC X(12).
  4236         16  FILLER REDEFINES PB-I-REFERENCE.
  4237             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4238             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4239             20  PB-I-CLP-STATE           PIC XX.
  4240         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4241             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4242             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4243             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4244         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4245         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4246         16  PB-I-RESIDENT-STATE          PIC XX.
  4247         16  PB-I-RATE-CODE               PIC X(4).
  4248         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4249         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4250         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4251         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4252         16  PB-I-BANK-NOCHRGB            PIC 99.
  4253         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4254         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4255
  4256     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4257         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4258             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4259         16  PB-C-CANCEL-ORIGIN           PIC X.
  4260             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4261         16  PB-C-LF-CANCEL-DT            PIC XX.
  4262         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4263         16  PB-C-LF-CALC-REQ             PIC X.
  4264             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4265         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4266         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4267         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4268             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4269         16  PB-C-AH-CANCEL-DT            PIC XX.
  4270         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4271         16  PB-C-AH-CALC-REQ             PIC X.
  4272             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4273         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4274         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4275         16  PB-C-LAST-NAME               PIC X(15).
  4276         16  PB-C-REFUND-SW               PIC X.
  4277             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4278             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4279         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4280         16  PB-C-PAYEE-CODE              PIC X(6).
  4281         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4282         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4283         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4284         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4285         16  PB-C-REFERENCE               PIC X(12).
  4286         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4287         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4288         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  80
* EL050.cbl
  4289         16  PB-C-CANCEL-REASON           PIC X.
  4290         16  PB-C-REF-INTERFACE-SW        PIC X.
  4291         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4292         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4293         16  FILLER                       PIC X(01).
  4294*        16  FILLER                       PIC X(18).
  4295         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4296*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4297         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4298         16  PB-CANCELED-CERT-DATA.
  4299             20  PB-CI-INSURED-NAME.
  4300                 24  PB-CI-LAST-NAME      PIC X(15).
  4301                 24  PB-CI-INITIALS       PIC XX.
  4302             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4303             20  PB-CI-INSURED-SEX        PIC X.
  4304             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4305             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4306             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4307             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4308             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4309             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4310             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4311             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4312             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4313             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4314             20  PB-CI-RATE-CLASS         PIC XX.
  4315             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4316             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4317             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4318             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4319             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4320             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4321             20  PB-CI-LF-ABBR            PIC X(3).
  4322             20  PB-CI-AH-ABBR            PIC X(3).
  4323             20  PB-CI-OB-FLAG            PIC X.
  4324                 88  PB-CI-OB                VALUE 'B'.
  4325             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4326                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4327                                           'M' '4' '5' '9' '2'.
  4328                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4329                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4330                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4331                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4332                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4333                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4334                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4335                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4336                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4337                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4338                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4339                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4340                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4341             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4342                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4343                                           'M' '4' '5' '9' '2'.
  4344                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4345                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4346                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  81
* EL050.cbl
  4347                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4348                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4349                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4350                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4351                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4352                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4353                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4354                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4355                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4356                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4357             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4358             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4359             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4360             20  PB-CI-MEMBER-NO          PIC X(12).
  4361             20  PB-CI-INT-CODE           PIC X.
  4362                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4363                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4364             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4365             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4366             20  PB-CI-COMP-EXCP-SW       PIC X.
  4367                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4368                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4369             20  PB-CI-ENTRY-STATUS       PIC X.
  4370             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4371             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4372             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4373             20  PB-CI-DEATH-DT           PIC XX.
  4374             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4375             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4376             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4377             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4378             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4379             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4380             20  PB-CI-ENTRY-DT              PIC XX.
  4381             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4382             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4383             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4384             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4385             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4386             20  PB-CI-OLD-LOF               PIC XXX.
  4387*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4388             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4389             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4390             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4391             20  PB-CI-INDV-GRP-CD           PIC X.
  4392             20  PB-CI-BENEFICIARY-NAME.
  4393                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4394                 24  FILLER                  PIC X(15).
  4395             20  PB-CI-NOTE-SW               PIC X.
  4396             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4397             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4398             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4399             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4400             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4401             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4402             20  PB-CI-FIRST-NAME            PIC X(10).
  4403             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4404
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  82
* EL050.cbl
  4405         16  FILLER                       PIC X(13).
  4406*032306  16  FILLER                       PIC X(27).
  4407*        16  FILLER                       PIC X(46).
  4408
  4409     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4410         16  FILLER                       PIC X(10).
  4411         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4412         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4413         16  PB-M-INSURED-MID-INIT        PIC X.
  4414         16  PB-M-INSURED-AGE             PIC 99.
  4415         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4416         16  PB-M-INSURED-SEX             PIC X.
  4417         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4418         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4419         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4420         16  PB-M-INSURED-CITY-STATE.
  4421             20  PB-M-INSURED-CITY        PIC X(28).
  4422             20  PB-M-INSURED-STATE       PIC XX.
  4423         16  PB-M-INSURED-ZIP-CODE.
  4424             20  PB-M-INSURED-ZIP-PRIME.
  4425                 24  PB-M-INSURED-ZIP-1   PIC X.
  4426                     88  PB-M-CANADIAN-POST-CODE
  4427                                             VALUE 'A' THRU 'Z'.
  4428                 24  FILLER               PIC X(4).
  4429             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4430         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4431                                        PB-M-INSURED-ZIP-CODE.
  4432             20  PM-M-INS-CAN-POST1       PIC XXX.
  4433             20  PM-M-INS-CAN-POST2       PIC XXX.
  4434             20  FILLER                   PIC XXX.
  4435         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4436         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4437         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4438         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4439         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4440         16  PB-M-CRED-BENE-CITYST.
  4441             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4442             20  PB-M-CRED-BENE-STATE     PIC XX.
  4443         16  FILLER                       PIC X(92).
  4444
  4445     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4446         16  FILLER                       PIC X(10).
  4447         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4448         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4449         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4450         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4451         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4452         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4453         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4454         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4455         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4456         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4457         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4458         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4459         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4460         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4461         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4462         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  83
* EL050.cbl
  4463         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4464         16  PB-ACCOUNT-NAME              PIC X(30).
  4465         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4466         16  PB-REFERENCE                 PIC X(12).
  4467         16  PB-B-RECEIVED-DT             PIC XX.
  4468         16  FILLER                       PIC X(234).
  4469
  4470     12  PB-RECORD-STATUS.
  4471         16  PB-CREDIT-SELECT-DT          PIC XX.
  4472         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4473         16  PB-BILLED-DT                 PIC XX.
  4474         16  PB-BILLING-STATUS            PIC X.
  4475             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4476             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4477             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4478         16  PB-RECORD-BILL               PIC X.
  4479             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4480             88  PB-RECORD-RETURNED           VALUE 'R'.
  4481             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4482             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4483             88  PB-OVERRIDE-AH               VALUE 'A'.
  4484             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4485         16  PB-BATCH-ENTRY               PIC X.
  4486             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4487             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4488             88  PB-REISSUED-CERT             VALUE 'E'.
  4489             88  PB-CASH-CERT                 VALUE 'C'.
  4490             88  PB-MONTHLY-CERT              VALUE 'M'.
  4491             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4492             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4493             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4494         16  PB-FORCE-CODE                PIC X.
  4495             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4496             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4497             88  PB-CANCEL-FORCE              VALUE '8'.
  4498             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4499             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4500             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4501             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4502             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4503             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4504             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4505             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4506         16  PB-FATAL-FLAG                PIC X.
  4507             88  PB-FATAL-ERRORS              VALUE 'X'.
  4508         16  PB-FORCE-ER-CD               PIC X.
  4509             88  PB-FORCE-ERRORS              VALUE 'F'.
  4510             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4511         16  PB-WARN-ER-CD                PIC X.
  4512             88  PB-WARNING-ERRORS            VALUE 'W'.
  4513         16  FILLER                       PIC X.
  4514         16  PB-OUT-BAL-CD                PIC X.
  4515             88  PB-OUT-OF-BAL                VALUE 'O'.
  4516         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4517         16  PB-AH-OVERRIDE-L1            PIC X.
  4518         16  PB-INPUT-DT                  PIC XX.
  4519         16  PB-INPUT-BY                  PIC X(4).
  4520         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  84
* EL050.cbl
  4521         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4522         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4523         16  PB-LF-EARNING-METHOD         PIC X.
  4524         16  PB-AH-EARNING-METHOD         PIC X.
  4525         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4526         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4527         16  PB-REIN-CD                   PIC XXX.
  4528         16  PB-LF-REFUND-TYPE            PIC X.
  4529         16  PB-AH-REFUND-TYPE            PIC X.
  4530         16  PB-ACCT-EFF-DT               PIC XX.
  4531         16  PB-ACCT-EXP-DT               PIC XX.
  4532         16  PB-COMPANY-ID                PIC X(3).
  4533         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4534         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4535         16  PB-SV-CARRIER                PIC X.
  4536         16  PB-SV-GROUPING               PIC X(6).
  4537         16  PB-SV-STATE                  PIC XX.
  4538         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4539         16  PB-GA-BILLING-INFO.
  4540             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4541                                          PIC XX.
  4542         16  PB-SV-REMIT-TO  REDEFINES
  4543             PB-GA-BILLING-INFO           PIC X(10).
  4544         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4545         16  PB-I-LOAN-OFFICER            PIC X(5).
  4546         16  PB-I-VIN                     PIC X(17).
  4547
  4548         16  FILLER                       PIC X(04).
  4549         16  IMNET-BYPASS-SW              PIC X.
  4550
  4551******************************************************************
  4552*                COMMON EDIT ERRORS                              *
  4553******************************************************************
  4554
  4555     12  PB-COMMON-ERRORS.
  4556         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4557                                           PIC S9(4)     COMP.
  4558
  4559******************************************************************
  4560
  4561* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4562*    COPY ELC50W1.
  4563******************************************************************
  4564*                                                                *
  4565*                                                                *
  4566*                             ELC50W1                            *
  4567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4568*                            VMOD=2.004                          *
  4569*                                                                *
  4570*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4571*                                                                *
  4572*                                                                *
  4573******************************************************************
  4574
  4575     12  WK-WORK-AREA.
  4576         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4577         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4578         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  85
* EL050.cbl
  4579         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4580         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4581         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4582         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4583         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4584         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4585         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4586         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4587         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4588         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4589         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4590         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4591         16  WK-CREDIT-EDIT-CONTROLS.
  4592             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4593             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4594             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4595             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4596             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4597             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4598         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4599         16  WK-SAVE-REIN-DATA.
  4600             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4601             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4602             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4603         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4604             88  ENTRY-FROM-EL6311       VALUE '6'.
  4605         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4606         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4607     12  WK-RECORD-ADDRESSES.
  4608         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4609         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4610         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4611         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4612         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4613         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4614         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4615         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4616     12  WK-OVER-SHORT-AREA.
  4617         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4618         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4619         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4620             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4621         16  FILLER                   PIC X(5) VALUE SPACES.
  4622
  4623*    COPY ELCEDITC.
  4624******************************************************************
  4625*                                                                *
  4626*                                                                *
  4627*                            ELCEDITC                            *
  4628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4629*                            VMOD=2.012                          *
  4630*                                                                *
  4631*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4632*                     EL6313, EL050 AND EL517.                   *
  4633*                                                                *
  4634******************************************************************
  4635******************************************************************
  4636*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  86
* EL050.cbl
  4637*
  4638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4639*-----------------------------------------------------------------
  4640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4641* EFFECTIVE    NUMBER
  4642*-----------------------------------------------------------------
  4643* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4644******************************************************************
  4645
  4646     12  EDIT-CRITERIA-DATA.
  4647         16  EC-CO-MONTH-END-DT       PIC XX.
  4648         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4649         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4650         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4651         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4652         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4653         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4654         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4655         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4656         16  EC-CO-REM-TERM-CALC      PIC X.
  4657               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4658               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4659               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4660               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4661
  4662         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4663               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4664               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4665               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4666               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4667               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4668               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4669               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4670               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4671               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4672               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4673
  4674         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4675               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4676               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4677               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4678               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4679               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4680               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4681               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4682               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4683
  4684         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4685                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4686                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4687
  4688         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4689                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4690                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4691                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4692                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4693                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4694                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  87
* EL050.cbl
  4695                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4696                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4697
  4698         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4699               88  EC-BR-REDUCING                   VALUE 'R'.
  4700               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4701
  4702         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4703         16  EC-BR-LF-DESC             PIC X(10).
  4704         16  EC-BR-AH-DESC             PIC X(10).
  4705         16  EC-BR-LF-COMMENT          PIC X(10).
  4706         16  EC-BR-AH-COMMENT          PIC X(10).
  4707
  4708         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4709               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4710               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4711               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4712               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4713
  4714         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4715               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4716               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4717               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4718               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4719
  4720         16  EC-BR-LF-REFUND-CALC      PIC X.
  4721                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4722                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4723                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4724                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4725                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4726                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4727                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4728
  4729         16  EC-BR-AH-REFUND-CALC      PIC X.
  4730                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4731                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4732                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4733                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4734                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4735                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4736                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4737                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4738
  4739         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4740                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4741                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4742                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4743
  4744         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4745                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4746                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4747                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4748
  4749         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4750         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4751         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4752         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  88
* EL050.cbl
  4753
  4754         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4755         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4756                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4757                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4758                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4759                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4760
  4761         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4762               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4763               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4764               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4765               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4766               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4767
  4768         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4769               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4770               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4771               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4772               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4773               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4774
  4775         16  EC-ST-LF-REFUND-CALC      PIC X.
  4776                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4777                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4778                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4779                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4780                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4781                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4782                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4783                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4784
  4785         16  EC-ST-AH-REFUND-CALC      PIC X.
  4786                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4787                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4788                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4789                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4790                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4791                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4792                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4793                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4794
  4795         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4796         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4797         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4798         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4799         16  EC-AM-EXPIRATION-DT       PIC XX.
  4800         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4801         16  EC-AM-CLASS-CD            PIC XX.
  4802         16  EC-AM-LF-DEVIATION        PIC XXX.
  4803         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4804         16  EC-AM-AH-DEVIATION        PIC XXX.
  4805         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4806         16  EC-AM-PHONE-NO            PIC X(10).
  4807
  4808         16  EC-AM-LF-REFUND-CALC      PIC X.
  4809                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4810                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  89
* EL050.cbl
  4811                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4812                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4813                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4814                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4815                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4816
  4817         16  EC-AM-AH-REFUND-CALC      PIC X.
  4818                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4819                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4820                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4821                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4822                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4823                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4824                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4825
  4826         16  EC-AM-BEN-I-G-CD          PIC X.
  4827                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4828                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4829                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4830
  4831         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4832         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4833         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4834         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4836         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4837         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4838         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4839         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4840
  4841         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4842         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4843         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4844         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4845         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4846         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4847         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4848         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4849         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4850         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4851         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4852         16  EC-RT-LF-NSP-ST           PIC XX.
  4853         16  EC-RT-AH-NSP-ST           PIC XX.
  4854         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4855         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4856
  4857         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4858             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4859                                             'M' '5' '9' '2'.
  4860             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4861             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4862             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4863             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4864             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4865             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4866             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4867             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4868             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  90
* EL050.cbl
  4869             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4870
  4871         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4872             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4873                                             'M' '5' '9' '2'.
  4874             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4875             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4876             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4877             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4878             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4879             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4880             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4881             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4882             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4883             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4884
  4885         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4886         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4887         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4888         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4889         16  EC-CM-DEATH-DT            PIC XX.
  4890
  4891*DMD CUSTOM CODING FIELDS BELOW
  4892*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4893         16  EC-BR-DMD-RATING-SW       PIC X.
  4894                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4895                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4896                 88  NO-DMD-RATING               VALUE 'N'.
  4897
  4898         16  EC-NEW-CERT               PIC X(11).
  4899         16  EC-NEW-STATE              PIC XX.
  4900         16  FILLER                    PIC X.
  4901*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4902         16  OVER-SHORT-EDIT-FIELDS.
  4903             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4904             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4905             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4906             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4907             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4908             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4909             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4910             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4911             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4912         16  FILLER                    PIC X(71).
  4913******************************************************************
  4914
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  91
* EL050.cbl
  4916*    COPY ELCDIFRD.
  4917******************************************************************
  4918*                                                                *
  4919*                                                                *
  4920*                            ELCDIFRD.                           *
  4921*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4922*                            VMOD=2.004                          *
  4923*                                                                *
  4924*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4925*                                                                *
  4926******************************************************************
  4927*
  4928  01  WS-DIFFERENCE-CALCULATION.
  4929        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4930        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4931        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4932        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4933        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4934        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4935        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4936        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4937        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4938        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4939        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4940
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  92
* EL050.cbl
  4942****************************************************************
  4943*
  4944* Copyright (c) 2007-2013 Dell Inc.
  4945* All rights reserved.
  4946*
  4947****************************************************************
  4948 01  DFHEIV.
  4949   02  DFHEIV0               PIC X(35).
  4950   02  DFHEIV1               PIC X(08).
  4951   02  DFHEIV2               PIC X(08).
  4952   02  DFHEIV3               PIC X(08).
  4953   02  DFHEIV4               PIC X(06).
  4954   02  DFHEIV5               PIC X(04).
  4955   02  DFHEIV6               PIC X(04).
  4956   02  DFHEIV7               PIC X(02).
  4957   02  DFHEIV8               PIC X(02).
  4958   02  DFHEIV9               PIC X(01).
  4959   02  DFHEIV10              PIC S9(7) COMP-3.
  4960   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4961   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4962   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4963   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4964   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4965   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4966   02  DFHEIV17              PIC X(04).
  4967   02  DFHEIV18              PIC X(04).
  4968   02  DFHEIV19              PIC X(04).
  4969   02  DFHEIV20              USAGE IS POINTER.
  4970   02  DFHEIV21              USAGE IS POINTER.
  4971   02  DFHEIV22              USAGE IS POINTER.
  4972   02  DFHEIV23              USAGE IS POINTER.
  4973   02  DFHEIV24              USAGE IS POINTER.
  4974   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4975   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4976   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4977   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4978   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4979   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4980   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4981   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4982   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4983   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4984   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4985   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4986   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4987   02  FILLER                PIC X(02).
  4988   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4989   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4990   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4991   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4992   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4993   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4994   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4995 LINKAGE  SECTION.
  4996*****************************************************************
  4997*                                                               *
  4998* Copyright (c) 2007-2013 Dell Inc.                             *
  4999* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  93
* EL050.cbl
  5000*                                                               *
  5001*****************************************************************
  5002 01  dfheiblk.
  5003     02  eibtime          pic s9(7) comp-3.
  5004     02  eibdate          pic s9(7) comp-3.
  5005     02  eibtrnid         pic x(4).
  5006     02  eibtaskn         pic s9(7) comp-3.
  5007     02  eibtrmid         pic x(4).
  5008     02  dfheigdi         pic s9(4) comp.
  5009     02  eibcposn         pic s9(4) comp.
  5010     02  eibcalen         pic s9(4) comp.
  5011     02  eibaid           pic x(1).
  5012     02  eibfiller1       pic x(1).
  5013     02  eibfn            pic x(2).
  5014     02  eibfiller2       pic x(2).
  5015     02  eibrcode         pic x(6).
  5016     02  eibfiller3       pic x(2).
  5017     02  eibds            pic x(8).
  5018     02  eibreqid         pic x(8).
  5019     02  eibrsrce         pic x(8).
  5020     02  eibsync          pic x(1).
  5021     02  eibfree          pic x(1).
  5022     02  eibrecv          pic x(1).
  5023     02  eibsend          pic x(1).
  5024     02  eibatt           pic x(1).
  5025     02  eibeoc           pic x(1).
  5026     02  eibfmh           pic x(1).
  5027     02  eibcompl         pic x(1).
  5028     02  eibsig           pic x(1).
  5029     02  eibconf          pic x(1).
  5030     02  eiberr           pic x(1).
  5031     02  eibrldbk         pic x(1).
  5032     02  eiberrcd         pic x(4).
  5033     02  eibsynrb         pic x(1).
  5034     02  eibnodat         pic x(1).
  5035     02  eibfiller5       pic x(2).
  5036     02  eibresp          pic s9(8) comp.
  5037     02  eibresp2         pic s9(8) comp.
  5038     02  dfheigdj         pic s9(4) comp.
  5039     02  dfheigdk         pic s9(4) comp.
  5040
  5041 01  DFHCOMMAREA                   PIC X(1036).
  5042
  5043*01 PARMLIST .
  5044*    02  FILLER                    PIC S9(8)   COMP.
  5045*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5046*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5047*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5048*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5049*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5050*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5051*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5052
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  94
* EL050.cbl
  5054*    COPY ELCCNTL.
  5055******************************************************************
  5056*                                                                *
  5057*                                                                *
  5058*                            ELCCNTL.                            *
  5059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5060*                            VMOD=2.059                          *
  5061*                                                                *
  5062*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5063*                                                                *
  5064*   FILE TYPE = VSAM,KSDS                                        *
  5065*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5066*                                                                *
  5067*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5068*       ALTERNATE INDEX = NONE                                   *
  5069*                                                                *
  5070*   LOG = YES                                                    *
  5071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5072******************************************************************
  5073*                   C H A N G E   L O G
  5074*
  5075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5076*-----------------------------------------------------------------
  5077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5078* EFFECTIVE    NUMBER
  5079*-----------------------------------------------------------------
  5080* 082503                   PEMA  ADD BENEFIT GROUP
  5081* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5082* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5083* 092705    2005050300006  PEMA  ADD SPP LEASES
  5084* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5085* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5086* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5087* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5088* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5089* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5090* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5091* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5092* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5093* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5094******************************************************************
  5095*
  5096 01  CONTROL-FILE.
  5097     12  CF-RECORD-ID                       PIC XX.
  5098         88  VALID-CF-ID                        VALUE 'CF'.
  5099
  5100     12  CF-CONTROL-PRIMARY.
  5101         16  CF-COMPANY-ID                  PIC XXX.
  5102         16  CF-RECORD-TYPE                 PIC X.
  5103             88  CF-COMPANY-MASTER              VALUE '1'.
  5104             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5105             88  CF-STATE-MASTER                VALUE '3'.
  5106             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5107             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5108             88  CF-CARRIER-MASTER              VALUE '6'.
  5109             88  CF-MORTALITY-MASTER            VALUE '7'.
  5110             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5111             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  95
* EL050.cbl
  5112             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5113             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5114             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5115             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5116             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5117             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5118             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5119             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5120             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5121         16  CF-ACCESS-CD-GENL              PIC X(4).
  5122         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5123             20  CF-PROCESSOR               PIC X(4).
  5124         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5125             20  CF-STATE-CODE              PIC XX.
  5126             20  FILLER                     PIC XX.
  5127         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5128             20  FILLER                     PIC XX.
  5129             20  CF-HI-BEN-IN-REC           PIC XX.
  5130         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5131             20  FILLER                     PIC XXX.
  5132             20  CF-CARRIER-CNTL            PIC X.
  5133         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5134             20  FILLER                     PIC XX.
  5135             20  CF-HI-TYPE-IN-REC          PIC 99.
  5136         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5137             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5138                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5139             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5140             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5141         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5142             20  FILLER                     PIC X.
  5143             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5144         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5145             20  FILLER                     PIC XX.
  5146             20  CF-MORTGAGE-PLAN           PIC XX.
  5147         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5148
  5149     12  CF-LAST-MAINT-DT                   PIC XX.
  5150     12  CF-LAST-MAINT-BY                   PIC X(4).
  5151     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5152
  5153     12  CF-RECORD-BODY                     PIC X(728).
  5154
  5155
  5156****************************************************************
  5157*             COMPANY MASTER RECORD                            *
  5158****************************************************************
  5159
  5160     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5161         16  CF-COMPANY-ADDRESS.
  5162             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5163             20  CF-CL-IN-CARE-OF           PIC X(30).
  5164             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5165             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5166             20  CF-CL-CITY-STATE           PIC X(30).
  5167             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5168             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5169         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  96
* EL050.cbl
  5170         16  CF-COMPANY-PASSWORD            PIC X(8).
  5171         16  CF-SECURITY-OPTION             PIC X.
  5172             88  ALL-SECURITY                   VALUE '1'.
  5173             88  COMPANY-VERIFY                 VALUE '2'.
  5174             88  PROCESSOR-VERIFY               VALUE '3'.
  5175             88  NO-SECURITY                    VALUE '4'.
  5176             88  ALL-BUT-TERM                   VALUE '5'.
  5177         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5178             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5179         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5180             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5181         16  CF-INFORCE-LOCATION            PIC X.
  5182             88  CERTS-ARE-ONLINE               VALUE '1'.
  5183             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5184             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5185         16  CF-LOWER-CASE-LETTERS          PIC X.
  5186         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5187             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5188             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5189             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5190             88  CF-ACCNT-CNTL                  VALUE '3'.
  5191             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5192
  5193         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5194         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5195
  5196         16  CF-LGX-CREDIT-USER             PIC X.
  5197             88  CO-IS-NOT-USER                 VALUE 'N'.
  5198             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5199
  5200         16 CF-CREDIT-CALC-CODES.
  5201             20  CF-CR-REM-TERM-CALC PIC X.
  5202               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5203               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5204               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5205               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5206               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5207               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5208               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5209             20  CF-CR-R78-METHOD           PIC X.
  5210               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5211               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5212
  5213         16  CF-CLAIM-CONTROL-COUNTS.
  5214             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5215                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5216
  5217             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5218                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5219
  5220             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5221                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5222
  5223             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5224                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5225
  5226         16  CF-CURRENT-MONTH-END           PIC XX.
  5227
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  97
* EL050.cbl
  5228         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5229             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5230             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5231             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5232             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5233                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5234                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5235             20  CF-CO-PREM-REJECT-SW       PIC X.
  5236                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5237                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5238             20  CF-CO-REF-REJECT-SW        PIC X.
  5239                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5240                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5241
  5242         16  CF-CO-REPORTING-DT             PIC XX.
  5243         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5244         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5245           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5246           88  CF-CO-MONTH-END                  VALUE '1'.
  5247
  5248         16  CF-LGX-CLAIM-USER              PIC X.
  5249             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5250             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5251
  5252         16  CF-CREDIT-EDIT-CONTROLS.
  5253             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5254             20  CF-MIN-AGE                 PIC 99.
  5255             20  CF-DEFAULT-AGE             PIC 99.
  5256             20  CF-MIN-TERM                PIC S999      COMP-3.
  5257             20  CF-MAX-TERM                PIC S999      COMP-3.
  5258             20  CF-DEFAULT-SEX             PIC X.
  5259             20  CF-JOINT-AGE-INPUT         PIC X.
  5260                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5261             20  CF-BIRTH-DATE-INPUT        PIC X.
  5262                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5263             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5264                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5265                 88  CF-ZERO-CARRIER            VALUE '1'.
  5266                 88  CF-ZERO-GROUPING           VALUE '2'.
  5267                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5268             20  CF-EDIT-SW                 PIC X.
  5269                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5270             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5271             20  CF-CR-PR-METHOD            PIC X.
  5272               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5273               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5274             20  FILLER                     PIC X.
  5275
  5276         16  CF-CREDIT-MISC-CONTROLS.
  5277             20  CF-REIN-TABLE-SW           PIC X.
  5278                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5279             20  CF-COMP-TABLE-SW           PIC X.
  5280                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5281             20  CF-EXPERIENCE-RETENTION-AGE
  5282                                            PIC S9        COMP-3.
  5283             20  CF-CONVERSION-DT           PIC XX.
  5284             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5285             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  98
* EL050.cbl
  5286                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5287                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5288
  5289             20  CF-CR-CHECK-NO-CONTROL.
  5290                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5291                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5292                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5293                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5294                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5295                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5296
  5297                 24  CF-CR-CHECK-COUNT       REDEFINES
  5298                     CF-CR-CHECK-COUNTER      PIC X(4).
  5299
  5300                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5301                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5302
  5303                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5304                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5305                 24  CF-MAIL-PROCESSING       PIC X.
  5306                     88  MAIL-PROCESSING          VALUE 'Y'.
  5307
  5308         16  CF-MISC-SYSTEM-CONTROL.
  5309             20  CF-SYSTEM-C                 PIC X.
  5310                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5311             20  CF-SYSTEM-D                 PIC X.
  5312                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5313             20  CF-SOC-SEC-NO-SW            PIC X.
  5314                 88  SOC-SEC-NO-USED             VALUE '1'.
  5315             20  CF-MEMBER-NO-SW             PIC X.
  5316                 88  MEMBER-NO-USED              VALUE '1'.
  5317             20  CF-TAX-ID-NUMBER            PIC X(11).
  5318             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5319             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5320                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5321                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5322                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5323                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5324             20  CF-SYSTEM-E                 PIC X.
  5325                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5326
  5327         16  CF-LGX-LIFE-USER               PIC X.
  5328             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5329             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5330
  5331         16  CF-CR-MONTH-END-DT             PIC XX.
  5332
  5333         16  CF-FILE-MAINT-DATES.
  5334             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5335                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5336             20  CF-LAST-BATCH       REDEFINES
  5337                 CF-LAST-BATCH-NO               PIC X(4).
  5338             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5339             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5340             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5341             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5342             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5343             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page  99
* EL050.cbl
  5344             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5345             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5346             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5347             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5348
  5349         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5350         16  FILLER                         PIC X.
  5351
  5352         16  CF-ALT-MORT-CODE               PIC X(4).
  5353         16  CF-MEMBER-CAPTION              PIC X(10).
  5354
  5355         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5356             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5357             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5358             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5359             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5360             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5361
  5362         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5363
  5364         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5365         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5366         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5367         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5368
  5369         16  CF-AH-OVERRIDE-L1              PIC X.
  5370         16  CF-AH-OVERRIDE-L2              PIC XX.
  5371         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5372         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5373
  5374         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5375         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5376
  5377         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5378         16  CF-AR-LAST-EL860-DT            PIC XX.
  5379         16  CF-MP-MONTH-END-DT             PIC XX.
  5380
  5381         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5382         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5383             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5384
  5385         16  CF-AR-MONTH-END-DT             PIC XX.
  5386
  5387         16  CF-CRDTCRD-USER                PIC X.
  5388             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5389             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5390
  5391         16  CF-CC-MONTH-END-DT             PIC XX.
  5392
  5393         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5394
  5395         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5396             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5397             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5398             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5399         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5400         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5401         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 100
* EL050.cbl
  5402         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5403             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5404             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5405         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5406         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5407         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5408             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5409         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5410
  5411         16  CF-CL-ZIP-CODE.
  5412             20  CF-CL-ZIP-PRIME.
  5413                 24  CF-CL-ZIP-1ST          PIC X.
  5414                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5415                 24  FILLER                 PIC X(4).
  5416             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5417         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5418             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5419             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5420             20  FILLER                     PIC XXX.
  5421
  5422         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5423         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5424         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5425         16  CF-CO-OPTION-START-DATE        PIC XX.
  5426         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5427           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5428                                                      '3' '4'.
  5429           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5430           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5431           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5432           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5433           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5434           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5435
  5436         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5437
  5438         16  CF-PAYMENT-APPROVAL-LEVELS.
  5439             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5440             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5441             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5442             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5443             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5444             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5445
  5446         16  CF-END-USER-REPORTING-USER     PIC X.
  5447             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5448             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5449
  5450         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5451             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5452             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5453
  5454         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5455
  5456         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5457         16  FILLER                         PIC X.
  5458
  5459         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 101
* EL050.cbl
  5460             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5461             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5462             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5463
  5464         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5465
  5466         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5467             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5468             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5469
  5470         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5471             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5472             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5473
  5474         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5475
  5476         16  CF-CO-ACH-ID-CODE              PIC  X.
  5477             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5478             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5479             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5480         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5481         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5482         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5483         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5484         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5485         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5486         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5487         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5488         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5489                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5490         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5491                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5492
  5493         16  CF-CO-OVER-SHORT.
  5494             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5495             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5496
  5497*         16  FILLER                         PIC X(102).
  5498         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5499             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5500             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5501
  5502         16  CF-AH-APPROVAL-DAYS.
  5503             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5504             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5505             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5506             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5507
  5508         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5509
  5510         16  CF-APPROV-LEV-5.
  5511             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5512             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5513             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5514
  5515         16  FILLER                         PIC X(68).
  5516****************************************************************
  5517*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 102
* EL050.cbl
  5518****************************************************************
  5519
  5520     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5521         16  CF-PROCESSOR-NAME              PIC X(30).
  5522         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5523         16  CF-PROCESSOR-TITLE             PIC X(26).
  5524         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5525                 88  MESSAGE-YES                VALUE 'Y'.
  5526                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5527
  5528*****************************************************
  5529****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5530****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5531****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5532****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5533*****************************************************
  5534
  5535         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5536             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5537             20  CF-APPLICATION-FORCE       PIC X.
  5538             20  CF-INDIVIDUAL-APP.
  5539                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5540                     28  CF-BROWSE-APP      PIC X.
  5541                     28  CF-UPDATE-APP      PIC X.
  5542
  5543         16  CF-CURRENT-TERM-ON             PIC X(4).
  5544         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5545             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5546             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5547             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5548             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5549             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5550             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5551             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5552         16  CF-PROCESSOR-CARRIER           PIC X.
  5553             88  NO-CARRIER-SECURITY            VALUE ' '.
  5554         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5555             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5556         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5557             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5558         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5559             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5560
  5561         16  CF-PROC-SYS-ACCESS-SW.
  5562             20  CF-PROC-CREDIT-CLAIMS-SW.
  5563                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5564                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5565                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5566                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5567             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5568                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5569                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5570             20  CF-PROC-LIFE-GNRLDGR-SW.
  5571                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5572                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5573                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5574                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5575             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 103
* EL050.cbl
  5576                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5577                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5578         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5579             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5580             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5581         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5582
  5583         16  CF-APPROVAL-LEVEL                  PIC X.
  5584             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5585             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5586             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5587             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5588             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5589
  5590         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5591
  5592         16  CF-LANGUAGE-TYPE                   PIC X.
  5593             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5594             88  CF-LANG-IS-FR                      VALUE 'F'.
  5595
  5596         16  CF-CSR-IND                         PIC X.
  5597         16  FILLER                             PIC X(239).
  5598
  5599****************************************************************
  5600*             PROCESSOR/REMINDERS RECORD                       *
  5601****************************************************************
  5602
  5603     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5604         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5605             20  CF-START-REMIND-DT         PIC XX.
  5606             20  CF-END-REMIND-DT           PIC XX.
  5607             20  CF-REMINDER-TEXT           PIC X(50).
  5608         16  FILLER                         PIC X(296).
  5609
  5610
  5611****************************************************************
  5612*             STATE MASTER RECORD                              *
  5613****************************************************************
  5614
  5615     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5616         16  CF-STATE-ABBREVIATION          PIC XX.
  5617         16  CF-STATE-NAME                  PIC X(25).
  5618         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5619         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5620             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5621             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5622             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5623             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5624                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5625                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5626             20  CF-ST-PREM-REJECT-SW       PIC X.
  5627                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5628                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5629             20  CF-ST-REF-REJECT-SW        PIC X.
  5630                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5631                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5632         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5633         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 104
* EL050.cbl
  5634         16  CF-ST-REFUND-RULES.
  5635             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5636             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5637             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5638         16  CF-ST-FST-PMT-EXTENSION.
  5639             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5640             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5641                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5642                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5643                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5644                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5645         16  CF-ST-STATE-CALL.
  5646             20  CF-ST-CALL-UNEARNED        PIC X.
  5647             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5648             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5649         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5650             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5651             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5652         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5653         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5654         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5655         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5656         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5657         16  FILLER                         PIC X.
  5658         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5659             20  CF-ST-BENEFIT-CD           PIC XX.
  5660             20  CF-ST-BENEFIT-KIND         PIC X.
  5661                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5662                 88  CF-ST-AH-KIND              VALUE 'A'.
  5663             20  CF-ST-REM-TERM-CALC        PIC X.
  5664                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5665                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5666                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5667                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5668                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5669                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5670                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5671                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5672
  5673             20  CF-ST-REFUND-CALC          PIC X.
  5674                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5675                 88  ST-REFD-BY-R78             VALUE '1'.
  5676                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5677                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5678                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5679                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5680                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5681                 88  ST-REFD-UTAH               VALUE '7'.
  5682                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5683                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5684                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5685
  5686             20  CF-ST-EARNING-CALC         PIC X.
  5687                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5688                 88  ST-EARN-BY-R78             VALUE '1'.
  5689                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5690                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5691                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 105
* EL050.cbl
  5692                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5693                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5694                 88  ST-EARN-MEAN               VALUE '8'.
  5695                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5696
  5697             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5698                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5699                 88  ST-OVRD-BY-R78             VALUE '1'.
  5700                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5701                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5702                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5703                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5704                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5705                 88  ST-OVRD-MEAN               VALUE '8'.
  5706                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5707             20  cf-st-extra-periods        pic 9.
  5708*            20  FILLER                     PIC X.
  5709
  5710         16  CF-ST-COMMISSION-CAPS.
  5711             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5712             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5713             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5714             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5715         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5716                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5717
  5718         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5719
  5720         16  CF-ST-STATUTORY-INTEREST.
  5721             20  CF-ST-STAT-DATE-FROM       PIC X.
  5722                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5723                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5724             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5725             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5726             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5727             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5728             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5729
  5730         16  CF-ST-OVER-SHORT.
  5731             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5732             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5733
  5734         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5735
  5736         16  CF-ST-RT-CALC                  PIC X.
  5737
  5738         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5739         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5740         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5741         16  CF-ST-RF-LR-CALC               PIC X.
  5742         16  CF-ST-RF-LL-CALC               PIC X.
  5743         16  CF-ST-RF-LN-CALC               PIC X.
  5744         16  CF-ST-RF-AH-CALC               PIC X.
  5745         16  CF-ST-RF-CP-CALC               PIC X.
  5746*        16  FILLER                         PIC X(206).
  5747*CIDMOD         16  FILLER                         PIC X(192).
  5748         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5749             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 106
* EL050.cbl
  5750         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5751         16  CF-ST-VFY-2ND-BENE             PIC X.
  5752         16  CF-ST-CAUSAL-STATE             PIC X.
  5753         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5754         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5755         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5756             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5757         16  CF-ST-NET-ONLY-STATE           PIC X.
  5758             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5759         16  FILLER                         PIC X(181).
  5760
  5761****************************************************************
  5762*             BENEFIT MASTER RECORD                            *
  5763****************************************************************
  5764
  5765     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5766         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5767             20  CF-BENEFIT-CODE            PIC XX.
  5768             20  CF-BENEFIT-NUMERIC  REDEFINES
  5769                 CF-BENEFIT-CODE            PIC XX.
  5770             20  CF-BENEFIT-ALPHA           PIC XXX.
  5771             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5772             20  CF-BENEFIT-COMMENT         PIC X(10).
  5773
  5774             20  CF-LF-COVERAGE-TYPE        PIC X.
  5775                 88  CF-REDUCING                VALUE 'R'.
  5776                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5777
  5778             20  CF-SPECIAL-CALC-CD         PIC X.
  5779                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5780                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5781                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5782                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5783                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5784                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5785                 88  CF-FARM-PLAN               VALUE 'F'.
  5786                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5787                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5788                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5789                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5790                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5791                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5792                 88  CF-PRUDENTIAL              VALUE 'P'.
  5793                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5794                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5795                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5796                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5797                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5798                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5799
  5800             20  CF-JOINT-INDICATOR         PIC X.
  5801                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5802
  5803*            20  FILLER                     PIC X(12).
  5804             20  cf-maximum-benefits        pic s999 comp-3.
  5805             20  FILLER                     PIC X(09).
  5806             20  CF-BENEFIT-CATEGORY        PIC X.
  5807             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 107
* EL050.cbl
  5808
  5809             20  CF-CO-REM-TERM-CALC        PIC X.
  5810                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5811                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5812                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5813                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5814                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5815
  5816             20  CF-CO-EARNINGS-CALC        PIC X.
  5817                 88  CO-EARN-BY-R78             VALUE '1'.
  5818                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5819                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5820                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5821                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5822                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5823                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5824                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5825
  5826             20  CF-CO-REFUND-CALC          PIC X.
  5827                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5828                 88  CO-REFD-BY-R78             VALUE '1'.
  5829                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5830                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5831                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5832                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5833                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5834                 88  CO-REFD-MEAN               VALUE '8'.
  5835                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5836                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5837                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5838
  5839             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5840                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5841                 88  CO-OVRD-BY-R78             VALUE '1'.
  5842                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5843                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5844                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5845                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5846                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5847                 88  CO-OVRD-MEAN               VALUE '8'.
  5848                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5849
  5850             20  CF-CO-BEN-I-G-CD           PIC X.
  5851                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5852                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5853                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5854
  5855         16  FILLER                         PIC X(304).
  5856
  5857
  5858****************************************************************
  5859*             CARRIER MASTER RECORD                            *
  5860****************************************************************
  5861
  5862     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5863         16  CF-ADDRESS-DATA.
  5864             20  CF-MAIL-TO-NAME            PIC X(30).
  5865             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 108
* EL050.cbl
  5866             20  CF-ADDRESS-LINE-1          PIC X(30).
  5867             20  CF-ADDRESS-LINE-2          PIC X(30).
  5868             20  CF-CITY-STATE              PIC X(30).
  5869             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5870             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5871
  5872         16  CF-CLAIM-NO-CONTROL.
  5873             20  CF-CLAIM-NO-METHOD         PIC X.
  5874                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5875                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5876                 88  CLAIM-NO-SEQ               VALUE '3'.
  5877                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5878             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5879                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5880                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5881                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5882
  5883         16  CF-CHECK-NO-CONTROL.
  5884             20  CF-CHECK-NO-METHOD         PIC X.
  5885                 88  CHECK-NO-MANUAL            VALUE '1'.
  5886                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5887                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5888                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5889             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5890                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5891
  5892         16  CF-DOMICILE-STATE              PIC XX.
  5893
  5894         16  CF-EXPENSE-CONTROLS.
  5895             20  CF-EXPENSE-METHOD          PIC X.
  5896                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5897                 88  DOLLARS-PER-PMT            VALUE '2'.
  5898                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5899                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5900             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5901             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5902
  5903         16  CF-CORRESPONDENCE-CONTROL.
  5904             20  CF-LETTER-RESEND-OPT       PIC X.
  5905                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5906                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5907             20  FILLER                     PIC X(4).
  5908
  5909         16  CF-RESERVE-CONTROLS.
  5910             20  CF-MANUAL-SW               PIC X.
  5911                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5912             20  CF-FUTURE-SW               PIC X.
  5913                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5914             20  CF-PTC-SW                  PIC X.
  5915                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5916             20  CF-IBNR-SW                 PIC X.
  5917                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5918             20  CF-PTC-LF-SW               PIC X.
  5919                 88  CF-LF-PTC-USED             VALUE '1'.
  5920             20  CF-CDT-ACCESS-METHOD       PIC X.
  5921                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5922                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5923                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 109
* EL050.cbl
  5924             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5925
  5926         16  CF-CLAIM-CALC-METHOD           PIC X.
  5927             88  360-PLUS-MONTHS                VALUE '1'.
  5928             88  365-PLUS-MONTHS                VALUE '2'.
  5929             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5930             88  360-DAILY                      VALUE '4'.
  5931             88  365-DAILY                      VALUE '5'.
  5932
  5933         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5934         16  FILLER                         PIC X(11).
  5935
  5936         16  CF-LIMIT-AMOUNTS.
  5937             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5938             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5939             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5940             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5941             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5942             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5943             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5944             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5945             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5946             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5947
  5948         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5949         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5950         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5951
  5952         16  CF-ZIP-CODE.
  5953             20  CF-ZIP-PRIME.
  5954                 24  CF-ZIP-1ST             PIC X.
  5955                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5956                 24  FILLER                 PIC X(4).
  5957             20  CF-ZIP-PLUS4               PIC X(4).
  5958         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5959             20  CF-CAN-POSTAL-1            PIC XXX.
  5960             20  CF-CAN-POSTAL-2            PIC XXX.
  5961             20  FILLER                     PIC XXX.
  5962
  5963         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5964         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5965         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5966
  5967         16  CF-RATING-SWITCH               PIC X.
  5968             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5969             88  CF-NO-RATING                   VALUE 'N'.
  5970
  5971         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5972
  5973         16  CF-CARRIER-OVER-SHORT.
  5974             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5975             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5976
  5977         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5978         16  CF-SECPAY-SWITCH               PIC X.
  5979             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5980             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5981         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 110
* EL050.cbl
  5982         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5983         16  FILLER                         PIC X(444).
  5984*        16  FILLER                         PIC X(452).
  5985
  5986
  5987****************************************************************
  5988*             MORTALITY MASTER RECORD                          *
  5989****************************************************************
  5990
  5991     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5992         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5993                                INDEXED BY CF-MORT-NDX.
  5994             20  CF-MORT-TABLE              PIC X(5).
  5995             20  CF-MORT-TABLE-TYPE         PIC X.
  5996                 88  CF-MORT-JOINT              VALUE 'J'.
  5997                 88  CF-MORT-SINGLE             VALUE 'S'.
  5998                 88  CF-MORT-COMBINED           VALUE 'C'.
  5999                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6000                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6001             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6002             20  CF-MORT-AGE-METHOD         PIC XX.
  6003                 88  CF-AGE-LAST                VALUE 'AL'.
  6004                 88  CF-AGE-NEAR                VALUE 'AN'.
  6005             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6006             20  CF-MORT-ADJUSTMENT-DIRECTION
  6007                                            PIC X.
  6008                 88  CF-MINUS                   VALUE '-'.
  6009                 88  CF-PLUS                    VALUE '+'.
  6010             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6011             20  CF-MORT-JOINT-CODE         PIC X.
  6012                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6013             20  CF-MORT-PC-Q               PIC X.
  6014                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6015             20  CF-MORT-TABLE-CODE         PIC X(4).
  6016             20  CF-MORT-COMMENTS           PIC X(15).
  6017             20  FILLER                     PIC X(14).
  6018
  6019         16  FILLER                         PIC X(251).
  6020
  6021
  6022****************************************************************
  6023*             BUSSINESS TYPE MASTER RECORD                     *
  6024****************************************************************
  6025
  6026     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6027* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6028* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6029* AND RECORD 05 IS TYPES 81-99
  6030         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6031             20  CF-BUSINESS-TITLE          PIC  X(19).
  6032             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6033                                            PIC S9V9(4) COMP-3.
  6034             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6035             20  FILLER                     PIC  X.
  6036         16  FILLER                         PIC  X(248).
  6037
  6038
  6039****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 111
* EL050.cbl
  6040*             TERMINAL MASTER RECORD                           *
  6041****************************************************************
  6042
  6043     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6044
  6045         16  CF-COMPANY-TERMINALS.
  6046             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6047                                  PIC X(4).
  6048         16  FILLER               PIC X(248).
  6049
  6050
  6051****************************************************************
  6052*             LIFE EDIT MASTER RECORD                          *
  6053****************************************************************
  6054
  6055     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6056         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6057             20  CF-LIFE-CODE-IN            PIC XX.
  6058             20  CF-LIFE-CODE-OUT           PIC XX.
  6059         16  FILLER                         PIC X(248).
  6060
  6061
  6062****************************************************************
  6063*             AH EDIT MASTER RECORD                            *
  6064****************************************************************
  6065
  6066     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6067         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6068             20  CF-AH-CODE-IN              PIC XXX.
  6069             20  CF-AH-CODE-OUT             PIC XX.
  6070         16  FILLER                         PIC X(248).
  6071
  6072
  6073****************************************************************
  6074*             CREDIBILITY TABLES                               *
  6075****************************************************************
  6076
  6077     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6078         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6079                             INDEXED BY CF-CRDB-NDX.
  6080             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6081             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6082             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6083         16  FILLER                         PIC  X(332).
  6084
  6085
  6086****************************************************************
  6087*             REPORT CUSTOMIZATION RECORD                      *
  6088****************************************************************
  6089
  6090     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6091         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6092             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6093             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6094             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6095**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6096****       A T-TRANSFER.                                   ****
  6097             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 112
* EL050.cbl
  6098
  6099         16  FILLER                         PIC XX.
  6100
  6101         16  CF-CARRIER-CNTL-OPT.
  6102             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6103                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6104                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6105             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6106                                            PIC X.
  6107         16  CF-GROUP-CNTL-OPT.
  6108             20  CF-GROUP-OPT-SEQ           PIC 9.
  6109                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6110                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6111             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6112                                            PIC X(6).
  6113         16  CF-STATE-CNTL-OPT.
  6114             20  CF-STATE-OPT-SEQ           PIC 9.
  6115                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6116                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6117             20  CF-STATE-SELECT OCCURS 3 TIMES
  6118                                            PIC XX.
  6119         16  CF-ACCOUNT-CNTL-OPT.
  6120             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6121                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6123             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-BUS-TYP-CNTL-OPT.
  6126             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6127                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6128                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6129             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6130                                            PIC XX.
  6131         16  CF-LF-TYP-CNTL-OPT.
  6132             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6133                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6134                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6135             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6136                                            PIC XX.
  6137         16  CF-AH-TYP-CNTL-OPT.
  6138             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6139                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6140                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6141             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6142                                            PIC XX.
  6143         16  CF-REPTCD1-CNTL-OPT.
  6144             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6145                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6146                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6147             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-REPTCD2-CNTL-OPT.
  6150             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6151                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6152                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6153             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 113
* EL050.cbl
  6156             20  CF-USER1-OPT-SEQ           PIC 9.
  6157                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6159             20  CF-USER1-SELECT OCCURS 3 TIMES
  6160                                            PIC X(10).
  6161         16  CF-USER2-CNTL-OPT.
  6162             20  CF-USER2-OPT-SEQ           PIC 9.
  6163                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6164                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6165             20  CF-USER2-SELECT OCCURS 3 TIMES
  6166                                            PIC X(10).
  6167         16  CF-USER3-CNTL-OPT.
  6168             20  CF-USER3-OPT-SEQ           PIC 9.
  6169                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6170                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6171             20  CF-USER3-SELECT OCCURS 3 TIMES
  6172                                            PIC X(10).
  6173         16  CF-USER4-CNTL-OPT.
  6174             20  CF-USER4-OPT-SEQ           PIC 9.
  6175                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6176                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6177             20  CF-USER4-SELECT OCCURS 3 TIMES
  6178                                            PIC X(10).
  6179         16  CF-USER5-CNTL-OPT.
  6180             20  CF-USER5-OPT-SEQ           PIC 9.
  6181                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6182                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6183             20  CF-USER5-SELECT OCCURS 3 TIMES
  6184                                            PIC X(10).
  6185         16  CF-REINS-CNTL-OPT.
  6186             20  CF-REINS-OPT-SEQ           PIC 9.
  6187                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6188                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6189             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6190                 24  CF-REINS-PRIME         PIC XXX.
  6191                 24  CF-REINS-SUB           PIC XXX.
  6192
  6193         16  CF-AGENT-CNTL-OPT.
  6194             20  CF-AGENT-OPT-SEQ           PIC 9.
  6195                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6196                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6197             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6198                                            PIC X(10).
  6199
  6200         16  FILLER                         PIC X(43).
  6201
  6202         16  CF-LOSS-RATIO-SELECT.
  6203             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6204             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6205         16  CF-ENTRY-DATE-SELECT.
  6206             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6207             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6208         16  CF-EFFECTIVE-DATE-SELECT.
  6209             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6210             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6211
  6212         16  CF-EXCEPTION-LIST-IND          PIC X.
  6213             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 114
* EL050.cbl
  6214
  6215         16  FILLER                         PIC X(318).
  6216
  6217****************************************************************
  6218*                  EXCEPTION REPORTING RECORD                  *
  6219****************************************************************
  6220
  6221     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6222         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6223             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6224
  6225         16  CF-COMBINED-LIFE-AH-OPT.
  6226             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6227             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6228             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6229             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6230
  6231         16  CF-LIFE-OPT.
  6232             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6233             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6234             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6235             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6236             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6237             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6238             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6239             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6240             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6241             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6242
  6243         16  CF-AH-OPT.
  6244             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6245             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6246             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6247             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6248             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6249             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6250             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6251             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6252             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6253             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6254
  6255         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6256             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6257             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6258             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6259
  6260         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6261
  6262         16  FILLER                         PIC X(673).
  6263
  6264
  6265****************************************************************
  6266*             MORTGAGE SYSTEM PLAN RECORD                      *
  6267****************************************************************
  6268
  6269     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6270         16  CF-PLAN-TYPE                   PIC X.
  6271             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 115
* EL050.cbl
  6272             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6273             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6274         16  CF-PLAN-ABBREV                 PIC XXX.
  6275         16  CF-PLAN-DESCRIPT               PIC X(10).
  6276         16  CF-PLAN-NOTES                  PIC X(20).
  6277         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6278         16  CF-PLAN-UNDERWRITING.
  6279             20  CF-PLAN-TERM-DATA.
  6280                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6281                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6282             20  CF-PLAN-AGE-DATA.
  6283                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6284                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6285                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6286             20  CF-PLAN-BENEFIT-DATA.
  6287                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6288                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6289                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6290                                            PIC S9(7)V99  COMP-3.
  6291         16  CF-PLAN-POLICY-FORMS.
  6292             20  CF-POLICY-FORM             PIC X(12).
  6293             20  CF-MASTER-APPLICATION      PIC X(12).
  6294             20  CF-MASTER-POLICY           PIC X(12).
  6295         16  CF-PLAN-RATING.
  6296             20  CF-RATE-CODE               PIC X(5).
  6297             20  CF-SEX-RATING              PIC X.
  6298                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6299                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6300             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6301             20  CF-SUB-STD-TYPE            PIC X.
  6302                 88  CF-PCT-OF-PREM            VALUE '1'.
  6303                 88  CF-PCT-OF-BENE            VALUE '2'.
  6304         16  CF-PLAN-PREM-TOLERANCES.
  6305             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6306             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6307         16  CF-PLAN-PYMT-TOLERANCES.
  6308             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6309             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6310         16  CF-PLAN-MISC-DATA.
  6311             20  FILLER                     PIC X.
  6312             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6313             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6314         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6315         16  CF-PLAN-IND-GRP                PIC X.
  6316             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6317                                                     '1'.
  6318             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6319                                                     '2'.
  6320         16  CF-MIB-SEARCH-SW               PIC X.
  6321             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6322             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6323             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6324             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6325         16  CF-ALPHA-SEARCH-SW             PIC X.
  6326             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6327             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6328             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6329             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 116
* EL050.cbl
  6330             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6331             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6332             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6333             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6334             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6335             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6336                                                     'A' 'B' 'C'
  6337                                                     'X' 'Y' 'Z'.
  6338         16  CF-EFF-DT-RULE-SW              PIC X.
  6339             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6340             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6341             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6342             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6343             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6344         16  FILLER                         PIC X(4).
  6345         16  CF-HEALTH-QUESTIONS            PIC X.
  6346             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6347         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6348         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6349         16  CF-PLAN-SNGL-JNT               PIC X.
  6350             88  CF-COMBINED-PLAN              VALUE 'C'.
  6351             88  CF-JNT-PLAN                   VALUE 'J'.
  6352             88  CF-SNGL-PLAN                  VALUE 'S'.
  6353         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6354         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6355         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6356         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6357         16  CF-RERATE-CNTL                 PIC  X.
  6358             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6359             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6360             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6361             88  CF-AUTO-RECALC                 VALUE '4'.
  6362         16  CF-BENEFIT-TYPE                PIC  X.
  6363             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6364             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6365         16  CF-POLICY-FEE                  PIC S999V99
  6366                                                    COMP-3.
  6367         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6368         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6369         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6370         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6371         16  FILLER                         PIC  X(32).
  6372         16  CF-TERMINATION-FORM            PIC  X(04).
  6373         16  FILLER                         PIC  X(08).
  6374         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6375                                                       COMP-3.
  6376         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6377         16  CF-ISSUE-LETTER                PIC  X(4).
  6378         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6379         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6380             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6381             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6382         16  CF-MP-REFUND-CALC              PIC X.
  6383             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6384             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6385             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6386             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6387             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 117
* EL050.cbl
  6388             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6389             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6390             88  CF-MP-REFD-MEAN                VALUE '8'.
  6391         16  CF-ALT-RATE-CODE               PIC  X(5).
  6392
  6393
  6394         16  FILLER                         PIC X(498).
  6395****************************************************************
  6396*             MORTGAGE COMPANY MASTER RECORD                   *
  6397****************************************************************
  6398
  6399     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6400         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6401         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6402             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6403             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6404             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6405             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6406             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6407
  6408         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6409         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6410         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6411         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6412         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6413
  6414         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6415             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6416         16  CF-MP-RECON-USE-IND            PIC X(1).
  6417             88  CF-MP-USE-RECON             VALUE 'Y'.
  6418         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6419             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6420         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6421             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6422             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6423         16  FILLER                         PIC X(1).
  6424         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6425             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6426         16  CF-MORTG-MIB-VERSION           PIC X.
  6427             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6428             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6429             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6430         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6431             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6432                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6433             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6434                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6435             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6436                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6437             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6438                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6439             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6440                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6441             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6442                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6443         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6444         16  FILLER                         PIC X(7).
  6445         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 118
* EL050.cbl
  6446             20  CF-MORTG-MIB-COMM          PIC X(5).
  6447             20  CF-MORTG-MIB-TERM          PIC X(5).
  6448         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6449             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6450         16  FILLER                         PIC X(03).
  6451         16  CF-MP-CHECK-NO-CONTROL.
  6452             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6453                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6454                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6455                                                ' ' LOW-VALUES.
  6456                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6457                                               VALUE '3'.
  6458         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6459         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6460         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6461             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6462                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6463             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6464                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6465             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6466                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6467             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6468                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6469             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6470                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6471             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6472                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6473         16  CF-MORTG-BILLING-AREA.
  6474             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6475                                            PIC X.
  6476         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6477         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6478         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6479         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6480             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6481             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6482         16  FILLER                         PIC X.
  6483         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6484             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6485             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6486         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6487         16  FILLER                         PIC X(8).
  6488         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6489         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6490         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6491         16  CF-ACH-COMPANY-ID.
  6492             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6493                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6494                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6495                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6496             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6497         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6498             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6499         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6500             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6501             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6502         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6503         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 119
* EL050.cbl
  6504         16  FILLER                         PIC X(536).
  6505
  6506****************************************************************
  6507*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6508****************************************************************
  6509
  6510     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6511         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6512             20  CF-FEMALE-HEIGHT.
  6513                 24  CF-FEMALE-FT           PIC 99.
  6514                 24  CF-FEMALE-IN           PIC 99.
  6515             20  CF-FEMALE-MIN-WT           PIC 999.
  6516             20  CF-FEMALE-MAX-WT           PIC 999.
  6517         16  FILLER                         PIC X(428).
  6518
  6519     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6520         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6521             20  CF-MALE-HEIGHT.
  6522                 24  CF-MALE-FT             PIC 99.
  6523                 24  CF-MALE-IN             PIC 99.
  6524             20  CF-MALE-MIN-WT             PIC 999.
  6525             20  CF-MALE-MAX-WT             PIC 999.
  6526         16  FILLER                         PIC X(428).
  6527******************************************************************
  6528*             AUTOMATIC ACTIVITY RECORD                          *
  6529******************************************************************
  6530     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6531         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6532             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6533             20  CF-SYS-LETTER-ID           PIC X(04).
  6534             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6535             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6536             20  CF-SYS-RESET-SW            PIC X(01).
  6537             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6538             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6539
  6540         16  FILLER                         PIC X(50).
  6541
  6542         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6543             20  CF-USER-ACTIVE-SW          PIC X(01).
  6544             20  CF-USER-LETTER-ID          PIC X(04).
  6545             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6546             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6547             20  CF-USER-RESET-SW           PIC X(01).
  6548             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6549             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6550             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6551
  6552         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 120
* EL050.cbl
  6554*    COPY ERCACCT.
  6555******************************************************************
  6556*                                                                *
  6557*                                                                *
  6558*                            ERCACCT                             *
  6559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6560*                            VMOD=2.031                          *
  6561*                                                                *
  6562*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6563*                                                                *
  6564*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6565*   VSAM ACCOUNT MASTER FILES.                                   *
  6566*                                                                *
  6567*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6568*                                                                *
  6569*   FILE TYPE = VSAM,KSDS                                        *
  6570*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6571*                                                                *
  6572*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6573*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6574*                                                                *
  6575*   LOG = NO                                                     *
  6576*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6577*                                                                *
  6578*                                                                *
  6579******************************************************************
  6580*                   C H A N G E   L O G
  6581*
  6582* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6583*-----------------------------------------------------------------
  6584*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6585* EFFECTIVE    NUMBER
  6586*-----------------------------------------------------------------
  6587* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6588* 092705    2005050300006  PEMA  ADD SPP LEASES
  6589* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6590* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6591* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6592* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6593* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6594* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6595******************************************************************
  6596
  6597 01  ACCOUNT-MASTER.
  6598     12  AM-RECORD-ID                      PIC XX.
  6599         88  VALID-AM-ID                      VALUE 'AM'.
  6600
  6601     12  AM-CONTROL-PRIMARY.
  6602         16  AM-COMPANY-CD                 PIC X.
  6603         16  AM-MSTR-CNTRL.
  6604             20  AM-CONTROL-A.
  6605                 24  AM-CARRIER            PIC X.
  6606                 24  AM-GROUPING.
  6607                     28 AM-GROUPING-PREFIX PIC XXX.
  6608                     28 AM-GROUPING-PRIME  PIC XXX.
  6609                 24  AM-STATE              PIC XX.
  6610                 24  AM-ACCOUNT.
  6611                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 121
* EL050.cbl
  6612                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6613             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6614                                           PIC X(19).
  6615             20  AM-CNTRL-B.
  6616                 24  AM-EXPIRATION-DT      PIC XX.
  6617                 24  FILLER                PIC X(4).
  6618             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6619                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6620
  6621     12  AM-CONTROL-BY-VAR-GRP.
  6622         16  AM-COMPANY-CD-A1              PIC X.
  6623         16  AM-VG-CARRIER                 PIC X.
  6624         16  AM-VG-GROUPING                PIC X(6).
  6625         16  AM-VG-STATE                   PIC XX.
  6626         16  AM-VG-ACCOUNT                 PIC X(10).
  6627         16  AM-VG-DATE.
  6628             20  AM-VG-EXPIRATION-DT       PIC XX.
  6629             20  FILLER                    PIC X(4).
  6630         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6631                                           PIC 9(11)      COMP-3.
  6632     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6633         16  FILLER                        PIC X(10).
  6634         16  AM-VG-KEY3.
  6635             20  AM-VG3-ACCOUNT            PIC X(10).
  6636             20  AM-VG3-EXP-DT             PIC XX.
  6637         16  FILLER                        PIC X(4).
  6638     12  AM-MAINT-INFORMATION.
  6639         16  AM-LAST-MAINT-DT              PIC XX.
  6640         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6641         16  AM-LAST-MAINT-USER            PIC X(4).
  6642         16  FILLER                        PIC XX.
  6643
  6644     12  AM-EFFECTIVE-DT                   PIC XX.
  6645     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6646
  6647     12  AM-PREV-DATES  COMP-3.
  6648         16  AM-PREV-EXP-DT                PIC 9(11).
  6649         16  AM-PREV-EFF-DT                PIC 9(11).
  6650
  6651     12  AM-REPORT-CODE-1                  PIC X(10).
  6652     12  AM-REPORT-CODE-2                  PIC X(10).
  6653
  6654     12  AM-CITY-CODE                      PIC X(4).
  6655     12  AM-COUNTY-PARISH                  PIC X(6).
  6656
  6657     12  AM-NAME                           PIC X(30).
  6658     12  AM-PERSON                         PIC X(30).
  6659     12  AM-ADDRS                          PIC X(30).
  6660     12  AM-CITY.
  6661         16  AM-ADDR-CITY                  PIC X(28).
  6662         16  AM-ADDR-STATE                 PIC XX.
  6663     12  AM-ZIP.
  6664         16  AM-ZIP-PRIME.
  6665             20  AM-ZIP-PRI-1ST            PIC X.
  6666                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6667             20  FILLER                    PIC X(4).
  6668         16  AM-ZIP-PLUS4                  PIC X(4).
  6669     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 122
* EL050.cbl
  6670         16  AM-CAN-POSTAL-1               PIC XXX.
  6671         16  AM-CAN-POSTAL-2               PIC XXX.
  6672         16  FILLER                        PIC XXX.
  6673     12  AM-TEL-NO.
  6674         16  AM-AREA-CODE                  PIC 999.
  6675         16  AM-TEL-PRE                    PIC 999.
  6676         16  AM-TEL-NBR                    PIC 9(4).
  6677     12  AM-TEL-LOC                        PIC X.
  6678         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6679         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6680
  6681     12  AM-COMM-STRUCTURE.
  6682         16  AM-DEFN-1.
  6683             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6684                 24  AM-AGT.
  6685                     28  AM-AGT-PREFIX     PIC X(4).
  6686                     28  AM-AGT-PRIME      PIC X(6).
  6687                 24  AM-COM-TYP            PIC X.
  6688                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6689                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6690                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6691                 24  AM-RECALC-LV-INDIC    PIC X.
  6692                 24  AM-RETRO-LV-INDIC     PIC X.
  6693                 24  AM-GL-CODES           PIC X.
  6694                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6695                 24  FILLER                PIC X(01).
  6696         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6697             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6698                 24  FILLER                PIC X(11).
  6699                 24  AM-L-COMA             PIC XXX.
  6700                 24  AM-J-COMA             PIC XXX.
  6701                 24  AM-A-COMA             PIC XXX.
  6702                 24  FILLER                PIC X(6).
  6703
  6704     12  AM-COMM-CHANGE-STATUS             PIC X.
  6705         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6706
  6707     12  AM-CSR-CODE                       PIC X(4).
  6708
  6709     12  AM-BILLING-STATUS                 PIC X.
  6710         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6711         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6712     12  AM-AUTO-REFUND-SW                 PIC X.
  6713         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6714         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6715     12  AM-GPCD                           PIC 99.
  6716     12  AM-IG                             PIC X.
  6717         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6718         88  AM-HAS-GROUP                     VALUE '2'.
  6719     12  AM-STATUS                         PIC X.
  6720         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6721         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6722         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6723         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6724         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6725         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6726         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6727         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 123
* EL050.cbl
  6728         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6729         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6730     12  AM-REMIT-TO                       PIC 99.
  6731     12  AM-ID-NO                          PIC X(11).
  6732
  6733     12  AM-CAL-TABLE                      PIC XX.
  6734     12  AM-LF-DEVIATION                   PIC XXX.
  6735     12  AM-AH-DEVIATION                   PIC XXX.
  6736     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6737     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6738     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6739     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6740     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6741     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6742
  6743     12  AM-USER-FIELDS.
  6744         16  AM-FLD-1                      PIC XX.
  6745         16  AM-FLD-2                      PIC XX.
  6746         16  AM-FLD-3                      PIC XX.
  6747         16  AM-FLD-4                      PIC XX.
  6748         16  AM-FLD-5                      PIC XX.
  6749
  6750     12  AM-1ST-PROD-DATE.
  6751         16  AM-1ST-PROD-YR                PIC XX.
  6752         16  AM-1ST-PROD-MO                PIC XX.
  6753         16  AM-1ST-PROD-DA                PIC XX.
  6754     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6755     12  AM-CERTS-PURGED-DATE.
  6756         16  AM-PUR-YR                     PIC XX.
  6757         16  AM-PUR-MO                     PIC XX.
  6758         16  AM-PUR-DA                     PIC XX.
  6759     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6760     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6761     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6762     12  AM-INACTIVE-DATE.
  6763         16  AM-INA-MO                     PIC 99.
  6764         16  AM-INA-DA                     PIC 99.
  6765         16  AM-INA-YR                     PIC 99.
  6766     12  AM-AR-HI-CERT-DATE                PIC XX.
  6767
  6768     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6769     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6770
  6771     12  AM-OB-PAYMENT-MODE                PIC X.
  6772         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6773         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6774         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6775         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6776
  6777     12  AM-AH-ONLY-INDICATOR              PIC X.
  6778         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6779         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6780
  6781     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6782
  6783     12  AM-OVER-SHORT.
  6784         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6785         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 124
* EL050.cbl
  6786
  6787     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6788     12  AM-DCC-CLP-STATE                  PIC XX.
  6789
  6790     12  AM-RECALC-COMM                    PIC X.
  6791     12  AM-RECALC-REIN                    PIC X.
  6792
  6793     12  AM-REI-TABLE                      PIC XXX.
  6794     12  AM-REI-ET-LF                      PIC X.
  6795     12  AM-REI-ET-AH                      PIC X.
  6796     12  AM-REI-PE-LF                      PIC X.
  6797     12  AM-REI-PE-AH                      PIC X.
  6798     12  AM-REI-PRT-ST                     PIC X.
  6799     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6800     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6801     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6802     12  AM-REI-GROUP-A                    PIC X(6).
  6803     12  AM-REI-MORT                       PIC X(4).
  6804     12  AM-REI-PRT-OW                     PIC X.
  6805     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6806     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6807     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6808     12  AM-REI-GROUP-B                    PIC X(6).
  6809
  6810     12  AM-TRUST-TYPE                     PIC X(2).
  6811
  6812     12  AM-EMPLOYER-STMT-USED             PIC X.
  6813     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6814
  6815     12  AM-STD-AH-TYPE                    PIC XX.
  6816     12  AM-EARN-METHODS.
  6817         16  AM-EARN-METHOD-R              PIC X.
  6818             88 AM-REF-RL-R78                 VALUE 'R'.
  6819             88 AM-REF-RL-PR                  VALUE 'P'.
  6820             88 AM-REF-RL-MEAN                VALUE 'M'.
  6821             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6822         16  AM-EARN-METHOD-L              PIC X.
  6823             88 AM-REF-LL-R78                 VALUE 'R'.
  6824             88 AM-REF-LL-PR                  VALUE 'P'.
  6825             88 AM-REF-LL-MEAN                VALUE 'M'.
  6826             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6827         16  AM-EARN-METHOD-A              PIC X.
  6828             88 AM-REF-AH-R78                 VALUE 'R'.
  6829             88 AM-REF-AH-PR                  VALUE 'P'.
  6830             88 AM-REF-AH-MEAN                VALUE 'M'.
  6831             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6832             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6833             88 AM-REF-AH-NET                 VALUE 'N'.
  6834
  6835     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6836     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6837     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6838
  6839     12  AM-RET-Y-N                        PIC X.
  6840     12  AM-RET-P-E                        PIC X.
  6841     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6842     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6843     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 125
* EL050.cbl
  6844     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6845         16  AM-POOL-PRIME                 PIC XXX.
  6846         16  AM-POOL-SUB                   PIC XXX.
  6847     12  AM-RETRO-EARNINGS.
  6848         16  AM-RET-EARN-R                 PIC X.
  6849         16  AM-RET-EARN-L                 PIC X.
  6850         16  AM-RET-EARN-A                 PIC X.
  6851     12  AM-RET-ST-TAX-USE                 PIC X.
  6852         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6853         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6854     12  AM-RETRO-BEG-EARNINGS.
  6855         16  AM-RET-BEG-EARN-R             PIC X.
  6856         16  AM-RET-BEG-EARN-L             PIC X.
  6857         16  AM-RET-BEG-EARN-A             PIC X.
  6858     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6859     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6860
  6861     12  AM-USER-SELECT-OPTIONS.
  6862         16  AM-USER-SELECT-1              PIC X(10).
  6863         16  AM-USER-SELECT-2              PIC X(10).
  6864         16  AM-USER-SELECT-3              PIC X(10).
  6865         16  AM-USER-SELECT-4              PIC X(10).
  6866         16  AM-USER-SELECT-5              PIC X(10).
  6867
  6868     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6869
  6870     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6871
  6872     12  AM-RPT045A-SWITCH                 PIC X.
  6873         88  RPT045A-OFF                   VALUE 'N'.
  6874
  6875     12  AM-INSURANCE-LIMITS.
  6876         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6877         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6878
  6879     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6880         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6881
  6882     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6883         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6884         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6885
  6886     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6887
  6888     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6889     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6890     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6891     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6892     12  AM-DCC-UEF-STATE                  PIC XX.
  6893     12  FILLER                            PIC XXX.
  6894     12  AM-REPORT-CODE-3                  PIC X(10).
  6895*    12  FILLER                            PIC X(22).
  6896
  6897     12  AM-RESERVE-DATE.
  6898         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6899         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6900         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6901
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 126
* EL050.cbl
  6902     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6903     12  AM-NOTIFICATION-TYPES.
  6904         16  AM-NOTIF-OF-LETTERS           PIC X.
  6905         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6906         16  AM-NOTIF-OF-REPORTS           PIC X.
  6907         16  AM-NOTIF-OF-STATUS            PIC X.
  6908
  6909     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6910         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6911         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6912         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6913         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6914
  6915     12  AM-BENEFIT-CONTROLS.
  6916         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6917             20  AM-BENEFIT-CODE           PIC XX.
  6918             20  AM-BENEFIT-TYPE           PIC X.
  6919             20  AM-BENEFIT-REVISION       PIC XXX.
  6920             20  AM-BENEFIT-REM-TERM       PIC X.
  6921             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6922             20  FILLER                    PIC XX.
  6923         16  FILLER                        PIC X(80).
  6924
  6925     12  AM-TRANSFER-DATA.
  6926         16  AM-TRANSFERRED-FROM.
  6927             20  AM-TRNFROM-CARRIER        PIC X.
  6928             20  AM-TRNFROM-GROUPING.
  6929                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6930                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6931             20  AM-TRNFROM-STATE          PIC XX.
  6932             20  AM-TRNFROM-ACCOUNT.
  6933                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6934                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6935             20  AM-TRNFROM-DTE            PIC XX.
  6936         16  AM-TRANSFERRED-TO.
  6937             20  AM-TRNTO-CARRIER          PIC X.
  6938             20  AM-TRNTO-GROUPING.
  6939                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6940                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6941             20  AM-TRNTO-STATE            PIC XX.
  6942             20  AM-TRNTO-ACCOUNT.
  6943                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6944                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6945             20  AM-TRNTO-DTE              PIC XX.
  6946         16  FILLER                        PIC X(10).
  6947
  6948     12  AM-SAVED-REMIT-TO                 PIC 99.
  6949
  6950     12  AM-COMM-STRUCTURE-SAVED.
  6951         16  AM-DEFN-1-SAVED.
  6952             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6953                 24  AM-AGT-SV             PIC X(10).
  6954                 24  AM-COM-TYP-SV         PIC X.
  6955                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6956                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6957                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6958                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6959                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 127
* EL050.cbl
  6960                 24  AM-GL-CODES-SV        PIC X.
  6961                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6962                 24  FILLER                PIC X.
  6963         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6964             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6965                 24  FILLER                PIC X(11).
  6966                 24  AM-L-COMA-SV          PIC XXX.
  6967                 24  AM-J-COMA-SV          PIC XXX.
  6968                 24  AM-A-COMA-SV          PIC XXX.
  6969                 24  FILLER                PIC X(6).
  6970
  6971     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6972         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6973            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6974            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6975            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6976
  6977     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6978     12  FILLER                            PIC X(120).
  6979
  6980     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6981         16  AM-CONTROL-NAME               PIC X(30).
  6982         16  AM-EXECUTIVE-ONE.
  6983             20  AM-EXEC1-NAME             PIC X(15).
  6984             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6985                                                          COMP-3.
  6986             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6987                                                          COMP-3.
  6988         16  AM-EXECUTIVE-TWO.
  6989             20  AM-EXEC2-NAME             PIC X(15).
  6990             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6991                                                          COMP-3.
  6992             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6993                                                          COMP-3.
  6994
  6995     12  AM-RETRO-ADDITIONAL-DATA.
  6996         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6997         16  AM-RETRO-PREM-P-E             PIC X.
  6998         16  AM-RETRO-CLMS-P-I             PIC X.
  6999         16  AM-RETRO-RET-BRACKET-LF.
  7000             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7001                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7002                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7003             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7004                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7005                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7006             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7007                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7008                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7009         16  AM-RETRO-RET-BRACKET-AH.
  7010             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7011                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7012                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7013                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7014             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7015                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7016                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7017             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 128
* EL050.cbl
  7018                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7019                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7020
  7021     12  AM-COMMENTS.
  7022         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7023
  7024     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7025         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7026         16  AM-FLI-BILLING-CODE           PIC X.
  7027         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7028         16  AM-FLI-UNITED-IDENT           PIC X.
  7029         16  AM-FLI-INTEREST-LOST-DATA.
  7030             20  AM-FLI-BANK-NO            PIC X(5).
  7031             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7032             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7033             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7034         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7035             20  AM-FLI-AGT                PIC X(9).
  7036             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7037             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7038         16  FILLER                        PIC X(102).
  7039
  7040     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7041         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7042             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7043             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7044             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7045             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7046             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7047         16  FILLER                          PIC X(10).
  7048******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 129
* EL050.cbl
  7050*    COPY ERCREIN.
  7051******************************************************************
  7052*                                                                *
  7053*                            ERCREIN                             *
  7054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7055*                            VMOD=2.010                          *
  7056*                                                                *
  7057*   ONLINE CREDIT SYSTEM                                         *
  7058*                                                                *
  7059*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7060*                                                                *
  7061*   FILE TYPE = VSAM,KSDS                                        *
  7062*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7063*                                                                *
  7064*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7065*       ALTERNATE PATH = NONE                                    *
  7066*                                                                *
  7067*   LOG = NO                                                     *
  7068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7069*                                                                *
  7070******************************************************************
  7071*                   C H A N G E   L O G
  7072*
  7073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7074*-----------------------------------------------------------------
  7075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7076* EFFECTIVE    NUMBER
  7077*-----------------------------------------------------------------
  7078* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7079* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7080******************************************************************
  7081 01  REINSURANCE-RECORD.
  7082     12  RE-RECORD-ID                      PIC XX.
  7083         88  VALID-RE-ID                      VALUE 'RE'.
  7084
  7085     12  RE-CONTROL-PRIMARY.
  7086         16  RE-COMPANY-CD                 PIC X.
  7087         16  RE-KEY.
  7088             20  RE-CODE                   PIC X.
  7089                 88  RE-TABLE-RECORD          VALUE 'A'.
  7090                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7091             20  RE-TABLE                  PIC XXX.
  7092             20  FILLER                    PIC XXX.
  7093         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7094             20  FILLER                    PIC X.
  7095             20  RE-COMPANY.
  7096                 24  RE-COMP-PRIME         PIC XXX.
  7097                 24  RE-COMP-SUB           PIC XXX.
  7098
  7099     12  RE-MAINT-INFORMATION.
  7100         16  RE-LAST-MAINT-DT              PIC XX.
  7101         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7102         16  RE-LAST-MAINT-USER            PIC X(4).
  7103         16  FILLER                        PIC X(10).
  7104
  7105     12  RE-TABLE-DATA.
  7106         16  RE-100-COMP                   PIC 99.
  7107
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 130
* EL050.cbl
  7108         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7109             20  RE-REI-COMP-NO.
  7110                 24  RE-REI-COMP           PIC XXX.
  7111                 24  RE-REI-COMP-SUB       PIC XXX.
  7112             20  RE-LF-QC                  PIC X.
  7113             20  RE-AH-QC                  PIC X.
  7114             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7115             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7116             20  RE-LFAGE-LO               PIC 99.
  7117             20  RE-LFAGE-HI               PIC 99.
  7118             20  RE-AHAGE-LO               PIC 99.
  7119             20  RE-AHAGE-HI               PIC 99.
  7120             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7121             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7122             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7123             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7124             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7125             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7126             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7127             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7128             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7129             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7130             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7131             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7132             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7133             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7134             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7135             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7136             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7137             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7138             20  RE-LF-BEN-CODE            PIC X.
  7139             20  RE-AH-BEN-CODE            PIC X.
  7140             20  RE-INTERACTIVE            PIC X.
  7141             20  RE-REMAINING              PIC X.
  7142             20  RE-LF-RUNOFF-SW           PIC X.
  7143             20  RE-AH-RUNOFF-SW           PIC X.
  7144             20  FILLER                    PIC X(19).
  7145
  7146         16  RE-COMP-INFO-END              PIC X(6).
  7147         16  RE-NSP-ST-CD-LF               PIC XX.
  7148         16  RE-NSP-ST-CD-AH               PIC XX.
  7149         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7150             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7151
  7152         16  FILLER                        PIC X(27).
  7153
  7154     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7155         16  RE-NAME                       PIC X(30).
  7156         16  RE-LF-PE                      PIC X.
  7157         16  RE-AH-PE                      PIC X.
  7158         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7159         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7160         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7161         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7162         16  RE-PRT-ST                     PIC X.
  7163         16  RE-PRT-OW                     PIC X.
  7164         16  RE-MORT-CODE                  PIC X(4).
  7165         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 131
* EL050.cbl
  7166         16  RE-ZERO-LF-FEE                PIC X.
  7167         16  RE-ZERO-AH-FEE                PIC X.
  7168         16  RE-CEDE-NAME                  PIC X(30).
  7169         16  RE-LF-COMM                    PIC X.
  7170         16  RE-AH-COMM                    PIC X.
  7171         16  RE-LF-TAX                     PIC X.
  7172         16  RE-AH-TAX                     PIC X.
  7173         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7174         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7175         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7176
  7177         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7178             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7179
  7180         16  RE-LF-CEDING-FEE-BRACKETS.
  7181             20  RE-LF-FEE-METHOD          PIC X.
  7182                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7183                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7184                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7185                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7186             20  RE-LF-FEE-BASIS           PIC X.
  7187                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7188                 88  RE-LF-NET-CEDED               VALUE '2'.
  7189                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7190                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7191                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7192                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7193                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7194                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7195             20  FILLER                    PIC XXX.
  7196             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7197                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7198                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7199
  7200         16  RE-AH-CEDING-FEE-BRACKETS.
  7201             20  RE-AH-FEE-METHOD          PIC X.
  7202                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7203                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7204                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7205                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7206             20  RE-AH-FEE-BASIS           PIC X.
  7207                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7208                 88  RE-AH-NET-CEDED               VALUE '2'.
  7209                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7210                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7211                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7212                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7213                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7214                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7215             20  FILLER                    PIC XXX.
  7216             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7217                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7218                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7219
  7220         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7221
  7222         16  RE-OLD-CEDING-STMT            PIC X.
  7223
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 132
* EL050.cbl
  7224         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7225         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7226         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7227         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7228         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7229         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7230         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7231         16  RE-MORT-SW                    PIC X.
  7232         16  RE-CEDING-TYPE-FLAG           PIC X.
  7233             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7234             88  RE-CEDED                          VALUE 'C'.
  7235             88  RE-ASSUMED                        VALUE 'A'.
  7236             88  RE-PHANTOM                        VALUE 'P'.
  7237
  7238         16  RE-CEDING-STMT-OPT-A          PIC X.
  7239             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7240         16  RE-CEDING-STMT-OPT-B          PIC X.
  7241             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7242         16  RE-CEDING-STMT-OPT-C          PIC X.
  7243             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7244         16  RE-CEDING-STMT-OPT-D          PIC X.
  7245             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7246         16  RE-CEDING-STMT-OPT-E          PIC X.
  7247             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7248
  7249         16  RE-PRT-CRSV                   PIC X.
  7250
  7251         16  RE-GL-CENTER                  PIC X(4).
  7252
  7253         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7254
  7255         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7256
  7257         16  RE-EARN-STOP-CODE             PIC X.
  7258             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7259             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7260
  7261         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7262             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7263
  7264         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7265         16  FILLER                        PIC X(2281).
  7266
  7267         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7268
  7269******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 133
* EL050.cbl
  7271*    COPY ERCCTBL.
  7272******************************************************************
  7273*                                                                *
  7274*                                                                *
  7275*                            ERCCTBL                             *
  7276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7277*                            VMOD=2.003
  7278*                                                                *
  7279*   ONLINE CREDIT SYSTEM                                         *
  7280*                                                                *
  7281*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7282*                                                                *
  7283*   FILE TYPE = VSAM,KSDS                                        *
  7284*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7285*                                                                *
  7286*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7287*       ALTERNATE PATH = NONE                                    *
  7288*                                                                *
  7289*   LOG = NO                                                     *
  7290*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7291*                                                                *
  7292*                                                                *
  7293******************************************************************
  7294
  7295 01  COMM-TABLE-RECORD.
  7296     12  CT-RECORD-ID                      PIC XX.
  7297         88  VALID-CT-ID                      VALUE 'CT'.
  7298
  7299     12  CT-CONTROL-PRIMARY.
  7300         16  CT-COMPANY-CD                 PIC X.
  7301         16  CT-TABLE                      PIC XXX.
  7302         16  CT-CNTRL-2.
  7303             20  CT-BEN-TYPE               PIC X.
  7304             20  CT-BEN-CODE               PIC XX.
  7305
  7306     12  CT-MAINT-INFORMATION.
  7307         16  CT-LAST-MAINT-DT              PIC XX.
  7308         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7309         16  CT-LAST-MAINT-USER            PIC X(4).
  7310         16  FILLER                        PIC X(31).
  7311
  7312     12  CT-LIMITS.
  7313         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7314
  7315         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7316
  7317         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7318
  7319     12  CT-RATES.
  7320         16  CT-RTX          OCCURS 27 TIMES.
  7321             20  CT-RT                     PIC SV9(5)     COMP-3.
  7322             20  CT-RT-R   REDEFINES
  7323                 CT-RT                     PIC XXX.
  7324
  7325     12  FILLER                            PIC  X(42).
  7326
  7327******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 134
* EL050.cbl
  7329*    COPY ERCFORM.
  7330******************************************************************
  7331*                                                                *
  7332*                                                                *
  7333*                            ERCFORM.                            *
  7334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7335*                            VMOD=2.003                          *
  7336*                                                                *
  7337*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7338*                                                                *
  7339*    FILE TYPE = VSAM,KSDS                                       *
  7340*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7341*                                                                *
  7342*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7343*                                                                *
  7344*    LOG = YES                                                   *
  7345*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7346******************************************************************
  7347 01  FORM-MASTER.
  7348    12  FO-RECORD-ID                 PIC X(02).
  7349        88  VALID-FO-ID                  VALUE 'FO'.
  7350
  7351    12  FO-CONTROL-PRIMARY.
  7352        16  FO-COMPANY-CD            PIC X(01).
  7353        16  FO-STATE                 PIC X(02).
  7354        16  FO-FORM-ID               PIC X(12).
  7355        16  FO-FORM-EXP-DT           PIC X(02).
  7356
  7357    12  FO-POLICY-FORM-DATA.
  7358        16  FO-IND-GRP-CD            PIC X(01).
  7359        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7360        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7361        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7362        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7363        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7364        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7365        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7366        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7367        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7368        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7369        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7370        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7371        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7372        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7373        16  FO-APP-CERT-USE-CD       PIC X(01).
  7374
  7375    12  FILLER                       PIC X(29).
  7376
  7377    12  FO-FORM-PLAN-TABLE.
  7378        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7379            20  FO-PLAN-TYPE         PIC X(01).
  7380            20  FO-PLAN-ID           PIC X(02).
  7381            20  FO-PLAN-TERM         PIC 9(03).
  7382            20  FO-PLAN-REFUND-METHOD
  7383                                     PIC X.
  7384
  7385    12  FILLER                       PIC X(30).
  7386
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 135
* EL050.cbl
  7387    12  FO-COMMENTS-AREA.
  7388        16  FO-COMMENT-LINE-1        PIC X(78).
  7389
  7390    12  FILLER                       PIC X(20).
  7391
  7392    12  FO-MAINT-INFORMATION.
  7393        16  FO-LAST-MAINT-DT         PIC X(02).
  7394        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7395        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 136
* EL050.cbl
  7397*    COPY ELCMSTR.
  7398******************************************************************
  7399*                                                                *
  7400*                            ELCMSTR.                            *
  7401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7402*                            VMOD=2.012                          *
  7403*                                                                *
  7404*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7405*                                                                *
  7406*   FILE TYPE = VSAM,KSDS                                        *
  7407*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7408*                                                                *
  7409*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7410*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7411*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7412*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7413*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7414*                                                 RKP=75,LEN=21  *
  7415*                                                                *
  7416*   **** NOTE ****                                               *
  7417*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7418*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7419*                                                                *
  7420*   LOG = YES                                                    *
  7421*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7422******************************************************************
  7423*                   C H A N G E   L O G
  7424*
  7425* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7426*-----------------------------------------------------------------
  7427*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7428* EFFECTIVE    NUMBER
  7429*-----------------------------------------------------------------
  7430* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7431* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7432* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7433* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7434* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7435******************************************************************
  7436 01  CLAIM-MASTER.
  7437     12  CL-RECORD-ID                PIC XX.
  7438         88  VALID-CL-ID         VALUE 'CL'.
  7439
  7440     12  CL-CONTROL-PRIMARY.
  7441         16  CL-COMPANY-CD           PIC X.
  7442         16  CL-CARRIER              PIC X.
  7443         16  CL-CLAIM-NO             PIC X(7).
  7444         16  CL-CERT-NO.
  7445             20  CL-CERT-PRIME       PIC X(10).
  7446             20  CL-CERT-SFX         PIC X.
  7447
  7448     12  CL-CONTROL-BY-NAME.
  7449         16  CL-COMPANY-CD-A1        PIC X.
  7450         16  CL-INSURED-LAST-NAME    PIC X(15).
  7451         16  CL-INSURED-NAME.
  7452             20  CL-INSURED-1ST-NAME PIC X(12).
  7453             20  CL-INSURED-MID-INIT PIC X.
  7454
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 137
* EL050.cbl
  7455     12  CL-CONTROL-BY-SSN.
  7456         16  CL-COMPANY-CD-A2        PIC X.
  7457         16  CL-SOC-SEC-NO.
  7458             20  CL-SSN-STATE        PIC XX.
  7459             20  CL-SSN-ACCOUNT      PIC X(6).
  7460             20  CL-SSN-LN3          PIC X(3).
  7461
  7462     12  CL-CONTROL-BY-CERT-NO.
  7463         16  CL-COMPANY-CD-A4        PIC X.
  7464         16  CL-CERT-NO-A4.
  7465             20  CL-CERT-A4-PRIME    PIC X(10).
  7466             20  CL-CERT-A4-SFX      PIC X.
  7467
  7468     12  CL-CONTROL-BY-CCN.
  7469         16  CL-COMPANY-CD-A5        PIC X.
  7470         16  CL-CCN-A5.
  7471             20  CL-CCN.
  7472                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7473                 24  CL-CCN-PRIME-A5 PIC X(12).
  7474             20  CL-CCN-FILLER-A5    PIC X(4).
  7475
  7476     12  CL-INSURED-PROFILE-DATA.
  7477         16  CL-INSURED-BIRTH-DT     PIC XX.
  7478         16  CL-INSURED-SEX-CD       PIC X.
  7479             88  INSURED-IS-MALE        VALUE 'M'.
  7480             88  INSURED-IS-FEMALE      VALUE 'F'.
  7481             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7482         16  CL-INSURED-OCC-CD       PIC X(6).
  7483         16  FILLER                  PIC X(5).
  7484
  7485     12  CL-PROCESSING-INFO.
  7486         16  CL-PROCESSOR-ID         PIC X(4).
  7487         16  CL-CLAIM-STATUS         PIC X.
  7488             88  CLAIM-IS-OPEN          VALUE 'O'.
  7489             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7490         16  CL-CLAIM-TYPE           PIC X.
  7491*            88  AH-CLAIM               VALUE 'A'.
  7492*            88  LIFE-CLAIM             VALUE 'L'.
  7493*            88  PROPERTY-CLAIM         VALUE 'P'.
  7494*            88  IUI-CLAIM              VALUE 'I'.
  7495*            88  GAP-CLAIM              VALUE 'G'.
  7496*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7497         16  CL-CLAIM-PREM-TYPE      PIC X.
  7498             88  SINGLE-PREMIUM         VALUE '1'.
  7499             88  O-B-COVERAGE           VALUE '2'.
  7500             88  OPEN-END-COVERAGE      VALUE '3'.
  7501         16  CL-INCURRED-DT          PIC XX.
  7502         16  CL-REPORTED-DT          PIC XX.
  7503         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7504         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7505         16  CL-LAST-PMT-DT          PIC XX.
  7506         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7507         16  CL-PAID-THRU-DT         PIC XX.
  7508         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7509         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7510         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7511         16  CL-PMT-CALC-METHOD      PIC X.
  7512             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 138
* EL050.cbl
  7513             88  CL-365-DAY-YR          VALUE '2'.
  7514             88  CL-FULL-MONTHS         VALUE '3'.
  7515         16  CL-CAUSE-CD             PIC X(6).
  7516
  7517         16  CL-PRIME-CERT-NO.
  7518             20  CL-PRIME-CERT-PRIME PIC X(10).
  7519             20  CL-PRIME-CERT-SFX   PIC X.
  7520
  7521         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7522             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7523             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7524
  7525         16  CL-MICROFILM-NO         PIC X(10).
  7526         16  FILLER REDEFINES CL-MICROFILM-NO.
  7527             20  CL-BENEFIT-PERIOD   PIC 99.
  7528             20  FILLER              PIC X(8).
  7529         16  CL-PROG-FORM-TYPE       PIC X.
  7530         16  CL-LAST-ADD-ON-DT       PIC XX.
  7531
  7532         16  CL-LAST-REOPEN-DT       PIC XX.
  7533         16  CL-LAST-CLOSE-DT        PIC XX.
  7534         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7535             88  FINAL-PAID             VALUE '1'.
  7536             88  CLAIM-DENIED           VALUE '2'.
  7537             88  AUTO-CLOSE             VALUE '3'.
  7538             88  MANUAL-CLOSE           VALUE '4'.
  7539             88  BENEFITS-CHANGED       VALUE 'C'.
  7540             88  SETUP-ERRORS           VALUE 'E'.
  7541         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7542         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7543         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7544             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7545         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7546         16  FILLER                  PIC X.
  7547
  7548     12  CL-CERTIFICATE-DATA.
  7549         16  CL-CERT-ORIGIN          PIC X.
  7550             88  CERT-WAS-ONLINE        VALUE '1'.
  7551             88  CERT-WAS-CREATED       VALUE '2'.
  7552             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7553         16  CL-CERT-KEY-DATA.
  7554             20  CL-CERT-CARRIER     PIC X.
  7555             20  CL-CERT-GROUPING    PIC X(6).
  7556             20  CL-CERT-STATE       PIC XX.
  7557             20  CL-CERT-ACCOUNT.
  7558                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7559                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7560             20  CL-CERT-EFF-DT      PIC XX.
  7561
  7562     12  CL-STATUS-CONTROLS.
  7563         16  CL-PRIORITY-CD          PIC X.
  7564             88  CONFIDENTIAL-DATA      VALUE '8'.
  7565             88  HIGHEST-PRIORITY       VALUE '9'.
  7566         16  CL-SUPV-ATTN-CD         PIC X.
  7567             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7568             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7569         16  CL-PURGED-DT            PIC XX.
  7570         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 139
* EL050.cbl
  7571         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7572         16  CL-NEXT-RESEND-DT       PIC XX.
  7573         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7574         16  CL-CRITICAL-PERIOD      PIC 99.
  7575*        16  FILLER                  PIC XX.
  7576         16  CL-LAST-MAINT-DT        PIC XX.
  7577         16  CL-LAST-MAINT-USER      PIC X(4).
  7578         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7579         16  CL-LAST-MAINT-TYPE      PIC X.
  7580             88  CLAIM-SET-UP           VALUE ' '.
  7581             88  PAYMENT-MADE           VALUE '1'.
  7582             88  LETTER-SENT            VALUE '2'.
  7583             88  MASTER-WAS-ALTERED     VALUE '3'.
  7584             88  MASTER-WAS-RESTORED    VALUE '4'.
  7585             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7586             88  FILE-CONVERTED         VALUE '6'.
  7587             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7588             88  ERROR-CORRECTION       VALUE 'E'.
  7589         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7590         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7591         16  CL-BENEFICIARY          PIC X(10).
  7592         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7593         16  CL-DENIAL-TYPE          PIC X.
  7594             88  CL-TYPE-DENIAL          VALUE '1'.
  7595             88  CL-TYPE-RESCISSION      VALUE '2'.
  7596             88  CL-TYPE-REFORMATION     VALUE '3'.
  7597             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7598             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7599         16  filler                  pic x(5).
  7600*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7601*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7602*        16  CL-RTW-DT               PIC XX.
  7603
  7604     12  CL-TRAILER-CONTROLS.
  7605         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7606             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7607             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7608             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7609         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7610         16  FILLER                  PIC XX.
  7611         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7612         16  CL-ADDRESS-TRAILER-CNT.
  7613             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7614                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7615             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7616                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7617             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7618                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7619             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7620                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7621             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7622                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7623             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7624                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7625             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7626                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7627
  7628     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 140
* EL050.cbl
  7629         16  CL-CV-REFNO-PRIME       PIC X(18).
  7630         16  CL-CV-REFNO-SFX         PIC XX.
  7631
  7632     12  CL-FILE-LOCATION            PIC X(4).
  7633
  7634     12  CL-PROCESS-ERRORS.
  7635         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7636             88  NO-FATAL-ERRORS        VALUE ZERO.
  7637         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7638             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7639
  7640     12  CL-PRODUCT-CD               PIC X.
  7641
  7642     12  CL-CURRENT-KEY-DATA.
  7643         16  CL-CURRENT-CARRIER      PIC X.
  7644         16  CL-CURRENT-GROUPING     PIC X(6).
  7645         16  CL-CURRENT-STATE        PIC XX.
  7646         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7647
  7648     12  CL-ASSOCIATES               PIC X.
  7649         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7650         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7651         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7652         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7653
  7654     12  CL-ACTIVITY-CODE            PIC 99.
  7655     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7656     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7657
  7658     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7659     12  CL-LAG-REPORT-CODE          PIC 9.
  7660     12  CL-LOAN-TYPE                PIC XX.
  7661     12  CL-LEGAL-STATE              PIC XX.
  7662
  7663     12  CL-YESNOSW                  PIC X.
  7664     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7665         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7666         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7667         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7668     12  cl-insured-type             pic x.
  7669         88  cl-claim-on-primary         value 'P'.
  7670         88  cl-claim-on-co-borrower     value 'C'.
  7671     12  cl-benefit-expiration-dt    PIC XX.
  7672
  7673 01  PLAN-RECORDS.
  7674     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7675     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7676
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 141
* EL050.cbl
  7678 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7679                          ACCOUNT-MASTER REINSURANCE-RECORD
  7680                          COMM-TABLE-RECORD FORM-MASTER
  7681                          CLAIM-MASTER PLAN-RECORDS.
  7682 0000-DFHEXIT SECTION.
  7683     MOVE '9#                    $   ' TO DFHEIV0.
  7684     MOVE 'EL050' TO DFHEIV1.
  7685     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7686
  7687     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7688
  7689
  7690* EXEC CICS  HANDLE CONDITION
  7691*           ERROR    (9300-ABEND)
  7692*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7693*    END-EXEC.
  7694*    MOVE '"$.J                  ! " #00007685' TO DFHEIV0
  7695     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7697     MOVE X'2220233030303037363835' TO DFHEIV0(25:11)
  7698     CALL 'kxdfhei1' USING DFHEIV0
  7699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7700
  7701
  7702 0000-COPY-PROCEDURE-DIV.
  7703*                          COPY ELC50PD.
  7704******************************************************************
  7705*                                                                *
  7706*                            ELC50PD                             *
  7707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7708*                            VMOD=2.188                          *
  7709*                                                                *
  7710******************************************************************
  7711*                   C H A N G E   L O G
  7712*
  7713* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7714*-----------------------------------------------------------------
  7715*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7716* EFFECTIVE    NUMBER
  7717*-----------------------------------------------------------------
  7718* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7719* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7720* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7721*                             2709 AND 2718
  7722* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7723* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7724* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7725* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7726* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7727*                                IS OPEN OR CNC DT < PD THRU
  7728* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7729* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7730* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7731* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7732* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7733* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7734* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7735* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 142
* EL050.cbl
  7736* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7737* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7738* 020906                   PEMA  EXPAND LOAN OFFICER
  7739* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7740* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7741* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7742* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7743* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7744* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7745* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7746* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7747* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7748* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7749* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7750* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7751* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7752* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7753* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7754* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7755* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7756* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7757* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7758* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7759* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7760* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7761* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7762* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7763* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7764*                                UPDATE VIN ON CERT TRAILER
  7765* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7766* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7767* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7768* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7769* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7770* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7771* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7772* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7773* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7774* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7775* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7776* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7777* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7778* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7779* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7780* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7781* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7782* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7783* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7784* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7785* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7786* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7787* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7788* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7789* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7790* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7791* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7792* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7793* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 143
* EL050.cbl
  7794* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7795* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7796* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7797* 032912  CR2011110200001  PEMA  AHL CHANGES
  7798* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7799* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7800* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7801* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7802* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7803* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7804* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7805* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7806* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7807* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7808* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7809* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7810* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7811* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7812* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7813* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7814* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7815* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7816* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7817* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7818* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7819* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7820* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7821* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7822* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7823* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7824* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7825*                                CERT #, ADD 2898 FORCIBLE ERROR
  7826* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7827* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7828* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7829* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7830* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7831* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7832* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7833* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7834* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7835* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7836* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7837* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7838******************************************************************
  7839************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7840******************************************************************
  7841
  7842     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7843
  7844     MOVE SPACES                 TO PB-FATAL-FLAG
  7845                                    PB-FORCE-ER-CD
  7846                                    PB-WARN-ER-CD
  7847                                    PB-OUT-BAL-CD.
  7848
  7849     MOVE SPACE                  TO WS-IG-OVRD-AH
  7850                                    WS-IG-OVRD-LF
  7851                                    WS-IG-OVRD-AM
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 144
* EL050.cbl
  7852                                    WS-IG-OVRD
  7853                                    WS-IG-OVRD-AH-PL
  7854                                    WS-IG-OVRD-LF-PL
  7855                                    WS-IG-OVRD-AH-BEN
  7856                                    WS-IG-OVRD-LF-BEN.
  7857
  7858******************************************************************
  7859*************       INITIALIZE COMMON ERRORS       ***************
  7860******************************************************************
  7861
  7862     MOVE +0                     TO PB-NO-OF-ERRORS.
  7863     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7864
  7865******************************************************************
  7866
  7867     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7868     SET JULIAN-TO-BIN           TO TRUE.
  7869*    MOVE 5                      TO DC-OPTION-CODE.
  7870     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7871     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7872
  7873     MOVE ZERO                   TO  SUB4.
  7874
  7875 0040-INITIALIZE-GA-BILL-DT.
  7876
  7877     ADD +1                      TO  SUB4.
  7878
  7879     IF  SUB4 GREATER THAN +5
  7880         GO TO 0050-CHECK-CNTL-FOUND.
  7881
  7882     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7883         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7884
  7885     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7886
  7887 0050-CHECK-CNTL-FOUND.
  7888
  7889     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7890        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7891                                         WS-AH-REM-TERM-CALC
  7892                                         EC-CO-REM-TERM-CALC
  7893        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7894        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7895        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7896                                         WS-TOL-AH-CLAIM
  7897        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7898                                         WS-TOL-AH-PREM
  7899                                         EC-CO-TOL-PREM
  7900        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7901                                         WS-TOL-AH-REFUND
  7902                                         EC-CO-TOL-REFUND
  7903        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7904                                         WS-AH-REFUND-OVS-AMT
  7905                                         EC-CO-OVR-SHT-AMT
  7906        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7907                                         WS-TOL-AH-PREM-PCT
  7908                                         EC-CO-TOL-PREM-PCT
  7909        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 145
* EL050.cbl
  7910                                         WS-TOL-AH-REFUND-PCT
  7911                                         EC-CO-TOL-REFUND-PCT
  7912        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7913                                         WS-AH-REFUND-OVS-PCT
  7914                                         EC-CO-OVR-SHT-PCT
  7915        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7916        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7917        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7918        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7919        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7920        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7921        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7922        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7923        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7924        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7925        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7926        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7927                                         EC-CO-MONTH-END-DT
  7928        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7929          GO TO 0100-READ-ACCT.
  7930
  7931     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7932     MOVE SPACES                 TO CNTL-ACCESS.
  7933     MOVE '1'                    TO CNTL-REC-TYPE.
  7934     MOVE +0                     TO CNTL-SEQ-NO.
  7935
  7936     MOVE '1' TO RC-SW-1.
  7937     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7938     IF NOT CF-COMPANY-MASTER
  7939         MOVE ZEROS             TO WK-CO-TOL-PREM
  7940                                   WK-CO-TOL-CLAIM
  7941                                   WK-CO-TOL-REFUND
  7942                                   WK-REFUND-OVS-AMT
  7943                                   WK-REFUND-OVS-PCT
  7944                                   WK-CO-TOL-PREM-PCT
  7945                                   WK-CO-TOL-REFUND-PCT
  7946                                   WK-DEFAULT-APR
  7947                                   WK-CO-MAX-CAP
  7948        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7949                                   WK-CR-R78-METHOD
  7950                                   WK-CO-REF-REJECT-SW
  7951                                   WK-CO-PREM-REJECT-SW
  7952                                   WK-REM-TRM-CALC-OPTION
  7953                                   WK-BIRTH-DATE-INPUT
  7954                                   WK-JOINT-AGE-INPUT
  7955        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7956        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7957        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7958        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7959          GO TO 0099-COMPANY-NOT-FOUND.
  7960
  7961     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7962        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7963     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7964        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7965     IF CF-CO-TOL-CAP NOT NUMERIC
  7966        MOVE +0                    TO CF-CO-TOL-CAP.
  7967     IF CF-DEFAULT-APR NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 146
* EL050.cbl
  7968        MOVE +0                    TO CF-DEFAULT-APR.
  7969
  7970     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7971     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7972     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7973     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7974     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7975     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7976     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7977     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7978     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7979     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7980     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7981     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7982
  7983     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7984          CF-CO-OVR-SHT-AMT > +0
  7985        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7986
  7987     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7988          CF-CO-OVR-SHT-PCT > +0
  7989        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7990
  7991     IF CF-VALID-REM-TRM-OPTION
  7992         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7993     ELSE
  7994         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7995
  7996     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7997     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7998     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7999     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8000
  8001     GO TO 0050-CHECK-CNTL-FOUND.
  8002
  8003 0099-COMPANY-NOT-FOUND.
  8004
  8005     MOVE ER-2616                TO WS-ERROR.
  8006     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8007
  8008 0100-READ-ACCT.
  8009
  8010     MOVE SPACES                 TO DATE-RANGE-SW.
  8011
  8012     IF WK-ACCT-ADDR = ZEROS
  8013        GO TO 0102-ACCT-GETMAIN.
  8014
  8015     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8016     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8017     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8018
  8019     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8020        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8021        GO TO 0105-READ-ACCT
  8022     END-IF
  8023
  8024     IF PB-CARRIER NOT = SPACES
  8025        IF PB-CARRIER NOT = AM-VG-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 147
* EL050.cbl
  8026           GO TO 0105-READ-ACCT.
  8027
  8028     IF PB-STATE NOT = SPACES
  8029        IF PB-STATE NOT = AM-VG-STATE
  8030           GO TO 0105-READ-ACCT.
  8031
  8032     IF PB-GROUPING NOT = SPACES
  8033        IF PB-GROUPING NOT = AM-VG-GROUPING
  8034           GO TO 0105-READ-ACCT.
  8035
  8036     MOVE 'X'                 TO DATE-RANGE-SW.
  8037
  8038     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8039        MOVE 'X'                 TO DATE-RANGE-SW
  8040        GO TO 0105-READ-ACCT.
  8041
  8042     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8043        GO TO 0105-READ-ACCT.
  8044
  8045     GO TO 0180-ACCOUNT-FOUND.
  8046
  8047 0102-ACCT-GETMAIN.
  8048     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8049     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8050
  8051 0105-READ-ACCT.
  8052     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8053     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8054     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8055     MOVE PB-STATE               TO ACCT-STATE.
  8056     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8057     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8058
  8059     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8060
  8061     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8062
  8063 0110-FIND-ACCT-TOLERANCES-LOOP.
  8064     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8065
  8066     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8067        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8068        GO TO 0199-ACCT-NOT-FOUND
  8069     END-IF
  8070     IF PB-CARRIER NOT = SPACES
  8071        IF PB-CARRIER NOT = AM-VG-CARRIER
  8072           GO TO 0199-ACCT-NOT-FOUND.
  8073
  8074     IF PB-STATE NOT = SPACES
  8075        IF PB-STATE NOT = AM-VG-STATE
  8076           GO TO 0199-ACCT-NOT-FOUND.
  8077
  8078     IF PB-GROUPING NOT = SPACES
  8079        IF PB-GROUPING NOT = AM-VG-GROUPING
  8080           GO TO 0199-ACCT-NOT-FOUND.
  8081
  8082     MOVE 'X'                    TO DATE-RANGE-SW.
  8083
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 148
* EL050.cbl
  8084     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8085        MOVE 'X'                 TO DATE-RANGE-SW
  8086        GO TO 0199-ACCT-NOT-FOUND.
  8087
  8088     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8089        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8090
  8091 0180-ACCOUNT-FOUND.
  8092     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8093     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8094     MOVE AM-STATE               TO PB-SV-STATE.
  8095     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8096
  8097     IF AM-CANCEL-FEE  NOT NUMERIC
  8098        MOVE ZEROS TO AM-CANCEL-FEE.
  8099
  8100     IF AM-MAX-MON-BEN NOT NUMERIC
  8101        MOVE ZEROS TO AM-MAX-MON-BEN.
  8102
  8103     IF AM-MAX-TOT-BEN NOT NUMERIC
  8104        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8105
  8106     IF AM-CLP-TOL-PCT NOT NUMERIC
  8107        MOVE +0                  TO AM-CLP-TOL-PCT
  8108     END-IF
  8109     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8110        MOVE +0                  TO AM-SPP-LEASE-COMM
  8111     END-IF
  8112     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8113        MOVE ER-2611             TO   WS-ERROR
  8114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8115
  8116     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8117        MOVE ER-2621             TO   WS-ERROR
  8118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8119
  8120     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8121        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8122        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8123        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8124         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8125
  8126     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8127     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8128     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8129     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8130     IF AM-CLP-TOL-PCT NOT = ZEROS
  8131        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8132     END-IF
  8133     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8134        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8135     END-IF
  8136*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8137*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8138*                                   WS-ADMIN-FEES
  8139*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8140*          (SUB5 > +10)
  8141*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 149
* EL050.cbl
  8142*             AND (AM-A-COM (SUB5) NUMERIC)
  8143*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8144*                + (AM-A-COM (SUB5) * 1000)
  8145*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8146*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8147*                + (AM-A-COM (SUB5) * 1000)
  8148*             END-IF
  8149*             IF AM-COM-TYP (SUB5) = 'N'
  8150*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8151*                + (AM-A-COM (SUB5) * 1000)
  8152*             END-IF
  8153*          END-IF
  8154*       END-PERFORM
  8155*    END-IF
  8156     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8157        AND (PB-ISSUE)
  8158        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8159                                    ws-cred-union-fees
  8160        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8161           (SUB5 > +10)
  8162           MOVE +0 TO WS-WK-RATE
  8163           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8164                                   'O' OR 'S')
  8165              IF (AM-A-COM (SUB5) NUMERIC)
  8166                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8167                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8168              ELSE
  8169                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8170                 IF PB-ISSUE
  8171                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8172                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8173                 ELSE
  8174                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8175                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8176                 END-IF
  8177                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8178                 MOVE ZEROS             TO WS-SUB1
  8179                                           WS-COMMISSION
  8180                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8181                 MOVE '0530'               TO CTBL-SW
  8182                 MOVE ' '                  TO WS-CTBL-READ-SW
  8183                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8184                 IF FIRST-TIME-THROUGH
  8185                    MOVE 'AA'              TO CTBL-BEN-CODE
  8186                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8187                 END-IF
  8188                 IF CTBL-TABLE-FOUND
  8189                    IF PB-ISSUE
  8190                       COMPUTE WS-COMM-CK-AMT =
  8191                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8192                    ELSE
  8193                       COMPUTE WS-COMM-CK-AMT =
  8194                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8195                    END-IF
  8196                    PERFORM 8800-GET-COMP-RATE
  8197                              THRU 8800-EXIT
  8198                 END-IF
  8199              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 150
* EL050.cbl
  8200              if am-com-typ (sub5) = 'O' or 'S'
  8201                 compute ws-cred-union-fees rounded =
  8202                    ws-cred-union-fees +
  8203                    (pb-i-ah-premium-amt * ws-wk-rate)
  8204              else
  8205                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8206                + (WS-WK-RATE * 1000)
  8207              end-if
  8208           END-IF
  8209        END-PERFORM
  8210     END-IF
  8211     IF PB-COMPANY-ID EQUAL 'CRI'
  8212         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8213
  8214     IF PB-COMPANY-ID EQUAL 'NCL'
  8215         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8216     END-IF
  8217
  8218     GO TO 0200-READ-CERT.
  8219
  8220 0199-ACCT-NOT-FOUND.
  8221
  8222     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8223
  8224     IF DATE-RANGE-SW NOT = SPACES
  8225        MOVE ER-2601             TO WS-ERROR
  8226        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8227     ELSE
  8228        MOVE ER-2619             TO WS-ERROR
  8229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8230
  8231     GO TO 9990-RETURN.
  8232
  8233 0200-READ-CERT.
  8234
  8235     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8236     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8237     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8238     MOVE PB-SV-STATE            TO CERT-STATE.
  8239     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8240     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8241     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8242
  8243     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8244
  8245     IF CERT-WAS-NOT-FOUND
  8246        GO TO 0299-CERT-NOT-FOUND.
  8247
  8248     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8249        MOVE ER-2759             TO WS-ERROR
  8250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8251        GO TO 0298-UNLOCK-RETURN.
  8252
  8253     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8254         MOVE ER-2758            TO WS-ERROR
  8255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8256         GO TO 0298-UNLOCK-RETURN.
  8257
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 151
* EL050.cbl
  8258     IF PB-ISSUE
  8259        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8260           IF CERT-WAS-CREATED-FOR-CLAIM
  8261              NEXT SENTENCE
  8262            ELSE
  8263              MOVE ER-2626       TO WS-ERROR
  8264              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8265              GO TO 0298-UNLOCK-RETURN.
  8266
  8267     IF NOT PB-CANCELLATION
  8268        GO TO 0300-CONTINUE-EDIT.
  8269
  8270     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8271     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8272     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8273     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8274     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8275     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8276
  8277     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8278     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8279     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8280     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8281     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8282     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8283     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8284     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8285     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8286
  8287     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8288     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8289     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8290     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8291     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8292     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8293     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8294
  8295     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8296     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8297
  8298     MOVE CM-CREDIT-INTERFACE-SW-1
  8299                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8300     MOVE CM-CREDIT-INTERFACE-SW-2
  8301                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8302
  8303     IF CM-O-B-COVERAGE
  8304         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8305
  8306     IF CM-LIVES NOT NUMERIC
  8307         MOVE ZERO                TO CM-LIVES.
  8308
  8309     IF CM-BILLED NOT NUMERIC
  8310         MOVE ZERO                TO CM-BILLED.
  8311
  8312     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8313         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8314         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8315         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 152
* EL050.cbl
  8316         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8317         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8318         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8319         MOVE CM-LIVES             TO PB-CI-LIVES
  8320*The next line causes a problem with my change  I dont think it is
  8321*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8322
  8323     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8324     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8325     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8326     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8327     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8328     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8329
  8330     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8331     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8332     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8333     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8334
  8335     IF CM-LIFE-COMM-PCT NUMERIC
  8336         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8337     ELSE
  8338         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8339
  8340     IF CM-AH-COMM-PCT NUMERIC
  8341         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8342     ELSE
  8343         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8344
  8345     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8346
  8347     IF CM-LOAN-APR       NOT NUMERIC
  8348           MOVE ZERO               TO CM-LOAN-APR.
  8349
  8350     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8351           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8352
  8353     IF CM-LOAN-TERM      NOT NUMERIC
  8354           MOVE ZERO               TO CM-LOAN-TERM.
  8355
  8356     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8357           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8358
  8359     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8360           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8361
  8362     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8363     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8364     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8365     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8366     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8367     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8368     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8369     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8370     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8371     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8372     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8373     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 153
* EL050.cbl
  8374
  8375     IF CM-STATE = CM-SSN-STATE
  8376         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8377
  8378     IF CM-STATE NOT = CM-MEMB-STATE
  8379         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8380
  8381     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8382
  8383     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8384        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8385        IF CM-ADDL-CLP NOT NUMERIC
  8386           MOVE +0               TO CM-ADDL-CLP
  8387        END-IF
  8388        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8389        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8390           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8391        END-IF
  8392     END-IF
  8393     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8394        MOVE +0                  TO WS-ADMIN-FEES
  8395                                    WS-CSO-ADMIN-FEE
  8396                                    WS-COMM-AND-MFEE
  8397                                    WS-1ST-YR-ALLOW
  8398        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8399           (SUB5 > +10)
  8400           MOVE +0 TO WS-WK-RATE
  8401           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8402              IF (AM-A-COM (SUB5) NUMERIC)
  8403                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8404                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8405              ELSE
  8406                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8407                 IF PB-ISSUE
  8408                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8409                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8410                 ELSE
  8411                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8412                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8413                 END-IF
  8414                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8415                 MOVE ZEROS             TO WS-SUB1
  8416                                           WS-COMMISSION
  8417                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8418                 MOVE '0530'               TO CTBL-SW
  8419                 MOVE ' '                  TO WS-CTBL-READ-SW
  8420                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8421                 IF FIRST-TIME-THROUGH
  8422                    MOVE 'AA'              TO CTBL-BEN-CODE
  8423                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8424                 END-IF
  8425                 IF CTBL-TABLE-FOUND
  8426                    IF PB-ISSUE
  8427                       COMPUTE WS-COMM-CK-AMT =
  8428                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8429                    ELSE
  8430                       COMPUTE WS-COMM-CK-AMT =
  8431                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 154
* EL050.cbl
  8432                    END-IF
  8433                    PERFORM 8800-GET-COMP-RATE
  8434                              THRU 8800-EXIT
  8435                 END-IF
  8436              END-IF
  8437              IF AM-COM-TYP (SUB5) = 'I'
  8438                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8439                   + (WS-WK-RATE * 1000)
  8440              END-IF
  8441              IF AM-COM-TYP (SUB5) = 'N'
  8442                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8443                   + (WS-WK-RATE * 1000)
  8444              END-IF
  8445              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8446                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8447                   + (WS-WK-RATE * 1000)
  8448              END-IF
  8449              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8450                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8451                   + (WS-WK-RATE * 1000)
  8452              END-IF
  8453           END-IF
  8454        END-PERFORM
  8455     END-IF
  8456     GO TO 0300-CONTINUE-EDIT.
  8457
  8458 0298-UNLOCK-RETURN.
  8459      PERFORM 9250-UNLOCK-RETURN
  8460      GO TO 9990-RETURN.
  8461
  8462 0299-CERT-NOT-FOUND.
  8463
  8464     MOVE '1'                     TO CERT-STATUS-SW.
  8465
  8466     IF PB-COMPANY-ID = 'UCL'
  8467         IF WS-ERROR = ER-2799
  8468             GO TO 3000-CONTINUE-EDIT.
  8469
  8470     IF NOT PB-CANCELLATION
  8471         GO TO 0300-CONTINUE-EDIT.
  8472
  8473     MOVE ER-2726                  TO  WS-ERROR.
  8474     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8475     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8476     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8477                                    PB-CI-LF-TERM
  8478                                    PB-C-LF-REM-TERM
  8479                                    PB-CI-AH-TERM
  8480                                    PB-C-AH-REM-TERM
  8481                                    PB-CI-LF-BENEFIT-CD
  8482                                    PB-CI-LF-BENEFIT-AMT
  8483                                    PB-CI-LF-ALT-BENEFIT-AMT
  8484                                    PB-CI-LF-PREMIUM-AMT
  8485                                    PB-CI-LF-ALT-PREMIUM-AMT
  8486                                    PB-CI-AH-BENEFIT-CD
  8487                                    PB-CI-AH-BENEFIT-AMT
  8488                                    PB-CI-AH-PREMIUM-AMT
  8489                                    PB-CI-PAY-FREQUENCY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 155
* EL050.cbl
  8490                                    PB-CI-LOAN-APR
  8491                                    PB-CI-LOAN-TERM
  8492                                    PB-CI-LIFE-COMMISSION
  8493                                    PB-CI-AH-COMMISSION
  8494                                    PB-CI-CURR-SEQ
  8495                                    PB-CI-AH-CANCEL-AMT
  8496                                    PB-CI-LF-CANCEL-AMT
  8497                                    PB-CI-RATE-DEV-PCT-LF
  8498                                    PB-CI-RATE-DEV-PCT-AH
  8499                                    PB-CI-EXTENTION-DAYS
  8500                                    PB-CI-TERM-IN-DAYS
  8501                                    PB-CI-LIVES
  8502                                    PB-CI-LF-CRIT-PER
  8503                                    PB-CI-AH-CRIT-PER
  8504                                    PB-CI-ADDL-CLP
  8505                                    PB-CI-DDF-IU-RATE-UP.
  8506
  8507     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8508                                    PB-CI-AH-SETTLEMENT-DT
  8509                                    PB-CI-DEATH-DT
  8510                                    PB-CI-LF-PRIOR-CANCEL-DT
  8511                                    PB-CI-AH-PRIOR-CANCEL-DT
  8512                                    PB-CI-ENTRY-DT
  8513                                    PB-CI-LF-EXPIRE-DT
  8514                                    PB-CI-AH-EXPIRE-DT
  8515                                    PB-CI-LOAN-1ST-PMT-DT.
  8516
  8517     IF ACCOUNT-MAST-FOUND
  8518        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8519        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8520
  8521
  8522 0300-CONTINUE-EDIT.
  8523
  8524     IF PB-ISSUE
  8525        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8526            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8527
  8528     IF PB-ISSUE
  8529        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8530            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8531
  8532     IF PB-ISSUE
  8533       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8534          (AM-NO-AH-ONLY)
  8535           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8536               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8537                   MOVE ER-2679 TO WS-ERROR
  8538                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8539
  8540     IF PB-ISSUE
  8541        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8542        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8543        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8544     ELSE
  8545        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8546        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8547        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 156
* EL050.cbl
  8548
  8549     MOVE 'N'                    TO PLAN-MASTER-SW
  8550                                    PLAN-MASTER-LIFE-SW
  8551                                    FORM-MASTER-SW
  8552                                    WS-APP-CERT-SW.
  8553
  8554     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8555                                    WS-PL-TOL-LF-REFUND
  8556                                    WS-PL-REF-OVS-AMT
  8557                                    WS-PL-TOL-LF-PREM-PCT
  8558                                    WS-PL-TOL-LF-REFUND-PCT
  8559                                    WS-PL-REF-OVS-PCT
  8560                                    WS-PL-TOL-LF-CLAIM.
  8561
  8562     IF PB-COMPANY-ID = 'NCL'
  8563       IF PB-ISSUE
  8564         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8565             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8566             IF FORM-MASTER-FOUND
  8567                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8568
  8569     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8570        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8571
  8572********************** MON CODE **********************
  8573     IF PB-COMPANY-ID = 'MON'
  8574     IF PB-ISSUE
  8575     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8576        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8577             PB-I-LOAN-APR = ZERO)
  8578               MOVE 14.0         TO PB-I-LOAN-APR.
  8579******************************************************
  8580
  8581     IF PB-COMPANY-ID = 'NCL'
  8582       IF PB-ISSUE
  8583           IF FORM-MASTER-FOUND
  8584             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8585                AM-DISMBR-COVERAGE
  8586                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8587                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8588                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8589                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8590                                           PB-I-LIFE-BENEFIT-CD.
  8591
  8592     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8593
  8594     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8595         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8596         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8597         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8598         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8599         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8600           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8601             GO TO 0301-LIFE-BENEFIT-SEARCH
  8602         ELSE
  8603             NEXT SENTENCE
  8604     ELSE
  8605         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 157
* EL050.cbl
  8606
  8607     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8608     MOVE '4'                    TO CNTL-REC-TYPE.
  8609     MOVE +0                     TO CNTL-SEQ-NO.
  8610     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8611
  8612     MOVE '1' TO RC-SW-2.
  8613     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8614
  8615     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8616        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8617         GO TO 0305-BENEFIT-NOT-FOUND.
  8618
  8619     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8620
  8621 0301-LIFE-BENEFIT-SEARCH.
  8622
  8623     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8624
  8625     IF NO-BENEFIT-FOUND
  8626        GO TO 0305-BENEFIT-NOT-FOUND.
  8627
  8628     IF WS-BEN-CD = '99'
  8629        GO TO 0305-BENEFIT-NOT-FOUND.
  8630
  8631     IF PB-COMPANY-ID = 'NCL'
  8632         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8633             GO TO 0304-LIFE-BENEFIT-FOUND.
  8634
  8635     MOVE +1                     TO SUB5.
  8636     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8637
  8638* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8639* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8640     IF PB-COMPANY-ID = 'DMD'
  8641         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8642
  8643 0302-EDIT-ACCT-LF-BENEFITS.
  8644
  8645     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8646        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8647           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8648                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8649           GO TO 03XX-GET-LIFE-ERPLAN.
  8650
  8651     IF SUB5 LESS THAN +20
  8652        ADD +1                   TO SUB5
  8653        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8654
  8655     MOVE +1                     TO SUB5.
  8656
  8657     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8658        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8659
  8660 0303-EDIT-DMD-EXTRA-BENEFITS.
  8661
  8662     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8663        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 158
* EL050.cbl
  8664           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8665                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8666           GO TO 03XX-GET-LIFE-ERPLAN.
  8667
  8668     IF SUB5 LESS THAN +30
  8669        ADD +1                   TO SUB5
  8670        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8671
  8672     MOVE +1                     TO SUB5.
  8673
  8674 03XX-EDIT-FOR-NINETY-LF.
  8675
  8676***************************************************************
  8677*                                                             *
  8678*    NINETY BENEFIT PLAN TYPES:                               *
  8679*                                                             *
  8680*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8681*      92 = ALL GROUP REDUCING BENEFITS                       *
  8682*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8683*      94 = ALL GROUP LEVEL BENEFITS                          *
  8684*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8685*           BENEFIT CONTROLS.                                 *
  8686*      99 = ALL BENEFITS                                      *
  8687*                                                             *
  8688***************************************************************
  8689
  8690     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8691                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8692
  8693     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8694       AND
  8695        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8696        GO TO 03XX-GET-LIFE-ERPLAN.
  8697
  8698     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8699       AND
  8700        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8701        IF CF-REDUCING (SUB3)
  8702           IF (PB-I-INDV-GRP-OVRD = 'I')
  8703              OR
  8704           ((AM-IG = '1') AND
  8705           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8706              OR
  8707           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8708           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8709           (AM-IG NOT = '2'))
  8710              GO TO 03XX-GET-LIFE-ERPLAN.
  8711
  8712     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8713       AND
  8714        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8715        IF CF-REDUCING (SUB3)
  8716           IF (PB-I-INDV-GRP-OVRD = 'G')
  8717              OR
  8718           ((AM-IG = '2') AND
  8719           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8720              OR
  8721           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 159
* EL050.cbl
  8722           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8723           (AM-IG NOT = '1'))
  8724              GO TO 03XX-GET-LIFE-ERPLAN.
  8725
  8726     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8727       AND
  8728        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8729        IF CF-LEVEL    (SUB3)
  8730           IF (PB-I-INDV-GRP-OVRD = 'I')
  8731              OR
  8732           ((AM-IG = '1') AND
  8733           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8734              OR
  8735           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8736           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8737            (AM-IG NOT = '2'))
  8738              GO TO 03XX-GET-LIFE-ERPLAN.
  8739
  8740     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8741       AND
  8742        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8743        IF CF-LEVEL    (SUB3)
  8744           IF (PB-I-INDV-GRP-OVRD = 'G')
  8745              OR
  8746           ((AM-IG = '2') AND
  8747           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8748              OR
  8749           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8750           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8751           (AM-IG NOT = '1'))
  8752              GO TO 03XX-GET-LIFE-ERPLAN.
  8753
  8754     IF SUB5 LESS THAN +20
  8755        ADD +1                   TO SUB5
  8756        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8757
  8758     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8759
  8760     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8761        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8762
  8763     MOVE +1                     TO SUB5.
  8764
  8765 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8766
  8767     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8768                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8769
  8770     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8771       AND
  8772        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8773        GO TO 03XX-GET-LIFE-ERPLAN.
  8774
  8775     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8776       AND
  8777        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8778        IF CF-REDUCING (SUB3)
  8779           IF (PB-I-INDV-GRP-OVRD = 'I')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 160
* EL050.cbl
  8780              OR
  8781           ((AM-IG = '1') AND
  8782           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8783              OR
  8784           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8785           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8786           (AM-IG NOT = '2'))
  8787              GO TO 03XX-GET-LIFE-ERPLAN.
  8788
  8789     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8790       AND
  8791        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8792        IF CF-REDUCING (SUB3)
  8793           IF (PB-I-INDV-GRP-OVRD = 'G')
  8794              OR
  8795           ((AM-IG = '2') AND
  8796           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8797              OR
  8798           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8799           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8800           (AM-IG NOT = '1'))
  8801              GO TO 03XX-GET-LIFE-ERPLAN.
  8802
  8803     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8804       AND
  8805        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8806        IF CF-LEVEL    (SUB3)
  8807           IF (PB-I-INDV-GRP-OVRD = 'I')
  8808              OR
  8809           ((AM-IG = '1') AND
  8810           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8811              OR
  8812           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8813           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8814            (AM-IG NOT = '2'))
  8815              GO TO 03XX-GET-LIFE-ERPLAN.
  8816
  8817     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8818       AND
  8819        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8820        IF CF-LEVEL    (SUB3)
  8821           IF (PB-I-INDV-GRP-OVRD = 'G')
  8822              OR
  8823           ((AM-IG = '2') AND
  8824           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8825              OR
  8826           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8827           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8828           (AM-IG NOT = '1'))
  8829              GO TO 03XX-GET-LIFE-ERPLAN.
  8830
  8831     IF SUB5 LESS THAN +30
  8832        ADD +1                   TO SUB5
  8833        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8834
  8835     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8836
  8837 03XX-EDIT-FOR-NINETY-LF-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 161
* EL050.cbl
  8838
  8839     MOVE +99                    TO SUB5.
  8840
  8841     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8842        IF PB-ISSUE
  8843           MOVE ER-1924          TO  WS-ERROR
  8844           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8845
  8846     GO TO 0304-LIFE-BENEFIT-FOUND.
  8847
  8848 03XX-GET-LIFE-ERPLAN.
  8849
  8850     IF WK-PLAN-ADDR EQUAL +0
  8851        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8852
  8853     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8854     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8855     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8856     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8857     MOVE 'Y'                    TO PLAN-MASTER-SW
  8858                                    PLAN-MASTER-LIFE-SW.
  8859     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8860
  8861 03XX-ERPLAN-LIFE-GETMAIN.
  8862
  8863     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8864     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8865
  8866 03XX-ERPLAN-LIFE-READ.
  8867
  8868     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8869     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8870     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8871     MOVE PB-SV-STATE            TO PLAN-STATE.
  8872     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8873     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8874     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8875     MOVE WS-SAVE-BENEFIT-REVISION
  8876                                 TO PLAN-REVISION-NO.
  8877
  8878     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8879     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8880
  8881     IF PB-COMPANY-ID = 'NCL'
  8882       IF NOT LF-PLAN-MASTER-FOUND
  8883         IF NOT PB-POLICY-IS-DECLINED  AND
  8884            NOT PB-POLICY-IS-VOIDED
  8885             MOVE  ER-1921         TO  WS-ERROR
  8886             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8887             GO TO 0304-LIFE-BENEFIT-FOUND.
  8888
  8889     IF NOT LF-PLAN-MASTER-FOUND
  8890        GO TO 0304-LIFE-BENEFIT-FOUND.
  8891
  8892 XXXX-CHECK-LF-PLAN-KEY.
  8893
  8894     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8895        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 162
* EL050.cbl
  8896        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8897        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8898        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8899        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8900        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8901        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8902        MOVE 'N'                 TO PLAN-MASTER-SW
  8903          GO TO 03XX-ERPLAN-LIFE-READ.
  8904
  8905     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8906
  8907     IF  PB-CANCELLATION
  8908         GO TO  0303-LF-ACCT-BEN-FOUND.
  8909
  8910     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8911        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8912           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8913           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8914              MOVE ER-2644             TO WS-ERROR
  8915              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8916           ELSE
  8917              NEXT SENTENCE
  8918        ELSE
  8919           IF PB-COMPANY-ID NOT = 'NCL'
  8920              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8921                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8922
  8923 0303-LF-ACCT-BEN-FOUND.
  8924
  8925     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8926
  8927     IF PL-DEV-CODE NOT = SPACES
  8928        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8929
  8930     IF PL-DEV-PCT NUMERIC AND
  8931        PL-DEV-PCT NOT = ZEROS
  8932        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8933
  8934     IF PL-TOL-PREM-AMT GREATER THAN +0
  8935        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8936
  8937     IF PL-TOL-REF-AMT GREATER THAN +0
  8938        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8939
  8940     IF PL-TOL-PREM-PCT GREATER THAN +0
  8941        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8942
  8943     IF PL-TOL-REF-PCT GREATER THAN +0
  8944        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8945
  8946     IF PL-TOL-CLM-AMT GREATER THAN +0
  8947        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8948
  8949     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8950                          PL-OVER-SHORT-AMT > +0
  8951        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8952
  8953     IF PL-OVER-SHORT-PCT NUMERIC  AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 163
* EL050.cbl
  8954                          PL-OVER-SHORT-PCT > +0
  8955        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8956
  8957     IF PL-SALES-TAX NUMERIC AND
  8958                          PL-SALES-TAX > +0
  8959         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8960
  8961     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8962        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8963                                    WS-IG-OVRD-AM.
  8964
  8965 0304-LIFE-BENEFIT-FOUND.
  8966
  8967     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8968
  8969     IF PB-ISSUE
  8970        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8971     ELSE
  8972        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8973
  8974     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8975     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8976     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8977     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8978     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8979                                         WS-LF-REFUND-CALC.
  8980     if (ws-lf-earnings-calc = '5')
  8981        and (pb-i-loan-apr = zeros)
  8982        and (benefit-code-chg)
  8983        move +99.9999 to pb-i-loan-apr
  8984     end-if
  8985
  8986     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8987        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8988
  8989     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8990        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8991     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8992
  8993     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8994     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8995     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8996     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8997     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8998     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8999
  9000     IF PB-COMPANY-ID = 'NCL'  AND
  9001        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9002         NEXT SENTENCE
  9003     ELSE
  9004         IF SUB5 NOT GREATER THAN +20
  9005            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9006               MOVE WS-SAVE-BENEFIT-REM-TERM
  9007                                      TO WS-AM-LF-BENE-REM-TERM
  9008                                         EC-BR-LF-REM-TERM-CALC.
  9009
  9010     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9011     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 164
* EL050.cbl
  9012
  9013     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9014
  9015 0305-BENEFIT-NOT-FOUND.
  9016
  9017     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9018     MOVE ER-2604                TO WS-ERROR.
  9019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9020
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 165
* EL050.cbl
  9022
  9023 0310-FIND-AH-BENEFIT-RECORD.
  9024
  9025     MOVE 'N'                    TO PLAN-MASTER-SW
  9026                                    PLAN-MASTER-AH-SW.
  9027
  9028     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9029                                    WS-PL-TOL-AH-REFUND
  9030                                    WS-AH-PL-REF-OVS-AMT
  9031                                    WS-PL-TOL-AH-PREM-PCT
  9032                                    WS-PL-TOL-AH-REFUND-PCT
  9033                                    WS-AH-PL-REF-OVS-PCT
  9034                                    WS-PL-TOL-AH-CLAIM.
  9035     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9036
  9037
  9038     if pb-issue
  9039        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9040           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9041        end-if
  9042        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9043           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9044           GO TO 0399-BENEFIT-NOT-FOUND
  9045        end-if
  9046     end-if
  9047
  9048     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9049        GO TO 0400-FIND-CARRIER.
  9050
  9051     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9052
  9053     IF WK-AH-BEN-ADDR NOT = ZEROS
  9054         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9055         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9056         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9057         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9058           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9059             GO TO 0311-AH-BENEFIT-SEARCH
  9060         ELSE
  9061             NEXT SENTENCE
  9062     ELSE
  9063         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9064
  9065     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9066     MOVE '5'                    TO CNTL-REC-TYPE.
  9067     MOVE +0                     TO CNTL-SEQ-NO.
  9068     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9069
  9070     MOVE '2' TO RC-SW-2.
  9071     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9072
  9073     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9074        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9075          GO TO 0399-BENEFIT-NOT-FOUND.
  9076
  9077     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9078
  9079 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 166
* EL050.cbl
  9080
  9081     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9082
  9083     IF NO-BENEFIT-FOUND
  9084         GO TO 0399-BENEFIT-NOT-FOUND.
  9085
  9086     IF WS-BEN-CD = '99'
  9087        GO TO 0399-BENEFIT-NOT-FOUND.
  9088
  9089     IF PB-COMPANY-ID  =  'NCL'
  9090         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9091             GO TO 0314-A-H-BENEFIT-FOUND.
  9092
  9093     MOVE +1                     TO SUB5.
  9094     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9095
  9096* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9097* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9098     IF PB-COMPANY-ID = 'DMD'
  9099         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9100
  9101 0312-EDIT-ACCT-AH-BENEFITS.
  9102
  9103     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9104        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9105           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9106                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9107           GO TO 03XX-GET-AH-ERPLAN.
  9108
  9109     IF SUB5 LESS THAN +20
  9110        ADD +1                   TO SUB5
  9111        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9112
  9113     MOVE +1                     TO SUB5.
  9114
  9115     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9116        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9117
  9118 0313-EDIT-DMD-EXTRA-BENEFITS.
  9119
  9120     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9121        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9122           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9123                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9124           GO TO 03XX-GET-AH-ERPLAN.
  9125
  9126     IF SUB5 LESS THAN +30
  9127        ADD +1                   TO SUB5
  9128        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9129
  9130     MOVE +1                     TO SUB5.
  9131
  9132 03XX-EDIT-FOR-NINETY-AH.
  9133
  9134***************************************************************
  9135*                                                             *
  9136*    NINETY BENEFIT PLAN TYPES:                               *
  9137*                                                             *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 167
* EL050.cbl
  9138*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9139*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9140*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9141*           BENEFIT CONTROLS.                                 *
  9142*      99 = ALL BENEFITS.                                     *
  9143*                                                             *
  9144***************************************************************
  9145
  9146     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9147                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9148
  9149     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9150       AND
  9151        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9152        GO TO 03XX-GET-AH-ERPLAN.
  9153
  9154     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9155       AND
  9156        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9157           IF (PB-I-INDV-GRP-OVRD = 'I')
  9158              OR
  9159           ((AM-IG = '1') AND
  9160           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9161              OR
  9162           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9163           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9164           (AM-IG NOT = '2'))
  9165              GO TO 03XX-GET-AH-ERPLAN.
  9166
  9167     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9168       AND
  9169        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9170           IF (PB-I-INDV-GRP-OVRD = 'G')
  9171              OR
  9172           ((AM-IG = '2') AND
  9173           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9174              OR
  9175           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9176           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9177           (AM-IG NOT = '1'))
  9178              GO TO 03XX-GET-AH-ERPLAN.
  9179
  9180     IF SUB5 LESS THAN +20
  9181        ADD +1                   TO SUB5
  9182        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9183
  9184     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9185        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9186
  9187     MOVE +1                    TO SUB5.
  9188
  9189 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9190
  9191     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9192                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9193
  9194     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9195       AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 168
* EL050.cbl
  9196        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9197        GO TO 03XX-GET-AH-ERPLAN.
  9198
  9199     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9200       AND
  9201        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9202           IF (PB-I-INDV-GRP-OVRD = 'I')
  9203              OR
  9204           ((AM-IG = '1') AND
  9205           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9206              OR
  9207           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9208           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9209           (AM-IG NOT = '2'))
  9210              GO TO 03XX-GET-AH-ERPLAN.
  9211
  9212     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9213       AND
  9214        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9215           IF (PB-I-INDV-GRP-OVRD = 'G')
  9216              OR
  9217           ((AM-IG = '2') AND
  9218           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9219              OR
  9220           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9221           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9222           (AM-IG NOT = '1'))
  9223              GO TO 03XX-GET-AH-ERPLAN.
  9224
  9225     IF SUB5 LESS THAN +30
  9226        ADD +1                   TO SUB5
  9227        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9228
  9229 03XX-EDIT-FOR-NINETY-AH-CONT.
  9230
  9231     MOVE +99                    TO SUB5.
  9232
  9233     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9234
  9235     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9236        IF PB-ISSUE
  9237           MOVE ER-1925          TO  WS-ERROR
  9238           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9239
  9240     GO TO 0314-A-H-BENEFIT-FOUND.
  9241
  9242 03XX-GET-AH-ERPLAN.
  9243
  9244     IF WK-PLAN-ADDR EQUAL +0
  9245         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9246
  9247     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9248     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9249     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9250     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9251     MOVE 'Y'                    TO PLAN-MASTER-SW
  9252                                    PLAN-MASTER-AH-SW.
  9253*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 169
* EL050.cbl
  9254     GO TO 03XX-ERPLAN-AH-READ.
  9255
  9256 03XX-ERPLAN-AH-GETMAIN.
  9257
  9258     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9259     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9260
  9261 03XX-ERPLAN-AH-READ.
  9262
  9263     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9264     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9265     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9266     MOVE PB-SV-STATE            TO PLAN-STATE.
  9267     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9268     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9269     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9270     MOVE WS-SAVE-BENEFIT-REVISION
  9271                                 TO PLAN-REVISION-NO.
  9272
  9273     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9274     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9275
  9276     IF PB-COMPANY-ID = 'NCL'
  9277       IF NOT AH-PLAN-MASTER-FOUND
  9278         IF NOT PB-POLICY-IS-DECLINED  AND
  9279            NOT PB-POLICY-IS-VOIDED
  9280             MOVE  ER-1922         TO  WS-ERROR
  9281             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9282             GO TO 0314-A-H-BENEFIT-FOUND.
  9283
  9284     IF NOT AH-PLAN-MASTER-FOUND
  9285        GO TO 0314-A-H-BENEFIT-FOUND.
  9286
  9287 XXXX-CHECK-AH-PLAN-KEY.
  9288
  9289     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9290        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9291        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9292        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9293        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9294        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9295        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9296        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9297        MOVE 'N'                 TO PLAN-MASTER-SW
  9298          GO TO 03XX-ERPLAN-AH-READ.
  9299
  9300     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9301
  9302     IF  PB-CANCELLATION
  9303         GO TO  0313-AH-ACCT-BEN-FOUND.
  9304
  9305     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9306       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9307          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9308          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9309             MOVE ER-2644             TO WS-ERROR
  9310             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9311          ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 170
* EL050.cbl
  9312             NEXT SENTENCE
  9313       ELSE
  9314          IF PB-COMPANY-ID NOT = 'NCL'
  9315             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9316                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9317
  9318 0313-AH-ACCT-BEN-FOUND.
  9319
  9320     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9321
  9322     IF PL-DEV-CODE NOT = SPACES
  9323        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9324
  9325     IF PL-DEV-PCT NUMERIC AND
  9326        PL-DEV-PCT NOT = ZEROS
  9327        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9328
  9329     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9330        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9331
  9332     IF PL-TOL-REF-AMT NOT EQUAL +0
  9333        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9334
  9335     IF PL-TOL-PREM-PCT GREATER THAN +0
  9336        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9337
  9338     IF PL-TOL-REF-PCT GREATER THAN +0
  9339        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9340
  9341     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9342        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9343
  9344     IF PL-OVER-SHORT-AMT NUMERIC AND
  9345                          PL-OVER-SHORT-AMT > +0
  9346        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9347
  9348     IF PL-OVER-SHORT-PCT NUMERIC AND
  9349                          PL-OVER-SHORT-PCT > +0
  9350        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9351
  9352     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9353        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9354        IF WS-IG-OVRD-AM EQUAL SPACES
  9355            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9356
  9357 0314-A-H-BENEFIT-FOUND.
  9358
  9359     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9360
  9361     IF PB-ISSUE
  9362        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9363       ELSE
  9364        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9365
  9366     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9367     if cf-maximum-benefits (sub3) numeric
  9368        move cf-maximum-benefits (sub3)
  9369                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 171
* EL050.cbl
  9370     else
  9371        move zeros               to ws-ah-max-bens
  9372     end-if
  9373     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9374     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9375     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9376                                         WS-AH-REFUND-CALC.
  9377
  9378     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9379        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9380
  9381     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9382        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9383     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9384
  9385     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9386     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9387     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9388     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9389     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9390     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9391
  9392     IF PB-COMPANY-ID = 'NCL'  AND
  9393        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9394         NEXT SENTENCE
  9395     ELSE
  9396         IF SUB5 NOT GREATER THAN +20
  9397            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9398                MOVE WS-SAVE-BENEFIT-REM-TERM
  9399                                      TO WS-AM-AH-BENE-REM-TERM
  9400                                         EC-BR-AH-REM-TERM-CALC.
  9401
  9402     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9403     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9404
  9405     GO TO 0400-FIND-CARRIER.
  9406
  9407 0399-BENEFIT-NOT-FOUND.
  9408
  9409     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9410     MOVE ER-2605                TO WS-ERROR.
  9411     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9412
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 172
* EL050.cbl
  9414
  9415 0400-FIND-CARRIER.
  9416
  9417     MOVE PB-SV-CARRIER          TO WS-CARR.
  9418
  9419     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9420     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9421     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9422     MOVE '6'                    TO CNTL-REC-TYPE.
  9423
  9424*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9425     MOVE SPACE                  TO WS-DMD-RATING-SW
  9426                                    EC-BR-DMD-RATING-SW.
  9427
  9428     MOVE '2'                    TO RC-SW-1.
  9429     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9430
  9431     IF NOT CF-CARRIER-MASTER
  9432        GO TO 0400-CARRIER-NOT-FOUND.
  9433
  9434 0400-BUILD-CARR-TOL.
  9435
  9436     IF CF-CR-TOL-PREM NUMERIC AND
  9437        CF-CR-TOL-PREM GREATER THAN +0
  9438        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9439                                    WS-TOL-AH-PREM.
  9440
  9441     IF CF-CR-TOL-REFUND NUMERIC AND
  9442        CF-CR-TOL-REFUND GREATER THAN +0
  9443        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9444                                    WS-TOL-AH-REFUND.
  9445
  9446     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9447        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9448        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9449                                    WS-AH-REFUND-OVS-AMT.
  9450
  9451     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9452        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9453        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9454                                    WS-AH-REFUND-OVS-PCT.
  9455
  9456     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9457        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9458        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9459                                    WS-TOL-AH-PREM-PCT.
  9460
  9461     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9462        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9463        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9464                                     WS-TOL-AH-REFUND-PCT.
  9465
  9466     IF CF-COMPANY-ID EQUAL 'DMD'
  9467         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9468                                    EC-BR-DMD-RATING-SW.
  9469
  9470     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9471     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 173
* EL050.cbl
  9472        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9473     END-IF
  9474     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9475        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9476     END-IF
  9477     IF WS-TOL-CLP-PCT = ZEROS
  9478        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9479     END-IF
  9480
  9481     IF WS-SPP-LEASE-COMM = ZEROS
  9482        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9483     END-IF
  9484     GO TO 0400-FIND-ERPDEF.
  9485
  9486 0400-CARRIER-NOT-FOUND.
  9487
  9488     MOVE ER-2602                TO WS-ERROR.
  9489     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9490
  9491 0400-FIND-ERPDEF.
  9492*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9493     IF (PB-COMPANY-ID = 'DCC')
  9494        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9495        CONTINUE
  9496     ELSE
  9497        GO TO 0400-FIND-ERCOMP
  9498     END-IF
  9499     MOVE ' '                    TO PDEF-MASTER-SW
  9500     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9501     MOVE PB-STATE               TO ERPDEF-STATE
  9502     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9503        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9504     END-IF
  9505     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9506     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9507     IF PB-ISSUE
  9508        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9509     ELSE
  9510        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9511     END-IF
  9512     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9513     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9514     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9515     IF PDEF-MASTER-FOUND
  9516        MOVE 'N'                 TO PDEF-MASTER-SW
  9517        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9518        IF PDEF-MASTER-FOUND
  9519           IF (ERPDEF-KEY-SAVE (1:16) =
  9520                        PD-CONTROL-PRIMARY (1:16))
  9521              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9522              CONTINUE
  9523           ELSE
  9524              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9525              IF (ERPDEF-KEY-SAVE (1:16) =
  9526                        PD-CONTROL-PRIMARY (1:16))
  9527                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9528                 CONTINUE
  9529              ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 174
* EL050.cbl
  9530                 MOVE 'N'        TO PDEF-MASTER-SW
  9531              END-IF
  9532           END-IF
  9533        END-IF
  9534        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9535     END-IF
  9536     IF PDEF-MASTER-FOUND
  9537        IF PD-TRUNCATED = 'Y'
  9538           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9539        END-IF
  9540     END-IF
  9541     .
  9542 0400-FIND-ERCOMP.
  9543     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9544        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9545           (WS-SUB1 > +10)
  9546           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9547                 OR 'A' OR 'N'
  9548              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9549              MOVE PB-CARRIER    TO COMP-CARRIER
  9550              MOVE PB-GROUPING   TO COMP-GROUPING
  9551              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9552              MOVE AM-AGT (WS-SUB1)
  9553                                 TO COMP-FIN-RESP
  9554              MOVE 'G'           TO COMP-TYPE
  9555              PERFORM 8582-READ-COMPENSATION-MASTER
  9556                                 THRU 8582-EXIT
  9557              IF COMP-MASTER-FOUND
  9558                 IF CO-GA-INACTIVE
  9559                    MOVE ER-2763 TO WS-ERROR
  9560                    PERFORM 9900-ERROR-FORMAT
  9561                                 THRU 9900-EXIT
  9562                    MOVE +11     TO WS-SUB1
  9563                 END-IF
  9564                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9565                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9566                    MOVE ER-2788 TO WS-ERROR
  9567                    PERFORM 9900-ERROR-FORMAT
  9568                                 THRU 9900-EXIT
  9569                    MOVE +11     TO WS-SUB1
  9570                 END-IF
  9571              END-IF
  9572           END-IF
  9573        END-PERFORM
  9574     END-IF
  9575     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9576        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9577           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9578                                    WS-CLP-STATE
  9579        ELSE
  9580           MOVE SPACES           TO PB-I-CLP-STATE
  9581                                    WS-CLP-STATE
  9582        END-IF
  9583     END-IF
  9584
  9585     IF (PB-COMPANY-ID = 'DCC')
  9586        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9587        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 175
* EL050.cbl
  9588        CONTINUE
  9589     ELSE
  9590        GO TO 0400-FIND-STATE-RECORD
  9591     END-IF
  9592     MOVE SPACES                 TO WS-CLP-STATE
  9593     MOVE +0                     TO WS-BANK-FEE
  9594                                    WS-BANK-LFEE
  9595                                    WS-BANK-NOCHRGB
  9596
  9597     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9598     IF (PB-ISSUE)
  9599        AND (PB-I-BANK-NUMBER NOT =
  9600            SPACES AND ZEROS AND LOW-VALUES)
  9601        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9602     ELSE
  9603        IF (PB-CANCELLATION)
  9604           AND (PB-CI-BANK-NUMBER NOT =
  9605                SPACES AND ZEROS AND LOW-VALUES)
  9606           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9607        END-IF
  9608     END-IF
  9609     IF COMP-FIN-RESP NOT = LOW-VALUES
  9610        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9611        MOVE PB-CARRIER          TO COMP-CARRIER
  9612        MOVE PB-GROUPING         TO COMP-GROUPING
  9613        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9614        MOVE 'B'                 TO COMP-TYPE
  9615        PERFORM 8582-READ-COMPENSATION-MASTER
  9616                                 THRU 8582-EXIT
  9617        IF COMP-MASTER-FOUND
  9618           IF CO-MAX-BANK-FEE NOT NUMERIC
  9619              MOVE +0            TO CO-MAX-BANK-FEE
  9620           END-IF
  9621           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9622              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9623           END-IF
  9624           IF CO-GA-INACTIVE
  9625              MOVE ER-2763       TO WS-ERROR
  9626              PERFORM 9900-ERROR-FORMAT
  9627                                 THRU 9900-EXIT
  9628           END-IF
  9629           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9630              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9631              MOVE ER-2788 TO WS-ERROR
  9632              PERFORM 9900-ERROR-FORMAT
  9633                                 THRU 9900-EXIT
  9634              MOVE +11     TO WS-SUB1
  9635           END-IF
  9636           IF WS-AH-BEN-CATEGORY = 'G'
  9637              MOVE CO-MAX-BANK-FEE
  9638                                 TO WS-BANK-FEE
  9639                                    PB-I-BANK-FEE
  9640           ELSE
  9641              MOVE CO-MAX-BANK-FEE-LEASE
  9642                                 TO WS-BANK-LFEE
  9643                                    PB-I-BANK-FEE
  9644           END-IF
  9645           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 176
* EL050.cbl
  9646              AND (WS-AH-REFUND-CALC = 'G'))
  9647                        OR
  9648              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9649              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9650              CONTINUE
  9651           ELSE
  9652              MOVE ER-2789 TO WS-ERROR
  9653              PERFORM 9900-ERROR-FORMAT
  9654                                 THRU 9900-EXIT
  9655           END-IF
  9656           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9657                                    PB-I-CLP-STATE
  9658           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9659           MOVE CO-CARRIER       TO BXRF-CARRIER
  9660           MOVE CO-GROUPING      TO BXRF-GROUPING
  9661           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9662           MOVE BXRF-MAX-REC-LENGTH
  9663                                 TO BXRF-REC-LENGTH
  9664           PERFORM 8584-READ-BANK-CROSS-REF
  9665                                 THRU 8584-EXIT
  9666           IF BXRF-MASTER-FOUND
  9667              MOVE ' '           TO BANK-ACCT-SW
  9668              MOVE BK-BANK-POINTER-CNT
  9669                                 TO BK-BANK-POINTER-CNT
  9670              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9671                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9672                 OR (BANK-ACCT-FOUND)
  9673                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9674                    AND (BK-AM-EXP-DT (WS-SUB1)
  9675                                 > PB-CERT-EFF-DT)
  9676                    AND (BK-AM-EFF-DT (WS-SUB1)
  9677                                 NOT > PB-CERT-EFF-DT)
  9678                    SET BANK-ACCT-FOUND TO TRUE
  9679                 END-IF
  9680              END-PERFORM
  9681              IF NOT BANK-ACCT-FOUND
  9682                 MOVE ZEROS      TO WS-BANK-FEE
  9683                                    WS-BANK-LFEE
  9684                 MOVE ER-2869    TO WS-ERROR
  9685                 PERFORM 9900-ERROR-FORMAT
  9686                                 THRU 9900-EXIT
  9687              ELSE
  9688                 PERFORM 5000-PROCESS-REPS
  9689                                 THRU 5000-EXIT
  9690                 IF AGENT-MASTER-FOUND
  9691                    MOVE +0      TO WS-BANK-FEE
  9692                                    WS-BANK-LFEE
  9693*                   MOVE AG-SPP-FEES (1)
  9694*                                TO PB-I-BANK-FEE
  9695*                                   WS-BANK-FEE
  9696                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9697                       (WS-SUB1 > +10)
  9698                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9699                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9700                       END-IF
  9701                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9702                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9703                       END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 177
* EL050.cbl
  9704                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9705                          AG-SPP-FEES (WS-SUB1)
  9706                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9707                          AG-SPP-LFEES (WS-SUB1)
  9708                    END-PERFORM
  9709                    IF WS-AH-BEN-CATEGORY = 'G'
  9710                       MOVE WS-BANK-FEE
  9711                                 TO PB-I-BANK-FEE
  9712                    ELSE
  9713                       MOVE WS-BANK-LFEE
  9714                                 TO PB-I-BANK-FEE
  9715                    END-IF
  9716                 END-IF
  9717              END-IF
  9718           END-IF
  9719        ELSE
  9720           MOVE ER-2879          TO WS-ERROR
  9721           PERFORM 9900-ERROR-FORMAT
  9722                                 THRU 9900-EXIT
  9723        END-IF
  9724     ELSE
  9725        MOVE ER-2879             TO WS-ERROR
  9726        PERFORM 9900-ERROR-FORMAT
  9727                                 THRU 9900-EXIT
  9728     END-IF
  9729     IF WS-AH-BEN-CATEGORY = 'G'
  9730        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9731        + WS-BANK-FEE
  9732     ELSE
  9733        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9734        + WS-BANK-LFEE
  9735     END-IF
  9736     .
  9737 0400-FIND-STATE-RECORD.
  9738
  9739     IF WK-STATE-ADDR NOT = ZEROS
  9740         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9741         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9742         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9743         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9744         IF PB-SV-STATE = CF-STATE-CODE
  9745             GO TO 0405-CONTINUE-EDIT
  9746         ELSE
  9747             NEXT SENTENCE
  9748     ELSE
  9749         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9750
  9751     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9752     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9753     MOVE '3'                    TO CNTL-REC-TYPE.
  9754     MOVE +0                     TO CNTL-SEQ-NO.
  9755
  9756     MOVE '3'                    TO RC-SW-2.
  9757     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9758
  9759     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9760        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9761        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 178
* EL050.cbl
  9762        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9763                                    WS-TOL-AH-CLAIM
  9764                                    WS-MINIMUM-REFUND
  9765                                    WS-TOL-LF-PREM
  9766                                    WS-TOL-AH-PREM
  9767                                    WS-TOL-LF-REFUND
  9768                                    WS-TOL-AH-REFUND
  9769                                    EC-ST-TOL-PREM-PCT
  9770                                    WS-TOL-LF-PREM-PCT
  9771                                    WS-TOL-AH-PREM-PCT
  9772                                    EC-ST-TOL-REFUND-PCT
  9773                                    WS-TOL-LF-REFUND-PCT
  9774                                    WS-TOL-AH-REFUND-PCT
  9775                                    EC-ST-TOL-PREM
  9776                                    EC-ST-TOL-REFUND
  9777                                    EC-ST-FST-PMT-DAYS-MAX
  9778                                    WS-FREE-LOOK-PERIOD
  9779                                    WS-ST-LF-PREM-TAX
  9780                                    WS-ST-AH-PREM-TAX-I
  9781                                    WS-ST-AH-PREM-TAX-G
  9782                                    WS-BANK-FEE
  9783                                    WS-BANK-LFEE
  9784                                    WS-TOL-CLP-PCT
  9785                                    WS-SPP-LEASE-COMM
  9786                                    WS-INT-PERIODS
  9787                                    WS-EXTRA-PMTS
  9788        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9789                                    EC-ST-FST-PMT-DAYS-CHG
  9790                                    WS-LF-REM-TERM-CALC
  9791                                    WS-LF-REFUND-CALC
  9792                                    EC-ST-LF-REM-TERM-CALC
  9793                                    EC-ST-LF-REFUND-CALC
  9794                                    WS-AH-REM-TERM-CALC
  9795                                    WS-AH-REFUND-CALC
  9796                                    WS-LF-BEN-CATEGORY
  9797                                    WS-AH-BEN-CATEGORY
  9798                                    WS-CLP-STATE
  9799                                    WS-ST-REFUND-CLAIM-FLAG
  9800                                    WS-ST-CAUSAL-STATE
  9801                                    ws-st-agent-sig-edit
  9802                                    EC-ST-AH-REM-TERM-CALC
  9803                                    EC-ST-AH-REFUND-CALC
  9804          GO TO 0499-STATE-NOT-FOUND.
  9805
  9806     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9807
  9808 0405-CONTINUE-EDIT.
  9809
  9810     if pb-company-id = 'AHL'
  9811        continue
  9812     else
  9813        IF PB-CERT-PRIME NOT NUMERIC
  9814           MOVE ER-2722          TO WS-ERROR
  9815           PERFORM 9900-ERROR-FORMAT
  9816                                 THRU 9900-EXIT
  9817        end-if
  9818     END-IF
  9819*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 179
* EL050.cbl
  9820*       MOVE +0                  TO SUB3
  9821*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9822*       IF SUB3 > +0
  9823*          MOVE ER-2722          TO WS-ERROR
  9824*          PERFORM 9900-ERROR-FORMAT
  9825*                                THRU 9900-EXIT
  9826*       END-IF
  9827*    END-IF
  9828*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9829*       IF PB-CERT-PRIME NOT NUMERIC
  9830*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9831*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9832*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9833*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9834*
  9835*          MOVE ER-2722          TO WS-ERROR
  9836*          PERFORM 9900-ERROR-FORMAT
  9837*                                THRU 9900-EXIT
  9838*       END-IF
  9839*    END-IF
  9840
  9841     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9842
  9843     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9844        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9845                                    WS-TOL-AH-CLAIM.
  9846
  9847     IF CF-ST-REFUND-MIN NOT NUMERIC
  9848        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9849
  9850     IF CF-ST-REFUND-MIN NOT = ZEROS
  9851        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9852
  9853     IF CF-ST-TOL-PREM  NOT = ZEROS
  9854        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9855                                    WS-TOL-AH-PREM
  9856        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9857
  9858     IF CF-ST-TOL-REFUND NOT = ZEROS
  9859        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9860                                    WS-TOL-AH-REFUND
  9861        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9862
  9863     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9864        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9865        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9866                                    WS-AH-REFUND-OVS-AMT
  9867                                    EC-ST-OVR-SHT-AMT.
  9868
  9869     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9870        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9871        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9872                                    WS-TOL-LF-PREM-PCT
  9873                                    WS-TOL-AH-PREM-PCT.
  9874
  9875     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9876        CF-ST-TOL-REF-PCT GREATER THAN +0
  9877        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 180
* EL050.cbl
  9878                                    WS-TOL-LF-REFUND-PCT
  9879                                    WS-TOL-AH-REFUND-PCT.
  9880
  9881     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9882        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9883        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9884                                    WS-AH-REFUND-OVS-PCT
  9885                                    EC-ST-OVR-SHT-PCT.
  9886
  9887     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9888     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9889
  9890     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9891          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9892
  9893     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9894     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9895     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9896
  9897     IF CF-ST-LF-PREM-TAX NUMERIC
  9898        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9899     END-IF
  9900     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9901        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9902     END-IF
  9903     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9904        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9905     END-IF
  9906
  9907     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9908         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9909     END-IF.
  9910
  9911     IF CF-ST-CAUSAL-STATE > SPACES
  9912         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9913     END-IF.
  9914     if cf-st-extra-interest-periods not numeric
  9915        move zeros               to cf-st-extra-interest-periods
  9916     end-if
  9917     if cf-st-extra-payments not numeric
  9918        move zeros               to cf-st-extra-payments
  9919     end-if
  9920
  9921     move cf-st-extra-interest-periods
  9922                                 to ws-int-periods
  9923     move cf-st-extra-payments   to ws-extra-pmts
  9924     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9925     move cf-st-net-only-state   to ws-net-only-state
  9926     IF WS-LF-BENEFIT-CD = ZEROS
  9927        GO TO 0410-CHECK-AH.
  9928
  9929     IF CF-ST-RT-CALC NOT = SPACES
  9930        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9931                                    EC-ST-LF-REM-TERM-CALC
  9932     END-IF
  9933
  9934     IF WS-LF-COVERAGE-TYPE = 'R'
  9935        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 181
* EL050.cbl
  9936           IF CF-ST-RF-LN-CALC > '0'
  9937              MOVE CF-ST-RF-LN-CALC
  9938                                 TO WS-LF-REFUND-CALC
  9939                                    EC-ST-LF-REFUND-CALC
  9940           END-IF
  9941        ELSE
  9942           IF CF-ST-RF-LR-CALC > '0'
  9943              MOVE CF-ST-RF-LR-CALC
  9944                                 TO WS-LF-REFUND-CALC
  9945                                    EC-ST-LF-REFUND-CALC
  9946           END-IF
  9947        END-IF
  9948     ELSE
  9949        IF CF-ST-RF-LL-CALC > '0'
  9950           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9951                                    EC-ST-LF-REFUND-CALC
  9952        END-IF
  9953     END-IF
  9954
  9955     IF CF-ST-RT-CALC NOT = SPACES
  9956        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9957                                    EC-ST-LF-REM-TERM-CALC
  9958     END-IF
  9959
  9960     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9961     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9962
  9963     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9964
  9965     IF NO-BENEFIT-FOUND
  9966        GO TO 0410-CHECK-AH.
  9967
  9968     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9969        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9970                                 TO EC-ST-LF-REM-TERM-CALC
  9971                                    WS-LF-REM-TERM-CALC
  9972     END-IF
  9973
  9974     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9975        MOVE CF-ST-REFUND-CALC (SUB3)
  9976                                 TO WS-LF-REFUND-CALC
  9977                                    EC-ST-LF-REFUND-CALC
  9978     END-IF
  9979*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9980     if cf-st-extra-periods (sub3) not numeric
  9981        move zeros               to cf-st-extra-periods (sub3)
  9982     end-if
  9983     if cf-st-extra-periods (sub3) > zeros
  9984        if ws-lf-ben-category = 'P'
  9985           move cf-st-extra-periods (sub3)
  9986                                 to ws-extra-pmts
  9987        else
  9988           if ws-lf-ben-category = 'I'
  9989              move cf-st-extra-periods (sub3)
  9990                                 to ws-int-periods
  9991           end-if
  9992        end-if
  9993     end-if
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 182
* EL050.cbl
  9994     .
  9995 0410-CHECK-AH.
  9996
  9997     IF WS-AH-BENEFIT-CD = ZEROS
  9998        GO TO 0500-SET-ACCOUNT.
  9999
 10000     IF CF-ST-RT-CALC NOT = SPACES
 10001        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10002                                    EC-ST-AH-REM-TERM-CALC
 10003     END-IF
 10004
 10005     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10006        IF CF-ST-RF-CP-CALC > '0'
 10007           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10008                                    EC-ST-AH-REFUND-CALC
 10009        END-IF
 10010     ELSE
 10011        IF CF-ST-RF-AH-CALC > '0'
 10012           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10013                                    EC-ST-AH-REFUND-CALC
 10014        END-IF
 10015     END-IF
 10016     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10017     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10018
 10019     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10020
 10021     IF NO-BENEFIT-FOUND
 10022        GO TO 0500-SET-ACCOUNT.
 10023
 10024     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10025        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10026                                 TO WS-AH-REM-TERM-CALC
 10027                                    EC-ST-AH-REM-TERM-CALC
 10028     END-IF
 10029
 10030     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10031        MOVE CF-ST-REFUND-CALC (SUB3)
 10032                                 TO WS-AH-REFUND-CALC
 10033                                    EC-ST-AH-REFUND-CALC
 10034     END-IF
 10035
 10036*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10037
 10038     GO TO 0500-SET-ACCOUNT.
 10039
 10040 0499-STATE-NOT-FOUND.
 10041
 10042     MOVE ER-2603                TO WS-ERROR.
 10043     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10044
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 183
* EL050.cbl
 10046
 10047 0500-SET-ACCOUNT.
 10048*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10049     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10050        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10051        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10052        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10053        MOVE '3'                 TO CNTL-REC-TYPE
 10054        MOVE +0                  TO CNTL-SEQ-NO
 10055
 10056        MOVE '3'                 TO RC-SW-2
 10057        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10058
 10059        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10060           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10061           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10062           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10063                                    WS-ST-AH-PREM-TAX-I
 10064                                    WS-ST-AH-PREM-TAX-G
 10065        ELSE
 10066           IF CF-ST-LF-PREM-TAX NUMERIC
 10067              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10068           END-IF
 10069           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10070              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10071           END-IF
 10072           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10073              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10074           END-IF
 10075        END-IF
 10076        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10077     END-IF
 10078*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10079*  FOR DCC ONLY
 10080     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10081
 10082        MOVE ' '                 TO STAT-MASTER-SW
 10083        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10084        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10085        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10086        MOVE PB-STATE            TO ELSTAT-STATE
 10087        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10088           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10089        END-IF
 10090
 10091        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10092        SET BIN-TO-GREG          TO TRUE
 10093        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10094        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10095        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10096
 10097        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10098        IF STAT-MASTER-FOUND
 10099           MOVE 'N'              TO STAT-MASTER-SW
 10100           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10101           IF STAT-MASTER-FOUND
 10102              IF (ELSTAT-KEY-SAVE (1:12) =
 10103                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 184
* EL050.cbl
 10104                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10105                    MOVE 'F'        TO STAT-MASTER-SW
 10106                 ELSE
 10107                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10108                    IF (STAT-MASTER-FOUND)
 10109                       AND (ELSTAT-KEY-SAVE (1:12) =
 10110                           SF-CONTROL-PRIMARY (1:12))
 10111                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10112                       MOVE 'F'     TO STAT-MASTER-SW
 10113                    END-IF
 10114                 END-IF
 10115              END-IF
 10116           END-IF
 10117        END-IF
 10118
 10119        IF STAT-MASTER-SW = 'F'
 10120           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10121              and (sf-st-lf-prem-tax > zeros)
 10122              MOVE SF-ST-LF-PREM-TAX
 10123                                 TO WS-ST-LF-PREM-TAX
 10124           END-IF
 10125           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10126              and (sf-st-ah-prem-tax-i > zeros)
 10127              MOVE SF-ST-AH-PREM-TAX-I
 10128                                 TO WS-ST-AH-PREM-TAX-I
 10129           END-IF
 10130           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10131              and (sf-st-ah-prem-tax-g > zeros)
 10132              MOVE SF-ST-AH-PREM-TAX-G
 10133                                 TO WS-ST-AH-PREM-TAX-G
 10134           END-IF
 10135        END-IF
 10136     END-IF
 10137     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10138        AND (PB-ISSUE)
 10139        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10140        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10141        AND (AM-GPCD = 06)
 10142        MOVE 'Y'                 TO WS-GOOD-HIN
 10143        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10144           MOVE PB-I-VIN         TO WS-WORK-VIN
 10145           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10146              (V1 > 16)
 10147              IF WS-WORK-VIN (V1:1) NUMERIC
 10148                 MOVE WS-WORK-VIN-N (V1)
 10149                                 TO WS-ROW-B-VAL (V1)
 10150              ELSE
 10151                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10152                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10153                    OR (V2 > 26)
 10154                 END-PERFORM
 10155                 IF V2 < 27
 10156                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10157                 ELSE
 10158                    MOVE 'N'     TO WS-GOOD-HIN
 10159                 END-IF
 10160              END-IF
 10161              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 185
* EL050.cbl
 10162                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10163              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10164                 WS-ROW-D-VAL (V1)
 10165           END-PERFORM
 10166           MOVE ZEROS            TO WS-VIN-REMAINDER
 10167           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10168             REMAINDER WS-VIN-REMAINDER
 10169           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10170              CONTINUE
 10171           ELSE
 10172              MOVE 'N'           TO WS-GOOD-HIN
 10173           END-IF
 10174        ELSE
 10175           MOVE 'N'              TO WS-GOOD-HIN
 10176        END-IF
 10177        IF WS-GOOD-HIN NOT = 'Y'
 10178           MOVE ER-3826           TO WS-ERROR
 10179           PERFORM 9900-ERROR-FORMAT
 10180                                 THRU 9900-EXIT
 10181        END-IF
 10182     END-IF
 10183     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10184        AND (PB-ISSUE)
 10185        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10186        AND (AM-GPCD NOT = 06)
 10187        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10188           perform 3400-edit-vin thru 3400-exit
 10189        ELSE
 10190          MOVE ER-3826           TO WS-ERROR
 10191          PERFORM 9900-ERROR-FORMAT
 10192                                 THRU 9900-EXIT
 10193        END-IF
 10194     END-IF
 10195     if (pb-company-id = 'CID')
 10196        and (pb-issue)
 10197        and (pb-i-vin not = spaces and low-values and zeros)
 10198        perform 3400-edit-vin    thru 3400-exit
 10199     end-if
 10200******************************************************************
 10201******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10202******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10203******* METHODS.
 10204******************************************************************
 10205     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10206        IF PB-CANCELLATION
 10207           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10208              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10209                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10210                IF FORM-MASTER-FOUND
 10211                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10212******************************************************************
 10213
 10214     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10215     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10216
 10217     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10218     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10219     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 186
* EL050.cbl
 10220     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10221
 10222
 10223     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10224     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10225     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10226
 10227     IF AM-LF-OB-RATE NOT NUMERIC
 10228         MOVE ZERO               TO AM-LF-OB-RATE.
 10229
 10230     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10231         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10232
 10233     IF AM-AH-OB-RATE NOT NUMERIC
 10234         MOVE ZERO               TO AM-AH-OB-RATE.
 10235
 10236     IF WS-LF-JOINT-INDICATOR = 'J'
 10237         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10238     ELSE
 10239         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10240
 10241     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10242
 10243     IF WS-IG-OVRD-AM  EQUAL SPACE
 10244         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10245
 10246     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10247         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10248                                       WS-IG-OVRD
 10249     ELSE
 10250         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10251             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10252                                       WS-IG-OVRD
 10253         ELSE
 10254             MOVE AM-IG             TO WS-IG-OVRD-AH
 10255                                       WS-IG-OVRD.
 10256
 10257     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10258         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10259                                       WS-IG-OVRD
 10260     ELSE
 10261         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10262             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10263                                       WS-IG-OVRD
 10264         ELSE
 10265             MOVE AM-IG             TO WS-IG-OVRD-LF
 10266                                       WS-IG-OVRD.
 10267
 10268     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10269     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10270     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10271     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10272*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10273     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10274                                              TO 'PRLDSFCTIA'.
 10275
 10276     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10277     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 187
* EL050.cbl
 10278     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10279     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10280
 10281     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10282     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10283     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10284     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10285     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10286     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10287     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10288
 10289     IF WS-ACCT-AH-DEV-PCT > +0
 10290        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10291     ELSE
 10292        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10293
 10294     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10295        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10296     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10297        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10298
 10299        IF AM-EARN-METHOD-L = 'S'
 10300            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10301                                        WS-LF-REFUND-CALC.
 10302
 10303        IF AM-EARN-METHOD-R = 'S'
 10304            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10305                                        WS-LF-REFUND-CALC.
 10306
 10307     IF WS-LF-COVERAGE-TYPE = 'R'
 10308         IF AM-EARN-METHOD-R = 'R'
 10309            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10310                                    WS-LF-REFUND-CALC.
 10311     IF WS-LF-COVERAGE-TYPE = 'R'
 10312         IF AM-EARN-METHOD-R = 'P'
 10313            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10314                                    WS-LF-REFUND-CALC.
 10315     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10316         IF AM-EARN-METHOD-L = 'R'
 10317            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10318                                    WS-LF-REFUND-CALC.
 10319     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10320         IF AM-EARN-METHOD-L = 'P'
 10321            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10322                                    WS-LF-REFUND-CALC.
 10323     IF WS-LF-COVERAGE-TYPE = 'R'
 10324         IF AM-EARN-METHOD-R = 'A'
 10325            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10326                                    WS-LF-REFUND-CALC.
 10327     IF WS-LF-COVERAGE-TYPE = 'R'
 10328         IF AM-EARN-METHOD-R = 'M'
 10329            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10330                                    WS-LF-REFUND-CALC.
 10331     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10332         IF AM-EARN-METHOD-L = 'A'
 10333            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10334                                    WS-LF-REFUND-CALC.
 10335     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 188
* EL050.cbl
 10336         IF AM-EARN-METHOD-L = 'M'
 10337            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10338                                    WS-LF-REFUND-CALC.
 10339
 10340     IF AM-EARN-METHOD-A = 'R'
 10341        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10342                                    WS-AH-REFUND-CALC.
 10343     IF AM-EARN-METHOD-A = 'P'
 10344        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10345                                    WS-AH-REFUND-CALC.
 10346     IF AM-EARN-METHOD-A = 'C'
 10347        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10348                                    WS-AH-REFUND-CALC.
 10349     IF AM-EARN-METHOD-A = 'A'
 10350        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10351                                    WS-AH-REFUND-CALC.
 10352     IF AM-EARN-METHOD-A = 'M'
 10353        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10354                                    WS-AH-REFUND-CALC.
 10355     IF AM-EARN-METHOD-A = 'N'
 10356        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10357                                    WS-AH-REFUND-CALC.
 10358     IF AM-EARN-METHOD-A = 'S'
 10359        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10360                                    WS-AH-REFUND-CALC.
 10361
 10362     IF AM-TOL-PREM NOT = ZEROS
 10363        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10364                                    WS-TOL-AH-PREM.
 10365
 10366     IF AM-OVR-SHT-AMT NUMERIC AND
 10367                  AM-OVR-SHT-AMT > 0
 10368        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10369                                    EC-AM-LF-OVR-SHT-AMT
 10370                                    WS-AH-REFUND-OVS-AMT
 10371                                    EC-AM-AH-OVR-SHT-AMT.
 10372
 10373     IF AM-OVR-SHT-PCT NUMERIC AND
 10374                    AM-OVR-SHT-PCT > 0
 10375        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10376                                    EC-AM-LF-OVR-SHT-PCT
 10377                                    WS-AH-REFUND-OVS-PCT
 10378                                    EC-AM-AH-OVR-SHT-PCT.
 10379
 10380     IF AM-TOL-REF-PCT NUMERIC AND
 10381                  AM-TOL-REF-PCT > 0
 10382        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10383                                    WS-TOL-AH-REFUND-PCT.
 10384
 10385     IF AM-TOL-REF  NOT = ZEROS  AND
 10386                  AM-TOL-REF NUMERIC
 10387        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10388                                    EC-AM-LF-TOL-REFUND
 10389                                    WS-TOL-AH-REFUND
 10390                                    EC-AM-AH-TOL-REFUND.
 10391
 10392     IF AM-TOL-CLM  NOT = ZEROS
 10393        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 189
* EL050.cbl
 10394                                    WS-TOL-AH-CLAIM.
 10395
 10396     IF AM-CLP-TOL-PCT NOT NUMERIC
 10397        MOVE +0                  TO AM-CLP-TOL-PCT
 10398     END-IF
 10399
 10400     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10401        MOVE +0                  TO AM-SPP-LEASE-COMM
 10402     END-IF
 10403     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10404        MOVE WS-PL-TOL-LF-PREM-PCT
 10405                                 TO WS-TOL-LF-PREM-PCT.
 10406
 10407     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10408        MOVE WS-PL-TOL-AH-PREM-PCT
 10409                                 TO WS-TOL-AH-PREM-PCT.
 10410
 10411     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10412        MOVE WS-PL-TOL-LF-REFUND-PCT
 10413                                 TO WS-TOL-LF-REFUND-PCT.
 10414
 10415     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10416        MOVE WS-PL-TOL-AH-REFUND-PCT
 10417                                 TO WS-TOL-AH-REFUND-PCT.
 10418
 10419     IF WS-PL-REF-OVS-AMT > +0
 10420        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10421
 10422     IF WS-PL-REF-OVS-PCT > +0
 10423        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10424
 10425     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10426        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10427     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10428        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10429     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10430        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10431     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10432        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10433     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10434        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10435     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10436        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10437
 10438     IF WS-AH-PL-REF-OVS-AMT > +0
 10439        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10440
 10441     IF WS-AH-PL-REF-OVS-PCT > +0
 10442        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10443
 10444     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10445     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10446
 10447     IF PB-CANCELLATION
 10448        GO TO 3000-CONTINUE-EDIT.
 10449
 10450     MOVE +1 TO SUB1.
 10451     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 190
* EL050.cbl
 10452     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10453
 10454     IF CF-COMPANY-ID = 'DMD'
 10455       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10456         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10457        ELSE
 10458         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10459
 10460  0525-FIND-ACCT-COMM.
 10461     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10462        NEXT SENTENCE
 10463      ELSE
 10464         ADD +1 TO SUB1
 10465         IF SUB1 LESS +11
 10466            GO TO 0525-FIND-ACCT-COMM
 10467          ELSE
 10468             GO TO 0560-EDIT-CONTINUE.
 10469
 10470     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10471     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10472                                    PB-I-LIFE-COMMISSION.
 10473***  IF PB-COMPANY-ID = 'CRI'
 10474     IF PB-PREM-ACCTNG-ONLY
 10475         GO TO 0560-EDIT-CONTINUE.
 10476
 10477     MOVE '0530' TO CTBL-SW.
 10478     MOVE ' '    TO WS-CTBL-READ-SW.
 10479
 10480
 10481 0530-GET-AH-COMP.
 10482     IF NO-AH-COVERAGE  OR
 10483        NO-AH-BENEFIT-MATCH
 10484           GO TO 0540-NEXT-READ-STEP.
 10485
 10486     IF AM-A-COM (SUB1) NUMERIC
 10487        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10488         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10489         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10490         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10491         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10492     ELSE
 10493          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10494          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10495          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10496          MOVE ZEROS             TO WS-SUB1
 10497                                    WS-COMMISSION
 10498          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10499          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10500          IF WS-COMMISSION > ZEROS
 10501             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10502             GO TO 0540-NEXT-READ-STEP
 10503          END-IF
 10504          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10505          IF CTBL-TABLE-FOUND
 10506             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10507                                        PB-I-AH-TERM
 10508             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10509             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 191
* EL050.cbl
 10510             GO TO 0540-NEXT-READ-STEP
 10511          ELSE
 10512             IF FIRST-TIME-THROUGH
 10513                 GO TO 0530-GET-AH-COMP
 10514             ELSE
 10515                 MOVE ER-2609                TO WS-ERROR
 10516                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10517
 10518 0540-NEXT-READ-STEP.
 10519     MOVE '0540' TO CTBL-SW.
 10520     MOVE ' '    TO WS-CTBL-READ-SW.
 10521
 10522 0540-GET-LF-COMP.
 10523     IF NO-LIFE-COVERAGE  OR
 10524        NO-LF-BENEFIT-MATCH
 10525           GO TO 0560-EDIT-CONTINUE.
 10526
 10527     IF WS-LF-JOINT-INDICATOR = 'J'
 10528        IF AM-J-COM (SUB1) NUMERIC
 10529           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10530           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10531           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10532           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10533           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10534        ELSE
 10535           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10536           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10537           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10538           MOVE ZEROS                TO WS-SUB1
 10539                                        WS-COMMISSION
 10540           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10541           IF WS-COMMISSION > ZEROS
 10542              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10543              GO TO 0560-EDIT-CONTINUE
 10544           END-IF
 10545           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10546           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10547           IF CTBL-TABLE-FOUND
 10548              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10549              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10550              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10551              GO TO 0560-EDIT-CONTINUE
 10552           ELSE
 10553              IF FIRST-TIME-THROUGH
 10554                  GO TO 0540-GET-LF-COMP
 10555              ELSE
 10556                  MOVE ER-2609                TO WS-ERROR
 10557                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10558                  GO TO 0560-EDIT-CONTINUE.
 10559
 10560     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10561        IF AM-L-COM (SUB1) NUMERIC
 10562           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10563           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10564           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10565           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10566           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10567        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 192
* EL050.cbl
 10568           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10569           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10570           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10571           MOVE ZEROS                TO WS-SUB1
 10572                                        WS-COMMISSION
 10573           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10574           IF WS-COMMISSION IS GREATER THAN ZEROS
 10575              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10576              GO TO 0560-EDIT-CONTINUE
 10577           END-IF
 10578           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10579           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10580           IF CTBL-TABLE-FOUND
 10581              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10582              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10583              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10584              GO TO 0560-EDIT-CONTINUE
 10585           ELSE
 10586              IF FIRST-TIME-THROUGH
 10587                  GO TO 0540-GET-LF-COMP
 10588              ELSE
 10589                  MOVE ER-2609                TO WS-ERROR
 10590                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10591
 10592*    GO TO 0560-EDIT-CONTINUE.
 10593
 10594 0560-EDIT-CONTINUE.
 10595     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10596                                    WS-AH-PMF-COMM
 10597*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10598*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10599     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10600        (SUB1 > +10)
 10601        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10602           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10603           MOVE '0530'           TO CTBL-SW
 10604           MOVE ' '              TO WS-CTBL-READ-SW
 10605           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10606           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10607           MOVE '0540'           TO CTBL-SW
 10608           MOVE ' '              TO WS-CTBL-READ-SW
 10609           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10610        END-IF
 10611     END-PERFORM
 10612     GO TO 0564-EDIT-CONTINUE
 10613     .
 10614 0561-CHECK-AH.
 10615     IF (NO-AH-COVERAGE)
 10616        OR (NO-AH-BENEFIT-MATCH)
 10617        CONTINUE
 10618     ELSE
 10619        IF (AM-A-COM (SUB1) NUMERIC)
 10620           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10621           IF (AM-COM-TYP (SUB1) = 'A')
 10622              AND (WS-AH-PMF-COMM = ZEROS)
 10623              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10624           END-IF
 10625           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 193
* EL050.cbl
 10626        ELSE
 10627           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10628           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10629           MOVE PB-AH-OVERRIDE-L1
 10630                                 TO CTBL-BEN-TYPE
 10631           MOVE ZEROS            TO WS-SUB1
 10632                                    WS-COMMISSION
 10633           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10634           PERFORM 8300-READ-CTBL-TABLE
 10635                                 THRU 8300-EXIT
 10636           IF CTBL-TABLE-FOUND
 10637              IF (AM-COM-TYP (SUB1) = 'A')
 10638                 AND (WS-AH-PMF-COMM = ZEROS)
 10639                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10640                                        PB-I-AH-TERM
 10641                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10642                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10643              END-IF
 10644              CONTINUE
 10645           ELSE
 10646              IF FIRST-TIME-THROUGH
 10647                 GO TO 0561-CHECK-AH
 10648              ELSE
 10649                 MOVE ER-2609    TO WS-ERROR
 10650                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10651              END-IF
 10652           END-IF
 10653        END-IF
 10654     END-IF
 10655     .
 10656 0561-EXIT.
 10657     EXIT.
 10658 0563-CHECK-LF.
 10659     IF (NO-LIFE-COVERAGE)
 10660        OR (NO-LF-BENEFIT-MATCH)
 10661        CONTINUE
 10662     ELSE
 10663        IF WS-LF-JOINT-INDICATOR = 'J'
 10664           IF AM-J-COM (SUB1) NUMERIC
 10665              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10666              IF (AM-COM-TYP (SUB1) = 'A')
 10667                 AND (WS-LF-PMF-COMM = ZEROS)
 10668                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10669              END-IF
 10670              CONTINUE
 10671           ELSE
 10672              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10673              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10674              MOVE PB-LIFE-OVERRIDE-L1
 10675                                 TO CTBL-BEN-TYPE
 10676              MOVE ZEROS         TO WS-SUB1
 10677                                    WS-COMMISSION
 10678              MOVE AM-J-COMA (SUB1)
 10679                                 TO CTBL-TABLE
 10680              PERFORM 8300-READ-CTBL-TABLE
 10681                                 THRU 8300-EXIT
 10682              IF CTBL-TABLE-FOUND
 10683                 IF (AM-COM-TYP (SUB1) = 'A')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 194
* EL050.cbl
 10684                    AND (WS-LF-PMF-COMM = ZEROS)
 10685                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10686                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10687                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10688                 END-IF
 10689                 CONTINUE
 10690              ELSE
 10691                 IF FIRST-TIME-THROUGH
 10692                    GO TO 0563-CHECK-LF
 10693                 ELSE
 10694                    MOVE ER-2609 TO WS-ERROR
 10695                    PERFORM 9900-ERROR-FORMAT
 10696                                 THRU 9900-EXIT
 10697*                   GO TO 0560-EDIT-CONTINUE
 10698                 END-IF
 10699              END-IF
 10700           END-IF
 10701        ELSE
 10702           IF AM-L-COM (SUB1) NUMERIC
 10703              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10704              IF (AM-COM-TYP (SUB1) = 'A')
 10705                 AND (WS-LF-PMF-COMM = ZEROS)
 10706                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10707              END-IF
 10708              CONTINUE
 10709           ELSE
 10710              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10711              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10712              MOVE PB-LIFE-OVERRIDE-L1
 10713                                 TO CTBL-BEN-TYPE
 10714              MOVE ZEROS         TO WS-SUB1
 10715                                    WS-COMMISSION
 10716              MOVE AM-L-COMA (SUB1)
 10717                                 TO CTBL-TABLE
 10718              PERFORM 8300-READ-CTBL-TABLE
 10719                                 THRU 8300-EXIT
 10720              IF CTBL-TABLE-FOUND
 10721                 CONTINUE
 10722              ELSE
 10723                 IF FIRST-TIME-THROUGH
 10724                    GO TO 0563-CHECK-LF
 10725                 ELSE
 10726                    MOVE ER-2609 TO WS-ERROR
 10727                    PERFORM 9900-ERROR-FORMAT
 10728                                 THRU 9900-EXIT
 10729                 END-IF
 10730              END-IF
 10731           END-IF
 10732        END-IF
 10733     END-IF
 10734     .
 10735 0563-EXIT.
 10736     EXIT.
 10737 0564-EDIT-CONTINUE.
 10738
 10739     IF  PB-COMPANY-ID EQUAL 'DMD'
 10740         IF PB-I-NUM-BILLED EQUAL ZEROS
 10741            MOVE ER-8148       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 195
* EL050.cbl
 10742            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10743
 10744*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10745*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10746*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10747*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10748*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10749*         IF NO-CONVERSION-ERROR
 10750*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10751*         ELSE
 10752*             IF PB-COMPANY-ID EQUAL 'HAN'
 10753*                 MOVE ZEROS     TO PB-I-AGE.
 10754     IF PB-I-BIRTHDAY > LOW-VALUES
 10755        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10756        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10757        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10758        PERFORM 8500-DATE-CONVERT
 10759                                 THRU 8500-EXIT
 10760        IF NO-CONVERSION-ERROR
 10761           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10762           IF PB-I-AGE > ZEROS
 10763              IF WS-WORK-AGE NOT = PB-I-AGE
 10764                 MOVE ER-9501    TO WS-ERROR
 10765                 PERFORM 9900-ERROR-FORMAT
 10766                                 THRU 9900-EXIT
 10767              END-IF
 10768           ELSE
 10769              MOVE WS-WORK-AGE   TO PB-I-AGE
 10770           END-IF
 10771        END-IF
 10772     END-IF
 10773     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10774                                   WS-INS-AGE-SET
 10775     IF PB-I-AGE = ZEROS
 10776        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10777           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10778                                   WS-INS-AGE-SET
 10779           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10780
 10781     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10782                                   WS-AH-EDIT-AGE.
 10783
 10784     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10785        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10786        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10787        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10788        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10789        IF NO-CONVERSION-ERROR
 10790           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10791           IF PB-I-JOINT-AGE > 0
 10792              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10793                 MOVE ER-9503    TO WS-ERROR
 10794                 PERFORM 9900-ERROR-FORMAT
 10795                                 THRU 9900-EXIT
 10796              END-IF
 10797           ELSE
 10798              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10799           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 196
* EL050.cbl
 10800        ELSE
 10801           MOVE ZEROS            TO PB-I-JOINT-AGE
 10802        END-IF
 10803     END-IF
 10804     IF PB-I-JOINT-AGE NOT NUMERIC
 10805        MOVE ZERO               TO PB-I-JOINT-AGE.
 10806
 10807     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10808                                   WS-JNT-AGE-SET
 10809     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10810        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10811           (WS-AH-JOINT-INDICATOR = 'J')
 10812           IF PB-I-JOINT-AGE = ZEROS
 10813               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10814                                          WS-JNT-AGE-SET
 10815               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10816           END-IF
 10817        END-IF
 10818     END-IF
 10819
 10820     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10821     IF WS-LF-JOINT-INDICATOR = 'J'
 10822        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10823        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10824            IF  PB-I-JOINT-AGE = ZERO
 10825                MOVE ER-2686       TO WS-ERROR
 10826                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10827            ELSE
 10828                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10829                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10830                    IF PB-COMPANY-ID NOT = 'LBL'
 10831                        MOVE ER-2685    TO WS-ERROR
 10832                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10833
 10834     IF WS-AH-JOINT-INDICATOR = 'J'
 10835        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10836            IF  PB-I-JOINT-AGE = ZERO
 10837                MOVE ER-2686       TO WS-ERROR
 10838                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10839            ELSE
 10840                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10841                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10842                                           WS-EDIT-AGE
 10843                    IF PB-COMPANY-ID NOT = 'LBL'
 10844                        MOVE ER-2685    TO WS-ERROR
 10845                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10846
 10847******************************************************************
 10848*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10849******************************************************************
 10850
 10851     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10852        (WS-AH-SPECIAL-CALC-CD = 'O')
 10853        NEXT SENTENCE
 10854     ELSE
 10855        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10856          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10857           (WS-LF-JOINT-INDICATOR = 'J'  OR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 197
* EL050.cbl
 10858            WS-AH-JOINT-INDICATOR = 'J')  AND
 10859           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10860            MOVE ER-2627             TO WS-ERROR
 10861            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10862
 10863     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10864        (WS-AH-SPECIAL-CALC-CD = 'O')
 10865         NEXT SENTENCE
 10866     ELSE
 10867         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10868            WS-AH-JOINT-INDICATOR = 'J'
 10869             IF PB-I-JOINT-INSURED = SPACES
 10870                 IF PB-COMPANY-ID NOT = 'JAL'
 10871                     MOVE ER-2696    TO WS-ERROR
 10872                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10873
 10874     IF PB-COMPANY-ID NOT = 'BOA'
 10875        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10876           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10877           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10878               PB-I-JOINT-INSURED NOT = SPACES)
 10879                MOVE ER-2691         TO WS-ERROR
 10880                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10881
 10882     IF PB-COMPANY-ID = 'BOA'
 10883        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10884           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10885            IF PB-I-JOINT-AGE NOT = ZEROS
 10886                MOVE ER-2691         TO WS-ERROR
 10887                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10888
 10889     IF PB-COMPANY-ID = 'CRI'
 10890        IF PB-I-SIG-SW = 'J'
 10891           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10892              WS-AH-JOINT-INDICATOR NOT = 'J'
 10893              MOVE ER-2675       TO WS-ERROR
 10894              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10895
 10896     IF PB-COMPANY-ID = 'CRI'
 10897        IF PB-I-SIG-SW = 'S'
 10898           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10899              WS-AH-JOINT-INDICATOR = 'J'
 10900              MOVE ER-2676       TO WS-ERROR
 10901              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10902
 10903     IF PB-COMPANY-ID = 'CVL'
 10904         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10905            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10906              MOVE ER-2783           TO WS-ERROR
 10907              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10908     IF (WS-LF-JOINT-INDICATOR = 'J')
 10909        AND (WS-AH-JOINT-INDICATOR = 'J')
 10910        AND (PB-I-LF-TERM > 120)
 10911        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10912        MOVE ER-2783             TO WS-ERROR
 10913        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10914     END-IF
 10915     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 198
* EL050.cbl
 10916
 10917     IF PB-I-INDV-GRP-OVRD = 'I'
 10918        MOVE ER-2666             TO WS-ERROR
 10919        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10920        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10921
 10922     IF PB-I-INDV-GRP-OVRD = 'G'
 10923        MOVE ER-2666             TO WS-ERROR
 10924        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10925        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10926
 10927     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10928        NEXT SENTENCE
 10929     ELSE
 10930        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10931
 10932     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10933        IF WS-ERROR = ER-2666
 10934           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10935           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10936
 10937     IF PB-COMPANY-ID = 'CID'
 10938        IF PB-STATE = 'UT' OR 'MO'
 10939           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10940                 OR '76' OR '77')
 10941                      OR
 10942               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10943                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10944                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10945                   OR '2K' OR '2L'))
 10946              AND PB-I-INDV-GRP-CD = 'I'
 10947              MOVE ER-2721             TO WS-ERROR
 10948              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10949           END-IF
 10950        END-IF
 10951     END-IF
 10952
 10953     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10954     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10955        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10956     ELSE
 10957        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10958     END-IF
 10959
 10960*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10961*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10962     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10963                                    ACCOUNT-AH-CK-SW.
 10964
 10965     IF PB-REISSUED-CERT       OR
 10966        PB-REIN-ONLY-CERT      OR
 10967        PB-POLICY-IS-DECLINED  OR
 10968        PB-POLICY-IS-VOIDED
 10969*       OR PB-MONTHLY-CERT
 10970         GO TO 3000-CONTINUE-EDIT.
 10971
 10972     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10973        IF WS-EDIT-AGE           > +65
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 199
* EL050.cbl
 10974           MOVE ER-2709          TO WS-ERROR
 10975           PERFORM 9900-ERROR-FORMAT
 10976                                 THRU 9900-EXIT
 10977        ELSE
 10978           IF WS-EDIT-AGE        > +55
 10979              MOVE ER-2718       TO WS-ERROR
 10980              PERFORM 9900-ERROR-FORMAT
 10981                                 THRU 9900-EXIT
 10982           END-IF
 10983        END-IF
 10984     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10985        IF WS-EDIT-AGE           > +65
 10986           MOVE ER-2709          TO WS-ERROR
 10987           PERFORM 9900-ERROR-FORMAT
 10988                                 THRU 9900-EXIT
 10989        END-IF
 10990     END-IF
 10991     .
 10992
 10993 0565-LIFE-PLAN-LIMIT-EDITS.
 10994
 10995     IF NOT LF-PLAN-MASTER-FOUND
 10996        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10997                                    EC-AM-LF-MAX-TOT-BEN
 10998        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10999
 11000     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11001
 11002     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11003         IF PL-LM-AGE (1) = ZEROS
 11004             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11005
 11006     IF NO-LF-BENEFIT-MATCH          OR
 11007        WS-LF-BENEFIT-CD = ZEROS     OR
 11008        WS-LF-SPECIAL-CALC-CD = 'M'
 11009        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11010
 11011     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11012     MOVE +1                     TO SUB2.
 11013
 11014     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11015        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11016           MOVE +5   TO SUB2
 11017           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11018              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11019              (PL-LM-AGE (SUB2) EQUAL +0)
 11020              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11021              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11022
 11023     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11024
 11025     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11026                               + PB-I-LF-ALT-BENEFIT-AMT.
 11027
 11028 0568-CHECK-LIFE-ATT-AGE.
 11029
 11030     IF PL-ATT-AGE NUMERIC AND
 11031        PL-ATT-AGE > +0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 200
* EL050.cbl
 11032        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11033     END-IF
 11034*    IF PL-ATT-AGE NUMERIC AND
 11035*       PL-ATT-AGE > +0
 11036*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11037*       IF PB-I-BIRTHDAY > LOW-VALUES
 11038*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11039*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11040*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11041*          SET BIN-PLUS-ELAPSED  TO TRUE
 11042*          PERFORM 8500-DATE-CONVERT
 11043*                                THRU 8500-EXIT
 11044*          IF NO-CONVERSION-ERROR
 11045*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11046*             MOVE ER-2669       TO WS-ERROR
 11047*             PERFORM 9900-ERROR-FORMAT
 11048*                                THRU 9900-EXIT
 11049*          END-IF
 11050*       ELSE
 11051*          IF WS-ATT-AGE >= PL-ATT-AGE
 11052*             MOVE ER-2669       TO WS-ERROR
 11053*             PERFORM 9900-ERROR-FORMAT
 11054*                                THRU 9900-EXIT
 11055*          END-IF
 11056*       END-IF
 11057*    END-IF
 11058     .
 11059 0570-CHECK-LIFE-LIMITS.
 11060
 11061     IF PB-COMPANY-ID EQUAL 'CRI'
 11062        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11063           IF SUB2 GREATER THAN +4
 11064              MOVE ER-2637 TO WS-ERROR
 11065              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11066              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11067
 11068     IF PB-COMPANY-ID  =  'NCL'
 11069        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11070            SUB2 GREATER THAN +8
 11071             MOVE 'U'         TO PB-BATCH-ENTRY
 11072             MOVE ER-2637     TO WS-ERROR
 11073             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11074             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11075
 11076     IF SUB2 > +8
 11077        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11078           AND (PB-I-SIG-SW = 'Y')
 11079           CONTINUE
 11080        ELSE
 11081           MOVE ER-2637          TO WS-ERROR
 11082           PERFORM 9900-ERROR-FORMAT
 11083                                 THRU 9900-EXIT
 11084        END-IF
 11085        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11086     END-IF
 11087     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11088     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11089     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 201
* EL050.cbl
 11090
 11091     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11092        ADD +1  TO SUB2
 11093        GO TO 0570-CHECK-LIFE-LIMITS.
 11094
 11095     IF PB-COMPANY-ID = 'NCL'
 11096         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11097
 11098     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11099        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11100        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11101           AND (PB-I-SIG-SW = 'Y')
 11102           CONTINUE
 11103        ELSE
 11104           MOVE ER-2637          TO WS-ERROR
 11105           PERFORM 9900-ERROR-FORMAT
 11106                                 THRU 9900-EXIT
 11107        END-IF
 11108     END-IF
 11109     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11110
 11111
 11112 0570-CHECK-NCL-LIFE-LIMITS.
 11113
 11114     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11115        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11116         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11117
 11118     IF APP-CERT-USED
 11119         IF SUB2  LESS THAN  +5
 11120             MOVE +5          TO SUB2
 11121             GO TO 0570-CHECK-LIFE-LIMITS.
 11122
 11123     MOVE ER-2637             TO WS-ERROR.
 11124     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11125
 11126     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11127
 11128 0575-CHECK-NCL-SIG-SWITCH.
 11129
 11130     IF NOT APP-CERT-USED
 11131         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11132
 11133     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11134        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11135        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11136        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11137         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11138
 11139     IF SUB2 GREATER THAN +4
 11140         IF PL-LM-AGE (5) = ZEROS  AND
 11141            PL-LM-AGE (6) = ZEROS  AND
 11142            PL-LM-AGE (7) = ZEROS  AND
 11143            PL-LM-AGE (8) = ZEROS
 11144             MOVE  ER-1927        TO WS-ERROR
 11145             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11146             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11147         ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 202
* EL050.cbl
 11148             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11149                 MOVE  ER-1920    TO WS-ERROR
 11150                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11151
 11152     IF PB-I-SIG-SW  = 'Y'
 11153       IF NOT PB-I-POLICY-ACCEPTED  AND
 11154          NOT PB-I-POLICY-DECLINED
 11155           MOVE 'U'               TO PB-BATCH-ENTRY
 11156           MOVE  ER-1926          TO WS-ERROR
 11157           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11158
 11159
 11160 0580-AH-PLAN-LIMIT-EDITS.
 11161
 11162     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11163        IF PB-I-AH-BENEFIT-AMT > +1250
 11164           MOVE ER-2702          TO WS-ERROR
 11165           PERFORM 9900-ERROR-FORMAT
 11166                                 THRU 9900-EXIT
 11167        END-IF
 11168     END-IF
 11169
 11170     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11171        AND (PB-MONTHLY-CERT)
 11172        IF PB-I-AH-BENEFIT-AMT > +3000
 11173           MOVE ER-2881          TO WS-ERROR
 11174           PERFORM 9900-ERROR-FORMAT
 11175                                 THRU 9900-EXIT
 11176        END-IF
 11177     END-IF
 11178     IF NOT AH-PLAN-MASTER-FOUND
 11179        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11180        GO TO 3000-CONTINUE-EDIT.
 11181
 11182     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11183
 11184     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11185         IF PL-LM-AGE (1) = ZEROS
 11186             GO TO 3000-CONTINUE-EDIT.
 11187
 11188     IF NO-AH-BENEFIT-MATCH          OR
 11189        WS-AH-BENEFIT-CD = ZEROS     OR
 11190        WS-AH-SPECIAL-CALC-CD = 'M'
 11191        GO TO 3000-CONTINUE-EDIT.
 11192
 11193     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11194     MOVE +1                     TO SUB2.
 11195
 11196     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11197        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11198           MOVE +5 TO SUB2
 11199           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11200              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11201              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11202              (PL-LM-AGE (SUB2) EQUAL +0)
 11203              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11204              GO TO 3000-CONTINUE-EDIT.
 11205
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 203
* EL050.cbl
 11206     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11207
 11208 0590-CHECK-AH-ATT-AGE.
 11209
 11210     IF PL-ATT-AGE NUMERIC AND
 11211        PL-ATT-AGE GREATER THAN +0
 11212        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11213     END-IF
 11214*       IF WS-ATT-AGE >= PL-ATT-AGE
 11215*          MOVE ER-3054          TO WS-ERROR
 11216*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11217     .
 11218 0597-CHECK-AH-LIMITS.
 11219
 11220     IF PB-COMPANY-ID EQUAL 'CRI'
 11221        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11222           IF SUB2 GREATER THAN +4
 11223              MOVE ER-2638       TO WS-ERROR
 11224              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11225              GO TO 3000-CONTINUE-EDIT.
 11226
 11227     IF PB-COMPANY-ID  =  'NCL'
 11228        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11229            SUB2 GREATER THAN +8
 11230             MOVE 'U'            TO PB-BATCH-ENTRY
 11231             MOVE ER-2638        TO WS-ERROR
 11232             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11233             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11234
 11235     IF SUB2 > +8
 11236        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11237           AND (PB-I-SIG-SW = 'Y')
 11238           CONTINUE
 11239        ELSE
 11240           MOVE ER-2638          TO WS-ERROR
 11241           PERFORM 9900-ERROR-FORMAT
 11242                                 THRU 9900-EXIT
 11243        END-IF
 11244        GO TO 3000-CONTINUE-EDIT
 11245     END-IF
 11246
 11247     IF PB-COMPANY-ID = 'CRI'
 11248        IF WS-ERROR = ER-2638
 11249           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11250
 11251     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11252     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11253     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11254     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11255
 11256     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11257        ADD +1                   TO SUB2
 11258        GO TO 0597-CHECK-AH-LIMITS.
 11259
 11260     IF PB-COMPANY-ID = 'NCL'
 11261         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11262
 11263     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 204
* EL050.cbl
 11264        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11265        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11266                                 > PL-LM-AMT (SUB2))
 11267        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11268           AND (PB-I-SIG-SW = 'Y')
 11269           CONTINUE
 11270        ELSE
 11271           MOVE ER-2638          TO WS-ERROR
 11272           PERFORM 9900-ERROR-FORMAT
 11273                                 THRU 9900-EXIT
 11274        END-IF
 11275     END-IF
 11276
 11277     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11278         IF  WS-ERROR    EQUAL    ER-2638
 11279             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11280                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11281                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11282                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11283                MOVE  ER-1910    TO  WS-ERROR
 11284                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11285
 11286     IF PB-COMPANY-ID = 'CRI'
 11287        IF WS-ERROR = ER-2638
 11288            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11289            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11290            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11291
 11292     GO TO 3000-CONTINUE-EDIT.
 11293
 11294 0597-CHECK-NCL-AH-LIMITS.
 11295
 11296     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11297        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11298        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11299                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11300         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11301
 11302     IF APP-CERT-USED
 11303         IF SUB2  LESS THAN  +5
 11304             MOVE +5             TO SUB2
 11305             GO TO 0597-CHECK-AH-LIMITS.
 11306
 11307     MOVE ER-2638                TO WS-ERROR.
 11308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11309
 11310     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11311
 11312 0599-CHECK-NCL-SIG-SWITCH.
 11313
 11314     IF NOT APP-CERT-USED
 11315         GO TO 3000-CONTINUE-EDIT.
 11316
 11317     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11318        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11319        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11320        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11321         GO TO 3000-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 205
* EL050.cbl
 11322
 11323     IF SUB2 GREATER THAN +4
 11324         IF PL-LM-AGE (5) = ZEROS  AND
 11325            PL-LM-AGE (6) = ZEROS  AND
 11326            PL-LM-AGE (7) = ZEROS  AND
 11327            PL-LM-AGE (8) = ZEROS
 11328             MOVE  ER-1927        TO WS-ERROR
 11329             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11330             GO TO 3000-CONTINUE-EDIT
 11331         ELSE
 11332             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11333                 MOVE  ER-1920    TO WS-ERROR
 11334                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11335
 11336     IF PB-I-SIG-SW  = 'Y'
 11337       IF NOT PB-I-POLICY-ACCEPTED  AND
 11338          NOT PB-I-POLICY-DECLINED
 11339           MOVE 'U'               TO PB-BATCH-ENTRY
 11340           MOVE  ER-1926          TO WS-ERROR
 11341           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11342
 11343******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 206
* EL050.cbl
 11345
 11346 3000-CONTINUE-EDIT.
 11347
 11348     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11349     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11350     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11351     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11352     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11353
 11354     IF BROWSE-STARTED
 11355        PERFORM 9990-RETURN THRU 9990-EXIT
 11356        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11357
 11358     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11359        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11360        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11361        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11362*       MOVE 1                   TO DC-OPTION-CODE
 11363        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11364        IF DATE-CONVERSION-ERROR
 11365           MOVE ER-2622          TO WS-ERROR
 11366           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11367        ELSE
 11368           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11369              MOVE ER-2623       TO WS-ERROR
 11370              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11371           ELSE
 11372              MOVE ER-2622       TO WS-ERROR
 11373              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11374
 11375     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11376     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11377     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11378*    MOVE 1                      TO DC-OPTION-CODE.
 11379     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11380     IF DATE-CONVERSION-ERROR
 11381        GO TO 3005-EDIT-CONTINUE
 11382     ELSE
 11383        IF DC-ELAPSED-DAYS GREATER +180
 11384           MOVE ER-2613          TO WS-ERROR
 11385           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11386        ELSE
 11387           IF DC-ELAPSED-DAYS GREATER +90
 11388              MOVE ER-2612       TO WS-ERROR
 11389              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11390           ELSE
 11391             IF DC-ELAPSED-DAYS GREATER +60
 11392                MOVE ER-2614     TO WS-ERROR
 11393                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11394
 11395 3005-EDIT-CONTINUE.
 11396
 11397     IF PB-CANCELLATION
 11398         GO TO 3700-EDIT-CANCEL.
 11399
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 207
* EL050.cbl
 11401******************************************************************
 11402*                  E D I T   I S S U E                           *
 11403******************************************************************
 11404
 11405 3020-EDIT-ISSUE.
 11406
 11407      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11408      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11409      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11410      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11411      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11412
 11413     IF PB-ISSUE-FORCE
 11414        OR PB-ISSUE-DATE-FORCED
 11415        OR PB-FORCE-OFF
 11416        OR PB-OVERCHARGE-FORCE
 11417        or pb-exceeded-limit-forced
 11418        CONTINUE
 11419     ELSE
 11420        MOVE ER-2670             TO WS-ERROR
 11421        PERFORM 9900-ERROR-FORMAT
 11422                                 THRU 9900-EXIT
 11423     END-IF
 11424     .
 11425 3022-SET-POLICY-STATUS.
 11426
 11427     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11428
 11429     IF (PB-REISSUED-CERT)
 11430             OR
 11431        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11432         AND (PB-MONTHLY-CERT))
 11433         MOVE '5'                TO PB-I-ENTRY-STATUS
 11434         MOVE 'E'                TO PB-BATCH-ENTRY
 11435     END-IF
 11436
 11437     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11438        IF PB-MONTHLY-CERT
 11439           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11440        END-IF
 11441        IF PB-CASH-CERT
 11442           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11443        END-IF
 11444     END-IF
 11445     IF PB-POLICY-IS-DECLINED
 11446         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11447     IF PB-POLICY-IS-VOIDED
 11448         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11449     IF PB-NEEDS-UNDERWRITING
 11450         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11451     IF PB-REIN-ONLY-CERT
 11452         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11453     IF PB-PREM-ACCTNG-ONLY
 11454         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11455
 11456     MOVE SPACE                  TO PB-I-OB-FLAG.
 11457
 11458     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 208
* EL050.cbl
 11459         MOVE ER-2665            TO WS-ERROR
 11460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11461         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11462
 11463     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11464        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11465           MOVE 'Z'             TO PB-I-OB-FLAG.
 11466
 11467     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11468        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11469           MOVE 'Z'             TO PB-I-OB-FLAG.
 11470
 11471     IF ACCOUNT-MAST-FOUND
 11472         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11473         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11474         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11475         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11476         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11477         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11478         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11479     END-IF
 11480
 11481     IF ACCOUNT-MAST-FOUND
 11482        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11483         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11484
 11485     IF (ACCOUNT-MAST-FOUND)
 11486*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11487        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11488        IF PB-REISSUED-CERT
 11489           CONTINUE
 11490        ELSE
 11491           MOVE ER-2608          TO WS-ERROR
 11492           PERFORM 9900-ERROR-FORMAT
 11493                                 THRU 9900-EXIT
 11494         END-IF
 11495     END-IF
 11496
 11497     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11498        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11499        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11500
 11501**********   DMD CUSTOM CODE FOLLOWS  **********
 11502 3024-EDIT-DMD-FIELDS.
 11503     IF PB-COMPANY-ID NOT = 'DMD'
 11504        GO TO 3025-EDIT-REINSURANCE.
 11505
 11506*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11507*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11508*** ERROR IF THEY ARE NOT EQUAL.
 11509
 11510     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11511     SET BIN-TO-GREG               TO TRUE.
 11512     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11513     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11514**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11515
 11516     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 209
* EL050.cbl
 11517     SET BIN-TO-GREG               TO TRUE.
 11518     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11519     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11520**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11521
 11522     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11523        MOVE ER-8116               TO WS-ERROR
 11524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11525
 11526     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11527
 11528     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11529                                      WK-FULL-CERT-NO.
 11530     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11531
 11532     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11533
 11534     IF PB-VALID-LIFE
 11535        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11536     ELSE
 11537        IF PB-VALID-AH
 11538          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11539
 11540
 11541     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11542     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11543     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11544                                      DCUA-UNDRWRTR-CODE
 11545                                      DCUA-UNDRWRTR-GROUP-CODE
 11546                                      DCUA-RETURN-CODE.
 11547
 11548****************************************************************
 11549*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11550***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11551***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11552***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11553***   TO THIS RECORD.                                        ***
 11554****************************************************************
 11555     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11556     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11557     IF DCUA-SUCCESSFUL-PROCESS
 11558        GO TO 3024-EDIT-DL7-CONT.
 11559
 11560     IF DCUA-RETURN-CODE EQUAL '01'
 11561        MOVE ER-8110               TO WS-ERROR
 11562        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11564        GO TO 3024-EDIT-DL7-CONT.
 11565
 11566     IF DCUA-RETURN-CODE EQUAL '02'
 11567        MOVE ER-8111               TO WS-ERROR
 11568        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11570        GO TO 3024-EDIT-DL7-CONT.
 11571
 11572     IF DCUA-RETURN-CODE EQUAL '03'
 11573        MOVE ER-8074               TO WS-ERROR
 11574        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 210
* EL050.cbl
 11575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11576        GO TO 3024-EDIT-DL7-CONT.
 11577
 11578     IF DCUA-RETURN-CODE EQUAL '04'
 11579        MOVE ER-8075               TO WS-ERROR
 11580        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11582        GO TO 3024-EDIT-DL7-CONT.
 11583
 11584     IF DCUA-RETURN-CODE EQUAL '05'
 11585        MOVE ER-8076               TO WS-ERROR
 11586        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11587        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11588        GO TO 3024-EDIT-DL7-CONT.
 11589
 11590     IF DCUA-RETURN-CODE EQUAL '06'
 11591        MOVE ER-8077               TO WS-ERROR
 11592        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11593        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11594        GO TO 3024-EDIT-DL7-CONT.
 11595
 11596     IF DCUA-RETURN-CODE EQUAL '07'
 11597        MOVE ER-8078               TO WS-ERROR
 11598        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11599        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11600        GO TO 3024-EDIT-DL7-CONT.
 11601
 11602     IF DCUA-RETURN-CODE EQUAL 'E1'
 11603        MOVE ER-8079               TO WS-ERROR
 11604        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11606        GO TO 3024-EDIT-DL7-CONT.
 11607
 11608     IF DCUA-RETURN-CODE EQUAL 'E2'
 11609        MOVE ER-8080               TO WS-ERROR
 11610        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11612        GO TO 3024-EDIT-DL7-CONT.
 11613
 11614     IF DCUA-RETURN-CODE EQUAL 'E3'
 11615        MOVE ER-8098               TO WS-ERROR
 11616        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11618        GO TO 3024-EDIT-DL7-CONT.
 11619
 11620     IF DCUA-RETURN-CODE EQUAL 'C1'
 11621        MOVE ER-8099               TO WS-ERROR
 11622        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11624        GO TO 3024-EDIT-DL7-CONT.
 11625
 11626     IF DCUA-RETURN-CODE EQUAL 'U1'
 11627        MOVE ER-8109               TO WS-ERROR
 11628        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL7-CONT.
 11631
 11632     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 211
* EL050.cbl
 11633        MOVE ER-8112               TO WS-ERROR
 11634        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11636        GO TO 3024-EDIT-DL7-CONT.
 11637
 11638     IF DCUA-RETURN-CODE EQUAL 'N2'
 11639        MOVE ER-8113               TO WS-ERROR
 11640        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11642        GO TO 3024-EDIT-DL7-CONT.
 11643
 11644     IF DCUA-RETURN-CODE EQUAL 'N3'
 11645        MOVE ER-8114               TO WS-ERROR
 11646        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11648        GO TO 3024-EDIT-DL7-CONT.
 11649
 11650     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11651     MOVE ER-8097                  TO WS-ERROR.
 11652     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11653     GO TO 3024-EDIT-DL7-CONT.
 11654
 11655 3024-EDIT-DL7-CONT.
 11656
 11657     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11658     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11659     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11660        NEXT SENTENCE
 11661     ELSE
 11662        MOVE ER-9263               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11664
 11665******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11666******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11667     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11668        NEXT SENTENCE
 11669     ELSE
 11670        MOVE ER-8039               TO WS-ERROR
 11671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11672
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 212
* EL050.cbl
 11674****************************************************************
 11675*** VALIDATE STATE  : DLO022                                 ***
 11676****************************************************************
 11677     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11678     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11679
 11680     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11681     IF DVSC-SUCCESSFUL-EDIT
 11682        GO TO 3024-EDIT-DL22-CONT.
 11683
 11684     IF DVSC-RETURN-CODE EQUAL '01'
 11685        MOVE ER-8300               TO WS-ERROR
 11686        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11687        GO TO 3024-EDIT-DL22-CONT.
 11688
 11689     IF DVSC-RETURN-CODE EQUAL '02'
 11690        MOVE ER-8301               TO WS-ERROR
 11691        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11692        GO TO 3024-EDIT-DL22-CONT.
 11693
 11694     IF DVSC-RETURN-CODE EQUAL '03'
 11695        MOVE ER-8302               TO WS-ERROR
 11696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11697        GO TO 3024-EDIT-DL22-CONT.
 11698
 11699     IF DVSC-RETURN-CODE EQUAL 'N1'
 11700        MOVE ER-8304               TO WS-ERROR
 11701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11702        GO TO 3024-EDIT-DL22-CONT.
 11703
 11704     MOVE ER-8303                  TO WS-ERROR
 11705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11706
 11707 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 213
* EL050.cbl
 11709****************************************************************
 11710*** VALIDATE LOAN OFFICER : DLO021                           ***
 11711****************************************************************
 11712
 11713     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11714     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11715     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11716     IF DVLO-SUCCESSFUL-EDIT
 11717        GO TO 3024-EDIT-DL21-CONT.
 11718
 11719     IF DVLO-RETURN-CODE EQUAL '01'
 11720        MOVE ER-8081               TO WS-ERROR
 11721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11722        GO TO 3024-EDIT-DL21-CONT.
 11723
 11724     IF DVLO-RETURN-CODE EQUAL '02'
 11725        MOVE ER-8082               TO WS-ERROR
 11726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11727        GO TO 3024-EDIT-DL21-CONT.
 11728
 11729     IF DVLO-RETURN-CODE EQUAL '03'
 11730        MOVE ER-8083               TO WS-ERROR
 11731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11732        GO TO 3024-EDIT-DL21-CONT.
 11733
 11734     IF DVLO-RETURN-CODE EQUAL '04'
 11735        MOVE ER-8084               TO WS-ERROR
 11736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11737        GO TO 3024-EDIT-DL21-CONT.
 11738
 11739     IF DVLO-RETURN-CODE EQUAL '05'
 11740        MOVE ER-8085               TO WS-ERROR
 11741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11742        GO TO 3024-EDIT-DL21-CONT.
 11743
 11744     MOVE ER-7825                  TO WS-ERROR
 11745     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11746     GO TO 3024-EDIT-DL21-CONT.
 11747
 11748 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 214
* EL050.cbl
 11750
 11751****************************************************************
 11752*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11753****************************************************************
 11754
 11755     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11756     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11757     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11758     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11759     IF DIPF-SUCCESSFUL-EDIT
 11760        GO TO 3024-EDIT-DL02-CONT.
 11761
 11762     IF DIPF-RETURN-CODE EQUAL '01'
 11763        MOVE ER-8086               TO WS-ERROR
 11764        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11765        GO TO 3024-EDIT-DL02-CONT.
 11766
 11767     IF DIPF-RETURN-CODE EQUAL '02'
 11768        MOVE ER-8087               TO WS-ERROR
 11769        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11770        GO TO 3024-EDIT-DL02-CONT.
 11771
 11772     IF DIPF-RETURN-CODE EQUAL '03'
 11773        MOVE ER-8088               TO WS-ERROR
 11774        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11775        GO TO 3024-EDIT-DL02-CONT.
 11776
 11777     MOVE ER-8095                  TO WS-ERROR
 11778     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11779     GO TO 3024-EDIT-DL02-CONT.
 11780
 11781 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 215
* EL050.cbl
 11783
 11784****************************************************************
 11785*** VALIDATE BANK ID : DLO003                                ***
 11786****************************************************************
 11787
 11788     MOVE WK-GREG-CENT           TO WCG-CENT.
 11789     MOVE WK-GREG-YYMM           TO WCG-REST.
 11790     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11791        MOVE ER-8040               TO WS-ERROR
 11792        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11793
 11794     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11795     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11796     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11797     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11798     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11799     IF DVBI-SUCCESSFUL-EDIT
 11800        GO TO 3024-EDIT-DL03-CONT.
 11801
 11802     IF DVBI-RETURN-CODE EQUAL '01'
 11803        MOVE ER-8089               TO WS-ERROR
 11804        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11805        GO TO 3024-EDIT-DL03-CONT.
 11806
 11807     IF DVBI-RETURN-CODE EQUAL '02'
 11808        MOVE ER-8090               TO WS-ERROR
 11809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11810        GO TO 3024-EDIT-DL03-CONT.
 11811
 11812     IF DVBI-RETURN-CODE EQUAL '03'
 11813        MOVE ER-8091               TO WS-ERROR
 11814        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11815        GO TO 3024-EDIT-DL03-CONT.
 11816
 11817     IF DVBI-RETURN-CODE EQUAL '04'
 11818        MOVE ER-8092               TO WS-ERROR
 11819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11820        GO TO 3024-EDIT-DL03-CONT.
 11821
 11822     IF DVBI-RETURN-CODE EQUAL '05'
 11823        MOVE ER-8093               TO WS-ERROR
 11824        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11825        GO TO 3024-EDIT-DL03-CONT.
 11826
 11827     IF DVBI-RETURN-CODE EQUAL '06'
 11828        MOVE ER-8094               TO WS-ERROR
 11829        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11830        GO TO 3024-EDIT-DL03-CONT.
 11831
 11832     MOVE ER-8096                  TO WS-ERROR
 11833     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11834     GO TO 3024-EDIT-DL03-CONT.
 11835
 11836 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 216
* EL050.cbl
 11838
 11839     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11840        NEXT SENTENCE
 11841     ELSE
 11842        MOVE ER-8042               TO WS-ERROR
 11843        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11844
 11845     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11846     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11847     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11848
 11849     IF DMPF-RETURN-CODE = '01'
 11850        MOVE ER-8067               TO WS-ERROR
 11851        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11852        GO TO 3024-EDIT-DL01-CONT.
 11853
 11854     IF DMPF-RETURN-CODE = '02'
 11855        MOVE ER-8068               TO WS-ERROR
 11856        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11857        GO TO 3024-EDIT-DL01-CONT.
 11858
 11859     IF DMPF-RETURN-CODE = '03'
 11860        MOVE ER-8069               TO WS-ERROR
 11861        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11862        GO TO 3024-EDIT-DL01-CONT.
 11863
 11864     IF DMPF-RETURN-CODE = 'E1'
 11865        MOVE ER-8070               TO WS-ERROR
 11866        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11867        GO TO 3024-EDIT-DL01-CONT.
 11868
 11869     IF DMPF-RETURN-CODE = 'N1'
 11870        MOVE ER-8071               TO WS-ERROR
 11871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11872        GO TO 3024-EDIT-DL01-CONT.
 11873
 11874     IF DMPF-RETURN-CODE NOT = 'OK'
 11875        MOVE ER-8072               TO WS-ERROR
 11876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11877
 11878 3024-EDIT-DL01-CONT.
 11879******************************************************************
 11880***  VALIDATES RATE CODES : DLO017                             ***
 11881******************************************************************
 11882
 11883      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11884      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11885      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11886      IF DVRC-SUCCESSFUL-EDIT
 11887        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11888        GO TO 3024-CHECK-VALID-RATE.
 11889
 11890      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11891
 11892      IF DVRC-RETURN-CODE EQUAL '01'
 11893         MOVE ER-7817                   TO WS-ERROR
 11894         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11895         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 217
* EL050.cbl
 11896
 11897      IF DVRC-RETURN-CODE EQUAL '02'
 11898         MOVE ER-7818                   TO WS-ERROR
 11899         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11900         GO TO 3025-EDIT-REINSURANCE.
 11901
 11902      IF DVRC-RETURN-CODE EQUAL '03'
 11903         MOVE ER-7819                   TO WS-ERROR
 11904         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11905         GO TO 3025-EDIT-REINSURANCE.
 11906
 11907       MOVE ER-7820                     TO WS-ERROR.
 11908       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11909       GO TO 3025-EDIT-REINSURANCE.
 11910
 11911******************************************************************
 11912***  GET PREMIUM RATES : DLO011                                ***
 11913******************************************************************
 11914
 11915 3024-CHECK-VALID-RATE.
 11916
 11917     IF VALID-RATE-CODE
 11918        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11919        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11920        MOVE SPACES                TO DPRB-RETURN-CODE
 11921        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11922     ELSE
 11923         GO TO 3025-EDIT-REINSURANCE.
 11924
 11925      IF DPRB-SUCCESSFUL-PROCESS
 11926         IF PB-VALID-LIFE
 11927             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11928             GO TO 3025-EDIT-REINSURANCE
 11929         ELSE
 11930             IF PB-VALID-AH
 11931                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11932                 GO TO 3025-EDIT-REINSURANCE.
 11933
 11934      IF DPRB-RETURN-CODE EQUAL '01'
 11935         MOVE ER-7812                   TO WS-ERROR
 11936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11937         GO TO 3025-EDIT-REINSURANCE.
 11938
 11939      IF DPRB-RETURN-CODE EQUAL '02'
 11940         MOVE ER-7813                   TO WS-ERROR
 11941         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11942         GO TO 3025-EDIT-REINSURANCE.
 11943
 11944      IF DPRB-RETURN-CODE EQUAL '03'
 11945         MOVE ER-7814                   TO WS-ERROR
 11946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11947         GO TO 3025-EDIT-REINSURANCE.
 11948
 11949      IF DPRB-RETURN-CODE EQUAL '04'
 11950         IF NOT DPRB-1ST-TIME
 11951            MOVE ER-7815                   TO WS-ERROR
 11952            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11953            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 218
* EL050.cbl
 11954          ELSE
 11955         IF PB-VALID-LIFE
 11956            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11957          ELSE
 11958            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11959         END-IF
 11960         MOVE SPACES                TO DOCC-RETURN-CODE
 11961         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11962         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11963         IF DOCC-RETURN-CODE = 'OK'
 11964             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11965             GO TO 3024-CHECK-VALID-RATE
 11966           ELSE
 11967             MOVE ER-7823               TO WS-ERROR
 11968             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11969             GO TO 3025-EDIT-REINSURANCE.
 11970
 11971       MOVE ER-7816                     TO WS-ERROR.
 11972       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11973       GO TO 3025-EDIT-REINSURANCE.
 11974
 11975**********   DMD CUSTOM CODE ABOVE    **********
 11976
 11977 3025-EDIT-REINSURANCE.
 11978     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11979         GO TO 3027-EDIT-CONTINUE.
 11980
 11981     MOVE LOW-VALUES               TO ERREIN-KEY.
 11982     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11983     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11984                                      REIN-CODE-2
 11985                                      REIN-CODE-3.
 11986     MOVE 'A'                      TO REIN-TYPE.
 11987
 11988     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11989
 11990     MOVE '3026' TO REIN-SW.
 11991     MOVE ' '                   TO WS-REIN-READ-SW.
 11992
 11993     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11994     IF REIN-TABLE-NOT-FOUND
 11995         GO TO 3026-NO-SPEC-TABLE.
 11996
 11997     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11998     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11999                                   WS-NSP-ST-CD-LF.
 12000     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12001                                   WS-NSP-ST-CD-AH.
 12002
 12003     GO TO 3040-EDIT-CONTINUE.
 12004
 12005 3026-NO-SPEC-TABLE.
 12006
 12007     MOVE ER-2664                TO WS-ERROR.
 12008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12009     GO TO 3040-EDIT-CONTINUE.
 12010
 12011 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 219
* EL050.cbl
 12012
 12013     IF PB-I-REIN-TABLE = SPACES
 12014       GO TO 3040-EDIT-CONTINUE.
 12015
 12016     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12017          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12018          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12019           GO TO 3040-EDIT-CONTINUE.
 12020
 12021     MOVE LOW-VALUES            TO ERREIN-KEY.
 12022     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12023     MOVE 'A'                   TO REIN-TYPE.
 12024     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12025
 12026     MOVE '3028'                TO REIN-SW.
 12027     MOVE ' '                   TO WS-REIN-READ-SW.
 12028
 12029     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12030     IF REIN-TABLE-NOT-FOUND
 12031         GO TO 3028-NO-REIN-TABLE.
 12032
 12033     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12034     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12035                                   WS-NSP-ST-CD-LF.
 12036     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12037                                   WS-NSP-ST-CD-AH.
 12038
 12039     GO TO 3040-EDIT-CONTINUE.
 12040
 12041 3028-NO-REIN-TABLE.
 12042
 12043     MOVE ER-2615                TO WS-ERROR.
 12044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12045     GO TO 3040-EDIT-CONTINUE.
 12046
 12047 3040-EDIT-CONTINUE.
 12048
 12049     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12050         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12051
 12052     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12053         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12054
 12055     IF (NOT PB-REISSUED-CERT)
 12056        AND (NOT PB-MONTHLY-CERT)
 12057        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12058            MOVE '001'           TO PB-I-LF-TERM
 12059            MOVE 'M'             TO PB-I-INSURED-SEX.
 12060
 12061     IF (NOT PB-REISSUED-CERT)
 12062        AND (NOT PB-MONTHLY-CERT)
 12063        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12064            MOVE '001'           TO PB-I-AH-TERM
 12065            MOVE 'M'             TO PB-I-INSURED-SEX.
 12066
 12067 3040-EDIT-1ST-PMT-DT.
 12068     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12069     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 220
* EL050.cbl
 12070         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12071
 12072******************************************************************
 12073*                                                                *
 12074*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12075*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12076*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12077*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12078*                                                                *
 12079******************************************************************
 12080
 12081     IF PB-EFF-DT-PROCESSING
 12082        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12083                                    PB-I-LF-EXPIRE-DT
 12084                                    PB-I-AH-EXPIRE-DT
 12085        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12086        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12087        MOVE ZERO                TO DC-ELAPSED-DAYS
 12088        MOVE +1                  TO DC-ELAPSED-MONTHS
 12089        SET BIN-PLUS-ELAPSED     TO TRUE
 12090*       MOVE 6                   TO DC-OPTION-CODE
 12091        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12092        IF NO-CONVERSION-ERROR
 12093           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12094
 12095******************************************************************
 12096*                                                                *
 12097*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12098*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12099*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12100*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12101*                                                                *
 12102******************************************************************
 12103
 12104     IF PB-EXT-DAYS-PROCESSING
 12105          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12106                                         PB-I-LF-EXPIRE-DT
 12107                                         PB-I-AH-EXPIRE-DT
 12108          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12109          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12110          MOVE +1                     TO DC-ELAPSED-MONTHS
 12111          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12112          SET BIN-PLUS-ELAPSED        TO TRUE
 12113*         MOVE 6                      TO DC-OPTION-CODE
 12114          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12115          IF NO-CONVERSION-ERROR
 12116             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12117
 12118******************************************************************
 12119*                                                                *
 12120*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12121*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12122*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12123*        (EXPIRE DATE - (TERM -1))  *  -1.
 12124*                                                                *
 12125******************************************************************
 12126
 12127     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 221
* EL050.cbl
 12128        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12129           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12130              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12131              MOVE PB-I-AH-TERM      TO WS-TERM
 12132           ELSE
 12133              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12134              MOVE PB-I-LF-TERM      TO WS-TERM
 12135        ELSE
 12136           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12137              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12138              MOVE PB-I-LF-TERM      TO WS-TERM
 12139           ELSE
 12140              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12141              MOVE PB-I-AH-TERM      TO WS-TERM.
 12142
 12143     IF PB-EXPIRE-DT-PROCESSING
 12144        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12145        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12146        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12147        MOVE ZERO                TO DC-ELAPSED-DAYS
 12148                                    DC-ODD-DAYS-OVER
 12149          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12150          SET BIN-PLUS-ELAPSED    TO TRUE
 12151*         MOVE 6                  TO DC-OPTION-CODE
 12152          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12153          IF NO-CONVERSION-ERROR
 12154             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12155
 12156******************************************************************
 12157*                                                                *
 12158*            1ST PAYMENT DATE PROCESSING                         *
 12159*                                                                *
 12160******************************************************************
 12161
 12162     IF PB-1ST-PMT-DT-PROCESSING
 12163        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12164                                    PB-I-AH-EXPIRE-DT
 12165        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12166
 12167     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12168         NEXT SENTENCE
 12169     ELSE
 12170         MOVE ER-2680                 TO WS-ERROR
 12171         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12172         GO TO 3060-ORIG-TERM-CHECK.
 12173
 12174     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12175     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12176     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12177*    MOVE 1                      TO DC-OPTION-CODE.
 12178     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12179                                    DC-ELAPSED-DAYS
 12180                                    DC-ODD-DAYS-OVER.
 12181
 12182     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12183
 12184     IF DATE-CONVERSION-ERROR
 12185        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 222
* EL050.cbl
 12186
 12187     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12188     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12189        AND (WS-LF-COVERAGE-TYPE = 'L')
 12190        IF (DC-ELAPSED-MONTHS > 1)
 12191                      OR
 12192           ((DC-ELAPSED-MONTHS = 1)
 12193           AND (DC-ODD-DAYS-OVER > 0))
 12194           MOVE ER-2882          TO WS-ERROR
 12195           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12196        END-IF
 12197     END-IF
 12198     if dc-elapsed-months > 0
 12199        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12200        + dc-odd-days-over
 12201     end-if
 12202     IF PB-EXT-DAYS-PROCESSING
 12203        CONTINUE
 12204     ELSE
 12205        IF DC-ELAPSED-MONTHS = +0
 12206           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12207        ELSE
 12208           IF (WS-LF-EARNINGS-CALC = '4')
 12209              AND (DC-ELAPSED-MONTHS > ZERO)
 12210              AND (DC-ELAPSED-DAYS > ZERO)
 12211              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12212           ELSE
 12213              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12214                                 THRU 6499-EXIT
 12215              MOVE WS-ODD-DAYS-OVER
 12216                                 TO PB-I-EXTENTION-DAYS
 12217           END-IF
 12218        END-IF
 12219     END-IF
 12220******************************************************************
 12221*                                                                *
 12222*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12223*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12224*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12225*            AND ANY ODD DAYS.                                   *
 12226*                                                                *
 12227******************************************************************
 12228
 12229     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12230                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12231     IF WS-LF-EARNINGS-CALC NOT = '4'
 12232        IF DC-ELAPSED-DAYS > ZEROS
 12233           MOVE ER-2681          TO WS-ERROR
 12234           PERFORM 9900-ERROR-FORMAT
 12235                                 THRU 9900-EXIT
 12236        END-IF
 12237     END-IF
 12238
 12239     IF WS-LF-EARNINGS-CALC NOT = '4'
 12240        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12241           MOVE ER-2681          TO WS-ERROR
 12242           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12243
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 223
* EL050.cbl
 12244     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12245        (PB-I-LF-TERM NOT = ZERO) AND
 12246         NOT NO-LIFE-COVERAGE
 12247          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12248          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12249          IF WS-LF-EARNINGS-CALC = '4'
 12250             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12251             PB-I-PAY-FREQUENCY
 12252          END-IF
 12253          MOVE ZERO              TO DC-ELAPSED-DAYS
 12254                                    DC-ODD-DAYS-OVER
 12255          MOVE 1                 TO DC-END-OF-MONTH
 12256          SET BIN-PLUS-ELAPSED        TO TRUE
 12257*         MOVE 6                 TO DC-OPTION-CODE
 12258          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12259          IF NO-CONVERSION-ERROR
 12260             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12261             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12262                (WS-LF-SPECIAL-CALC-CD = 'L')
 12263                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12264                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12265                  MOVE +1             TO DC-ELAPSED-MONTHS
 12266                  SET BIN-PLUS-ELAPSED  TO TRUE
 12267*                 MOVE 6              TO DC-OPTION-CODE
 12268                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12269                  IF NO-CONVERSION-ERROR
 12270                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12271
 12272* okay, i had to move the new att age edit down here because the
 12273* expiration date could get recalculated and i need the exp date
 12274     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12275        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12276        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12277        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12278           AND ZEROS
 12279           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12280           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12281           SET ELAPSED-BETWEEN-BIN TO TRUE
 12282           PERFORM 8500-DATE-CONVERT
 12283                                 THRU 8500-EXIT
 12284           IF NO-CONVERSION-ERROR
 12285              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12286                 MOVE ER-2669       TO WS-ERROR
 12287*                PERFORM 9900-ERROR-FORMAT
 12288*                                THRU 9900-EXIT
 12289              END-IF
 12290           END-IF
 12291        ELSE
 12292           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12293           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12294              MOVE ER-2669       TO WS-ERROR
 12295*             PERFORM 9900-ERROR-FORMAT
 12296*                                THRU 9900-EXIT
 12297           ELSE
 12298              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12299                 MOVE ER-1570    TO WS-ERROR
 12300                 PERFORM 9900-ERROR-FORMAT
 12301                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 224
* EL050.cbl
 12302              END-IF
 12303           END-IF
 12304        END-IF
 12305        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12306           AND ZEROS
 12307           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12308           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12309           SET ELAPSED-BETWEEN-BIN TO TRUE
 12310           PERFORM 8500-DATE-CONVERT
 12311                                 THRU 8500-EXIT
 12312           IF NO-CONVERSION-ERROR
 12313              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12314                 MOVE ER-2669       TO WS-ERROR
 12315*                PERFORM 9900-ERROR-FORMAT
 12316*                                THRU 9900-EXIT
 12317              END-IF
 12318           END-IF
 12319        ELSE
 12320           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12321             (PB-I-LF-TERM / 12)
 12322           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12323              MOVE ER-2669       TO WS-ERROR
 12324*             PERFORM 9900-ERROR-FORMAT
 12325*                                THRU 9900-EXIT
 12326           ELSE
 12327              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12328                 MOVE ER-1571    TO WS-ERROR
 12329                 PERFORM 9900-ERROR-FORMAT
 12330                                 THRU 9900-EXIT
 12331              END-IF
 12332           END-IF
 12333        END-IF
 12334        IF WS-ERROR = ER-2669
 12335           PERFORM 9900-ERROR-FORMAT
 12336                                 THRU 9900-EXIT
 12337        END-IF
 12338     END-IF
 12339     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12340        (PB-I-AH-TERM NOT = ZERO) AND
 12341         NOT NO-AH-COVERAGE
 12342          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12343             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12344             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12345             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12346          ELSE
 12347             IF WS-LF-EARNINGS-CALC = '4'
 12348                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12349                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12350                PB-I-PAY-FREQUENCY
 12351             ELSE
 12352                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12353                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12354             END-IF
 12355          END-IF
 12356          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12357                                         DC-ODD-DAYS-OVER
 12358          MOVE 1                      TO DC-END-OF-MONTH
 12359          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 225
* EL050.cbl
 12360*         MOVE 6                      TO DC-OPTION-CODE
 12361          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12362          IF NO-CONVERSION-ERROR
 12363             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12364     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12365        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12366        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12367        IF PB-I-BIRTHDAY > LOW-VALUES
 12368           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12369           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12370           SET ELAPSED-BETWEEN-BIN TO TRUE
 12371           PERFORM 8500-DATE-CONVERT
 12372                                 THRU 8500-EXIT
 12373           IF NO-CONVERSION-ERROR
 12374              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12375                 MOVE ER-3054       TO WS-ERROR
 12376*                PERFORM 9900-ERROR-FORMAT
 12377*                                THRU 9900-EXIT
 12378              END-IF
 12379           END-IF
 12380        ELSE
 12381           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12382           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12383              MOVE ER-3054       TO WS-ERROR
 12384*             PERFORM 9900-ERROR-FORMAT
 12385*                                THRU 9900-EXIT
 12386           END-IF
 12387        END-IF
 12388        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12389           AND ZEROS
 12390           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12391           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12392           SET ELAPSED-BETWEEN-BIN TO TRUE
 12393           PERFORM 8500-DATE-CONVERT
 12394                                 THRU 8500-EXIT
 12395           IF NO-CONVERSION-ERROR
 12396              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12397                 MOVE ER-3054       TO WS-ERROR
 12398*                PERFORM 9900-ERROR-FORMAT
 12399*                                THRU 9900-EXIT
 12400              END-IF
 12401           END-IF
 12402        ELSE
 12403           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12404             (PB-I-AH-TERM / 12)
 12405           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12406              MOVE ER-3054       TO WS-ERROR
 12407*             PERFORM 9900-ERROR-FORMAT
 12408*                                THRU 9900-EXIT
 12409           END-IF
 12410        END-IF
 12411        IF WS-ERROR = ER-3054
 12412           PERFORM 9900-ERROR-FORMAT
 12413                                 THRU 9900-EXIT
 12414        END-IF
 12415     END-IF
 12416     MOVE SPACE                       TO DC-END-OF-MONTH.
 12417
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 226
* EL050.cbl
 12418     IF PB-COMPANY-ID = 'NCB'
 12419        GO TO 3040-EDIT-EXTENSION-DAYS.
 12420
 12421     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12422       AND
 12423        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12424        NEXT SENTENCE
 12425     ELSE
 12426        GO TO 3040-EDIT-EXTENSION-DAYS.
 12427
 12428     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12429        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12430        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12431     ELSE
 12432        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12433        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12434
 12435     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12436*    MOVE '1'      TO DC-OPTION-CODE
 12437     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12438     IF (NO-CONVERSION-ERROR)
 12439        AND (DC-ELAPSED-MONTHS > +1)
 12440        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12441        MOVE ER-2668   TO WS-ERROR
 12442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12443
 12444 3040-EDIT-EXTENSION-DAYS.
 12445
 12446     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12447        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12448         GO TO 3050-EDIT-TERM-IN-DAYS
 12449     ELSE
 12450         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12451
 12452     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12453         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12454     ELSE
 12455        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12456           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12457           MOVE ER-2681         TO WS-ERROR
 12458           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12459
 12460     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12461        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12462        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12463         GO TO 3060-ORIG-TERM-CHECK.
 12464
 12465     GO TO 3060-ORIG-TERM-CHECK.
 12466
 12467 3050-EDIT-TERM-IN-DAYS.
 12468
 12469     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12470
 12471     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12472         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12473     ELSE
 12474         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12475            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 227
* EL050.cbl
 12476            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12477
 12478     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12479                                       REMAINDER WS-WORK-TERM.
 12480     IF WS-WORK-TERM GREATER THAN ZERO
 12481         ADD +1 TO PB-I-LF-TERM.
 12482
 12483     IF NOT NO-AH-COVERAGE
 12484         MOVE ER-2684            TO WS-ERROR
 12485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12486
 12487
 12488 3060-ORIG-TERM-CHECK.
 12489
 12490******************************************************************
 12491*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12492******************************************************************
 12493
 12494     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12495        NEXT SENTENCE
 12496     ELSE
 12497        IF NOT NO-LIFE-COVERAGE
 12498           IF PB-I-LF-TERM NUMERIC
 12499              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12500              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12501              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12502                  NEXT SENTENCE
 12503           ELSE
 12504              MOVE ER-2647       TO WS-ERROR
 12505              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12506
 12507     IF NOT NO-AH-COVERAGE
 12508         IF PB-I-AH-TERM NUMERIC
 12509            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12510            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12511            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12512             NEXT SENTENCE
 12513          ELSE
 12514              MOVE ER-2658       TO WS-ERROR
 12515              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12516
 12517     IF PB-COMPANY-ID = 'NCB'
 12518        GO TO 3070-LOAN-TERM-CHECK.
 12519
 12520     IF POLICY-HAS-AH
 12521       AND
 12522        POLICY-HAS-LIFE
 12523       AND
 12524        PB-I-LF-TERM NUMERIC
 12525       AND
 12526        PB-I-AH-TERM NUMERIC
 12527        NEXT SENTENCE
 12528     ELSE
 12529        GO TO 3070-LOAN-TERM-CHECK.
 12530
 12531     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12532     IF WS-TEX-FACT-2 LESS THAN +0
 12533        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 228
* EL050.cbl
 12534
 12535     IF WS-TEX-FACT-2 GREATER THAN +1
 12536        MOVE ER-2668             TO WS-ERROR
 12537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12538
 12539 3070-LOAN-TERM-CHECK.
 12540
 12541     IF (WS-LF-BENEFIT-CD = ZERO)
 12542         OR (NO-LF-BENEFIT-MATCH)
 12543            GO TO 3125-EDIT-PMT-FREQ.
 12544*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12545*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12546*          AND 'V' AND 'W' AND 'X'
 12547*          GO TO 3125-EDIT-PMT-FREQ
 12548*       END-IF
 12549*    ELSE
 12550*       IF WS-AH-DCC-TRUNC = 'T'
 12551*          CONTINUE
 12552*       ELSE
 12553*          GO TO 3125-EDIT-PMT-FREQ
 12554*       END-IF
 12555*    END-IF
 12556     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12557                    OR
 12558        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12559        AND (WS-AH-DCC-TRUNC = 'T'))
 12560        CONTINUE
 12561     ELSE
 12562        GO TO 3125-EDIT-PMT-FREQ
 12563     END-IF
 12564     IF PB-I-LOAN-TERM NOT NUMERIC
 12565         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12566
 12567     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12568        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12569*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12570        PB-I-LOAN-TERM NOT GREATER THAN +360
 12571         NEXT SENTENCE
 12572     ELSE
 12573         MOVE ER-2648            TO WS-ERROR
 12574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12575
 12576     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12577        MOVE ER-3058             TO WS-ERROR
 12578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12579     end-if
 12580
 12581     IF WS-STATE-ABBREVIATION = 'NC'
 12582        IF PB-I-LOAN-TERM > +59
 12583           CONTINUE
 12584        ELSE
 12585           MOVE ER-2792          TO WS-ERROR
 12586           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12587        END-IF
 12588     END-IF
 12589
 12590     .
 12591 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 229
* EL050.cbl
 12592     IF (WS-LF-BENEFIT-CD = ZERO)
 12593         OR (NO-LF-BENEFIT-MATCH)
 12594            GO TO 3127-EDIT-LOAN-OFFICER.
 12595     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12596                    OR
 12597        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12598        AND (WS-AH-DCC-TRUNC = 'T'))
 12599                    OR
 12600         (PB-COMPANY-ID = 'AHL')
 12601        CONTINUE
 12602     ELSE
 12603        IF (PB-I-LOAN-TERM > ZEROS)
 12604           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12605           MOVE ER-1575          TO WS-ERROR
 12606           PERFORM 9900-ERROR-FORMAT
 12607                                 THRU 9900-EXIT
 12608        END-IF
 12609     END-IF
 12610     IF WS-LF-EARNINGS-CALC NOT = '4'
 12611         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12612            MOVE ER-2653         TO WS-ERROR
 12613            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12614            GO TO 3127-EDIT-LOAN-OFFICER
 12615         ELSE
 12616            GO TO 3127-EDIT-LOAN-OFFICER.
 12617
 12618     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12619         MOVE ER-2655            TO WS-ERROR
 12620         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12621         GO TO 3127-EDIT-LOAN-OFFICER.
 12622
 12623     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12624         MOVE ER-2654            TO WS-ERROR
 12625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12626         GO TO 3127-EDIT-LOAN-OFFICER.
 12627
 12628     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12629         GIVING WS-TEX-FACT-2
 12630             REMAINDER WS-TEX-FACT-3.
 12631
 12632*    IF WS-TEX-FACT-3 NOT = ZERO
 12633*       MOVE ER-2654             TO WS-ERROR
 12634*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12635
 12636
 12637 3127-EDIT-LOAN-OFFICER.
 12638
 12639     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12640        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12641           MOVE ER-2690          TO WS-ERROR
 12642           PERFORM 9900-ERROR-FORMAT
 12643                                 THRU 9900-EXIT
 12644        ELSE
 12645           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12646           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12647           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12648           MOVE PB-SV-STATE      TO LOFC-STATE
 12649           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 230
* EL050.cbl
 12650           MOVE PB-I-LOAN-OFFICER
 12651                                 TO LOFC-CODE
 12652           PERFORM 8586-READ-LOAN-OFFICER
 12653                                 THRU 8586-EXIT
 12654           IF (NOT LOFC-MASTER-FOUND)
 12655              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12656              MOVE ER-3006       TO WS-ERROR
 12657              PERFORM 9900-ERROR-FORMAT
 12658                                 THRU 9900-EXIT
 12659           END-IF
 12660        END-IF
 12661     END-IF
 12662     .
 12663 3129-EDIT-APR.
 12664
 12665     IF (WS-LF-BENEFIT-CD = ZERO)
 12666        OR (NO-LF-BENEFIT-MATCH)
 12667        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12668           GO TO 3130-EDIT-AGE
 12669*       ELSE
 12670*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12671*             GO TO 3130-EDIT-AGE
 12672*          END-IF
 12673        END-IF
 12674     END-IF
 12675
 12676     IF (WS-STATE-ABBREVIATION = 'OH')
 12677         AND (PB-I-RATE-CLASS NOT = 'L ')
 12678         AND (PB-I-LF-TERM GREATER THAN 60)
 12679         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12680         GO TO 3129-APR-CONT.
 12681
 12682     IF (WS-STATE-ABBREVIATION = 'RI')
 12683         AND (PB-I-LF-TERM GREATER THAN 60)
 12684         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12685         GO TO 3129-APR-CONT.
 12686
 12687     IF (WS-STATE-ABBREVIATION = 'UT')
 12688         AND (PB-I-LF-TERM GREATER THAN 62)
 12689         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12690         AND (PB-CERT-EFF-DT LESS WS-830901)
 12691         GO TO 3129-APR-CONT.
 12692
 12693     IF PB-COMPANY-ID = 'LAP'
 12694        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12695           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12696              MOVE ER-2656         TO WS-ERROR
 12697              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12698              GO TO 3130-EDIT-AGE.
 12699
 12700     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12701        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12702        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12703        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12704        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12705        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12706         GO TO 3130-EDIT-AGE.
 12707
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 231
* EL050.cbl
 12708 3129-APR-CONT.
 12709     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12710         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12711         GO TO 3130-EDIT-AGE.
 12712
 12713     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12714         WS-AH-BENEFIT-CD (1:1) = 'S')
 12715        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12716        AND (PB-I-LOAN-APR = ZERO)
 12717        MOVE ER-2657             TO WS-ERROR
 12718        PERFORM 9900-ERROR-FORMAT
 12719                                 THRU 9900-EXIT
 12720        GO TO 3130-EDIT-AGE
 12721     END-IF
 12722*    IF PB-I-LOAN-APR = ZERO
 12723*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12724*    END-IF
 12725
 12726     if pb-i-loan-apr = +99.9999
 12727        move er-2656             to ws-error
 12728        PERFORM 9900-ERROR-FORMAT
 12729                                 THRU 9900-EXIT
 12730        GO TO 3130-EDIT-AGE
 12731     end-if
 12732*    IF PB-I-LOAN-APR = ZERO
 12733*       MOVE ER-2656             TO WS-ERROR
 12734*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12735*       GO TO 3130-EDIT-AGE.
 12736
 12737*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12738     if pb-i-loan-apr not = +99.9999
 12739        IF PB-I-LOAN-APR > +30.000
 12740           MOVE ER-2657          TO WS-ERROR
 12741           PERFORM 9900-ERROR-FORMAT
 12742                                 THRU 9900-EXIT
 12743        end-if
 12744     end-if
 12745     .
 12746 3130-EDIT-AGE.
 12747
 12748******************************************************************
 12749*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12750******************************************************************
 12751
 12752     IF NOT NO-LIFE-COVERAGE
 12753        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12754           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12755               MOVE ER-2628             TO WS-ERROR
 12756               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12757
 12758     IF NOT NO-AH-COVERAGE
 12759        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12760           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12761               MOVE ER-2628         TO WS-ERROR
 12762               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12763
 12764 3133-SEX-CODE.
 12765     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 232
* EL050.cbl
 12766         IF WS-DEFAULT-SEX = 'M'
 12767             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12768          ELSE
 12769             IF WS-DEFAULT-SEX = 'F'
 12770             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12771
 12772     IF PB-I-INSURED-SEX = '1'
 12773         MOVE 'M' TO PB-I-INSURED-SEX.
 12774
 12775     IF PB-I-INSURED-SEX = '2'
 12776         MOVE 'F' TO PB-I-INSURED-SEX.
 12777
 12778 3134-SIG-SW-EDIT.
 12779     IF PB-I-SIG-SW = SPACE
 12780         MOVE 'N'                TO  PB-I-SIG-SW.
 12781
 12782     IF PB-COMPANY-ID = 'NCL'
 12783         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12784             NEXT SENTENCE
 12785         ELSE
 12786             MOVE ER-1923        TO  WS-ERROR
 12787             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12788     ELSE
 12789     IF PB-COMPANY-ID = 'CRI'
 12790         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12791             NEXT SENTENCE
 12792         ELSE
 12793             MOVE ER-2606        TO  WS-ERROR
 12794             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12795     ELSE
 12796     IF PB-COMPANY-ID = 'TMS'
 12797         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12798             NEXT SENTENCE
 12799         ELSE
 12800             MOVE ER-2689        TO  WS-ERROR
 12801             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12802     ELSE
 12803         IF PB-I-SIG-SW = 'Y' OR 'N'
 12804             NEXT SENTENCE
 12805         ELSE
 12806             MOVE ER-2651        TO  WS-ERROR
 12807             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12808
 12809     IF PB-COMPANY-ID = 'FLA'
 12810         IF (WS-EDIT-AGE GREATER 54  OR
 12811             WS-AH-EDIT-AGE GREATER 54)  AND
 12812            PB-I-SIG-SW = 'N'
 12813            MOVE ER-2651         TO  WS-ERROR
 12814            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12815
 12816 3135-NAME-EDIT.
 12817
 12818     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12819        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12820        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12821           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12822                                 TO PB-I-JOINT-FIRST-NAME
 12823        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 233
* EL050.cbl
 12824     END-IF
 12825     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12826        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12827        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12828           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12829                                 TO PB-I-JOINT-LAST-NAME
 12830        END-PERFORM
 12831     END-IF
 12832     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12833        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12834        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12835           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12836                                 TO PB-I-INSURED-FIRST-NAME
 12837        END-PERFORM
 12838     END-IF
 12839     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12840        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12841        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12842           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12843                                 TO PB-I-INSURED-LAST-NAME
 12844        END-PERFORM
 12845     END-IF
 12846     IF PB-I-INSURED-LAST-NAME = SPACES
 12847       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12848       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12849           MOVE ER-2660    TO WS-ERROR
 12850           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12851
 12852 3136-EDIT-SEX.
 12853
 12854******************************************************************
 12855*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12856******************************************************************
 12857
 12858     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12859        (WS-AH-SPECIAL-CALC-CD = 'O')
 12860        NEXT SENTENCE
 12861     ELSE
 12862        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12863           NEXT SENTENCE
 12864        ELSE
 12865           MOVE ER-2629            TO WS-ERROR
 12866           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12867
 12868 3137-EDIT-EFF-DATE.
 12869
 12870     IF PB-REISSUED-CERT       OR
 12871        PB-POLICY-IS-DECLINED  OR
 12872        PB-POLICY-IS-VOIDED
 12873         GO TO 3139-EDIT-COVERAGE-CODES.
 12874
 12875     MOVE SPACE                  TO WS-2671-SW
 12876                                    WS-2672-SW.
 12877
 12878     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12879         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12880             MOVE ER-2703        TO WS-ERROR
 12881             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 234
* EL050.cbl
 12882             GO TO 3139-EDIT-COVERAGE-CODES.
 12883
 12884     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12885         GO TO 3139-EDIT-COVERAGE-CODES.
 12886
 12887     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12888     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12889*    MOVE '1'                    TO DC-OPTION-CODE.
 12890     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12891     MOVE +0                     TO DC-ELAPSED-MONTHS
 12892                                    DC-ELAPSED-DAYS.
 12893     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12894
 12895     IF DATE-CONVERSION-ERROR
 12896         GO TO 3139-EDIT-COVERAGE-CODES.
 12897
 12898     IF DC-ELAPSED-DAYS GREATER +180
 12899         MOVE ER-2672            TO WS-ERROR
 12900         MOVE 'Y'                TO WS-2672-SW
 12901         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12902     END-IF
 12903
 12904     IF WS-ERROR = ER-2671  AND
 12905        PB-COMPANY-ID  = 'LBL'
 12906        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12907        MOVE SPACE               TO WS-2671-SW
 12908        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12909
 12910     IF PB-ISSUE-DATE-FORCED  AND
 12911      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12912         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12913         MOVE ER-2673            TO WS-ERROR
 12914         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12915         MOVE SPACE              TO WS-2671-SW
 12916                                    WS-2672-SW.
 12917
 12918     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12919         IF PB-ISSUE-DATE-FORCED
 12920             MOVE ER-2600          TO  WS-ERROR
 12921             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12922         ELSE
 12923             MOVE ER-2692          TO  WS-ERROR
 12924             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12925
 12926
 12927 3139-EDIT-COVERAGE-CODES.
 12928
 12929     if pb-company-id not = 'AHL'
 12930        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12931           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12932           MOVE ER-2787          TO WS-ERROR
 12933           PERFORM 9900-ERROR-FORMAT
 12934                                 THRU 9900-EXIT
 12935        END-IF
 12936     end-if
 12937     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12938        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12939                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 235
* EL050.cbl
 12940           MOVE ER-2719          TO WS-ERROR
 12941           PERFORM 9900-ERROR-FORMAT
 12942                                 THRU 9900-EXIT
 12943        END-IF
 12944     END-IF
 12945
 12946     IF PB-POLICY-IS-DECLINED  OR
 12947        PB-POLICY-IS-VOIDED
 12948         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12949
 12950     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12951        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12952         MOVE ER-2630                TO WS-ERROR
 12953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12954
 12955     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12956        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12957        PB-I-LF-PREMIUM-AMT = ZERO
 12958         GO TO 3140-CHECK-AH-FOR-ZERO.
 12959
 12960     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12961        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12962        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12963         GO TO 3140-CHECK-AH-FOR-ZERO.
 12964
 12965     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12966        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12967        MOVE ER-2631             TO WS-ERROR
 12968        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12969     END-IF
 12970
 12971
 12972******************************************************************
 12973*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12974******************************************************************
 12975
 12976     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12977        NEXT SENTENCE
 12978     ELSE
 12979        IF PB-I-LF-BENEFIT-AMT = ZERO
 12980           MOVE ER-2632             TO WS-ERROR
 12981           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12982
 12983
 12984******************************************************************
 12985*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12986******************************************************************
 12987
 12988     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12989        CONTINUE
 12990     ELSE
 12991        IF PB-I-LF-PREMIUM-AMT = ZERO
 12992           IF (NOT PB-COMP-LF-PREM)
 12993              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12994              and (ws-lf-ben-category not = 'C')
 12995              MOVE ER-2633       TO WS-ERROR
 12996              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12997           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 236
* EL050.cbl
 12998        END-IF
 12999     END-IF
 13000     .
 13001 3140-CHECK-AH-FOR-ZERO.
 13002
 13003     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13004        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13005        PB-I-AH-PREMIUM-AMT = ZERO
 13006         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13007
 13008     IF PB-COMPANY-ID = 'CSL'  AND
 13009        PB-I-AH-BENEFIT-CD = ZERO  AND
 13010        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13011        PB-I-AH-PREMIUM-AMT = ZERO
 13012         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13013
 13014     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13015        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13016        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13017         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13018
 13019     IF PB-I-AH-BENEFIT-CD = ZERO
 13020         MOVE ER-2634            TO WS-ERROR
 13021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13022
 13023******************************************************************
 13024*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13025******************************************************************
 13026
 13027     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13028        NEXT SENTENCE
 13029     ELSE
 13030        IF PB-I-AH-BENEFIT-AMT = ZERO
 13031           MOVE ER-2635             TO WS-ERROR
 13032           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13033
 13034******************************************************************
 13035*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13036******************************************************************
 13037
 13038     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13039        NEXT SENTENCE
 13040     ELSE
 13041        IF PB-I-AH-PREMIUM-AMT = ZERO
 13042            IF NOT PB-COMP-AH-PREM
 13043                MOVE ER-2636    TO WS-ERROR
 13044                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13045
 13046
 13047 3140-EDIT-MAX-AMT-SIZES.
 13048* CUSTOM CODE FOR CLIENT    'DMD'
 13049     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13050                                     WS-RES-MUNI-TAX
 13051                                     PB-I-STATE-TAX
 13052                                     PB-I-MUNI-TAX.
 13053
 13054     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13055
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 237
* EL050.cbl
 13056     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13057        GO TO 3150-RATE-OUTSTAND-BAL.
 13058
 13059     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13060        GO TO 3150-RATE-OUTSTAND-BAL.
 13061
 13062     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13063        GO TO 3150-RATE-OUTSTAND-BAL.
 13064
 13065     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13066                             OR 'RIC')
 13067        GO TO 3150-RATE-OUTSTAND-BAL.
 13068
 13069     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13070        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13071            GO TO 3150-RATE-OUTSTAND-BAL
 13072        ELSE
 13073           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13074               GO TO 3150-RATE-OUTSTAND-BAL.
 13075
 13076     IF NOT PB-NO-MONTHS-SKIPPED
 13077        GO TO 3150-RATE-OUTSTAND-BAL.
 13078
 13079     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13080        GO TO 3150-RATE-OUTSTAND-BAL.
 13081
 13082     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13083        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13084           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13085             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13086           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13087           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13088              MOVE ER-2693     TO WS-ERROR
 13089              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13090              GO TO 3150-RATE-OUTSTAND-BAL
 13091           ELSE
 13092              GO TO 3150-RATE-OUTSTAND-BAL.
 13093
 13094 3150-RATE-OUTSTAND-BAL.
 13095
 13096* DMD RATING TEST
 13097     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13098         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13099         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13100         MOVE ER-2687                 TO WS-ERROR
 13101         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13102         MOVE 'B'                     TO PB-I-OB-FLAG
 13103         GO TO 3260-EDIT-CONTINUE.
 13104
 13105     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13106         IF  WS-ERROR    EQUAL    ER-2693
 13107             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13108                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13109                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13110                 MOVE  +0            TO  WS-ERROR.
 13111
 13112     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13113         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 238
* EL050.cbl
 13114             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13115                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13116                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13117                 MOVE  +0            TO  WS-ERROR.
 13118
 13119     IF PLAN-MASTER-AH-SW = 'Y'
 13120        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13121            IF  WS-ERROR    EQUAL    ER-2693
 13122              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13123                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13124                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13125                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13126                 MOVE  ER-1910           TO  WS-ERROR
 13127                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13128
 13129     IF PLAN-MASTER-AH-SW = 'Y'
 13130        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13131            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13132               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13133               MOVE  ER-1910           TO  WS-ERROR
 13134               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13135
 13136     IF PLAN-MASTER-AH-SW = 'Y'
 13137        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13138            IF  WS-ERROR    EQUAL    ER-2693
 13139                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13140                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13141                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13142                 MOVE  +0       TO  WS-ERROR.
 13143
 13144     IF WS-ERROR = ER-2693
 13145        IF PB-COMPANY-ID = 'JAL' AND
 13146           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13147           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13148           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13149
 13150     IF WS-ERROR = ER-2693
 13151        IF PB-COMPANY-ID = 'NCL'  AND
 13152           PB-I-AH-BENEFIT-CD = 'OA'
 13153           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13154           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13155
 13156     IF WS-ERROR = ER-2693
 13157        IF PB-COMPANY-ID = 'CNL' AND
 13158           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13159           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13160           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13161
 13162     IF WS-ERROR = ER-2693
 13163        IF PB-COMPANY-ID = 'HER'
 13164           IF WS-LEVEL
 13165              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13166              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13167
 13168     IF ((LF-BENEFIT-FOUND) AND
 13169         (NOT NO-LIFE-COVERAGE)  AND
 13170         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13171       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 239
* EL050.cbl
 13172             (NOT NO-AH-COVERAGE)    AND
 13173             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13174         NEXT SENTENCE
 13175     ELSE
 13176         GO TO 3215-EDIT-RATES.
 13177
 13178     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13179        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13180           MOVE ER-2674          TO WS-ERROR
 13181           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13182           GO TO 3215-EDIT-RATES.
 13183
 13184     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13185        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13186           MOVE ER-2674          TO WS-ERROR
 13187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13188           GO TO 3215-EDIT-RATES.
 13189
 13190     MOVE 'B'                    TO PB-I-OB-FLAG.
 13191
 13192     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13193         NEXT SENTENCE
 13194     ELSE
 13195         IF NOT NO-LIFE-COVERAGE
 13196             IF WS-ACCT-LF-OB-RT = ZERO
 13197                MOVE ER-2641    TO WS-ERROR
 13198                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13199
 13200     IF PB-COMPANY-ID = 'CRI'
 13201       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13202         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13203         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13204         IF WS-ERROR = ER-2675
 13205            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13206            MOVE ER-2687              TO WS-ERROR
 13207            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13208         ELSE
 13209            MOVE ER-2687              TO WS-ERROR
 13210            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13211
 13212
 13213     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13214         NEXT SENTENCE
 13215     ELSE
 13216       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13217            NEXT SENTENCE
 13218       ELSE
 13219         IF NOT NO-AH-COVERAGE
 13220             IF WS-ACCT-AH-OB-RT = ZERO
 13221                MOVE ER-2642    TO WS-ERROR
 13222                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13223
 13224     IF PB-COMPANY-ID = 'CRI'
 13225       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13226         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13227         IF WS-ERROR = ER-2676
 13228            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13229            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 240
* EL050.cbl
 13230            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13231         ELSE
 13232            MOVE ER-2687              TO WS-ERROR
 13233            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13234
 13235     IF PB-COMPANY-ID NOT = 'GIC'
 13236         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13237            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13238     ELSE
 13239         IF PB-I-LF-PREM-CALC = ZEROS
 13240             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13241                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13242
 13243     IF PB-COMPANY-ID NOT = 'GIC'
 13244         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13245            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13246     ELSE
 13247         IF PB-I-AH-PREM-CALC = ZEROS
 13248             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13249                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13250
 13251     MOVE ZEROS TO PB-I-MORT-CODE.
 13252
 13253     GO TO 3260-EDIT-CONTINUE.
 13254
 13255
 13256 3215-EDIT-RATES.
 13257     IF ACCOUNT-MAST-FOUND
 13258         NEXT SENTENCE
 13259     ELSE
 13260         GO TO 3999-END-EDIT.
 13261
 13262 3220-CHECK-LF-RATES.
 13263
 13264     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13265        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13266        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13267        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13268           AND (NOT WS-LF-CASH))
 13269                           OR
 13270           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13271           AND (NOT WS-AH-CASH)))
 13272                       AND
 13273           (PB-I-ENTRY-STATUS NOT = '5')
 13274           MOVE 'M'              TO PB-BATCH-ENTRY
 13275                                    PB-I-ENTRY-STATUS
 13276        END-IF
 13277     END-IF
 13278     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13279                                    PB-I-AH-PREM-CALC
 13280                                    PB-I-LF-ALT-PREM-CALC
 13281                                    PB-I-LF-ALT-RATE
 13282                                    PB-I-LF-REI-RATE
 13283                                    PB-I-LF-ALT-REI-RATE
 13284                                    PB-I-AH-REI-RATE
 13285                                    PB-I-TOT-FEES-CALC.
 13286
 13287     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 241
* EL050.cbl
 13288        NEXT SENTENCE
 13289     ELSE
 13290        MOVE ZEROS               TO PB-I-LF-RATE
 13291                                    PB-I-AH-RATE.
 13292
 13293     IF PB-I-TOT-FEES NOT NUMERIC
 13294        MOVE ZEROS               TO PB-I-TOT-FEES
 13295     END-IF
 13296     IF PB-I-LIVES NOT NUMERIC
 13297         MOVE ZERO               TO PB-I-LIVES.
 13298
 13299     IF PB-I-NUM-BILLED NOT NUMERIC
 13300         MOVE ZERO               TO PB-I-NUM-BILLED.
 13301
 13302     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13303        MOVE +0                  TO PB-I-LF-PREM-TAX
 13304     END-IF
 13305
 13306     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13307        MOVE +0                  TO PB-I-AH-PREM-TAX
 13308     END-IF
 13309
 13310     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13311        PB-I-PAY-FREQUENCY = ZEROS
 13312            MOVE 12 TO CP-PAY-FREQUENCY
 13313     ELSE
 13314            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13315
 13316     IF PB-I-STATE-TAX NOT NUMERIC
 13317         MOVE ZEROS               TO PB-I-STATE-TAX.
 13318
 13319     IF PB-I-MUNI-TAX NOT NUMERIC
 13320         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13321
 13322     MOVE SPACES                 TO CP-BEN-CATEGORY
 13323     IF PB-COMPANY-ID  = 'CSL'  AND
 13324        PB-I-LF-TERM NOT = ZERO
 13325        COMPUTE WS-PAYMENT-AMT =
 13326             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13327        COMPUTE WS-CSL-AMT1 =
 13328             PB-I-LF-TERM * AM-MAX-MON-BEN
 13329        COMPUTE WS-CSL-AMT2 =
 13330             WS-PAYMENT-AMT * PB-I-LF-TERM
 13331        IF CP-PAY-FREQUENCY NOT = 12
 13332           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13333           MOVE '8' TO WS-CSL-CALC-CD
 13334        ELSE
 13335           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13336              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13337               AM-MAX-TOT-BEN
 13338               MOVE '6' TO WS-CSL-CALC-CD
 13339           ELSE
 13340              IF (WS-CSL-AMT1  GREATER THAN
 13341                 AM-MAX-TOT-BEN) AND
 13342                 (WS-CSL-AMT2  GREATER THAN
 13343                 AM-MAX-TOT-BEN)
 13344                 MOVE '7' TO WS-CSL-CALC-CD
 13345              ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 242
* EL050.cbl
 13346                 MOVE '5' TO WS-CSL-CALC-CD.
 13347
 13348     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13349         NEXT SENTENCE
 13350     ELSE
 13351         GO TO 3300-CHECK-AH-RATES.
 13352
 13353*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13354
 13355     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13356        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13357              OR
 13358           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13359           MOVE ER-2618          TO WS-ERROR
 13360           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13361           GO TO 3300-CHECK-AH-RATES.
 13362
 13363     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13364           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13365                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13366
 13367     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13368         MOVE ER-2687             TO WS-ERROR
 13369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13370         MOVE 'Z000'              TO PB-I-MORT-CODE
 13371         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13372         GO TO 3300-CHECK-AH-RATES.
 13373
 13374     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13375        IF PB-I-LIVES = ZERO
 13376           MOVE ER-2688          TO WS-ERROR
 13377           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13378
 13379     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13380
 13381     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13382     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13383     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13384     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13385     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13386     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13387     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13388     MOVE '3'                    TO CP-PROCESS-TYPE.
 13389     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13390     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13391
 13392******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13393     IF PB-COMPANY-ID EQUAL 'CDL'
 13394         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13395            CP-EARN-AS-NET-PAY)
 13396             IF PB-CERT-EFF-DT GREATER  WS-931231
 13397                 MOVE '1'        TO CP-EARNING-METHOD.
 13398*******
 13399
 13400     MOVE PB-SV-STATE            TO CP-STATE.
 13401     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13402     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13403     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 243
* EL050.cbl
 13404     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13405     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13406                                    CP-RATING-BENEFIT-AMT.
 13407     IF CP-STATE-STD-ABBRV = 'OR'
 13408         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13409                                         PB-I-LF-ALT-BENEFIT-AMT.
 13410     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13411     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13412     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13413     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13414     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13415     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13416     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13417     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13418     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13419                                    CP-REMAINING-TERM
 13420                                    CP-LOAN-TERM.
 13421
 13422     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13423         NEXT SENTENCE
 13424     ELSE
 13425         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13426             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13427                                           PB-I-LF-PREMIUM-AMT.
 13428
 13429     IF PB-COMPANY-ID EQUAL 'CSL'
 13430        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13431           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13432                                         PB-I-LF-PREMIUM-AMT.
 13433
 13434     IF PB-COMPANY-ID EQUAL 'NCB'
 13435         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13436            CP-EARN-AS-NET-PAY
 13437             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13438                 PB-I-LF-PREMIUM-AMT.
 13439
 13440     IF (CP-TRUNCATED-LIFE)
 13441        or ((pb-company-id = 'AHL')
 13442           and (pb-i-loan-term > pb-i-lf-term))
 13443        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13444
 13445     IF PB-COMPANY-ID EQUAL 'CRI'
 13446        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13447
 13448     IF CP-TERM-IS-DAYS
 13449         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13450     ELSE
 13451         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13452     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13453        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13454        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13455        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13456        IF WS-LF-BEN-CATEGORY = 'D'
 13457           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13458           MOVE PB-I-LIFE-COMMISSION
 13459                                 TO CP-DCC-ACT-COMM
 13460           MOVE WS-LF-BEN-CATEGORY
 13461                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 244
* EL050.cbl
 13462        END-IF
 13463        IF (CP-BENEFIT-CD (1:1) = 'P')
 13464           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13465           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13466           add pb-i-ah-premium-amt to cp-original-premium
 13467        END-IF
 13468     END-IF
 13469     IF PB-COMPANY-ID = 'CSL'
 13470         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13471         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13472         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13473
 13474     IF PB-COMPANY-ID = 'CSL'
 13475        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13476
 13477     IF (CP-SPECIAL-CALC-CD = 'H')
 13478        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13479         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13480                                    TO CP-ALTERNATE-BENEFIT
 13481         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13482     if (pb-company-id = 'CID')
 13483        and (ws-lf-earnings-calc = '4')
 13484        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13485        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13486        move pb-i-term-type      to cp-pmt-mode
 13487        move pb-i-no-of-payments to cp-no-of-pmts
 13488     end-if
 13489     move ws-net-only-state      to cp-net-only-state
 13490     IF (PB-COMPANY-ID = 'CID')
 13491        AND (WS-LF-EARNINGS-CALC = 'B')
 13492        AND (CP-STATE-STD-ABBRV = 'MN')
 13493        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13494                                 TO CP-ALTERNATE-BENEFIT
 13495        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13496     END-IF
 13497     IF (PB-COMPANY-ID = 'CID')
 13498        AND (WS-LF-EARNINGS-CALC = 'B')
 13499        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13500                                 TO CP-ALTERNATE-BENEFIT
 13501        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13502        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13503*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13504*         pb-i-lf-alt-premium-amt
 13505        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13506        IF WS-LF-BEN-CATEGORY = 'P'
 13507           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13508        ELSE
 13509           IF WS-LF-BEN-CATEGORY = 'I'
 13510              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13511           END-IF
 13512        END-IF
 13513     END-IF
 13514     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13515     MOVE 'R'                   TO CP-RATE-FILE.
 13516     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13517
 13518     IF CP-ERROR-RATE-NOT-FOUND
 13519        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 245
* EL050.cbl
 13520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13521        GO TO 3300-CHECK-AH-RATES.
 13522
 13523     IF PB-COMPANY-ID EQUAL 'CRI'
 13524        IF CP-ERROR-NO-LIMITS-CRI
 13525           IF NOT ACCOUNT-LIFE-CHECKED
 13526              MOVE ER-2607      TO WS-ERROR
 13527              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13528
 13529******************************************************************
 13530*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13531*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13532******************************************************************
 13533
 13534* CALC LIFE AGE AT EXPIRATION.
 13535
 13536     COMPUTE WS-AGE-AT-EXPIRE =
 13537          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13538
 13539*    IF PB-STATE = 'CO' OR 'UT'
 13540*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13541*        MOVE 'F'            TO PB-FATAL-FLAG
 13542*        MOVE ER-2709        TO WS-ERROR
 13543*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13544*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13545
 13546*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13547*        MOVE 'X'            TO PB-FATAL-FLAG
 13548*        MOVE ER-2718        TO WS-ERROR
 13549*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13550*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13551
 13552* CALC A & H AGE AT EXPIRATION.
 13553
 13554     COMPUTE WS-AGE-AT-EXPIRE =
 13555          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13556
 13557*    IF PB-STATE = 'CO' OR 'UT'
 13558*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13559*        MOVE 'F'            TO PB-FATAL-FLAG
 13560*        MOVE ER-2709        TO WS-ERROR
 13561*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13562*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13563
 13564*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13565*        MOVE 'X'            TO PB-FATAL-FLAG
 13566*        MOVE ER-2718        TO WS-ERROR
 13567*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13568*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13569
 13570     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13571        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13572
 13573     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13574        and (not pb-monthly-cert)
 13575        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13576     end-if
 13577
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 246
* EL050.cbl
 13578     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13579        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13580
 13581     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13582         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13583         MOVE ER-2639        TO WS-ERROR
 13584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13585
 13586
 13587******************************************************************
 13588*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13589******************************************************************
 13590
 13591 PREMIUM-EDITING-IS-BYPASSED.
 13592     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13593        AND (CP-R-MAX-ATT-AGE > +0)
 13594        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13595        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13596           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13597           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13598           MOVE '1'              TO DC-OPTION-CODE
 13599           PERFORM 8500-DATE-CONVERT
 13600                                 THRU 8500-EXIT
 13601           IF NO-CONVERSION-ERROR
 13602              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13603                 MOVE ER-2661       TO WS-ERROR
 13604*                PERFORM 9900-ERROR-FORMAT
 13605*                                THRU 9900-EXIT
 13606              END-IF
 13607           END-IF
 13608        ELSE
 13609           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13610           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13611              MOVE ER-2661       TO WS-ERROR
 13612*             PERFORM 9900-ERROR-FORMAT
 13613*                                THRU 9900-EXIT
 13614           ELSE
 13615              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13616                 MOVE ER-1570    TO WS-ERROR
 13617                 PERFORM 9900-ERROR-FORMAT
 13618                                 THRU 9900-EXIT
 13619              END-IF
 13620           END-IF
 13621        END-IF
 13622        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13623           MOVE PB-I-JOINT-BIRTHDAY
 13624                                 TO DC-BIN-DATE-1
 13625           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13626           MOVE '1'              TO DC-OPTION-CODE
 13627           PERFORM 8500-DATE-CONVERT
 13628                                 THRU 8500-EXIT
 13629           IF NO-CONVERSION-ERROR
 13630              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13631                 MOVE ER-2661       TO WS-ERROR
 13632*                PERFORM 9900-ERROR-FORMAT
 13633*                                THRU 9900-EXIT
 13634              END-IF
 13635           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 247
* EL050.cbl
 13636              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13637           END-IF
 13638        ELSE
 13639           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13640             (PB-I-LF-TERM / 12)
 13641           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13642              MOVE ER-2661       TO WS-ERROR
 13643*             PERFORM 9900-ERROR-FORMAT
 13644*                                THRU 9900-EXIT
 13645           ELSE
 13646              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13647                 MOVE ER-1571    TO WS-ERROR
 13648                 PERFORM 9900-ERROR-FORMAT
 13649                                 THRU 9900-EXIT
 13650              END-IF
 13651           END-IF
 13652        END-IF
 13653        IF WS-ERROR = ER-2661
 13654           PERFORM 9900-ERROR-FORMAT
 13655                                 THRU 9900-EXIT
 13656        END-IF
 13657     END-IF
 13658*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13659*       MOVE ER-2661             TO WS-ERROR
 13660*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13661
 13662     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13663        MOVE ER-2662             TO WS-ERROR
 13664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13665
 13666     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13667        MOVE ER-2677             TO WS-ERROR
 13668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13669
 13670     IF CP-ERROR-LOAN-TERM
 13671        MOVE ER-2648             TO WS-ERROR
 13672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13673
 13674 3221-CHECK-ERROR-RATE-OPEN.
 13675
 13676     IF CP-ERROR-RATE-FILE-NOTOPEN
 13677         GO TO 3990-FILES-NOT-OPEN.
 13678
 13679     IF PB-COMPANY-ID NOT = 'DMD'
 13680        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13681     END-IF
 13682     .
 13683 3221-CONTINUE.
 13684     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13685                                    WS-DCC-AH-RATE
 13686     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13687        IF WS-LF-BEN-CATEGORY = 'D'
 13688           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13689              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13690        END-IF
 13691     END-IF
 13692     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13693*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 248
* EL050.cbl
 13694     IF (PB-COMPANY-ID = 'CID')
 13695        AND (WS-LF-EARNINGS-CALC = 'B')
 13696        AND (CP-STATE-STD-ABBRV = 'MN')
 13697        AND (PB-CERT-EFF-DT > X'A4FF')
 13698        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13699     END-IF
 13700     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13701
 13702     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13703     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13704        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13705        AND (PB-I-POLICY-IS-MONTHLY)
 13706        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13707        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13708     END-IF
 13709     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13710     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13711     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13712     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13713     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13714        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13715        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13716        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13717        MOVE ER-2786             TO WS-ERROR
 13718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13719     END-IF
 13720
 13721     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13722
 13723******************************************************************
 13724*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13725******************************************************************
 13726     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13727        and ((not pb-monthly-cert)
 13728        or (ws-lf-ben-category = 'C'))
 13729        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13730
 13731     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13732        GO TO 3225-CHECK-ALT-LIFE-RATE
 13733     ELSE
 13734       IF PB-I-LF-RATE = ZERO
 13735          MOVE ER-2641          TO WS-ERROR
 13736          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13737
 13738 3225-CHECK-ALT-LIFE-RATE.
 13739
 13740     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13741        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13742        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13743         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13744
 13745     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13746         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13747             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13748                   OR
 13749              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13750              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13751              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 249
* EL050.cbl
 13752             MOVE ER-2720        TO  WS-ERROR
 13753             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13754             GO TO 3225-RATING-CONT
 13755         ELSE
 13756             GO TO 3225-RATING-CONT.
 13757     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13758        AND (AM-GPCD = 01 OR 06 OR 15)
 13759        MOVE ER-2798             TO WS-ERROR
 13760        PERFORM 9900-ERROR-FORMAT
 13761                                 THRU 9900-EXIT
 13762*       GO TO 3225-RATING-CONT
 13763     END-IF
 13764     if (pb-company-id = 'CID')
 13765        and (ws-lf-earnings-calc = 'B')
 13766        and (ws-lf-ben-category = 'P' or 'I')
 13767        and (ws-net-only-state = 'Y')
 13768        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13769        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13770        go to 3225-rating-cont
 13771     end-if
 13772     IF (PB-COMPANY-ID = 'CID')
 13773        AND (WS-LF-EARNINGS-CALC = 'B')
 13774        AND (CP-STATE-STD-ABBRV = 'MN')
 13775        AND (PB-CERT-EFF-DT > X'A4FF')
 13776        GO TO 3225-RATING-CONT
 13777     END-IF
 13778     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13779        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13780           AND (PB-I-POLICY-IS-MONTHLY)
 13781           GO TO 3225-RATING-CONT
 13782        END-IF
 13783     END-IF
 13784
 13785     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13786        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13787        CP-EARN-AS-REG-BALLOON
 13788        NEXT SENTENCE
 13789     ELSE
 13790        MOVE '2'                 TO CP-EARNING-METHOD.
 13791
 13792 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13793
 13794     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13795
 13796     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13797        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13798        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13799         NEXT SENTENCE
 13800     ELSE
 13801         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13802
 13803     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13804     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13805     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13806                                     CP-RATING-BENEFIT-AMT.
 13807     IF CP-STATE-STD-ABBRV = 'OR'
 13808         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13809                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 250
* EL050.cbl
 13810     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13811        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13812     END-IF
 13813     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13814     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13815     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13816                                    CP-REMAINING-TERM
 13817                                    CP-LOAN-TERM.
 13818     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13819        ADD +1                   TO CP-ORIGINAL-TERM
 13820                                    CP-REMAINING-TERM
 13821                                    CP-LOAN-TERM.
 13822
 13823     MOVE 'R'                   TO CP-RATE-FILE.
 13824     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13825
 13826     IF CP-ERROR-RATE-NOT-FOUND
 13827         MOVE ER-2641            TO WS-ERROR
 13828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13829         GO TO 3300-CHECK-AH-RATES.
 13830
 13831     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13832     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13833
 13834     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13835         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13836
 13837     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13838                               + PB-I-LF-ALT-BENEFIT-AMT.
 13839
 13840     IF ACCOUNT-LIFE-CHECKED  OR
 13841        PB-POLICY-IS-VOIDED   OR
 13842        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13843        and (not pb-monthly-cert))
 13844        GO TO 3225-CONTINUE.
 13845
 13846     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13847        GO TO 3225-CONTINUE.
 13848
 13849     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13850                             EC-RT-LF-MAX-TOT-BEN
 13851        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13852        MOVE ER-2639       TO WS-ERROR
 13853        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13854
 13855 3225-CONTINUE.
 13856     IF PB-I-LF-ALT-RATE = ZERO
 13857         MOVE ER-2659            TO WS-ERROR
 13858         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13859
 13860     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13861        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13862        MOVE ER-2698             TO WS-ERROR
 13863        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13864
 13865 3225-RATING-CONT.
 13866
 13867     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 251
* EL050.cbl
 13868        and (not pb-monthly-cert)
 13869         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13870         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13871         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13872            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13873            CONTINUE
 13874         ELSE
 13875            MOVE ER-2687         TO WS-ERROR
 13876            PERFORM 9900-ERROR-FORMAT
 13877                                 THRU 9900-EXIT
 13878         END-IF
 13879         GO TO 3290-EDIT-LF-REIN-RATE
 13880     END-IF
 13881
 13882* DMD RATING TEST
 13883     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13884         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13885         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13886         MOVE ER-2687                 TO WS-ERROR
 13887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13888         GO TO 3290-EDIT-LF-REIN-RATE.
 13889
 13890 3230-CLIENT-MORT-CD-SPECIALS.
 13891
 13892     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13893     SET BIN-TO-GREG          TO TRUE.
 13894*    MOVE ' '                 TO DC-OPTION-CODE.
 13895     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13896     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13897
 13898 C-POS-3230-MORT-CD.
 13899     IF PB-COMPANY-ID = 'POS' AND
 13900        PB-SV-CARRIER = '2'
 13901         NEXT SENTENCE
 13902     ELSE
 13903         GO TO C-POS-3240-MORT-CD.
 13904
 13905     IF PB-SV-GROUPING = '030'
 13906        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13907         MOVE '2350' TO PB-I-MORT-CODE
 13908      ELSE
 13909         MOVE '3300' TO PB-I-MORT-CODE.
 13910
 13911
 13912 C-POS-3240-MORT-CD.
 13913     IF PB-COMPANY-ID = 'POS' AND
 13914        PB-SV-CARRIER = '1'
 13915         NEXT SENTENCE
 13916     ELSE
 13917         GO TO 3230-CONTINUE.
 13918
 13919     IF PB-SV-STATE = '45' OR '47'
 13920        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13921         MOVE '5200' TO PB-I-MORT-CODE
 13922     ELSE
 13923         MOVE '8300' TO PB-I-MORT-CODE.
 13924
 13925 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 252
* EL050.cbl
 13926
 13927     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13928        GO TO 3240-CONTINUE
 13929     END-IF
 13930
 13931     IF PB-CERT-EFF-DT > WS-971231
 13932        GO TO 3240-CONTINUE
 13933     END-IF
 13934
 13935     IF LF-BENEFIT-FOUND AND
 13936        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13937         MOVE 'F250'       TO PB-I-MORT-CODE
 13938     ELSE
 13939         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13940             MOVE '7250'   TO PB-I-MORT-CODE
 13941         ELSE
 13942             MOVE '4251'   TO PB-I-MORT-CODE
 13943         END-IF
 13944     END-IF
 13945
 13946     .
 13947 3240-CONTINUE.
 13948
 13949     IF PB-COMPANY-ID NOT = 'GNL'
 13950         GO TO 3256-CONTINUE.
 13951
 13952     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13953         MOVE 'A300' TO PB-I-MORT-CODE
 13954     ELSE
 13955         MOVE '8350' TO PB-I-MORT-CODE.
 13956
 13957 3256-CONTINUE.
 13958     IF PB-COMPANY-ID NOT = 'ABL'
 13959         GO TO 3260-EDIT-CONTINUE.
 13960
 13961     IF PB-I-LF-TERM GREATER THAN 59
 13962         MOVE 'F550' TO PB-I-MORT-CODE
 13963     ELSE
 13964         MOVE 'E550' TO PB-I-MORT-CODE.
 13965
 13966 3260-EDIT-CONTINUE.
 13967     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13968
 13969 3290-EDIT-LF-REIN-RATE.
 13970     IF LF-REIN-NSP-NOT-USED
 13971         GO TO 3290-RATING-CONT.
 13972
 13973     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13974        GO TO 3290-RATING-CONT.
 13975     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13976     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13977     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13978     MOVE '3'                   TO CP-PROCESS-TYPE.
 13979     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13980
 13981******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13982     IF PB-COMPANY-ID EQUAL 'CDL'
 13983         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 253
* EL050.cbl
 13984            CP-EARN-AS-NET-PAY)
 13985             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13986*            MOVE SPACE          TO DC-OPTION-CODE
 13987             SET BIN-TO-GREG     TO TRUE
 13988             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13989***  Y2K PROJ 7744
 13990             IF DC-GREG-DATE-CYMD GREATER 19931231
 13991                 MOVE '1'        TO CP-EARNING-METHOD.
 13992***  Y2K PROJ 7744
 13993*******
 13994
 13995     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13996     MOVE PB-SV-STATE           TO CP-STATE.
 13997     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13998     MOVE ZERO                  TO CP-DEVIATION-CODE
 13999                                   CP-RATE-DEV-PCT.
 14000     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14001     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14002                                   CP-RATING-BENEFIT-AMT.
 14003
 14004************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14005     IF PB-COMPANY-ID EQUAL 'NCB'
 14006         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14007            CP-EARN-AS-NET-PAY
 14008             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14009                 PB-I-LF-PREMIUM-AMT.
 14010************
 14011
 14012     IF CP-STATE-STD-ABBRV = 'OR'
 14013         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14014                                         PB-I-LF-ALT-BENEFIT-AMT.
 14015     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14016     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14017     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14018     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14019     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14020     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14021     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14022     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14023                                   CP-REMAINING-TERM
 14024                                   CP-LOAN-TERM.
 14025     IF CP-TRUNCATED-LIFE
 14026        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14027
 14028     IF CP-TERM-IS-DAYS
 14029         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14030     ELSE
 14031         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14032
 14033     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14034        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14035     END-IF
 14036     IF PB-COMPANY-ID NOT = 'TIC'
 14037          MOVE ZERO          TO CP-CLASS-CODE.
 14038
 14039     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14040
 14041     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 254
* EL050.cbl
 14042     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14043
 14044     IF CP-ERROR-RATE-NOT-FOUND
 14045        IF PB-I-OB
 14046           MOVE ER-2625      TO WS-ERROR
 14047           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14048           GO TO 3299-EDIT-CONTINUE
 14049        ELSE
 14050           MOVE ER-2643      TO WS-ERROR
 14051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14052           GO TO 3299-EDIT-CONTINUE.
 14053
 14054     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14055
 14056     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14057     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14058
 14059     IF PB-I-LF-REI-RATE = ZERO
 14060         MOVE ER-2643        TO WS-ERROR
 14061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14062
 14063 3290-CHECK-ALT-REIN-RATE.
 14064
 14065     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14066        GO TO 3290-RATING-CONT.
 14067
 14068     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14069     MOVE '2'                    TO CP-EARNING-METHOD.
 14070     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14071     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14072     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14073     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14074                                     CP-RATING-BENEFIT-AMT.
 14075     IF CP-STATE-STD-ABBRV = 'OR'
 14076         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14077                                         PB-I-LF-ALT-BENEFIT-AMT.
 14078     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14079        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14080     END-IF
 14081     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14082     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14083     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14084                                    CP-REMAINING-TERM
 14085                                    CP-LOAN-TERM.
 14086     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14087        ADD +1                   TO CP-ORIGINAL-TERM
 14088                                    CP-REMAINING-TERM
 14089                                    CP-LOAN-TERM.
 14090
 14091     MOVE 'R'                   TO CP-RATE-FILE.
 14092     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14093
 14094     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14095
 14096     IF PB-I-LF-ALT-REI-RATE = ZERO
 14097         MOVE ER-2643            TO WS-ERROR
 14098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14099
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 255
* EL050.cbl
 14100 3290-RATING-CONT.
 14101
 14102     IF PB-I-OB
 14103*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14104        GO TO 3300-CHECK-AH-RATES.
 14105
 14106 3299-EDIT-CONTINUE.
 14107
 14108     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14109         NEXT SENTENCE
 14110     ELSE
 14111         MOVE ER-2620           TO WS-ERROR
 14112         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14113
 14114 3300-CHECK-AH-RATES.
 14115     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14116         NEXT SENTENCE
 14117     ELSE
 14118         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14119
 14120     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14121        and (not pb-monthly-cert))
 14122                  or
 14123        ((CF-COMPANY-ID = 'DMD') AND
 14124                (NO-DMD-RATING))
 14125         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14126            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14127            CONTINUE
 14128         ELSE
 14129            MOVE ER-2687         TO WS-ERROR
 14130            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14131         END-IF
 14132         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14133         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14134     END-IF
 14135
 14136     IF PB-I-OB
 14137        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14138
 14139     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14140         MOVE ER-2687             TO WS-ERROR
 14141         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14142         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14143         GO TO 3999-END-EDIT.
 14144
 14145*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14146     if pb-company-id = 'AHL'
 14147        go to 3300-skip-crit-per
 14148     end-if
 14149     if (pb-i-ah-crit-per not = zeros)
 14150        and (ws-ah-special-calc-cd not = 'C')
 14151        MOVE ER-1572             TO WS-ERROR
 14152        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14153        go to 3300-skip-crit-per
 14154     END-IF
 14155     if (pb-company-id = 'DCC' or 'VPP')
 14156        and (am-dcc-product-code not = spaces)
 14157        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 256
* EL050.cbl
 14158     end-if
 14159     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14160        IF PB-I-AH-CRIT-PER = ZERO
 14161           move ws-ah-max-bens   to pb-i-ah-crit-per
 14162*          MOVE ER-2618       TO WS-ERROR
 14163*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14164*          GO TO 3999-END-EDIT
 14165        END-IF
 14166     END-IF
 14167     if (ws-ah-special-calc-cd = 'C')
 14168        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14169        MOVE ER-1576             TO WS-ERROR
 14170        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14171     end-if
 14172
 14173     .
 14174 3300-skip-crit-per.
 14175     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14176     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14177     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14178     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14179     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14180     MOVE PB-SV-STATE            TO CP-STATE.
 14181     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14182     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14183     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14184*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14185     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14186     MOVE '3'                    TO CP-PROCESS-TYPE.
 14187     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14188     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14189                                    CP-RATING-BENEFIT-AMT.
 14190     IF PB-COMPANY-ID = 'CID'
 14191               OR
 14192        CP-STATE-STD-ABBRV = 'OR'
 14193         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14194                                         PB-I-AH-TERM.
 14195     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14196        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14197           AND (PB-I-POLICY-IS-MONTHLY)
 14198           MOVE PB-I-LF-BENEFIT-AMT
 14199                                 TO CP-NET-BENEFIT-AMT
 14200           move pb-i-ah-premium-amt to cp-original-premium
 14201           add pb-i-lf-premium-amt to cp-original-premium
 14202        END-IF
 14203     END-IF
 14204     MOVE SPACES                 TO CP-BEN-CATEGORY
 14205     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14206        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14207        EVALUATE TRUE
 14208           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14209              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14210              MOVE PB-I-LF-BENEFIT-AMT
 14211                                 TO CP-RATING-BENEFIT-AMT
 14212              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14213           WHEN WS-AH-BEN-CATEGORY = 'G'
 14214              MOVE PB-I-UNPAID-CASH-PRICE
 14215                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 257
* EL050.cbl
 14216           WHEN WS-AH-BEN-CATEGORY = 'D'
 14217              MOVE WS-AH-PMF-COMM
 14218                                 TO CP-DCC-PMF-COMM
 14219              MOVE PB-I-AH-COMMISSION
 14220                                 TO CP-DCC-ACT-COMM
 14221        END-EVALUATE
 14222     END-IF
 14223     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14224     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14225     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14226     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14227     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14228     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14229     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14230                                    CP-REMAINING-TERM
 14231                                    WS-WORK-TERM.
 14232     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14233
 14234     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14235     SET BIN-TO-GREG             TO TRUE.
 14236*    MOVE ' '                    TO DC-OPTION-CODE.
 14237     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14238     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14239
 14240     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14241     IF NOT VALID-SKIP-CODE
 14242         MOVE ER-2683            TO WS-ERROR
 14243         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14244         GO TO 3320-RATE-CONTINUE.
 14245
 14246     IF PB-NO-MONTHS-SKIPPED
 14247         GO TO 3320-RATE-CONTINUE.
 14248
 14249     MOVE SPACE TO NUMBER-OF-MONTHS.
 14250
 14251     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14252         MOVE 'S'                TO SK-MO (6).
 14253     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14254         MOVE 'S'                TO SK-MO (7).
 14255     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14256         MOVE 'S'                TO SK-MO (8).
 14257     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14258         MOVE 'S'                TO SK-MO (9).
 14259     IF PB-I-SKIP-CODE = 'A'
 14260         MOVE 'S'                TO SK-MO (10).
 14261
 14262     MOVE 1                      TO SUB2.
 14263     MOVE PB-I-AH-TERM           TO SUB3.
 14264     MOVE WS-MONTH               TO SUB1.
 14265     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14266     GO TO 3320-RATE-CONTINUE.
 14267
 14268 3310-GET-SKIP-MO.
 14269     IF SUB1 = 13
 14270         MOVE 1                  TO SUB1.
 14271
 14272     IF SK-MO (SUB1) = 'S'
 14273         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 258
* EL050.cbl
 14274
 14275     ADD 1 TO SUB2
 14276              SUB1.
 14277
 14278 3320-RATE-CONTINUE.
 14279
 14280     IF WS-WORK-TERM = ZERO
 14281         MOVE 1                  TO WS-WORK-TERM.
 14282
 14283     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14284                                    CP-LOAN-TERM.
 14285
 14286     IF PB-COMPANY-ID EQUAL 'DMD'
 14287         NEXT SENTENCE
 14288     ELSE
 14289         MOVE ZERO               TO PB-I-AH-RATE
 14290                                    PB-I-AH-REI-RATE.
 14291
 14292
 14293     IF PB-COMPANY-ID EQUAL 'CRI'
 14294        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14295
 14296     IF PB-COMPANY-ID = 'CSL'
 14297         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14298         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14299         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14300         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14301
 14302     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14303        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14304           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14305              PB-I-RATE-DEV-PCT-LF
 14306        END-IF
 14307        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14308                                 TO CP-ALTERNATE-BENEFIT
 14309        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14310        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14311        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14312     END-IF
 14313*    if ws-clp-state not = spaces
 14314*       move ws-clp-state to cp-state
 14315*    end-if
 14316     IF (PB-COMPANY-ID = 'CID')
 14317        AND (WS-LF-EARNINGS-CALC = 'B')
 14318        AND (CP-STATE-STD-ABBRV = 'MN')
 14319        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14320     ELSE
 14321        MOVE ' '                 TO CP-AH-BALLOON-SW
 14322     END-IF
 14323     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14324     MOVE 'R'                   TO CP-RATE-FILE.
 14325     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14326
 14327     IF (CP-ERROR-RATE-NOT-FOUND)
 14328        and (not pb-monthly-cert)
 14329        IF PB-I-OB
 14330           MOVE ER-2624          TO WS-ERROR
 14331           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 259
* EL050.cbl
 14332           GO TO 3340-CALCULATE-PREMIUM-AMT
 14333        ELSE
 14334          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14335              NEXT SENTENCE
 14336          ELSE
 14337           MOVE ER-2642          TO WS-ERROR
 14338           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14339           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14340
 14341     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14342        CP-ERROR-DIV-BY-ZERO
 14343           MOVE ER-3782          TO WS-ERROR
 14344           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14345
 14346     IF PB-COMPANY-ID EQUAL 'CRI'
 14347        IF CP-ERROR-NO-LIMITS-CRI
 14348           IF NOT ACCOUNT-AH-CHECKED
 14349              MOVE ER-2607          TO WS-ERROR
 14350              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14351
 14352     IF ACCOUNT-AH-CHECKED
 14353        NEXT SENTENCE
 14354     ELSE
 14355       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14356          MOVE ER-2640           TO WS-ERROR
 14357          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14358
 14359     IF PB-COMPANY-ID = 'CRI'
 14360         IF WS-ERROR = ER-2640
 14361             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14362     IF ACCOUNT-AH-CHECKED
 14363        CONTINUE
 14364     ELSE
 14365        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14366           AND (CP-R-MAX-ATT-AGE > +0)
 14367           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14368           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14369              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14370              MOVE PB-I-AH-EXPIRE-DT
 14371                                 TO DC-BIN-DATE-2
 14372              MOVE '1'           TO DC-OPTION-CODE
 14373              PERFORM 8500-DATE-CONVERT
 14374                                 THRU 8500-EXIT
 14375              IF NO-CONVERSION-ERROR
 14376                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14377                    MOVE ER-2661       TO WS-ERROR
 14378*                   PERFORM 9900-ERROR-FORMAT
 14379*                                THRU 9900-EXIT
 14380                 END-IF
 14381              END-IF
 14382           ELSE
 14383              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14384              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14385                 MOVE ER-2661    TO WS-ERROR
 14386*                PERFORM 9900-ERROR-FORMAT
 14387*                                THRU 9900-EXIT
 14388              ELSE
 14389                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 260
* EL050.cbl
 14390                    MOVE ER-1570 TO WS-ERROR
 14391                    PERFORM 9900-ERROR-FORMAT
 14392                                 THRU 9900-EXIT
 14393                 END-IF
 14394              END-IF
 14395           END-IF
 14396           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14397              MOVE PB-I-JOINT-BIRTHDAY
 14398                                    TO DC-BIN-DATE-1
 14399              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14400              MOVE '1'              TO DC-OPTION-CODE
 14401              PERFORM 8500-DATE-CONVERT
 14402                                    THRU 8500-EXIT
 14403              IF NO-CONVERSION-ERROR
 14404                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14405                    MOVE ER-2661       TO WS-ERROR
 14406*                   PERFORM 9900-ERROR-FORMAT
 14407*                                   THRU 9900-EXIT
 14408                 END-IF
 14409              END-IF
 14410           ELSE
 14411              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14412                (PB-I-AH-TERM / 12)
 14413              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14414                 MOVE ER-2661       TO WS-ERROR
 14415*                PERFORM 9900-ERROR-FORMAT
 14416*                                   THRU 9900-EXIT
 14417              ELSE
 14418                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14419                    MOVE ER-1571 TO WS-ERROR
 14420                    PERFORM 9900-ERROR-FORMAT
 14421                                 THRU 9900-EXIT
 14422                 END-IF
 14423              END-IF
 14424           END-IF
 14425           IF WS-ERROR = ER-2661
 14426              PERFORM 9900-ERROR-FORMAT
 14427                                    THRU 9900-EXIT
 14428           END-IF
 14429        END-IF
 14430     END-IF
 14431*    IF ACCOUNT-AH-CHECKED
 14432*       NEXT SENTENCE
 14433*    ELSE
 14434*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14435*          MOVE ER-2661          TO WS-ERROR
 14436*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14437
 14438     IF ACCOUNT-AH-CHECKED
 14439        NEXT SENTENCE
 14440     ELSE
 14441        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14442           MOVE ER-2663          TO WS-ERROR
 14443           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14444
 14445     IF ACCOUNT-AH-CHECKED OR
 14446        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14447         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 261
* EL050.cbl
 14448        NEXT SENTENCE
 14449     ELSE
 14450        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14451           MOVE ER-2667            TO WS-ERROR
 14452           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14453
 14454     IF PB-COMPANY-ID = 'CRI'
 14455         IF WS-ERROR = ER-2667
 14456             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14457
 14458     IF ACCOUNT-AH-CHECKED
 14459        NEXT SENTENCE
 14460     ELSE
 14461        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14462           MOVE ER-2678            TO WS-ERROR
 14463           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14464
 14465     IF CP-ERROR-RATE-FILE-NOTOPEN
 14466         GO TO 3990-FILES-NOT-OPEN.
 14467
 14468 3321-CONTINUE.
 14469     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14470     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14471     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14472*    IF (PB-COMPANY-ID = 'DCC')
 14473        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14474        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14475                                    PB-I-LF-ALT-PREM-CALC
 14476        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14477        IF WS-AH-BEN-CATEGORY = 'G'
 14478           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14479           + PB-I-ADDL-CLP)
 14480           * (1 + WS-TOL-CLP-PCT)
 14481*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14482        ELSE
 14483           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14484           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14485*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14486        END-IF
 14487        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14488                                 TO PB-I-AH-PREM-CALC
 14489        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14490           MOVE ER-8152          TO WS-ERROR
 14491           PERFORM 9900-ERROR-FORMAT
 14492                                 THRU 9900-EXIT
 14493        ELSE
 14494           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14495                 PB-I-ADDL-CLP)
 14496              MOVE ER-8148       TO WS-ERROR
 14497              PERFORM 9900-ERROR-FORMAT
 14498                                 THRU 9900-EXIT
 14499           END-IF
 14500        END-IF
 14501     END-IF
 14502     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14503        AND (PB-I-POLICY-IS-MONTHLY)
 14504        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14505        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 262
* EL050.cbl
 14506        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14507           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14508        END-IF
 14509     END-IF
 14510     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14511        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14512        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14513        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14514        MOVE ER-2786             TO WS-ERROR
 14515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14516     END-IF
 14517     MOVE +0                     TO PB-I-AH-CLP
 14518     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14519        evaluate true
 14520           when WS-AH-BEN-CATEGORY = 'D'
 14521              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14522                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14523           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14524              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14525           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14526              compute ws-cred-union-fees rounded =
 14527                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14528                    pb-i-ah-commission)
 14529              COMPUTE PB-I-AH-CLP =
 14530                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14531        end-evaluate
 14532     END-IF
 14533     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14534
 14535     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14536         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14537
 14538     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14539         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14540
 14541     if (ws-ah-special-calc-cd = 'E')
 14542        and (pb-monthly-cert)
 14543        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14544     end-if
 14545     IF PB-COMPANY-ID = 'CRI'
 14546         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14547            PB-I-PAYMENT-AMOUNT = ZERO
 14548             NEXT SENTENCE
 14549         ELSE
 14550             COMPUTE PB-I-AH-PREM-CALC =
 14551                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14552                 (CP-PREMIUM-RATE / 100)
 14553             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14554                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14555                                             PB-I-RATE-DEV-PCT-AH.
 14556
 14557     IF (PB-I-AH-RATE  = ZERO)
 14558        and (not pb-monthly-cert)
 14559       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14560           NEXT SENTENCE
 14561       ELSE
 14562         MOVE ER-2642            TO WS-ERROR
 14563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 263
* EL050.cbl
 14564
 14565     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14566     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14567     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14568     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14569     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14570     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14571
 14572     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14573        AND (WS-AH-BEN-CATEGORY = 'G')
 14574        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14575        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14576        IF CP-DEVIATION-CODE NOT = '000'
 14577           MOVE '000'            TO CP-DEVIATION-CODE
 14578           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14579           IF NO-CP-ERROR
 14580              COMPUTE PB-I-DDF-IU-RATE-UP =
 14581              PB-I-AH-CLP - CP-CALC-PREMIUM
 14582           ELSE
 14583              MOVE ER-3057        TO WS-ERROR
 14584              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14585           END-IF
 14586        END-IF
 14587     END-IF
 14588     .
 14589 3335-EDIT-AH-REIN-NSP-RATE.
 14590     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14591        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14592              compute ws-cred-union-fees rounded =
 14593                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14594                    pb-i-ah-commission)
 14595              COMPUTE PB-I-AH-CLP =
 14596                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14597        end-if
 14598     END-IF
 14599     IF AH-REIN-NSP-NOT-USED
 14600         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14601
 14602     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14603     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14604         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14605     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14606     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14607     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14608     MOVE PB-SV-STATE            TO CP-STATE.
 14609     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14610     MOVE ZERO                   TO CP-DEVIATION-CODE
 14611                                    CP-RATE-DEV-PCT.
 14612*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14613     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14614     MOVE '3'                    TO CP-PROCESS-TYPE.
 14615     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14616     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14617                                    CP-RATING-BENEFIT-AMT.
 14618     IF CP-STATE-STD-ABBRV = 'OR'
 14619         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14620                                         PB-I-AH-TERM.
 14621     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 264
* EL050.cbl
 14622     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14623     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14624     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14625     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14626     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14627                                    CP-REMAINING-TERM
 14628                                    WS-WORK-TERM.
 14629     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14630     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14631        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14632     END-IF
 14633     IF  PB-COMPANY-ID = 'TIC'
 14634         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14635            MOVE ZERO TO CP-CLASS-CODE.
 14636
 14637     IF PB-COMPANY-ID NOT = 'TIC'
 14638          MOVE ZERO          TO CP-CLASS-CODE.
 14639
 14640     MOVE ZERO               TO CP-DEVIATION-CODE.
 14641
 14642     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14643
 14644     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14645
 14646     MOVE 'R'                   TO CP-RATE-FILE.
 14647     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14648
 14649     IF CP-ERROR-RATE-NOT-FOUND
 14650         MOVE ER-2645        TO WS-ERROR
 14651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14652         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14653
 14654     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14655
 14656     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14657     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14658
 14659     IF PB-I-AH-REI-RATE = ZERO
 14660         MOVE ER-2645        TO WS-ERROR
 14661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14662
 14663
 14664 3340-CALCULATE-PREMIUM-AMT.
 14665
 14666     IF PB-COMPANY-ID = 'NCL'
 14667         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14668             WS-AH-SPECIAL-CALC-CD = 'O')
 14669             GO TO 3999-END-EDIT.
 14670
 14671     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14672                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14673                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14674                         OR 'AHL'
 14675         NEXT SENTENCE
 14676     ELSE
 14677         IF WS-STATE-ABBREVIATION = 'CT'
 14678             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14679                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 265
* EL050.cbl
 14680                 COMPUTE PB-I-LF-PREM-CALC =
 14681                                     PB-I-LF-PREM-CALC * .90
 14682                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14683                                     PB-I-LF-ALT-PREM-CALC * .90
 14684                 COMPUTE PB-I-AH-PREM-CALC =
 14685                                     PB-I-AH-PREM-CALC * .90.
 14686
 14687     IF PB-COMP-LF-PREM
 14688        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14689        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14690
 14691     IF PB-COMP-AH-PREM
 14692        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14693
 14694 3340-CHECK-DCC-TOT-FEES.
 14695     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14696        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14697        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14698        AND (PB-I-POLICY-IS-MONTHLY)
 14699        CONTINUE
 14700     ELSE
 14701        GO TO 3340-EDIT-LF-AH-TOL
 14702     END-IF
 14703     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14704     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14705     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14706        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14707           PB-I-RATE-DEV-PCT-LF
 14708     END-IF
 14709     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14710        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14711           PB-I-RATE-DEV-PCT-AH
 14712     END-IF
 14713     MOVE 'N'                    TO CP-BEN-CATEGORY
 14714     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14715
 14716     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14717     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14718     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14719     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14720     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14721     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14722     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14723     MOVE '3'                    TO CP-PROCESS-TYPE.
 14724     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14725     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14726
 14727     MOVE PB-SV-STATE            TO CP-STATE.
 14728     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14729     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14730     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14731     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14732     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14733                                    CP-RATING-BENEFIT-AMT.
 14734     IF CP-STATE-STD-ABBRV = 'OR'
 14735         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14736                                         PB-I-LF-ALT-BENEFIT-AMT.
 14737     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 266
* EL050.cbl
 14738     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14739     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14740     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14741     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14742     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14743     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14744     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14745     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14746                                    CP-REMAINING-TERM
 14747                                    CP-LOAN-TERM.
 14748     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14749        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14750           PB-I-LF-PREMIUM-AMT
 14751     end-if
 14752
 14753     IF CP-TRUNCATED-LIFE
 14754        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14755
 14756     IF CP-TERM-IS-DAYS
 14757         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14758     ELSE
 14759         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14760
 14761     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14762     IF CP-SPECIAL-CALC-CD = 'H'
 14763         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14764                                    TO CP-ALTERNATE-BENEFIT
 14765         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14766     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14767     MOVE 'R'                    TO CP-RATE-FILE
 14768     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14769     IF NOT CP-ERROR-RATE-NOT-FOUND
 14770        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14771        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14772           AND (CP-BENEFIT-CD (1:1) = 'S')
 14773           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14774                                    PB-I-LF-PREMIUM-AMT
 14775        END-IF
 14776     ELSE
 14777        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14778     END-IF
 14779     .
 14780 3340-EDIT-LF-AH-TOL.
 14781
 14782***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14783***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14784***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14785***
 14786     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14787         PB-I-AH-PREMIUM-AMT
 14788          GIVING WS-CALC-WORK.
 14789
 14790     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14791        AND WS-CALC-WORK NOT = ZERO
 14792         MOVE ER-2649            TO WS-ERROR
 14793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14794
 14795     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 267
* EL050.cbl
 14796             FROM PB-I-LF-PREMIUM-AMT
 14797                 GIVING WS-UNSIGN-WRK1.
 14798
 14799     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14800             FROM PB-I-LF-ALT-PREMIUM-AMT
 14801                 GIVING WS-UNSIGN-WRK4.
 14802
 14803     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14804                                + WS-UNSIGN-WRK4.
 14805
 14806     SUBTRACT PB-I-AH-PREM-CALC
 14807             FROM PB-I-AH-PREMIUM-AMT
 14808                 GIVING WS-UNSIGN-WRK2.
 14809
 14810******************************************************************
 14811*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14812******************************************************************
 14813
 14814     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14815         MOVE ZERO TO WS-UNSIGN-WRK1.
 14816
 14817     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14818         MOVE ZERO TO WS-UNSIGN-WRK2.
 14819
 14820     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14821             GIVING WS-UNSIGN-WRK3.
 14822
 14823 3342-CONTINUE.
 14824
 14825     IF (PB-I-LF-RATE = ZERO  AND
 14826         PB-I-AH-RATE = ZERO)
 14827         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14828            WS-AH-SPECIAL-CALC-CD = 'O'
 14829              NEXT SENTENCE
 14830         ELSE
 14831             GO TO 3345-EDIT-CONTINUE.
 14832
 14833     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14834         NEXT SENTENCE
 14835     ELSE
 14836     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14837        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14838           IF (PB-REISSUED-CERT         OR
 14839               PB-POLICY-IS-DECLINED    OR
 14840               PB-POLICY-IS-VOIDED)
 14841              NEXT SENTENCE
 14842           ELSE
 14843              IF WS-PREM-REJECT-SW = SPACE
 14844                 MOVE ER-2652    TO WS-ERROR
 14845                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14846                 GO TO 3344-CHECK-AH
 14847              ELSE
 14848                 MOVE ER-2650    TO WS-ERROR
 14849                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14850                 GO TO 3344-CHECK-AH.
 14851
 14852***
 14853***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 268
* EL050.cbl
 14854***
 14855
 14856     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14857         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14858            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14859             (1 + WS-TOL-LF-PREM-PCT)
 14860         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14861            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14862             (1 - WS-TOL-LF-PREM-PCT)
 14863     ELSE
 14864         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14865         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14866
 14867***
 14868***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14869***
 14870
 14871     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14872         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14873          WS-TOL-LF-PREM.
 14874
 14875     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14876         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14877          WS-TOL-LF-PREM.
 14878
 14879     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14880        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14881
 14882     IF PB-REISSUED-CERT
 14883        or PB-POLICY-IS-DECLINED
 14884        or PB-POLICY-IS-VOIDED
 14885        continue
 14886     ELSE
 14887        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14888              > WS-TOL-LF-HIGH-PREM-AMT)
 14889           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14890              < WS-TOL-LF-LOW-PREM-AMT))
 14891                      or
 14892           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14893              > WS-TOL-LF-HIGH-PREM-PCT)
 14894           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14895              < WS-TOL-LF-LOW-PREM-PCT))
 14896           IF WS-PREM-REJECT-SW = SPACE
 14897              MOVE ER-2652       TO WS-ERROR
 14898              PERFORM 9900-ERROR-FORMAT
 14899                                 THRU 9900-EXIT
 14900           ELSE
 14901              MOVE ER-2650       TO WS-ERROR
 14902              PERFORM 9900-ERROR-FORMAT
 14903                                 THRU 9900-EXIT
 14904           end-if
 14905        end-if
 14906     end-if
 14907
 14908*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14909*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14910*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14911*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 269
* EL050.cbl
 14912
 14913     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14914        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14915                      OR
 14916           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14917           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14918           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14919           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14920        END-IF
 14921     END-IF
 14922
 14923     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14924        IF WS-COMP-MAX-CAP GREATER THAN +0
 14925           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14926              IF (PB-REISSUED-CERT         OR
 14927                  PB-POLICY-IS-DECLINED    OR
 14928                  PB-POLICY-IS-VOIDED)
 14929                 NEXT SENTENCE
 14930              ELSE
 14931                  MOVE ER-2646   TO  WS-ERROR
 14932                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14933
 14934 3344-CVL-TOLERANCE-CHECK.
 14935
 14936      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14937          GO TO 3344-CHECK-AH.
 14938
 14939      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14940          GO TO 3344-CHECK-AH.
 14941
 14942      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14943                                     WS-UNSIGN-WRK6.
 14944
 14945      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14946          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14947                                 + PB-I-LF-PREMIUM-AMT
 14948                                 - PB-I-LF-PREM-CALC.
 14949
 14950      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14951          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14952                                 + PB-I-LF-ALT-PREMIUM-AMT
 14953                                 - PB-I-LF-ALT-PREM-CALC.
 14954
 14955      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14956          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14957              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14958                 MOVE ER-2652    TO  WS-ERROR
 14959                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14960              ELSE
 14961                 MOVE ER-2650    TO  WS-ERROR
 14962                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14963
 14964      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14965          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14966              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14967                 MOVE ER-2652    TO  WS-ERROR
 14968                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14969              ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 270
* EL050.cbl
 14970                 MOVE ER-2650    TO  WS-ERROR
 14971                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14972
 14973 3344-CHECK-AH.
 14974
 14975****************************************************************
 14976***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14977***
 14978
 14979     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14980         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14981             (1 + WS-TOL-AH-PREM-PCT)
 14982         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14983             (1 - WS-TOL-AH-PREM-PCT)
 14984     ELSE
 14985         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14986         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14987
 14988***
 14989***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14990***
 14991
 14992     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14993         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14994
 14995     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14996         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14997
 14998     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14999        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15000
 15001     IF (PB-REISSUED-CERT)
 15002        OR (PB-POLICY-IS-DECLINED)
 15003        OR (PB-POLICY-IS-VOIDED)
 15004        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15005        CONTINUE
 15006     ELSE
 15007        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15008              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15009                          or
 15010           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15011              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15012           IF WS-PREM-REJECT-SW = SPACE
 15013              MOVE ER-3052       TO WS-ERROR
 15014              PERFORM 9900-ERROR-FORMAT
 15015                                 THRU 9900-EXIT
 15016           ELSE
 15017              MOVE ER-3050       TO WS-ERROR
 15018              PERFORM 9900-ERROR-FORMAT
 15019                                 THRU 9900-EXIT
 15020           END-IF
 15021        END-IF
 15022     END-IF
 15023     if (pb-company-id = 'DCC' or 'VPP')
 15024        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15025        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15026        and (pb-i-policy-is-monthly)
 15027        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 271
* EL050.cbl
 15028           pb-i-tot-fees-calc + ws-tol-ah-prem
 15029        compute ws-tol-ah-low-prem-amt =
 15030           pb-i-tot-fees-calc - ws-tol-ah-prem
 15031        if ws-tol-ah-prem-pct > zeros
 15032           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15033              (1 + ws-tol-ah-prem-pct)
 15034           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15035              (1 - ws-tol-ah-prem-pct)
 15036        else
 15037           move +9999999.99      to ws-tol-ah-high-prem-pct
 15038           move +0               to ws-tol-ah-low-prem-pct
 15039        end-if
 15040        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15041            or
 15042           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15043                          or
 15044           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15045           or
 15046           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15047            move er-3049         to ws-error
 15048           perform 9900-error-format
 15049                                 thru 9900-exit
 15050
 15051        end-if
 15052     end-if
 15053     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15054         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15055             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15056             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15057
 15058     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15059        IF WS-COMP-MAX-CAP GREATER THAN +0
 15060           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15061              IF (PB-REISSUED-CERT         OR
 15062                  PB-POLICY-IS-DECLINED    OR
 15063                  PB-POLICY-IS-VOIDED)
 15064                 NEXT SENTENCE
 15065              ELSE
 15066                  MOVE ER-2646   TO  WS-ERROR
 15067                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15068
 15069     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15070        (WS-COMP-MAX-CAP EQUAL +0)
 15071           GO TO 3345-EDIT-CONTINUE.
 15072
 15073     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15074        GREATER THAN WS-COMP-MAX-CAP
 15075           MOVE ER-2646          TO  WS-ERROR
 15076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15077
 15078 3345-EDIT-CONTINUE.
 15079
 15080*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15081*       IF PB-ENTRY-BATCH   NUMERIC
 15082*          IF PB-ISSUE
 15083*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15084*          ELSE
 15085*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 272
* EL050.cbl
 15086*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15087
 15088*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15089*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15090*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15091*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15092*        ELSE
 15093*            MOVE  ER-1909            TO  WS-ERROR
 15094*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15095
 15096     IF PB-I-POLICY-ACCEPTED
 15097        IF PB-POLICY-IS-DECLINED  OR
 15098           PB-REISSUED-CERT  OR
 15099           PB-REIN-ONLY-CERT  OR
 15100           PB-POLICY-IS-VOIDED
 15101            MOVE  ER-1891         TO  WS-ERROR
 15102            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15103        ELSE
 15104            MOVE SPACE            TO  PB-BATCH-ENTRY
 15105            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15106
 15107     IF PB-I-POLICY-DECLINED
 15108        IF PB-REISSUED-CERT  OR
 15109           PB-REIN-ONLY-CERT  OR
 15110           PB-POLICY-IS-VOIDED
 15111            MOVE  ER-1906         TO  WS-ERROR
 15112            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15113        ELSE
 15114            MOVE  'D'             TO  PB-BATCH-ENTRY
 15115                                      PB-I-ENTRY-STATUS.
 15116
 15117     IF PB-I-NEEDS-UNDERWRITING
 15118        IF PB-POLICY-IS-DECLINED OR
 15119           PB-REISSUED-CERT  OR
 15120           PB-REIN-ONLY-CERT  OR
 15121           PB-POLICY-IS-VOIDED
 15122            MOVE  ER-1907         TO  WS-ERROR
 15123            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15124        ELSE
 15125            MOVE 'U'              TO  PB-BATCH-ENTRY
 15126                                      PB-I-ENTRY-STATUS.
 15127
 15128     IF PB-NEEDS-UNDERWRITING
 15129        MOVE  ER-1901             TO  WS-ERROR
 15130        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15131     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15132        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15133        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15134        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15135           AND (NOT WS-LF-CASH))
 15136                           OR
 15137           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15138           AND (NOT WS-AH-CASH)))
 15139                       AND
 15140           (PB-I-ENTRY-STATUS NOT = '5')
 15141           MOVE 'M'              TO PB-BATCH-ENTRY
 15142                                    PB-I-ENTRY-STATUS
 15143        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 273
* EL050.cbl
 15144     END-IF
 15145     move pending-business       to ws-passed-erpndb
 15146     move ' '                    to ws-exceed-limit-yn
 15147     perform 7780-call-agg       thru 7780-exit
 15148*    display ' el050 exceed ' ws-exceed-limit-yn
 15149     if ws-exceed-limit-yn = 'Y'
 15150        MOVE  ER-9813            TO WS-ERROR
 15151        move 'Y'                 to ws-9813-sw
 15152        PERFORM  9900-ERROR-FORMAT
 15153                                 THRU 9900-EXIT
 15154     end-if
 15155     if (PB-EXCEEDED-LIMIT-FORCED)
 15156        and (ws-9813-sw = 'Y')
 15157        subtract +1 from PB-NO-OF-ERRORS
 15158        move er-9823             to ws-error
 15159        PERFORM  9900-ERROR-FORMAT
 15160                                 THRU 9900-EXIT
 15161     end-if
 15162     IF  PB-COMPANY-ID NOT = 'NCL'
 15163         GO TO 3999-END-EDIT.
 15164
 15165     IF PB-REISSUED-CERT  OR
 15166        PB-POLICY-IS-DECLINED  OR
 15167        PB-POLICY-IS-VOIDED  OR
 15168        PB-I-OB
 15169         GO TO 3999-END-EDIT.
 15170
 15171     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15172         MOVE  ER-2644            TO  WS-ERROR
 15173         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15174         GO TO 3999-END-EDIT.
 15175
 15176     MOVE 'N'                     TO  FORM-MASTER-SW.
 15177     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15178
 15179     IF NOT FORM-MASTER-FOUND
 15180         GO TO 3999-END-EDIT.
 15181
 15182     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15183                                      FORM-MASTER-AH-SW.
 15184
 15185     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15186         MOVE  +1                 TO SUB6
 15187         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15188
 15189     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15190         MOVE  +1                 TO SUB6
 15191         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15192
 15193     IF LF-FORM-MASTER-FOUND  OR
 15194        AH-FORM-MASTER-FOUND
 15195         GO TO 3360-CHECK-FORM-LIMITS
 15196     ELSE
 15197         GO TO 3999-END-EDIT.
 15198
 15199******************************************************************
 15200*                  3350-GET-ERFORM                               *
 15201*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 274
* EL050.cbl
 15202*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15203******************************************************************
 15204
 15205 3350-GET-ERFORM.
 15206
 15207     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15208         GO TO  3350-ERFORM-GETMAIN.
 15209
 15210     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15211     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15212     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15213     MOVE 'Y'                     TO FORM-MASTER-SW.
 15214
 15215     IF PB-CANCELLATION
 15216         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15217            PB-SV-STATE          EQUAL   FO-STATE       AND
 15218            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15219              GO TO 3350-EXIT
 15220         ELSE
 15221             NEXT SENTENCE
 15222     ELSE
 15223         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15224            PB-SV-STATE          EQUAL   FO-STATE       AND
 15225            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15226              GO TO 3350-EXIT.
 15227
 15228 3350-ERFORM-GETMAIN.
 15229
 15230     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15231     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15232
 15233 3350-ERFORM-READ.
 15234
 15235     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15236     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15237     IF PB-CANCELLATION
 15238         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15239     ELSE
 15240         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15241     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15242
 15243     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15244
 15245     IF FORM-MASTER-FOUND
 15246       IF PB-CANCELLATION
 15247          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15248             PB-SV-STATE          EQUAL   FO-STATE       AND
 15249             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15250              GO  TO 3350-EXIT
 15251          ELSE
 15252              NEXT SENTENCE
 15253       ELSE
 15254          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15255             PB-SV-STATE          EQUAL   FO-STATE       AND
 15256             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15257              GO  TO 3350-EXIT.
 15258
 15259     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 275
* EL050.cbl
 15260     MOVE  ER-1895                TO  WS-ERROR.
 15261     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15262
 15263 3350-EXIT.
 15264      EXIT.
 15265
 15266******************************************************************
 15267*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15268*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15269*   VALID FOR THE POLICY FORM USED.                              *
 15270******************************************************************
 15271
 15272 3355-EDIT-FORM-LF-BENEFITS.
 15273
 15274     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15275        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15276         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15277         GO TO   3355-EXIT.
 15278
 15279     IF  SUB6    LESS THAN   +40
 15280         ADD  +1      TO  SUB6
 15281         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15282
 15283     MOVE  ER-1896         TO  WS-ERROR.
 15284     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15285
 15286 3355-EXIT.
 15287      EXIT.
 15288
 15289******************************************************************
 15290*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15291*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15292*   VALID FOR THE POLICY FORM USED.                              *
 15293******************************************************************
 15294
 15295 3356-EDIT-FORM-AH-BENEFITS.
 15296
 15297     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15298        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15299         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15300         GO TO  3356-EXIT.
 15301
 15302      IF  SUB6    LESS THAN     +40
 15303          ADD  +1      TO  SUB6
 15304          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15305
 15306     MOVE  ER-1897         TO  WS-ERROR.
 15307     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15308
 15309 3356-EXIT.
 15310      EXIT.
 15311
 15312******************************************************************
 15313*                  3357-BENEFIT-SEARCH                           *
 15314*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15315*   CANCELLATIONS ONLY.                                          *
 15316******************************************************************
 15317 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 276
* EL050.cbl
 15318     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15319         MOVE +1                          TO SUB6
 15320         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15321
 15322     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15323         MOVE +1                          TO SUB6
 15324         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15325
 15326 3357-EXIT.
 15327     EXIT.
 15328
 15329******************************************************************
 15330*                  3358-BENEFIT-LIFE-SEARCH                      *
 15331*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15332*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15333*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15334******************************************************************
 15335 3358-BENEFIT-LIFE-SEARCH.
 15336     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15337       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15338         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15339           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15340              IF FO-PLAN-REFUND-METHOD (SUB6)
 15341                     IS GREATER THAN SPACES
 15342                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15343                                          WS-LF-REFUND-CALC
 15344                 GO TO 3358-EXIT.
 15345
 15346     IF SUB6 LESS THAN +40
 15347         ADD +1                 TO SUB6
 15348         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15349
 15350 3358-EXIT.
 15351     EXIT.
 15352******************************************************************
 15353*                  3359-BENEFIT-AH-SEARCH                        *
 15354*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15355*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15356*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15357******************************************************************
 15358 3359-BENEFIT-AH-SEARCH.
 15359     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15360       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15361         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15362           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15363              IF FO-PLAN-REFUND-METHOD (SUB6)
 15364                      IS GREATER THAN SPACES
 15365                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15366                                          WS-AH-REFUND-CALC
 15367                 GO TO 3359-EXIT.
 15368
 15369     IF SUB6 LESS THAN +40
 15370         ADD +1                 TO SUB6
 15371         GO TO 3359-BENEFIT-AH-SEARCH.
 15372
 15373 3359-EXIT.
 15374     EXIT.
 15375
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 277
* EL050.cbl
 15376******************************************************************
 15377*                  3360-CHECK-FORM-LIMITS                        *
 15378*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15379*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15380******************************************************************
 15381
 15382 3360-CHECK-FORM-LIMITS.
 15383
 15384     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15385         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15386
 15387     IF NOT LF-FORM-MASTER-FOUND
 15388         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15389
 15390 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15391
 15392     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15393       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15394        WS-LF-JOINT-INDICATOR = 'J'  AND
 15395        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15396         IF PB-COMPANY-ID = 'NCL'
 15397            MOVE  ER-1911          TO  WS-ERROR
 15398            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15399         ELSE
 15400            MOVE  ER-1892          TO  WS-ERROR
 15401            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15402
 15403 3360-CHECK-FORM-LF-ATT-AGE.
 15404
 15405     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15406
 15407     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15408         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15409         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15410            IF PB-COMPANY-ID = 'NCL'
 15411                MOVE  ER-1913      TO  WS-ERROR
 15412                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15413            ELSE
 15414                MOVE  ER-1894      TO  WS-ERROR
 15415                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15416
 15417 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15418
 15419     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15420         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15421         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15422            IF PB-COMPANY-ID = 'NCL'
 15423                MOVE  ER-1914      TO  WS-ERROR
 15424                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15425            ELSE
 15426                MOVE  ER-1899      TO  WS-ERROR
 15427                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15428
 15429 3360-CHECK-FORM-LF-TERM-BAMT.
 15430
 15431     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15432         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15433         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 278
* EL050.cbl
 15434           IF  PB-COMPANY-ID = 'NCL'
 15435               MOVE  ER-1916       TO  WS-ERROR
 15436               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15437           ELSE
 15438               MOVE  ER-1902       TO  WS-ERROR
 15439               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15440
 15441     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15442                                    PB-I-LF-ALT-BENEFIT-AMT.
 15443
 15444     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15445         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15446         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15447             IF  PB-COMPANY-ID = 'NCL'
 15448                 MOVE  ER-1918     TO  WS-ERROR
 15449                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15450             ELSE
 15451                 MOVE  ER-1904     TO  WS-ERROR
 15452                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15453
 15454******************************************************************
 15455*                  3360-CHECK-FORM-AH-LIMITS                     *
 15456*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15457*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15458******************************************************************
 15459
 15460 3360-CHECK-FORM-AH-LIMITS.
 15461
 15462     IF NOT AH-FORM-MASTER-FOUND
 15463         GO TO 3999-END-EDIT.
 15464
 15465 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15466
 15467     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15468       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15469        WS-AH-JOINT-INDICATOR = 'J'  AND
 15470        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15471         IF PB-COMPANY-ID = 'NCL'
 15472            MOVE  ER-1912          TO  WS-ERROR
 15473            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15474         ELSE
 15475            MOVE  ER-1893          TO  WS-ERROR
 15476            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15477
 15478 3360-CHECK-FORM-AH-ATT-AGE.
 15479
 15480     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15481
 15482     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15483         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15484         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15485            IF PB-COMPANY-ID = 'NCL'
 15486                MOVE  ER-1913      TO  WS-ERROR
 15487                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15488            ELSE
 15489                MOVE  ER-1894      TO  WS-ERROR
 15490                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15491
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 279
* EL050.cbl
 15492 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15493
 15494     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15495         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15496         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15497            IF PB-COMPANY-ID = 'NCL'
 15498                MOVE  ER-1915      TO  WS-ERROR
 15499                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15500            ELSE
 15501                MOVE  ER-1900      TO  WS-ERROR
 15502                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15503
 15504 3360-CHECK-FORM-AH-TERM-BAMT.
 15505
 15506     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15507         FO-AH-MAX-TERM    GREATER THAN  +0
 15508         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15509             IF  PB-COMPANY-ID = 'NCL'
 15510                 MOVE  ER-1917     TO  WS-ERROR
 15511                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15512             ELSE
 15513                  MOVE  ER-1903    TO  WS-ERROR
 15514                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15515
 15516     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15517         FO-MAX-AH-AMT    GREATER THAN  +0
 15518         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15519             IF  PB-COMPANY-ID = 'NCL'
 15520                 MOVE  ER-1919     TO  WS-ERROR
 15521                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15522             ELSE
 15523                 MOVE  ER-1905     TO  WS-ERROR
 15524                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15525
 15526     GO TO 3999-END-EDIT.
 15527
 15528******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 280
* EL050.cbl
 15530 3400-edit-vin.
 15531
 15532     move spaces                 to hldi-pass-area
 15533     MOVE PB-I-VIN               TO WS-WORK-VIN
 15534     MOVE +8                     TO V2
 15535     MOVE ZEROS                  TO WS-VIN-TOTAL
 15536     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15537      (V1 > 17)
 15538        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15539           MOVE ER-3825          TO WS-ERROR
 15540           PERFORM 9900-ERROR-FORMAT
 15541                                 THRU 9900-EXIT
 15542        ELSE
 15543           IF V1 = 8
 15544              MOVE 10            TO V2
 15545           END-IF
 15546           IF V1 = 9
 15547              MOVE 0             TO V2
 15548           END-IF
 15549           IF V1 = 10
 15550              MOVE 9             TO V2
 15551           END-IF
 15552           IF WS-WORK-VIN (V1:1) NUMERIC
 15553              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15554               + (WS-WORK-VIN-N (V1) * V2)
 15555           ELSE
 15556              MOVE WS-WORK-VIN (V1:1)
 15557                            TO WS-HEX-BYTE
 15558              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15559              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15560               + (WS-NUM (V3) * V2)
 15561           END-IF
 15562           COMPUTE V2 = V2 - 1
 15563        END-IF
 15564     END-PERFORM
 15565     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15566     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15567        REMAINDER WS-VIN-REMAINDER
 15568     IF ((WS-WORK-VIN (9:1) = 'X')
 15569        AND (WS-VIN-REMAINDER = 10))
 15570                OR
 15571        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15572        if pb-company-id = 'VPP'
 15573           perform 3410-check-with-hldi
 15574                                 thru 3410-exit
 15575     ELSE
 15576        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15577           MOVE ER-3826          TO WS-ERROR
 15578           PERFORM 9900-ERROR-FORMAT
 15579                                 THRU 9900-EXIT
 15580        ELSE
 15581           MOVE ER-3827          TO WS-ERROR
 15582           PERFORM 9900-ERROR-FORMAT
 15583                                 THRU 9900-EXIT
 15584        END-IF
 15585     END-IF
 15586
 15587     .
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 281
* EL050.cbl
 15588 3400-exit.
 15589     exit.
 15590 3410-check-with-hldi.
 15591     move spaces                 to hldi-pass-area
 15592     move pb-i-vin               to pa-vin
 15593     perform 7785-call-hldi      thru 7785-exit
 15594*    display 'PA-VIN        ' PA-VIN
 15595*    display 'PA-ErrorCode  ' PA-ErrorCode
 15596*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15597*    display 'PA-ModelYear  ' PA-ModelYear
 15598*    display 'PA-MakeName   ' PA-MakeName
 15599*    display 'PA-ModelName  ' PA-ModelName
 15600*    display 'PA-SeriesName ' PA-SeriesName
 15601     if pa-errorcode (1:1) not = '0'
 15602        move spaces              to hldi-pass-area
 15603        move pb-i-vin            to pa-vin
 15604*       move pa-errordesc        to pa-seriesname
 15605*       perform 7786-call-hldim  thru 7786-exit
 15606*       display 'PA-VIN        ' PA-VIN
 15607*       display 'PA-ErrorCode  ' PA-ErrorCode
 15608*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15609*       display 'PA-ModelYear  ' PA-ModelYear
 15610*       display 'PA-MakeName   ' PA-MakeName
 15611*       display 'PA-ModelName  ' PA-ModelName
 15612*       display 'PA-SeriesName ' PA-SeriesName
 15613     end-if
 15614     .
 15615 3410-exit.
 15616     exit.
 15617******************************************************************
 15618*                  E D I T   C A N C E L                         *
 15619******************************************************************
 15620
 15621 3700-EDIT-CANCEL.
 15622     IF PB-COMPANY-ID = 'DMD'
 15623         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15624                                         WS-RES-MUNI-TAX
 15625                                         PB-CI-STATE-TAX
 15626                                         PB-CI-MUNI-TAX
 15627         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15628
 15629*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15630*       IF PB-ENTRY-BATCH  NUMERIC
 15631*          IF PB-CANCELLATION
 15632*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15633*          ELSE
 15634*             IF PB-ISSUE
 15635*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15636
 15637     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15638        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15639     END-IF
 15640*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15641*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15642
 15643     IF CM-ENTRY-STATUS = 'V'
 15644        MOVE ER-2780             TO WS-ERROR
 15645        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 282
* EL050.cbl
 15646        GO TO 3999-END-EDIT.
 15647
 15648     IF CM-ENTRY-STATUS = 'D'
 15649        MOVE ER-2781             TO WS-ERROR
 15650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15651        GO TO 3999-END-EDIT.
 15652
 15653     IF CM-ENTRY-STATUS = 'U'
 15654        MOVE ER-2782             TO WS-ERROR
 15655        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15656
 15657***************************************************************
 15658*                                                             *
 15659*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15660*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15661*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15662*   OF ANOTHER COVERAGE.                                      *
 15663*                                                             *
 15664***************************************************************
 15665
 15666     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15667                                    PB-C-AH-CANCEL-VOID-SW.
 15668
 15669     IF PB-C-LF-CANCEL-AMT = ZERO
 15670        NEXT SENTENCE
 15671     ELSE
 15672        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15673           AND
 15674           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15675               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15676               MOVE ER-2745           TO WS-ERROR
 15677               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15678
 15679     IF PB-C-AH-CANCEL-AMT = ZERO
 15680        NEXT SENTENCE
 15681     ELSE
 15682        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15683           AND
 15684           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15685               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15686               MOVE ER-2745           TO WS-ERROR
 15687               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15688
 15689     IF WS-LF-EARNINGS-CALC = '4'
 15690        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15691
 15692     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15693     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15694     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15695     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15696     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15697     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15698
 15699     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15700                                      PB-C-AH-REF-CALC.
 15701     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15702
 15703******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 283
* EL050.cbl
 15704*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15705*             TO VALIDATE COVERAGE.                              *
 15706******************************************************************
 15707
 15708     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15709        PB-C-LF-CANCEL-AMT = ZEROS
 15710          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15711      ELSE
 15712          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15713
 15714     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15715        PB-C-AH-CANCEL-AMT = ZEROS
 15716          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15717      ELSE
 15718          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15719
 15720     EVALUATE TRUE
 15721         WHEN PB-CANCEL-FORCE             OR
 15722              PB-CANCEL-DATE-FORCED       OR
 15723              PB-FORCE-OFF
 15724                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15725                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15726                  END-IF
 15727         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15728               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15729              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15730                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15731         WHEN OTHER
 15732              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15733                 MOVE ER-2794              TO WS-ERROR
 15734              ELSE
 15735                 MOVE ER-2749              TO WS-ERROR
 15736              END-IF
 15737              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15738     END-EVALUATE.
 15739
 15740
 15741*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15742*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15743*            MOVE  ER-1909            TO  WS-ERROR
 15744*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15745*        ELSE
 15746*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15747
 15748     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15749     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15750        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15751     ELSE
 15752        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15753     END-IF
 15754     .
 15755 3705-EDIT-CANCEL-DT.
 15756
 15757     IF LF-COVERAGE-CANCELLED
 15758        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15759         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15760         MOVE WS-CURRENT-MONTH-END
 15761                                 TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 284
* EL050.cbl
 15762         SET ELAPSED-BETWEEN-BIN TO TRUE
 15763*        MOVE 1                  TO DC-OPTION-CODE
 15764         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15765         IF DATE-CONVERSION-ERROR
 15766            NEXT SENTENCE
 15767          ELSE
 15768             IF DC-ELAPSED-DAYS GREATER +180
 15769                IF PB-CANCEL-DATE-FORCED  OR
 15770                   PB-CANCEL-DATE-FORCED-NO-FEE
 15771                      MOVE ER-2751  TO WS-ERROR
 15772                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15773                 ELSE
 15774                   MOVE ER-2752  TO WS-ERROR
 15775                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15776
 15777     IF AH-COVERAGE-CANCELLED
 15778        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15779         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15780         MOVE WS-CURRENT-MONTH-END
 15781                                 TO DC-BIN-DATE-2
 15782         SET ELAPSED-BETWEEN-BIN TO TRUE
 15783*        MOVE 1                  TO DC-OPTION-CODE
 15784         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15785         IF DATE-CONVERSION-ERROR
 15786            NEXT SENTENCE
 15787          ELSE
 15788             IF DC-ELAPSED-DAYS GREATER +180
 15789                IF PB-CANCEL-DATE-FORCED OR
 15790                   PB-CANCEL-DATE-FORCED-NO-FEE
 15791                      MOVE ER-2751  TO WS-ERROR
 15792                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15793                 ELSE
 15794                   MOVE ER-2752  TO WS-ERROR
 15795                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15796
 15797     IF WS-ERROR = ER-2752
 15798        AND (PB-COMPANY-ID = 'ABL'
 15799         OR  PB-COMPANY-ID = 'FGL'
 15800         OR  PB-COMPANY-ID = 'IST'
 15801         OR  PB-COMPANY-ID = 'JHL'
 15802         OR  PB-COMPANY-ID = 'LAP'
 15803         OR  PB-COMPANY-ID = 'LBL'
 15804         OR  PB-COMPANY-ID = 'NCB'
 15805         OR  PB-COMPANY-ID = 'NLI'
 15806         OR  PB-COMPANY-ID = 'OFI'
 15807         OR  PB-COMPANY-ID = 'PLI'
 15808         OR  PB-COMPANY-ID = 'TAO'
 15809         OR  PB-COMPANY-ID = 'TIC'
 15810         OR  PB-COMPANY-ID = 'HER'
 15811         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15812         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15813            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15814            MOVE ER-2762     TO WS-ERROR
 15815            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15816
 15817     IF LF-COVERAGE-CANCELLED
 15818        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15819        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 285
* EL050.cbl
 15820             MOVE ER-2733         TO WS-ERROR
 15821             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15822
 15823     IF AH-COVERAGE-CANCELLED
 15824        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15825        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15826              MOVE ER-2733        TO WS-ERROR
 15827              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15828
 15829     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15830        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15831        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15832           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15833            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15834              IF PB-COMPANY-ID NOT = 'LAP'
 15835               MOVE ER-2704            TO WS-ERROR
 15836               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15837
 15838     IF CERT-WAS-NOT-FOUND
 15839         GO TO 3999-END-EDIT.
 15840
 15841     IF PB-COMPANY-ID EQUAL 'CDC'
 15842        IF LF-COVERAGE-CANCELLED
 15843           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15844            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15845            MOVE PB-C-LF-CANCEL-DT
 15846                                 TO DC-BIN-DATE-2
 15847            SET ELAPSED-BETWEEN-BIN TO TRUE
 15848*           MOVE 1               TO DC-OPTION-CODE
 15849            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15850            IF DATE-CONVERSION-ERROR
 15851               NEXT SENTENCE
 15852             ELSE
 15853                IF DC-ELAPSED-DAYS GREATER +60
 15854                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15855
 15856     IF PB-COMPANY-ID EQUAL 'CDC'
 15857        IF AH-COVERAGE-CANCELLED
 15858           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15859            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15860            MOVE PB-C-AH-CANCEL-DT
 15861                                 TO DC-BIN-DATE-2
 15862            MOVE +0              TO DC-ELAPSED-DAYS
 15863                                    DC-ELAPSED-MONTHS
 15864            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15865*           MOVE 1               TO DC-OPTION-CODE
 15866            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15867            IF DATE-CONVERSION-ERROR
 15868               NEXT SENTENCE
 15869             ELSE
 15870                IF DC-ELAPSED-DAYS GREATER +60
 15871                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15872
 15873     MOVE +0                     TO DC-ELAPSED-DAYS
 15874                                    DC-ELAPSED-MONTHS.
 15875
 15876     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15877        (WS-AH-SPECIAL-CALC-CD = 'Z')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 286
* EL050.cbl
 15878          MOVE 'Z'                TO PB-CI-OB-FLAG
 15879          MOVE ER-2767            TO WS-ERROR
 15880          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15881          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15882          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15883          GO TO 3775-OVER-REF-CHK
 15884        ELSE
 15885          MOVE ZEROS              TO PB-CI-LIVES
 15886                                     PB-C-LIVES
 15887          IF PB-CI-OB-FLAG NOT = 'B'
 15888             MOVE SPACE           TO PB-CI-OB-FLAG.
 15889
 15890     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15891         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15892     ELSE
 15893         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15894
 15895     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15896        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15897            MOVE ER-2760         TO WS-ERROR
 15898            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15899
 15900     IF LF-COVERAGE-CANCELLED
 15901        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15902         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15903            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15904               MOVE ER-2774       TO WS-ERROR
 15905               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15906
 15907     IF AH-COVERAGE-CANCELLED
 15908        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15909         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15910            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15911               MOVE ER-2775       TO WS-ERROR
 15912               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15913
 15914     IF LF-COVERAGE-CANCELLED
 15915        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15916         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15917            MOVE ER-2776         TO WS-ERROR
 15918            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15919
 15920     IF AH-COVERAGE-CANCELLED
 15921        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15922         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15923            MOVE ER-2777         TO WS-ERROR
 15924            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15925
 15926     IF LF-COVERAGE-CANCELLED
 15927        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15928        if pb-ci-lf-expire-dt = low-values or spaces
 15929           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15930           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15931           MOVE PB-CI-EXTENTION-DAYS
 15932                                 TO DC-ELAPSED-DAYS
 15933           SET BIN-PLUS-ELAPSED  TO TRUE
 15934           PERFORM 8500-DATE-CONVERT
 15935                                 THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 287
* EL050.cbl
 15936           IF DATE-CONVERSION-ERROR
 15937              move low-values    to dc-bin-date-2
 15938           end-if
 15939        else
 15940           move pb-ci-lf-expire-dt
 15941                                 to dc-bin-date-2
 15942        end-if
 15943        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15944           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15945                             OR  'FIA'
 15946              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15947           ELSE
 15948              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15949              MOVE ER-2731       TO WS-ERROR
 15950              PERFORM 9900-ERROR-FORMAT
 15951                                 THRU 9900-EXIT
 15952           end-if
 15953        end-if
 15954     end-if
 15955*    IF LF-COVERAGE-CANCELLED
 15956*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15957*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15958*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15959*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15960*        SET BIN-PLUS-ELAPSED      TO TRUE
 15961*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15962*        IF DATE-CONVERSION-ERROR
 15963*           NEXT SENTENCE
 15964*         ELSE
 15965*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15966*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15967*                            OR  'FIA'
 15968*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15969*              ELSE
 15970*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15971*               MOVE ER-2731       TO WS-ERROR
 15972*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15973     .
 15974 3705-EDIT-AH-CANCEL-DT.
 15975     IF AH-COVERAGE-CANCELLED
 15976        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15977        if pb-ci-AH-expire-dt = low-values or spaces
 15978           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15979           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15980           MOVE PB-CI-EXTENTION-DAYS
 15981                                 TO DC-ELAPSED-DAYS
 15982           SET BIN-PLUS-ELAPSED  TO TRUE
 15983           PERFORM 8500-DATE-CONVERT
 15984                                 THRU 8500-EXIT
 15985           IF DATE-CONVERSION-ERROR
 15986              move low-values    to dc-bin-date-2
 15987           end-if
 15988        else
 15989           move pb-ci-ah-expire-dt
 15990                                 to dc-bin-date-2
 15991        end-if
 15992        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15993           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 288
* EL050.cbl
 15994                             OR  'FIA'
 15995              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15996           ELSE
 15997              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15998              MOVE ER-2771       TO WS-ERROR
 15999              PERFORM 9900-ERROR-FORMAT
 16000                                 THRU 9900-EXIT
 16001           end-if
 16002        end-if
 16003     end-if
 16004*    IF AH-COVERAGE-CANCELLED
 16005*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16006*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16007*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16008*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16009**       MOVE 6                    TO DC-OPTION-CODE
 16010*        SET BIN-PLUS-ELAPSED      TO TRUE
 16011*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16012*        IF DATE-CONVERSION-ERROR
 16013*           NEXT SENTENCE
 16014*         ELSE
 16015*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16016*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16017*                             OR 'FIA'
 16018*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16019*             ELSE
 16020*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16021*              MOVE ER-2771       TO WS-ERROR
 16022*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16023     .
 16024 3705-EDIT-CONTINUED.
 16025
 16026*    IF LF-COVERAGE-CANCELLED
 16027*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16028*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16029*            MOVE ER-2727         TO WS-ERROR
 16030*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16031*
 16032*    IF AH-COVERAGE-CANCELLED
 16033*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16034*        IF PB-COMPANY-ID = 'ACE'
 16035*           MOVE ER-2727        TO WS-ERROR
 16036*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16037*        ELSE
 16038*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16039*              MOVE ER-2727     TO WS-ERROR
 16040*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16041
 16042     IF PB-COMPANY-ID = 'ACE'
 16043       IF AH-COVERAGE-CANCELLED
 16044         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16045           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16046              MOVE ER-2732      TO WS-ERROR
 16047              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16048
 16049     IF PB-COMPANY-ID      EQUAL   'HER'
 16050        IF WS-ERROR        EQUAL   ER-2727
 16051            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 289
* EL050.cbl
 16052            MOVE  ER-2725          TO  WS-ERROR
 16053            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16054
 16055     IF PB-C-CLAIM-CREATED-CANCEL
 16056            MOVE ER-2748         TO WS-ERROR
 16057            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16058
 16059     IF PB-C-LAST-NAME NOT = SPACES
 16060         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16061            MOVE ER-2747         TO WS-ERROR
 16062            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16063
 16064 3710-EDIT-LUMP-SUM-PRIOR.
 16065
 16066     IF AH-COVERAGE-CANCELLED
 16067         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16068             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16069                MOVE ER-2735    TO WS-ERROR
 16070                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16071
 16072     IF LF-COVERAGE-CANCELLED
 16073         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16074             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16075                MOVE ER-2735    TO WS-ERROR
 16076                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16077
 16078 3710-EDIT-PRIOR-DEATH.
 16079
 16080*    IF LF-COVERAGE-CANCELLED
 16081*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16082*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16083*           (NOT PB-CI-OB)
 16084*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16085*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16086*                   MOVE ER-2732  TO WS-ERROR
 16087*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16088*
 16089*    IF AH-COVERAGE-CANCELLED
 16090*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16091*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16092*           (NOT PB-CI-OB)
 16093*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16094*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16095*                   MOVE ER-2732  TO WS-ERROR
 16096*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16097
 16098     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16099         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16100            (NOT PB-COMP-LF-CANCEL)
 16101             NEXT SENTENCE
 16102         ELSE
 16103           IF PB-C-LF-CANCEL-VOIDED
 16104              NEXT SENTENCE
 16105           ELSE
 16106              MOVE ER-2753      TO WS-ERROR
 16107              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16108
 16109     IF CANCEL-FUTURE-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 290
* EL050.cbl
 16110         GO TO 3999-END-EDIT.
 16111
 16112 3715-GET-REMAIN-TERM-LF.
 16113
 16114     IF NO-LF-BENEFIT-MATCH  OR
 16115        WS-LF-BENEFIT-CD = ZEROS
 16116        GO TO 3730-GET-AH-REMAIN-TERM.
 16117
 16118     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16119     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16120     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16121     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16122     MOVE PB-SV-STATE            TO CP-STATE.
 16123     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16124     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16125     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16126     MOVE '2'                    TO CP-PROCESS-TYPE.
 16127     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16128     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16129     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16130     IF (PB-COMPANY-ID = 'CID')
 16131        AND (CP-STATE-STD-ABBRV = 'WI')
 16132        MOVE '7'                 TO CP-REM-TERM-METHOD
 16133        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16134     ELSE
 16135        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16136        MOVE WS-REM-TRM-CALC-OPTION
 16137                                 TO CP-REM-TRM-CALC-OPTION
 16138     END-IF
 16139**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16140     IF (PB-COMPANY-ID = 'CID')
 16141        AND (CP-STATE-STD-ABBRV = 'MO')
 16142        AND (PB-CERT-EFF-DT >= X'9B41')
 16143        AND (PB-CERT-EFF-DT <= X'A2FB')
 16144        MOVE '7'                 TO CP-REM-TERM-METHOD
 16145        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16146     END-IF
 16147     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16148                                    CP-LOAN-TERM.
 16149     IF CP-TRUNCATED-LIFE
 16150        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16151
 16152     IF CP-TERM-IS-DAYS
 16153         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16154     ELSE
 16155         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16156
 16157     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16158
 16159     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16160
 16161     IF LF-COVERAGE-CANCELLED
 16162        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16163        NEXT SENTENCE
 16164      ELSE
 16165          GO TO 3730-GET-AH-REMAIN-TERM.
 16166
 16167 3720-GET-LF-REFUND.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 291
* EL050.cbl
 16168
 16169     IF PB-C-LF-CANCEL-VOIDED
 16170        GO TO 3730-GET-AH-REMAIN-TERM
 16171     end-if
 16172
 16173     IF PB-COMPANY-ID EQUAL 'BOA'
 16174         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16175         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16176         GO TO 3730-GET-AH-REMAIN-TERM.
 16177
 16178     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16179        (WS-AH-SPECIAL-CALC-CD = 'M')
 16180         MOVE ER-2767            TO WS-ERROR
 16181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16182         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16183         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16184         GO TO 3780-UPDATE-CANCEL-CERT.
 16185
 16186*    if (ws-lf-earnings-calc = '6')
 16187*       or (pb-c-lf-refund-override = '6')
 16188*       move cp-remaining-term-1 to cp-remaining-term-2
 16189*    end-if
 16190     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16191
 16192     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16193     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16194     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16195     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16196     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16197     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16198     IF PB-COMPANY-ID = 'DCC'
 16199        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16200        IF PDEF-MASTER-FOUND
 16201           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16202              (V1 > +8)
 16203              OR (PD-PROD-CODE (V1) = 'L')
 16204           END-PERFORM
 16205           IF V1 < +9
 16206              MOVE PD-MAX-AMT (V1)
 16207                           TO CP-R-MAX-TOT-BEN
 16208                              EC-AM-LF-MAX-TOT-BEN
 16209           END-IF
 16210        ELSE
 16211        MOVE ' '                 TO PDEF-MASTER-SW
 16212        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16213        MOVE PB-STATE            TO ERPDEF-STATE
 16214        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16215           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16216        END-IF
 16217        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16218        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16219        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16220        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16221        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16222        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16223        IF PDEF-MASTER-FOUND
 16224           MOVE 'N'              TO PDEF-MASTER-SW
 16225           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 292
* EL050.cbl
 16226           IF PDEF-MASTER-FOUND
 16227              IF (ERPDEF-KEY-SAVE (1:16) =
 16228                           PD-CONTROL-PRIMARY (1:16))
 16229                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16230                 CONTINUE
 16231              ELSE
 16232                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16233                 IF (ERPDEF-KEY-SAVE (1:16) =
 16234                           PD-CONTROL-PRIMARY (1:16))
 16235                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16236                    CONTINUE
 16237                 ELSE
 16238                    MOVE 'N'     TO PDEF-MASTER-SW
 16239                 END-IF
 16240              END-IF
 16241
 16242              IF PDEF-MASTER-FOUND
 16243                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16244                    (V1 > +8)
 16245                    OR (PD-PROD-CODE (V1) = 'L')
 16246                 END-PERFORM
 16247                 IF V1 < +9
 16248                    MOVE PD-MAX-AMT (V1)
 16249                                 TO CP-R-MAX-TOT-BEN
 16250                                    EC-AM-LF-MAX-TOT-BEN
 16251                 END-IF
 16252              END-IF
 16253           END-IF
 16254           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16255        END-IF
 16256        END-IF
 16257     END-IF
 16258     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16259
 16260     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16261
 16262     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16263                                    PB-C-LF-REM-TERM.
 16264
 16265     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16266     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16267
 16268     IF PB-COMPANY-ID EQUAL 'FLC'
 16269        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16270           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16271           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16272                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16273                    - CM-LF-ITD-DEATH-AMT
 16274           IF PB-C-LF-REF-CALC LESS THAN +0
 16275              MOVE +0            TO PB-C-LF-REF-CALC
 16276              GO TO 3730-GET-AH-REMAIN-TERM
 16277           ELSE
 16278              GO TO 3730-GET-AH-REMAIN-TERM.
 16279
 16280     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16281                            OR '4' OR '5' OR '6' OR '8'
 16282                            OR '9' OR 'G'
 16283        MOVE PB-C-LF-REFUND-OVERRIDE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 293
* EL050.cbl
 16284                                 TO CP-EARNING-METHOD.
 16285
 16286     if pb-company-id = 'AHL'
 16287        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16288        if cp-class-code = spaces
 16289           move zeros            to cp-class-code
 16290        end-if
 16291     ELSE
 16292        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16293     END-IF
 16294*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16295     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16296     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16297                                    CP-RATING-BENEFIT-AMT.
 16298     IF CP-STATE-STD-ABBRV = 'OR'
 16299         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16300                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16301     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16302     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16303     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16304     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16305     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16306     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16307     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16308     IF WS-DEFAULT-APR NOT NUMERIC
 16309         MOVE ZEROS TO WS-DEFAULT-APR.
 16310****   N O T E   ****
 16311*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16312*      THE OH HARD CODING IN ELCRFNDP
 16313
 16314     IF PB-COMPANY-ID = 'CID'
 16315        IF CP-STATE-STD-ABBRV = 'OH'
 16316           MOVE WS-LF-EARNINGS-CALC
 16317                                 TO CP-EARNING-METHOD
 16318        END-IF
 16319     END-IF
 16320
 16321****   N O T E   ****
 16322
 16323     IF CP-EARN-AS-NET-PAY
 16324         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16325            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16326                MOVE WS-DEFAULT-APR
 16327                                 TO  CP-LOAN-APR
 16328                MOVE ER-3780     TO  WS-ERROR
 16329                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16330            ELSE
 16331                MOVE ER-3781     TO  WS-ERROR
 16332                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16333*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16334     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16335
 16336     IF CP-REFUND-TYPE-USED NOT = SPACE
 16337         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16338
 16339     IF CP-ERROR-RATE-IS-ZERO OR
 16340        CP-ERROR-RATE-NOT-FOUND
 16341        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 294
* EL050.cbl
 16342        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16343
 16344     IF CP-ERROR-RATE-FILE-NOTOPEN
 16345        MOVE ER-2617             TO WS-ERROR
 16346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16347
 16348     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16349        AND PB-CI-ENTRY-STATUS = 'M'
 16350        MOVE +0                  TO PB-C-LF-REF-CALC
 16351     ELSE
 16352        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16353     END-IF
 16354
 16355     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16356         GO TO 3730-GET-AH-REMAIN-TERM.
 16357
 16358*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16359*       ADD +1                   TO PB-C-LF-REM-TERM
 16360*                                   CP-REMAINING-TERM
 16361*                                   CP-ORIGINAL-TERM.
 16362
 16363     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16364     MOVE '2'                    TO CP-EARNING-METHOD
 16365                                    CP-RATING-METHOD.
 16366     IF PB-COMPANY-ID = 'CID'
 16367        IF (CP-STATE-STD-ABBRV = 'MN')
 16368           AND (PB-CERT-EFF-DT > X'A4FF')
 16369           AND (WS-LF-EARNINGS-CALC = 'B')
 16370           MOVE '5'              TO CP-EARNING-METHOD
 16371           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16372        END-IF
 16373     END-IF
 16374     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16375                                        CP-REMAINING-BENEFIT
 16376                                        CP-RATING-BENEFIT-AMT.
 16377     IF CP-STATE-STD-ABBRV = 'OR'
 16378         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16379                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16380     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16381     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16382
 16383     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16384
 16385     IF CP-ERROR-RATE-IS-ZERO OR
 16386        CP-ERROR-RATE-NOT-FOUND
 16387        MOVE ER-2740             TO WS-ERROR
 16388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16389
 16390     IF CP-ERROR-RATE-FILE-NOTOPEN
 16391        MOVE ER-2617             TO WS-ERROR
 16392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16393
 16394     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16395
 16396******************************************************************
 16397
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 295
* EL050.cbl
 16399 3730-GET-AH-REMAIN-TERM.
 16400     IF NO-AH-BENEFIT-MATCH  OR
 16401        WS-AH-BENEFIT-CD = ZEROS
 16402         GO TO 3770-CHECK-REFUNDS.
 16403
 16404     IF PB-CI-AH-LUMP-SUM-DISAB
 16405         IF  PB-C-AH-CANCEL-AMT = ZERO
 16406            IF NOT PB-COMP-AH-CANCEL
 16407             GO TO 3770-CHECK-REFUNDS.
 16408
 16409     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16410     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16411     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16412     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16413     MOVE PB-SV-STATE            TO CP-STATE.
 16414     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16415     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16416     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16417     MOVE '2'                    TO CP-PROCESS-TYPE.
 16418     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16419     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16420     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16421     IF (PB-COMPANY-ID = 'CID')
 16422        AND (CP-STATE-STD-ABBRV = 'WI')
 16423        MOVE '7'                 TO CP-REM-TERM-METHOD
 16424        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16425     ELSE
 16426        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16427        MOVE WS-REM-TRM-CALC-OPTION
 16428                                 TO CP-REM-TRM-CALC-OPTION
 16429     END-IF
 16430     IF (PB-COMPANY-ID = 'CID')
 16431        AND (CP-STATE-STD-ABBRV = 'MO')
 16432        AND (PB-CERT-EFF-DT >= X'9B41')
 16433        AND (PB-CERT-EFF-DT <= X'A2FB')
 16434        MOVE '7'                 TO CP-REM-TERM-METHOD
 16435        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16436     END-IF
 16437     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16438                                    CP-LOAN-TERM.
 16439     IF NOT CP-TERM-IS-DAYS
 16440         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16441
 16442     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16443
 16444     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16445
 16446     IF AH-COVERAGE-CANCELLED
 16447        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16448        NEXT SENTENCE
 16449      ELSE
 16450         GO TO 3770-CHECK-REFUNDS.
 16451
 16452 3740-GET-AH-REFUND.
 16453
 16454     IF PB-C-AH-CANCEL-VOIDED
 16455        GO TO 3780-UPDATE-CANCEL-CERT
 16456     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 296
* EL050.cbl
 16457
 16458     IF PB-COMPANY-ID = 'BOA'
 16459         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16460         GO TO 3770-CHECK-REFUNDS.
 16461
 16462     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16463*    MOVE ' '                    TO DC-OPTION-CODE
 16464     SET BIN-TO-GREG             TO TRUE
 16465     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16466     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16467                                    PB-C-AH-REM-TERM.
 16468     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16469     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16470
 16471     IF PB-COMPANY-ID EQUAL 'FLC'
 16472        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16473           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16474           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16475                    - CM-AH-ITD-AH-PMT)
 16476           IF PB-C-AH-REF-CALC LESS THAN +0
 16477              MOVE +0            TO PB-C-AH-REF-CALC
 16478              GO TO 3770-CHECK-REFUNDS
 16479           ELSE
 16480              GO TO 3770-CHECK-REFUNDS.
 16481
 16482     IF PB-COMPANY-ID = 'DCC'
 16483        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16484            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16485           MOVE 'S'              TO CP-EARNING-METHOD
 16486        END-IF
 16487     END-IF
 16488     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16489                            OR '4' OR '5' OR '6' OR '8'
 16490                            OR '9' OR 'G' OR 'S'
 16491        MOVE PB-C-AH-REFUND-OVERRIDE
 16492                                 TO CP-EARNING-METHOD.
 16493
 16494     if pb-company-id = 'AHL'
 16495        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16496        if cp-class-code = spaces
 16497           move zeros            to cp-class-code
 16498        end-if
 16499     ELSE
 16500        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16501     END-IF
 16502*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16503     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16504     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16505                                    CP-RATING-BENEFIT-AMT.
 16506     IF CP-STATE-STD-ABBRV = 'OR'
 16507         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16508                                         PB-CI-AH-TERM.
 16509     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16510     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16511     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16512     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16513     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16514     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 297
* EL050.cbl
 16515
 16516     IF CP-STATE-STD-ABBRV = 'OH'
 16517        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16518                                AND 'CID' AND 'DCC' and 'VPP'
 16519                                AND 'AHL')
 16520           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16521              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16522              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16523              MOVE '6' TO CP-EARNING-METHOD
 16524           END-IF
 16525        END-IF
 16526        IF PB-COMPANY-ID = 'CID'
 16527           IF NO-LIFE-COVERAGE
 16528              IF CP-CRITICAL-PERIOD
 16529                 MOVE '2'       TO CP-EARNING-METHOD
 16530              ELSE
 16531                 MOVE '6'       TO CP-EARNING-METHOD
 16532              END-IF
 16533           ELSE
 16534              IF WS-LF-COVERAGE-TYPE = 'L'
 16535                 MOVE '2'       TO CP-EARNING-METHOD
 16536              ELSE
 16537                 IF (PB-CI-LF-TERM > +60) OR
 16538                    (WS-LF-EARNINGS-CALC = '5')
 16539                    IF CP-CRITICAL-PERIOD
 16540                       MOVE '2'  TO CP-EARNING-METHOD
 16541                    ELSE
 16542                       MOVE '6'  TO CP-EARNING-METHOD
 16543                    END-IF
 16544                 ELSE
 16545                    MOVE '1'     TO CP-EARNING-METHOD
 16546                 END-IF
 16547              END-IF
 16548           END-IF
 16549        END-IF
 16550     END-IF
 16551
 16552*    IF CP-STATE-STD-ABBRV = 'VA'
 16553*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16554*          IF CP-ORIGINAL-TERM GREATER 61
 16555*             MOVE '6' TO CP-EARNING-METHOD
 16556*          ELSE
 16557*             MOVE '1' TO CP-EARNING-METHOD.
 16558
 16559     IF WS-DEFAULT-APR NOT NUMERIC
 16560         MOVE ZEROS TO WS-DEFAULT-APR.
 16561     IF CP-EARN-AS-NET-PAY
 16562         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16563            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16564                MOVE WS-DEFAULT-APR
 16565                                 TO  CP-LOAN-APR
 16566                MOVE ER-3780     TO  WS-ERROR
 16567                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16568            ELSE
 16569                MOVE ER-3781     TO  WS-ERROR
 16570                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16571     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16572     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 298
* EL050.cbl
 16573        AND CP-CANCEL-REASON = 'R'
 16574        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16575        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16576     END-IF
 16577     IF PB-COMPANY-ID = 'DCC'
 16578        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16579        AND (CP-EARNING-METHOD = 'D')
 16580        AND (CP-CANCEL-REASON NOT = 'R')
 16581        CONTINUE
 16582     ELSE
 16583        GO TO 3750-CONTINUE
 16584     END-IF
 16585     MOVE ' '                    TO DD-IU-SW
 16586     IF NOT PDEF-MASTER-FOUND
 16587        MOVE ' '                 TO PDEF-MASTER-SW
 16588        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16589        MOVE PB-STATE            TO ERPDEF-STATE
 16590        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16591           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16592        END-IF
 16593        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16594        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16595        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16596        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16597        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16598        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16599        IF PDEF-MASTER-FOUND
 16600           MOVE 'N'              TO PDEF-MASTER-SW
 16601           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16602           IF PDEF-MASTER-FOUND
 16603              IF (ERPDEF-KEY-SAVE (1:16) =
 16604                           PD-CONTROL-PRIMARY (1:16))
 16605                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16606                 CONTINUE
 16607              ELSE
 16608                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16609                 IF (ERPDEF-KEY-SAVE (1:16) =
 16610                           PD-CONTROL-PRIMARY (1:16))
 16611                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16612                    CONTINUE
 16613                 ELSE
 16614                    MOVE ER-2740 TO WS-ERROR
 16615                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16616                    GO TO 3770-CHECK-REFUNDS
 16617                 END-IF
 16618              END-IF
 16619           END-IF
 16620           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16621        END-IF
 16622     END-IF
 16623     IF PDEF-MASTER-FOUND
 16624        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16625           (V1 > +8)
 16626           OR (PD-PROD-CODE (V1) = 'I')
 16627        END-PERFORM
 16628        IF V1 < +9
 16629           SET DD-IU-PRESENT        TO TRUE
 16630        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 299
* EL050.cbl
 16631        IF WS-AH-DCC-TRUNC = 'T'
 16632           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16633        ELSE
 16634           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16635        END-IF
 16636        EVALUATE TRUE
 16637           WHEN WS-TERM > +168
 16638              MOVE 15               TO V1
 16639           WHEN WS-TERM > +156
 16640              MOVE 14               TO V1
 16641           WHEN WS-TERM > +144
 16642              MOVE 13               TO V1
 16643           WHEN WS-TERM > +132
 16644              MOVE 12               TO V1
 16645           WHEN WS-TERM > +120
 16646              MOVE 11               TO V1
 16647           WHEN WS-TERM > +108
 16648              MOVE 10               TO V1
 16649           WHEN WS-TERM > +96
 16650              MOVE 9                TO V1
 16651           WHEN WS-TERM > +84
 16652              MOVE 8                TO V1
 16653           WHEN WS-TERM > +72
 16654              MOVE 7                TO V1
 16655           WHEN WS-TERM > +60
 16656              MOVE 6                TO V1
 16657           WHEN WS-TERM > +48
 16658              MOVE 5                TO V1
 16659           WHEN WS-TERM > +36
 16660              MOVE 4                TO V1
 16661           WHEN WS-TERM > +24
 16662              MOVE 3                TO V1
 16663           WHEN WS-TERM > +12
 16664              MOVE 2                TO V1
 16665           WHEN OTHER
 16666              MOVE 1                TO V1
 16667        END-EVALUATE
 16668
 16669        EVALUATE TRUE
 16670*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16671*             < +13)
 16672*             AND (DD-IU-PRESENT)
 16673*             MOVE 2                TO V2
 16674*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16675*             MOVE 1                TO V2
 16676           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16677              MOVE 2                TO V2
 16678           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16679              MOVE 3                TO V2
 16680           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16681              MOVE 4                TO V2
 16682           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16683              MOVE 5                TO V2
 16684           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16685              MOVE 6                TO V2
 16686           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16687              MOVE 7                TO V2
 16688           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 300
* EL050.cbl
 16689              MOVE 8                TO V2
 16690           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16691              MOVE 9                TO V2
 16692           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16693              MOVE 10               TO V2
 16694           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16695              MOVE 11               TO V2
 16696           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16697              MOVE 12               TO V2
 16698           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16699              MOVE 13               TO V2
 16700           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16701              MOVE 14               TO V2
 16702           WHEN OTHER
 16703              MOVE 15               TO V2
 16704        END-EVALUATE
 16705
 16706        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16707                                 TO CP-DDF-LO-FACT
 16708        MOVE PD-UEP-FACTOR (V1 V2)
 16709                                 TO CP-DDF-HI-FACT
 16710
 16711        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16712        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16713        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16714           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16715        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16716        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16717        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16718           + PD-1ST-YR-ADMIN-ALLOW
 16719
 16720        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16721*       IF PI-CLP-YN = 'Y'
 16722*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16723*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16724*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16725*       END-IF
 16726
 16727        IF DD-IU-PRESENT
 16728           MOVE 'I'              TO CP-EARNING-METHOD
 16729        END-IF
 16730        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16731                                     CP-CLP-RATE-UP
 16732        IF CP-IU-RATE-UP NOT = ZEROS
 16733           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16734              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16735           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16736              / (1 - WS-WORK-FACT)
 16737        END-IF
 16738     END-IF
 16739     .
 16740 3750-CONTINUE.
 16741     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16742
 16743     IF CP-REFUND-TYPE-USED NOT = SPACE
 16744         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16745
 16746     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 301
* EL050.cbl
 16747        CP-ERROR-RATE-NOT-FOUND
 16748        MOVE ER-2740             TO WS-ERROR
 16749        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16750
 16751     IF CP-ERROR-RATE-FILE-NOTOPEN
 16752        MOVE ER-2617             TO WS-ERROR
 16753        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16754     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16755        AND (PB-CI-ENTRY-STATUS = 'M')
 16756        MOVE +0                  TO PB-C-AH-REF-CALC
 16757     ELSE
 16758        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16759     END-IF
 16760     if pb-company-id = 'VPP'
 16761        MOVE cm-ah-clp           to cp-original-premium
 16762        move zeros               to cp-calc-refund
 16763        perform 7600-get-refund  thru 7600-exit
 16764        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16765           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16766        else
 16767           move zeros            to pb-c-ah-rfnd-clp
 16768        end-if
 16769        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16770           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16771           pb-ci-cancel-fee
 16772     end-if
 16773     IF PB-COMPANY-ID = 'DCC'
 16774        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16775        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16776        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16777        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16778        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16779        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16780        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16781        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16782*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16783     END-IF
 16784     .
 16785 3770-CHECK-REFUNDS.
 16786
 16787     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16788        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16789           MOVE ER-2766          TO WS-ERROR
 16790           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16791           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16792           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16793              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16794
 16795     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16796        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16797           MOVE ER-2766          TO WS-ERROR
 16798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16799           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16800           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16801              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16802
 16803     IF PB-COMP-LF-CANCEL
 16804        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 302
* EL050.cbl
 16805        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16806           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16807              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16808
 16809     IF PB-COMP-AH-CANCEL
 16810        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16811        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16812           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16813              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16814
 16815     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16816             GIVING WS-UNSIGN-WRK1
 16817     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16818             GIVING WS-UNSIGN-WRK2.
 16819
 16820     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16821         MOVE ZERO TO WS-UNSIGN-WRK1.
 16822
 16823     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16824         MOVE ZERO TO WS-UNSIGN-WRK2.
 16825
 16826     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16827
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 303
* EL050.cbl
 16829
 16830 3772-CONTINUE.
 16831
 16832**********************************
 16833*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16834*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16835*** DOUBLES THE TOLERANCE AMOUNT.
 16836***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16837**********************************
 16838     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16839     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16840         IF WS-REF-REJECT-SW = SPACE
 16841             MOVE ER-2754        TO WS-ERROR
 16842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16843           ELSE
 16844             MOVE ER-2736        TO WS-ERROR
 16845             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16846**********************************
 16847
 16848 3773-CONTINUE.
 16849
 16850     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16851        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16852           MOVE ER-2723          TO WS-ERROR
 16853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16854
 16855     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16856        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16857           MOVE ER-2724          TO WS-ERROR
 16858           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16859
 16860     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16861         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16862             (1 + WS-LF-REFUND-OVS-PCT)
 16863     ELSE
 16864         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16865
 16866     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16867         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16868             (1 - WS-TOL-LF-REFUND-PCT)
 16869     ELSE
 16870         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16871
 16872     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16873        AND (PB-CI-ENTRY-STATUS = 'M')
 16874        AND (PB-C-LF-CANCEL-AMT > +0)
 16875        MOVE ER-3843             TO WS-ERROR
 16876        PERFORM 9900-ERROR-FORMAT
 16877                                 THRU 9900-EXIT
 16878     END-IF
 16879     EVALUATE TRUE
 16880        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16881           CONTINUE
 16882        WHEN PB-C-LF-CANCEL-AMT = +0
 16883                 AND PB-C-LF-REF-CALC > +0
 16884           CONTINUE
 16885        WHEN WS-LF-REFUND-OVS-AMT = 0
 16886                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 304
* EL050.cbl
 16887           CONTINUE
 16888        WHEN OTHER
 16889           IF WS-TOL-LF-REFUND  = +0
 16890              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16891           END-IF
 16892           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16893                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16894                          (PB-C-LF-CANCEL-AMT))
 16895              CONTINUE
 16896           ELSE
 16897              IF WS-LF-REFUND-OVS-AMT = +0
 16898                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16899              END-IF
 16900              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16901                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16902                                       PB-C-LF-CANCEL-AMT)
 16903                 CONTINUE
 16904              ELSE
 16905                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16906                   MOVE ER-2754   TO  WS-ERROR
 16907                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16908                 ELSE
 16909                    MOVE ER-2736   TO  WS-ERROR
 16910                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16911                 END-IF
 16912              END-IF
 16913           END-IF
 16914     END-EVALUATE.
 16915
 16916     EVALUATE TRUE
 16917        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16918           CONTINUE
 16919        WHEN PB-C-LF-CANCEL-AMT = +0
 16920                 AND PB-C-LF-REF-CALC > +0
 16921           CONTINUE
 16922        WHEN OTHER
 16923           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16924               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16925              CONTINUE
 16926           ELSE
 16927              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16928               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16929                CONTINUE
 16930              ELSE
 16931                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16932                     MOVE ER-2754   TO  WS-ERROR
 16933                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16934                 ELSE
 16935                     MOVE ER-2736   TO  WS-ERROR
 16936                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16937                 END-IF
 16938              END-IF
 16939           END-IF
 16940     END-EVALUATE.
 16941
 16942     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16943         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16944             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 305
* EL050.cbl
 16945     ELSE
 16946         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16947
 16948     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16949         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16950             (1 - WS-TOL-AH-REFUND-PCT)
 16951     ELSE
 16952         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16953
 16954     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16955        AND (PB-CI-ENTRY-STATUS = 'M')
 16956        AND (PB-C-AH-CANCEL-AMT > +0)
 16957        MOVE ER-3843             TO WS-ERROR
 16958        PERFORM 9900-ERROR-FORMAT
 16959                                 THRU 9900-EXIT
 16960     END-IF
 16961     EVALUATE TRUE
 16962        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16963           CONTINUE
 16964*       WHEN PB-C-AH-REF-CALC = +0 AND
 16965*                  PB-C-AH-CANCEL-AMT > +0
 16966        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16967                   PB-C-AH-REF-CALC > +0
 16968           CONTINUE
 16969        WHEN WS-AH-REFUND-OVS-AMT = +0
 16970                AND WS-TOL-AH-REFUND = +0
 16971           CONTINUE
 16972        WHEN OTHER
 16973           IF WS-TOL-AH-REFUND = +0
 16974              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16975           END-IF
 16976           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16977               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16978                                         PB-C-AH-CANCEL-AMT)
 16979              CONTINUE
 16980           ELSE
 16981              IF WS-AH-REFUND-OVS-AMT = +0
 16982                 MOVE +9999999.99 TO
 16983                         WS-AH-REFUND-OVS-AMT
 16984              END-IF
 16985              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16986                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16987                                         PB-C-AH-CANCEL-AMT)
 16988                 CONTINUE
 16989              ELSE
 16990                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16991                    MOVE ER-2754   TO  WS-ERROR
 16992                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16993                 ELSE
 16994                    MOVE ER-2736   TO  WS-ERROR
 16995                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16996                 END-IF
 16997              END-IF
 16998           END-IF
 16999     END-EVALUATE.
 17000
 17001     EVALUATE TRUE
 17002        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 306
* EL050.cbl
 17003           CONTINUE
 17004*       WHEN PB-C-AH-REF-CALC > +0 AND
 17005*                  PB-C-AH-CANCEL-AMT = +0
 17006        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17007                   PB-C-AH-REF-CALC = +0
 17008           CONTINUE
 17009        WHEN OTHER
 17010           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17011               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17012              CONTINUE
 17013           ELSE
 17014              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17015                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17016                 CONTINUE
 17017              ELSE
 17018                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17019                     MOVE ER-2754   TO  WS-ERROR
 17020                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17021                 ELSE
 17022                     MOVE ER-2736   TO  WS-ERROR
 17023                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17024                 END-IF
 17025              END-IF
 17026           END-IF
 17027     END-EVALUATE.
 17028
 17029     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17030        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17031        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17032           AND  PB-C-LF-REF-CALC < +1.00
 17033           AND  PB-C-AH-REF-CALC < +1.00
 17034           CONTINUE
 17035        ELSE
 17036           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17037              AND (PB-CI-ENTRY-STATUS = 'M')
 17038              CONTINUE
 17039           ELSE
 17040              MOVE ER-2741       TO WS-ERROR
 17041              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17042           END-IF
 17043        END-IF
 17044     END-IF
 17045
 17046     IF (PB-C-LF-CANCEL-AMT = ZERO
 17047        AND WS-LF-BENEFIT-CD NOT = ZERO
 17048        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17049        AND PB-C-LF-REF-CALC NOT = ZERO)
 17050        OR
 17051        (PB-C-LF-CANCEL-AMT = ZERO
 17052        AND WS-LF-BENEFIT-CD NOT = ZERO
 17053        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17054             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17055                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17056                NEXT SENTENCE
 17057             ELSE
 17058                MOVE ER-2739        TO WS-ERROR
 17059                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17060
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 307
* EL050.cbl
 17061     IF (PB-C-AH-CANCEL-AMT = ZERO
 17062        AND WS-AH-BENEFIT-CD NOT = ZERO
 17063        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17064        AND PB-C-AH-REF-CALC NOT = ZERO)
 17065        OR
 17066        (PB-C-AH-CANCEL-AMT = ZERO
 17067        AND WS-AH-BENEFIT-CD NOT = ZERO
 17068        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17069             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17070                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17071                NEXT SENTENCE
 17072             ELSE
 17073                MOVE ER-2738        TO WS-ERROR
 17074                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17075
 17076 3775-OVER-REF-CHK.
 17077
 17078     IF PB-CI-ENTRY-STATUS = '5'
 17079        GO TO 3780-UPDATE-CANCEL-CERT.
 17080
 17081     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17082                              PB-CI-LF-ALT-PREMIUM-AMT.
 17083
 17084     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17085        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17086                                 PB-C-LF-REF-CALC
 17087      ELSE
 17088        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17089                                 PB-C-LF-CANCEL-AMT.
 17090
 17091     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17092        MOVE ER-2755             TO WS-ERROR
 17093        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17094
 17095     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17096
 17097     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17098        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17099                                 PB-C-AH-REF-CALC
 17100      ELSE
 17101        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17102                                 PB-C-AH-CANCEL-AMT.
 17103
 17104     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17105        MOVE ER-2778             TO WS-ERROR
 17106        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17107
 17108     IF PB-CI-OB-FLAG NOT = 'Z'
 17109        NEXT SENTENCE
 17110       ELSE
 17111         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17112            MOVE ER-2757           TO WS-ERROR
 17113            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17114
 17115 3780-UPDATE-CANCEL-CERT.
 17116
 17117     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17118        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 308
* EL050.cbl
 17119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17120
 17121     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17122         MOVE ER-2729              TO WS-ERROR
 17123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17124
 17125     IF PB-CI-LF-BENEFIT-CD = ZERO
 17126         GO TO 3780-UPDATE-CONT-1.
 17127
 17128     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17129         GO TO 3780-UPDATE-CONT-1.
 17130
 17131     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17132       AND
 17133        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17134       AND
 17135        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17136       AND
 17137        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17138            NEXT SENTENCE
 17139       ELSE
 17140        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17141          AND
 17142***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17143***       AND
 17144           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17145            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17146               MOVE ER-2730      TO WS-ERROR
 17147               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17148               GO TO 3999-END-EDIT
 17149            ELSE
 17150               GO TO 3999-END-EDIT
 17151        ELSE
 17152            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17153               MOVE ER-2765           TO WS-ERROR
 17154               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17155               GO TO 3785-CHECK-NH.
 17156*              GO TO 3999-END-EDIT.
 17157
 17158 3780-UPDATE-CONT-1.
 17159     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17160
 17161     IF PB-CI-AH-BENEFIT-CD = ZERO
 17162         GO TO 3780-UPDATE-CONT-2.
 17163
 17164     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17165         GO TO 3780-UPDATE-CONT-2.
 17166
 17167     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17168
 17169     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17170       AND
 17171        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17172       AND
 17173        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17174       AND
 17175        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17176            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 309
* EL050.cbl
 17177       ELSE
 17178        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17179          AND
 17180***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17181***       AND
 17182           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17183           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17184            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17185               MOVE ER-2773      TO WS-ERROR
 17186               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17187               GO TO 3999-END-EDIT
 17188            ELSE
 17189               GO TO 3999-END-EDIT
 17190            END-IF
 17191           ELSE
 17192             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17193                IF MSTR-CERT-NO = W-CL-CERT-NO
 17194                   MOVE ER-2890 TO WS-ERROR
 17195                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17196                   GO TO 3999-END-EDIT
 17197                ELSE
 17198                   MOVE ER-2898 TO WS-ERROR
 17199                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17200                   GO TO 3999-END-EDIT
 17201                END-IF
 17202             ELSE
 17203                GO TO 3785-CHECK-NH
 17204             END-IF
 17205           END-IF
 17206          ELSE
 17207            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17208              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17209                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17210                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17211                      MOVE ER-2890 TO WS-ERROR
 17212                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17213                      GO TO 3999-END-EDIT
 17214                   ELSE
 17215                      MOVE ER-2898 TO WS-ERROR
 17216                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17217                      GO TO 3999-END-EDIT
 17218                   END-IF
 17219                ELSE
 17220                   MOVE ER-2765 TO WS-ERROR
 17221                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17222                   GO TO 3785-CHECK-NH
 17223                END-IF
 17224              ELSE
 17225               MOVE ER-2765      TO WS-ERROR
 17226               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17227               GO TO 3785-CHECK-NH.
 17228*              GO TO 3999-END-EDIT.
 17229
 17230 3780-UPDATE-CONT-2.
 17231
 17232     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17233        AND WS-LF-BENEFIT-CD = ZERO
 17234           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 310
* EL050.cbl
 17235           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17236
 17237     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17238        AND WS-AH-BENEFIT-CD = ZERO
 17239           MOVE ER-2744           TO WS-ERROR
 17240           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17241
 17242     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17243        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17244        AND
 17245        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17246         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17247           MOVE ER-2746           TO WS-ERROR
 17248           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17249
 17250     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17251       AND
 17252        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17253             MOVE ER-2737        TO WS-ERROR
 17254             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17255
 17256     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17257       AND
 17258        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17259             MOVE ER-2737        TO WS-ERROR
 17260             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17261
 17262     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17263         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17264             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17265             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17266         ELSE
 17267             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17268                 MOVE ER-2768    TO WS-ERROR
 17269                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17270             ELSE
 17271                 MOVE ER-2756    TO WS-ERROR
 17272                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17273
 17274     IF CERT-PEND-ISSUE-RETURNED
 17275        MOVE ER-2772             TO WS-ERROR
 17276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17277 3785-CHECK-NH.
 17278*    IF PB-STATE NOT = 'NH' and 'TN'
 17279     IF PB-STATE NOT = 'NH'
 17280        GO TO 3999-END-EDIT
 17281     END-IF
 17282
 17283     MOVE ER-2796                TO WS-ERROR
 17284     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17285     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17286        OR (CM-NH-INTERFACE-SW = 'Y')
 17287        MOVE ER-2793             TO WS-ERROR
 17288        PERFORM 9900-ERROR-FORMAT
 17289                                 THRU 9900-EXIT
 17290     END-IF
 17291     MOVE +0                     TO WS-PAYMENT-AMT
 17292     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 311
* EL050.cbl
 17293        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17294               PB-C-AH-CANCEL-DT
 17295           GO TO 3999-END-EDIT
 17296        END-IF
 17297     end-if
 17298***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17299***-_-
 17300***-_-   For TN it's only flat cancels
 17301***-_-
 17302***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17303     if pb-state = 'TN'
 17304        if ((pb-c-lf-cancel-dt <> low-values)
 17305           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17306                      or
 17307           ((pb-c-ah-cancel-dt <> low-values)
 17308           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17309           GO TO 3999-END-EDIT
 17310        END-IF
 17311     end-if
 17312     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17313        GO TO 3999-END-EDIT
 17314     END-IF
 17315***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17316***-_-
 17317***-_-   if cancel date within 15 days of effective date, bypass
 17318***-_-
 17319***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17320     IF PB-STATE NOT = 'NH'
 17321        GO TO 3785-CONTINUE
 17322     END-IF
 17323     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17324     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17325     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17326        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17327     END-IF
 17328     MOVE '1'                    TO DC-OPTION-CODE
 17329     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17330     IF NO-CONVERSION-ERROR
 17331        IF DC-ELAPSED-DAYS < +16
 17332           GO TO 3999-END-EDIT
 17333        END-IF
 17334     END-IF
 17335***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17336***-_-
 17337***-_-   if cancel date within 30 days of current date then
 17338***-_-   bypass else subtract 15 days from period
 17339***-_-
 17340***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17341     MOVE +0                     TO DC-ELAPSED-DAYS
 17342     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17343     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17344     MOVE '1'                    TO DC-OPTION-CODE
 17345     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17346     IF NO-CONVERSION-ERROR
 17347        IF DC-ELAPSED-DAYS > +30
 17348           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17349        ELSE
 17350           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 312
* EL050.cbl
 17351        END-IF
 17352     ELSE
 17353        GO TO 3999-END-EDIT
 17354     END-IF
 17355     .
 17356 3785-CONTINUE.
 17357     if pb-state = 'TN'
 17358        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17359        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17360        MOVE '1'                 TO DC-OPTION-CODE
 17361        PERFORM 8500-DATE-CONVERT
 17362                                 THRU 8500-EXIT
 17363        IF no-CONVERSION-ERROR
 17364           IF DC-ELAPSED-DAYS < +16
 17365              GO TO 3999-END-EDIT
 17366           END-IF
 17367        END-IF
 17368***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17369***-_-
 17370***-_-   'NH' is 10%, TN is 3.5%
 17371***-_-
 17372***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17373     if pb-state = 'NH'
 17374        move +1.10               to ws-work-rate
 17375     else
 17376        move +1.035              to ws-work-rate
 17377     end-if
 17378     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17379        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17380           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17381     IF WS-PAYMENT-AMT < 600.00
 17382        GO TO 3999-END-EDIT
 17383     END-IF
 17384     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17385
 17386     IF (ERMAIL-FOUND = ' ')
 17387         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17388         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17389        GO TO 3999-END-EDIT
 17390     END-IF
 17391     MOVE ER-2795                TO WS-ERROR
 17392     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17393
 17394     GO TO 3999-END-EDIT.
 17395******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 313
* EL050.cbl
 17397 3990-FILES-NOT-OPEN.
 17398
 17399     MOVE ER-2617                TO WS-ERROR.
 17400     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17401     GO TO 9990-RETURN.
 17402
 17403 3999-END-EDIT.
 17404
 17405     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17406
 17407     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17408         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17409         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17410             PERFORM 9250-UNLOCK-RETURN
 17411             GO TO 9990-RETURN
 17412          ELSE
 17413             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17414             GO TO 9990-RETURN.
 17415
 17416     IF PB-CANCELLATION
 17417          GO TO 9990-RETURN.
 17418
 17419     IF CERT-WAS-NOT-FOUND
 17420        MOVE SPACES              TO CERTIFICATE-MASTER.
 17421
 17422     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17423
 17424     IF CERT-WAS-FOUND
 17425         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17426             PERFORM 9250-UNLOCK-RETURN
 17427          ELSE
 17428            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17429      ELSE
 17430         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17431
 17432*    if pb-company-id = 'VPP'
 17433*       perform 8150-read-elcrtt thru 8150-exit
 17434*       if ws-vehicle-odometer numeric
 17435*          if ws-vehicle-odometer > 6000
 17436*             move er-1583       to ws-error
 17437*             PERFORM 9900-ERROR-FORMAT
 17438*                                THRU 9900-EXIT
 17439*          end-if
 17440*       end-if
 17441*    end-if
 17442     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17443        IF ((PB-COMPANY-ID = 'DCC')
 17444           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17445                         or
 17446            (pb-company-id = 'CID' or 'VPP')
 17447            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17448        END-IF
 17449     END-IF.
 17450
 17451     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17452         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17453     END-IF.
 17454     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 314
* EL050.cbl
 17455     perform 8150-read-elcrtt    thru 8150-exit
 17456     if ws-ins-age-defaulted = 'Y'
 17457        move er-1573             to ws-error
 17458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17459     end-if
 17460
 17461     if ws-jnt-age-defaulted = 'Y'
 17462        move er-1574             to ws-error
 17463        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17464     end-if
 17465***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17466***                                                           ****
 17467***  Set an error if the state requires verification of agent ****
 17468***  and agent hasn't verified yet and the status is not =    ****
 17469***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17470***  and the entry date > 09/01/2015.                         ****
 17471***                                                           ****
 17472***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17473     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17474        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17475        and (pb-account (9:2) not = 'OB')
 17476        if (ws-st-agent-sig-edit = 'Y')
 17477           and (am-report-code-1 not = 'CONLEY')
 17478           evaluate true
 17479              when cs-agent-edit-status = 'C'
 17480                 move er-1743    to ws-error
 17481                 perform 9900-error-format
 17482                                 thru 9900-exit
 17483              when cs-agent-edit-status = 'S'
 17484                 move er-1744    to ws-error
 17485                 perform 9900-error-format
 17486                                 thru 9900-exit
 17487              when cs-agent-edit-status = 'M'
 17488                 move er-1745    to ws-error
 17489                 perform 9900-error-format
 17490                                 thru 9900-exit
 17491              when cs-agent-edit-status = 'R'
 17492                 move er-1747    to ws-error
 17493                 perform 9900-error-format
 17494                                 thru 9900-exit
 17495              when cs-agent-edit-status = 'N'
 17496                 move er-1748    to ws-error
 17497                 perform 9900-error-format
 17498                                 thru 9900-exit
 17499              when cs-agent-edit-status <> 'V' and 'U' and
 17500                                           'R' and 'N'
 17501                 move er-1746    to ws-error
 17502                 perform 9900-error-format
 17503                                 thru 9900-exit
 17504           end-evaluate
 17505        end-if
 17506     end-if
 17507     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17508     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17509        AND (WS-NO-SECURE-PAY))
 17510                  OR
 17511        (WS-LF-SPECIAL-CALC-CD = 'O'
 17512        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 315
* EL050.cbl
 17513        SET SKIP-ADDR-EDIT       TO TRUE
 17514     END-IF
 17515     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17516        AND (NOT SKIP-ADDR-EDIT)
 17517        MOVE ER-2963             TO WS-ERROR
 17518        PERFORM 9900-ERROR-FORMAT
 17519                                 THRU 9900-EXIT
 17520        GO TO 9990-RETURN
 17521     END-IF
 17522     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17523     IF ERPNDM-FOUND NOT = 'X'
 17524        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17525           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17526           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17527           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17528           AND (NOT SKIP-ADDR-EDIT)
 17529           MOVE ER-2694          TO WS-ERROR
 17530           PERFORM 9900-ERROR-FORMAT
 17531                                 THRU 9900-EXIT
 17532        END-IF
 17533        MOVE ' '                 TO STATE-RECORD-ERROR
 17534        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17535        MOVE PM-STATE            TO CNTL-ACCESS
 17536        MOVE '3'                 TO CNTL-REC-TYPE
 17537        MOVE +0                  TO CNTL-SEQ-NO
 17538        MOVE '0'                 TO RC-SW-2
 17539        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17540        IF (NO-STATE-RECORD)
 17541           OR (CF-RECORD-TYPE NOT = '3')
 17542           OR (PM-STATE NOT = CF-STATE-CODE)
 17543           IF (PM-STATE = SPACES)
 17544              AND (SKIP-ADDR-EDIT)
 17545              CONTINUE
 17546           ELSE
 17547              MOVE ER-2963       TO WS-ERROR
 17548              PERFORM 9900-ERROR-FORMAT
 17549                                 THRU 9900-EXIT
 17550           END-IF
 17551        END-IF
 17552        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17553           MOVE ER-2883          TO WS-ERROR
 17554           PERFORM 9900-ERROR-FORMAT
 17555                                 THRU 9900-EXIT
 17556        END-IF
 17557        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17558           MOVE ' '                 TO STATE-RECORD-ERROR
 17559           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17560           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17561           MOVE '3'                 TO CNTL-REC-TYPE
 17562           MOVE +0                  TO CNTL-SEQ-NO
 17563           MOVE '0'                 TO RC-SW-2
 17564           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17565           IF NO-STATE-RECORD
 17566              OR (CF-RECORD-TYPE NOT = '3')
 17567              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17568              MOVE ER-2964          TO WS-ERROR
 17569              PERFORM 9900-ERROR-FORMAT
 17570                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 316
* EL050.cbl
 17571           END-IF
 17572        END-IF
 17573     ELSE
 17574        IF NOT SKIP-ADDR-EDIT
 17575           MOVE ER-2393          TO WS-ERROR
 17576           PERFORM 9900-ERROR-FORMAT
 17577                                 THRU 9900-EXIT
 17578        END-IF
 17579     END-IF
 17580
 17581     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17582
 17583     IF (ERMAIL-FOUND = ' ' AND
 17584        ERPNDM-FOUND = ' ')
 17585        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17586           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17587           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17588          OR
 17589           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17590          OR
 17591           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17592           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17593           GO TO 3999-UNLOCK-ERMAIL.
 17594
 17595     IF ERPNDM-FOUND = 'X'
 17596        GO TO 3999-UNLOCK-ERMAIL.
 17597
 17598     IF PM-INSURED-LAST-NAME      = SPACES
 17599        AND PM-INSURED-FIRST-NAME = SPACES
 17600        AND PM-ADDRESS-LINE-1     = SPACES
 17601        AND PM-ADDRESS-LINE-2     = SPACES
 17602        AND PM-CITY-STATE         = SPACES
 17603        AND PM-CRED-BENE-NAME     = SPACES
 17604        AND PM-CRED-BENE-ADDR     = SPACES
 17605        AND PM-CRED-BENE-CTYST    = SPACES
 17606        GO TO 3999-UNLOCK-ERMAIL
 17607     END-IF
 17608
 17609     MOVE SPACES                 TO MAILING-DATA.
 17610
 17611     MOVE 'MA'                   TO MA-RECORD-ID.
 17612     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17613     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17614     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17615     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17616     MOVE PB-SV-STATE            TO MA-STATE.
 17617     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17618     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17619
 17620     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17621     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17622
 17623     IF ERMAIL-FOUND = ' '
 17624        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17625     ELSE
 17626        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17627        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17628        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 317
* EL050.cbl
 17629
 17630     GO TO 9990-RETURN.
 17631
 17632 3999-UNLOCK-ERMAIL.
 17633     IF ERMAIL-FOUND = ' '
 17634        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17635
 17636     GO TO 9990-RETURN.
 17637******************************************************************
 17638
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 318
* EL050.cbl
 17640 4000-UPDATE-CANCELLED-CERT.
 17641     IF CERT-WAS-NOT-FOUND
 17642        GO TO 4299-EXIT.
 17643
 17644*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17645     IF PB-C-NH-INT-ON-REFS > ZEROS
 17646        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17647     END-IF
 17648     IF PB-C-REF-INTERFACE-SW = 'Y'
 17649        MOVE PB-C-REF-INTERFACE-SW
 17650                                 TO CM-NH-INTERFACE-SW
 17651     END-IF
 17652     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17653     IF ERMAIL-FOUND = 'X'
 17654        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17655        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17656        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17657        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17658           MOVE ER-2694          TO WS-ERROR
 17659           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17660     END-IF
 17661
 17662     IF PB-C-POST-CARD-IND = 'Y'
 17663        MOVE +8                  TO SUB
 17664*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17665        IF ERMAIL-FOUND = ' '
 17666           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17667              (SUB > +7)
 17668              OR (MA-MAIL-STATUS (SUB) = '1')
 17669           END-PERFORM
 17670        END-IF
 17671        IF (SUB > +7)
 17672           OR (ERMAIL-FOUND = 'X')
 17673           MOVE ER-3789          TO WS-ERROR
 17674           PERFORM 9900-ERROR-FORMAT
 17675                                 THRU 9900-EXIT
 17676        END-IF
 17677     ELSE
 17678        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17679     END-IF
 17680
 17681     IF ERMAIL-FOUND = ' '
 17682        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17683     END-IF.
 17684
 17685     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17686
 17687     IF PB-CI-OB-FLAG = 'Z'
 17688        GO TO 4150-SUMMARY-CERT-CANCEL.
 17689
 17690     IF PB-C-LF-CANCEL-VOIDED
 17691         PERFORM 4200-REVERSE-LF-CANCEL.
 17692     IF PB-C-AH-CANCEL-VOIDED
 17693         PERFORM 4200-REVERSE-AH-CANCEL.
 17694
 17695 4100-APPLY-LF-CANCEL.
 17696
 17697     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 319
* EL050.cbl
 17698
 17699 4100-CHECK-LF-ERRORS.
 17700
 17701     ADD +1                       TO WS-SUB.
 17702
 17703     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17704        IF LF-COVERAGE-CANCELLED
 17705           GO TO 4100-LF-CANCEL-CONT
 17706        ELSE
 17707           GO TO 4100-UPDATE-LF-COVERAGE.
 17708
 17709     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17710                                   ER-2729 OR
 17711                                   ER-2730 OR
 17712                                   ER-2731 OR
 17713                                   ER-2732 OR
 17714                                   ER-2737 OR
 17715                                   ER-2740 OR
 17716                                   ER-2743 OR
 17717                                   ER-2749 OR
 17718                                   ER-2750 OR
 17719                                   ER-2755 OR
 17720                                   ER-2757 OR
 17721                                   ER-2760 OR
 17722                                   ER-2772 OR
 17723                                   ER-2774 OR
 17724                                   ER-2776 OR
 17725                                   ER-2794
 17726        GO TO 4100-UPDATE-LF-COVERAGE.
 17727
 17728     GO TO 4100-CHECK-LF-ERRORS.
 17729
 17730 4100-UPDATE-LF-COVERAGE.
 17731
 17732     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17733     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17734     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17735        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17736     END-IF
 17737     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17738                                      TO CM-CREDIT-INTERFACE-SW-2.
 17739     IF CM-LF-CANCEL-DT = LOW-VALUE
 17740         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17741
 17742     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17743         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17744                                         CM-LF-STATUS-AT-CANCEL.
 17745
 17746     GO TO 4100-APPLY-AH-CANCEL.
 17747
 17748 4100-LF-CANCEL-CONT.
 17749     IF PB-C-LF-CANCEL-VOIDED
 17750         GO TO 4100-APPLY-AH-CANCEL.
 17751
 17752     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17753         GO TO 4100-APPLY-AH-CANCEL.
 17754
 17755     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 320
* EL050.cbl
 17756        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17757           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17758        ELSE
 17759           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17760
 17761     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17762     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17763
 17764     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17765         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17766
 17767     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17768        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17769         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17770         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17771
 17772     IF PB-RECORD-RETURNED
 17773        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17774      ELSE
 17775        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17776
 17777 4100-APPLY-AH-CANCEL.
 17778
 17779     MOVE +0                      TO WS-SUB.
 17780
 17781 4100-CHECK-AH-ERRORS.
 17782
 17783     ADD +1                       TO WS-SUB.
 17784
 17785     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17786        IF AH-COVERAGE-CANCELLED
 17787           GO TO 4100-AH-CANCEL-CONT
 17788        ELSE
 17789           GO TO 4100-UPDATE-AH-COVERAGE.
 17790
 17791     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17792                                   ER-2729 OR
 17793                                   ER-2732 OR
 17794                                   ER-2737 OR
 17795                                   ER-2740 OR
 17796                                   ER-2744 OR
 17797                                   ER-2749 OR
 17798                                   ER-2750 OR
 17799                                   ER-2755 OR
 17800                                   ER-2757 OR
 17801                                   ER-2760 OR
 17802                                   ER-2771 OR
 17803                                   ER-2772 OR
 17804                                   ER-2773 OR
 17805                                   ER-2775 OR
 17806                                   ER-2777 OR
 17807                                   ER-2778 OR
 17808                                   ER-2794
 17809        GO TO 4100-UPDATE-AH-COVERAGE.
 17810
 17811     GO TO 4100-CHECK-AH-ERRORS.
 17812
 17813 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 321
* EL050.cbl
 17814
 17815     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17816     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17817     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17818     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17819                                      TO CM-CREDIT-INTERFACE-SW-2.
 17820     IF CM-AH-CANCEL-DT = LOW-VALUE
 17821         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17822
 17823     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17824         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17825                                         CM-AH-STATUS-AT-CANCEL.
 17826
 17827     IF LF-COVERAGE-CANCELLED
 17828         IF PB-RECORD-RETURNED
 17829              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17830          ELSE
 17831              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17832
 17833     GO TO 4299-EXIT.
 17834
 17835 4100-AH-CANCEL-CONT.
 17836     IF PB-C-AH-CANCEL-VOIDED
 17837         GO TO 4299-EXIT.
 17838
 17839     if cm-credit-interface-sw-2 = ' '
 17840        if pb-fatal-errors or pb-unforced-errors
 17841           move '4'              to cm-credit-interface-sw-2
 17842        else
 17843           move '1'              to cm-credit-interface-sw-2
 17844        end-if
 17845     end-if
 17846     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17847         GO TO 4299-EXIT.
 17848
 17849     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17850        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17851           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17852        ELSE
 17853           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17854
 17855     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17856     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17857
 17858     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17859         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17860
 17861     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17862         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17863         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17864
 17865     IF PB-RECORD-RETURNED
 17866        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17867      ELSE
 17868        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17869
 17870     GO TO 4299-EXIT.
 17871
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 322
* EL050.cbl
 17872 4150-SUMMARY-CERT-CANCEL.
 17873     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17874
 17875     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17876        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17877                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17878     ELSE
 17879        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17880                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17881
 17882     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17883        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17884                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17885     ELSE
 17886        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17887                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17888
 17889     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17890        NEXT SENTENCE
 17891     ELSE
 17892        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17893
 17894     GO TO 4299-EXIT.
 17895
 17896 4200-REVERSE-LF-CANCEL.
 17897     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17898
 17899     IF CM-LF-CANCEL-APPLIED
 17900        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17901        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17902        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17903
 17904     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17905
 17906     IF PB-RECORD-RETURNED
 17907        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17908       ELSE
 17909        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17910
 17911 4200-REVERSE-LF-EXIT.
 17912       EXIT.
 17913
 17914 4200-REVERSE-AH-CANCEL.
 17915     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17916
 17917     IF CM-AH-CANCEL-APPLIED
 17918        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17919        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17920        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17921
 17922     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17923
 17924     IF PB-RECORD-RETURNED
 17925        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17926       ELSE
 17927        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17928
 17929 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 323
* EL050.cbl
 17930       EXIT.
 17931
 17932 4299-EXIT.
 17933       EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 324
* EL050.cbl
 17935
 17936 4500-UPDATE-NEW-CERT.
 17937     IF CERT-WAS-FOUND
 17938         NEXT SENTENCE
 17939       ELSE
 17940         GO TO 4520-BUILD-NEW-KEY.
 17941
 17942     IF  CLASIC-CREATED-CERT
 17943         GO TO 4999-EXIT.
 17944
 17945     IF  CERT-WAS-CREATED-FOR-CLAIM
 17946         GO TO 4520-BUILD-NEW-KEY.
 17947
 17948     IF CERT-ADDED-BATCH
 17949        IF CM-RECORD-ID = 'CM'
 17950            GO TO 4999-EXIT.
 17951
 17952 4520-BUILD-NEW-KEY.
 17953* BUILD CONTROL PRIMARY
 17954
 17955     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17956                                       CM-COMPANY-CD-A1
 17957                                       CM-COMPANY-CD-A2
 17958                                       CM-COMPANY-CD-A4
 17959                                       CM-COMPANY-CD-A5.
 17960
 17961     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17962     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17963     MOVE PB-SV-STATE               TO CM-STATE.
 17964     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17965     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17966     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17967     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17968
 17969     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17970
 17971     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17972     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17973     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17974     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17975
 17976     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17977        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17978
 17979     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17980         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17981         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17982         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17983         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17984     ELSE
 17985         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17986
 17987     IF PB-COMPANY-ID   EQUAL  'CRI'
 17988         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17989         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17990         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17991         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17992         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 325
* EL050.cbl
 17993
 17994     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17995        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17996         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17997
 17998     IF PB-COMPANY-ID  = 'LBL'
 17999        IF PB-I-JOINT-COVERAGE
 18000            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18001                                           PB-I-MEMBER-NO
 18002            GO TO 4550-CONT-CERT-PROCESS.
 18003
 18004     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18005        NEXT SENTENCE
 18006     ELSE
 18007        GO TO 4540-BUILD-MEMBER-NO.
 18008
 18009******************************************************************
 18010*                                                                *
 18011*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18012*    FOR 'MON'.                                                  *
 18013*                                                                *
 18014******************************************************************
 18015
 18016     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18017     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18018     MOVE +1                     TO WS-SUB1
 18019                                    WS-SUB2.
 18020
 18021 4530-EDIT-MEMB-NAME.
 18022
 18023     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18024        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18025        ADD +1                       TO WS-SUB2.
 18026
 18027     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18028        ADD +1                       TO WS-SUB1
 18029        GO TO 4530-EDIT-MEMB-NAME.
 18030
 18031     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18032     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18033     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18034*    MOVE SPACE                      TO DC-OPTION-CODE.
 18035     SET  BIN-TO-GREG                TO TRUE.
 18036     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18037     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18038
 18039     GO TO 4550-CONT-CERT-PROCESS.
 18040
 18041******************************************************************
 18042*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18043******************************************************************
 18044
 18045 4540-BUILD-MEMBER-NO.
 18046
 18047     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18048         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18049         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18050         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 326
* EL050.cbl
 18051         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18052     ELSE
 18053         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18054
 18055     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18056        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18057         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18058
 18059 4550-CONT-CERT-PROCESS.
 18060
 18061*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18062*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18063*    ELSE
 18064*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18065
 18066     IF CERT-WAS-CREATED-FOR-CLAIM
 18067        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18068        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18069
 18070     IF CERT-AND-CLAIM-ONLINE
 18071        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18072        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18073
 18074     MOVE 'CM'                     TO CM-RECORD-ID.
 18075     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18076
 18077     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18078        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18079        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18080     ELSE
 18081        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18082        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18083
 18084     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18085     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18086     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18087     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18088     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18089     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18090     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18091                                      CM-LF-ITD-CANCEL-AMT
 18092                                      CM-LF-ITD-DEATH-AMT
 18093                                      CM-AH-ITD-AH-PMT
 18094                                      CM-AH-ITD-LUMP-PMT
 18095                                      CM-AH-ITD-CANCEL-AMT
 18096                                      CM-LF-NSP-PREMIUM-AMT
 18097                                      CM-AH-NSP-PREMIUM-AMT.
 18098*                                     CM-CLAIM-DEDUCT-WITHHELD
 18099*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18100     if pb-i-loan-apr = +99.9999
 18101        move zeros                 to cm-loan-apr
 18102     else
 18103        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18104     end-if
 18105     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18106     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18107     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18108     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 327
* EL050.cbl
 18109     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18110     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18111     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18112     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18113     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18114     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18115     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18116
 18117     IF PB-I-LIVES NOT NUMERIC
 18118         MOVE ZERO                 TO PB-I-LIVES.
 18119
 18120     IF PB-I-NUM-BILLED NOT NUMERIC
 18121         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18122
 18123     MOVE PB-I-LIVES               TO CM-LIVES.
 18124     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18125
 18126     IF PB-COMPANY-ID EQUAL  'DMD'
 18127         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18128         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18129
 18130     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18131     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18132     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18133     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18134     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18135     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18136
 18137     IF PB-I-LF-POLICY-FEE NUMERIC
 18138        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18139     ELSE
 18140        MOVE +0                    TO CM-LF-POLICY-FEE.
 18141
 18142     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18143        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18144        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18145     ELSE
 18146        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18147
 18148     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18149     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18150     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18151     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18152     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18153     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18154     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18155     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18156     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18157
 18158     IF PB-I-CANCEL-FEE NUMERIC
 18159        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18160     ELSE
 18161        MOVE +0                  TO CM-CANCEL-FEE
 18162     END-IF
 18163
 18164     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18165        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18166     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 328
* EL050.cbl
 18167        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18168
 18169     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18170     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18171
 18172     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18173                                      CM-LF-DEATH-EXIT-DT
 18174                                      CM-AH-SETTLEMENT-EXIT-DT.
 18175
 18176*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18177*                       'TIH' OR 'OFL' OR 'FLA' OR
 18178*                       'TII' OR 'TMS' OR 'CRI' OR
 18179*                       'NCL'
 18180     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18181
 18182     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18183         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18184            MOVE '2'                TO CM-PREMIUM-TYPE.
 18185
 18186     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18187         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18188            MOVE '2'                TO CM-PREMIUM-TYPE.
 18189
 18190     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18191         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18192     ELSE
 18193         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18194         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18195
 18196     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18197     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18198     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18199     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18200     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18201     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18202     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18203     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18204
 18205     IF PB-NO-MONTHS-SKIPPED
 18206         MOVE SPACE                 TO CM-SKIP-CODE
 18207     ELSE
 18208         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18209
 18210     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18211     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18212                                       CM-LF-STATUS-AT-CANCEL.
 18213
 18214     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18215     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18216                                       CM-AH-STATUS-AT-CANCEL.
 18217
 18218     MOVE '1'                       TO CM-ENTRY-STATUS.
 18219
 18220     IF PB-REISSUED-CERT
 18221        MOVE '5'                    TO CM-ENTRY-STATUS.
 18222
 18223     IF PB-MONTHLY-CERT
 18224        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 329
* EL050.cbl
 18225
 18226     IF PB-CASH-CERT
 18227        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18228
 18229     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18230     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18231     IF PB-POLICY-IS-DECLINED
 18232        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18233
 18234     IF PB-POLICY-IS-VOIDED
 18235        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18236
 18237     IF PB-NEEDS-UNDERWRITING
 18238        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18239
 18240     IF PB-REIN-ONLY-CERT
 18241        MOVE '9'                    TO CM-ENTRY-STATUS.
 18242
 18243     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18244         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18245     ELSE
 18246         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18247
 18248     IF PB-RECORD-RETURNED
 18249        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18250      ELSE
 18251        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18252
 18253     IF PB-I-MAIL-ADDRS-PRESENT
 18254        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18255
 18256     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18257                                       CM-ENTRY-DT.
 18258
 18259 4999-EXIT.
 18260     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 330
* EL050.cbl
 18262
 18263 5000-PROCESS-REPS.
 18264     MOVE ' '                    TO AGTC-MASTER-SW
 18265     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18266     MOVE CO-TYPE                TO AGTC-TYPE
 18267     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18268     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18269     IF (AGTC-MASTER-SW NOT = 'N')
 18270        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18271        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18272        PERFORM 8583-READ-ERAGTC-NEXT
 18273                                 THRU 8583-EXIT
 18274     END-IF
 18275     IF AGTC-MASTER-SW = 'N'
 18276        CONTINUE
 18277     ELSE
 18278        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18279           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18280              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18281              MOVE 'Y'           TO AGTC-MASTER-SW
 18282           END-IF
 18283        END-IF
 18284     END-IF
 18285     .
 18286 5000-EXIT.
 18287     EXIT.
 18288 6370-EDIT-INPUT-LF-CODE.
 18289     move ' ' to ws-benefit-cd-chg-sw
 18290     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18291        MOVE +1                  TO SUB
 18292        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18293        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18294        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18295        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18296        GO TO 6370-SEARCH-LOOP.
 18297
 18298     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18299
 18300     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18301     MOVE SPACES                 TO CNTL-ACCESS.
 18302*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18303     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18304     MOVE +0                     TO CNTL-SEQ-NO.
 18305     MOVE '4' TO RC-SW-2.
 18306     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18307
 18308     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18309        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18310        GO TO 6370-NO-LF-FOUND.
 18311
 18312     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18313     MOVE +1                     TO SUB.
 18314
 18315 6370-SEARCH-LOOP.
 18316     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18317         GO TO 6370-NO-LF-FOUND.
 18318
 18319     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 331
* EL050.cbl
 18320        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18321           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18322           set benefit-code-chg to true
 18323        end-if
 18324        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18325        GO TO 6370-HER-NET-PAY-CHECK.
 18326
 18327     ADD 1   TO SUB.
 18328*    IF SUB GREATER 120
 18329     IF SUB GREATER 200
 18330         GO TO 6370-NO-LF-FOUND.
 18331
 18332     GO TO 6370-SEARCH-LOOP.
 18333
 18334 6370-NO-LF-FOUND.
 18335
 18336     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18337        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18338        set benefit-code-chg to true
 18339     end-if
 18340     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18341
 18342 6370-HER-NET-PAY-CHECK.
 18343
 18344     IF PB-COMPANY-ID = 'CID'
 18345        IF PB-SV-STATE = 'CA' OR 'MN'
 18346           IF PB-I-LF-BENEFIT-CD = '02'
 18347              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18348           ELSE
 18349              IF PB-I-LF-BENEFIT-CD = '04'
 18350                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18351              END-IF
 18352           END-IF
 18353        END-IF
 18354     END-IF
 18355
 18356     IF PB-COMPANY-ID NOT = 'HER'
 18357         GO TO 6370-EXIT.
 18358
 18359     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18360         GO TO 6370-EXIT.
 18361
 18362     IF PB-I-LF-TERM NOT NUMERIC
 18363         MOVE ZEROS              TO PB-I-LF-TERM.
 18364
 18365     IF PB-I-LOAN-TERM NOT NUMERIC
 18366         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18367
 18368     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18369         GO TO 6370-EXIT.
 18370
 18371     IF PB-I-LF-BENEFIT-CD = '33'
 18372         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18373
 18374     IF PB-I-LF-BENEFIT-CD = '34'
 18375         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18376
 18377 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 332
* EL050.cbl
 18378     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 333
* EL050.cbl
 18380
 18381 6380-EDIT-INPUT-AH-CODE.
 18382     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18383        MOVE +1                  TO SUB
 18384        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18385        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18386        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18387        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18388        GO TO 6380-SEARCH-LOOP.
 18389
 18390     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18391
 18392     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18393     MOVE SPACES                 TO CNTL-ACCESS.
 18394     MOVE 'A'                    TO CNTL-REC-TYPE.
 18395*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18396     MOVE +0                     TO CNTL-SEQ-NO.
 18397     MOVE '5' TO RC-SW-2.
 18398     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18399
 18400     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18401        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18402        GO TO 6380-NO-AH-FOUND.
 18403
 18404     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18405     MOVE +1 TO SUB.
 18406
 18407 6380-SEARCH-LOOP.
 18408     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18409         GO TO 6380-NO-AH-FOUND.
 18410
 18411     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18412         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18413         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18414
 18415     ADD 1   TO SUB.
 18416     IF SUB GREATER THAN 96
 18417*    IF SUB GREATER THAN 300
 18418         GO TO 6380-NO-AH-FOUND.
 18419
 18420     GO TO 6380-SEARCH-LOOP.
 18421
 18422 6380-NO-AH-FOUND.
 18423
 18424     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18425
 18426     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18427         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18428     ELSE
 18429         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18430
 18431 6380-CSO-AH-ONLY-CHECKS.
 18432
 18433     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18434        NEXT SENTENCE
 18435      ELSE
 18436        GO TO 6380-EXIT.
 18437
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 334
* EL050.cbl
 18438     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18439         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18440
 18441
 18442     GO TO 6380-EXIT
 18443     .
 18444 6380-CSO-LIFE-WITH-AH-CHECKS.
 18445
 18446
 18447     .
 18448 6380-EXIT.
 18449     EXIT.
 18450
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 335
* EL050.cbl
 18452
 18453 6400-COMPUTE-EXTENSION-DAYS.
 18454
 18455******************************************************************
 18456*                                                                *
 18457*                   COMPUTE EXTENSION DAYS                       *
 18458*                                                                *
 18459*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18460*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18461*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18462*    THE EXTENSION DAYS.                                         *
 18463*                                                                *
 18464******************************************************************
 18465
 18466     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18467     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18468
 18469******************************************************************
 18470*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18471*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18472******************************************************************
 18473
 18474     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18475        COMPUTE WS-ODD-DAYS-OVER =
 18476               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18477     ELSE
 18478        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18479
 18480     IF WS-ODD-DAYS-OVER = ZEROS
 18481           GO TO 6499-EXIT
 18482     ELSE
 18483        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18484           IF WS-WDF-MONTH = 02
 18485              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18486              ADD 2       TO  WS-ODD-DAYS-OVER
 18487              GO TO 6499-EXIT
 18488           ELSE
 18489              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18490                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18491                 GO TO 6499-EXIT
 18492               ELSE
 18493                 GO TO 6499-EXIT
 18494        ELSE
 18495           GO TO 6499-EXIT.
 18496
 18497 6412-CHECK-TO-DAY.
 18498
 18499        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18500           IF WS-WDT-DAY = 28
 18501              ADD 2              TO WS-ODD-DAYS-OVER
 18502           ELSE
 18503              IF WS-WDT-DAY = 29
 18504                 ADD 1           TO WS-ODD-DAYS-OVER
 18505              ELSE
 18506                 NEXT SENTENCE
 18507        ELSE
 18508           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18509              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 336
* EL050.cbl
 18510
 18511     GO TO 6499-EXIT.
 18512
 18513
 18514 6415-CHECK-LEAP-YEAR.
 18515
 18516     IF DC-DAYS-IN-MONTH = 29
 18517        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18518
 18519 6415-EXIT.
 18520     EXIT.
 18521
 18522 6499-EXIT.
 18523      EXIT.
 18524
 18525 6500-END.
 18526     EXIT.
 18527
 18528
 18529******************************************************************
 18530************* PROCEDURE DIVISION FOR EL050 ***********************
 18531********************** ELC50PD END *******************************
 18532
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 337
* EL050.cbl
 18534
 18535**START***********************************************************
 18536*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18537*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18538******************************************************************
 18539*
 18540 6600-GET-STATE-MUNICIPAL-TAX.
 18541
 18542     IF PB-COMPANY-ID NOT = 'DMD'
 18543         GO TO 6640-EXIT.
 18544
 18545     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18546     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18547     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18548*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18549*
 18550***  Y2K PROJ 7744
 18551     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18552     SET BIN-TO-GREG          TO TRUE.
 18553     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18554
 18555     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18556
 18557     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18558     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18559
 18560
 18561* EXEC CICS HANDLE CONDITION
 18562*        INVREQ    (6610-START-BROWSE)
 18563*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18564*        NOTFND    (6630-END-OF-FILE)
 18565*    END-EXEC.
 18566*    MOVE '"$8JI                 ! # #00018550' TO DFHEIV0
 18567     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18569     MOVE X'2320233030303138353530' TO DFHEIV0(25:11)
 18570     CALL 'kxdfhei1' USING DFHEIV0
 18571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18572
 18573
 18574 6610-START-BROWSE.
 18575
 18576
 18577* EXEC CICS HANDLE CONDITION
 18578*        NOTFND    (6630-END-OF-FILE)
 18579*        DISABLED  (6630-ERRESS-PROBLEM)
 18580*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18581*        ENDFILE   (6630-END-OF-FILE)
 18582*    END-EXEC.
 18583*    MOVE '"$IcJ''                ! $ #00018558' TO DFHEIV0
 18584     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18586     MOVE X'2420233030303138353538' TO DFHEIV0(25:11)
 18587     CALL 'kxdfhei1' USING DFHEIV0
 18588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18589
 18590
 18591
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 338
* EL050.cbl
 18592* EXEC CICS STARTBR
 18593*        DATASET (FILE-ID-ERRESS)
 18594*        RIDFLD  (WS-ERRESS-KEY)
 18595*        GTEQ
 18596*    END-EXEC.
 18597     MOVE 0
 18598       TO DFHEIV11
 18599*    MOVE '&,         G          &   #00018565' TO DFHEIV0
 18600     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18601     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18602     MOVE X'2020233030303138353635' TO DFHEIV0(25:11)
 18603     CALL 'kxdfhei1' USING DFHEIV0,
 18604           FILE-ID-ERRESS,
 18605           WS-ERRESS-KEY,
 18606           DFHEIV99,
 18607           DFHEIV11,
 18608           DFHEIV99
 18609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18610
 18611
 18612 6620-READ-NEXT-ERRESS-MASTER.
 18613
 18614
 18615* EXEC CICS HANDLE CONDITION
 18616*        NOTFND    (6630-END-OF-FILE)
 18617*        ENDFILE   (6630-END-OF-FILE)
 18618*        DISABLED  (6630-ERRESS-PROBLEM)
 18619*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18620*    END-EXEC.
 18621*    MOVE '"$I''cJ                ! % #00018573' TO DFHEIV0
 18622     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18624     MOVE X'2520233030303138353733' TO DFHEIV0(25:11)
 18625     CALL 'kxdfhei1' USING DFHEIV0
 18626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18627
 18628
 18629
 18630* EXEC CICS READNEXT
 18631*        DATASET (FILE-ID-ERRESS)
 18632*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18633*        RIDFLD  (WS-ERRESS-KEY)
 18634*    END-EXEC.
 18635     MOVE LENGTH OF
 18636      RESIDENT-STATE-TAX-MASTER
 18637       TO DFHEIV12
 18638     MOVE 0
 18639       TO DFHEIV11
 18640*    MOVE '&.IL                  )   #00018580' TO DFHEIV0
 18641     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18642     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18643     MOVE X'2020233030303138353830' TO DFHEIV0(25:11)
 18644     CALL 'kxdfhei1' USING DFHEIV0,
 18645           FILE-ID-ERRESS,
 18646           RESIDENT-STATE-TAX-MASTER,
 18647           DFHEIV12,
 18648           WS-ERRESS-KEY,
 18649           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 339
* EL050.cbl
 18650           DFHEIV11,
 18651           DFHEIV99,
 18652           DFHEIV99
 18653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18654
 18655
 18656     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18657
 18658* EXEC CICS ENDBR
 18659*            DATASET (FILE-ID-ERRESS)
 18660*       END-EXEC
 18661     MOVE 0
 18662       TO DFHEIV11
 18663*    MOVE '&2                    $   #00018587' TO DFHEIV0
 18664     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18665     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18666     MOVE X'2020233030303138353837' TO DFHEIV0(25:11)
 18667     CALL 'kxdfhei1' USING DFHEIV0,
 18668           FILE-ID-ERRESS,
 18669           DFHEIV11,
 18670           DFHEIV99
 18671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18672        GO TO 6630-END-OF-FILE.
 18673
 18674     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18675        NEXT SENTENCE
 18676      ELSE
 18677        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18678
 18679*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18680*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18681*
 18682     MOVE +2                     TO WS-SUB1.
 18683
 18684     IF PB-ISSUE
 18685     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18686        MOVE +1                  TO WS-SUB1.
 18687
 18688     IF PB-CANCELLATION
 18689     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18690        MOVE +1                  TO WS-SUB1.
 18691*
 18692*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18693*
 18694***  Y2K PROJ 7744
 18695     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18696***  Y2K PROJ 7744
 18697
 18698*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18699* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18700* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18701
 18702     ADD 1                    TO WS-YEAR-YY.
 18703
 18704     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18705         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18706                              TO WS-RES-STATE-TAX
 18707         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 340
* EL050.cbl
 18708                              TO WS-RES-MUNI-TAX
 18709     ELSE
 18710         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18711                              TO WS-RES-STATE-TAX
 18712         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18713                              TO WS-RES-MUNI-TAX.
 18714
 18715*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18716
 18717     IF PB-CANCELLATION
 18718         GO TO 6640-CANCEL-TAX.
 18719
 18720     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18721         COMPUTE PB-I-STATE-TAX ROUNDED =
 18722                                   PB-I-LF-PREMIUM-AMT
 18723                                 * WS-RES-STATE-TAX
 18724         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18725                                   PB-I-LF-PREMIUM-AMT
 18726                                 * WS-RES-MUNI-TAX
 18727     ELSE
 18728     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18729         COMPUTE PB-I-STATE-TAX ROUNDED =
 18730                                   PB-I-AH-PREMIUM-AMT
 18731                                 * WS-RES-STATE-TAX
 18732         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18733                                   PB-I-AH-PREMIUM-AMT
 18734                                 * WS-RES-MUNI-TAX.
 18735
 18736
 18737* EXEC CICS ENDBR
 18738*         DATASET (FILE-ID-ERRESS)
 18739*    END-EXEC.
 18740     MOVE 0
 18741       TO DFHEIV11
 18742*    MOVE '&2                    $   #00018654' TO DFHEIV0
 18743     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18744     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18745     MOVE X'2020233030303138363534' TO DFHEIV0(25:11)
 18746     CALL 'kxdfhei1' USING DFHEIV0,
 18747           FILE-ID-ERRESS,
 18748           DFHEIV11,
 18749           DFHEIV99
 18750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18751
 18752
 18753     GO TO 6640-EXIT.
 18754
 18755 6640-CANCEL-TAX.
 18756     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18757
 18758     IF PB-C-LF-CANCEL-AMT > ZEROS
 18759         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18760                                   PB-C-LF-CANCEL-AMT
 18761                                 * WS-RES-STATE-TAX
 18762         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18763                                   PB-C-LF-CANCEL-AMT
 18764                                *  WS-RES-MUNI-TAX
 18765     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 341
* EL050.cbl
 18766     IF PB-C-AH-CANCEL-AMT > ZEROS
 18767         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18768                                   PB-C-AH-CANCEL-AMT
 18769                                 * WS-RES-STATE-TAX
 18770         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18771                                   PB-C-AH-CANCEL-AMT
 18772                                *  WS-RES-MUNI-TAX.
 18773
 18774
 18775* EXEC CICS ENDBR
 18776*         DATASET (FILE-ID-ERRESS)
 18777*    END-EXEC.
 18778     MOVE 0
 18779       TO DFHEIV11
 18780*    MOVE '&2                    $   #00018679' TO DFHEIV0
 18781     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18783     MOVE X'2020233030303138363739' TO DFHEIV0(25:11)
 18784     CALL 'kxdfhei1' USING DFHEIV0,
 18785           FILE-ID-ERRESS,
 18786           DFHEIV11,
 18787           DFHEIV99
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18789
 18790
 18791     GO TO 6640-EXIT.
 18792
 18793 6630-END-OF-FILE.
 18794     MOVE ER-8002              TO WS-ERROR.
 18795     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18796
 18797     GO TO 6640-EXIT.
 18798
 18799 6630-ERRESS-PROBLEM.
 18800     MOVE ER-8044              TO WS-ERROR.
 18801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18802
 18803 6640-EXIT.
 18804     EXIT.
 18805
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 342
* EL050.cbl
 18807 6650-GET-RES-STATE-COMM.
 18808
 18809     IF PB-COMPANY-ID NOT = 'DMD'
 18810         GO TO 6700-COMM-EXIT.
 18811
 18812     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18813     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18814     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18815     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18816     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18817     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18818     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18819
 18820*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18821*
 18822***  Y2K PROJ 7744
 18823     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18824     SET BIN-TO-GREG          TO TRUE.
 18825     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18826
 18827     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18828***  Y2K PROJ 7744
 18829
 18830     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18831
 18832
 18833* EXEC CICS HANDLE CONDITION
 18834*        INVREQ    (6660-START-BROWSE)
 18835*        DISABLED  (6690-ERRESC-PROBLEM)
 18836*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18837*        NOTFND    (6690-END-OF-FILE)
 18838*    END-EXEC.
 18839*    MOVE '"$8cJI                ! & #00018724' TO DFHEIV0
 18840     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18842     MOVE X'2620233030303138373234' TO DFHEIV0(25:11)
 18843     CALL 'kxdfhei1' USING DFHEIV0
 18844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18845
 18846
 18847
 18848* EXEC CICS RESETBR
 18849*        DATASET (FILE-ID-ERRESC)
 18850*        RIDFLD  (WS-ERRESC-KEY)
 18851*    END-EXEC.
 18852     MOVE 0
 18853       TO DFHEIV11
 18854*    MOVE '&4         G          &   #00018731' TO DFHEIV0
 18855     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18856     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18857     MOVE X'2020233030303138373331' TO DFHEIV0(25:11)
 18858     CALL 'kxdfhei1' USING DFHEIV0,
 18859           FILE-ID-ERRESC,
 18860           WS-ERRESC-KEY,
 18861           DFHEIV99,
 18862           DFHEIV11,
 18863           DFHEIV99
 18864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 343
* EL050.cbl
 18865
 18866
 18867 6660-START-BROWSE.
 18868
 18869
 18870* EXEC CICS HANDLE CONDITION
 18871*        NOTFND    (6690-END-OF-FILE)
 18872*        DISABLED  (6690-ERRESC-PROBLEM)
 18873*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18874*        ENDFILE   (6690-END-OF-FILE)
 18875*    END-EXEC.
 18876*    MOVE '"$IcJ''                ! '' #00018738' TO DFHEIV0
 18877     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18879     MOVE X'2720233030303138373338' TO DFHEIV0(25:11)
 18880     CALL 'kxdfhei1' USING DFHEIV0
 18881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18882
 18883
 18884
 18885* EXEC CICS STARTBR
 18886*        DATASET (FILE-ID-ERRESC)
 18887*        RIDFLD  (WS-ERRESC-KEY)
 18888*        GTEQ
 18889*    END-EXEC.
 18890     MOVE 0
 18891       TO DFHEIV11
 18892*    MOVE '&,         G          &   #00018745' TO DFHEIV0
 18893     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18894     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18895     MOVE X'2020233030303138373435' TO DFHEIV0(25:11)
 18896     CALL 'kxdfhei1' USING DFHEIV0,
 18897           FILE-ID-ERRESC,
 18898           WS-ERRESC-KEY,
 18899           DFHEIV99,
 18900           DFHEIV11,
 18901           DFHEIV99
 18902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18903
 18904
 18905     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18906
 18907 6670-READ-NEXT-ERRESC-MASTER.
 18908
 18909
 18910* EXEC CICS HANDLE CONDITION
 18911*        NOTFND    (6690-END-OF-FILE)
 18912*        DISABLED  (6690-ERRESC-PROBLEM)
 18913*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18914*        ENDFILE   (6690-END-OF-FILE)
 18915*    END-EXEC.
 18916*    MOVE '"$IcJ''                ! ( #00018755' TO DFHEIV0
 18917     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18919     MOVE X'2820233030303138373535' TO DFHEIV0(25:11)
 18920     CALL 'kxdfhei1' USING DFHEIV0
 18921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18922
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 344
* EL050.cbl
 18923
 18924
 18925* EXEC CICS READNEXT
 18926*        DATASET (FILE-ID-ERRESC)
 18927*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18928*        RIDFLD  (ERRESC-RECORD-KEY)
 18929*    END-EXEC.
 18930     MOVE LENGTH OF
 18931      ACCOUNT-RESIDENT-ST-COMMISSION
 18932       TO DFHEIV12
 18933     MOVE 0
 18934       TO DFHEIV11
 18935*    MOVE '&.IL                  )   #00018762' TO DFHEIV0
 18936     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18937     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18938     MOVE X'2020233030303138373632' TO DFHEIV0(25:11)
 18939     CALL 'kxdfhei1' USING DFHEIV0,
 18940           FILE-ID-ERRESC,
 18941           ACCOUNT-RESIDENT-ST-COMMISSION,
 18942           DFHEIV12,
 18943           ERRESC-RECORD-KEY,
 18944           DFHEIV99,
 18945           DFHEIV11,
 18946           DFHEIV99,
 18947           DFHEIV99
 18948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18949
 18950
 18951     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18952        NEXT SENTENCE
 18953     ELSE
 18954
 18955* EXEC CICS ENDBR
 18956*            DATASET (FILE-ID-ERRESC)
 18957*       END-EXEC
 18958     MOVE 0
 18959       TO DFHEIV11
 18960*    MOVE '&2                    $   #00018771' TO DFHEIV0
 18961     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18962     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18963     MOVE X'2020233030303138373731' TO DFHEIV0(25:11)
 18964     CALL 'kxdfhei1' USING DFHEIV0,
 18965           FILE-ID-ERRESC,
 18966           DFHEIV11,
 18967           DFHEIV99
 18968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18969        GO TO 6690-END-OF-FILE.
 18970
 18971     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18972
 18973* EXEC CICS ENDBR
 18974*            DATASET (FILE-ID-ERRESC)
 18975*       END-EXEC
 18976     MOVE 0
 18977       TO DFHEIV11
 18978*    MOVE '&2                    $   #00018777' TO DFHEIV0
 18979     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18980     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 345
* EL050.cbl
 18981     MOVE X'2020233030303138373737' TO DFHEIV0(25:11)
 18982     CALL 'kxdfhei1' USING DFHEIV0,
 18983           FILE-ID-ERRESC,
 18984           DFHEIV11,
 18985           DFHEIV99
 18986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18987        GO TO 6690-END-OF-FILE.
 18988
 18989     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18990        NEXT SENTENCE
 18991      ELSE
 18992        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18993
 18994* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18995*
 18996     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18997
 18998     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18999
 19000     IF WS-SUB1 > ZERO
 19001         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19002             PERFORM 6680-SET-COMMISSION
 19003         ELSE
 19004             PERFORM 6680-SET-TABLE-CODE.
 19005
 19006
 19007* EXEC CICS ENDBR
 19008*         DATASET (FILE-ID-ERRESC)
 19009*    END-EXEC.
 19010     MOVE 0
 19011       TO DFHEIV11
 19012*    MOVE '&2                    $   #00018799' TO DFHEIV0
 19013     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19014     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19015     MOVE X'2020233030303138373939' TO DFHEIV0(25:11)
 19016     CALL 'kxdfhei1' USING DFHEIV0,
 19017           FILE-ID-ERRESC,
 19018           DFHEIV11,
 19019           DFHEIV99
 19020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19021
 19022
 19023     GO TO 6700-COMM-EXIT.
 19024
 19025 6680-SET-TABLE-CODE.
 19026     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19027        MOVE ZEROS             TO WS-SUB1
 19028     ELSE
 19029* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19030* TO COMPUTE AH COMMISSION.
 19031        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19032        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19033        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19034        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19035        PERFORM 6680-READ-CTBL-TABLE
 19036        IF WS-CTBL-READ-SW NOT = 'Y'
 19037           MOVE ZEROS          TO WS-SUB1.
 19038
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 346
* EL050.cbl
 19039 6680-READ-CTBL-TABLE.
 19040*
 19041* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19042* TO COMPUTE LIFE COMMISSION
 19043
 19044     IF CTBL-SW = '0540'
 19045        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19046        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19047        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19048
 19049     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19050
 19051     IF CTBL-TABLE-FOUND
 19052        IF CTBL-SW = '0530'
 19053             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19054                                    * PB-I-AH-TERM
 19055             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19056             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19057        ELSE
 19058             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19059             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19060             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19061     ELSE
 19062        IF FIRST-TIME-THROUGH
 19063            GO TO 6680-READ-CTBL-TABLE
 19064        ELSE
 19065            MOVE ZEROS         TO WS-SUB1.
 19066
 19067 6680-SET-COMMISSION.
 19068     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19069           MOVE ZEROS          TO WS-SUB1
 19070       ELSE
 19071           MOVE RESC-COMMISSION-PER (WS-SUB)
 19072                               TO WS-COMMISSION
 19073           IF CTBL-SW = '0530'
 19074               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19075           ELSE
 19076               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19077
 19078 6680-SEARCH-CATEGORY.
 19079     ADD +1                   TO WS-SUB.
 19080     IF WS-SUB > +12
 19081         GO TO 6680-EXIT.
 19082
 19083     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19084          MOVE WS-SUB         TO WS-SUB1
 19085          GO TO 6680-EXIT.
 19086
 19087     GO TO 6680-SEARCH-CATEGORY.
 19088
 19089 6680-EXIT.
 19090     EXIT.
 19091
 19092 6690-END-OF-FILE.
 19093     GO TO 6700-COMM-EXIT.
 19094
 19095 6690-ERRESC-PROBLEM.
 19096      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 347
* EL050.cbl
 19097      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19098
 19099      GO TO 6700-COMM-EXIT.
 19100
 19101 6700-COMM-EXIT.
 19102     EXIT.
 19103
 19104 7000-GET-RATE.
 19105
 19106* EXEC CICS LINK
 19107*        PROGRAM    ('ELRATE')
 19108*        COMMAREA   (CALCULATION-PASS-AREA)
 19109*        LENGTH     (CP-COMM-LENGTH)
 19110*    END-EXEC.
 19111     MOVE 'ELRATE' TO DFHEIV1
 19112*    MOVE '."C                   (   #00018885' TO DFHEIV0
 19113     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19114     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19115     MOVE X'2020233030303138383835' TO DFHEIV0(25:11)
 19116     CALL 'kxdfhei1' USING DFHEIV0,
 19117           DFHEIV1,
 19118           CALCULATION-PASS-AREA,
 19119           CP-COMM-LENGTH,
 19120           DFHEIV99,
 19121           DFHEIV99,
 19122           DFHEIV99,
 19123           DFHEIV99
 19124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19125
 19126
 19127 7000-EXIT.
 19128     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 348
* EL050.cbl
 19130 7100-FIND-BENEFIT-IN-STATE.
 19131     MOVE 'N'                    TO BEN-SEARCH-SW.
 19132
 19133     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19134         VARYING SUB3 FROM 1 BY 1 UNTIL
 19135            ((SUB3 GREATER 50) OR
 19136              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19137               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19138
 19139     IF SUB3 NOT = 51
 19140         MOVE 'Y'                TO BEN-SEARCH-SW.
 19141
 19142     GO TO 7199-EXIT.
 19143
 19144 7100-BENEFIT-DUMMY.
 19145
 19146 7100-DUMMY-EXIT.
 19147     EXIT.
 19148
 19149 7199-EXIT.
 19150     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 349
* EL050.cbl
 19152 7200-FIND-BENEFIT.
 19153     MOVE 'N'                    TO BEN-SEARCH-SW.
 19154
 19155     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19156         VARYING SUB3 FROM 1 BY 1 UNTIL
 19157            ((SUB3 GREATER 8) OR
 19158            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19159
 19160     IF SUB3 NOT = 9
 19161         MOVE 'Y'                TO BEN-SEARCH-SW.
 19162
 19163     GO TO 7200-EXIT.
 19164
 19165 7200-BENEFIT-DUMMY.
 19166
 19167 7200-DUMMY-EXIT.
 19168     EXIT.
 19169
 19170 7200-EXIT.
 19171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 350
* EL050.cbl
 19173 7250-LOOK-FOR-RESCINDED-CLAIM.
 19174     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19175                                    W-CL-COMP-CD.
 19176     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19177                                    W-CL-CERT-NO.
 19178
 19179
 19180* EXEC CICS HANDLE CONDITION
 19181*        NOTFND  (7250-CONTINUE)
 19182*        ENDFILE (7250-CONTINUE)
 19183*    END-EXEC.
 19184*    MOVE '"$I''                  ! ) #00018943' TO DFHEIV0
 19185     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19187     MOVE X'2920233030303138393433' TO DFHEIV0(25:11)
 19188     CALL 'kxdfhei1' USING DFHEIV0
 19189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19190
 19191
 19192
 19193* EXEC CICS IGNORE CONDITION
 19194*        DUPKEY
 19195*    END-EXEC.
 19196*    MOVE '"*$                   !   #00018948' TO DFHEIV0
 19197     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19199     MOVE X'2020233030303138393438' TO DFHEIV0(25:11)
 19200     CALL 'kxdfhei1' USING DFHEIV0
 19201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19202
 19203
 19204
 19205* EXEC CICS STARTBR
 19206*        DATASET   (CLMS-ID)
 19207*        RIDFLD    (ELMSTR-KEY)
 19208*        GENERIC   EQUAL
 19209*        KEYLENGTH (ELMSTR-LENGTH)
 19210*    END-EXEC.
 19211     MOVE 0
 19212       TO DFHEIV11
 19213*    MOVE '&,   KG    E          &   #00018952' TO DFHEIV0
 19214     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19215     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19216     MOVE X'2020233030303138393532' TO DFHEIV0(25:11)
 19217     CALL 'kxdfhei1' USING DFHEIV0,
 19218           CLMS-ID,
 19219           ELMSTR-KEY,
 19220           ELMSTR-LENGTH,
 19221           DFHEIV11,
 19222           DFHEIV99
 19223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19224
 19225
 19226     MOVE 'Y'                    TO W-BROWSE-SW.
 19227
 19228 7250-NEXT-CLAIM.
 19229
 19230
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 351
* EL050.cbl
 19231* EXEC CICS READNEXT
 19232*        DATASET   (CLMS-ID)
 19233*        RIDFLD    (ELMSTR-KEY)
 19234*        SET       (ADDRESS OF CLAIM-MASTER)
 19235*    END-EXEC.
 19236     MOVE 0
 19237       TO DFHEIV11
 19238*    MOVE '&.S                   )   #00018963' TO DFHEIV0
 19239     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19240     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19241     MOVE X'2020233030303138393633' TO DFHEIV0(25:11)
 19242     CALL 'kxdfhei1' USING DFHEIV0,
 19243           CLMS-ID,
 19244           DFHEIV20,
 19245           DFHEIV99,
 19246           ELMSTR-KEY,
 19247           DFHEIV99,
 19248           DFHEIV11,
 19249           DFHEIV99,
 19250           DFHEIV99
 19251     SET ADDRESS OF CLAIM-MASTER TO
 19252         DFHEIV20
 19253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19254
 19255
 19256     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19257        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19258         GO TO 7250-CONTINUE
 19259     END-IF.
 19260
 19261     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19262        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19263        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19264        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19265        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19266         GO TO 7250-NEXT-CLAIM
 19267     END-IF.
 19268
 19269     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19270        OR (CL-CLAIM-TYPE = 'I')
 19271        OR (CL-CLAIM-TYPE = 'G')
 19272        OR (CL-CLAIM-TYPE = 'F')
 19273          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19274              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19275              GO TO 7250-CONTINUE
 19276          END-IF
 19277     END-IF.
 19278
 19279     GO TO 7250-NEXT-CLAIM.
 19280
 19281 7250-CONTINUE.
 19282
 19283     IF W-BROWSE-SW = 'Y'
 19284
 19285* EXEC CICS ENDBR
 19286*            DATASET   (CLMS-ID)
 19287*        END-EXEC
 19288     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 352
* EL050.cbl
 19289       TO DFHEIV11
 19290*    MOVE '&2                    $   #00018997' TO DFHEIV0
 19291     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19292     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19293     MOVE X'2020233030303138393937' TO DFHEIV0(25:11)
 19294     CALL 'kxdfhei1' USING DFHEIV0,
 19295           CLMS-ID,
 19296           DFHEIV11,
 19297           DFHEIV99
 19298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19299         MOVE 'N' TO W-BROWSE-SW
 19300     END-IF.
 19301
 19302 7250-EXIT.
 19303     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 353
* EL050.cbl
 19305 7300-CHECK-FOR-OPEN-CLMS.
 19306
 19307*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19308*    MOVE SPACES                 TO CNTL-ACCESS.
 19309*    MOVE '1'                    TO CNTL-REC-TYPE.
 19310*    MOVE +0                     TO CNTL-SEQ-NO.
 19311
 19312*    MOVE '3'                    TO RC-SW-1.
 19313*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19314
 19315*    IF NOT CF-COMPANY-MASTER
 19316*         PERFORM 0099-COMPANY-NOT-FOUND
 19317*         GO TO 7300-EXIT.
 19318
 19319     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19320                                    W-CL-COMP-CD.
 19321     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19322                                    W-CL-CERT-NO.
 19323
 19324
 19325* EXEC CICS HANDLE CONDITION
 19326*        NOTFND  (7300-CONTINUE)
 19327*        ENDFILE (7300-CONTINUE)
 19328*    END-EXEC.
 19329*    MOVE '"$I''                  ! * #00019025' TO DFHEIV0
 19330     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19332     MOVE X'2A20233030303139303235' TO DFHEIV0(25:11)
 19333     CALL 'kxdfhei1' USING DFHEIV0
 19334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19335
 19336
 19337
 19338* EXEC CICS IGNORE CONDITION
 19339*        DUPKEY
 19340*    END-EXEC.
 19341*    MOVE '"*$                   !   #00019030' TO DFHEIV0
 19342     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19343     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19344     MOVE X'2020233030303139303330' TO DFHEIV0(25:11)
 19345     CALL 'kxdfhei1' USING DFHEIV0
 19346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19347
 19348
 19349
 19350* EXEC CICS STARTBR
 19351*        DATASET   (CLMS-ID)
 19352*        RIDFLD    (ELMSTR-KEY)
 19353*        GENERIC   EQUAL
 19354*        KEYLENGTH (ELMSTR-LENGTH)
 19355*    END-EXEC.
 19356     MOVE 0
 19357       TO DFHEIV11
 19358*    MOVE '&,   KG    E          &   #00019034' TO DFHEIV0
 19359     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19360     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19361     MOVE X'2020233030303139303334' TO DFHEIV0(25:11)
 19362     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 354
* EL050.cbl
 19363           CLMS-ID,
 19364           ELMSTR-KEY,
 19365           ELMSTR-LENGTH,
 19366           DFHEIV11,
 19367           DFHEIV99
 19368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19369
 19370
 19371     MOVE 'Y'                    TO W-BROWSE-SW.
 19372
 19373 7300-NEXT-CLAIM.
 19374
 19375
 19376* EXEC CICS READNEXT
 19377*        DATASET   (CLMS-ID)
 19378*        RIDFLD    (ELMSTR-KEY)
 19379*        SET       (ADDRESS OF CLAIM-MASTER)
 19380*    END-EXEC.
 19381     MOVE 0
 19382       TO DFHEIV11
 19383*    MOVE '&.S                   )   #00019045' TO DFHEIV0
 19384     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19385     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19386     MOVE X'2020233030303139303435' TO DFHEIV0(25:11)
 19387     CALL 'kxdfhei1' USING DFHEIV0,
 19388           CLMS-ID,
 19389           DFHEIV20,
 19390           DFHEIV99,
 19391           ELMSTR-KEY,
 19392           DFHEIV99,
 19393           DFHEIV11,
 19394           DFHEIV99,
 19395           DFHEIV99
 19396     SET ADDRESS OF CLAIM-MASTER TO
 19397         DFHEIV20
 19398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19399
 19400
 19401     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19402        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19403         GO TO 7300-CONTINUE.
 19404
 19405     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19406        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19407        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19408        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19409        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19410         GO TO 7300-NEXT-CLAIM.
 19411
 19412*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19413     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19414        OR (CL-CLAIM-TYPE = 'I')
 19415        OR (CL-CLAIM-TYPE = 'G')
 19416        OR (CL-CLAIM-TYPE = 'F')
 19417        IF CLAIM-IS-OPEN
 19418           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19419             AND PB-C-AH-CANCEL-DT > SPACES
 19420              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 355
* EL050.cbl
 19421              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19422           END-IF
 19423           EVALUATE TRUE
 19424             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19425                 MOVE ER-2884      TO WS-ERROR
 19426             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19427                 MOVE ER-2887      TO WS-ERROR
 19428             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19429                 MOVE ER-2886      TO WS-ERROR
 19430             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19431                 MOVE ER-2888      TO WS-ERROR
 19432             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19433                 MOVE ER-2885      TO WS-ERROR
 19434             WHEN OTHER
 19435                 MOVE ER-2768      TO WS-ERROR
 19436           END-EVALUATE
 19437           IF PB-C-AH-CANCEL-VOIDED OR
 19438              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19439                NOT AH-COVERAGE-CANCELLED)
 19440               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19441               MOVE ER-2768      TO WS-ERROR
 19442           END-IF
 19443           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19444           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19445              PB-FORCE-CODE NOT EQUAL '8'
 19446               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19447           END-IF
 19448           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19449           GO TO 7300-NEXT-CLAIM
 19450        ELSE
 19451           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19452*****THIS IS A RESCISSION OR REFORMATION
 19453              IF AH-COVERAGE-CANCELLED
 19454                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19455                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19456                    MOVE 1                   TO DC-ELAPSED-DAYS
 19457                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19458                    SET BIN-PLUS-ELAPSED     TO TRUE
 19459                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19460                    IF NO-CONVERSION-ERROR
 19461                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19462                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19463                          MOVE ER-2897 TO WS-ERROR
 19464                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19465                          GO TO 7300-NEXT-CLAIM
 19466                       END-IF
 19467                    END-IF
 19468                 ELSE
 19469                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19470                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19471                         MOVE ER-2890 TO WS-ERROR
 19472                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19473                         GO TO 7300-NEXT-CLAIM
 19474                      ELSE
 19475                         MOVE ER-2898 TO WS-ERROR
 19476                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19477                         GO TO 7300-NEXT-CLAIM
 19478                      END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 356
* EL050.cbl
 19479                   END-IF
 19480                 END-IF
 19481              END-IF
 19482           ELSE
 19483              IF CL-DENIAL-TYPE = '1'  AND
 19484                 CL-TOTAL-PAID-AMT = 0
 19485                    GO TO 7300-NEXT-CLAIM
 19486              END-IF
 19487              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19488               AND PB-C-AH-CANCEL-DT > SPACES
 19489                 MOVE ER-2756        TO WS-ERROR
 19490                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19491                 GO TO 7300-NEXT-CLAIM
 19492              END-IF
 19493           END-IF
 19494        END-IF
 19495     ELSE
 19496*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19497        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19498           IF (CLAIM-IS-OPEN)
 19499              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19500                 <> zeros
 19501              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19502                 <> zeros)
 19503              MOVE ER-2889      TO WS-ERROR
 19504              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19505              GO TO 7300-NEXT-CLAIM
 19506           ELSE
 19507              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19508*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19509                 IF (LF-COVERAGE-CANCELLED AND
 19510                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19511                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19512                         MOVE ER-2890 TO WS-ERROR
 19513                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19514                         GO TO 7300-NEXT-CLAIM
 19515                      ELSE
 19516                         MOVE ER-2898 TO WS-ERROR
 19517                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19518                         GO TO 7300-NEXT-CLAIM
 19519                      END-IF
 19520                 END-IF
 19521              ELSE
 19522                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19523                    and (CL-TOTAL-PAID-AMT = 0)
 19524                    GO TO 7300-NEXT-CLAIM
 19525                 END-IF
 19526                 IF (
 19527                      (AH-COVERAGE-CANCELLED)
 19528                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19529                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19530                      and (pb-ci-ah-cancel-amt +
 19531                         pb-c-ah-cancel-amt) <> zeros
 19532                    )
 19533                               OR
 19534                    (
 19535                      (LF-COVERAGE-CANCELLED)
 19536                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 357
* EL050.cbl
 19537                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19538                      and (pb-ci-lf-cancel-amt +
 19539                         pb-c-lf-cancel-amt) <> zeros
 19540                    )
 19541                       MOVE ER-2965 TO WS-ERROR
 19542                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19543                       GO TO 7300-NEXT-CLAIM
 19544                 END-IF
 19545                 IF LF-COVERAGE-CANCELLED
 19546                  IF CL-TOTAL-PAID-AMT > 0
 19547                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19548                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19549                        MOVE ER-2891 TO WS-ERROR
 19550                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19551                        GO TO 7300-NEXT-CLAIM
 19552                      END-IF
 19553                    ELSE
 19554****only show this error if cert num matches exactly
 19555                      IF PB-CERT-NO = CL-CERT-NO
 19556                         MOVE ER-2892 TO WS-ERROR
 19557                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19558                         GO TO 7300-NEXT-CLAIM
 19559                      END-IF
 19560                    END-IF
 19561                  END-IF
 19562                 END-IF
 19563              END-IF
 19564           END-IF
 19565        END-IF
 19566     END-IF
 19567
 19568     GO TO 7300-NEXT-CLAIM.
 19569
 19570 7300-CONTINUE.
 19571
 19572     IF W-BROWSE-SW = 'Y'
 19573
 19574* EXEC CICS ENDBR
 19575*            DATASET   (CLMS-ID)
 19576*        END-EXEC.
 19577     MOVE 0
 19578       TO DFHEIV11
 19579*    MOVE '&2                    $   #00019223' TO DFHEIV0
 19580     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19581     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19582     MOVE X'2020233030303139323233' TO DFHEIV0(25:11)
 19583     CALL 'kxdfhei1' USING DFHEIV0,
 19584           CLMS-ID,
 19585           DFHEIV11,
 19586           DFHEIV99
 19587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19588
 19589
 19590 7300-EXIT.
 19591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 358
* EL050.cbl
 19593
 19594 7400-GET-REMAIN-TERM.
 19595
 19596* EXEC CICS LINK
 19597*        PROGRAM    ('ELRTRM')
 19598*        COMMAREA   (CALCULATION-PASS-AREA)
 19599*        LENGTH     (CP-COMM-LENGTH)
 19600*    END-EXEC.
 19601     MOVE 'ELRTRM' TO DFHEIV1
 19602*    MOVE '."C                   (   #00019232' TO DFHEIV0
 19603     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19605     MOVE X'2020233030303139323332' TO DFHEIV0(25:11)
 19606     CALL 'kxdfhei1' USING DFHEIV0,
 19607           DFHEIV1,
 19608           CALCULATION-PASS-AREA,
 19609           CP-COMM-LENGTH,
 19610           DFHEIV99,
 19611           DFHEIV99,
 19612           DFHEIV99,
 19613           DFHEIV99
 19614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19615
 19616
 19617 7400-EXIT.
 19618     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 359
* EL050.cbl
 19620
 19621 7500-GET-REMAIN-AMOUNT.
 19622
 19623* EXEC CICS LINK
 19624*        PROGRAM    ('ELRAMT')
 19625*        COMMAREA   (CALCULATION-PASS-AREA)
 19626*        LENGTH     (CP-COMM-LENGTH)
 19627*    END-EXEC.
 19628     MOVE 'ELRAMT' TO DFHEIV1
 19629*    MOVE '."C                   (   #00019243' TO DFHEIV0
 19630     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19632     MOVE X'2020233030303139323433' TO DFHEIV0(25:11)
 19633     CALL 'kxdfhei1' USING DFHEIV0,
 19634           DFHEIV1,
 19635           CALCULATION-PASS-AREA,
 19636           CP-COMM-LENGTH,
 19637           DFHEIV99,
 19638           DFHEIV99,
 19639           DFHEIV99,
 19640           DFHEIV99
 19641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19642
 19643
 19644 7500-EXIT.
 19645     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 360
* EL050.cbl
 19647
 19648 7600-GET-REFUND.
 19649
 19650* EXEC CICS LINK
 19651*        PROGRAM    ('ELRFND')
 19652*        COMMAREA   (CALCULATION-PASS-AREA)
 19653*        LENGTH     (CP-COMM-LENGTH)
 19654*    END-EXEC.
 19655     MOVE 'ELRFND' TO DFHEIV1
 19656*    MOVE '."C                   (   #00019254' TO DFHEIV0
 19657     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19659     MOVE X'2020233030303139323534' TO DFHEIV0(25:11)
 19660     CALL 'kxdfhei1' USING DFHEIV0,
 19661           DFHEIV1,
 19662           CALCULATION-PASS-AREA,
 19663           CP-COMM-LENGTH,
 19664           DFHEIV99,
 19665           DFHEIV99,
 19666           DFHEIV99,
 19667           DFHEIV99
 19668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19669
 19670
 19671 7600-EXIT.
 19672     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 361
* EL050.cbl
 19674 7700-CALL-DL1.
 19675
 19676* EXEC CICS LINK
 19677*        PROGRAM    ('DLO001')
 19678*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19679*        LENGTH     (DLO001-COMM-LENGTH)
 19680*    END-EXEC.
 19681     MOVE 'DLO001' TO DFHEIV1
 19682*    MOVE '."C                   (   #00019264' TO DFHEIV0
 19683     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19685     MOVE X'2020233030303139323634' TO DFHEIV0(25:11)
 19686     CALL 'kxdfhei1' USING DFHEIV0,
 19687           DFHEIV1,
 19688           WS-DLO-MASTER-POLICY-FORM,
 19689           DLO001-COMM-LENGTH,
 19690           DFHEIV99,
 19691           DFHEIV99,
 19692           DFHEIV99,
 19693           DFHEIV99
 19694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19695
 19696
 19697 7700-EXIT.
 19698     EXIT.
 19699
 19700 7710-CALL-DL2.
 19701
 19702* EXEC CICS LINK
 19703*        PROGRAM    ('DLO002')
 19704*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19705*        LENGTH     (DLO002-COMM-LENGTH)
 19706*    END-EXEC.
 19707     MOVE 'DLO002' TO DFHEIV1
 19708*    MOVE '."C                   (   #00019274' TO DFHEIV0
 19709     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19711     MOVE X'2020233030303139323734' TO DFHEIV0(25:11)
 19712     CALL 'kxdfhei1' USING DFHEIV0,
 19713           DFHEIV1,
 19714           WS-DLO-INTERNAL-POLICY-FORM,
 19715           DLO002-COMM-LENGTH,
 19716           DFHEIV99,
 19717           DFHEIV99,
 19718           DFHEIV99,
 19719           DFHEIV99
 19720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19721
 19722
 19723 7710-EXIT.
 19724     EXIT.
 19725
 19726 7720-CALL-DL3.
 19727
 19728* EXEC CICS LINK
 19729*        PROGRAM    ('DLO003')
 19730*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19731*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 362
* EL050.cbl
 19732*    END-EXEC.
 19733     MOVE 'DLO003' TO DFHEIV1
 19734*    MOVE '."C                   (   #00019284' TO DFHEIV0
 19735     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19737     MOVE X'2020233030303139323834' TO DFHEIV0(25:11)
 19738     CALL 'kxdfhei1' USING DFHEIV0,
 19739           DFHEIV1,
 19740           WS-DLO-VALID-BANK-ID,
 19741           DLO003-COMM-LENGTH,
 19742           DFHEIV99,
 19743           DFHEIV99,
 19744           DFHEIV99,
 19745           DFHEIV99
 19746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19747
 19748
 19749 7720-EXIT.
 19750     EXIT.
 19751
 19752 7730-CALL-DL7.
 19753
 19754* EXEC CICS LINK
 19755*        PROGRAM    ('DLO007')
 19756*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19757*        LENGTH     (DLO007-COMM-LENGTH)
 19758*    END-EXEC.
 19759     MOVE 'DLO007' TO DFHEIV1
 19760*    MOVE '."C                   (   #00019294' TO DFHEIV0
 19761     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19763     MOVE X'2020233030303139323934' TO DFHEIV0(25:11)
 19764     CALL 'kxdfhei1' USING DFHEIV0,
 19765           DFHEIV1,
 19766           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19767           DLO007-COMM-LENGTH,
 19768           DFHEIV99,
 19769           DFHEIV99,
 19770           DFHEIV99,
 19771           DFHEIV99
 19772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19773
 19774
 19775 7730-EXIT.
 19776     EXIT.
 19777
 19778 7740-CALL-DL11.
 19779
 19780* EXEC CICS LINK
 19781*        PROGRAM    ('DLO011')
 19782*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19783*        LENGTH     (DLO011-COMM-LENGTH)
 19784*    END-EXEC.
 19785     MOVE 'DLO011' TO DFHEIV1
 19786*    MOVE '."C                   (   #00019304' TO DFHEIV0
 19787     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19788     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19789     MOVE X'2020233030303139333034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 363
* EL050.cbl
 19790     CALL 'kxdfhei1' USING DFHEIV0,
 19791           DFHEIV1,
 19792           WS-DLO-PREM-RATES-BEN-TYPE,
 19793           DLO011-COMM-LENGTH,
 19794           DFHEIV99,
 19795           DFHEIV99,
 19796           DFHEIV99,
 19797           DFHEIV99
 19798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19799
 19800
 19801 7740-EXIT.
 19802     EXIT.
 19803
 19804 7750-CALL-DL17.
 19805
 19806* EXEC CICS LINK
 19807*        PROGRAM    ('DLO017')
 19808*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19809*        LENGTH     (DLO017-COMM-LENGTH)
 19810*    END-EXEC.
 19811     MOVE 'DLO017' TO DFHEIV1
 19812*    MOVE '."C                   (   #00019314' TO DFHEIV0
 19813     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19814     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19815     MOVE X'2020233030303139333134' TO DFHEIV0(25:11)
 19816     CALL 'kxdfhei1' USING DFHEIV0,
 19817           DFHEIV1,
 19818           WS-DLO-VALID-RATE-CODE,
 19819           DLO017-COMM-LENGTH,
 19820           DFHEIV99,
 19821           DFHEIV99,
 19822           DFHEIV99,
 19823           DFHEIV99
 19824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19825
 19826
 19827 7750-EXIT.
 19828     EXIT.
 19829
 19830 7755-CALL-DL19.
 19831
 19832* EXEC CICS LINK
 19833*        PROGRAM    ('DLO019')
 19834*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19835*        LENGTH     (DLO019-COMM-LENGTH)
 19836*    END-EXEC.
 19837     MOVE 'DLO019' TO DFHEIV1
 19838*    MOVE '."C                   (   #00019324' TO DFHEIV0
 19839     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19841     MOVE X'2020233030303139333234' TO DFHEIV0(25:11)
 19842     CALL 'kxdfhei1' USING DFHEIV0,
 19843           DFHEIV1,
 19844           WS-DLO-ORIG-COV-CAT,
 19845           DLO019-COMM-LENGTH,
 19846           DFHEIV99,
 19847           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 364
* EL050.cbl
 19848           DFHEIV99,
 19849           DFHEIV99
 19850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19851
 19852
 19853 7755-EXIT.
 19854     EXIT.
 19855
 19856 7760-CALL-DL21.
 19857
 19858* EXEC CICS LINK
 19859*        PROGRAM    ('DLO021')
 19860*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19861*        LENGTH     (DLO021-COMM-LENGTH)
 19862*    END-EXEC.
 19863     MOVE 'DLO021' TO DFHEIV1
 19864*    MOVE '."C                   (   #00019334' TO DFHEIV0
 19865     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19866     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19867     MOVE X'2020233030303139333334' TO DFHEIV0(25:11)
 19868     CALL 'kxdfhei1' USING DFHEIV0,
 19869           DFHEIV1,
 19870           WS-DLO-VALID-LOAN-OFFICER,
 19871           DLO021-COMM-LENGTH,
 19872           DFHEIV99,
 19873           DFHEIV99,
 19874           DFHEIV99,
 19875           DFHEIV99
 19876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19877
 19878
 19879 7760-EXIT.
 19880     EXIT.
 19881
 19882 7770-CALL-DL22.
 19883
 19884* EXEC CICS LINK
 19885*        PROGRAM    ('DLO022')
 19886*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19887*        LENGTH     (DLO022-COMM-LENGTH)
 19888*    END-EXEC.
 19889     MOVE 'DLO022' TO DFHEIV1
 19890*    MOVE '."C                   (   #00019344' TO DFHEIV0
 19891     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19893     MOVE X'2020233030303139333434' TO DFHEIV0(25:11)
 19894     CALL 'kxdfhei1' USING DFHEIV0,
 19895           DFHEIV1,
 19896           WS-DLO-VALID-STATE-CODE,
 19897           DLO022-COMM-LENGTH,
 19898           DFHEIV99,
 19899           DFHEIV99,
 19900           DFHEIV99,
 19901           DFHEIV99
 19902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19903
 19904
 19905 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 365
* EL050.cbl
 19906     EXIT.
 19907
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 366
* EL050.cbl
 19909
 19910 7780-CALL-AGG.
 19911
 19912* EXEC CICS LINK
 19913*        PROGRAM    ('ELAGGO')
 19914*        COMMAREA   (WS-PASS-to-pemaggo)
 19915*        LENGTH     (ws-passed-key-LENGTH)
 19916*    END-EXEC.
 19917     MOVE 'ELAGGO' TO DFHEIV1
 19918*    MOVE '."C                   (   #00019356' TO DFHEIV0
 19919     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19920     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19921     MOVE X'2020233030303139333536' TO DFHEIV0(25:11)
 19922     CALL 'kxdfhei1' USING DFHEIV0,
 19923           DFHEIV1,
 19924           WS-PASS-to-pemaggo,
 19925           ws-passed-key-LENGTH,
 19926           DFHEIV99,
 19927           DFHEIV99,
 19928           DFHEIV99,
 19929           DFHEIV99
 19930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19931
 19932 7780-EXIT.
 19933     EXIT.
 19934 7785-CALL-HLDI.
 19935
 19936* EXEC CICS LINK
 19937*        PROGRAM    ('ELHLDI')
 19938*        COMMAREA   (HLDI-PASS-AREA)
 19939*        LENGTH     (HLDI-PASS-AREA-LEN)
 19940*    END-EXEC.
 19941     MOVE 'ELHLDI' TO DFHEIV1
 19942*    MOVE '."C                   (   #00019364' TO DFHEIV0
 19943     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19944     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19945     MOVE X'2020233030303139333634' TO DFHEIV0(25:11)
 19946     CALL 'kxdfhei1' USING DFHEIV0,
 19947           DFHEIV1,
 19948           HLDI-PASS-AREA,
 19949           HLDI-PASS-AREA-LEN,
 19950           DFHEIV99,
 19951           DFHEIV99,
 19952           DFHEIV99,
 19953           DFHEIV99
 19954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19955
 19956 7785-EXIT.
 19957     EXIT.
 19958 7786-CALL-HLDIM.
 19959
 19960* EXEC CICS LINK
 19961*        PROGRAM    ('ELHLDIM')
 19962*        COMMAREA   (HLDI-PASS-AREA)
 19963*        LENGTH     (HLDI-PASS-AREA-LEN)
 19964*    END-EXEC.
 19965     MOVE 'ELHLDIM' TO DFHEIV1
 19966*    MOVE '."C                   (   #00019372' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 367
* EL050.cbl
 19967     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19969     MOVE X'2020233030303139333732' TO DFHEIV0(25:11)
 19970     CALL 'kxdfhei1' USING DFHEIV0,
 19971           DFHEIV1,
 19972           HLDI-PASS-AREA,
 19973           HLDI-PASS-AREA-LEN,
 19974           DFHEIV99,
 19975           DFHEIV99,
 19976           DFHEIV99,
 19977           DFHEIV99
 19978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19979
 19980 7786-EXIT.
 19981     EXIT.
 19982 7800-REWRITE-CERT.
 19983******************************************************************
 19984*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19985*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19986******************************************************************
 19987
 19988     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19989        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19990        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19991        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19992
 19993* EXEC CICS REWRITE
 19994*                  DATASET (CERT-ID)
 19995*                  FROM    (CERTIFICATE-MASTER)
 19996*              END-EXEC
 19997     MOVE LENGTH OF
 19998      CERTIFICATE-MASTER
 19999       TO DFHEIV11
 20000*    MOVE '&& L                  %   #00019389' TO DFHEIV0
 20001     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20002     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20003     MOVE X'2020233030303139333839' TO DFHEIV0(25:11)
 20004     CALL 'kxdfhei1' USING DFHEIV0,
 20005           CERT-ID,
 20006           CERTIFICATE-MASTER,
 20007           DFHEIV11,
 20008           DFHEIV99
 20009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20010        GO TO 7800-EXIT.
 20011
 20012       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20013       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20014
 20015 7800-EXIT.
 20016      EXIT.
 20017
 20018 7900-DELETE-CERT.
 20019
 20020* EXEC CICS DELETE
 20021*        DATASET (CERT-ID)
 20022*    END-EXEC.
 20023*    MOVE '&(                    &   #00019402' TO DFHEIV0
 20024     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 368
* EL050.cbl
 20025     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20026     MOVE X'2020233030303139343032' TO DFHEIV0(25:11)
 20027     CALL 'kxdfhei1' USING DFHEIV0,
 20028           CERT-ID,
 20029           DFHEIV99,
 20030           DFHEIV99,
 20031           DFHEIV99,
 20032           DFHEIV99
 20033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20034
 20035
 20036 7900-EXIT.
 20037     EXIT.
 20038
 20039 8000-WRITE-CERT.
 20040
 20041* EXEC CICS HANDLE CONDITION
 20042*        DUPKEY    (8000-FREE-MAIN)
 20043*    END-EXEC.
 20044*    MOVE '"$$                   ! + #00019410' TO DFHEIV0
 20045     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20047     MOVE X'2B20233030303139343130' TO DFHEIV0(25:11)
 20048     CALL 'kxdfhei1' USING DFHEIV0
 20049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20050
 20051
 20052
 20053* EXEC CICS WRITE
 20054*        DATASET     (CERT-ID)
 20055*        FROM        (CERTIFICATE-MASTER)
 20056*        RIDFLD      (ELCERT-KEY)
 20057*    END-EXEC.
 20058     MOVE LENGTH OF
 20059      CERTIFICATE-MASTER
 20060       TO DFHEIV11
 20061*    MOVE '&$ L                  ''   #00019414' TO DFHEIV0
 20062     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20064     MOVE X'2020233030303139343134' TO DFHEIV0(25:11)
 20065     CALL 'kxdfhei1' USING DFHEIV0,
 20066           CERT-ID,
 20067           CERTIFICATE-MASTER,
 20068           DFHEIV11,
 20069           ELCERT-KEY,
 20070           DFHEIV99,
 20071           DFHEIV99
 20072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20073
 20074
 20075 8000-FREE-MAIN.
 20076
 20077 8000-EXIT.
 20078      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 369
* EL050.cbl
 20080
 20081 8100-READ-ERPNDM.
 20082
 20083* EXEC CICS HANDLE CONDITION
 20084*         NOTFND     (8100-NOTFND)
 20085*         ENDFILE    (8100-NOTFND)
 20086*    END-EXEC.
 20087*    MOVE '"$I''                  ! , #00019427' TO DFHEIV0
 20088     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20090     MOVE X'2C20233030303139343237' TO DFHEIV0(25:11)
 20091     CALL 'kxdfhei1' USING DFHEIV0
 20092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20093
 20094
 20095     MOVE SPACES                 TO ERPNDM-FOUND.
 20096     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20097
 20098
 20099* EXEC CICS READ
 20100*         DATASET   (FILE-ERPNDM)
 20101*         RIDFLD    (PM-CONTROL-PRIMARY)
 20102*         INTO      (PENDING-MAILING-DATA)
 20103*    END-EXEC.
 20104     MOVE LENGTH OF
 20105      PENDING-MAILING-DATA
 20106       TO DFHEIV11
 20107*    MOVE '&"IL       E          (   #00019435' TO DFHEIV0
 20108     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20110     MOVE X'2020233030303139343335' TO DFHEIV0(25:11)
 20111     CALL 'kxdfhei1' USING DFHEIV0,
 20112           FILE-ERPNDM,
 20113           PENDING-MAILING-DATA,
 20114           DFHEIV11,
 20115           PM-CONTROL-PRIMARY,
 20116           DFHEIV99,
 20117           DFHEIV99,
 20118           DFHEIV99
 20119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20120
 20121
 20122     GO TO 8100-EXIT.
 20123
 20124 8100-NOTFND.
 20125
 20126     MOVE 'X'                    TO ERPNDM-FOUND.
 20127     MOVE ER-2694                TO WS-ERROR.
 20128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20129     MOVE ER-2883                TO WS-ERROR
 20130     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20131     .
 20132 8100-EXIT.
 20133     EXIT.
 20134
 20135 8110-READ-ERMAIL.
 20136
 20137* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 370
* EL050.cbl
 20138*         NOTFND     (8110-NOTFND)
 20139*         ENDFILE    (8110-NOTFND)
 20140*    END-EXEC.
 20141*    MOVE '"$I''                  ! - #00019455' TO DFHEIV0
 20142     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20144     MOVE X'2D20233030303139343535' TO DFHEIV0(25:11)
 20145     CALL 'kxdfhei1' USING DFHEIV0
 20146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20147
 20148
 20149     MOVE SPACES                 TO ERMAIL-FOUND.
 20150     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20151     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20152     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20153     MOVE PB-SV-STATE            TO MA-STATE.
 20154
 20155
 20156* EXEC CICS READ
 20157*         UPDATE
 20158*         DATASET   (FILE-ERMAIL)
 20159*         RIDFLD    (MA-CONTROL-PRIMARY)
 20160*         INTO      (MAILING-DATA)
 20161*    END-EXEC.
 20162     MOVE LENGTH OF
 20163      MAILING-DATA
 20164       TO DFHEIV11
 20165*    MOVE '&"IL       EU         (   #00019466' TO DFHEIV0
 20166     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20168     MOVE X'2020233030303139343636' TO DFHEIV0(25:11)
 20169     CALL 'kxdfhei1' USING DFHEIV0,
 20170           FILE-ERMAIL,
 20171           MAILING-DATA,
 20172           DFHEIV11,
 20173           MA-CONTROL-PRIMARY,
 20174           DFHEIV99,
 20175           DFHEIV99,
 20176           DFHEIV99
 20177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20178
 20179
 20180     GO TO 8110-EXIT.
 20181
 20182 8110-NOTFND.
 20183     MOVE 'X'                    TO ERMAIL-FOUND.
 20184
 20185 8110-EXIT.
 20186     EXIT.
 20187
 20188 8120-REWRITE-ERMAIL.
 20189
 20190* EXEC CICS REWRITE
 20191*         DATASET    (FILE-ERMAIL)
 20192*         FROM       (MAILING-DATA)
 20193*    END-EXEC.
 20194     MOVE LENGTH OF
 20195      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 371
* EL050.cbl
 20196       TO DFHEIV11
 20197*    MOVE '&& L                  %   #00019482' TO DFHEIV0
 20198     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20199     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20200     MOVE X'2020233030303139343832' TO DFHEIV0(25:11)
 20201     CALL 'kxdfhei1' USING DFHEIV0,
 20202           FILE-ERMAIL,
 20203           MAILING-DATA,
 20204           DFHEIV11,
 20205           DFHEIV99
 20206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20207
 20208
 20209 8120-EXIT.
 20210     EXIT.
 20211
 20212 8130-WRITE-ERMAIL.
 20213
 20214* EXEC CICS HANDLE CONDITION
 20215*         DUPKEY   (8130-EXIT)
 20216*    END-EXEC.
 20217*    MOVE '"$$                   ! . #00019491' TO DFHEIV0
 20218     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20220     MOVE X'2E20233030303139343931' TO DFHEIV0(25:11)
 20221     CALL 'kxdfhei1' USING DFHEIV0
 20222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20223
 20224
 20225
 20226* EXEC CICS WRITE
 20227*         DATASET     (FILE-ERMAIL)
 20228*         RIDFLD      (MA-CONTROL-PRIMARY)
 20229*         FROM        (MAILING-DATA)
 20230*    END-EXEC.
 20231     MOVE LENGTH OF
 20232      MAILING-DATA
 20233       TO DFHEIV11
 20234*    MOVE '&$ L                  ''   #00019495' TO DFHEIV0
 20235     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20236     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20237     MOVE X'2020233030303139343935' TO DFHEIV0(25:11)
 20238     CALL 'kxdfhei1' USING DFHEIV0,
 20239           FILE-ERMAIL,
 20240           MAILING-DATA,
 20241           DFHEIV11,
 20242           MA-CONTROL-PRIMARY,
 20243           DFHEIV99,
 20244           DFHEIV99
 20245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20246
 20247
 20248 8130-EXIT.
 20249     EXIT.
 20250
 20251 8140-UNLOCK-ERMAIL.
 20252
 20253* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 372
* EL050.cbl
 20254*         DATASET   (FILE-ERMAIL)
 20255*    END-EXEC.
 20256*    MOVE '&*                    #   #00019505' TO DFHEIV0
 20257     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20258     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20259     MOVE X'2020233030303139353035' TO DFHEIV0(25:11)
 20260     CALL 'kxdfhei1' USING DFHEIV0,
 20261           FILE-ERMAIL,
 20262           DFHEIV99
 20263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20264
 20265
 20266 8140-EXIT.
 20267     EXIT.
 20268
 20269 8150-read-elcrtt.
 20270
 20271
 20272* EXEC CICS HANDLE CONDITION
 20273*        NOTFND   (8150-exit)
 20274*    END-EXEC
 20275*    MOVE '"$I                   ! / #00019514' TO DFHEIV0
 20276     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20277     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20278     MOVE X'2F20233030303139353134' TO DFHEIV0(25:11)
 20279     CALL 'kxdfhei1' USING DFHEIV0
 20280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20281
 20282     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20283     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20284
 20285
 20286* EXEC CICS READ
 20287*        DATASET  (CRTT-ID)
 20288*        RIDFLD   (WS-ELCRTT-KEY)
 20289*        INTO     (CERTIFICATE-TRAILERS)
 20290*    END-EXEC
 20291     MOVE LENGTH OF
 20292      CERTIFICATE-TRAILERS
 20293       TO DFHEIV11
 20294*    MOVE '&"IL       E          (   #00019521' TO DFHEIV0
 20295     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20297     MOVE X'2020233030303139353231' TO DFHEIV0(25:11)
 20298     CALL 'kxdfhei1' USING DFHEIV0,
 20299           CRTT-ID,
 20300           CERTIFICATE-TRAILERS,
 20301           DFHEIV11,
 20302           WS-ELCRTT-KEY,
 20303           DFHEIV99,
 20304           DFHEIV99,
 20305           DFHEIV99
 20306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20307
 20308     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20309     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20310     move cs-vehicle-odometer    to ws-vehicle-odometer
 20311
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 373
* EL050.cbl
 20312     .
 20313 8150-exit.
 20314     exit.
 20315 8180-UPDATE-VIN-NUMBER.
 20316
 20317* EXEC CICS HANDLE CONDITION
 20318*        NOTFND   (8180-NOTFND)
 20319*    END-EXEC.
 20320*    MOVE '"$I                   ! 0 #00019535' TO DFHEIV0
 20321     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20323     MOVE X'3020233030303139353335' TO DFHEIV0(25:11)
 20324     CALL 'kxdfhei1' USING DFHEIV0
 20325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20326
 20327
 20328     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20329     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20330
 20331
 20332* EXEC CICS READ
 20333*        UPDATE
 20334*        DATASET  (CRTT-ID)
 20335*        RIDFLD   (WS-ELCRTT-KEY)
 20336*        INTO     (CERTIFICATE-TRAILERS)
 20337*    END-EXEC.
 20338     MOVE LENGTH OF
 20339      CERTIFICATE-TRAILERS
 20340       TO DFHEIV11
 20341*    MOVE '&"IL       EU         (   #00019542' TO DFHEIV0
 20342     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20343     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20344     MOVE X'2020233030303139353432' TO DFHEIV0(25:11)
 20345     CALL 'kxdfhei1' USING DFHEIV0,
 20346           CRTT-ID,
 20347           CERTIFICATE-TRAILERS,
 20348           DFHEIV11,
 20349           WS-ELCRTT-KEY,
 20350           DFHEIV99,
 20351           DFHEIV99,
 20352           DFHEIV99
 20353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20354
 20355
 20356     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20357        or (hldi-pass-area not = spaces)
 20358        move pa-modelyear        to cs-year
 20359        move pa-makename         to cs-make
 20360        move pa-modelname        to cs-model
 20361        move pa-seriesname       to cs-future
 20362        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20363
 20364* EXEC CICS REWRITE
 20365*           DATASET  (CRTT-ID)
 20366*           FROM     (CERTIFICATE-TRAILERS)
 20367*        END-EXEC
 20368     MOVE LENGTH OF
 20369      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 374
* EL050.cbl
 20370       TO DFHEIV11
 20371*    MOVE '&& L                  %   #00019556' TO DFHEIV0
 20372     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20373     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20374     MOVE X'2020233030303139353536' TO DFHEIV0(25:11)
 20375     CALL 'kxdfhei1' USING DFHEIV0,
 20376           CRTT-ID,
 20377           CERTIFICATE-TRAILERS,
 20378           DFHEIV11,
 20379           DFHEIV99
 20380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20381     ELSE
 20382
 20383* EXEC CICS UNLOCK
 20384*          DATASET  (CRTT-ID)
 20385*       END-EXEC
 20386*    MOVE '&*                    #   #00019561' TO DFHEIV0
 20387     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20388     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20389     MOVE X'2020233030303139353631' TO DFHEIV0(25:11)
 20390     CALL 'kxdfhei1' USING DFHEIV0,
 20391           CRTT-ID,
 20392           DFHEIV99
 20393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20394     END-IF.
 20395
 20396     GO TO 8180-EXIT.
 20397
 20398 8180-NOTFND.
 20399
 20400     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20401     MOVE 'CS'         TO CS-RECORD-ID.
 20402     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20403     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20404     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20405     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20406
 20407* EXEC CICS WRITE
 20408*       DATASET  (CRTT-ID)
 20409*       RIDFLD   (WS-ELCRTT-KEY)
 20410*       FROM     (CERTIFICATE-TRAILERS)
 20411*    END-EXEC.
 20412     MOVE LENGTH OF
 20413      CERTIFICATE-TRAILERS
 20414       TO DFHEIV11
 20415*    MOVE '&$ L                  ''   #00019576' TO DFHEIV0
 20416     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20417     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20418     MOVE X'2020233030303139353736' TO DFHEIV0(25:11)
 20419     CALL 'kxdfhei1' USING DFHEIV0,
 20420           CRTT-ID,
 20421           CERTIFICATE-TRAILERS,
 20422           DFHEIV11,
 20423           WS-ELCRTT-KEY,
 20424           DFHEIV99,
 20425           DFHEIV99
 20426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20427
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 375
* EL050.cbl
 20428
 20429 8180-EXIT.
 20430     EXIT.
 20431
 20432 8190-UPDATE-REFUND-CLAIM-FLAG.
 20433
 20434* EXEC CICS HANDLE CONDITION
 20435*        NOTFND   (8190-NOTFND)
 20436*    END-EXEC.
 20437*    MOVE '"$I                   ! 1 #00019586' TO DFHEIV0
 20438     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20440     MOVE X'3120233030303139353836' TO DFHEIV0(25:11)
 20441     CALL 'kxdfhei1' USING DFHEIV0
 20442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20443
 20444
 20445     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20446     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20447
 20448
 20449* EXEC CICS READ
 20450*        UPDATE
 20451*        DATASET  (CRTT-ID)
 20452*        RIDFLD   (WS-ELCRTT-KEY)
 20453*        INTO     (CERTIFICATE-TRAILERS)
 20454*    END-EXEC.
 20455     MOVE LENGTH OF
 20456      CERTIFICATE-TRAILERS
 20457       TO DFHEIV11
 20458*    MOVE '&"IL       EU         (   #00019593' TO DFHEIV0
 20459     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20461     MOVE X'2020233030303139353933' TO DFHEIV0(25:11)
 20462     CALL 'kxdfhei1' USING DFHEIV0,
 20463           CRTT-ID,
 20464           CERTIFICATE-TRAILERS,
 20465           DFHEIV11,
 20466           WS-ELCRTT-KEY,
 20467           DFHEIV99,
 20468           DFHEIV99,
 20469           DFHEIV99
 20470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20471
 20472
 20473     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20474
 20475* EXEC CICS REWRITE
 20476*       DATASET  (CRTT-ID)
 20477*       FROM     (CERTIFICATE-TRAILERS)
 20478*    END-EXEC.
 20479     MOVE LENGTH OF
 20480      CERTIFICATE-TRAILERS
 20481       TO DFHEIV11
 20482*    MOVE '&& L                  %   #00019601' TO DFHEIV0
 20483     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20484     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20485     MOVE X'2020233030303139363031' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 376
* EL050.cbl
 20486     CALL 'kxdfhei1' USING DFHEIV0,
 20487           CRTT-ID,
 20488           CERTIFICATE-TRAILERS,
 20489           DFHEIV11,
 20490           DFHEIV99
 20491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20492
 20493
 20494     GO TO 8190-EXIT.
 20495
 20496 8190-NOTFND.
 20497
 20498     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20499     MOVE 'CS'         TO CS-RECORD-ID.
 20500     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20501     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20502     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20503     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20504
 20505* EXEC CICS WRITE
 20506*       DATASET  (CRTT-ID)
 20507*       RIDFLD   (WS-ELCRTT-KEY)
 20508*       FROM     (CERTIFICATE-TRAILERS)
 20509*    END-EXEC.
 20510     MOVE LENGTH OF
 20511      CERTIFICATE-TRAILERS
 20512       TO DFHEIV11
 20513*    MOVE '&$ L                  ''   #00019616' TO DFHEIV0
 20514     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20515     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20516     MOVE X'2020233030303139363136' TO DFHEIV0(25:11)
 20517     CALL 'kxdfhei1' USING DFHEIV0,
 20518           CRTT-ID,
 20519           CERTIFICATE-TRAILERS,
 20520           DFHEIV11,
 20521           WS-ELCRTT-KEY,
 20522           DFHEIV99,
 20523           DFHEIV99
 20524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20525
 20526
 20527 8190-EXIT.
 20528     EXIT.
 20529
 20530 8195-UPDATE-AGE-FLAGS.
 20531
 20532* EXEC CICS HANDLE CONDITION
 20533*        NOTFND   (8195-NOTFND)
 20534*    END-EXEC.
 20535*    MOVE '"$I                   ! 2 #00019626' TO DFHEIV0
 20536     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20538     MOVE X'3220233030303139363236' TO DFHEIV0(25:11)
 20539     CALL 'kxdfhei1' USING DFHEIV0
 20540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20541
 20542
 20543     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 377
* EL050.cbl
 20544     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20545
 20546
 20547* EXEC CICS READ
 20548*        UPDATE
 20549*        DATASET  (CRTT-ID)
 20550*        RIDFLD   (WS-ELCRTT-KEY)
 20551*        INTO     (CERTIFICATE-TRAILERS)
 20552*    END-EXEC.
 20553     MOVE LENGTH OF
 20554      CERTIFICATE-TRAILERS
 20555       TO DFHEIV11
 20556*    MOVE '&"IL       EU         (   #00019633' TO DFHEIV0
 20557     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20558     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20559     MOVE X'2020233030303139363333' TO DFHEIV0(25:11)
 20560     CALL 'kxdfhei1' USING DFHEIV0,
 20561           CRTT-ID,
 20562           CERTIFICATE-TRAILERS,
 20563           DFHEIV11,
 20564           WS-ELCRTT-KEY,
 20565           DFHEIV99,
 20566           DFHEIV99,
 20567           DFHEIV99
 20568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20569
 20570
 20571     IF WS-INS-AGE-SET = 'Y'
 20572        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20573     END-IF
 20574     IF WS-JNT-AGE-SET = 'Y'
 20575        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20576     END-IF
 20577
 20578
 20579* EXEC CICS REWRITE
 20580*       DATASET  (CRTT-ID)
 20581*       FROM     (CERTIFICATE-TRAILERS)
 20582*    END-EXEC.
 20583     MOVE LENGTH OF
 20584      CERTIFICATE-TRAILERS
 20585       TO DFHEIV11
 20586*    MOVE '&& L                  %   #00019647' TO DFHEIV0
 20587     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20588     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20589     MOVE X'2020233030303139363437' TO DFHEIV0(25:11)
 20590     CALL 'kxdfhei1' USING DFHEIV0,
 20591           CRTT-ID,
 20592           CERTIFICATE-TRAILERS,
 20593           DFHEIV11,
 20594           DFHEIV99
 20595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20596
 20597
 20598     GO TO 8195-EXIT.
 20599
 20600 8195-NOTFND.
 20601
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 378
* EL050.cbl
 20602     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20603     MOVE 'CS'         TO CS-RECORD-ID.
 20604     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20605     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20606     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20607     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20608     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20609
 20610* EXEC CICS WRITE
 20611*       DATASET  (CRTT-ID)
 20612*       RIDFLD   (WS-ELCRTT-KEY)
 20613*       FROM     (CERTIFICATE-TRAILERS)
 20614*    END-EXEC.
 20615     MOVE LENGTH OF
 20616      CERTIFICATE-TRAILERS
 20617       TO DFHEIV11
 20618*    MOVE '&$ L                  ''   #00019663' TO DFHEIV0
 20619     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20620     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20621     MOVE X'2020233030303139363633' TO DFHEIV0(25:11)
 20622     CALL 'kxdfhei1' USING DFHEIV0,
 20623           CRTT-ID,
 20624           CERTIFICATE-TRAILERS,
 20625           DFHEIV11,
 20626           WS-ELCRTT-KEY,
 20627           DFHEIV99,
 20628           DFHEIV99
 20629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20630
 20631
 20632 8195-EXIT.
 20633     EXIT.
 20634
 20635 8200-READ-REIN-TABLE.
 20636
 20637* EXEC CICS HANDLE CONDITION
 20638*         NOTFND   (8200-NOTFND)
 20639*    END-EXEC.
 20640*    MOVE '"$I                   ! 3 #00019673' TO DFHEIV0
 20641     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20643     MOVE X'3320233030303139363733' TO DFHEIV0(25:11)
 20644     CALL 'kxdfhei1' USING DFHEIV0
 20645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20646
 20647
 20648
 20649* EXEC CICS READ
 20650*        DATASET     (REIN-ID)
 20651*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20652*        RIDFLD      (ERREIN-KEY)
 20653*    END-EXEC.
 20654*    MOVE '&"S        E          (   #00019677' TO DFHEIV0
 20655     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20657     MOVE X'2020233030303139363737' TO DFHEIV0(25:11)
 20658     CALL 'kxdfhei1' USING DFHEIV0,
 20659           REIN-ID,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 379
* EL050.cbl
 20660           DFHEIV20,
 20661           DFHEIV99,
 20662           ERREIN-KEY,
 20663           DFHEIV99,
 20664           DFHEIV99,
 20665           DFHEIV99
 20666     SET ADDRESS OF REINSURANCE-RECORD TO
 20667         DFHEIV20
 20668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20669
 20670
 20671     GO TO 8200-EXIT.
 20672
 20673 8200-NOTFND.
 20674     MOVE 'N'             TO WS-REIN-READ-SW.
 20675
 20676 8200-EXIT.
 20677      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 380
* EL050.cbl
 20679
 20680 8300-READ-CTBL-TABLE.
 20681
 20682* EXEC CICS HANDLE CONDITION
 20683*        NOTFND    (8300-NOTFND)
 20684*        DISABLED  (8300-ERRESS-PROBLEM)
 20685*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20686*        ENDFILE   (8300-NOTFND)
 20687*    END-EXEC.
 20688*    MOVE '"$IcJ''                ! 4 #00019693' TO DFHEIV0
 20689     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20691     MOVE X'3420233030303139363933' TO DFHEIV0(25:11)
 20692     CALL 'kxdfhei1' USING DFHEIV0
 20693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20694
 20695
 20696
 20697* EXEC CICS READ
 20698*        DATASET     (CTBL-ID)
 20699*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20700*        RIDFLD      (ERCTBL-KEY)
 20701*    END-EXEC.
 20702*    MOVE '&"S        E          (   #00019700' TO DFHEIV0
 20703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20705     MOVE X'2020233030303139373030' TO DFHEIV0(25:11)
 20706     CALL 'kxdfhei1' USING DFHEIV0,
 20707           CTBL-ID,
 20708           DFHEIV20,
 20709           DFHEIV99,
 20710           ERCTBL-KEY,
 20711           DFHEIV99,
 20712           DFHEIV99,
 20713           DFHEIV99
 20714     SET ADDRESS OF COMM-TABLE-RECORD TO
 20715         DFHEIV20
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
 20719     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20720
 20721     GO TO 8300-EXIT.
 20722
 20723 8300-NOTFND.
 20724
 20725     IF CTBL-SW = '0530'
 20726         MOVE 'AA'                     TO WS-AH-COMP-CD
 20727         MOVE '0550'                   TO CTBL-SW
 20728         MOVE '1'                      TO WS-CTBL-READ-SW
 20729         GO TO 8300-EXIT.
 20730
 20731     IF CTBL-SW = '0540'
 20732         MOVE 'AA'                     TO WS-LF-COMP-CD
 20733         MOVE '0550'                   TO CTBL-SW
 20734         MOVE '1'                      TO WS-CTBL-READ-SW
 20735         GO TO 8300-EXIT.
 20736
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 381
* EL050.cbl
 20737     IF CTBL-SW = '0550'
 20738         MOVE '2'                      TO WS-CTBL-READ-SW
 20739         GO TO 8300-EXIT.
 20740
 20741     GO TO 8300-EXIT.
 20742
 20743 8300-ERRESS-PROBLEM.
 20744
 20745      MOVE ER-8050              TO WS-ERROR.
 20746      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20747
 20748     GO TO 8300-EXIT.
 20749
 20750 8300-EXIT.
 20751      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 382
* EL050.cbl
 20753
 20754
 20755 8400-GETMAIN-ERFORM.
 20756
 20757
 20758* EXEC CICS   GETMAIN
 20759*        LENGTH  (500)
 20760*        SET     (ADDRESS OF FORM-MASTER)
 20761*    END-EXEC.
 20762     MOVE 500
 20763       TO DFHEIV11
 20764*    MOVE '," L                  $   #00019744' TO DFHEIV0
 20765     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20766     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20767     MOVE X'2020233030303139373434' TO DFHEIV0(25:11)
 20768     CALL 'kxdfhei1' USING DFHEIV0,
 20769           DFHEIV20,
 20770           DFHEIV11,
 20771           DFHEIV99
 20772     SET ADDRESS OF FORM-MASTER TO
 20773         DFHEIV20
 20774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20775
 20776
 20777     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20778
 20779 8400-EXIT.
 20780      EXIT.
 20781
 20782 8450-READ-FORM-MASTER.
 20783
 20784
 20785* EXEC CICS  HANDLE CONDITION
 20786*        NOTFND   (8450-FORM-NOT-FOUND)
 20787*        ENDFILE  (8450-FORM-NOT-FOUND)
 20788*    END-EXEC.
 20789*    MOVE '"$I''                  ! 5 #00019756' TO DFHEIV0
 20790     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20792     MOVE X'3520233030303139373536' TO DFHEIV0(25:11)
 20793     CALL 'kxdfhei1' USING DFHEIV0
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20795
 20796
 20797
 20798* EXEC CICS   READ
 20799*        DATASET   (FORM-ID)
 20800*        RIDFLD    (ERFORM-KEY)
 20801*        INTO      (FORM-MASTER)
 20802*        GTEQ
 20803*    END-EXEC.
 20804     MOVE LENGTH OF
 20805      FORM-MASTER
 20806       TO DFHEIV11
 20807*    MOVE '&"IL       G          (   #00019761' TO DFHEIV0
 20808     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20810     MOVE X'2020233030303139373631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 383
* EL050.cbl
 20811     CALL 'kxdfhei1' USING DFHEIV0,
 20812           FORM-ID,
 20813           FORM-MASTER,
 20814           DFHEIV11,
 20815           ERFORM-KEY,
 20816           DFHEIV99,
 20817           DFHEIV99,
 20818           DFHEIV99
 20819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20820
 20821
 20822     MOVE  'Y'           TO  FORM-MASTER-SW.
 20823
 20824     GO TO  8450-EXIT.
 20825
 20826 8450-FORM-NOT-FOUND.
 20827
 20828     MOVE  'N'           TO  FORM-MASTER-SW.
 20829
 20830 8450-EXIT.
 20831      EXIT.
 20832
 20833 8500-DATE-CONVERT.
 20834
 20835* EXEC CICS LINK
 20836*        PROGRAM    ('ELDATCV')
 20837*        COMMAREA   (DATE-CONVERSION-DATA)
 20838*        LENGTH     (DC-COMM-LENGTH)
 20839*    END-EXEC.
 20840     MOVE 'ELDATCV' TO DFHEIV1
 20841*    MOVE '."C                   (   #00019780' TO DFHEIV0
 20842     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20844     MOVE X'2020233030303139373830' TO DFHEIV0(25:11)
 20845     CALL 'kxdfhei1' USING DFHEIV0,
 20846           DFHEIV1,
 20847           DATE-CONVERSION-DATA,
 20848           DC-COMM-LENGTH,
 20849           DFHEIV99,
 20850           DFHEIV99,
 20851           DFHEIV99,
 20852           DFHEIV99
 20853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20854
 20855
 20856 8500-EXIT.
 20857     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 384
* EL050.cbl
 20859
 20860 8555-RELOAD-CONTROL-FILE.
 20861     CONTINUE.
 20862
 20863 8555-EXIT.
 20864     EXIT.
 20865
 20866 8557-GETMAIN-ERPLAN.
 20867
 20868
 20869* EXEC CICS GETMAIN
 20870*        LENGTH    (840)
 20871*        SET       (ADDRESS OF PLAN-RECORDS)
 20872*    END-EXEC.
 20873     MOVE 840
 20874       TO DFHEIV11
 20875*    MOVE '," L                  $   #00019798' TO DFHEIV0
 20876     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20877     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20878     MOVE X'2020233030303139373938' TO DFHEIV0(25:11)
 20879     CALL 'kxdfhei1' USING DFHEIV0,
 20880           DFHEIV20,
 20881           DFHEIV11,
 20882           DFHEIV99
 20883     SET ADDRESS OF PLAN-RECORDS TO
 20884         DFHEIV20
 20885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20886
 20887
 20888     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20889
 20890 8557-EXIT.
 20891     EXIT.
 20892
 20893 8560-GETMAIN.
 20894
 20895* EXEC CICS GETMAIN
 20896*        LENGTH    (2000)
 20897*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20898*    END-EXEC.
 20899     MOVE 2000
 20900       TO DFHEIV11
 20901*    MOVE '," L                  $   #00019809' TO DFHEIV0
 20902     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20904     MOVE X'2020233030303139383039' TO DFHEIV0(25:11)
 20905     CALL 'kxdfhei1' USING DFHEIV0,
 20906           DFHEIV20,
 20907           DFHEIV11,
 20908           DFHEIV99
 20909     SET ADDRESS OF ACCOUNT-MASTER TO
 20910         DFHEIV20
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
 20914     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20915
 20916 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 385
* EL050.cbl
 20917     EXIT.
 20918
 20919 8570-START-ACCOUNT-MASTER.
 20920
 20921* EXEC CICS HANDLE CONDITION
 20922*        NOTFND    (0199-ACCT-NOT-FOUND)
 20923*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20924*    END-EXEC.
 20925*    MOVE '"$I''                  ! 6 #00019820' TO DFHEIV0
 20926     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20928     MOVE X'3620233030303139383230' TO DFHEIV0(25:11)
 20929     CALL 'kxdfhei1' USING DFHEIV0
 20930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20931
 20932
 20933
 20934* EXEC CICS STARTBR
 20935*        DATASET    (ACCT-ID)
 20936*        RIDFLD     (ERACCT-KEY)
 20937*        GTEQ
 20938*    END-EXEC.
 20939     MOVE 0
 20940       TO DFHEIV11
 20941*    MOVE '&,         G          &   #00019825' TO DFHEIV0
 20942     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20943     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20944     MOVE X'2020233030303139383235' TO DFHEIV0(25:11)
 20945     CALL 'kxdfhei1' USING DFHEIV0,
 20946           ACCT-ID,
 20947           ERACCT-KEY,
 20948           DFHEIV99,
 20949           DFHEIV11,
 20950           DFHEIV99
 20951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20952
 20953
 20954 8570-EXIT.
 20955     EXIT.
 20956
 20957 8580-READ-ACCOUNT-MASTER.
 20958
 20959* EXEC CICS HANDLE CONDITION
 20960*        NOTFND    (0199-ACCT-NOT-FOUND)
 20961*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20962*    END-EXEC.
 20963*    MOVE '"$I''                  ! 7 #00019835' TO DFHEIV0
 20964     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20966     MOVE X'3720233030303139383335' TO DFHEIV0(25:11)
 20967     CALL 'kxdfhei1' USING DFHEIV0
 20968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20969
 20970
 20971
 20972* EXEC CICS READNEXT
 20973*        DATASET     (ACCT-ID)
 20974*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 386
* EL050.cbl
 20975*        RIDFLD      (ERACCT-KEY)
 20976*    END-EXEC.
 20977     MOVE LENGTH OF
 20978      ACCOUNT-MASTER
 20979       TO DFHEIV12
 20980     MOVE 0
 20981       TO DFHEIV11
 20982*    MOVE '&.IL                  )   #00019840' TO DFHEIV0
 20983     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20984     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20985     MOVE X'2020233030303139383430' TO DFHEIV0(25:11)
 20986     CALL 'kxdfhei1' USING DFHEIV0,
 20987           ACCT-ID,
 20988           ACCOUNT-MASTER,
 20989           DFHEIV12,
 20990           ERACCT-KEY,
 20991           DFHEIV99,
 20992           DFHEIV11,
 20993           DFHEIV99,
 20994           DFHEIV99
 20995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20996
 20997
 20998 8580-EXIT.
 20999     EXIT.
 21000
 21001 8582-READ-COMPENSATION-MASTER.
 21002
 21003* EXEC CICS HANDLE CONDITION
 21004*        NOTFND    (8582-COMP-NOT-FOUND)
 21005*        ENDFILE   (8582-COMP-NOT-FOUND)
 21006*    END-EXEC.
 21007*    MOVE '"$I''                  ! 8 #00019850' TO DFHEIV0
 21008     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21010     MOVE X'3820233030303139383530' TO DFHEIV0(25:11)
 21011     CALL 'kxdfhei1' USING DFHEIV0
 21012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21013
 21014
 21015
 21016* EXEC CICS READ
 21017*        DATASET     (COMP-ID)
 21018*        INTO        (COMPENSATION-MASTER)
 21019*        RIDFLD      (ERCOMP-KEY)
 21020*    END-EXEC.
 21021     MOVE LENGTH OF
 21022      COMPENSATION-MASTER
 21023       TO DFHEIV11
 21024*    MOVE '&"IL       E          (   #00019855' TO DFHEIV0
 21025     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21027     MOVE X'2020233030303139383535' TO DFHEIV0(25:11)
 21028     CALL 'kxdfhei1' USING DFHEIV0,
 21029           COMP-ID,
 21030           COMPENSATION-MASTER,
 21031           DFHEIV11,
 21032           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 387
* EL050.cbl
 21033           DFHEIV99,
 21034           DFHEIV99,
 21035           DFHEIV99
 21036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21037
 21038
 21039     MOVE 'Y'                    TO COMP-MASTER-SW
 21040
 21041     GO TO 8582-EXIT
 21042     .
 21043 8582-COMP-NOT-FOUND.
 21044
 21045     MOVE 'N'                    TO COMP-MASTER-SW.
 21046
 21047 8582-EXIT.
 21048     EXIT.
 21049
 21050 8583-READ-ERAGTC.
 21051
 21052* EXEC CICS HANDLE CONDITION
 21053*        NOTFND    (8583-AGTC-NOT-FOUND)
 21054*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21055*    END-EXEC.
 21056*    MOVE '"$I''                  ! 9 #00019873' TO DFHEIV0
 21057     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21059     MOVE X'3920233030303139383733' TO DFHEIV0(25:11)
 21060     CALL 'kxdfhei1' USING DFHEIV0
 21061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21062
 21063
 21064
 21065* EXEC CICS STARTBR
 21066*        DATASET    (AGTC-ID)
 21067*        RIDFLD     (ERAGTC-KEY)
 21068*        GTEQ
 21069*    END-EXEC.
 21070     MOVE 0
 21071       TO DFHEIV11
 21072*    MOVE '&,         G          &   #00019878' TO DFHEIV0
 21073     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21074     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21075     MOVE X'2020233030303139383738' TO DFHEIV0(25:11)
 21076     CALL 'kxdfhei1' USING DFHEIV0,
 21077           AGTC-ID,
 21078           ERAGTC-KEY,
 21079           DFHEIV99,
 21080           DFHEIV11,
 21081           DFHEIV99
 21082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21083
 21084
 21085 8583-READ-ERAGTC-NEXT.
 21086
 21087* EXEC CICS READNEXT
 21088*        DATASET     (AGTC-ID)
 21089*        INTO        (AGENT-COMMISSIONS)
 21090*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 388
* EL050.cbl
 21091*    END-EXEC.
 21092     MOVE LENGTH OF
 21093      AGENT-COMMISSIONS
 21094       TO DFHEIV12
 21095     MOVE 0
 21096       TO DFHEIV11
 21097*    MOVE '&.IL                  )   #00019885' TO DFHEIV0
 21098     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21099     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21100     MOVE X'2020233030303139383835' TO DFHEIV0(25:11)
 21101     CALL 'kxdfhei1' USING DFHEIV0,
 21102           AGTC-ID,
 21103           AGENT-COMMISSIONS,
 21104           DFHEIV12,
 21105           ERAGTC-KEY,
 21106           DFHEIV99,
 21107           DFHEIV11,
 21108           DFHEIV99,
 21109           DFHEIV99
 21110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21111
 21112
 21113*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21114
 21115     GO TO 8583-EXIT
 21116     .
 21117 8583-AGTC-NOT-FOUND.
 21118
 21119     MOVE 'N'                    TO AGTC-MASTER-SW.
 21120
 21121 8583-EXIT.
 21122     EXIT.
 21123
 21124 8584-READ-BANK-CROSS-REF.
 21125
 21126* EXEC CICS HANDLE CONDITION
 21127*        NOTFND    (8584-BXRF-NOT-FOUND)
 21128*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21129*    END-EXEC.
 21130*    MOVE '"$I''                  ! : #00019903' TO DFHEIV0
 21131     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21133     MOVE X'3A20233030303139393033' TO DFHEIV0(25:11)
 21134     CALL 'kxdfhei1' USING DFHEIV0
 21135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21136
 21137
 21138
 21139* EXEC CICS READ
 21140*        DATASET     (BXRF-ID)
 21141*        INTO        (BANK-CROSS-REFERENCE)
 21142*        RIDFLD      (ERBXRF-KEY)
 21143*        LENGTH      (BXRF-REC-LENGTH)
 21144*    END-EXEC.
 21145*    MOVE '&"IL       E          (   #00019908' TO DFHEIV0
 21146     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21148     MOVE X'2020233030303139393038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 389
* EL050.cbl
 21149     CALL 'kxdfhei1' USING DFHEIV0,
 21150           BXRF-ID,
 21151           BANK-CROSS-REFERENCE,
 21152           BXRF-REC-LENGTH,
 21153           ERBXRF-KEY,
 21154           DFHEIV99,
 21155           DFHEIV99,
 21156           DFHEIV99
 21157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21158
 21159
 21160     MOVE 'Y'                    TO BXRF-MASTER-SW
 21161
 21162     GO TO 8584-EXIT
 21163     .
 21164 8584-BXRF-NOT-FOUND.
 21165
 21166     MOVE 'N'                    TO BXRF-MASTER-SW.
 21167
 21168 8584-EXIT.
 21169     EXIT.
 21170
 21171 8585-READ-PLAN-MASTER.
 21172
 21173
 21174* EXEC CICS HANDLE CONDITION
 21175*        NOTFND    (8585-PLAN-NOT-FOUND)
 21176*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21177*    END-EXEC.
 21178*    MOVE '"$I''                  ! ; #00019928' TO DFHEIV0
 21179     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21181     MOVE X'3B20233030303139393238' TO DFHEIV0(25:11)
 21182     CALL 'kxdfhei1' USING DFHEIV0
 21183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21184
 21185
 21186
 21187* EXEC CICS READ
 21188*        DATASET     (PLAN-ID)
 21189*        INTO        (PLAN-MASTER)
 21190*        RIDFLD      (ERPLAN-KEY)
 21191*    END-EXEC.
 21192     MOVE LENGTH OF
 21193      PLAN-MASTER
 21194       TO DFHEIV11
 21195*    MOVE '&"IL       E          (   #00019933' TO DFHEIV0
 21196     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21198     MOVE X'2020233030303139393333' TO DFHEIV0(25:11)
 21199     CALL 'kxdfhei1' USING DFHEIV0,
 21200           PLAN-ID,
 21201           PLAN-MASTER,
 21202           DFHEIV11,
 21203           ERPLAN-KEY,
 21204           DFHEIV99,
 21205           DFHEIV99,
 21206           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 390
* EL050.cbl
 21207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21208
 21209
 21210     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21211
 21212     GO TO 8585-EXIT.
 21213
 21214 8585-PLAN-NOT-FOUND.
 21215
 21216     MOVE 'N'                    TO PLAN-MASTER-SW.
 21217
 21218 8585-EXIT.
 21219     EXIT.
 21220
 21221 8586-READ-LOAN-OFFICER.
 21222
 21223* EXEC CICS READ
 21224*        DATASET     (LOFC-ID)
 21225*        INTO        (LOAN-OFFICER-MASTER)
 21226*        RIDFLD      (ERLOFC-KEY)
 21227*        RESP        (WS-RESPONSE)
 21228*    END-EXEC
 21229     MOVE LENGTH OF
 21230      LOAN-OFFICER-MASTER
 21231       TO DFHEIV11
 21232*    MOVE '&"IL       E          (  N#00019951' TO DFHEIV0
 21233     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21235     MOVE X'204E233030303139393531' TO DFHEIV0(25:11)
 21236     CALL 'kxdfhei1' USING DFHEIV0,
 21237           LOFC-ID,
 21238           LOAN-OFFICER-MASTER,
 21239           DFHEIV11,
 21240           ERLOFC-KEY,
 21241           DFHEIV99,
 21242           DFHEIV99,
 21243           DFHEIV99
 21244     MOVE EIBRESP  TO WS-RESPONSE
 21245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21246
 21247     IF WS-RESP-NORMAL
 21248        MOVE 'Y'                 TO LOFC-MASTER-SW
 21249     ELSE
 21250        MOVE 'N'                 TO LOFC-MASTER-SW
 21251     END-IF
 21252     .
 21253 8586-EXIT.
 21254     EXIT.
 21255 8587-START-ERPDEF.
 21256
 21257* EXEC CICS STARTBR
 21258*       DATASET   (PDEF-ID)
 21259*       RIDFLD    (ERPDEF-KEY)
 21260*       GTEQ
 21261*       RESP      (WS-RESPONSE)
 21262*    END-EXEC
 21263     MOVE 0
 21264       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 391
* EL050.cbl
 21265*    MOVE '&,         G          &  N#00019967' TO DFHEIV0
 21266     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21267     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21268     MOVE X'204E233030303139393637' TO DFHEIV0(25:11)
 21269     CALL 'kxdfhei1' USING DFHEIV0,
 21270           PDEF-ID,
 21271           ERPDEF-KEY,
 21272           DFHEIV99,
 21273           DFHEIV11,
 21274           DFHEIV99
 21275     MOVE EIBRESP  TO WS-RESPONSE
 21276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21277     IF WS-RESP-NORMAL
 21278        MOVE 'Y'                 TO PDEF-MASTER-SW
 21279     ELSE
 21280        MOVE 'N'                 TO PDEF-MASTER-SW
 21281     END-IF
 21282     .
 21283 8587-EXIT.
 21284     EXIT.
 21285 8588-READ-ERPDEF.
 21286
 21287* EXEC CICS READNEXT
 21288*       DATASET   (PDEF-ID)
 21289*       RIDFLD    (ERPDEF-KEY)
 21290*       INTO      (PRODUCT-MASTER)
 21291*       RESP      (WS-RESPONSE)
 21292*    END-EXEC
 21293     MOVE LENGTH OF
 21294      PRODUCT-MASTER
 21295       TO DFHEIV12
 21296     MOVE 0
 21297       TO DFHEIV11
 21298*    MOVE '&.IL                  )  N#00019982' TO DFHEIV0
 21299     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21300     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21301     MOVE X'204E233030303139393832' TO DFHEIV0(25:11)
 21302     CALL 'kxdfhei1' USING DFHEIV0,
 21303           PDEF-ID,
 21304           PRODUCT-MASTER,
 21305           DFHEIV12,
 21306           ERPDEF-KEY,
 21307           DFHEIV99,
 21308           DFHEIV11,
 21309           DFHEIV99,
 21310           DFHEIV99
 21311     MOVE EIBRESP  TO WS-RESPONSE
 21312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21313     IF WS-RESP-NORMAL
 21314        MOVE 'Y'                 TO PDEF-MASTER-SW
 21315     ELSE
 21316        MOVE 'N'                 TO PDEF-MASTER-SW
 21317     END-IF
 21318     .
 21319 8588-EXIT.
 21320     EXIT.
 21321 8589-ENDBR-ERPDEF.
 21322
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 392
* EL050.cbl
 21323* EXEC CICS ENDBR
 21324*       DATASET   (PDEF-ID)
 21325*    END-EXEC
 21326     MOVE 0
 21327       TO DFHEIV11
 21328*    MOVE '&2                    $   #00019997' TO DFHEIV0
 21329     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21331     MOVE X'2020233030303139393937' TO DFHEIV0(25:11)
 21332     CALL 'kxdfhei1' USING DFHEIV0,
 21333           PDEF-ID,
 21334           DFHEIV11,
 21335           DFHEIV99
 21336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21337     .
 21338 8589-EXIT.
 21339     EXIT.
 21340 8590-READ-CERT-MASTER.
 21341     IF PB-COMPANY-ID = 'UCL'
 21342         GO TO 8690-READ-CERT-MASTER-UCL.
 21343
 21344
 21345* EXEC CICS HANDLE CONDITION
 21346*         NOTFND    (0299-CERT-NOT-FOUND)
 21347*    END-EXEC.
 21348*    MOVE '"$I                   ! < #00020007' TO DFHEIV0
 21349     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21351     MOVE X'3C20233030303230303037' TO DFHEIV0(25:11)
 21352     CALL 'kxdfhei1' USING DFHEIV0
 21353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21354
 21355
 21356
 21357* EXEC CICS READ
 21358*        DATASET     (CERT-ID)
 21359*        INTO        (CERTIFICATE-MASTER)
 21360*        RIDFLD      (ELCERT-KEY)
 21361*        UPDATE
 21362*    END-EXEC.
 21363     MOVE LENGTH OF
 21364      CERTIFICATE-MASTER
 21365       TO DFHEIV11
 21366*    MOVE '&"IL       EU         (   #00020011' TO DFHEIV0
 21367     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21368     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21369     MOVE X'2020233030303230303131' TO DFHEIV0(25:11)
 21370     CALL 'kxdfhei1' USING DFHEIV0,
 21371           CERT-ID,
 21372           CERTIFICATE-MASTER,
 21373           DFHEIV11,
 21374           ELCERT-KEY,
 21375           DFHEIV99,
 21376           DFHEIV99,
 21377           DFHEIV99
 21378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21379
 21380
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 393
* EL050.cbl
 21381 8590-EXIT.
 21382     EXIT.
 21383
 21384 8690-READ-CERT-MASTER-UCL.
 21385
 21386* EXEC CICS HANDLE CONDITION
 21387*         NOTFND    (8700-READ-CERT-MASTER)
 21388*    END-EXEC.
 21389*    MOVE '"$I                   ! = #00020022' TO DFHEIV0
 21390     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21392     MOVE X'3D20233030303230303232' TO DFHEIV0(25:11)
 21393     CALL 'kxdfhei1' USING DFHEIV0
 21394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21395
 21396
 21397 8690-READ-CERT-CONT.
 21398
 21399* EXEC CICS READ
 21400*        DATASET     (CERT-ID)
 21401*        INTO        (CERTIFICATE-MASTER)
 21402*        RIDFLD      (ELCERT-KEY)
 21403*        UPDATE
 21404*    END-EXEC.
 21405     MOVE LENGTH OF
 21406      CERTIFICATE-MASTER
 21407       TO DFHEIV11
 21408*    MOVE '&"IL       EU         (   #00020027' TO DFHEIV0
 21409     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21410     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21411     MOVE X'2020233030303230303237' TO DFHEIV0(25:11)
 21412     CALL 'kxdfhei1' USING DFHEIV0,
 21413           CERT-ID,
 21414           CERTIFICATE-MASTER,
 21415           DFHEIV11,
 21416           ELCERT-KEY,
 21417           DFHEIV99,
 21418           DFHEIV99,
 21419           DFHEIV99
 21420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21421
 21422
 21423     GO TO 8590-EXIT.
 21424
 21425 8700-READ-CERT-MASTER.
 21426     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21427     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21428
 21429* EXEC CICS HANDLE CONDITION
 21430*         DUPKEY    (8720-COMP-ACCOUNTS)
 21431*         ENDFILE   (8730-END-BROWSE)
 21432*         NOTFND    (8740-NOT-FOUND)
 21433*    END-EXEC.
 21434*    MOVE '"$$''I                 ! > #00020039' TO DFHEIV0
 21435     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21437     MOVE X'3E20233030303230303339' TO DFHEIV0(25:11)
 21438     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 394
* EL050.cbl
 21439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21440
 21441
 21442
 21443* EXEC CICS STARTBR
 21444*        DATASET     ('ELCERT5')
 21445*        RIDFLD      (ELCERT2-KEY)
 21446*        EQUAL
 21447*    END-EXEC.
 21448     MOVE 'ELCERT5' TO DFHEIV1
 21449     MOVE 0
 21450       TO DFHEIV11
 21451*    MOVE '&,         E          &   #00020045' TO DFHEIV0
 21452     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21454     MOVE X'2020233030303230303435' TO DFHEIV0(25:11)
 21455     CALL 'kxdfhei1' USING DFHEIV0,
 21456           DFHEIV1,
 21457           ELCERT2-KEY,
 21458           DFHEIV99,
 21459           DFHEIV11,
 21460           DFHEIV99
 21461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21462
 21463
 21464 8710-READ-NEXT.
 21465
 21466* EXEC CICS READNEXT
 21467*        DATASET     ('ELCERT5')
 21468*        INTO        (CERTIFICATE-MASTER)
 21469*        RIDFLD      (ELCERT2-KEY)
 21470*    END-EXEC.
 21471     MOVE LENGTH OF
 21472      CERTIFICATE-MASTER
 21473       TO DFHEIV12
 21474     MOVE 'ELCERT5' TO DFHEIV1
 21475     MOVE 0
 21476       TO DFHEIV11
 21477*    MOVE '&.IL                  )   #00020052' TO DFHEIV0
 21478     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21479     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21480     MOVE X'2020233030303230303532' TO DFHEIV0(25:11)
 21481     CALL 'kxdfhei1' USING DFHEIV0,
 21482           DFHEIV1,
 21483           CERTIFICATE-MASTER,
 21484           DFHEIV12,
 21485           ELCERT2-KEY,
 21486           DFHEIV99,
 21487           DFHEIV11,
 21488           DFHEIV99,
 21489           DFHEIV99
 21490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21491
 21492
 21493 8720-COMP-ACCOUNTS.
 21494
 21495* EXEC CICS ENTER
 21496*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 395
* EL050.cbl
 21497*         FROM (PB-C-LAST-NAME)
 21498*    END-EXEC.
 21499     MOVE 001
 21500       TO DFHEIV11
 21501*    MOVE ':$F                   %   #00020059' TO DFHEIV0
 21502     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21503     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21504     MOVE X'2020233030303230303539' TO DFHEIV0(25:11)
 21505     CALL 'kxdfhei1' USING DFHEIV0,
 21506           DFHEIV11,
 21507           PB-C-LAST-NAME,
 21508           DFHEIV99,
 21509           DFHEIV99
 21510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21511
 21512
 21513
 21514* EXEC CICS ENTER
 21515*         TRACEID (002)
 21516*         FROM (CM-INSURED-LAST-NAME)
 21517*    END-EXEC.
 21518     MOVE 002
 21519       TO DFHEIV11
 21520*    MOVE ':$F                   %   #00020064' TO DFHEIV0
 21521     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21522     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21523     MOVE X'2020233030303230303634' TO DFHEIV0(25:11)
 21524     CALL 'kxdfhei1' USING DFHEIV0,
 21525           DFHEIV11,
 21526           CM-INSURED-LAST-NAME,
 21527           DFHEIV99,
 21528           DFHEIV99
 21529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21530
 21531
 21532     IF PB-CERT-NO NOT = CM-CERT-NO
 21533         GO TO 8730-END-BROWSE.
 21534
 21535     IF PB-ACCOUNT = CM-ACCOUNT
 21536         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21537             MOVE ER-2799        TO WS-ERROR
 21538             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21539             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21540             GO TO 8730-END-BROWSE.
 21541
 21542     GO TO 8710-READ-NEXT.
 21543
 21544 8730-END-BROWSE.
 21545
 21546* EXEC CICS ENDBR
 21547*         DATASET    ('ELCERT5')
 21548*    END-EXEC.
 21549     MOVE 'ELCERT5' TO DFHEIV1
 21550     MOVE 0
 21551       TO DFHEIV11
 21552*    MOVE '&2                    $   #00020082' TO DFHEIV0
 21553     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21554     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 396
* EL050.cbl
 21555     MOVE X'2020233030303230303832' TO DFHEIV0(25:11)
 21556     CALL 'kxdfhei1' USING DFHEIV0,
 21557           DFHEIV1,
 21558           DFHEIV11,
 21559           DFHEIV99
 21560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21561
 21562
 21563 8740-NOT-FOUND.
 21564     GO TO 0299-CERT-NOT-FOUND.
 21565
 21566 8750-START-ELSTAT.
 21567
 21568* EXEC CICS STARTBR
 21569*       DATASET   (STAT-ID)
 21570*       RIDFLD    (ELSTAT-KEY)
 21571*       GTEQ
 21572*       RESP      (WS-RESPONSE)
 21573*    END-EXEC
 21574     MOVE 0
 21575       TO DFHEIV11
 21576*    MOVE '&,         G          &  N#00020090' TO DFHEIV0
 21577     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21578     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21579     MOVE X'204E233030303230303930' TO DFHEIV0(25:11)
 21580     CALL 'kxdfhei1' USING DFHEIV0,
 21581           STAT-ID,
 21582           ELSTAT-KEY,
 21583           DFHEIV99,
 21584           DFHEIV11,
 21585           DFHEIV99
 21586     MOVE EIBRESP  TO WS-RESPONSE
 21587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21588     IF WS-RESP-NORMAL
 21589        MOVE 'Y'                 TO STAT-MASTER-SW
 21590     ELSE
 21591        MOVE 'N'                 TO STAT-MASTER-SW
 21592     END-IF
 21593     .
 21594 8750-EXIT.
 21595     EXIT.
 21596 8752-READ-ELSTAT.
 21597
 21598* EXEC CICS READNEXT
 21599*       DATASET   (STAT-ID)
 21600*       RIDFLD    (ELSTAT-KEY)
 21601*       INTO      (STATE-FILE)
 21602*       RESP      (WS-RESPONSE)
 21603*    END-EXEC
 21604     MOVE LENGTH OF
 21605      STATE-FILE
 21606       TO DFHEIV12
 21607     MOVE 0
 21608       TO DFHEIV11
 21609*    MOVE '&.IL                  )  N#00020105' TO DFHEIV0
 21610     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21611     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21612     MOVE X'204E233030303230313035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 397
* EL050.cbl
 21613     CALL 'kxdfhei1' USING DFHEIV0,
 21614           STAT-ID,
 21615           STATE-FILE,
 21616           DFHEIV12,
 21617           ELSTAT-KEY,
 21618           DFHEIV99,
 21619           DFHEIV11,
 21620           DFHEIV99,
 21621           DFHEIV99
 21622     MOVE EIBRESP  TO WS-RESPONSE
 21623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21624     IF WS-RESP-NORMAL
 21625        MOVE 'Y'                 TO STAT-MASTER-SW
 21626     ELSE
 21627        MOVE 'N'                 TO STAT-MASTER-SW
 21628     END-IF
 21629     .
 21630 8752-EXIT.
 21631     EXIT.
 21632 8800-GET-COMP-RATE.
 21633     MOVE +1 TO IB.
 21634     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21635         ADD +9 TO IB
 21636         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21637             ADD +9 TO IB
 21638             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21639                MOVE ZEROS       TO WS-WK-RATE
 21640                GO TO 8800-EXIT.
 21641
 21642     IF PB-I-AGE GREATER CT-AGE (1)
 21643         ADD +3 TO IB
 21644         IF PB-I-AGE GREATER CT-AGE (2)
 21645             ADD +3 TO IB
 21646             IF PB-I-AGE GREATER CT-AGE (3)
 21647                MOVE ZEROS       TO WS-WK-RATE
 21648                GO TO 8800-EXIT.
 21649
 21650     IF WS-WORK-TERM GREATER CT-TRM (1)
 21651         ADD +1 TO IB
 21652         IF WS-WORK-TERM GREATER CT-TRM (2)
 21653             ADD +1 TO IB
 21654             IF WS-WORK-TERM GREATER CT-TRM (3)
 21655                MOVE ZEROS       TO WS-WK-RATE
 21656                GO TO 8800-EXIT.
 21657
 21658     IF CT-RT (IB) NOT NUMERIC
 21659         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21660         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21661         GO TO 8800-GET-COMP-RATE.
 21662
 21663     MOVE CT-RT (IB) TO WS-WK-RATE.
 21664
 21665 8800-EXIT.
 21666     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 398
* EL050.cbl
 21668 8900-ADDRESS-FILE.
 21669     IF ERACCT-FILE-ADDRESSED
 21670         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21671         GO TO 8900-ADDRESS-EXIT.
 21672
 21673     IF ELCNTL-FILE-ADDRESSED
 21674         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21675         GO TO 8900-ADDRESS-EXIT.
 21676
 21677     IF ERPLAN-FILE-ADDRESSED
 21678         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21679         GO TO 8900-ADDRESS-EXIT.
 21680
 21681     IF ERFORM-FILE-ADDRESSED
 21682         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21683         GO TO 8900-ADDRESS-EXIT.
 21684
 21685 8900-ADDRESS-EXIT.
 21686     EXIT.
 21687
 21688 9000-READ-CONTROL.
 21689
 21690* EXEC CICS HANDLE CONDITION
 21691*        NOTFND    (9000-NOTFND)
 21692*    END-EXEC.
 21693*    MOVE '"$I                   ! ? #00020176' TO DFHEIV0
 21694     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21696     MOVE X'3F20233030303230313736' TO DFHEIV0(25:11)
 21697     CALL 'kxdfhei1' USING DFHEIV0
 21698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21699
 21700
 21701
 21702* EXEC CICS READ
 21703*        DATASET     (CNTL-ID)
 21704*        SET         (ADDRESS OF CONTROL-FILE)
 21705*        RIDFLD      (ELCNTL-KEY)
 21706*        GTEQ
 21707*    END-EXEC.
 21708*    MOVE '&"S        G          (   #00020180' TO DFHEIV0
 21709     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21711     MOVE X'2020233030303230313830' TO DFHEIV0(25:11)
 21712     CALL 'kxdfhei1' USING DFHEIV0,
 21713           CNTL-ID,
 21714           DFHEIV20,
 21715           DFHEIV99,
 21716           ELCNTL-KEY,
 21717           DFHEIV99,
 21718           DFHEIV99,
 21719           DFHEIV99
 21720     SET ADDRESS OF CONTROL-FILE TO
 21721         DFHEIV20
 21722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21723
 21724
 21725     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 399
* EL050.cbl
 21726
 21727 9000-NOTFND.
 21728     IF RC-SW-1 = '1'
 21729        MOVE ER-2616              TO WS-ERROR
 21730        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21731        GO TO 9000-EXIT.
 21732
 21733     IF RC-SW-1 = '2'
 21734        MOVE ER-2602              TO WS-ERROR
 21735        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21736
 21737 9000-EXIT.
 21738      EXIT.
 21739
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 400
* EL050.cbl
 21741 9100-READ-CONTROL.
 21742
 21743* EXEC CICS HANDLE CONDITION
 21744*        NOTFND  (9100-NOTFND)
 21745*        ENDFILE (9100-NOTFND)
 21746*    END-EXEC.
 21747*    MOVE '"$I''                  ! @ #00020204' TO DFHEIV0
 21748     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21749     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21750     MOVE X'4020233030303230323034' TO DFHEIV0(25:11)
 21751     CALL 'kxdfhei1' USING DFHEIV0
 21752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21753
 21754
 21755
 21756* EXEC CICS READ
 21757*        DATASET     (CNTL-ID)
 21758*        INTO        (CONTROL-FILE)
 21759*        RIDFLD      (ELCNTL-KEY)
 21760*        GTEQ
 21761*    END-EXEC.
 21762     MOVE LENGTH OF
 21763      CONTROL-FILE
 21764       TO DFHEIV11
 21765*    MOVE '&"IL       G          (   #00020209' TO DFHEIV0
 21766     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21768     MOVE X'2020233030303230323039' TO DFHEIV0(25:11)
 21769     CALL 'kxdfhei1' USING DFHEIV0,
 21770           CNTL-ID,
 21771           CONTROL-FILE,
 21772           DFHEIV11,
 21773           ELCNTL-KEY,
 21774           DFHEIV99,
 21775           DFHEIV99,
 21776           DFHEIV99
 21777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21778
 21779
 21780     GO TO 9100-EXIT.
 21781
 21782 9100-NOTFND.
 21783     IF RC-SW-2 = '0'
 21784        MOVE '1'                  TO STATE-RECORD-ERROR
 21785        GO TO 9100-EXIT
 21786     END-IF
 21787     IF RC-SW-2 = '1'
 21788        MOVE '1'                  TO LF-BENEFIT-ERROR
 21789        MOVE ER-2604              TO WS-ERROR
 21790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21791        GO TO 9100-EXIT.
 21792
 21793     IF RC-SW-2 = '2'
 21794        MOVE '1'                  TO AH-BENEFIT-ERROR
 21795        MOVE ER-2605              TO WS-ERROR
 21796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21797        GO TO 9100-EXIT.
 21798
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 401
* EL050.cbl
 21799     IF RC-SW-2 = '3'
 21800         MOVE ER-2603           TO WS-ERROR
 21801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21802         GO TO 9100-EXIT.
 21803
 21804     IF RC-SW-2 = '4'
 21805         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21806         GO TO 9100-EXIT.
 21807
 21808     IF RC-SW-2 = '5'
 21809         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21810         IF WS-AH-INPUT-CD-1 = SPACE
 21811             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21812         ELSE
 21813             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21814
 21815 9100-EXIT.
 21816      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 402
* EL050.cbl
 21818 9200-CONTROL-GETMAIN.
 21819
 21820* EXEC CICS GETMAIN
 21821*         LENGTH   (750)
 21822*         SET      (ADDRESS OF CONTROL-FILE)
 21823*    END-EXEC.
 21824     MOVE 750
 21825       TO DFHEIV11
 21826*    MOVE '," L                  $   #00020255' TO DFHEIV0
 21827     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21828     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21829     MOVE X'2020233030303230323535' TO DFHEIV0(25:11)
 21830     CALL 'kxdfhei1' USING DFHEIV0,
 21831           DFHEIV20,
 21832           DFHEIV11,
 21833           DFHEIV99
 21834     SET ADDRESS OF CONTROL-FILE TO
 21835         DFHEIV20
 21836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21837
 21838
 21839     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21840
 21841 9200-EXIT.
 21842     EXIT.
 21843
 21844 9250-UNLOCK-RETURN.
 21845
 21846* EXEC CICS UNLOCK
 21847*        DATASET   (CERT-ID)
 21848*    END-EXEC.
 21849*    MOVE '&*                    #   #00020266' TO DFHEIV0
 21850     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21851     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21852     MOVE X'2020233030303230323636' TO DFHEIV0(25:11)
 21853     CALL 'kxdfhei1' USING DFHEIV0,
 21854           CERT-ID,
 21855           DFHEIV99
 21856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21857
 21858
 21859 9300-ABEND.
 21860     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21861
 21862
 21863* EXEC CICS LINK
 21864*        PROGRAM   ('EL004')
 21865*        COMMAREA  (WS-ERROR-LINE)
 21866*        LENGTH    (72)
 21867*    END-EXEC.
 21868     MOVE 'EL004' TO DFHEIV1
 21869     MOVE 72
 21870       TO DFHEIV11
 21871*    MOVE '."C                   (   #00020273' TO DFHEIV0
 21872     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21874     MOVE X'2020233030303230323733' TO DFHEIV0(25:11)
 21875     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 403
* EL050.cbl
 21876           DFHEIV1,
 21877           WS-ERROR-LINE,
 21878           DFHEIV11,
 21879           DFHEIV99,
 21880           DFHEIV99,
 21881           DFHEIV99,
 21882           DFHEIV99
 21883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21884
 21885
 21886     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21887
 21888
 21889* EXEC CICS ABEND
 21890*        ABCODE ('EL50')
 21891*    END-EXEC.
 21892     MOVE 'EL50' TO DFHEIV5
 21893*    MOVE '.,A                   "   #00020281' TO DFHEIV0
 21894     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21895     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21896     MOVE X'2020233030303230323831' TO DFHEIV0(25:11)
 21897     CALL 'kxdfhei1' USING DFHEIV0,
 21898           DFHEIV5
 21899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21900
 21901
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 404
* EL050.cbl
 21903
 21904******************************************************************
 21905*                                                                *
 21906*            E R R O R   F O R M A T   R O U T I N E             *
 21907*                                                                *
 21908******************************************************************
 21909
 21910 9900-ERROR-FORMAT.
 21911
 21912     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21913                    PB-COMMON-ERROR (2) OR
 21914                    PB-COMMON-ERROR (3) OR
 21915                    PB-COMMON-ERROR (4) OR
 21916                    PB-COMMON-ERROR (5) OR
 21917                    PB-COMMON-ERROR (6) OR
 21918                    PB-COMMON-ERROR (7) OR
 21919                    PB-COMMON-ERROR (8) OR
 21920                    PB-COMMON-ERROR (9) OR
 21921                    PB-COMMON-ERROR (10)
 21922        GO TO 9900-EXIT.
 21923
 21924     IF PB-NO-OF-ERRORS = +10
 21925        GO TO 9900-EXIT.
 21926
 21927     ADD +1  TO PB-NO-OF-ERRORS.
 21928     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21929                                       (PB-NO-OF-ERRORS).
 21930 9900-EXIT.
 21931     EXIT.
 21932
 21933 9990-RETURN.
 21934     IF BROWSE-STARTED
 21935
 21936* EXEC CICS ENDBR
 21937*            DATASET  (ACCT-ID)
 21938*       END-EXEC.
 21939     MOVE 0
 21940       TO DFHEIV11
 21941*    MOVE '&2                    $   #00020318' TO DFHEIV0
 21942     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21943     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21944     MOVE X'2020233030303230333138' TO DFHEIV0(25:11)
 21945     CALL 'kxdfhei1' USING DFHEIV0,
 21946           ACCT-ID,
 21947           DFHEIV11,
 21948           DFHEIV99
 21949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21950
 21951
 21952 9990-EXIT.
 21953     EXIT.
 21954
 21955
 21956****Check for CRTO record, add one if not found.
 21957 9991-CHECK-FOR-ELCRTO.
 21958
 21959* EXEC CICS HANDLE CONDITION
 21960*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 405
* EL050.cbl
 21961*         ENDFILE (9991-CRTO-NOT-FOUND)
 21962*     END-EXEC.
 21963*    MOVE '"$I''                  ! A #00020328' TO DFHEIV0
 21964     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21966     MOVE X'4120233030303230333238' TO DFHEIV0(25:11)
 21967     CALL 'kxdfhei1' USING DFHEIV0
 21968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21969
 21970     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21971     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21972     MOVE +0                     TO ELCRTO-SEQ-NO
 21973
 21974
 21975* EXEC CICS READ
 21976*       DATASET   ('ELCRTO')
 21977*       INTO      (ORIGINAL-CERTIFICATE)
 21978*       RIDFLD    (ELCRTO-KEY)
 21979*       GTEQ
 21980*       RESP      (WS-RESPONSE)
 21981*    END-EXEC
 21982     MOVE LENGTH OF
 21983      ORIGINAL-CERTIFICATE
 21984       TO DFHEIV11
 21985     MOVE 'ELCRTO' TO DFHEIV1
 21986*    MOVE '&"IL       G          (  N#00020336' TO DFHEIV0
 21987     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21989     MOVE X'204E233030303230333336' TO DFHEIV0(25:11)
 21990     CALL 'kxdfhei1' USING DFHEIV0,
 21991           DFHEIV1,
 21992           ORIGINAL-CERTIFICATE,
 21993           DFHEIV11,
 21994           ELCRTO-KEY,
 21995           DFHEIV99,
 21996           DFHEIV99,
 21997           DFHEIV99
 21998     MOVE EIBRESP  TO WS-RESPONSE
 21999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22000
 22001     IF WS-RESP-NORMAL
 22002        AND (OC-CONTROL-PRIMARY (1:33) =
 22003                 PB-CONTROL-BY-ACCOUNT (1:33))
 22004        AND (OC-RECORD-TYPE =  'I')
 22005           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22006               GO TO 9991-CHECK-INDICATORS
 22007           ELSE
 22008               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22009               GO TO 9991-CRTO-ADD-REC
 22010           END-IF
 22011     END-IF.
 22012
 22013 9991-CRTO-NOT-FOUND.
 22014
 22015     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22016     MOVE 'OC'                TO OC-RECORD-ID
 22017     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22018                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 406
* EL050.cbl
 22019     MOVE +4096               TO OC-KEY-SEQ-NO.
 22020
 22021 9991-CRTO-ADD-REC.
 22022
 22023     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22024     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22025     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22026     MOVE 'I'                 TO OC-RECORD-TYPE
 22027     IF PB-ISSUE
 22028         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22029         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22030         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22031         MOVE PB-I-AGE               TO OC-INS-AGE
 22032         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22033         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22034         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22035         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22036         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22037         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22038         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22039         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22040         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22041         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22042         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22043         IF PB-I-JOINT-COMMISSION > +0
 22044             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22045         ELSE
 22046             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22047         END-IF
 22048         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22049         MOVE +0                     TO OC-LF-CANCEL-AMT
 22050                                        OC-LF-ITD-CANCEL-AMT
 22051         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22052         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22053         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22054         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22055         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22056         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22057         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22058         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22059         MOVE +0                     TO OC-AH-CANCEL-AMT
 22060                                        OC-AH-ITD-CANCEL-AMT
 22061         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22062         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22063         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22064     ELSE
 22065         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22066         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22067         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22068         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22069         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22070         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22071         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22072         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22073         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22074          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22075             MOVE SPACES             TO OC-LF-BENCD
 22076             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 407
* EL050.cbl
 22077                                        OC-LF-BEN-AMT
 22078                                        OC-LF-PRM-AMT
 22079                                        OC-LF-ALT-BEN-AMT
 22080                                        OC-LF-ALT-PRM-AMT
 22081                                        OC-LF-COMM-PCT
 22082                                        OC-LF-CANCEL-AMT
 22083             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22084             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22085         ELSE
 22086             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22087             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22088             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22089             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22090             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22091             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22092             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22093             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22094             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22095             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22096         END-IF
 22097         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22098         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22099          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22100             MOVE SPACES             TO OC-AH-BENCD
 22101             MOVE ZEROS              TO OC-AH-TERM
 22102                                        OC-AH-BEN-AMT
 22103                                        OC-AH-PRM-AMT
 22104                                        OC-AH-COMM-PCT
 22105                                        OC-AH-CANCEL-AMT
 22106                                        OC-AH-CP
 22107             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22108             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22109         ELSE
 22110             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22111             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22112             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22113             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22114             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22115             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22116             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22117             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22118             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22119         END-IF
 22120         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22121         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22122         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22123         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22124     END-IF
 22125     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22126
 22127     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22128
 22129
 22130* EXEC CICS READ
 22131*         DATASET   (FILE-ERMAIL)
 22132*         RIDFLD    (MA-CONTROL-PRIMARY)
 22133*         INTO      (MAILING-DATA)
 22134*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 408
* EL050.cbl
 22135*    END-EXEC
 22136     MOVE LENGTH OF
 22137      MAILING-DATA
 22138       TO DFHEIV11
 22139*    MOVE '&"IL       E          (  N#00020472' TO DFHEIV0
 22140     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22142     MOVE X'204E233030303230343732' TO DFHEIV0(25:11)
 22143     CALL 'kxdfhei1' USING DFHEIV0,
 22144           FILE-ERMAIL,
 22145           MAILING-DATA,
 22146           DFHEIV11,
 22147           MA-CONTROL-PRIMARY,
 22148           DFHEIV99,
 22149           DFHEIV99,
 22150           DFHEIV99
 22151     MOVE EIBRESP  TO WS-RESPONSE
 22152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22153
 22154     IF WS-RESP-NORMAL
 22155         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22156     END-IF.
 22157
 22158     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22159     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22160
 22161
 22162* EXEC CICS READ
 22163*         DATASET  (CRTT-ID)
 22164*         RIDFLD   (WS-ELCRTT-KEY)
 22165*         INTO     (CERTIFICATE-TRAILERS)
 22166*         RESP     (WS-RESPONSE)
 22167*    END-EXEC
 22168     MOVE LENGTH OF
 22169      CERTIFICATE-TRAILERS
 22170       TO DFHEIV11
 22171*    MOVE '&"IL       E          (  N#00020486' TO DFHEIV0
 22172     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22174     MOVE X'204E233030303230343836' TO DFHEIV0(25:11)
 22175     CALL 'kxdfhei1' USING DFHEIV0,
 22176           CRTT-ID,
 22177           CERTIFICATE-TRAILERS,
 22178           DFHEIV11,
 22179           WS-ELCRTT-KEY,
 22180           DFHEIV99,
 22181           DFHEIV99,
 22182           DFHEIV99
 22183     MOVE EIBRESP  TO WS-RESPONSE
 22184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22185
 22186     IF WS-RESP-NORMAL
 22187         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22188         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22189     END-IF.
 22190
 22191
 22192* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 409
* EL050.cbl
 22193*       DATASET   ('ELCRTO')
 22194*       FROM      (ORIGINAL-CERTIFICATE)
 22195*       RIDFLD    (OC-CONTROL-PRIMARY)
 22196*       RESP      (WS-RESPONSE)
 22197*    END-EXEC.
 22198     MOVE LENGTH OF
 22199      ORIGINAL-CERTIFICATE
 22200       TO DFHEIV11
 22201     MOVE 'ELCRTO' TO DFHEIV1
 22202*    MOVE '&$ L                  ''  N#00020498' TO DFHEIV0
 22203     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22204     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22205     MOVE X'204E233030303230343938' TO DFHEIV0(25:11)
 22206     CALL 'kxdfhei1' USING DFHEIV0,
 22207           DFHEIV1,
 22208           ORIGINAL-CERTIFICATE,
 22209           DFHEIV11,
 22210           OC-CONTROL-PRIMARY,
 22211           DFHEIV99,
 22212           DFHEIV99
 22213     MOVE EIBRESP  TO WS-RESPONSE
 22214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22215
 22216
 22217     GO TO 9991-EXIT.
 22218
 22219 9991-CHECK-INDICATORS.
 22220
 22221     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22222         GO TO 9991-EXIT
 22223     END-IF.
 22224
 22225     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22226         GO TO 9991-EXIT
 22227     END-IF.
 22228
 22229
 22230* EXEC CICS READ
 22231*       DATASET   ('ELCRTO')
 22232*       INTO      (ORIGINAL-CERTIFICATE)
 22233*       RIDFLD    (OC-CONTROL-PRIMARY)
 22234*       UPDATE
 22235*       RESP      (WS-RESPONSE)
 22236*    END-EXEC
 22237     MOVE LENGTH OF
 22238      ORIGINAL-CERTIFICATE
 22239       TO DFHEIV11
 22240     MOVE 'ELCRTO' TO DFHEIV1
 22241*    MOVE '&"IL       EU         (  N#00020517' TO DFHEIV0
 22242     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22243     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22244     MOVE X'204E233030303230353137' TO DFHEIV0(25:11)
 22245     CALL 'kxdfhei1' USING DFHEIV0,
 22246           DFHEIV1,
 22247           ORIGINAL-CERTIFICATE,
 22248           DFHEIV11,
 22249           OC-CONTROL-PRIMARY,
 22250           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 410
* EL050.cbl
 22251           DFHEIV99,
 22252           DFHEIV99
 22253     MOVE EIBRESP  TO WS-RESPONSE
 22254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22255     IF WS-RESP-NORMAL
 22256        IF PB-ISSUE
 22257          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22258          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22259          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22260          MOVE PB-I-AGE               TO OC-INS-AGE
 22261          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22262          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22263          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22264          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22265          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22266          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22267          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22268          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22269          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22270          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22271          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22272          IF PB-I-JOINT-COMMISSION > +0
 22273              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22274          ELSE
 22275              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22276          END-IF
 22277          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22278          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22279          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22280          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22281          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22282          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22283          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22284          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22285          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22286
 22287          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22288
 22289* EXEC CICS READ
 22290*             DATASET   (FILE-ERMAIL)
 22291*             RIDFLD    (MA-CONTROL-PRIMARY)
 22292*             INTO      (MAILING-DATA)
 22293*             RESP      (WS-RESPONSE)
 22294*         END-EXEC
 22295     MOVE LENGTH OF
 22296      MAILING-DATA
 22297       TO DFHEIV11
 22298*    MOVE '&"IL       E          (  N#00020557' TO DFHEIV0
 22299     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22301     MOVE X'204E233030303230353537' TO DFHEIV0(25:11)
 22302     CALL 'kxdfhei1' USING DFHEIV0,
 22303           FILE-ERMAIL,
 22304           MAILING-DATA,
 22305           DFHEIV11,
 22306           MA-CONTROL-PRIMARY,
 22307           DFHEIV99,
 22308           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 411
* EL050.cbl
 22309           DFHEIV99
 22310     MOVE EIBRESP  TO WS-RESPONSE
 22311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22312          IF WS-RESP-NORMAL
 22313             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22314          END-IF
 22315
 22316          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22317          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22318
 22319* EXEC CICS READ
 22320*             DATASET  (CRTT-ID)
 22321*             RIDFLD   (WS-ELCRTT-KEY)
 22322*             INTO     (CERTIFICATE-TRAILERS)
 22323*             RESP     (WS-RESPONSE)
 22324*         END-EXEC
 22325     MOVE LENGTH OF
 22326      CERTIFICATE-TRAILERS
 22327       TO DFHEIV11
 22328*    MOVE '&"IL       E          (  N#00020569' TO DFHEIV0
 22329     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22331     MOVE X'204E233030303230353639' TO DFHEIV0(25:11)
 22332     CALL 'kxdfhei1' USING DFHEIV0,
 22333           CRTT-ID,
 22334           CERTIFICATE-TRAILERS,
 22335           DFHEIV11,
 22336           WS-ELCRTT-KEY,
 22337           DFHEIV99,
 22338           DFHEIV99,
 22339           DFHEIV99
 22340     MOVE EIBRESP  TO WS-RESPONSE
 22341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22342          IF WS-RESP-NORMAL
 22343             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22344                               OC-INS-AGE-DEFAULT-FLAG
 22345             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22346                               OC-JNT-AGE-DEFAULT-FLAG
 22347          END-IF
 22348
 22349        ELSE
 22350          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22351             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22352             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22353             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22354          END-IF
 22355          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22356             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22357             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22358             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22359          END-IF
 22360          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22361        END-IF
 22362
 22363* EXEC CICS REWRITE
 22364*          DATASET   ('ELCRTO')
 22365*          FROM      (ORIGINAL-CERTIFICATE)
 22366*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 412
* EL050.cbl
 22367*       END-EXEC
 22368     MOVE LENGTH OF
 22369      ORIGINAL-CERTIFICATE
 22370       TO DFHEIV11
 22371     MOVE 'ELCRTO' TO DFHEIV1
 22372*    MOVE '&& L                  %  N#00020595' TO DFHEIV0
 22373     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22374     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22375     MOVE X'204E233030303230353935' TO DFHEIV0(25:11)
 22376     CALL 'kxdfhei1' USING DFHEIV0,
 22377           DFHEIV1,
 22378           ORIGINAL-CERTIFICATE,
 22379           DFHEIV11,
 22380           DFHEIV99
 22381     MOVE EIBRESP  TO WS-RESPONSE
 22382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22383     END-IF.
 22384
 22385 9991-EXIT.
 22386     EXIT.
 22387
 22388
 22389 9999-RETURN.
 22390     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22391
 22392
 22393* EXEC CICS RETURN
 22394*    END-EXEC.
 22395*    MOVE '.(                    ''   #00020609' TO DFHEIV0
 22396     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22397     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22398     MOVE X'2020233030303230363039' TO DFHEIV0(25:11)
 22399     CALL 'kxdfhei1' USING DFHEIV0,
 22400           DFHEIV99,
 22401           DFHEIV99,
 22402           DFHEIV99,
 22403           DFHEIV99,
 22404           DFHEIV99,
 22405           DFHEIV99
 22406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22407
 22408
 22409
 22410* GOBACK.
 22411     MOVE '9%                    "   ' TO DFHEIV0
 22412     MOVE 'EL050' TO DFHEIV1
 22413     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22414     GOBACK.
 22415
 22416 9999-DFHBACK SECTION.
 22417     MOVE '9%                    "   ' TO DFHEIV0
 22418     MOVE 'EL050' TO DFHEIV1
 22419     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22420     GOBACK.
 22421 9999-DFHEXIT.
 22422     IF DFHEIGDJ EQUAL 0001
 22423         NEXT SENTENCE
 22424     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 413
* EL050.cbl
 22425         GO TO 9300-ABEND,
 22426               3990-FILES-NOT-OPEN
 22427         DEPENDING ON DFHEIGDI
 22428     ELSE IF DFHEIGDJ EQUAL 3
 22429         GO TO 6610-START-BROWSE,
 22430               6630-ERRESS-PROBLEM,
 22431               6630-END-OF-FILE
 22432         DEPENDING ON DFHEIGDI
 22433     ELSE IF DFHEIGDJ EQUAL 4
 22434         GO TO 6630-END-OF-FILE,
 22435               6630-ERRESS-PROBLEM,
 22436               6630-ERRESS-PROBLEM,
 22437               6630-END-OF-FILE
 22438         DEPENDING ON DFHEIGDI
 22439     ELSE IF DFHEIGDJ EQUAL 5
 22440         GO TO 6630-END-OF-FILE,
 22441               6630-END-OF-FILE,
 22442               6630-ERRESS-PROBLEM,
 22443               6630-ERRESS-PROBLEM
 22444         DEPENDING ON DFHEIGDI
 22445     ELSE IF DFHEIGDJ EQUAL 6
 22446         GO TO 6660-START-BROWSE,
 22447               6690-ERRESC-PROBLEM,
 22448               6690-ERRESC-PROBLEM,
 22449               6690-END-OF-FILE
 22450         DEPENDING ON DFHEIGDI
 22451     ELSE IF DFHEIGDJ EQUAL 7
 22452         GO TO 6690-END-OF-FILE,
 22453               6690-ERRESC-PROBLEM,
 22454               6690-ERRESC-PROBLEM,
 22455               6690-END-OF-FILE
 22456         DEPENDING ON DFHEIGDI
 22457     ELSE IF DFHEIGDJ EQUAL 8
 22458         GO TO 6690-END-OF-FILE,
 22459               6690-ERRESC-PROBLEM,
 22460               6690-ERRESC-PROBLEM,
 22461               6690-END-OF-FILE
 22462         DEPENDING ON DFHEIGDI
 22463     ELSE IF DFHEIGDJ EQUAL 9
 22464         GO TO 7250-CONTINUE,
 22465               7250-CONTINUE
 22466         DEPENDING ON DFHEIGDI
 22467     ELSE IF DFHEIGDJ EQUAL 10
 22468         GO TO 7300-CONTINUE,
 22469               7300-CONTINUE
 22470         DEPENDING ON DFHEIGDI
 22471     ELSE IF DFHEIGDJ EQUAL 11
 22472         GO TO 8000-FREE-MAIN
 22473         DEPENDING ON DFHEIGDI
 22474     ELSE IF DFHEIGDJ EQUAL 12
 22475         GO TO 8100-NOTFND,
 22476               8100-NOTFND
 22477         DEPENDING ON DFHEIGDI
 22478     ELSE IF DFHEIGDJ EQUAL 13
 22479         GO TO 8110-NOTFND,
 22480               8110-NOTFND
 22481         DEPENDING ON DFHEIGDI
 22482     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 414
* EL050.cbl
 22483         GO TO 8130-EXIT
 22484         DEPENDING ON DFHEIGDI
 22485     ELSE IF DFHEIGDJ EQUAL 15
 22486         GO TO 8150-exit
 22487         DEPENDING ON DFHEIGDI
 22488     ELSE IF DFHEIGDJ EQUAL 16
 22489         GO TO 8180-NOTFND
 22490         DEPENDING ON DFHEIGDI
 22491     ELSE IF DFHEIGDJ EQUAL 17
 22492         GO TO 8190-NOTFND
 22493         DEPENDING ON DFHEIGDI
 22494     ELSE IF DFHEIGDJ EQUAL 18
 22495         GO TO 8195-NOTFND
 22496         DEPENDING ON DFHEIGDI
 22497     ELSE IF DFHEIGDJ EQUAL 19
 22498         GO TO 8200-NOTFND
 22499         DEPENDING ON DFHEIGDI
 22500     ELSE IF DFHEIGDJ EQUAL 20
 22501         GO TO 8300-NOTFND,
 22502               8300-ERRESS-PROBLEM,
 22503               8300-ERRESS-PROBLEM,
 22504               8300-NOTFND
 22505         DEPENDING ON DFHEIGDI
 22506     ELSE IF DFHEIGDJ EQUAL 21
 22507         GO TO 8450-FORM-NOT-FOUND,
 22508               8450-FORM-NOT-FOUND
 22509         DEPENDING ON DFHEIGDI
 22510     ELSE IF DFHEIGDJ EQUAL 22
 22511         GO TO 0199-ACCT-NOT-FOUND,
 22512               0199-ACCT-NOT-FOUND
 22513         DEPENDING ON DFHEIGDI
 22514     ELSE IF DFHEIGDJ EQUAL 23
 22515         GO TO 0199-ACCT-NOT-FOUND,
 22516               0199-ACCT-NOT-FOUND
 22517         DEPENDING ON DFHEIGDI
 22518     ELSE IF DFHEIGDJ EQUAL 24
 22519         GO TO 8582-COMP-NOT-FOUND,
 22520               8582-COMP-NOT-FOUND
 22521         DEPENDING ON DFHEIGDI
 22522     ELSE IF DFHEIGDJ EQUAL 25
 22523         GO TO 8583-AGTC-NOT-FOUND,
 22524               8583-AGTC-NOT-FOUND
 22525         DEPENDING ON DFHEIGDI
 22526     ELSE IF DFHEIGDJ EQUAL 26
 22527         GO TO 8584-BXRF-NOT-FOUND,
 22528               8584-BXRF-NOT-FOUND
 22529         DEPENDING ON DFHEIGDI
 22530     ELSE IF DFHEIGDJ EQUAL 27
 22531         GO TO 8585-PLAN-NOT-FOUND,
 22532               8585-PLAN-NOT-FOUND
 22533         DEPENDING ON DFHEIGDI
 22534     ELSE IF DFHEIGDJ EQUAL 28
 22535         GO TO 0299-CERT-NOT-FOUND
 22536         DEPENDING ON DFHEIGDI
 22537     ELSE IF DFHEIGDJ EQUAL 29
 22538         GO TO 8700-READ-CERT-MASTER
 22539         DEPENDING ON DFHEIGDI
 22540     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:57 Page 415
* EL050.cbl
 22541         GO TO 8720-COMP-ACCOUNTS,
 22542               8730-END-BROWSE,
 22543               8740-NOT-FOUND
 22544         DEPENDING ON DFHEIGDI
 22545     ELSE IF DFHEIGDJ EQUAL 31
 22546         GO TO 9000-NOTFND
 22547         DEPENDING ON DFHEIGDI
 22548     ELSE IF DFHEIGDJ EQUAL 32
 22549         GO TO 9100-NOTFND,
 22550               9100-NOTFND
 22551         DEPENDING ON DFHEIGDI
 22552     ELSE IF DFHEIGDJ EQUAL 33
 22553         GO TO 9991-CRTO-NOT-FOUND,
 22554               9991-CRTO-NOT-FOUND
 22555         DEPENDING ON DFHEIGDI.
 22556     MOVE '9%                    "   ' TO DFHEIV0
 22557     MOVE 'EL050' TO DFHEIV1
 22558     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22559     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41464     Code:       91989
