* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   1
* EL691.cbl
* Options: int("EL691.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL691.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL691.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL691.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL691.
     4*
     5*AUTHOR.    LOGIC, INC.
     6*           DALLAS, TEXAS.
     7
     8*DATE-COMPILED.
     9
    10*REMARKS.
    11*        THIS PROGRAM PROVIDES THE FUNCTIONS TO BROWSE AND EDIT
    12*    THE DETAIL OF AN ARCHIVED LETTER.
    13
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   2
* EL691.cbl
    14*    TRANS ID = EXN1
    15
    16******************************************************************
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 071111    2011022800001  AJRA  NAPERSOFT - NEW SCREEN
    25* 100312    2011022800001  AJRA  CHANGE RECEIVED MSG
    26* 121112    2012101700002  AJRA  ADD PF6 TO CERT NOTE, ENDT ARCH N
    27* 122612    2012101700002  AJRA  UPDATE BILLING NOTE ON RECEIVED
    28******************************************************************
    29
    30 DATA DIVISION.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32) VALUE '********************************'.
    34 77  FILLER  PIC X(32) VALUE '*    EL691 WORKING STORAGE     *'.
    35 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   3
* EL691.cbl
    37
    38 01  W-WORK-AREAS.
    39     12  FILLER                  PIC  X(18)
    40                                      VALUE 'PROGRAM WORK AREA:'.
    41     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
    42     12  W-CALL-PGM              PIC  X(08).
    43     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
    44     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
    45     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
    46
    47     12  W-TIME-IN               PIC S9(07).
    48     12  FILLER REDEFINES W-TIME-IN.
    49         16  FILLER              PIC  X(01).
    50         16  W-TIME-OUT          PIC  9(02)V9(02).
    51         16  FILLER              PIC  X(02).
    52
    53     12  W-DEEDIT-FIELD          PIC  X(15).
    54     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
    55
    56     12  W-ERROR-COUNT           PIC S9(3)       VALUE ZERO.
    57     12  W-UPDATE-SW             PIC S9          VALUE ZERO.
    58     12  W-RESEND-DATE           PIC XX    VALUE LOW-VALUES.
    59     12  W-SENT-DATE             PIC XX    VALUE LOW-VALUES.
    60     12  W-FINAL-ACT-DATE        PIC XX    VALUE LOW-VALUES.
    61     12  W-RECEIVED-DATE         PIC XX    VALUE LOW-VALUES.
    62     12  W-STOP-LETTER-DATE      PIC XX    VALUE LOW-VALUES.
    63     12  W-RESPONSE              PIC S9(8)   COMP.
    64         88  RESP-NORMAL                  VALUE +00.
    65         88  RESP-NOTFND                  VALUE +13.
    66         88  RESP-DUPREC                  VALUE +14.
    67         88  RESP-DUPKEY                  VALUE +15.
    68         88  RESP-NOTOPEN                 VALUE +19.
    69         88  RESP-ENDFILE                 VALUE +20.
    70
    71     12  W-ARCH-SAVE-KEY         PIC  X(03).
    72     12  W-ARCH-KEY.
    73         16  W-ARCH-COMPANY-CD   PIC  X(01).
    74         16  W-ARCH-NUMBER       PIC S9(08)      COMP.
    75
    76     12  W-ARCT-KEY.
    77         16  W-ARCT-COMPANY-CD   PIC  X(01).
    78         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
    79         16  W-ARCT-RECORD-TYPE  PIC  X(01).
    80             88  W-ARCT-COMMENT-DATA   VALUE '3'.
    81         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
    82
    83     12  W-CERT-NOTE-MSG.
    84         16  FILLER              PIC X(29)
    85             VALUE 'REQUESTED DOCUMENT RECEIVED  '.
    86         16  W-CERT-NOTE-RECV-DT PIC X(8).
    87
    88     12  WS-FIND-BILLING-NOTE.
    89         16  WS-FBN-NOTE         PIC X(25).
    90         16  WS-FBN-LTRID        PIC X(4).
    91
    92     12  WS-RECEIVED-NOTE.
    93         16  FILLER              PIC X(12)
    94             VALUE ' - RECEIVED '.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   4
* EL691.cbl
    95         16  WS-BN-RECV-DATE     PIC X(8).
    96
    97     12  ELCERT-FILE-ID          PIC  X(08)  VALUE 'ELCERT'.
    98     12  ERCNOT-FILE-ID          PIC  X(08)  VALUE 'ERCNOT'.
    99     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
   100     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   101     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   102     12  ERCNOT-KEY.
   103         16  ERCNOT-PARTIAL-KEY.
   104             20 ERCNOT-COMPANY-CD    PIC X.
   105             20 ERCNOT-CARRIER       PIC X.
   106             20 ERCNOT-GROUPING      PIC X(06).
   107             20 ERCNOT-STATE         PIC XX.
   108             20 ERCNOT-ACCOUNT       PIC X(10).
   109             20 ERCNOT-EFF-DT        PIC XX.
   110             20 ERCNOT-CERT-NO.
   111                25 ERCNOT-CERT-PRIME PIC X(10).
   112                25 ERCNOT-CERT-SFX   PIC X.
   113             20 ERCNOT-REC-TYP       PIC X.
   114         16 ERCNOT-SEQ           PIC S9(4) COMP.
   115     12  SV-PRIOR-KEY.
   116         16 SV-COMPANY-CD            PIC X.
   117         16 SV-CARRIER               PIC X.
   118         16 SV-GROUPING              PIC X(06).
   119         16 SV-STATE                 PIC XX.
   120         16 SV-ACCOUNT               PIC X(10).
   121         16 SV-EFF-DT                PIC XX.
   122         16 SV-CERT-NO.
   123            20 SV-CERT-PRIME         PIC X(10).
   124            20 SV-CERT-SFX           PIC X(1).
   125         16 SV-REC-TYP               PIC X.
   126         16  SV-NOTE-SEQUENCE        PIC S9(4) COMP.
   127     12  ELCERT-KEY.
   128         16  ELCERT-COMPANY-CD        PIC X.
   129         16  ELCERT-CARRIER           PIC X.
   130         16  ELCERT-GROUPING          PIC X(6).
   131         16  ELCERT-STATE             PIC XX.
   132         16  ELCERT-ACCOUNT           PIC X(10).
   133         16  ELCERT-EFF-DT            PIC XX.
   134         16  ELCERT-CERT-NO.
   135             20  ELCERT-CERT-PRIME    PIC X(10).
   136             20  ELCERT-CERT-SFX      PIC X.
   137     12  ELEOBC-FILE-ID          PIC X(08)  VALUE 'ELEOBC'.
   138     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   139     12  ELEOBC-KEY.
   140         16  EOBC-COMPANY-CD     PIC X.
   141         16  EOBC-REC-TYPE       PIC X.
   142         16  EOBC-CODE           PIC X(4).
   143         16  FILLER              PIC X(9).
   144     12  ERNOTE-FILE-ID          PIC X(08)  VALUE 'ERNOTE'.
   145     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   146     12  ERNOTE-KEY.
   147         16  ERNOTE-COMPANY-CD   PIC X.
   148         16  ERNOTE-CARRIER      PIC X.
   149         16  ERNOTE-GROUPING     PIC X(6).
   150         16  ERNOTE-STATE        PIC XX.
   151         16  ERNOTE-ACCOUNT      PIC X(10).
   152         16  ERNOTE-CERT-EFF-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   5
* EL691.cbl
   153         16  ERNOTE-CERT-PRIME   PIC X(10).
   154         16  ERNOTE-CERT-SFX     PIC X.
   155     12  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
   156
   157
   158 01  FILLER                      PIC  X(22)
   159                                 VALUE 'INTERFACE AREA STARTS:'.
   160*    COPY ELCINTF.
   161******************************************************************
   162*                                                                *
   163*                                                                *
   164*                            ELCINTF.                            *
   165*                            VMOD=2.017                          *
   166*                                                                *
   167*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   168*                                                                *
   169*       LENGTH = 1024                                            *
   170*                                                                *
   171******************************************************************
   172*                   C H A N G E   L O G
   173*
   174* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   175*-----------------------------------------------------------------
   176*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   177* EFFECTIVE    NUMBER
   178*-----------------------------------------------------------------
   179* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   180******************************************************************
   181 01  PROGRAM-INTERFACE-BLOCK.
   182     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   183     12  PI-CALLING-PROGRAM              PIC X(8).
   184     12  PI-SAVED-PROGRAM-1              PIC X(8).
   185     12  PI-SAVED-PROGRAM-2              PIC X(8).
   186     12  PI-SAVED-PROGRAM-3              PIC X(8).
   187     12  PI-SAVED-PROGRAM-4              PIC X(8).
   188     12  PI-SAVED-PROGRAM-5              PIC X(8).
   189     12  PI-SAVED-PROGRAM-6              PIC X(8).
   190     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   191     12  PI-COMPANY-ID                   PIC XXX.
   192     12  PI-COMPANY-CD                   PIC X.
   193
   194     12  PI-COMPANY-PASSWORD             PIC X(8).
   195
   196     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   197
   198     12  PI-CONTROL-IN-PROGRESS.
   199         16  PI-CARRIER                  PIC X.
   200         16  PI-GROUPING                 PIC X(6).
   201         16  PI-STATE                    PIC XX.
   202         16  PI-ACCOUNT                  PIC X(10).
   203         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   204                                         PIC X(10).
   205         16  PI-CLAIM-CERT-GRP.
   206             20  PI-CLAIM-NO             PIC X(7).
   207             20  PI-CERT-NO.
   208                 25  PI-CERT-PRIME       PIC X(10).
   209                 25  PI-CERT-SFX         PIC X.
   210             20  PI-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   6
* EL691.cbl
   211         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   212             20  PI-PLAN-CODE            PIC X(2).
   213             20  PI-REVISION-NUMBER      PIC X(3).
   214             20  PI-PLAN-EFF-DT          PIC X(2).
   215             20  PI-PLAN-EXP-DT          PIC X(2).
   216             20  FILLER                  PIC X(11).
   217         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   218             20  PI-OE-REFERENCE-1.
   219                 25  PI-OE-REF-1-PRIME   PIC X(18).
   220                 25  PI-OE-REF-1-SUFF    PIC XX.
   221
   222     12  PI-SESSION-IN-PROGRESS          PIC X.
   223         88  CLAIM-SESSION                   VALUE '1'.
   224         88  CREDIT-SESSION                  VALUE '2'.
   225         88  WARRANTY-SESSION                VALUE '3'.
   226         88  MORTGAGE-SESSION                VALUE '4'.
   227         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   228
   229
   230*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   231
   232     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   233     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   234
   235     12  PI-CREDIT-USER                  PIC X.
   236         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   237         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   238
   239     12  PI-CLAIM-USER                   PIC X.
   240         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   241         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   242
   243     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   244         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   245         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   246         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   247         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   248         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   249
   250     12  PI-PROCESSOR-ID                 PIC X(4).
   251
   252     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   253
   254     12  PI-MEMBER-CAPTION               PIC X(10).
   255
   256     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   257         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   258
   259     12  PI-LIFE-OVERRIDE-L1             PIC X.
   260     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   261     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   262     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   263
   264     12  PI-AH-OVERRIDE-L1               PIC X.
   265     12  PI-AH-OVERRIDE-L2               PIC XX.
   266     12  PI-AH-OVERRIDE-L6               PIC X(6).
   267     12  PI-AH-OVERRIDE-L12              PIC X(12).
   268
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   7
* EL691.cbl
   269     12  PI-NEW-SYSTEM                   PIC X(2).
   270
   271     12  PI-PRIMARY-CERT-NO              PIC X(11).
   272     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   273         88  PI-USES-PAID-TO                 VALUE '1'.
   274     12  PI-CRDTCRD-SYSTEM.
   275         16  PI-CRDTCRD-USER             PIC X.
   276             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   277             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   278         16  PI-CC-MONTH-END-DT          PIC XX.
   279     12  PI-PROCESSOR-PRINTER            PIC X(4).
   280
   281     12  PI-OE-REFERENCE-2.
   282         16  PI-OE-REF-2-PRIME           PIC X(10).
   283         16  PI-OE-REF-2-SUFF            PIC X.
   284
   285     12  PI-REM-TRM-CALC-OPTION          PIC X.
   286
   287     12  PI-LANGUAGE-TYPE                PIC X.
   288             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   289             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   290             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   291
   292     12  PI-POLICY-LINKAGE-IND           PIC X.
   293         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   294         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   295                                                   LOW-VALUES.
   296
   297     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   298     12  PI-CLAIM-PW-SESSION             PIC X(1).
   299         88  PI-CLAIM-CREDIT                 VALUE '1'.
   300         88  PI-CLAIM-CONVEN                 VALUE '2'.
   301
   302     12  PI-PROCESSOR-CSR-IND            PIC X.
   303         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   304         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   305
   306     12  FILLER                          PIC X(3).
   307
   308     12  PI-SYSTEM-LEVEL                 PIC X(145).
   309
   310     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   311         PI-SYSTEM-LEVEL.
   312
   313         16  PI-ENTRY-CODES.
   314             20  PI-ENTRY-CD-1           PIC X.
   315             20  PI-ENTRY-CD-2           PIC X.
   316
   317         16  PI-RETURN-CODES.
   318             20  PI-RETURN-CD-1          PIC X.
   319             20  PI-RETURN-CD-2          PIC X.
   320
   321         16  PI-UPDATE-STATUS-SAVE.
   322             20  PI-UPDATE-BY            PIC X(4).
   323             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   324
   325         16  PI-LOWER-CASE-LETTERS       PIC X.
   326             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   8
* EL691.cbl
   327
   328*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   329*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   330*            88  CARRIER-CLM-CNTL            VALUE '2'.
   331
   332         16  PI-CERT-ACCESS-CONTROL      PIC X.
   333             88  ST-ACCNT-CNTL               VALUE ' '.
   334             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   335             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   336             88  ACCNT-CNTL                  VALUE '3'.
   337             88  CARR-ACCNT-CNTL             VALUE '4'.
   338
   339         16  PI-PROCESSOR-CAP-LIST.
   340             20  PI-SYSTEM-CONTROLS.
   341                24 PI-SYSTEM-DISPLAY     PIC X.
   342                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   343                24 PI-SYSTEM-MODIFY      PIC X.
   344                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   345             20  FILLER                  PIC XX.
   346             20  PI-DISPLAY-CAP          PIC X.
   347                 88  DISPLAY-CAP             VALUE 'Y'.
   348             20  PI-MODIFY-CAP           PIC X.
   349                 88  MODIFY-CAP              VALUE 'Y'.
   350             20  PI-MSG-AT-LOGON-CAP     PIC X.
   351                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   352             20  PI-FORCE-CAP            PIC X.
   353                 88  FORCE-CAP               VALUE 'Y'.
   354
   355         16  PI-PROGRAM-CONTROLS.
   356             20  PI-PGM-PRINT-OPT        PIC X.
   357             20  PI-PGM-FORMAT-OPT       PIC X.
   358             20  PI-PGM-PROCESS-OPT      PIC X.
   359             20  PI-PGM-TOTALS-OPT       PIC X.
   360
   361         16  PI-HELP-INTERFACE.
   362             20  PI-LAST-ERROR-NO        PIC X(4).
   363             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   364
   365         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   366             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   367
   368         16  PI-CR-CONTROL-IN-PROGRESS.
   369             20  PI-CR-CARRIER           PIC X.
   370             20  PI-CR-GROUPING          PIC X(6).
   371             20  PI-CR-STATE             PIC XX.
   372             20  PI-CR-ACCOUNT           PIC X(10).
   373             20  PI-CR-FIN-RESP          PIC X(10).
   374             20  PI-CR-TYPE              PIC X.
   375
   376         16  PI-CR-BATCH-NUMBER          PIC X(6).
   377
   378         16  PI-CR-MONTH-END-DT          PIC XX.
   379
   380         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   381             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   382             88  PI-ZERO-CARRIER             VALUE '1'.
   383             88  PI-ZERO-GROUPING            VALUE '2'.
   384             88  PI-ZERO-CAR-GROUP           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   9
* EL691.cbl
   385
   386         16  PI-CARRIER-SECURITY         PIC X.
   387             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   388
   389         16  PI-ACCOUNT-SECURITY         PIC X(10).
   390             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   391             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   392
   393         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   394             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   395                                         INDEXED BY PI-ACCESS-NDX
   396                                         PIC X.
   397
   398         16  PI-GA-BILLING-CONTROL       PIC X.
   399             88  PI-GA-BILLING               VALUE '1'.
   400
   401         16  PI-MAIL-PROCESSING          PIC X.
   402             88  PI-MAIL-YES                 VALUE 'Y'.
   403
   404         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   405
   406         16  PI-AR-SYSTEM.
   407             20  PI-AR-PROCESSING-CNTL   PIC X.
   408                 88  PI-AR-PROCESSING        VALUE 'Y'.
   409             20  PI-AR-SUMMARY-CODE      PIC X(6).
   410             20  PI-AR-MONTH-END-DT      PIC XX.
   411
   412         16  PI-MP-SYSTEM.
   413             20  PI-MORTGAGE-USER            PIC X.
   414                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   415                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   416             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   417                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   418                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   419                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   420                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   421                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   422             20  PI-MP-MONTH-END-DT          PIC XX.
   423             20  PI-MP-REFERENCE-NO.
   424                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   425                 24  PI-MP-REFERENCE-SFX     PIC XX.
   426
   427         16  PI-LABEL-CONTROL            PIC X(01).
   428             88  PI-CREATE-LABELS                    VALUE 'Y'.
   429             88  PI-BYPASS-LABELS                    VALUE 'N'.
   430
   431         16  PI-BILL-GROUPING-CODE       PIC X(01).
   432             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   433
   434         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   435             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   436             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   437
   438         16  FILLER                      PIC X(14).
   439
   440     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   441******************************************************************
   442     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  10
* EL691.cbl
   443*    COPY ELC1042.
   444******************************************************************
   445*                                                                *
   446*                                                                *
   447*                           ELC1042                              *
   448*                            VMOD=2.002                          *
   449*                                                                *
   450*    NOTE                                                        *
   451*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   452*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   453*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   454*        TO THESE PROGRAMS.                                      *
   455*                                                                *
   456*    NOTE                                                        *
   457*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   458*        USE ONLY!                                               *
   459*                                                                *
   460******************************************************************
   461
   462         16  PI-1042-WA.
   463             20  PI-ACTION       PIC  X(01).
   464                 88 PI-SHOW-MODE           VALUE '1'.
   465                 88 PI-CLEAR-MODE          VALUE '2'.
   466                 88 PI-CREATE-MODE         VALUE '3'.
   467             20  PI-COMM-CONTROL PIC  X(12).
   468             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   469             20  PI-EOF-SW       PIC  X(01).
   470                 88  PI-FILE-EOF           VALUE 'Y'.
   471             20  PI-FILETYP      PIC  X(01).
   472             20  PI-FORM-SQUEEZE-CONTROL
   473                                 PIC  X(01).
   474                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   475                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   476             20  PI-LAST-CONTROL PIC  X(12).
   477             20  PI-TEMP-STOR-ITEMS
   478                                 PIC S9(04) COMP.
   479             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   480             20  PI-UPDATE-SW    PIC  9(01).
   481                 88 ANY-UPDATES            VALUE 1.
   482             20  PI-104-SCREEN-SENT-IND
   483                                 PIC  X(01).
   484                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   485                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   486             20  PI-1042-SCREEN-SENT-IND
   487                                 PIC  X(01).
   488                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   489                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   490             20  PI-1042-ARCHIVE-IND
   491                                 PIC  X(01).
   492                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   493             20  FILLER          PIC  X(29).
   494*    COPY ELC689PI.
   495******************************************************************
   496*                                                                *
   497*                            ELC689PI                            *
   498*                            VMOD=2.003                          *
   499*                                                                *
   500*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  11
* EL691.cbl
   501*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   502*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   503*                                                                *
   504*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   505*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   506*    BETWEEN PROGRAMS.                                           *
   507*                                                                *
   508*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   509*                                                                *
   510*               EL631 - EL689  - EL6891 - EL6892                 *
   511*                                                                *
   512******************************************************************
   513*                   C H A N G E   L O G
   514*
   515* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   516*-----------------------------------------------------------------
   517*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   518* EFFECTIVE    NUMBER
   519*-----------------------------------------------------------------
   520* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   521* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   522* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   523******************************************************************
   524
   525
   526         16  PI-689-WORK-AREA.
   527             20  PI-689-ALT-PRINTER-ID
   528                                 PIC  X(04).
   529             20  PI-689-ARCHIVE-NUMBER
   530                                 PIC  9(08).
   531             20  PI-689-ARCHIVE-SW
   532                                 PIC  X(01).
   533                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   534             20  PI-689-DATA-SOURCE
   535                                 PIC  X(01).
   536                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   537                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   538                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   539                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   540                 88  PI-689-SRC-CHECKS         VALUE '5'.
   541             20  PI-689-ERROR-IND
   542                                 PIC  X(01).
   543                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   544             20  PI-689-ERROR    PIC  9(04).
   545                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   546                 88  PI-689-FATAL-ERROR
   547                     VALUES 0004 0006 0008 0013 0023 0029 0033
   548                            0042 0047 0051 0066 0067 0070
   549                            0168 0169 0174 0175 0176 0177 0179
   550                            0180 0181 0182 0184 0185 0189 0190
   551                            0191
   552                            0215 0279 0280
   553                            0412 0413 0454
   554                            0533 0537
   555                            2055 2114 2208 2209 2216 2232 2369
   556                            2398 2433 2908 2999
   557                            3000 3770 3771 3775
   558                            7250 7365 7367 7368 7369 7370 7371
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  12
* EL691.cbl
   559                            7272 7373 7374 7376 7377 7378 7379
   560                            7381 7388 7390 7393 7395 7396 7398
   561                            9095 9096 9281 9298 9299 9320 9327
   562                            9426 9427.
   563                 88  PI-689-STOP-ERROR
   564                     VALUES 0004 0008 0013 0023 0029 0033
   565                            0042 0047 0066 0067 0070
   566                            0168 0169 0174 0175 0176 0177
   567                            0181 0182 0184 0185 0189 0190
   568                            0279 0280
   569                            0412 0413 0454
   570                            2055 2208 2209 2216 2232
   571                            2398 2999
   572                            3000 3770 3771 3775
   573                            7250 7365 7369 7370 7371
   574                            7272 7373 7374 7376 7377 7378 7379
   575                            7381 7388 7390 7393 7396 7398
   576                            9095 9096 9299 9320 9426.
   577             20  PI-689-FOLLOW-UP-DATE
   578                                 PIC  X(02).
   579             20  PI-689-FORM-NUMBER
   580                                 PIC  X(04).
   581             20  PI-689-LABEL-SOURCE
   582                                 PIC X(01).
   583                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
   584                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
   585                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
   586                 88  PI-689-SOURCE-COMP     VALUE '4'.
   587                 88  PI-689-SOURCE-MAIL     VALUE '5'.
   588                 88  PI-689-SOURCE-CHECK    VALUE '6'.
   589                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
   590             20  PI-689-NUMBER-COPIES
   591                                 PIC  9(01).
   592             20  PI-689-NUMBER-LABEL-LINES
   593                                 PIC  9(01).
   594             20  PI-689-NUMBER-TEXT-RECORDS
   595                                 PIC  9(03).
   596             20  PI-689-PRINT-ORDER-SW
   597                                 PIC  X(01).
   598                 88  PI-689-PRINT-FIRST     VALUE '1'.
   599                 88  PI-689-PRINT-SECOND    VALUE '2'.
   600                 88  PI-689-PRINT-LATER     VALUE '3'.
   601                 88  PI-689-PRINT-ONLY      VALUE '4'.
   602             20  PI-689-PRINT-RESTRICTION
   603                                 PIC  X(01).
   604                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
   605                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
   606                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
   607             20  PI-689-PRINT-SW PIC  X(01).
   608                 88  PI-689-PRINT-PERFORMED VALUE '1'.
   609             20  PI-689-RESEND-DATE-1
   610                                 PIC  X(02).
   611             20  PI-689-RESEND-LETR-1
   612                                 PIC X(4).
   613             20  PI-689-TEMP-STOR-ID
   614                                 PIC  X(08).
   615             20  PI-689-USE-SCREEN-IND
   616                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  13
* EL691.cbl
   617                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
   618             20  PI-689-ARCH-POINTER
   619                                 PIC S9(08) COMP.
   620                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
   621             20  PI-689-ARCT-POINTER
   622                                 PIC S9(08) COMP.
   623                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
   624             20  PI-689-VARIABLE-DATA-GRP.
   625                 24  PI-689-VARIABLE-DATA-1
   626                                 PIC  X(30).
   627                 24  PI-689-VARIABLE-DATA-2
   628                                 PIC  X(30).
   629                 24  PI-689-VARIABLE-DATA-3
   630                                 PIC  X(30).
   631                 24  PI-689-VARIABLE-DATA-4
   632                                 PIC  X(30).
   633
   634         16  PI-689-KEY-DATA-FIELDS.
   635             20  PI-689-ACCOUNT  PIC  X(10).
   636             20  PI-689-CARRIER  PIC  X(01).
   637             20  PI-689-CERT-NO.
   638                 24  PI-689-CERT-PRIME
   639                                 PIC  X(10).
   640                 24  PI-689-CERT-SFX
   641                                 PIC  X(01).
   642             20  PI-689-CHG-SEQ-NO
   643                                 PIC S9(04)    COMP.
   644             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
   645                                 PIC  X(02).
   646             20  PI-689-ENTRY-BATCH
   647                                 PIC  X(06).
   648             20  PI-689-EFF-DATE PIC  X(02).
   649             20  PI-689-EXP-DATE PIC  X(02).
   650             20  PI-689-GROUPING PIC  X(06).
   651             20  PI-689-RESP-PERSON
   652                                 PIC  X(10).
   653             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
   654             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
   655                                 PIC  X(04).
   656             20  PI-689-STATE    PIC  X(02).
   657             20  PI-689-TYPE     PIC  X(01).
   658             20  PI-689-CONTROL  PIC S9(08)    COMP.
   659             20  PI-689-ALT-SEQ-NO
   660                                 PIC S9(04)    COMP.
   661         16  PI-689-DATE-EDIT    PIC  X(08).
   662         16  PI-689-FOLLOW-UP-EDIT
   663                                 PIC  X(08).
   664         16  PI-689-RESEND1-EDIT PIC  X(08).
   665         16  PI-689-SEQ-EDIT     PIC  X(08).
   666         16  PI-689-BCSEQ-EDIT   PIC  X(04).
   667         16  PI-689-LBL-OVERRIDE PIC  X(01).
   668             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
   669         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
   670         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
   671         16  PI-690-WORK-AREA.
   672             20  PI-690-ARCHIVE-TABLE.
   673                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
   674                                 PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  14
* EL691.cbl
   675             20  PI-690-CURSOR   PIC S9(04) COMP.
   676             20  PI-690-FIRST-DATA.
   677                 24  PI-690-FIRST-CERT-NO.
   678                     28  PI-690-FIRST-CERT-PRIME
   679                                 PIC  X(10).
   680                     28  PI-690-FIRST-SUFFIX
   681                                 PIC  X(01).
   682                 24  PI-690-FIRST-CARRIER
   683                                 PIC  X(01).
   684                 24  PI-690-FIRST-GROUPING
   685                                 PIC  X(06).
   686                 24  PI-690-FIRST-STATE
   687                                 PIC  X(02).
   688                 24  PI-690-FIRST-ACCOUNT
   689                                 PIC  X(10).
   690                 24  PI-690-FIRST-EFFECT-DATE
   691                                 PIC  X(02).
   692                 24  PI-690-FIRST-ENTRY.
   693                     28  PI-690-FIRST-CONTROL-PREFIX
   694                                 PIC  X(02).
   695                     28  PI-690-FIRST-CONTROL
   696                                 PIC S9(08) COMP.
   697                 24  PI-690-FIRST-FORM
   698                                 PIC  X(04).
   699                 24  PI-690-FIRST-PROCESSOR
   700                                 PIC  X(04).
   701                 24  PI-690-FIRST-ARCHIVE-NO
   702                                 PIC S9(08) COMP.
   703             20  PI-690-INIT-DATA.
   704                 24  PI-690-INIT-CERT-NO.
   705                     28  PI-690-INIT-CERT-PRIME
   706                                 PIC  X(10).
   707                     28  PI-690-INIT-SUFFIX
   708                                 PIC  X(01).
   709                 24  PI-690-INIT-CARRIER
   710                                 PIC  X(01).
   711                 24  PI-690-INIT-GROUPING
   712                                 PIC  X(06).
   713                 24  PI-690-INIT-STATE
   714                                 PIC  X(02).
   715                 24  PI-690-INIT-ACCOUNT
   716                                 PIC  X(10).
   717                 24  PI-690-INIT-EFFECT-DATE
   718                                 PIC  X(02).
   719                 24  PI-690-INIT-EFF-DTE
   720                                 PIC  X(08).
   721                 24  PI-690-INIT-ENTRY.
   722                     28  PI-690-INIT-CONTROL-PREFIX
   723                                 PIC  X(02).
   724                     28  PI-690-INIT-CONTROL
   725                                 PIC S9(08) COMP.
   726                 24  PI-690-INIT-FORM
   727                                 PIC  X(04).
   728                 24  PI-690-INIT-PROCESSOR
   729                                 PIC  X(04).
   730                 24  PI-690-INIT-ARCHIVE-NO
   731                                 PIC S9(08) COMP.
   732             20  PI-690-LAST-DATA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  15
* EL691.cbl
   733                 24  PI-690-LAST-CERT-NO.
   734                     28  PI-690-LAST-CERT-PRIME
   735                                 PIC  X(10).
   736                     28  PI-690-LAST-SUFFIX
   737                                 PIC  X(01).
   738                 24  PI-690-LAST-CARRIER
   739                                 PIC  X(01).
   740                 24  PI-690-LAST-GROUPING
   741                                 PIC  X(06).
   742                 24  PI-690-LAST-STATE
   743                                 PIC  X(02).
   744                 24  PI-690-LAST-ACCOUNT
   745                                 PIC  X(10).
   746                 24  PI-690-LAST-EFFECT-DATE
   747                                 PIC  X(02).
   748                 24  PI-690-LAST-ENTRY.
   749                     28  PI-690-LAST-CONTROL-PREFIX
   750                                 PIC  X(02).
   751                     28  PI-690-LAST-CONTROL
   752                                 PIC S9(08) COMP.
   753                 24  PI-690-LAST-FORM
   754                                 PIC  X(04).
   755                 24  PI-690-LAST-PROCESSOR
   756                                 PIC  X(04).
   757                 24  PI-690-LAST-ARCHIVE-NO
   758                                 PIC S9(08) COMP.
   759             20  PI-690-LAST-ARCH-NDX
   760                                 PIC S9(04) COMP.
   761             20  PI-690-BRWS-TYPE-IND
   762                                 PIC  9(01).
   763                 88  PI-690-BRWS-CERTRP               VALUE 1.
   764                 88  PI-690-BRWS-FORM                 VALUE 2.
   765                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
   766                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
   767                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
   768                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
   769             20  PI-690-LAST-BROWSE-IND
   770                                 PIC  X(01).
   771                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
   772                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
   773             20  PI-690-STATUS-SELECTION-IND
   774                                 PIC  X(01).
   775                 88  PI-690-SELECT-ALL       VALUE 'N'.
   776                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
   777                                               'X' 'P' 'V' 'N'.
   778         16  PI-ARCHIVE-COMPLETE    PIC X(01).
   779         16  PI-ARCHIVE-RECEIVED    PIC X(01).
   780         16  PI-ARCHIVE-STOPPED     PIC X(01).
   781         16  PI-ARCHIVE-FINAL       PIC X(01).
   782         16  PI-COMMENT-INDEX       PIC S9(4) COMP.
   783         16  PI-ARCHIVE-LTRID       PIC X(4).
   784         16  FILLER              PIC X(59).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  16
* EL691.cbl
   786
   787 01  W-CONSTANT-AREA.
   788     12  FILLER                  PIC  X(18)
   789                                 VALUE 'PROGRAM CONSTANTS:'.
   790     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
   791
   792     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
   793     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
   794     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
   795     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
   796     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
   797     12  W-MAP                   PIC  X(08)  VALUE 'EL691A'.
   798     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
   799         16  FILLER              PIC  X(02).
   800         16  W-MAP-NUM           PIC  X(06).
   801     12  W-MAPSET                PIC  X(08)  VALUE 'EL691S'.
   802     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL691'.
   803     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXN1'.
   804     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
   805     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
   806     12  W-XCTL-1279             PIC  X(08)  VALUE 'EL1279'.
   807     12  SLASH                   PIC X       VALUE '/'.
   808     12  W-ZEROS                 PIC  S9(03) VALUE +0 COMP-3.
   809     12  W-ADD-ARCT              PIC  X      VALUE 'N'.
   810     12  W-DONE-ADDING           PIC  X      VALUE 'N'.
   811     12  W-NEED-COMMENT          PIC  X      VALUE 'N'.
   812
   813 01  ERROR-MESSAGES.
   814     12  ER-0000                 PIC  X(04) VALUE '0000'.
   815     12  ER-0004                 PIC  X(04) VALUE '0004'.
   816     12  ER-0029                 PIC  X(04) VALUE '0029'.
   817     12  ER-0051                 PIC  X(04) VALUE '0051'.
   818     12  ER-0070                 PIC  X(04) VALUE '0070'.
   819     12  ER-0295                 PIC  X(04) VALUE '0295'.
   820     12  ER-0296                 PIC  X(04) VALUE '0296'.
   821     12  ER-0539                 PIC  X(04) VALUE '0539'.
   822     12  ER-0895                 PIC  X(04) VALUE '0895'.
   823     12  ER-0897                 PIC  X(04) VALUE '0897'.
   824     12  ER-3112                 PIC  X(04) VALUE '3112'.
   825     12  ER-7008                 PIC  X(04) VALUE '7008'.
   826     12  ER-7363                 PIC  X(04) VALUE '7363'.
   827     12  ER-7371                 PIC  X(04) VALUE '7371'.
   828     12  ER-7373                 PIC  X(04) VALUE '7373'.
   829     12  ER-7388                 PIC  X(04) VALUE '7388'.
   830     12  ER-9097                 PIC  X(04) VALUE '9097'.
   831     12  ER-9245                 PIC  X(04) VALUE '9245'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  17
* EL691.cbl
   833*    COPY ELCAID.
   834******************************************************************
   835*                                                                *
   836*                            ELCAID.                             *
   837*                            VMOD=2.001                          *
   838*                                                                *
   839*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   840*                                                                *
   841*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   842*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   843******************************************************************
   844
   845 01  DFHAID.
   846   02  DFHNULL   PIC  X  VALUE  ' '.
   847   02  DFHENTER  PIC  X  VALUE  QUOTE.
   848   02  DFHCLEAR  PIC  X  VALUE  '_'.
   849   02  DFHPEN    PIC  X  VALUE  '='.
   850   02  DFHOPID   PIC  X  VALUE  'W'.
   851   02  DFHPA1    PIC  X  VALUE  '%'.
   852   02  DFHPA2    PIC  X  VALUE  '>'.
   853   02  DFHPA3    PIC  X  VALUE  ','.
   854   02  DFHPF1    PIC  X  VALUE  '1'.
   855   02  DFHPF2    PIC  X  VALUE  '2'.
   856   02  DFHPF3    PIC  X  VALUE  '3'.
   857   02  DFHPF4    PIC  X  VALUE  '4'.
   858   02  DFHPF5    PIC  X  VALUE  '5'.
   859   02  DFHPF6    PIC  X  VALUE  '6'.
   860   02  DFHPF7    PIC  X  VALUE  '7'.
   861   02  DFHPF8    PIC  X  VALUE  '8'.
   862   02  DFHPF9    PIC  X  VALUE  '9'.
   863   02  DFHPF10   PIC  X  VALUE  ':'.
   864   02  DFHPF11   PIC  X  VALUE  '#'.
   865   02  DFHPF12   PIC  X  VALUE  '@'.
   866   02  DFHPF13   PIC  X  VALUE  'A'.
   867   02  DFHPF14   PIC  X  VALUE  'B'.
   868   02  DFHPF15   PIC  X  VALUE  'C'.
   869   02  DFHPF16   PIC  X  VALUE  'D'.
   870   02  DFHPF17   PIC  X  VALUE  'E'.
   871   02  DFHPF18   PIC  X  VALUE  'F'.
   872   02  DFHPF19   PIC  X  VALUE  'G'.
   873   02  DFHPF20   PIC  X  VALUE  'H'.
   874   02  DFHPF21   PIC  X  VALUE  'I'.
   875*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   876   02  DFHPF22   PIC  X  VALUE  '['.
   877   02  DFHPF23   PIC  X  VALUE  '.'.
   878   02  DFHPF24   PIC  X  VALUE  '<'.
   879   02  DFHMSRE   PIC  X  VALUE  'X'.
   880   02  DFHSTRF   PIC  X  VALUE  'h'.
   881   02  DFHTRIG   PIC  X  VALUE  '"'.
   882 01  FILLER    REDEFINES DFHAID.
   883     12  FILLER                  PIC  X(08).
   884     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  18
* EL691.cbl
   886*    COPY ELCATTR.
   887******************************************************************
   888*                                                                *
   889*                            ELCATTR.                            *
   890*                            VMOD=2.001                          *
   891*                                                                *
   892*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   893*                                                                *
   894*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   895*                                                                *
   896*                   POS 1   P=PROTECTED                          *
   897*                           U=UNPROTECTED                        *
   898*                           S=ASKIP                              *
   899*                   POS 2   A=ALPHA/NUMERIC                      *
   900*                           N=NUMERIC                            *
   901*                   POS 3   N=NORMAL                             *
   902*                           B=BRIGHT                             *
   903*                           D=DARK                               *
   904*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   905*                           OF=MODIFIED DATA TAG OFF             *
   906*                                                                *
   907*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   908******************************************************************
   909 01  ATTRIBUTE-LIST.
   910     12  AL-PABOF            PIC X       VALUE 'Y'.
   911     12  AL-PABON            PIC X       VALUE 'Z'.
   912     12  AL-PADOF            PIC X       VALUE '%'.
   913     12  AL-PADON            PIC X       VALUE '_'.
   914     12  AL-PANOF            PIC X       VALUE '-'.
   915     12  AL-PANON            PIC X       VALUE '/'.
   916     12  AL-SABOF            PIC X       VALUE '8'.
   917     12  AL-SABON            PIC X       VALUE '9'.
   918     12  AL-SADOF            PIC X       VALUE '@'.
   919     12  AL-SADON            PIC X       VALUE QUOTE.
   920     12  AL-SANOF            PIC X       VALUE '0'.
   921     12  AL-SANON            PIC X       VALUE '1'.
   922     12  AL-UABOF            PIC X       VALUE 'H'.
   923     12  AL-UABON            PIC X       VALUE 'I'.
   924     12  AL-UADOF            PIC X       VALUE '<'.
   925     12  AL-UADON            PIC X       VALUE '('.
   926     12  AL-UANOF            PIC X       VALUE ' '.
   927     12  AL-UANON            PIC X       VALUE 'A'.
   928     12  AL-UNBOF            PIC X       VALUE 'Q'.
   929     12  AL-UNBON            PIC X       VALUE 'R'.
   930     12  AL-UNDOF            PIC X       VALUE '*'.
   931     12  AL-UNDON            PIC X       VALUE ')'.
   932     12  AL-UNNOF            PIC X       VALUE '&'.
   933     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  19
* EL691.cbl
   935*    COPY ELCDATE.
   936******************************************************************
   937*                                                                *
   938*                                                                *
   939*                            ELCDATE.                            *
   940*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   941*                            VMOD=2.003
   942*                                                                *
   943*                                                                *
   944*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   945*                 LENGTH = 200                                   *
   946******************************************************************
   947
   948 01  DATE-CONVERSION-DATA.
   949     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   950     12  DC-OPTION-CODE                PIC X.
   951         88  BIN-TO-GREG                VALUE ' '.
   952         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   953         88  EDIT-GREG-TO-BIN           VALUE '2'.
   954         88  YMD-GREG-TO-BIN            VALUE '3'.
   955         88  MDY-GREG-TO-BIN            VALUE '4'.
   956         88  JULIAN-TO-BIN              VALUE '5'.
   957         88  BIN-PLUS-ELAPSED           VALUE '6'.
   958         88  FIND-CENTURY               VALUE '7'.
   959         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   960         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   961         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   962         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   963         88  JULIAN-TO-BIN-3            VALUE 'C'.
   964         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   965         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   966         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   967         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   968         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   969         88  CHECK-LEAP-YEAR            VALUE 'H'.
   970         88  BIN-3-TO-GREG              VALUE 'I'.
   971         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   972         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   973         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   974         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   975         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   976         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   977         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   978         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   979         88  THREE-CHARACTER-BIN
   980                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   981         88  GREGORIAN-TO-BIN
   982                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   983         88  BIN-TO-GREGORIAN
   984                  VALUES ' ' '1' 'I' '8' 'G'.
   985         88  JULIAN-TO-BINARY
   986                  VALUES '5' 'C' 'E' 'F'.
   987     12  DC-ERROR-CODE                 PIC X.
   988         88  NO-CONVERSION-ERROR        VALUE ' '.
   989         88  DATE-CONVERSION-ERROR
   990                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   991         88  DATE-IS-ZERO               VALUE '1'.
   992         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  20
* EL691.cbl
   993         88  DATE-IS-INVALID            VALUE '3'.
   994         88  DATE1-GREATER-DATE2        VALUE '4'.
   995         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   996         88  DATE-INVALID-OPTION        VALUE '9'.
   997         88  INVALID-CENTURY            VALUE 'A'.
   998         88  ONLY-CENTURY               VALUE 'B'.
   999         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1000         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1001     12  DC-END-OF-MONTH               PIC X.
  1002         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1003     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1004         88  USE-NORMAL-PROCESS         VALUE ' '.
  1005         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1006         88  ADJUST-UP-100-YRS          VALUE '2'.
  1007     12  FILLER                        PIC X.
  1008     12  DC-CONVERSION-DATES.
  1009         16  DC-BIN-DATE-1             PIC XX.
  1010         16  DC-BIN-DATE-2             PIC XX.
  1011         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1012         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1013                       DC-GREG-DATE-1-EDIT.
  1014             20  DC-EDIT1-MONTH        PIC 99.
  1015             20  SLASH1-1              PIC X.
  1016             20  DC-EDIT1-DAY          PIC 99.
  1017             20  SLASH1-2              PIC X.
  1018             20  DC-EDIT1-YEAR         PIC 99.
  1019         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1020         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1021                     DC-GREG-DATE-2-EDIT.
  1022             20  DC-EDIT2-MONTH        PIC 99.
  1023             20  SLASH2-1              PIC X.
  1024             20  DC-EDIT2-DAY          PIC 99.
  1025             20  SLASH2-2              PIC X.
  1026             20  DC-EDIT2-YEAR         PIC 99.
  1027         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1028         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1029                     DC-GREG-DATE-1-YMD.
  1030             20  DC-YMD-YEAR           PIC 99.
  1031             20  DC-YMD-MONTH          PIC 99.
  1032             20  DC-YMD-DAY            PIC 99.
  1033         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1034         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1035                      DC-GREG-DATE-1-MDY.
  1036             20  DC-MDY-MONTH          PIC 99.
  1037             20  DC-MDY-DAY            PIC 99.
  1038             20  DC-MDY-YEAR           PIC 99.
  1039         16  DC-GREG-DATE-1-ALPHA.
  1040             20  DC-ALPHA-MONTH        PIC X(10).
  1041             20  DC-ALPHA-DAY          PIC 99.
  1042             20  FILLER                PIC XX.
  1043             20  DC-ALPHA-CENTURY.
  1044                 24 DC-ALPHA-CEN-N     PIC 99.
  1045             20  DC-ALPHA-YEAR         PIC 99.
  1046         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1047         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1048         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1049         16  DC-JULIAN-DATE            PIC 9(05).
  1050         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  21
* EL691.cbl
  1051                                       PIC 9(05).
  1052         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1053             20  DC-JULIAN-YEAR        PIC 99.
  1054             20  DC-JULIAN-DAYS        PIC 999.
  1055         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1056         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1057         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1058     12  DATE-CONVERSION-VARIBLES.
  1059         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1060         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1061             20  FILLER                PIC 9(3).
  1062             20  HOLD-CEN-1-CCYY.
  1063                 24  HOLD-CEN-1-CC     PIC 99.
  1064                 24  HOLD-CEN-1-YY     PIC 99.
  1065             20  HOLD-CEN-1-MO         PIC 99.
  1066             20  HOLD-CEN-1-DA         PIC 99.
  1067         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1068             20  HOLD-CEN-1-R-MO       PIC 99.
  1069             20  HOLD-CEN-1-R-DA       PIC 99.
  1070             20  HOLD-CEN-1-R-CCYY.
  1071                 24  HOLD-CEN-1-R-CC   PIC 99.
  1072                 24  HOLD-CEN-1-R-YY   PIC 99.
  1073             20  FILLER                PIC 9(3).
  1074         16  HOLD-CENTURY-1-X.
  1075             20  FILLER                PIC X(3)  VALUE SPACES.
  1076             20  HOLD-CEN-1-X-CCYY.
  1077                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1078                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1079             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1080             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1081         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1082             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1083             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1084             20  HOLD-CEN-1-R-X-CCYY.
  1085                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1086                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1087             20  FILLER                PIC XXX.
  1088         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1089         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1090         16  DC-JULIAN-DATE-1          PIC 9(07).
  1091         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1092             20  DC-JULIAN-1-CCYY.
  1093                 24  DC-JULIAN-1-CC    PIC 99.
  1094                 24  DC-JULIAN-1-YR    PIC 99.
  1095             20  DC-JULIAN-DA-1        PIC 999.
  1096         16  DC-JULIAN-DATE-2          PIC 9(07).
  1097         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1098             20  DC-JULIAN-2-CCYY.
  1099                 24  DC-JULIAN-2-CC    PIC 99.
  1100                 24  DC-JULIAN-2-YR    PIC 99.
  1101             20  DC-JULIAN-DA-2        PIC 999.
  1102         16  DC-GREG-DATE-A-EDIT.
  1103             20  DC-EDITA-MONTH        PIC 99.
  1104             20  SLASHA-1              PIC X VALUE '/'.
  1105             20  DC-EDITA-DAY          PIC 99.
  1106             20  SLASHA-2              PIC X VALUE '/'.
  1107             20  DC-EDITA-CCYY.
  1108                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  22
* EL691.cbl
  1109                 24  DC-EDITA-YEAR     PIC 99.
  1110         16  DC-GREG-DATE-B-EDIT.
  1111             20  DC-EDITB-MONTH        PIC 99.
  1112             20  SLASHB-1              PIC X VALUE '/'.
  1113             20  DC-EDITB-DAY          PIC 99.
  1114             20  SLASHB-2              PIC X VALUE '/'.
  1115             20  DC-EDITB-CCYY.
  1116                 24  DC-EDITB-CENT     PIC 99.
  1117                 24  DC-EDITB-YEAR     PIC 99.
  1118         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1119         16  DC-GREG-DATE-CYMD-R REDEFINES
  1120                              DC-GREG-DATE-CYMD.
  1121             20  DC-CYMD-CEN           PIC 99.
  1122             20  DC-CYMD-YEAR          PIC 99.
  1123             20  DC-CYMD-MONTH         PIC 99.
  1124             20  DC-CYMD-DAY           PIC 99.
  1125         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1126         16  DC-GREG-DATE-MDCY-R REDEFINES
  1127                              DC-GREG-DATE-MDCY.
  1128             20  DC-MDCY-MONTH         PIC 99.
  1129             20  DC-MDCY-DAY           PIC 99.
  1130             20  DC-MDCY-CEN           PIC 99.
  1131             20  DC-MDCY-YEAR          PIC 99.
  1132    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1133        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1134    12  DC-EL310-DATE                  PIC X(21).
  1135    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  23
* EL691.cbl
  1137*    COPY ELCNWA.
  1138*****************************************************************
  1139*                                                               *
  1140*                                                               *
  1141*                            ELCNWA.                            *
  1142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1143*                            VMOD=2.003                         *
  1144*                                                               *
  1145*            M O V E   N A M E   W O R K   A R E A.             *
  1146*                                                               *
  1147*****************************************************************.
  1148
  1149 01  WS-NAME-WORK-AREA.
  1150     05  WS-INSURED-LAST-NAME        PIC X(15).
  1151     05  WS-INSURED-1ST-NAME         PIC X(12).
  1152     05  WS-INSURED-MID-INIT         PIC X.
  1153
  1154     05  WS-NAME-WORK.
  1155         10  WS-NW                   PIC X
  1156             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1157
  1158     05  WS-NAME-WORK2.
  1159         10  WS-NW2                  PIC X
  1160             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1161                                        NWA-INDEX0.
  1162
  1163     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1164                                     COMP-3.
  1165
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  24
* EL691.cbl
  1167*    COPY ELCEMIB.
  1168******************************************************************
  1169*                                                                *
  1170*                                                                *
  1171*                            ELCEMIB.                            *
  1172*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1173*                            VMOD=2.005                          *
  1174*                                                                *
  1175*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1176*                                                                *
  1177******************************************************************
  1178 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1179     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1180     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1181     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1182     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1183     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1184     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1185     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1186     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1187     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1188         88  EMI-NO-ERRORS                    VALUE '1'.
  1189         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1190         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1191     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1192         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1193     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1194         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1195         88  EMI-AREA1-FULL                   VALUE '2'.
  1196     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1197         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1198         88  EMI-AREA2-FULL                   VALUE '2'.
  1199     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1200         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1201         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1202         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1203         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1204         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1205     12  EMI-ERROR-LINES.
  1206         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1207         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1208         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1209         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1210             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1211                 24  EMI-ERR-NUM         PIC X(4).
  1212                 24  EMI-FILLER          PIC X.
  1213                 24  EMI-SEV             PIC X.
  1214                 24  FILLER              PIC X.
  1215             20  FILLER                  PIC X(02).
  1216     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1217         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1218             20  EMI-ERROR-NUMBER    PIC X(4).
  1219             20  EMI-FILL            PIC X.
  1220             20  EMI-SEVERITY        PIC X.
  1221             20  FILLER              PIC X.
  1222             20  EMI-ERROR-TEXT.
  1223                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1224                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  25
* EL691.cbl
  1225     12  EMI-SEVERITY-SAVE           PIC X.
  1226         88  EMI-NOTE                    VALUE 'N'.
  1227         88  EMI-WARNING                 VALUE 'W'.
  1228         88  EMI-FORCABLE                VALUE 'F'.
  1229         88  EMI-FATAL                   VALUE 'X'.
  1230     12  EMI-MESSAGE-FLAG            PIC X.
  1231         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1232         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1233     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1234     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1235         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1236         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1237         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1238     12  FILLER                      PIC X(137)  VALUE SPACES.
  1239     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1240     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1241     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1242     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1243 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  26
* EL691.cbl
  1245*    COPY ELCLOGOF.
  1246******************************************************************
  1247*                                                                *
  1248*                                                                *
  1249*                            ELCLOGOF.                           *
  1250*                            VMOD=2.001                          *
  1251*                                                                *
  1252*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1253*                                                                *
  1254******************************************************************
  1255 01  CLASIC-LOGOFF.
  1256     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1257     12  LOGOFF-TEXT.
  1258         16  FILLER          PIC X(5)    VALUE SPACES.
  1259         16  LOGOFF-MSG.
  1260             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1261             20  FILLER      PIC X       VALUE SPACES.
  1262             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1263         16  FILLER          PIC X(80)
  1264           VALUE '* YOU ARE NOW LOGGED OFF'.
  1265         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1266         16  FILLER          PIC X       VALUE QUOTE.
  1267         16  LOGOFF-SYS-MSG  PIC X(17)
  1268           VALUE 'S CLAS-IC SYSTEM '.
  1269     12  TEXT-MESSAGES.
  1270         16  UNACCESS-MSG    PIC X(29)
  1271             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1272         16  PGMIDERR-MSG    PIC X(17)
  1273             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  27
* EL691.cbl
  1275*    COPY ELCSCTM.
  1276******************************************************************
  1277*                                                                *
  1278*                                                                *
  1279*                            ELCSCTM                             *
  1280*                            VMOD=2.001                          *
  1281*                                                                *
  1282*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  1283*                                                                *
  1284******************************************************************
  1285 01  SECURITY-MESSAGE.
  1286     12  FILLER                          PIC X(30)
  1287            VALUE '** LOGIC SECURITY VIOLATION -'.
  1288     12  SM-READ                         PIC X(6).
  1289     12  FILLER                          PIC X(5)
  1290            VALUE ' PGM='.
  1291     12  SM-PGM                          PIC X(6).
  1292     12  FILLER                          PIC X(5)
  1293            VALUE ' OPR='.
  1294     12  SM-PROCESSOR-ID                 PIC X(4).
  1295     12  FILLER                          PIC X(6)
  1296            VALUE ' TERM='.
  1297     12  SM-TERMID                       PIC X(4).
  1298     12  FILLER                          PIC XX   VALUE SPACE.
  1299     12  SM-JUL-DATE                     PIC 9(5).
  1300     12  FILLER                          PIC X    VALUE SPACE.
  1301     12  SM-TIME                         PIC 99.99.
  1302
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  28
* EL691.cbl
  1304*    COPY ELCSCRTY.
  1305******************************************************************
  1306*                                                                *
  1307*                                                                *
  1308*                            ELCSCRTY                            *
  1309*                            VMOD=2.001                          *
  1310*                                                                *
  1311*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  1312*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  1313*        SAVED IN PI-SECURITY-ADDRESS.                           *
  1314*                                                                *
  1315******************************************************************
  1316 01  SECURITY-CONTROL.
  1317     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  1318     12  FILLER                       PIC XX    VALUE 'SC'.
  1319     12  SC-CREDIT-CODES.
  1320         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  1321             20  SC-CREDIT-DISPLAY    PIC X.
  1322             20  SC-CREDIT-UPDATE     PIC X.
  1323     12  SC-CLAIMS-CODES.
  1324         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  1325             20  SC-CLAIMS-DISPLAY    PIC X.
  1326             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  29
* EL691.cbl
  1328
  1329*    COPY EL691S.
  1330 01  EL691AI.
  1331     05  FILLER            PIC  X(0012).
  1332*    -------------------------------
  1333     05  RUNDTEL PIC S9(0004) COMP.
  1334     05  RUNDTEF PIC  X(0001).
  1335     05  FILLER REDEFINES RUNDTEF.
  1336         10  RUNDTEA PIC  X(0001).
  1337     05  RUNDTEI PIC  X(0008).
  1338*    -------------------------------
  1339     05  RUNTIMEL PIC S9(0004) COMP.
  1340     05  RUNTIMEF PIC  X(0001).
  1341     05  FILLER REDEFINES RUNTIMEF.
  1342         10  RUNTIMEA PIC  X(0001).
  1343     05  RUNTIMEI PIC  X(0005).
  1344*    -------------------------------
  1345     05  COMPANYL PIC S9(0004) COMP.
  1346     05  COMPANYF PIC  X(0001).
  1347     05  FILLER REDEFINES COMPANYF.
  1348         10  COMPANYA PIC  X(0001).
  1349     05  COMPANYI PIC  X(0003).
  1350*    -------------------------------
  1351     05  USERIDL PIC S9(0004) COMP.
  1352     05  USERIDF PIC  X(0001).
  1353     05  FILLER REDEFINES USERIDF.
  1354         10  USERIDA PIC  X(0001).
  1355     05  USERIDI PIC  X(0004).
  1356*    -------------------------------
  1357     05  CARRIERL PIC S9(0004) COMP.
  1358     05  CARRIERF PIC  X(0001).
  1359     05  FILLER REDEFINES CARRIERF.
  1360         10  CARRIERA PIC  X(0001).
  1361     05  CARRIERI PIC  X(0001).
  1362*    -------------------------------
  1363     05  GROUPL PIC S9(0004) COMP.
  1364     05  GROUPF PIC  X(0001).
  1365     05  FILLER REDEFINES GROUPF.
  1366         10  GROUPA PIC  X(0001).
  1367     05  GROUPI PIC  X(0006).
  1368*    -------------------------------
  1369     05  STATEL PIC S9(0004) COMP.
  1370     05  STATEF PIC  X(0001).
  1371     05  FILLER REDEFINES STATEF.
  1372         10  STATEA PIC  X(0001).
  1373     05  STATEI PIC  X(0002).
  1374*    -------------------------------
  1375     05  ACCTL PIC S9(0004) COMP.
  1376     05  ACCTF PIC  X(0001).
  1377     05  FILLER REDEFINES ACCTF.
  1378         10  ACCTA PIC  X(0001).
  1379     05  ACCTI PIC  X(0010).
  1380*    -------------------------------
  1381     05  CERTL PIC S9(0004) COMP.
  1382     05  CERTF PIC  X(0001).
  1383     05  FILLER REDEFINES CERTF.
  1384         10  CERTA PIC  X(0001).
  1385     05  CERTI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  30
* EL691.cbl
  1386*    -------------------------------
  1387     05  SFXL PIC S9(0004) COMP.
  1388     05  SFXF PIC  X(0001).
  1389     05  FILLER REDEFINES SFXF.
  1390         10  SFXA PIC  X(0001).
  1391     05  SFXI PIC  X(0001).
  1392*    -------------------------------
  1393     05  MAINTL PIC S9(0004) COMP.
  1394     05  MAINTF PIC  X(0001).
  1395     05  FILLER REDEFINES MAINTF.
  1396         10  MAINTA PIC  X(0001).
  1397     05  MAINTI PIC  X(0001).
  1398*    -------------------------------
  1399     05  MAINTBYL PIC S9(0004) COMP.
  1400     05  MAINTBYF PIC  X(0001).
  1401     05  FILLER REDEFINES MAINTBYF.
  1402         10  MAINTBYA PIC  X(0001).
  1403     05  MAINTBYI PIC  X(0004).
  1404*    -------------------------------
  1405     05  MAINTDTL PIC S9(0004) COMP.
  1406     05  MAINTDTF PIC  X(0001).
  1407     05  FILLER REDEFINES MAINTDTF.
  1408         10  MAINTDTA PIC  X(0001).
  1409     05  MAINTDTI PIC  X(0008).
  1410*    -------------------------------
  1411     05  MAINTTML PIC S9(0004) COMP.
  1412     05  MAINTTMF PIC  X(0001).
  1413     05  FILLER REDEFINES MAINTTMF.
  1414         10  MAINTTMA PIC  X(0001).
  1415     05  MAINTTMI PIC  X(0005).
  1416*    -------------------------------
  1417     05  ARCHNOL PIC S9(0004) COMP.
  1418     05  ARCHNOF PIC  X(0001).
  1419     05  FILLER REDEFINES ARCHNOF.
  1420         10  ARCHNOA PIC  X(0001).
  1421     05  ARCHNOI PIC  X(0008).
  1422*    -------------------------------
  1423     05  ENDARCHL PIC S9(0004) COMP.
  1424     05  ENDARCHF PIC  X(0001).
  1425     05  FILLER REDEFINES ENDARCHF.
  1426         10  ENDARCHA PIC  X(0001).
  1427     05  ENDARCHI PIC  X(0008).
  1428*    -------------------------------
  1429     05  FORMNOL PIC S9(0004) COMP.
  1430     05  FORMNOF PIC  X(0001).
  1431     05  FILLER REDEFINES FORMNOF.
  1432         10  FORMNOA PIC  X(0001).
  1433     05  FORMNOI PIC  X(0004).
  1434*    -------------------------------
  1435     05  RESFORML PIC S9(0004) COMP.
  1436     05  RESFORMF PIC  X(0001).
  1437     05  FILLER REDEFINES RESFORMF.
  1438         10  RESFORMA PIC  X(0001).
  1439     05  RESFORMI PIC  X(0004).
  1440*    -------------------------------
  1441     05  CREATDTL PIC S9(0004) COMP.
  1442     05  CREATDTF PIC  X(0001).
  1443     05  FILLER REDEFINES CREATDTF.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  31
* EL691.cbl
  1444         10  CREATDTA PIC  X(0001).
  1445     05  CREATDTI PIC  X(0008).
  1446*    -------------------------------
  1447     05  RESENDL PIC S9(0004) COMP.
  1448     05  RESENDF PIC  X(0001).
  1449     05  FILLER REDEFINES RESENDF.
  1450         10  RESENDA PIC  X(0001).
  1451     05  RESENDI PIC  X(0008).
  1452*    -------------------------------
  1453     05  CREATBYL PIC S9(0004) COMP.
  1454     05  CREATBYF PIC  X(0001).
  1455     05  FILLER REDEFINES CREATBYF.
  1456         10  CREATBYA PIC  X(0001).
  1457     05  CREATBYI PIC  X(0004).
  1458*    -------------------------------
  1459     05  PRINTDTL PIC S9(0004) COMP.
  1460     05  PRINTDTF PIC  X(0001).
  1461     05  FILLER REDEFINES PRINTDTF.
  1462         10  PRINTDTA PIC  X(0001).
  1463     05  PRINTDTI PIC  X(0008).
  1464*    -------------------------------
  1465     05  RESPRNTL PIC S9(0004) COMP.
  1466     05  RESPRNTF PIC  X(0001).
  1467     05  FILLER REDEFINES RESPRNTF.
  1468         10  RESPRNTA PIC  X(0001).
  1469     05  RESPRNTI PIC  X(0008).
  1470*    -------------------------------
  1471     05  STCOMPL PIC S9(0004) COMP.
  1472     05  STCOMPF PIC  X(0001).
  1473     05  FILLER REDEFINES STCOMPF.
  1474         10  STCOMPA PIC  X(0001).
  1475     05  STCOMPI PIC  X(0019).
  1476*    -------------------------------
  1477     05  REPLYL PIC S9(0004) COMP.
  1478     05  REPLYF PIC  X(0001).
  1479     05  FILLER REDEFINES REPLYF.
  1480         10  REPLYA PIC  X(0001).
  1481     05  REPLYI PIC  X(0008).
  1482*    -------------------------------
  1483     05  STRECVL PIC S9(0004) COMP.
  1484     05  STRECVF PIC  X(0001).
  1485     05  FILLER REDEFINES STRECVF.
  1486         10  STRECVA PIC  X(0001).
  1487     05  STRECVI PIC  X(0019).
  1488*    -------------------------------
  1489     05  STOPDTEL PIC S9(0004) COMP.
  1490     05  STOPDTEF PIC  X(0001).
  1491     05  FILLER REDEFINES STOPDTEF.
  1492         10  STOPDTEA PIC  X(0001).
  1493     05  STOPDTEI PIC  X(0008).
  1494*    -------------------------------
  1495     05  STSTOPL PIC S9(0004) COMP.
  1496     05  STSTOPF PIC  X(0001).
  1497     05  FILLER REDEFINES STSTOPF.
  1498         10  STSTOPA PIC  X(0001).
  1499     05  STSTOPI PIC  X(0019).
  1500*    -------------------------------
  1501     05  FINDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  32
* EL691.cbl
  1502     05  FINDATEF PIC  X(0001).
  1503     05  FILLER REDEFINES FINDATEF.
  1504         10  FINDATEA PIC  X(0001).
  1505     05  FINDATEI PIC  X(0008).
  1506*    -------------------------------
  1507     05  STFINLL PIC S9(0004) COMP.
  1508     05  STFINLF PIC  X(0001).
  1509     05  FILLER REDEFINES STFINLF.
  1510         10  STFINLA PIC  X(0001).
  1511     05  STFINLI PIC  X(0019).
  1512*    -------------------------------
  1513     05  FINLACTL PIC S9(0004) COMP.
  1514     05  FINLACTF PIC  X(0001).
  1515     05  FILLER REDEFINES FINLACTF.
  1516         10  FINLACTA PIC  X(0001).
  1517     05  FINLACTI PIC  X(0001).
  1518*    -------------------------------
  1519     05  COMMENTL PIC S9(0004) COMP.
  1520     05  COMMENTF PIC  X(0001).
  1521     05  FILLER REDEFINES COMMENTF.
  1522         10  COMMENTA PIC  X(0001).
  1523     05  COMMENTI PIC  X(0069).
  1524*    -------------------------------
  1525     05  ERRMSG1L PIC S9(0004) COMP.
  1526     05  ERRMSG1F PIC  X(0001).
  1527     05  FILLER REDEFINES ERRMSG1F.
  1528         10  ERRMSG1A PIC  X(0001).
  1529     05  ERRMSG1I PIC  X(0079).
  1530*    -------------------------------
  1531     05  ERRMSG2L PIC S9(0004) COMP.
  1532     05  ERRMSG2F PIC  X(0001).
  1533     05  FILLER REDEFINES ERRMSG2F.
  1534         10  ERRMSG2A PIC  X(0001).
  1535     05  ERRMSG2I PIC  X(0079).
  1536 01  EL691AO REDEFINES EL691AI.
  1537     05  FILLER            PIC  X(0012).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  RUNDTEO PIC  X(0008).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  RUNTIMEO PIC  99.99.
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  COMPANYO PIC  X(0003).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  USERIDO PIC  X(0004).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  CARRIERO PIC  X(0001).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  GROUPO PIC  X(0006).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  STATEO PIC  X(0002).
  1559*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  33
* EL691.cbl
  1560     05  FILLER            PIC  X(0003).
  1561     05  ACCTO PIC  X(0010).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  CERTO PIC  X(0010).
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  SFXO PIC  X(0001).
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  MAINTO PIC  X(0001).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  MAINTBYO PIC  X(0004).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  MAINTDTO PIC  99B99B99.
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  MAINTTMO PIC  99.99.
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  ARCHNOO PIC  X(0008).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  ENDARCHO PIC  X(0008).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  FORMNOO PIC  X(0004).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  RESFORMO PIC  X(0004).
  1592*    -------------------------------
  1593     05  FILLER            PIC  X(0003).
  1594     05  CREATDTO PIC  99B99B99.
  1595*    -------------------------------
  1596     05  FILLER            PIC  X(0003).
  1597     05  RESENDO PIC  99B99B99.
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
  1600     05  CREATBYO PIC  X(0004).
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  PRINTDTO PIC  99B99B99.
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  RESPRNTO PIC  99B99B99.
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  STCOMPO PIC  X(0019).
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  REPLYO PIC  99B99B99.
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  STRECVO PIC  X(0019).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  34
* EL691.cbl
  1618     05  STOPDTEO PIC  99B99B99.
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  STSTOPO PIC  X(0019).
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  FINDATEO PIC  99B99B99.
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  STFINLO PIC  X(0019).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  FINLACTO PIC  X(0001).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  COMMENTO PIC  X(0069).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  ERRMSG1O PIC  X(0079).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  ERRMSG2O PIC  X(0079).
  1640*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  35
* EL691.cbl
  1642****************************************************************
  1643*
  1644* Copyright (c) 2007 by Clerity Solutions, Inc.
  1645* All rights reserved.
  1646*
  1647****************************************************************
  1648 01  DFHEIV.
  1649   02  DFHEIV0               PIC X(35).
  1650   02  DFHEIV1               PIC X(08).
  1651   02  DFHEIV2               PIC X(08).
  1652   02  DFHEIV3               PIC X(08).
  1653   02  DFHEIV4               PIC X(06).
  1654   02  DFHEIV5               PIC X(04).
  1655   02  DFHEIV6               PIC X(04).
  1656   02  DFHEIV7               PIC X(02).
  1657   02  DFHEIV8               PIC X(02).
  1658   02  DFHEIV9               PIC X(01).
  1659   02  DFHEIV10              PIC S9(7) COMP-3.
  1660   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1661   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1662   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1663   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1664   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1665   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1666   02  DFHEIV17              PIC X(04).
  1667   02  DFHEIV18              PIC X(04).
  1668   02  DFHEIV19              PIC X(04).
  1669   02  DFHEIV20              USAGE IS POINTER.
  1670   02  DFHEIV21              USAGE IS POINTER.
  1671   02  DFHEIV22              USAGE IS POINTER.
  1672   02  DFHEIV23              USAGE IS POINTER.
  1673   02  DFHEIV24              USAGE IS POINTER.
  1674   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1675   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1676   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1677   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1678   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1679   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1680   02  FILLER                PIC X(02).
  1681   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1682   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1683   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1684   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1685   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1686 LINKAGE  SECTION.
  1687*****************************************************************
  1688*                                                               *
  1689* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1690* All rights reserved.                                          *
  1691*                                                               *
  1692*****************************************************************
  1693 01  dfheiblk.
  1694     02  eibtime          pic s9(7) comp-3.
  1695     02  eibdate          pic s9(7) comp-3.
  1696     02  eibtrnid         pic x(4).
  1697     02  eibtaskn         pic s9(7) comp-3.
  1698     02  eibtrmid         pic x(4).
  1699     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  36
* EL691.cbl
  1700     02  eibcposn         pic s9(4) comp.
  1701     02  eibcalen         pic s9(4) comp.
  1702     02  eibaid           pic x(1).
  1703     02  eibfiller1       pic x(1).
  1704     02  eibfn            pic x(2).
  1705     02  eibfiller2       pic x(2).
  1706     02  eibrcode         pic x(6).
  1707     02  eibfiller3       pic x(2).
  1708     02  eibds            pic x(8).
  1709     02  eibreqid         pic x(8).
  1710     02  eibrsrce         pic x(8).
  1711     02  eibsync          pic x(1).
  1712     02  eibfree          pic x(1).
  1713     02  eibrecv          pic x(1).
  1714     02  eibsend          pic x(1).
  1715     02  eibatt           pic x(1).
  1716     02  eibeoc           pic x(1).
  1717     02  eibfmh           pic x(1).
  1718     02  eibcompl         pic x(1).
  1719     02  eibsig           pic x(1).
  1720     02  eibconf          pic x(1).
  1721     02  eiberr           pic x(1).
  1722     02  eibrldbk         pic x(1).
  1723     02  eiberrcd         pic x(4).
  1724     02  eibsynrb         pic x(1).
  1725     02  eibnodat         pic x(1).
  1726     02  eibfiller5       pic x(2).
  1727     02  eibresp          pic 9(09) comp.
  1728     02  eibresp2         pic 9(09) comp.
  1729     02  dfheigdj         pic s9(4) comp.
  1730     02  dfheigdk         pic s9(4) comp.
  1731 01  DFHCOMMAREA                 PIC X(1024).
  1732
  1733*    COPY ERCARCH.
  1734******************************************************************
  1735*                                                                *
  1736*                            ERCARCH.                            *
  1737*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1738*                            VMOD=2.002                          *
  1739*                                                                *
  1740*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  1741*                                                                *
  1742*   FILE TYPE = VSAM,KSDS                                        *
  1743*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1744*                                                                *
  1745*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  1746*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  1747*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  1748*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  1749*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  1750*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  1751*                                                                *
  1752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1753******************************************************************
  1754*                   C H A N G E   L O G
  1755*
  1756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1757*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  37
* EL691.cbl
  1758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1759* EFFECTIVE    NUMBER
  1760*-----------------------------------------------------------------
  1761* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1762* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1763* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1764******************************************************************
  1765 01  LETTER-ARCHIVE.
  1766     12  LA-RECORD-ID                PIC  X(02).
  1767         88  LA-VALID-ID                VALUE 'LA'.
  1768
  1769     12  LA-CONTROL-PRIMARY.
  1770         16  LA-COMPANY-CD           PIC  X(01).
  1771         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  1772
  1773     12  LA-CONTROL-BY-CERT-RESP.
  1774         16  LA-COMPANY-CD-A2        PIC  X(01).
  1775         16  LA-CERT-NO-A2.
  1776             20  LA-CERT-PRIME-A2    PIC  X(10).
  1777             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  1778         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  1779             20  LA-RESP-PERSON-A2   PIC  X(10).
  1780             20  LA-TYPE-A2          PIC  X(01).
  1781         16  LA-CARRIER-A2           PIC  X(01).
  1782         16  LA-GROUPING-A2          PIC  X(06).
  1783         16  LA-STATE-A2             PIC  X(02).
  1784         16  LA-ACCOUNT-A2           PIC  X(10).
  1785         16  LA-EFFECT-DATE-A2       PIC  X(02).
  1786         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  1787
  1788     12  LA-CONTROL-BY-FORM.
  1789         16  LA-COMPANY-CD-A3        PIC  X(01).
  1790         16  LA-FORM-A3              PIC  X(04).
  1791         16  LA-CARRIER-A3           PIC  X(01).
  1792         16  LA-GROUPING-A3          PIC  X(06).
  1793         16  LA-STATE-A3             PIC  X(02).
  1794         16  LA-ACCOUNT-A3           PIC  X(10).
  1795         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  1796
  1797     12  LA-CONTROL-BY-PROCESSOR.
  1798         16  LA-COMPANY-CD-A4        PIC  X(01).
  1799         16  LA-PROCESSOR-CD         PIC  X(04).
  1800         16  LA-CARRIER-A4           PIC  X(01).
  1801         16  LA-GROUPING-A4          PIC  X(06).
  1802         16  LA-STATE-A4             PIC  X(02).
  1803         16  LA-ACCOUNT-A4           PIC  X(10).
  1804         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  1805
  1806     12  LA-CONTROL-BY-KEY-FIELDS.
  1807         16  LA-COMPANY-CD-A5        PIC  X(01).
  1808         16  LA-CARRIER-A5           PIC  X(01).
  1809         16  LA-GROUPING-A5          PIC  X(06).
  1810         16  LA-STATE-A5             PIC  X(02).
  1811         16  LA-ACCOUNT-A5           PIC  X(10).
  1812         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  1813
  1814     12  LA-CONTROL-BY-GROUP-CODE.
  1815         16  LA-COMPANY-CD-A6        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  38
* EL691.cbl
  1816         16  LA-ENTRY-A6.
  1817             20  LA-FILLER           PIC  X(02).
  1818             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  1819         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  1820
  1821     12  FILLER                      PIC  X(09).
  1822
  1823     12  LA-HEADER-RECORD.
  1824         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  1825         16  LA-CREATION-DATE        PIC  X(02).
  1826         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  1827         16  LA-FINAL-ACT-DATE       REDEFINES
  1828               LA-FOLLOW-UP-DATE     PIC  X(02).
  1829         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  1830         16  LA-NO-OF-COPIES         PIC S9(01).
  1831         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  1832         16  LA-REPLY-DATE           PIC  X(02).
  1833         16  LA-RESEND-DATES.
  1834             20  LA-RESEND-DATE      PIC  X(02).
  1835             20  LA-SENT-DATE        PIC  X(02).
  1836             20  FILLER              PIC  X(08).
  1837         16  LA-SOURCE-INFORMATION.
  1838             20  LA-DATA-SOURCE      PIC  X(01).
  1839             20  LA-ADDR-SOURCE      PIC  X(01).
  1840         16  LA-STATUS               PIC  X(01).
  1841             88  LA-STATUS-ACTIVE         VALUE 'A'.
  1842             88  LA-STATUS-COMPLETED      VALUE 'C'.
  1843             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  1844             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  1845             88  LA-STATUS-PURGED         VALUE 'P'.
  1846             88  LA-STATUS-VOIDED         VALUE 'V'.
  1847         16  LA-LAST-RESENT-PRINT-DATE
  1848                                     PIC  X(02).
  1849         16  LA-PRINT-RESTRICTION    PIC  X(01).
  1850             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  1851                                          VALUE 'C'.
  1852             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  1853                                          VALUE 'F'.
  1854             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  1855                                          VALUE 'P'.
  1856         16  LA-PURGED-DATE          PIC  X(02).
  1857         16  LA-VOIDED-DATE          PIC  X(02).
  1858         16  LA-RESEND-LETR          PIC  X(4).
  1859         16  FILLER                  PIC  X(08).
  1860*        16  LA-RESEND-LETR-2        PIC  X(4).
  1861*        16  LA-RESEND-LETR-3        PIC  X(4).
  1862*        16  FILLER                  PIC  X(59).
  1863         16  LA-ARCHIVE-STATUS       PIC  X.
  1864             88  LA-TEMP                VALUE 'T'.
  1865             88  LA-QWS                 VALUE 'Q'.
  1866             88  LA-BATCH               VALUE 'B'.
  1867         16  LA-FINAL-ACT-IND        PIC  X(1).
  1868         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  1869         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  1870         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  1871                                     PIC X(4).
  1872         16  FILLER                  PIC  X(42).
  1873*        16  FILLER                  PIC  X(71).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  39
* EL691.cbl
  1874         16  LA-LAST-MAINT-DATE      PIC  X(2).
  1875         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  1876         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  1877                                     PIC  X(4).
  1878         16  LA-LAST-UPDATED-BY      PIC  X(4).
  1879
  1880******************************************************************
  1881
  1882*    COPY ERCARCT.
  1883******************************************************************
  1884*                                                                *
  1885*                            ERCARCT.                            *
  1886*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1887*                            VMOD=2.002                          *
  1888*                                                                *
  1889*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  1890*                                                                *
  1891*   FILE TYPE = VSAM,KSDS                                        *
  1892*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  1893*                                                                *
  1894*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  1895*                                                                *
  1896*   LOG = NO                                                     *
  1897*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1898******************************************************************
  1899*                   C H A N G E   L O G
  1900*
  1901* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1902*-----------------------------------------------------------------
  1903*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1904* EFFECTIVE    NUMBER
  1905*-----------------------------------------------------------------
  1906* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1907******************************************************************
  1908 01  LETTER-ARCHIVE-TEXT.
  1909     12  LT-RECORD-ID                PIC  X(02).
  1910         88  LT-VALID-ID                VALUE 'LT'.
  1911
  1912     12  LT-CONTROL-PRIMARY.
  1913         16  LT-COMPANY-CD           PIC  X(01).
  1914         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  1915         16  LT-RECORD-TYPE          PIC  X(01).
  1916             88  LT-ADDRESS-DATA        VALUE '1'.
  1917             88  LT-TEXT-DATA           VALUE '2'.
  1918             88  LT-COMMENT-DATA        VALUE '3'.
  1919         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  1920
  1921     12  FILLER                      PIC  X(28).
  1922     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  1923
  1924     12  LT-TEXT-RECORD.
  1925         16  LT-LETTER-TEXT OCCURS 20 TIMES
  1926                            INDEXED BY LT-NDX.
  1927             20  LT-TEXT-LINE        PIC  X(70).
  1928             20  LT-SKIP-CONTROL     PIC  X(02).
  1929                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  1930                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  1931             20  FILLER              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  40
* EL691.cbl
  1932
  1933     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  1934         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  1935             20  LT-COMMENT-LINE     PIC X(69).
  1936             20  LT-COMMENT-CHG-DT   PIC X(02).
  1937             20  LT-COMMENT-CHG-BY   PIC X(04).
  1938             20  FILLER              PIC X(05).
  1939
  1940
  1941*    COPY ERCCNOT.
  1942******************************************************************
  1943*                                                                *
  1944*                            ERCCNOT                             *
  1945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1946*                            VMOD=2.003                          *
  1947*                                                                *
  1948*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1949*                                                                *
  1950*        FILE TYPE= VSAM,KSDS                                    *
  1951*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1952*                                                                *
  1953*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1954*                                                                *
  1955*        LOG = YES                                               *
  1956*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1957*                                                                *
  1958******************************************************************
  1959*                   C H A N G E   L O G
  1960*
  1961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1962*-----------------------------------------------------------------
  1963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1964* EFFECTIVE    NUMBER
  1965*-----------------------------------------------------------------
  1966* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1967******************************************************************
  1968
  1969 01  CERT-NOTE-FILE.
  1970     12  CZ-RECORD-ID                PIC  XX.
  1971         88  VALID-CZ-ID                  VALUE 'CZ'.
  1972
  1973     12  CZ-CONTROL-PRIMARY.
  1974         16  CZ-COMPANY-CD           PIC X.
  1975         16  CZ-CARRIER              PIC X.
  1976         16  CZ-GROUPING.
  1977             20 CZ-GROUPING-PREFIX   PIC XXX.
  1978             20 CZ-GROUPING-PRIME    PIC XXX.
  1979         16  CZ-STATE                PIC XX.
  1980         16  CZ-ACCOUNT.
  1981             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1982             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1983         16  CZ-CERT-EFF-DT          PIC XX.
  1984         16  CZ-CERT-NO.
  1985             20  CZ-CERT-PRIME       PIC X(10).
  1986             20  CZ-CERT-SFX         PIC X.
  1987         16  CZ-RECORD-TYPE          PIC X.
  1988             88  CERT-NOTE           VALUE '1'.
  1989             88  CLAIM-CERT-NOTE     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  41
* EL691.cbl
  1990         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1991
  1992     12  CZ-LAST-MAINT-DT            PIC XX.
  1993     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1994     12  CZ-LAST-MAINT-USER          PIC X(4).
  1995
  1996     12  CZ-NOTE-INFORMATION.
  1997         16  CZ-NOTE                 PIC X(63).
  1998         16  FILLER                  PIC X(39).
  1999******************************************************************
  2000
  2001*    COPY ELCCERT.
  2002******************************************************************
  2003*                                                                *
  2004*                            ELCCERT.                            *
  2005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2006*                            VMOD=2.013                          *
  2007*                                                                *
  2008*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2009*                                                                *
  2010*   FILE TYPE = VSAM,KSDS                                        *
  2011*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2012*                                                                *
  2013*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2014*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2015*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2016*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2017*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2018*                                                                *
  2019*   LOG = YES                                                    *
  2020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2021******************************************************************
  2022*                   C H A N G E   L O G
  2023*
  2024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2025*-----------------------------------------------------------------
  2026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2027* EFFECTIVE    NUMBER
  2028*-----------------------------------------------------------------
  2029* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2030* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2031* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2032* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2033* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2034* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2035* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2036* 032612  CR2011110200001  PEMA  AHL CHANGES
  2037******************************************************************
  2038
  2039 01  CERTIFICATE-MASTER.
  2040     12  CM-RECORD-ID                      PIC XX.
  2041         88  VALID-CM-ID                      VALUE 'CM'.
  2042
  2043     12  CM-CONTROL-PRIMARY.
  2044         16  CM-COMPANY-CD                 PIC X.
  2045         16  CM-CARRIER                    PIC X.
  2046         16  CM-GROUPING.
  2047             20  CM-GROUPING-PREFIX        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  42
* EL691.cbl
  2048             20  CM-GROUPING-PRIME         PIC X(3).
  2049         16  CM-STATE                      PIC XX.
  2050         16  CM-ACCOUNT.
  2051             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2052             20  CM-ACCOUNT-PRIME          PIC X(6).
  2053         16  CM-CERT-EFF-DT                PIC XX.
  2054         16  CM-CERT-NO.
  2055             20  CM-CERT-PRIME             PIC X(10).
  2056             20  CM-CERT-SFX               PIC X.
  2057
  2058     12  CM-CONTROL-BY-NAME.
  2059         16  CM-COMPANY-CD-A1              PIC X.
  2060         16  CM-INSURED-LAST-NAME          PIC X(15).
  2061         16  CM-INSURED-INITIALS.
  2062             20  CM-INSURED-INITIAL1       PIC X.
  2063             20  CM-INSURED-INITIAL2       PIC X.
  2064
  2065     12  CM-CONTROL-BY-SSN.
  2066         16  CM-COMPANY-CD-A2              PIC X.
  2067         16  CM-SOC-SEC-NO.
  2068             20  CM-SSN-STATE              PIC XX.
  2069             20  CM-SSN-ACCOUNT            PIC X(6).
  2070             20  CM-SSN-LN3.
  2071                 25  CM-INSURED-INITIALS-A2.
  2072                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2073                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2074                 25 CM-PART-LAST-NAME-A2         PIC X.
  2075
  2076     12  CM-CONTROL-BY-CERT-NO.
  2077         16  CM-COMPANY-CD-A4              PIC X.
  2078         16  CM-CERT-NO-A4                 PIC X(11).
  2079
  2080     12  CM-CONTROL-BY-MEMB.
  2081         16  CM-COMPANY-CD-A5              PIC X.
  2082         16  CM-MEMBER-NO.
  2083             20  CM-MEMB-STATE             PIC XX.
  2084             20  CM-MEMB-ACCOUNT           PIC X(6).
  2085             20  CM-MEMB-LN4.
  2086                 25  CM-INSURED-INITIALS-A5.
  2087                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2088                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2089                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2090
  2091     12  CM-INSURED-PROFILE-DATA.
  2092         16  CM-INSURED-FIRST-NAME.
  2093             20  CM-INSURED-1ST-INIT       PIC X.
  2094             20  FILLER                    PIC X(9).
  2095         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2096         16  CM-INSURED-SEX                PIC X.
  2097             88  CM-SEX-MALE                  VALUE 'M'.
  2098             88  CM-SEX-FEMAL                 VALUE 'F'.
  2099         16  CM-INSURED-JOINT-AGE          PIC 99.
  2100         16  CM-JOINT-INSURED-NAME.
  2101             20  CM-JT-LAST-NAME           PIC X(15).
  2102             20  CM-JT-FIRST-NAME.
  2103                 24  CM-JT-1ST-INIT        PIC X.
  2104                 24  FILLER                PIC X(9).
  2105             20  CM-JT-INITIAL             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  43
* EL691.cbl
  2106
  2107     12  CM-LIFE-DATA.
  2108         16  CM-LF-BENEFIT-CD              PIC XX.
  2109         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2110         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2111         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2112         16  CM-LF-DEV-CODE                PIC XXX.
  2113         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2114         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2115         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2116         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2117         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2118         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2119         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2120         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2121         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2122         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2123         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2124         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2125         16  FILLER                        PIC XX.
  2126
  2127     12  CM-AH-DATA.
  2128         16  CM-AH-BENEFIT-CD              PIC XX.
  2129         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2130         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2131         16  CM-AH-DEV-CODE                PIC XXX.
  2132         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2133         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2134         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2135         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2136         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2137         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2138         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2139         16  CM-AH-PAID-THRU-DT            PIC XX.
  2140             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2141         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2142         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2143         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2144         16  FILLER                        PIC X.
  2145
  2146     12  CM-LOAN-INFORMATION.
  2147         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2148         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2149                                           PIC S9(5)V99  COMP-3.
  2150         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2151         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2152         16  CM-PAY-FREQUENCY              PIC S99.
  2153         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2154         16  CM-RATE-CLASS                 PIC XX.
  2155         16  CM-BENEFICIARY                PIC X(25).
  2156         16  CM-POLICY-FORM-NO             PIC X(12).
  2157         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2158         16  CM-LAST-ADD-ON-DT             PIC XX.
  2159         16  CM-DEDUCTIBLE-AMOUNTS.
  2160             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2161             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2162         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2163             20  CM-RESIDENT-STATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  44
* EL691.cbl
  2164             20  CM-RATE-CODE              PIC X(4).
  2165             20  FILLER                    PIC XX.
  2166         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2167             20  CM-LOAN-OFFICER           PIC X(5).
  2168             20  FILLER                    PIC XXX.
  2169         16  CM-CSR-CODE                   PIC XXX.
  2170         16  CM-UNDERWRITING-CODE          PIC X.
  2171             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2172         16  CM-POST-CARD-IND              PIC X.
  2173         16  CM-NH-INTERFACE-SW            PIC X.
  2174         16  CM-PREMIUM-TYPE               PIC X.
  2175             88  CM-SING-PRM                  VALUE '1'.
  2176             88  CM-O-B-COVERAGE              VALUE '2'.
  2177             88  CM-OPEN-END                  VALUE '3'.
  2178         16  CM-IND-GRP-TYPE               PIC X.
  2179             88  CM-INDIVIDUAL                VALUE 'I'.
  2180             88  CM-GROUP                     VALUE 'G'.
  2181         16  CM-SKIP-CODE                  PIC X.
  2182             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2183             88  SKIP-JULY                    VALUE '1'.
  2184             88  SKIP-AUGUST                  VALUE '2'.
  2185             88  SKIP-SEPTEMBER               VALUE '3'.
  2186             88  SKIP-JULY-AUG                VALUE '4'.
  2187             88  SKIP-AUG-SEPT                VALUE '5'.
  2188             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2189             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2190             88  SKIP-JUNE                    VALUE '8'.
  2191             88  SKIP-JUNE-JULY               VALUE '9'.
  2192             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2193             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2194         16  CM-PAYMENT-MODE               PIC X.
  2195             88  PAY-MONTHLY                  VALUE SPACE.
  2196             88  PAY-WEEKLY                   VALUE '1'.
  2197             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2198             88  PAY-BI-WEEKLY                VALUE '3'.
  2199             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2200         16  CM-LOAN-NUMBER                PIC X(8).
  2201         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2202         16  CM-OLD-LOF                    PIC XXX.
  2203*        16  CM-LOAN-OFFICER               PIC XXX.
  2204         16  CM-REIN-TABLE                 PIC XXX.
  2205         16  CM-SPECIAL-REIN-CODE          PIC X.
  2206         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2207         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2208         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2209
  2210     12  CM-STATUS-DATA.
  2211         16  CM-ENTRY-STATUS               PIC X.
  2212         16  CM-ENTRY-DT                   PIC XX.
  2213
  2214         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2215         16  CM-LF-CANCEL-DT               PIC XX.
  2216         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2217
  2218         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2219         16  CM-LF-DEATH-DT                PIC XX.
  2220         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2221
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  45
* EL691.cbl
  2222         16  CM-LF-CURRENT-STATUS          PIC X.
  2223             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2224                                                'M' '4' '5' '9'.
  2225             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2226             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2227             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2228             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2229             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2230             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2231             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2232             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2233             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2234             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2235             88  CM-LF-DECLINED               VALUE 'D'.
  2236             88  CM-LF-VOIDED                 VALUE 'V'.
  2237
  2238         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2239         16  CM-AH-CANCEL-DT               PIC XX.
  2240         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2241
  2242         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2243         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2244         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2245
  2246         16  CM-AH-CURRENT-STATUS          PIC X.
  2247             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2248                                                'M' '4' '5' '9'.
  2249             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2250             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2251             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2252             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2253             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2254             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2255             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2256             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2257             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2258             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2259             88  CM-AH-DECLINED               VALUE 'D'.
  2260             88  CM-AH-VOIDED                 VALUE 'V'.
  2261
  2262         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2263             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2264             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2265             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2266         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2267
  2268         16  CM-ENTRY-BATCH                PIC X(6).
  2269         16  CM-LF-EXIT-BATCH              PIC X(6).
  2270         16  CM-AH-EXIT-BATCH              PIC X(6).
  2271         16  CM-LAST-MONTH-END             PIC XX.
  2272
  2273     12  CM-NOTE-SW                        PIC X.
  2274         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2275         88  CERT-NOTES-PRESENT               VALUE '1'.
  2276         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2277         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2278         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2279         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  46
* EL691.cbl
  2280         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2281         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2282     12  CM-COMP-EXCP-SW                   PIC X.
  2283         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2284         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2285     12  CM-INSURED-ADDRESS-SW             PIC X.
  2286         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2287         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2288
  2289*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2290     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2291     12  FILLER                            PIC X.
  2292
  2293*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2294     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2295     12  FILLER                            PIC X.
  2296*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2297     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2298
  2299     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2300         88  CERT-ADDED-BATCH                 VALUE ' '.
  2301         88  CERT-ADDED-ONLINE                VALUE '1'.
  2302         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2303         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2304         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2305     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2306         88  CERT-AS-LOADED                   VALUE ' '.
  2307         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2308         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2309         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2310         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2311         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2312         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2313         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2314
  2315     12  CM-ACCOUNT-COMM-PCTS.
  2316         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2317         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2318
  2319     12  CM-USER-FIELD                     PIC X.
  2320     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2321     12  CM-CLP-STATE                      PIC XX.
  2322     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2323     12  CM-USER-RESERVED                  PIC XXX.
  2324     12  FILLER REDEFINES CM-USER-RESERVED.
  2325         16  CM-AH-CLASS-CD                PIC XX.
  2326         16  F                             PIC X.
  2327******************************************************************
  2328
  2329*    COPY ELCEOBC.
  2330******************************************************************
  2331*                                                                *
  2332*                                                                *
  2333*                            ELCEOBC                             *
  2334*                            VMOD=2.001                          *
  2335*                                                                *
  2336*   CLAIM SYSTEM EOB CODE TABLE                                  *
  2337*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  47
* EL691.cbl
  2338*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2339*   VSAM EOB CODE TABLE                                          *
  2340*                                                                *
  2341*   FILE DESCRIPTION = EOB CODE TABLE                            *
  2342*                                                                *
  2343*   FILE TYPE = VSAM,KSDS                                        *
  2344*   RECORD SIZE = 350   RECFORM = FIX                            *
  2345*                                                                *
  2346*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  2347*                                                                *
  2348*   LOG = NO                                                     *
  2349*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2350*                                                                *
  2351*                                                                *
  2352******************************************************************
  2353*                   C H A N G E   L O G
  2354*
  2355* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2356*-----------------------------------------------------------------
  2357*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2358* EFFECTIVE    NUMBER
  2359*-----------------------------------------------------------------
  2360* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  2361* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  2362******************************************************************
  2363 01  EOB-CODES.
  2364     12  EO-RECORD-ID                      PIC XX.
  2365         88  VALID-DN-ID                      VALUE 'EO'.
  2366     12  EO-CONTROL-PRIMARY.
  2367         16  EO-COMPANY-CD                 PIC X.
  2368         16  EO-RECORD-TYPE                PIC X.
  2369             88  EO-EOB-RECS                  VALUE '1'.
  2370             88  EO-VERIF-RECS                VALUE '2'.
  2371             88  EO-GCE-RECS                  VALUE '3'.
  2372         16  EO-EOB-CODE                   PIC X(4).
  2373         16  FILLER                        PIC X(9).
  2374     12  EO-MAINT-INFORMATION.
  2375         16  EO-LAST-MAINT-DT              PIC XX.
  2376         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2377         16  EO-LAST-MAINT-USER            PIC X(4).
  2378         16  FILLER                        PIC XX.
  2379     12  EO-DESCRIPTION                    PIC X(275).
  2380     12  FILLER                            PIC X(46).
  2381******************************************************************
  2382
  2383*    COPY ERCNOTE.
  2384******************************************************************
  2385*                                                                *
  2386*                                                                *
  2387*                            ERCNOTE                             *
  2388*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2389*                            VMOD=2.003                          *
  2390*                                                                *
  2391*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2392*                                                                *
  2393*        FILE TYPE= VSAM,KSDS                                    *
  2394*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2395*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  48
* EL691.cbl
  2396*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2397*                                                                *
  2398*        LOG = YES                                               *
  2399*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2400*                                                                *
  2401******************************************************************
  2402*                   C H A N G E   L O G
  2403*
  2404* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2405*-----------------------------------------------------------------
  2406*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2407* EFFECTIVE    NUMBER
  2408*-----------------------------------------------------------------
  2409* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2410*                                FILE WILL CONTAIN BILLING NOTES O
  2411******************************************************************
  2412
  2413 01  CERTIFICATE-NOTE.
  2414     12  CN-RECORD-ID                PIC  XX.
  2415         88  VALID-CN-ID                  VALUE 'CN'.
  2416
  2417     12  CN-CONTROL-PRIMARY.
  2418         16  CN-COMPANY-CD           PIC X.
  2419         16  CN-CARRIER              PIC X.
  2420         16  CN-GROUPING.
  2421             20 CN-GROUPING-PREFIX   PIC XXX.
  2422             20 CN-GROUPING-PRIME    PIC XXX.
  2423         16  CN-STATE                PIC XX.
  2424         16  CN-ACCOUNT.
  2425             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2426             20 CN-ACCOUNT-PRIME     PIC X(6).
  2427         16  CN-CERT-EFF-DT          PIC XX.
  2428         16  CN-CERT-NO.
  2429             20  CN-CERT-PRIME       PIC X(10).
  2430             20  CN-CERT-SFX         PIC X.
  2431
  2432     12  CN-BILLING-START-LINE-NO    PIC 99.
  2433     12  CN-BILLING-END-LINE-NO      PIC 99.
  2434
  2435     12  CN-LINES.
  2436         16  CN-LINE OCCURS 10       PIC X(77).
  2437
  2438     12  CN-LAST-MAINT-DT            PIC XX.
  2439     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2440     12  CN-LAST-MAINT-USER          PIC X(4).
  2441     12  FILLER                      PIC X(6).
  2442******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  49
* EL691.cbl
  2444
  2445 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  2446                          LETTER-ARCHIVE-TEXT CERT-NOTE-FILE
  2447                          CERTIFICATE-MASTER EOB-CODES
  2448                          CERTIFICATE-NOTE.
  2449 0000-DFHEXIT SECTION.
  2450     MOVE '9#                    $   ' TO DFHEIV0.
  2451     MOVE 'EL691' TO DFHEIV1.
  2452     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2453     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2454
  2455     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2456     MOVE '5'                    TO DC-OPTION-CODE.
  2457     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  2458     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  2459     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  2460                                    W-CURRENT-SAVE.
  2461
  2462     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2463     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  2464                                 TO EMI-SAVE-AREA.
  2465
  2466     IF  EIBCALEN EQUAL 0
  2467         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  2468         GO TO 8300-SEND-TEXT
  2469     END-IF.
  2470
  2471     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  2472         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  2473             MOVE PI-SAVED-PROGRAM-5
  2474                                 TO PI-SAVED-PROGRAM-6
  2475             MOVE PI-SAVED-PROGRAM-4
  2476                                 TO PI-SAVED-PROGRAM-5
  2477             MOVE PI-SAVED-PROGRAM-3
  2478                                 TO PI-SAVED-PROGRAM-4
  2479             MOVE PI-SAVED-PROGRAM-2
  2480                                 TO PI-SAVED-PROGRAM-3
  2481             MOVE PI-SAVED-PROGRAM-1
  2482                                 TO PI-SAVED-PROGRAM-2
  2483             MOVE PI-RETURN-TO-PROGRAM
  2484                                 TO PI-SAVED-PROGRAM-1
  2485             MOVE PI-CALLING-PROGRAM
  2486                                 TO PI-RETURN-TO-PROGRAM
  2487             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  2488         ELSE
  2489             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  2490             MOVE PI-RETURN-TO-PROGRAM
  2491                                     TO PI-CALLING-PROGRAM
  2492             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  2493             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  2494             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  2495             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  2496             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  2497             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  2498             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  2499         END-IF
  2500     ELSE
  2501         GO TO 0200-RECEIVE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  50
* EL691.cbl
  2502     END-IF.
  2503
  2504     GO TO 1000-SHOW.
  2505
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  51
* EL691.cbl
  2507
  2508 0200-RECEIVE.
  2509
  2510
  2511* EXEC CICS HANDLE AID
  2512*        CLEAR    (9300-DFHCLEAR)
  2513*        PA1      (9200-PA)
  2514*        PA2      (9200-PA)
  2515*        PA3      (9200-PA)
  2516*    END-EXEC.
  2517*    MOVE '"&=!"#               V! " #00002506' TO DFHEIV0
  2518     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  2519     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2520     MOVE X'2220233030303032353036' TO DFHEIV0(25:11)
  2521     CALL 'kxdfhei1' USING DFHEIV0
  2522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2523
  2524
  2525
  2526* EXEC CICS HANDLE CONDITION
  2527*        PGMIDERR (9700-PGMID-ERROR)
  2528*        ERROR    (9800-ABEND)
  2529*    END-EXEC.
  2530*    MOVE '"$L.                  ! # #00002513' TO DFHEIV0
  2531     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2532     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2533     MOVE X'2320233030303032353133' TO DFHEIV0(25:11)
  2534     CALL 'kxdfhei1' USING DFHEIV0
  2535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2536
  2537
  2538
  2539* EXEC CICS RECEIVE
  2540*        MAP      (W-MAP)
  2541*        MAPSET   (W-MAPSET)
  2542*        INTO     (EL691AI)
  2543*    END-EXEC.
  2544     MOVE LENGTH OF
  2545      EL691AI
  2546       TO DFHEIV11
  2547*    MOVE '8"T I  L              ''   #00002518' TO DFHEIV0
  2548     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2549     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2550     MOVE X'2020233030303032353138' TO DFHEIV0(25:11)
  2551     CALL 'kxdfhei1' USING DFHEIV0,
  2552           W-MAP,
  2553           EL691AI,
  2554           DFHEIV11,
  2555           W-MAPSET,
  2556           DFHEIV99,
  2557           DFHEIV99
  2558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2559
  2560
  2561     IF  NOT DISPLAY-CAP
  2562         MOVE 'READ'             TO SM-READ
  2563         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2564         MOVE ER-9097            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  52
* EL691.cbl
  2565         MOVE -1                 TO MAINTL
  2566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2567         GO TO 8100-SEND-INITIAL-MAP
  2568     END-IF.
  2569
  2570
  2571 0300-CHECK-PFKEYS.
  2572
  2573     IF  EIBAID EQUAL DFHPF23
  2574         MOVE EIBAID             TO PI-ENTRY-CD-1
  2575         MOVE W-XCTL-005         TO W-CALL-PGM
  2576         GO TO 9400-XCTL
  2577     END-IF.
  2578
  2579     IF  EIBAID EQUAL DFHPF24
  2580         MOVE W-XCTL-626         TO W-CALL-PGM
  2581         GO TO 9400-XCTL
  2582     END-IF.
  2583
  2584     IF  EIBAID EQUAL DFHPF6
  2585         MOVE W-XCTL-1279        TO W-CALL-PGM
  2586         GO TO 9400-XCTL
  2587     END-IF
  2588
  2589     IF  MAINTI EQUAL 'C'  AND
  2590         EIBAID EQUAL DFHENTER
  2591          GO TO 0700-PROCESS-CHANGES
  2592     END-IF.
  2593
  2594     MOVE ER-0029                TO EMI-ERROR.
  2595
  2596
  2597 0320-INPUT-ERROR.
  2598
  2599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2600     MOVE -1                     TO  MAINTL.
  2601     GO TO 8200-SEND-DATAONLY.
  2602
  2603
  2604 0700-PROCESS-CHANGES.
  2605
  2606     IF  NOT MODIFY-CAP
  2607         MOVE 'UPDATE'           TO SM-READ
  2608         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2609         MOVE ER-0070            TO EMI-ERROR
  2610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2611         MOVE -1                 TO MAINTL
  2612         GO TO 8100-SEND-INITIAL-MAP
  2613     END-IF.
  2614
  2615     MOVE 'N'                    TO W-NEED-COMMENT.
  2616
  2617     IF RESENDL GREATER ZERO
  2618         MOVE 'Y'                TO W-NEED-COMMENT
  2619         IF RESENDI = SPACES
  2620             MOVE AL-UANON       TO  RESENDA
  2621             MOVE +1             TO  W-UPDATE-SW
  2622             MOVE LOW-VALUES     TO  W-RESEND-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  53
* EL691.cbl
  2623         ELSE
  2624             MOVE RESENDI       TO  W-DEEDIT-FIELD
  2625             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2626             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2627                 MOVE W-DEEDIT-FIELD-V0  TO  RESENDO
  2628                 INSPECT RESENDI CONVERTING SPACES TO SLASH
  2629                 MOVE '4'        TO  DC-OPTION-CODE
  2630                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2631                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2632                 IF DC-ERROR-CODE NOT = SPACES
  2633                     MOVE ER-0295         TO  EMI-ERROR
  2634                     MOVE -1              TO  RESENDL
  2635                     MOVE AL-UABON        TO  RESENDA
  2636                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2637                 ELSE
  2638                     MOVE AL-UANON       TO  RESENDA
  2639                     MOVE +1             TO  W-UPDATE-SW
  2640                     MOVE DC-BIN-DATE-1  TO  W-RESEND-DATE
  2641                 END-IF
  2642             ELSE
  2643                 MOVE ER-0295    TO  EMI-ERROR
  2644                 MOVE -1         TO  RESENDL
  2645                 MOVE AL-UABON   TO  RESENDA
  2646                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2647             END-IF
  2648         END-IF
  2649     END-IF.
  2650
  2651     IF FINDATEL GREATER ZERO
  2652         IF FINDATEI = SPACES
  2653             MOVE AL-UANON       TO  FINDATEA
  2654             MOVE +1             TO  W-UPDATE-SW
  2655             MOVE LOW-VALUES     TO  W-FINAL-ACT-DATE
  2656             MOVE SPACES         TO  PI-ARCHIVE-FINAL
  2657         ELSE
  2658             MOVE 'Y'             TO  PI-ARCHIVE-FINAL
  2659             MOVE FINDATEI        TO  W-DEEDIT-FIELD
  2660             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2661             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2662                 MOVE W-DEEDIT-FIELD-V0  TO  FINDATEO
  2663                 INSPECT FINDATEI CONVERTING SPACES TO SLASH
  2664                 MOVE '4'                 TO  DC-OPTION-CODE
  2665                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2666                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2667                 IF DC-ERROR-CODE NOT = SPACES
  2668                     MOVE ER-0296        TO  EMI-ERROR
  2669                     MOVE -1             TO  FINDATEL
  2670                     MOVE AL-UABON       TO  FINDATEA
  2671                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2672                 ELSE
  2673                     MOVE AL-UANON       TO  FINDATEA
  2674                     MOVE +1             TO  W-UPDATE-SW
  2675                     MOVE DC-BIN-DATE-1  TO  W-FINAL-ACT-DATE
  2676                 END-IF
  2677             ELSE
  2678                 MOVE ER-0296    TO  EMI-ERROR
  2679                 MOVE -1         TO  FINDATEL
  2680                 MOVE AL-UABON   TO  FINDATEA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  54
* EL691.cbl
  2681                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2682             END-IF
  2683         END-IF
  2684     END-IF.
  2685
  2686     IF REPLYL GREATER ZERO
  2687         IF REPLYI = SPACES
  2688             MOVE AL-UANON       TO  REPLYA
  2689             MOVE +1             TO  W-UPDATE-SW
  2690             MOVE LOW-VALUES     TO  W-RECEIVED-DATE
  2691             MOVE SPACES         TO  PI-ARCHIVE-RECEIVED
  2692                                     WS-RECEIVED-NOTE
  2693             PERFORM 4500-UPDATE-BILL-NOTE THRU 4500-EXIT
  2694         ELSE
  2695             MOVE 'Y'            TO  PI-ARCHIVE-RECEIVED
  2696             MOVE REPLYI         TO  W-DEEDIT-FIELD
  2697             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2698             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2699                 MOVE W-DEEDIT-FIELD-V0  TO  REPLYO
  2700                 INSPECT REPLYI CONVERTING SPACES TO SLASH
  2701                 MOVE '4'        TO  DC-OPTION-CODE
  2702                 MOVE W-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  2703                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2704                 IF DC-ERROR-CODE NOT = SPACES
  2705                     MOVE ER-9245        TO  EMI-ERROR
  2706                     MOVE -1             TO  REPLYL
  2707                     MOVE AL-UABON       TO  REPLYA
  2708                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2709                 ELSE
  2710                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  2711                       MOVE ER-0539      TO  EMI-ERROR
  2712                       MOVE -1           TO  REPLYL
  2713                       MOVE AL-UABON     TO  REPLYA
  2714                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2715                   ELSE
  2716                       MOVE AL-UANON     TO  REPLYA
  2717                       MOVE +1           TO  W-UPDATE-SW
  2718                       MOVE DC-BIN-DATE-1 TO W-RECEIVED-DATE
  2719                       MOVE DC-GREG-DATE-1-EDIT TO
  2720                                        W-CERT-NOTE-RECV-DT
  2721                                        WS-BN-RECV-DATE
  2722                   END-IF
  2723                 END-IF
  2724             ELSE
  2725                 MOVE ER-9245    TO  EMI-ERROR
  2726                 MOVE -1         TO  REPLYL
  2727                 MOVE AL-UABON   TO  REPLYA
  2728                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2729             END-IF
  2730         END-IF
  2731     END-IF.
  2732
  2733     IF STOPDTEL GREATER ZERO
  2734         IF STOPDTEI = SPACES
  2735             MOVE AL-UANON       TO  STOPDTEA
  2736             MOVE +1             TO  W-UPDATE-SW
  2737             MOVE LOW-VALUES     TO  W-STOP-LETTER-DATE
  2738             MOVE SPACES         TO  PI-ARCHIVE-STOPPED
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  55
* EL691.cbl
  2739             MOVE AL-UANOF       TO  RESENDA
  2740                                     RESFORMA
  2741                                     FINDATEA
  2742                                     FINLACTA
  2743                                     REPLYA
  2744                                     COMMENTA
  2745         ELSE
  2746             MOVE 'Y'            TO  PI-ARCHIVE-STOPPED
  2747             MOVE 'Y'            TO  W-NEED-COMMENT
  2748             MOVE STOPDTEI       TO  W-DEEDIT-FIELD
  2749             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2750             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2751                 MOVE W-DEEDIT-FIELD-V0  TO  STOPDTEO
  2752                 INSPECT STOPDTEI CONVERTING SPACES TO SLASH
  2753                 MOVE '4'        TO  DC-OPTION-CODE
  2754                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2755                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2756                 IF DC-ERROR-CODE NOT = SPACES
  2757                     MOVE ER-0897         TO  EMI-ERROR
  2758                     MOVE -1              TO  STOPDTEL
  2759                     MOVE AL-UABON        TO  STOPDTEA
  2760                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2761                 ELSE
  2762                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  2763                       MOVE ER-0895      TO  EMI-ERROR
  2764                       MOVE -1           TO  STOPDTEL
  2765                       MOVE AL-UABON     TO  STOPDTEA
  2766                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2767                   ELSE
  2768                     MOVE AL-UANON       TO  STOPDTEA
  2769                     MOVE +1             TO  W-UPDATE-SW
  2770                     MOVE DC-BIN-DATE-1  TO  W-STOP-LETTER-DATE
  2771                   END-IF
  2772                 END-IF
  2773             ELSE
  2774                 MOVE ER-0897    TO  EMI-ERROR
  2775                 MOVE -1         TO  STOPDTEL
  2776                 MOVE AL-UABON   TO  STOPDTEA
  2777                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2778             END-IF
  2779         END-IF
  2780     END-IF.
  2781
  2782     IF W-NEED-COMMENT = 'Y'  AND
  2783        COMMENTL NOT > ZERO
  2784           MOVE -1         TO  COMMENTL
  2785           MOVE ER-7363    TO  EMI-ERROR
  2786           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2787     END-IF.
  2788
  2789     IF COMMENTL GREATER ZERO
  2790      OR  RESFORML GREATER ZERO
  2791      OR  FINLACTL GREATER ZERO
  2792         MOVE +1          TO  W-UPDATE-SW
  2793     END-IF.
  2794
  2795     IF W-ERROR-COUNT GREATER ZERO
  2796         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  56
* EL691.cbl
  2797     END-IF.
  2798
  2799     IF W-UPDATE-SW NOT GREATER ZERO
  2800         MOVE ER-3112    TO  EMI-ERROR
  2801         MOVE -1         TO  MAINTL
  2802         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2803         GO TO 8200-SEND-DATAONLY
  2804     END-IF.
  2805
  2806     IF PI-ARCHIVE-STOPPED = 'Y'
  2807        MOVE AL-SANOF       TO RESENDA
  2808                               RESFORMA
  2809                               FINDATEA
  2810                               FINLACTA
  2811                               REPLYA
  2812                               COMMENTA
  2813     END-IF.
  2814
  2815     PERFORM 3000-READ-FOR-UPDATE THRU 3000-EXIT.
  2816
  2817     IF RESENDL GREATER ZERO
  2818         MOVE W-RESEND-DATE      TO  LA-RESEND-DATE
  2819     END-IF.
  2820
  2821     IF FINDATEL GREATER ZERO
  2822         MOVE W-FINAL-ACT-DATE   TO  LA-FINAL-ACT-DATE
  2823     END-IF.
  2824
  2825     IF REPLYL GREATER ZERO
  2826         MOVE W-RECEIVED-DATE    TO  LA-REPLY-DATE
  2827         IF W-RECEIVED-DATE NOT EQUAL LOW-VALUES
  2828             PERFORM 4000-ADD-CERT-NOTE THRU 4099-EXIT
  2829             PERFORM 4500-UPDATE-BILL-NOTE THRU 4500-EXIT
  2830         END-IF
  2831     END-IF.
  2832
  2833     IF RESFORML GREATER ZERO
  2834        MOVE RESFORMI            TO  LA-RESEND-LETR
  2835     END-IF.
  2836
  2837     IF FINLACTL GREATER ZERO
  2838        MOVE FINLACTI            TO  LA-FINAL-ACT-IND
  2839     END-IF.
  2840
  2841     IF STOPDTEL GREATER ZERO
  2842        MOVE W-STOP-LETTER-DATE  TO  LA-VOIDED-DATE
  2843     END-IF.
  2844
  2845     PERFORM 3100-REWRITE THRU 3100-EXIT.
  2846
  2847     IF COMMENTL NOT GREATER ZERO
  2848
  2849         MOVE ER-0000            TO  EMI-ERROR
  2850         MOVE ' '                TO  MAINTO
  2851         MOVE -1                 TO  MAINTL
  2852         MOVE AL-UANOF           TO  MAINTA
  2853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2854         GO TO 1000-SHOW
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  57
* EL691.cbl
  2855     END-IF.
  2856
  2857     PERFORM 3200-READ-ARCT-FOR-UPDATE THRU 3200-EXIT.
  2858
  2859     IF PI-COMMENT-INDEX EQUAL +20
  2860         MOVE ER-0051    TO  EMI-ERROR
  2861         MOVE -1         TO  MAINTL
  2862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2863         GO TO 8200-SEND-DATAONLY
  2864     END-IF
  2865
  2866     SET PI-COMMENT-INDEX UP BY +1.
  2867     SET LC-NDX TO PI-COMMENT-INDEX.
  2868     MOVE COMMENTI        TO  LT-COMMENT-LINE (LC-NDX).
  2869     MOVE W-SAVE-BIN-DATE TO  LT-COMMENT-CHG-DT (LC-NDX).
  2870     MOVE PI-PROCESSOR-ID TO  LT-COMMENT-CHG-BY (LC-NDX).
  2871     ADD +1               TO  LT-NUM-LINES-ON-RECORD.
  2872
  2873
  2874     IF W-ADD-ARCT = 'N'
  2875         PERFORM 3300-REWRITE-ARCT THRU 3300-EXIT
  2876     ELSE
  2877         PERFORM 3350-INSERT-ARCT THRU 3350-EXIT
  2878     END-IF.
  2879
  2880
  2881     MOVE ER-0000                TO  EMI-ERROR.
  2882     MOVE ' '                    TO  MAINTO.
  2883     MOVE -1                     TO  MAINTL.
  2884     MOVE AL-UANOF               TO  MAINTA.
  2885     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2886     GO TO 1000-SHOW.
  2887
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  58
* EL691.cbl
  2889
  2890 1000-SHOW.
  2891***************************************************************
  2892*     THIS ROUTINE WILL READ THE ARCHIVE FILE WITH THE        *
  2893*     ARCHIVE NUMBER SPECIFIED FROM THE PRIOR SCREEN.         *
  2894***************************************************************
  2895     MOVE LOW-VALUES              TO W-ARCT-KEY.
  2896     MOVE PI-COMPANY-CD           TO W-ARCH-COMPANY-CD
  2897                                     W-ARCT-COMPANY-CD.
  2898     MOVE PI-689-ARCHIVE-NUMBER   TO W-ARCH-NUMBER
  2899                                     W-ARCT-ARCHIVE-NO.
  2900     MOVE '3'                     TO W-ARCT-RECORD-TYPE.
  2901     MOVE +0                      TO W-ARCT-LINE-SEQ-NO.
  2902
  2903
  2904* EXEC CICS HANDLE CONDITION
  2905*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  2906*         NOTFND     (1070-ARCH-NOT-FOUND)
  2907*         ENDFILE    (1070-ARCH-NOT-FOUND)
  2908*    END-EXEC.
  2909*    MOVE '"$JI''                 ! $ #00002866' TO DFHEIV0
  2910     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2912     MOVE X'2420233030303032383636' TO DFHEIV0(25:11)
  2913     CALL 'kxdfhei1' USING DFHEIV0
  2914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2915
  2916
  2917
  2918* EXEC CICS READ
  2919*        DATASET (W-ARCH-FILE-ID)
  2920*        SET     (ADDRESS OF LETTER-ARCHIVE)
  2921*        RIDFLD  (W-ARCH-KEY)
  2922*    END-EXEC.
  2923*    MOVE '&"S        E          (   #00002872' TO DFHEIV0
  2924     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2926     MOVE X'2020233030303032383732' TO DFHEIV0(25:11)
  2927     CALL 'kxdfhei1' USING DFHEIV0,
  2928           W-ARCH-FILE-ID,
  2929           DFHEIV20,
  2930           DFHEIV99,
  2931           W-ARCH-KEY,
  2932           DFHEIV99,
  2933           DFHEIV99,
  2934           DFHEIV99
  2935     SET ADDRESS OF LETTER-ARCHIVE TO
  2936         DFHEIV20
  2937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2938
  2939
  2940     MOVE LA-FORM-A3             TO FORMNOO.
  2941     MOVE LA-FORM-A3             TO PI-ARCHIVE-LTRID
  2942     MOVE LA-ARCHIVE-NO          TO ARCHNOO.
  2943     MOVE LA-CARRIER-A2          TO CARRIERO.
  2944     MOVE LA-GROUPING-A2         TO GROUPO.
  2945     MOVE LA-STATE-A2            TO STATEO.
  2946     MOVE LA-ACCOUNT-A2          TO ACCTO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  59
* EL691.cbl
  2947     MOVE LA-CERT-PRIME-A2       TO CERTO.
  2948     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  2949
  2950     IF LA-ENDT-ARCH-NO-X EQUAL LOW-VALUES OR SPACES
  2951          MOVE SPACES            TO ENDARCHO
  2952     ELSE
  2953          MOVE LA-ENDT-ARCH-NO   TO ENDARCHO
  2954     END-IF
  2955
  2956     IF  LA-CREATION-DATE EQUAL LOW-VALUES OR SPACES
  2957         MOVE SPACES             TO CREATDTI
  2958     ELSE
  2959         MOVE LA-CREATION-DATE   TO DC-BIN-DATE-1
  2960         MOVE ' '                TO DC-OPTION-CODE
  2961         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2962         MOVE DC-GREG-DATE-1-EDIT TO CREATDTI
  2963     END-IF.
  2964
  2965     MOVE LA-PROCESSOR-CD        TO CREATBYI.
  2966
  2967     IF  LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES OR SPACES
  2968         MOVE SPACES             TO PRINTDTI
  2969     ELSE
  2970         MOVE LA-INITIAL-PRINT-DATE TO DC-BIN-DATE-1
  2971         MOVE ' '                TO DC-OPTION-CODE
  2972         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2973         MOVE DC-GREG-DATE-1-EDIT TO PRINTDTI
  2974     END-IF.
  2975
  2976     IF  LA-RESEND-DATE = LOW-VALUES OR SPACES
  2977         MOVE SPACES             TO RESENDI
  2978     ELSE
  2979         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  2980         MOVE ' '                TO DC-OPTION-CODE
  2981         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2982         MOVE DC-GREG-DATE-1-EDIT TO RESENDI
  2983     END-IF.
  2984
  2985     MOVE LA-RESEND-LETR         TO RESFORMI.
  2986
  2987     IF  LA-SENT-DATE = LOW-VALUES OR SPACES
  2988         MOVE SPACES             TO RESPRNTI
  2989         MOVE SPACES             TO PI-ARCHIVE-COMPLETE
  2990     ELSE
  2991         MOVE 'Y'                TO PI-ARCHIVE-COMPLETE
  2992         MOVE LA-SENT-DATE     TO DC-BIN-DATE-1
  2993         MOVE ' '                TO DC-OPTION-CODE
  2994         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2995         MOVE DC-GREG-DATE-1-EDIT TO RESPRNTI
  2996     END-IF.
  2997
  2998     IF  LA-FINAL-ACT-DATE EQUAL LOW-VALUES OR SPACES
  2999         MOVE SPACES             TO FINDATEI
  3000         MOVE SPACES             TO PI-ARCHIVE-FINAL
  3001     ELSE
  3002         MOVE 'Y'                TO PI-ARCHIVE-FINAL
  3003         MOVE LA-FINAL-ACT-DATE  TO DC-BIN-DATE-1
  3004         MOVE ' '                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  60
* EL691.cbl
  3005         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3006         MOVE DC-GREG-DATE-1-EDIT TO FINDATEI
  3007     END-IF.
  3008
  3009     MOVE LA-FINAL-ACT-IND       TO FINLACTI.
  3010
  3011     IF  LA-REPLY-DATE = LOW-VALUES OR SPACES
  3012         MOVE SPACES             TO REPLYI
  3013         MOVE SPACES             TO PI-ARCHIVE-RECEIVED
  3014     ELSE
  3015         MOVE 'Y'                TO PI-ARCHIVE-RECEIVED
  3016         MOVE LA-REPLY-DATE      TO DC-BIN-DATE-1
  3017         MOVE ' '                TO DC-OPTION-CODE
  3018         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3019         MOVE DC-GREG-DATE-1-EDIT TO REPLYI
  3020     END-IF.
  3021
  3022     IF  LA-VOIDED-DATE = LOW-VALUES OR SPACES
  3023         MOVE SPACES             TO STOPDTEI
  3024         MOVE SPACES             TO PI-ARCHIVE-STOPPED
  3025     ELSE
  3026         MOVE 'Y'                TO PI-ARCHIVE-STOPPED
  3027         MOVE LA-VOIDED-DATE     TO DC-BIN-DATE-1
  3028         MOVE ' '                TO DC-OPTION-CODE
  3029         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3030         MOVE DC-GREG-DATE-1-EDIT TO STOPDTEI
  3031     END-IF.
  3032
  3033     IF LA-LAST-MAINT-DATE = LOW-VALUES OR SPACES
  3034         MOVE SPACES             TO MAINTDTI
  3035     ELSE
  3036         MOVE LA-LAST-MAINT-DATE TO DC-BIN-DATE-1
  3037         MOVE ' '                TO DC-OPTION-CODE
  3038         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3039         MOVE DC-GREG-DATE-1-EDIT TO MAINTDTI
  3040     END-IF.
  3041
  3042     IF LA-LAST-MAINT-TIMEX = LOW-VALUES OR SPACES
  3043         MOVE ZEROES             TO MAINTTMO
  3044     ELSE
  3045         MOVE LA-LAST-MAINT-TIME TO W-TIME-IN
  3046         MOVE W-TIME-OUT         TO MAINTTMO
  3047     END-IF.
  3048
  3049     MOVE LA-LAST-UPDATED-BY     TO MAINTBYI.
  3050
  3051     IF (LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  3052       OR (LA-VOIDED-DATE  NOT EQUAL LOW-VALUES AND SPACES)
  3053          MOVE AL-SANOF          TO RESENDA
  3054                                    RESFORMA
  3055                                    FINDATEA
  3056                                    FINLACTA
  3057                                    REPLYA
  3058                                    COMMENTA
  3059     END-IF.
  3060
  3061     IF LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES
  3062         MOVE AL-SANOF           TO STOPDTEA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  61
* EL691.cbl
  3063     END-IF.
  3064
  3065
  3066* EXEC CICS HANDLE CONDITION
  3067*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  3068*         NOTFND     (1000-ARCT-NOT-FOUND)
  3069*         ENDFILE    (1000-ARCT-NOT-FOUND)
  3070*    END-EXEC.
  3071*    MOVE '"$JI''                 ! % #00003003' TO DFHEIV0
  3072     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3074     MOVE X'2520233030303033303033' TO DFHEIV0(25:11)
  3075     CALL 'kxdfhei1' USING DFHEIV0
  3076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3077
  3078
  3079
  3080* EXEC CICS READ
  3081*        DATASET  (W-ARCT-FILE-ID)
  3082*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3083*        RIDFLD   (W-ARCT-KEY)
  3084*    END-EXEC.
  3085*    MOVE '&"S        E          (   #00003009' TO DFHEIV0
  3086     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3087     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3088     MOVE X'2020233030303033303039' TO DFHEIV0(25:11)
  3089     CALL 'kxdfhei1' USING DFHEIV0,
  3090           W-ARCT-FILE-ID,
  3091           DFHEIV20,
  3092           DFHEIV99,
  3093           W-ARCT-KEY,
  3094           DFHEIV99,
  3095           DFHEIV99,
  3096           DFHEIV99
  3097     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3098         DFHEIV20
  3099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3100
  3101
  3102     SET LC-NDX TO W-ZEROS.
  3103     PERFORM 20 TIMES
  3104         SET LC-NDX UP BY +1
  3105         IF LT-COMMENT-LINE (LC-NDX) > SPACES
  3106             MOVE LT-COMMENT-LINE (LC-NDX) TO COMMENTI
  3107             SET PI-COMMENT-INDEX TO LC-NDX
  3108         END-IF
  3109     END-PERFORM.
  3110
  3111     MOVE -1                     TO MAINTL.
  3112     GO TO 8100-SEND-INITIAL-MAP.
  3113
  3114 1000-ARCT-NOT-FOUND.
  3115
  3116     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3117     MOVE -1                     TO MAINTL.
  3118     GO TO 8100-SEND-INITIAL-MAP.
  3119
  3120 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  62
* EL691.cbl
  3121     EXIT.
  3122
  3123
  3124 1070-ARCH-NOT-FOUND.
  3125
  3126     MOVE ER-7371                TO EMI-ERROR.
  3127     MOVE -1                     TO ARCHNOL.
  3128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3129     GO TO 8100-SEND-INITIAL-MAP.
  3130
  3131
  3132 3000-READ-FOR-UPDATE SECTION.
  3133
  3134
  3135* EXEC CICS HANDLE CONDITION
  3136*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  3137*         NOTFND     (1070-ARCH-NOT-FOUND)
  3138*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3139*    END-EXEC.
  3140*    MOVE '"$JI''                 ! & #00003047' TO DFHEIV0
  3141     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3143     MOVE X'2620233030303033303437' TO DFHEIV0(25:11)
  3144     CALL 'kxdfhei1' USING DFHEIV0
  3145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3146
  3147
  3148     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
  3149     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCH-NUMBER
  3150
  3151
  3152* EXEC CICS READ
  3153*        DATASET (W-ARCH-FILE-ID)
  3154*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3155*        RIDFLD  (W-ARCH-KEY)
  3156*        UPDATE
  3157*    END-EXEC.
  3158*    MOVE '&"S        EU         (   #00003056' TO DFHEIV0
  3159     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3160     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3161     MOVE X'2020233030303033303536' TO DFHEIV0(25:11)
  3162     CALL 'kxdfhei1' USING DFHEIV0,
  3163           W-ARCH-FILE-ID,
  3164           DFHEIV20,
  3165           DFHEIV99,
  3166           W-ARCH-KEY,
  3167           DFHEIV99,
  3168           DFHEIV99,
  3169           DFHEIV99
  3170     SET ADDRESS OF LETTER-ARCHIVE TO
  3171         DFHEIV20
  3172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3173
  3174
  3175 3000-EXIT.
  3176     EXIT.
  3177
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  63
* EL691.cbl
  3179
  3180 3100-REWRITE SECTION.
  3181
  3182     MOVE PI-PROCESSOR-ID        TO  LA-LAST-UPDATED-BY
  3183                                     MAINTBYI.
  3184     MOVE W-SAVE-BIN-DATE        TO  LA-LAST-MAINT-DATE.
  3185     MOVE W-SAVE-DATE            TO  MAINTDTI.
  3186
  3187     MOVE EIBTIME                TO  LA-LAST-MAINT-TIME
  3188                                     W-TIME-IN.
  3189     MOVE W-TIME-OUT             TO  MAINTTMO.
  3190
  3191
  3192* EXEC CICS REWRITE
  3193*        DATASET (W-ARCH-FILE-ID)
  3194*        FROM    (LETTER-ARCHIVE)
  3195*    END-EXEC.
  3196     MOVE LENGTH OF
  3197      LETTER-ARCHIVE
  3198       TO DFHEIV11
  3199*    MOVE '&& L                  %   #00003079' TO DFHEIV0
  3200     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3201     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3202     MOVE X'2020233030303033303739' TO DFHEIV0(25:11)
  3203     CALL 'kxdfhei1' USING DFHEIV0,
  3204           W-ARCH-FILE-ID,
  3205           LETTER-ARCHIVE,
  3206           DFHEIV11,
  3207           DFHEIV99
  3208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3209
  3210
  3211 3100-EXIT.
  3212     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  64
* EL691.cbl
  3214 3200-READ-ARCT-FOR-UPDATE  SECTION.
  3215
  3216
  3217* EXEC CICS HANDLE CONDITION
  3218*         NOTFND     (3200-NOT-FOUND)
  3219*         ENDFILE    (3200-NOT-FOUND)
  3220*    END-EXEC.
  3221*    MOVE '"$I''                  ! '' #00003089' TO DFHEIV0
  3222     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  3223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3224     MOVE X'2720233030303033303839' TO DFHEIV0(25:11)
  3225     CALL 'kxdfhei1' USING DFHEIV0
  3226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3227
  3228
  3229     MOVE PI-COMPANY-CD TO W-ARCT-COMPANY-CD.
  3230     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCT-ARCHIVE-NO.
  3231     MOVE '3'                   TO W-ARCT-RECORD-TYPE.
  3232     MOVE +0                    TO W-ARCT-LINE-SEQ-NO.
  3233
  3234
  3235* EXEC CICS READ
  3236*        DATASET  (W-ARCT-FILE-ID)
  3237*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3238*        RIDFLD   (W-ARCT-KEY)
  3239*        UPDATE
  3240*    END-EXEC.
  3241*    MOVE '&"S        EU         (   #00003099' TO DFHEIV0
  3242     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3243     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3244     MOVE X'2020233030303033303939' TO DFHEIV0(25:11)
  3245     CALL 'kxdfhei1' USING DFHEIV0,
  3246           W-ARCT-FILE-ID,
  3247           DFHEIV20,
  3248           DFHEIV99,
  3249           W-ARCT-KEY,
  3250           DFHEIV99,
  3251           DFHEIV99,
  3252           DFHEIV99
  3253     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3254         DFHEIV20
  3255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3256
  3257
  3258     MOVE 'N' TO W-ADD-ARCT.
  3259     GO TO 3200-EXIT.
  3260
  3261 3200-NOT-FOUND.
  3262
  3263
  3264* EXEC CICS GETMAIN
  3265*         SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3266*         LENGTH   (W-ARCT-LENGTH)
  3267*    END-EXEC.
  3268*    MOVE '," L                  $   #00003111' TO DFHEIV0
  3269     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3270     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3271     MOVE X'2020233030303033313131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  65
* EL691.cbl
  3272     CALL 'kxdfhei1' USING DFHEIV0,
  3273           DFHEIV20,
  3274           W-ARCT-LENGTH,
  3275           DFHEIV99
  3276     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3277         DFHEIV20
  3278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3279
  3280
  3281     MOVE 'Y'                    TO W-ADD-ARCT.
  3282     MOVE LOW-VALUES             TO LETTER-ARCHIVE-TEXT.
  3283     MOVE 'LT'                   TO LT-RECORD-ID.
  3284     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
  3285     MOVE PI-689-ARCHIVE-NUMBER  TO LT-ARCHIVE-NO.
  3286     MOVE '3'                    TO LT-RECORD-TYPE.
  3287     MOVE +0                     TO LT-LINE-SEQ-NO.
  3288     MOVE +0                     TO LT-NUM-LINES-ON-RECORD.
  3289     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3290
  3291 3200-EXIT.
  3292     EXIT.
  3293
  3294 3300-REWRITE-ARCT SECTION.
  3295
  3296
  3297* EXEC CICS REWRITE
  3298*        DATASET (W-ARCT-FILE-ID)
  3299*        FROM    (LETTER-ARCHIVE-TEXT)
  3300*    END-EXEC.
  3301     MOVE LENGTH OF
  3302      LETTER-ARCHIVE-TEXT
  3303       TO DFHEIV11
  3304*    MOVE '&& L                  %   #00003131' TO DFHEIV0
  3305     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3306     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3307     MOVE X'2020233030303033313331' TO DFHEIV0(25:11)
  3308     CALL 'kxdfhei1' USING DFHEIV0,
  3309           W-ARCT-FILE-ID,
  3310           LETTER-ARCHIVE-TEXT,
  3311           DFHEIV11,
  3312           DFHEIV99
  3313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3314
  3315
  3316 3300-EXIT.
  3317     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  66
* EL691.cbl
  3319
  3320 3350-INSERT-ARCT SECTION.
  3321
  3322* EXEC CICS WRITE
  3323*         DATASET   (W-ARCT-FILE-ID)
  3324*         FROM      (LETTER-ARCHIVE-TEXT)
  3325*         RIDFLD    (LT-CONTROL-PRIMARY)
  3326*    END-EXEC.
  3327     MOVE LENGTH OF
  3328      LETTER-ARCHIVE-TEXT
  3329       TO DFHEIV11
  3330*    MOVE '&$ L                  ''   #00003141' TO DFHEIV0
  3331     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3332     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3333     MOVE X'2020233030303033313431' TO DFHEIV0(25:11)
  3334     CALL 'kxdfhei1' USING DFHEIV0,
  3335           W-ARCT-FILE-ID,
  3336           LETTER-ARCHIVE-TEXT,
  3337           DFHEIV11,
  3338           LT-CONTROL-PRIMARY,
  3339           DFHEIV99,
  3340           DFHEIV99
  3341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3342
  3343
  3344 3350-EXIT.
  3345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  67
* EL691.cbl
  3347
  3348
  3349 4000-ADD-CERT-NOTE  SECTION.
  3350
  3351     MOVE SPACES                 TO  ERCNOT-KEY
  3352                                     ELCERT-KEY.
  3353
  3354     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  3355                                     ELCERT-COMPANY-CD.
  3356     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  3357                                     ELCERT-CARRIER.
  3358     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  3359                                     ELCERT-GROUPING.
  3360     MOVE PI-STATE               TO  ERCNOT-STATE
  3361                                     ELCERT-STATE.
  3362     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  3363                                     ELCERT-ACCOUNT.
  3364     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  3365                                     ELCERT-EFF-DT.
  3366     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  3367                                     ELCERT-CERT-PRIME.
  3368     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  3369                                     ELCERT-CERT-SFX.
  3370     MOVE '1'                    TO  ERCNOT-REC-TYP
  3371     MOVE ZEROS                  TO  ERCNOT-SEQ.
  3372     MOVE ERCNOT-KEY             TO  SV-PRIOR-KEY.
  3373
  3374
  3375
  3376* EXEC CICS HANDLE CONDITION
  3377*         NOTFND(4010-ENDBR)
  3378*         ENDFILE(4010-ENDBR)
  3379*    END-EXEC.
  3380*    MOVE '"$I''                  ! ( #00003178' TO DFHEIV0
  3381     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  3382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3383     MOVE X'2820233030303033313738' TO DFHEIV0(25:11)
  3384     CALL 'kxdfhei1' USING DFHEIV0
  3385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3386
  3387
  3388
  3389* EXEC CICS STARTBR
  3390*         DATASET(ERCNOT-FILE-ID)
  3391*         RIDFLD(ERCNOT-KEY)
  3392*         KEYLENGTH(ERCNOT-START-LENGTH)
  3393*         GENERIC
  3394*         GTEQ
  3395*    END-EXEC.
  3396     MOVE 0
  3397       TO DFHEIV11
  3398*    MOVE '&,   KG    G          &   #00003183' TO DFHEIV0
  3399     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3400     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3401     MOVE X'2020233030303033313833' TO DFHEIV0(25:11)
  3402     CALL 'kxdfhei1' USING DFHEIV0,
  3403           ERCNOT-FILE-ID,
  3404           ERCNOT-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  68
* EL691.cbl
  3405           ERCNOT-START-LENGTH,
  3406           DFHEIV11,
  3407           DFHEIV99
  3408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3409
  3410
  3411 4001-LOOP.
  3412
  3413* EXEC CICS READNEXT
  3414*         SET(ADDRESS OF CERT-NOTE-FILE)
  3415*         DATASET(ERCNOT-FILE-ID)
  3416*         RIDFLD(ERCNOT-KEY)
  3417*    END-EXEC.
  3418     MOVE 0
  3419       TO DFHEIV11
  3420*    MOVE '&.S                   )   #00003192' TO DFHEIV0
  3421     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3422     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3423     MOVE X'2020233030303033313932' TO DFHEIV0(25:11)
  3424     CALL 'kxdfhei1' USING DFHEIV0,
  3425           ERCNOT-FILE-ID,
  3426           DFHEIV20,
  3427           DFHEIV99,
  3428           ERCNOT-KEY,
  3429           DFHEIV99,
  3430           DFHEIV11,
  3431           DFHEIV99,
  3432           DFHEIV99
  3433     SET ADDRESS OF CERT-NOTE-FILE TO
  3434         DFHEIV20
  3435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3436
  3437
  3438     IF CZ-COMPANY-CD NOT = SV-COMPANY-CD
  3439         GO TO 4010-ENDBR
  3440     END-IF.
  3441
  3442     IF (CZ-CARRIER = SV-CARRIER)
  3443        AND (CZ-GROUPING = SV-GROUPING)
  3444        AND (CZ-STATE = SV-STATE)
  3445        AND (CZ-ACCOUNT = SV-ACCOUNT)
  3446        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  3447        AND (CZ-CERT-NO = SV-CERT-NO)
  3448        AND (CZ-RECORD-TYPE = SV-REC-TYP)
  3449          MOVE CZ-NOTE-SEQUENCE TO SV-NOTE-SEQUENCE
  3450          GO TO 4001-LOOP
  3451     END-IF.
  3452
  3453 4010-ENDBR.
  3454
  3455
  3456* EXEC CICS ENDBR
  3457*         DATASET(ERCNOT-FILE-ID)
  3458*    END-EXEC.
  3459     MOVE 0
  3460       TO DFHEIV11
  3461*    MOVE '&2                    $   #00003215' TO DFHEIV0
  3462     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  69
* EL691.cbl
  3463     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3464     MOVE X'2020233030303033323135' TO DFHEIV0(25:11)
  3465     CALL 'kxdfhei1' USING DFHEIV0,
  3466           ERCNOT-FILE-ID,
  3467           DFHEIV11,
  3468           DFHEIV99
  3469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3470
  3471
  3472     MOVE SV-PRIOR-KEY           TO  ERCNOT-KEY.
  3473     MOVE SPACES                 TO  CERT-NOTE-FILE.
  3474     ADD 1                       TO  ERCNOT-SEQ.
  3475     MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY.
  3476     MOVE  'CZ'                  TO  CZ-RECORD-ID.
  3477     MOVE W-CERT-NOTE-MSG        TO  CZ-NOTE.
  3478     MOVE PI-PROCESSOR-ID        TO  CZ-LAST-MAINT-USER.
  3479     MOVE W-SAVE-BIN-DATE        TO  CZ-LAST-MAINT-DT.
  3480     MOVE EIBTIME                TO  CZ-LAST-MAINT-HHMMSS.
  3481
  3482
  3483* EXEC CICS WRITE
  3484*         DATASET(ERCNOT-FILE-ID)
  3485*         FROM(CERT-NOTE-FILE)
  3486*         RIDFLD(ERCNOT-KEY)
  3487*         RESP(W-RESPONSE)
  3488*    END-EXEC.
  3489     MOVE LENGTH OF
  3490      CERT-NOTE-FILE
  3491       TO DFHEIV11
  3492*    MOVE '&$ L                  ''  N#00003229' TO DFHEIV0
  3493     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3495     MOVE X'204E233030303033323239' TO DFHEIV0(25:11)
  3496     CALL 'kxdfhei1' USING DFHEIV0,
  3497           ERCNOT-FILE-ID,
  3498           CERT-NOTE-FILE,
  3499           DFHEIV11,
  3500           ERCNOT-KEY,
  3501           DFHEIV99,
  3502           DFHEIV99
  3503     MOVE EIBRESP  TO W-RESPONSE
  3504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3505
  3506
  3507     IF RESP-NORMAL
  3508         PERFORM 4800-CERTIFICATE-UPDATE THRU 4899-EXIT
  3509     END-IF.
  3510
  3511 4099-EXIT.
  3512     EXIT.
  3513
  3514
  3515 4500-UPDATE-BILL-NOTE SECTION.
  3516
  3517
  3518* EXEC CICS GETMAIN
  3519*         SET      (ADDRESS OF EOB-CODES)
  3520*         LENGTH   (ELEOBC-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  70
* EL691.cbl
  3521*    END-EXEC
  3522*    MOVE '," L                  $   #00003246' TO DFHEIV0
  3523     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3524     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3525     MOVE X'2020233030303033323436' TO DFHEIV0(25:11)
  3526     CALL 'kxdfhei1' USING DFHEIV0,
  3527           DFHEIV20,
  3528           ELEOBC-LENGTH,
  3529           DFHEIV99
  3530     SET ADDRESS OF EOB-CODES TO
  3531         DFHEIV20
  3532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3533
  3534     MOVE LOW-VALUES             TO ELEOBC-KEY
  3535     MOVE PI-COMPANY-CD          TO EOBC-COMPANY-CD
  3536     MOVE '5'                    TO EOBC-REC-TYPE
  3537
  3538
  3539* EXEC CICS STARTBR
  3540*        DATASET   (ELEOBC-FILE-ID)
  3541*        RIDFLD    (ELEOBC-KEY)
  3542*        GTEQ
  3543*        RESP      (W-RESPONSE)
  3544*    END-EXEC
  3545     MOVE 0
  3546       TO DFHEIV11
  3547*    MOVE '&,         G          &  N#00003255' TO DFHEIV0
  3548     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3549     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3550     MOVE X'204E233030303033323535' TO DFHEIV0(25:11)
  3551     CALL 'kxdfhei1' USING DFHEIV0,
  3552           ELEOBC-FILE-ID,
  3553           ELEOBC-KEY,
  3554           DFHEIV99,
  3555           DFHEIV11,
  3556           DFHEIV99
  3557     MOVE EIBRESP  TO W-RESPONSE
  3558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3559
  3560     IF NOT RESP-NORMAL
  3561        GO TO 4500-EXIT
  3562     END-IF
  3563      .
  3564 4500-READNEXT-ELEOBC.
  3565
  3566
  3567* EXEC CICS READNEXT
  3568*       INTO    (EOB-CODES)
  3569*       DATASET (ELEOBC-FILE-ID)
  3570*       RIDFLD  (ELEOBC-KEY)
  3571*       RESP    (W-RESPONSE)
  3572*    END-EXEC
  3573     MOVE LENGTH OF
  3574      EOB-CODES
  3575       TO DFHEIV12
  3576     MOVE 0
  3577       TO DFHEIV11
  3578*    MOVE '&.IL                  )  N#00003268' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  71
* EL691.cbl
  3579     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3580     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3581     MOVE X'204E233030303033323638' TO DFHEIV0(25:11)
  3582     CALL 'kxdfhei1' USING DFHEIV0,
  3583           ELEOBC-FILE-ID,
  3584           EOB-CODES,
  3585           DFHEIV12,
  3586           ELEOBC-KEY,
  3587           DFHEIV99,
  3588           DFHEIV11,
  3589           DFHEIV99,
  3590           DFHEIV99
  3591     MOVE EIBRESP  TO W-RESPONSE
  3592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3593
  3594     IF RESP-NORMAL
  3595         IF EO-RECORD-TYPE NOT = '5'
  3596             GO TO 4500-EXIT
  3597         END-IF
  3598     ELSE
  3599         GO TO 4500-EXIT
  3600     END-IF
  3601
  3602     IF EO-RECORD-TYPE = '5' AND
  3603        EO-EOB-CODE = PI-ARCHIVE-LTRID
  3604           CONTINUE
  3605     ELSE
  3606         GO TO 4500-READNEXT-ELEOBC
  3607     END-IF
  3608
  3609     MOVE SPACES TO WS-FIND-BILLING-NOTE
  3610     MOVE EO-DESCRIPTION TO WS-FBN-NOTE
  3611     MOVE PI-ARCHIVE-LTRID TO WS-FBN-LTRID
  3612
  3613
  3614* EXEC CICS GETMAIN
  3615*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  3616*         LENGTH   (ERNOTE-LENGTH)
  3617*    END-EXEC
  3618*    MOVE '," L                  $   #00003294' TO DFHEIV0
  3619     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3620     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3621     MOVE X'2020233030303033323934' TO DFHEIV0(25:11)
  3622     CALL 'kxdfhei1' USING DFHEIV0,
  3623           DFHEIV20,
  3624           ERNOTE-LENGTH,
  3625           DFHEIV99
  3626     SET ADDRESS OF CERTIFICATE-NOTE TO
  3627         DFHEIV20
  3628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3629
  3630     MOVE PI-COMPANY-CD          TO  ERNOTE-COMPANY-CD
  3631     MOVE PI-CARRIER             TO  ERNOTE-CARRIER
  3632     MOVE PI-GROUPING            TO  ERNOTE-GROUPING
  3633     MOVE PI-STATE               TO  ERNOTE-STATE
  3634     MOVE PI-ACCOUNT             TO  ERNOTE-ACCOUNT
  3635     MOVE PI-CERT-EFF-DT         TO  ERNOTE-CERT-EFF-DT
  3636     MOVE PI-CERT-PRIME          TO  ERNOTE-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  72
* EL691.cbl
  3637     MOVE PI-CERT-SFX            TO  ERNOTE-CERT-SFX
  3638
  3639
  3640* EXEC CICS READ
  3641*       DATASET    (ERNOTE-FILE-ID)
  3642*       RIDFLD     (ERNOTE-KEY)
  3643*       INTO       (CERTIFICATE-NOTE)
  3644*       RESP       (W-RESPONSE)
  3645*       UPDATE
  3646*    END-EXEC
  3647     MOVE LENGTH OF
  3648      CERTIFICATE-NOTE
  3649       TO DFHEIV11
  3650*    MOVE '&"IL       EU         (  N#00003308' TO DFHEIV0
  3651     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3652     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3653     MOVE X'204E233030303033333038' TO DFHEIV0(25:11)
  3654     CALL 'kxdfhei1' USING DFHEIV0,
  3655           ERNOTE-FILE-ID,
  3656           CERTIFICATE-NOTE,
  3657           DFHEIV11,
  3658           ERNOTE-KEY,
  3659           DFHEIV99,
  3660           DFHEIV99,
  3661           DFHEIV99
  3662     MOVE EIBRESP  TO W-RESPONSE
  3663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3664
  3665     IF RESP-NORMAL
  3666       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  3667           (NOTE-SUB > +10) OR
  3668           (CN-LINE (NOTE-SUB) (1:29) =
  3669                             WS-FIND-BILLING-NOTE (1:29))
  3670       END-PERFORM
  3671       IF CN-LINE (NOTE-SUB) (1:29) NOT =
  3672                              WS-FIND-BILLING-NOTE (1:29)
  3673
  3674* EXEC CICS UNLOCK
  3675*           DATASET    (ERNOTE-FILE-ID)
  3676*        END-EXEC
  3677*    MOVE '&*                    #   #00003324' TO DFHEIV0
  3678     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3679     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3680     MOVE X'2020233030303033333234' TO DFHEIV0(25:11)
  3681     CALL 'kxdfhei1' USING DFHEIV0,
  3682           ERNOTE-FILE-ID,
  3683           DFHEIV99
  3684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3685         GO TO 4500-EXIT
  3686       END-IF
  3687
  3688       MOVE WS-RECEIVED-NOTE TO CN-LINE (NOTE-SUB) (50:20)
  3689       MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  3690       MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
  3691       MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  3692
  3693* EXEC CICS REWRITE
  3694*         DATASET    (ERNOTE-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  73
* EL691.cbl
  3695*         FROM       (CERTIFICATE-NOTE)
  3696*         RESP       (W-RESPONSE)
  3697*      END-EXEC
  3698     MOVE LENGTH OF
  3699      CERTIFICATE-NOTE
  3700       TO DFHEIV11
  3701*    MOVE '&& L                  %  N#00003334' TO DFHEIV0
  3702     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3703     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3704     MOVE X'204E233030303033333334' TO DFHEIV0(25:11)
  3705     CALL 'kxdfhei1' USING DFHEIV0,
  3706           ERNOTE-FILE-ID,
  3707           CERTIFICATE-NOTE,
  3708           DFHEIV11,
  3709           DFHEIV99
  3710     MOVE EIBRESP  TO W-RESPONSE
  3711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3712
  3713       .
  3714
  3715 4500-EXIT.
  3716     EXIT.
  3717
  3718
  3719 4800-CERTIFICATE-UPDATE SECTION.
  3720
  3721
  3722* EXEC CICS HANDLE CONDITION
  3723*        NOTFND   (4899-EXIT)
  3724*    END-EXEC.
  3725*    MOVE '"$I                   ! ) #00003348' TO DFHEIV0
  3726     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3728     MOVE X'2920233030303033333438' TO DFHEIV0(25:11)
  3729     CALL 'kxdfhei1' USING DFHEIV0
  3730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3731
  3732
  3733
  3734* EXEC CICS READ
  3735*    EQUAL
  3736*    DATASET   (ELCERT-FILE-ID)
  3737*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  3738*    RIDFLD    (ELCERT-KEY)
  3739*    UPDATE
  3740*    RESP      (W-RESPONSE)
  3741*    END-EXEC.
  3742*    MOVE '&"S        EU         (  N#00003352' TO DFHEIV0
  3743     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3744     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3745     MOVE X'204E233030303033333532' TO DFHEIV0(25:11)
  3746     CALL 'kxdfhei1' USING DFHEIV0,
  3747           ELCERT-FILE-ID,
  3748           DFHEIV20,
  3749           DFHEIV99,
  3750           ELCERT-KEY,
  3751           DFHEIV99,
  3752           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  74
* EL691.cbl
  3753           DFHEIV99
  3754     SET ADDRESS OF CERTIFICATE-MASTER TO
  3755         DFHEIV20
  3756     MOVE EIBRESP  TO W-RESPONSE
  3757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3758
  3759
  3760     IF RESP-NORMAL
  3761        IF CM-NOTE-SW = ' '
  3762           MOVE '1'        TO CM-NOTE-SW
  3763        ELSE
  3764           IF CM-NOTE-SW = '2'
  3765              MOVE '3'      TO CM-NOTE-SW
  3766           ELSE
  3767              IF CM-NOTE-SW = '4'
  3768                  MOVE '5'    TO CM-NOTE-SW
  3769              ELSE
  3770                 IF CM-NOTE-SW = '6'
  3771                    MOVE '7'  TO CM-NOTE-SW
  3772                 END-IF
  3773              END-IF
  3774           END-IF
  3775        END-IF
  3776
  3777* EXEC CICS REWRITE
  3778*          FROM      (CERTIFICATE-MASTER)
  3779*          DATASET   (ELCERT-FILE-ID)
  3780*       END-EXEC
  3781     MOVE LENGTH OF
  3782      CERTIFICATE-MASTER
  3783       TO DFHEIV11
  3784*    MOVE '&& L                  %   #00003377' TO DFHEIV0
  3785     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3786     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3787     MOVE X'2020233030303033333737' TO DFHEIV0(25:11)
  3788     CALL 'kxdfhei1' USING DFHEIV0,
  3789           ELCERT-FILE-ID,
  3790           CERTIFICATE-MASTER,
  3791           DFHEIV11,
  3792           DFHEIV99
  3793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3794     END-IF.
  3795
  3796 4899-EXIT.
  3797      EXIT.
  3798
  3799
  3800
  3801 8010-ARCH-NOT-OPEN.
  3802
  3803     MOVE ER-7388                TO EMI-ERROR.
  3804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3805     MOVE -1                     TO MAINTL.
  3806     GO TO 8200-SEND-DATAONLY.
  3807
  3808 8015-ARCT-NOT-OPEN.
  3809
  3810     MOVE ER-7373                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  75
* EL691.cbl
  3811     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3812     MOVE -1                     TO MAINTL.
  3813     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  76
* EL691.cbl
  3815
  3816 8100-SEND-INITIAL-MAP.
  3817
  3818     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  3819
  3820     IF  NOT EMI-NO-ERRORS
  3821         MOVE EMI-MESSAGE-AREA (1)
  3822                                 TO ERRMSG1O
  3823     ELSE
  3824         MOVE SPACES             TO ERRMSG1O
  3825     END-IF.
  3826
  3827
  3828* EXEC CICS SEND
  3829*        MAP    (W-MAP)
  3830*        MAPSET (W-MAPSET)
  3831*        FROM   (EL691AO)
  3832*        ERASE
  3833*        CURSOR
  3834*    END-EXEC.
  3835     MOVE LENGTH OF
  3836      EL691AO
  3837       TO DFHEIV12
  3838     MOVE -1
  3839       TO DFHEIV11
  3840*    MOVE '8$     CT  E    H L F ,   #00003414' TO DFHEIV0
  3841     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3842     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3843     MOVE X'2020233030303033343134' TO DFHEIV0(25:11)
  3844     CALL 'kxdfhei1' USING DFHEIV0,
  3845           W-MAP,
  3846           EL691AO,
  3847           DFHEIV12,
  3848           W-MAPSET,
  3849           DFHEIV99,
  3850           DFHEIV99,
  3851           DFHEIV99,
  3852           DFHEIV11,
  3853           DFHEIV99,
  3854           DFHEIV99,
  3855           DFHEIV99
  3856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3857
  3858
  3859     GO TO 9000-RETURN-TRANS.
  3860
  3861 8100-EXIT.
  3862     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  77
* EL691.cbl
  3864
  3865 8200-SEND-DATAONLY.
  3866
  3867     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  3868
  3869     IF  NOT EMI-NO-ERRORS
  3870         MOVE EMI-MESSAGE-AREA (1)
  3871                                 TO ERRMSG1O
  3872     ELSE
  3873         MOVE SPACES             TO ERRMSG1O
  3874     END-IF.
  3875
  3876
  3877* EXEC CICS SEND
  3878*        MAP    (W-MAP)
  3879*        MAPSET (W-MAPSET)
  3880*        FROM   (EL691AO)
  3881*        DATAONLY
  3882*        CURSOR
  3883*    END-EXEC.
  3884     MOVE LENGTH OF
  3885      EL691AO
  3886       TO DFHEIV12
  3887     MOVE -1
  3888       TO DFHEIV11
  3889*    MOVE '8$D    CT       H L F ,   #00003439' TO DFHEIV0
  3890     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3891     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3892     MOVE X'2020233030303033343339' TO DFHEIV0(25:11)
  3893     CALL 'kxdfhei1' USING DFHEIV0,
  3894           W-MAP,
  3895           EL691AO,
  3896           DFHEIV12,
  3897           W-MAPSET,
  3898           DFHEIV99,
  3899           DFHEIV99,
  3900           DFHEIV99,
  3901           DFHEIV11,
  3902           DFHEIV99,
  3903           DFHEIV99,
  3904           DFHEIV99
  3905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3906
  3907
  3908     GO TO 9000-RETURN-TRANS.
  3909
  3910 8200-EXIT.
  3911     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  78
* EL691.cbl
  3913
  3914 8300-SEND-TEXT.
  3915
  3916
  3917* EXEC CICS SEND TEXT
  3918*        FROM    (LOGOFF-TEXT)
  3919*        LENGTH  (LOGOFF-LENGTH)
  3920*        ERASE
  3921*        FREEKB
  3922*    END-EXEC.
  3923*    MOVE '8&      T  E F  H   F -   #00003455' TO DFHEIV0
  3924     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3925     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3926     MOVE X'2020233030303033343535' TO DFHEIV0(25:11)
  3927     CALL 'kxdfhei1' USING DFHEIV0,
  3928           LOGOFF-TEXT,
  3929           LOGOFF-LENGTH,
  3930           DFHEIV99,
  3931           DFHEIV99,
  3932           DFHEIV99,
  3933           DFHEIV99,
  3934           DFHEIV99,
  3935           DFHEIV99,
  3936           DFHEIV99,
  3937           DFHEIV99,
  3938           DFHEIV99,
  3939           DFHEIV99
  3940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3941
  3942
  3943     GO TO 9000-RETURN-TRANS.
  3944
  3945 8300-EXIT.
  3946     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  79
* EL691.cbl
  3948
  3949 8600-DEEDIT.
  3950
  3951
  3952* EXEC CICS BIF DEEDIT
  3953*         FIELD    (W-DEEDIT-FIELD)
  3954*         LENGTH   (15)
  3955*    END-EXEC.
  3956     MOVE 15
  3957       TO DFHEIV11
  3958*    MOVE '@"L                   #   #00003470' TO DFHEIV0
  3959     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3960     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3961     MOVE X'2020233030303033343730' TO DFHEIV0(25:11)
  3962     CALL 'kxdfhei1' USING DFHEIV0,
  3963           W-DEEDIT-FIELD,
  3964           DFHEIV11
  3965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3966
  3967
  3968 8600-EXIT.
  3969     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  80
* EL691.cbl
  3971
  3972 9000-RETURN-TRANS.
  3973
  3974     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  3975     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
  3976
  3977* EXEC CICS RETURN
  3978*        TRANSID    (W-TRANSACTION)
  3979*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3980*        LENGTH     (PI-COMM-LENGTH)
  3981*    END-EXEC.
  3982*    MOVE '.(CT                  ''   #00003483' TO DFHEIV0
  3983     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3985     MOVE X'2020233030303033343833' TO DFHEIV0(25:11)
  3986     CALL 'kxdfhei1' USING DFHEIV0,
  3987           W-TRANSACTION,
  3988           PROGRAM-INTERFACE-BLOCK,
  3989           PI-COMM-LENGTH,
  3990           DFHEIV99,
  3991           DFHEIV99,
  3992           DFHEIV99
  3993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3994
  3995
  3996 9000-EXIT.
  3997     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  81
* EL691.cbl
  3999
  4000 9200-PA.
  4001
  4002     MOVE ER-7008                TO EMI-ERROR.
  4003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4004     MOVE -1                     TO MAINTL.
  4005     GO TO 8200-SEND-DATAONLY.
  4006
  4007 9200-EXIT.
  4008     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  82
* EL691.cbl
  4010
  4011 9300-DFHCLEAR.
  4012
  4013     MOVE PI-RETURN-TO-PROGRAM TO W-CALL-PGM.
  4014     GO TO 9400-XCTL.
  4015
  4016 9300-EXIT.
  4017     EXIT.
  4018
  4019 9400-XCTL.
  4020
  4021
  4022* EXEC CICS XCTL
  4023*        PROGRAM  (W-CALL-PGM)
  4024*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4025*        LENGTH   (PI-COMM-LENGTH)
  4026*    END-EXEC.
  4027*    MOVE '.$C                   %   #00003514' TO DFHEIV0
  4028     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4029     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4030     MOVE X'2020233030303033353134' TO DFHEIV0(25:11)
  4031     CALL 'kxdfhei1' USING DFHEIV0,
  4032           W-CALL-PGM,
  4033           PROGRAM-INTERFACE-BLOCK,
  4034           PI-COMM-LENGTH,
  4035           DFHEIV99
  4036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4037
  4038
  4039 9400-EXIT.
  4040     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  83
* EL691.cbl
  4042
  4043 9500-LINK-DATE-CONVERT.
  4044
  4045
  4046* EXEC CICS LINK
  4047*        PROGRAM    ('ELDATCV')
  4048*        COMMAREA   (DATE-CONVERSION-DATA)
  4049*        LENGTH     (DC-COMM-LENGTH)
  4050*    END-EXEC.
  4051     MOVE 'ELDATCV' TO DFHEIV1
  4052*    MOVE '."C                   (   #00003526' TO DFHEIV0
  4053     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4055     MOVE X'2020233030303033353236' TO DFHEIV0(25:11)
  4056     CALL 'kxdfhei1' USING DFHEIV0,
  4057           DFHEIV1,
  4058           DATE-CONVERSION-DATA,
  4059           DC-COMM-LENGTH,
  4060           DFHEIV99,
  4061           DFHEIV99,
  4062           DFHEIV99,
  4063           DFHEIV99
  4064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4065
  4066
  4067 9500-EXIT.
  4068     EXIT.
  4069
  4070 9600-FORMAT-DATE-TIME.
  4071
  4072     MOVE W-SAVE-DATE            TO RUNDTEO.
  4073     MOVE EIBTIME                TO W-TIME-IN.
  4074     MOVE W-TIME-OUT             TO RUNTIMEO.
  4075     MOVE PI-COMPANY-ID          TO COMPANYO.
  4076     MOVE PI-PROCESSOR-ID        TO USERIDO.
  4077     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  4078
  4079     IF PI-ARCHIVE-COMPLETE = 'Y'
  4080        MOVE AL-SANOF           TO STCOMPA
  4081        MOVE AL-SADOF           TO STRECVA
  4082                                   STSTOPA
  4083                                   STFINLA
  4084     ELSE
  4085       IF PI-ARCHIVE-RECEIVED = 'Y'
  4086           MOVE AL-SANOF        TO STRECVA
  4087           MOVE AL-SADOF        TO STCOMPA
  4088                                   STSTOPA
  4089                                   STFINLA
  4090       ELSE
  4091         IF PI-ARCHIVE-STOPPED = 'Y'
  4092             MOVE AL-SANOF      TO STSTOPA
  4093             MOVE AL-SADOF      TO STCOMPA
  4094                                   STRECVA
  4095                                   STFINLA
  4096         ELSE
  4097           IF PI-ARCHIVE-FINAL = 'Y'
  4098               MOVE AL-SANOF    TO STFINLA
  4099               MOVE AL-SADOF    TO STCOMPA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  84
* EL691.cbl
  4100                                   STRECVA
  4101                                   STSTOPA
  4102           ELSE
  4103               MOVE AL-SADOF    TO STCOMPA
  4104                                   STRECVA
  4105                                   STSTOPA
  4106                                   STFINLA
  4107           END-IF
  4108         END-IF
  4109       END-IF
  4110     END-IF.
  4111
  4112
  4113 9600-EXIT.
  4114     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  85
* EL691.cbl
  4116
  4117 9700-PGMID-ERROR.
  4118
  4119
  4120* EXEC CICS  HANDLE CONDITION
  4121*        PGMIDERR  (8300-SEND-TEXT)
  4122*    END-EXEC.
  4123*    MOVE '"$L                   ! * #00003584' TO DFHEIV0
  4124     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4126     MOVE X'2A20233030303033353834' TO DFHEIV0(25:11)
  4127     CALL 'kxdfhei1' USING DFHEIV0
  4128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4129
  4130
  4131     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  4132     MOVE ' '                    TO PI-ENTRY-CD-1.
  4133     MOVE W-XCTL-005             TO W-CALL-PGM
  4134                                    LOGOFF-PGM.
  4135     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  4136
  4137     PERFORM 9400-XCTL THRU 9400-EXIT.
  4138
  4139 9700-EXIT.
  4140     EXIT.
  4141
  4142 9800-ABEND.
  4143
  4144     MOVE W-LINK-004             TO W-CALL-PGM.
  4145     MOVE DFHEIBLK               TO EMI-LINE1
  4146
  4147
  4148* EXEC CICS  LINK
  4149*        PROGRAM   (W-CALL-PGM)
  4150*        COMMAREA  (EMI-LINE1)
  4151*        LENGTH    (72)
  4152*    END-EXEC.
  4153     MOVE 72
  4154       TO DFHEIV11
  4155*    MOVE '."C                   (   #00003604' TO DFHEIV0
  4156     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4158     MOVE X'2020233030303033363034' TO DFHEIV0(25:11)
  4159     CALL 'kxdfhei1' USING DFHEIV0,
  4160           W-CALL-PGM,
  4161           EMI-LINE1,
  4162           DFHEIV11,
  4163           DFHEIV99,
  4164           DFHEIV99,
  4165           DFHEIV99,
  4166           DFHEIV99
  4167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4168
  4169
  4170     GO TO 8200-SEND-DATAONLY.
  4171
  4172 9800-EXIT.
  4173     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  86
* EL691.cbl
  4175
  4176 9900-ERROR-FORMAT.
  4177
  4178     IF  EMI-ERROR EQUAL ER-9097
  4179         NEXT SENTENCE
  4180     ELSE
  4181         IF  EMI-ERRORS-COMPLETE
  4182                 OR
  4183             EMI-ERROR EQUAL W-LAST-ERROR
  4184             GO TO 9900-EXIT
  4185     END-IF.
  4186
  4187     ADD +1  TO  W-ERROR-COUNT.
  4188     MOVE W-LINK-001             TO W-CALL-PGM.
  4189
  4190
  4191* EXEC CICS LINK
  4192*        PROGRAM    (W-CALL-PGM)
  4193*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  4194*        LENGTH     (EMI-COMM-LENGTH)
  4195*    END-EXEC.
  4196*    MOVE '."C                   (   #00003630' TO DFHEIV0
  4197     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4199     MOVE X'2020233030303033363330' TO DFHEIV0(25:11)
  4200     CALL 'kxdfhei1' USING DFHEIV0,
  4201           W-CALL-PGM,
  4202           ERROR-MESSAGE-INTERFACE-BLOCK,
  4203           EMI-COMM-LENGTH,
  4204           DFHEIV99,
  4205           DFHEIV99,
  4206           DFHEIV99,
  4207           DFHEIV99
  4208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4209
  4210
  4211     MOVE EMI-ERROR              TO W-LAST-ERROR.
  4212
  4213 9900-EXIT.
  4214     EXIT.
  4215
  4216 9905-INITIALIZE-SECURITY.
  4217******************************************************************
  4218*                                                                *
  4219*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  4220*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  4221*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  4222*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  4223*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  4224*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  4225*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  4226*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
  4227*                                                                *
  4228*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
  4229*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  4230*                                                                *
  4231******************************************************************
  4232
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  87
* EL691.cbl
  4233     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  4234         MOVE 'Y'                TO PI-DISPLAY-CAP
  4235                                    PI-MODIFY-CAP
  4236     ELSE
  4237
  4238* EXEC CICS READQ TS
  4239*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  4240*            INTO   (SECURITY-CONTROL)
  4241*            LENGTH (SC-COMM-LENGTH)
  4242*            ITEM   (1)
  4243*        END-EXEC
  4244     MOVE 1
  4245       TO DFHEIV11
  4246*    MOVE '*$II   L              ''   #00003662' TO DFHEIV0
  4247     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4248     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4249     MOVE X'2020233030303033363632' TO DFHEIV0(25:11)
  4250     CALL 'kxdfhei1' USING DFHEIV0,
  4251           PI-SECURITY-TEMP-STORE-ID,
  4252           SECURITY-CONTROL,
  4253           SC-COMM-LENGTH,
  4254           DFHEIV11,
  4255           DFHEIV99,
  4256           DFHEIV99
  4257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4258         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  4259                                 TO PI-DISPLAY-CAP
  4260         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  4261                                 TO PI-MODIFY-CAP
  4262     END-IF.
  4263
  4264 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  88
* EL691.cbl
  4266
  4267 9995-SECURITY-VIOLATION.
  4268
  4269     MOVE EIBDATE                TO SM-JUL-DATE.
  4270     MOVE EIBTRMID               TO SM-TERMID.
  4271     MOVE W-THIS-PGM             TO SM-PGM.
  4272     MOVE EIBTIME                TO W-TIME-IN.
  4273     MOVE W-TIME-OUT             TO SM-TIME.
  4274     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
  4275
  4276
  4277* EXEC CICS LINK
  4278*         PROGRAM  ('EL003')
  4279*         COMMAREA (SECURITY-MESSAGE)
  4280*         LENGTH   (80)
  4281*    END-EXEC.
  4282     MOVE 'EL003' TO DFHEIV1
  4283     MOVE 80
  4284       TO DFHEIV11
  4285*    MOVE '."C                   (   #00003686' TO DFHEIV0
  4286     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4288     MOVE X'2020233030303033363836' TO DFHEIV0(25:11)
  4289     CALL 'kxdfhei1' USING DFHEIV0,
  4290           DFHEIV1,
  4291           SECURITY-MESSAGE,
  4292           DFHEIV11,
  4293           DFHEIV99,
  4294           DFHEIV99,
  4295           DFHEIV99,
  4296           DFHEIV99
  4297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4298
  4299
  4300 9995-EXIT.
  4301     EXIT.
  4302
  4303 9999-GOBACK.
  4304
  4305
  4306* GOBACK.
  4307     MOVE '9%                    "   ' TO DFHEIV0
  4308     MOVE 'EL691' TO DFHEIV1
  4309     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4310     GOBACK.
  4311
  4312 9999-EXIT.
  4313     EXIT.
  4314
  4315 9999-DFHBACK SECTION.
  4316     MOVE '9%                    "   ' TO DFHEIV0
  4317     MOVE 'EL691' TO DFHEIV1
  4318     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4319     GOBACK.
  4320 9999-DFHEXIT.
  4321     IF DFHEIGDJ EQUAL 0001
  4322         NEXT SENTENCE
  4323     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  89
* EL691.cbl
  4324         GO TO 9300-DFHCLEAR,
  4325               9200-PA,
  4326               9200-PA,
  4327               9200-PA
  4328         DEPENDING ON DFHEIGDI
  4329     ELSE IF DFHEIGDJ EQUAL 3
  4330         GO TO 9700-PGMID-ERROR,
  4331               9800-ABEND
  4332         DEPENDING ON DFHEIGDI
  4333     ELSE IF DFHEIGDJ EQUAL 4
  4334         GO TO 8010-ARCH-NOT-OPEN,
  4335               1070-ARCH-NOT-FOUND,
  4336               1070-ARCH-NOT-FOUND
  4337         DEPENDING ON DFHEIGDI
  4338     ELSE IF DFHEIGDJ EQUAL 5
  4339         GO TO 8015-ARCT-NOT-OPEN,
  4340               1000-ARCT-NOT-FOUND,
  4341               1000-ARCT-NOT-FOUND
  4342         DEPENDING ON DFHEIGDI
  4343     ELSE IF DFHEIGDJ EQUAL 6
  4344         GO TO 8010-ARCH-NOT-OPEN,
  4345               1070-ARCH-NOT-FOUND,
  4346               1070-ARCH-NOT-FOUND
  4347         DEPENDING ON DFHEIGDI
  4348     ELSE IF DFHEIGDJ EQUAL 7
  4349         GO TO 3200-NOT-FOUND,
  4350               3200-NOT-FOUND
  4351         DEPENDING ON DFHEIGDI
  4352     ELSE IF DFHEIGDJ EQUAL 8
  4353         GO TO 4010-ENDBR,
  4354               4010-ENDBR
  4355         DEPENDING ON DFHEIGDI
  4356     ELSE IF DFHEIGDJ EQUAL 9
  4357         GO TO 4899-EXIT
  4358         DEPENDING ON DFHEIGDI
  4359     ELSE IF DFHEIGDJ EQUAL 10
  4360         GO TO 8300-SEND-TEXT
  4361         DEPENDING ON DFHEIGDI.
  4362     MOVE '9%                    "   ' TO DFHEIV0
  4363     MOVE 'EL691' TO DFHEIV1
  4364     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4365     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4936     Code:       10420
