* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30* 082014  IR2015082100001  PEMA  bypass more manual request checks
    31* 092215  IR2015092200001  PEMA  modify determination of manual ch
    32 environment division.
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
    35 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    36    FILE STATUS IS WRITTEN-STATUS
    37                            ORGANIZATION IS LINE SEQUENTIAL.
    38 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    39    FILE STATUS IS WRITRPT-STATUS
    40                            ORGANIZATION IS LINE SEQUENTIAL.
    41 data division.
    42 FILE SECTION.
    43 FD  CPS-WRITTEN-IN
    44     BLOCK CONTAINS 0
    45     RECORDING MODE F.
    46 01  CPS-WRITTEN-IN-REC          pic x(200).
    47 FD  CPS-WRITTEN-RPT
    48     BLOCK CONTAINS 0
    49     RECORDING MODE F.
    50 01  CPS-WRITTEN-RPT-REC         pic x(132).
    51 working-storage section.
    52 01  DFH-START PIC X(04).
    53 77  ws-process-sw               pic x value ' '.
    54     88  process-cashed            value 'C'.
    55     88  process-written           value 'W'.
    56 77  ws-writ-cnt                 pic 9(5) value zeros.
    57 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    58 77  s1                          pic s999 comp-3 value +0.
    59 77  s2                          pic s999 comp-3 value +0.
    60 77  i1                          pic s999 comp-3 value +0.
    61 77  o1                          pic s999 comp-3 value +0.
    62 77  ws-bin-cashed-dt            pic xx  value low-values.
    63 77  ws-bin-check-dt             pic xx  value low-values.
    64 77  ws-page-cntr                pic 999  value zeros.
    65 77  ws-line-cntr                pic 999  value 070.
    66 77  ws-max-lines                pic 999  value 060.
    67 77  ws-erchek-sw                pic x    value spaces.
    68     88  erchek-found              value 'Y'.
    69 77  ws-table-sw                 pic x    value spaces.
    70     88  table-found               value 'Y'.
    71 77  ws-continue-sw              pic x  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   3
* EL201.cbl
    72     88  ok-to-continue            value 'Y'.
    73     88  not-ok-to-continue        value 'N'.
    74 77  ws-in-recs                  pic 9(5) value zeros.
    75 77  ws-eof-sw                   pic x  value spaces.
    76     88  end-of-input                  value 'Y'.
    77 77  ws-sql-code                 pic s9(7) value zeros.
    78 77  ws-dis-sql-code             pic -9999999 value zeros.
    79 01  ws-written-in.
    80     05  ws-writ-in-dir          pic x(15)  value
    81         '/data/seqfiles/'.
    82*    05  ws-writ-in-dir          pic x(26)  value
    83*        '/data/test/mdoff/seqfiles/'.
    84     05  ws-writ-in-name         pic x(16) value
    85         'miscpymts.csv   '.
    86 01  ws-written-rpt.
    87     05  ws-writ-rpt-dir         pic x(15)  value
    88         '/data/seqfiles/'.
    89*    05  ws-writ-rpt-dir         pic x(26)  value
    90*        '/data/test/mdoff/seqfiles/'.
    91     05  ws-writ-rpt-comp-id     pic xxx  value spaces.
    92     05  ws-writ-rpt-name        pic x(13) value
    93         'miscpymts.rpt'.
*   94 EXEC SQL
*   95    INCLUDE SQLDA
*   96 END-EXEC
    97 01 SQLDA sync.
    98    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    99    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   100    05 SQLN                  PIC S9(4) COMP-5 value 0.
   101    05 SQLD                  PIC S9(4) COMP-5 value 0.
   102    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   103       10 SQLTYPE            PIC S9(4) COMP-5.
   104       10 SQLLEN             PIC S9(4) COMP-5.
   105$IF P64 SET
   106X      *> For 64-bit environments, ensure that SQLDATA is
   107X      *> aligned on an 8-byte boundary.
   108X      10 FILLER             PIC S9(9) COMP-5.
   109$END
   110       10 SQLDATA            USAGE POINTER.
   111       10 SQLIND             USAGE POINTER.
   112       10 SQLNAME.
   113          15 SQLNAMEL        PIC S9(4) COMP-5.
   114          15 SQLNAMEC        PIC X(30).
   115
   116* Values for SQLTYPE
   117
   118 78  ESQL-DATE-CHAR              VALUE 384.
   119 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   120 78  ESQL-DATE-REC               VALUE 386.
   121 78  ESQL-DATE-REC-NULL          VALUE 387.
   122 78  ESQL-TIME-CHAR              VALUE 388.
   123 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   124 78  ESQL-TIME-REC               VALUE 390.
   125 78  ESQL-TIME-REC-NULL          VALUE 391.
   126 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   127 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   128 78  ESQL-TIMESTAMP-REC          VALUE 394.
   129 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   131 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   132 78  ESQL-TS-OFFSET-REC          VALUE 398.
   133 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   134 78  ESQL-LONGVARBINARY          VALUE 404.
   135 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   136 78  ESQL-LONGVARCHAR            VALUE 408.
   137 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   138 78  ESQL-BINARY                 VALUE 444.
   139 78  ESQL-BINARY-NULL            VALUE 445.
   140 78  ESQL-VARBINARY              VALUE 446.
   141 78  ESQL-VARBINARY-NULL         VALUE 447.
   142 78  ESQL-VARCHAR                VALUE 448.
   143 78  ESQL-VARCHAR-NULL           VALUE 449.
   144
   145 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   146 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   147
   148 78  ESQL-CHAR                   VALUE 452.
   149 78  ESQL-CHAR-NULL              VALUE 453.
   150
   151 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   152 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   153
   154 78  ESQL-DOUBLE                 VALUE 480.
   155 78  ESQL-DOUBLE-NULL            VALUE 481.
   156 78  ESQL-REAL                   VALUE 482.
   157 78  ESQL-REAL-NULL              VALUE 483.
   158 78  ESQL-DECIMAL                VALUE 484.
   159 78  ESQL-DECIMAL-NULL           VALUE 485.
   160 78  ESQL-INTEGER                VALUE 496.
   161 78  ESQL-INTEGER-NULL           VALUE 497.
   162 78  ESQL-SMALLINT               VALUE 500.
   163 78  ESQL-SMALLINT-NULL          VALUE 501.
   164 78  ESQL-TINYINT                VALUE 502.
   165 78  ESQL-TINYINT-NULL           VALUE 503.
*  166 EXEC SQL
*  167    INCLUDE SQLCA
*  168 END-EXEC
   169 01 SQLCA.
   170     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   171     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   172     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   173     05  SQLERRM.
   174         49  SQLERRML    PIC S9(4) COMP-5.
   175         49  SQLERRMC    PIC X(70).
   176     05  SQLERRP         PIC X(8).
   177     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   178     05  SQLWARN.
   179         10  SQLWARN0    PIC X.
   180         10  SQLWARN1    PIC X.
   181         10  SQLWARN2    PIC X.
   182         10  SQLWARN3    PIC X.
   183         10  SQLWARN4    PIC X.
   184         10  SQLWARN5    PIC X.
   185         10  SQLWARN6    PIC X.
   186         10  SQLWARN7    PIC X.
   187     05  SQLEXT.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN8    PIC X.
   189         10  SQLWARN9    PIC X.
   190         10  SQLWARN10   PIC X.
   191         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   192     05  SQLSTATE    PIC X(5).
   193 EXEC SQL
   194    BEGIN DECLARE SECTION
   195 END-EXEC
   196 01  ws-key-stuff.
   197     05  ws-check-key            pic 9(7).
   198     05  ws-check-no             pic x(7).
   199     05  ws-compid               pic xxx.
   200     05  ws-carrier              pic x.
   201     05  ws-grouping             pic x(6).
   202     05  ws-state                pic xx.
   203     05  ws-account              pic x(10).
   204     05  ws-eff-date             pic x(10).
   205     05  ws-certificate          pic x(10).
   206     05  ws-cert-sfx             pic x.
   207     05  ws-seq-no               pic 999.
   208     05  ws-type                 pic 999.
   209 01  sqlcmd                      pic x(1024).
   210 01  WS-MOE-DATE                 pic x(10).
   211 01  svr                         pic x(32).
   212 01  usr                         pic x(32).
   213 01  pass                        pic x(32).
   214 01  usr-pass                    pic x(64).
   215 01  ws-disp-code                pic s9(11).
   216***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   217***                                                            ***
   218***  These indicators are used to determine if a variable      ***
   219***  is passed nulls from sql. The indicator will be -1        ***
   220***  if the value on sql is nulls and +0 if the value is       ***
   221***  something other than nulls. Here is an example on how     ***
   222***  to use the indicator variables.                           ***
   223***                                                            ***
   224***     EXEC SQL                                               ***
   225***        fetch checkapp into                                 ***
   226***           :db-app-status :nu-app-status,                   ***
   227***           :db-app-by     :nu-app-by,                       ***
   228***           :db-app-date   :nu-app-date,                     ***
   229***           :db-app-batch  :nu-app-batch                     ***
   230***     END-EXEC                                               ***
   231***                                                            ***
   232***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   233 01  indicator-vaiables-for-nulls.
   234     05  nu-app-status           pic s9(4) comp value +0.
   235     05  nu-app-by               pic s9(4) comp value +0.
   236     05  nu-app-date             pic s9(4) comp value +0.
   237     05  nu-app-batch            pic s9(4) comp value +0.
   238     05  nu-fincar               pic s9(4) comp value +0.
   239     05  nu-checkno              pic s9(4) comp value +0.
   240 01  daily-check-request-rec.
   241     05  db-checkkey             pic x(7).
   242     05  db-compid               pic xxx.
   243     05  db-carrier              pic x.
   244     05  db-grouping             pic x(6).
   245     05  db-state                pic xx.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   6
* EL201.cbl
   246     05  db-account              pic x(10).
   247     05  db-effdate              pic x(24).
   248     05  db-certificate          pic x(10).
   249     05  db-cert-sfx             pic x.
   250     05  db-seq-no               pic x(7).
   251     05  db-type                 pic x(7).
   252     05  db-amount               pic x(10).
   253     05  db-amount-n redefines
   254         db-amount               pic 9(7).99.
   255     05  db-checkno              pic x(15).
   256     05  db-checkdate            pic x(10).
   257     05  db-checkstatus          pic 9(5).
   258     05  db-releasebatch         pic 9(5).
   259     05  db-releasedt            pic x(10).
   260     05  db-releaseby            pic x(4).
   261     05  db-payeename1           pic x(30).
   262     05  db-payeename2           pic x(30).
   263     05  db-payeeaddr1           pic x(30).
   264     05  db-payeeaddr2           pic x(30).
   265     05  db-payeecity            pic x(30).
   266     05  db-payeest              pic xx.
   267     05  db-payeezip             pic x(10).
   268     05  db-fincar               pic x.
   269     05  db-fingrp               pic x(6).
   270     05  db-finresp              pic x(10).
   271     05  db-finacct              pic x(10).
   272     05  db-preparer             pic x(4).
   273     05  db-app-status           pic x(9).
   274     05  dp-app-status-n redefines db-app-status
   275                                 pic 9(9).
   276     05  db-app-by               pic x(20).
   277     05  db-app-date             pic x(30).
   278     05  db-app-batch            pic x(10).
   279     05  db-return-to            pic x(30).
   280 EXEC SQL
   281    END DECLARE SECTION
   282 END-EXEC
   283 01  FILE-KEYS.
   284     12  ELCNTL-KEY.
   285         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   286         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   287         16 ELCNTL-ACCESS.
   288             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   289             20  FILLER              PIC X       VALUE SPACES.
   290             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   291         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   292 01  f.
   293     05  ws-connect-sw               pic x  value ' '.
   294         88  connected-to-db             value 'Y'.
   295     05  written-status          pic xx.
   296     05  writrpt-status          pic xx.
   297     05  ws-comp-id              pic xxx.
   298     05  ws-comp-cd              pic x.
   299 01  ws-raw-record.
   300     05  raw-check-no            pic x(20).
   301     05  raw-check-dt            pic x(20).
   302     05  raw-check-amt           pic x(15).
   303     05  raw-vendor-id           pic x(20).
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   7
* EL201.cbl
   304     05  raw-user-defined        pic x(30).
   305     05  raw-voucher-ref         pic x(35).
   306 01  ws-written-rec.
   307     05  wsw-check-no            pic x(20).
   308     05  wsw-check-dt            pic x(20).
   309     05  wsw-check-amt           pic x(15).
   310     05  wsw-vendor-id           pic x(20).
   311     05  wsw-user-defined        pic x(30).
   312     05  wsw-voucher-ref         pic x(35).
   313 01  filler.
   314     05  wsw-check-key           pic x(7).
   315     05  wsw-check-key-num redefines wsw-check-key
   316                                 pic 9(7).
   317 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   318     88  RESP-NORMAL                    VALUE +0.
   319     88  resp-file-notfnd               value +12.
   320     88  RESP-NOTFND                    VALUE +13.
   321     88  resp-duprec                    value +14.
   322     88  resp-dupkey                    value +15.
   323     88  resp-invreq                    value +16.
   324     88  RESP-NOTOPEN                   VALUE +19.
   325     88  RESP-ENDFILE                   VALUE +20.
   326     88  resp-lengtherr                 value +22.
   327 01  ws-work-amt-alpha           pic x(10).
   328 01  ws-work-amt-num redefines ws-work-amt-alpha
   329                                 pic 9(8)v99.
   330 01  ws-qry-string               pic x(80) value spaces.
   331 01  ws-qrystr-len               pic s9(8) comp value +60.
   332 01  ws-seq-alpha                pic x(5).
   333 01  ws-seq-no-num redefines ws-seq-alpha
   334                                 pic 9(5).
   335*                                copy ERCCHEK.
   336******************************************************************
   337*                                                                *
   338*                                                                *
   339*                            ERCCHEK                             *
   340*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   341*                            VMOD=2.008                          *
   342*                                                                *
   343*   FILE DESCRIPTION = CHECK RECORDS                             *
   344*                                                                *
   345*   FILE TYPE = VSAM,KSDS                                        *
   346*   RECORD SIZE = 600    RECFORM = FIXED                         *
   347*                                                                *
   348*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   349*       ALTERNATE INDEX = NONE                                   *
   350*                                                                *
   351*   LOG = YES                                                    *
   352*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   353******************************************************************
   354*                   C H A N G E   L O G
   355*
   356* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   357*-----------------------------------------------------------------
   358*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   359* EFFECTIVE    NUMBER
   360*-----------------------------------------------------------------
   361* 021414    2003053000001  PEMA  changes for auto chk request
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   8
* EL201.cbl
   362******************************************************************
   363 01  CHECK-RECORDS.
   364     12  CH-RECORD-ID                      PIC XX.
   365         88  VALID-CH-ID                      VALUE 'CH'.
   366
   367     12  CH-CONTROL-PRIMARY.
   368         16  CH-COMPANY-CD                 PIC X.
   369         16  CH-CARRIER                    PIC X.
   370         16  CH-GROUPING                   PIC X(6).
   371         16  CH-STATE                      PIC XX.
   372         16  CH-ACCOUNT                    PIC X(10).
   373         16  CH-CERT-EFF-DT                PIC XX.
   374         16  CH-CERT-NO.
   375             20  CH-CERT-PRIME             PIC X(10).
   376             20  CH-CERT-SFX               PIC X.
   377         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   378
   379     12  CH-RECORDED-DT                    PIC XX.
   380     12  CH-RECORDED-BY                    PIC X(4).
   381     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   382
   383     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   384     12  CH-CHECK-NO                       PIC X(7).
   385     12  CH-REASON-FOR-CHECK               PIC X(25).
   386     12  CH-CHECK-WRITTEN-DT               PIC XX.
   387     12  FILLER                            PIC X.
   388
   389     12  CH-PAYEE-INFO.
   390         16  CH-PAYEE-NAME-1               PIC X(30).
   391         16  CH-PAYEE-NAME-2               PIC X(30).
   392         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   393         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   394         16  CH-PAYEE-CITY-ST.
   395             20  CH-PAYEE-CITY             PIC X(28).
   396             20  CH-PAYEE-STATE            PIC XX.
   397         16  CH-PAYEE-ZIP-CODE.
   398             20  CH-PAYEE-ZIP.
   399                 24  CH-ZIP-PRI-1ST        PIC X.
   400                     88  CH-CANADIAN-POST-CODE
   401                                           VALUES 'A' THRU 'Z'.
   402                 24  FILLER                PIC X(4).
   403             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   404         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   405             20  CH-CAN-POSTAL-1           PIC XXX.
   406             20  CH-CAN-POSTAL-2           PIC XXX.
   407             20  FILLER                    PIC XXX.
   408
   409     12  CH-CHECK-STUB-TEXT.
   410         16  CH-STUB-LINE-1                PIC X(30).
   411         16  CH-TEXT-LINE-1                PIC X(50).
   412         16  CH-TEXT-LINE-2                PIC X(50).
   413         16  CH-TEXT-LINE-3                PIC X(40).
   414     12  CH-RETURN-TO                      PIC X(30).
   415
   416     12  CH-COMPENSATION-CONTROL.
   417         16  CH-COMP-CARRIER               PIC X.
   418         16  CH-COMP-GROUPING              PIC X(6).
   419         16  CH-COMP-FIN-RESP              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page   9
* EL201.cbl
   420         16  CH-COMP-ACCOUNT               PIC X(10).
   421
   422     12  CH-CREDIT-SELECT-DT               PIC XX.
   423     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   424     12  CH-PAYEE-CODE                     PIC X(6).
   425
   426     12  CH-VOID-DATA.
   427         20  CH-VOID-DT                    PIC XX.
   428         20  CH-VOID-BY                    PIC X(4).
   429         20  CH-VOID-REASON                PIC X(25).
   430
   431     12  CH-APPROVAL-DATA.
   432         20  CH-APPROVAL-DT                PIC XX.
   433         20  CH-APPROVAL-STATUS            PIC X.
   434             88  CH-IN-LIMBO                  VALUE ' '.
   435             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   436             88  CH-APPROVED                  VALUE 'A'.
   437             88  CH-DENIED                    VALUE 'D'.
   438         20  CH-APPROVED-BY                PIC XXXX.
   439     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   440             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   441     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   442
   443     12  ch-released-dt                    pic xx.
   444     12  ch-check-cashed-dt                pic xx.
   445     12  FILLER                            PIC X.
   446*    12  CH-CHECK-REFERENCE                PIC X(12).
   447     12  CH-CHECK-ORIGIN-SW                PIC X.
   448             88  CH-REFUND-CHECK              VALUE 'R'.
   449             88  CH-MAINT-CHECK               VALUE 'M'.
   450
   451     12  CH-CANC-DT                        PIC XX.
   452     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   453     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   454
   455     12  CH-INSURED-NAME                   PIC X(28).
   456
   457     12  ch-released-by                    pic x(4).
   458     12  ch-csr                            pic x(4).
   459     12  ch-deduct-commission              pic x.
   460         88  ch-deduct-comm                  value 'Y'.
   461         88  ch-do-not-deduct-comm           value 'N'.
   462
   463     12  FILLER                            PIC X(11).
   464*    12  CH-LETTER-TABLE.
   465*        16  CH-LETTERS OCCURS 3 TIMES
   466*                       INDEXED BY CH-LT-NDX
   467*                                          PIC X(04).
   468
   469     12  FILLER                            PIC X(07).
   470
   471*                                copy ELCFUNDT.
   472*****************************************************************
   473*                                                               *
   474*                            ELCFUNDT.                          *
   475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   476*                            VMOD=2.001                         *
   477*                                                               *
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  10
* EL201.cbl
   478*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   479*                                                               *
   480*****************************************************************
   481
   482
   483 01  FUNCTION-DATE.
   484     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   485     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   486         10  WS-FN-CCYR            PIC 9(4).
   487         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   488             15  WS-FN-CC          PIC 99.
   489             15  WS-FN-YR          PIC 99.
   490         10  WS-FN-MO              PIC 99.
   491         10  WS-FN-DA              PIC 99.
   492     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   493     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   494     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   495     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   496     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   497         88  WS-BEHIND-GMT                     VALUE '-'.
   498         88  WS-AFTER-GMT                      VALUE '+'.
   499         88  WS-NO-GMT                         VALUE ZERO.
   500     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   501     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   502*                                COPY ELCDATE.
   503******************************************************************
   504*                                                                *
   505*                                                                *
   506*                            ELCDATE.                            *
   507*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   508*                            VMOD=2.003
   509*                                                                *
   510*                                                                *
   511*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   512*                 LENGTH = 200                                   *
   513******************************************************************
   514
   515 01  DATE-CONVERSION-DATA.
   516     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   517     12  DC-OPTION-CODE                PIC X.
   518         88  BIN-TO-GREG                VALUE ' '.
   519         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   520         88  EDIT-GREG-TO-BIN           VALUE '2'.
   521         88  YMD-GREG-TO-BIN            VALUE '3'.
   522         88  MDY-GREG-TO-BIN            VALUE '4'.
   523         88  JULIAN-TO-BIN              VALUE '5'.
   524         88  BIN-PLUS-ELAPSED           VALUE '6'.
   525         88  FIND-CENTURY               VALUE '7'.
   526         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   527         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   528         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   529         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   530         88  JULIAN-TO-BIN-3            VALUE 'C'.
   531         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   532         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   533         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   534         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   535         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  11
* EL201.cbl
   536         88  CHECK-LEAP-YEAR            VALUE 'H'.
   537         88  BIN-3-TO-GREG              VALUE 'I'.
   538         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   539         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   540         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   541         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   542         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   543         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   544         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   545         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   546         88  THREE-CHARACTER-BIN
   547                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   548         88  GREGORIAN-TO-BIN
   549                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   550         88  BIN-TO-GREGORIAN
   551                  VALUES ' ' '1' 'I' '8' 'G'.
   552         88  JULIAN-TO-BINARY
   553                  VALUES '5' 'C' 'E' 'F'.
   554     12  DC-ERROR-CODE                 PIC X.
   555         88  NO-CONVERSION-ERROR        VALUE ' '.
   556         88  DATE-CONVERSION-ERROR
   557                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   558         88  DATE-IS-ZERO               VALUE '1'.
   559         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   560         88  DATE-IS-INVALID            VALUE '3'.
   561         88  DATE1-GREATER-DATE2        VALUE '4'.
   562         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   563         88  DATE-INVALID-OPTION        VALUE '9'.
   564         88  INVALID-CENTURY            VALUE 'A'.
   565         88  ONLY-CENTURY               VALUE 'B'.
   566         88  ONLY-LEAP-YEAR             VALUE 'C'.
   567         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   568     12  DC-END-OF-MONTH               PIC X.
   569         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   570     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   571         88  USE-NORMAL-PROCESS         VALUE ' '.
   572         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   573         88  ADJUST-UP-100-YRS          VALUE '2'.
   574     12  FILLER                        PIC X.
   575     12  DC-CONVERSION-DATES.
   576         16  DC-BIN-DATE-1             PIC XX.
   577         16  DC-BIN-DATE-2             PIC XX.
   578         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   579         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   580                       DC-GREG-DATE-1-EDIT.
   581             20  DC-EDIT1-MONTH        PIC 99.
   582             20  SLASH1-1              PIC X.
   583             20  DC-EDIT1-DAY          PIC 99.
   584             20  SLASH1-2              PIC X.
   585             20  DC-EDIT1-YEAR         PIC 99.
   586         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   587         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   588                     DC-GREG-DATE-2-EDIT.
   589             20  DC-EDIT2-MONTH        PIC 99.
   590             20  SLASH2-1              PIC X.
   591             20  DC-EDIT2-DAY          PIC 99.
   592             20  SLASH2-2              PIC X.
   593             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  12
* EL201.cbl
   594         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   595         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   596                     DC-GREG-DATE-1-YMD.
   597             20  DC-YMD-YEAR           PIC 99.
   598             20  DC-YMD-MONTH          PIC 99.
   599             20  DC-YMD-DAY            PIC 99.
   600         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   601         16  DC-GREG-DATE-1-MDY-R REDEFINES
   602                      DC-GREG-DATE-1-MDY.
   603             20  DC-MDY-MONTH          PIC 99.
   604             20  DC-MDY-DAY            PIC 99.
   605             20  DC-MDY-YEAR           PIC 99.
   606         16  DC-GREG-DATE-1-ALPHA.
   607             20  DC-ALPHA-MONTH        PIC X(10).
   608             20  DC-ALPHA-DAY          PIC 99.
   609             20  FILLER                PIC XX.
   610             20  DC-ALPHA-CENTURY.
   611                 24 DC-ALPHA-CEN-N     PIC 99.
   612             20  DC-ALPHA-YEAR         PIC 99.
   613         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   614         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   615         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   616         16  DC-JULIAN-DATE            PIC 9(05).
   617         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   618                                       PIC 9(05).
   619         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   620             20  DC-JULIAN-YEAR        PIC 99.
   621             20  DC-JULIAN-DAYS        PIC 999.
   622         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   623         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   624         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   625     12  DATE-CONVERSION-VARIBLES.
   626         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   627         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   628             20  FILLER                PIC 9(3).
   629             20  HOLD-CEN-1-CCYY.
   630                 24  HOLD-CEN-1-CC     PIC 99.
   631                 24  HOLD-CEN-1-YY     PIC 99.
   632             20  HOLD-CEN-1-MO         PIC 99.
   633             20  HOLD-CEN-1-DA         PIC 99.
   634         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   635             20  HOLD-CEN-1-R-MO       PIC 99.
   636             20  HOLD-CEN-1-R-DA       PIC 99.
   637             20  HOLD-CEN-1-R-CCYY.
   638                 24  HOLD-CEN-1-R-CC   PIC 99.
   639                 24  HOLD-CEN-1-R-YY   PIC 99.
   640             20  FILLER                PIC 9(3).
   641         16  HOLD-CENTURY-1-X.
   642             20  FILLER                PIC X(3)  VALUE SPACES.
   643             20  HOLD-CEN-1-X-CCYY.
   644                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   645                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   646             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   647             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   648         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   649             20  HOLD-CEN-1-R-X-MO     PIC XX.
   650             20  HOLD-CEN-1-R-X-DA     PIC XX.
   651             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  13
* EL201.cbl
   652                 24  HOLD-CEN-1-R-X-CC PIC XX.
   653                 24  HOLD-CEN-1-R-X-YY PIC XX.
   654             20  FILLER                PIC XXX.
   655         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   656         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   657         16  DC-JULIAN-DATE-1          PIC 9(07).
   658         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   659             20  DC-JULIAN-1-CCYY.
   660                 24  DC-JULIAN-1-CC    PIC 99.
   661                 24  DC-JULIAN-1-YR    PIC 99.
   662             20  DC-JULIAN-DA-1        PIC 999.
   663         16  DC-JULIAN-DATE-2          PIC 9(07).
   664         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   665             20  DC-JULIAN-2-CCYY.
   666                 24  DC-JULIAN-2-CC    PIC 99.
   667                 24  DC-JULIAN-2-YR    PIC 99.
   668             20  DC-JULIAN-DA-2        PIC 999.
   669         16  DC-GREG-DATE-A-EDIT.
   670             20  DC-EDITA-MONTH        PIC 99.
   671             20  SLASHA-1              PIC X VALUE '/'.
   672             20  DC-EDITA-DAY          PIC 99.
   673             20  SLASHA-2              PIC X VALUE '/'.
   674             20  DC-EDITA-CCYY.
   675                 24  DC-EDITA-CENT     PIC 99.
   676                 24  DC-EDITA-YEAR     PIC 99.
   677         16  DC-GREG-DATE-B-EDIT.
   678             20  DC-EDITB-MONTH        PIC 99.
   679             20  SLASHB-1              PIC X VALUE '/'.
   680             20  DC-EDITB-DAY          PIC 99.
   681             20  SLASHB-2              PIC X VALUE '/'.
   682             20  DC-EDITB-CCYY.
   683                 24  DC-EDITB-CENT     PIC 99.
   684                 24  DC-EDITB-YEAR     PIC 99.
   685         16  DC-GREG-DATE-CYMD         PIC 9(08).
   686         16  DC-GREG-DATE-CYMD-R REDEFINES
   687                              DC-GREG-DATE-CYMD.
   688             20  DC-CYMD-CEN           PIC 99.
   689             20  DC-CYMD-YEAR          PIC 99.
   690             20  DC-CYMD-MONTH         PIC 99.
   691             20  DC-CYMD-DAY           PIC 99.
   692         16  DC-GREG-DATE-MDCY         PIC 9(08).
   693         16  DC-GREG-DATE-MDCY-R REDEFINES
   694                              DC-GREG-DATE-MDCY.
   695             20  DC-MDCY-MONTH         PIC 99.
   696             20  DC-MDCY-DAY           PIC 99.
   697             20  DC-MDCY-CEN           PIC 99.
   698             20  DC-MDCY-YEAR          PIC 99.
   699    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   700        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   701    12  DC-EL310-DATE                  PIC X(21).
   702    12  FILLER                         PIC X(28).
   703*                                COPY ELCCNTL.
   704******************************************************************
   705*                                                                *
   706*                                                                *
   707*                            ELCCNTL.                            *
   708*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   709*                            VMOD=2.059                          *
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  14
* EL201.cbl
   710*                                                                *
   711*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   712*                                                                *
   713*   FILE TYPE = VSAM,KSDS                                        *
   714*   RECORD SIZE = 750  RECFORM = FIXED                           *
   715*                                                                *
   716*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   717*       ALTERNATE INDEX = NONE                                   *
   718*                                                                *
   719*   LOG = YES                                                    *
   720*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   721******************************************************************
   722*                   C H A N G E   L O G
   723*
   724* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   725*-----------------------------------------------------------------
   726*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   727* EFFECTIVE    NUMBER
   728*-----------------------------------------------------------------
   729* 082503                   PEMA  ADD BENEFIT GROUP
   730* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   731* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   732* 092705    2005050300006  PEMA  ADD SPP LEASES
   733* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   734* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   735* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   736* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   737* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   738* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   739* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   740* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   741* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   742* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   743******************************************************************
   744*
   745 01  CONTROL-FILE.
   746     12  CF-RECORD-ID                       PIC XX.
   747         88  VALID-CF-ID                        VALUE 'CF'.
   748
   749     12  CF-CONTROL-PRIMARY.
   750         16  CF-COMPANY-ID                  PIC XXX.
   751         16  CF-RECORD-TYPE                 PIC X.
   752             88  CF-COMPANY-MASTER              VALUE '1'.
   753             88  CF-PROCESSOR-MASTER            VALUE '2'.
   754             88  CF-STATE-MASTER                VALUE '3'.
   755             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   756             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   757             88  CF-CARRIER-MASTER              VALUE '6'.
   758             88  CF-MORTALITY-MASTER            VALUE '7'.
   759             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   760             88  CF-TERMINAL-MASTER             VALUE '9'.
   761             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   762             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   763             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   764             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   765             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   766             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   767             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  15
* EL201.cbl
   768             88  CF-REMINDERS-MASTER            VALUE 'R'.
   769             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   770         16  CF-ACCESS-CD-GENL              PIC X(4).
   771         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   772             20  CF-PROCESSOR               PIC X(4).
   773         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   774             20  CF-STATE-CODE              PIC XX.
   775             20  FILLER                     PIC XX.
   776         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   777             20  FILLER                     PIC XX.
   778             20  CF-HI-BEN-IN-REC           PIC XX.
   779         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   780             20  FILLER                     PIC XXX.
   781             20  CF-CARRIER-CNTL            PIC X.
   782         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   783             20  FILLER                     PIC XX.
   784             20  CF-HI-TYPE-IN-REC          PIC 99.
   785         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   786             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   787                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   788             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   789             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   790         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   791             20  FILLER                     PIC X.
   792             20  CF-CUSTOM-REPORT-NO        PIC 999.
   793         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   794             20  FILLER                     PIC XX.
   795             20  CF-MORTGAGE-PLAN           PIC XX.
   796         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   797
   798     12  CF-LAST-MAINT-DT                   PIC XX.
   799     12  CF-LAST-MAINT-BY                   PIC X(4).
   800     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   801
   802     12  CF-RECORD-BODY                     PIC X(728).
   803
   804
   805****************************************************************
   806*             COMPANY MASTER RECORD                            *
   807****************************************************************
   808
   809     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   810         16  CF-COMPANY-ADDRESS.
   811             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   812             20  CF-CL-IN-CARE-OF           PIC X(30).
   813             20  CF-CL-ADDR-LINE-1          PIC X(30).
   814             20  CF-CL-ADDR-LINE-2          PIC X(30).
   815             20  CF-CL-CITY-STATE           PIC X(30).
   816             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   817             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   818         16  CF-COMPANY-CD                  PIC X.
   819         16  CF-COMPANY-PASSWORD            PIC X(8).
   820         16  CF-SECURITY-OPTION             PIC X.
   821             88  ALL-SECURITY                   VALUE '1'.
   822             88  COMPANY-VERIFY                 VALUE '2'.
   823             88  PROCESSOR-VERIFY               VALUE '3'.
   824             88  NO-SECURITY                    VALUE '4'.
   825             88  ALL-BUT-TERM                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  16
* EL201.cbl
   826         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   827             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   828         16  CF-LGX-INTERFACE-CNTL          PIC X.
   829             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   830         16  CF-INFORCE-LOCATION            PIC X.
   831             88  CERTS-ARE-ONLINE               VALUE '1'.
   832             88  CERTS-ARE-OFFLINE              VALUE '2'.
   833             88  NO-CERTS-AVAILABLE             VALUE '3'.
   834         16  CF-LOWER-CASE-LETTERS          PIC X.
   835         16  CF-CERT-ACCESS-CONTROL         PIC X.
   836             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   837             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   838             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   839             88  CF-ACCNT-CNTL                  VALUE '3'.
   840             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   841
   842         16  CF-FORMS-PRINTER-ID            PIC X(4).
   843         16  CF-CHECK-PRINTER-ID            PIC X(4).
   844
   845         16  CF-LGX-CREDIT-USER             PIC X.
   846             88  CO-IS-NOT-USER                 VALUE 'N'.
   847             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   848
   849         16 CF-CREDIT-CALC-CODES.
   850             20  CF-CR-REM-TERM-CALC PIC X.
   851               88  CR-EARN-AFTER-15TH           VALUE '1'.
   852               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   853               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   854               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   855               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   856               88  CR-EARN-AFTER-14TH           VALUE '6'.
   857               88  CR-EARN-AFTER-16TH           VALUE '7'.
   858             20  CF-CR-R78-METHOD           PIC X.
   859               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   860               88  DONT-USE-PLUS-ONE            VALUE '1'.
   861
   862         16  CF-CLAIM-CONTROL-COUNTS.
   863             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   864                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   865
   866             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   867                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   868
   869             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   870                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   871
   872             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   873                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   874
   875         16  CF-CURRENT-MONTH-END           PIC XX.
   876
   877         16  CF-CO-CALC-QUOTE-TOLERANCE.
   878             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   879             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   880             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   881             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   882                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   883                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  17
* EL201.cbl
   884             20  CF-CO-PREM-REJECT-SW       PIC X.
   885                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   886                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   887             20  CF-CO-REF-REJECT-SW        PIC X.
   888                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   889                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   890
   891         16  CF-CO-REPORTING-DT             PIC XX.
   892         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   893         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   894           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   895           88  CF-CO-MONTH-END                  VALUE '1'.
   896
   897         16  CF-LGX-CLAIM-USER              PIC X.
   898             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   899             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   900
   901         16  CF-CREDIT-EDIT-CONTROLS.
   902             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   903             20  CF-MIN-AGE                 PIC 99.
   904             20  CF-DEFAULT-AGE             PIC 99.
   905             20  CF-MIN-TERM                PIC S999      COMP-3.
   906             20  CF-MAX-TERM                PIC S999      COMP-3.
   907             20  CF-DEFAULT-SEX             PIC X.
   908             20  CF-JOINT-AGE-INPUT         PIC X.
   909                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   910             20  CF-BIRTH-DATE-INPUT        PIC X.
   911                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   912             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   913                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   914                 88  CF-ZERO-CARRIER            VALUE '1'.
   915                 88  CF-ZERO-GROUPING           VALUE '2'.
   916                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   917             20  CF-EDIT-SW                 PIC X.
   918                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   919             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   920             20  CF-CR-PR-METHOD            PIC X.
   921               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   922               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   923             20  FILLER                     PIC X.
   924
   925         16  CF-CREDIT-MISC-CONTROLS.
   926             20  CF-REIN-TABLE-SW           PIC X.
   927                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   928             20  CF-COMP-TABLE-SW           PIC X.
   929                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   930             20  CF-EXPERIENCE-RETENTION-AGE
   931                                            PIC S9        COMP-3.
   932             20  CF-CONVERSION-DT           PIC XX.
   933             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   934             20  CF-RUN-FREQUENCY-SW        PIC X.
   935                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   936                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   937
   938             20  CF-CR-CHECK-NO-CONTROL.
   939                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   940                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   941                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  18
* EL201.cbl
   942                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   943                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   944                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   945
   946                 24  CF-CR-CHECK-COUNT       REDEFINES
   947                     CF-CR-CHECK-COUNTER      PIC X(4).
   948
   949                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   950                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   951
   952                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   953                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   954                 24  CF-MAIL-PROCESSING       PIC X.
   955                     88  MAIL-PROCESSING          VALUE 'Y'.
   956
   957         16  CF-MISC-SYSTEM-CONTROL.
   958             20  CF-SYSTEM-C                 PIC X.
   959                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   960             20  CF-SYSTEM-D                 PIC X.
   961                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   962             20  CF-SOC-SEC-NO-SW            PIC X.
   963                 88  SOC-SEC-NO-USED             VALUE '1'.
   964             20  CF-MEMBER-NO-SW             PIC X.
   965                 88  MEMBER-NO-USED              VALUE '1'.
   966             20  CF-TAX-ID-NUMBER            PIC X(11).
   967             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   968             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   969                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   970                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   971                 88  CF-ALL-APPROVED             VALUE 'Y'.
   972                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   973             20  CF-SYSTEM-E                 PIC X.
   974                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   975
   976         16  CF-LGX-LIFE-USER               PIC X.
   977             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   978             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   979
   980         16  CF-CR-MONTH-END-DT             PIC XX.
   981
   982         16  CF-FILE-MAINT-DATES.
   983             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   984                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   985             20  CF-LAST-BATCH       REDEFINES
   986                 CF-LAST-BATCH-NO               PIC X(4).
   987             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   988             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   989             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   990             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   991             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   992             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   993             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   994             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   995             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   996             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   997
   998         16  CF-NEXT-COMPANY-ID             PIC XXX.
   999         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  19
* EL201.cbl
  1000
  1001         16  CF-ALT-MORT-CODE               PIC X(4).
  1002         16  CF-MEMBER-CAPTION              PIC X(10).
  1003
  1004         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1005             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1006             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1007             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1008             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1009             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1010
  1011         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1012
  1013         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1014         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1015         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1016         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1017
  1018         16  CF-AH-OVERRIDE-L1              PIC X.
  1019         16  CF-AH-OVERRIDE-L2              PIC XX.
  1020         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1021         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1022
  1023         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1024         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1025
  1026         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1027         16  CF-AR-LAST-EL860-DT            PIC XX.
  1028         16  CF-MP-MONTH-END-DT             PIC XX.
  1029
  1030         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1031         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1032             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1033
  1034         16  CF-AR-MONTH-END-DT             PIC XX.
  1035
  1036         16  CF-CRDTCRD-USER                PIC X.
  1037             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1038             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1039
  1040         16  CF-CC-MONTH-END-DT             PIC XX.
  1041
  1042         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1043
  1044         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1045             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1046             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1047             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1048         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1049         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1050         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1051         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1052             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1053             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1054         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1055         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1056         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1057             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  20
* EL201.cbl
  1058         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1059
  1060         16  CF-CL-ZIP-CODE.
  1061             20  CF-CL-ZIP-PRIME.
  1062                 24  CF-CL-ZIP-1ST          PIC X.
  1063                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1064                 24  FILLER                 PIC X(4).
  1065             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1066         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1067             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1068             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1069             20  FILLER                     PIC XXX.
  1070
  1071         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1072         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1073         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1074         16  CF-CO-OPTION-START-DATE        PIC XX.
  1075         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1076           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1077                                                      '3' '4'.
  1078           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1079           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1080           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1081           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1082           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1083           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1084
  1085         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1086
  1087         16  CF-PAYMENT-APPROVAL-LEVELS.
  1088             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1089             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1090             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1091             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1092             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1093             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1094
  1095         16  CF-END-USER-REPORTING-USER     PIC X.
  1096             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1097             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1098
  1099         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1100             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1101             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1102
  1103         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1104
  1105         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1106         16  FILLER                         PIC X.
  1107
  1108         16  CF-CREDIT-ARCHIVE-CNTL.
  1109             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1110             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1111             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1112
  1113         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1114
  1115         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  21
* EL201.cbl
  1116             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1117             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1118
  1119         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1120             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1121             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1122
  1123         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1124
  1125         16  CF-CO-ACH-ID-CODE              PIC  X.
  1126             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1127             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1128             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1129         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1130         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1131         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1132         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1133         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1134         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1135         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1136         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1137         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1138                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1139         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1140                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1141
  1142         16  CF-CO-OVER-SHORT.
  1143             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1144             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1145
  1146*         16  FILLER                         PIC X(102).
  1147         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1148             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1149             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1150
  1151         16  CF-AH-APPROVAL-DAYS.
  1152             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1153             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1154             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1155             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1156
  1157         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1158
  1159         16  CF-APPROV-LEV-5.
  1160             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1161             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1162             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1163
  1164         16  FILLER                         PIC X(68).
  1165****************************************************************
  1166*             PROCESSOR/USER RECORD                            *
  1167****************************************************************
  1168
  1169     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1170         16  CF-PROCESSOR-NAME              PIC X(30).
  1171         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1172         16  CF-PROCESSOR-TITLE             PIC X(26).
  1173         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  22
* EL201.cbl
  1174                 88  MESSAGE-YES                VALUE 'Y'.
  1175                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1176
  1177*****************************************************
  1178****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1179****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1180****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1181****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1182*****************************************************
  1183
  1184         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1185             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1186             20  CF-APPLICATION-FORCE       PIC X.
  1187             20  CF-INDIVIDUAL-APP.
  1188                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1189                     28  CF-BROWSE-APP      PIC X.
  1190                     28  CF-UPDATE-APP      PIC X.
  1191
  1192         16  CF-CURRENT-TERM-ON             PIC X(4).
  1193         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1194             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1195             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1196             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1197             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1198             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1199             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1200             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1201         16  CF-PROCESSOR-CARRIER           PIC X.
  1202             88  NO-CARRIER-SECURITY            VALUE ' '.
  1203         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1204             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1205         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1206             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1207         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1208             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1209
  1210         16  CF-PROC-SYS-ACCESS-SW.
  1211             20  CF-PROC-CREDIT-CLAIMS-SW.
  1212                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1213                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1214                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1215                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1216             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1217                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1218                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1219             20  CF-PROC-LIFE-GNRLDGR-SW.
  1220                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1221                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1222                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1223                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1224             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1225                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1226                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1227         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1228             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1229             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1230         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1231
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  23
* EL201.cbl
  1232         16  CF-APPROVAL-LEVEL                  PIC X.
  1233             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1234             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1235             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1236             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1237             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1238
  1239         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1240
  1241         16  CF-LANGUAGE-TYPE                   PIC X.
  1242             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1243             88  CF-LANG-IS-FR                      VALUE 'F'.
  1244
  1245         16  CF-CSR-IND                         PIC X.
  1246         16  FILLER                             PIC X(239).
  1247
  1248****************************************************************
  1249*             PROCESSOR/REMINDERS RECORD                       *
  1250****************************************************************
  1251
  1252     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1253         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1254             20  CF-START-REMIND-DT         PIC XX.
  1255             20  CF-END-REMIND-DT           PIC XX.
  1256             20  CF-REMINDER-TEXT           PIC X(50).
  1257         16  FILLER                         PIC X(296).
  1258
  1259
  1260****************************************************************
  1261*             STATE MASTER RECORD                              *
  1262****************************************************************
  1263
  1264     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1265         16  CF-STATE-ABBREVIATION          PIC XX.
  1266         16  CF-STATE-NAME                  PIC X(25).
  1267         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1268         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1269             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1270             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1271             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1272             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1273                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1274                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1275             20  CF-ST-PREM-REJECT-SW       PIC X.
  1276                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1277                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1278             20  CF-ST-REF-REJECT-SW        PIC X.
  1279                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1280                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1281         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1282         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1283         16  CF-ST-REFUND-RULES.
  1284             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1285             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1286             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1287         16  CF-ST-FST-PMT-EXTENSION.
  1288             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1289             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  24
* EL201.cbl
  1290                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1291                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1292                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1293                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1294         16  CF-ST-STATE-CALL.
  1295             20  CF-ST-CALL-UNEARNED        PIC X.
  1296             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1297             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1298         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1299             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1300             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1301         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1302         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1303         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1304         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1305         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1306         16  FILLER                         PIC X.
  1307         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1308             20  CF-ST-BENEFIT-CD           PIC XX.
  1309             20  CF-ST-BENEFIT-KIND         PIC X.
  1310                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1311                 88  CF-ST-AH-KIND              VALUE 'A'.
  1312             20  CF-ST-REM-TERM-CALC        PIC X.
  1313                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1314                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1315                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1316                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1317                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1318                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1319                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1320                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1321
  1322             20  CF-ST-REFUND-CALC          PIC X.
  1323                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1324                 88  ST-REFD-BY-R78             VALUE '1'.
  1325                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1326                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1327                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1328                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1329                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1330                 88  ST-REFD-UTAH               VALUE '7'.
  1331                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1332                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1333                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1334
  1335             20  CF-ST-EARNING-CALC         PIC X.
  1336                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1337                 88  ST-EARN-BY-R78             VALUE '1'.
  1338                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1339                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1340                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1341                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1342                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1343                 88  ST-EARN-MEAN               VALUE '8'.
  1344                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1345
  1346             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1347                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  25
* EL201.cbl
  1348                 88  ST-OVRD-BY-R78             VALUE '1'.
  1349                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1350                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1351                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1352                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1353                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1354                 88  ST-OVRD-MEAN               VALUE '8'.
  1355                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1356             20  cf-st-extra-periods        pic 9.
  1357*            20  FILLER                     PIC X.
  1358
  1359         16  CF-ST-COMMISSION-CAPS.
  1360             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1361             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1362             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1363             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1364         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1365                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1366
  1367         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1368
  1369         16  CF-ST-STATUTORY-INTEREST.
  1370             20  CF-ST-STAT-DATE-FROM       PIC X.
  1371                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1372                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1373             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1374             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1375             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1376             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1377             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1378
  1379         16  CF-ST-OVER-SHORT.
  1380             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1381             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1382
  1383         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1384
  1385         16  CF-ST-RT-CALC                  PIC X.
  1386
  1387         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1388         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1389         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1390         16  CF-ST-RF-LR-CALC               PIC X.
  1391         16  CF-ST-RF-LL-CALC               PIC X.
  1392         16  CF-ST-RF-LN-CALC               PIC X.
  1393         16  CF-ST-RF-AH-CALC               PIC X.
  1394         16  CF-ST-RF-CP-CALC               PIC X.
  1395*        16  FILLER                         PIC X(206).
  1396*CIDMOD         16  FILLER                         PIC X(192).
  1397         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1398             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1399         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1400         16  CF-ST-VFY-2ND-BENE             PIC X.
  1401         16  CF-ST-CAUSAL-STATE             PIC X.
  1402         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1403         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1404         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1405             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  26
* EL201.cbl
  1406         16  CF-ST-NET-ONLY-STATE           PIC X.
  1407             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1408         16  FILLER                         PIC X(181).
  1409
  1410****************************************************************
  1411*             BENEFIT MASTER RECORD                            *
  1412****************************************************************
  1413
  1414     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1415         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1416             20  CF-BENEFIT-CODE            PIC XX.
  1417             20  CF-BENEFIT-NUMERIC  REDEFINES
  1418                 CF-BENEFIT-CODE            PIC XX.
  1419             20  CF-BENEFIT-ALPHA           PIC XXX.
  1420             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1421             20  CF-BENEFIT-COMMENT         PIC X(10).
  1422
  1423             20  CF-LF-COVERAGE-TYPE        PIC X.
  1424                 88  CF-REDUCING                VALUE 'R'.
  1425                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1426
  1427             20  CF-SPECIAL-CALC-CD         PIC X.
  1428                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1429                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1430                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1431                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1432                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1433                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1434                 88  CF-FARM-PLAN               VALUE 'F'.
  1435                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1436                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1437                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1438                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1439                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1440                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1441                 88  CF-PRUDENTIAL              VALUE 'P'.
  1442                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1443                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1444                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1445                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1446                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1447                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1448
  1449             20  CF-JOINT-INDICATOR         PIC X.
  1450                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1451
  1452*            20  FILLER                     PIC X(12).
  1453             20  cf-maximum-benefits        pic s999 comp-3.
  1454             20  FILLER                     PIC X(09).
  1455             20  CF-BENEFIT-CATEGORY        PIC X.
  1456             20  CF-LOAN-TYPE               PIC X(8).
  1457
  1458             20  CF-CO-REM-TERM-CALC        PIC X.
  1459                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1460                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1461                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1462                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1463                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  27
* EL201.cbl
  1464
  1465             20  CF-CO-EARNINGS-CALC        PIC X.
  1466                 88  CO-EARN-BY-R78             VALUE '1'.
  1467                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1468                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1469                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1470                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1471                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1472                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1473                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1474
  1475             20  CF-CO-REFUND-CALC          PIC X.
  1476                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1477                 88  CO-REFD-BY-R78             VALUE '1'.
  1478                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1479                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1480                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1481                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1482                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1483                 88  CO-REFD-MEAN               VALUE '8'.
  1484                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1485                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1486                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1487
  1488             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1489                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1490                 88  CO-OVRD-BY-R78             VALUE '1'.
  1491                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1492                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1493                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1494                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1495                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1496                 88  CO-OVRD-MEAN               VALUE '8'.
  1497                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1498
  1499             20  CF-CO-BEN-I-G-CD           PIC X.
  1500                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1501                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1502                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1503
  1504         16  FILLER                         PIC X(304).
  1505
  1506
  1507****************************************************************
  1508*             CARRIER MASTER RECORD                            *
  1509****************************************************************
  1510
  1511     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1512         16  CF-ADDRESS-DATA.
  1513             20  CF-MAIL-TO-NAME            PIC X(30).
  1514             20  CF-IN-CARE-OF              PIC X(30).
  1515             20  CF-ADDRESS-LINE-1          PIC X(30).
  1516             20  CF-ADDRESS-LINE-2          PIC X(30).
  1517             20  CF-CITY-STATE              PIC X(30).
  1518             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1519             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1520
  1521         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  28
* EL201.cbl
  1522             20  CF-CLAIM-NO-METHOD         PIC X.
  1523                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1524                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1525                 88  CLAIM-NO-SEQ               VALUE '3'.
  1526                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1527             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1528                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1529                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1530                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1531
  1532         16  CF-CHECK-NO-CONTROL.
  1533             20  CF-CHECK-NO-METHOD         PIC X.
  1534                 88  CHECK-NO-MANUAL            VALUE '1'.
  1535                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1536                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1537                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1538             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1539                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1540
  1541         16  CF-DOMICILE-STATE              PIC XX.
  1542
  1543         16  CF-EXPENSE-CONTROLS.
  1544             20  CF-EXPENSE-METHOD          PIC X.
  1545                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1546                 88  DOLLARS-PER-PMT            VALUE '2'.
  1547                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1548                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1549             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1550             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1551
  1552         16  CF-CORRESPONDENCE-CONTROL.
  1553             20  CF-LETTER-RESEND-OPT       PIC X.
  1554                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1555                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1556             20  FILLER                     PIC X(4).
  1557
  1558         16  CF-RESERVE-CONTROLS.
  1559             20  CF-MANUAL-SW               PIC X.
  1560                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1561             20  CF-FUTURE-SW               PIC X.
  1562                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1563             20  CF-PTC-SW                  PIC X.
  1564                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1565             20  CF-IBNR-SW                 PIC X.
  1566                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1567             20  CF-PTC-LF-SW               PIC X.
  1568                 88  CF-LF-PTC-USED             VALUE '1'.
  1569             20  CF-CDT-ACCESS-METHOD       PIC X.
  1570                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1571                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1572                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1573             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1574
  1575         16  CF-CLAIM-CALC-METHOD           PIC X.
  1576             88  360-PLUS-MONTHS                VALUE '1'.
  1577             88  365-PLUS-MONTHS                VALUE '2'.
  1578             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1579             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  29
* EL201.cbl
  1580             88  365-DAILY                      VALUE '5'.
  1581
  1582         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1583         16  FILLER                         PIC X(11).
  1584
  1585         16  CF-LIMIT-AMOUNTS.
  1586             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1587             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1588             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1589             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1590             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1591             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1592             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1593             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1594             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1595             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1596
  1597         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1598         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1599         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1600
  1601         16  CF-ZIP-CODE.
  1602             20  CF-ZIP-PRIME.
  1603                 24  CF-ZIP-1ST             PIC X.
  1604                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1605                 24  FILLER                 PIC X(4).
  1606             20  CF-ZIP-PLUS4               PIC X(4).
  1607         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1608             20  CF-CAN-POSTAL-1            PIC XXX.
  1609             20  CF-CAN-POSTAL-2            PIC XXX.
  1610             20  FILLER                     PIC XXX.
  1611
  1612         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1613         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1614         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1615
  1616         16  CF-RATING-SWITCH               PIC X.
  1617             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1618             88  CF-NO-RATING                   VALUE 'N'.
  1619
  1620         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1621
  1622         16  CF-CARRIER-OVER-SHORT.
  1623             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1624             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1625
  1626         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1627         16  CF-SECPAY-SWITCH               PIC X.
  1628             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1629             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1630         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1631         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1632         16  FILLER                         PIC X(444).
  1633*        16  FILLER                         PIC X(452).
  1634
  1635
  1636****************************************************************
  1637*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  30
* EL201.cbl
  1638****************************************************************
  1639
  1640     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1641         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1642                                INDEXED BY CF-MORT-NDX.
  1643             20  CF-MORT-TABLE              PIC X(5).
  1644             20  CF-MORT-TABLE-TYPE         PIC X.
  1645                 88  CF-MORT-JOINT              VALUE 'J'.
  1646                 88  CF-MORT-SINGLE             VALUE 'S'.
  1647                 88  CF-MORT-COMBINED           VALUE 'C'.
  1648                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1649                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1650             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1651             20  CF-MORT-AGE-METHOD         PIC XX.
  1652                 88  CF-AGE-LAST                VALUE 'AL'.
  1653                 88  CF-AGE-NEAR                VALUE 'AN'.
  1654             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1655             20  CF-MORT-ADJUSTMENT-DIRECTION
  1656                                            PIC X.
  1657                 88  CF-MINUS                   VALUE '-'.
  1658                 88  CF-PLUS                    VALUE '+'.
  1659             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1660             20  CF-MORT-JOINT-CODE         PIC X.
  1661                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1662             20  CF-MORT-PC-Q               PIC X.
  1663                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1664             20  CF-MORT-TABLE-CODE         PIC X(4).
  1665             20  CF-MORT-COMMENTS           PIC X(15).
  1666             20  FILLER                     PIC X(14).
  1667
  1668         16  FILLER                         PIC X(251).
  1669
  1670
  1671****************************************************************
  1672*             BUSSINESS TYPE MASTER RECORD                     *
  1673****************************************************************
  1674
  1675     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1676* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1677* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1678* AND RECORD 05 IS TYPES 81-99
  1679         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1680             20  CF-BUSINESS-TITLE          PIC  X(19).
  1681             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1682                                            PIC S9V9(4) COMP-3.
  1683             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1684             20  FILLER                     PIC  X.
  1685         16  FILLER                         PIC  X(248).
  1686
  1687
  1688****************************************************************
  1689*             TERMINAL MASTER RECORD                           *
  1690****************************************************************
  1691
  1692     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1693
  1694         16  CF-COMPANY-TERMINALS.
  1695             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  31
* EL201.cbl
  1696                                  PIC X(4).
  1697         16  FILLER               PIC X(248).
  1698
  1699
  1700****************************************************************
  1701*             LIFE EDIT MASTER RECORD                          *
  1702****************************************************************
  1703
  1704     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1705         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1706             20  CF-LIFE-CODE-IN            PIC XX.
  1707             20  CF-LIFE-CODE-OUT           PIC XX.
  1708         16  FILLER                         PIC X(248).
  1709
  1710
  1711****************************************************************
  1712*             AH EDIT MASTER RECORD                            *
  1713****************************************************************
  1714
  1715     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1716         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1717             20  CF-AH-CODE-IN              PIC XXX.
  1718             20  CF-AH-CODE-OUT             PIC XX.
  1719         16  FILLER                         PIC X(248).
  1720
  1721
  1722****************************************************************
  1723*             CREDIBILITY TABLES                               *
  1724****************************************************************
  1725
  1726     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1727         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1728                             INDEXED BY CF-CRDB-NDX.
  1729             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1730             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1731             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1732         16  FILLER                         PIC  X(332).
  1733
  1734
  1735****************************************************************
  1736*             REPORT CUSTOMIZATION RECORD                      *
  1737****************************************************************
  1738
  1739     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1740         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1741             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1742             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1743             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1744**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1745****       A T-TRANSFER.                                   ****
  1746             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1747
  1748         16  FILLER                         PIC XX.
  1749
  1750         16  CF-CARRIER-CNTL-OPT.
  1751             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1752                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1753                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  32
* EL201.cbl
  1754             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1755                                            PIC X.
  1756         16  CF-GROUP-CNTL-OPT.
  1757             20  CF-GROUP-OPT-SEQ           PIC 9.
  1758                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1759                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1760             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1761                                            PIC X(6).
  1762         16  CF-STATE-CNTL-OPT.
  1763             20  CF-STATE-OPT-SEQ           PIC 9.
  1764                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1765                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1766             20  CF-STATE-SELECT OCCURS 3 TIMES
  1767                                            PIC XX.
  1768         16  CF-ACCOUNT-CNTL-OPT.
  1769             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1770                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1771                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1772             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1773                                            PIC X(10).
  1774         16  CF-BUS-TYP-CNTL-OPT.
  1775             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1776                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1777                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1778             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1779                                            PIC XX.
  1780         16  CF-LF-TYP-CNTL-OPT.
  1781             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1782                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1783                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1784             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1785                                            PIC XX.
  1786         16  CF-AH-TYP-CNTL-OPT.
  1787             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1788                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1789                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1790             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1791                                            PIC XX.
  1792         16  CF-REPTCD1-CNTL-OPT.
  1793             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1794                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1795                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1796             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1797                                            PIC X(10).
  1798         16  CF-REPTCD2-CNTL-OPT.
  1799             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1800                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1801                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1802             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1803                                            PIC X(10).
  1804         16  CF-USER1-CNTL-OPT.
  1805             20  CF-USER1-OPT-SEQ           PIC 9.
  1806                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1807                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1808             20  CF-USER1-SELECT OCCURS 3 TIMES
  1809                                            PIC X(10).
  1810         16  CF-USER2-CNTL-OPT.
  1811             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  33
* EL201.cbl
  1812                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1813                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1814             20  CF-USER2-SELECT OCCURS 3 TIMES
  1815                                            PIC X(10).
  1816         16  CF-USER3-CNTL-OPT.
  1817             20  CF-USER3-OPT-SEQ           PIC 9.
  1818                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1819                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1820             20  CF-USER3-SELECT OCCURS 3 TIMES
  1821                                            PIC X(10).
  1822         16  CF-USER4-CNTL-OPT.
  1823             20  CF-USER4-OPT-SEQ           PIC 9.
  1824                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1825                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1826             20  CF-USER4-SELECT OCCURS 3 TIMES
  1827                                            PIC X(10).
  1828         16  CF-USER5-CNTL-OPT.
  1829             20  CF-USER5-OPT-SEQ           PIC 9.
  1830                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1831                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1832             20  CF-USER5-SELECT OCCURS 3 TIMES
  1833                                            PIC X(10).
  1834         16  CF-REINS-CNTL-OPT.
  1835             20  CF-REINS-OPT-SEQ           PIC 9.
  1836                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1837                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1838             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1839                 24  CF-REINS-PRIME         PIC XXX.
  1840                 24  CF-REINS-SUB           PIC XXX.
  1841
  1842         16  CF-AGENT-CNTL-OPT.
  1843             20  CF-AGENT-OPT-SEQ           PIC 9.
  1844                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1845                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1846             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1847                                            PIC X(10).
  1848
  1849         16  FILLER                         PIC X(43).
  1850
  1851         16  CF-LOSS-RATIO-SELECT.
  1852             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1853             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1854         16  CF-ENTRY-DATE-SELECT.
  1855             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1856             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1857         16  CF-EFFECTIVE-DATE-SELECT.
  1858             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1859             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1860
  1861         16  CF-EXCEPTION-LIST-IND          PIC X.
  1862             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1863
  1864         16  FILLER                         PIC X(318).
  1865
  1866****************************************************************
  1867*                  EXCEPTION REPORTING RECORD                  *
  1868****************************************************************
  1869
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  34
* EL201.cbl
  1870     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1871         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1872             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1873
  1874         16  CF-COMBINED-LIFE-AH-OPT.
  1875             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1876             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1877             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1878             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1879
  1880         16  CF-LIFE-OPT.
  1881             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1882             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1883             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1884             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1885             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1886             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1887             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1888             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1889             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1890             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1891
  1892         16  CF-AH-OPT.
  1893             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1894             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1895             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1896             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1897             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1898             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1899             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1900             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1901             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1902             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1903
  1904         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1905             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1906             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1907             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1908
  1909         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1910
  1911         16  FILLER                         PIC X(673).
  1912
  1913
  1914****************************************************************
  1915*             MORTGAGE SYSTEM PLAN RECORD                      *
  1916****************************************************************
  1917
  1918     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1919         16  CF-PLAN-TYPE                   PIC X.
  1920             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1921             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1922             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1923         16  CF-PLAN-ABBREV                 PIC XXX.
  1924         16  CF-PLAN-DESCRIPT               PIC X(10).
  1925         16  CF-PLAN-NOTES                  PIC X(20).
  1926         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1927         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  35
* EL201.cbl
  1928             20  CF-PLAN-TERM-DATA.
  1929                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1930                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1931             20  CF-PLAN-AGE-DATA.
  1932                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1933                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1934                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1935             20  CF-PLAN-BENEFIT-DATA.
  1936                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1937                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1938                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1939                                            PIC S9(7)V99  COMP-3.
  1940         16  CF-PLAN-POLICY-FORMS.
  1941             20  CF-POLICY-FORM             PIC X(12).
  1942             20  CF-MASTER-APPLICATION      PIC X(12).
  1943             20  CF-MASTER-POLICY           PIC X(12).
  1944         16  CF-PLAN-RATING.
  1945             20  CF-RATE-CODE               PIC X(5).
  1946             20  CF-SEX-RATING              PIC X.
  1947                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1948                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1949             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1950             20  CF-SUB-STD-TYPE            PIC X.
  1951                 88  CF-PCT-OF-PREM            VALUE '1'.
  1952                 88  CF-PCT-OF-BENE            VALUE '2'.
  1953         16  CF-PLAN-PREM-TOLERANCES.
  1954             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1955             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1956         16  CF-PLAN-PYMT-TOLERANCES.
  1957             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1958             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1959         16  CF-PLAN-MISC-DATA.
  1960             20  FILLER                     PIC X.
  1961             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1962             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1963         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1964         16  CF-PLAN-IND-GRP                PIC X.
  1965             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1966                                                     '1'.
  1967             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1968                                                     '2'.
  1969         16  CF-MIB-SEARCH-SW               PIC X.
  1970             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1971             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1972             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1973             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1974         16  CF-ALPHA-SEARCH-SW             PIC X.
  1975             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1976             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1977             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1978             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1979             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1980             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1981             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1982             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1983             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1984             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1985                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  36
* EL201.cbl
  1986                                                     'X' 'Y' 'Z'.
  1987         16  CF-EFF-DT-RULE-SW              PIC X.
  1988             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1989             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1990             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1991             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1992             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1993         16  FILLER                         PIC X(4).
  1994         16  CF-HEALTH-QUESTIONS            PIC X.
  1995             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1996         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1997         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1998         16  CF-PLAN-SNGL-JNT               PIC X.
  1999             88  CF-COMBINED-PLAN              VALUE 'C'.
  2000             88  CF-JNT-PLAN                   VALUE 'J'.
  2001             88  CF-SNGL-PLAN                  VALUE 'S'.
  2002         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2003         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2004         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2005         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2006         16  CF-RERATE-CNTL                 PIC  X.
  2007             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2008             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2009             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2010             88  CF-AUTO-RECALC                 VALUE '4'.
  2011         16  CF-BENEFIT-TYPE                PIC  X.
  2012             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2013             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2014         16  CF-POLICY-FEE                  PIC S999V99
  2015                                                    COMP-3.
  2016         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2017         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2018         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2019         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2020         16  FILLER                         PIC  X(32).
  2021         16  CF-TERMINATION-FORM            PIC  X(04).
  2022         16  FILLER                         PIC  X(08).
  2023         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2024                                                       COMP-3.
  2025         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2026         16  CF-ISSUE-LETTER                PIC  X(4).
  2027         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2028         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2029             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2030             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2031         16  CF-MP-REFUND-CALC              PIC X.
  2032             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2033             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2034             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2035             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2036             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2037             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2038             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2039             88  CF-MP-REFD-MEAN                VALUE '8'.
  2040         16  CF-ALT-RATE-CODE               PIC  X(5).
  2041
  2042
  2043         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  37
* EL201.cbl
  2044****************************************************************
  2045*             MORTGAGE COMPANY MASTER RECORD                   *
  2046****************************************************************
  2047
  2048     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2049         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2050         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2051             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2052             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2053             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2054             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2055             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2056
  2057         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2058         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2059         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2060         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2061         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2062
  2063         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2064             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2065         16  CF-MP-RECON-USE-IND            PIC X(1).
  2066             88  CF-MP-USE-RECON             VALUE 'Y'.
  2067         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2068             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2069         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2070             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2071             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2072         16  FILLER                         PIC X(1).
  2073         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2074             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2075         16  CF-MORTG-MIB-VERSION           PIC X.
  2076             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2077             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2078             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2079         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2080             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2081                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2082             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2083                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2084             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2085                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2086             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2087                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2088             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2089                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2090             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2091                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2092         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2093         16  FILLER                         PIC X(7).
  2094         16  CF-MORTG-DESTINATION-SYMBOL.
  2095             20  CF-MORTG-MIB-COMM          PIC X(5).
  2096             20  CF-MORTG-MIB-TERM          PIC X(5).
  2097         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2098             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2099         16  FILLER                         PIC X(03).
  2100         16  CF-MP-CHECK-NO-CONTROL.
  2101             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  38
* EL201.cbl
  2102                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2103                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2104                                                ' ' LOW-VALUES.
  2105                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2106                                               VALUE '3'.
  2107         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2108         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2109         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2110             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2111                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2112             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2113                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2114             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2115                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2116             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2117                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2118             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2119                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2120             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2121                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2122         16  CF-MORTG-BILLING-AREA.
  2123             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2124                                            PIC X.
  2125         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2126         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2127         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2128         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2129             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2130             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2131         16  FILLER                         PIC X.
  2132         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2133             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2134             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2135         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2136         16  FILLER                         PIC X(8).
  2137         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2138         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2139         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2140         16  CF-ACH-COMPANY-ID.
  2141             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2142                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2143                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2144                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2145             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2146         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2147             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2148         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2149             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2150             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2151         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2152         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2153         16  FILLER                         PIC X(536).
  2154
  2155****************************************************************
  2156*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2157****************************************************************
  2158
  2159     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  39
* EL201.cbl
  2160         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2161             20  CF-FEMALE-HEIGHT.
  2162                 24  CF-FEMALE-FT           PIC 99.
  2163                 24  CF-FEMALE-IN           PIC 99.
  2164             20  CF-FEMALE-MIN-WT           PIC 999.
  2165             20  CF-FEMALE-MAX-WT           PIC 999.
  2166         16  FILLER                         PIC X(428).
  2167
  2168     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2169         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2170             20  CF-MALE-HEIGHT.
  2171                 24  CF-MALE-FT             PIC 99.
  2172                 24  CF-MALE-IN             PIC 99.
  2173             20  CF-MALE-MIN-WT             PIC 999.
  2174             20  CF-MALE-MAX-WT             PIC 999.
  2175         16  FILLER                         PIC X(428).
  2176******************************************************************
  2177*             AUTOMATIC ACTIVITY RECORD                          *
  2178******************************************************************
  2179     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2180         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2181             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2182             20  CF-SYS-LETTER-ID           PIC X(04).
  2183             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2184             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2185             20  CF-SYS-RESET-SW            PIC X(01).
  2186             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2187             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2188
  2189         16  FILLER                         PIC X(50).
  2190
  2191         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2192             20  CF-USER-ACTIVE-SW          PIC X(01).
  2193             20  CF-USER-LETTER-ID          PIC X(04).
  2194             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2195             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2196             20  CF-USER-RESET-SW           PIC X(01).
  2197             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2198             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2199             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2200
  2201         16  FILLER                         PIC X(246).
  2202 01  ws-heading1.
  2203     05  ws-head1                pic x(120)  value '
  2204-     '                                   DAILY CHECK RECONCILIATI
  2205-     'ON                                            '.
  2206     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2207 01  ws-heading2.
  2208     05  filler                  pic x(51) value spaces.
  2209     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2210     05  WS-H2-DATE              PIC X(10).
  2211     05  ws-h2-time              pic x(8).
  2212 01  ws-heading3.
  2213     05  filler                  pic x(53) value spaces.
  2214     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2215     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2216     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2217 01  ws-heading4.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  40
* EL201.cbl
  2218     05  filler                  pic x(117)   value ' CAR  GROUP
  2219-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2220-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2221 01  ws-hd1-written.
  2222     05  filler                  pic x(120)  value '
  2223-     '                                   DAILY WRITTEN CHECKS REP
  2224-     'ORT                                           '.
  2225 01  ws-hd4-written.
  2226     05  filler                  pic x(117)   value ' CAR  GROUP
  2227-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2228-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2229 01  ws-detail1.
  2230     05  filler                  pic xx value '  '.
  2231     05  ws-d1-carr              pic x(4) value spaces.
  2232     05  ws-d1-grp               pic x(7) value spaces.
  2233     05  ws-d1-state             pic x(4) value spaces.
  2234     05  ws-d1-account           pic x(12) value spaces.
  2235     05  ws-d1-eff-dt            pic x(12) value spaces.
  2236     05  ws-d1-cert-no           pic x(14) value spaces.
  2237     05  ws-d1-chk-type          pic x(5) value spaces.
  2238     05  ws-d1-chk-no            pic x(12) value spaces.
  2239     05  f                       pic xx value spaces.
  2240     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2241     05  ws-d1-preparer          pic x(8) value spaces.
  2242     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2243     05  ws-d1-chk-amt redefines
  2244         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2245     05  filler                  pic xx value spaces.
  2246     05  ws-d1-message           pic x(20) value spaces.
  2247 01  ws-detail2.
  2248     05  filler                  pic x(12) value '    PAYEE - '.
  2249     05  ws-d2-addr-line         pic x(120) value spaces.
  2250 01  ws-total1.
  2251     05  filler                  pic x(5) value '     '.
  2252     05  ws-t1-cnt               pic zzzz9  value zeros.
  2253     05  ws-t1-chks              pic x(24)  value spaces.
  2254     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2255 01  w-doctoken                  pic x(16).
  2256 01 output-data.
  2257    05  filler                   pic x(6) value "TITLE=".
  2258    05  output-title             pic x(26) value 'Check Posting'.
  2259    05  filler                   pic x(8) value "&COMPID=".
  2260    05  out-comp-id              pic xxx.
  2261    05  filler                   pic x(5) value "&MSG=".
  2262    05  output-msg               pic x(50).
  2263 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2264     'cd /apps/prod/cid1p/jcl'.
  2265*     'cd /apps/test/mdoff/jcl'.
  2266 01  TRAN-DATA-LINE2.
  2267     05  filler                  pic x(10) value 'unikixjob '.
  2268     05  tdl2-job                pic x(8) value 'cilg201b'.
  2269     05  filler                  pic x(9) value ' -k cid1p'.
  2270*    05  filler                  pic x(9) value ' -k mdoff'.
  2271     05  filler                  pic x(51) value spaces.
  2272****************************************************************
  2273*
  2274* Copyright (c) 2007 by Clerity Solutions, Inc.
  2275* All rights reserved.
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  41
* EL201.cbl
  2276*
  2277****************************************************************
  2278 01  DFHEIV.
  2279   02  DFHEIV0               PIC X(35).
  2280   02  DFHEIV1               PIC X(08).
  2281   02  DFHEIV2               PIC X(08).
  2282   02  DFHEIV3               PIC X(08).
  2283   02  DFHEIV4               PIC X(06).
  2284   02  DFHEIV5               PIC X(04).
  2285   02  DFHEIV6               PIC X(04).
  2286   02  DFHEIV7               PIC X(02).
  2287   02  DFHEIV8               PIC X(02).
  2288   02  DFHEIV9               PIC X(01).
  2289   02  DFHEIV10              PIC S9(7) COMP-3.
  2290   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2291   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2292   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2293   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2294   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2295   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2296   02  DFHEIV17              PIC X(04).
  2297   02  DFHEIV18              PIC X(04).
  2298   02  DFHEIV19              PIC X(04).
  2299   02  DFHEIV20              USAGE IS POINTER.
  2300   02  DFHEIV21              USAGE IS POINTER.
  2301   02  DFHEIV22              USAGE IS POINTER.
  2302   02  DFHEIV23              USAGE IS POINTER.
  2303   02  DFHEIV24              USAGE IS POINTER.
  2304   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2305   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2306   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2307   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2308   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2309   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2310   02  FILLER                PIC X(02).
  2311   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2312   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2313   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2314   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2315   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2316 LINKAGE  SECTION.
  2317*****************************************************************
  2318*                                                               *
  2319* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2320* All rights reserved.                                          *
  2321*                                                               *
  2322*****************************************************************
  2323 01  dfheiblk.
  2324     02  eibtime          pic s9(7) comp-3.
  2325     02  eibdate          pic s9(7) comp-3.
  2326     02  eibtrnid         pic x(4).
  2327     02  eibtaskn         pic s9(7) comp-3.
  2328     02  eibtrmid         pic x(4).
  2329     02  dfheigdi         pic s9(4) comp.
  2330     02  eibcposn         pic s9(4) comp.
  2331     02  eibcalen         pic s9(4) comp.
  2332     02  eibaid           pic x(1).
  2333     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  42
* EL201.cbl
  2334     02  eibfn            pic x(2).
  2335     02  eibfiller2       pic x(2).
  2336     02  eibrcode         pic x(6).
  2337     02  eibfiller3       pic x(2).
  2338     02  eibds            pic x(8).
  2339     02  eibreqid         pic x(8).
  2340     02  eibrsrce         pic x(8).
  2341     02  eibsync          pic x(1).
  2342     02  eibfree          pic x(1).
  2343     02  eibrecv          pic x(1).
  2344     02  eibsend          pic x(1).
  2345     02  eibatt           pic x(1).
  2346     02  eibeoc           pic x(1).
  2347     02  eibfmh           pic x(1).
  2348     02  eibcompl         pic x(1).
  2349     02  eibsig           pic x(1).
  2350     02  eibconf          pic x(1).
  2351     02  eiberr           pic x(1).
  2352     02  eibrldbk         pic x(1).
  2353     02  eiberrcd         pic x(4).
  2354     02  eibsynrb         pic x(1).
  2355     02  eibnodat         pic x(1).
  2356     02  eibfiller5       pic x(2).
  2357     02  eibresp          pic 9(09) comp.
  2358     02  eibresp2         pic 9(09) comp.
  2359     02  dfheigdj         pic s9(4) comp.
  2360     02  dfheigdk         pic s9(4) comp.
  2361 01  DFHCOMMAREA       PIC X(01).
  2362 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  2363 0000-DFHEXIT SECTION.
  2364     MOVE '9#                    $   ' TO DFHEIV0.
  2365     MOVE 'EL201' TO DFHEIV1.
  2366     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2367***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2368***                                                            ***
  2369***  Even though this program is using WEB Servies we don't    ***
  2370***  have any form fields to browse through, we are getting    ***
  2371***  the information we need through the variables that are    ***
  2372***  included in the URL. These variables are retrieved by     ***
  2373***  the           exec cics web extract                       ***
  2374***                   querystring  (data-value)                ***
  2375***                   querystrlen  (data-value)                ***
  2376***                end-exec                                    ***
  2377***  BTW, you must provide the length it isn't passed to you.  ***
  2378***  Allow for extra on the length or you will get a length    ***
  2379***  error instead of just truncation.                         ***
  2380***                                                            ***
  2381***  This program is expecting                                 ***
  2382*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2383*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2384***                                                            ***
  2385***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2386     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2387     move ws-fn-cymd             to dc-greg-date-cymd
  2388     move 'L'                    to dc-option-code
  2389     perform 9700-date-convert   thru 9700-exit
  2390     if no-conversion-error
  2391        move dc-greg-date-1-alpha to ws-h3-date
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  43
* EL201.cbl
  2392        move dc-greg-date-1-edit to ws-h2-date
  2393     else
  2394        display ' error current dt invalid ' dc-error-code
  2395     end-if
  2396     string ws-fn-hours   ':'
  2397            ws-fn-minutes ':'
  2398            ws-fn-seconds
  2399        delimited by size into ws-h2-time
  2400     end-string
  2401
  2402* exec cics web extract
  2403*       querystring  (ws-qry-string)
  2404*       querystrlen  (ws-qrystr-len)
  2405*    end-exec
  2406*    MOVE 'X0  QL                .   #00002304' TO DFHEIV0
  2407     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2408     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2409     MOVE X'2020233030303032333034' TO DFHEIV0(25:11)
  2410     CALL 'kxdfhei1' USING DFHEIV0,
  2411           DFHEIV99,
  2412           DFHEIV99,
  2413           ws-qry-string,
  2414           ws-qrystr-len,
  2415           DFHEIV99,
  2416           DFHEIV99,
  2417           DFHEIV99,
  2418           DFHEIV99,
  2419           DFHEIV99,
  2420           DFHEIV99,
  2421           DFHEIV99,
  2422           DFHEIV99,
  2423           DFHEIV99
  2424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2425     move ws-qry-string (6:3)    to ws-comp-id
  2426                                    out-comp-id
  2427     move 'Successful Run   '    to output-msg
  2428     move ws-comp-id             to elcntl-key
  2429     move '1'                    to elcntl-rec-type
  2430     move +0                     to elcntl-seq
  2431
  2432* exec cics read
  2433*       dataset  ('ELCNTL')
  2434*       into     (control-file)
  2435*       ridfld   (elcntl-key)
  2436*       resp     (ws-response)
  2437*    end-exec
  2438     MOVE LENGTH OF
  2439      control-file
  2440       TO DFHEIV11
  2441     MOVE 'ELCNTL' TO DFHEIV1
  2442*    MOVE '&"IL       E          (  N#00002314' TO DFHEIV0
  2443     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2445     MOVE X'204E233030303032333134' TO DFHEIV0(25:11)
  2446     CALL 'kxdfhei1' USING DFHEIV0,
  2447           DFHEIV1,
  2448           control-file,
  2449           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  44
* EL201.cbl
  2450           elcntl-key,
  2451           DFHEIV99,
  2452           DFHEIV99,
  2453           DFHEIV99
  2454     MOVE EIBRESP  TO ws-response
  2455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2456     if resp-normal
  2457        move cf-cl-mail-to-name  to ws-h2-client-name
  2458        move cf-company-cd       to ws-comp-cd
  2459     else
  2460        move 'Company Rec not found ' to ws-h2-client-name
  2461                                         output-msg
  2462        display ' error elcntl read ' ws-response ' '
  2463           elcntl-key (1:8)
  2464        go to 0000-return
  2465     end-if
  2466     evaluate true
  2467        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2468           set process-written      to true
  2469           perform 2000-process-written
  2470                                 thru 2000-exit
  2471        when other
  2472           move 'Invalid File ' to output-msg
  2473     end-evaluate
  2474     if connected-to-db
  2475        EXEC SQL
  2476            commit work release
  2477        END-EXEC
  2478        if sqlcode not = 0
  2479           move ' Failed to Commit DB '
  2480                                 to output-msg
  2481           display "Error: commit release "
  2482           display ' sql return code ' sqlcode
  2483           display ' sql err mess    ' sqlerrmc
  2484        end-if
  2485     end-if
  2486     .
  2487 0000-return.
  2488     perform 1030-send-form      thru 1030-exit
  2489
  2490* exec cics
  2491*       return
  2492*    end-exec
  2493*    MOVE '.(                    ''   #00002353' TO DFHEIV0
  2494     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2495     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2496     MOVE X'2020233030303032333533' TO DFHEIV0(25:11)
  2497     CALL 'kxdfhei1' USING DFHEIV0,
  2498           DFHEIV99,
  2499           DFHEIV99,
  2500           DFHEIV99,
  2501           DFHEIV99,
  2502           DFHEIV99,
  2503           DFHEIV99
  2504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2505     .
  2506 1000-CONNECT-DB.
  2507     move 'NTCSO2_ChkApprv'      to svr
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  45
* EL201.cbl
  2508     move 'sa'                   to usr
  2509     move 'ntcso2'               to pass
  2510*    move 'NTSQLTST2_ChkApprv'   to svr
  2511*    move 'sa'                   to usr
  2512*    move 'sql2008r2'            to pass
  2513     string
  2514         usr delimited space
  2515         "." delimited size
  2516         pass delimited space into usr-pass
  2517     end-string
  2518     EXEC SQL
  2519        CONNECT TO :svr USER :usr-pass
  2520     END-EXEC
  2521     if sqlcode not = 0
  2522        display "Error: cannot connect "
  2523        display sqlcode
  2524        display sqlerrmc
  2525        move 'Failed to connect to DB'
  2526                                 to output-msg
  2527        go to 0000-return
  2528     else
  2529        set connected-to-db to true
  2530     end-if
  2531     .
  2532 1000-EXIT.
  2533     EXIT.
  2534 1020-read-erchek.
  2535     move ws-comp-cd             to ch-company-cd
  2536     move db-carrier             to ch-carrier
  2537     move db-grouping            to ch-grouping
  2538     move db-state               to ch-state
  2539     move db-account             to ch-account
  2540     move db-certificate         to ch-cert-prime
  2541     move db-cert-sfx            to ch-cert-sfx
  2542     string db-effdate (1:4)
  2543            db-effdate (6:2)
  2544            db-effdate (9:2)
  2545        delimited by size into dc-greg-date-cymd-r
  2546     end-string
  2547     move 'L'                    to dc-option-code
  2548     perform 9700-date-convert   thru 9700-exit
  2549     if no-conversion-error
  2550        move dc-bin-date-1       to ch-cert-eff-dt
  2551     else
  2552        display ' error cvtdte eff dt ' db-effdate ' '
  2553           dc-error-code
  2554     end-if
  2555     move zeros                  to ws-seq-alpha
  2556     move +5                     to s2
  2557     perform varying s1 from +5 by -1 until s1 < +1
  2558        if db-seq-no (s1:1) numeric
  2559           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2560           subtract +1 from s2
  2561        end-if
  2562     end-perform
  2563     move ws-seq-no-num          to ch-sequence-no
  2564*    display ' dte   **' db-effdate '**'
  2565*    display ' carrier ' ch-carrier
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  46
* EL201.cbl
  2566*    display ' group   ' ch-grouping
  2567*    display ' state   ' ch-state
  2568*    display ' acct    ' ch-account
  2569*    display ' cert  **' ch-cert-no '**'
  2570*    display ' seq     ' ch-sequence-no
  2571
  2572* exec cics read
  2573*       update
  2574*       dataset    ('ERCHEK')
  2575*       into       (check-records)
  2576*       ridfld     (ch-control-primary)
  2577*       resp       (ws-response)
  2578*    end-exec
  2579     MOVE LENGTH OF
  2580      check-records
  2581       TO DFHEIV11
  2582     MOVE 'ERCHEK' TO DFHEIV1
  2583*    MOVE '&"IL       EU         (  N#00002422' TO DFHEIV0
  2584     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2585     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2586     MOVE X'204E233030303032343232' TO DFHEIV0(25:11)
  2587     CALL 'kxdfhei1' USING DFHEIV0,
  2588           DFHEIV1,
  2589           check-records,
  2590           DFHEIV11,
  2591           ch-control-primary,
  2592           DFHEIV99,
  2593           DFHEIV99,
  2594           DFHEIV99
  2595     MOVE EIBRESP  TO ws-response
  2596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2597     .
  2598 1020-exit.
  2599     exit.
  2600 1030-send-form.
  2601
  2602* exec cics document create
  2603*       doctoken   (w-doctoken)
  2604*       template   ('WCHECKS')
  2605*       symbollist (output-data)
  2606*       listlength (length of output-data)
  2607*    end-exec
  2608     MOVE 'WCHECKS'
  2609      TO DFHEIVL0
  2610     MOVE LENGTH OF
  2611      output-data TO DFHEIV16
  2612*    MOVE '\"D tSL               )   #00002433' TO DFHEIV0
  2613     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2614     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2615     MOVE X'2020233030303032343333' TO DFHEIV0(25:11)
  2616     CALL 'kxdfhei1' USING DFHEIV0,
  2617           w-doctoken,
  2618           DFHEIV99,
  2619           DFHEIVL0,
  2620           output-data,
  2621           DFHEIV16,
  2622           DFHEIV99,
  2623           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  47
* EL201.cbl
  2624           DFHEIV99
  2625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2626
  2627* exec cics web send
  2628*       doctoken(w-doctoken)
  2629*    end-exec
  2630*    MOVE 'X$D                   *   #00002439' TO DFHEIV0
  2631     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2632     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2633     MOVE X'2020233030303032343339' TO DFHEIV0(25:11)
  2634     CALL 'kxdfhei1' USING DFHEIV0,
  2635           w-doctoken,
  2636           DFHEIV99,
  2637           DFHEIV99,
  2638           DFHEIV99,
  2639           DFHEIV99,
  2640           DFHEIV99,
  2641           DFHEIV99,
  2642           DFHEIV99,
  2643           DFHEIV99
  2644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2645     .
  2646 1030-exit.
  2647     exit.
  2648 1050-disconnect.
  2649     if connected-to-db
  2650        EXEC SQL
  2651            disconnect all
  2652        END-EXEC
  2653        move ' ' to ws-connect-sw
  2654     end-if
  2655     .
  2656 1050-exit.
  2657     exit.
  2658 2000-process-written.
  2659     perform 2010-open-files     thru 2010-exit
  2660     perform 2020-init           thru 2020-exit
  2661     perform 2050-process-input  thru 2050-exit until
  2662        end-of-input
  2663     if ws-writ-cnt > zeros
  2664        move ws-writ-cnt         to ws-t1-cnt
  2665        move ' Written '         to ws-t1-chks
  2666        move ws-tot-writ-amt     to ws-t1-amount
  2667     else
  2668        perform 4010-write-headings
  2669                                 thru 4010-exit
  2670        move spaces              to ws-total1
  2671        string ' No checks for '
  2672           ws-writ-rpt-comp-id
  2673           ' today. ' delimited by size into ws-total1
  2674        end-string
  2675     end-if
  2676     move spaces                 to cps-written-rpt-rec
  2677     perform 4020-write-a-line   thru 4020-exit
  2678     move ws-total1              to cps-written-rpt-rec
  2679     perform 4020-write-a-line   thru 4020-exit
  2680     perform 2500-close-files    thru 2500-exit
  2681     perform 5000-submit-job     thru 5000-exit
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  48
* EL201.cbl
  2682     .
  2683 2000-exit.
  2684     exit.
  2685 2010-open-files.
  2686     move function upper-case(ws-comp-id)
  2687                                 to ws-writ-rpt-comp-id
  2688     if ws-writ-rpt-comp-id = 'AHL'
  2689        move 'miscpymtsahl.csv'  to ws-writ-in-name
  2690     end-if
  2691     open input CPS-WRITTEN-IN
  2692         output CPS-WRITTEN-RPT
  2693     if written-status not = '00'
  2694        display 'error written open ' written-status
  2695        move ' Invalid or missing file '
  2696                                 to output-msg
  2697        go to 0000-return
  2698     end-if
  2699     .
  2700 2010-exit.
  2701     exit.
  2702 2020-init.
  2703     move spaces                 to ws-detail1
  2704     move ws-hd1-written         to ws-head1
  2705     move 'EL201B'               to ws-h1-rpt-id
  2706     move ws-hd4-written         to ws-heading4
  2707     move 'Posting of Written Checks '
  2708                                 to output-title
  2709     if ws-comp-id = 'AHL'
  2710        move 'ahlg201b'          to tdl2-job
  2711     else
  2712        move 'cilg201b'          to tdl2-job
  2713     end-if
  2714     if not connected-to-db
  2715        perform 1000-connect-db  thru 1000-exit
  2716     end-if
  2717***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2718***                                                            ***
  2719**     I do 2 reads to bypass the header record                ***
  2720***                                                            ***
  2721***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2722     perform 2040-read-input     thru 2040-exit
  2723     perform 2040-read-input     thru 2040-exit
  2724     .
  2725 2020-exit.
  2726     exit.
  2727 2040-read-input.
  2728     read CPS-WRITTEN-IN at end
  2729        set end-of-input   to true
  2730     end-read
  2731     if not end-of-input
  2732        add 1 to ws-in-recs
  2733     end-if
  2734     .
  2735 2040-exit.
  2736     exit.
  2737 2050-process-input.
  2738     move spaces                 to ws-raw-record
  2739                                    ws-written-rec
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  49
* EL201.cbl
  2740     unstring cps-written-in-rec
  2741        delimited by ',' into
  2742           raw-check-no
  2743           raw-check-dt
  2744           raw-check-amt
  2745           raw-vendor-id
  2746           raw-user-defined
  2747           raw-voucher-ref
  2748     end-unstring
  2749*    display ' chk no    **' wsw-check-no '**'
  2750*    display ' chk dt    **' wsw-check-dt '**'
  2751*    display ' chk amt   **' wsw-check-amt '**'
  2752*    display ' vend id   **' wsw-vendor-id '**'
  2753*    display ' user def  **' wsw-user-defined '**'
  2754*    display ' vouch ref **' wsw-voucher-ref '**'
  2755***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2756***                                                            ***
  2757***    Every now and then I get bogus records with quotes      ***
  2758***  so I am just going to remove them.  These are normally    ***
  2759***  a result of a manual process that should not be included  ***
  2760***  in this file.                                             ***
  2761***                                                            ***
  2762***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2763
  2764     move +1                     to o1
  2765     perform varying i1 from +1 by +1 until i1 > +20
  2766        if raw-check-no (i1:1) <> '"'
  2767           move raw-check-no (i1:1)
  2768                                 to wsw-check-no (o1:1)
  2769           add +1 to o1
  2770        end-if
  2771     end-perform
  2772
  2773     move +1                     to o1
  2774     perform varying i1 from +1 by +1 until i1 > +20
  2775        if raw-check-dt (i1:1) <> '"'
  2776           move raw-check-dt (i1:1)
  2777                                 to wsw-check-dt (o1:1)
  2778           add +1 to o1
  2779        end-if
  2780     end-perform
  2781
  2782     move +1                     to o1
  2783     perform varying i1 from +1 by +1 until i1 > +15
  2784        if raw-check-amt (i1:1) <> '"'
  2785           move raw-check-amt (i1:1)
  2786                                 to wsw-check-amt (o1:1)
  2787           add +1 to o1
  2788        end-if
  2789     end-perform
  2790
  2791     move +1                     to o1
  2792     perform varying i1 from +1 by +1 until i1 > +20
  2793        if raw-vendor-id (i1:1) <> '"'
  2794           move raw-vendor-id (i1:1)
  2795                                 to wsw-vendor-id (o1:1)
  2796           add +1 to o1
  2797        end-if
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  50
* EL201.cbl
  2798     end-perform
  2799
  2800     move +1                     to o1
  2801     perform varying i1 from +1 by +1 until i1 > +30
  2802        if raw-user-defined (i1:1) <> '"'
  2803           move raw-user-defined (i1:1)
  2804                                 to wsw-user-defined (o1:1)
  2805           add +1 to o1
  2806        end-if
  2807     end-perform
  2808
  2809     move +1                     to o1
  2810     perform varying i1 from +1 by +1 until i1 > +35
  2811        if raw-voucher-ref (i1:1) <> '"'
  2812           move raw-voucher-ref (i1:1)
  2813                                 to wsw-voucher-ref (o1:1)
  2814           add +1 to o1
  2815        end-if
  2816     end-perform
  2817     if (wsw-check-no = spaces)
  2818        and (wsw-check-dt = spaces)
  2819        and (wsw-check-amt = spaces)
  2820        display ' empty record ' cps-written-in-rec
  2821        go to 2050-read
  2822     end-if
  2823     string wsw-check-dt (1:4)
  2824            wsw-check-dt (6:2)
  2825            wsw-check-dt (9:2)
  2826        delimited by size into dc-greg-date-cymd-r
  2827     end-string
  2828     move 'L'                    to dc-option-code
  2829     perform 9700-date-convert   thru 9700-exit
  2830     if no-conversion-error
  2831        move dc-bin-date-1       to ws-bin-check-dt
  2832     else
  2833        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2834           dc-error-code
  2835     end-if
  2836     perform varying s1 from +1 by +1 until
  2837        (s1 > +28)
  2838        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND' or
  2839          'CANCEL')
  2840     end-perform
  2841     if s1 < +29
  2842        move 'Bypass- Manual Entry'    to ws-d1-message
  2843        move ' '                 to ws-table-sw
  2844        go to 2050-continue
  2845     end-if
  2846*    if wsw-user-defined (1:3) not numeric
  2847*       move 'Bypass- Manual Entry'
  2848*                                to ws-d1-message
  2849*       move ' '                 to ws-table-sw
  2850*       go to 2050-continue
  2851*    end-if
  2852     perform varying s1 from +1 by +1 until
  2853        (s1 > +30)
  2854        or (wsw-user-defined (s1:1) = ' ')
  2855     end-perform
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  51
* EL201.cbl
  2856     if (s1 < +12)
  2857        and (s1 > +8)
  2858        continue
  2859     else
  2860        move 'Bypass- Manual Entry'
  2861                                 to ws-d1-message
  2862        move ' '                 to ws-table-sw
  2863        go to 2050-continue
  2864     end-if
  2865     move spaces                 to wsw-check-key
  2866     perform varying s1 from +30 by -1 until
  2867        (s1 < +1)
  2868        or (wsw-user-defined (s1:1) numeric)
  2869     end-perform
  2870     if s1 > +7
  2871        move wsw-user-defined (s1 - 6:7)
  2872                                 to wsw-check-key
  2873     else
  2874        move 'Invalid Input CK-KEY'    to ws-d1-message
  2875        go to 2050-continue
  2876     end-if
  2877*    go to 2050-read
  2878     move ' '                    to ws-erchek-sw
  2879                                    ws-table-sw
  2880     perform 2200-get-tbl-row    thru 2200-exit
  2881     if sqlcode = 0
  2882        set table-found          to true
  2883        perform 1020-read-erchek thru 1020-exit
  2884        if resp-normal
  2885           set erchek-found to true
  2886           perform 2310-upd-erchek
  2887                                 thru 2310-exit
  2888           perform 2320-upd-table thru 2320-exit
  2889        else
  2890           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2891              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2892              ' ' ws-response
  2893           move ' chk rec not found ' to ws-d1-message
  2894        end-if
  2895     else
  2896        move ' tbl row not found ' to ws-d1-message
  2897     end-if
  2898     .
  2899 2050-continue.
  2900     perform 2400-build-print-line thru 2400-exit
  2901     .
  2902 2050-read.
  2903     perform 2040-read-input     thru 2040-exit
  2904     .
  2905 2050-exit.
  2906     exit.
  2907 2200-get-tbl-row.
  2908***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2909***                                                            ***
  2910***  I'm only expecting one row so no cursor is declared       ***
  2911***                                                            ***
  2912***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2913     move ws-comp-id             to ws-compid
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  52
* EL201.cbl
  2914     move wsw-check-key-num      to ws-check-key
  2915     move 1                      to ws-type
  2916     exec sql
  2917        SELECT
  2918           CheckKey,
  2919           Company,
  2920           CertCarrier,
  2921           CertGroup,
  2922           CertState,
  2923           CertAccount,
  2924           CertEffDate,
  2925           CertNumber,
  2926           CertNumberSuf,
  2927           CheckSeqNbr,
  2928           CheckType,
  2929           CheckAmount,
  2930           Preparer
  2931        INTO
  2932           :db-checkkey,
  2933           :db-compid,
  2934           :db-carrier,
  2935           :db-grouping,
  2936           :db-state,
  2937           :db-account,
  2938           :db-effdate,
  2939           :db-certificate,
  2940           :db-cert-sfx,
  2941           :db-seq-no,
  2942           :db-type,
  2943           :db-amount,
  2944           :db-preparer
  2945        FROM
  2946           ChkApp_Check
  2947        WHERE
  2948           (CheckKey    = :ws-check-key)
  2949           and (Company = :ws-compid)
  2950     end-exec
  2951     if sqlcode not = 0
  2952        move sqlcode to ws-sql-code
  2953        move ws-sql-code to ws-dis-sql-code
  2954        display ' dis sql code ' ws-dis-sql-code
  2955        display "Error: cannot read row "
  2956        display ' sql return code ' sqlcode
  2957        display ' sql err mess    ' sqlerrmc
  2958     end-if
  2959     .
  2960 2200-exit.
  2961     exit.
  2962 2310-upd-erchek.
  2963     move ws-bin-check-dt        to ch-check-written-dt
  2964     if wsw-check-no (1:1) = '"'
  2965        move wsw-check-no (5:7)  to ch-check-no
  2966     else
  2967        move wsw-check-no (4:7)  to ch-check-no
  2968     end-if
  2969*    move zeros                  to ws-response
  2970
  2971* exec cics rewrite
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  53
* EL201.cbl
  2972*       dataset     ('ERCHEK')
  2973*       from        (check-records)
  2974*       resp        (ws-response)
  2975*    end-exec
  2976     MOVE LENGTH OF
  2977      check-records
  2978       TO DFHEIV11
  2979     MOVE 'ERCHEK' TO DFHEIV1
  2980*    MOVE '&& L                  %  N#00002767' TO DFHEIV0
  2981     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2982     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2983     MOVE X'204E233030303032373637' TO DFHEIV0(25:11)
  2984     CALL 'kxdfhei1' USING DFHEIV0,
  2985           DFHEIV1,
  2986           check-records,
  2987           DFHEIV11,
  2988           DFHEIV99
  2989     MOVE EIBRESP  TO ws-response
  2990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2991     if resp-normal
  2992        add 1 to ws-writ-cnt
  2993        compute ws-tot-writ-amt =
  2994           ws-tot-writ-amt + ch-amount-paid
  2995        move 'Successful Post '  to ws-d1-message
  2996     else
  2997        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  2998     end-if
  2999     .
  3000 2310-exit.
  3001     exit.
  3002 2320-upd-table.
  3003     string wsw-check-dt (6:2) '/'
  3004            wsw-check-dt (9:2) '/'
  3005            wsw-check-dt (1:4)
  3006        delimited by size into db-checkdate
  3007     move ch-check-no            to db-checkno
  3008*    move zeros to sqlcode
  3009     EXEC SQL
  3010        UPDATE
  3011           ChkApp_Check
  3012        SET
  3013           CheckNumber = :db-checkno,
  3014           CheckDate = :db-checkdate
  3015        WHERE
  3016           CheckKey = :db-checkkey
  3017     END-EXEC
  3018     if sqlcode not = 0
  3019        move 'Table not updated ' to ws-d1-message
  3020        display "Error: cannot update table   "
  3021        display ' sql retrun code ' sqlcode
  3022        display ' sql err mess    ' sqlerrmc
  3023     end-if
  3024     .
  3025 2320-exit.
  3026     exit.
  3027 2400-build-print-line.
  3028     if table-found
  3029        move db-carrier          to ws-d1-carr
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  54
* EL201.cbl
  3030        move db-grouping         to ws-d1-grp
  3031        move db-state            to ws-d1-state
  3032        move db-account          to ws-d1-account
  3033        string
  3034           db-effdate (6:2)   '/'
  3035           db-effdate (9:2)   '/'
  3036           db-effdate (1:4)
  3037           delimited by size into ws-d1-eff-dt
  3038        end-string
  3039        move db-certificate      to ws-d1-cert-no
  3040        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3041        move 'REF'               to ws-d1-chk-type
  3042        move +10                 to s2
  3043        move zeros               to ws-work-amt-alpha
  3044        perform varying s1 from +10 by -1 until s1 < +1
  3045           if db-amount (s1:1) numeric
  3046              move db-amount (s1:1)
  3047                                 to ws-work-amt-alpha (s2:1)
  3048              subtract +1 from s2
  3049           end-if
  3050        end-perform
  3051        move ws-work-amt-num     to ws-d1-chk-amt
  3052        move db-preparer         to ws-d1-preparer
  3053        move db-checkno          to ws-d1-chk-no
  3054        move db-checkdate        to ws-d1-writ-cash-dt
  3055     else
  3056        move wsw-check-no        to ws-d1-chk-no
  3057     end-if
  3058     perform 4000-write-report   thru 4000-exit
  3059     move spaces                 to ws-detail1
  3060     .
  3061 2400-exit.
  3062     exit.
  3063 2500-close-files.
  3064     close cps-written-in cps-written-rpt
  3065     .
  3066 2500-exit.
  3067     exit.
  3068 4000-write-report.
  3069     if ws-line-cntr > ws-max-lines
  3070        move zeros               to ws-line-cntr
  3071        perform 4010-write-headings thru 4010-exit
  3072     end-if
  3073     move ws-detail1             to cps-written-rpt-rec
  3074     perform 4020-write-a-line   thru 4020-exit
  3075     .
  3076 4000-exit.
  3077     exit.
  3078 4010-write-headings.
  3079     add 1 to ws-page-cntr
  3080     move ws-page-cntr           to ws-h3-page
  3081     move ws-heading1            to cps-written-rpt-rec
  3082     perform 4020-write-a-line   thru 4020-exit
  3083     move ws-heading2            to cps-written-rpt-rec
  3084     perform 4020-write-a-line   thru 4020-exit
  3085     move ws-heading3            to cps-written-rpt-rec
  3086     perform 4020-write-a-line   thru 4020-exit
  3087     move spaces                 to cps-written-rpt-rec
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  55
* EL201.cbl
  3088     perform 4020-write-a-line   thru 4020-exit
  3089     move spaces                 to cps-written-rpt-rec
  3090     perform 4020-write-a-line   thru 4020-exit
  3091     move ws-heading4            to cps-written-rpt-rec
  3092     perform 4020-write-a-line   thru 4020-exit
  3093     move spaces                 to cps-written-rpt-rec
  3094     perform 4020-write-a-line   thru 4020-exit
  3095     .
  3096 4010-exit.
  3097     exit.
  3098 4020-write-a-line.
  3099     write cps-written-rpt-rec
  3100     add 1 to ws-line-cntr
  3101     .
  3102 4020-exit.
  3103     exit.
  3104 5000-submit-job.
  3105
  3106* EXEC CICS WRITEQ TD
  3107*       QUEUE ('BTCH')
  3108*       FROM (TRAN-DATA-LINE1)
  3109*       LENGTH (80)
  3110*    END-EXEC
  3111     MOVE 80
  3112       TO DFHEIV11
  3113     MOVE 'BTCH' TO DFHEIV5
  3114*    MOVE '(" L                  &   #00002886' TO DFHEIV0
  3115     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3116     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3117     MOVE X'2020233030303032383836' TO DFHEIV0(25:11)
  3118     CALL 'kxdfhei1' USING DFHEIV0,
  3119           DFHEIV5,
  3120           TRAN-DATA-LINE1,
  3121           DFHEIV11,
  3122           DFHEIV99,
  3123           DFHEIV99
  3124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3125
  3126* EXEC CICS WRITEQ TD
  3127*       QUEUE ('BTCH')
  3128*       FROM (TRAN-DATA-LINE2)
  3129*       LENGTH (80)
  3130*    END-EXEC
  3131     MOVE 80
  3132       TO DFHEIV11
  3133     MOVE 'BTCH' TO DFHEIV5
  3134*    MOVE '(" L                  &   #00002891' TO DFHEIV0
  3135     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3136     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3137     MOVE X'2020233030303032383931' TO DFHEIV0(25:11)
  3138     CALL 'kxdfhei1' USING DFHEIV0,
  3139           DFHEIV5,
  3140           TRAN-DATA-LINE2,
  3141           DFHEIV11,
  3142           DFHEIV99,
  3143           DFHEIV99
  3144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3145     .
* Micro Focus Server Express         V5.1 revision 000 22-Sep-15 15:53 Page  56
* EL201.cbl
  3146 5000-exit.
  3147     exit.
  3148 9700-DATE-CONVERT.
  3149
  3150* EXEC CICS LINK
  3151*         PROGRAM  ('ELDATCV')
  3152*         COMMAREA (DATE-CONVERSION-DATA)
  3153*         LENGTH   (DC-COMM-LENGTH)
  3154*    END-EXEC.
  3155     MOVE 'ELDATCV' TO DFHEIV1
  3156*    MOVE '."C                   (   #00002900' TO DFHEIV0
  3157     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3159     MOVE X'2020233030303032393030' TO DFHEIV0(25:11)
  3160     CALL 'kxdfhei1' USING DFHEIV0,
  3161           DFHEIV1,
  3162           DATE-CONVERSION-DATA,
  3163           DC-COMM-LENGTH,
  3164           DFHEIV99,
  3165           DFHEIV99,
  3166           DFHEIV99,
  3167           DFHEIV99
  3168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3169
  3170 9700-EXIT.
  3171      EXIT.
  3172
  3173 9999-DFHBACK SECTION.
  3174     MOVE '9%                    "   ' TO DFHEIV0
  3175     MOVE 'EL201' TO DFHEIV1
  3176     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3177     GOBACK.
  3178 9999-DFHEXIT.
  3179     IF DFHEIGDJ EQUAL 0001
  3180         NEXT SENTENCE.
  3181     MOVE '9%                    "   ' TO DFHEIV0
  3182     MOVE 'EL201' TO DFHEIV1
  3183     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3184     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      139428     Code:        9184
