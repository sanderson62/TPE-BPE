* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.   NSRASBL.
     4*AUTHOR.     PABLO
     5*            COLLEYVILLE, TEXAS.
     6*REMARKS.    EXECUTED FROM NSRASLTR
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   2
* NSRASBL.cbl
    14*-----------------------------------------------------------------
    15* 060611    2011022800001  PEMA  NEW PROGRAM
    16* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    17* 071212    2011022800001  AJRA  ADD UNDW ID
    18* 072312    2011022800001  AJRA    ADD NEW FIELDS
    19* 090612  IR2012090600001  AJRA  NAPERSOFT
    20* 091112  IR2012091100002  AJRA  FIX AKA
    21* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    22* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    23* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    24* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    25* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    26* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    27* 110612    2012101700002  AJRA  ADD NEW FIELDS
    28* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    29* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    30* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    31* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    32* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    33* 011314  IR2014011300001  AJRA  FIX NEXT BUS DT AND ENDORSEMENT A
    34* 011514    2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    35* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    36* 121015  CR2015100900001  TANA  ADD VIN NUMBER
    37******************************************************************
    38 ENVIRONMENT DIVISION.
    39 DATA DIVISION.
    40 working-storage section.
    41 01  DFH-START PIC X(04).
    42 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    43 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    44 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    45 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    46 77  SAVE-NEXT-BUS-DT-EDIT-A     PIC X(10)   VALUE SPACES.
    47 77  SAVE-CYCLE-DAY-OF-WEEK      PIC S9   COMP-3 VALUE +0.
    48 77  S1                          PIC S999 COMP-3 VALUE +0.
    49 77  E1                          PIC S999 COMP-3 VALUE +0.
    50 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    51 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    52 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    53 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    54 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    55 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    56 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    57 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    58 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    59 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    60 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    61 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    62     88  FOUND-BENE                  VALUE 'Y'.
    63 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    64 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    65 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    66 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    67     88  END-OF-ERPNDB              VALUE 'Y'.
    68 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    69     88  ACCT-FOUND                 VALUE 'Y'.
    70 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    71     88  CERT-FOUND                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   3
* NSRASBL.cbl
    72     88  CERT-NOT-FOUND             VALUE 'N'.
    73 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    74     88  ENDT-FOUND                 VALUE 'Y'.
    75     88  ENDT-NOT-FOUND             VALUE 'N'.
    76 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    77     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    78 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    79 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    80 77  WS-LF-EARN                  PIC X     VALUE ' '.
    81 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    82 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    83 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    84 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    85 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    86 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    87 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    88 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    89 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    90 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    91 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    92 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    93 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    95 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    96 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    98 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    99     88  PROCESS-ISSUE               VALUE 'I'.
   100     88  PROCESS-CANCEL              VALUE 'C'.
   101 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
   102 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
   103 77  WS-DIFF                     PIC 999 VALUE ZEROS.
   104 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
   105 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
   106 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   107 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   108 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
*  109 EXEC SQL
*  110    INCLUDE SQLDA
*  111 END-EXEC
   112 01 SQLDA sync.
   113    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   114    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   115    05 SQLN                  PIC S9(4) COMP-5 value 0.
   116    05 SQLD                  PIC S9(4) COMP-5 value 0.
   117    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   118       10 SQLTYPE            PIC S9(4) COMP-5.
   119       10 SQLLEN             PIC S9(4) COMP-5.
   120$IF P64 SET
   121X      *> For 64-bit environments, ensure that SQLDATA is
   122X      *> aligned on an 8-byte boundary.
   123X      10 FILLER             PIC S9(9) COMP-5.
   124$END
   125       10 SQLDATA            USAGE POINTER.
   126       10 SQLIND             USAGE POINTER.
   127       10 SQLNAME.
   128          15 SQLNAMEL        PIC S9(4) COMP-5.
   129          15 SQLNAMEC        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   4
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130
   131* Values for SQLTYPE
   132
   133 78  ESQL-DATE-CHAR              VALUE 384.
   134 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   135 78  ESQL-DATE-REC               VALUE 386.
   136 78  ESQL-DATE-REC-NULL          VALUE 387.
   137 78  ESQL-TIME-CHAR              VALUE 388.
   138 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   139 78  ESQL-TIME-REC               VALUE 390.
   140 78  ESQL-TIME-REC-NULL          VALUE 391.
   141 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   142 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   143 78  ESQL-TIMESTAMP-REC          VALUE 394.
   144 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   145 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   146 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   147 78  ESQL-TS-OFFSET-REC          VALUE 398.
   148 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   149 78  ESQL-LONGVARBINARY          VALUE 404.
   150 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   151 78  ESQL-LONGVARCHAR            VALUE 408.
   152 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   153 78  ESQL-BINARY                 VALUE 444.
   154 78  ESQL-BINARY-NULL            VALUE 445.
   155 78  ESQL-VARBINARY              VALUE 446.
   156 78  ESQL-VARBINARY-NULL         VALUE 447.
   157 78  ESQL-VARCHAR                VALUE 448.
   158 78  ESQL-VARCHAR-NULL           VALUE 449.
   159
   160 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   161 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   162
   163 78  ESQL-CHAR                   VALUE 452.
   164 78  ESQL-CHAR-NULL              VALUE 453.
   165
   166 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   167 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   168
   169 78  ESQL-DOUBLE                 VALUE 480.
   170 78  ESQL-DOUBLE-NULL            VALUE 481.
   171 78  ESQL-REAL                   VALUE 482.
   172 78  ESQL-REAL-NULL              VALUE 483.
   173 78  ESQL-DECIMAL                VALUE 484.
   174 78  ESQL-DECIMAL-NULL           VALUE 485.
   175 78  ESQL-INTEGER                VALUE 496.
   176 78  ESQL-INTEGER-NULL           VALUE 497.
   177 78  ESQL-SMALLINT               VALUE 500.
   178 78  ESQL-SMALLINT-NULL          VALUE 501.
   179 78  ESQL-TINYINT                VALUE 502.
   180 78  ESQL-TINYINT-NULL           VALUE 503.
   181
*  182 EXEC SQL
*  183    INCLUDE SQLCA
*  184 END-EXEC
   185 01 SQLCA.
   186     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   187     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   5
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   189     05  SQLERRM.
   190         49  SQLERRML    PIC S9(4) COMP-5.
   191         49  SQLERRMC    PIC X(70).
   192     05  SQLERRP         PIC X(8).
   193     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   194     05  SQLWARN.
   195         10  SQLWARN0    PIC X.
   196         10  SQLWARN1    PIC X.
   197         10  SQLWARN2    PIC X.
   198         10  SQLWARN3    PIC X.
   199         10  SQLWARN4    PIC X.
   200         10  SQLWARN5    PIC X.
   201         10  SQLWARN6    PIC X.
   202         10  SQLWARN7    PIC X.
   203     05  SQLEXT.
   204         10  SQLWARN8    PIC X.
   205         10  SQLWARN9    PIC X.
   206         10  SQLWARN10   PIC X.
   207         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   208     05  SQLSTATE    PIC X(5).
   209
   210 EXEC SQL
   211    BEGIN DECLARE SECTION
   212 END-EXEC
   213
   214 01  SQLCMD                      PIC X(1024).
   215 01  SVR                         PIC X(32).
   216 01  USR                         PIC X(32).
   217 01  PASS                        PIC X(32).
   218 01  USR-PASS                    PIC X(64).
   219
   220 01  WS-SQL-DATA.
   221     05  WS-CYCLE-DATE           PIC X(10).
   222     05  WS-NEXT-BUS-DT          PIC X(10).
   223
   224 EXEC SQL
   225    END DECLARE SECTION
   226 END-EXEC
   227
   228
   229 01  P pointer.
   230 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   231 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   232 01  var-ptr pointer.
   233 01  env-var-len                 pic 9(4)  binary.
   234 01  rc                          pic 9(9)  binary.
   235
   236 01  WS-KIXHOST                  PIC X(10).
   237 01  WS-KIXSYS.
   238     05  WS-KIX-FIL1             PIC X(10).
   239     05  WS-KIX-APPS             PIC X(10).
   240     05  WS-KIX-ENV              PIC X(10).
   241     05  WS-KIX-MYENV            PIC X(10).
   242     05  WS-KIX-SYS              PIC X(10).
   243
   244 01  WS-CALC-FIELDS.
   245     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   6
* NSRASBL.cbl
   246     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   247     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   248     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   249     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   250     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   251     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   252     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   253     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   254     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   255     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   256     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   257     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   258     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   259     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   260     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   261     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   262     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   263     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   264     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   265     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   266     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   267     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   268     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   269     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   270     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   271     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   272     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   273     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   274     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   275     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   276     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   277     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   278     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   279     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   280     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   281     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   282     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   283     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   284     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   285     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   286     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   287 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   288 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   289 01 response-code         pic s9(8) comp.
   290 01 display-response      pic 9(8).
   291 01 bl-index              pic 9(8) comp.
   292 01 max-last-name         pic x(18).
   293 01 first-initial         pic x.
   294 01 name-in-range-flag    pic 9.
   295 01 max-entries           pic s9(8) comp value 100.
   296 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   297 01 lower-case    pic x(26) value
   298            "abcdefghijklmnopqrstuvwxyz".
   299 01 upper-case    pic x(26) value
   300            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   301
   302*                                COPY ELCVADS.
   303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   7
* NSRASBL.cbl
   304*                                                                *
   305*                                                                *
   306*                            ELCVADS.                            *
   307*                                                                *
   308*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   309*   ELVADS                  LENGTH = 350                         *
   310******************************************************************
   311******************************************************************
   312*                   C H A N G E   L O G
   313*
   314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   315*-----------------------------------------------------------------
   316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   317* EFFECTIVE    NUMBER
   318*-----------------------------------------------------------------
   319* 100111    2011022800001  AJRA  NAPERSOFT
   320******************************************************************
   321
   322 01  VIRGINIA-DISCLOSURE.
   323     12  VD-COMPANY-CD              PIC X.
   324     12  VD-CARRIER                 PIC X.
   325     12  VD-GROUPING.
   326         20  VD-GROUPING-PREFIX     PIC XXX.
   327         20  VD-GROUPING-PRIME      PIC XXX.
   328     12  VD-STATE                   PIC XX.
   329     12  VD-ACCOUNT.
   330         20  VD-ACCOUNT-PREFIX      PIC X(4).
   331         20  VD-ACCOUNT-PRIME       PIC X(6).
   332     12  VD-CERT-EFF-DT             PIC XX.
   333     12  VD-CERT-NO.
   334         20  VD-CERT-PRIME          PIC X(10).
   335         20  VD-CERT-SFX            PIC X.
   336     12  VD-ENTRY-BATCH             PIC X(6).
   337     12  VD-CSR-ID                  PIC X(4).
   338     12  VD-NAME.
   339         20  VD-INSURED-LAST-NAME   PIC X(15).
   340         20  VD-INSURED-FIRST-NAME.
   341             24  VD-INSURED-1ST-INIT PIC X.
   342             24  FILLER             PIC X(9).
   343         20  VD-INSURED-MIDDLE-INIT PIC X.
   344     12  VD-JOINT-INSURED.
   345         20 VD-JOINT-LAST-NAME      PIC X(15).
   346         20 VD-JOINT-FIRST-NAME.
   347            24  VD-JOINT-FIRST-INIT PIC X.
   348            24  FILLER              PIC X(9).
   349         20 VD-JOINT-MIDDLE-INIT    PIC X.
   350     12  VD-INSURED-ADDRESS-1       PIC X(30).
   351     12  VD-INSURED-ADDRESS-2       PIC X(30).
   352     12  VD-INSURED-CITY-STATE.
   353         20  VD-INSURED-CITY        PIC X(28).
   354         20  VD-INSURED-STATE       PIC XX.
   355     12  VD-INSURED-ZIP-CODE.
   356         20  VD-INSURED-ZIP-PRIME.
   357             24  VD-INSURED-ZIP-1   PIC X.
   358                 88  VD-CANADIAN-POST-CODE
   359                                       VALUE 'A' THRU 'Z'.
   360             24  FILLER             PIC X(4).
   361         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   8
* NSRASBL.cbl
   362     12  VD-BENEFICIARY-NAME        PIC X(30).
   363     12  VD-ACCOUNT-NAME            PIC X(30).
   364     12  VD-LOAN-TERM               PIC S999   COMP-3.
   365     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   366     12  VD-1ST-PMT-DT              PIC XX.
   367     12  VD-LIFE-BENEFIT-CD         PIC XX.
   368         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   369         88  VD-INVALID-LIFE           VALUE '  ' '00'
   370                                             '90' THRU '99'.
   371     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   372                                    PIC XX.
   373     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   374     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   375     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   376     12  VD-LF-TERM                 PIC S999   COMP-3.
   377     12  VD-AH-BENEFIT-CD           PIC XX.
   378         88  VD-VALID-AH               VALUE '01' THRU '89'.
   379         88  VD-INVALID-AH             VALUE '  ' '00'
   380                                             '90' THRU '99'.
   381     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   382     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   383     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   384     12  VD-AH-TERM                 PIC S999   COMP-3.
   385     12  VD-LETTER-ID               PIC X(4).
   386     12  VD-PROC-ID                 PIC X(4).
   387     12  VD-COMP-ID                 PIC X(3).
   388     12  VD-CURRENT-DATE            PIC XX.
   389     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   390     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   391     12  FILLER                     PIC X(32).
   392 01  WS-PASS-AREA.
   393     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   394     05  WS-PASS-VADS-REC    PIC X(350).
   395
   396*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   397*                         COPY ELCZREC.
   398******************************************************************
   399*                                                                *
   400*                                                                *
   401*                            ELCZREC.                            *
   402*                                                                *
   403*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   404*                                                                *
   405******************************************************************
   406*-----------------------------------------------------------------
   407*                   C H A N G E   L O G
   408*
   409* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   410*-----------------------------------------------------------------
   411*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   412* EFFECTIVE    NUMBER
   413*-----------------------------------------------------------------
   414* 122011    2011022800001  AJRA  NEW FILE
   415* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   416* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   417* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   418* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   419*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page   9
* NSRASBL.cbl
   420 01  W-Z-CONTROL-DATA.
   421     05  W-NUMBER-OF-COPIES      PIC  9.
   422     05  FILLER                  PIC  X.
   423     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   424     05  FILLER                  PIC  X.
   425     05  W-DAYS-TO-RESEND        PIC  999.
   426     05  FILLER                  PIC  X.
   427     05  W-FORM-TO-RESEND        PIC  X(4).
   428     05  W-ADD-BAR-CODE          PIC  X.
   429     05  W-PROMPT-LETTER         PIC  X.
   430     05  W-HAS-RETURN-ENV        PIC  X.
   431     05  W-ENCLOSURE-CD          PIC  XXX.
   432     05  W-SIG-FLAG-DEFAULT      PIC  X.
   433     05  W-AUTO-CLOSE-IND        PIC  X.
   434     05  FILLER                  PIC  X.
   435     05  W-LETTER-TO-BENE        PIC  X.
   436     05  FILLER                  PIC  X.
   437     05  W-LETTER-TO-ACCT        PIC  X.
   438     05  FILLER                  PIC  X.
   439     05  W-LETTER-TYPE           PIC  X.
   440     05  FILLER                  PIC  X.
   441     05  W-PRINT-CERTIFICATE     PIC  X.
   442     05  FILLER                  PIC  X.
   443     05  W-REFUND-REQUIRED       PIC  X.
   444     05  FILLER                  PIC  X.
   445     05  W-ONBASE-CODE           PIC  XX.
   446     05  FILLER                  PIC  X.
   447     05  W-ACCT-SUMM             PIC  X.
   448     05  FILLER                  PIC  X.
   449     05  W-CSO-SUMM              PIC  X.
   450     05  FILLER                  PIC  X.
   451     05  W-REASONS-REQUIRED      PIC  X.
   452     05  FILLER                  PIC  X(29).
   453 01  MISC.
   454     12  WS-RESPONSE             PIC S9(8)   COMP.
   455         88  RESP-NORMAL                  VALUE +00.
   456         88  RESP-NOTFND                  VALUE +13.
   457         88  RESP-DUPREC                  VALUE +14.
   458         88  RESP-DUPKEY                  VALUE +15.
   459         88  RESP-NOTOPEN                 VALUE +19.
   460         88  RESP-ENDFILE                 VALUE +20.
   461
   462     12  WS-EDIT-A-DATE.
   463         16  WS-EDIT-A-MM                 PIC X(2).
   464         16  FILLER                       PIC X(1).
   465         16  WS-EDIT-A-DD                 PIC X(2).
   466         16  FILLER                       PIC X(1).
   467         16  WS-EDIT-A-CCYY.
   468             20  WS-EDIT-A-CC             PIC X(2).
   469             20  WS-EDIT-A-YY             PIC X(2).
   470 01  srch-commarea.
   471*                                copy ELCADLTRSPI.
   472******************************************************************
   473*                   C H A N G E   L O G
   474*
   475* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   476*-----------------------------------------------------------------
   477*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  10
* NSRASBL.cbl
   478* EFFECTIVE    NUMBER
   479*-----------------------------------------------------------------
   480* 060611    2011022800001  PEMA  NEW COPYBOOK
   481* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   482* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   483******************************************************************
   484****************************************
   485*  commarea for NaperSoft On Demand Admin services letters
   486*  (business logic input & output)
   487****************************************
   488     03  BL-INPUT.
   489         05  BL-DATA-SRCE        PIC X.
   490         05  BL-LETTER-ID        PIC XXXX.
   491         05  BL-CARRIER          PIC X.
   492         05  BL-GROUP            PIC X(6).
   493         05  BL-STATE            PIC XX.
   494         05  BL-ACCOUNT          PIC X(10).
   495         05  BL-EFF-DT           PIC X(10).
   496         05  BL-CERT-NO          PIC X(11).
   497         05  BL-BATCH-NO         PIC X(6).
   498         05  BL-BATCH-SEQ        PIC 9(8).
   499         05  BL-RESP-NO          PIC X(10).
   500         05  BL-NO-OF-COPIES     PIC 99.
   501         05  BL-PROC-ID          PIC XXXX.
   502         05  BL-COMP-ID          PIC XXX.
   503         05  BL-PRINT-NOW-SW     PIC X.
   504         05  BL-ENC-CD           PIC XXX.
   505         05  BL-RESEND-DT        PIC X(10).
   506         05  BL-FOLLOW-UP-DT     PIC X(10).
   507         05  BL-ARCHIVE-NO       PIC 9(8).
   508         05  BL-FUNC             PIC X(8).
   509         05  BL-COMMENTS         PIC X(100).
   510         05  FILLER REDEFINES BL-COMMENTS.
   511             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   512             10  BL-LETTER-TO-ACCT PIC X.
   513             10  BL-LETTER-TO-BENE PIC X.
   514             10  BL-WRITE-ERARCH   PIC X.
   515                 88  ERARCH-QWS      VALUE 'Q'.
   516                 88  ERARCH-BATCH    VALUE 'B'.
   517                 88  ERARCH-TEMP     VALUE 'T'.
   518             10  BL-PROCESS-TYPE PIC X(07).
   519             10  BL-CERT-FORM-ID PIC X(05).
   520             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   521             10  BL-SOURCE-SCREEN PIC X(8).
   522             10  FILLER          PIC X(25).
   523     03  BL-OUTPUT.
   524         05  BL-STATUS                   PIC X.
   525             88  BL-OK                      VALUE "P".
   526             88  BL-FAIL                  VALUE "F".
   527         05  BL-MESSAGE          PIC X(50).
   528     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   529     03  FILLER                  PIC X(31).
   530 01  filler                      pic x(500).
   531 01  WS-SAVE-CARRIER-INFO.
   532     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   533     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   534     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   535     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  11
* NSRASBL.cbl
   536     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   537     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   538     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   539     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   540 01  WS-SAVE-STATE-INFO.
   541     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   542     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   543 01  WS-SAVE-LFBEN-INFO.
   544     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   545     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   546     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   547 01  WS-SAVE-AHBEN-INFO.
   548     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   549     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   550     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   551     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   552 01  WS-ERPNDB-KEY.
   553     05  WS-ERPNDB-COMPANY-CD    PIC X.
   554     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   555     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   556     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   557 01  WS-ELENCC-KEY.
   558     05  WS-ELENCC-COMPANY-CD    PIC X.
   559     05  WS-ELENCC-REC-TYPE      PIC X.
   560     05  WS-ELENCC-ENC-CODE      PIC X(5).
   561     05  F                       PIC X(9).
   562 01  WS-ELCERT-KEY.
   563     05  WS-ELCERT-COMPANY-CD    PIC X.
   564     05  WS-ELCERT-CARRIER       PIC X.
   565     05  WS-ELCERT-GROUP         PIC X(6).
   566     05  WS-ELCERT-STATE         PIC XX.
   567     05  WS-ELCERT-ACCOUNT       PIC X(10).
   568     05  WS-ELCERT-EFF-DT        PIC XX.
   569     05  WS-ELCERT-CERT-NO       PIC X(11).
   570 01  WS-ELCRTT-KEY.
   571     05  WS-ELCRTT-PRIMARY       PIC X(33).
   572     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   573
   574 01  WS-ERENDT-KEY.
   575     05  WS-ERENDT-COMPANY-CD    PIC X.
   576     05  WS-ERENDT-CARRIER       PIC X.
   577     05  WS-ERENDT-GROUP         PIC X(6).
   578     05  WS-ERENDT-STATE         PIC XX.
   579     05  WS-ERENDT-ACCOUNT       PIC X(10).
   580     05  WS-ERENDT-EFF-DT        PIC XX.
   581     05  WS-ERENDT-CERT-NO       PIC X(11).
   582     05  WS-ERENDT-REC-TYPE      PIC X.
   583     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   584
   585 01  WS-ERENDT-KEY-BY-ARCH.
   586     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   587     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   588 01  WS-ERCOMP-KEY.
   589     05  WS-ERCOMP-COMPANY-CD    PIC X.
   590     05  WS-ERCOMP-CARRIER       PIC X.
   591     05  WS-ERCOMP-GROUP         PIC X(6).
   592     05  WS-ERCOMP-RESP-NO       PIC X(10).
   593     05  WS-ERCOMP-ACCOUNT       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  12
* NSRASBL.cbl
   594     05  WS-ERCOMP-REC-TYPE      PIC X.
   595 01  WS-ERMAIL-KEY.
   596     05  WS-ERMAIL-COMPANY-CD    PIC X.
   597     05  WS-ERMAIL-CARRIER       PIC X.
   598     05  WS-ERMAIL-GROUP         PIC X(6).
   599     05  WS-ERMAIL-STATE         PIC XX.
   600     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   601     05  WS-ERMAIL-EFF-DT        PIC XX.
   602     05  WS-ERMAIL-CERT-NO       PIC X(11).
   603 01  WS-ERACCT-KEY.
   604     05  WS-ERACCT-COMPANY-CD    PIC X.
   605     05  WS-ERACCT-CARRIER       PIC X.
   606     05  WS-ERACCT-GROUP         PIC X(6).
   607     05  WS-ERACCT-STATE         PIC XX.
   608     05  WS-ERACCT-ACCOUNT       PIC X(10).
   609     05  WS-ERACCT-EXP-DT        PIC XX.
   610     05  FILLER                  PIC XXXX.
   611 01  WS-ELLETR-KEY.
   612     05  WS-ELLETR-COMPANY-CD    PIC X.
   613     05  WS-ELLETR-LETTER-ID     PIC X(12).
   614     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   615 01  WS-ELCNTL-KEY.
   616     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   617     05  WS-ELCNTL-REC-TYPE      PIC X.
   618     05  WS-ELCNTL-GENL.
   619         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   620         10  WS-ELCNTL-BEN-CD.
   621             15  F               PIC X.
   622             15  WS-ELCNTL-CARR  PIC X.
   623     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   624*                                COPY ELCDATE.
   625******************************************************************
   626*                                                                *
   627*                                                                *
   628*                            ELCDATE.                            *
   629*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   630*                            VMOD=2.003
   631*                                                                *
   632*                                                                *
   633*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   634*                 LENGTH = 200                                   *
   635******************************************************************
   636
   637 01  DATE-CONVERSION-DATA.
   638     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   639     12  DC-OPTION-CODE                PIC X.
   640         88  BIN-TO-GREG                VALUE ' '.
   641         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   642         88  EDIT-GREG-TO-BIN           VALUE '2'.
   643         88  YMD-GREG-TO-BIN            VALUE '3'.
   644         88  MDY-GREG-TO-BIN            VALUE '4'.
   645         88  JULIAN-TO-BIN              VALUE '5'.
   646         88  BIN-PLUS-ELAPSED           VALUE '6'.
   647         88  FIND-CENTURY               VALUE '7'.
   648         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   649         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   650         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   651         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  13
* NSRASBL.cbl
   652         88  JULIAN-TO-BIN-3            VALUE 'C'.
   653         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   654         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   655         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   656         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   657         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   658         88  CHECK-LEAP-YEAR            VALUE 'H'.
   659         88  BIN-3-TO-GREG              VALUE 'I'.
   660         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   661         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   662         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   663         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   664         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   665         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   666         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   667         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   668         88  THREE-CHARACTER-BIN
   669                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   670         88  GREGORIAN-TO-BIN
   671                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   672         88  BIN-TO-GREGORIAN
   673                  VALUES ' ' '1' 'I' '8' 'G'.
   674         88  JULIAN-TO-BINARY
   675                  VALUES '5' 'C' 'E' 'F'.
   676     12  DC-ERROR-CODE                 PIC X.
   677         88  NO-CONVERSION-ERROR        VALUE ' '.
   678         88  DATE-CONVERSION-ERROR
   679                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   680         88  DATE-IS-ZERO               VALUE '1'.
   681         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   682         88  DATE-IS-INVALID            VALUE '3'.
   683         88  DATE1-GREATER-DATE2        VALUE '4'.
   684         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   685         88  DATE-INVALID-OPTION        VALUE '9'.
   686         88  INVALID-CENTURY            VALUE 'A'.
   687         88  ONLY-CENTURY               VALUE 'B'.
   688         88  ONLY-LEAP-YEAR             VALUE 'C'.
   689         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   690     12  DC-END-OF-MONTH               PIC X.
   691         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   692     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   693         88  USE-NORMAL-PROCESS         VALUE ' '.
   694         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   695         88  ADJUST-UP-100-YRS          VALUE '2'.
   696     12  FILLER                        PIC X.
   697     12  DC-CONVERSION-DATES.
   698         16  DC-BIN-DATE-1             PIC XX.
   699         16  DC-BIN-DATE-2             PIC XX.
   700         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   701         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   702                       DC-GREG-DATE-1-EDIT.
   703             20  DC-EDIT1-MONTH        PIC 99.
   704             20  SLASH1-1              PIC X.
   705             20  DC-EDIT1-DAY          PIC 99.
   706             20  SLASH1-2              PIC X.
   707             20  DC-EDIT1-YEAR         PIC 99.
   708         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   709         16  DC-GREG-DATE-2-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  14
* NSRASBL.cbl
   710                     DC-GREG-DATE-2-EDIT.
   711             20  DC-EDIT2-MONTH        PIC 99.
   712             20  SLASH2-1              PIC X.
   713             20  DC-EDIT2-DAY          PIC 99.
   714             20  SLASH2-2              PIC X.
   715             20  DC-EDIT2-YEAR         PIC 99.
   716         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   717         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   718                     DC-GREG-DATE-1-YMD.
   719             20  DC-YMD-YEAR           PIC 99.
   720             20  DC-YMD-MONTH          PIC 99.
   721             20  DC-YMD-DAY            PIC 99.
   722         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   723         16  DC-GREG-DATE-1-MDY-R REDEFINES
   724                      DC-GREG-DATE-1-MDY.
   725             20  DC-MDY-MONTH          PIC 99.
   726             20  DC-MDY-DAY            PIC 99.
   727             20  DC-MDY-YEAR           PIC 99.
   728         16  DC-GREG-DATE-1-ALPHA.
   729             20  DC-ALPHA-MONTH        PIC X(10).
   730             20  DC-ALPHA-DAY          PIC 99.
   731             20  FILLER                PIC XX.
   732             20  DC-ALPHA-CENTURY.
   733                 24 DC-ALPHA-CEN-N     PIC 99.
   734             20  DC-ALPHA-YEAR         PIC 99.
   735         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   736         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   737         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   738         16  DC-JULIAN-DATE            PIC 9(05).
   739         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   740                                       PIC 9(05).
   741         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   742             20  DC-JULIAN-YEAR        PIC 99.
   743             20  DC-JULIAN-DAYS        PIC 999.
   744         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   745         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   746         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   747     12  DATE-CONVERSION-VARIBLES.
   748         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   749         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   750             20  FILLER                PIC 9(3).
   751             20  HOLD-CEN-1-CCYY.
   752                 24  HOLD-CEN-1-CC     PIC 99.
   753                 24  HOLD-CEN-1-YY     PIC 99.
   754             20  HOLD-CEN-1-MO         PIC 99.
   755             20  HOLD-CEN-1-DA         PIC 99.
   756         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   757             20  HOLD-CEN-1-R-MO       PIC 99.
   758             20  HOLD-CEN-1-R-DA       PIC 99.
   759             20  HOLD-CEN-1-R-CCYY.
   760                 24  HOLD-CEN-1-R-CC   PIC 99.
   761                 24  HOLD-CEN-1-R-YY   PIC 99.
   762             20  FILLER                PIC 9(3).
   763         16  HOLD-CENTURY-1-X.
   764             20  FILLER                PIC X(3)  VALUE SPACES.
   765             20  HOLD-CEN-1-X-CCYY.
   766                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   767                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  15
* NSRASBL.cbl
   768             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   769             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   770         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   771             20  HOLD-CEN-1-R-X-MO     PIC XX.
   772             20  HOLD-CEN-1-R-X-DA     PIC XX.
   773             20  HOLD-CEN-1-R-X-CCYY.
   774                 24  HOLD-CEN-1-R-X-CC PIC XX.
   775                 24  HOLD-CEN-1-R-X-YY PIC XX.
   776             20  FILLER                PIC XXX.
   777         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   778         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   779         16  DC-JULIAN-DATE-1          PIC 9(07).
   780         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   781             20  DC-JULIAN-1-CCYY.
   782                 24  DC-JULIAN-1-CC    PIC 99.
   783                 24  DC-JULIAN-1-YR    PIC 99.
   784             20  DC-JULIAN-DA-1        PIC 999.
   785         16  DC-JULIAN-DATE-2          PIC 9(07).
   786         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   787             20  DC-JULIAN-2-CCYY.
   788                 24  DC-JULIAN-2-CC    PIC 99.
   789                 24  DC-JULIAN-2-YR    PIC 99.
   790             20  DC-JULIAN-DA-2        PIC 999.
   791         16  DC-GREG-DATE-A-EDIT.
   792             20  DC-EDITA-MONTH        PIC 99.
   793             20  SLASHA-1              PIC X VALUE '/'.
   794             20  DC-EDITA-DAY          PIC 99.
   795             20  SLASHA-2              PIC X VALUE '/'.
   796             20  DC-EDITA-CCYY.
   797                 24  DC-EDITA-CENT     PIC 99.
   798                 24  DC-EDITA-YEAR     PIC 99.
   799         16  DC-GREG-DATE-B-EDIT.
   800             20  DC-EDITB-MONTH        PIC 99.
   801             20  SLASHB-1              PIC X VALUE '/'.
   802             20  DC-EDITB-DAY          PIC 99.
   803             20  SLASHB-2              PIC X VALUE '/'.
   804             20  DC-EDITB-CCYY.
   805                 24  DC-EDITB-CENT     PIC 99.
   806                 24  DC-EDITB-YEAR     PIC 99.
   807         16  DC-GREG-DATE-CYMD         PIC 9(08).
   808         16  DC-GREG-DATE-CYMD-R REDEFINES
   809                              DC-GREG-DATE-CYMD.
   810             20  DC-CYMD-CEN           PIC 99.
   811             20  DC-CYMD-YEAR          PIC 99.
   812             20  DC-CYMD-MONTH         PIC 99.
   813             20  DC-CYMD-DAY           PIC 99.
   814         16  DC-GREG-DATE-MDCY         PIC 9(08).
   815         16  DC-GREG-DATE-MDCY-R REDEFINES
   816                              DC-GREG-DATE-MDCY.
   817             20  DC-MDCY-MONTH         PIC 99.
   818             20  DC-MDCY-DAY           PIC 99.
   819             20  DC-MDCY-CEN           PIC 99.
   820             20  DC-MDCY-YEAR          PIC 99.
   821    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   822        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   823    12  DC-EL310-DATE                  PIC X(21).
   824    12  FILLER                         PIC X(28).
   825*                                COPY NSCASEXTR.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  16
* NSRASBL.cbl
   826******************************************************************
   827*                                                                *
   828*                                                                *
   829*                            NSCASEXTR.                          *
   830*                            VMOD=2.001                          *
   831*                                                                *
   832*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   833*                                                                *
   834*   FILE TYPE = VSAM,KSDS                                        *
   835*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   836*                                                                *
   837*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   838*                                                                *
   839*   LOG = NO                                                     *
   840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   841******************************************************************
   842*-----------------------------------------------------------------
   843*                   C H A N G E   L O G
   844*
   845* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   846*-----------------------------------------------------------------
   847*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   848* EFFECTIVE    NUMBER
   849*-----------------------------------------------------------------
   850* 072211    2011022800001  PEMA  NEW FILE
   851*-----------------------------------------------------------------
   852 01 NSAS-EXTRACT-RECORD.
   853    05  NSAS-CONTROL-PRIMARY.
   854        10  NSAS-COMPANY-CD      PIC X.
   855        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   856        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   857    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   858    05  FILLER                   PIC X(143).
   859*                                COPY ERCPNDB.
   860******************************************************************
   861*                                                                *
   862*                                                                *
   863*                            ERCPNDB.                            *
   864*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   865*                            VMOD=2.025                          *
   866*                                                                *
   867*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   868*                                                                *
   869******************************************************************
   870*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   871*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   872******************************************************************
   873*                                                                *
   874*                                                                *
   875*   FILE TYPE = VSAM,KSDS                                        *
   876*   RECORD SIZE = 585  RECFORM = FIXED                           *
   877*                                                                *
   878*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   879*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   880*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   881*                                                 RKP=13,LEN=36  *
   882*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   883*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  17
* NSRASBL.cbl
   884*                                                RKP=49,LEN=11   *
   885*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   886*                                      AND CHG-SEQ.)             *
   887*                                                RKP=60,LEN=15   *
   888*                                                                *
   889*   LOG = NO                                                     *
   890*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   891******************************************************************
   892******************************************************************
   893*                   C H A N G E   L O G
   894*
   895* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   896*-----------------------------------------------------------------
   897*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   898* EFFECTIVE    NUMBER
   899*-----------------------------------------------------------------
   900* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   901* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   902* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   903* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   904* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   905* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   906* 032306                   PEMA  ADD BOW LOAN NUMBER
   907* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   908* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   909* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   910* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   911* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   912* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   913* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   914* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   915* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   916******************************************************************
   917
   918 01  PENDING-BUSINESS.
   919     12  PB-RECORD-ID                     PIC XX.
   920         88  VALID-PB-ID                        VALUE 'PB'.
   921
   922     12  PB-CONTROL-PRIMARY.
   923         16  PB-COMPANY-CD                PIC X.
   924         16  PB-ENTRY-BATCH               PIC X(6).
   925         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   926         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   927
   928     12  PB-CONTROL-BY-ACCOUNT.
   929         16  PB-COMPANY-CD-A1             PIC X.
   930         16  PB-CARRIER                   PIC X.
   931         16  PB-GROUPING.
   932             20  PB-GROUPING-PREFIX       PIC XXX.
   933             20  PB-GROUPING-PRIME        PIC XXX.
   934         16  PB-STATE                     PIC XX.
   935         16  PB-ACCOUNT.
   936             20  PB-ACCOUNT-PREFIX        PIC X(4).
   937             20  PB-ACCOUNT-PRIME         PIC X(6).
   938         16  PB-CERT-EFF-DT               PIC XX.
   939         16  PB-CERT-NO.
   940             20  PB-CERT-PRIME            PIC X(10).
   941             20  PB-CERT-SFX              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  18
* NSRASBL.cbl
   942         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   943
   944         16  PB-RECORD-TYPE               PIC X.
   945             88  PB-MAILING-DATA                VALUE '0'.
   946             88  PB-ISSUE                       VALUE '1'.
   947             88  PB-CANCELLATION                VALUE '2'.
   948             88  PB-BATCH-TRAILER               VALUE '9'.
   949
   950     12  PB-CONTROL-BY-ORIG-BATCH.
   951         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   952         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   953         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   954         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   955
   956     12  PB-CONTROL-BY-CSR.
   957         16  PB-CSR-COMPANY-CD            PIC X.
   958         16  PB-CSR-ID                    PIC X(4).
   959         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   960         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   961         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   962******************************************************************
   963*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   964******************************************************************
   965
   966     12  PB-LAST-MAINT-DT                 PIC XX.
   967     12  PB-LAST-MAINT-BY                 PIC X(4).
   968     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   969
   970     12  PB-RECORD-BODY                   PIC X(375).
   971
   972     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   973         16  PB-CERT-ORIGIN               PIC X.
   974             88  CLASIC-CREATED-CERT         VALUE '1'.
   975         16  PB-I-NAME.
   976             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   977             20  PB-I-INSURED-FIRST-NAME.
   978                 24  PB-I-INSURED-1ST-INIT PIC X.
   979                 24  FILLER                PIC X(9).
   980             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   981         16  PB-I-AGE                     PIC S99   COMP-3.
   982         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   983         16  PB-I-BIRTHDAY                PIC XX.
   984         16  PB-I-INSURED-SEX             PIC X.
   985             88  PB-SEX-MALE     VALUE 'M'.
   986             88  PB-SEX-FEMALE   VALUE 'F'.
   987
   988         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   989         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   990         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   991         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   992         16  PB-I-SKIP-CODE               PIC X.
   993             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   994             88  PB-SKIP-JULY              VALUE '1'.
   995             88  PB-SKIP-AUGUST            VALUE '2'.
   996             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   997             88  PB-SKIP-JULY-AUG          VALUE '4'.
   998             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   999             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  19
* NSRASBL.cbl
  1000             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1001             88  PB-SKIP-JUNE              VALUE '8'.
  1002             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1003             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1004             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1005         16  PB-I-TERM-TYPE               PIC X.
  1006             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1007             88  PB-PAID-WEEKLY            VALUE 'W'.
  1008             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1009             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1010             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1011         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1012         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1013         16  PB-I-DATA-ENTRY-SW           PIC X.
  1014             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1015             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1016             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1017             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1018         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1019         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1020*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1021         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1022         16  FILLER                       PIC X.
  1023
  1024         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1025             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1026             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1027                                                   '90' THRU '99'.
  1028         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1029                                          PIC XX.
  1030         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1031         16  PB-I-AMOUNT-FINANCED REDEFINES
  1032                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1033         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1034         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1035                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1036         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1037         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1038         16  PB-I-CLP-AMOUNT REDEFINES
  1039                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1040         16  PB-I-LF-CALC-FLAG            PIC X.
  1041             88 PB-COMP-LF-PREM               VALUE '?'.
  1042         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1043         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1044         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1045         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1046         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1047         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1048         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1049         16  PB-I-LF-ABBR                 PIC XXX.
  1050         16  PB-I-LF-INPUT-CD             PIC XX.
  1051
  1052         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1053             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1054             88  PB-INVALID-AH               VALUE '  ' '00'
  1055                                                   '90' THRU '99'.
  1056         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1057         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  20
* NSRASBL.cbl
  1058         16  PB-I-AH-CALC-FLAG            PIC X.
  1059             88 PB-COMP-AH-PREM                  VALUE '?'.
  1060         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1061         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1062         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1063         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1064         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1065         16  PB-I-AH-ABBR                 PIC XXX.
  1066         16  PB-I-AH-INPUT-CD             PIC XXX.
  1067
  1068         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1069         16  PB-I-REIN-TABLE              PIC XXX.
  1070         16  PB-I-BUSINESS-TYPE           PIC 99.
  1071         16  PB-I-INDV-GRP-CD             PIC X.
  1072         16  PB-I-MORT-CODE.
  1073             20  PB-I-TABLE               PIC X.
  1074             20  PB-I-INTEREST            PIC XX.
  1075             20  PB-I-MORT-TYP            PIC X.
  1076         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1077         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1078         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1079         16  PB-I-INDV-GRP-OVRD           PIC X.
  1080         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1081         16  PB-I-SIG-SW                  PIC X.
  1082             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1083         16  PB-I-RATE-CLASS              PIC XX.
  1084         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1085         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1086         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1087         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1088         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1089         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1090         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1091         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1092         16  PB-I-OB-FLAG                 PIC X.
  1093             88  PB-I-OB                      VALUE 'B'.
  1094             88  PB-I-SUMMARY                 VALUE 'Z'.
  1095         16  PB-I-ENTRY-STATUS            PIC X.
  1096             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1097                                              'M' '5' '9' '2'.
  1098             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1099             88  PB-I-POLICY-PENDING          VALUE '2'.
  1100             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1101             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1102             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  1103             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1104             88  PB-I-REIN-ONLY               VALUE '9'.
  1105             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1106             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1107             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1108             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1109         16  PB-I-INT-CODE                PIC X.
  1110             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1111             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1112         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1113         16  PB-I-SOC-SEC-NO              PIC X(11).
  1114         16  PB-I-MEMBER-NO               PIC X(12).
  1115         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  21
* NSRASBL.cbl
  1116*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1117         16  PB-I-OLD-LOF                 PIC XXX.
  1118         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1119         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1120         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1121         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1122         16  PB-I-LIFE-INDICATOR          PIC X.
  1123             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1124         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1125         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1126                                          PIC S9(5)V99    COMP-3.
  1127         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1128             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1129             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1130         16  PB-I-1ST-PMT-DT              PIC XX.
  1131         16  PB-I-JOINT-INSURED.
  1132             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1133             20 PB-I-JOINT-FIRST-NAME.
  1134                24  PB-I-JOINT-FIRST-INIT PIC X.
  1135                24  FILLER                PIC X(9).
  1136             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1137*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1138         16  PB-I-BENEFICIARY-NAME.
  1139             20  PB-I-BANK-NUMBER         PIC X(10).
  1140             20  FILLER                   PIC X(15).
  1141         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1142         16  PB-I-REFERENCE               PIC X(12).
  1143         16  FILLER REDEFINES PB-I-REFERENCE.
  1144             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1145             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1146             20  PB-I-CLP-STATE           PIC XX.
  1147         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1148             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1149             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1150             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1151         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1152         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1153         16  PB-I-RESIDENT-STATE          PIC XX.
  1154         16  PB-I-RATE-CODE               PIC X(4).
  1155         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1156         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1157         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1158         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1159         16  PB-I-BANK-NOCHRGB            PIC 99.
  1160         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1161         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1162
  1163     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1164         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1165             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1166         16  PB-C-CANCEL-ORIGIN           PIC X.
  1167             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1168         16  PB-C-LF-CANCEL-DT            PIC XX.
  1169         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1170         16  PB-C-LF-CALC-REQ             PIC X.
  1171             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1172         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1173         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  22
* NSRASBL.cbl
  1174         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1175             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1176         16  PB-C-AH-CANCEL-DT            PIC XX.
  1177         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1178         16  PB-C-AH-CALC-REQ             PIC X.
  1179             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1180         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1181         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1182         16  PB-C-LAST-NAME               PIC X(15).
  1183         16  PB-C-REFUND-SW               PIC X.
  1184             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1185             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1186         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1187         16  PB-C-PAYEE-CODE              PIC X(6).
  1188         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1189         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1190         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1191         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1192         16  PB-C-REFERENCE               PIC X(12).
  1193         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1194         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1195         16  PB-C-POST-CARD-IND           PIC X.
  1196         16  PB-C-CANCEL-REASON           PIC X.
  1197         16  PB-C-REF-INTERFACE-SW        PIC X.
  1198         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1199         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1200         16  FILLER                       PIC X(01).
  1201*        16  FILLER                       PIC X(18).
  1202         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1203*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1204         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1205         16  PB-CANCELED-CERT-DATA.
  1206             20  PB-CI-INSURED-NAME.
  1207                 24  PB-CI-LAST-NAME      PIC X(15).
  1208                 24  PB-CI-INITIALS       PIC XX.
  1209             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1210             20  PB-CI-INSURED-SEX        PIC X.
  1211             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1212             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1213             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1214             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1215             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1216             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1217             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1218             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1219             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1220             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1221             20  PB-CI-RATE-CLASS         PIC XX.
  1222             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1223             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1224             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1225             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1226             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1227             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1228             20  PB-CI-LF-ABBR            PIC X(3).
  1229             20  PB-CI-AH-ABBR            PIC X(3).
  1230             20  PB-CI-OB-FLAG            PIC X.
  1231                 88  PB-CI-OB                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  23
* NSRASBL.cbl
  1232             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1233                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1234                                           'M' '4' '5' '9' '2'.
  1235                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1236                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1237                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1238                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1239                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1240                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  1241                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1242                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1243                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1244                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1245                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1246                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1247                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1248             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1249                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1250                                           'M' '4' '5' '9' '2'.
  1251                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1252                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1253                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1254                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1255                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1256                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  1257                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1258                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1259                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1260                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1261                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1262                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1263                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1264             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1265             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1266             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1267             20  PB-CI-MEMBER-NO          PIC X(12).
  1268             20  PB-CI-INT-CODE           PIC X.
  1269                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1270                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1271             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1272             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1273             20  PB-CI-COMP-EXCP-SW       PIC X.
  1274                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1275                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1276             20  PB-CI-ENTRY-STATUS       PIC X.
  1277             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1278             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1279             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1280             20  PB-CI-DEATH-DT           PIC XX.
  1281             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1282             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1283             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1284             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1285             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1286             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1287             20  PB-CI-ENTRY-DT              PIC XX.
  1288             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1289             20  PB-CI-LF-EXPIRE-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  24
* NSRASBL.cbl
  1290             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1291             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1292             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1293             20  PB-CI-OLD-LOF               PIC XXX.
  1294*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1295             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1296             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1297             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1298             20  PB-CI-INDV-GRP-CD           PIC X.
  1299             20  PB-CI-BENEFICIARY-NAME.
  1300                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1301                 24  FILLER                  PIC X(15).
  1302             20  PB-CI-NOTE-SW               PIC X.
  1303             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1304             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1305             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1306             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1307             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1308             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1309             20  PB-CI-FIRST-NAME            PIC X(10).
  1310             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1311
  1312         16  FILLER                       PIC X(13).
  1313*032306  16  FILLER                       PIC X(27).
  1314*        16  FILLER                       PIC X(46).
  1315
  1316     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1317         16  FILLER                       PIC X(10).
  1318         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1319         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1320         16  PB-M-INSURED-MID-INIT        PIC X.
  1321         16  PB-M-INSURED-AGE             PIC 99.
  1322         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1323         16  PB-M-INSURED-SEX             PIC X.
  1324         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1325         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1326         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1327         16  PB-M-INSURED-CITY-STATE.
  1328             20  PB-M-INSURED-CITY        PIC X(28).
  1329             20  PB-M-INSURED-STATE       PIC XX.
  1330         16  PB-M-INSURED-ZIP-CODE.
  1331             20  PB-M-INSURED-ZIP-PRIME.
  1332                 24  PB-M-INSURED-ZIP-1   PIC X.
  1333                     88  PB-M-CANADIAN-POST-CODE
  1334                                             VALUE 'A' THRU 'Z'.
  1335                 24  FILLER               PIC X(4).
  1336             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1337         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1338                                        PB-M-INSURED-ZIP-CODE.
  1339             20  PM-M-INS-CAN-POST1       PIC XXX.
  1340             20  PM-M-INS-CAN-POST2       PIC XXX.
  1341             20  FILLER                   PIC XXX.
  1342         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1343         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1344         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1345         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1346         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1347         16  PB-M-CRED-BENE-CITYST.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  25
* NSRASBL.cbl
  1348             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1349             20  PB-M-CRED-BENE-STATE     PIC XX.
  1350         16  FILLER                       PIC X(92).
  1351
  1352     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1353         16  FILLER                       PIC X(10).
  1354         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1355         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1356         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1357         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1358         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1359         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1360         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1361         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1362         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1363         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1364         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1365         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1366         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1367         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1368         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1369         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1370         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1371         16  PB-ACCOUNT-NAME              PIC X(30).
  1372         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1373         16  PB-REFERENCE                 PIC X(12).
  1374         16  PB-B-RECEIVED-DT             PIC XX.
  1375         16  FILLER                       PIC X(234).
  1376
  1377     12  PB-RECORD-STATUS.
  1378         16  PB-CREDIT-SELECT-DT          PIC XX.
  1379         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1380         16  PB-BILLED-DT                 PIC XX.
  1381         16  PB-BILLING-STATUS            PIC X.
  1382             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1383             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1384             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1385         16  PB-RECORD-BILL               PIC X.
  1386             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1387             88  PB-RECORD-RETURNED           VALUE 'R'.
  1388             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1389             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1390             88  PB-OVERRIDE-AH               VALUE 'A'.
  1391             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1392         16  PB-BATCH-ENTRY               PIC X.
  1393             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1394             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1395             88  PB-REISSUED-CERT             VALUE 'E'.
  1396             88  PB-CASH-CERT                 VALUE 'C'.
  1397             88  PB-MONTHLY-CERT              VALUE 'M'.
  1398             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1399             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1400             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1401         16  PB-FORCE-CODE                PIC X.
  1402             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1403             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1404             88  PB-CANCEL-FORCE              VALUE '8'.
  1405             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  26
* NSRASBL.cbl
  1406             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1407             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1408             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1409             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1410             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1411             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1412         16  PB-FATAL-FLAG                PIC X.
  1413             88  PB-FATAL-ERRORS              VALUE 'X'.
  1414         16  PB-FORCE-ER-CD               PIC X.
  1415             88  PB-FORCE-ERRORS              VALUE 'F'.
  1416             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1417         16  PB-WARN-ER-CD                PIC X.
  1418             88  PB-WARNING-ERRORS            VALUE 'W'.
  1419         16  FILLER                       PIC X.
  1420         16  PB-OUT-BAL-CD                PIC X.
  1421             88  PB-OUT-OF-BAL                VALUE 'O'.
  1422         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1423         16  PB-AH-OVERRIDE-L1            PIC X.
  1424         16  PB-INPUT-DT                  PIC XX.
  1425         16  PB-INPUT-BY                  PIC X(4).
  1426         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1427         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1428         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1429         16  PB-LF-EARNING-METHOD         PIC X.
  1430         16  PB-AH-EARNING-METHOD         PIC X.
  1431         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1432         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1433         16  PB-REIN-CD                   PIC XXX.
  1434         16  PB-LF-REFUND-TYPE            PIC X.
  1435         16  PB-AH-REFUND-TYPE            PIC X.
  1436         16  PB-ACCT-EFF-DT               PIC XX.
  1437         16  PB-ACCT-EXP-DT               PIC XX.
  1438         16  PB-COMPANY-ID                PIC X(3).
  1439         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1440         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1441         16  PB-SV-CARRIER                PIC X.
  1442         16  PB-SV-GROUPING               PIC X(6).
  1443         16  PB-SV-STATE                  PIC XX.
  1444         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1445         16  PB-GA-BILLING-INFO.
  1446             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1447                                          PIC XX.
  1448         16  PB-SV-REMIT-TO  REDEFINES
  1449             PB-GA-BILLING-INFO           PIC X(10).
  1450         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1451         16  PB-I-LOAN-OFFICER            PIC X(5).
  1452         16  PB-I-VIN                     PIC X(17).
  1453
  1454         16  FILLER                       PIC X(04).
  1455         16  IMNET-BYPASS-SW              PIC X.
  1456
  1457******************************************************************
  1458*                COMMON EDIT ERRORS                              *
  1459******************************************************************
  1460
  1461     12  PB-COMMON-ERRORS.
  1462         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1463                                           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  27
* NSRASBL.cbl
  1464
  1465******************************************************************
  1466*                                COPY ERCENDT.
  1467******************************************************************
  1468*                                                                *
  1469*                                                                *
  1470*                            ERCENDT.                            *
  1471*                            VMOD=2.001                          *
  1472*                                                                *
  1473*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1474*                                                                *
  1475*   FILE TYPE = VSAM,KSDS                                        *
  1476*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1477*                                                                *
  1478*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1479*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1480*                                                                *
  1481*   LOG = NO                                                     *
  1482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1483******************************************************************
  1484*-----------------------------------------------------------------
  1485*                   C H A N G E   L O G
  1486*
  1487* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1488*-----------------------------------------------------------------
  1489*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1490* EFFECTIVE    NUMBER
  1491*-----------------------------------------------------------------
  1492* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1493*                                WITH OPEN CLAIMS
  1494* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1495* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1496* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1497*-----------------------------------------------------------------
  1498 01  ENDORSEMENT-RECORD.
  1499     12  EN-RECORD-ID                PIC XX.
  1500         88  VALID-EN-ID                VALUE 'EN'.
  1501     12  EN-CONTROL-PRIMARY.
  1502         16  EN-COMPANY-CD           PIC X.
  1503         16  EN-CARRIER              PIC X.
  1504         16  EN-GROUPING             PIC X(6).
  1505         16  EN-STATE                PIC XX.
  1506         16  EN-ACCOUNT              PIC X(10).
  1507         16  EN-CERT-EFF-DT          PIC XX.
  1508         16  EN-CERT-NO.
  1509             20  EN-CERT-PRIME       PIC X(10).
  1510             20  EN-CERT-SFX         PIC X.
  1511         16  EN-REC-TYPE             PIC X.
  1512             88  EN-ISSUE               VALUE 'I'.
  1513             88  EN-CANCELLATION        VALUE 'C'.
  1514         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1515     12  EN-CONTROL-BY-ARCH-NO.
  1516         16  EN-COMPANY-CD-A1              PIC X.
  1517         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1518     12  EN-LAST-MAINT-DT            PIC XX.
  1519     12  EN-LAST-MAINT-BY            PIC X(4).
  1520     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1521     12  EN-ENDORSEMENT-RECORD       PIC X(329).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  28
* NSRASBL.cbl
  1522     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1523         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1524         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1525         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1526         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1527         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1528         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1529         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1530         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1531         16  EN-LF-ORIG-BENCD        PIC XX.
  1532         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1533         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1534         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1535         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1536         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1537         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1538*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1539         16  EN-ORIG-CRED-BENE       PIC X(25).
  1540         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1541         16  FILLER                  PIC X.
  1542         16  EN-AH-ORIG-BENCD        PIC XX.
  1543         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1544         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1545         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1546         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1547*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1548*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1549         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1550         16  F                       PIC X(09).
  1551         16  EN-AH-ORIG-CP           PIC 99.
  1552         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1553         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1554         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1555         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1556         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1557         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1558         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1559         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1560         16  EN-LF-NEW-BENCD         PIC XX.
  1561         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1562         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1563         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1564         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1565         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1566         16  EN-LF-NEW-EXP-DT        PIC XX.
  1567         16  EN-NEW-CRED-BENE        PIC X(25).
  1568         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1569         16  FILLER                  PIC X.
  1570         16  EN-AH-NEW-BENCD         PIC XX.
  1571         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1572         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1573         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1574         16  EN-AH-NEW-EXP-DT        PIC XX.
  1575*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1576*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1577*        16  F                       PIC X(12).
  1578         16  EN-AH-NEW-CP            PIC 99.
  1579         16  EN-SIG-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  29
* NSRASBL.cbl
  1580         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1581         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1582         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1583         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1584         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1585         16  FILLER                  PIC X(33).
  1586     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1587         16  EN-LF-ORIG-REF-DT       PIC XX.
  1588         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1589         16  EN-AH-ORIG-REF-DT       PIC XX.
  1590         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1591         16  EN-LF-NEW-REF-DT        PIC XX.
  1592         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1593         16  EN-AH-NEW-REF-DT        PIC XX.
  1594         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1595         16  EN-FLAG-CERT            PIC X.
  1596         16  EN-INS-LAST-NAME        PIC X(15).
  1597         16  EN-INS-FIRST-NAME       PIC X(10).
  1598         16  EN-INS-MIDDLE-INIT      PIC X.
  1599         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1600         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1601         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1602         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1603         16  FILLER                  PIC X(262).
  1604     12  EN-MONEY-SW             PIC X.
  1605     12  EN-HEALTH-APP           PIC X.
  1606     12  EN-VOUCHER-SW           PIC X.
  1607     12  EN-PAYEE                PIC X(14).
  1608     12  EN-INPUT-DT             PIC XX.
  1609     12  EN-PROCESS-DT           PIC XX.
  1610     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1611     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1612     12  EN-REASON-CODES.
  1613         16  F OCCURS 12.
  1614             20  EN-REASON-CODE  PIC X(4).
  1615     12  EN-TEMPLATE-USED        PIC X(8).
  1616     12  EN-DOCU-TYPE            PIC X.
  1617         88  EN-VERI-DOCU          VALUE 'V'.
  1618         88  EN-GCE-DOCU           VALUE 'G'.
  1619         88  EN-CANC-DOCU          VALUE 'C'.
  1620     12  EN-COMMENTS1            PIC X(13).
  1621     12  EN-COMMENTS2            PIC X(70).
  1622     12  EN-COMM-CHGBK           PIC X.
  1623         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1624         88  EN-CHG-ACCT           VALUE 'Y'.
  1625     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1626     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1627     12  EN-BATCH-NUMBER         PIC X(6).
  1628     12  EN-ACCT-SUMM            PIC X.
  1629     12  EN-CSO-SUMM             PIC X.
  1630     12  FILLER                  PIC X(13).
  1631******************************************************************
  1632*                                COPY ERCMAIL.
  1633******************************************************************
  1634*                                                                *
  1635*                                                                *
  1636*                            ERCMAIL                             *
  1637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  30
* NSRASBL.cbl
  1638*                            VMOD=2.003                          *
  1639*                                                                *
  1640*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1641*                                                                *
  1642*   FILE TYPE = VSAM,KSDS                                        *
  1643*   RECORD SIZE = 374   RECFORM = FIX                            *
  1644*                                                                *
  1645*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1646*   ALTERNATE PATH    = NOT USED                                 *
  1647*                                                                *
  1648*   LOG = YES                                                    *
  1649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1650******************************************************************
  1651*                   C H A N G E   L O G
  1652*
  1653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1654*-----------------------------------------------------------------
  1655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1656* EFFECTIVE    NUMBER
  1657*-----------------------------------------------------------------
  1658* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1659* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1660* 111108                   PEMA  ADD CRED BENE ADDR2
  1661******************************************************************
  1662
  1663 01  MAILING-DATA.
  1664     12  MA-RECORD-ID                      PIC XX.
  1665         88  VALID-MA-ID                       VALUE 'MA'.
  1666
  1667     12  MA-CONTROL-PRIMARY.
  1668         16  MA-COMPANY-CD                 PIC X.
  1669         16  MA-CARRIER                    PIC X.
  1670         16  MA-GROUPING.
  1671             20  MA-GROUPING-PREFIX        PIC XXX.
  1672             20  MA-GROUPING-PRIME         PIC XXX.
  1673         16  MA-STATE                      PIC XX.
  1674         16  MA-ACCOUNT.
  1675             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1676             20  MA-ACCOUNT-PRIME          PIC X(6).
  1677         16  MA-CERT-EFF-DT                PIC XX.
  1678         16  MA-CERT-NO.
  1679             20  MA-CERT-PRIME             PIC X(10).
  1680             20  MA-CERT-SFX               PIC X.
  1681
  1682     12  FILLER                            PIC XX.
  1683
  1684     12  MA-ACCESS-CONTROL.
  1685         16  MA-SOURCE-SYSTEM              PIC XX.
  1686             88  MA-FROM-CREDIT                VALUE 'CR'.
  1687             88  MA-FROM-VSI                   VALUE 'VS'.
  1688             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1689             88  MA-FROM-OTHER                 VALUE 'OT'.
  1690         16  MA-RECORD-ADD-DT              PIC XX.
  1691         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1692         16  MA-LAST-MAINT-DT              PIC XX.
  1693         16  MA-LAST-MAINT-BY              PIC XXXX.
  1694         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1695
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  31
* NSRASBL.cbl
  1696     12  MA-PROFILE-INFO.
  1697         16  MA-QUALIFY-CODE-1             PIC XX.
  1698         16  MA-QUALIFY-CODE-2             PIC XX.
  1699         16  MA-QUALIFY-CODE-3             PIC XX.
  1700         16  MA-QUALIFY-CODE-4             PIC XX.
  1701         16  MA-QUALIFY-CODE-5             PIC XX.
  1702
  1703         16  MA-INSURED-LAST-NAME          PIC X(15).
  1704         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1705         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1706         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1707         16  MA-INSURED-BIRTH-DT           PIC XX.
  1708         16  MA-INSURED-SEX                PIC X.
  1709             88  MA-SEX-MALE                   VALUE 'M'.
  1710             88  MA-SEX-FEMALE                 VALUE 'F'.
  1711         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1712
  1713         16  MA-ADDRESS-CORRECTED          PIC X.
  1714         16  MA-JOINT-BIRTH-DT             PIC XX.
  1715*        16  FILLER                        PIC X(12).
  1716
  1717         16  MA-ADDRESS-LINE-1             PIC X(30).
  1718         16  MA-ADDRESS-LINE-2             PIC X(30).
  1719         16  MA-CITY-STATE.
  1720             20  MA-CITY                   PIC X(28).
  1721             20  MA-ADDR-STATE             PIC XX.
  1722         16  MA-ZIP.
  1723             20  MA-ZIP-CODE.
  1724                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1725                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1726                 24  FILLER                PIC X(4).
  1727             20  MA-ZIP-PLUS4              PIC X(4).
  1728         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1729             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1730             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1731             20  FILLER                    PIC X(3).
  1732
  1733         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1734
  1735         16  FILLER                        PIC XXX.
  1736*        16  FILLER                        PIC X(10).
  1737
  1738     12  MA-CRED-BENE-INFO.
  1739         16  MA-CRED-BENE-NAME                 PIC X(25).
  1740         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1741         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1742         16  MA-CRED-BENE-CTYST.
  1743             20  MA-CRED-BENE-CITY             PIC X(28).
  1744             20  MA-CRED-BENE-STATE            PIC XX.
  1745         16  MA-CRED-BENE-ZIP.
  1746             20  MA-CB-ZIP-CODE.
  1747                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1748                     88  MA-CB-CANADIAN-POST-CODE
  1749                                           VALUE 'A' THRU 'Z'.
  1750                 24  FILLER                    PIC X(4).
  1751             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1752         16  MA-CB-CANADIAN-POSTAL-CODE
  1753                            REDEFINES MA-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  32
* NSRASBL.cbl
  1754             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1755             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1756             20  FILLER                        PIC X(3).
  1757     12  MA-POST-CARD-MAIL-DATA.
  1758         16  MA-MAIL-DATA OCCURS 7.
  1759             20  MA-MAIL-TYPE              PIC X.
  1760                 88  MA-12MO-MAILING           VALUE '1'.
  1761                 88  MA-EXP-MAILING            VALUE '2'.
  1762             20  MA-MAIL-STATUS            PIC X.
  1763                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1764                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1765                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1766             20  MA-MAIL-DATE              PIC XX.
  1767     12  FILLER                            PIC XX.
  1768     12  FILLER                            PIC XX.
  1769*    12  FILLER                            PIC X(30).
  1770******************************************************************
  1771*                                COPY ERCCOMP.
  1772******************************************************************
  1773*                                                                *
  1774*                                                                *
  1775*                            ERCCOMP                             *
  1776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1777*                            VMOD=2.019                          *
  1778*                                                                *
  1779*   ONLINE CREDIT SYSTEM                                         *
  1780*                                                                *
  1781*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1782*                                                                *
  1783*   FILE TYPE = VSAM,KSDS                                        *
  1784*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1785*                                                                *
  1786*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1787*       ALTERNATE PATH = NONE                                    *
  1788*                                                                *
  1789*   LOG = NO                                                     *
  1790*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1791*                                                                *
  1792******************************************************************
  1793*                   C H A N G E   L O G
  1794*
  1795* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1796*-----------------------------------------------------------------
  1797*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1798* EFFECTIVE    NUMBER
  1799*-----------------------------------------------------------------
  1800* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1801* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1802* 092205    2005050300006  PEMA  ADD LEASE FEE
  1803* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1804* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1805* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1806* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1807* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1808* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1809******************************************************************
  1810
  1811 01  COMPENSATION-MASTER.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  33
* NSRASBL.cbl
  1812     12  CO-RECORD-ID                          PIC XX.
  1813         88  VALID-CO-ID                          VALUE 'CO'.
  1814
  1815     12  CO-CONTROL-PRIMARY.
  1816         16  CO-COMPANY-CD                     PIC X.
  1817         16  CO-CONTROL.
  1818             20  CO-CTL-1.
  1819                 24  CO-CARR-GROUP.
  1820                     28  CO-CARRIER            PIC X.
  1821                     28  CO-GROUPING.
  1822                         32  CO-GROUP-PREFIX   PIC XXX.
  1823                         32  CO-GROUP-PRIME    PIC XXX.
  1824                 24  CO-RESP-NO.
  1825                     28  CO-RESP-PREFIX        PIC X(4).
  1826                     28  CO-RESP-PRIME         PIC X(6).
  1827             20  CO-CTL-2.
  1828                 24  CO-ACCOUNT.
  1829                     28  CO-ACCT-PREFIX        PIC X(4).
  1830                     28  CO-ACCT-PRIME         PIC X(6).
  1831         16  CO-TYPE                           PIC X.
  1832             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1833             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1834             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1835
  1836     12  CO-MAINT-INFORMATION.
  1837         16  CO-LAST-MAINT-DT                  PIC XX.
  1838         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1839         16  CO-LAST-MAINT-USER                PIC X(4).
  1840     12  FILLER                                PIC XX.
  1841     12  CO-STMT-TYPE                          PIC XXX.
  1842     12  CO-COMP-TYPE                          PIC X.
  1843         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1844     12  CO-STMT-OWNER                         PIC X(4).
  1845     12  CO-BALANCE-CONTROL                    PIC X.
  1846         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1847         88  CO-NO-BALANCE                        VALUE 'N'.
  1848
  1849     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1850         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1851         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1852         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1853
  1854     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1855         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1856         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1857
  1858     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1859     12  CO-GA-DIRECT-DEP                      PIC X.
  1860     12  CO-FUTURE-SPACE                       PIC X.
  1861         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1862
  1863     12  CO-ACCT-NAME                          PIC X(30).
  1864     12  CO-MAIL-NAME                          PIC X(30).
  1865     12  CO-ADDR-1                             PIC X(30).
  1866     12  CO-ADDR-2                             PIC X(30).
  1867     12  CO-ADDR-3.
  1868         16  CO-ADDR-CITY                      PIC X(27).
  1869         16  CO-ADDR-STATE                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  34
* NSRASBL.cbl
  1870     12  CO-CSO-1099                           PIC X.
  1871     12  CO-ZIP.
  1872         16  CO-ZIP-PRIME.
  1873             20  CO-ZIP-PRI-1ST                PIC X.
  1874                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1875             20  FILLER                        PIC X(4).
  1876         16  CO-ZIP-PLUS4                      PIC X(4).
  1877     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1878         16  CO-CAN-POSTAL-1                   PIC XXX.
  1879         16  CO-CAN-POSTAL-2                   PIC XXX.
  1880         16  FILLER                            PIC XXX.
  1881     12  CO-SOC-SEC                            PIC X(13).
  1882     12  CO-TELEPHONE.
  1883         16  CO-AREA-CODE                      PIC XXX.
  1884         16  CO-PREFIX                         PIC XXX.
  1885         16  CO-PHONE                          PIC X(4).
  1886
  1887     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1888
  1889     12  CO-AR-BAL-LEVEL                       PIC X.
  1890         88  CO-AR-REF-LVL                        VALUE '1'.
  1891         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1892         88  CO-AR-BILL-LVL                       VALUE '2'.
  1893         88  CO-AR-AGT-LVL                        VALUE '3'.
  1894         88  CO-AR-FR-LVL                         VALUE '4'.
  1895
  1896     12  CO-AR-NORMAL-PRINT                    PIC X.
  1897         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1898         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1899
  1900     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1901
  1902     12  CO-AR-REPORTING                       PIC X.
  1903         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1904         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1905
  1906     12  CO-AR-PULL-CHECK                      PIC X.
  1907         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1908         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1909
  1910     12  CO-AR-BALANCE-PRINT                   PIC X.
  1911         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1912
  1913     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1914         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1915         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1916         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1917
  1918     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1919
  1920     12  CO-USER-CODE                          PIC X.
  1921     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1922
  1923******************************************************************
  1924*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1925*    THE LAST MONTH END RUN.
  1926******************************************************************
  1927
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  35
* NSRASBL.cbl
  1928     12  CO-LAST-ACTIVITY-DATE.
  1929         16  CO-ACT-YEAR                       PIC 99.
  1930         16  CO-ACT-MONTH                      PIC 99.
  1931         16  CO-ACT-DAY                        PIC 99.
  1932
  1933     12  CO-LAST-STMT-DT.
  1934         16  CO-LAST-STMT-YEAR                 PIC 99.
  1935         16  CO-LAST-STMT-MONTH                PIC 99.
  1936         16  CO-LAST-STMT-DAY                  PIC 99.
  1937
  1938     12  CO-MO-END-TOTALS.
  1939         16  CO-MONTHLY-TOTALS.
  1940             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1941             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1942             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1943             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1944             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1945
  1946         16  CO-AGING-TOTALS.
  1947             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1948             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1949             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1950             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1951
  1952         16  CO-YTD-TOTALS.
  1953             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1954             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1955
  1956         16  CO-OVER-UNDER-TOTALS.
  1957             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1958             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1959
  1960     12  CO-MISCELLANEOUS-TOTALS.
  1961         16  CO-FICA-TOTALS.
  1962             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1963             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1964
  1965         16  CO-CLAIM-TOTALS.
  1966             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1967             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1968
  1969******************************************************************
  1970*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1971*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1972******************************************************************
  1973
  1974     12  CO-CURRENT-TOTALS.
  1975         16  CO-CURRENT-LAST-STMT-DT.
  1976             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1977             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1978             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1979
  1980         16  CO-CURRENT-MONTHLY-TOTALS.
  1981             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1982             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1983             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1984             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1985             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  36
* NSRASBL.cbl
  1986
  1987         16  CO-CURRENT-AGING-TOTALS.
  1988             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1989             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1990             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1991             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1992
  1993         16  CO-CURRENT-YTD-TOTALS.
  1994             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1995             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1996
  1997     12  CO-PAID-COMM-TOTALS.
  1998         16  CO-YTD-PAID-COMMS.
  1999             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2000             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2001
  2002     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2003         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2004         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2005
  2006     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2007         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2008         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2009         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2010         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2011         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2012         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2013         88  CO-FINAL-LETTER                  VALUE 'F'.
  2014         88  CO-RECONCILING                   VALUE 'R'.
  2015         88  CO-PHONE-CALL                    VALUE 'P'.
  2016         88  CO-LEGAL                         VALUE 'L'.
  2017         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2018         88  CO-WRITE-OFF                     VALUE 'W'.
  2019         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2020
  2021     12  CO-CSR-CODE                       PIC X(4).
  2022
  2023     12  CO-GA-STATUS-INFO.
  2024         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2025         16  CO-GA-TERMINATION-DT          PIC XX.
  2026         16  CO-GA-STATUS-CODE             PIC X.
  2027             88  CO-GA-ACTIVE                 VALUE 'A'.
  2028             88  CO-GA-INACTIVE               VALUE 'I'.
  2029             88  CO-GA-PENDING                VALUE 'P'.
  2030         16  CO-GA-COMMENTS.
  2031             20  CO-GA-COMMENT-1           PIC X(40).
  2032             20  CO-GA-COMMENT-2           PIC X(40).
  2033             20  CO-GA-COMMENT-3           PIC X(40).
  2034             20  CO-GA-COMMENT-4           PIC X(40).
  2035
  2036     12  CO-RPTCD2                         PIC X(10).
  2037     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2038         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2039         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2040
  2041     12  CO-TYPE-AGENT                     PIC X(01).
  2042         88  CO-CORPORATION                   VALUE 'C'.
  2043         88  CO-PARTNERSHIP                   VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  37
* NSRASBL.cbl
  2044         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2045         88  CO-TRUST                         VALUE 'T'.
  2046         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2047
  2048     12  CO-FAXNO.
  2049         16  CO-FAX-AREA-CODE                  PIC XXX.
  2050         16  CO-FAX-PREFIX                     PIC XXX.
  2051         16  CO-FAX-PHONE                      PIC X(4).
  2052
  2053     12  CO-BANK-INFORMATION.
  2054         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2055         16  CO-BANK-TRANSIT-NON REDEFINES
  2056             CO-BANK-TRANSIT-NO                PIC 9(8).
  2057
  2058         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2059     12  CO-MISC-DEDUCT-INFO REDEFINES
  2060                  CO-BANK-INFORMATION.
  2061         16  CO-MD-GL-ACCT                     PIC X(10).
  2062         16  CO-MD-DIV                         PIC XX.
  2063         16  CO-MD-CENTER                      PIC X(4).
  2064         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2065         16  CO-CREATE-AP-CHECK                PIC X.
  2066         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2067         16  FILLER                            PIC XXX.
  2068     12  CO-ACH-STATUS                         PIC X.
  2069         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2070         88  CO-ACH-PENDING                        VALUE 'P'.
  2071
  2072     12  CO-BILL-SW                            PIC X.
  2073     12  CO-CONTROL-NAME                       PIC X(30).
  2074     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2075     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2076     12  CO-CLP-STATE                          PIC XX.
  2077     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2078     12  CO-SPP-REFUND-EDIT                    PIC X.
  2079
  2080******************************************************************
  2081*                                COPY ELCCERT.
  2082******************************************************************
  2083*                                                                *
  2084*                            ELCCERT.                            *
  2085*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2086*                            VMOD=2.013                          *
  2087*                                                                *
  2088*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2089*                                                                *
  2090*   FILE TYPE = VSAM,KSDS                                        *
  2091*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2092*                                                                *
  2093*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2094*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2095*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2096*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2097*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2098*                                                                *
  2099*   LOG = YES                                                    *
  2100*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2101******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  38
* NSRASBL.cbl
  2102*                   C H A N G E   L O G
  2103*
  2104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2105*-----------------------------------------------------------------
  2106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2107* EFFECTIVE    NUMBER
  2108*-----------------------------------------------------------------
  2109* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2110* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2111* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2112* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2113* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2114* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2115* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2116* 032612  CR2011110200001  PEMA  AHL CHANGES
  2117* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2118******************************************************************
  2119
  2120 01  CERTIFICATE-MASTER.
  2121     12  CM-RECORD-ID                      PIC XX.
  2122         88  VALID-CM-ID                      VALUE 'CM'.
  2123
  2124     12  CM-CONTROL-PRIMARY.
  2125         16  CM-COMPANY-CD                 PIC X.
  2126         16  CM-CARRIER                    PIC X.
  2127         16  CM-GROUPING.
  2128             20  CM-GROUPING-PREFIX        PIC X(3).
  2129             20  CM-GROUPING-PRIME         PIC X(3).
  2130         16  CM-STATE                      PIC XX.
  2131         16  CM-ACCOUNT.
  2132             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2133             20  CM-ACCOUNT-PRIME          PIC X(6).
  2134         16  CM-CERT-EFF-DT                PIC XX.
  2135         16  CM-CERT-NO.
  2136             20  CM-CERT-PRIME             PIC X(10).
  2137             20  CM-CERT-SFX               PIC X.
  2138
  2139     12  CM-CONTROL-BY-NAME.
  2140         16  CM-COMPANY-CD-A1              PIC X.
  2141         16  CM-INSURED-LAST-NAME          PIC X(15).
  2142         16  CM-INSURED-INITIALS.
  2143             20  CM-INSURED-INITIAL1       PIC X.
  2144             20  CM-INSURED-INITIAL2       PIC X.
  2145
  2146     12  CM-CONTROL-BY-SSN.
  2147         16  CM-COMPANY-CD-A2              PIC X.
  2148         16  CM-SOC-SEC-NO.
  2149             20  CM-SSN-STATE              PIC XX.
  2150             20  CM-SSN-ACCOUNT            PIC X(6).
  2151             20  CM-SSN-LN3.
  2152                 25  CM-INSURED-INITIALS-A2.
  2153                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2154                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2155                 25 CM-PART-LAST-NAME-A2         PIC X.
  2156
  2157     12  CM-CONTROL-BY-CERT-NO.
  2158         16  CM-COMPANY-CD-A4              PIC X.
  2159         16  CM-CERT-NO-A4                 PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  39
* NSRASBL.cbl
  2160
  2161     12  CM-CONTROL-BY-MEMB.
  2162         16  CM-COMPANY-CD-A5              PIC X.
  2163         16  CM-MEMBER-NO.
  2164             20  CM-MEMB-STATE             PIC XX.
  2165             20  CM-MEMB-ACCOUNT           PIC X(6).
  2166             20  CM-MEMB-LN4.
  2167                 25  CM-INSURED-INITIALS-A5.
  2168                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2169                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2170                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2171
  2172     12  CM-INSURED-PROFILE-DATA.
  2173         16  CM-INSURED-FIRST-NAME.
  2174             20  CM-INSURED-1ST-INIT       PIC X.
  2175             20  FILLER                    PIC X(9).
  2176         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2177         16  CM-INSURED-SEX                PIC X.
  2178             88  CM-SEX-MALE                  VALUE 'M'.
  2179             88  CM-SEX-FEMAL                 VALUE 'F'.
  2180         16  CM-INSURED-JOINT-AGE          PIC 99.
  2181         16  CM-JOINT-INSURED-NAME.
  2182             20  CM-JT-LAST-NAME           PIC X(15).
  2183             20  CM-JT-FIRST-NAME.
  2184                 24  CM-JT-1ST-INIT        PIC X.
  2185                 24  FILLER                PIC X(9).
  2186             20  CM-JT-INITIAL             PIC X.
  2187
  2188     12  CM-LIFE-DATA.
  2189         16  CM-LF-BENEFIT-CD              PIC XX.
  2190         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2191         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2192         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2193         16  CM-LF-DEV-CODE                PIC XXX.
  2194         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2195         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2196         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2197         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2198         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2199         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2200         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2201         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2202         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2203         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2204         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2205         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2206         16  cm-temp-epiq                  pic xx.
  2207             88  EPIQ-CLASS                  value 'EQ'.
  2208*        16  FILLER                        PIC XX.
  2209
  2210     12  CM-AH-DATA.
  2211         16  CM-AH-BENEFIT-CD              PIC XX.
  2212         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2213         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2214         16  CM-AH-DEV-CODE                PIC XXX.
  2215         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2216         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2217         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  40
* NSRASBL.cbl
  2218         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2219         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2220         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2221         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2222         16  CM-AH-PAID-THRU-DT            PIC XX.
  2223             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2224         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2225         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2226         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2227         16  FILLER                        PIC X.
  2228
  2229     12  CM-LOAN-INFORMATION.
  2230         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2231         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2232                                           PIC S9(5)V99  COMP-3.
  2233         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2234         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2235         16  CM-PAY-FREQUENCY              PIC S99.
  2236         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2237         16  CM-RATE-CLASS                 PIC XX.
  2238         16  CM-BENEFICIARY                PIC X(25).
  2239         16  CM-POLICY-FORM-NO             PIC X(12).
  2240         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2241         16  CM-LAST-ADD-ON-DT             PIC XX.
  2242         16  CM-DEDUCTIBLE-AMOUNTS.
  2243             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2244             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2245         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2246             20  CM-RESIDENT-STATE         PIC XX.
  2247             20  CM-RATE-CODE              PIC X(4).
  2248             20  FILLER                    PIC XX.
  2249         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2250             20  CM-LOAN-OFFICER           PIC X(5).
  2251             20  FILLER                    PIC XXX.
  2252         16  CM-CSR-CODE                   PIC XXX.
  2253         16  CM-UNDERWRITING-CODE          PIC X.
  2254             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2255         16  CM-POST-CARD-IND              PIC X.
  2256         16  CM-NH-INTERFACE-SW            PIC X.
  2257         16  CM-PREMIUM-TYPE               PIC X.
  2258             88  CM-SING-PRM                  VALUE '1'.
  2259             88  CM-O-B-COVERAGE              VALUE '2'.
  2260             88  CM-OPEN-END                  VALUE '3'.
  2261         16  CM-IND-GRP-TYPE               PIC X.
  2262             88  CM-INDIVIDUAL                VALUE 'I'.
  2263             88  CM-GROUP                     VALUE 'G'.
  2264         16  CM-SKIP-CODE                  PIC X.
  2265             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2266             88  SKIP-JULY                    VALUE '1'.
  2267             88  SKIP-AUGUST                  VALUE '2'.
  2268             88  SKIP-SEPTEMBER               VALUE '3'.
  2269             88  SKIP-JULY-AUG                VALUE '4'.
  2270             88  SKIP-AUG-SEPT                VALUE '5'.
  2271             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2272             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2273             88  SKIP-JUNE                    VALUE '8'.
  2274             88  SKIP-JUNE-JULY               VALUE '9'.
  2275             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  41
* NSRASBL.cbl
  2276             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2277         16  CM-PAYMENT-MODE               PIC X.
  2278             88  PAY-MONTHLY                  VALUE SPACE.
  2279             88  PAY-WEEKLY                   VALUE '1'.
  2280             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2281             88  PAY-BI-WEEKLY                VALUE '3'.
  2282             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2283         16  CM-LOAN-NUMBER                PIC X(8).
  2284         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2285         16  CM-OLD-LOF                    PIC XXX.
  2286*        16  CM-LOAN-OFFICER               PIC XXX.
  2287         16  CM-REIN-TABLE                 PIC XXX.
  2288         16  CM-SPECIAL-REIN-CODE          PIC X.
  2289         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2290         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2291         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2292
  2293     12  CM-STATUS-DATA.
  2294         16  CM-ENTRY-STATUS               PIC X.
  2295         16  CM-ENTRY-DT                   PIC XX.
  2296
  2297         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2298         16  CM-LF-CANCEL-DT               PIC XX.
  2299         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2300
  2301         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2302         16  CM-LF-DEATH-DT                PIC XX.
  2303         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2304
  2305         16  CM-LF-CURRENT-STATUS          PIC X.
  2306             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2307                                                'M' '4' '5' '9'.
  2308             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2309             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2310             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2311             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2312             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2313             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2314             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2315             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2316             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2317             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2318             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2319             88  CM-LF-DECLINED               VALUE 'D'.
  2320             88  CM-LF-VOIDED                 VALUE 'V'.
  2321
  2322         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2323         16  CM-AH-CANCEL-DT               PIC XX.
  2324         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2325
  2326         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2327         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2328         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2329
  2330         16  CM-AH-CURRENT-STATUS          PIC X.
  2331             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2332                                                'M' '4' '5' '9'.
  2333             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  42
* NSRASBL.cbl
  2334             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2335             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2336             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2337             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2338             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2339             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2340             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2341             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2342             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2343             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2344             88  CM-AH-DECLINED               VALUE 'D'.
  2345             88  CM-AH-VOIDED                 VALUE 'V'.
  2346
  2347         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2348             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2349             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2350             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2351         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2352
  2353         16  CM-ENTRY-BATCH                PIC X(6).
  2354         16  CM-LF-EXIT-BATCH              PIC X(6).
  2355         16  CM-AH-EXIT-BATCH              PIC X(6).
  2356         16  CM-LAST-MONTH-END             PIC XX.
  2357
  2358     12  CM-NOTE-SW                        PIC X.
  2359         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2360         88  CERT-NOTES-PRESENT               VALUE '1'.
  2361         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2362         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2363         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2364         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2365         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2366         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2367     12  CM-COMP-EXCP-SW                   PIC X.
  2368         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2369         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2370     12  CM-INSURED-ADDRESS-SW             PIC X.
  2371         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2372         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2373
  2374*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2375     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2376     12  FILLER                            PIC X.
  2377
  2378*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2379     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2380     12  FILLER                            PIC X.
  2381*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2382     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2383
  2384     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2385         88  CERT-ADDED-BATCH                 VALUE ' '.
  2386         88  CERT-ADDED-ONLINE                VALUE '1'.
  2387         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2388         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2389         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2390     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2391         88  CERT-AS-LOADED                   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  43
* NSRASBL.cbl
  2392         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2393         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2394         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2395         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2396         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2397         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2398         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2399
  2400     12  CM-ACCOUNT-COMM-PCTS.
  2401         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2402         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2403
  2404     12  CM-USER-FIELD                     PIC X.
  2405     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2406     12  CM-CLP-STATE                      PIC XX.
  2407     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2408     12  CM-USER-RESERVED                  PIC XXX.
  2409     12  FILLER REDEFINES CM-USER-RESERVED.
  2410         16  CM-AH-CLASS-CD                PIC XX.
  2411         16  F                             PIC X.
  2412******************************************************************
  2413*                                COPY ELCCRTO.
  2414******************************************************************
  2415*                                                                *
  2416*                            ELCCRTO.                            *
  2417*                                                                *
  2418*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2419*                                                                *
  2420*   FILE TYPE = VSAM,KSDS                                        *
  2421*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2422*                                                                *
  2423*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2424*                                                                *
  2425*   LOG = YES                                                    *
  2426*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2427******************************************************************
  2428*                   C H A N G E   L O G
  2429*
  2430* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2431*-----------------------------------------------------------------
  2432*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2433* EFFECTIVE    NUMBER
  2434*-----------------------------------------------------------------
  2435* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2436* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2437* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2438* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2439* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2440******************************************************************
  2441 01  ORIGINAL-CERTIFICATE.
  2442     12  OC-RECORD-ID                      PIC XX.
  2443         88  VALID-OC-ID                      VALUE 'OC'.
  2444     12  OC-CONTROL-PRIMARY.
  2445         16  OC-COMPANY-CD                 PIC X.
  2446         16  OC-CARRIER                    PIC X.
  2447         16  OC-GROUPING                   PIC X(6).
  2448         16  OC-STATE                      PIC XX.
  2449         16  OC-ACCOUNT                    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  44
* NSRASBL.cbl
  2450         16  OC-CERT-EFF-DT                PIC XX.
  2451         16  OC-CERT-NO.
  2452             20  OC-CERT-PRIME             PIC X(10).
  2453             20  OC-CERT-SFX               PIC X.
  2454         16  OC-RECORD-TYPE                PIC X.
  2455         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2456     12  OC-LAST-MAINT-DT                  PIC XX.
  2457     12  OC-LAST-MAINT-BY                  PIC X(4).
  2458     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2459     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2460     12  FILLER                            PIC X(49).
  2461     12  OC-ORIG-REC.
  2462         16  OC-INS-LAST-NAME              PIC X(15).
  2463         16  OC-INS-FIRST-NAME             PIC X(10).
  2464         16  OC-INS-MIDDLE-INIT            PIC X.
  2465         16  OC-INS-AGE                    PIC S999     COMP-3.
  2466         16  OC-JNT-LAST-NAME              PIC X(15).
  2467         16  OC-JNT-FIRST-NAME             PIC X(10).
  2468         16  OC-JNT-MIDDLE-INIT            PIC X.
  2469         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2470         16  OC-LF-BENCD                   PIC XX.
  2471         16  OC-LF-TERM                    PIC S999      COMP-3.
  2472         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2473         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2474         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2475         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2476         16  OC-LF-EXP-DT                  PIC XX.
  2477         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2478         16  OC-LF-CANCEL-DT               PIC XX.
  2479         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2480         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2481         16  OC-AH-BENCD                   PIC XX.
  2482         16  OC-AH-TERM                    PIC S999      COMP-3.
  2483         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2484         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2485         16  OC-AH-EXP-DT                  PIC XX.
  2486         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2487         16  OC-AH-CP                      PIC 99.
  2488         16  OC-AH-CANCEL-DT               PIC XX.
  2489         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2490         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2491         16  OC-CRED-BENE-NAME             PIC X(25).
  2492         16  OC-1ST-PMT-DT                 PIC XX.
  2493         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2494         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2495         16  OC-ISSUE-TRAN-IND             PIC X.
  2496         16  OC-CANCEL-TRAN-IND            PIC X.
  2497         16  FILLER                        PIC X(211).
  2498
  2499     12  FILLER                            PIC X(50).
  2500******************************************************************
  2501*                                COPY ERCACCT.
  2502******************************************************************
  2503*                                                                *
  2504*                                                                *
  2505*                            ERCACCT                             *
  2506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2507*                            VMOD=2.031                          *
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  45
* NSRASBL.cbl
  2508*                                                                *
  2509*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2510*                                                                *
  2511*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2512*   VSAM ACCOUNT MASTER FILES.                                   *
  2513*                                                                *
  2514*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2515*                                                                *
  2516*   FILE TYPE = VSAM,KSDS                                        *
  2517*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2518*                                                                *
  2519*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2520*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2521*                                                                *
  2522*   LOG = NO                                                     *
  2523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2524*                                                                *
  2525*                                                                *
  2526******************************************************************
  2527*                   C H A N G E   L O G
  2528*
  2529* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2530*-----------------------------------------------------------------
  2531*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2532* EFFECTIVE    NUMBER
  2533*-----------------------------------------------------------------
  2534* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2535* 092705    2005050300006  PEMA  ADD SPP LEASES
  2536* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2537* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2538* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2539* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2540* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2541******************************************************************
  2542
  2543 01  ACCOUNT-MASTER.
  2544     12  AM-RECORD-ID                      PIC XX.
  2545         88  VALID-AM-ID                      VALUE 'AM'.
  2546
  2547     12  AM-CONTROL-PRIMARY.
  2548         16  AM-COMPANY-CD                 PIC X.
  2549         16  AM-MSTR-CNTRL.
  2550             20  AM-CONTROL-A.
  2551                 24  AM-CARRIER            PIC X.
  2552                 24  AM-GROUPING.
  2553                     28 AM-GROUPING-PREFIX PIC XXX.
  2554                     28 AM-GROUPING-PRIME  PIC XXX.
  2555                 24  AM-STATE              PIC XX.
  2556                 24  AM-ACCOUNT.
  2557                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2558                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2559             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2560                                           PIC X(19).
  2561             20  AM-CNTRL-B.
  2562                 24  AM-EXPIRATION-DT      PIC XX.
  2563                 24  FILLER                PIC X(4).
  2564             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2565                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  46
* NSRASBL.cbl
  2566
  2567     12  AM-CONTROL-BY-VAR-GRP.
  2568         16  AM-COMPANY-CD-A1              PIC X.
  2569         16  AM-VG-CARRIER                 PIC X.
  2570         16  AM-VG-GROUPING                PIC X(6).
  2571         16  AM-VG-STATE                   PIC XX.
  2572         16  AM-VG-ACCOUNT                 PIC X(10).
  2573         16  AM-VG-DATE.
  2574             20  AM-VG-EXPIRATION-DT       PIC XX.
  2575             20  FILLER                    PIC X(4).
  2576         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2577                                           PIC 9(11)      COMP-3.
  2578     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2579         16  FILLER                        PIC X(10).
  2580         16  AM-VG-KEY3.
  2581             20  AM-VG3-ACCOUNT            PIC X(10).
  2582             20  AM-VG3-EXP-DT             PIC XX.
  2583         16  FILLER                        PIC X(4).
  2584     12  AM-MAINT-INFORMATION.
  2585         16  AM-LAST-MAINT-DT              PIC XX.
  2586         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2587         16  AM-LAST-MAINT-USER            PIC X(4).
  2588         16  FILLER                        PIC XX.
  2589
  2590     12  AM-EFFECTIVE-DT                   PIC XX.
  2591     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2592
  2593     12  AM-PREV-DATES  COMP-3.
  2594         16  AM-PREV-EXP-DT                PIC 9(11).
  2595         16  AM-PREV-EFF-DT                PIC 9(11).
  2596
  2597     12  AM-REPORT-CODE-1                  PIC X(10).
  2598     12  AM-REPORT-CODE-2                  PIC X(10).
  2599
  2600     12  AM-CITY-CODE                      PIC X(4).
  2601     12  AM-COUNTY-PARISH                  PIC X(6).
  2602
  2603     12  AM-NAME                           PIC X(30).
  2604     12  AM-PERSON                         PIC X(30).
  2605     12  AM-ADDRS                          PIC X(30).
  2606     12  AM-CITY.
  2607         16  AM-ADDR-CITY                  PIC X(28).
  2608         16  AM-ADDR-STATE                 PIC XX.
  2609     12  AM-ZIP.
  2610         16  AM-ZIP-PRIME.
  2611             20  AM-ZIP-PRI-1ST            PIC X.
  2612                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2613             20  FILLER                    PIC X(4).
  2614         16  AM-ZIP-PLUS4                  PIC X(4).
  2615     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2616         16  AM-CAN-POSTAL-1               PIC XXX.
  2617         16  AM-CAN-POSTAL-2               PIC XXX.
  2618         16  FILLER                        PIC XXX.
  2619     12  AM-TEL-NO.
  2620         16  AM-AREA-CODE                  PIC 999.
  2621         16  AM-TEL-PRE                    PIC 999.
  2622         16  AM-TEL-NBR                    PIC 9(4).
  2623     12  AM-TEL-LOC                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  47
* NSRASBL.cbl
  2624         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2625         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2626
  2627     12  AM-COMM-STRUCTURE.
  2628         16  AM-DEFN-1.
  2629             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2630                 24  AM-AGT.
  2631                     28  AM-AGT-PREFIX     PIC X(4).
  2632                     28  AM-AGT-PRIME      PIC X(6).
  2633                 24  AM-COM-TYP            PIC X.
  2634                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2635                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2636                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2637                 24  AM-RECALC-LV-INDIC    PIC X.
  2638                 24  AM-RETRO-LV-INDIC     PIC X.
  2639                 24  AM-GL-CODES           PIC X.
  2640                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2641                 24  FILLER                PIC X(01).
  2642         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2643             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2644                 24  FILLER                PIC X(11).
  2645                 24  AM-L-COMA             PIC XXX.
  2646                 24  AM-J-COMA             PIC XXX.
  2647                 24  AM-A-COMA             PIC XXX.
  2648                 24  FILLER                PIC X(6).
  2649
  2650     12  AM-COMM-CHANGE-STATUS             PIC X.
  2651         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2652
  2653     12  AM-CSR-CODE                       PIC X(4).
  2654
  2655     12  AM-BILLING-STATUS                 PIC X.
  2656         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2657         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2658     12  AM-AUTO-REFUND-SW                 PIC X.
  2659         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2660         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2661     12  AM-GPCD                           PIC 99.
  2662     12  AM-IG                             PIC X.
  2663         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2664         88  AM-HAS-GROUP                     VALUE '2'.
  2665     12  AM-STATUS                         PIC X.
  2666         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2667         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2668         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2669         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2670         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2671         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2672     12  AM-REMIT-TO                       PIC 99.
  2673     12  AM-ID-NO                          PIC X(11).
  2674
  2675     12  AM-CAL-TABLE                      PIC XX.
  2676     12  AM-LF-DEVIATION                   PIC XXX.
  2677     12  AM-AH-DEVIATION                   PIC XXX.
  2678     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2679     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2680     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2681     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  48
* NSRASBL.cbl
  2682     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2683     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2684
  2685     12  AM-USER-FIELDS.
  2686         16  AM-FLD-1                      PIC XX.
  2687         16  AM-FLD-2                      PIC XX.
  2688         16  AM-FLD-3                      PIC XX.
  2689         16  AM-FLD-4                      PIC XX.
  2690         16  AM-FLD-5                      PIC XX.
  2691
  2692     12  AM-1ST-PROD-DATE.
  2693         16  AM-1ST-PROD-YR                PIC XX.
  2694         16  AM-1ST-PROD-MO                PIC XX.
  2695         16  AM-1ST-PROD-DA                PIC XX.
  2696     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2697     12  AM-CERTS-PURGED-DATE.
  2698         16  AM-PUR-YR                     PIC XX.
  2699         16  AM-PUR-MO                     PIC XX.
  2700         16  AM-PUR-DA                     PIC XX.
  2701     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2702     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2703     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2704     12  AM-INACTIVE-DATE.
  2705         16  AM-INA-MO                     PIC 99.
  2706         16  AM-INA-DA                     PIC 99.
  2707         16  AM-INA-YR                     PIC 99.
  2708     12  AM-AR-HI-CERT-DATE                PIC XX.
  2709
  2710     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2711     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2712
  2713     12  AM-OB-PAYMENT-MODE                PIC X.
  2714         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2715         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2716         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2717         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2718
  2719     12  AM-AH-ONLY-INDICATOR              PIC X.
  2720         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2721         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2722
  2723     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2724
  2725     12  AM-OVER-SHORT.
  2726         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2727         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2728
  2729     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2730     12  AM-DCC-CLP-STATE                  PIC XX.
  2731
  2732     12  AM-RECALC-COMM                    PIC X.
  2733     12  AM-RECALC-REIN                    PIC X.
  2734
  2735     12  AM-REI-TABLE                      PIC XXX.
  2736     12  AM-REI-ET-LF                      PIC X.
  2737     12  AM-REI-ET-AH                      PIC X.
  2738     12  AM-REI-PE-LF                      PIC X.
  2739     12  AM-REI-PE-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  49
* NSRASBL.cbl
  2740     12  AM-REI-PRT-ST                     PIC X.
  2741     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2742     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2743     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2744     12  AM-REI-GROUP-A                    PIC X(6).
  2745     12  AM-REI-MORT                       PIC X(4).
  2746     12  AM-REI-PRT-OW                     PIC X.
  2747     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2748     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2749     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2750     12  AM-REI-GROUP-B                    PIC X(6).
  2751
  2752     12  AM-TRUST-TYPE                     PIC X(2).
  2753
  2754     12  AM-EMPLOYER-STMT-USED             PIC X.
  2755     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2756
  2757     12  AM-STD-AH-TYPE                    PIC XX.
  2758     12  AM-EARN-METHODS.
  2759         16  AM-EARN-METHOD-R              PIC X.
  2760             88 AM-REF-RL-R78                 VALUE 'R'.
  2761             88 AM-REF-RL-PR                  VALUE 'P'.
  2762             88 AM-REF-RL-MEAN                VALUE 'M'.
  2763             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2764         16  AM-EARN-METHOD-L              PIC X.
  2765             88 AM-REF-LL-R78                 VALUE 'R'.
  2766             88 AM-REF-LL-PR                  VALUE 'P'.
  2767             88 AM-REF-LL-MEAN                VALUE 'M'.
  2768             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2769         16  AM-EARN-METHOD-A              PIC X.
  2770             88 AM-REF-AH-R78                 VALUE 'R'.
  2771             88 AM-REF-AH-PR                  VALUE 'P'.
  2772             88 AM-REF-AH-MEAN                VALUE 'M'.
  2773             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2774             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2775             88 AM-REF-AH-NET                 VALUE 'N'.
  2776
  2777     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2778     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2779     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2780
  2781     12  AM-RET-Y-N                        PIC X.
  2782     12  AM-RET-P-E                        PIC X.
  2783     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2784     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2785     12  AM-RET-GRP                        PIC X(6).
  2786     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2787         16  AM-POOL-PRIME                 PIC XXX.
  2788         16  AM-POOL-SUB                   PIC XXX.
  2789     12  AM-RETRO-EARNINGS.
  2790         16  AM-RET-EARN-R                 PIC X.
  2791         16  AM-RET-EARN-L                 PIC X.
  2792         16  AM-RET-EARN-A                 PIC X.
  2793     12  AM-RET-ST-TAX-USE                 PIC X.
  2794         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2795         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2796     12  AM-RETRO-BEG-EARNINGS.
  2797         16  AM-RET-BEG-EARN-R             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  50
* NSRASBL.cbl
  2798         16  AM-RET-BEG-EARN-L             PIC X.
  2799         16  AM-RET-BEG-EARN-A             PIC X.
  2800     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2801     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2802
  2803     12  AM-USER-SELECT-OPTIONS.
  2804         16  AM-USER-SELECT-1              PIC X(10).
  2805         16  AM-USER-SELECT-2              PIC X(10).
  2806         16  AM-USER-SELECT-3              PIC X(10).
  2807         16  AM-USER-SELECT-4              PIC X(10).
  2808         16  AM-USER-SELECT-5              PIC X(10).
  2809
  2810     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2811
  2812     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2813
  2814     12  AM-RPT045A-SWITCH                 PIC X.
  2815         88  RPT045A-OFF                   VALUE 'N'.
  2816
  2817     12  AM-INSURANCE-LIMITS.
  2818         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2819         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2820
  2821     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2822         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2823
  2824     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2825         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2826         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2827
  2828     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2829
  2830     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2831     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2832     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2833     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2834     12  AM-DCC-UEF-STATE                  PIC XX.
  2835     12  FILLER                            PIC XXX.
  2836     12  AM-REPORT-CODE-3                  PIC X(10).
  2837*    12  FILLER                            PIC X(22).
  2838
  2839     12  AM-RESERVE-DATE.
  2840         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2841         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2842         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2843
  2844     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2845     12  AM-NOTIFICATION-TYPES.
  2846         16  AM-NOTIF-OF-LETTERS           PIC X.
  2847         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2848         16  AM-NOTIF-OF-REPORTS           PIC X.
  2849         16  AM-NOTIF-OF-STATUS            PIC X.
  2850
  2851     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2852         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2853         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2854         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2855         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  51
* NSRASBL.cbl
  2856
  2857     12  AM-BENEFIT-CONTROLS.
  2858         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2859             20  AM-BENEFIT-CODE           PIC XX.
  2860             20  AM-BENEFIT-TYPE           PIC X.
  2861             20  AM-BENEFIT-REVISION       PIC XXX.
  2862             20  AM-BENEFIT-REM-TERM       PIC X.
  2863             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2864             20  FILLER                    PIC XX.
  2865         16  FILLER                        PIC X(80).
  2866
  2867     12  AM-TRANSFER-DATA.
  2868         16  AM-TRANSFERRED-FROM.
  2869             20  AM-TRNFROM-CARRIER        PIC X.
  2870             20  AM-TRNFROM-GROUPING.
  2871                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2872                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2873             20  AM-TRNFROM-STATE          PIC XX.
  2874             20  AM-TRNFROM-ACCOUNT.
  2875                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2876                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2877             20  AM-TRNFROM-DTE            PIC XX.
  2878         16  AM-TRANSFERRED-TO.
  2879             20  AM-TRNTO-CARRIER          PIC X.
  2880             20  AM-TRNTO-GROUPING.
  2881                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2882                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2883             20  AM-TRNTO-STATE            PIC XX.
  2884             20  AM-TRNTO-ACCOUNT.
  2885                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2886                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2887             20  AM-TRNTO-DTE              PIC XX.
  2888         16  FILLER                        PIC X(10).
  2889
  2890     12  AM-SAVED-REMIT-TO                 PIC 99.
  2891
  2892     12  AM-COMM-STRUCTURE-SAVED.
  2893         16  AM-DEFN-1-SAVED.
  2894             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2895                 24  AM-AGT-SV             PIC X(10).
  2896                 24  AM-COM-TYP-SV         PIC X.
  2897                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2898                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2899                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2900                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2901                 24  FILLER                PIC X.
  2902                 24  AM-GL-CODES-SV        PIC X.
  2903                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2904                 24  FILLER                PIC X.
  2905         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2906             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2907                 24  FILLER                PIC X(11).
  2908                 24  AM-L-COMA-SV          PIC XXX.
  2909                 24  AM-J-COMA-SV          PIC XXX.
  2910                 24  AM-A-COMA-SV          PIC XXX.
  2911                 24  FILLER                PIC X(6).
  2912
  2913     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  52
* NSRASBL.cbl
  2914         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2915            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2916            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2917            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2918
  2919     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2920     12  FILLER                            PIC X(120).
  2921
  2922     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2923         16  AM-CONTROL-NAME               PIC X(30).
  2924         16  AM-EXECUTIVE-ONE.
  2925             20  AM-EXEC1-NAME             PIC X(15).
  2926             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2927                                                          COMP-3.
  2928             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2929                                                          COMP-3.
  2930         16  AM-EXECUTIVE-TWO.
  2931             20  AM-EXEC2-NAME             PIC X(15).
  2932             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2933                                                          COMP-3.
  2934             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2935                                                          COMP-3.
  2936
  2937     12  AM-RETRO-ADDITIONAL-DATA.
  2938         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2939         16  AM-RETRO-PREM-P-E             PIC X.
  2940         16  AM-RETRO-CLMS-P-I             PIC X.
  2941         16  AM-RETRO-RET-BRACKET-LF.
  2942             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2943                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2944                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2945             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2946                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2947                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2948             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2949                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2950                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2951         16  AM-RETRO-RET-BRACKET-AH.
  2952             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2953                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2954                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2955                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2956             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2957                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2958                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2959             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2960                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2961                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2962
  2963     12  AM-COMMENTS.
  2964         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2965
  2966     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2967         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2968         16  AM-FLI-BILLING-CODE           PIC X.
  2969         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2970         16  AM-FLI-UNITED-IDENT           PIC X.
  2971         16  AM-FLI-INTEREST-LOST-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  53
* NSRASBL.cbl
  2972             20  AM-FLI-BANK-NO            PIC X(5).
  2973             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2974             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2975             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2976         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2977             20  AM-FLI-AGT                PIC X(9).
  2978             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2979             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2980         16  FILLER                        PIC X(102).
  2981
  2982     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2983         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2984             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2985             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2986             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2987             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2988             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2989         16  FILLER                          PIC X(10).
  2990******************************************************************
  2991*                                COPY ELCTEXT.
  2992******************************************************************
  2993*                                                                *
  2994*                                                                *
  2995*                            ELCTEXT.                            *
  2996*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2997*                            VMOD=2.008                          *
  2998*                                                                *
  2999*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3000*                                     FORM LETTERS,              *
  3001*                                     CERT FORM DISPLAY.
  3002*                                                                *
  3003*   FILE TYPE = VSAM,KSDS                                        *
  3004*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3005*                                                                *
  3006*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3007*       ALTERNATE INDEX = NONE                                   *
  3008*                                                                *
  3009*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3010*       ALTERNATE INDEX = NONE                                   *
  3011*                                                                *
  3012*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3013*       ALTERNATE INDEX = NONE                                   *
  3014*                                                                *
  3015*   LOG = NO                                                     *
  3016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3017******************************************************************
  3018 01  TEXT-FILES.
  3019     12  TEXT-FILE-ID                PIC XX.
  3020         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3021         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3022         88  HELP-FILE-TEXT             VALUE 'TH'.
  3023
  3024     12  TX-CONTROL-PRIMARY.
  3025         16  TX-COMPANY-CD           PIC X.
  3026             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3027         16  TX-ACCESS-CD-GENL       PIC X(12).
  3028
  3029         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  54
* NSRASBL.cbl
  3030             20  TX-LETTER-NO        PIC X(4).
  3031             20  FILLER              PIC X(8).
  3032
  3033         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3034             20  TX-FORM-NO          PIC X(12).
  3035
  3036         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3037             20  TX-HELP-TYPE        PIC X.
  3038                 88  HELP-FOR-GENERAL   VALUE ' '.
  3039                 88  HELP-BY-SCREEN     VALUE 'S'.
  3040                 88  HELP-BY-ERROR      VALUE 'E'.
  3041             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3042                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3043             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3044                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3045             20  FILLER              PIC X(4).
  3046
  3047         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3048
  3049     12  TX-PROCESS-CONTROL          PIC XX.
  3050         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3051
  3052     12  TX-TEXT-LINE                PIC X(70).
  3053
  3054     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3055         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3056         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3057         88  TX-VALID-FORM-SQUEEZE-VALUE
  3058                                        VALUE 'Y' ' '.
  3059
  3060     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3061         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3062         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3063         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3064         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3065         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3066         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3067         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3068                                              'K' 'N' ' '
  3069                                              'Z'.
  3070
  3071     12  TX-ARCHIVE-SW               PIC X.
  3072         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3073         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3074         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3075
  3076     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3077     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3078
  3079     12  TX-BSR-CODE                 PIC X.
  3080         88  TX-BSR-LETTER              VALUE 'B'.
  3081         88  TX-NON-BSR-LETTER          VALUE ' '.
  3082
  3083     12  FILLER                      PIC X.
  3084*****************************************************************
  3085*                                COPY ELCCNTL.
  3086******************************************************************
  3087*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  55
* NSRASBL.cbl
  3088*                                                                *
  3089*                            ELCCNTL.                            *
  3090*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3091*                            VMOD=2.059                          *
  3092*                                                                *
  3093*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3094*                                                                *
  3095*   FILE TYPE = VSAM,KSDS                                        *
  3096*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3097*                                                                *
  3098*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3099*       ALTERNATE INDEX = NONE                                   *
  3100*                                                                *
  3101*   LOG = YES                                                    *
  3102*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3103******************************************************************
  3104*                   C H A N G E   L O G
  3105*
  3106* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3107*-----------------------------------------------------------------
  3108*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3109* EFFECTIVE    NUMBER
  3110*-----------------------------------------------------------------
  3111* 082503                   PEMA  ADD BENEFIT GROUP
  3112* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3113* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3114* 092705    2005050300006  PEMA  ADD SPP LEASES
  3115* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3116* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3117* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3118* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3119* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3120* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3121* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3122* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3123* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3124* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3125******************************************************************
  3126*
  3127 01  CONTROL-FILE.
  3128     12  CF-RECORD-ID                       PIC XX.
  3129         88  VALID-CF-ID                        VALUE 'CF'.
  3130
  3131     12  CF-CONTROL-PRIMARY.
  3132         16  CF-COMPANY-ID                  PIC XXX.
  3133         16  CF-RECORD-TYPE                 PIC X.
  3134             88  CF-COMPANY-MASTER              VALUE '1'.
  3135             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3136             88  CF-STATE-MASTER                VALUE '3'.
  3137             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3138             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3139             88  CF-CARRIER-MASTER              VALUE '6'.
  3140             88  CF-MORTALITY-MASTER            VALUE '7'.
  3141             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3142             88  CF-TERMINAL-MASTER             VALUE '9'.
  3143             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3144             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3145             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  56
* NSRASBL.cbl
  3146             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3147             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3148             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3149             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3150             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3151             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3152         16  CF-ACCESS-CD-GENL              PIC X(4).
  3153         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3154             20  CF-PROCESSOR               PIC X(4).
  3155         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3156             20  CF-STATE-CODE              PIC XX.
  3157             20  FILLER                     PIC XX.
  3158         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3159             20  FILLER                     PIC XX.
  3160             20  CF-HI-BEN-IN-REC           PIC XX.
  3161         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3162             20  FILLER                     PIC XXX.
  3163             20  CF-CARRIER-CNTL            PIC X.
  3164         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3165             20  FILLER                     PIC XX.
  3166             20  CF-HI-TYPE-IN-REC          PIC 99.
  3167         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3168             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3169                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3170             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3171             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3172         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3173             20  FILLER                     PIC X.
  3174             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3175         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3176             20  FILLER                     PIC XX.
  3177             20  CF-MORTGAGE-PLAN           PIC XX.
  3178         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3179
  3180     12  CF-LAST-MAINT-DT                   PIC XX.
  3181     12  CF-LAST-MAINT-BY                   PIC X(4).
  3182     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3183
  3184     12  CF-RECORD-BODY                     PIC X(728).
  3185
  3186
  3187****************************************************************
  3188*             COMPANY MASTER RECORD                            *
  3189****************************************************************
  3190
  3191     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3192         16  CF-COMPANY-ADDRESS.
  3193             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3194             20  CF-CL-IN-CARE-OF           PIC X(30).
  3195             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3196             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3197             20  CF-CL-CITY-STATE           PIC X(30).
  3198             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3199             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3200         16  CF-COMPANY-CD                  PIC X.
  3201         16  CF-COMPANY-PASSWORD            PIC X(8).
  3202         16  CF-SECURITY-OPTION             PIC X.
  3203             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  57
* NSRASBL.cbl
  3204             88  COMPANY-VERIFY                 VALUE '2'.
  3205             88  PROCESSOR-VERIFY               VALUE '3'.
  3206             88  NO-SECURITY                    VALUE '4'.
  3207             88  ALL-BUT-TERM                   VALUE '5'.
  3208         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3209             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3210         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3211             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3212         16  CF-INFORCE-LOCATION            PIC X.
  3213             88  CERTS-ARE-ONLINE               VALUE '1'.
  3214             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3215             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3216         16  CF-LOWER-CASE-LETTERS          PIC X.
  3217         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3218             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3219             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3220             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3221             88  CF-ACCNT-CNTL                  VALUE '3'.
  3222             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3223
  3224         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3225         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3226
  3227         16  CF-LGX-CREDIT-USER             PIC X.
  3228             88  CO-IS-NOT-USER                 VALUE 'N'.
  3229             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3230
  3231         16 CF-CREDIT-CALC-CODES.
  3232             20  CF-CR-REM-TERM-CALC PIC X.
  3233               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3234               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3235               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3236               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3237               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3238               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3239               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3240             20  CF-CR-R78-METHOD           PIC X.
  3241               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3242               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3243
  3244         16  CF-CLAIM-CONTROL-COUNTS.
  3245             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3246                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3247
  3248             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3249                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3250
  3251             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3252                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3253
  3254             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3255                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3256
  3257         16  CF-CURRENT-MONTH-END           PIC XX.
  3258
  3259         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3260             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3261             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  58
* NSRASBL.cbl
  3262             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3263             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3264                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3265                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3266             20  CF-CO-PREM-REJECT-SW       PIC X.
  3267                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3268                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3269             20  CF-CO-REF-REJECT-SW        PIC X.
  3270                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3271                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3272
  3273         16  CF-CO-REPORTING-DT             PIC XX.
  3274         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3275         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3276           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3277           88  CF-CO-MONTH-END                  VALUE '1'.
  3278
  3279         16  CF-LGX-CLAIM-USER              PIC X.
  3280             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3281             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3282
  3283         16  CF-CREDIT-EDIT-CONTROLS.
  3284             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3285             20  CF-MIN-AGE                 PIC 99.
  3286             20  CF-DEFAULT-AGE             PIC 99.
  3287             20  CF-MIN-TERM                PIC S999      COMP-3.
  3288             20  CF-MAX-TERM                PIC S999      COMP-3.
  3289             20  CF-DEFAULT-SEX             PIC X.
  3290             20  CF-JOINT-AGE-INPUT         PIC X.
  3291                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3292             20  CF-BIRTH-DATE-INPUT        PIC X.
  3293                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3294             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3295                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3296                 88  CF-ZERO-CARRIER            VALUE '1'.
  3297                 88  CF-ZERO-GROUPING           VALUE '2'.
  3298                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3299             20  CF-EDIT-SW                 PIC X.
  3300                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3301             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3302             20  CF-CR-PR-METHOD            PIC X.
  3303               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3304               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3305             20  FILLER                     PIC X.
  3306
  3307         16  CF-CREDIT-MISC-CONTROLS.
  3308             20  CF-REIN-TABLE-SW           PIC X.
  3309                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3310             20  CF-COMP-TABLE-SW           PIC X.
  3311                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3312             20  CF-EXPERIENCE-RETENTION-AGE
  3313                                            PIC S9        COMP-3.
  3314             20  CF-CONVERSION-DT           PIC XX.
  3315             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3316             20  CF-RUN-FREQUENCY-SW        PIC X.
  3317                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3318                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3319
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  59
* NSRASBL.cbl
  3320             20  CF-CR-CHECK-NO-CONTROL.
  3321                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3322                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3323                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3324                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3325                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3326                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3327
  3328                 24  CF-CR-CHECK-COUNT       REDEFINES
  3329                     CF-CR-CHECK-COUNTER      PIC X(4).
  3330
  3331                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3332                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3333
  3334                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3335                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3336                 24  CF-MAIL-PROCESSING       PIC X.
  3337                     88  MAIL-PROCESSING          VALUE 'Y'.
  3338
  3339         16  CF-MISC-SYSTEM-CONTROL.
  3340             20  CF-SYSTEM-C                 PIC X.
  3341                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3342             20  CF-SYSTEM-D                 PIC X.
  3343                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3344             20  CF-SOC-SEC-NO-SW            PIC X.
  3345                 88  SOC-SEC-NO-USED             VALUE '1'.
  3346             20  CF-MEMBER-NO-SW             PIC X.
  3347                 88  MEMBER-NO-USED              VALUE '1'.
  3348             20  CF-TAX-ID-NUMBER            PIC X(11).
  3349             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3350             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3351                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3352                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3353                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3354                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3355             20  CF-SYSTEM-E                 PIC X.
  3356                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3357
  3358         16  CF-LGX-LIFE-USER               PIC X.
  3359             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3360             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3361
  3362         16  CF-CR-MONTH-END-DT             PIC XX.
  3363
  3364         16  CF-FILE-MAINT-DATES.
  3365             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3366                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3367             20  CF-LAST-BATCH       REDEFINES
  3368                 CF-LAST-BATCH-NO               PIC X(4).
  3369             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3370             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3371             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3372             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3373             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3374             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3375             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3376             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3377             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  60
* NSRASBL.cbl
  3378             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3379
  3380         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3381         16  FILLER                         PIC X.
  3382
  3383         16  CF-ALT-MORT-CODE               PIC X(4).
  3384         16  CF-MEMBER-CAPTION              PIC X(10).
  3385
  3386         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3387             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3388             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3389             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3390             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3391             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3392
  3393         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3394
  3395         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3396         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3397         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3398         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3399
  3400         16  CF-AH-OVERRIDE-L1              PIC X.
  3401         16  CF-AH-OVERRIDE-L2              PIC XX.
  3402         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3403         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3404
  3405         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3406         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3407
  3408         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3409         16  CF-AR-LAST-EL860-DT            PIC XX.
  3410         16  CF-MP-MONTH-END-DT             PIC XX.
  3411
  3412         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3413         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3414             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3415
  3416         16  CF-AR-MONTH-END-DT             PIC XX.
  3417
  3418         16  CF-CRDTCRD-USER                PIC X.
  3419             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3420             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3421
  3422         16  CF-CC-MONTH-END-DT             PIC XX.
  3423
  3424         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3425
  3426         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3427             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3428             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3429             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3430         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3431         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3432         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3433         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3434             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3435             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  61
* NSRASBL.cbl
  3436         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3437         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3438         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3439             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3440         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3441
  3442         16  CF-CL-ZIP-CODE.
  3443             20  CF-CL-ZIP-PRIME.
  3444                 24  CF-CL-ZIP-1ST          PIC X.
  3445                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3446                 24  FILLER                 PIC X(4).
  3447             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3448         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3449             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3450             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3451             20  FILLER                     PIC XXX.
  3452
  3453         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3454         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3455         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3456         16  CF-CO-OPTION-START-DATE        PIC XX.
  3457         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3458           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3459                                                      '3' '4'.
  3460           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3461           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3462           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3463           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3464           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3465           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3466
  3467         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3468
  3469         16  CF-PAYMENT-APPROVAL-LEVELS.
  3470             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3471             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3472             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3473             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3474             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3475             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3476
  3477         16  CF-END-USER-REPORTING-USER     PIC X.
  3478             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3479             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3480
  3481         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3482             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3483             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3484
  3485         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3486
  3487         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3488         16  FILLER                         PIC X.
  3489
  3490         16  CF-CREDIT-ARCHIVE-CNTL.
  3491             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3492             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3493             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  62
* NSRASBL.cbl
  3494
  3495         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3496
  3497         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3498             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3499             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3500
  3501         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3502             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3503             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3504
  3505         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3506
  3507         16  CF-CO-ACH-ID-CODE              PIC  X.
  3508             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3509             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3510             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3511         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3512         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3513         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3514         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3515         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3516         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3517         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3518         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3519         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3520                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3521         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3522                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3523
  3524         16  CF-CO-OVER-SHORT.
  3525             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3526             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3527
  3528*         16  FILLER                         PIC X(102).
  3529         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3530             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3531             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3532
  3533         16  CF-AH-APPROVAL-DAYS.
  3534             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3535             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3536             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3537             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3538
  3539         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3540
  3541         16  CF-APPROV-LEV-5.
  3542             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3543             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3544             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3545
  3546         16  FILLER                         PIC X(68).
  3547****************************************************************
  3548*             PROCESSOR/USER RECORD                            *
  3549****************************************************************
  3550
  3551     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  63
* NSRASBL.cbl
  3552         16  CF-PROCESSOR-NAME              PIC X(30).
  3553         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3554         16  CF-PROCESSOR-TITLE             PIC X(26).
  3555         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3556                 88  MESSAGE-YES                VALUE 'Y'.
  3557                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3558
  3559*****************************************************
  3560****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3561****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3562****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3563****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3564*****************************************************
  3565
  3566         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3567             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3568             20  CF-APPLICATION-FORCE       PIC X.
  3569             20  CF-INDIVIDUAL-APP.
  3570                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3571                     28  CF-BROWSE-APP      PIC X.
  3572                     28  CF-UPDATE-APP      PIC X.
  3573
  3574         16  CF-CURRENT-TERM-ON             PIC X(4).
  3575         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3576             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3577             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3578             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3579             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3580             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3581             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3582             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3583         16  CF-PROCESSOR-CARRIER           PIC X.
  3584             88  NO-CARRIER-SECURITY            VALUE ' '.
  3585         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3586             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3587         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3588             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3589         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3590             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3591
  3592         16  CF-PROC-SYS-ACCESS-SW.
  3593             20  CF-PROC-CREDIT-CLAIMS-SW.
  3594                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3595                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3596                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3597                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3598             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3599                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3600                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3601             20  CF-PROC-LIFE-GNRLDGR-SW.
  3602                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3603                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3604                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3605                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3606             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3607                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3608                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3609         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  64
* NSRASBL.cbl
  3610             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3611             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3612         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3613
  3614         16  CF-APPROVAL-LEVEL                  PIC X.
  3615             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3616             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3617             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3618             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3619             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3620
  3621         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3622
  3623         16  CF-LANGUAGE-TYPE                   PIC X.
  3624             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3625             88  CF-LANG-IS-FR                      VALUE 'F'.
  3626
  3627         16  CF-CSR-IND                         PIC X.
  3628         16  FILLER                             PIC X(239).
  3629
  3630****************************************************************
  3631*             PROCESSOR/REMINDERS RECORD                       *
  3632****************************************************************
  3633
  3634     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3635         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3636             20  CF-START-REMIND-DT         PIC XX.
  3637             20  CF-END-REMIND-DT           PIC XX.
  3638             20  CF-REMINDER-TEXT           PIC X(50).
  3639         16  FILLER                         PIC X(296).
  3640
  3641
  3642****************************************************************
  3643*             STATE MASTER RECORD                              *
  3644****************************************************************
  3645
  3646     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3647         16  CF-STATE-ABBREVIATION          PIC XX.
  3648         16  CF-STATE-NAME                  PIC X(25).
  3649         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3650         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3651             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3652             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3653             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3654             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3655                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3656                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3657             20  CF-ST-PREM-REJECT-SW       PIC X.
  3658                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3659                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3660             20  CF-ST-REF-REJECT-SW        PIC X.
  3661                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3662                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3663         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3664         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3665         16  CF-ST-REFUND-RULES.
  3666             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3667             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  65
* NSRASBL.cbl
  3668             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3669         16  CF-ST-FST-PMT-EXTENSION.
  3670             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3671             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3672                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3673                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3674                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3675                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3676         16  CF-ST-STATE-CALL.
  3677             20  CF-ST-CALL-UNEARNED        PIC X.
  3678             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3679             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3680         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3681             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3682             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3683         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3684         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3685         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3686         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3687         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3688         16  FILLER                         PIC X.
  3689         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3690             20  CF-ST-BENEFIT-CD           PIC XX.
  3691             20  CF-ST-BENEFIT-KIND         PIC X.
  3692                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3693                 88  CF-ST-AH-KIND              VALUE 'A'.
  3694             20  CF-ST-REM-TERM-CALC        PIC X.
  3695                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3696                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3697                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3698                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3699                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3700                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3701                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3702                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3703
  3704             20  CF-ST-REFUND-CALC          PIC X.
  3705                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3706                 88  ST-REFD-BY-R78             VALUE '1'.
  3707                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3708                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3709                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3710                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3711                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3712                 88  ST-REFD-UTAH               VALUE '7'.
  3713                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3714                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3715                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3716
  3717             20  CF-ST-EARNING-CALC         PIC X.
  3718                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3719                 88  ST-EARN-BY-R78             VALUE '1'.
  3720                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3721                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3722                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3723                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3724                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3725                 88  ST-EARN-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  66
* NSRASBL.cbl
  3726                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3727
  3728             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3729                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3730                 88  ST-OVRD-BY-R78             VALUE '1'.
  3731                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3732                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3733                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3734                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3735                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3736                 88  ST-OVRD-MEAN               VALUE '8'.
  3737                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3738             20  cf-st-extra-periods        pic 9.
  3739*            20  FILLER                     PIC X.
  3740
  3741         16  CF-ST-COMMISSION-CAPS.
  3742             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3743             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3744             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3745             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3746         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3747                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3748
  3749         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3750
  3751         16  CF-ST-STATUTORY-INTEREST.
  3752             20  CF-ST-STAT-DATE-FROM       PIC X.
  3753                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3754                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3755             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3756             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3757             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3758             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3759             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3760
  3761         16  CF-ST-OVER-SHORT.
  3762             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3763             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3764
  3765         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3766
  3767         16  CF-ST-RT-CALC                  PIC X.
  3768
  3769         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3770         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3771         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3772         16  CF-ST-RF-LR-CALC               PIC X.
  3773         16  CF-ST-RF-LL-CALC               PIC X.
  3774         16  CF-ST-RF-LN-CALC               PIC X.
  3775         16  CF-ST-RF-AH-CALC               PIC X.
  3776         16  CF-ST-RF-CP-CALC               PIC X.
  3777*        16  FILLER                         PIC X(206).
  3778*CIDMOD         16  FILLER                         PIC X(192).
  3779         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3780             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3781         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3782         16  CF-ST-VFY-2ND-BENE             PIC X.
  3783         16  CF-ST-CAUSAL-STATE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  67
* NSRASBL.cbl
  3784         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3785         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3786         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3787             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3788         16  CF-ST-NET-ONLY-STATE           PIC X.
  3789             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3790         16  FILLER                         PIC X(181).
  3791
  3792****************************************************************
  3793*             BENEFIT MASTER RECORD                            *
  3794****************************************************************
  3795
  3796     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3797         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3798             20  CF-BENEFIT-CODE            PIC XX.
  3799             20  CF-BENEFIT-NUMERIC  REDEFINES
  3800                 CF-BENEFIT-CODE            PIC XX.
  3801             20  CF-BENEFIT-ALPHA           PIC XXX.
  3802             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3803             20  CF-BENEFIT-COMMENT         PIC X(10).
  3804
  3805             20  CF-LF-COVERAGE-TYPE        PIC X.
  3806                 88  CF-REDUCING                VALUE 'R'.
  3807                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3808
  3809             20  CF-SPECIAL-CALC-CD         PIC X.
  3810                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3811                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3812                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3813                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3814                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3815                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3816                 88  CF-FARM-PLAN               VALUE 'F'.
  3817                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3818                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3819                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3820                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3821                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3822                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3823                 88  CF-PRUDENTIAL              VALUE 'P'.
  3824                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3825                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3826                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3827                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3828                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3829                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3830
  3831             20  CF-JOINT-INDICATOR         PIC X.
  3832                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3833
  3834*            20  FILLER                     PIC X(12).
  3835             20  cf-maximum-benefits        pic s999 comp-3.
  3836             20  FILLER                     PIC X(09).
  3837             20  CF-BENEFIT-CATEGORY        PIC X.
  3838             20  CF-LOAN-TYPE               PIC X(8).
  3839
  3840             20  CF-CO-REM-TERM-CALC        PIC X.
  3841                 88  CO-EARN-AFTER-15TH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  68
* NSRASBL.cbl
  3842                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3843                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3844                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3845                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3846
  3847             20  CF-CO-EARNINGS-CALC        PIC X.
  3848                 88  CO-EARN-BY-R78             VALUE '1'.
  3849                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3850                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3851                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3852                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3853                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3854                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3855                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3856
  3857             20  CF-CO-REFUND-CALC          PIC X.
  3858                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3859                 88  CO-REFD-BY-R78             VALUE '1'.
  3860                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3861                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3862                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3863                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3864                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3865                 88  CO-REFD-MEAN               VALUE '8'.
  3866                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3867                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3868                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3869
  3870             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3871                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3872                 88  CO-OVRD-BY-R78             VALUE '1'.
  3873                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3874                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3875                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3876                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3877                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3878                 88  CO-OVRD-MEAN               VALUE '8'.
  3879                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3880
  3881             20  CF-CO-BEN-I-G-CD           PIC X.
  3882                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3883                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3884                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3885
  3886         16  FILLER                         PIC X(304).
  3887
  3888
  3889****************************************************************
  3890*             CARRIER MASTER RECORD                            *
  3891****************************************************************
  3892
  3893     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3894         16  CF-ADDRESS-DATA.
  3895             20  CF-MAIL-TO-NAME            PIC X(30).
  3896             20  CF-IN-CARE-OF              PIC X(30).
  3897             20  CF-ADDRESS-LINE-1          PIC X(30).
  3898             20  CF-ADDRESS-LINE-2          PIC X(30).
  3899             20  CF-CITY-STATE              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  69
* NSRASBL.cbl
  3900             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3901             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3902
  3903         16  CF-CLAIM-NO-CONTROL.
  3904             20  CF-CLAIM-NO-METHOD         PIC X.
  3905                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3906                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3907                 88  CLAIM-NO-SEQ               VALUE '3'.
  3908                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3909             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3910                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3911                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3912                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3913
  3914         16  CF-CHECK-NO-CONTROL.
  3915             20  CF-CHECK-NO-METHOD         PIC X.
  3916                 88  CHECK-NO-MANUAL            VALUE '1'.
  3917                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3918                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3919                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3920             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3921                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3922
  3923         16  CF-DOMICILE-STATE              PIC XX.
  3924
  3925         16  CF-EXPENSE-CONTROLS.
  3926             20  CF-EXPENSE-METHOD          PIC X.
  3927                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3928                 88  DOLLARS-PER-PMT            VALUE '2'.
  3929                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3930                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3931             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3932             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3933
  3934         16  CF-CORRESPONDENCE-CONTROL.
  3935             20  CF-LETTER-RESEND-OPT       PIC X.
  3936                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3937                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3938             20  FILLER                     PIC X(4).
  3939
  3940         16  CF-RESERVE-CONTROLS.
  3941             20  CF-MANUAL-SW               PIC X.
  3942                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3943             20  CF-FUTURE-SW               PIC X.
  3944                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3945             20  CF-PTC-SW                  PIC X.
  3946                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3947             20  CF-IBNR-SW                 PIC X.
  3948                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3949             20  CF-PTC-LF-SW               PIC X.
  3950                 88  CF-LF-PTC-USED             VALUE '1'.
  3951             20  CF-CDT-ACCESS-METHOD       PIC X.
  3952                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3953                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3954                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3955             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3956
  3957         16  CF-CLAIM-CALC-METHOD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  70
* NSRASBL.cbl
  3958             88  360-PLUS-MONTHS                VALUE '1'.
  3959             88  365-PLUS-MONTHS                VALUE '2'.
  3960             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3961             88  360-DAILY                      VALUE '4'.
  3962             88  365-DAILY                      VALUE '5'.
  3963
  3964         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3965         16  FILLER                         PIC X(11).
  3966
  3967         16  CF-LIMIT-AMOUNTS.
  3968             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3969             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3970             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3971             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3972             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3973             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3974             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3975             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3976             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3977             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3978
  3979         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3980         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3981         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3982
  3983         16  CF-ZIP-CODE.
  3984             20  CF-ZIP-PRIME.
  3985                 24  CF-ZIP-1ST             PIC X.
  3986                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3987                 24  FILLER                 PIC X(4).
  3988             20  CF-ZIP-PLUS4               PIC X(4).
  3989         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3990             20  CF-CAN-POSTAL-1            PIC XXX.
  3991             20  CF-CAN-POSTAL-2            PIC XXX.
  3992             20  FILLER                     PIC XXX.
  3993
  3994         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3995         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3996         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3997
  3998         16  CF-RATING-SWITCH               PIC X.
  3999             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4000             88  CF-NO-RATING                   VALUE 'N'.
  4001
  4002         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4003
  4004         16  CF-CARRIER-OVER-SHORT.
  4005             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4006             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4007
  4008         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4009         16  CF-SECPAY-SWITCH               PIC X.
  4010             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4011             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4012         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4013         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4014         16  FILLER                         PIC X(444).
  4015*        16  FILLER                         PIC X(452).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  71
* NSRASBL.cbl
  4016
  4017
  4018****************************************************************
  4019*             MORTALITY MASTER RECORD                          *
  4020****************************************************************
  4021
  4022     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4023         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4024                                INDEXED BY CF-MORT-NDX.
  4025             20  CF-MORT-TABLE              PIC X(5).
  4026             20  CF-MORT-TABLE-TYPE         PIC X.
  4027                 88  CF-MORT-JOINT              VALUE 'J'.
  4028                 88  CF-MORT-SINGLE             VALUE 'S'.
  4029                 88  CF-MORT-COMBINED           VALUE 'C'.
  4030                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4031                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4032             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4033             20  CF-MORT-AGE-METHOD         PIC XX.
  4034                 88  CF-AGE-LAST                VALUE 'AL'.
  4035                 88  CF-AGE-NEAR                VALUE 'AN'.
  4036             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4037             20  CF-MORT-ADJUSTMENT-DIRECTION
  4038                                            PIC X.
  4039                 88  CF-MINUS                   VALUE '-'.
  4040                 88  CF-PLUS                    VALUE '+'.
  4041             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4042             20  CF-MORT-JOINT-CODE         PIC X.
  4043                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4044             20  CF-MORT-PC-Q               PIC X.
  4045                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4046             20  CF-MORT-TABLE-CODE         PIC X(4).
  4047             20  CF-MORT-COMMENTS           PIC X(15).
  4048             20  FILLER                     PIC X(14).
  4049
  4050         16  FILLER                         PIC X(251).
  4051
  4052
  4053****************************************************************
  4054*             BUSSINESS TYPE MASTER RECORD                     *
  4055****************************************************************
  4056
  4057     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4058* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4059* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4060* AND RECORD 05 IS TYPES 81-99
  4061         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4062             20  CF-BUSINESS-TITLE          PIC  X(19).
  4063             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4064                                            PIC S9V9(4) COMP-3.
  4065             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4066             20  FILLER                     PIC  X.
  4067         16  FILLER                         PIC  X(248).
  4068
  4069
  4070****************************************************************
  4071*             TERMINAL MASTER RECORD                           *
  4072****************************************************************
  4073
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  72
* NSRASBL.cbl
  4074     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4075
  4076         16  CF-COMPANY-TERMINALS.
  4077             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4078                                  PIC X(4).
  4079         16  FILLER               PIC X(248).
  4080
  4081
  4082****************************************************************
  4083*             LIFE EDIT MASTER RECORD                          *
  4084****************************************************************
  4085
  4086     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4087         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4088             20  CF-LIFE-CODE-IN            PIC XX.
  4089             20  CF-LIFE-CODE-OUT           PIC XX.
  4090         16  FILLER                         PIC X(248).
  4091
  4092
  4093****************************************************************
  4094*             AH EDIT MASTER RECORD                            *
  4095****************************************************************
  4096
  4097     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4098         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4099             20  CF-AH-CODE-IN              PIC XXX.
  4100             20  CF-AH-CODE-OUT             PIC XX.
  4101         16  FILLER                         PIC X(248).
  4102
  4103
  4104****************************************************************
  4105*             CREDIBILITY TABLES                               *
  4106****************************************************************
  4107
  4108     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4109         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4110                             INDEXED BY CF-CRDB-NDX.
  4111             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4112             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4113             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4114         16  FILLER                         PIC  X(332).
  4115
  4116
  4117****************************************************************
  4118*             REPORT CUSTOMIZATION RECORD                      *
  4119****************************************************************
  4120
  4121     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4122         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4123             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4124             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4125             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4126**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4127****       A T-TRANSFER.                                   ****
  4128             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4129
  4130         16  FILLER                         PIC XX.
  4131
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  73
* NSRASBL.cbl
  4132         16  CF-CARRIER-CNTL-OPT.
  4133             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4134                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4135                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4136             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4137                                            PIC X.
  4138         16  CF-GROUP-CNTL-OPT.
  4139             20  CF-GROUP-OPT-SEQ           PIC 9.
  4140                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4141                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4142             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4143                                            PIC X(6).
  4144         16  CF-STATE-CNTL-OPT.
  4145             20  CF-STATE-OPT-SEQ           PIC 9.
  4146                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4147                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4148             20  CF-STATE-SELECT OCCURS 3 TIMES
  4149                                            PIC XX.
  4150         16  CF-ACCOUNT-CNTL-OPT.
  4151             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4152                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4153                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4154             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4155                                            PIC X(10).
  4156         16  CF-BUS-TYP-CNTL-OPT.
  4157             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4158                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4159                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4160             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4161                                            PIC XX.
  4162         16  CF-LF-TYP-CNTL-OPT.
  4163             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4164                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4165                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4166             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4167                                            PIC XX.
  4168         16  CF-AH-TYP-CNTL-OPT.
  4169             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4170                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4171                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4172             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4173                                            PIC XX.
  4174         16  CF-REPTCD1-CNTL-OPT.
  4175             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4176                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4177                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4178             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4179                                            PIC X(10).
  4180         16  CF-REPTCD2-CNTL-OPT.
  4181             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4182                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4183                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4184             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4185                                            PIC X(10).
  4186         16  CF-USER1-CNTL-OPT.
  4187             20  CF-USER1-OPT-SEQ           PIC 9.
  4188                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4189                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  74
* NSRASBL.cbl
  4190             20  CF-USER1-SELECT OCCURS 3 TIMES
  4191                                            PIC X(10).
  4192         16  CF-USER2-CNTL-OPT.
  4193             20  CF-USER2-OPT-SEQ           PIC 9.
  4194                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4195                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4196             20  CF-USER2-SELECT OCCURS 3 TIMES
  4197                                            PIC X(10).
  4198         16  CF-USER3-CNTL-OPT.
  4199             20  CF-USER3-OPT-SEQ           PIC 9.
  4200                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4201                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4202             20  CF-USER3-SELECT OCCURS 3 TIMES
  4203                                            PIC X(10).
  4204         16  CF-USER4-CNTL-OPT.
  4205             20  CF-USER4-OPT-SEQ           PIC 9.
  4206                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4207                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4208             20  CF-USER4-SELECT OCCURS 3 TIMES
  4209                                            PIC X(10).
  4210         16  CF-USER5-CNTL-OPT.
  4211             20  CF-USER5-OPT-SEQ           PIC 9.
  4212                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4213                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4214             20  CF-USER5-SELECT OCCURS 3 TIMES
  4215                                            PIC X(10).
  4216         16  CF-REINS-CNTL-OPT.
  4217             20  CF-REINS-OPT-SEQ           PIC 9.
  4218                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4219                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4220             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4221                 24  CF-REINS-PRIME         PIC XXX.
  4222                 24  CF-REINS-SUB           PIC XXX.
  4223
  4224         16  CF-AGENT-CNTL-OPT.
  4225             20  CF-AGENT-OPT-SEQ           PIC 9.
  4226                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4227                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4228             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4229                                            PIC X(10).
  4230
  4231         16  FILLER                         PIC X(43).
  4232
  4233         16  CF-LOSS-RATIO-SELECT.
  4234             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4235             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4236         16  CF-ENTRY-DATE-SELECT.
  4237             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4238             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4239         16  CF-EFFECTIVE-DATE-SELECT.
  4240             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4241             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4242
  4243         16  CF-EXCEPTION-LIST-IND          PIC X.
  4244             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4245
  4246         16  FILLER                         PIC X(318).
  4247
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  75
* NSRASBL.cbl
  4248****************************************************************
  4249*                  EXCEPTION REPORTING RECORD                  *
  4250****************************************************************
  4251
  4252     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4253         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4254             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4255
  4256         16  CF-COMBINED-LIFE-AH-OPT.
  4257             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4258             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4259             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4260             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4261
  4262         16  CF-LIFE-OPT.
  4263             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4264             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4265             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4266             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4267             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4268             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4269             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4270             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4271             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4272             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4273
  4274         16  CF-AH-OPT.
  4275             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4276             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4277             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4278             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4279             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4280             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4281             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4282             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4283             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4284             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4285
  4286         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4287             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4288             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4289             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4290
  4291         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4292
  4293         16  FILLER                         PIC X(673).
  4294
  4295
  4296****************************************************************
  4297*             MORTGAGE SYSTEM PLAN RECORD                      *
  4298****************************************************************
  4299
  4300     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4301         16  CF-PLAN-TYPE                   PIC X.
  4302             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4303             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4304             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4305         16  CF-PLAN-ABBREV                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  76
* NSRASBL.cbl
  4306         16  CF-PLAN-DESCRIPT               PIC X(10).
  4307         16  CF-PLAN-NOTES                  PIC X(20).
  4308         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4309         16  CF-PLAN-UNDERWRITING.
  4310             20  CF-PLAN-TERM-DATA.
  4311                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4312                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4313             20  CF-PLAN-AGE-DATA.
  4314                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4315                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4316                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4317             20  CF-PLAN-BENEFIT-DATA.
  4318                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4319                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4320                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4321                                            PIC S9(7)V99  COMP-3.
  4322         16  CF-PLAN-POLICY-FORMS.
  4323             20  CF-POLICY-FORM             PIC X(12).
  4324             20  CF-MASTER-APPLICATION      PIC X(12).
  4325             20  CF-MASTER-POLICY           PIC X(12).
  4326         16  CF-PLAN-RATING.
  4327             20  CF-RATE-CODE               PIC X(5).
  4328             20  CF-SEX-RATING              PIC X.
  4329                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4330                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4331             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4332             20  CF-SUB-STD-TYPE            PIC X.
  4333                 88  CF-PCT-OF-PREM            VALUE '1'.
  4334                 88  CF-PCT-OF-BENE            VALUE '2'.
  4335         16  CF-PLAN-PREM-TOLERANCES.
  4336             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4337             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4338         16  CF-PLAN-PYMT-TOLERANCES.
  4339             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4340             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4341         16  CF-PLAN-MISC-DATA.
  4342             20  FILLER                     PIC X.
  4343             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4344             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4345         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4346         16  CF-PLAN-IND-GRP                PIC X.
  4347             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4348                                                     '1'.
  4349             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4350                                                     '2'.
  4351         16  CF-MIB-SEARCH-SW               PIC X.
  4352             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4353             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4354             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4355             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4356         16  CF-ALPHA-SEARCH-SW             PIC X.
  4357             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4358             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4359             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4360             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4361             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4362             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4363             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  77
* NSRASBL.cbl
  4364             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4365             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4366             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4367                                                     'A' 'B' 'C'
  4368                                                     'X' 'Y' 'Z'.
  4369         16  CF-EFF-DT-RULE-SW              PIC X.
  4370             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4371             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4372             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4373             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4374             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4375         16  FILLER                         PIC X(4).
  4376         16  CF-HEALTH-QUESTIONS            PIC X.
  4377             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4378         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4379         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4380         16  CF-PLAN-SNGL-JNT               PIC X.
  4381             88  CF-COMBINED-PLAN              VALUE 'C'.
  4382             88  CF-JNT-PLAN                   VALUE 'J'.
  4383             88  CF-SNGL-PLAN                  VALUE 'S'.
  4384         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4385         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4386         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4387         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4388         16  CF-RERATE-CNTL                 PIC  X.
  4389             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4390             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4391             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4392             88  CF-AUTO-RECALC                 VALUE '4'.
  4393         16  CF-BENEFIT-TYPE                PIC  X.
  4394             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4395             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4396         16  CF-POLICY-FEE                  PIC S999V99
  4397                                                    COMP-3.
  4398         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4399         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4400         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4401         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4402         16  FILLER                         PIC  X(32).
  4403         16  CF-TERMINATION-FORM            PIC  X(04).
  4404         16  FILLER                         PIC  X(08).
  4405         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4406                                                       COMP-3.
  4407         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4408         16  CF-ISSUE-LETTER                PIC  X(4).
  4409         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4410         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4411             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4412             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4413         16  CF-MP-REFUND-CALC              PIC X.
  4414             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4415             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4416             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4417             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4418             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4419             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4420             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4421             88  CF-MP-REFD-MEAN                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  78
* NSRASBL.cbl
  4422         16  CF-ALT-RATE-CODE               PIC  X(5).
  4423
  4424
  4425         16  FILLER                         PIC X(498).
  4426****************************************************************
  4427*             MORTGAGE COMPANY MASTER RECORD                   *
  4428****************************************************************
  4429
  4430     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4431         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4432         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4433             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4434             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4435             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4436             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4437             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4438
  4439         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4440         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4441         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4442         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4443         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4444
  4445         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4446             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4447         16  CF-MP-RECON-USE-IND            PIC X(1).
  4448             88  CF-MP-USE-RECON             VALUE 'Y'.
  4449         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4450             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4451         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4452             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4453             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4454         16  FILLER                         PIC X(1).
  4455         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4456             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4457         16  CF-MORTG-MIB-VERSION           PIC X.
  4458             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4459             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4460             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4461         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4462             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4463                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4464             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4465                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4466             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4467                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4468             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4469                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4470             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4471                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4472             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4473                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4474         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4475         16  FILLER                         PIC X(7).
  4476         16  CF-MORTG-DESTINATION-SYMBOL.
  4477             20  CF-MORTG-MIB-COMM          PIC X(5).
  4478             20  CF-MORTG-MIB-TERM          PIC X(5).
  4479         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  79
* NSRASBL.cbl
  4480             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4481         16  FILLER                         PIC X(03).
  4482         16  CF-MP-CHECK-NO-CONTROL.
  4483             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4484                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4485                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4486                                                ' ' LOW-VALUES.
  4487                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4488                                               VALUE '3'.
  4489         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4490         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4491         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4492             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4493                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4494             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4495                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4496             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4497                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4498             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4499                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4500             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4501                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4502             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4503                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4504         16  CF-MORTG-BILLING-AREA.
  4505             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4506                                            PIC X.
  4507         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4508         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4509         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4510         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4511             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4512             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4513         16  FILLER                         PIC X.
  4514         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4515             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4516             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4517         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4518         16  FILLER                         PIC X(8).
  4519         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4520         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4521         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4522         16  CF-ACH-COMPANY-ID.
  4523             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4524                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4525                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4526                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4527             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4528         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4529             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4530         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4531             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4532             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4533         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4534         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4535         16  FILLER                         PIC X(536).
  4536
  4537****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  80
* NSRASBL.cbl
  4538*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4539****************************************************************
  4540
  4541     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4542         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4543             20  CF-FEMALE-HEIGHT.
  4544                 24  CF-FEMALE-FT           PIC 99.
  4545                 24  CF-FEMALE-IN           PIC 99.
  4546             20  CF-FEMALE-MIN-WT           PIC 999.
  4547             20  CF-FEMALE-MAX-WT           PIC 999.
  4548         16  FILLER                         PIC X(428).
  4549
  4550     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4551         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4552             20  CF-MALE-HEIGHT.
  4553                 24  CF-MALE-FT             PIC 99.
  4554                 24  CF-MALE-IN             PIC 99.
  4555             20  CF-MALE-MIN-WT             PIC 999.
  4556             20  CF-MALE-MAX-WT             PIC 999.
  4557         16  FILLER                         PIC X(428).
  4558******************************************************************
  4559*             AUTOMATIC ACTIVITY RECORD                          *
  4560******************************************************************
  4561     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4562         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4563             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4564             20  CF-SYS-LETTER-ID           PIC X(04).
  4565             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4566             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4567             20  CF-SYS-RESET-SW            PIC X(01).
  4568             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4569             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4570
  4571         16  FILLER                         PIC X(50).
  4572
  4573         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4574             20  CF-USER-ACTIVE-SW          PIC X(01).
  4575             20  CF-USER-LETTER-ID          PIC X(04).
  4576             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4577             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4578             20  CF-USER-RESET-SW           PIC X(01).
  4579             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4580             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4581             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4582
  4583         16  FILLER                         PIC X(246).
  4584*                                COPY NSCASVARS.
  4585******************************************************************
  4586*                   C H A N G E   L O G
  4587*
  4588*        CURRENT SIZE - 6180
  4589*
  4590* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4591*-----------------------------------------------------------------
  4592*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4593* EFFECTIVE    NUMBER
  4594*-----------------------------------------------------------------
  4595* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  81
* NSRASBL.cbl
  4596* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4597* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4598* 121015  CR2015100900001  TANA  ADD VIN NUMBER
  4599******************************************************************
  4600 01 NAPER-OUTPUT-DATA.
  4601    05  F                       PIC X(07) VALUE "LETTER=".
  4602    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4603    05  F                       PIC X(08) VALUE "~PROCID=".
  4604    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4605    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4606    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4607    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4608    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4609    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4610    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4611    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4612    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4613    05  F                       PIC X(06) VALUE "~CARR=".
  4614    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4615    05  F                       PIC X(10) VALUE "~GROUPING=".
  4616    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4617    05  F                       PIC X(08) VALUE "~CERTST=".
  4618    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4619    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4620    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4621    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4622    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4623    05  F                       PIC X(07) VALUE "~CRTNO=".
  4624    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4625    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4626    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4627    05  F                       PIC X(08) VALUE "~ILNAME=".
  4628    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4629    05  F                       PIC X(08) VALUE "~IFNAME=".
  4630    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4631    05  F                       PIC X(08) VALUE "~IFINIT=".
  4632    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4633    05  F                       PIC X(08) VALUE "~IMINIT=".
  4634    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4635    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4636    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4637    05  F                       PIC X(06) VALUE "~ISEX=".
  4638    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4639    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4640    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4641    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4642    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4643    05  F                       PIC X(09) VALUE "~INSCITY=".
  4644    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4645    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4646    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4647    05  F                       PIC X(08) VALUE "~INSZIP=".
  4648    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4649    05  F                       PIC X(05) VALUE "~SSN=".
  4650    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4651    05  F                       PIC X(07) VALUE "~MEMNO=".
  4652    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4653    05  F                       PIC X(08) VALUE "~JLNAME=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  82
* NSRASBL.cbl
  4654    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4655    05  F                       PIC X(08) VALUE "~JFNAME=".
  4656    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4657    05  F                       PIC X(08) VALUE "~JMINIT=".
  4658    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4659    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4660    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4661    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4662    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4663    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4664    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4665    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4666    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4667    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4668    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4669    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4670    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4671    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4672    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4673    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4674    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4675    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4676    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4677    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4678    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4679    05  F                       PIC X(10) VALUE "~BENENAME=".
  4680    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4681    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4682    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4683    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4684    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4685    05  F                       PIC X(10) VALUE "~BENECITY=".
  4686    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4687    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4688    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4689    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4690    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4691    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4692    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4693    05  F                       PIC X(08) VALUE "~RESPNO=".
  4694    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4695    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4696    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4697    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4698    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4699    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4700    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4701    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4702    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4703    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4704    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4705    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4706    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4707    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4708    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4709    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4710    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4711    05  F                       PIC X(09) VALUE "~COMPFAX=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  83
* NSRASBL.cbl
  4712    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4713    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4714    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4715    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4716    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4717    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4718    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4719    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4720    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4721    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4722    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4723    05  F                       PIC X(07) VALUE "~BATCH=".
  4724    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4725    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4726    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4727    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4728    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4729    05  F                       PIC X(05) VALUE "~APR=".
  4730    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4731    05  F                       PIC X(08) VALUE "~LNTERM=".
  4732    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4733    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4734    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4735    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4736    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4737    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4738    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4739    05  F                       PIC X(07) VALUE "~UCODE=".
  4740    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4741    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4742    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4743    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4744    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4745    05  F                       PIC X(06) VALUE "~SKIP=".
  4746    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4747    05  F                       PIC X(06) VALUE "~MODE=".
  4748    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4749    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4750    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4751    05  F                       PIC X(06) VALUE "~RTBL=".
  4752    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4753    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4754    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4755    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4756    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4757    05  F                       PIC X(08) VALUE "~LFTERM=".
  4758    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4759    05  F                       PIC X(07) VALUE "~LFDEV=".
  4760    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4761    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4762    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4763    05  F                       PIC X(07) VALUE "~LFBEN=".
  4764    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4765    05  F                       PIC X(08) VALUE "~LFPREM=".
  4766    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4767    05  F                       PIC X(08) VALUE "~LFABEN=".
  4768    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4769    05  F                       PIC X(09) VALUE "~LFAPREM=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  84
* NSRASBL.cbl
  4770    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4771    05  F                       PIC X(07) VALUE "~LFNSP=".
  4772    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4773    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4774    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4775    05  F                       PIC X(07) VALUE "~LFCAN=".
  4776    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4777    05  F                       PIC X(07) VALUE "~LFDTH=".
  4778    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4779    05  F                       PIC X(08) VALUE "~LFRATE=".
  4780    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4781    05  F                       PIC X(09) VALUE "~LFARATE=".
  4782    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4783    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4784    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4785    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4786    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4787    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4788    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4789    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4790    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4791    05  F                       PIC X(07) VALUE "~DTHDT=".
  4792    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4793    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4794    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4795    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4796    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4797    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4798    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4799    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4800    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4801    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4802    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4803    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4804    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4805    05  F                       PIC X(08) VALUE "~AHTERM=".
  4806    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4807    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4808    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4809    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4810    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4811    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4812    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4813    05  F                       PIC X(07) VALUE "~AHBEN=".
  4814    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4815    05  F                       PIC X(08) VALUE "~AHPREM=".
  4816    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4817    05  F                       PIC X(07) VALUE "~AHNSP=".
  4818    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4819    05  F                       PIC X(07) VALUE "~AHCAN=".
  4820    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4821    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4822    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4823    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4824    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4825    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4826    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4827    05  F                       PIC X(08) VALUE "~AHRATE=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  85
* NSRASBL.cbl
  4828    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4829    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4830    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4831    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4832    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4833    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4834    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4835    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4836    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4837    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4838    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4839    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4840    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4841    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4842    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4843    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4844    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4845    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4846    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4847    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4848    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4849    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4850    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4851    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4852                                PIC X(2).
  4853    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4854    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4855    05  F                       PIC X(08) VALUE "~TOTREF=".
  4856    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4857    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4858    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4859    05  F                       PIC X(07) VALUE "~STERM=".
  4860    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4861    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4862    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4863    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4864    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4865    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4866    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4867    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4868    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4869    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4870    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4871    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4872    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4873    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4874    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4875    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4876    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4877    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4878    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4879    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4880    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4881    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4882    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4883    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4884                                PIC X(12).
  4885    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  86
* NSRASBL.cbl
  4886    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4887    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4888                                PIC X(12).
  4889    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4890    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4891    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4892    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4893    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4894    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4895    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4896    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4897    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4898                                PIC X(12).
  4899    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4900    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4901    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4902                                PIC X(10).
  4903    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4904    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4905    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4906    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4907    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4908    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4909    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4910    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4911    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4912    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4913    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4914    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4915    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4916                                PIC X(10).
  4917    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4918    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4919    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4920                                PIC X(10).
  4921    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4922    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4923    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4924    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4925    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4926    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4927    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4928    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4929    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4930    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4931    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4932    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4933    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4934    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4935    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4936    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4937    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4938    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4939    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4940                                PIC X(2).
  4941    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4942    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4943    05  F                       PIC X(08) VALUE "~OSTERM=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  87
* NSRASBL.cbl
  4944    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4945    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4946    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4947    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4948    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4949    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4950    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4951    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4952    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4953    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4954                                PIC X(09).
  4955    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4956    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4957    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4958    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4959    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4960    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4961    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4962    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4963    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4964                                PIC X(09).
  4965    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4966    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4967    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4968    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4969    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4970                                PIC X(09).
  4971    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4972    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4973    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4974                                PIC X(12).
  4975    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4976    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4977    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4978                                PIC X(10).
  4979    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4980    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4981    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4982    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4983    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4984                                PIC X(12).
  4985    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4986    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4987    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4988                                PIC X(10).
  4989    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4990    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4991    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4992    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4993    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4994    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4995    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4996    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4997    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4998                                PIC X(09).
  4999    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  5000    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  5001    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  88
* NSRASBL.cbl
  5002                                PIC X(09).
  5003    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  5004    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  5005    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  5006                                PIC X(10).
  5007    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  5008    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  5009    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  5010                                PIC X(10).
  5011    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  5012    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  5013    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  5014    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  5015    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  5016    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  5017    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  5018    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  5019    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  5020    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  5021    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  5022    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  5023    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  5024    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  5025    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  5026                                PIC X(09).
  5027    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  5028    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  5029    05  F                       PIC X(08) VALUE "~NSTERM=".
  5030    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  5031    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  5032                                PIC X(09).
  5033    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  5034    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  5035    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  5036    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  5037    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  5038    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  5039    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  5040    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  5041    05  F                       PIC X(09) VALUE "~BALLOON=".
  5042    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  5043    05  F                       PIC X(10) VALUE "~LEASEIND=".
  5044    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  5045    05  F                       PIC X(09) VALUE "~RESCIND=".
  5046    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  5047    05  F                       PIC X(07) VALUE "~RCD01=".
  5048    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  5049    05  F                       PIC X(07) VALUE "~RCD02=".
  5050    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  5051    05  F                       PIC X(07) VALUE "~RCD03=".
  5052    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  5053    05  F                       PIC X(07) VALUE "~RCD04=".
  5054    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  5055    05  F                       PIC X(07) VALUE "~RCD05=".
  5056    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  5057    05  F                       PIC X(07) VALUE "~RCD06=".
  5058    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  5059    05  F                       PIC X(07) VALUE "~RCD07=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  89
* NSRASBL.cbl
  5060    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  5061    05  F                       PIC X(07) VALUE "~RCD08=".
  5062    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  5063    05  F                       PIC X(07) VALUE "~RCD09=".
  5064    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  5065    05  F                       PIC X(07) VALUE "~RCD10=".
  5066    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  5067    05  F                       PIC X(07) VALUE "~RCD11=".
  5068    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  5069    05  F                       PIC X(07) VALUE "~RCD12=".
  5070    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  5071    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  5072    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  5073    05  F                       PIC X(08) VALUE "~ARCHNO=".
  5074    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  5075    05  F                       PIC X(06) VALUE "~FORM=".
  5076    05  OUT-FORM                PIC X(03) VALUE SPACES.
  5077    05  F                       PIC X(09) VALUE "~ENCLINE=".
  5078    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  5079    05  F                       PIC X(08) VALUE "~ATTACH=".
  5080    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  5081    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  5082    05  OUT-STACK               PIC X(10) VALUE SPACES.
  5083    05  F                       PIC X(11) VALUE "~STATENAME=".
  5084    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  5085    05  F                       PIC X(08) VALUE "~PRTNOW=".
  5086    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  5087    05  F                       PIC X(05) VALUE "~NCB=".
  5088    05  OUT-CHGBACK             PIC X     VALUE ' '.
  5089    05  F                       PIC X(8) VALUE "~CSOAMT=".
  5090    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  5091    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  5092    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  5093    05  F                       PIC X(09) VALUE "~LETRTYP=".
  5094    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  5095    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  5096    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  5097    05  F                       PIC X(08) VALUE "~INSBDT=".
  5098    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  5099    05  F                       PIC X(08) VALUE "~JNTBDT=".
  5100    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  5101    05  F                       PIC X(08) VALUE "~TOTINT=".
  5102    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  5103    05  F                       PIC X(8) VALUE "~TOPREM=".
  5104    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  5105    05  F                       PIC X(7) VALUE "~TOREF=".
  5106    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  5107    05  F                       PIC X(7) VALUE "~CANDT=".
  5108    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  5109    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  5110    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  5111    05  F                       PIC X(08) VALUE "~CERTID=".
  5112    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  5113    05  F                       PIC X(08) VALUE "~UNDWID=".
  5114    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  5115    05  F                       PIC X(8) VALUE "~TNPREM=".
  5116    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  5117    05  F                       PIC X(7) VALUE "~TNREF=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  90
* NSRASBL.cbl
  5118    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  5119    05  F                       PIC X(8)  VALUE "~COVIND=".
  5120    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  5121    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  5122    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  5123    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  5124    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  5125    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  5126    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  5127    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  5128    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  5129    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  5130    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  5131    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  5132                                PIC X(10).
  5133    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  5134    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5135    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  5136    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5137    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  5138    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5139    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  5140    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5141    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  5142    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5143    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  5144    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5145    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  5146    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  5147    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  5148    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5149    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  5150    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5151    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  5152    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  5153    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  5154    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  5155    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  5156    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5157    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  5158    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5159    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  5160    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  5161    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  5162    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  5163    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  5164    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5165    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  5166    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5167    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  5168    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  5169    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  5170    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5171    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  5172    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5173    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5174    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5175    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  91
* NSRASBL.cbl
  5176    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5177    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5178    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5179    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5180    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5181    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5182    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5183    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5184    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5185    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5186    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5187    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5188    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5189    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5190    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5191    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5192    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5193    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5194    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5195    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5196    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5197    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5198    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5199    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5200    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5201    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5202    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5203    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5204    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5205    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5206    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5207    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5208    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5209    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5210    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5211    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5212    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5213    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5214    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5215    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5216    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5217    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5218    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5219    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5220    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5221    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5222    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5223    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5224    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5225    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5226    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5227    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5228    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5229    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5230    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5231    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5232    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5233    05  F                       PIC X(8)  VALUE "~SCREEN=".
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  92
* NSRASBL.cbl
  5234    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5235    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5236    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5237    05  F                       PIC X(7)  VALUE "~VINNO=".
  5238    05  OUT-VIN-NUMBER          PIC X(17) VALUE SPACES.
  5239    05  F                       PIC X(11) VALUE 'EndOfString'.
  5240    05  f                       pic x(2) value spaces.
  5241*                                COPY ERCARCH.
  5242******************************************************************
  5243*                                                                *
  5244*                            ERCARCH.                            *
  5245*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5246*                            VMOD=2.002                          *
  5247*                                                                *
  5248*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5249*                                                                *
  5250*   FILE TYPE = VSAM,KSDS                                        *
  5251*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5252*                                                                *
  5253*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5254*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5255*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5256*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5257*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5258*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5259*                                                                *
  5260*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5261******************************************************************
  5262*                   C H A N G E   L O G
  5263*
  5264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5265*-----------------------------------------------------------------
  5266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5267* EFFECTIVE    NUMBER
  5268*-----------------------------------------------------------------
  5269* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5270* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5271* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5272******************************************************************
  5273 01  LETTER-ARCHIVE.
  5274     12  LA-RECORD-ID                PIC  X(02).
  5275         88  LA-VALID-ID                VALUE 'LA'.
  5276
  5277     12  LA-CONTROL-PRIMARY.
  5278         16  LA-COMPANY-CD           PIC  X(01).
  5279         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5280
  5281     12  LA-CONTROL-BY-CERT-RESP.
  5282         16  LA-COMPANY-CD-A2        PIC  X(01).
  5283         16  LA-CERT-NO-A2.
  5284             20  LA-CERT-PRIME-A2    PIC  X(10).
  5285             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5286         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5287             20  LA-RESP-PERSON-A2   PIC  X(10).
  5288             20  LA-TYPE-A2          PIC  X(01).
  5289         16  LA-CARRIER-A2           PIC  X(01).
  5290         16  LA-GROUPING-A2          PIC  X(06).
  5291         16  LA-STATE-A2             PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  93
* NSRASBL.cbl
  5292         16  LA-ACCOUNT-A2           PIC  X(10).
  5293         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5294         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5295
  5296     12  LA-CONTROL-BY-FORM.
  5297         16  LA-COMPANY-CD-A3        PIC  X(01).
  5298         16  LA-FORM-A3              PIC  X(04).
  5299         16  LA-CARRIER-A3           PIC  X(01).
  5300         16  LA-GROUPING-A3          PIC  X(06).
  5301         16  LA-STATE-A3             PIC  X(02).
  5302         16  LA-ACCOUNT-A3           PIC  X(10).
  5303         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5304
  5305     12  LA-CONTROL-BY-PROCESSOR.
  5306         16  LA-COMPANY-CD-A4        PIC  X(01).
  5307         16  LA-PROCESSOR-CD         PIC  X(04).
  5308         16  LA-CARRIER-A4           PIC  X(01).
  5309         16  LA-GROUPING-A4          PIC  X(06).
  5310         16  LA-STATE-A4             PIC  X(02).
  5311         16  LA-ACCOUNT-A4           PIC  X(10).
  5312         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5313
  5314     12  LA-CONTROL-BY-KEY-FIELDS.
  5315         16  LA-COMPANY-CD-A5        PIC  X(01).
  5316         16  LA-CARRIER-A5           PIC  X(01).
  5317         16  LA-GROUPING-A5          PIC  X(06).
  5318         16  LA-STATE-A5             PIC  X(02).
  5319         16  LA-ACCOUNT-A5           PIC  X(10).
  5320         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5321
  5322     12  LA-CONTROL-BY-GROUP-CODE.
  5323         16  LA-COMPANY-CD-A6        PIC  X(01).
  5324         16  LA-ENTRY-A6.
  5325             20  LA-FILLER           PIC  X(02).
  5326             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5327         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5328
  5329     12  FILLER                      PIC  X(09).
  5330
  5331     12  LA-HEADER-RECORD.
  5332         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5333         16  LA-CREATION-DATE        PIC  X(02).
  5334         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5335         16  LA-FINAL-ACT-DATE       REDEFINES
  5336               LA-FOLLOW-UP-DATE     PIC  X(02).
  5337         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5338         16  LA-NO-OF-COPIES         PIC S9(01).
  5339         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5340         16  LA-REPLY-DATE           PIC  X(02).
  5341         16  LA-RESEND-DATES.
  5342             20  LA-RESEND-DATE      PIC  X(02).
  5343             20  LA-SENT-DATE        PIC  X(02).
  5344             20  FILLER              PIC  X(08).
  5345         16  LA-SOURCE-INFORMATION.
  5346             20  LA-DATA-SOURCE      PIC  X(01).
  5347             20  LA-ADDR-SOURCE      PIC  X(01).
  5348         16  LA-STATUS               PIC  X(01).
  5349             88  LA-STATUS-ACTIVE         VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  94
* NSRASBL.cbl
  5350             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5351             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5352             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5353             88  LA-STATUS-PURGED         VALUE 'P'.
  5354             88  LA-STATUS-VOIDED         VALUE 'V'.
  5355         16  LA-LAST-RESENT-PRINT-DATE
  5356                                     PIC  X(02).
  5357         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5358             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5359                                          VALUE 'C'.
  5360             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5361                                          VALUE 'F'.
  5362             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5363                                          VALUE 'P'.
  5364         16  LA-PURGED-DATE          PIC  X(02).
  5365         16  LA-VOIDED-DATE          PIC  X(02).
  5366         16  LA-RESEND-LETR          PIC  X(4).
  5367         16  FILLER                  PIC  X(08).
  5368*        16  LA-RESEND-LETR-2        PIC  X(4).
  5369*        16  LA-RESEND-LETR-3        PIC  X(4).
  5370*        16  FILLER                  PIC  X(59).
  5371         16  LA-ARCHIVE-STATUS       PIC  X.
  5372             88  LA-TEMP                VALUE 'T'.
  5373             88  LA-QWS                 VALUE 'Q'.
  5374             88  LA-BATCH               VALUE 'B'.
  5375         16  LA-FINAL-ACT-IND        PIC  X(1).
  5376         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5377         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5378         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5379                                     PIC X(4).
  5380         16  FILLER                  PIC  X(42).
  5381*        16  FILLER                  PIC  X(71).
  5382         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5383         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5384         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5385                                     PIC  X(4).
  5386         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5387
  5388******************************************************************
  5389*                                COPY ELCCRTT.
  5390******************************************************************
  5391*                                                                *
  5392*                            ELCCRTT.                            *
  5393*                                                                *
  5394*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5395*                                                                *
  5396*   FILE TYPE = VSAM,KSDS                                        *
  5397*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5398*                                                                *
  5399*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5400*                                                                *
  5401*   LOG = YES                                                    *
  5402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5403******************************************************************
  5404*                   C H A N G E   L O G
  5405*
  5406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5407*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  95
* NSRASBL.cbl
  5408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5409* EFFECTIVE    NUMBER
  5410*-----------------------------------------------------------------
  5411* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5412* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5413* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5414* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5415* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5416* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5417* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5418* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5419******************************************************************
  5420
  5421 01  CERTIFICATE-TRAILERS.
  5422     12  CS-RECORD-ID                      PIC XX.
  5423         88  VALID-CS-ID                      VALUE 'CS'.
  5424
  5425     12  CS-CONTROL-PRIMARY.
  5426         16  CS-COMPANY-CD                 PIC X.
  5427         16  CS-CARRIER                    PIC X.
  5428         16  CS-GROUPING                   PIC X(6).
  5429         16  CS-STATE                      PIC XX.
  5430         16  CS-ACCOUNT                    PIC X(10).
  5431         16  CS-CERT-EFF-DT                PIC XX.
  5432         16  CS-CERT-NO.
  5433             20  CS-CERT-PRIME             PIC X(10).
  5434             20  CS-CERT-SFX               PIC X.
  5435         16  CS-TRAILER-TYPE               PIC X.
  5436             88  COMM-TRLR           VALUE 'A'.
  5437             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5438             88  CERT-DATA-TRLR      VALUE 'C'.
  5439
  5440     12  CS-DATA-AREA                      PIC X(516).
  5441
  5442     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5443         16  CS-BANK-COMMISSION-AREA.
  5444             20  CS-BANK-COMMS       OCCURS 10.
  5445                 24  CS-AGT                PIC X(10).
  5446                 24  CS-COM-TYP            PIC X.
  5447                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5448                 24  CS-RECALC-LV-INDIC    PIC X.
  5449                 24  FILLER                PIC X(10).
  5450         16  FILLER                        PIC X(256).
  5451
  5452     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5453****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5454         16  CS-MB-CLAIM-DATA OCCURS 24.
  5455             20  CS-CLAIM-NO               PIC X(7).
  5456             20  CS-CLAIM-TYPE             PIC X.
  5457                 88  CS-AH-CLM               VALUE 'A'.
  5458                 88  CS-IU-CLM               VALUE 'I'.
  5459                 88  CS-GP-CLM               VALUE 'G'.
  5460                 88  CS-LF-CLM               VALUE 'L'.
  5461                 88  CS-PR-CLM               VALUE 'P'.
  5462                 88  CS-FL-CLM               VALUE 'F'.
  5463             20  CS-INSURED-TYPE           PIC X.
  5464                 88  CS-PRIM-INSURED          VALUE 'P'.
  5465                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  96
* NSRASBL.cbl
  5466             20  CS-BENEFIT-PERIOD         PIC 99.
  5467             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5468             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5469             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5470         16  FILLER                        PIC X(12).
  5471     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5472         16  CS-VIN-NUMBER                 PIC X(17).
  5473         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5474         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5475         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5476         16  cs-agent-name.
  5477             20  cs-agent-fname            pic x(20).
  5478             20  cs-agent-mi               pic x.
  5479             20  cs-agent-lname            pic x(25).
  5480         16  cs-license-no                 pic x(15).
  5481         16  cs-npn-number                 pic x(10).
  5482         16  cs-agent-edit-status          pic x.
  5483             88  cs-ae-refer-to-manager      value 'M'.
  5484             88  cs-ae-cover-sheet           value 'C'.
  5485             88  cs-ae-sig-form              value 'S'.
  5486             88  cs-ae-verified              value 'V'.
  5487             88  cs-unidentified-signature   value 'U'.
  5488             88  cs-cert-returned            value 'R'.
  5489             88  cs-accept-no-commission     value 'N'.
  5490         16  FILLER                        PIC X(424).
  5491*        16  FILLER                        PIC X(496).
  5492 01  FILLER                      PIC X(500)  VALUE SPACES.
  5493*                                COPY ELCENCC.
  5494******************************************************************
  5495*                                                                *
  5496*                                                                *
  5497*                            ELCENCC                             *
  5498*                            VMOD=2.001                          *
  5499*                                                                *
  5500*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5501*                                                                *
  5502*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5503*   A NAPERSOFT DOCUMENT                                         *
  5504*                                                                *
  5505*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5506*                                                                *
  5507*   FILE TYPE = VSAM,KSDS                                        *
  5508*   RECORD SIZE = 400   RECFORM = FIX                            *
  5509*                                                                *
  5510*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5511*                                                                *
  5512*   LOG = NO                                                     *
  5513*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5514*                                                                *
  5515*                                                                *
  5516******************************************************************
  5517*                   C H A N G E   L O G
  5518*
  5519* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5520*-----------------------------------------------------------------
  5521*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5522* EFFECTIVE    NUMBER
  5523*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  97
* NSRASBL.cbl
  5524* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5525******************************************************************
  5526 01  ENCLOSURE-CODES.
  5527     12  NC-RECORD-ID                      PIC XX.
  5528         88  VALID-NC-ID                      VALUE 'NC'.
  5529     12  NC-CONTROL-PRIMARY.
  5530         16  NC-COMPANY-CD                 PIC X.
  5531         16  NC-REC-TYPE                   PIC X.
  5532             88  NC-CLAIMS                   VALUE '1'.
  5533             88  NC-ADMIN                    VALUE '2'.
  5534         16  NC-ENC-CODE                   PIC X(5).
  5535         16  FILLER                        PIC X(09).
  5536     12  NC-MAINT-INFORMATION.
  5537         16  NC-LAST-MAINT-DT              PIC XX.
  5538         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5539         16  NC-LAST-MAINT-USER            PIC X(4).
  5540         16  FILLER                        PIC XX.
  5541     12  NC-OUTPUT-STACK                   PIC XXX.
  5542     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5543     12  NC-ATTACHMENTS                    PIC X(100).
  5544     12  NC-FUTURE                         PIC X(50).
  5545     12  FILLER                            PIC X(117).
  5546******************************************************************
  5547****************************************************************
  5548*
  5549* Copyright (c) 2007 by Clerity Solutions, Inc.
  5550* All rights reserved.
  5551*
  5552****************************************************************
  5553 01  DFHEIV.
  5554   02  DFHEIV0               PIC X(35).
  5555   02  DFHEIV1               PIC X(08).
  5556   02  DFHEIV2               PIC X(08).
  5557   02  DFHEIV3               PIC X(08).
  5558   02  DFHEIV4               PIC X(06).
  5559   02  DFHEIV5               PIC X(04).
  5560   02  DFHEIV6               PIC X(04).
  5561   02  DFHEIV7               PIC X(02).
  5562   02  DFHEIV8               PIC X(02).
  5563   02  DFHEIV9               PIC X(01).
  5564   02  DFHEIV10              PIC S9(7) COMP-3.
  5565   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5566   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5567   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5568   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5569   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5570   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5571   02  DFHEIV17              PIC X(04).
  5572   02  DFHEIV18              PIC X(04).
  5573   02  DFHEIV19              PIC X(04).
  5574   02  DFHEIV20              USAGE IS POINTER.
  5575   02  DFHEIV21              USAGE IS POINTER.
  5576   02  DFHEIV22              USAGE IS POINTER.
  5577   02  DFHEIV23              USAGE IS POINTER.
  5578   02  DFHEIV24              USAGE IS POINTER.
  5579   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5580   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5581   02  DFHEIV27              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  98
* NSRASBL.cbl
  5582   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5583   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5584   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5585   02  FILLER                PIC X(02).
  5586   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5587   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5588   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5589   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5590   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5591 LINKAGE  SECTION.
  5592*****************************************************************
  5593*                                                               *
  5594* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5595* All rights reserved.                                          *
  5596*                                                               *
  5597*****************************************************************
  5598 01  dfheiblk.
  5599     02  eibtime          pic s9(7) comp-3.
  5600     02  eibdate          pic s9(7) comp-3.
  5601     02  eibtrnid         pic x(4).
  5602     02  eibtaskn         pic s9(7) comp-3.
  5603     02  eibtrmid         pic x(4).
  5604     02  dfheigdi         pic s9(4) comp.
  5605     02  eibcposn         pic s9(4) comp.
  5606     02  eibcalen         pic s9(4) comp.
  5607     02  eibaid           pic x(1).
  5608     02  eibfiller1       pic x(1).
  5609     02  eibfn            pic x(2).
  5610     02  eibfiller2       pic x(2).
  5611     02  eibrcode         pic x(6).
  5612     02  eibfiller3       pic x(2).
  5613     02  eibds            pic x(8).
  5614     02  eibreqid         pic x(8).
  5615     02  eibrsrce         pic x(8).
  5616     02  eibsync          pic x(1).
  5617     02  eibfree          pic x(1).
  5618     02  eibrecv          pic x(1).
  5619     02  eibsend          pic x(1).
  5620     02  eibatt           pic x(1).
  5621     02  eibeoc           pic x(1).
  5622     02  eibfmh           pic x(1).
  5623     02  eibcompl         pic x(1).
  5624     02  eibsig           pic x(1).
  5625     02  eibconf          pic x(1).
  5626     02  eiberr           pic x(1).
  5627     02  eibrldbk         pic x(1).
  5628     02  eiberrcd         pic x(4).
  5629     02  eibsynrb         pic x(1).
  5630     02  eibnodat         pic x(1).
  5631     02  eibfiller5       pic x(2).
  5632     02  eibresp          pic 9(09) comp.
  5633     02  eibresp2         pic 9(09) comp.
  5634     02  dfheigdj         pic s9(4) comp.
  5635     02  dfheigdk         pic s9(4) comp.
  5636 01 dfhcommarea                  PIC X(6500).
  5637
  5638 01  var  pic x(30).
  5639 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page  99
* NSRASBL.cbl
  5640 0000-DFHEXIT SECTION.
  5641     MOVE '9#                    $   ' TO DFHEIV0.
  5642     MOVE 'NSRASBL' TO DFHEIV1.
  5643     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5644     display ' entering pgm nsrasbl '
  5645     display ' commarea ' dfhcommarea
  5646     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5647     MOVE '5'                    TO DC-OPTION-CODE
  5648     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5649     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5650     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5651     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5652     MOVE DC-DAY-OF-WEEK         TO SAVE-CYCLE-DAY-OF-WEEK
  5653     move dfhcommarea            to srch-commarea
  5654*****************************************************
  5655* The full       key has been established and passed
  5656* to this program via NSRASLTR
  5657*****************************************************
  5658     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5659     display ' input data ' bl-carrier ' ' bl-group ' '
  5660        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5661     MOVE BL-LETTER-ID           TO OUT-LETTER
  5662     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5663     MOVE BL-CARRIER             TO OUT-CARRIER
  5664     MOVE BL-GROUP               TO OUT-GROUPING
  5665     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5666     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5667     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5668     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5669     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5670        DC-EDITA-DAY  DELIMITED BY SIZE
  5671        INTO OUT-CYCLE-DT
  5672     END-STRING
  5673
  5674     set P to address of KIXSYS
  5675     CALL "getenv" using by value P returning var-ptr
  5676     if var-ptr = null then
  5677        display ' kixsys not set '
  5678     else
  5679        set address of var to var-ptr
  5680        move 0 to env-var-len
  5681        inspect var tallying env-var-len
  5682          for characters before X'00'
  5683        unstring var (1:env-var-len) delimited by '/'
  5684        into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5685              WS-KIX-SYS
  5686        end-unstring
  5687     end-if
  5688
  5689     set P to address of KIXHOST
  5690     CALL "getenv" using by value P returning var-ptr
  5691     if var-ptr = null then
  5692        display ' kixhost not set '
  5693     else
  5694        set address of var to var-ptr
  5695        move 0 to env-var-len
  5696        inspect var tallying env-var-len
  5697          for characters before X'00'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 100
* NSRASBL.cbl
  5698        MOVE var(1:env-var-len)  to ws-kixhost
  5699        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  5700     end-if
  5701
  5702**** This routine will connect to the Logic Database on SQL Server
  5703**** and call a stored procedure to determine the next business da
  5704
  5705     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  5706     IF SQLCODE = 0
  5707        PERFORM 4200-GET-NEXT-BUS-DT  THRU 4200-EXIT
  5708        IF SQLCODE = 0
  5709            MOVE WS-NEXT-BUS-DT TO SAVE-NEXT-BUS-DT-EDIT-A
  5710                                   WS-EDIT-A-DATE
  5711            MOVE WS-EDIT-A-YY   TO DC-YMD-YEAR
  5712            MOVE WS-EDIT-A-MM   TO DC-YMD-MONTH
  5713            MOVE WS-EDIT-A-DD   TO DC-YMD-DAY
  5714            MOVE '3'            TO DC-OPTION-CODE
  5715            PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5716            IF NO-CONVERSION-ERROR
  5717               MOVE DC-BIN-DATE-1 TO SAVE-BIN-NEXT-BUS-DT
  5718            ELSE
  5719               MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5720               MOVE '6'         TO DC-OPTION-CODE
  5721               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5722               IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5723                  MOVE 3        TO DC-ELAPSED-DAYS
  5724               ELSE
  5725                 IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5726                    MOVE 2     TO DC-ELAPSED-DAYS
  5727                 ELSE
  5728                    MOVE 1     TO DC-ELAPSED-DAYS
  5729                 END-IF
  5730               END-IF
  5731               PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5732               IF NO-CONVERSION-ERROR
  5733                   MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5734                   MOVE DC-GREG-DATE-A-EDIT TO
  5735                                SAVE-NEXT-BUS-DT-EDIT-A
  5736               ELSE
  5737                   MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5738                   MOVE WS-SAVE-EDIT-A-DATE TO
  5739                                SAVE-NEXT-BUS-DT-EDIT-A
  5740               END-IF
  5741            END-IF
  5742        ELSE
  5743            MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5744            MOVE '6'         TO DC-OPTION-CODE
  5745            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5746            IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5747               MOVE 3        TO DC-ELAPSED-DAYS
  5748            ELSE
  5749              IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5750                 MOVE 2     TO DC-ELAPSED-DAYS
  5751              ELSE
  5752                 MOVE 1     TO DC-ELAPSED-DAYS
  5753              END-IF
  5754            END-IF
  5755            PERFORM 9700-DATE-LINK   THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 101
* NSRASBL.cbl
  5756            IF NO-CONVERSION-ERROR
  5757                MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5758                MOVE DC-GREG-DATE-A-EDIT TO
  5759                                SAVE-NEXT-BUS-DT-EDIT-A
  5760            ELSE
  5761                MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5762                MOVE WS-SAVE-EDIT-A-DATE TO
  5763                                SAVE-NEXT-BUS-DT-EDIT-A
  5764            END-IF
  5765        END-IF
  5766     ELSE
  5767        MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5768        MOVE '6'         TO DC-OPTION-CODE
  5769        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5770        IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5771           MOVE 3        TO DC-ELAPSED-DAYS
  5772        ELSE
  5773          IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5774             MOVE 2     TO DC-ELAPSED-DAYS
  5775          ELSE
  5776             MOVE 1     TO DC-ELAPSED-DAYS
  5777          END-IF
  5778        END-IF
  5779        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5780        IF NO-CONVERSION-ERROR
  5781            MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5782            MOVE DC-GREG-DATE-A-EDIT TO
  5783                                SAVE-NEXT-BUS-DT-EDIT-A
  5784        ELSE
  5785            MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5786            MOVE WS-SAVE-EDIT-A-DATE TO
  5787                                SAVE-NEXT-BUS-DT-EDIT-A
  5788        END-IF
  5789     END-IF
  5790     PERFORM 4300-DISCONNECT THRU 4300-EXIT
  5791
  5792     MOVE SAVE-NEXT-BUS-DT-EDIT-A  TO WS-EDIT-A-DATE
  5793     STRING WS-EDIT-A-CCYY '-' WS-EDIT-A-MM '-'
  5794           WS-EDIT-A-DD ' 00:00:00.0' DELIMITED BY SIZE
  5795              INTO OUT-NEXT-BUS-DT
  5796     END-STRING
  5797     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5798        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5799     ELSE
  5800        IF BL-EFF-DT = SPACES
  5801           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5802        ELSE
  5803           IF BL-EFF-DT (9:2) = SPACES
  5804              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5805                     BL-EFF-DT (4:2)
  5806                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5807              END-STRING
  5808           ELSE
  5809              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5810                     BL-EFF-DT (4:2)
  5811                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5812              END-STRING
  5813           END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 102
* NSRASBL.cbl
  5814           MOVE '3'              TO DC-OPTION-CODE
  5815           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5816           IF NO-CONVERSION-ERROR
  5817              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5818           ELSE
  5819              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5820              SET BL-FAIL TO TRUE
  5821              GO TO 0000-RETURN
  5822           END-IF
  5823        END-IF
  5824     END-IF
  5825     perform 0800-init-out-data  thru 0800-exit
  5826     SET BL-FAIL TO TRUE
  5827******************************************************************
  5828* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5829*    1) FROM ACCT MAINT
  5830*    2) FROM CERT UPDATE
  5831*    3) FROM COMP MAINT
  5832*    4) FROM REVIEW AND CORRECTIONS
  5833******************************************************************
  5834     EVALUATE BL-DATA-SRCE
  5835        WHEN '1'
  5836           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5837        WHEN '2'
  5838           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5839        WHEN '3'
  5840           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5841        WHEN '4'
  5842           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5843        WHEN OTHER
  5844           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5845     END-EVALUATE
  5846     IF BL-OK
  5847        display ' bl write erarch ' bl-write-erarch
  5848        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5849        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5850        IF BL-ARCHIVE-NO = ZEROS
  5851           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5852           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5853           display ' arch zeros, new arch ' bl-archive-no
  5854        END-IF
  5855        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5856        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5857        display ' bl write erarch ' bl-write-erarch
  5858        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5859           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5860           IF BL-FAIL
  5861              GO TO 0000-RETURN
  5862           END-IF
  5863        END-IF
  5864        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5865        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5866     END-IF
  5867     .
  5868 0000-RETURN.
  5869     move srch-commarea          to dfhcommarea
  5870
  5871* exec cics
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 103
* NSRASBL.cbl
  5872*       return
  5873*    end-exec
  5874*    MOVE '.(                    ''   #00005773' TO DFHEIV0
  5875     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5877     MOVE X'2020233030303035373733' TO DFHEIV0(25:11)
  5878     CALL 'kxdfhei1' USING DFHEIV0,
  5879           DFHEIV99,
  5880           DFHEIV99,
  5881           DFHEIV99,
  5882           DFHEIV99,
  5883           DFHEIV99,
  5884           DFHEIV99
  5885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5886     .
  5887 0100-DATA-SRCE-1.
  5888     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5889     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5890     MOVE ' '                    TO WS-ERACCT-SW
  5891     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5892     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5893     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5894     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5895     MOVE BL-STATE               TO WS-ERACCT-STATE
  5896     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5897     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5898                                    WS-CERT-EFF-DT
  5899     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5900     IF ACCT-FOUND
  5901        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5902        PERFORM 1025-GET-CSR-INFO
  5903                                 THRU 1025-EXIT
  5904        PERFORM 1300-DETERMINE-COMM
  5905                                 THRU 1300-EXIT
  5906        SET BL-OK TO TRUE
  5907     ELSE
  5908        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5909        SET BL-FAIL TO TRUE
  5910     END-IF
  5911     .
  5912 0100-EXIT.
  5913     EXIT.
  5914 0200-DATA-SRCE-2.
  5915     display ' made it to data srce 2 '
  5916     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5917     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5918     MOVE ' '                    TO WS-ELCERT-SW
  5919     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5920     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5921     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5922     MOVE BL-STATE               TO WS-ELCERT-STATE
  5923     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5924     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5925                                    WS-CERT-EFF-DT
  5926     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5927
  5928     MOVE ' '                 TO WS-ERACCT-SW
  5929     MOVE LOW-VALUES          TO WS-ERACCT-KEY
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 104
* NSRASBL.cbl
  5930     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5931     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5932     IF ACCT-FOUND
  5933        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5934        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5935     END-IF
  5936     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5937     IF CERT-FOUND
  5938        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5939        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5940        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5941        IF WS-LF-EARN = 'B'
  5942           MOVE 'B'              TO OUT-BALLOON-IND
  5943        END-IF
  5944        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5945        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5946        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5947        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5948
  5949        IF BL-ENDT-ARCH-NO > ZERO
  5950           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5951           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5952           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5953        ELSE
  5954           IF BL-ARCHIVE-NO > ZERO
  5955              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5956              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5957              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5958           END-IF
  5959        END-IF
  5960
  5961        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5962           AND (OUT-BALLOON-IND = 'B')
  5963           MOVE 'B'              TO OUT-FORM (3:1)
  5964        END-IF
  5965        SET BL-OK TO TRUE
  5966     ELSE
  5967        display ' cert not found ' ws-elcert-cert-no
  5968        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5969        SET BL-FAIL TO TRUE
  5970     END-IF
  5971     .
  5972 0200-EXIT.
  5973     EXIT.
  5974 0300-DATA-SRCE-3.
  5975     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5976     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5977     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5978     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5979     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5980     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5981     IF WS-ERCOMP-ACCOUNT = SPACES
  5982        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5983        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5984     ELSE
  5985        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5986     END-IF
  5987     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 105
* NSRASBL.cbl
  5988     IF RESP-NORMAL
  5989        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5990        PERFORM 1025-GET-CSR-INFO
  5991                                 THRU 1025-EXIT
  5992        SET BL-OK TO TRUE
  5993     ELSE
  5994        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5995        SET BL-FAIL TO TRUE
  5996     END-IF
  5997     .
  5998 0300-EXIT.
  5999     EXIT.
  6000 0400-DATA-SRCE-4.
  6001     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  6002     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  6003     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  6004     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  6005     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  6006                                    WS-ELCERT-SW WS-ERENDT-SW
  6007
  6008* EXEC CICS READ
  6009*         DATASET    ('ERPNDB')
  6010*         INTO       (PENDING-BUSINESS)
  6011*         RIDFLD     (WS-ERPNDB-KEY)
  6012*         RESP       (WS-RESPONSE)
  6013*    END-EXEC
  6014     MOVE LENGTH OF
  6015      PENDING-BUSINESS
  6016       TO DFHEIV11
  6017     MOVE 'ERPNDB' TO DFHEIV1
  6018*    MOVE '&"IL       E          (  N#00005897' TO DFHEIV0
  6019     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6021     MOVE X'204E233030303035383937' TO DFHEIV0(25:11)
  6022     CALL 'kxdfhei1' USING DFHEIV0,
  6023           DFHEIV1,
  6024           PENDING-BUSINESS,
  6025           DFHEIV11,
  6026           WS-ERPNDB-KEY,
  6027           DFHEIV99,
  6028           DFHEIV99,
  6029           DFHEIV99
  6030     MOVE EIBRESP  TO WS-RESPONSE
  6031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6032     IF RESP-NORMAL
  6033        IF PB-RECORD-TYPE = '1' OR '2'
  6034           MOVE PB-CARRIER       TO BL-CARRIER
  6035           MOVE PB-GROUPING      TO BL-GROUP
  6036           MOVE PB-STATE         TO BL-STATE
  6037           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  6038           MOVE PB-CERT-NO       TO BL-CERT-NO
  6039           MOVE PB-CSR-ID        TO WS-CSR-ID
  6040           IF PB-ISSUE
  6041              SET PROCESS-ISSUE TO TRUE
  6042              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  6043              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  6044              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  6045              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 106
* NSRASBL.cbl
  6046           ELSE
  6047              SET PROCESS-CANCEL TO TRUE
  6048              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  6049              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  6050              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  6051              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  6052           END-IF
  6053           PERFORM 1120-MATCH-CARRIER
  6054                                 THRU 1120-EXIT
  6055           PERFORM 1125-MATCH-STATE
  6056                                 THRU 1125-EXIT
  6057           PERFORM 1130-MATCH-BENCDS
  6058                                 THRU 1130-EXIT
  6059           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  6060           MOVE WS-LF-DESC       TO OUT-LF-DESC
  6061                                    OUT-ORIG-LF-DESC
  6062           IF WS-LF-EARN = 'B'
  6063              MOVE 'B'           TO OUT-BALLOON-IND
  6064           END-IF
  6065           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  6066                                    OUT-ORIG-WAIT-PER
  6067           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  6068                                    OUT-ORIG-RET-ELIM
  6069           MOVE WS-AH-DESC       TO OUT-AH-DESC
  6070                                    OUT-ORIG-AH-DESC
  6071           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  6072                                    OUT-ORIG-BEN-DAYS
  6073           PERFORM 1025-GET-CSR-INFO
  6074                                 THRU 1025-EXIT
  6075
  6076           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  6077           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  6078                                 TO WS-ERACCT-KEY (1:22)
  6079           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  6080           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  6081           IF ACCT-FOUND
  6082              MOVE AM-CSR-CODE      TO WS-CSR-ID
  6083              PERFORM 1025-GET-CSR-INFO
  6084                                    THRU 1025-EXIT
  6085              PERFORM 1300-DETERMINE-COMM
  6086                                    THRU 1300-EXIT
  6087           END-IF
  6088
  6089           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  6090                                 TO WS-ELCERT-KEY
  6091           PERFORM 1100-GET-ELCERT
  6092                                 THRU 1100-EXIT
  6093
  6094           IF BL-ENDT-ARCH-NO > ZERO
  6095              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  6096              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  6097              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6098           ELSE
  6099              IF BL-ARCHIVE-NO > ZERO
  6100                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  6101                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  6102                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6103              END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 107
* NSRASBL.cbl
  6104           END-IF
  6105
  6106           SET BL-OK TO TRUE
  6107           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  6108              AND (OUT-BALLOON-IND = 'B')
  6109              MOVE 'B'           TO OUT-FORM (3:1)
  6110           END-IF
  6111        END-IF
  6112     END-IF
  6113     .
  6114 0400-EXIT.
  6115     EXIT.
  6116 0500-SCRUB-DATA.
  6117*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  6118*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  6119*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  6120*   TO A HEX 26 TO GET BY THE DECODER
  6121     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  6122                                 TO M1
  6123     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  6124     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6125        (A1 > M1)
  6126        OR (WS-WORK-FIELD (A1:1) = '*')
  6127        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6128        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6129     END-PERFORM
  6130     IF A1 > M1
  6131        CONTINUE
  6132     ELSE
  6133        MOVE WS-WORK-FIELD (1:A1 - 1)
  6134                                 TO OUT-ACCT-NAME
  6135     END-IF
  6136     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  6137                                 TO M1
  6138     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  6139     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6140        (A1 > M1)
  6141        OR (WS-WORK-FIELD (A1:1) = '*')
  6142        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6143        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6144     END-PERFORM
  6145     IF A1 > M1
  6146        CONTINUE
  6147     ELSE
  6148        MOVE WS-WORK-FIELD (1:A1 - 1)
  6149                                 TO OUT-BENE-NAME
  6150     END-IF
  6151     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  6152         MOVE '0000000000 '  TO OUT-CERT-NO
  6153     END-IF
  6154     MOVE +1 TO M1
  6155     MOVE SPACES TO BL-RECORD-PASSED-DATA
  6156     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  6157                                 TO NS-LEN
  6158     display ' naper output data length ' ns-len
  6159     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6160        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  6161        OR (A1 > NS-LEN)
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 108
* NSRASBL.cbl
  6162        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  6163           CONTINUE
  6164        ELSE
  6165           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  6166              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  6167              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  6168              ADD +1 TO M1
  6169           ELSE
  6170              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  6171                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  6172                 ADD +3 TO M1
  6173              ELSE
  6174                 MOVE NAPER-OUTPUT-DATA (A1:1)
  6175                                 TO BL-RECORD-PASSED-DATA (M1:1)
  6176                 ADD +1 TO M1
  6177              END-IF
  6178           END-IF
  6179        END-IF
  6180     END-PERFORM
  6181     .
  6182 0500-EXIT.
  6183     EXIT.
  6184 0600-GET-ERENDT.
  6185
  6186* EXEC CICS READ
  6187*         DATASET    ('ERENDT2')
  6188*         INTO       (ENDORSEMENT-RECORD)
  6189*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  6190*         RESP       (WS-RESPONSE)
  6191*    END-EXEC
  6192     MOVE LENGTH OF
  6193      ENDORSEMENT-RECORD
  6194       TO DFHEIV11
  6195     MOVE 'ERENDT2' TO DFHEIV1
  6196*    MOVE '&"IL       E          (  N#00006056' TO DFHEIV0
  6197     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6199     MOVE X'204E233030303036303536' TO DFHEIV0(25:11)
  6200     CALL 'kxdfhei1' USING DFHEIV0,
  6201           DFHEIV1,
  6202           ENDORSEMENT-RECORD,
  6203           DFHEIV11,
  6204           WS-ERENDT-KEY-BY-ARCH,
  6205           DFHEIV99,
  6206           DFHEIV99,
  6207           DFHEIV99
  6208     MOVE EIBRESP  TO WS-RESPONSE
  6209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6210     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  6211         WS-ERENDT-ARCHIVE
  6212     IF (RESP-NORMAL)
  6213        SET ENDT-FOUND TO TRUE
  6214        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  6215        PERFORM 0650-PROCESS-NO-Change
  6216                                 THRU 0650-EXIT
  6217     END-IF
  6218     .
  6219 0600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 109
* NSRASBL.cbl
  6220     EXIT.
  6221 0620-BUILD-ENDT.
  6222     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  6223                                    OUT-NEW-LF-CAN-DT
  6224                                    OUT-ORIG-AH-CAN-DT
  6225                                    OUT-NEW-AH-CAN-DT
  6226                                    OUT-ORIG-CAN-DT
  6227                                    OUT-NEW-CAN-DT
  6228     IF EN-REC-TYPE = 'C'
  6229        GO TO 0620-PROCESS-CANCEL
  6230     END-IF
  6231     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  6232     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  6233     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6234     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  6235     IF WS-LF-EARN = 'B'
  6236        MOVE 'B'                 TO OUT-BALLOON-IND
  6237     END-IF
  6238     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  6239     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  6240     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  6241     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  6242     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  6243     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  6244     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  6245     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  6246         MOVE ZERO                 TO OUT-ORIG-IAGE
  6247     ELSE
  6248         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  6249     END-IF
  6250     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  6251     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  6252     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  6253     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  6254         MOVE ZERO                 TO OUT-ORIG-JAGE
  6255     ELSE
  6256         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  6257     END-IF
  6258     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  6259     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  6260     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  6261     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  6262     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  6263     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  6264     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6265                             EN-LF-ORIG-ALT-PRM-AMT
  6266     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  6267     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  6268         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  6269                                    OUT-ORIG-LF-PRM-A
  6270                                    OUT-ORIG-LF-ALT-BEN-A
  6271                                    OUT-ORIG-LF-ALT-PRM-A
  6272                                    OUT-ORIG-COVERAGE-IND
  6273     ELSE
  6274         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  6275         IF EN-LF-ORIG-PRM-AMT = .01
  6276             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  6277         END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 110
* NSRASBL.cbl
  6278         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  6279             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  6280         END-IF
  6281         IF EN-LF-ORIG-ALT-PRM-AMT = .01
  6282             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  6283         END-IF
  6284         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  6285             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  6286         END-IF
  6287     END-IF
  6288     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6289     MOVE ' '                    TO DC-OPTION-CODE
  6290     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6291     IF NO-CONVERSION-ERROR
  6292        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6293           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6294              INTO OUT-ORIG-LF-EXP-DT
  6295        END-STRING
  6296     END-IF
  6297     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6298     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6299     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  6300     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6301     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6302         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6303                                    OUT-ORIG-AH-PRM-A
  6304     ELSE
  6305        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6306            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6307        ELSE
  6308            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6309        END-IF
  6310        IF EN-AH-ORIG-PRM-AMT = .01
  6311            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6312        END-IF
  6313        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6314            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  6315        END-IF
  6316     END-IF
  6317     COMPUTE WS-WORK-PREM =
  6318        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6319           + EN-AH-ORIG-PRM-AMT
  6320     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  6321     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6322     MOVE ' '                    TO DC-OPTION-CODE
  6323     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6324     IF NO-CONVERSION-ERROR
  6325        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6326           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6327              INTO OUT-ORIG-AH-EXP-DT
  6328        END-STRING
  6329     END-IF
  6330     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6331                                    OUT-ORIG-MAX-PMTS
  6332     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6333         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6334     END-IF
  6335     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 111
* NSRASBL.cbl
  6336     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6337     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6338     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6339         MOVE ZERO                TO OUT-NEW-IAGE
  6340     ELSE
  6341         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6342     END-IF
  6343     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6344     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6345     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6346     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6347         MOVE ZERO                TO OUT-NEW-JAGE
  6348     ELSE
  6349         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6350     END-IF
  6351     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6352     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6353     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6354     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6355     IF WS-LF-EARN = 'B'
  6356        MOVE 'B'                 TO OUT-BALLOON-IND
  6357     END-IF
  6358     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6359     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6360     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6361     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6362     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6363     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6364     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6365     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6366     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6367     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6368     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6369                             EN-LF-NEW-ALT-PRM-AMT
  6370     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6371     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6372         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6373                                    OUT-NEW-LF-PRM-A
  6374                                    OUT-NEW-LF-ALT-BEN-A
  6375                                    OUT-NEW-LF-ALT-PRM-A
  6376                                    OUT-NEW-LF-CMB-PREM-A
  6377                                    OUT-NEW-COVERAGE-IND
  6378     ELSE
  6379         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6380     END-IF
  6381    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6382     MOVE ' '                     TO DC-OPTION-CODE
  6383     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6384     IF NO-CONVERSION-ERROR
  6385        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6386           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6387              INTO OUT-NEW-LF-EXP-DT
  6388        END-STRING
  6389     END-IF
  6390     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6391     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6392     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6393     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 112
* NSRASBL.cbl
  6394     COMPUTE WS-WORK-PREM =
  6395        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6396           + EN-AH-NEW-PRM-AMT
  6397     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6398     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6399         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6400                                    OUT-NEW-AH-PRM-A
  6401     ELSE
  6402        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6403            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6404        ELSE
  6405            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6406        END-IF
  6407     END-IF
  6408     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6409     MOVE ' '                     TO DC-OPTION-CODE
  6410     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6411     IF NO-CONVERSION-ERROR
  6412        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6413           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6414              INTO OUT-NEW-AH-EXP-DT
  6415        END-STRING
  6416     END-IF
  6417     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6418                                     OUT-NEW-MAX-PMTS
  6419     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6420         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6421     END-IF
  6422     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6423        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6424     ELSE
  6425        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6426     END-IF
  6427     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6428        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6429     ELSE
  6430        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6431     END-IF
  6432     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6433        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6434     ELSE
  6435        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6436     END-IF
  6437     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6438        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6439     ELSE
  6440        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6441     END-IF
  6442     COMPUTE WS-WORK-PREM =
  6443        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6444        EN-AH-NEW-PRM-AMT) -
  6445        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6446        EN-AH-ORIG-PRM-AMT)
  6447     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6448     IF EN-CSO-PORTION NOT NUMERIC
  6449        MOVE ZEROS               TO EN-CSO-PORTION
  6450     END-IF
  6451     IF EN-ACCT-PORTION NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 113
* NSRASBL.cbl
  6452        MOVE ZERO                TO EN-ACCT-PORTION
  6453     END-IF
  6454*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6455*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6456     IF WS-WORK-PREM > +0
  6457        MOVE 'CSO'               TO OUT-PAYEE
  6458     ELSE
  6459      IF WS-WORK-PREM = +0
  6460         MOVE 'ZERO'             TO OUT-PAYEE
  6461      ELSE
  6462         MOVE 'ACCT'             TO OUT-PAYEE
  6463      END-IF
  6464     END-IF
  6465     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6466        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6467     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6468     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6469        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6470     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6471     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6472        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6473        * EN-LF-ORIG-COMM-PCT
  6474     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6475     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6476        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6477     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6478     COMPUTE WS-ACCT-ORIG-PORTION =
  6479        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6480     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6481
  6482     COMPUTE WS-CSO-ORIG-LF-PORT =
  6483       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6484     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6485     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6486       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6487     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6488     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6489       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6490        WS-ACCT-ORIG-CMB-LF-PORT
  6491     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6492     COMPUTE WS-CSO-ORIG-AH-PORT =
  6493        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6494     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6495     COMPUTE WS-CSO-ORIG-PORTION =
  6496        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6497     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6498     COMPUTE WS-ACCT-NEW-LF-PORT =
  6499        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6500     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6501     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6502        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6503     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6504     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6505        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6506        * EN-LF-NEW-COMM-PCT
  6507     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6508     COMPUTE WS-ACCT-NEW-AH-PORT =
  6509        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 114
* NSRASBL.cbl
  6510     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6511     COMPUTE WS-ACCT-NEW-PORTION =
  6512        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6513     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6514
  6515     COMPUTE WS-CSO-NEW-LF-PORT =
  6516       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6517     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6518     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6519       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6520     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6521     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6522       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6523        WS-ACCT-NEW-CMB-LF-PORT
  6524     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6525     COMPUTE WS-CSO-NEW-AH-PORT =
  6526        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6527     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6528     COMPUTE WS-CSO-NEW-PORTION =
  6529        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6530     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6531
  6532     COMPUTE WS-ACCT-LF-PORT-CHG =
  6533        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6534     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6535     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6536        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6537     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6538     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6539        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6540     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6541     COMPUTE WS-ACCT-AH-PORT-CHG =
  6542        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6543     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6544     COMPUTE WS-ACCT-PORTION-CHG =
  6545        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6546     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6547
  6548     COMPUTE WS-CSO-LF-PORT-CHG =
  6549        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6550     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6551     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6552        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6553     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6554     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6555        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6556     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6557     COMPUTE WS-CSO-AH-PORT-CHG =
  6558        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6559     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6560     COMPUTE WS-CSO-PORTION-CHG =
  6561        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6562     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6563
  6564     COMPUTE WS-WORK-PREM =
  6565         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6566     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6567     COMPUTE WS-WORK-PREM =
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 115
* NSRASBL.cbl
  6568         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6569     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6570     COMPUTE WS-WORK-PREM =
  6571        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6572        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6573     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6574     COMPUTE WS-WORK-PREM =
  6575        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6576     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6577
  6578     move en-sig-sw              to out-sig-sw
  6579     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6580     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6581     GO TO 0620-CONTINUE
  6582     .
  6583 0620-PROCESS-CANCEL.
  6584     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6585        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6586        MOVE ' '                 TO DC-OPTION-CODE
  6587        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6588        IF NO-CONVERSION-ERROR
  6589           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6590              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6591                 INTO OUT-ORIG-LF-CAN-DT
  6592           END-STRING
  6593        END-IF
  6594        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6595     END-IF
  6596
  6597     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6598        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6599        MOVE ' '                 TO DC-OPTION-CODE
  6600        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6601        IF NO-CONVERSION-ERROR
  6602           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6603              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6604                 INTO OUT-NEW-LF-CAN-DT
  6605           END-STRING
  6606        END-IF
  6607        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6608     END-IF
  6609
  6610     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6611        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6612        MOVE ' '                    TO DC-OPTION-CODE
  6613        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6614        IF NO-CONVERSION-ERROR
  6615           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6616              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6617                 INTO OUT-ORIG-AH-CAN-DT
  6618           END-STRING
  6619        END-IF
  6620        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6621           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6622        END-IF
  6623     END-IF
  6624
  6625     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 116
* NSRASBL.cbl
  6626        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6627        MOVE ' '                    TO DC-OPTION-CODE
  6628        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6629        IF NO-CONVERSION-ERROR
  6630           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6631              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6632                 INTO OUT-NEW-AH-CAN-DT
  6633           END-STRING
  6634        END-IF
  6635        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6636           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6637        END-IF
  6638     END-IF
  6639     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6640     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6641     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6642     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6643     COMPUTE WS-WORK-PREM =
  6644        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6645     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6646     COMPUTE WS-WORK-PREM =
  6647        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6648     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6649     COMPUTE WS-WORK-PREM =
  6650        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6651        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6652     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6653
  6654     COMPUTE WS-WORK-PREM =
  6655        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6656     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6657     COMPUTE WS-WORK-PREM =
  6658        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6659     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6660
  6661*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6662*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6663     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6664
  6665     IF EN-COMM-CHGBK = 'N'
  6666         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6667                                   OUT-CSO-ORIG-ALT-LF-PORT
  6668         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6669         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6670         COMPUTE WS-CSO-ORIG-PORTION =
  6671             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6672         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6673         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6674                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6675                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6676                                   OUT-ACCT-ORIG-AH-PORT
  6677                                   OUT-ACCT-ORIG-PORTION
  6678
  6679         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6680                                   OUT-CSO-NEW-ALT-LF-PORT
  6681         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6682         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6683         COMPUTE WS-CSO-NEW-PORTION =
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 117
* NSRASBL.cbl
  6684             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6685         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6686         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6687                                   OUT-ACCT-NEW-ALT-LF-PORT
  6688                                   OUT-ACCT-NEW-CMB-LF-PORT
  6689                                   OUT-ACCT-NEW-AH-PORT
  6690                                   OUT-ACCT-NEW-PORTION
  6691
  6692         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6693                                   OUT-CSO-ALT-LF-PORT-CHG
  6694         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6695           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6696         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6697         COMPUTE WS-CSO-AH-PORT-CHG =
  6698           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6699         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6700         COMPUTE WS-CSO-PORTION-CHG =
  6701           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6702           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6703         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6704         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6705                                   OUT-ACCT-ALT-LF-PORT-CHG
  6706                                   OUT-ACCT-CMB-LF-PORT-CHG
  6707                                   OUT-ACCT-AH-PORT-CHG
  6708                                   OUT-ACCT-PORTION-CHG
  6709     ELSE
  6710         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6711                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6712         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6713           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6714         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6715                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6716         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6717           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6718         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6719         COMPUTE WS-ACCT-ORIG-PORTION =
  6720            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6721         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6722
  6723         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6724                                   OUT-CSO-ORIG-ALT-LF-PORT
  6725         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6726           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6727         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6728         COMPUTE WS-CSO-ORIG-AH-PORT =
  6729           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6730         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6731         COMPUTE WS-CSO-ORIG-PORTION =
  6732            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6733         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6734
  6735         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6736                                   OUT-ACCT-NEW-ALT-LF-PORT
  6737         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6738           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6739         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6740         COMPUTE WS-ACCT-NEW-AH-PORT =
  6741           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 118
* NSRASBL.cbl
  6742         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6743         COMPUTE WS-ACCT-NEW-PORTION =
  6744            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6745         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6746
  6747         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6748                                   OUT-CSO-NEW-ALT-LF-PORT
  6749         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6750           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6751         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6752         COMPUTE WS-CSO-NEW-AH-PORT =
  6753           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6754         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6755         COMPUTE WS-CSO-NEW-PORTION =
  6756            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6757         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6758
  6759         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6760                                    OUT-ACCT-ALT-LF-PORT-CHG
  6761         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6762            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6763         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6764         COMPUTE WS-ACCT-AH-PORT-CHG =
  6765            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6766         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6767         COMPUTE WS-ACCT-PORTION-CHG =
  6768            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6769         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6770
  6771         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6772                                    OUT-CSO-ALT-LF-PORT-CHG
  6773         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6774            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6775         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6776         COMPUTE WS-CSO-AH-PORT-CHG =
  6777            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6778         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6779         COMPUTE WS-CSO-PORTION-CHG =
  6780            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6781         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6782
  6783     END-IF
  6784     .
  6785 0620-CONTINUE.
  6786     display ' about to bld reason codes ' en-reason-code (1)
  6787     move en-reason-code (1)     to out-rea-cd1
  6788     move en-reason-code (2)     to out-rea-cd2
  6789     move en-reason-code (3)     to out-rea-cd3
  6790     move en-reason-code (4)     to out-rea-cd4
  6791     move en-reason-code (5)     to out-rea-cd5
  6792     move en-reason-code (6)     to out-rea-cd6
  6793     move en-reason-code (7)     to out-rea-cd7
  6794     move en-reason-code (8)     to out-rea-cd8
  6795     move en-reason-code (9)     to out-rea-cd9
  6796     move en-reason-code (10)    to out-rea-cd10
  6797     move en-reason-code (11)    to out-rea-cd11
  6798     move en-reason-code (12)    to out-rea-cd12
  6799*    PERFORM 1300-DETERMINE-COMM
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 119
* NSRASBL.cbl
  6800*                                THRU 1300-EXIT
  6801     .
  6802 0620-EXIT.
  6803     EXIT.
  6804 0650-PROCESS-NO-Change.
  6805     IF EN-REC-TYPE = 'C'
  6806        GO TO 0650-PROCESS-CANCEL
  6807     END-IF
  6808     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6809        AND (OUT-NEW-ILNAME NOT = SPACES))
  6810                      AND
  6811        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6812        AND (OUT-NEW-IFNAME NOT = SPACES))
  6813                      AND
  6814        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6815        AND (OUT-NEW-IFNAME NOT = SPACES))
  6816        move 'No Change'         to out-new-Ifname
  6817        MOVE SPACES              TO OUT-NEW-IMINIT
  6818        move spaces              to out-new-Ilname
  6819     ELSE
  6820         IF OUT-NEW-ILNAME = SPACES
  6821           AND OUT-NEW-IFNAME = SPACES
  6822           AND OUT-NEW-IMINIT = SPACES
  6823           AND OUT-ORIG-ILNAME NOT = SPACES
  6824            MOVE 'None'          TO OUT-NEW-IFNAME
  6825            MOVE SPACES          TO OUT-NEW-IMINIT
  6826            MOVE SPACES          TO OUT-NEW-ILNAME
  6827         END-IF
  6828     END-IF
  6829     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6830        AND (OUT-NEW-JLNAME NOT = SPACES))
  6831                    AND
  6832        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6833        AND (OUT-NEW-JFNAME NOT = SPACES))
  6834                    AND
  6835        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6836        AND (OUT-NEW-JFNAME NOT = SPACES))
  6837        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6838        MOVE SPACES              TO OUT-NEW-JMINIT
  6839        MOVE SPACES              TO OUT-NEW-JLNAME
  6840     ELSE
  6841         IF OUT-NEW-JLNAME = SPACES
  6842           AND OUT-NEW-JFNAME = SPACES
  6843           AND OUT-NEW-JMINIT = SPACES
  6844           AND OUT-ORIG-JLNAME NOT = SPACES
  6845            MOVE 'None'          TO OUT-NEW-JFNAME
  6846            MOVE SPACES          TO OUT-NEW-JMINIT
  6847            MOVE SPACES          TO OUT-NEW-JLNAME
  6848         END-IF
  6849     END-IF
  6850     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6851        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6852        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6853     ELSE
  6854         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6855           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6856             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6857         END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 120
* NSRASBL.cbl
  6858     END-IF
  6859     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6860        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6861        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6862     ELSE
  6863         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6864           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6865             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6866         END-IF
  6867     END-IF
  6868     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6869        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6870        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6871     ELSE
  6872         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6873           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6874             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6875         END-IF
  6876     END-IF
  6877     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6878        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6879        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6880     ELSE
  6881         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6882           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6883             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6884         END-IF
  6885     END-IF
  6886
  6887     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6888                              EN-LF-ORIG-ALT-PRM-AMT
  6889     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6890                               EN-LF-NEW-ALT-PRM-AMT
  6891     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6892        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6893        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6894     ELSE
  6895         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6896           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6897            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6898         END-IF
  6899     END-IF
  6900     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6901        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6902     END-IF
  6903     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6904        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6905        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6906     END-IF
  6907     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6908        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6909        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6910     ELSE
  6911        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6912          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6913            MOVE 'None'          TO OUT-NEW-LF-DESC
  6914        END-IF
  6915     end-if
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 121
* NSRASBL.cbl
  6916     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6917       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6918        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6919     END-IF
  6920     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6921        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6922        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6923     ELSE
  6924         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6925           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6926             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6927         END-IF
  6928     END-IF
  6929     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6930        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6931        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6932     ELSE
  6933         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6934           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6935             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6936         END-IF
  6937     END-IF
  6938     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6939        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6940        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6941     ELSE
  6942         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6943           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6944             MOVE 'None'         TO OUT-NEW-AH-DESC
  6945         END-IF
  6946     END-IF
  6947     IF EN-INS-ORIG-AGE-DEF-FLAG <> 'Y'
  6948         MOVE 'N' TO EN-INS-ORIG-AGE-DEF-FLAG
  6949     END-IF
  6950     IF EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6951         MOVE 'N' TO EN-INS-NEW-AGE-DEF-FLAG
  6952     END-IF
  6953     IF EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y'
  6954         MOVE 'N' TO EN-JNT-ORIG-AGE-DEF-FLAG
  6955     END-IF
  6956     IF EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6957         MOVE 'N' TO EN-JNT-NEW-AGE-DEF-FLAG
  6958     END-IF
  6959
  6960     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6961       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  6962       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6963       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  6964       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  6965       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  6966        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6967     END-IF
  6968     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6969        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6970        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  6971        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6972        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  6973        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 122
* NSRASBL.cbl
  6974        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
  6975        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6976     ELSE
  6977         IF (EN-JNT-ORIG-AGE > ZEROS)
  6978           AND (EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y')
  6979           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6980             MOVE 'None'         TO OUT-NEW-JAGE-A
  6981         END-IF
  6982     END-IF
  6983     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6984        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6985        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6986     ELSE
  6987         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6988           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6989             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6990         END-IF
  6991     END-IF
  6992     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6993        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6994        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6995     ELSE
  6996         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6997           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6998             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6999         END-IF
  7000     END-IF
  7001     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  7002        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  7003        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  7004                                    OUT-NEW-MAX-PMTS-A
  7005     ELSE
  7006         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7007           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7008             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  7009                                    OUT-NEW-MAX-PMTS-A
  7010         END-IF
  7011     END-IF
  7012     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  7013        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  7014     END-IF
  7015     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  7016       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  7017         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  7018     ELSE
  7019         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7020           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7021             MOVE 'None'         TO OUT-NEW-WAIT-PER
  7022         END-IF
  7023     END-IF
  7024     .
  7025 0650-PROCESS-CANCEL.
  7026     .
  7027 0650-EXIT.
  7028     EXIT.
  7029 0700-WRITE-EXTR.
  7030     display ' made it to 0700 '
  7031     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 123
* NSRASBL.cbl
  7032     IF BL-FAIL
  7033        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  7034        GO TO 0700-EXIT
  7035     END-IF
  7036     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  7037     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  7038     MOVE +0                     TO NSAS-SEQ-NO
  7039     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  7040     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  7041     IF BL-FAIL
  7042        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  7043        GO TO 0700-EXIT
  7044     END-IF
  7045     IF W-LETTER-TO-ACCT NOT = SPACES
  7046        display ' acct ne spaces ' bl-archive-no
  7047        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  7048        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7049        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7050        MOVE +1                  TO NSAS-SEQ-NO
  7051        PERFORM 0720-WRITE-NSASEXTR
  7052                                 THRU 0720-EXIT
  7053        IF BL-FAIL
  7054           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  7055           GO TO 0700-EXIT
  7056        END-IF
  7057     END-IF
  7058     IF W-LETTER-TO-BENE NOT = SPACES
  7059        display ' bene ne spaces ' bl-archive-no
  7060        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  7061        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7062        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7063        MOVE +2                  TO NSAS-SEQ-NO
  7064        PERFORM 0720-WRITE-NSASEXTR
  7065                                 THRU 0720-EXIT
  7066        IF BL-FAIL
  7067           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  7068        END-IF
  7069     END-IF
  7070     IF W-PRINT-CERTIFICATE = 'Y' AND
  7071        BL-STATE = 'VA'
  7072           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  7073           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  7074           MOVE BL-CARRIER          TO VD-CARRIER
  7075           MOVE BL-GROUP            TO VD-GROUPING
  7076           MOVE BL-STATE            TO VD-STATE
  7077           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  7078           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  7079           MOVE BL-CERT-NO          TO VD-CERT-NO
  7080           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  7081           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  7082           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  7083           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  7084           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  7085           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  7086           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  7087           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  7088           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  7089           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 124
* NSRASBL.cbl
  7090           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  7091           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  7092           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  7093           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  7094           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  7095           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  7096           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  7097           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  7098           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  7099           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  7100           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  7101           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  7102           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  7103           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  7104           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  7105           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  7106           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  7107           MOVE 'VADS'              TO VD-LETTER-ID
  7108           MOVE OUT-PROC-ID         TO VD-PROC-ID
  7109           MOVE BL-COMP-ID          TO VD-COMP-ID
  7110           MOVE EIBTIME             TO VD-CURRENT-TIME
  7111           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  7112           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  7113           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  7114
  7115* EXEC CICS LINK
  7116*              PROGRAM    (LINK-ELVADS)
  7117*              COMMAREA   (WS-PASS-AREA)
  7118*              LENGTH     (WS-PASS-AREA-LENGTH)
  7119*          END-EXEC
  7120*    MOVE '."C                   (   #00006966' TO DFHEIV0
  7121     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7123     MOVE X'2020233030303036393636' TO DFHEIV0(25:11)
  7124     CALL 'kxdfhei1' USING DFHEIV0,
  7125           LINK-ELVADS,
  7126           WS-PASS-AREA,
  7127           WS-PASS-AREA-LENGTH,
  7128           DFHEIV99,
  7129           DFHEIV99,
  7130           DFHEIV99,
  7131           DFHEIV99
  7132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7133     END-IF
  7134     .
  7135 0700-EXIT.
  7136     EXIT.
  7137  0710-BUILD-NSASEXTR.
  7138***  i added the extra space in front of the 1st ~
  7139***  only because there may be a letter to acct or bene
  7140     STRING
  7141         OUT-LETTER             ' ~'
  7142         OUT-PROC-ID            '~'
  7143         OUT-PROC-NAME          '~'
  7144         OUT-PROC-TITLE         '~'
  7145         OUT-CSR-NAME           '~'
  7146         OUT-CSR-TITLE          '~'
  7147         OUT-CARRIER            '~'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 125
* NSRASBL.cbl
  7148         OUT-GROUPING           '~'
  7149         OUT-STATE              '~'
  7150         OUT-ACCOUNT            '~'
  7151         OUT-CERT-EFF-DT        '~'
  7152         OUT-CERT-NO            '~'
  7153         OUT-CERT-SFX           '~'
  7154         OUT-ILNAME             '~'
  7155         OUT-IFNAME             '~'
  7156         OUT-IFINIT             '~'
  7157         OUT-IMINIT             '~'
  7158         OUT-IAGE               '~'
  7159         OUT-ISEX               '~'
  7160         OUT-INS-ADDR1          '~'
  7161         OUT-INS-ADDR2          '~'
  7162         OUT-INS-CITY           '~'
  7163         OUT-INS-STATE          '~'
  7164         OUT-INS-ZIP            '~'
  7165         OUT-SOC-SEC-NO         '~'
  7166         OUT-MEMBER-NO          '~'
  7167         OUT-JLNAME             '~'
  7168         OUT-JFNAME             '~'
  7169         OUT-JMINIT             '~'
  7170         OUT-JAGE               '~'
  7171         OUT-ACCT-NAME          '~'
  7172         OUT-ACCT-ADDR1         '~'
  7173         OUT-ACCT-ADDR2         '~'
  7174         OUT-ACCT-CITY          '~'
  7175         OUT-ACCT-STATE         '~'
  7176         OUT-ACCT-ZIP           '~'
  7177         OUT-ACCT-PHONE         '~'
  7178         OUT-ACCT-CNTRL-NAME    '~'
  7179         OUT-ACCT-BUS-TYPE      '~'
  7180         OUT-BENE-NAME          '~'
  7181         OUT-BENE-ADDR1         '~'
  7182         OUT-BENE-ADDR2         '~'
  7183         OUT-BENE-CITY          '~'
  7184         OUT-BENE-STATE         '~'
  7185         OUT-BENE-ZIP           '~'
  7186         OUT-CARR-NAME          '~'
  7187         OUT-RESP-NO            '~'
  7188         OUT-COMP-NAME          '~'
  7189         OUT-COMP-MAIL-TO       '~'
  7190         OUT-COMP-ADDR1         '~'
  7191         OUT-COMP-ADDR2         '~'
  7192         OUT-COMP-CITY          '~'
  7193         OUT-COMP-STATE         '~'
  7194         OUT-COMP-ZIP           '~'
  7195         OUT-COMP-PHONE         '~'
  7196         OUT-COMP-FAX           '~'
  7197         OUT-COMP-STATUS        '~'
  7198         OUT-BILL-SW            '~'
  7199         OUT-RPT-CD1            '~'
  7200         OUT-RPT-CD2            '~'
  7201         OUT-ENTRY-DT           '~'
  7202         OUT-ENTRY-BATCH        '~'
  7203         OUT-ENTRY-STATUS       '~'
  7204         OUT-1ST-PMT-DT         '~'
  7205         OUT-LOAN-APR           '~'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 126
* NSRASBL.cbl
  7206         OUT-LOAN-TERM          '~'
  7207         OUT-RATE-CLASS         '~'
  7208         OUT-EXT-DAYS           '~'
  7209         OUT-CSR-CODE           '~'
  7210         OUT-UCODE              '~'
  7211         OUT-PREM-TYPE          '~'
  7212         OUT-IND-GRP            '~'
  7213         OUT-SKIP-CD            '~'
  7214         OUT-PMT-MODE           '~'
  7215         OUT-LOAN-OFF           '~'
  7216         OUT-REIN-TABLE         '~'
  7217         OUT-SPEC-REIN          '~'
  7218         OUT-LF-BENCD           '~'
  7219         OUT-LF-TERM            '~'
  7220         OUT-LF-DEV-CD          '~'
  7221         OUT-LF-DEV-PCT         '~'
  7222         OUT-LF-BEN             '~'
  7223         OUT-LF-PRM             '~'
  7224         OUT-LF-ALT-BEN         '~'
  7225         OUT-LF-ALT-PRM         '~'
  7226         OUT-LF-NSP             '~'
  7227         OUT-LF-REM-BEN         '~'
  7228         OUT-LF-REF             '~'
  7229         OUT-LF-DTH             '~'
  7230         OUT-LF-RATE            '~'
  7231         OUT-LF-ALT-RATE        '~'
  7232         OUT-LF-EXP-DT          '~'
  7233         OUT-LF-CUR-STATUS      '~'
  7234         OUT-LF-CAN-DT          '~'
  7235         OUT-LF-CAN-EXIT-DT     '~'
  7236         OUT-LF-DTH-DT          '~'
  7237         OUT-LF-DTH-EXIT-DT     '~'
  7238         OUT-LF-EXIT-BATCH      '~'
  7239         OUT-LF-COMM-PCT        '~'
  7240         OUT-LF-DESC            '~'
  7241         OUT-LF-ABBRV           '~'
  7242         OUT-AH-BENCD           '~'
  7243         OUT-AH-TERM            '~'
  7244         OUT-CRIT-PER           '~'
  7245         OUT-AH-DEV-CD          '~'
  7246         OUT-AH-DEV-PCT         '~'
  7247         OUT-AH-BEN             '~'
  7248         OUT-AH-PRM             '~'
  7249         OUT-AH-NSP             '~'
  7250         OUT-AH-REF             '~'
  7251         OUT-AH-CLM             '~'
  7252         OUT-AH-TOT-BEN         '~'
  7253         OUT-AH-PDTHRU-DT       '~'
  7254         OUT-AH-RATE            '~'
  7255         OUT-AH-EXP-DT          '~'
  7256         OUT-AH-CUR-STATUS      '~'
  7257         OUT-AH-CAN-DT          '~'
  7258         OUT-AH-CAN-EXIT-DT     '~'
  7259         OUT-AH-EXIT-BATCH      '~'
  7260         OUT-AH-COMM-PCT        '~'
  7261         OUT-AH-DESC            '~'
  7262         OUT-RET-ELIM           '~'
  7263         OUT-BEN-DAYS           '~'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 127
* NSRASBL.cbl
  7264         OUT-WAIT-PER           '~'
  7265         OUT-MAX-PMTS           '~'
  7266         OUT-TOT-PRM            '~'
  7267         OUT-TOT-REF            '~'
  7268         OUT-SCHED-EXP-DT       '~'
  7269         OUT-SCHED-TERM         '~'
  7270         OUT-ORIG-ILNAME        '~'
  7271         OUT-ORIG-IFNAME        '~'
  7272         OUT-ORIG-MINIT         '~'
  7273         OUT-ORIG-IAGE          '~'
  7274         OUT-ORIG-JLNAME        '~'
  7275         OUT-ORIG-JFNAME        '~'
  7276         OUT-ORIG-JMINIT        '~'
  7277         OUT-ORIG-JAGE          '~'
  7278         OUT-ORIG-LF-BENCD      '~'
  7279         OUT-ORIG-LF-TERM       '~'
  7280         OUT-ORIG-LF-BEN        '~'
  7281         OUT-ORIG-LF-PRM        '~'
  7282         OUT-LF-CALC-PRM        '~'
  7283         OUT-ORIG-LF-REF        '~'
  7284         OUT-LF-CALC-REF        '~'
  7285         OUT-ORIG-LF-ALT-BEN    '~'
  7286         OUT-ORIG-LF-ALT-PRM    '~'
  7287         OUT-ORIG-LF-EXP-DT     '~'
  7288         OUT-ORIG-LF-DESC       '~'
  7289         OUT-ORIG-AH-BENCD      '~'
  7290         OUT-ORIG-AH-TERM       '~'
  7291         OUT-ORIG-CRIT-PER      '~'
  7292         OUT-ORIG-AH-BEN        '~'
  7293         OUT-ORIG-AH-PRM        '~'
  7294         OUT-AH-CALC-PRM        '~'
  7295         OUT-ORIG-AH-REF        '~'
  7296         OUT-AH-CALC-REF        '~'
  7297         OUT-ORIG-AH-EXP-DT     '~'
  7298         OUT-ORIG-AH-DESC       '~'
  7299         OUT-ORIG-RET-ELIM      '~'
  7300         OUT-ORIG-BEN-DAYS      '~'
  7301         OUT-ORIG-WAIT-PER      '~'
  7302         OUT-ORIG-MAX-PMTS      '~'
  7303         OUT-ORIG-SCHED-EXP-DT  '~'
  7304         OUT-ORIG-SCHED-TERM    '~'
  7305         OUT-NEW-ILNAME         '~'
  7306         OUT-NEW-IFNAME         '~'
  7307         OUT-NEW-IMINIT         '~'
  7308         OUT-NEW-IAGE           '~'
  7309         OUT-NEW-JLNAME         '~'
  7310         OUT-NEW-JFNAME         '~'
  7311         OUT-NEW-JMINIT         '~'
  7312         OUT-NEW-JAGE           '~'
  7313         OUT-NEW-LF-BENCD       '~'
  7314         OUT-NEW-LF-TERM        '~'
  7315         OUT-NEW-LF-BEN         '~'
  7316         OUT-NEW-LF-PRM         '~'
  7317         OUT-NEW-LF-REF         '~'
  7318         OUT-NEW-LF-ALT-BEN     '~'
  7319         OUT-NEW-LF-ALT-PRM     '~'
  7320         OUT-NEW-LF-EXP-DT      '~'
  7321         OUT-NEW-LF-DESC        '~'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 128
* NSRASBL.cbl
  7322         OUT-NEW-AH-BENCD       '~'
  7323         OUT-NEW-AH-TERM        '~'
  7324         OUT-NEW-CRIT-PER       '~'
  7325         OUT-NEW-AH-BEN         '~'
  7326         OUT-NEW-AH-PRM         '~'
  7327         OUT-NEW-AH-REF         '~'
  7328         OUT-NEW-AH-EXP-DT      '~'
  7329         OUT-NEW-AH-DESC        '~'
  7330         OUT-NEW-RET-ELIM       '~'
  7331         OUT-NEW-BEN-DAYS       '~'
  7332         OUT-NEW-WAIT-PER       '~'
  7333         OUT-NEW-MAX-PMTS       '~'
  7334         OUT-NEW-SCHED-EXP-DT   '~'
  7335         OUT-NEW-SCHED-TERM     '~'
  7336         OUT-TOT-PRM-CHG        '~'
  7337         OUT-TOT-REF-CHG        '~'
  7338         OUT-PAYEE              '~'
  7339         OUT-SIG-SW             '~'
  7340         OUT-BALLOON-IND        '~'
  7341         OUT-LEASE-IND          '~'
  7342         OUT-RESCIND            '~'
  7343         OUT-REA-CD1            '~'
  7344         OUT-REA-CD2            '~'
  7345         OUT-REA-CD3            '~'
  7346         OUT-REA-CD4            '~'
  7347         OUT-REA-CD5            '~'
  7348         OUT-REA-CD6            '~'
  7349         OUT-REA-CD7            '~'
  7350         OUT-REA-CD8            '~'
  7351         OUT-REA-CD9            '~'
  7352         OUT-REA-CD10           '~'
  7353         OUT-REA-CD11           '~'
  7354         OUT-REA-CD12           '~'
  7355         OUT-CYCLE-DT           '~'
  7356         OUT-ARCH-NO            '~'
  7357         OUT-FORM               '~'
  7358         OUT-ENC-LINE           '~'
  7359         OUT-ATTACH             '~'
  7360         OUT-STACK              '~'
  7361         OUT-STATE-NAME         '~'
  7362         OUT-PRINT-NOW          '~'
  7363         OUT-CHGBACK            '~'
  7364         OUT-CSO-PORTION        '~'
  7365         OUT-ACCT-PORTION       '~'
  7366         OUT-LETTER-TYPE        '~'
  7367         OUT-PRINT-CERTIFICATE  '~'
  7368         OUT-INS-BIRTHDATE      '~'
  7369         OUT-JNT-BIRTHDATE      '~'
  7370         OUT-TOT-INTEREST       '~'
  7371         OUT-ORIG-TOT-PREM      '~'
  7372         OUT-ORIG-TOT-REF       '~'
  7373         OUT-CANCEL-DT          '~'
  7374         OUT-HEALTH-APP         '~'
  7375         OUT-CERTIFICATE-ID     '~'
  7376         OUT-UNDW-ID            '~'
  7377         OUT-NEW-TOT-PREM       '~'
  7378         OUT-NEW-TOT-REF        '~'
  7379         OUT-COVERAGE-IND       '~'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 129
* NSRASBL.cbl
  7380         OUT-ORIG-COVERAGE-IND  '~'
  7381         OUT-NEW-COVERAGE-IND   '~'
  7382         OUT-LF-CMB-PREM        '~'
  7383         OUT-ORIG-LF-CMB-PREM   '~'
  7384         OUT-NEW-LF-CMB-PREM    '~'
  7385         OUT-LF-PREM-CHG        '~'
  7386         OUT-LF-ALT-PREM-CHG    '~'
  7387         OUT-LF-CMB-PREM-CHG    '~'
  7388         OUT-AH-PREM-CHG        '~'
  7389         OUT-LF-REF-CHG         '~'
  7390         OUT-AH-REF-CHG         '~'
  7391         OUT-ACCT-LF-PORTION    '~'
  7392         OUT-ACCT-ALT-LF-PORT   '~'
  7393         OUT-ACCT-CMB-LF-PORT   '~'
  7394         OUT-ACCT-AH-PORTION    '~'
  7395         OUT-CSO-LF-PORTION     '~'
  7396         OUT-CSO-ALT-LF-PORT    '~'
  7397         OUT-CSO-CMB-LF-PORT    '~'
  7398         OUT-CSO-AH-PORTION     '~'
  7399         OUT-ACCT-ORIG-LF-PORT  '~'
  7400         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7401         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7402         OUT-ACCT-ORIG-AH-PORT  '~'
  7403         OUT-ACCT-ORIG-PORTION  '~'
  7404         OUT-CSO-ORIG-LF-PORT   '~'
  7405         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7406         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7407         OUT-CSO-ORIG-AH-PORT   '~'
  7408         OUT-CSO-ORIG-PORTION   '~'
  7409         OUT-ACCT-NEW-LF-PORT   '~'
  7410         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7411         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7412         OUT-ACCT-NEW-AH-PORT   '~'
  7413         OUT-ACCT-NEW-PORTION   '~'
  7414         OUT-CSO-NEW-LF-PORT    '~'
  7415         OUT-CSO-NEW-ALT-LF-PORT '~'
  7416         OUT-CSO-NEW-CMB-LF-PORT '~'
  7417         OUT-CSO-NEW-AH-PORT    '~'
  7418         OUT-CSO-NEW-PORTION    '~'
  7419         OUT-ACCT-LF-PORT-CHG   '~'
  7420         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7421         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7422         OUT-ACCT-AH-PORT-CHG   '~'
  7423         OUT-ACCT-PORTION-CHG   '~'
  7424         OUT-CSO-LF-PORT-CHG    '~'
  7425         OUT-CSO-ALT-LF-PORT-CHG '~'
  7426         OUT-CSO-CMB-LF-PORT-CHG '~'
  7427         OUT-CSO-AH-PORT-CHG    '~'
  7428         OUT-CSO-PORTION-CHG    '~'
  7429         OUT-ORIG-LF-CAN-DT     '~'
  7430         OUT-NEW-LF-CAN-DT      '~'
  7431         OUT-ORIG-AH-CAN-DT     '~'
  7432         OUT-NEW-AH-CAN-DT      '~'
  7433         OUT-ORIG-CAN-DT        '~'
  7434         OUT-NEW-CAN-DT         '~'
  7435         OUT-SCREEN-ID          '~'
  7436         OUT-NEXT-BUS-DT        '~'
  7437         OUT-VIN-NUMBER         '~'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 130
* NSRASBL.cbl
  7438            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7439     END-STRING
  7440     .
  7441 0710-exit.
  7442     EXIT.
  7443 0720-WRITE-NSASEXTR.
  7444
  7445* EXEC CICS WRITE
  7446*       DATASET    ('NSASEXTR')
  7447*       FROM       (NSAS-EXTRACT-RECORD)
  7448*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7449*       RESP       (WS-RESPONSE)
  7450*    END-EXEC
  7451     MOVE LENGTH OF
  7452      NSAS-EXTRACT-RECORD
  7453       TO DFHEIV11
  7454     MOVE 'NSASEXTR' TO DFHEIV1
  7455*    MOVE '&$ L                  ''  N#00007282' TO DFHEIV0
  7456     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7457     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7458     MOVE X'204E233030303037323832' TO DFHEIV0(25:11)
  7459     CALL 'kxdfhei1' USING DFHEIV0,
  7460           DFHEIV1,
  7461           NSAS-EXTRACT-RECORD,
  7462           DFHEIV11,
  7463           NSAS-CONTROL-PRIMARY,
  7464           DFHEIV99,
  7465           DFHEIV99
  7466     MOVE EIBRESP  TO WS-RESPONSE
  7467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7468     IF NOT RESP-NORMAL
  7469        display ' bad write nsasextr ' ws-response
  7470        SET BL-FAIL TO TRUE
  7471     END-IF
  7472     .
  7473 0720-EXIT.
  7474     EXIT.
  7475 0800-init-out-data.
  7476     MOVE ZEROS                  TO OUT-IAGE
  7477                                    OUT-JAGE
  7478                                    OUT-LOAN-APR
  7479                                    OUT-LOAN-TERM
  7480                                    OUT-EXT-DAYS
  7481                                    OUT-LF-TERM
  7482                                    OUT-AH-TERM
  7483                                    OUT-LF-DEV-PCT
  7484                                    OUT-AH-DEV-PCT
  7485                                    OUT-LF-BEN
  7486                                    OUT-AH-BEN
  7487                                    OUT-CRIT-PER
  7488                                    OUT-MAX-PMTS
  7489                                    OUT-SCHED-TERM
  7490                                    OUT-ORIG-IAGE
  7491                                    OUT-ORIG-JAGE
  7492                                    OUT-NEW-IAGE
  7493                                    OUT-NEW-JAGE
  7494                                    OUT-ORIG-LF-TERM
  7495                                    OUT-ORIG-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 131
* NSRASBL.cbl
  7496                                    OUT-NEW-LF-TERM
  7497                                    OUT-NEW-AH-TERM
  7498                                    OUT-ORIG-CRIT-PER
  7499                                    OUT-ORIG-MAX-PMTS
  7500                                    OUT-ORIG-SCHED-TERM
  7501                                    OUT-NEW-SCHED-TERM
  7502                                    OUT-NEW-CRIT-PER
  7503                                    OUT-NEW-MAX-PMTS
  7504                                    OUT-CSO-PORTION
  7505                                    OUT-CSO-LF-PORTION
  7506                                    OUT-CSO-ALT-LF-PORT
  7507                                    OUT-CSO-CMB-LF-PORT
  7508                                    OUT-CSO-AH-PORTION
  7509                                    OUT-ACCT-PORTION
  7510                                    OUT-ACCT-LF-PORTION
  7511                                    OUT-ACCT-ALT-LF-PORT
  7512                                    OUT-ACCT-CMB-LF-PORT
  7513                                    OUT-ACCT-AH-PORTION
  7514                                    OUT-LF-PREM-CHG
  7515                                    OUT-LF-ALT-PREM-CHG
  7516                                    OUT-LF-CMB-PREM-CHG
  7517                                    OUT-AH-PREM-CHG
  7518                                    OUT-LF-REF-CHG
  7519                                    OUT-AH-REF-CHG
  7520     .
  7521 0800-exit.
  7522     exit.
  7523 1000-BUILD-ERARCH.
  7524* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7525*    1) FROM ACCT MAINT
  7526*    2) FROM CERT UPDATE
  7527*    3) FROM COMP MAINT
  7528*    4) FROM REVIEW AND CORRECTIONS
  7529******************************************************************
  7530     MOVE 'LA'                   TO LETTER-ARCHIVE
  7531     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7532                                    LA-ARCHIVE-NO-A2
  7533                                    LA-ARCHIVE-NO-A3
  7534                                    LA-ARCHIVE-NO-A4
  7535                                    LA-ARCHIVE-NO-A5
  7536                                    LA-ARCHIVE-NO-A6
  7537     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7538                                    LA-COMPANY-CD-A2
  7539                                    LA-COMPANY-CD-A3
  7540                                    LA-COMPANY-CD-A4
  7541                                    LA-COMPANY-CD-A5
  7542                                    LA-COMPANY-CD-A6
  7543     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7544                                    LA-CARRIER-A3
  7545                                    LA-CARRIER-A4
  7546                                    LA-CARRIER-A5
  7547     MOVE BL-GROUP               TO LA-GROUPING-A2
  7548                                    LA-GROUPING-A3
  7549                                    LA-GROUPING-A4
  7550                                    LA-GROUPING-A5
  7551     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7552                                    LA-ACCOUNT-A3
  7553                                    LA-ACCOUNT-A4
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 132
* NSRASBL.cbl
  7554                                    LA-ACCOUNT-A5
  7555     MOVE BL-STATE               TO LA-STATE-A2
  7556                                    LA-STATE-A3
  7557                                    LA-STATE-A4
  7558                                    LA-STATE-A5
  7559     IF BL-DATA-SRCE = '2' OR '4'
  7560        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7561        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7562     ELSE
  7563        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7564     END-IF
  7565     IF BL-DATA-SRCE = '4'
  7566        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7567     END-IF
  7568     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7569                                    LA-LAST-UPDATED-BY
  7570     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7571                                    LA-INITIAL-PRINT-DATE
  7572                                    LA-SENT-DATE
  7573                                    LA-REPLY-DATE
  7574                                    LA-RESEND-DATE
  7575                                    LA-FOLLOW-UP-DATE
  7576     MOVE 'A'                    TO LA-STATUS
  7577     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7578     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7579     IF W-DAYS-TO-RESEND NOT NUMERIC
  7580        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7581     END-IF
  7582     IF W-DAYS-TO-RESEND > ZEROS
  7583        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7584        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7585        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7586        MOVE '6'                 TO DC-OPTION-CODE
  7587        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7588        IF NO-CONVERSION-ERROR
  7589           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7590        END-IF
  7591     END-IF
  7592     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7593        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7594        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7595        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7596        MOVE '6'                 TO DC-OPTION-CODE
  7597        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7598        IF NO-CONVERSION-ERROR
  7599           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7600        END-IF
  7601     END-IF
  7602
  7603     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7604     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7605     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7606     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7607     IF BL-ENDT-ARCH-NO > ZEROS
  7608        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7609     ELSE
  7610        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7611     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 133
* NSRASBL.cbl
  7612     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7613                                    LA-LAST-MAINT-DATE
  7614     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7615                                    LA-NO-OF-TEXT-RECORDS
  7616     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7617
  7618* EXEC CICS WRITE
  7619*         DATASET   ('ERARCH')
  7620*         FROM      (LETTER-ARCHIVE)
  7621*         RIDFLD    (LA-CONTROL-PRIMARY)
  7622*         RESP      (WS-RESPONSE)
  7623*    END-EXEC
  7624     MOVE LENGTH OF
  7625      LETTER-ARCHIVE
  7626       TO DFHEIV11
  7627     MOVE 'ERARCH' TO DFHEIV1
  7628*    MOVE '&$ L                  ''  N#00007437' TO DFHEIV0
  7629     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7630     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7631     MOVE X'204E233030303037343337' TO DFHEIV0(25:11)
  7632     CALL 'kxdfhei1' USING DFHEIV0,
  7633           DFHEIV1,
  7634           LETTER-ARCHIVE,
  7635           DFHEIV11,
  7636           LA-CONTROL-PRIMARY,
  7637           DFHEIV99,
  7638           DFHEIV99
  7639     MOVE EIBRESP  TO WS-RESPONSE
  7640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7641     IF NOT RESP-NORMAL
  7642        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7643        la-archive-no
  7644        SET BL-FAIL TO TRUE
  7645     END-IF
  7646     .
  7647 1000-EXIT.
  7648     EXIT.
  7649 1025-GET-CSR-INFO.
  7650     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7651                                    OUT-CSR-TITLE
  7652                                    OUT-PROC-TITLE
  7653                                    OUT-UNDW-ID
  7654     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7655     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7656     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7657     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7658
  7659* EXEC CICS READ
  7660*       INTO    (CONTROL-FILE)
  7661*       DATASET ('ELCNTL')
  7662*       RIDFLD  (WS-ELCNTL-KEY)
  7663*       RESP    (WS-RESPONSE)
  7664*    END-EXEC
  7665     MOVE LENGTH OF
  7666      CONTROL-FILE
  7667       TO DFHEIV11
  7668     MOVE 'ELCNTL' TO DFHEIV1
  7669*    MOVE '&"IL       E          (  N#00007460' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 134
* NSRASBL.cbl
  7670     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7672     MOVE X'204E233030303037343630' TO DFHEIV0(25:11)
  7673     CALL 'kxdfhei1' USING DFHEIV0,
  7674           DFHEIV1,
  7675           CONTROL-FILE,
  7676           DFHEIV11,
  7677           WS-ELCNTL-KEY,
  7678           DFHEIV99,
  7679           DFHEIV99,
  7680           DFHEIV99
  7681     MOVE EIBRESP  TO WS-RESPONSE
  7682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7683     IF RESP-NORMAL
  7684        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7685                                    OUT-PROC-NAME
  7686*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7687*                                   OUT-PROC-TITLE
  7688     END-IF
  7689     IF BL-PROC-ID NOT = PB-CSR-ID
  7690        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7691        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7692        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7693                                    OUT-PROC-TITLE
  7694        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7695
  7696* EXEC CICS READ
  7697*          INTO    (CONTROL-FILE)
  7698*          DATASET ('ELCNTL')
  7699*          RIDFLD  (WS-ELCNTL-KEY)
  7700*          RESP    (WS-RESPONSE)
  7701*       END-EXEC
  7702     MOVE LENGTH OF
  7703      CONTROL-FILE
  7704       TO DFHEIV11
  7705     MOVE 'ELCNTL' TO DFHEIV1
  7706*    MOVE '&"IL       E          (  N#00007478' TO DFHEIV0
  7707     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7708     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7709     MOVE X'204E233030303037343738' TO DFHEIV0(25:11)
  7710     CALL 'kxdfhei1' USING DFHEIV0,
  7711           DFHEIV1,
  7712           CONTROL-FILE,
  7713           DFHEIV11,
  7714           WS-ELCNTL-KEY,
  7715           DFHEIV99,
  7716           DFHEIV99,
  7717           DFHEIV99
  7718     MOVE EIBRESP  TO WS-RESPONSE
  7719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7720        IF RESP-NORMAL
  7721           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7722*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7723        END-IF
  7724     END-IF
  7725     .
  7726 1025-EXIT.
  7727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 135
* NSRASBL.cbl
  7728 1050-GET-ERMAIL.
  7729     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7730
  7731* EXEC CICS READ
  7732*         DATASET    ('ERMAIL')
  7733*         INTO       (MAILING-DATA)
  7734*         RIDFLD     (WS-ERMAIL-KEY)
  7735*         RESP       (WS-RESPONSE)
  7736*    END-EXEC
  7737     MOVE LENGTH OF
  7738      MAILING-DATA
  7739       TO DFHEIV11
  7740     MOVE 'ERMAIL' TO DFHEIV1
  7741*    MOVE '&"IL       E          (  N#00007494' TO DFHEIV0
  7742     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7744     MOVE X'204E233030303037343934' TO DFHEIV0(25:11)
  7745     CALL 'kxdfhei1' USING DFHEIV0,
  7746           DFHEIV1,
  7747           MAILING-DATA,
  7748           DFHEIV11,
  7749           WS-ERMAIL-KEY,
  7750           DFHEIV99,
  7751           DFHEIV99,
  7752           DFHEIV99
  7753     MOVE EIBRESP  TO WS-RESPONSE
  7754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7755     IF RESP-NORMAL
  7756        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7757        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7758        MOVE MA-CITY             TO OUT-INS-CITY
  7759        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7760        MOVE MA-ZIP              TO OUT-INS-ZIP
  7761        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7762        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7763        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7764        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7765        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7766        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7767        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7768           MOVE MA-INSURED-BIRTH-DT
  7769                                 TO DC-BIN-DATE-1
  7770           MOVE ' '              TO DC-OPTION-CODE
  7771           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7772           IF NO-CONVERSION-ERROR
  7773              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7774                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7775                INTO OUT-INS-BIRTHDATE
  7776              END-STRING
  7777           END-IF
  7778        END-IF
  7779        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7780           MOVE MA-JOINT-BIRTH-DT
  7781                                 TO DC-BIN-DATE-1
  7782           MOVE ' '              TO DC-OPTION-CODE
  7783           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7784           IF NO-CONVERSION-ERROR
  7785              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 136
* NSRASBL.cbl
  7786                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7787                INTO OUT-JNT-BIRTHDATE
  7788              END-STRING
  7789           END-IF
  7790        END-IF
  7791     END-IF
  7792     .
  7793 1050-EXIT.
  7794     EXIT.
  7795 1100-GET-ELCERT.
  7796
  7797* EXEC CICS READ
  7798*         DATASET    ('ELCERT')
  7799*         INTO       (CERTIFICATE-MASTER)
  7800*         RIDFLD     (WS-ELCERT-KEY)
  7801*         RESP       (WS-RESPONSE)
  7802*    END-EXEC.
  7803     MOVE LENGTH OF
  7804      CERTIFICATE-MASTER
  7805       TO DFHEIV11
  7806     MOVE 'ELCERT' TO DFHEIV1
  7807*    MOVE '&"IL       E          (  N#00007541' TO DFHEIV0
  7808     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7810     MOVE X'204E233030303037353431' TO DFHEIV0(25:11)
  7811     CALL 'kxdfhei1' USING DFHEIV0,
  7812           DFHEIV1,
  7813           CERTIFICATE-MASTER,
  7814           DFHEIV11,
  7815           WS-ELCERT-KEY,
  7816           DFHEIV99,
  7817           DFHEIV99,
  7818           DFHEIV99
  7819     MOVE EIBRESP  TO WS-RESPONSE
  7820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7821
  7822     IF RESP-NORMAL
  7823        SET CERT-FOUND TO TRUE
  7824        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7825        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7826     END-IF
  7827     .
  7828 1100-EXIT.
  7829     EXIT.
  7830 1110-BUILD-CERT.
  7831     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7832     MOVE SPACES                 TO OUT-COVERAGE-IND
  7833     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7834     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7835     MOVE CM-CARRIER             TO OUT-CARRIER
  7836     MOVE CM-GROUPING            TO OUT-GROUPING
  7837     MOVE CM-STATE               TO OUT-STATE
  7838     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7839     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7840     MOVE ' '                    TO DC-OPTION-CODE
  7841     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7842     IF NO-CONVERSION-ERROR
  7843        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 137
* NSRASBL.cbl
  7844           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7845              INTO OUT-CERT-EFF-DT
  7846        END-STRING
  7847     END-IF
  7848     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7849     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7850                                    OUT-ORIG-ILNAME
  7851     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7852     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7853                                    OUT-ORIG-MINIT
  7854     IF (CM-SSN-STATE = CM-STATE)
  7855        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7856        MOVE SPACES              TO OUT-SOC-SEC-NO
  7857     ELSE
  7858        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7859     END-IF
  7860     IF (CM-MEMB-STATE = CM-STATE)
  7861        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7862        MOVE SPACES              TO OUT-MEMBER-NO
  7863     ELSE
  7864        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7865     END-IF
  7866     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7867                                    OUT-ORIG-IFNAME
  7868     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7869                                    OUT-ORIG-IAGE
  7870     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7871     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7872                                    OUT-ORIG-JAGE
  7873     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7874                                    OUT-ORIG-JLNAME
  7875     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7876                                    OUT-ORIG-JFNAME
  7877     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7878                                    OUT-ORIG-JMINIT
  7879     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7880                                    OUT-ORIG-LF-BENCD
  7881     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7882                                    OUT-ORIG-LF-TERM
  7883     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7884     IF CM-LF-DEV-PCT NOT NUMERIC
  7885        MOVE ZEROS               TO CM-LF-DEV-PCT
  7886     END-IF
  7887     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7888     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7889     IF NOT CERT-TRL-REC-NOT-FOUND
  7890         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7891             MOVE ZERO           TO OUT-IAGE
  7892                                    OUT-ORIG-IAGE
  7893         END-IF
  7894         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7895             MOVE ZERO           TO OUT-JAGE
  7896                                    OUT-ORIG-JAGE
  7897         END-IF
  7898         MOVE CS-VIN-NUMBER      TO OUT-VIN-NUMBER
  7899     END-IF
  7900
  7901     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 138
* NSRASBL.cbl
  7902        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7903          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7904           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7905             MOVE SPACES          TO OUT-LF-BENCD
  7906                                     WS-LF-BENCD
  7907                                     OUT-LF-CAN-DT
  7908             MOVE ZEROS           TO OUT-LF-TERM
  7909                                     OUT-LF-BEN
  7910                                     OUT-LF-PRM
  7911                                     OUT-LF-ALT-BEN
  7912                                     OUT-LF-ALT-PRM
  7913                                     OUT-LF-COMM-PCT
  7914                                     OUT-LF-NSP
  7915                                     OUT-LF-REM-BEN
  7916                                     WS-WORK-LF-PREM
  7917                                     WS-WORK-ALT-LF-PREM
  7918                                     WS-WORK-CMB-LF-PREM
  7919                                     OUT-LF-REF
  7920                                     OUT-ORIG-LF-REF
  7921                                     WS-WORK-LF-REF
  7922             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7923             GO TO 1100-LF-CONT
  7924        END-IF
  7925     END-IF
  7926
  7927     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7928        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7929             MOVE SPACES          TO OUT-LF-BENCD
  7930                                     WS-LF-BENCD
  7931                                     OUT-LF-CAN-DT
  7932             MOVE ZEROS           TO OUT-LF-TERM
  7933                                     OUT-LF-BEN
  7934                                     OUT-LF-PRM
  7935                                     OUT-LF-ALT-BEN
  7936                                     OUT-LF-ALT-PRM
  7937                                     OUT-LF-COMM-PCT
  7938                                     OUT-LF-NSP
  7939                                     OUT-LF-REM-BEN
  7940                                     WS-WORK-LF-PREM
  7941                                     WS-WORK-ALT-LF-PREM
  7942                                     WS-WORK-CMB-LF-PREM
  7943                                     OUT-LF-REF
  7944                                     OUT-ORIG-LF-REF
  7945                                     WS-WORK-LF-REF
  7946             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7947             GO TO 1100-LF-CONT
  7948        END-IF
  7949     END-IF
  7950     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7951         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7952                                    OUT-ORIG-COVERAGE-IND
  7953     END-IF
  7954
  7955     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7956     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7957                                    OUT-ORIG-LF-BEN
  7958     IF CM-LF-BENEFIT-AMT = 999999999.99
  7959        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 139
* NSRASBL.cbl
  7960     END-IF
  7961     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7962                                    OUT-ORIG-LF-PRM
  7963                                    WS-WORK-LF-PREM
  7964     IF CM-LF-PREMIUM-AMT = .01
  7965         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  7966     END-IF
  7967     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7968        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7969     END-IF
  7970     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7971                                    OUT-ORIG-LF-ALT-BEN
  7972     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  7973        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  7974     END-IF
  7975     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7976        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7977     END-IF
  7978     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7979                                    OUT-ORIG-LF-ALT-PRM
  7980                                    WS-WORK-ALT-LF-PREM
  7981     IF CM-LF-ALT-PREMIUM-AMT = .01
  7982         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  7983     END-IF
  7984     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7985                             CM-LF-ALT-PREMIUM-AMT
  7986     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7987                                 OUT-ORIG-LF-CMB-PREM
  7988                                 WS-WORK-CMB-LF-PREM
  7989     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7990        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7991     END-IF
  7992     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7993     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7994     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7995                                    OUT-ORIG-LF-REF
  7996                                    WS-WORK-LF-REF
  7997     IF CM-LF-DEATH-CLAIM-APPLIED
  7998        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7999            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  8000                                    OUT-ORIG-LF-REF
  8001                                    WS-WORK-LF-REF
  8002     END-IF
  8003     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  8004     MOVE ' '                    TO DC-OPTION-CODE
  8005     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8006     IF NO-CONVERSION-ERROR
  8007        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8008           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8009              INTO OUT-LF-CAN-DT
  8010        END-STRING
  8011     END-IF
  8012
  8013     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8014         MOVE ZEROS          TO WS-WORK-LF-PREM
  8015                                WS-WORK-ALT-LF-PREM
  8016                                WS-WORK-CMB-LF-PREM
  8017     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 140
* NSRASBL.cbl
  8018
  8019      .
  8020 1100-LF-CONT.
  8021
  8022     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  8023     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  8024        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  8025     END-IF
  8026     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  8027     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  8028        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  8029     END-IF
  8030     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  8031     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8032        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  8033          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8034              MOVE SPACES              TO OUT-AH-BENCD
  8035                                          WS-AH-BENCD
  8036                                          OUT-AH-CAN-DT
  8037              MOVE ZEROS               TO OUT-AH-TERM
  8038                                          OUT-AH-BEN
  8039                                          OUT-AH-PRM
  8040                                          OUT-AH-NSP
  8041                                          OUT-AH-COMM-PCT
  8042                                          OUT-CRIT-PER
  8043                                          WS-WORK-AH-PREM
  8044                                          OUT-AH-REF
  8045                                          OUT-ORIG-AH-REF
  8046                                          WS-WORK-AH-REF
  8047              MOVE SPACES              TO OUT-MAX-PMTS-A
  8048                                          OUT-WAIT-PER
  8049                                          OUT-RET-ELIM
  8050                                          OUT-AH-DESC
  8051                                          OUT-BEN-DAYS
  8052              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8053             GO TO 1100-AH-CONT
  8054        END-IF
  8055     END-IF
  8056
  8057     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8058        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8059              MOVE SPACES              TO OUT-AH-BENCD
  8060                                          WS-AH-BENCD
  8061                                          OUT-AH-CAN-DT
  8062              MOVE ZEROS               TO OUT-AH-TERM
  8063                                          OUT-AH-BEN
  8064                                          OUT-AH-PRM
  8065                                          OUT-AH-NSP
  8066                                          OUT-AH-COMM-PCT
  8067                                          OUT-CRIT-PER
  8068                                          WS-WORK-AH-PREM
  8069                                          OUT-AH-REF
  8070                                          OUT-ORIG-AH-REF
  8071                                          WS-WORK-AH-REF
  8072              MOVE SPACES              TO OUT-MAX-PMTS-A
  8073                                          OUT-WAIT-PER
  8074                                          OUT-RET-ELIM
  8075                                          OUT-AH-DESC
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 141
* NSRASBL.cbl
  8076                                          OUT-BEN-DAYS
  8077              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8078             GO TO 1100-AH-CONT
  8079        END-IF
  8080     END-IF
  8081     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  8082     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  8083                                    OUT-ORIG-AH-BENCD
  8084     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  8085        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  8086           CM-AH-BENEFIT-AMT
  8087        IF OUT-COVERAGE-IND = 'LIFE'
  8088            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  8089                                    OUT-ORIG-COVERAGE-IND
  8090        ELSE
  8091            MOVE 'AH  '          TO OUT-COVERAGE-IND
  8092                                    OUT-ORIG-COVERAGE-IND
  8093        END-IF
  8094     ELSE
  8095        MOVE ZEROS               TO OUT-AH-TOT-BEN
  8096     END-IF
  8097     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  8098                                    OUT-ORIG-AH-TERM
  8099     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  8100                                    OUT-ORIG-CRIT-PER
  8101                                    OUT-MAX-PMTS
  8102                                    OUT-ORIG-MAX-PMTS
  8103     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  8104         MOVE SPACES             TO OUT-MAX-PMTS-A
  8105     END-IF
  8106     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  8107     IF CM-AH-DEV-PCT NOT NUMERIC
  8108        MOVE ZEROS               TO CM-AH-DEV-PCT
  8109     END-IF
  8110     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  8111     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  8112                                    OUT-ORIG-AH-BEN
  8113     IF CM-AH-BENEFIT-AMT = 9999999.99
  8114        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  8115     END-IF
  8116     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  8117                                    OUT-ORIG-AH-PRM
  8118                                    WS-WORK-AH-PREM
  8119     IF CM-AH-PREMIUM-AMT = .01
  8120         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  8121     END-IF
  8122     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  8123     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  8124                                    OUT-ORIG-AH-REF
  8125                                    WS-WORK-AH-REF
  8126     IF CM-AH-DEATH-CLAIM-APPLIED
  8127        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8128            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  8129                                    OUT-ORIG-AH-REF
  8130                                    WS-WORK-AH-REF
  8131     END-IF
  8132     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8133     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 142
* NSRASBL.cbl
  8134     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8135     IF NO-CONVERSION-ERROR
  8136        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8137           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8138              INTO OUT-AH-CAN-DT
  8139        END-STRING
  8140     END-IF
  8141
  8142     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8143         MOVE ZEROS          TO WS-WORK-AH-PREM
  8144     END-IF
  8145
  8146      .
  8147 1100-AH-CONT.
  8148
  8149     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  8150     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  8151     MOVE ' '                    TO DC-OPTION-CODE
  8152     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8153     IF NO-CONVERSION-ERROR
  8154        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8155           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8156              INTO OUT-AH-PDTHRU-DT
  8157        END-STRING
  8158     END-IF
  8159     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  8160        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  8161     END-IF
  8162     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  8163     IF CM-LOAN-APR NOT NUMERIC
  8164        MOVE ZEROS               TO CM-LOAN-APR
  8165     END-IF
  8166     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  8167     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  8168     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  8169     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  8170     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  8171     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  8172     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  8173     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  8174     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  8175     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  8176     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8177     MOVE ' '                    TO DC-OPTION-CODE
  8178     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8179     IF NO-CONVERSION-ERROR
  8180        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8181           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8182              INTO OUT-LF-EXP-DT
  8183        END-STRING
  8184     END-IF
  8185     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  8186     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8187     MOVE ' '                    TO DC-OPTION-CODE
  8188     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8189     IF NO-CONVERSION-ERROR
  8190        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8191           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 143
* NSRASBL.cbl
  8192              INTO OUT-AH-EXP-DT
  8193        END-STRING
  8194     END-IF
  8195     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  8196     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  8197     MOVE ' '                    TO DC-OPTION-CODE
  8198     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8199     IF NO-CONVERSION-ERROR
  8200        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8201           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8202              INTO OUT-1ST-PMT-DT
  8203        END-STRING
  8204     END-IF
  8205     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  8206     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  8207     MOVE ' '                    TO DC-OPTION-CODE
  8208     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8209     IF NO-CONVERSION-ERROR
  8210        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8211           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8212              INTO OUT-ENTRY-DT
  8213        END-STRING
  8214     END-IF
  8215     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8216     MOVE ' '                    TO DC-OPTION-CODE
  8217     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8218     IF NO-CONVERSION-ERROR
  8219        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8220           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8221              INTO OUT-LF-CAN-EXIT-DT
  8222        END-STRING
  8223     END-IF
  8224     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  8225     MOVE ' '                    TO DC-OPTION-CODE
  8226     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8227     IF NO-CONVERSION-ERROR
  8228        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8229           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8230              INTO OUT-LF-DTH-DT
  8231        END-STRING
  8232     END-IF
  8233     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  8234     MOVE ' '                    TO DC-OPTION-CODE
  8235     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8236     IF NO-CONVERSION-ERROR
  8237        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8238           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8239              INTO OUT-LF-DTH-EXIT-DT
  8240        END-STRING
  8241     END-IF
  8242     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  8243     IF OUT-AH-CAN-DT NOT = SPACES
  8244        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  8245     ELSE
  8246        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  8247     END-IF
  8248     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8249     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 144
* NSRASBL.cbl
  8250     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8251     IF NO-CONVERSION-ERROR
  8252        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8253           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8254              INTO OUT-AH-CAN-EXIT-DT
  8255        END-STRING
  8256     END-IF
  8257     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  8258     IF CM-ENTRY-BATCH = LOW-VALUES
  8259        MOVE SPACES              TO CM-ENTRY-BATCH
  8260     END-IF
  8261     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  8262     IF CM-LF-EXIT-BATCH = LOW-VALUES
  8263        MOVE SPACES              TO CM-LF-EXIT-BATCH
  8264     END-IF
  8265     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  8266     IF CM-AH-EXIT-BATCH = LOW-VALUES
  8267        MOVE SPACES              TO CM-AH-EXIT-BATCH
  8268     END-IF
  8269     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  8270     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  8271     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  8272     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  8273     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  8274     COMPUTE WS-WORK-PREM =
  8275        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  8276           + CM-AH-PREMIUM-AMT)
  8277     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  8278                                    OUT-ORIG-TOT-PREM
  8279     COMPUTE WS-WORK-REF =
  8280        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  8281     MOVE WS-WORK-REF            TO OUT-TOT-REF
  8282                                    OUT-ORIG-TOT-REF
  8283     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  8284        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  8285     ELSE
  8286        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  8287     END-IF
  8288     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  8289     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  8290        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  8291     ELSE
  8292        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  8293     END-IF
  8294     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  8295     IF CM-NH-INT-ON-REFS NUMERIC
  8296        IF CM-NH-INT-ON-REFS NOT = ZEROS
  8297           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  8298        END-IF
  8299     END-IF
  8300
  8301     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8302        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8303            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8304        END-IF
  8305        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8306            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8307        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 145
* NSRASBL.cbl
  8308     END-IF
  8309*
  8310*     IF BL-DATA-SRCE = '2'
  8311*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8312*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8313*        END-IF
  8314*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8315*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8316*        END-IF
  8317*     END-IF
  8318
  8319     COMPUTE WS-ACCT-LF-PORTION =
  8320        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8321     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8322                                OUT-ACCT-ORIG-LF-PORT
  8323     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8324        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8325     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8326                                OUT-ACCT-ORIG-ALT-LF-PORT
  8327     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8328        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8329     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  8330                                OUT-ACCT-ORIG-CMB-LF-PORT
  8331     COMPUTE WS-ACCT-AH-PORTION =
  8332        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8333     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8334                                OUT-ACCT-ORIG-AH-PORT
  8335     COMPUTE WS-ACCT-PORTION =
  8336        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8337     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8338                                OUT-ACCT-ORIG-PORTION
  8339
  8340     COMPUTE WS-CSO-LF-PORTION =
  8341       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8342     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8343                               OUT-CSO-ORIG-LF-PORT
  8344     COMPUTE WS-CSO-ALT-LF-PORTION =
  8345       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  8346     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8347                                   OUT-CSO-ORIG-ALT-LF-PORT
  8348     COMPUTE WS-CSO-CMB-LF-PORTION =
  8349       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8350     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8351                                   OUT-CSO-ORIG-CMB-LF-PORT
  8352     COMPUTE WS-CSO-AH-PORTION =
  8353        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  8354     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  8355                               OUT-CSO-ORIG-AH-PORT
  8356     COMPUTE WS-CSO-PORTION =
  8357        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8358     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8359                            OUT-CSO-ORIG-PORTION
  8360     .
  8361 1110-EXIT.
  8362     EXIT.
  8363 1115-MATCH-COMPANY.
  8364     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8365     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 146
* NSRASBL.cbl
  8366     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8367
  8368* EXEC CICS READ
  8369*       INTO    (CONTROL-FILE)
  8370*       DATASET ('ELCNTL')
  8371*       RIDFLD  (WS-ELCNTL-KEY)
  8372*       RESP    (WS-RESPONSE)
  8373*    END-EXEC
  8374     MOVE LENGTH OF
  8375      CONTROL-FILE
  8376       TO DFHEIV11
  8377     MOVE 'ELCNTL' TO DFHEIV1
  8378*    MOVE '&"IL       E          (  N#00008092' TO DFHEIV0
  8379     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8381     MOVE X'204E233030303038303932' TO DFHEIV0(25:11)
  8382     CALL 'kxdfhei1' USING DFHEIV0,
  8383           DFHEIV1,
  8384           CONTROL-FILE,
  8385           DFHEIV11,
  8386           WS-ELCNTL-KEY,
  8387           DFHEIV99,
  8388           DFHEIV99,
  8389           DFHEIV99
  8390     MOVE EIBRESP  TO WS-RESPONSE
  8391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8392     IF RESP-NORMAL
  8393        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8394     END-IF
  8395     .
  8396 1115-EXIT.
  8397     EXIT.
  8398 1120-MATCH-CARRIER.
  8399     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8400     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8401     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8402     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8403
  8404* EXEC CICS READ
  8405*       INTO    (CONTROL-FILE)
  8406*       DATASET ('ELCNTL')
  8407*       RIDFLD  (WS-ELCNTL-KEY)
  8408*       RESP    (WS-RESPONSE)
  8409*    END-EXEC
  8410     MOVE LENGTH OF
  8411      CONTROL-FILE
  8412       TO DFHEIV11
  8413     MOVE 'ELCNTL' TO DFHEIV1
  8414*    MOVE '&"IL       E          (  N#00008109' TO DFHEIV0
  8415     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8417     MOVE X'204E233030303038313039' TO DFHEIV0(25:11)
  8418     CALL 'kxdfhei1' USING DFHEIV0,
  8419           DFHEIV1,
  8420           CONTROL-FILE,
  8421           DFHEIV11,
  8422           WS-ELCNTL-KEY,
  8423           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 147
* NSRASBL.cbl
  8424           DFHEIV99,
  8425           DFHEIV99
  8426     MOVE EIBRESP  TO WS-RESPONSE
  8427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8428     IF RESP-NORMAL
  8429        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8430     ELSE
  8431        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8432     END-IF
  8433     .
  8434 1120-EXIT.
  8435     EXIT.
  8436 1125-MATCH-STATE.
  8437     MOVE BL-STATE               TO OUT-STATE
  8438     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8439     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8440     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8441     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8442
  8443* EXEC CICS READ
  8444*       INTO    (CONTROL-FILE)
  8445*       DATASET ('ELCNTL')
  8446*       RIDFLD  (WS-ELCNTL-KEY)
  8447*       RESP    (WS-RESPONSE)
  8448*    END-EXEC
  8449     MOVE LENGTH OF
  8450      CONTROL-FILE
  8451       TO DFHEIV11
  8452     MOVE 'ELCNTL' TO DFHEIV1
  8453*    MOVE '&"IL       E          (  N#00008129' TO DFHEIV0
  8454     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8456     MOVE X'204E233030303038313239' TO DFHEIV0(25:11)
  8457     CALL 'kxdfhei1' USING DFHEIV0,
  8458           DFHEIV1,
  8459           CONTROL-FILE,
  8460           DFHEIV11,
  8461           WS-ELCNTL-KEY,
  8462           DFHEIV99,
  8463           DFHEIV99,
  8464           DFHEIV99
  8465     MOVE EIBRESP  TO WS-RESPONSE
  8466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8467     IF RESP-NORMAL
  8468        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8469     ELSE
  8470        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8471     END-IF
  8472     .
  8473 1125-EXIT.
  8474     EXIT.
  8475 1130-MATCH-BENCDS.
  8476     MOVE SPACES                 TO WS-LF-ABBRV
  8477                                    WS-LF-DESC
  8478                                    WS-LF-EARN
  8479                                    WS-WAIT-PER
  8480                                    WS-RET-ELIM
  8481                                    WS-AH-DESC
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 148
* NSRASBL.cbl
  8482                                    WS-BEN-DAYS
  8483     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8484        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8485     END-IF
  8486     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8487        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8488     END-IF
  8489     .
  8490 1130-EXIT.
  8491     EXIT.
  8492 1140-MATCH-LFBEN.
  8493     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8494     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8495     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8496     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8497
  8498* EXEC CICS READ
  8499*       INTO    (CONTROL-FILE)
  8500*       DATASET ('ELCNTL')
  8501*       RIDFLD  (WS-ELCNTL-KEY)
  8502*       GTEQ
  8503*       RESP    (WS-RESPONSE)
  8504*    END-EXEC
  8505     MOVE LENGTH OF
  8506      CONTROL-FILE
  8507       TO DFHEIV11
  8508     MOVE 'ELCNTL' TO DFHEIV1
  8509*    MOVE '&"IL       G          (  N#00008165' TO DFHEIV0
  8510     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8511     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8512     MOVE X'204E233030303038313635' TO DFHEIV0(25:11)
  8513     CALL 'kxdfhei1' USING DFHEIV0,
  8514           DFHEIV1,
  8515           CONTROL-FILE,
  8516           DFHEIV11,
  8517           WS-ELCNTL-KEY,
  8518           DFHEIV99,
  8519           DFHEIV99,
  8520           DFHEIV99
  8521     MOVE EIBRESP  TO WS-RESPONSE
  8522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8523     IF RESP-NORMAL
  8524        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8525           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8526           OR (S1 > +8)
  8527        END-PERFORM
  8528        IF S1 < + 9
  8529           MOVE CF-BENEFIT-ALPHA (S1)
  8530                                 TO WS-LF-ABBRV
  8531           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8532           MOVE CF-CO-EARNINGS-CALC (S1)
  8533                                 TO WS-LF-EARN
  8534        ELSE
  8535           MOVE 'XX'             TO WS-LF-DESC
  8536           MOVE 'XXX'            TO WS-LF-ABBRV
  8537        END-IF
  8538     ELSE
  8539        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 149
* NSRASBL.cbl
  8540     END-IF
  8541     .
  8542 1140-EXIT.
  8543     EXIT.
  8544 1150-MATCH-AHBEN.
  8545     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8546     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8547     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8548     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8549
  8550* EXEC CICS READ
  8551*       INTO    (CONTROL-FILE)
  8552*       DATASET ('ELCNTL')
  8553*       RIDFLD  (WS-ELCNTL-KEY)
  8554*       GTEQ
  8555*       RESP    (WS-RESPONSE)
  8556*    END-EXEC
  8557     MOVE LENGTH OF
  8558      CONTROL-FILE
  8559       TO DFHEIV11
  8560     MOVE 'ELCNTL' TO DFHEIV1
  8561*    MOVE '&"IL       G          (  N#00008198' TO DFHEIV0
  8562     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8564     MOVE X'204E233030303038313938' TO DFHEIV0(25:11)
  8565     CALL 'kxdfhei1' USING DFHEIV0,
  8566           DFHEIV1,
  8567           CONTROL-FILE,
  8568           DFHEIV11,
  8569           WS-ELCNTL-KEY,
  8570           DFHEIV99,
  8571           DFHEIV99,
  8572           DFHEIV99
  8573     MOVE EIBRESP  TO WS-RESPONSE
  8574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8575     IF RESP-NORMAL
  8576        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8577           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8578           OR (S1 > +8)
  8579        END-PERFORM
  8580        IF S1 < + 9
  8581           MOVE CF-BENEFIT-ALPHA (S1)
  8582                                 TO WS-WAIT-PER
  8583           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8584                                 TO WS-RET-ELIM
  8585           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8586                                 TO WS-BEN-DAYS
  8587           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8588              IF CF-JOINT-INDICATOR (S1) = 'J'
  8589                 MOVE 'Joint Critical Period Disability'
  8590                                 TO WS-AH-DESC
  8591              ELSE
  8592                 MOVE 'Single Critical Period-Primary Only'
  8593                                 TO WS-AH-DESC
  8594              END-IF
  8595           ELSE
  8596              IF CF-JOINT-INDICATOR (S1) = 'J'
  8597                 MOVE 'Joint Disability'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 150
* NSRASBL.cbl
  8598                                 TO WS-AH-DESC
  8599              ELSE
  8600                 MOVE 'Single Disability (Primary Only)'
  8601                                 TO WS-AH-DESC
  8602              END-IF
  8603           END-IF
  8604        ELSE
  8605           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8606        END-IF
  8607     ELSE
  8608        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8609     END-IF
  8610     .
  8611 1150-EXIT.
  8612     EXIT.
  8613
  8614 1160-READ-CERT-TRAILER.
  8615
  8616     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8617     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8618     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8619
  8620
  8621* EXEC CICS HANDLE CONDITION
  8622*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8623*    END-EXEC.
  8624*    MOVE '"$I                   ! " #00008250' TO DFHEIV0
  8625     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8627     MOVE X'2220233030303038323530' TO DFHEIV0(25:11)
  8628     CALL 'kxdfhei1' USING DFHEIV0
  8629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8630
  8631
  8632
  8633* EXEC CICS READ
  8634*        DATASET  ('ELCRTT')
  8635*        RIDFLD   (WS-ELCRTT-KEY)
  8636*        INTO     (CERTIFICATE-TRAILERS)
  8637*    END-EXEC.
  8638     MOVE LENGTH OF
  8639      CERTIFICATE-TRAILERS
  8640       TO DFHEIV11
  8641     MOVE 'ELCRTT' TO DFHEIV1
  8642*    MOVE '&"IL       E          (   #00008254' TO DFHEIV0
  8643     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8644     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8645     MOVE X'2020233030303038323534' TO DFHEIV0(25:11)
  8646     CALL 'kxdfhei1' USING DFHEIV0,
  8647           DFHEIV1,
  8648           CERTIFICATE-TRAILERS,
  8649           DFHEIV11,
  8650           WS-ELCRTT-KEY,
  8651           DFHEIV99,
  8652           DFHEIV99,
  8653           DFHEIV99
  8654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8655
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 151
* NSRASBL.cbl
  8656
  8657     GO TO 1160-EXIT.
  8658
  8659 1160-CERT-TRL-REC-NOTFND.
  8660     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8661
  8662 1160-EXIT.
  8663     EXIT.
  8664 1200-GET-ERACCT.
  8665     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8666     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8667                                    OUT-ACCT-ADDR1
  8668                                    OUT-ACCT-ADDR2
  8669                                    OUT-ACCT-CITY
  8670     MOVE ZEROS                  TO WS-CHGBACK
  8671
  8672* EXEC CICS STARTBR
  8673*        DATASET   ('ERACCT')
  8674*        RIDFLD    (WS-ERACCT-KEY)
  8675*        GTEQ
  8676*        RESP      (WS-RESPONSE)
  8677*    END-EXEC
  8678     MOVE 'ERACCT' TO DFHEIV1
  8679     MOVE 0
  8680       TO DFHEIV11
  8681*    MOVE '&,         G          &  N#00008274' TO DFHEIV0
  8682     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8683     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8684     MOVE X'204E233030303038323734' TO DFHEIV0(25:11)
  8685     CALL 'kxdfhei1' USING DFHEIV0,
  8686           DFHEIV1,
  8687           WS-ERACCT-KEY,
  8688           DFHEIV99,
  8689           DFHEIV11,
  8690           DFHEIV99
  8691     MOVE EIBRESP  TO WS-RESPONSE
  8692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8693     IF RESP-NORMAL
  8694
  8695* EXEC CICS READNEXT
  8696*          INTO    (ACCOUNT-MASTER)
  8697*          DATASET ('ERACCT')
  8698*          RIDFLD  (WS-ERACCT-KEY)
  8699*          RESP    (WS-RESPONSE)
  8700*       END-EXEC
  8701     MOVE LENGTH OF
  8702      ACCOUNT-MASTER
  8703       TO DFHEIV12
  8704     MOVE 'ERACCT' TO DFHEIV1
  8705     MOVE 0
  8706       TO DFHEIV11
  8707*    MOVE '&.IL                  )  N#00008281' TO DFHEIV0
  8708     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8709     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8710     MOVE X'204E233030303038323831' TO DFHEIV0(25:11)
  8711     CALL 'kxdfhei1' USING DFHEIV0,
  8712           DFHEIV1,
  8713           ACCOUNT-MASTER,
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 152
* NSRASBL.cbl
  8714           DFHEIV12,
  8715           WS-ERACCT-KEY,
  8716           DFHEIV99,
  8717           DFHEIV11,
  8718           DFHEIV99,
  8719           DFHEIV99
  8720     MOVE EIBRESP  TO WS-RESPONSE
  8721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8722     END-IF
  8723     IF RESP-NORMAL
  8724        PERFORM UNTIL
  8725           NOT (RESP-NORMAL)
  8726           OR (WS-SAVE-ERACCT-KEY NOT =
  8727                        AM-CONTROL-PRIMARY (1:20))
  8728           IF BL-DATA-SRCE = '4' OR '2'
  8729              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8730                 AND >= AM-EFFECTIVE-DT)
  8731                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8732                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8733                    OR (S1 > +10)
  8734                 END-PERFORM
  8735                 IF S1 < +11
  8736                    MOVE AM-COMM-CHARGEBACK (S1)
  8737                                 TO WS-CHGBACK
  8738                 END-IF
  8739              END-IF
  8740           END-IF
  8741           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8742
  8743* EXEC CICS READNEXT
  8744*             INTO    (ACCOUNT-MASTER)
  8745*             DATASET ('ERACCT')
  8746*             RIDFLD  (WS-ERACCT-KEY)
  8747*             RESP    (WS-RESPONSE)
  8748*          END-EXEC
  8749     MOVE LENGTH OF
  8750      ACCOUNT-MASTER
  8751       TO DFHEIV12
  8752     MOVE 'ERACCT' TO DFHEIV1
  8753     MOVE 0
  8754       TO DFHEIV11
  8755*    MOVE '&.IL                  )  N#00008307' TO DFHEIV0
  8756     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8757     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8758     MOVE X'204E233030303038333037' TO DFHEIV0(25:11)
  8759     CALL 'kxdfhei1' USING DFHEIV0,
  8760           DFHEIV1,
  8761           ACCOUNT-MASTER,
  8762           DFHEIV12,
  8763           WS-ERACCT-KEY,
  8764           DFHEIV99,
  8765           DFHEIV11,
  8766           DFHEIV99,
  8767           DFHEIV99
  8768     MOVE EIBRESP  TO WS-RESPONSE
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8770        END-PERFORM
  8771        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 153
* NSRASBL.cbl
  8772        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8773           SET ACCT-FOUND TO TRUE
  8774           MOVE AM-NAME          TO OUT-ACCT-NAME
  8775           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8776           MOVE SPACES           TO OUT-ACCT-ADDR2
  8777           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8778           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8779           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8780           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8781           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8782           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8783           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8784              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8785                 INTO OUT-ACCT-ZIP (6:5)
  8786              END-STRING
  8787           END-IF
  8788           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8789           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8790           MOVE AM-STATE         TO OUT-FORM
  8791           IF AM-ACCOUNT (10:1) = 'L'
  8792              MOVE 'L'           TO OUT-FORM (3:1)
  8793                                    OUT-LEASE-IND
  8794           END-IF
  8795           MOVE AM-CONTROL-PRIMARY (1:8)
  8796                                 TO WS-ERCOMP-KEY
  8797           IF AM-REMIT-TO NOT NUMERIC
  8798              MOVE 01            TO AM-REMIT-TO
  8799           END-IF
  8800           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8801           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8802              (AM-COM-TYP (S1) = 'C' OR 'D')
  8803              OR (S1 > +10)
  8804           END-PERFORM
  8805           IF S1 < +11
  8806              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8807           END-IF
  8808           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8809           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8810        END-IF
  8811     END-IF
  8812
  8813* EXEC CICS ENDBR
  8814*        DATASET   ('ERACCT')
  8815*    END-EXEC
  8816     MOVE 'ERACCT' TO DFHEIV1
  8817     MOVE 0
  8818       TO DFHEIV11
  8819*    MOVE '&2                    $   #00008355' TO DFHEIV0
  8820     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8821     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8822     MOVE X'2020233030303038333535' TO DFHEIV0(25:11)
  8823     CALL 'kxdfhei1' USING DFHEIV0,
  8824           DFHEIV1,
  8825           DFHEIV11,
  8826           DFHEIV99
  8827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8828    .
  8829 1200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 154
* NSRASBL.cbl
  8830     EXIT.
  8831 1225-GET-ERCOMP.
  8832
  8833* EXEC CICS READ
  8834*       INTO    (COMPENSATION-MASTER)
  8835*       DATASET ('ERCOMP')
  8836*       RIDFLD  (WS-ERCOMP-KEY)
  8837*       RESP    (WS-RESPONSE)
  8838*    END-EXEC
  8839     MOVE LENGTH OF
  8840      COMPENSATION-MASTER
  8841       TO DFHEIV11
  8842     MOVE 'ERCOMP' TO DFHEIV1
  8843*    MOVE '&"IL       E          (  N#00008362' TO DFHEIV0
  8844     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8846     MOVE X'204E233030303038333632' TO DFHEIV0(25:11)
  8847     CALL 'kxdfhei1' USING DFHEIV0,
  8848           DFHEIV1,
  8849           COMPENSATION-MASTER,
  8850           DFHEIV11,
  8851           WS-ERCOMP-KEY,
  8852           DFHEIV99,
  8853           DFHEIV99,
  8854           DFHEIV99
  8855     MOVE EIBRESP  TO WS-RESPONSE
  8856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8857     IF RESP-NORMAL
  8858        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8859        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8860        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8861        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8862        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8863        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8864        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8865        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8866        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8867        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8868        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8869        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8870     END-IF
  8871     .
  8872 1225-EXIT.
  8873     EXIT.
  8874 1250-GET-ELLETR.
  8875     display ' made it to 1250 '
  8876     move spaces                 to W-Z-CONTROL-DATA
  8877     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8878     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8879     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8880
  8881* EXEC CICS READ
  8882*         DATASET    ('ELLETR')
  8883*         INTO       (TEXT-FILES)
  8884*         RIDFLD     (WS-ELLETR-KEY)
  8885*         RESP       (WS-RESPONSE)
  8886*         GTEQ
  8887*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 155
* NSRASBL.cbl
  8888     MOVE LENGTH OF
  8889      TEXT-FILES
  8890       TO DFHEIV11
  8891     MOVE 'ELLETR' TO DFHEIV1
  8892*    MOVE '&"IL       G          (  N#00008391' TO DFHEIV0
  8893     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8894     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8895     MOVE X'204E233030303038333931' TO DFHEIV0(25:11)
  8896     CALL 'kxdfhei1' USING DFHEIV0,
  8897           DFHEIV1,
  8898           TEXT-FILES,
  8899           DFHEIV11,
  8900           WS-ELLETR-KEY,
  8901           DFHEIV99,
  8902           DFHEIV99,
  8903           DFHEIV99
  8904     MOVE EIBRESP  TO WS-RESPONSE
  8905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8906     IF RESP-NORMAL
  8907        IF (LETTER-FILE-TEXT)
  8908           AND (BL-LETTER-ID = TX-LETTER-NO)
  8909           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8910           display ' found good z record '
  8911           PERFORM 1280-PROCESS-Z-CONTROLS
  8912                                 THRU 1280-EXIT
  8913        END-IF
  8914     END-IF
  8915     .
  8916 1250-EXIT.
  8917     EXIT.
  8918 1280-PROCESS-Z-CONTROLS.
  8919     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8920*    IF W-FORM-TO-RESEND > SPACES
  8921*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8922*    ELSE
  8923*       MOVE SPACES              TO OUT-FORM
  8924*    END-IF
  8925     IF BL-ENC-CD = SPACES OR LOW-VALUES
  8926        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8927     END-IF
  8928     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8929     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8930     .
  8931 1280-EXIT.
  8932     EXIT.
  8933 1300-DETERMINE-COMM.
  8934******************************************************************
  8935* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8936*    1) FROM ACCT MAINT
  8937*    2) FROM CERT UPDATE
  8938*    3) FROM COMP MAINT
  8939*    4) FROM REVIEW AND CORRECTIONS
  8940******************************************************************
  8941     MOVE 'Y'                    TO OUT-CHGBACK
  8942     MOVE ZEROS                  TO WS-DIFF
  8943                                    WS-CHGBK-LIFE-PCT
  8944                                    WS-CHGBK-AH-PCT
  8945     IF BL-DATA-SRCE = '4'
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 156
* NSRASBL.cbl
  8946        IF PB-CANCELLATION
  8947           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8948           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8949           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8950           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8951           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8952              MOVE PB-C-LF-CANCEL-DT
  8953                                 TO DC-BIN-DATE-2
  8954           END-IF
  8955           MOVE '1'              TO DC-OPTION-CODE
  8956           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8957           IF NO-CONVERSION-ERROR
  8958              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8959              IF DC-ODD-DAYS-OVER > +1
  8960                 ADD +1          TO WS-DIFF
  8961              END-IF
  8962              IF (WS-CHGBACK = 99)
  8963                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8964                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8965                                WS-CHGBK-AH-PCT
  8966                   MOVE 'N'  TO OUT-CHGBACK
  8967              END-IF
  8968           END-IF
  8969        ELSE
  8970           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8971           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8972        END-IF
  8973     ELSE
  8974        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8975        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8976        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8977           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8978           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8979           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8980           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8981              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8982           END-IF
  8983           MOVE '1'              TO DC-OPTION-CODE
  8984           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8985           IF NO-CONVERSION-ERROR
  8986              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8987              IF DC-ODD-DAYS-OVER > +1
  8988                 ADD +1          TO WS-DIFF
  8989              END-IF
  8990              IF (WS-CHGBACK = 99)
  8991                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8992                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8993                                WS-CHGBK-AH-PCT
  8994                   MOVE 'N'  TO OUT-CHGBACK
  8995              END-IF
  8996           END-IF
  8997        END-IF
  8998     END-IF
  8999     .
  9000 1300-EXIT.
  9001     EXIT.
  9002 1500-GET-ARCH-NO.
  9003     DISPLAY ' MADE IT TO 1500 '
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 157
* NSRASBL.cbl
  9004     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  9005     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  9006     MOVE SPACES                 TO WS-ELCNTL-GENL
  9007     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  9008
  9009* EXEC CICS READ
  9010*       INTO    (CONTROL-FILE)
  9011*       DATASET ('ELCNTL')
  9012*       RIDFLD  (WS-ELCNTL-KEY)
  9013*       UPDATE
  9014*       RESP    (WS-RESPONSE)
  9015*    END-EXEC
  9016     MOVE LENGTH OF
  9017      CONTROL-FILE
  9018       TO DFHEIV11
  9019     MOVE 'ELCNTL' TO DFHEIV1
  9020*    MOVE '&"IL       EU         (  N#00008500' TO DFHEIV0
  9021     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9022     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9023     MOVE X'204E233030303038353030' TO DFHEIV0(25:11)
  9024     CALL 'kxdfhei1' USING DFHEIV0,
  9025           DFHEIV1,
  9026           CONTROL-FILE,
  9027           DFHEIV11,
  9028           WS-ELCNTL-KEY,
  9029           DFHEIV99,
  9030           DFHEIV99,
  9031           DFHEIV99
  9032     MOVE EIBRESP  TO WS-RESPONSE
  9033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9034     IF RESP-NORMAL
  9035        AND (CF-COMPANY-ID  = BL-COMP-ID)
  9036        AND (CF-RECORD-TYPE = '1')
  9037        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  9038        MOVE CF-CREDIT-LAST-ARCH-NUM
  9039                                 TO WS-ARCHIVE-NO
  9040
  9041* EXEC CICS REWRITE
  9042*          FROM    (CONTROL-FILE)
  9043*          DATASET ('ELCNTL')
  9044*       END-EXEC
  9045     MOVE LENGTH OF
  9046      CONTROL-FILE
  9047       TO DFHEIV11
  9048     MOVE 'ELCNTL' TO DFHEIV1
  9049*    MOVE '&& L                  %   #00008513' TO DFHEIV0
  9050     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9051     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9052     MOVE X'2020233030303038353133' TO DFHEIV0(25:11)
  9053     CALL 'kxdfhei1' USING DFHEIV0,
  9054           DFHEIV1,
  9055           CONTROL-FILE,
  9056           DFHEIV11,
  9057           DFHEIV99
  9058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9059     ELSE
  9060        MOVE +0                  TO WS-ARCHIVE-NO
  9061     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 158
* NSRASBL.cbl
  9062    .
  9063 1500-EXIT.
  9064     EXIT.
  9065 1700-GET-ELENCC.
  9066     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  9067     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  9068     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  9069     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  9070        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  9071        OR (E1 > +5)
  9072     END-PERFORM
  9073     IF E1 < +5
  9074        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  9075     END-IF
  9076
  9077* EXEC CICS READ
  9078*        DATASET   ('ELENCC')
  9079*        INTO      (ENCLOSURE-CODES)
  9080*        RIDFLD    (WS-ELENCC-KEY)
  9081*        RESP      (WS-RESPONSE)
  9082*    END-EXEC
  9083     MOVE LENGTH OF
  9084      ENCLOSURE-CODES
  9085       TO DFHEIV11
  9086     MOVE 'ELENCC' TO DFHEIV1
  9087*    MOVE '&"IL       E          (  N#00008534' TO DFHEIV0
  9088     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9090     MOVE X'204E233030303038353334' TO DFHEIV0(25:11)
  9091     CALL 'kxdfhei1' USING DFHEIV0,
  9092           DFHEIV1,
  9093           ENCLOSURE-CODES,
  9094           DFHEIV11,
  9095           WS-ELENCC-KEY,
  9096           DFHEIV99,
  9097           DFHEIV99,
  9098           DFHEIV99
  9099     MOVE EIBRESP  TO WS-RESPONSE
  9100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9101     IF NOT RESP-NORMAL
  9102        display ' elencc resp not normal ' ws-response
  9103        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  9104
  9105* EXEC CICS READ
  9106*           DATASET   ('ELENCC')
  9107*           INTO      (ENCLOSURE-CODES)
  9108*           RIDFLD    (WS-ELENCC-KEY)
  9109*           RESP      (WS-RESPONSE)
  9110*       END-EXEC
  9111     MOVE LENGTH OF
  9112      ENCLOSURE-CODES
  9113       TO DFHEIV11
  9114     MOVE 'ELENCC' TO DFHEIV1
  9115*    MOVE '&"IL       E          (  N#00008543' TO DFHEIV0
  9116     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9118     MOVE X'204E233030303038353433' TO DFHEIV0(25:11)
  9119     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 159
* NSRASBL.cbl
  9120           DFHEIV1,
  9121           ENCLOSURE-CODES,
  9122           DFHEIV11,
  9123           WS-ELENCC-KEY,
  9124           DFHEIV99,
  9125           DFHEIV99,
  9126           DFHEIV99
  9127     MOVE EIBRESP  TO WS-RESPONSE
  9128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9129     END-IF
  9130     IF RESP-NORMAL
  9131        display ' elencc resp normal ' ws-response
  9132        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  9133        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  9134        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  9135     END-IF
  9136     .
  9137 1700-EXIT.
  9138     EXIT.
  9139
  9140
  9141 4100-CONNECT-TO-DB.
  9142
  9143     MOVE 'NTCSO2_LOGIC'         TO SVR
  9144     MOVE 'sa'                   TO USR
  9145     MOVE 'ntcso2'               TO PASS
  9146
  9147     STRING
  9148         USR DELIMITED SPACE
  9149         "." DELIMITED SIZE
  9150         PASS DELIMITED SPACE INTO USR-PASS
  9151     END-STRING
  9152
  9153     EXEC SQL
  9154        CONNECT TO :SVR USER :USR-PASS
  9155     END-EXEC
  9156
  9157     IF SQLCODE NOT = 0
  9158        DISPLAY "ERROR: CANNOT CONNECT "
  9159        DISPLAY SQLCODE
  9160        DISPLAY SQLERRMC
  9161        GO TO 4100-EXIT
  9162     END-IF
  9163
  9164     .
  9165 4100-EXIT.
  9166     EXIT.
  9167
  9168
  9169
  9170 4200-GET-NEXT-BUS-DT.
  9171
  9172     MOVE WS-SAVE-EDIT-A-DATE    TO WS-CYCLE-DATE
  9173     MOVE SPACES                 TO WS-NEXT-BUS-DT
  9174
  9175     IF WS-KIXHOST = 'logictest'
  9176        EXEC SQL
  9177          CALL NaperTestCalcNextBusDt
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 160
* NSRASBL.cbl
  9178                        @cycledate = :WS-CYCLE-DATE,
  9179                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9180        END-EXEC
  9181     ELSE
  9182        EXEC SQL
  9183          CALL NaperProdCalcNextBusDt
  9184                        @cycledate = :WS-CYCLE-DATE,
  9185                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9186        END-EXEC
  9187     END-IF
  9188
  9189     IF SQLCODE NOT = 0
  9190        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
  9191        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9192        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9193        GO TO 4200-EXIT
  9194     END-IF
  9195
  9196     .
  9197 4200-EXIT.
  9198     EXIT.
  9199
  9200
  9201
  9202 4300-DISCONNECT.
  9203
  9204     EXEC SQL
  9205        DISCONNECT
  9206     END-EXEC
  9207     .
  9208 4300-EXIT.
  9209     EXIT.
  9210
  9211 9700-DATE-LINK.
  9212
  9213* EXEC CICS LINK
  9214*        PROGRAM   ('ELDATCV')
  9215*        COMMAREA  (DATE-CONVERSION-DATA)
  9216*        LENGTH    (DC-COMM-LENGTH)
  9217*    END-EXEC.
  9218     MOVE 'ELDATCV' TO DFHEIV1
  9219*    MOVE '."C                   (   #00008632' TO DFHEIV0
  9220     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9221     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9222     MOVE X'2020233030303038363332' TO DFHEIV0(25:11)
  9223     CALL 'kxdfhei1' USING DFHEIV0,
  9224           DFHEIV1,
  9225           DATE-CONVERSION-DATA,
  9226           DC-COMM-LENGTH,
  9227           DFHEIV99,
  9228           DFHEIV99,
  9229           DFHEIV99,
  9230           DFHEIV99
  9231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9232
  9233 9700-EXIT.
  9234      EXIT.
  9235
* Micro Focus Server Express         V5.1 revision 000 15-Dec-15 10:01 Page 161
* NSRASBL.cbl
  9236 9999-DFHBACK SECTION.
  9237     MOVE '9%                    "   ' TO DFHEIV0
  9238     MOVE 'NSRASBL' TO DFHEIV1
  9239     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9240     GOBACK.
  9241 9999-DFHEXIT.
  9242     IF DFHEIGDJ EQUAL 0001
  9243         NEXT SENTENCE
  9244     ELSE IF DFHEIGDJ EQUAL 2
  9245         GO TO 1160-CERT-TRL-REC-NOTFND
  9246         DEPENDING ON DFHEIGDI.
  9247     MOVE '9%                    "   ' TO DFHEIV0
  9248     MOVE 'NSRASBL' TO DFHEIV1
  9249     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9250     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      168492     Code:       57562
