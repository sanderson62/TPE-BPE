* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52* 100417  CR2017051000002  PEMA  Add fields to interface
    53* 100418  CR2018073000001  PEMA  REWORD REFUND METHODS
    54* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    55* 052319  IR2019052300001  PEMA  VIN&BENE not being passed at time
    56******************************************************************
    57 environment division.
    58 data division.
    59 working-storage section.
    60 01  DFH-START PIC X(04).
    61*
    62* program buffers
    63*
    64 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    65     88  ALREADY-SENT              VALUE 'Y'.
    66 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    67 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    68     88  ELCERT-FINISHED            VALUE 'Y'.
    69 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    70 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    71     88  ERACCT-FOUND               VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   3
* SOCK03.cbl
    72 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    73 77 ws-send-msg-size           pic s9(8) comp value 4096.
    74 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    75 77 ws-recv-buf                pic x(4096).
    76 77 ws-send-buf                pic x(4096) VALUE SPACES.
    77 77 ws-recv-total              pic s9(8) comp value 0.
    78 77 ws-recv-left               pic s9(8) comp value 0.
    79 77 ws-seq-num                 pic s9(8) comp value 0.
    80 77 ws-flags                   pic s9(8) comp value 0.
    81 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    82 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    83 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    84 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    85 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    86 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    87 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    88 77  ws-cancel-reason            pic x   value spaces.
    89 77  P1                          PIC S999 COMP-3 VALUE +0.
    90 77  P2                          PIC S999 COMP-3 VALUE +0.
    91 77  C0                          PIC S999 COMP-3 VALUE +0.
    92 77  C1                          PIC S999 COMP-3 VALUE +0.
    93 77  C2                          PIC S999 COMP-3 VALUE +0.
    94 77  C3                          PIC S999 COMP-3 VALUE +0.
    95 77 S1                           PIC S999 COMP-3 VALUE +0.
    96 77 S2                           PIC S999 COMP-3 VALUE +0.
    97 77 L1                           PIC S999 COMP-3 VALUE +0.
    98 77 L2                           PIC S999 COMP-3 VALUE +0.
    99 77 F1                           PIC S999 COMP-3 VALUE +0.
   100 77 WS-BUILD-SW                  PIC X.
   101    88  TIME-TO-BUILD               VALUE 'Y'.
   102 77 WS-SAVE-ERACCT               PIC X(2000).
   103 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   104 77 WS-STOP-SW                   PIC X  VALUE ' '.
   105    88  TOLD-TO-STOP               VALUE 'Y'.
   106 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   107    88  GET-RATES                    VALUE 'R'.
   108    88  GET-ACT-ACCTS                VALUE 'A'.
   109 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   110 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   111 77 ws-disp-rate                 pic z9.99999.
   112 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   113     88  END-OF-ERCTBL                 VALUE 'Y'.
   114 77  WS-STATUS                   PIC X.
   115 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   116 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   117 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   118 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   119 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   120 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   121 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   122 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   123 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   124 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   125 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   126 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   127     88  WS-ELCERT-FULL             VALUE '1'.
   128     88  WS-ELCERT-NAME             VALUE '2'.
   129     88  WS-ELCERT-CERT-NO          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   4
* SOCK03.cbl
   130     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   131 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   132 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   133     88  I-SAY-TO-STOP      VALUE 'Y'.
   134 77  WS-HEX-0A                   PIC X.
   135 77  WS-CALL-TYPE                PIC X(6).
   136 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   137 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   138 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   139 77  DD-IU-SW                    PIC X   VALUE ' '.
   140     88  DD-IU-PRESENT                 VALUE 'Y'.
   141 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   142 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   143 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   144 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   145 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   146 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   147 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   148 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   149 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   150     88  PDEF-FOUND                              VALUE 'Y'.
   151 77  ws-epiq-sw                  pic x  value ' '.
   152     88  ws-epiq-request           value 'Y'.
   153 77  ws-epiq-max                 pic s999 value +0 comp-3.
   154 01  WS-STRING-DATA.
   155     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   156     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   157     05  WS-CARRIER              PIC X        VALUE SPACES.
   158     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   159     05  WS-STATE                PIC XX       VALUE SPACES.
   160     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   161     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   162     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   163     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   164     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   165     05  WS-MID-INIT             PIC X        VALUE SPACES.
   166     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   167     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   168     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   169     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   170     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   171     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   172     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   173     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   174     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   175     05  WS-LF-METHOD            PIC X(15)    VALUE SPACES.
   176     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   177     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   178     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   179     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   180     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   181     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   182     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   183     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   184     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   185     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   186     05  WS-AH-METHOD            PIC X(15)    VALUE SPACES.
   187     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   5
* SOCK03.cbl
   188     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   189     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   190     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   191     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   192     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   193     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   194     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   195     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   196     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   197     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   198     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   199     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   200     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   201     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   202     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   203     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   204     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   205     05  WS-LF-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   206     05  WS-AH-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   207     05  WS-VIN                  PIC X(17)  VALUE SPACES.
   208     05  WS-CRED-BENE-NAME       PIC X(30)  VALUE SPACES.
   209 01  ws-work-date.
   210     05  ws-work-ccyy            pic x(4).
   211     05  ws-work-mm              pic xx.
   212     05  ws-work-dd              pic xx.
   213 01  ws-work-date-num redefines ws-work-date
   214                                 pic 9(8).
   215 01  FILLER.
   216     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   217     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   218     12  WS-STATE-ABBREVIATION   PIC XX.
   219     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   220     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   221     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   222     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   223     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   224     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   225     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   226     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   227     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   228     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   229     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   230     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   231     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   232     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   233     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   234     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   235     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   236     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   237     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   238     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   239     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   240     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   241     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   242     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   243     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   244     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   245         88  WS-REDUCING                         VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   6
* SOCK03.cbl
   246         88  WS-LEVEL                            VALUE 'L'  'P'.
   247 01  ELMSTR-KEY.
   248     12  ELMSTR-COMP-CD          PIC X.
   249     12  ELMSTR-CERT-NO          PIC X(11).
   250 01  CTBL-KEY-SAVE               PIC X(5).
   251 01  CTBL-KEY.
   252     05  CTBL-COMPANY-CD         PIC X.
   253     05  CTBL-TABLE              PIC XXX.
   254     05  CTBL-BEN-TYPE           PIC X.
   255     05  CTBL-BEN-CODE           PIC XX.
   256 01  ERPDEF-KEY-SAVE             PIC X(18).
   257 01  ERPDEF-KEY.
   258     12  ERPDEF-COMPANY-CD       PIC X.
   259     12  ERPDEF-STATE            PIC XX.
   260     12  ERPDEF-PROD-CD          PIC XXX.
   261     12  F                       PIC X(7).
   262     12  ERPDEF-BEN-TYPE         PIC X.
   263     12  ERPDEF-BEN-CODE         PIC XX.
   264     12  ERPDEF-EXP-DT           PIC XX.
   265 01  WS-AM3-KEY.
   266     12  WS-AM3-ACCOUNT          PIC X(10).
   267     12  WS-AM3-EXP-DT           PIC XX.
   268 01  WS-AM-KEY.
   269     12  WS-AM-COMPANY-CD        PIC X.
   270     12  WS-AM-CARRIER           PIC X.
   271     12  WS-AM-GROUPING          PIC X(6).
   272     12  WS-AM-STATE             PIC XX.
   273     12  WS-AM-ACCOUNT           PIC X(10).
   274     12  WS-AM-EXPIRATION-DT     PIC XX.
   275     12  WS-AM-FILLER            PIC XXXX.
   276 01  WS-CO-DATA.
   277     05  WS-CO-NUM               PIC X(10).
   278     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   279     05  WS-CO-NAME              PIC X(30).
   280     05  WS-CO-MAIL-NAME         PIC X(30).
   281     05  WS-CO-ADDR1             PIC X(30).
   282     05  WS-CO-ADDR2             PIC X(30).
   283     05  WS-CO-ADDR3             PIC X(30).
   284     05  WS-CO-ZIP               PIC X(9).
   285     05  WS-CO-PHONE             PIC X(10).
   286 01  WS-CF-KEY.
   287     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   288     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   289*        88  COMPANY-MASTER                      VALUE '1'.
   290*        88  STATE-MASTER                        VALUE '3'.
   291*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   292*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   293     12  WS-CF-ACCESS.
   294         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   295         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   296             20  FILLER          PIC  X(01).
   297             20  WS-CF-CARRIER   PIC  X(01).
   298     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   299 01  WS-CS-KEY.
   300     05  WS-CS-COMPANY-CD        PIC X.
   301     05  WS-CS-CARRIER           PIC X.
   302     05  WS-CS-GROUP             PIC X(6).
   303     05  WS-CS-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   7
* SOCK03.cbl
   304     05  WS-CS-ACCOUNT           PIC X(10).
   305     05  WS-CS-EFF-DT            PIC XX.
   306     05  WS-CS-CERT-NO           PIC X(11).
   307     05  WS-CS-TRLR-TYPE         PIC X.
   308 01  WS-MA-KEY.
   309     05  WS-MA-COMPANY-CD        PIC X.
   310     05  WS-MA-CARRIER           PIC X.
   311     05  WS-MA-GROUP             PIC X(6).
   312     05  WS-MA-STATE             PIC XX.
   313     05  WS-MA-ACCOUNT           PIC X(10).
   314     05  WS-MA-EFF-DT            PIC XX.
   315     05  WS-MA-CERT-NO           PIC X(11).
   316 01  WS-CM-KEY.
   317     05  WS-CM-COMPANY-CD        PIC X.
   318     05  WS-CM-CARRIER           PIC X.
   319     05  WS-CM-GROUP             PIC X(6).
   320     05  WS-CM-STATE             PIC XX.
   321     05  WS-CM-ACCOUNT           PIC X(10).
   322     05  WS-CM-EFF-DT            PIC XX.
   323     05  WS-CM-CERT-NO           PIC X(11).
   324 01  WS-CM-KEY-A1.
   325     05  WS-CM-COMPANY-CD-A1     PIC X.
   326     05  WS-CM-LAST-NAME         PIC X(15).
   327     05  WS-CM-INITIALS          PIC XX.
   328 01  WS-CM-KEY-A4.
   329     05  WS-CM-COMPANY-CD-A4     PIC X.
   330     05  WS-CM-CERT-NO-A4        PIC X(11).
   331 01  WS-CID-NO                   PIC X(8).
   332 01  WS-DISP-RESP                PIC 9(5).
   333 01  WS-RESPONSE                 PIC S9(8)   COMP.
   334     88  RESP-NORMAL                  VALUE +00.
   335     88  RESP-NOTFND                  VALUE +13.
   336     88  RESP-DUPKEY                  VALUE +15.
   337     88  RESP-NOTOPEN                 VALUE +19.
   338     88  RESP-ENDFILE                 VALUE +20.
   339*                                 COPY ELCCERT.
   340******************************************************************
   341*                                                                *
   342*                            ELCCERT.                            *
   343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   344*                            VMOD=2.013                          *
   345*                                                                *
   346*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   347*                                                                *
   348*   FILE TYPE = VSAM,KSDS                                        *
   349*   RECORD SIZE = 450  RECFORM = FIXED                           *
   350*                                                                *
   351*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   352*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   353*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   354*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   355*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   356*                                                                *
   357*   LOG = YES                                                    *
   358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   359******************************************************************
   360*                   C H A N G E   L O G
   361*
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   8
* SOCK03.cbl
   362* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   363*-----------------------------------------------------------------
   364*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   365* EFFECTIVE    NUMBER
   366*-----------------------------------------------------------------
   367* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   368* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   369* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   370* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   371* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   372* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   373* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   374* 032612  CR2011110200001  PEMA  AHL CHANGES
   375* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   376* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   377* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   378******************************************************************
   379
   380 01  CERTIFICATE-MASTER.
   381     12  CM-RECORD-ID                      PIC XX.
   382         88  VALID-CM-ID                      VALUE 'CM'.
   383
   384     12  CM-CONTROL-PRIMARY.
   385         16  CM-COMPANY-CD                 PIC X.
   386         16  CM-CARRIER                    PIC X.
   387         16  CM-GROUPING.
   388             20  CM-GROUPING-PREFIX        PIC X(3).
   389             20  CM-GROUPING-PRIME         PIC X(3).
   390         16  CM-STATE                      PIC XX.
   391         16  CM-ACCOUNT.
   392             20  CM-ACCOUNT-PREFIX         PIC X(4).
   393             20  CM-ACCOUNT-PRIME          PIC X(6).
   394         16  CM-CERT-EFF-DT                PIC XX.
   395         16  CM-CERT-NO.
   396             20  CM-CERT-PRIME             PIC X(10).
   397             20  CM-CERT-SFX               PIC X.
   398
   399     12  CM-CONTROL-BY-NAME.
   400         16  CM-COMPANY-CD-A1              PIC X.
   401         16  CM-INSURED-LAST-NAME          PIC X(15).
   402         16  CM-INSURED-INITIALS.
   403             20  CM-INSURED-INITIAL1       PIC X.
   404             20  CM-INSURED-INITIAL2       PIC X.
   405
   406     12  CM-CONTROL-BY-SSN.
   407         16  CM-COMPANY-CD-A2              PIC X.
   408         16  CM-SOC-SEC-NO.
   409             20  CM-SSN-STATE              PIC XX.
   410             20  CM-SSN-ACCOUNT            PIC X(6).
   411             20  CM-SSN-LN3.
   412                 25  CM-INSURED-INITIALS-A2.
   413                     30 CM-INSURED-INITIAL1-A2   PIC X.
   414                     30 CM-INSURED-INITIAL2-A2   PIC X.
   415                 25 CM-PART-LAST-NAME-A2         PIC X.
   416
   417     12  CM-CONTROL-BY-CERT-NO.
   418         16  CM-COMPANY-CD-A4              PIC X.
   419         16  CM-CERT-NO-A4                 PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page   9
* SOCK03.cbl
   420
   421     12  CM-CONTROL-BY-MEMB.
   422         16  CM-COMPANY-CD-A5              PIC X.
   423         16  CM-MEMBER-NO.
   424             20  CM-MEMB-STATE             PIC XX.
   425             20  CM-MEMB-ACCOUNT           PIC X(6).
   426             20  CM-MEMB-LN4.
   427                 25  CM-INSURED-INITIALS-A5.
   428                     30 CM-INSURED-INITIAL1-A5   PIC X.
   429                     30 CM-INSURED-INITIAL2-A5   PIC X.
   430                 25 CM-PART-LAST-NAME-A5         PIC XX.
   431
   432     12  CM-INSURED-PROFILE-DATA.
   433         16  CM-INSURED-FIRST-NAME.
   434             20  CM-INSURED-1ST-INIT       PIC X.
   435             20  FILLER                    PIC X(9).
   436         16  CM-INSURED-ISSUE-AGE          PIC 99.
   437         16  CM-INSURED-SEX                PIC X.
   438             88  CM-SEX-MALE                  VALUE 'M'.
   439             88  CM-SEX-FEMAL                 VALUE 'F'.
   440         16  CM-INSURED-JOINT-AGE          PIC 99.
   441         16  CM-JOINT-INSURED-NAME.
   442             20  CM-JT-LAST-NAME           PIC X(15).
   443             20  CM-JT-FIRST-NAME.
   444                 24  CM-JT-1ST-INIT        PIC X.
   445                 24  FILLER                PIC X(9).
   446             20  CM-JT-INITIAL             PIC X.
   447
   448     12  CM-LIFE-DATA.
   449         16  CM-LF-BENEFIT-CD              PIC XX.
   450         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   451         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   452         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   453         16  CM-LF-DEV-CODE                PIC XXX.
   454         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   455         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   456         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   457         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   458         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   459         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   460         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   461         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   462         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   463         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   464         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   465         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   466         16  cm-temp-epiq                  pic xx.
   467             88  EPIQ-CLASS                  value 'EQ'.
   468*        16  FILLER                        PIC XX.
   469
   470     12  CM-AH-DATA.
   471         16  CM-AH-BENEFIT-CD              PIC XX.
   472         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   473         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   474         16  CM-AH-DEV-CODE                PIC XXX.
   475         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   476         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   477         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  10
* SOCK03.cbl
   478         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   479         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   480         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   481         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   482         16  CM-AH-PAID-THRU-DT            PIC XX.
   483             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   484         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   485         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   486         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   487         16  FILLER                        PIC X.
   488
   489     12  CM-LOAN-INFORMATION.
   490         16  CM-LIVES                      PIC S9(7)     COMP-3.
   491         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   492                                           PIC S9(5)V99  COMP-3.
   493         16  CM-BILLED                     PIC S9(7)     COMP-3.
   494         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   495         16  CM-PAY-FREQUENCY              PIC S99.
   496         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   497         16  CM-RATE-CLASS                 PIC XX.
   498         16  CM-BENEFICIARY                PIC X(25).
   499         16  CM-POLICY-FORM-NO             PIC X(12).
   500         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   501         16  CM-LAST-ADD-ON-DT             PIC XX.
   502         16  CM-DEDUCTIBLE-AMOUNTS.
   503             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   504             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   505         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   506             20  CM-RESIDENT-STATE         PIC XX.
   507             20  CM-RATE-CODE              PIC X(4).
   508             20  FILLER                    PIC XX.
   509         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   510             20  CM-LOAN-OFFICER           PIC X(5).
   511             20  FILLER                    PIC XXX.
   512         16  CM-CSR-CODE                   PIC XXX.
   513         16  CM-UNDERWRITING-CODE          PIC X.
   514             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   515         16  CM-POST-CARD-IND              PIC X.
   516         16  CM-REF-INTERFACE-SW           PIC X.
   517         16  CM-PREMIUM-TYPE               PIC X.
   518             88  CM-SING-PRM                  VALUE '1'.
   519             88  CM-O-B-COVERAGE              VALUE '2'.
   520             88  CM-OPEN-END                  VALUE '3'.
   521         16  CM-IND-GRP-TYPE               PIC X.
   522             88  CM-INDIVIDUAL                VALUE 'I'.
   523             88  CM-GROUP                     VALUE 'G'.
   524         16  CM-SKIP-CODE                  PIC X.
   525             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   526             88  SKIP-JULY                    VALUE '1'.
   527             88  SKIP-AUGUST                  VALUE '2'.
   528             88  SKIP-SEPTEMBER               VALUE '3'.
   529             88  SKIP-JULY-AUG                VALUE '4'.
   530             88  SKIP-AUG-SEPT                VALUE '5'.
   531             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   532             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   533             88  SKIP-JUNE                    VALUE '8'.
   534             88  SKIP-JUNE-JULY               VALUE '9'.
   535             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  11
* SOCK03.cbl
   536             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   537         16  CM-PAYMENT-MODE               PIC X.
   538             88  PAY-MONTHLY                  VALUE SPACE.
   539             88  PAY-WEEKLY                   VALUE '1'.
   540             88  PAY-SEMI-MONTHLY             VALUE '2'.
   541             88  PAY-BI-WEEKLY                VALUE '3'.
   542             88  PAY-SEMI-ANUALLY             VALUE '4'.
   543         16  CM-LOAN-NUMBER                PIC X(8).
   544         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   545         16  CM-OLD-LOF                    PIC XXX.
   546*        16  CM-LOAN-OFFICER               PIC XXX.
   547         16  CM-REIN-TABLE                 PIC XXX.
   548         16  CM-SPECIAL-REIN-CODE          PIC X.
   549         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   550         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   551         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   552
   553     12  CM-STATUS-DATA.
   554         16  CM-ENTRY-STATUS               PIC X.
   555         16  CM-ENTRY-DT                   PIC XX.
   556
   557         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   558         16  CM-LF-CANCEL-DT               PIC XX.
   559         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   560
   561         16  CM-LF-STATUS-AT-DEATH         PIC X.
   562         16  CM-LF-DEATH-DT                PIC XX.
   563         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   564
   565         16  CM-LF-CURRENT-STATUS          PIC X.
   566             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   567                                                'M' '4' '5' '9'.
   568             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   569             88  CM-LF-POLICY-PENDING         VALUE '2'.
   570             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   571             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   572             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   573             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   574             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   575             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   576             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   577             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   578             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   579             88  CM-LF-DECLINED               VALUE 'D'.
   580             88  CM-LF-VOIDED                 VALUE 'V'.
   581
   582         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   583         16  CM-AH-CANCEL-DT               PIC XX.
   584         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   585
   586         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   587         16  CM-AH-SETTLEMENT-DT           PIC XX.
   588         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   589
   590         16  CM-AH-CURRENT-STATUS          PIC X.
   591             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   592                                                'M' '4' '5' '9'.
   593             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  12
* SOCK03.cbl
   594             88  CM-AH-POLICY-PENDING         VALUE '2'.
   595             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   596             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   597             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   598             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   599             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   600             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   601             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   602             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   603             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   604             88  CM-AH-DECLINED               VALUE 'D'.
   605             88  CM-AH-VOIDED                 VALUE 'V'.
   606
   607         16  CM-CLAIM-INTERFACE-SW         PIC X.
   608             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   609             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   610             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   611         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   612
   613         16  CM-ENTRY-BATCH                PIC X(6).
   614         16  CM-LF-EXIT-BATCH              PIC X(6).
   615         16  CM-AH-EXIT-BATCH              PIC X(6).
   616         16  CM-LAST-MONTH-END             PIC XX.
   617
   618     12  CM-NOTE-SW                        PIC X.
   619         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   620         88  CERT-NOTES-PRESENT               VALUE '1'.
   621         88  BILLING-NOTES-PRESENT            VALUE '2'.
   622         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   623         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   624         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   625         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   626         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   627     12  CM-COMP-EXCP-SW                   PIC X.
   628         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   629         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   630     12  CM-INSURED-ADDRESS-SW             PIC X.
   631         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   632         88  INSURED-ADDR-PRESENT             VALUE '1'.
   633
   634*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   635     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   636     12  FILLER                            PIC X.
   637
   638*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   639     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   640     12  FILLER                            PIC X.
   641*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   642     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   643
   644     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   645         88  CERT-ADDED-BATCH                 VALUE ' '.
   646         88  CERT-ADDED-ONLINE                VALUE '1'.
   647         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   648         88  CERT-PURGED-OFFLINE              VALUE '3'.
   649         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   650     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   651         88  CERT-AS-LOADED                   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  13
* SOCK03.cbl
   652         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   653         88  CERT-CLAIM-ONLINE                VALUE '2'.
   654         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   655         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   656         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   657         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   658         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   659
   660     12  CM-ACCOUNT-COMM-PCTS.
   661         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   662         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   663
   664     12  CM-USER-FIELD                     PIC X.
   665     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   666     12  CM-CLP-STATE                      PIC XX.
   667     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   668     12  CM-USER-RESERVED                  PIC XXX.
   669     12  FILLER REDEFINES CM-USER-RESERVED.
   670         16  CM-AH-CLASS-CD                PIC XX.
   671         16  F                             PIC X.
   672******************************************************************
   673*                                 COPY ELCMSTR.
   674******************************************************************
   675*                                                                *
   676*                            ELCMSTR.                            *
   677*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   678*                            VMOD=2.012                          *
   679*                                                                *
   680*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   681*                                                                *
   682*   FILE TYPE = VSAM,KSDS                                        *
   683*   RECORD SIZE = 350  RECFORM = FIXED                           *
   684*                                                                *
   685*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   686*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   687*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   688*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   689*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   690*                                                 RKP=75,LEN=21  *
   691*                                                                *
   692*   **** NOTE ****                                               *
   693*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   694*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   695*                                                                *
   696*   LOG = YES                                                    *
   697*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   698******************************************************************
   699*                   C H A N G E   L O G
   700*
   701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   702*-----------------------------------------------------------------
   703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   704* EFFECTIVE    NUMBER
   705*-----------------------------------------------------------------
   706* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   707* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   708* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   709* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  14
* SOCK03.cbl
   710* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   711* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   712* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   713******************************************************************
   714 01  CLAIM-MASTER.
   715     12  CL-RECORD-ID                PIC XX.
   716         88  VALID-CL-ID         VALUE 'CL'.
   717
   718     12  CL-CONTROL-PRIMARY.
   719         16  CL-COMPANY-CD           PIC X.
   720         16  CL-CARRIER              PIC X.
   721         16  CL-CLAIM-NO             PIC X(7).
   722         16  CL-CERT-NO.
   723             20  CL-CERT-PRIME       PIC X(10).
   724             20  CL-CERT-SFX         PIC X.
   725
   726     12  CL-CONTROL-BY-NAME.
   727         16  CL-COMPANY-CD-A1        PIC X.
   728         16  CL-INSURED-LAST-NAME    PIC X(15).
   729         16  CL-INSURED-NAME.
   730             20  CL-INSURED-1ST-NAME PIC X(12).
   731             20  CL-INSURED-MID-INIT PIC X.
   732
   733     12  CL-CONTROL-BY-SSN.
   734         16  CL-COMPANY-CD-A2        PIC X.
   735         16  CL-SOC-SEC-NO.
   736             20  CL-SSN-STATE        PIC XX.
   737             20  CL-SSN-ACCOUNT      PIC X(6).
   738             20  CL-SSN-LN3          PIC X(3).
   739
   740     12  CL-CONTROL-BY-CERT-NO.
   741         16  CL-COMPANY-CD-A4        PIC X.
   742         16  CL-CERT-NO-A4.
   743             20  CL-CERT-A4-PRIME    PIC X(10).
   744             20  CL-CERT-A4-SFX      PIC X.
   745
   746     12  CL-CONTROL-BY-CCN.
   747         16  CL-COMPANY-CD-A5        PIC X.
   748         16  CL-CCN-A5.
   749             20  CL-CCN.
   750                 24  CL-CCN-PREFIX-A5 PIC X(4).
   751                 24  CL-CCN-PRIME-A5 PIC X(12).
   752             20  CL-CCN-FILLER-A5    PIC X(4).
   753
   754     12  CL-INSURED-PROFILE-DATA.
   755         16  CL-INSURED-BIRTH-DT     PIC XX.
   756         16  CL-INSURED-SEX-CD       PIC X.
   757             88  INSURED-IS-MALE        VALUE 'M'.
   758             88  INSURED-IS-FEMALE      VALUE 'F'.
   759             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   760         16  CL-INSURED-OCC-CD       PIC X(6).
   761         16  FILLER                  PIC X(5).
   762
   763     12  CL-PROCESSING-INFO.
   764         16  CL-PROCESSOR-ID         PIC X(4).
   765         16  CL-CLAIM-STATUS         PIC X.
   766             88  CLAIM-IS-OPEN          VALUE 'O'.
   767             88  CLAIM-IS-CLOSED        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  15
* SOCK03.cbl
   768         16  CL-CLAIM-TYPE           PIC X.
   769*            88  AH-CLAIM               VALUE 'A'.
   770*            88  LIFE-CLAIM             VALUE 'L'.
   771*            88  PROPERTY-CLAIM         VALUE 'P'.
   772*            88  IUI-CLAIM              VALUE 'I'.
   773*            88  GAP-CLAIM              VALUE 'G'.
   774*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   775*            88  OTHER-CLAIM            VALUE 'O'.
   776         16  CL-CLAIM-PREM-TYPE      PIC X.
   777             88  SINGLE-PREMIUM         VALUE '1'.
   778             88  O-B-COVERAGE           VALUE '2'.
   779             88  OPEN-END-COVERAGE      VALUE '3'.
   780         16  CL-INCURRED-DT          PIC XX.
   781         16  CL-REPORTED-DT          PIC XX.
   782         16  CL-FILE-ESTABLISH-DT    PIC XX.
   783         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   784         16  CL-LAST-PMT-DT          PIC XX.
   785         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   786         16  CL-PAID-THRU-DT         PIC XX.
   787         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   788         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   789         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   790         16  CL-PMT-CALC-METHOD      PIC X.
   791             88  CL-360-DAY-YR          VALUE '1'.
   792             88  CL-365-DAY-YR          VALUE '2'.
   793             88  CL-FULL-MONTHS         VALUE '3'.
   794         16  CL-CAUSE-CD             PIC X(6).
   795
   796         16  CL-PRIME-CERT-NO.
   797             20  CL-PRIME-CERT-PRIME PIC X(10).
   798             20  CL-PRIME-CERT-SFX   PIC X.
   799
   800         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   801             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   802             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   803
   804         16  CL-MICROFILM-NO         PIC X(10).
   805         16  FILLER REDEFINES CL-MICROFILM-NO.
   806             20  CL-BENEFIT-PERIOD   PIC 99.
   807             20  FILLER              PIC X(8).
   808         16  CL-PROG-FORM-TYPE       PIC X.
   809         16  CL-LAST-ADD-ON-DT       PIC XX.
   810
   811         16  CL-LAST-REOPEN-DT       PIC XX.
   812         16  CL-LAST-CLOSE-DT        PIC XX.
   813         16  CL-LAST-CLOSE-REASON    PIC X(01).
   814             88  FINAL-PAID             VALUE '1'.
   815             88  CLAIM-DENIED           VALUE '2'.
   816             88  AUTO-CLOSE             VALUE '3'.
   817             88  MANUAL-CLOSE           VALUE '4'.
   818             88  BENEFITS-CHANGED       VALUE 'C'.
   819             88  SETUP-ERRORS           VALUE 'E'.
   820         16  CL-ASSOC-CERT-SEQU      PIC S99.
   821         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   822         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   823             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   824         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   825         16  FILLER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  16
* SOCK03.cbl
   826
   827     12  CL-CERTIFICATE-DATA.
   828         16  CL-CERT-ORIGIN          PIC X.
   829             88  CERT-WAS-ONLINE        VALUE '1'.
   830             88  CERT-WAS-CREATED       VALUE '2'.
   831             88  COVERAGE-WAS-ADDED     VALUE '3'.
   832         16  CL-CERT-KEY-DATA.
   833             20  CL-CERT-CARRIER     PIC X.
   834             20  CL-CERT-GROUPING    PIC X(6).
   835             20  CL-CERT-STATE       PIC XX.
   836             20  CL-CERT-ACCOUNT.
   837                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   838                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   839             20  CL-CERT-EFF-DT      PIC XX.
   840
   841     12  CL-STATUS-CONTROLS.
   842         16  CL-PRIORITY-CD          PIC X.
   843             88  CONFIDENTIAL-DATA      VALUE '8'.
   844             88  HIGHEST-PRIORITY       VALUE '9'.
   845         16  CL-SUPV-ATTN-CD         PIC X.
   846             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   847             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   848         16  CL-PURGED-DT            PIC XX.
   849         16  CL-RESTORED-DT          PIC XX.
   850         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   851         16  CL-NEXT-RESEND-DT       PIC XX.
   852         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   853         16  CL-CRITICAL-PERIOD      PIC 99.
   854*        16  FILLER                  PIC XX.
   855         16  CL-LAST-MAINT-DT        PIC XX.
   856         16  CL-LAST-MAINT-USER      PIC X(4).
   857         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   858         16  CL-LAST-MAINT-TYPE      PIC X.
   859             88  CLAIM-SET-UP           VALUE ' '.
   860             88  PAYMENT-MADE           VALUE '1'.
   861             88  LETTER-SENT            VALUE '2'.
   862             88  MASTER-WAS-ALTERED     VALUE '3'.
   863             88  MASTER-WAS-RESTORED    VALUE '4'.
   864             88  INCURRED-DATE-CHANGED  VALUE '5'.
   865             88  FILE-CONVERTED         VALUE '6'.
   866             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   867             88  ERROR-CORRECTION       VALUE 'E'.
   868         16  CL-RELATED-CLAIM-NO     PIC X(7).
   869         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   870         16  CL-BENEFICIARY          PIC X(10).
   871         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   872         16  CL-DENIAL-TYPE          PIC X.
   873             88  CL-TYPE-DENIAL          VALUE '1'.
   874             88  CL-TYPE-RESCISSION      VALUE '2'.
   875             88  CL-TYPE-REFORMATION     VALUE '3'.
   876             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   877             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   878         16  CL-NO-OF-EXTENSIONS     PIC 99.
   879         16  filler                  pic x(3).
   880*        16  CL-CRIT-PER-RECURRENT   PIC X.
   881*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   882*        16  CL-RTW-DT               PIC XX.
   883
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  17
* SOCK03.cbl
   884     12  CL-TRAILER-CONTROLS.
   885         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   886             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   887             88  CL-LAST-TRL-AVAIL      VALUE +100.
   888             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   889         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   890         16  FILLER                  PIC XX.
   891         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   892         16  CL-ADDRESS-TRAILER-CNT.
   893             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   894                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   895             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   896                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   897             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   898                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   899             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   900                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   901             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   902                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   903             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   904                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   905             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   906                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   907
   908     12  CL-CV-REFERENCE-NO.
   909         16  CL-CV-REFNO-PRIME       PIC X(18).
   910         16  CL-CV-REFNO-SFX         PIC XX.
   911
   912     12  CL-FILE-LOCATION            PIC X(4).
   913
   914     12  CL-PROCESS-ERRORS.
   915         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   916             88  NO-FATAL-ERRORS        VALUE ZERO.
   917         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   918             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   919
   920     12  CL-PRODUCT-CD               PIC X.
   921
   922     12  CL-CURRENT-KEY-DATA.
   923         16  CL-CURRENT-CARRIER      PIC X.
   924         16  CL-CURRENT-GROUPING     PIC X(6).
   925         16  CL-CURRENT-STATE        PIC XX.
   926         16  CL-CURRENT-ACCOUNT      PIC X(10).
   927
   928     12  CL-ASSOCIATES               PIC X.
   929         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   930         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   931         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   932         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   933
   934     12  CL-ACTIVITY-CODE            PIC 99.
   935     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   936     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   937
   938     12  CL-LAPSE-REPORT-CODE        PIC 9.
   939     12  CL-LAG-REPORT-CODE          PIC 9.
   940     12  CL-LOAN-TYPE                PIC XX.
   941     12  CL-LEGAL-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  18
* SOCK03.cbl
   942
   943     12  CL-YESNOSW                  PIC X.
   944     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   945         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   946         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   947         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   948     12  cl-insured-type             pic x.
   949         88  cl-claim-on-primary         value 'P'.
   950         88  cl-claim-on-co-borrower     value 'C'.
   951     12  cl-benefit-expiration-dt    PIC XX.
   952*                                 COPY ERCPDEF.
   953******************************************************************
   954*                                                                *
   955*                                                                *
   956*                            ERCPDEF.                            *
   957*                                                                *
   958*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   959*                                                                *
   960*    FILE TYPE = VSAM,KSDS                                       *
   961*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   962*                                                                *
   963*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   964*                                                                *
   965*    LOG = YES                                                   *
   966*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   967******************************************************************
   968*                   C H A N G E   L O G
   969*
   970* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   971*-----------------------------------------------------------------
   972*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   973* EFFECTIVE    NUMBER
   974*-----------------------------------------------------------------
   975* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   976* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   977* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   978* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   979******************************************************************
   980 01  PRODUCT-MASTER.
   981    12  PD-RECORD-ID                 PIC X(02).
   982        88  VALID-PD-ID                  VALUE 'PD'.
   983    12  PD-CONTROL-PRIMARY.
   984        16  PD-COMPANY-CD            PIC X.
   985        16  PD-STATE                 PIC XX.
   986        16  PD-PRODUCT-CD            PIC XXX.
   987        16  PD-FILLER                PIC X(7).
   988        16  PD-BEN-TYPE              PIC X.
   989        16  PD-BEN-CODE              PIC XX.
   990        16  PD-PROD-EXP-DT           PIC XX.
   991    12  FILLER                       PIC X(50).
   992    12  PD-PRODUCT-DATA OCCURS 8.
   993        16  PD-PROD-CODE             PIC X.
   994            88  PD-PROD-LIFE           VALUE 'L'.
   995            88  PD-PROD-PROP           VALUE 'P'.
   996            88  PD-PROD-AH             VALUE 'A'.
   997            88  PD-PROD-IU             VALUE 'I'.
   998            88  PD-PROD-GAP            VALUE 'G'.
   999            88  PD-PROD-FAML           VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  19
* SOCK03.cbl
  1000            88  PD-PROD-OTH            VALUE 'O'.
  1001        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  1002        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1003        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1004        16  PD-MAX-TERM              PIC S999        COMP-3.
  1005        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1006        16  FILLER                   PIC X.
  1007        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1008        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1009        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  1010        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1011        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1012        16  PD-REC-CRIT-PERIOD       PIC 99.
  1013        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  1014            20  PD-RECURRING-YN      PIC X.
  1015            20  FILLER               PIC X.
  1016        16  PD-RTW-MOS               PIC 99.
  1017        16  PD-MAX-EXTENSION         PIC 99.
  1018        16  pd-ben-pct               pic sv999 comp-3.
  1019*       16  FILLER                   PIC XX.
  1020    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1021    12  PD-TERM-LIMITS OCCURS 15.
  1022        16  PD-LOW-TERM              PIC S999        COMP-3.
  1023        16  PD-HI-TERM               PIC S999        COMP-3.
  1024*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1025    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1026        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1027        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1028    12  PD-EARN-FACTORS.
  1029        16  FILLER OCCURS 15.
  1030            20  FILLER OCCURS 15.
  1031                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1032    12  PD-PRODUCT-DESC              PIC X(80).
  1033    12  PD-TRUNCATED                 PIC X.
  1034    12  FILLER                       PIC X(59).
  1035    12  PD-MAINT-INFORMATION.
  1036        16  PD-LAST-MAINT-DT         PIC X(02).
  1037        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1038        16  PD-LAST-MAINT-BY         PIC X(04).
  1039*                                 COPY ERCCTBL.
  1040******************************************************************
  1041*                                                                *
  1042*                                                                *
  1043*                            ERCCTBL                             *
  1044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1045*                            VMOD=2.003
  1046*                                                                *
  1047*   ONLINE CREDIT SYSTEM                                         *
  1048*                                                                *
  1049*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1050*                                                                *
  1051*   FILE TYPE = VSAM,KSDS                                        *
  1052*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1053*                                                                *
  1054*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1055*       ALTERNATE PATH = NONE                                    *
  1056*                                                                *
  1057*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  20
* SOCK03.cbl
  1058*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1059*                                                                *
  1060*                                                                *
  1061******************************************************************
  1062
  1063 01  COMM-TABLE-RECORD.
  1064     12  CT-RECORD-ID                      PIC XX.
  1065         88  VALID-CT-ID                      VALUE 'CT'.
  1066
  1067     12  CT-CONTROL-PRIMARY.
  1068         16  CT-COMPANY-CD                 PIC X.
  1069         16  CT-TABLE                      PIC XXX.
  1070         16  CT-CNTRL-2.
  1071             20  CT-BEN-TYPE               PIC X.
  1072             20  CT-BEN-CODE               PIC XX.
  1073
  1074     12  CT-MAINT-INFORMATION.
  1075         16  CT-LAST-MAINT-DT              PIC XX.
  1076         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1077         16  CT-LAST-MAINT-USER            PIC X(4).
  1078         16  FILLER                        PIC X(31).
  1079
  1080     12  CT-LIMITS.
  1081         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1082
  1083         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1084
  1085         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1086
  1087     12  CT-RATES.
  1088         16  CT-RTX          OCCURS 27 TIMES.
  1089             20  CT-RT                     PIC SV9(5)     COMP-3.
  1090             20  CT-RT-R   REDEFINES
  1091                 CT-RT                     PIC XXX.
  1092
  1093     12  FILLER                            PIC  X(42).
  1094
  1095******************************************************************
  1096*                                 COPY ELCCNTL.
  1097******************************************************************
  1098*                                                                *
  1099*                                                                *
  1100*                            ELCCNTL.                            *
  1101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1102*                            VMOD=2.059                          *
  1103*                                                                *
  1104*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1105*                                                                *
  1106*   FILE TYPE = VSAM,KSDS                                        *
  1107*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1108*                                                                *
  1109*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1110*       ALTERNATE INDEX = NONE                                   *
  1111*                                                                *
  1112*   LOG = YES                                                    *
  1113*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1114******************************************************************
  1115*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  21
* SOCK03.cbl
  1116*
  1117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1118*-----------------------------------------------------------------
  1119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1120* EFFECTIVE    NUMBER
  1121*-----------------------------------------------------------------
  1122* 082503                   PEMA  ADD BENEFIT GROUP
  1123* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1124* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1125* 092705    2005050300006  PEMA  ADD SPP LEASES
  1126* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1127* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1128* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1129* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1130* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1131* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1132* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1133* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1134* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1135* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1136* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1137******************************************************************
  1138*
  1139 01  CONTROL-FILE.
  1140     12  CF-RECORD-ID                       PIC XX.
  1141         88  VALID-CF-ID                        VALUE 'CF'.
  1142
  1143     12  CF-CONTROL-PRIMARY.
  1144         16  CF-COMPANY-ID                  PIC XXX.
  1145         16  CF-RECORD-TYPE                 PIC X.
  1146             88  CF-COMPANY-MASTER              VALUE '1'.
  1147             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1148             88  CF-STATE-MASTER                VALUE '3'.
  1149             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1150             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1151             88  CF-CARRIER-MASTER              VALUE '6'.
  1152             88  CF-MORTALITY-MASTER            VALUE '7'.
  1153             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1154             88  CF-TERMINAL-MASTER             VALUE '9'.
  1155             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1156             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1157             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1158             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1159             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1160             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1161             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1162             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1163             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1164         16  CF-ACCESS-CD-GENL              PIC X(4).
  1165         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1166             20  CF-PROCESSOR               PIC X(4).
  1167         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1168             20  CF-STATE-CODE              PIC XX.
  1169             20  FILLER                     PIC XX.
  1170         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1171             20  FILLER                     PIC XX.
  1172             20  CF-HI-BEN-IN-REC           PIC XX.
  1173         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  22
* SOCK03.cbl
  1174             20  FILLER                     PIC XXX.
  1175             20  CF-CARRIER-CNTL            PIC X.
  1176         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1177             20  FILLER                     PIC XX.
  1178             20  CF-HI-TYPE-IN-REC          PIC 99.
  1179         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1180             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1181                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1182             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1183             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1184         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1185             20  FILLER                     PIC X.
  1186             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1187         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1188             20  FILLER                     PIC XX.
  1189             20  CF-MORTGAGE-PLAN           PIC XX.
  1190         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1191
  1192     12  CF-LAST-MAINT-DT                   PIC XX.
  1193     12  CF-LAST-MAINT-BY                   PIC X(4).
  1194     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1195
  1196     12  CF-RECORD-BODY                     PIC X(728).
  1197
  1198
  1199****************************************************************
  1200*             COMPANY MASTER RECORD                            *
  1201****************************************************************
  1202
  1203     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1204         16  CF-COMPANY-ADDRESS.
  1205             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1206             20  CF-CL-IN-CARE-OF           PIC X(30).
  1207             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1208             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1209             20  CF-CL-CITY-STATE           PIC X(30).
  1210             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1211             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1212         16  CF-COMPANY-CD                  PIC X.
  1213         16  CF-COMPANY-PASSWORD            PIC X(8).
  1214         16  CF-SECURITY-OPTION             PIC X.
  1215             88  ALL-SECURITY                   VALUE '1'.
  1216             88  COMPANY-VERIFY                 VALUE '2'.
  1217             88  PROCESSOR-VERIFY               VALUE '3'.
  1218             88  NO-SECURITY                    VALUE '4'.
  1219             88  ALL-BUT-TERM                   VALUE '5'.
  1220         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1221             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1222         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1223             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1224         16  CF-INFORCE-LOCATION            PIC X.
  1225             88  CERTS-ARE-ONLINE               VALUE '1'.
  1226             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1227             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1228         16  CF-LOWER-CASE-LETTERS          PIC X.
  1229         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1230             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1231             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  23
* SOCK03.cbl
  1232             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1233             88  CF-ACCNT-CNTL                  VALUE '3'.
  1234             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1235
  1236         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1237         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1238
  1239         16  CF-LGX-CREDIT-USER             PIC X.
  1240             88  CO-IS-NOT-USER                 VALUE 'N'.
  1241             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1242
  1243         16 CF-CREDIT-CALC-CODES.
  1244             20  CF-CR-REM-TERM-CALC PIC X.
  1245               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1246               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1247               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1248               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1249               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1250               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1251               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1252             20  CF-CR-R78-METHOD           PIC X.
  1253               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1254               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1255
  1256         16  CF-CLAIM-CONTROL-COUNTS.
  1257             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1258                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1259
  1260             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1261                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1262
  1263             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1264                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1265
  1266             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1267                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1268
  1269         16  CF-CURRENT-MONTH-END           PIC XX.
  1270
  1271         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1272             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1273             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1274             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1275             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1276                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1277                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1278             20  CF-CO-PREM-REJECT-SW       PIC X.
  1279                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1280                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1281             20  CF-CO-REF-REJECT-SW        PIC X.
  1282                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1283                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1284
  1285         16  CF-CO-REPORTING-DT             PIC XX.
  1286         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1287         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1288           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1289           88  CF-CO-MONTH-END                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  24
* SOCK03.cbl
  1290
  1291         16  CF-LGX-CLAIM-USER              PIC X.
  1292             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1293             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1294
  1295         16  CF-CREDIT-EDIT-CONTROLS.
  1296             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1297             20  CF-MIN-AGE                 PIC 99.
  1298             20  CF-DEFAULT-AGE             PIC 99.
  1299             20  CF-MIN-TERM                PIC S999      COMP-3.
  1300             20  CF-MAX-TERM                PIC S999      COMP-3.
  1301             20  CF-DEFAULT-SEX             PIC X.
  1302             20  CF-JOINT-AGE-INPUT         PIC X.
  1303                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1304             20  CF-BIRTH-DATE-INPUT        PIC X.
  1305                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1306             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1307                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1308                 88  CF-ZERO-CARRIER            VALUE '1'.
  1309                 88  CF-ZERO-GROUPING           VALUE '2'.
  1310                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1311             20  CF-EDIT-SW                 PIC X.
  1312                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1313             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1314             20  CF-CR-PR-METHOD            PIC X.
  1315               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1316               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1317             20  FILLER                     PIC X.
  1318
  1319         16  CF-CREDIT-MISC-CONTROLS.
  1320             20  CF-REIN-TABLE-SW           PIC X.
  1321                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1322             20  CF-COMP-TABLE-SW           PIC X.
  1323                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1324             20  CF-EXPERIENCE-RETENTION-AGE
  1325                                            PIC S9        COMP-3.
  1326             20  CF-CONVERSION-DT           PIC XX.
  1327             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1328             20  CF-RUN-FREQUENCY-SW        PIC X.
  1329                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1330                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1331
  1332             20  CF-CR-CHECK-NO-CONTROL.
  1333                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1334                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1335                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1336                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1337                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1338                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1339
  1340                 24  CF-CR-CHECK-COUNT       REDEFINES
  1341                     CF-CR-CHECK-COUNTER      PIC X(4).
  1342
  1343                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1344                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1345
  1346                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1347                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  25
* SOCK03.cbl
  1348                 24  CF-MAIL-PROCESSING       PIC X.
  1349                     88  MAIL-PROCESSING          VALUE 'Y'.
  1350
  1351         16  CF-MISC-SYSTEM-CONTROL.
  1352             20  CF-SYSTEM-C                 PIC X.
  1353                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1354             20  CF-SYSTEM-D                 PIC X.
  1355                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1356             20  CF-SOC-SEC-NO-SW            PIC X.
  1357                 88  SOC-SEC-NO-USED             VALUE '1'.
  1358             20  CF-MEMBER-NO-SW             PIC X.
  1359                 88  MEMBER-NO-USED              VALUE '1'.
  1360             20  CF-TAX-ID-NUMBER            PIC X(11).
  1361             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1362             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1363                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1364                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1365                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1366                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1367             20  CF-SYSTEM-E                 PIC X.
  1368                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1369
  1370         16  CF-LGX-LIFE-USER               PIC X.
  1371             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1372             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1373
  1374         16  CF-CR-MONTH-END-DT             PIC XX.
  1375
  1376         16  CF-FILE-MAINT-DATES.
  1377             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1378                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1379             20  CF-LAST-BATCH       REDEFINES
  1380                 CF-LAST-BATCH-NO               PIC X(4).
  1381             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1382             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1383             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1384             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1385             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1386             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1387             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1388             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1389             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1390             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1391
  1392         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1393         16  FILLER                         PIC X.
  1394
  1395         16  CF-ALT-MORT-CODE               PIC X(4).
  1396         16  CF-MEMBER-CAPTION              PIC X(10).
  1397
  1398         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1399             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1400             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1401             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1402             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1403             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1404
  1405         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  26
* SOCK03.cbl
  1406
  1407         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1408         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1409         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1410         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1411
  1412         16  CF-AH-OVERRIDE-L1              PIC X.
  1413         16  CF-AH-OVERRIDE-L2              PIC XX.
  1414         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1415         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1416
  1417         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1418         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1419
  1420         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1421         16  CF-AR-LAST-EL860-DT            PIC XX.
  1422         16  CF-MP-MONTH-END-DT             PIC XX.
  1423
  1424         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1425         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1426             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1427
  1428         16  CF-AR-MONTH-END-DT             PIC XX.
  1429
  1430         16  CF-CRDTCRD-USER                PIC X.
  1431             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1432             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1433
  1434         16  CF-CC-MONTH-END-DT             PIC XX.
  1435
  1436         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1437
  1438         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1439             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1440             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1441             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1442         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1443         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1444         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1445         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1446             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1447             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1448         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1449         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1450         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1451             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1452         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1453
  1454         16  CF-CL-ZIP-CODE.
  1455             20  CF-CL-ZIP-PRIME.
  1456                 24  CF-CL-ZIP-1ST          PIC X.
  1457                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1458                 24  FILLER                 PIC X(4).
  1459             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1460         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1461             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1462             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1463             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  27
* SOCK03.cbl
  1464
  1465         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1466         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1467         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1468         16  CF-CO-OPTION-START-DATE        PIC XX.
  1469         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1470           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1471                                                      '3' '4'.
  1472           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1473           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1474           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1475           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1476           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1477           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1478
  1479         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1480
  1481         16  CF-PAYMENT-APPROVAL-LEVELS.
  1482             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1483             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1484             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1485             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1486             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1487             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1488
  1489         16  CF-END-USER-REPORTING-USER     PIC X.
  1490             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1491             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1492
  1493         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1494             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1495             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1496
  1497         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1498
  1499         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1500         16  FILLER                         PIC X.
  1501
  1502         16  CF-CREDIT-ARCHIVE-CNTL.
  1503             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1504             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1505             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1506
  1507         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1508
  1509         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1510             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1511             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1512
  1513         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1514             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1515             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1516
  1517         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1518
  1519         16  CF-CO-ACH-ID-CODE              PIC  X.
  1520             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1521             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  28
* SOCK03.cbl
  1522             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1523         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1524         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1525         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1526         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1527         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1528         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1529         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1530         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1531         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1532                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1533         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1534                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1535
  1536         16  CF-CO-OVER-SHORT.
  1537             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1538             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1539
  1540*         16  FILLER                         PIC X(102).
  1541         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1542             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1543             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1544
  1545         16  CF-AH-APPROVAL-DAYS.
  1546             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1547             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1548             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1549             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1550
  1551         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1552
  1553         16  CF-APPROV-LEV-5.
  1554             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1555             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1556             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1557
  1558         16  FILLER                         PIC X(68).
  1559****************************************************************
  1560*             PROCESSOR/USER RECORD                            *
  1561****************************************************************
  1562
  1563     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1564         16  CF-PROCESSOR-NAME              PIC X(30).
  1565         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1566         16  CF-PROCESSOR-TITLE             PIC X(26).
  1567         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1568                 88  MESSAGE-YES                VALUE 'Y'.
  1569                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1570
  1571*****************************************************
  1572****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1573****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1574****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1575****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1576*****************************************************
  1577
  1578         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1579             20  CF-ADMINISTRATION-CONTROLS PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  29
* SOCK03.cbl
  1580             20  CF-APPLICATION-FORCE       PIC X.
  1581             20  CF-INDIVIDUAL-APP.
  1582                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1583                     28  CF-BROWSE-APP      PIC X.
  1584                     28  CF-UPDATE-APP      PIC X.
  1585
  1586         16  CF-CURRENT-TERM-ON             PIC X(4).
  1587         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1588             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1589             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1590             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1591             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1592             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1593             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1594             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1595         16  CF-PROCESSOR-CARRIER           PIC X.
  1596             88  NO-CARRIER-SECURITY            VALUE ' '.
  1597         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1598             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1599         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1600             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1601         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1602             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1603
  1604         16  CF-PROC-SYS-ACCESS-SW.
  1605             20  CF-PROC-CREDIT-CLAIMS-SW.
  1606                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1607                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1608                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1609                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1610             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1611                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1612                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1613             20  CF-PROC-LIFE-GNRLDGR-SW.
  1614                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1615                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1616                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1617                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1618             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1619                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1620                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1621         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1622             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1623             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1624         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1625
  1626         16  CF-APPROVAL-LEVEL                  PIC X.
  1627             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1628             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1629             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1630             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1631             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1632
  1633         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1634
  1635         16  CF-LANGUAGE-TYPE                   PIC X.
  1636             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1637             88  CF-LANG-IS-FR                      VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  30
* SOCK03.cbl
  1638
  1639         16  CF-CSR-IND                         PIC X.
  1640         16  FILLER                             PIC X(239).
  1641
  1642****************************************************************
  1643*             PROCESSOR/REMINDERS RECORD                       *
  1644****************************************************************
  1645
  1646     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1647         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1648             20  CF-START-REMIND-DT         PIC XX.
  1649             20  CF-END-REMIND-DT           PIC XX.
  1650             20  CF-REMINDER-TEXT           PIC X(50).
  1651         16  FILLER                         PIC X(296).
  1652
  1653
  1654****************************************************************
  1655*             STATE MASTER RECORD                              *
  1656****************************************************************
  1657
  1658     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1659         16  CF-STATE-ABBREVIATION          PIC XX.
  1660         16  CF-STATE-NAME                  PIC X(25).
  1661         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1662         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1663             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1664             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1665             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1666             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1667                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1668                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1669             20  CF-ST-PREM-REJECT-SW       PIC X.
  1670                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1671                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1672             20  CF-ST-REF-REJECT-SW        PIC X.
  1673                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1674                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1675         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1676         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1677         16  CF-ST-REFUND-RULES.
  1678             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1679             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1680             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1681         16  CF-ST-FST-PMT-EXTENSION.
  1682             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1683             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1684                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1685                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1686                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1687                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1688         16  CF-ST-STATE-CALL.
  1689             20  CF-ST-CALL-UNEARNED        PIC X.
  1690             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1691             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1692         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1693             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1694             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1695         16  CF-REPLACEMENT-LETTER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  31
* SOCK03.cbl
  1696         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1697         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1698         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1699         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1700         16  FILLER                         PIC X.
  1701         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1702             20  CF-ST-BENEFIT-CD           PIC XX.
  1703             20  CF-ST-BENEFIT-KIND         PIC X.
  1704                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1705                 88  CF-ST-AH-KIND              VALUE 'A'.
  1706             20  CF-ST-REM-TERM-CALC        PIC X.
  1707                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1708                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1709                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1710                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1711                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1712                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1713                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1714                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1715
  1716             20  CF-ST-REFUND-CALC          PIC X.
  1717                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1718                 88  ST-REFD-BY-R78             VALUE '1'.
  1719                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1720                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1721                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1722                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1723                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1724                 88  ST-REFD-UTAH               VALUE '7'.
  1725                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1726                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1727                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1728
  1729             20  CF-ST-EARNING-CALC         PIC X.
  1730                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1731                 88  ST-EARN-BY-R78             VALUE '1'.
  1732                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1733                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1734                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1735                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1736                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1737                 88  ST-EARN-MEAN               VALUE '8'.
  1738                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1739
  1740             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1741                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1742                 88  ST-OVRD-BY-R78             VALUE '1'.
  1743                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1744                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1745                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1746                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1747                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1748                 88  ST-OVRD-MEAN               VALUE '8'.
  1749                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1750             20  cf-st-extra-periods        pic 9.
  1751*            20  FILLER                     PIC X.
  1752
  1753         16  CF-ST-COMMISSION-CAPS.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  32
* SOCK03.cbl
  1754             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1755             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1756             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1757             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1758         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1759                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1760                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1761                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1762
  1763         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1764
  1765         16  CF-ST-STATUTORY-INTEREST.
  1766             20  CF-ST-STAT-DATE-FROM       PIC X.
  1767                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1768                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1769             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1770             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1771             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1772             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1773             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1774
  1775         16  CF-ST-OVER-SHORT.
  1776             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1777             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1778
  1779         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1780
  1781         16  CF-ST-RT-CALC                  PIC X.
  1782
  1783         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1784         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1785         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1786         16  CF-ST-RF-LR-CALC               PIC X.
  1787         16  CF-ST-RF-LL-CALC               PIC X.
  1788         16  CF-ST-RF-LN-CALC               PIC X.
  1789         16  CF-ST-RF-AH-CALC               PIC X.
  1790         16  CF-ST-RF-CP-CALC               PIC X.
  1791*        16  FILLER                         PIC X(206).
  1792*CIDMOD         16  FILLER                         PIC X(192).
  1793         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1794             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1795         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1796         16  CF-ST-VFY-2ND-BENE             PIC X.
  1797         16  CF-ST-CAUSAL-STATE             PIC X.
  1798         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1799         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1800         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1801             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1802         16  CF-ST-NET-ONLY-STATE           PIC X.
  1803             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1804         16  cf-commission-cap-required     pic x.
  1805         16  CF-ST-GA-COMMISSION-CAPS.
  1806             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1807             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1808             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1809             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1810         16  CF-ST-TOT-COMMISSION-CAPS.
  1811             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  33
* SOCK03.cbl
  1812             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1813             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1814             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1815         16  FILLER                         PIC X(156).
  1816
  1817****************************************************************
  1818*             BENEFIT MASTER RECORD                            *
  1819****************************************************************
  1820
  1821     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1822         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1823             20  CF-BENEFIT-CODE            PIC XX.
  1824             20  CF-BENEFIT-NUMERIC  REDEFINES
  1825                 CF-BENEFIT-CODE            PIC XX.
  1826             20  CF-BENEFIT-ALPHA           PIC XXX.
  1827             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1828             20  CF-BENEFIT-COMMENT         PIC X(10).
  1829
  1830             20  CF-LF-COVERAGE-TYPE        PIC X.
  1831                 88  CF-REDUCING                VALUE 'R'.
  1832                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1833
  1834             20  CF-SPECIAL-CALC-CD         PIC X.
  1835                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1836                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1837                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1838                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1839                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1840                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1841                 88  CF-FARM-PLAN               VALUE 'F'.
  1842                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1843                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1844                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1845                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1846                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1847                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1848                 88  CF-PRUDENTIAL              VALUE 'P'.
  1849                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1850                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1851                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1852                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1853                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1854                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1855
  1856             20  CF-JOINT-INDICATOR         PIC X.
  1857                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1858
  1859*            20  FILLER                     PIC X(12).
  1860             20  cf-maximum-benefits        pic s999 comp-3.
  1861             20  FILLER                     PIC X(09).
  1862             20  CF-BENEFIT-CATEGORY        PIC X.
  1863             20  CF-LOAN-TYPE               PIC X(8).
  1864
  1865             20  CF-CO-REM-TERM-CALC        PIC X.
  1866                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1867                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1868                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1869                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  34
* SOCK03.cbl
  1870                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1871
  1872             20  CF-CO-EARNINGS-CALC        PIC X.
  1873                 88  CO-EARN-BY-R78             VALUE '1'.
  1874                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1875                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1876                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1877                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1878                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1879                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1880                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1881
  1882             20  CF-CO-REFUND-CALC          PIC X.
  1883                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1884                 88  CO-REFD-BY-R78             VALUE '1'.
  1885                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1886                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1887                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1888                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1889                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1890                 88  CO-REFD-MEAN               VALUE '8'.
  1891                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1892                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1893                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1894
  1895             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1896                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1897                 88  CO-OVRD-BY-R78             VALUE '1'.
  1898                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1899                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1900                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1901                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1902                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1903                 88  CO-OVRD-MEAN               VALUE '8'.
  1904                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1905
  1906             20  CF-CO-BEN-I-G-CD           PIC X.
  1907                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1908                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1909                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1910
  1911         16  FILLER                         PIC X(304).
  1912
  1913
  1914****************************************************************
  1915*             CARRIER MASTER RECORD                            *
  1916****************************************************************
  1917
  1918     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1919         16  CF-ADDRESS-DATA.
  1920             20  CF-MAIL-TO-NAME            PIC X(30).
  1921             20  CF-IN-CARE-OF              PIC X(30).
  1922             20  CF-ADDRESS-LINE-1          PIC X(30).
  1923             20  CF-ADDRESS-LINE-2          PIC X(30).
  1924             20  CF-CITY-STATE              PIC X(30).
  1925             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1926             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1927
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  35
* SOCK03.cbl
  1928         16  CF-CLAIM-NO-CONTROL.
  1929             20  CF-CLAIM-NO-METHOD         PIC X.
  1930                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1931                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1932                 88  CLAIM-NO-SEQ               VALUE '3'.
  1933                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1934             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1935                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1936                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1937                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1938
  1939         16  CF-CHECK-NO-CONTROL.
  1940             20  CF-CHECK-NO-METHOD         PIC X.
  1941                 88  CHECK-NO-MANUAL            VALUE '1'.
  1942                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1943                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1944                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1945             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1946                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1947
  1948         16  CF-DOMICILE-STATE              PIC XX.
  1949
  1950         16  CF-EXPENSE-CONTROLS.
  1951             20  CF-EXPENSE-METHOD          PIC X.
  1952                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1953                 88  DOLLARS-PER-PMT            VALUE '2'.
  1954                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1955                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1956             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1957             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1958
  1959         16  CF-CORRESPONDENCE-CONTROL.
  1960             20  CF-LETTER-RESEND-OPT       PIC X.
  1961                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1962                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1963             20  FILLER                     PIC X(4).
  1964
  1965         16  CF-RESERVE-CONTROLS.
  1966             20  CF-MANUAL-SW               PIC X.
  1967                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1968             20  CF-FUTURE-SW               PIC X.
  1969                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1970             20  CF-PTC-SW                  PIC X.
  1971                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1972             20  CF-IBNR-SW                 PIC X.
  1973                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1974             20  CF-PTC-LF-SW               PIC X.
  1975                 88  CF-LF-PTC-USED             VALUE '1'.
  1976             20  CF-CDT-ACCESS-METHOD       PIC X.
  1977                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1978                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1979                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1980             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1981
  1982         16  CF-CLAIM-CALC-METHOD           PIC X.
  1983             88  360-PLUS-MONTHS                VALUE '1'.
  1984             88  365-PLUS-MONTHS                VALUE '2'.
  1985             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  36
* SOCK03.cbl
  1986             88  360-DAILY                      VALUE '4'.
  1987             88  365-DAILY                      VALUE '5'.
  1988
  1989         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1990         16  FILLER                         PIC X(11).
  1991
  1992         16  CF-LIMIT-AMOUNTS.
  1993             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1994             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1995             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1996             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1997             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1998             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1999             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2000             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2001             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2002             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2003
  2004         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2005         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2006         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2007
  2008         16  CF-ZIP-CODE.
  2009             20  CF-ZIP-PRIME.
  2010                 24  CF-ZIP-1ST             PIC X.
  2011                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2012                 24  FILLER                 PIC X(4).
  2013             20  CF-ZIP-PLUS4               PIC X(4).
  2014         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2015             20  CF-CAN-POSTAL-1            PIC XXX.
  2016             20  CF-CAN-POSTAL-2            PIC XXX.
  2017             20  FILLER                     PIC XXX.
  2018
  2019         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2020         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2021         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2022
  2023         16  CF-RATING-SWITCH               PIC X.
  2024             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2025             88  CF-NO-RATING                   VALUE 'N'.
  2026
  2027         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2028
  2029         16  CF-CARRIER-OVER-SHORT.
  2030             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2031             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2032
  2033         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2034         16  CF-SECPAY-SWITCH               PIC X.
  2035             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2036             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2037         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2038         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2039         16  FILLER                         PIC X(444).
  2040*        16  FILLER                         PIC X(452).
  2041
  2042
  2043****************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  37
* SOCK03.cbl
  2044*             MORTALITY MASTER RECORD                          *
  2045****************************************************************
  2046
  2047     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2048         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2049                                INDEXED BY CF-MORT-NDX.
  2050             20  CF-MORT-TABLE              PIC X(5).
  2051             20  CF-MORT-TABLE-TYPE         PIC X.
  2052                 88  CF-MORT-JOINT              VALUE 'J'.
  2053                 88  CF-MORT-SINGLE             VALUE 'S'.
  2054                 88  CF-MORT-COMBINED           VALUE 'C'.
  2055                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2056                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2057             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2058             20  CF-MORT-AGE-METHOD         PIC XX.
  2059                 88  CF-AGE-LAST                VALUE 'AL'.
  2060                 88  CF-AGE-NEAR                VALUE 'AN'.
  2061             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2062             20  CF-MORT-ADJUSTMENT-DIRECTION
  2063                                            PIC X.
  2064                 88  CF-MINUS                   VALUE '-'.
  2065                 88  CF-PLUS                    VALUE '+'.
  2066             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2067             20  CF-MORT-JOINT-CODE         PIC X.
  2068                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2069             20  CF-MORT-PC-Q               PIC X.
  2070                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2071             20  CF-MORT-TABLE-CODE         PIC X(4).
  2072             20  CF-MORT-COMMENTS           PIC X(15).
  2073             20  FILLER                     PIC X(14).
  2074
  2075         16  FILLER                         PIC X(251).
  2076
  2077
  2078****************************************************************
  2079*             BUSSINESS TYPE MASTER RECORD                     *
  2080****************************************************************
  2081
  2082     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2083* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2084* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2085* AND RECORD 05 IS TYPES 81-99
  2086         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2087             20  CF-BUSINESS-TITLE          PIC  X(19).
  2088             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2089                                            PIC S9V9(4) COMP-3.
  2090             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2091             20  FILLER                     PIC  X.
  2092         16  FILLER                         PIC  X(248).
  2093
  2094
  2095****************************************************************
  2096*             TERMINAL MASTER RECORD                           *
  2097****************************************************************
  2098
  2099     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2100
  2101         16  CF-COMPANY-TERMINALS.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  38
* SOCK03.cbl
  2102             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2103                                  PIC X(4).
  2104         16  FILLER               PIC X(248).
  2105
  2106
  2107****************************************************************
  2108*             LIFE EDIT MASTER RECORD                          *
  2109****************************************************************
  2110
  2111     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2112         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2113             20  CF-LIFE-CODE-IN            PIC XX.
  2114             20  CF-LIFE-CODE-OUT           PIC XX.
  2115         16  FILLER                         PIC X(248).
  2116
  2117
  2118****************************************************************
  2119*             AH EDIT MASTER RECORD                            *
  2120****************************************************************
  2121
  2122     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2123         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2124             20  CF-AH-CODE-IN              PIC XXX.
  2125             20  CF-AH-CODE-OUT             PIC XX.
  2126         16  FILLER                         PIC X(248).
  2127
  2128
  2129****************************************************************
  2130*             CREDIBILITY TABLES                               *
  2131****************************************************************
  2132
  2133     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2134         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2135                             INDEXED BY CF-CRDB-NDX.
  2136             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2137             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2138             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2139         16  FILLER                         PIC  X(332).
  2140
  2141
  2142****************************************************************
  2143*             REPORT CUSTOMIZATION RECORD                      *
  2144****************************************************************
  2145
  2146     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2147         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2148             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2149             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2150             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2151**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2152****       A T-TRANSFER.                                   ****
  2153             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2154
  2155         16  FILLER                         PIC XX.
  2156
  2157         16  CF-CARRIER-CNTL-OPT.
  2158             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2159                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  39
* SOCK03.cbl
  2160                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2161             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2162                                            PIC X.
  2163         16  CF-GROUP-CNTL-OPT.
  2164             20  CF-GROUP-OPT-SEQ           PIC 9.
  2165                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2166                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2167             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2168                                            PIC X(6).
  2169         16  CF-STATE-CNTL-OPT.
  2170             20  CF-STATE-OPT-SEQ           PIC 9.
  2171                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2172                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2173             20  CF-STATE-SELECT OCCURS 3 TIMES
  2174                                            PIC XX.
  2175         16  CF-ACCOUNT-CNTL-OPT.
  2176             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2177                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2178                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2179             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2180                                            PIC X(10).
  2181         16  CF-BUS-TYP-CNTL-OPT.
  2182             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2183                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2184                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2185             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2186                                            PIC XX.
  2187         16  CF-LF-TYP-CNTL-OPT.
  2188             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2189                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2190                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2191             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2192                                            PIC XX.
  2193         16  CF-AH-TYP-CNTL-OPT.
  2194             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2195                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2196                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2197             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2198                                            PIC XX.
  2199         16  CF-REPTCD1-CNTL-OPT.
  2200             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2201                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2202                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2203             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2204                                            PIC X(10).
  2205         16  CF-REPTCD2-CNTL-OPT.
  2206             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2207                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2208                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2209             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2210                                            PIC X(10).
  2211         16  CF-USER1-CNTL-OPT.
  2212             20  CF-USER1-OPT-SEQ           PIC 9.
  2213                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2214                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2215             20  CF-USER1-SELECT OCCURS 3 TIMES
  2216                                            PIC X(10).
  2217         16  CF-USER2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  40
* SOCK03.cbl
  2218             20  CF-USER2-OPT-SEQ           PIC 9.
  2219                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2220                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2221             20  CF-USER2-SELECT OCCURS 3 TIMES
  2222                                            PIC X(10).
  2223         16  CF-USER3-CNTL-OPT.
  2224             20  CF-USER3-OPT-SEQ           PIC 9.
  2225                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2226                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2227             20  CF-USER3-SELECT OCCURS 3 TIMES
  2228                                            PIC X(10).
  2229         16  CF-USER4-CNTL-OPT.
  2230             20  CF-USER4-OPT-SEQ           PIC 9.
  2231                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2232                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2233             20  CF-USER4-SELECT OCCURS 3 TIMES
  2234                                            PIC X(10).
  2235         16  CF-USER5-CNTL-OPT.
  2236             20  CF-USER5-OPT-SEQ           PIC 9.
  2237                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2238                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2239             20  CF-USER5-SELECT OCCURS 3 TIMES
  2240                                            PIC X(10).
  2241         16  CF-REINS-CNTL-OPT.
  2242             20  CF-REINS-OPT-SEQ           PIC 9.
  2243                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2244                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2245             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2246                 24  CF-REINS-PRIME         PIC XXX.
  2247                 24  CF-REINS-SUB           PIC XXX.
  2248
  2249         16  CF-AGENT-CNTL-OPT.
  2250             20  CF-AGENT-OPT-SEQ           PIC 9.
  2251                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2252                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2253             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2254                                            PIC X(10).
  2255
  2256         16  FILLER                         PIC X(43).
  2257
  2258         16  CF-LOSS-RATIO-SELECT.
  2259             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2260             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2261         16  CF-ENTRY-DATE-SELECT.
  2262             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2263             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2264         16  CF-EFFECTIVE-DATE-SELECT.
  2265             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2266             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2267
  2268         16  CF-EXCEPTION-LIST-IND          PIC X.
  2269             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2270
  2271         16  FILLER                         PIC X(318).
  2272
  2273****************************************************************
  2274*                  EXCEPTION REPORTING RECORD                  *
  2275****************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  41
* SOCK03.cbl
  2276
  2277     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2278         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2279             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2280
  2281         16  CF-COMBINED-LIFE-AH-OPT.
  2282             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2283             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2284             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2285             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2286
  2287         16  CF-LIFE-OPT.
  2288             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2289             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2290             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2291             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2292             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2293             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2294             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2295             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2296             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2297             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2298
  2299         16  CF-AH-OPT.
  2300             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2301             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2302             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2303             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2304             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2305             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2306             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2307             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2308             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2309             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2310
  2311         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2312             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2313             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2314             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2315
  2316         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2317
  2318         16  FILLER                         PIC X(673).
  2319
  2320
  2321****************************************************************
  2322*             MORTGAGE SYSTEM PLAN RECORD                      *
  2323****************************************************************
  2324
  2325     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2326         16  CF-PLAN-TYPE                   PIC X.
  2327             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2328             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2329             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2330         16  CF-PLAN-ABBREV                 PIC XXX.
  2331         16  CF-PLAN-DESCRIPT               PIC X(10).
  2332         16  CF-PLAN-NOTES                  PIC X(20).
  2333         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  42
* SOCK03.cbl
  2334         16  CF-PLAN-UNDERWRITING.
  2335             20  CF-PLAN-TERM-DATA.
  2336                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2337                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2338             20  CF-PLAN-AGE-DATA.
  2339                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2340                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2341                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2342             20  CF-PLAN-BENEFIT-DATA.
  2343                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2344                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2345                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2346                                            PIC S9(7)V99  COMP-3.
  2347         16  CF-PLAN-POLICY-FORMS.
  2348             20  CF-POLICY-FORM             PIC X(12).
  2349             20  CF-MASTER-APPLICATION      PIC X(12).
  2350             20  CF-MASTER-POLICY           PIC X(12).
  2351         16  CF-PLAN-RATING.
  2352             20  CF-RATE-CODE               PIC X(5).
  2353             20  CF-SEX-RATING              PIC X.
  2354                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2355                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2356             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2357             20  CF-SUB-STD-TYPE            PIC X.
  2358                 88  CF-PCT-OF-PREM            VALUE '1'.
  2359                 88  CF-PCT-OF-BENE            VALUE '2'.
  2360         16  CF-PLAN-PREM-TOLERANCES.
  2361             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2362             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2363         16  CF-PLAN-PYMT-TOLERANCES.
  2364             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2365             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2366         16  CF-PLAN-MISC-DATA.
  2367             20  FILLER                     PIC X.
  2368             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2369             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2370         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2371         16  CF-PLAN-IND-GRP                PIC X.
  2372             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2373                                                     '1'.
  2374             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2375                                                     '2'.
  2376         16  CF-MIB-SEARCH-SW               PIC X.
  2377             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2378             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2379             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2380             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2381         16  CF-ALPHA-SEARCH-SW             PIC X.
  2382             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2383             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2384             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2385             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2386             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2387             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2388             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2389             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2390             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2391             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  43
* SOCK03.cbl
  2392                                                     'A' 'B' 'C'
  2393                                                     'X' 'Y' 'Z'.
  2394         16  CF-EFF-DT-RULE-SW              PIC X.
  2395             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2396             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2397             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2398             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2399             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2400         16  FILLER                         PIC X(4).
  2401         16  CF-HEALTH-QUESTIONS            PIC X.
  2402             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2403         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2404         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2405         16  CF-PLAN-SNGL-JNT               PIC X.
  2406             88  CF-COMBINED-PLAN              VALUE 'C'.
  2407             88  CF-JNT-PLAN                   VALUE 'J'.
  2408             88  CF-SNGL-PLAN                  VALUE 'S'.
  2409         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2410         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2411         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2412         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2413         16  CF-RERATE-CNTL                 PIC  X.
  2414             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2415             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2416             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2417             88  CF-AUTO-RECALC                 VALUE '4'.
  2418         16  CF-BENEFIT-TYPE                PIC  X.
  2419             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2420             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2421         16  CF-POLICY-FEE                  PIC S999V99
  2422                                                    COMP-3.
  2423         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2424         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2425         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2426         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2427         16  FILLER                         PIC  X(32).
  2428         16  CF-TERMINATION-FORM            PIC  X(04).
  2429         16  FILLER                         PIC  X(08).
  2430         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2431                                                       COMP-3.
  2432         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2433         16  CF-ISSUE-LETTER                PIC  X(4).
  2434         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2435         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2436             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2437             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2438         16  CF-MP-REFUND-CALC              PIC X.
  2439             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2440             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2441             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2442             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2443             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2444             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2445             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2446             88  CF-MP-REFD-MEAN                VALUE '8'.
  2447         16  CF-ALT-RATE-CODE               PIC  X(5).
  2448
  2449
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  44
* SOCK03.cbl
  2450         16  FILLER                         PIC X(498).
  2451****************************************************************
  2452*             MORTGAGE COMPANY MASTER RECORD                   *
  2453****************************************************************
  2454
  2455     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2456         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2457         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2458             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2459             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2460             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2461             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2462             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2463
  2464         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2465         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2466         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2467         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2468         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2469
  2470         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2471             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2472         16  CF-MP-RECON-USE-IND            PIC X(1).
  2473             88  CF-MP-USE-RECON             VALUE 'Y'.
  2474         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2475             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2476         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2477             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2478             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2479         16  FILLER                         PIC X(1).
  2480         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2481             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2482         16  CF-MORTG-MIB-VERSION           PIC X.
  2483             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2484             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2485             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2486         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2487             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2488                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2489             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2490                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2491             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2492                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2493             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2494                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2495             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2496                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2497             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2498                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2499         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2500         16  FILLER                         PIC X(7).
  2501         16  CF-MORTG-DESTINATION-SYMBOL.
  2502             20  CF-MORTG-MIB-COMM          PIC X(5).
  2503             20  CF-MORTG-MIB-TERM          PIC X(5).
  2504         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2505             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2506         16  FILLER                         PIC X(03).
  2507         16  CF-MP-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  45
* SOCK03.cbl
  2508             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2509                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2510                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2511                                                ' ' LOW-VALUES.
  2512                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2513                                               VALUE '3'.
  2514         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2515         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2516         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2517             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2518                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2519             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2520                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2521             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2522                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2523             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2524                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2525             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2526                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2527             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2528                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2529         16  CF-MORTG-BILLING-AREA.
  2530             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2531                                            PIC X.
  2532         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2533         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2534         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2535         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2536             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2537             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2538         16  FILLER                         PIC X.
  2539         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2540             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2541             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2542         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2543         16  FILLER                         PIC X(8).
  2544         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2545         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2546         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2547         16  CF-ACH-COMPANY-ID.
  2548             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2549                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2550                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2551                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2552             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2553         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2554             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2555         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2556             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2557             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2558         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2559         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2560         16  FILLER                         PIC X(536).
  2561
  2562****************************************************************
  2563*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2564****************************************************************
  2565
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  46
* SOCK03.cbl
  2566     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2567         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2568             20  CF-FEMALE-HEIGHT.
  2569                 24  CF-FEMALE-FT           PIC 99.
  2570                 24  CF-FEMALE-IN           PIC 99.
  2571             20  CF-FEMALE-MIN-WT           PIC 999.
  2572             20  CF-FEMALE-MAX-WT           PIC 999.
  2573         16  FILLER                         PIC X(428).
  2574
  2575     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2576         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2577             20  CF-MALE-HEIGHT.
  2578                 24  CF-MALE-FT             PIC 99.
  2579                 24  CF-MALE-IN             PIC 99.
  2580             20  CF-MALE-MIN-WT             PIC 999.
  2581             20  CF-MALE-MAX-WT             PIC 999.
  2582         16  FILLER                         PIC X(428).
  2583******************************************************************
  2584*             AUTOMATIC ACTIVITY RECORD                          *
  2585******************************************************************
  2586     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2587         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2588             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2589             20  CF-SYS-LETTER-ID           PIC X(04).
  2590             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2591             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2592             20  CF-SYS-RESET-SW            PIC X(01).
  2593             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2594             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2595
  2596         16  FILLER                         PIC X(50).
  2597
  2598         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2599             20  CF-USER-ACTIVE-SW          PIC X(01).
  2600             20  CF-USER-LETTER-ID          PIC X(04).
  2601             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2602             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2603             20  CF-USER-RESET-SW           PIC X(01).
  2604             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2605             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2606             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2607
  2608         16  FILLER                         PIC X(246).
  2609*                                 COPY ERCACCT.
  2610******************************************************************
  2611*                                                                *
  2612*                                                                *
  2613*                            ERCACCT                             *
  2614*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2615*                            VMOD=2.031                          *
  2616*                                                                *
  2617*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2618*                                                                *
  2619*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2620*   VSAM ACCOUNT MASTER FILES.                                   *
  2621*                                                                *
  2622*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2623*                                                                *
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  47
* SOCK03.cbl
  2624*   FILE TYPE = VSAM,KSDS                                        *
  2625*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2626*                                                                *
  2627*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2628*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2629*                                                                *
  2630*   LOG = NO                                                     *
  2631*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2632*                                                                *
  2633*                                                                *
  2634******************************************************************
  2635*                   C H A N G E   L O G
  2636*
  2637* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2638*-----------------------------------------------------------------
  2639*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2640* EFFECTIVE    NUMBER
  2641*-----------------------------------------------------------------
  2642* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2643* 092705    2005050300006  PEMA  ADD SPP LEASES
  2644* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2645* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2646* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2647* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2648* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2649* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2650******************************************************************
  2651
  2652 01  ACCOUNT-MASTER.
  2653     12  AM-RECORD-ID                      PIC XX.
  2654         88  VALID-AM-ID                      VALUE 'AM'.
  2655
  2656     12  AM-CONTROL-PRIMARY.
  2657         16  AM-COMPANY-CD                 PIC X.
  2658         16  AM-MSTR-CNTRL.
  2659             20  AM-CONTROL-A.
  2660                 24  AM-CARRIER            PIC X.
  2661                 24  AM-GROUPING.
  2662                     28 AM-GROUPING-PREFIX PIC XXX.
  2663                     28 AM-GROUPING-PRIME  PIC XXX.
  2664                 24  AM-STATE              PIC XX.
  2665                 24  AM-ACCOUNT.
  2666                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2667                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2668             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2669                                           PIC X(19).
  2670             20  AM-CNTRL-B.
  2671                 24  AM-EXPIRATION-DT      PIC XX.
  2672                 24  FILLER                PIC X(4).
  2673             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2674                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2675
  2676     12  AM-CONTROL-BY-VAR-GRP.
  2677         16  AM-COMPANY-CD-A1              PIC X.
  2678         16  AM-VG-CARRIER                 PIC X.
  2679         16  AM-VG-GROUPING                PIC X(6).
  2680         16  AM-VG-STATE                   PIC XX.
  2681         16  AM-VG-ACCOUNT                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  48
* SOCK03.cbl
  2682         16  AM-VG-DATE.
  2683             20  AM-VG-EXPIRATION-DT       PIC XX.
  2684             20  FILLER                    PIC X(4).
  2685         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2686                                           PIC 9(11)      COMP-3.
  2687     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2688         16  FILLER                        PIC X(10).
  2689         16  AM-VG-KEY3.
  2690             20  AM-VG3-ACCOUNT            PIC X(10).
  2691             20  AM-VG3-EXP-DT             PIC XX.
  2692         16  FILLER                        PIC X(4).
  2693     12  AM-MAINT-INFORMATION.
  2694         16  AM-LAST-MAINT-DT              PIC XX.
  2695         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2696         16  AM-LAST-MAINT-USER            PIC X(4).
  2697         16  FILLER                        PIC XX.
  2698
  2699     12  AM-EFFECTIVE-DT                   PIC XX.
  2700     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2701
  2702     12  AM-PREV-DATES  COMP-3.
  2703         16  AM-PREV-EXP-DT                PIC 9(11).
  2704         16  AM-PREV-EFF-DT                PIC 9(11).
  2705
  2706     12  AM-REPORT-CODE-1                  PIC X(10).
  2707     12  AM-REPORT-CODE-2                  PIC X(10).
  2708
  2709     12  AM-CITY-CODE                      PIC X(4).
  2710     12  AM-COUNTY-PARISH                  PIC X(6).
  2711
  2712     12  AM-NAME                           PIC X(30).
  2713     12  AM-PERSON                         PIC X(30).
  2714     12  AM-ADDRS                          PIC X(30).
  2715     12  AM-CITY.
  2716         16  AM-ADDR-CITY                  PIC X(28).
  2717         16  AM-ADDR-STATE                 PIC XX.
  2718     12  AM-ZIP.
  2719         16  AM-ZIP-PRIME.
  2720             20  AM-ZIP-PRI-1ST            PIC X.
  2721                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2722             20  FILLER                    PIC X(4).
  2723         16  AM-ZIP-PLUS4                  PIC X(4).
  2724     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2725         16  AM-CAN-POSTAL-1               PIC XXX.
  2726         16  AM-CAN-POSTAL-2               PIC XXX.
  2727         16  FILLER                        PIC XXX.
  2728     12  AM-TEL-NO.
  2729         16  AM-AREA-CODE                  PIC 999.
  2730         16  AM-TEL-PRE                    PIC 999.
  2731         16  AM-TEL-NBR                    PIC 9(4).
  2732     12  AM-TEL-LOC                        PIC X.
  2733         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2734         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2735
  2736     12  AM-COMM-STRUCTURE.
  2737         16  AM-DEFN-1.
  2738             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2739                 24  AM-AGT.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  49
* SOCK03.cbl
  2740                     28  AM-AGT-PREFIX     PIC X(4).
  2741                     28  AM-AGT-PRIME      PIC X(6).
  2742                 24  AM-COM-TYP            PIC X.
  2743                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2744                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2745                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2746                 24  AM-RECALC-LV-INDIC    PIC X.
  2747                 24  AM-RETRO-LV-INDIC     PIC X.
  2748                 24  AM-GL-CODES           PIC X.
  2749                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2750                 24  FILLER                PIC X(01).
  2751         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2752             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2753                 24  FILLER                PIC X(11).
  2754                 24  AM-L-COMA             PIC XXX.
  2755                 24  AM-J-COMA             PIC XXX.
  2756                 24  AM-A-COMA             PIC XXX.
  2757                 24  FILLER                PIC X(6).
  2758
  2759     12  AM-COMM-CHANGE-STATUS             PIC X.
  2760         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2761
  2762     12  AM-CSR-CODE                       PIC X(4).
  2763
  2764     12  AM-BILLING-STATUS                 PIC X.
  2765         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2766         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2767     12  AM-AUTO-REFUND-SW                 PIC X.
  2768         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2769         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2770     12  AM-GPCD                           PIC 99.
  2771     12  AM-IG                             PIC X.
  2772         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2773         88  AM-HAS-GROUP                     VALUE '2'.
  2774     12  AM-STATUS                         PIC X.
  2775         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2776         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2777         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2778         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2779         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2780         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2781         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2782         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2783         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2784         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2785     12  AM-REMIT-TO                       PIC 99.
  2786     12  AM-ID-NO                          PIC X(11).
  2787
  2788     12  AM-CAL-TABLE                      PIC XX.
  2789     12  AM-LF-DEVIATION                   PIC XXX.
  2790     12  AM-AH-DEVIATION                   PIC XXX.
  2791     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2792     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2793     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2794     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2795     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2796     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2797
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  50
* SOCK03.cbl
  2798     12  AM-USER-FIELDS.
  2799         16  AM-FLD-1                      PIC XX.
  2800         16  AM-FLD-2                      PIC XX.
  2801         16  AM-FLD-3                      PIC XX.
  2802         16  AM-FLD-4                      PIC XX.
  2803         16  AM-FLD-5                      PIC XX.
  2804
  2805     12  AM-1ST-PROD-DATE.
  2806         16  AM-1ST-PROD-YR                PIC XX.
  2807         16  AM-1ST-PROD-MO                PIC XX.
  2808         16  AM-1ST-PROD-DA                PIC XX.
  2809     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2810     12  AM-CERTS-PURGED-DATE.
  2811         16  AM-PUR-YR                     PIC XX.
  2812         16  AM-PUR-MO                     PIC XX.
  2813         16  AM-PUR-DA                     PIC XX.
  2814     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2815     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2816     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2817     12  AM-INACTIVE-DATE.
  2818         16  AM-INA-MO                     PIC 99.
  2819         16  AM-INA-DA                     PIC 99.
  2820         16  AM-INA-YR                     PIC 99.
  2821     12  AM-AR-HI-CERT-DATE                PIC XX.
  2822
  2823     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2824     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2825
  2826     12  AM-OB-PAYMENT-MODE                PIC X.
  2827         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2828         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2829         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2830         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2831
  2832     12  AM-AH-ONLY-INDICATOR              PIC X.
  2833         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2834         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2835
  2836     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2837
  2838     12  AM-OVER-SHORT.
  2839         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2840         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2841
  2842     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2843     12  AM-DCC-CLP-STATE                  PIC XX.
  2844
  2845     12  AM-RECALC-COMM                    PIC X.
  2846     12  AM-RECALC-REIN                    PIC X.
  2847
  2848     12  AM-REI-TABLE                      PIC XXX.
  2849     12  AM-REI-ET-LF                      PIC X.
  2850     12  AM-REI-ET-AH                      PIC X.
  2851     12  AM-REI-PE-LF                      PIC X.
  2852     12  AM-REI-PE-AH                      PIC X.
  2853     12  AM-REI-PRT-ST                     PIC X.
  2854     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2855     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  51
* SOCK03.cbl
  2856     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2857     12  AM-REI-GROUP-A                    PIC X(6).
  2858     12  AM-REI-MORT                       PIC X(4).
  2859     12  AM-REI-PRT-OW                     PIC X.
  2860     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2861     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2862     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2863     12  AM-REI-GROUP-B                    PIC X(6).
  2864
  2865     12  AM-TRUST-TYPE                     PIC X(2).
  2866
  2867     12  AM-EMPLOYER-STMT-USED             PIC X.
  2868     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2869
  2870     12  AM-STD-AH-TYPE                    PIC XX.
  2871     12  AM-EARN-METHODS.
  2872         16  AM-EARN-METHOD-R              PIC X.
  2873             88 AM-REF-RL-R78                 VALUE 'R'.
  2874             88 AM-REF-RL-PR                  VALUE 'P'.
  2875             88 AM-REF-RL-MEAN                VALUE 'M'.
  2876             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2877         16  AM-EARN-METHOD-L              PIC X.
  2878             88 AM-REF-LL-R78                 VALUE 'R'.
  2879             88 AM-REF-LL-PR                  VALUE 'P'.
  2880             88 AM-REF-LL-MEAN                VALUE 'M'.
  2881             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2882         16  AM-EARN-METHOD-A              PIC X.
  2883             88 AM-REF-AH-R78                 VALUE 'R'.
  2884             88 AM-REF-AH-PR                  VALUE 'P'.
  2885             88 AM-REF-AH-MEAN                VALUE 'M'.
  2886             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2887             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2888             88 AM-REF-AH-NET                 VALUE 'N'.
  2889
  2890     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2891     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2892     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2893
  2894     12  AM-RET-Y-N                        PIC X.
  2895     12  AM-RET-P-E                        PIC X.
  2896     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2897     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2898     12  AM-RET-GRP                        PIC X(6).
  2899     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2900         16  AM-POOL-PRIME                 PIC XXX.
  2901         16  AM-POOL-SUB                   PIC XXX.
  2902     12  AM-RETRO-EARNINGS.
  2903         16  AM-RET-EARN-R                 PIC X.
  2904         16  AM-RET-EARN-L                 PIC X.
  2905         16  AM-RET-EARN-A                 PIC X.
  2906     12  AM-RET-ST-TAX-USE                 PIC X.
  2907         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2908         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2909     12  AM-RETRO-BEG-EARNINGS.
  2910         16  AM-RET-BEG-EARN-R             PIC X.
  2911         16  AM-RET-BEG-EARN-L             PIC X.
  2912         16  AM-RET-BEG-EARN-A             PIC X.
  2913     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  52
* SOCK03.cbl
  2914     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2915
  2916     12  AM-USER-SELECT-OPTIONS.
  2917         16  AM-USER-SELECT-1              PIC X(10).
  2918         16  AM-USER-SELECT-2              PIC X(10).
  2919         16  AM-USER-SELECT-3              PIC X(10).
  2920         16  AM-USER-SELECT-4              PIC X(10).
  2921         16  AM-USER-SELECT-5              PIC X(10).
  2922
  2923     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2924
  2925     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2926
  2927     12  AM-RPT045A-SWITCH                 PIC X.
  2928         88  RPT045A-OFF                   VALUE 'N'.
  2929
  2930     12  AM-INSURANCE-LIMITS.
  2931         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2932         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2933
  2934     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2935         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2936
  2937     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2938         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2939         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2940
  2941     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2942
  2943     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2944     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2945     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2946     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2947     12  AM-DCC-UEF-STATE                  PIC XX.
  2948     12  FILLER                            PIC XXX.
  2949     12  AM-REPORT-CODE-3                  PIC X(10).
  2950*    12  FILLER                            PIC X(22).
  2951
  2952     12  AM-RESERVE-DATE.
  2953         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2954         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2955         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2956
  2957     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2958     12  AM-NOTIFICATION-TYPES.
  2959         16  AM-NOTIF-OF-LETTERS           PIC X.
  2960         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2961         16  AM-NOTIF-OF-REPORTS           PIC X.
  2962         16  AM-NOTIF-OF-STATUS            PIC X.
  2963
  2964     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2965         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2966         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2967         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2968         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2969
  2970     12  AM-BENEFIT-CONTROLS.
  2971         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  53
* SOCK03.cbl
  2972             20  AM-BENEFIT-CODE           PIC XX.
  2973             20  AM-BENEFIT-TYPE           PIC X.
  2974             20  AM-BENEFIT-REVISION       PIC XXX.
  2975             20  AM-BENEFIT-REM-TERM       PIC X.
  2976             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2977             20  FILLER                    PIC XX.
  2978         16  FILLER                        PIC X(80).
  2979
  2980     12  AM-TRANSFER-DATA.
  2981         16  AM-TRANSFERRED-FROM.
  2982             20  AM-TRNFROM-CARRIER        PIC X.
  2983             20  AM-TRNFROM-GROUPING.
  2984                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2985                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2986             20  AM-TRNFROM-STATE          PIC XX.
  2987             20  AM-TRNFROM-ACCOUNT.
  2988                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2989                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2990             20  AM-TRNFROM-DTE            PIC XX.
  2991         16  AM-TRANSFERRED-TO.
  2992             20  AM-TRNTO-CARRIER          PIC X.
  2993             20  AM-TRNTO-GROUPING.
  2994                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2995                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2996             20  AM-TRNTO-STATE            PIC XX.
  2997             20  AM-TRNTO-ACCOUNT.
  2998                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2999                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3000             20  AM-TRNTO-DTE              PIC XX.
  3001         16  FILLER                        PIC X(10).
  3002
  3003     12  AM-SAVED-REMIT-TO                 PIC 99.
  3004
  3005     12  AM-COMM-STRUCTURE-SAVED.
  3006         16  AM-DEFN-1-SAVED.
  3007             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3008                 24  AM-AGT-SV             PIC X(10).
  3009                 24  AM-COM-TYP-SV         PIC X.
  3010                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3011                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3012                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3013                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3014                 24  FILLER                PIC X.
  3015                 24  AM-GL-CODES-SV        PIC X.
  3016                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3017                 24  FILLER                PIC X.
  3018         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3019             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3020                 24  FILLER                PIC X(11).
  3021                 24  AM-L-COMA-SV          PIC XXX.
  3022                 24  AM-J-COMA-SV          PIC XXX.
  3023                 24  AM-A-COMA-SV          PIC XXX.
  3024                 24  FILLER                PIC X(6).
  3025
  3026     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3027         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3028            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3029            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  54
* SOCK03.cbl
  3030            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3031
  3032     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3033     12  FILLER                            PIC X(120).
  3034
  3035     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3036         16  AM-CONTROL-NAME               PIC X(30).
  3037         16  AM-EXECUTIVE-ONE.
  3038             20  AM-EXEC1-NAME             PIC X(15).
  3039             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3040                                                          COMP-3.
  3041             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3042                                                          COMP-3.
  3043         16  AM-EXECUTIVE-TWO.
  3044             20  AM-EXEC2-NAME             PIC X(15).
  3045             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3046                                                          COMP-3.
  3047             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3048                                                          COMP-3.
  3049
  3050     12  AM-RETRO-ADDITIONAL-DATA.
  3051         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3052         16  AM-RETRO-PREM-P-E             PIC X.
  3053         16  AM-RETRO-CLMS-P-I             PIC X.
  3054         16  AM-RETRO-RET-BRACKET-LF.
  3055             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3056                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3057                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3058             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3059                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3060                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3061             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3062                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3063                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3064         16  AM-RETRO-RET-BRACKET-AH.
  3065             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3066                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3067                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3068                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3069             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3070                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3071                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3072             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3073                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3074                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3075
  3076     12  AM-COMMENTS.
  3077         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3078
  3079     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3080         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3081         16  AM-FLI-BILLING-CODE           PIC X.
  3082         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3083         16  AM-FLI-UNITED-IDENT           PIC X.
  3084         16  AM-FLI-INTEREST-LOST-DATA.
  3085             20  AM-FLI-BANK-NO            PIC X(5).
  3086             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3087             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  55
* SOCK03.cbl
  3088             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3089         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3090             20  AM-FLI-AGT                PIC X(9).
  3091             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3092             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3093         16  FILLER                        PIC X(102).
  3094
  3095     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3096         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3097             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3098             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3099             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3100             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3101             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3102         16  FILLER                          PIC X(10).
  3103******************************************************************
  3104*                                 COPY ERCMAIL.
  3105******************************************************************
  3106*                                                                *
  3107*                                                                *
  3108*                            ERCMAIL                             *
  3109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3110*                            VMOD=2.003                          *
  3111*                                                                *
  3112*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3113*                                                                *
  3114*   FILE TYPE = VSAM,KSDS                                        *
  3115*   RECORD SIZE = 374   RECFORM = FIX                            *
  3116*                                                                *
  3117*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3118*   ALTERNATE PATH    = NOT USED                                 *
  3119*                                                                *
  3120*   LOG = YES                                                    *
  3121*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3122******************************************************************
  3123*                   C H A N G E   L O G
  3124*
  3125* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3126*-----------------------------------------------------------------
  3127*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3128* EFFECTIVE    NUMBER
  3129*-----------------------------------------------------------------
  3130* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3131* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3132* 111108                   PEMA  ADD CRED BENE ADDR2
  3133******************************************************************
  3134
  3135 01  MAILING-DATA.
  3136     12  MA-RECORD-ID                      PIC XX.
  3137         88  VALID-MA-ID                       VALUE 'MA'.
  3138
  3139     12  MA-CONTROL-PRIMARY.
  3140         16  MA-COMPANY-CD                 PIC X.
  3141         16  MA-CARRIER                    PIC X.
  3142         16  MA-GROUPING.
  3143             20  MA-GROUPING-PREFIX        PIC XXX.
  3144             20  MA-GROUPING-PRIME         PIC XXX.
  3145         16  MA-STATE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  56
* SOCK03.cbl
  3146         16  MA-ACCOUNT.
  3147             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3148             20  MA-ACCOUNT-PRIME          PIC X(6).
  3149         16  MA-CERT-EFF-DT                PIC XX.
  3150         16  MA-CERT-NO.
  3151             20  MA-CERT-PRIME             PIC X(10).
  3152             20  MA-CERT-SFX               PIC X.
  3153
  3154     12  FILLER                            PIC XX.
  3155
  3156     12  MA-ACCESS-CONTROL.
  3157         16  MA-SOURCE-SYSTEM              PIC XX.
  3158             88  MA-FROM-CREDIT                VALUE 'CR'.
  3159             88  MA-FROM-VSI                   VALUE 'VS'.
  3160             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3161             88  MA-FROM-OTHER                 VALUE 'OT'.
  3162         16  MA-RECORD-ADD-DT              PIC XX.
  3163         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3164         16  MA-LAST-MAINT-DT              PIC XX.
  3165         16  MA-LAST-MAINT-BY              PIC XXXX.
  3166         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3167
  3168     12  MA-PROFILE-INFO.
  3169         16  MA-QUALIFY-CODE-1             PIC XX.
  3170         16  MA-QUALIFY-CODE-2             PIC XX.
  3171         16  MA-QUALIFY-CODE-3             PIC XX.
  3172         16  MA-QUALIFY-CODE-4             PIC XX.
  3173         16  MA-QUALIFY-CODE-5             PIC XX.
  3174
  3175         16  MA-INSURED-LAST-NAME          PIC X(15).
  3176         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3177         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3178         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3179         16  MA-INSURED-BIRTH-DT           PIC XX.
  3180         16  MA-INSURED-SEX                PIC X.
  3181             88  MA-SEX-MALE                   VALUE 'M'.
  3182             88  MA-SEX-FEMALE                 VALUE 'F'.
  3183         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3184
  3185         16  MA-ADDRESS-CORRECTED          PIC X.
  3186         16  MA-JOINT-BIRTH-DT             PIC XX.
  3187*        16  FILLER                        PIC X(12).
  3188
  3189         16  MA-ADDRESS-LINE-1             PIC X(30).
  3190         16  MA-ADDRESS-LINE-2             PIC X(30).
  3191         16  MA-CITY-STATE.
  3192             20  MA-CITY                   PIC X(28).
  3193             20  MA-ADDR-STATE             PIC XX.
  3194         16  MA-ZIP.
  3195             20  MA-ZIP-CODE.
  3196                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3197                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3198                 24  FILLER                PIC X(4).
  3199             20  MA-ZIP-PLUS4              PIC X(4).
  3200         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  3201             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  3202             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3203             20  FILLER                    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  57
* SOCK03.cbl
  3204
  3205         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  3206
  3207         16  FILLER                        PIC XXX.
  3208*        16  FILLER                        PIC X(10).
  3209
  3210     12  MA-CRED-BENE-INFO.
  3211         16  MA-CRED-BENE-NAME                 PIC X(25).
  3212         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3213         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3214         16  MA-CRED-BENE-CTYST.
  3215             20  MA-CRED-BENE-CITY             PIC X(28).
  3216             20  MA-CRED-BENE-STATE            PIC XX.
  3217         16  MA-CRED-BENE-ZIP.
  3218             20  MA-CB-ZIP-CODE.
  3219                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3220                     88  MA-CB-CANADIAN-POST-CODE
  3221                                           VALUE 'A' THRU 'Z'.
  3222                 24  FILLER                    PIC X(4).
  3223             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3224         16  MA-CB-CANADIAN-POSTAL-CODE
  3225                            REDEFINES MA-CRED-BENE-ZIP.
  3226             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3227             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3228             20  FILLER                        PIC X(3).
  3229     12  MA-POST-CARD-MAIL-DATA.
  3230         16  MA-MAIL-DATA OCCURS 7.
  3231             20  MA-MAIL-TYPE              PIC X.
  3232                 88  MA-12MO-MAILING           VALUE '1'.
  3233                 88  MA-EXP-MAILING            VALUE '2'.
  3234             20  MA-MAIL-STATUS            PIC X.
  3235                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3236                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3237                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3238             20  MA-MAIL-DATE              PIC XX.
  3239     12  FILLER                            PIC XX.
  3240     12  FILLER                            PIC XX.
  3241*    12  FILLER                            PIC X(30).
  3242******************************************************************
  3243*                                 COPY ELCCRTT.
  3244******************************************************************
  3245*                                                                *
  3246*                            ELCCRTT.                            *
  3247*                                                                *
  3248*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3249*                                                                *
  3250*   FILE TYPE = VSAM,KSDS                                        *
  3251*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3252*                                                                *
  3253*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3254*                                                                *
  3255*   LOG = YES                                                    *
  3256*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3257******************************************************************
  3258*                   C H A N G E   L O G
  3259*
  3260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3261*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  58
* SOCK03.cbl
  3262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3263* EFFECTIVE    NUMBER
  3264*-----------------------------------------------------------------
  3265* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3266* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3267* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3268* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3269* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3270* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3271* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3272* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3273* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3274* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3275* 091318  CR2018073000001  PEMA  ADD Refund methods
  3276* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3277******************************************************************
  3278
  3279 01  CERTIFICATE-TRAILERS.
  3280     12  CS-RECORD-ID                      PIC XX.
  3281         88  VALID-CS-ID                      VALUE 'CS'.
  3282
  3283     12  CS-CONTROL-PRIMARY.
  3284         16  CS-COMPANY-CD                 PIC X.
  3285         16  CS-CARRIER                    PIC X.
  3286         16  CS-GROUPING                   PIC X(6).
  3287         16  CS-STATE                      PIC XX.
  3288         16  CS-ACCOUNT                    PIC X(10).
  3289         16  CS-CERT-EFF-DT                PIC XX.
  3290         16  CS-CERT-NO.
  3291             20  CS-CERT-PRIME             PIC X(10).
  3292             20  CS-CERT-SFX               PIC X.
  3293         16  CS-TRAILER-TYPE               PIC X.
  3294             88  COMM-TRLR           VALUE 'A'.
  3295             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3296             88  CERT-DATA-TRLR      VALUE 'C'.
  3297
  3298     12  CS-DATA-AREA                      PIC X(516).
  3299
  3300     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3301         16  CS-BANK-COMMISSION-AREA.
  3302             20  CS-BANK-COMMS       OCCURS 10.
  3303                 24  CS-AGT                PIC X(10).
  3304                 24  CS-COM-TYP            PIC X.
  3305                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3306                 24  CS-RECALC-LV-INDIC    PIC X.
  3307                 24  FILLER                PIC X(10).
  3308         16  FILLER                        PIC X(256).
  3309
  3310     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3311****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3312         16  CS-MB-CLAIM-DATA OCCURS 24.
  3313             20  CS-CLAIM-NO               PIC X(7).
  3314             20  CS-CLAIM-TYPE             PIC X.
  3315                 88  CS-AH-CLM               VALUE 'A'.
  3316                 88  CS-IU-CLM               VALUE 'I'.
  3317                 88  CS-GP-CLM               VALUE 'G'.
  3318                 88  CS-LF-CLM               VALUE 'L'.
  3319                 88  CS-PR-CLM               VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  59
* SOCK03.cbl
  3320                 88  CS-FL-CLM               VALUE 'F'.
  3321                 88  CS-OT-CLM               VALUE 'O'.
  3322             20  CS-INSURED-TYPE           PIC X.
  3323                 88  CS-PRIM-INSURED          VALUE 'P'.
  3324                 88  CS-CO-BORROWER           VALUE 'C'.
  3325             20  CS-BENEFIT-PERIOD         PIC 99.
  3326             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3327             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3328             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3329         16  FILLER                        PIC X(12).
  3330     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3331         16  CS-VIN-NUMBER                 PIC X(17).
  3332         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3333         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3334         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3335         16  cs-agent-name.
  3336             20  cs-agent-fname            pic x(20).
  3337             20  cs-agent-mi               pic x.
  3338             20  cs-agent-lname            pic x(25).
  3339         16  cs-license-no                 pic x(15).
  3340         16  cs-npn-number                 pic x(10).
  3341         16  cs-agent-edit-status          pic x.
  3342             88  cs-ae-refer-to-manager      value 'M'.
  3343             88  cs-ae-cover-sheet           value 'C'.
  3344             88  cs-ae-sig-form              value 'S'.
  3345             88  cs-ae-verified              value 'V'.
  3346             88  cs-unidentified-signature   value 'U'.
  3347             88  cs-cert-returned            value 'R'.
  3348             88  cs-accept-no-commission     value 'N'.
  3349         16  cs-year                       pic 9999.
  3350         16  cs-make                       pic x(20).
  3351         16  cs-model                      pic x(20).
  3352         16  cs-future                     pic x(20).
  3353         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3354         16  cs-claim-verification-status  pic x.
  3355             88  cs-clm-ver-eligible         value 'A'.
  3356             88  cs-clm-ver-partial-elig     value 'B'.
  3357             88  cs-clm-ver-not-eligible     value 'C'.
  3358             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3359             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3360             88  cs-clm-ver-ND-CERT          value 'F'.
  3361             88  cs-clm-ver-spec-other       value 'G'.
  3362             88  cs-clam-ver-pratial-corrected
  3363                                             value 'H'.
  3364             88  cs-clm-ver-no-matches       value 'I'.
  3365             88  cs-clm-ver-not-elig-corrected
  3366                                             value 'J'.
  3367             88  cs-clm-ver-needs-review     value 'R'.
  3368             88  cs-clm-ver-sent-to-claims   value 'W'.
  3369         16  CS-LF-REFUND-METHOD           PIC X.
  3370         16  CS-AH-REFUND-METHOD           PIC X.
  3371         16  FILLER                        PIC X(353). *> was 420
  3372*        16  FILLER                        PIC X(496).
  3373*                                 COPY ELCDATE.
  3374******************************************************************
  3375*                                                                *
  3376*                                                                *
  3377*                            ELCDATE.                            *
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  60
* SOCK03.cbl
  3378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3379*                            VMOD=2.003
  3380*                                                                *
  3381*                                                                *
  3382*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3383*                 LENGTH = 200                                   *
  3384******************************************************************
  3385
  3386 01  DATE-CONVERSION-DATA.
  3387     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3388     12  DC-OPTION-CODE                PIC X.
  3389         88  BIN-TO-GREG                VALUE ' '.
  3390         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3391         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3392         88  YMD-GREG-TO-BIN            VALUE '3'.
  3393         88  MDY-GREG-TO-BIN            VALUE '4'.
  3394         88  JULIAN-TO-BIN              VALUE '5'.
  3395         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3396         88  FIND-CENTURY               VALUE '7'.
  3397         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3398         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3399         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3400         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3401         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3402         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3403         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3404         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3405         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3406         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3407         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3408         88  BIN-3-TO-GREG              VALUE 'I'.
  3409         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3410         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3411         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3412         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3413         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3414         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3415         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3416         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3417         88  THREE-CHARACTER-BIN
  3418                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3419         88  GREGORIAN-TO-BIN
  3420                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3421         88  BIN-TO-GREGORIAN
  3422                  VALUES ' ' '1' 'I' '8' 'G'.
  3423         88  JULIAN-TO-BINARY
  3424                  VALUES '5' 'C' 'E' 'F'.
  3425     12  DC-ERROR-CODE                 PIC X.
  3426         88  NO-CONVERSION-ERROR        VALUE ' '.
  3427         88  DATE-CONVERSION-ERROR
  3428                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3429         88  DATE-IS-ZERO               VALUE '1'.
  3430         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3431         88  DATE-IS-INVALID            VALUE '3'.
  3432         88  DATE1-GREATER-DATE2        VALUE '4'.
  3433         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3434         88  DATE-INVALID-OPTION        VALUE '9'.
  3435         88  INVALID-CENTURY            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  61
* SOCK03.cbl
  3436         88  ONLY-CENTURY               VALUE 'B'.
  3437         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3438         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3439     12  DC-END-OF-MONTH               PIC X.
  3440         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3441     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3442         88  USE-NORMAL-PROCESS         VALUE ' '.
  3443         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3444         88  ADJUST-UP-100-YRS          VALUE '2'.
  3445     12  FILLER                        PIC X.
  3446     12  DC-CONVERSION-DATES.
  3447         16  DC-BIN-DATE-1             PIC XX.
  3448         16  DC-BIN-DATE-2             PIC XX.
  3449         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3450         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3451                       DC-GREG-DATE-1-EDIT.
  3452             20  DC-EDIT1-MONTH        PIC 99.
  3453             20  SLASH1-1              PIC X.
  3454             20  DC-EDIT1-DAY          PIC 99.
  3455             20  SLASH1-2              PIC X.
  3456             20  DC-EDIT1-YEAR         PIC 99.
  3457         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3458         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3459                     DC-GREG-DATE-2-EDIT.
  3460             20  DC-EDIT2-MONTH        PIC 99.
  3461             20  SLASH2-1              PIC X.
  3462             20  DC-EDIT2-DAY          PIC 99.
  3463             20  SLASH2-2              PIC X.
  3464             20  DC-EDIT2-YEAR         PIC 99.
  3465         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3466         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3467                     DC-GREG-DATE-1-YMD.
  3468             20  DC-YMD-YEAR           PIC 99.
  3469             20  DC-YMD-MONTH          PIC 99.
  3470             20  DC-YMD-DAY            PIC 99.
  3471         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3472         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3473                      DC-GREG-DATE-1-MDY.
  3474             20  DC-MDY-MONTH          PIC 99.
  3475             20  DC-MDY-DAY            PIC 99.
  3476             20  DC-MDY-YEAR           PIC 99.
  3477         16  DC-GREG-DATE-1-ALPHA.
  3478             20  DC-ALPHA-MONTH        PIC X(10).
  3479             20  DC-ALPHA-DAY          PIC 99.
  3480             20  FILLER                PIC XX.
  3481             20  DC-ALPHA-CENTURY.
  3482                 24 DC-ALPHA-CEN-N     PIC 99.
  3483             20  DC-ALPHA-YEAR         PIC 99.
  3484         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3485         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3486         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3487         16  DC-JULIAN-DATE            PIC 9(05).
  3488         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3489                                       PIC 9(05).
  3490         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3491             20  DC-JULIAN-YEAR        PIC 99.
  3492             20  DC-JULIAN-DAYS        PIC 999.
  3493         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  62
* SOCK03.cbl
  3494         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3495         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3496     12  DATE-CONVERSION-VARIBLES.
  3497         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3498         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3499             20  FILLER                PIC 9(3).
  3500             20  HOLD-CEN-1-CCYY.
  3501                 24  HOLD-CEN-1-CC     PIC 99.
  3502                 24  HOLD-CEN-1-YY     PIC 99.
  3503             20  HOLD-CEN-1-MO         PIC 99.
  3504             20  HOLD-CEN-1-DA         PIC 99.
  3505         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3506             20  HOLD-CEN-1-R-MO       PIC 99.
  3507             20  HOLD-CEN-1-R-DA       PIC 99.
  3508             20  HOLD-CEN-1-R-CCYY.
  3509                 24  HOLD-CEN-1-R-CC   PIC 99.
  3510                 24  HOLD-CEN-1-R-YY   PIC 99.
  3511             20  FILLER                PIC 9(3).
  3512         16  HOLD-CENTURY-1-X.
  3513             20  FILLER                PIC X(3)  VALUE SPACES.
  3514             20  HOLD-CEN-1-X-CCYY.
  3515                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3516                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3517             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3518             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3519         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3520             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3521             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3522             20  HOLD-CEN-1-R-X-CCYY.
  3523                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3524                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3525             20  FILLER                PIC XXX.
  3526         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3527         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3528         16  DC-JULIAN-DATE-1          PIC 9(07).
  3529         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3530             20  DC-JULIAN-1-CCYY.
  3531                 24  DC-JULIAN-1-CC    PIC 99.
  3532                 24  DC-JULIAN-1-YR    PIC 99.
  3533             20  DC-JULIAN-DA-1        PIC 999.
  3534         16  DC-JULIAN-DATE-2          PIC 9(07).
  3535         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3536             20  DC-JULIAN-2-CCYY.
  3537                 24  DC-JULIAN-2-CC    PIC 99.
  3538                 24  DC-JULIAN-2-YR    PIC 99.
  3539             20  DC-JULIAN-DA-2        PIC 999.
  3540         16  DC-GREG-DATE-A-EDIT.
  3541             20  DC-EDITA-MONTH        PIC 99.
  3542             20  SLASHA-1              PIC X VALUE '/'.
  3543             20  DC-EDITA-DAY          PIC 99.
  3544             20  SLASHA-2              PIC X VALUE '/'.
  3545             20  DC-EDITA-CCYY.
  3546                 24  DC-EDITA-CENT     PIC 99.
  3547                 24  DC-EDITA-YEAR     PIC 99.
  3548         16  DC-GREG-DATE-B-EDIT.
  3549             20  DC-EDITB-MONTH        PIC 99.
  3550             20  SLASHB-1              PIC X VALUE '/'.
  3551             20  DC-EDITB-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  63
* SOCK03.cbl
  3552             20  SLASHB-2              PIC X VALUE '/'.
  3553             20  DC-EDITB-CCYY.
  3554                 24  DC-EDITB-CENT     PIC 99.
  3555                 24  DC-EDITB-YEAR     PIC 99.
  3556         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3557         16  DC-GREG-DATE-CYMD-R REDEFINES
  3558                              DC-GREG-DATE-CYMD.
  3559             20  DC-CYMD-CEN           PIC 99.
  3560             20  DC-CYMD-YEAR          PIC 99.
  3561             20  DC-CYMD-MONTH         PIC 99.
  3562             20  DC-CYMD-DAY           PIC 99.
  3563         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3564         16  DC-GREG-DATE-MDCY-R REDEFINES
  3565                              DC-GREG-DATE-MDCY.
  3566             20  DC-MDCY-MONTH         PIC 99.
  3567             20  DC-MDCY-DAY           PIC 99.
  3568             20  DC-MDCY-CEN           PIC 99.
  3569             20  DC-MDCY-YEAR          PIC 99.
  3570    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3571        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3572    12  DC-EL310-DATE                  PIC X(21).
  3573    12  FILLER                         PIC X(28).
  3574*                                 COPY ELCCALC.
  3575******************************************************************
  3576*                                                                *
  3577*                           ELCCALC.                            *
  3578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3579*                            VMOD=2.025                          *
  3580*                                                                *
  3581*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3582*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3583*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3584*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3585*                                                                *
  3586*  PASSED TO ELRTRM                                              *
  3587*  -----------------                                             *
  3588*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3589*  ORIGINAL TERM                                                 *
  3590*  BEGINNING DATE                                                *
  3591*  ENDING DATE                                                   *
  3592*  COMPANY I.D.                                                  *
  3593*  ACCOUNT MASTER USER FIELD                                     *
  3594*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3595*  FREE LOOK DAYS                                                *
  3596*                                                                *
  3597*  RETURNED FROM ELRTRM                                          *
  3598*  ---------------------                                         *
  3599*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3600*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3601*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3602*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3603*----------------------------------------------------------------*
  3604*  PASSED TO ELRAMT                                              *
  3605*  ----------------                                              *
  3606*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3607*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3608*  ORIGINAL AMOUNT                                               *
  3609*  ALTERNATE BENEFIT (BALLON)                                    *
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  64
* SOCK03.cbl
  3610*  A.P.R. - NET PAY ONLY                                         *
  3611*  METHOD
  3612*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3613*  COMPANY I.D.                                                  *
  3614*  BENEFIT TYPE                                                  *
  3615*                                                                *
  3616*  RETURNED FROM ELRAMT                                          *
  3617*  --------------------                                          *
  3618*  REMAINING AMOUNT 1 - CURRENT                                  *
  3619*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3620*  REMAINING AMOUNT FACTOR
  3621*----------------------------------------------------------------*
  3622*  PASSED TO ELRESV                                              *
  3623*  -----------------                                             *
  3624*  CERTIFICATE EFFECTIVE DATE                                    *
  3625*  VALUATION DATE                                                *
  3626*  PAID THRU DATE                                                *
  3627*  BENEFIT                                                       *
  3628*  INCURRED DATE                                                 *
  3629*  REPORTED DATE                                                 *
  3630*  ISSUE AGE                                                     *
  3631*  TERM                                                          *
  3632*  CDT PERCENT                                                   *
  3633*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3634* *CLAIM TYPE (LIFE, A/H)                                        *
  3635* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3636* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3637*                                                                *
  3638*  RETURNED FROM ELRESV                                          *
  3639*  --------------------                                          *
  3640*  CDT TABLE USED                                                *
  3641*  CDT FACTOR USED                                               *
  3642*  PAY TO CURRENT RESERVE                                        *
  3643*  I.B.N.R. - A/H ONLY                                           *
  3644*  FUTURE (ACCRUED) AH ONLY                                      *
  3645*----------------------------------------------------------------*
  3646*  PASSED TO ELRATE                                              *
  3647*  ----------------                                              *
  3648*  CERT ISSUE DATE                                               *
  3649*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3650*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3651*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3652*  STATE CODE (CLIENT DEFINED)                                   *
  3653*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3654*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3655*  DEVIATION CODE                                                *
  3656*  ISSUE AGE                                                     *
  3657*  ORIGINAL BENEFIT AMOUNT                                       *
  3658*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3659*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3660*  BENEFIT KIND (LIFE OR A/H)                                    *
  3661*  A.P.R.                                                        *
  3662*  METHOD
  3663*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3664*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3665*  COMPANY I.D. (3 CHARACTER)                                    *
  3666*  BENEFIT CODE                                                  *
  3667*  BENEFIT OVERRIDE CODE                                         *
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  65
* SOCK03.cbl
  3668*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3669*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3670*  JOINT INDICATOR (CSL ONLY)                                    *
  3671*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3672*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3673*                                                                *
  3674*  RETURNED FROM ELRATE                                          *
  3675*  --------------------                                          *
  3676*  CALCULATED PREMIUM                                            *
  3677*  PREMIUM RATE                                                  *
  3678*  MORTALITY CODE                                                *
  3679*  MAX ATTAINED AGE                                              *
  3680*  MAX AGE                                                       *
  3681*  MAX TERM                                                      *
  3682*  MAX MONTHLY BENEFIT                                           *
  3683*  MAX TOTAL BENIFIT                                             *
  3684*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3685*----------------------------------------------------------------*
  3686*  PASSED TO ELRFND                                              *
  3687*  ----------------                                              *
  3688*  CERT ISSUE DATE                                               *
  3689*  REFUND DATE                                                   *
  3690*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3691*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3692*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3693*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3694*  STATE CODE (CLIENT DEFINED)                                   *
  3695*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3696*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3697*  DEVIATION CODE                                                *
  3698*  ISSUE AGE                                                     *
  3699*  ORIGINAL BENEFIT AMOUNT                                       *
  3700*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3701*  PROCESS TYPE (CANCEL)                                         *
  3702*  BENEFIT KIND (LIFE OR A/H)                                    *
  3703*  A.P.R.                                                        *
  3704*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3705*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3706*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3707*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3708*  COMPANY I.D. (3 CHARACTER)                                    *
  3709*  BENEFIT CODE                                                  *
  3710*  BENEFIT OVERRIDE CODE                                         *
  3711*                                                                *
  3712*  RETURNED FROM ELRFND                                          *
  3713*  --------------------                                          *
  3714*  CALCULATED REFUND                                             *
  3715*----------------------------------------------------------------*
  3716*  PASSED TO ELEARN                                              *
  3717*  ----------------                                              *
  3718*  CERT ISSUE DATE                                               *
  3719*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3720*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3721*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3722*  STATE CODE (CLIENT DEFINED)                                   *
  3723*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3724*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3725*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  66
* SOCK03.cbl
  3726*  ISSUE AGE                                                     *
  3727*  ORIGINAL BENEFIT AMOUNT                                       *
  3728*  BENEFIT KIND (LIFE OR A/H)                                    *
  3729*  A.P.R.                                                        *
  3730*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3731*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3732*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3733*  COMPANY I.D. (3 CHARACTER)                                    *
  3734*  BENEFIT CODE                                                  *
  3735*  BENEFIT OVERRIDE CODE                                         *
  3736*                                                                *
  3737*  RETURNED FROM ELEARN                                          *
  3738*  --------------------                                          *
  3739*  INDICATED  EARNINGS                                           *
  3740*----------------------------------------------------------------*
  3741*                 LENGTH = 450                                   *
  3742*                                                                *
  3743******************************************************************
  3744******************************************************************
  3745*                   C H A N G E   L O G
  3746*
  3747* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3748*-----------------------------------------------------------------
  3749*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3750* EFFECTIVE    NUMBER
  3751*-----------------------------------------------------------------
  3752* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3753* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3754* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3755* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3756* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3757* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3758* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3759* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3760* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3761* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3762* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3763******************************************************************
  3764
  3765 01  CALCULATION-PASS-AREA.
  3766     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3767                                     COMP.
  3768
  3769     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3770       88  NO-CP-ERROR                             VALUE ZERO.
  3771       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3772                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3773       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3774       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3775       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3776       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3777       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3778       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3779       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3780       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3781       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3782       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3783       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  67
* SOCK03.cbl
  3784       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3785       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3786       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3787       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3788       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3789       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3790
  3791     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3792       88  NO-CP-ERROR-2                           VALUE ZERO.
  3793***********************  INPUT AREAS ****************************
  3794
  3795     12  CP-CALCULATION-AREA.
  3796         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3797         16  CP-CERT-EFF-DT        PIC XX.
  3798         16  CP-VALUATION-DT       PIC XX.
  3799         16  CP-PAID-THRU-DT       PIC XX.
  3800         16  CP-BENEFIT-TYPE       PIC X.
  3801           88  CP-AH                               VALUE 'A' 'D'
  3802                                                   'I' 'U'.
  3803           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3804           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3805         16  CP-INCURRED-DT        PIC XX.
  3806         16  CP-REPORTED-DT        PIC XX.
  3807         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3808         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3809         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-CDT-METHOD         PIC X.
  3814           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3815           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3816           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3817         16  CP-CLAIM-TYPE         PIC X.
  3818           88  CP-AH-CLAIM                         VALUE 'A'.
  3819           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3820         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-REM-TERM-METHOD    PIC X.
  3835           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3836           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3837           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3838           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3839           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3840           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3841           88  CP-EARN-AFTER-16TH                  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  68
* SOCK03.cbl
  3842         16  CP-EARNING-METHOD     PIC X.
  3843           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3844           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3845           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3846           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3847           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3848           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3849           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3850           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3851           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3852           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3853           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3854           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3855           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3856           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3857         16  CP-PROCESS-TYPE       PIC X.
  3858           88  CP-CLAIM                            VALUE '1'.
  3859           88  CP-CANCEL                           VALUE '2'.
  3860           88  CP-ISSUE                            VALUE '3'.
  3861         16  CP-SPECIAL-CALC-CD    PIC X.
  3862           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3863           88  CP-1-MTH-INTEREST               VALUE ' '.
  3864           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3865           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3866           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3867           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3868           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3869           88  CP-FARM-PLAN                    VALUE 'F'.
  3870           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3871           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3872           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3873           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3874           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3875           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3876           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3877           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3878           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3879           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3880                                                     'W' 'X'.
  3881           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3882           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3883           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3884           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3885           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3886           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3887           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3888           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3889           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3890           88  CP-CSL-METH-1                   VALUE '5'.
  3891           88  CP-CSL-METH-2                   VALUE '6'.
  3892           88  CP-CSL-METH-3                   VALUE '7'.
  3893           88  CP-CSL-METH-4                   VALUE '8'.
  3894
  3895         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3896                                     COMP-3.
  3897         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3898         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3899         16  CP-STATE              PIC XX          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  69
* SOCK03.cbl
  3900         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3901         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3902           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3903               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3904         16  CP-R78-OPTION         PIC X.
  3905           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3906           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3907
  3908         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3909         16  CP-IBNR-RESERVE-SW    PIC X.
  3910         16  CP-CLAIM-STATUS       PIC X.
  3911         16  CP-RATE-FILE          PIC X.
  3912         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3913                                     COMP-3.
  3914
  3915         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3916         16  CP-AH-OVERRIDE-CODE   PIC X.
  3917
  3918         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3921                                   PIC S9(5)V99 COMP-3.
  3922         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3923                                     COMP-3.
  3924         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3925                                     COMP-3.
  3926         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3927                                     COMP-3.
  3928         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3929                                  PIC S9(7)V99 COMP-3.
  3930
  3931         16  CP-PAID-FROM-DATE     PIC X(02).
  3932         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3933         16  CP-EXT-DAYS-CALC      PIC X.
  3934           88  CP-EXT-NO-CHG                   VALUE ' '.
  3935           88  CP-EXT-CHG-LF                   VALUE '1'.
  3936           88  CP-EXT-CHG-AH                   VALUE '2'.
  3937           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3938         16  CP-DOMICILE-STATE     PIC XX.
  3939         16  CP-CARRIER            PIC X.
  3940         16  CP-REIN-FLAG          PIC X.
  3941         16  CP-REM-TRM-CALC-OPTION PIC X.
  3942           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3943                      '2' '3' '4' '5'.
  3944           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3945           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3946           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3947           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3948           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3949           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3950           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3951           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3952         16  CP-SIG-SWITCH         PIC X.
  3953         16  CP-RATING-METHOD      PIC X.
  3954           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3955           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3956           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3957           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  70
* SOCK03.cbl
  3958           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3959           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3960           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3961           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3962           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3963         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3964                                     COMP-3.
  3965         16  CP-BEN-CATEGORY       PIC X.
  3966         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3967         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3968                                   PIC S99V9(5) COMP-3.
  3969         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3970         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3971                                   PIC S99V9(5) COMP-3.
  3972         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3973         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3974         16  CP-EXPIRE-DT          PIC XX.
  3975         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3976         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3977         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3978         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3979         16  CP-DDF-SPEC-CALC      PIC X.
  3980             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3981             88  CP-CALC-CLP              VALUE 'C'.
  3982         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3983         16  CP-CANCEL-REASON      PIC X.
  3984         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3985         16  CP-PMT-MODE           PIC X.
  3986         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3987         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3988         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3989         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3990         16  FILLER                PIC X.
  3991
  3992***************    OUTPUT FROM ELRESV   ************************
  3993
  3994         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3995
  3996         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3997                                     COMP-3.
  3998         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3999                                     COMP-3.
  4000         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  4001                                     COMP-3.
  4002         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  4003                                     COMP-3.
  4004         16  FILLER                PIC X(09).
  4005***************    OUTPUT FROM ELRTRM   *************************
  4006
  4007         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  4008                                     COMP-3.
  4009         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  4010                                     COMP-3.
  4011         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  4012                                     COMP-3.
  4013         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  4014                                     COMP-3.
  4015         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  71
* SOCK03.cbl
  4016
  4017***************    OUTPUT FROM ELRAMT   *************************
  4018
  4019         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  4020                                     COMP-3.
  4021         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  4022                                     COMP-3.
  4023         16  FILLER                PIC X(12).
  4024
  4025***************    OUTPUT FROM ELRATE   *************************
  4026
  4027         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  4028                                     COMP-3.
  4029         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  4030                                     COMP-3.
  4031         16  CP-MORTALITY-CODE     PIC X(4).
  4032         16  CP-RATE-EDIT-FLAG     PIC X.
  4033             88  CP-RATES-NEED-APR                  VALUE '1'.
  4034         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  4035                                     COMP-3.
  4036         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  4037         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4038         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  4039                                   PIC S9(7)V99 COMP-3.
  4040         16  FILLER                PIC X(07).
  4041
  4042***************    OUTPUT FROM ELRFND   *************************
  4043
  4044         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  4045                                     COMP-3.
  4046         16  CP-REFUND-TYPE-USED   PIC X.
  4047           88  CP-R-AS-R78                         VALUE '1'.
  4048           88  CP-R-AS-PRORATA                     VALUE '2'.
  4049           88  CP-R-AS-CALIF                       VALUE '3'.
  4050           88  CP-R-AS-TEXAS                       VALUE '4'.
  4051           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4052           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4053           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  4054           88  CP-R-AS-MEAN                        VALUE '8'.
  4055           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4056           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4057           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4058           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4059           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4060           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4061         16  FILLER                PIC X(12).
  4062
  4063***************    OUTPUT FROM ELEARN   *************************
  4064
  4065         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4066                                     COMP-3.
  4067         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4068                                     COMP-3.
  4069         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4070                                     COMP-3.
  4071         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  4072                                     COMP-3.
  4073         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  72
* SOCK03.cbl
  4074                                     COMP-3.
  4075         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  4076                                     COMP-3.
  4077         16  CP-EARNING-TYPE-USED  PIC X.
  4078           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4079           88  CP-E-AS-R78                         VALUE '1'.
  4080           88  CP-E-AS-PRORATA                     VALUE '2'.
  4081           88  CP-E-AS-TEXAS                       VALUE '4'.
  4082           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4083           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4084           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4085           88  CP-E-AS-MEAN                        VALUE '8'.
  4086           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4087         16  FILLER                PIC X(12).
  4088
  4089***************    OUTPUT FROM ELPMNT   *************************
  4090
  4091         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4092                                     COMP-3.
  4093         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4094                                     COMP-3.
  4095         16  FILLER                PIC X(12).
  4096
  4097***************   MISC WORK AREAS    *****************************
  4098         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4099                                     COMP-3.
  4100         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4101                                     COMP-3.
  4102         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4103                                     COMP-3.
  4104         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4105                                     COMP-3.
  4106         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4107                                     COMP-3.
  4108         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4109                                     COMP-3.
  4110         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4111             88  OPEN-RATE-FILE                   VALUE 'O'.
  4112             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4113             88  IO-ERROR                         VALUE 'E'.
  4114
  4115         16  CP-FIRST-PAY-DATE     PIC XX.
  4116
  4117         16  CP-JOINT-INDICATOR    PIC X.
  4118
  4119         16  CP-RESERVE-REMAINING-TERM
  4120                                   PIC S9(4)V9    VALUE ZERO
  4121                                     COMP-3.
  4122
  4123         16  CP-INSURED-BIRTH-DT   PIC XX.
  4124
  4125         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4126                                     COMP-3.
  4127
  4128         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4129                                     COMP-3.
  4130
  4131         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  73
* SOCK03.cbl
  4132                                     COMP-3.
  4133
  4134         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4135                                     COMP-3.
  4136
  4137         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4138                                     COMP-3.
  4139
  4140         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4141                                     COMP-3.
  4142
  4143         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4144                                     COMP-3.
  4145
  4146         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4147             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4148
  4149         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4150                                     COMP-3.
  4151         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4152                                     COMP-3.
  4153         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4154         16  cp-extra-periods      pic 9 value zeros.
  4155         16  cp-net-only-state     pic x value spaces.
  4156         16  FILLER                PIC X(13).
  4157******************************************************************
  4158****************************************************************
  4159*
  4160* Copyright (c) 2007-2013 Dell Inc.
  4161* All rights reserved.
  4162*
  4163****************************************************************
  4164 01  DFHEIV.
  4165   02  DFHEIV0               PIC X(35).
  4166   02  DFHEIV1               PIC X(08).
  4167   02  DFHEIV2               PIC X(08).
  4168   02  DFHEIV3               PIC X(08).
  4169   02  DFHEIV4               PIC X(06).
  4170   02  DFHEIV5               PIC X(04).
  4171   02  DFHEIV6               PIC X(04).
  4172   02  DFHEIV7               PIC X(02).
  4173   02  DFHEIV8               PIC X(02).
  4174   02  DFHEIV9               PIC X(01).
  4175   02  DFHEIV10              PIC S9(7) COMP-3.
  4176   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4177   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4178   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4179   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4180   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4181   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4182   02  DFHEIV17              PIC X(04).
  4183   02  DFHEIV18              PIC X(04).
  4184   02  DFHEIV19              PIC X(04).
  4185   02  DFHEIV20              USAGE IS POINTER.
  4186   02  DFHEIV21              USAGE IS POINTER.
  4187   02  DFHEIV22              USAGE IS POINTER.
  4188   02  DFHEIV23              USAGE IS POINTER.
  4189   02  DFHEIV24              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  74
* SOCK03.cbl
  4190   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4191   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4192   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4193   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4194   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4195   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4196   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4197   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4198   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4199   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4200   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4201   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4202   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4203   02  FILLER                PIC X(02).
  4204   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4205   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4206   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4207   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4208   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4209   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4210   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4211 LINKAGE  SECTION.
  4212*****************************************************************
  4213*                                                               *
  4214* Copyright (c) 2007-2013 Dell Inc.                             *
  4215* All rights reserved.                                          *
  4216*                                                               *
  4217*****************************************************************
  4218 01  dfheiblk.
  4219     02  eibtime          pic s9(7) comp-3.
  4220     02  eibdate          pic s9(7) comp-3.
  4221     02  eibtrnid         pic x(4).
  4222     02  eibtaskn         pic s9(7) comp-3.
  4223     02  eibtrmid         pic x(4).
  4224     02  dfheigdi         pic s9(4) comp.
  4225     02  eibcposn         pic s9(4) comp.
  4226     02  eibcalen         pic s9(4) comp.
  4227     02  eibaid           pic x(1).
  4228     02  eibfiller1       pic x(1).
  4229     02  eibfn            pic x(2).
  4230     02  eibfiller2       pic x(2).
  4231     02  eibrcode         pic x(6).
  4232     02  eibfiller3       pic x(2).
  4233     02  eibds            pic x(8).
  4234     02  eibreqid         pic x(8).
  4235     02  eibrsrce         pic x(8).
  4236     02  eibsync          pic x(1).
  4237     02  eibfree          pic x(1).
  4238     02  eibrecv          pic x(1).
  4239     02  eibsend          pic x(1).
  4240     02  eibatt           pic x(1).
  4241     02  eibeoc           pic x(1).
  4242     02  eibfmh           pic x(1).
  4243     02  eibcompl         pic x(1).
  4244     02  eibsig           pic x(1).
  4245     02  eibconf          pic x(1).
  4246     02  eiberr           pic x(1).
  4247     02  eibrldbk         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  75
* SOCK03.cbl
  4248     02  eiberrcd         pic x(4).
  4249     02  eibsynrb         pic x(1).
  4250     02  eibnodat         pic x(1).
  4251     02  eibfiller5       pic x(2).
  4252     02  eibresp          pic s9(8) comp.
  4253     02  eibresp2         pic s9(8) comp.
  4254     02  dfheigdj         pic s9(4) comp.
  4255     02  dfheigdk         pic s9(4) comp.
  4256 01  DFHCOMMAREA.
  4257   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  4258   05 LSTN-NAME                PIC X(8).
  4259   05 LSTN-SUBNAME             PIC X(8).
  4260   05 CLIENT-IN-DATA.
  4261      15  CLIENT-CAR           PIC X.
  4262      15  CLIENT-GRP           PIC X(6).
  4263      15  CLIENT-STATE         PIC XX.
  4264      15  CLIENT-ACCOUNT       PIC X(10).
  4265*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  4266      15  CLIENT-EFF-DT        PIC X(8).
  4267      15  CLIENT-CERT-NO       PIC X(11).
  4268      15  CLIENT-LAST-NAME     PIC X(15).
  4269      15  CLIENT-FIRST-NAME    PIC X(10).
  4270      15  CLIENT-VAL-DT        PIC X(8).
  4271      15  CLIENT-CAN-REASON    PIC X.
  4272   05 SOCKADDR-IN-PARM.
  4273     15 SIN-FAMILY             PIC 9(4) COMP.
  4274     15 SIN-PORT               PIC 9(4) COMP.
  4275     15 SIN-ADDRESS            PIC 9(8) COMP.
  4276     15 SIN-ZERO               PIC X(8).
  4277 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4278 0000-DFHEXIT SECTION.
  4279     MOVE '9#                    $   ' TO DFHEIV0.
  4280     MOVE 'SOCK03' TO DFHEIV1.
  4281     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4282     display '  BEGIN SOCK03 '
  4283     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  4284     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  4285     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  4286        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  4287        evaluate true
  4288           when client-in-data (8:3) = 'AHL'
  4289              MOVE X'06'         TO WS-COMP-CD
  4290              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  4291                                    WS-COMP-ID
  4292           when CLIENT-IN-DATA (8:3) = 'DCC'
  4293              MOVE X'05'         TO WS-COMP-CD
  4294              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  4295                                    WS-COMP-ID
  4296           when CLIENT-IN-DATA (8:3) = 'VPP'
  4297              MOVE X'07'         TO WS-COMP-CD
  4298              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  4299                                    WS-COMP-ID
  4300           when other
  4301              MOVE X'04'         TO WS-COMP-CD
  4302              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  4303                                    WS-COMP-ID
  4304        end-evaluate
  4305        move 'CSO'               to ws-send-buf (1:3)
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  76
* SOCK03.cbl
  4306        move +25                 to ws-send-msg-size
  4307     END-IF
  4308     display 'SOCK03:sequence number  =', ws-seq-num.
  4309     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  4310     call "send" using by value GIVE-TAKE-SOCKET,
  4311         by reference ws-send-buf,
  4312         by value ws-send-msg-size,
  4313         by value ws-flags.
  4314     if return-code <= zero
  4315         display 'SOCK03:send error ',
  4316         go to socket-error.
  4317     move low-values to ws-recv-buf.
  4318     set ws-recv-total to zero.
  4319     compute ws-recv-left = ws-recv-msg-size.
  4320     display 'SOCK03:About to recv '
  4321     call "recv" using by value GIVE-TAKE-SOCKET,
  4322         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4323         by value ws-recv-left,
  4324         by value ws-flags.
  4325     if return-code < zero
  4326        display 'SOCK03:recv error ',
  4327        go to socket-error.
  4328     if return-code = zero
  4329        display 'SOCK03:client disconnected',
  4330        go to socket-error.
  4331*
  4332     display 'SOCK03:Good recv  '
  4333     display 'SOCK03:return code      = ', return-code
  4334     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  4335     move +4096                  to ws-send-msg-size
  4336*    move +750                   to ws-send-msg-size
  4337     move ws-recv-buf (1:72)     to client-in-data
  4338     MOVE SPACES                 TO WS-ELCERT-SW
  4339     MOVE X'0A'                  TO WS-HEX-0A
  4340     if client-account = 'EPIQ000001'
  4341        set ws-epiq-request to true
  4342        move spaces              to client-account
  4343     end-if
  4344     move +0 to ws-epiq-max
  4345     EVALUATE TRUE
  4346        WHEN (CLIENT-CAR NOT = SPACES)
  4347           AND (CLIENT-STATE NOT = SPACES)
  4348           AND (CLIENT-ACCOUNT NOT = SPACES)
  4349           AND (CLIENT-EFF-DT NOT = SPACES)
  4350           AND (CLIENT-CERT-NO NOT = SPACES)
  4351           SET WS-ELCERT-FULL    TO TRUE
  4352           DISPLAY ' SETTING FULL '
  4353        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4354           SET WS-ELCERT-CERT-NO TO TRUE
  4355           DISPLAY ' SETTING CERT NO '
  4356*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4357*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4358        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4359           AND (CLIENT-LAST-NAME NOT = SPACES)
  4360           SET WS-ELCERT-ACT-NAME TO TRUE
  4361        WHEN CLIENT-LAST-NAME NOT = SPACES
  4362           SET WS-ELCERT-NAME    TO TRUE
  4363           DISPLAY ' SETTING NAME '
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  77
* SOCK03.cbl
  4364        WHEN OTHER
  4365           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4366           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4367           MOVE ZEROS            TO WS-RESP
  4368           PERFORM 0030-BUILD-BUFFER
  4369                                 THRU 0030-EXIT
  4370           PERFORM 0020-SEND-BUFFER
  4371                                 THRU 0020-EXIT
  4372           PERFORM 0025-CLOSE-SOCKET
  4373                                 THRU 0025-EXIT
  4374           GO TO 0010-RETURN
  4375     END-EVALUATE
  4376     IF CLIENT-CAN-REASON = 'R'
  4377        MOVE 'R'                 TO WS-CANCEL-REASON
  4378     ELSE
  4379        MOVE ' '                 TO WS-CANCEL-REASON
  4380     END-IF
  4381     IF WS-ELCERT-KEY-SW NOT = SPACES
  4382        PERFORM 0050-BEGIN-REFUND-PROCESS
  4383                                 THRU 0050-EXIT
  4384     END-IF
  4385     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4386     .
  4387 0010-RETURN.
  4388
  4389* exec cics return end-exec.
  4390*    MOVE '.(                    ''   #00004384' TO DFHEIV0
  4391     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4392     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4393     MOVE X'2020233030303034333834' TO DFHEIV0(25:11)
  4394     CALL 'kxdfhei1' USING DFHEIV0,
  4395           DFHEIV99,
  4396           DFHEIV99,
  4397           DFHEIV99,
  4398           DFHEIV99,
  4399           DFHEIV99,
  4400           DFHEIV99
  4401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4402
  4403
  4404* goback.
  4405     MOVE '9%                    "   ' TO DFHEIV0
  4406     MOVE 'SOCK03' TO DFHEIV1
  4407     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4408     goback.
  4409*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4410     .
  4411 0020-SEND-BUFFER.
  4412     display 'SOCK03:About to send      '
  4413     display 'SOCK03:sequence number  =', ws-seq-num.
  4414     display 'SOCK03:send buffer      =', ws-send-buf(1:500).
  4415     call "send" using by value GIVE-TAKE-SOCKET,
  4416         by reference ws-send-buf,
  4417         by value ws-send-msg-size,
  4418         by value ws-flags.
  4419     if return-code <= zero
  4420         display 'SOCK03:send error ' return-code,
  4421         go to socket-error.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  78
* SOCK03.cbl
  4422 0020-EXIT.
  4423     EXIT.
  4424 0025-CLOSE-SOCKET.
  4425*    display 'SOCK03:closing socket'.
  4426*    call "close" using by value GIVE-TAKE-SOCKET .
  4427     display 'SOCK03:done'.
  4428     .
  4429 0025-EXIT.
  4430     EXIT.
  4431*
  4432* set up the receive buffer
  4433*
  4434     move low-values to ws-recv-buf.
  4435     set ws-recv-total to zero.
  4436     compute ws-recv-left = ws-recv-msg-size.
  4437*
  4438* receive data
  4439*
  4440 recv-1.
  4441     call "recv" using by value GIVE-TAKE-SOCKET,
  4442         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4443         by value ws-recv-left,
  4444         by value ws-flags.
  4445*
  4446* test what was received and decide what we should do
  4447*
  4448     if return-code < zero
  4449        display 'SOCK03:recv error ',
  4450        go to socket-error.
  4451     if return-code = zero
  4452        display 'SOCK03:client disconnected',
  4453        go to socket-error.
  4454*
  4455* have we received all the data yet?
  4456*
  4457     compute ws-recv-total = ws-recv-total + return-code.
  4458     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4459*
  4460* not yet
  4461*
  4462     if ws-recv-left > 0 go to recv-1.
  4463*
  4464* received all the data
  4465*
  4466     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4467*
  4468* make sure what we received was what we sent
  4469*
  4470*    if ws-recv-buf <> ws-send-buf
  4471*        display "SOCK03:data doesn't match",
  4472*        go to socket-error.
  4473*
  4474* end of pass
  4475*
  4476*loop-end.
  4477*    if ws-seq-num = 5 go to socket-error.
  4478*    go to loop-1.
  4479*
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  79
* SOCK03.cbl
  4480* program end
  4481*
  4482 socket-error.
  4483     if ws-seq-num <> 0
  4484         display "SOCK03:did not complete".
  4485*
  4486* flush the send buffer and deallocate
  4487*
  4488*    display 'SOCK03:closing socket'.
  4489*    call "close" using by value GIVE-TAKE-SOCKET .
  4490*
  4491* finised return to cics
  4492*
  4493 socket-fin.
  4494*    display 'SOCK03:closing socket'.
  4495*    call "close" using by value GIVE-TAKE-SOCKET .
  4496     display 'SOCK03:done'.
  4497
  4498* exec cics return end-exec.
  4499*    MOVE '.(                    ''   #00004474' TO DFHEIV0
  4500     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4501     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4502     MOVE X'2020233030303034343734' TO DFHEIV0(25:11)
  4503     CALL 'kxdfhei1' USING DFHEIV0,
  4504           DFHEIV99,
  4505           DFHEIV99,
  4506           DFHEIV99,
  4507           DFHEIV99,
  4508           DFHEIV99,
  4509           DFHEIV99
  4510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4511
  4512
  4513* goback.
  4514     MOVE '9%                    "   ' TO DFHEIV0
  4515     MOVE 'SOCK03' TO DFHEIV1
  4516     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4517     goback.
  4518 0030-BUILD-BUFFER.
  4519     MOVE SPACES                 TO WS-SEND-BUF
  4520     IF WS-CALL-TYPE = 'NEWBUS'
  4521        STRING
  4522           WS-COMMENT            ';'
  4523           WS-RESP               ';'
  4524           WS-CARRIER            ';'
  4525           WS-GROUPING           ';'
  4526           WS-STATE              ';'
  4527           WS-ACCOUNT            ';'
  4528           WS-CERT-EFF-DATE      ';'
  4529           WS-CERT-NO            ';'
  4530           WS-LAST-NAME          ';'
  4531           WS-FIRST-NAME         ';'
  4532           WS-MID-INIT           ';'
  4533           WS-LAST-JNAME         ';'
  4534           WS-FIRST-JNAME        ';'
  4535           WS-MID-JINIT          ';'
  4536           WS-POST-CARD-SW       ';'
  4537           ws-lf-coverage-type   ';'
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  80
* SOCK03.cbl
  4538           WS-LF-STATUS          ';'
  4539           WS-LF-BEN-CODE        ';'
  4540           WS-LF-BEN-CODE-DESC   ';'
  4541           WS-LF-TERM            ';'
  4542           WS-LF-REM-TERM        ';'
  4543           WS-LF-PREM            ';'
  4544           WS-LF-REFUND          ';'
  4545           WS-LF-METHOD          ';'
  4546           WS-LF-ORIG-BENEFIT    ';'
  4547           WS-LF-REM-BEN         ';'
  4548           WS-LF-EXPIRE-DATE     ';'
  4549           WS-LF-COMM            ';'
  4550           WS-LF-UEC             ';'
  4551           WS-AH-COVERAGE-TYPE   ';'
  4552           WS-AH-STATUS          ';'
  4553           WS-AH-BEN-CODE        ';'
  4554           WS-AH-BEN-CODE-DESC   ';'
  4555           WS-AH-TERM            ';'
  4556           WS-AH-REM-TERM        ';'
  4557           WS-AH-PREM            ';'
  4558           WS-AH-REFUND          ';'
  4559           WS-AH-METHOD          ';'
  4560           WS-AH-ORIG-BENEFIT    ';'
  4561           WS-AH-REM-BEN         ';'
  4562           WS-AH-EXPIRE-DATE     ';'
  4563           WS-AH-COMM            ';'
  4564           WS-AH-UEC             ';'
  4565           WS-ACCOUNT-NAME       ';'
  4566           WS-REPORT-CODE-1      ';'
  4567           WS-REPORT-CODE-2      ';'
  4568           WS-REPORT-CODE-3      ';'
  4569           WS-CLM-PAID-THRU-DT   ';'
  4570           WS-LF-CANCEL-DATE     ';'
  4571           WS-AH-CANCEL-DATE     ';'
  4572           WS-VIN                ';'
  4573           WS-CRED-BENE-NAME     ';'
  4574           WS-HEX-0A
  4575            DELIMITED BY '  ' INTO WS-SEND-BUF
  4576        END-STRING
  4577     ELSE
  4578        STRING
  4579           WS-COMMENT            ';'  *> 0
  4580           WS-RESP               ';'
  4581           WS-CARRIER            ';'
  4582           WS-GROUPING           ';'
  4583           WS-STATE              ';'
  4584           WS-ACCOUNT            ';'
  4585           WS-CERT-EFF-DATE      ';'
  4586           WS-CERT-NO            ';'
  4587           WS-LAST-NAME          ';'
  4588           WS-FIRST-NAME         ';'
  4589           WS-MID-INIT           ';'
  4590           WS-LAST-JNAME         ';'
  4591           WS-FIRST-JNAME        ';'
  4592           WS-MID-JINIT          ';'
  4593           WS-POST-CARD-SW       ';'
  4594           WS-LF-STATUS          ';'
  4595           WS-LF-BEN-CODE        ';'  *> 16
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  81
* SOCK03.cbl
  4596           WS-LF-BEN-CODE-DESC   ';'
  4597           WS-LF-TERM            ';'
  4598           WS-LF-REM-TERM        ';'
  4599           WS-LF-PREM            ';'
  4600           WS-LF-REFUND          ';'
  4601           WS-LF-METHOD          ';'
  4602           WS-LF-ORIG-BENEFIT    ';'
  4603           WS-LF-REM-BEN         ';'
  4604           WS-LF-EXPIRE-DATE     ';'
  4605           WS-LF-COMM            ';'
  4606           WS-LF-UEC             ';'
  4607           WS-AH-STATUS          ';'
  4608           WS-AH-BEN-CODE        ';'   *> 29
  4609           WS-AH-BEN-CODE-DESC   ';'
  4610           WS-AH-TERM            ';'
  4611           WS-AH-REM-TERM        ';'
  4612           WS-AH-PREM            ';'   *> 32
  4613           WS-AH-REFUND          ';'   *> 33
  4614           WS-AH-METHOD          ';'
  4615           WS-AH-ORIG-BENEFIT    ';'   *> 36
  4616           WS-AH-REM-BEN         ';'
  4617           WS-AH-EXPIRE-DATE     ';'
  4618           WS-AH-COMM            ';'
  4619           WS-AH-UEC             ';'
  4620           WS-ACCOUNT-NAME       ';'
  4621           WS-REPORT-CODE-1      ';'
  4622           WS-REPORT-CODE-2      ';'
  4623           WS-REPORT-CODE-3      ';'
  4624           WS-CLM-PAID-THRU-DT   ';'
  4625           WS-LF-CANCEL-DATE     ';'
  4626           WS-AH-CANCEL-DATE     ';'
  4627           WS-VIN                ';'
  4628           WS-CRED-BENE-NAME     ';'
  4629           'E'                   ';'
  4630            DELIMITED BY '  ' INTO WS-SEND-BUF
  4631        END-STRING
  4632     END-IF
  4633     .
  4634 0030-EXIT.
  4635     EXIT.
  4636 0050-BEGIN-REFUND-PROCESS.
  4637     IF WS-ELCERT-ACT-NAME
  4638        PERFORM 0060-FIND-FULL-KEY
  4639                                 THRU 0060-EXIT
  4640        MOVE AM-CARRIER          TO CLIENT-CAR
  4641        MOVE AM-GROUPING         TO CLIENT-GRP
  4642        MOVE AM-STATE            TO CLIENT-STATE
  4643     END-IF
  4644     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4645     IF NOT RESP-NORMAL
  4646        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4647        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4648        MOVE WS-RESPONSE         TO WS-RESP
  4649        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4650        PERFORM 0020-SEND-BUFFER
  4651                                 THRU 0020-EXIT
  4652        PERFORM 0025-CLOSE-SOCKET
  4653                                 THRU 0025-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  82
* SOCK03.cbl
  4654        GO TO 0010-RETURN
  4655     END-IF
  4656     PERFORM 0150-READ-NEXT-ELCERT
  4657                                 THRU 0150-EXIT
  4658*    display ' came back from 0150 ' ws-response
  4659     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4660        DISPLAY ' CERT NOT FOUND '
  4661        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4662        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4663        MOVE WS-RESPONSE         TO WS-RESP
  4664        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4665        PERFORM 0020-SEND-BUFFER
  4666                                 THRU 0020-EXIT
  4667        PERFORM 0025-CLOSE-SOCKET
  4668                                 THRU 0025-EXIT
  4669        GO TO 0010-RETURN
  4670     END-IF
  4671     PERFORM 0200-BEGIN-REFUND-PROCESS
  4672                                 THRU 0200-EXIT UNTIL
  4673        ELCERT-FINISHED
  4674     .
  4675 0050-EXIT.
  4676     EXIT.
  4677 0060-FIND-FULL-KEY.
  4678     MOVE ' ' TO WS-STOP-SW
  4679     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4680     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4681
  4682* EXEC CICS STARTBR
  4683*       DATASET  ('ERACCT3')
  4684*       RIDFLD   (WS-AM3-KEY)
  4685*       GTEQ
  4686*       RESP (WS-RESPONSE)
  4687*    END-EXEC
  4688     MOVE 'ERACCT3' TO DFHEIV1
  4689     MOVE 0
  4690       TO DFHEIV11
  4691*    MOVE '&,         G          &  N#00004639' TO DFHEIV0
  4692     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4693     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4694     MOVE X'204E233030303034363339' TO DFHEIV0(25:11)
  4695     CALL 'kxdfhei1' USING DFHEIV0,
  4696           DFHEIV1,
  4697           WS-AM3-KEY,
  4698           DFHEIV99,
  4699           DFHEIV11,
  4700           DFHEIV99
  4701     MOVE EIBRESP  TO WS-RESPONSE
  4702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4703     IF RESP-NORMAL
  4704        PERFORM UNTIL TOLD-TO-STOP
  4705
  4706* EXEC CICS READNEXT
  4707*             DATASET  ('ERACCT3')
  4708*             INTO     (ACCOUNT-MASTER)
  4709*             RIDFLD   (WS-AM3-KEY)
  4710*          END-EXEC
  4711     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  83
* SOCK03.cbl
  4712      ACCOUNT-MASTER
  4713       TO DFHEIV12
  4714     MOVE 'ERACCT3' TO DFHEIV1
  4715     MOVE 0
  4716       TO DFHEIV11
  4717*    MOVE '&.IL                  )   #00004647' TO DFHEIV0
  4718     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4719     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4720     MOVE X'2020233030303034363437' TO DFHEIV0(25:11)
  4721     CALL 'kxdfhei1' USING DFHEIV0,
  4722           DFHEIV1,
  4723           ACCOUNT-MASTER,
  4724           DFHEIV12,
  4725           WS-AM3-KEY,
  4726           DFHEIV99,
  4727           DFHEIV11,
  4728           DFHEIV99,
  4729           DFHEIV99
  4730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4731           EVALUATE TRUE
  4732              WHEN (RESP-NORMAL)
  4733                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4734                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4735                 SET TOLD-TO-STOP TO TRUE
  4736              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4737                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4738                 CONTINUE
  4739              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4740                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4741                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4742                 MOVE ZEROS      TO WS-RESP
  4743                 PERFORM 0030-BUILD-BUFFER
  4744                                 THRU 0030-EXIT
  4745                 PERFORM 0020-SEND-BUFFER
  4746                                 THRU 0020-EXIT
  4747                 PERFORM 0025-CLOSE-SOCKET
  4748                                 THRU 0025-EXIT
  4749                 GO TO 0010-RETURN
  4750           END-EVALUATE
  4751        END-PERFORM
  4752
  4753* EXEC CICS ENDBR
  4754*          DATASET   ('ERACCT3')
  4755*       END-EXEC
  4756     MOVE 'ERACCT3' TO DFHEIV1
  4757     MOVE 0
  4758       TO DFHEIV11
  4759*    MOVE '&2                    $   #00004673' TO DFHEIV0
  4760     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4761     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4762     MOVE X'2020233030303034363733' TO DFHEIV0(25:11)
  4763     CALL 'kxdfhei1' USING DFHEIV0,
  4764           DFHEIV1,
  4765           DFHEIV11,
  4766           DFHEIV99
  4767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4768     ELSE
  4769        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  84
* SOCK03.cbl
  4770        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4771        MOVE ZEROS      TO WS-RESP
  4772        PERFORM 0030-BUILD-BUFFER
  4773                                 THRU 0030-EXIT
  4774        PERFORM 0020-SEND-BUFFER
  4775                                 THRU 0020-EXIT
  4776        PERFORM 0025-CLOSE-SOCKET
  4777                                 THRU 0025-EXIT
  4778        GO TO 0010-RETURN
  4779     END-IF
  4780     .
  4781 0060-EXIT.
  4782     EXIT.
  4783 0100-START-ELCERT.
  4784     MOVE SPACES                 TO WS-SEND-BUF
  4785     INITIALIZE WS-STRING-DATA
  4786     MOVE LOW-VALUES             TO WS-CM-KEY
  4787                                    WS-CM-KEY-A1
  4788                                    WS-CM-KEY-A4
  4789     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4790                                    WS-CM-COMPANY-CD-A1
  4791                                    WS-CM-COMPANY-CD-A4
  4792     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4793     MOVE 'L'                    TO DC-OPTION-CODE
  4794     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4795     IF NO-CONVERSION-ERROR
  4796        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4797     ELSE
  4798        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4799        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4800        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4801        PERFORM 0020-SEND-BUFFER
  4802                                 THRU 0020-EXIT
  4803        PERFORM 0025-CLOSE-SOCKET
  4804                                 THRU 0025-EXIT
  4805        GO TO 0010-RETURN
  4806     END-IF
  4807     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4808        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4809        MOVE 'L'                 TO DC-OPTION-CODE
  4810        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4811        IF NO-CONVERSION-ERROR
  4812           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4813        ELSE
  4814           MOVE 'BAD EFF DT CONVERT '
  4815                                 TO WS-COMMENT
  4816           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4817           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4818           PERFORM 0020-SEND-BUFFER
  4819                                 THRU 0020-EXIT
  4820           PERFORM 0025-CLOSE-SOCKET
  4821                                 THRU 0025-EXIT
  4822           GO TO 0010-RETURN
  4823        END-IF
  4824     END-IF
  4825     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4826        (F1 > +10)
  4827        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  85
* SOCK03.cbl
  4828     END-PERFORM
  4829     IF F1 > +1
  4830        SUBTRACT +1 FROM F1
  4831     END-IF
  4832     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4833        (L1 > +15)
  4834        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4835     END-PERFORM
  4836     IF L1 > +1
  4837        SUBTRACT +1 FROM L1
  4838     END-IF
  4839     EVALUATE TRUE
  4840        WHEN WS-ELCERT-FULL
  4841           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4842           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4843           MOVE CLIENT-STATE        TO WS-CM-STATE
  4844           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4845           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4846           MOVE CLIENT-CERT-NO (1:10)
  4847                                    TO WS-CM-CERT-NO
  4848
  4849* EXEC CICS READ
  4850*             INTO    (CERTIFICATE-MASTER)
  4851*             DATASET ('ELCERT')
  4852*             RIDFLD  (WS-CM-KEY)
  4853*             RESP    (WS-RESPONSE)
  4854*          END-EXEC
  4855     MOVE LENGTH OF
  4856      CERTIFICATE-MASTER
  4857       TO DFHEIV11
  4858     MOVE 'ELCERT' TO DFHEIV1
  4859*    MOVE '&"IL       E          (  N#00004757' TO DFHEIV0
  4860     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4861     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4862     MOVE X'204E233030303034373537' TO DFHEIV0(25:11)
  4863     CALL 'kxdfhei1' USING DFHEIV0,
  4864           DFHEIV1,
  4865           CERTIFICATE-MASTER,
  4866           DFHEIV11,
  4867           WS-CM-KEY,
  4868           DFHEIV99,
  4869           DFHEIV99,
  4870           DFHEIV99
  4871     MOVE EIBRESP  TO WS-RESPONSE
  4872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4873        WHEN WS-ELCERT-ACT-NAME
  4874           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4875           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4876           MOVE CLIENT-STATE        TO WS-CM-STATE
  4877           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4878           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4879           MOVE ZEROS               TO WS-CM-CERT-NO
  4880
  4881* EXEC CICS STARTBR
  4882*             DATASET ('ELCERT')
  4883*             RIDFLD  (WS-CM-KEY)
  4884*             RESP    (WS-RESPONSE)
  4885*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  86
* SOCK03.cbl
  4886     MOVE 'ELCERT' TO DFHEIV1
  4887     MOVE 0
  4888       TO DFHEIV11
  4889*    MOVE '&,         G          &  N#00004770' TO DFHEIV0
  4890     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4891     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4892     MOVE X'204E233030303034373730' TO DFHEIV0(25:11)
  4893     CALL 'kxdfhei1' USING DFHEIV0,
  4894           DFHEIV1,
  4895           WS-CM-KEY,
  4896           DFHEIV99,
  4897           DFHEIV11,
  4898           DFHEIV99
  4899     MOVE EIBRESP  TO WS-RESPONSE
  4900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4901        WHEN WS-ELCERT-NAME
  4902           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4903           MOVE SPACES           TO WS-CM-INITIALS
  4904           COMPUTE WS-LENGTH = L1 + +1
  4905
  4906* EXEC CICS STARTBR
  4907*             DATASET   ('ELCERT2')
  4908*             RIDFLD    (WS-CM-KEY-A1)
  4909*             GENERIC
  4910*             KEYLENGTH (WS-LENGTH)
  4911*             GTEQ
  4912*             RESP      (WS-RESPONSE)
  4913*          END-EXEC
  4914     MOVE 'ELCERT2' TO DFHEIV1
  4915     MOVE 0
  4916       TO DFHEIV11
  4917*    MOVE '&,   KG    G          &  N#00004779' TO DFHEIV0
  4918     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4919     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4920     MOVE X'204E233030303034373739' TO DFHEIV0(25:11)
  4921     CALL 'kxdfhei1' USING DFHEIV0,
  4922           DFHEIV1,
  4923           WS-CM-KEY-A1,
  4924           WS-LENGTH,
  4925           DFHEIV11,
  4926           DFHEIV99
  4927     MOVE EIBRESP  TO WS-RESPONSE
  4928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4929*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4930*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4931        WHEN WS-ELCERT-CERT-NO
  4932* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4933           MOVE +11 TO WS-LENGTH
  4934           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4935
  4936* EXEC CICS STARTBR
  4937*             DATASET   ('ELCERT5')
  4938*             RIDFLD    (WS-CM-KEY-A4)
  4939*             GENERIC
  4940*             KEYLENGTH (WS-LENGTH)
  4941*             GTEQ
  4942*             RESP      (WS-RESPONSE)
  4943*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  87
* SOCK03.cbl
  4944     MOVE 'ELCERT5' TO DFHEIV1
  4945     MOVE 0
  4946       TO DFHEIV11
  4947*    MOVE '&,   KG    G          &  N#00004793' TO DFHEIV0
  4948     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4949     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4950     MOVE X'204E233030303034373933' TO DFHEIV0(25:11)
  4951     CALL 'kxdfhei1' USING DFHEIV0,
  4952           DFHEIV1,
  4953           WS-CM-KEY-A4,
  4954           WS-LENGTH,
  4955           DFHEIV11,
  4956           DFHEIV99
  4957     MOVE EIBRESP  TO WS-RESPONSE
  4958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4959     END-EVALUATE
  4960     .
  4961 0100-EXIT.
  4962     EXIT.
  4963 0150-READ-NEXT-ELCERT.
  4964     EVALUATE TRUE
  4965        WHEN WS-ELCERT-ACT-NAME
  4966*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4967
  4968* EXEC CICS READNEXT
  4969*             DATASET   ('ELCERT')
  4970*             RIDFLD    (WS-CM-KEY)
  4971*             INTO      (CERTIFICATE-MASTER)
  4972*             RESP      (WS-RESPONSE)
  4973*          END-EXEC
  4974     MOVE LENGTH OF
  4975      CERTIFICATE-MASTER
  4976       TO DFHEIV12
  4977     MOVE 'ELCERT' TO DFHEIV1
  4978     MOVE 0
  4979       TO DFHEIV11
  4980*    MOVE '&.IL                  )  N#00004810' TO DFHEIV0
  4981     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4982     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4983     MOVE X'204E233030303034383130' TO DFHEIV0(25:11)
  4984     CALL 'kxdfhei1' USING DFHEIV0,
  4985           DFHEIV1,
  4986           CERTIFICATE-MASTER,
  4987           DFHEIV12,
  4988           WS-CM-KEY,
  4989           DFHEIV99,
  4990           DFHEIV11,
  4991           DFHEIV99,
  4992           DFHEIV99
  4993     MOVE EIBRESP  TO WS-RESPONSE
  4994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4995        WHEN WS-ELCERT-NAME
  4996*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4997
  4998* EXEC CICS READNEXT
  4999*             DATASET   ('ELCERT2')
  5000*             RIDFLD    (WS-CM-KEY-A1)
  5001*             INTO      (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  88
* SOCK03.cbl
  5002*             RESP      (WS-RESPONSE)
  5003*          END-EXEC
  5004     MOVE LENGTH OF
  5005      CERTIFICATE-MASTER
  5006       TO DFHEIV12
  5007     MOVE 'ELCERT2' TO DFHEIV1
  5008     MOVE 0
  5009       TO DFHEIV11
  5010*    MOVE '&.IL                  )  N#00004818' TO DFHEIV0
  5011     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5012     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5013     MOVE X'204E233030303034383138' TO DFHEIV0(25:11)
  5014     CALL 'kxdfhei1' USING DFHEIV0,
  5015           DFHEIV1,
  5016           CERTIFICATE-MASTER,
  5017           DFHEIV12,
  5018           WS-CM-KEY-A1,
  5019           DFHEIV99,
  5020           DFHEIV11,
  5021           DFHEIV99,
  5022           DFHEIV99
  5023     MOVE EIBRESP  TO WS-RESPONSE
  5024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5025        WHEN WS-ELCERT-CERT-NO
  5026
  5027* EXEC CICS READNEXT
  5028*             DATASET   ('ELCERT5')
  5029*             RIDFLD    (WS-CM-KEY-A4)
  5030*             INTO      (CERTIFICATE-MASTER)
  5031*             RESP      (WS-RESPONSE)
  5032*          END-EXEC
  5033     MOVE LENGTH OF
  5034      CERTIFICATE-MASTER
  5035       TO DFHEIV12
  5036     MOVE 'ELCERT5' TO DFHEIV1
  5037     MOVE 0
  5038       TO DFHEIV11
  5039*    MOVE '&.IL                  )  N#00004825' TO DFHEIV0
  5040     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5041     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5042     MOVE X'204E233030303034383235' TO DFHEIV0(25:11)
  5043     CALL 'kxdfhei1' USING DFHEIV0,
  5044           DFHEIV1,
  5045           CERTIFICATE-MASTER,
  5046           DFHEIV12,
  5047           WS-CM-KEY-A4,
  5048           DFHEIV99,
  5049           DFHEIV11,
  5050           DFHEIV99,
  5051           DFHEIV99
  5052     MOVE EIBRESP  TO WS-RESPONSE
  5053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5054     END-EVALUATE
  5055     .
  5056 0150-EXIT.
  5057     EXIT.
  5058 0200-BEGIN-REFUND-PROCESS.
  5059     MOVE SPACES                 TO WS-BUFF-SENT-SW
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  89
* SOCK03.cbl
  5060                                    WS-ERACCT-SW
  5061     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  5062                                    WS-NCB-DIFF-ODD-DAYS
  5063     INITIALIZE WS-STRING-DATA
  5064     IF RESP-NORMAL OR RESP-DUPKEY
  5065        EVALUATE TRUE
  5066           WHEN WS-ELCERT-ACT-NAME
  5067              EVALUATE TRUE
  5068                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  5069                    OR (CM-CARRIER NOT = CLIENT-CAR)
  5070                    OR (CM-GROUPING NOT = CLIENT-GRP)
  5071                    OR (CM-STATE NOT = CLIENT-STATE)
  5072                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  5073                    SET ELCERT-FINISHED TO TRUE
  5074                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  5075                    CLIENT-LAST-NAME (1:L1))
  5076                    GO TO 0200-CONTINUE
  5077                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  5078                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5079                    GO TO 0200-CONTINUE
  5080                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  5081                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5082                     CLIENT-FIRST-NAME (1:F1)))
  5083                    GO TO 0200-CONTINUE
  5084                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  5085                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5086                    GO TO 0200-CONTINUE
  5087              END-EVALUATE
  5088           WHEN WS-ELCERT-CERT-NO
  5089              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5090                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  5091                 SET ELCERT-FINISHED TO TRUE
  5092              ELSE
  5093                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5094                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5095                              OR
  5096                    ((CLIENT-LAST-NAME NOT = SPACES)
  5097                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  5098                        CLIENT-LAST-NAME (1:L1)))
  5099                              OR
  5100                    ((CLIENT-FIRST-NAME NOT = SPACES)
  5101                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5102                        CLIENT-FIRST-NAME (1:F1)))
  5103                              OR
  5104                    ((CLIENT-ACCOUNT NOT = SPACES)
  5105                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5106                     GO TO 0200-CONTINUE
  5107                 END-IF
  5108              END-IF
  5109           WHEN WS-ELCERT-NAME
  5110              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5111                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  5112                    CLIENT-LAST-NAME (1:L1))
  5113                  SET ELCERT-FINISHED TO TRUE
  5114              ELSE
  5115                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5116                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5117                           OR
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  90
* SOCK03.cbl
  5118                 ((CLIENT-FIRST-NAME NOT = SPACES)
  5119                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5120                     CLIENT-FIRST-NAME (1:F1)))
  5121                           OR
  5122                 ((CLIENT-ACCOUNT NOT = SPACES)
  5123                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5124                  GO TO 0200-CONTINUE
  5125                 END-IF
  5126              END-IF
  5127           WHEN OTHER
  5128              SET ELCERT-FINISHED   TO TRUE
  5129        END-EVALUATE
  5130     ELSE
  5131        SET ELCERT-FINISHED TO TRUE
  5132     END-IF
  5133*       IF WS-ELCERT-CERT-NO
  5134*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5135*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  5136*                          OR
  5137*                ((CLIENT-EFF-DT NOT = SPACES)
  5138*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5139*                          OR
  5140*                ((CLIENT-LAST-NAME NOT = SPACES)
  5141*                 AND (CM-INSURED-LAST-NAME NOT =
  5142*                    CLIENT-LAST-NAME))
  5143*                 SET ELCERT-FINISHED TO TRUE
  5144*          END-IF
  5145*          IF WS-ELCERT-NAME
  5146*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5147*                OR (CM-INSURED-LAST-NAME NOT =
  5148*                   CLIENT-LAST-NAME)
  5149*                            OR
  5150*                ((CLIENT-EFF-DT NOT = SPACES)
  5151*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5152*                 SET ELCERT-FINISHED TO TRUE
  5153*             END-IF
  5154*          ELSE
  5155*             SET ELCERT-FINISHED   TO TRUE
  5156*          END-IF
  5157     IF NOT WS-ELCERT-FULL
  5158        IF ELCERT-FINISHED
  5159           GO TO 0200-EXIT
  5160        END-IF
  5161     END-IF
  5162     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  5163        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  5164        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5165        PERFORM 0030-BUILD-BUFFER
  5166                                 THRU 0030-EXIT
  5167        PERFORM 0020-SEND-BUFFER
  5168                                 THRU 0020-EXIT
  5169        GO TO 0200-CONTINUE
  5170     END-IF
  5171     if (ws-epiq-request)
  5172        and (not EPIQ-CLASS)
  5173        go to 0200-continue
  5174     end-if
  5175
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  91
* SOCK03.cbl
  5176     if ws-epiq-request
  5177        add +1 to ws-epiq-max
  5178        if ws-epiq-max > +100
  5179           go to 0200-continue
  5180        end-if
  5181     end-if
  5182     PERFORM 0300-GET-ELCNTL-RECORDS
  5183                                 THRU 0300-EXIT
  5184     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  5185     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5186     MOVE +0                     TO DC-ELAPSED-MONTHS
  5187                                    DC-ELAPSED-DAYS
  5188     MOVE '1'                    TO DC-OPTION-CODE
  5189     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5190     IF NO-CONVERSION-ERROR
  5191        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  5192        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  5193     END-IF
  5194     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  5195     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  5196     perform 0610-get-ermail     thru 0610-exit
  5197     perform 0620-get-elcrtt     thru 0620-exit
  5198     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  5199     IF NOT ALREADY-SENT
  5200        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  5201     END-IF
  5202     .
  5203 0200-CONTINUE.
  5204     PERFORM 0150-READ-NEXT-ELCERT
  5205                                 THRU 0150-EXIT
  5206     .
  5207 0200-EXIT.
  5208     EXIT.
  5209 0300-GET-ELCNTL-RECORDS.
  5210     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  5211     IF NOT RESP-NORMAL
  5212        MOVE ' COMPANY RECORD NOT FOUND '
  5213                                 TO WS-COMMENT
  5214        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5215        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5216        PERFORM 0020-SEND-BUFFER
  5217                                 THRU 0020-EXIT
  5218        PERFORM 0025-CLOSE-SOCKET
  5219                                 THRU 0025-EXIT
  5220        GO TO 0010-RETURN
  5221     END-IF
  5222     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  5223        PERFORM 0320-GET-LIFE-RECORD
  5224                                 THRU 0320-EXIT
  5225        IF NOT RESP-NORMAL
  5226           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  5227                                 TO WS-COMMENT
  5228           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5229           PERFORM 0030-BUILD-BUFFER
  5230                                 THRU 0030-EXIT
  5231           PERFORM 0020-SEND-BUFFER
  5232                                 THRU 0020-EXIT
  5233           PERFORM 0025-CLOSE-SOCKET
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  92
* SOCK03.cbl
  5234                                 THRU 0025-EXIT
  5235           GO TO 0010-RETURN
  5236        END-IF
  5237     END-IF
  5238     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5239        PERFORM 0330-GET-AH-RECORD
  5240                                 THRU 0330-EXIT
  5241        IF NOT RESP-NORMAL
  5242           MOVE ' AH BENEFIT RECORD NOT FOUND '
  5243                                 TO WS-COMMENT
  5244           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5245           PERFORM 0030-BUILD-BUFFER
  5246                                 THRU 0030-EXIT
  5247           PERFORM 0020-SEND-BUFFER
  5248                                 THRU 0020-EXIT
  5249           PERFORM 0025-CLOSE-SOCKET
  5250                                 THRU 0025-EXIT
  5251           GO TO 0010-RETURN
  5252        END-IF
  5253     END-IF
  5254     PERFORM 0340-GET-STATE-RECORD
  5255                                 THRU 0340-EXIT
  5256     IF NOT RESP-NORMAL
  5257        MOVE ' STATE RECORD NOT FOUND '
  5258                                 TO WS-COMMENT
  5259        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5260        PERFORM 0030-BUILD-BUFFER
  5261                                 THRU 0030-EXIT
  5262        PERFORM 0020-SEND-BUFFER
  5263                                 THRU 0020-EXIT
  5264        PERFORM 0025-CLOSE-SOCKET
  5265                                 THRU 0025-EXIT
  5266        GO TO 0010-RETURN
  5267     END-IF
  5268     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  5269     IF NOT ERACCT-FOUND
  5270        MOVE ' ACCOUNT NOT FOUND '
  5271                                 TO WS-COMMENT
  5272        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5273        PERFORM 0030-BUILD-BUFFER
  5274                                 THRU 0030-EXIT
  5275        PERFORM 0020-SEND-BUFFER
  5276                                 THRU 0020-EXIT
  5277        PERFORM 0025-CLOSE-SOCKET
  5278                                 THRU 0025-EXIT
  5279        GO TO 0010-RETURN
  5280     ELSE
  5281        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  5282        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  5283        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  5284        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  5285     END-IF
  5286     .
  5287 0300-EXIT.
  5288     EXIT.
  5289 0310-GET-COMPANY.
  5290     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  5291     MOVE '1'                    TO  WS-CF-RECORD-TYPE
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  93
* SOCK03.cbl
  5292     MOVE SPACES                 TO  WS-CF-ACCESS
  5293     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  5294
  5295* EXEC CICS READ
  5296*       INTO    (CONTROL-FILE)
  5297*       DATASET ('ELCNTL')
  5298*       RIDFLD  (WS-CF-KEY)
  5299*       RESP    (WS-RESPONSE)
  5300*    END-EXEC
  5301     MOVE LENGTH OF
  5302      CONTROL-FILE
  5303       TO DFHEIV11
  5304     MOVE 'ELCNTL' TO DFHEIV1
  5305*    MOVE '&"IL       E          (  N#00005072' TO DFHEIV0
  5306     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5308     MOVE X'204E233030303035303732' TO DFHEIV0(25:11)
  5309     CALL 'kxdfhei1' USING DFHEIV0,
  5310           DFHEIV1,
  5311           CONTROL-FILE,
  5312           DFHEIV11,
  5313           WS-CF-KEY,
  5314           DFHEIV99,
  5315           DFHEIV99,
  5316           DFHEIV99
  5317     MOVE EIBRESP  TO WS-RESPONSE
  5318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5319     IF (RESP-NORMAL)
  5320        AND (CF-COMPANY-ID = WS-COMP-ID)
  5321        AND (CF-RECORD-TYPE = '1')
  5322        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5323        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  5324        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  5325        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5326        IF CF-DEFAULT-APR NUMERIC
  5327           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5328        ELSE
  5329           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5330        END-IF
  5331        IF CF-VALID-REM-TRM-OPTION
  5332           MOVE CF-REM-TRM-CALC-OPTION
  5333                                 TO WS-CF-REM-TRM-CALC-OPTION
  5334        ELSE
  5335           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5336        END-IF
  5337     END-IF
  5338     .
  5339 0310-EXIT.
  5340     EXIT.
  5341 0320-GET-LIFE-RECORD.
  5342     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5343     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5344                                    WS-LF-BEN-CODE
  5345     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5346
  5347* EXEC CICS READ
  5348*       INTO    (CONTROL-FILE)
  5349*       DATASET ('ELCNTL')
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  94
* SOCK03.cbl
  5350*       RIDFLD  (WS-CF-KEY)
  5351*       GTEQ
  5352*       RESP    (WS-RESPONSE)
  5353*    END-EXEC
  5354     MOVE LENGTH OF
  5355      CONTROL-FILE
  5356       TO DFHEIV11
  5357     MOVE 'ELCNTL' TO DFHEIV1
  5358*    MOVE '&"IL       G          (  N#00005105' TO DFHEIV0
  5359     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5361     MOVE X'204E233030303035313035' TO DFHEIV0(25:11)
  5362     CALL 'kxdfhei1' USING DFHEIV0,
  5363           DFHEIV1,
  5364           CONTROL-FILE,
  5365           DFHEIV11,
  5366           WS-CF-KEY,
  5367           DFHEIV99,
  5368           DFHEIV99,
  5369           DFHEIV99
  5370     MOVE EIBRESP  TO WS-RESPONSE
  5371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5372     IF RESP-NORMAL
  5373        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5374        AND (CF-RECORD-TYPE = '4')
  5375        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5376           (S1 > +8)
  5377           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5378        END-PERFORM
  5379        IF S1 > +8
  5380           CONTINUE
  5381        ELSE
  5382           MOVE CF-BENEFIT-DESCRIP (S1)
  5383                                 TO WS-LF-BEN-CODE-DESC
  5384           MOVE CF-LF-COVERAGE-TYPE (S1)
  5385                                 TO WS-CF-LF-COVERAGE-TYPE
  5386           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5387              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5388           ELSE
  5389              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5390           END-IF
  5391           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5392               MOVE CF-CO-REM-TERM-CALC (S1)
  5393                                 TO WS-LF-CO-REM-TERM-CALC
  5394           END-IF
  5395           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5396               MOVE CF-CO-EARNINGS-CALC (S1)
  5397                                 TO WS-LF-CO-EARNINGS-CALC
  5398                                    WS-LF-CO-REFUND-CALC
  5399           END-IF
  5400           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5401               MOVE CF-SPECIAL-CALC-CD (S1)
  5402                                 TO WS-LF-SPECIAL-CALC-CD
  5403           END-IF
  5404           IF CF-CO-REFUND-CALC (S1) > '0'
  5405               MOVE CF-CO-REFUND-CALC (S1)
  5406                                 TO WS-LF-CO-REFUND-CALC
  5407        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  95
* SOCK03.cbl
  5408     END-IF
  5409     .
  5410 0320-EXIT.
  5411     EXIT.
  5412 0330-GET-AH-RECORD.
  5413     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5414     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5415     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5416
  5417* EXEC CICS READ
  5418*       INTO    (CONTROL-FILE)
  5419*       DATASET ('ELCNTL')
  5420*       RIDFLD  (WS-CF-KEY)
  5421*       GTEQ
  5422*       RESP    (WS-RESPONSE)
  5423*    END-EXEC
  5424     MOVE LENGTH OF
  5425      CONTROL-FILE
  5426       TO DFHEIV11
  5427     MOVE 'ELCNTL' TO DFHEIV1
  5428*    MOVE '&"IL       G          (  N#00005156' TO DFHEIV0
  5429     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5431     MOVE X'204E233030303035313536' TO DFHEIV0(25:11)
  5432     CALL 'kxdfhei1' USING DFHEIV0,
  5433           DFHEIV1,
  5434           CONTROL-FILE,
  5435           DFHEIV11,
  5436           WS-CF-KEY,
  5437           DFHEIV99,
  5438           DFHEIV99,
  5439           DFHEIV99
  5440     MOVE EIBRESP  TO WS-RESPONSE
  5441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5442     IF RESP-NORMAL
  5443        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5444        AND (CF-RECORD-TYPE = '5')
  5445        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5446           (S1 > +8)
  5447           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5448        END-PERFORM
  5449        IF S1 > +8
  5450           CONTINUE
  5451        ELSE
  5452           MOVE CF-BENEFIT-DESCRIP (S1)
  5453                                 TO WS-AH-BEN-CODE-DESC
  5454           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5455              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5456           ELSE
  5457              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5458           END-IF
  5459           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5460              MOVE CF-CO-REM-TERM-CALC (S1)
  5461                                 TO WS-AH-CO-REM-TERM-CALC
  5462           END-IF
  5463           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5464              MOVE CF-CO-EARNINGS-CALC (S1)
  5465                                 TO WS-AH-CO-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  96
* SOCK03.cbl
  5466                                    WS-AH-CO-REFUND-CALC
  5467           END-IF
  5468           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5469              MOVE CF-SPECIAL-CALC-CD (S1)
  5470                                 TO WS-AH-SPECIAL-CALC-CD
  5471           END-IF
  5472           IF CF-CO-REFUND-CALC (S1) > '0'
  5473              MOVE CF-CO-REFUND-CALC (S1)
  5474                                 TO WS-AH-CO-REFUND-CALC
  5475           END-IF
  5476           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5477              MOVE CF-BENEFIT-CATEGORY (S1)
  5478                                 TO WS-AH-BEN-CATEGORY
  5479           END-IF
  5480        END-IF
  5481     END-IF
  5482     .
  5483 0330-EXIT.
  5484     EXIT.
  5485 0340-GET-STATE-RECORD.
  5486     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5487     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5488     MOVE CM-STATE               TO WS-CF-ACCESS
  5489     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5490
  5491* EXEC CICS READ
  5492*       INTO    (CONTROL-FILE)
  5493*       DATASET ('ELCNTL')
  5494*       RIDFLD  (WS-CF-KEY)
  5495*       RESP    (WS-RESPONSE)
  5496*    END-EXEC
  5497     MOVE LENGTH OF
  5498      CONTROL-FILE
  5499       TO DFHEIV11
  5500     MOVE 'ELCNTL' TO DFHEIV1
  5501*    MOVE '&"IL       E          (  N#00005211' TO DFHEIV0
  5502     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5504     MOVE X'204E233030303035323131' TO DFHEIV0(25:11)
  5505     CALL 'kxdfhei1' USING DFHEIV0,
  5506           DFHEIV1,
  5507           CONTROL-FILE,
  5508           DFHEIV11,
  5509           WS-CF-KEY,
  5510           DFHEIV99,
  5511           DFHEIV99,
  5512           DFHEIV99
  5513     MOVE EIBRESP  TO WS-RESPONSE
  5514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5515     IF (RESP-NORMAL)
  5516        AND (CF-COMPANY-ID = WS-COMP-ID)
  5517        AND (CF-RECORD-TYPE = '3')
  5518        AND (CF-STATE-CODE = CM-STATE)
  5519        MOVE CF-ST-FREE-LOOK-PERIOD
  5520                                 TO WS-FREE-LOOK
  5521        MOVE CF-STATE-ABBREVIATION
  5522                                 TO WS-STATE-ABBREVIATION
  5523        MOVE CF-ST-FST-PMT-DAYS-CHG
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  97
* SOCK03.cbl
  5524                                 TO  WS-STATE-EXT-DAYS-CHG
  5525        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5526           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5527           IF CF-ST-RT-CALC NOT = SPACES
  5528              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5529           END-IF
  5530           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5531              IF CF-ST-RF-LR-CALC > '0'
  5532                 MOVE CF-ST-RF-LR-CALC
  5533                                 TO WS-LF-ST-REFUND-CALC
  5534              END-IF
  5535              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5536                 IF CF-ST-RF-LN-CALC > '0'
  5537                    MOVE CF-ST-RF-LN-CALC
  5538                                 TO WS-LF-ST-REFUND-CALC
  5539                 END-IF
  5540              END-IF
  5541           ELSE
  5542              IF CF-ST-RF-LL-CALC > '0'
  5543                 MOVE CF-ST-RF-LL-CALC
  5544                                 TO WS-LF-ST-REFUND-CALC
  5545              END-IF
  5546           END-IF
  5547           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5548              (S1 > 50)
  5549              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5550                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5551           END-PERFORM
  5552           IF S1 < +51
  5553              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5554                 MOVE CF-ST-REM-TERM-CALC (S1)
  5555                                 TO WS-LF-ST-REM-TERM-CALC
  5556              END-IF
  5557              IF CF-ST-REFUND-CALC (S1) > '0'
  5558                 MOVE CF-ST-REFUND-CALC (S1)
  5559                                 TO WS-LF-ST-REFUND-CALC
  5560              END-IF
  5561           END-IF
  5562        END-IF
  5563        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5564           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5565           IF CF-ST-RT-CALC NOT = SPACES
  5566              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5567           END-IF
  5568           IF CF-ST-RF-AH-CALC > '0'
  5569              MOVE CF-ST-RF-AH-CALC
  5570                                 TO WS-AH-ST-REFUND-CALC
  5571           END-IF
  5572           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5573              IF CF-ST-RF-CP-CALC > '0'
  5574                 MOVE CF-ST-RF-CP-CALC
  5575                                 TO WS-AH-ST-REFUND-CALC
  5576              END-IF
  5577           END-IF
  5578           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5579              (S1 > 50)
  5580              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5581                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  98
* SOCK03.cbl
  5582           END-PERFORM
  5583           IF S1 < +51
  5584              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5585                 MOVE CF-ST-REM-TERM-CALC (S1)
  5586                                 TO WS-AH-ST-REM-TERM-CALC
  5587              END-IF
  5588              IF CF-ST-REFUND-CALC (S1) > '0'
  5589                 MOVE CF-ST-REFUND-CALC (S1)
  5590                                 TO WS-AH-ST-REFUND-CALC
  5591              END-IF
  5592           END-IF
  5593        END-IF
  5594     END-IF
  5595     .
  5596 0340-EXIT.
  5597     EXIT.
  5598 0350-GET-ERACCT.
  5599     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5600                                    WS-AM-EARN-METHOD-R
  5601                                    WS-AM-EARN-METHOD-A
  5602                                    WS-LF-AM-REM-TERM-CALC
  5603                                    WS-AH-AM-REM-TERM-CALC
  5604     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5605     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5606     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5607     MOVE CM-STATE               TO WS-AM-STATE
  5608     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5609     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5610     MOVE LOW-VALUES             TO WS-AM-FILLER
  5611     MOVE ' '                    TO WS-STOP-SW
  5612
  5613* EXEC CICS STARTBR
  5614*       DATASET  ('ERACCT')
  5615*       RIDFLD   (WS-AM-KEY)
  5616*       GTEQ
  5617*       RESP (WS-RESPONSE)
  5618*    END-EXEC
  5619     MOVE 'ERACCT' TO DFHEIV1
  5620     MOVE 0
  5621       TO DFHEIV11
  5622*    MOVE '&,         G          &  N#00005314' TO DFHEIV0
  5623     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5624     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5625     MOVE X'204E233030303035333134' TO DFHEIV0(25:11)
  5626     CALL 'kxdfhei1' USING DFHEIV0,
  5627           DFHEIV1,
  5628           WS-AM-KEY,
  5629           DFHEIV99,
  5630           DFHEIV11,
  5631           DFHEIV99
  5632     MOVE EIBRESP  TO WS-RESPONSE
  5633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5634     IF RESP-NORMAL
  5635        PERFORM UNTIL TOLD-TO-STOP
  5636
  5637* EXEC CICS READNEXT
  5638*             DATASET  ('ERACCT')
  5639*             INTO     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page  99
* SOCK03.cbl
  5640*             RIDFLD   (WS-AM-KEY)
  5641*          END-EXEC
  5642     MOVE LENGTH OF
  5643      ACCOUNT-MASTER
  5644       TO DFHEIV12
  5645     MOVE 'ERACCT' TO DFHEIV1
  5646     MOVE 0
  5647       TO DFHEIV11
  5648*    MOVE '&.IL                  )   #00005322' TO DFHEIV0
  5649     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5650     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5651     MOVE X'2020233030303035333232' TO DFHEIV0(25:11)
  5652     CALL 'kxdfhei1' USING DFHEIV0,
  5653           DFHEIV1,
  5654           ACCOUNT-MASTER,
  5655           DFHEIV12,
  5656           WS-AM-KEY,
  5657           DFHEIV99,
  5658           DFHEIV11,
  5659           DFHEIV99,
  5660           DFHEIV99
  5661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5662           IF RESP-NORMAL
  5663              EVALUATE TRUE
  5664                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5665                    CM-CONTROL-PRIMARY (1:20)
  5666                    SET TOLD-TO-STOP TO TRUE
  5667                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5668                    CM-CONTROL-PRIMARY (1:20))
  5669                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5670                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5671                    SET ERACCT-FOUND      TO TRUE
  5672                    SET TOLD-TO-STOP TO TRUE
  5673              END-EVALUATE
  5674           ELSE
  5675              SET TOLD-TO-STOP TO TRUE
  5676           END-IF
  5677        END-PERFORM
  5678
  5679* EXEC CICS ENDBR
  5680*          DATASET   ('ERACCT')
  5681*       END-EXEC
  5682     MOVE 'ERACCT' TO DFHEIV1
  5683     MOVE 0
  5684       TO DFHEIV11
  5685*    MOVE '&2                    $   #00005343' TO DFHEIV0
  5686     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5687     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5688     MOVE X'2020233030303035333433' TO DFHEIV0(25:11)
  5689     CALL 'kxdfhei1' USING DFHEIV0,
  5690           DFHEIV1,
  5691           DFHEIV11,
  5692           DFHEIV99
  5693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5694     END-IF
  5695     .
  5696 0350-EXIT.
  5697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 100
* SOCK03.cbl
  5698 0400-PROCESS-LIFE.
  5699     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5700     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5701     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5702     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5703     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5704     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5705     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5706     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5707     MOVE CM-CARRIER             TO WS-CARRIER
  5708     MOVE CM-GROUPING            TO WS-GROUPING
  5709     MOVE CM-STATE               TO WS-STATE
  5710     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5711     MOVE CM-CERT-NO             TO WS-CERT-NO
  5712     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5713     MOVE ' '                    TO  DC-OPTION-CODE.
  5714     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5715     IF NO-CONVERSION-ERROR
  5716        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5717     ELSE
  5718        MOVE 99999999            TO WS-CERT-EFF-DATE
  5719     END-IF
  5720     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5721        GO TO 0400-EXIT
  5722     END-IF
  5723     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5724                                    WS-TOT-LF-PREM
  5725                                    WS-TOT-LF-COMM
  5726                                    WS-LF-CANCEL-DATE
  5727     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5728     MOVE ' '                    TO  DC-OPTION-CODE
  5729     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5730     IF NO-CONVERSION-ERROR
  5731        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5732     ELSE
  5733        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5734     END-IF
  5735     IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5736        MOVE CM-LF-DEATH-DT      TO DC-BIN-DATE-1
  5737        MOVE ' '                 TO DC-OPTION-CODE
  5738
  5739        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5740        IF NO-CONVERSION-ERROR
  5741           MOVE DC-GREG-DATE-CYMD
  5742                                 TO WS-LF-CANCEL-DATE
  5743        ELSE
  5744           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5745        END-IF
  5746     END-IF
  5747     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5748        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
  5749        MOVE ' '                 TO DC-OPTION-CODE
  5750
  5751        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5752        IF NO-CONVERSION-ERROR
  5753           MOVE DC-GREG-DATE-CYMD
  5754                                 TO WS-LF-CANCEL-DATE
  5755        ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 101
* SOCK03.cbl
  5756           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5757        END-IF
  5758     END-IF
  5759     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5760     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5761     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5762     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5763     MOVE CM-STATE               TO CP-STATE
  5764     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5765     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5766     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5767     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5768     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5769     MOVE '2'                    TO CP-PROCESS-TYPE
  5770     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5771     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5772     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5773     MOVE WS-CF-REM-TRM-CALC-OPTION
  5774                                 TO CP-REM-TRM-CALC-OPTION
  5775     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5776     IF WS-LF-CO-REM-TERM-CALC > '0'
  5777        MOVE WS-LF-CO-REM-TERM-CALC
  5778                                 TO CP-REM-TERM-METHOD
  5779     END-IF
  5780     IF WS-LF-ST-REM-TERM-CALC > '0'
  5781         MOVE WS-LF-ST-REM-TERM-CALC
  5782                                 TO  CP-REM-TERM-METHOD.
  5783     IF WS-LF-AM-REM-TERM-CALC > '0'
  5784         MOVE WS-LF-AM-REM-TERM-CALC
  5785                                 TO  CP-REM-TERM-METHOD.
  5786     IF (WS-COMP-ID = 'CID')
  5787        AND (CP-STATE-STD-ABBRV = 'WI')
  5788        MOVE '7'                 TO CP-REM-TERM-METHOD
  5789        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5790     END-IF
  5791     IF (WS-COMP-ID = 'CID')
  5792        AND (CP-STATE-STD-ABBRV = 'MO')
  5793        AND (CM-CERT-EFF-DT >= X'9B41')
  5794        AND (CM-CERT-EFF-DT <= X'A2FB')
  5795        MOVE '7'                 TO CP-REM-TERM-METHOD
  5796        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5797     END-IF
  5798     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5799                                    CP-LOAN-TERM
  5800                                    WS-LF-TERM
  5801     IF CP-TRUNCATED-LIFE
  5802         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5803     IF CP-TERM-IS-DAYS
  5804        IF CM-LF-TERM-IN-DAYS NUMERIC
  5805           MOVE CM-LF-TERM-IN-DAYS
  5806                                 TO CP-TERM-OR-EXT-DAYS
  5807        ELSE
  5808           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5809        END-IF
  5810     ELSE
  5811        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5812           MOVE CM-PMT-EXTENSION-DAYS
  5813                                 TO CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 102
* SOCK03.cbl
  5814        ELSE
  5815           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5816        END-IF
  5817     END-IF
  5818     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5819     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5820        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5821        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5822     END-IF
  5823     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5824     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5825     MOVE ' '                    TO WS-CLM-STOP-SW
  5826     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5827     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5828
  5829* EXEC CICS STARTBR
  5830*       DATASET     ('ELMSTR5')
  5831*       RIDFLD      (ELMSTR-KEY)
  5832*       RESP        (WS-RESPONSE)
  5833*    END-EXEC
  5834     MOVE 'ELMSTR5' TO DFHEIV1
  5835     MOVE 0
  5836       TO DFHEIV11
  5837*    MOVE '&,         G          &  N#00005480' TO DFHEIV0
  5838     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5839     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5840     MOVE X'204E233030303035343830' TO DFHEIV0(25:11)
  5841     CALL 'kxdfhei1' USING DFHEIV0,
  5842           DFHEIV1,
  5843           ELMSTR-KEY,
  5844           DFHEIV99,
  5845           DFHEIV11,
  5846           DFHEIV99
  5847     MOVE EIBRESP  TO WS-RESPONSE
  5848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5849     DISPLAY ' AFTER START ' WS-RESPONSE
  5850     IF RESP-NORMAL
  5851        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5852
  5853* EXEC CICS READNEXT
  5854*             DATASET   ('ELMSTR5')
  5855*             RIDFLD    (ELMSTR-KEY)
  5856*             INTO      (CLAIM-MASTER)
  5857*             RESP      (WS-RESPONSE)
  5858*          END-EXEC
  5859     MOVE LENGTH OF
  5860      CLAIM-MASTER
  5861       TO DFHEIV12
  5862     MOVE 'ELMSTR5' TO DFHEIV1
  5863     MOVE 0
  5864       TO DFHEIV11
  5865*    MOVE '&.IL                  )  N#00005488' TO DFHEIV0
  5866     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5867     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5868     MOVE X'204E233030303035343838' TO DFHEIV0(25:11)
  5869     CALL 'kxdfhei1' USING DFHEIV0,
  5870           DFHEIV1,
  5871           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 103
* SOCK03.cbl
  5872           DFHEIV12,
  5873           ELMSTR-KEY,
  5874           DFHEIV99,
  5875           DFHEIV11,
  5876           DFHEIV99,
  5877           DFHEIV99
  5878     MOVE EIBRESP  TO WS-RESPONSE
  5879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5880        IF (RESP-NORMAL OR RESP-DUPKEY)
  5881           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5882           AND (CM-CERT-NO = CL-CERT-NO)
  5883           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5884              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5885              IF CL-CLAIM-TYPE = 'L' OR 'O'
  5886                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5887                    MOVE 'D'     TO WS-AH-STATUS
  5888                 END-IF
  5889                 IF CLAIM-IS-OPEN
  5890                    MOVE ' OPEN LIFE CLAIM '
  5891                                 TO WS-COMMENT
  5892                    MOVE 'L'     TO WS-LF-STATUS
  5893                    GO TO 0400-EXIT
  5894                 ELSE
  5895                    MOVE ' DEATH CLAIM APPLIED '
  5896                                 TO WS-COMMENT
  5897                    MOVE 'D'     TO WS-LF-STATUS
  5898*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5899*                      MOVE CL-PAID-THRU-DT
  5900*                                TO WS-LF-BIN-PAID-THRU-DT
  5901*                   END-IF
  5902                 END-IF
  5903              END-IF
  5904           END-IF
  5905        ELSE
  5906           SET I-SAY-TO-STOP TO TRUE
  5907        END-IF
  5908        END-PERFORM
  5909
  5910* EXEC CICS ENDBR
  5911*          DATASET   ('ELMSTR5')
  5912*       END-EXEC
  5913     MOVE 'ELMSTR5' TO DFHEIV1
  5914     MOVE 0
  5915       TO DFHEIV11
  5916*    MOVE '&2                    $   #00005523' TO DFHEIV0
  5917     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5918     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5919     MOVE X'2020233030303035353233' TO DFHEIV0(25:11)
  5920     CALL 'kxdfhei1' USING DFHEIV0,
  5921           DFHEIV1,
  5922           DFHEIV11,
  5923           DFHEIV99
  5924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5925     END-IF
  5926     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5927*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5928        MOVE WS-LF-BIN-PAID-THRU-DT
  5929                                 TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 104
* SOCK03.cbl
  5930        MOVE ' '                 TO DC-OPTION-CODE
  5931        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5932        IF NO-CONVERSION-ERROR
  5933           MOVE DC-GREG-DATE-CYMD
  5934                                 TO WS-CLM-PAID-THRU-DT
  5935        ELSE
  5936           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5937        END-IF
  5938*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5939*          MOVE 'CAN DT =< CLM PD THRU DT'
  5940*                                TO WS-COMMENT
  5941*          MOVE 'P'              TO WS-LF-STATUS
  5942*          GO TO 0400-EXIT
  5943*       END-IF
  5944        GO TO 0400-EXIT
  5945     END-IF
  5946     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5947     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5948        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5949        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5950        COMPUTE CP-REMAINING-TERM-1 =
  5951                CP-REMAINING-TERM-1 - +1
  5952        COMPUTE CP-REMAINING-TERM-2 =
  5953                CP-REMAINING-TERM-2 - +1
  5954     END-IF
  5955     IF CP-REMAINING-TERM-1 NEGATIVE
  5956        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5957     END-IF
  5958     IF CP-REMAINING-TERM-2 NEGATIVE
  5959        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5960     END-IF
  5961     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5962        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5963     END-IF
  5964     IF CM-LIFE-COMM-PCT > ZEROS
  5965        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5966           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5967     END-IF
  5968     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5969     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5970     IF CM-LF-CURRENT-STATUS = '8'
  5971        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5972           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5973                                 TO WS-COMMENT
  5974           MOVE 'C'              TO WS-LF-STATUS
  5975           move cm-lf-itd-cancel-amt
  5976                                 to ws-lf-refund
  5977*          PERFORM 0030-BUILD-BUFFER
  5978*                                THRU 0030-EXIT
  5979*          PERFORM 0020-SEND-BUFFER
  5980*                                THRU 0020-EXIT
  5981*          SET ALREADY-SENT      TO TRUE
  5982*          MOVE SPACES           TO WS-COMMENT
  5983           GO TO 0400-EXIT
  5984*          PERFORM 0025-CLOSE-SOCKET
  5985*                                THRU 0025-EXIT
  5986*          GO TO 0010-RETURN
  5987        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 105
* SOCK03.cbl
  5988     END-IF
  5989     IF CM-LF-CURRENT-STATUS = '7'
  5990        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5991           MOVE ' DEATH CLAIM APPLIED '
  5992                                 TO WS-COMMENT
  5993           MOVE 'D'              TO WS-LF-STATUS
  5994*          PERFORM 0030-BUILD-BUFFER
  5995*                                THRU 0030-EXIT
  5996*          IF NOT ALREADY-SENT
  5997*             PERFORM 0020-SEND-BUFFER
  5998*                                THRU 0020-EXIT
  5999*             SET ALREADY-SENT   TO TRUE
  6000*          END-IF
  6001           GO TO 0400-EXIT
  6002*          PERFORM 0025-CLOSE-SOCKET
  6003*                                THRU 0025-EXIT
  6004*          GO TO 0010-RETURN
  6005        END-IF
  6006     END-IF
  6007     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6008        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  6009        MOVE 'LF COVERAGE EXPIRED '
  6010                                 TO WS-COMMENT
  6011        MOVE 'E'                 TO WS-LF-STATUS
  6012        GO TO 0400-EXIT
  6013     END-IF
  6014     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6015        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6016        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6017     ELSE
  6018        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  6019     END-IF
  6020     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6021     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6022*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6023     if ws-comp-id = 'AHL'
  6024        move cm-lf-class-cd      to cp-class-code
  6025        if cp-class-code = spaces
  6026           move zeros            to cp-class-code
  6027        end-if
  6028     else
  6029        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6030     end-if
  6031     IF (ws-comp-id = 'DCC' or 'VPP')
  6032        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6033        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6034        PERFORM 0730-GET-DDF-FACTORS
  6035                                 THRU 0730-EXIT
  6036        IF PDEF-FOUND
  6037           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6038              (P1 > +8)
  6039              OR (PD-PROD-CODE (P1) = 'L')
  6040           END-PERFORM
  6041           IF P1 < +9
  6042              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6043           END-IF
  6044        END-IF
  6045     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 106
* SOCK03.cbl
  6046     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  6047*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  6048     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  6049        CM-LF-ALT-BENEFIT-AMT
  6050*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  6051     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  6052                                    WS-LF-REM-BEN
  6053     move cm-lf-premium-amt      to ws-tot-lf-prem
  6054     if ws-lf-co-earnings-calc = 'B'
  6055        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  6056           + CM-LF-ALT-PREMIUM-AMT
  6057     end-if
  6058     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  6059     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6060        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6061        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6062     ELSE
  6063        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6064     END-IF
  6065     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6066     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6067     IF WS-LF-ST-REFUND-CALC > ZERO
  6068         MOVE WS-LF-ST-REFUND-CALC
  6069                                 TO  CP-EARNING-METHOD.
  6070     IF WS-LF-FO-REFUND-CALC > ZERO
  6071         MOVE WS-LF-FO-REFUND-CALC
  6072                                 TO  CP-EARNING-METHOD.
  6073     IF CP-RATING-METHOD = '4'
  6074        MOVE '4'                 TO CP-EARNING-METHOD
  6075     END-IF
  6076*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6077     if ws-comp-id = 'AHL'
  6078        move cm-lf-class-cd      to cp-class-code
  6079        if cp-class-code = spaces
  6080           move zeros            to cp-class-code
  6081        end-if
  6082     else
  6083        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6084     end-if
  6085     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6086     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6087                                     CP-RATING-BENEFIT-AMT.
  6088     IF CP-STATE-STD-ABBRV = 'OR'
  6089         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6090                                         CM-LF-ALT-BENEFIT-AMT.
  6091****   N O T E   ****
  6092*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6093*      THE OH HARD CODING IN ELCRFNDP
  6094     IF WS-COMP-ID = 'CID'
  6095        IF CP-STATE-STD-ABBRV = 'OH'
  6096           MOVE WS-LF-CO-EARNINGS-CALC
  6097                                 TO CP-EARNING-METHOD
  6098        END-IF
  6099     END-IF
  6100****   N O T E   ****
  6101     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6102     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6103     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 107
* SOCK03.cbl
  6104     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6105     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6106*    IF CP-EARN-AS-NET-PAY
  6107*       IF CP-LOAN-APR <= ZEROS
  6108*          IF WS-CF-DEFAULT-APR > ZEROS
  6109*             MOVE WS-CF-DEFAULT-APR
  6110*                                TO  CP-LOAN-APR
  6111*          END-IF
  6112*       END-IF
  6113*    END-IF
  6114*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  6115*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  6116*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  6117*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  6118*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  6119*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  6120*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6121*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  6122*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6123*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  6124*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  6125*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  6126*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  6127*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6128*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  6129*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  6130*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  6131*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6132     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6133     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  6134     DISPLAY ' MADE IT BACK FROM ELRFND '
  6135     IF (CP-ERROR-RATE-IS-ZERO)
  6136        OR (CP-ERROR-RATE-NOT-FOUND)
  6137        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6138        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  6139          DELIMITED BY SIZE INTO WS-COMMENT
  6140        END-STRING
  6141        MOVE 'X'                 TO WS-LF-STATUS
  6142        GO TO 0400-EXIT
  6143*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6144*       IF NOT ALREADY-SENT
  6145*          PERFORM 0020-SEND-BUFFER
  6146*                                THRU 0020-EXIT
  6147*          SET ALREADY-SENT      TO TRUE
  6148*       END-IF
  6149*       PERFORM 0025-CLOSE-SOCKET
  6150*                                THRU 0025-EXIT
  6151*       GO TO 0010-RETURN
  6152     END-IF
  6153     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  6154                                    WS-TOT-LF-RFND
  6155     IF (WS-LF-STATUS = SPACES)
  6156        OR (CP-CALC-REFUND > ZEROS)
  6157        MOVE 'A'                 TO WS-LF-STATUS
  6158     END-IF
  6159     EVALUATE TRUE
  6160        WHEN CP-R-AS-R78
  6161           MOVE 'RULE 78'          TO  WS-LF-METHOD
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 108
* SOCK03.cbl
  6162        WHEN  CP-R-AS-PRORATA
  6163           MOVE 'PRORATA'          TO  WS-LF-METHOD
  6164        WHEN CP-R-AS-CALIF
  6165           MOVE 'CALIF'            TO  WS-LF-METHOD
  6166        WHEN CP-R-AS-TEXAS
  6167           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6168        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6169           MOVE 'UTAH'             TO  WS-LF-METHOD
  6170        WHEN CP-R-AS-FARM-PLAN
  6171           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6172        WHEN CP-R-AS-NET-PAY
  6173           MOVE 'NET PAY'          TO  WS-LF-METHOD
  6174        WHEN CP-R-AS-ANTICIPATION
  6175           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  6176        WHEN CP-R-AS-MEAN
  6177           MOVE 'MEAN'             TO  WS-LF-METHOD
  6178        WHEN CP-R-AS-SUM-OF-DIGITS
  6179           MOVE 'SUM OF DIGITS'    TO  WS-LF-METHOD
  6180        WHEN CP-R-AS-REPOSSESSION
  6181           MOVE 'REPOSSESSION'     TO  WS-LF-METHOD
  6182     END-EVALUATE
  6183     IF WS-TOT-LF-RFND > ZEROS
  6184        COMPUTE WS-WORK-FACTOR ROUNDED =
  6185           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  6186        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  6187           WS-TOT-LF-COMM
  6188     END-IF
  6189     IF ERACCT-FOUND
  6190        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6191           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6192        END-IF
  6193        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6194           IF (AM-COMM-CHARGEBACK (1) = 99)
  6195                     OR
  6196              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6197                     OR
  6198              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6199              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6200              MOVE ZEROS         TO WS-LF-UEC
  6201           END-IF
  6202        END-IF
  6203     END-IF
  6204     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  6205        GO TO 0400-EXIT
  6206     END-IF
  6207     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6208     MOVE '2'                    TO  CP-EARNING-METHOD
  6209                                     CP-RATING-METHOD.
  6210     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6211                                     CP-REMAINING-BENEFIT
  6212                                     CP-RATING-BENEFIT-AMT.
  6213     IF CP-STATE-STD-ABBRV = 'OR'
  6214         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6215                                         CM-LF-ALT-BENEFIT-AMT.
  6216     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6217     IF ws-comp-id = 'CID'
  6218        IF (CP-STATE-STD-ABBRV = 'MN')
  6219           AND (CM-CERT-EFF-DT > X'A4FF')
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 109
* SOCK03.cbl
  6220           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6221           MOVE '5'              TO CP-EARNING-METHOD
  6222           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6223        END-IF
  6224     END-IF
  6225     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6226     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  6227     IF (CP-ERROR-RATE-IS-ZERO)
  6228        OR (CP-ERROR-RATE-NOT-FOUND)
  6229        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6230        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  6231          DELIMITED BY SIZE INTO WS-COMMENT
  6232        END-STRING
  6233        MOVE 'X'              TO WS-LF-STATUS
  6234        GO TO 0400-EXIT
  6235*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6236*       IF NOT ALREADY-SENT
  6237*          PERFORM 0020-SEND-BUFFER
  6238*                                THRU 0020-EXIT
  6239*          SET ALREADY-SENT      TO TRUE
  6240*       END-IF
  6241*       PERFORM 0025-CLOSE-SOCKET
  6242*                                THRU 0025-EXIT
  6243*       GO TO 0010-RETURN
  6244     END-IF
  6245     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  6246     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  6247     IF WS-TOT-LF-RFND > ZEROS
  6248        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  6249           WS-TOT-LF-COMM
  6250     END-IF
  6251     IF ERACCT-FOUND
  6252        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6253           IF (AM-COMM-CHARGEBACK (1) = 99)
  6254                     OR
  6255              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6256                     OR
  6257              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6258              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6259              MOVE ZEROS         TO WS-LF-UEC
  6260           END-IF
  6261        END-IF
  6262     END-IF
  6263     .
  6264 0400-EXIT.
  6265     EXIT.
  6266 0500-PROCESS-AH.
  6267     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  6268        GO TO 0500-EXIT
  6269     END-IF
  6270     MOVE ZEROS                  TO WS-TOT-AH-RFND
  6271                                    WS-TOT-AH-PREM
  6272                                    WS-TOT-AH-COMM
  6273                                    WS-AH-CANCEL-DATE
  6274     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  6275     MOVE ' '                    TO  DC-OPTION-CODE
  6276     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6277     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 110
* SOCK03.cbl
  6278        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  6279     ELSE
  6280        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  6281     END-IF
  6282     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6283        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  6284        MOVE ' '                 TO DC-OPTION-CODE
  6285
  6286        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6287        IF NO-CONVERSION-ERROR
  6288           MOVE DC-GREG-DATE-CYMD TO WS-AH-CANCEL-DATE
  6289        ELSE
  6290           MOVE ZEROS            TO WS-AH-CANCEL-DATE
  6291        END-IF
  6292     END-IF
  6293     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  6294     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  6295     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  6296     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6297     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6298     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  6299     MOVE CM-STATE               TO  CP-STATE.
  6300     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6301     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6302     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6303     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6304     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  6305     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6306     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6307     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  6308     MOVE WS-CF-CR-REM-TERM-CALC
  6309                                 TO  CP-REM-TERM-METHOD.
  6310     IF WS-AH-CO-REM-TERM-CALC > '0'
  6311         MOVE WS-AH-CO-REM-TERM-CALC
  6312                                 TO  CP-REM-TERM-METHOD.
  6313     IF WS-AH-ST-REM-TERM-CALC > '0'
  6314         MOVE WS-AH-ST-REM-TERM-CALC
  6315                                 TO  CP-REM-TERM-METHOD.
  6316     IF WS-AH-AM-REM-TERM-CALC > '0'
  6317         MOVE WS-AH-AM-REM-TERM-CALC
  6318                                 TO  CP-REM-TERM-METHOD.
  6319     IF (WS-COMP-ID = 'CID')
  6320        AND (CP-STATE-STD-ABBRV = 'WI')
  6321        MOVE '7'                 TO CP-REM-TERM-METHOD
  6322        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6323     END-IF
  6324     IF (WS-COMP-ID = 'CID')
  6325        AND (CP-STATE-STD-ABBRV = 'MO')
  6326        AND (CM-CERT-EFF-DT >= X'9B41')
  6327        AND (CM-CERT-EFF-DT <= X'A2FB')
  6328        MOVE '7'                 TO CP-REM-TERM-METHOD
  6329        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6330     END-IF
  6331     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  6332                                     CP-LOAN-TERM.
  6333     IF  NOT  CP-TERM-IS-DAYS
  6334         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6335             MOVE CM-PMT-EXTENSION-DAYS
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 111
* SOCK03.cbl
  6336                                 TO  CP-TERM-OR-EXT-DAYS
  6337         ELSE
  6338             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6339     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  6340     IF CM-AH-COMM-PCT > ZEROS
  6341        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  6342           CM-AH-PREMIUM-AMT
  6343     END-IF
  6344     IF (ws-comp-id = 'DCC' or 'VPP')
  6345        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6346        compute ws-tot-ah-comm = cm-ah-premium-amt -
  6347           (cm-ah-clp + cm-addl-clp)
  6348     end-if
  6349     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  6350     IF WS-AH-STATUS = 'D'
  6351        GO TO 0500-EXIT
  6352     END-IF
  6353     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  6354     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  6355     MOVE ' '                    TO WS-CLM-STOP-SW
  6356     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6357     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6358
  6359* EXEC CICS STARTBR
  6360*       DATASET     ('ELMSTR5')
  6361*       RIDFLD      (ELMSTR-KEY)
  6362*       RESP        (WS-RESPONSE)
  6363*    END-EXEC
  6364     MOVE 'ELMSTR5' TO DFHEIV1
  6365     MOVE 0
  6366       TO DFHEIV11
  6367*    MOVE '&,         G          &  N#00005959' TO DFHEIV0
  6368     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6369     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6370     MOVE X'204E233030303035393539' TO DFHEIV0(25:11)
  6371     CALL 'kxdfhei1' USING DFHEIV0,
  6372           DFHEIV1,
  6373           ELMSTR-KEY,
  6374           DFHEIV99,
  6375           DFHEIV11,
  6376           DFHEIV99
  6377     MOVE EIBRESP  TO WS-RESPONSE
  6378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6379     DISPLAY ' AFTER START ' WS-RESPONSE
  6380     IF RESP-NORMAL
  6381        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6382           DISPLAY ' AH READNEXT '
  6383
  6384* EXEC CICS READNEXT
  6385*             DATASET   ('ELMSTR5')
  6386*             RIDFLD    (ELMSTR-KEY)
  6387*             INTO      (CLAIM-MASTER)
  6388*             RESP      (WS-RESPONSE)
  6389*          END-EXEC
  6390     MOVE LENGTH OF
  6391      CLAIM-MASTER
  6392       TO DFHEIV12
  6393     MOVE 'ELMSTR5' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 112
* SOCK03.cbl
  6394     MOVE 0
  6395       TO DFHEIV11
  6396*    MOVE '&.IL                  )  N#00005968' TO DFHEIV0
  6397     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6398     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6399     MOVE X'204E233030303035393638' TO DFHEIV0(25:11)
  6400     CALL 'kxdfhei1' USING DFHEIV0,
  6401           DFHEIV1,
  6402           CLAIM-MASTER,
  6403           DFHEIV12,
  6404           ELMSTR-KEY,
  6405           DFHEIV99,
  6406           DFHEIV11,
  6407           DFHEIV99,
  6408           DFHEIV99
  6409     MOVE EIBRESP  TO WS-RESPONSE
  6410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6411        IF (RESP-NORMAL OR RESP-DUPKEY)
  6412           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6413           AND (CM-CERT-NO = CL-CERT-NO)
  6414           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6415              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6416              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6417                 IF CLAIM-IS-OPEN
  6418                    DISPLAY ' FOUND OPEN AH CLAIM '
  6419                    MOVE ' OPEN HEALTH CLAIM '
  6420                                 TO WS-COMMENT
  6421                    MOVE 'H'     TO WS-AH-STATUS
  6422                 ELSE
  6423                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6424                    MOVE ' CLOSED HEALTH CLAIM '
  6425                                 TO WS-COMMENT
  6426                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6427                       MOVE CL-PAID-THRU-DT
  6428                                 TO WS-AH-BIN-PAID-THRU-DT
  6429                    END-IF
  6430                 END-IF
  6431              END-IF
  6432           END-IF
  6433        ELSE
  6434           SET I-SAY-TO-STOP TO TRUE
  6435        END-IF
  6436        END-PERFORM
  6437
  6438* EXEC CICS ENDBR
  6439*          DATASET   ('ELMSTR5')
  6440*       END-EXEC
  6441     MOVE 'ELMSTR5' TO DFHEIV1
  6442     MOVE 0
  6443       TO DFHEIV11
  6444*    MOVE '&2                    $   #00006000' TO DFHEIV0
  6445     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6446     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6447     MOVE X'2020233030303036303030' TO DFHEIV0(25:11)
  6448     CALL 'kxdfhei1' USING DFHEIV0,
  6449           DFHEIV1,
  6450           DFHEIV11,
  6451           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 113
* SOCK03.cbl
  6452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6453     END-IF
  6454     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6455*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6456        MOVE WS-AH-BIN-PAID-THRU-DT
  6457                                 TO DC-BIN-DATE-1
  6458        MOVE ' '                 TO DC-OPTION-CODE
  6459        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6460        IF NO-CONVERSION-ERROR
  6461           MOVE DC-GREG-DATE-CYMD
  6462                                 TO WS-CLM-PAID-THRU-DT
  6463        ELSE
  6464           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6465        END-IF
  6466        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6467           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6468                                 TO WS-COMMENT
  6469           MOVE 'P'              TO WS-AH-STATUS
  6470           GO TO 0500-EXIT
  6471        END-IF
  6472     END-IF
  6473     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6474     IF CM-AH-CURRENT-STATUS = '8'
  6475        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6476           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6477                                 TO WS-COMMENT
  6478           MOVE 'C'              TO WS-AH-STATUS
  6479           move cm-ah-itd-cancel-amt
  6480                                 to ws-ah-refund
  6481           GO TO 0500-EXIT
  6482        END-IF
  6483     END-IF
  6484     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6485        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6486           MOVE ' SETTLEMENT CLAIM APPLIED '
  6487                                 TO WS-COMMENT
  6488           MOVE 'S'              TO WS-AH-STATUS
  6489*          PERFORM 0030-BUILD-BUFFER
  6490*                                THRU 0030-EXIT
  6491*          IF NOT ALREADY-SENT
  6492*             PERFORM 0020-SEND-BUFFER
  6493*                                THRU 0020-EXIT
  6494*             SET ALREADY-SENT   TO TRUE
  6495*          END-IF
  6496           GO TO 0500-EXIT
  6497*          PERFORM 0025-CLOSE-SOCKET
  6498*                                THRU 0025-EXIT
  6499*          GO TO 0010-RETURN
  6500        END-IF
  6501     END-IF
  6502     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6503        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6504        MOVE 'AH COVERAGE EXPIRED '
  6505                                 TO WS-COMMENT
  6506        MOVE 'E'                 TO WS-AH-STATUS
  6507        GO TO 0500-EXIT
  6508     END-IF
  6509     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 114
* SOCK03.cbl
  6510                                    WS-AH-PREM
  6511     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6512     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6513        * CP-REMAINING-TERM-1
  6514     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6515                                     WS-AH-REM-TERM
  6516     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6517     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6518     IF WS-AH-ST-REFUND-CALC > ZERO
  6519         MOVE WS-AH-ST-REFUND-CALC
  6520                                 TO  CP-EARNING-METHOD.
  6521     IF WS-AH-FO-REFUND-CALC > ZERO
  6522         MOVE WS-AH-FO-REFUND-CALC
  6523                                 TO  CP-EARNING-METHOD.
  6524*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6525     if ws-comp-id = 'AHL'
  6526        move cm-ah-class-cd      to cp-class-code
  6527        if cp-class-code = spaces
  6528           move zeros            to cp-class-code
  6529        end-if
  6530     else
  6531        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6532     end-if
  6533     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6534     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6535                                     CP-RATING-BENEFIT-AMT.
  6536     IF CP-STATE-STD-ABBRV = 'OR'
  6537         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6538                                         CM-AH-ORIG-TERM.
  6539     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6540     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6541     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6542     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6543     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6544     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6545     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6546     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6547     MOVE ' '                    TO  DC-OPTION-CODE.
  6548     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6549     IF CP-STATE-STD-ABBRV = 'OH'
  6550        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6551         IF (CP-ORIGINAL-TERM > 60)
  6552           AND (DC-GREG-DATE-1-YMD > '831101')
  6553           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6554             MOVE '6'            TO  CP-EARNING-METHOD
  6555         END-IF
  6556        END-IF
  6557        IF WS-COMP-ID = 'CID'
  6558           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6559                           LOW-VALUES)
  6560              IF CP-CRITICAL-PERIOD
  6561                 MOVE '2'       TO CP-EARNING-METHOD
  6562              ELSE
  6563                 MOVE '6'       TO CP-EARNING-METHOD
  6564              END-IF
  6565           ELSE
  6566              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6567                 MOVE '2'       TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 115
* SOCK03.cbl
  6568              ELSE
  6569                 IF ((CM-LF-ORIG-TERM > 60) AND
  6570                    (CM-RATE-CLASS NOT = 'L '))
  6571                               OR
  6572                    (WS-LF-CO-EARNINGS-CALC = '5')
  6573                    IF CP-CRITICAL-PERIOD
  6574                       MOVE '2'  TO CP-EARNING-METHOD
  6575                    ELSE
  6576                       MOVE '6'  TO CP-EARNING-METHOD
  6577                    END-IF
  6578                 ELSE
  6579                    MOVE '1'     TO CP-EARNING-METHOD
  6580                 END-IF
  6581              END-IF
  6582           END-IF
  6583        END-IF
  6584     END-IF
  6585     IF CP-STATE-STD-ABBRV = 'VA'
  6586       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6587         IF DC-GREG-DATE-1-YMD > '921231'
  6588            IF CP-ORIGINAL-TERM > 61
  6589                MOVE '6'            TO  CP-EARNING-METHOD
  6590            ELSE
  6591                MOVE '1'            TO  CP-EARNING-METHOD.
  6592*    IF CP-EARN-AS-NET-PAY
  6593*       IF CP-LOAN-APR <= ZEROS
  6594*          IF WS-CF-DEFAULT-APR > ZEROS
  6595*             MOVE WS-CF-DEFAULT-APR
  6596*                                TO  CP-LOAN-APR
  6597*          END-IF
  6598*       END-IF
  6599*    END-IF
  6600     IF WS-COMP-ID = 'DCC' or 'VPP'
  6601        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6602           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6603           MOVE 'S'              TO CP-EARNING-METHOD
  6604        END-IF
  6605     END-IF
  6606     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6607     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6608        AND (CP-EARNING-METHOD = 'D')
  6609        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6610                                    WS-DDF-CSO-ADMIN-FEE
  6611                                    WS-DDF-1ST-YR-TOT-EXP
  6612                                    WS-DDF-COMM-AND-MFEE
  6613        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6614           S1 > +10
  6615           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6616              IF (AM-A-COM (S1) NUMERIC)
  6617                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6618                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6619              ELSE
  6620                 MOVE +0         TO WS-COMM-PCT C0
  6621                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6622                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6623              END-IF
  6624              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6625                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 116
* SOCK03.cbl
  6626                    + WS-COMM-PCT
  6627              END-IF
  6628              IF AM-COM-TYP (S1) = 'N'
  6629                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6630                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6631              END-IF
  6632              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6633                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6634                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6635              END-IF
  6636              IF AM-COM-TYP (S1) = 'I'
  6637                 COMPUTE WS-DDF-COMM-AND-MFEE
  6638                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6639              END-IF
  6640           END-IF
  6641        END-PERFORM
  6642        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6643        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6644        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6645           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6646     END-IF
  6647     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6648        AND (CP-EARNING-METHOD = 'D')
  6649        AND (ws-CANCEL-REASON NOT = 'R')
  6650        PERFORM 0730-GET-DDF-FACTORS
  6651                                 THRU 0730-EXIT
  6652        IF NOT PDEF-FOUND
  6653           MOVE ' DDF UE FACTORS  NOT FOUND '
  6654                                 TO WS-COMMENT
  6655           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6656           PERFORM 0030-BUILD-BUFFER
  6657                                 THRU 0030-EXIT
  6658           PERFORM 0020-SEND-BUFFER
  6659                                 THRU 0020-EXIT
  6660           PERFORM 0025-CLOSE-SOCKET
  6661                                 THRU 0025-EXIT
  6662           GO TO 0010-RETURN
  6663        END-IF
  6664*       IF NOT PDEF-FOUND
  6665*          MOVE ER-9999          TO EMI-ERROR
  6666*          PERFORM 9700-ERROR-FORMAT
  6667*                                THRU 9799-EXIT
  6668*          GO TO 8200-SEND-DATAONLY
  6669*       END-IF
  6670        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6671                                 TO CP-DDF-LO-FACT
  6672        MOVE PD-UEP-FACTOR (P1 P2)
  6673                                 TO CP-DDF-HI-FACT
  6674        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6675        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6676        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6677        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6678           + PD-1ST-YR-ADMIN-ALLOW
  6679        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6680*       IF PI-CLP-YN = 'Y'
  6681*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6682*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6683*                                   CP-DDF-CLP
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 117
* SOCK03.cbl
  6684*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6685*       END-IF
  6686        IF DD-IU-PRESENT
  6687           MOVE 'I'              TO CP-EARNING-METHOD
  6688        END-IF
  6689        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6690                                    CP-CLP-RATE-UP
  6691        IF (CP-CALC-GROSS-FEE)
  6692           AND (CP-IU-RATE-UP NOT = ZEROS)
  6693           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6694              / CP-ORIGINAL-PREMIUM)
  6695           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6696              / (1 - TEX-FACT-8)
  6697        END-IF
  6698     END-IF
  6699     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6700     IF (CP-ERROR-RATE-IS-ZERO)
  6701        OR (CP-ERROR-RATE-NOT-FOUND)
  6702        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6703        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6704          DELIMITED BY SIZE INTO WS-COMMENT
  6705        END-STRING
  6706        IF WS-AH-STATUS NOT = 'H'
  6707           MOVE 'X'                 TO WS-AH-STATUS
  6708        END-IF
  6709        GO TO 0500-EXIT
  6710*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6711*       IF NOT ALREADY-SENT
  6712*          PERFORM 0020-SEND-BUFFER
  6713*                                THRU 0020-EXIT
  6714*          SET ALREADY-SENT      TO TRUE
  6715*       END-IF
  6716*       PERFORM 0025-CLOSE-SOCKET
  6717*                                THRU 0025-EXIT
  6718*       GO TO 0010-RETURN
  6719     END-IF
  6720     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6721                                    WS-TOT-AH-RFND
  6722     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6723     IF ((WS-AH-STATUS = SPACES)
  6724        OR (CP-CALC-REFUND > ZEROS))
  6725                  AND
  6726          (WS-AH-STATUS NOT = 'H')
  6727        MOVE 'A'                 TO WS-AH-STATUS
  6728     END-IF
  6729     IF WS-COMP-ID = 'DCC' or 'VPP'
  6730        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6731        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6732        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6733        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6734        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6735        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6736        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6737        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6738        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6739     END-IF
  6740     EVALUATE TRUE
  6741        WHEN CP-R-AS-R78
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 118
* SOCK03.cbl
  6742           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6743        WHEN CP-R-AS-PRORATA
  6744           MOVE 'PRORATA'          TO  WS-AH-METHOD
  6745        WHEN CP-REFUND-TYPE-USED = '3'
  6746           MOVE 'CALIF'            TO  WS-AH-METHOD
  6747        WHEN CP-R-AS-TEXAS
  6748           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6749        WHEN CP-R-AS-FARM-PLAN
  6750           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6751        WHEN CP-R-AS-NET-PAY
  6752           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6753        WHEN CP-R-AS-ANTICIPATION
  6754           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6755        WHEN CP-R-AS-MEAN
  6756           MOVE 'MEAN'             TO  WS-AH-METHOD
  6757        WHEN CP-R-AS-SUM-OF-DIGITS
  6758           MOVE 'SUM OF DIGITS'    TO  WS-AH-METHOD
  6759        WHEN CP-GAP-ACTUARIAL
  6760           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6761        WHEN CP-R-AS-REPOSSESSION
  6762           MOVE 'REPOSSESSION'     TO WS-AH-METHOD
  6763     END-EVALUATE
  6764     IF WS-TOT-AH-RFND > ZEROS
  6765        IF (ws-comp-id = 'DCC' or 'VPP')
  6766           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6767           compute ws-work-factor rounded =
  6768              ws-ah-rfnd-clp / cm-ah-clp
  6769        else
  6770           COMPUTE WS-WORK-FACTOR ROUNDED =
  6771              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6772        end-if
  6773        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6774           WS-TOT-AH-COMM
  6775     END-IF
  6776     IF ERACCT-FOUND
  6777        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6778           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6779        END-IF
  6780        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6781           IF (AM-COMM-CHARGEBACK (1) = 99)
  6782                     OR
  6783              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6784                     OR
  6785              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6786              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6787              MOVE ZEROS         TO WS-AH-UEC
  6788           END-IF
  6789        END-IF
  6790     END-IF
  6791     .
  6792 0500-EXIT.
  6793     EXIT.
  6794 0610-GET-ERMAIL.
  6795
  6796     move cm-control-primary     to ws-ma-key
  6797*    MOVE WS-CM-KEY              TO WS-MA-KEY
  6798
  6799* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 119
* SOCK03.cbl
  6800*       INTO    (MAILING-DATA)
  6801*       DATASET ('ERMAIL')
  6802*       RIDFLD  (WS-MA-KEY)
  6803*       RESP    (WS-RESPONSE)
  6804*    END-EXEC
  6805     MOVE LENGTH OF
  6806      MAILING-DATA
  6807       TO DFHEIV11
  6808     MOVE 'ERMAIL' TO DFHEIV1
  6809*    MOVE '&"IL       E          (  N#00006348' TO DFHEIV0
  6810     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6811     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6812     MOVE X'204E233030303036333438' TO DFHEIV0(25:11)
  6813     CALL 'kxdfhei1' USING DFHEIV0,
  6814           DFHEIV1,
  6815           MAILING-DATA,
  6816           DFHEIV11,
  6817           WS-MA-KEY,
  6818           DFHEIV99,
  6819           DFHEIV99,
  6820           DFHEIV99
  6821     MOVE EIBRESP  TO WS-RESPONSE
  6822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6823
  6824     IF RESP-NORMAL
  6825        MOVE MA-CRED-BENE-NAME   to ws-cred-bene-name
  6826     else
  6827        move spaces              to ws-cred-bene-name
  6828     end-if
  6829
  6830     .
  6831 0610-EXIT.
  6832     EXIT.
  6833 0620-GET-ELCRTT.
  6834
  6835     move cm-control-primary     to ws-cs-key
  6836*    MOVE WS-CM-KEY              TO WS-CS-KEY
  6837     move 'C'                    to WS-CS-TRLR-TYPE
  6838
  6839
  6840* EXEC CICS READ
  6841*       INTO    (CERTIFICATE-TRAILERS)
  6842*       DATASET ('ELCRTT')
  6843*       RIDFLD  (WS-CS-KEY)
  6844*       RESP    (WS-RESPONSE)
  6845*    END-EXEC
  6846     MOVE LENGTH OF
  6847      CERTIFICATE-TRAILERS
  6848       TO DFHEIV11
  6849     MOVE 'ELCRTT' TO DFHEIV1
  6850*    MOVE '&"IL       E          (  N#00006370' TO DFHEIV0
  6851     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6852     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6853     MOVE X'204E233030303036333730' TO DFHEIV0(25:11)
  6854     CALL 'kxdfhei1' USING DFHEIV0,
  6855           DFHEIV1,
  6856           CERTIFICATE-TRAILERS,
  6857           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 120
* SOCK03.cbl
  6858           WS-CS-KEY,
  6859           DFHEIV99,
  6860           DFHEIV99,
  6861           DFHEIV99
  6862     MOVE EIBRESP  TO WS-RESPONSE
  6863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6864
  6865     IF RESP-NORMAL
  6866        MOVE cs-vin-number       to ws-vin
  6867     else
  6868        move spaces              to ws-vin
  6869     end-if
  6870
  6871     .
  6872 0620-EXIT.
  6873     EXIT.
  6874 0700-LINK-REM-TERM.
  6875
  6876* EXEC CICS LINK
  6877*        PROGRAM   ('ELRTRM')
  6878*        COMMAREA  (CALCULATION-PASS-AREA)
  6879*        LENGTH    (CP-COMM-LENGTH)
  6880*    END-EXEC.
  6881     MOVE 'ELRTRM' TO DFHEIV1
  6882*    MOVE '."C                   (   #00006387' TO DFHEIV0
  6883     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6885     MOVE X'2020233030303036333837' TO DFHEIV0(25:11)
  6886     CALL 'kxdfhei1' USING DFHEIV0,
  6887           DFHEIV1,
  6888           CALCULATION-PASS-AREA,
  6889           CP-COMM-LENGTH,
  6890           DFHEIV99,
  6891           DFHEIV99,
  6892           DFHEIV99,
  6893           DFHEIV99
  6894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6895
  6896 0700-EXIT.
  6897     EXIT.
  6898 0710-LINK-REM-AMOUNT.
  6899
  6900* EXEC CICS LINK
  6901*        PROGRAM   ('ELRAMT')
  6902*        COMMAREA  (CALCULATION-PASS-AREA)
  6903*        LENGTH    (CP-COMM-LENGTH)
  6904*    END-EXEC
  6905     MOVE 'ELRAMT' TO DFHEIV1
  6906*    MOVE '."C                   (   #00006395' TO DFHEIV0
  6907     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6909     MOVE X'2020233030303036333935' TO DFHEIV0(25:11)
  6910     CALL 'kxdfhei1' USING DFHEIV0,
  6911           DFHEIV1,
  6912           CALCULATION-PASS-AREA,
  6913           CP-COMM-LENGTH,
  6914           DFHEIV99,
  6915           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 121
* SOCK03.cbl
  6916           DFHEIV99,
  6917           DFHEIV99
  6918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6919     .
  6920 0710-EXIT.
  6921     EXIT.
  6922 0720-LINK-REFUND.
  6923
  6924* EXEC CICS LINK
  6925*        PROGRAM   ('ELRFND')
  6926*        COMMAREA  (CALCULATION-PASS-AREA)
  6927*        LENGTH    (CP-COMM-LENGTH)
  6928*    END-EXEC
  6929     MOVE 'ELRFND' TO DFHEIV1
  6930*    MOVE '."C                   (   #00006404' TO DFHEIV0
  6931     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6933     MOVE X'2020233030303036343034' TO DFHEIV0(25:11)
  6934     CALL 'kxdfhei1' USING DFHEIV0,
  6935           DFHEIV1,
  6936           CALCULATION-PASS-AREA,
  6937           CP-COMM-LENGTH,
  6938           DFHEIV99,
  6939           DFHEIV99,
  6940           DFHEIV99,
  6941           DFHEIV99
  6942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6943     .
  6944 0720-EXIT.
  6945     EXIT.
  6946 0730-GET-DDF-FACTORS.
  6947     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6948     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6949     MOVE CM-STATE               TO ERPDEF-STATE
  6950     if cm-clp-state not = cm-state and spaces and zeros
  6951        move cm-clp-state        to erpdef-state
  6952     end-if
  6953     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6954     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6955     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6956     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6957     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6958
  6959* EXEC CICS STARTBR
  6960*        DATASET  ('ERPDEF')
  6961*        RIDFLD   (ERPDEF-KEY)
  6962*        GTEQ
  6963*        RESP     (WS-RESPONSE)
  6964*    END-EXEC
  6965     MOVE 'ERPDEF' TO DFHEIV1
  6966     MOVE 0
  6967       TO DFHEIV11
  6968*    MOVE '&,         G          &  N#00006424' TO DFHEIV0
  6969     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6971     MOVE X'204E233030303036343234' TO DFHEIV0(25:11)
  6972     CALL 'kxdfhei1' USING DFHEIV0,
  6973           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 122
* SOCK03.cbl
  6974           ERPDEF-KEY,
  6975           DFHEIV99,
  6976           DFHEIV11,
  6977           DFHEIV99
  6978     MOVE EIBRESP  TO WS-RESPONSE
  6979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6980     IF NOT RESP-NORMAL
  6981        GO TO 0730-EXIT
  6982     END-IF
  6983     .
  6984 0730-READNEXT.
  6985
  6986* EXEC CICS READNEXT
  6987*       DATASET  ('ERPDEF')
  6988*       INTO     (PRODUCT-MASTER)
  6989*       RIDFLD   (ERPDEF-KEY)
  6990*       RESP     (WS-RESPONSE)
  6991*    END-EXEC
  6992     MOVE LENGTH OF
  6993      PRODUCT-MASTER
  6994       TO DFHEIV12
  6995     MOVE 'ERPDEF' TO DFHEIV1
  6996     MOVE 0
  6997       TO DFHEIV11
  6998*    MOVE '&.IL                  )  N#00006435' TO DFHEIV0
  6999     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7000     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7001     MOVE X'204E233030303036343335' TO DFHEIV0(25:11)
  7002     CALL 'kxdfhei1' USING DFHEIV0,
  7003           DFHEIV1,
  7004           PRODUCT-MASTER,
  7005           DFHEIV12,
  7006           ERPDEF-KEY,
  7007           DFHEIV99,
  7008           DFHEIV11,
  7009           DFHEIV99,
  7010           DFHEIV99
  7011     MOVE EIBRESP  TO WS-RESPONSE
  7012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7013     IF NOT RESP-NORMAL
  7014        GO TO 0730-ENDBR
  7015     END-IF
  7016     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7017        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7018           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7019        ELSE
  7020           GO TO 0730-READNEXT
  7021        END-IF
  7022     ELSE
  7023        GO TO 0730-ENDBR
  7024     END-IF
  7025     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7026        (P1 > +8)
  7027        OR (PD-PROD-CODE (P1) = 'I')
  7028     END-PERFORM
  7029     IF P1 < +9
  7030        SET DD-IU-PRESENT        TO TRUE
  7031     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 123
* SOCK03.cbl
  7032     IF CM-LOAN-TERM = ZEROS
  7033        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7034     END-IF
  7035     IF PD-TRUNCATED = 'Y'
  7036        MOVE CM-LOAN-TERM        TO WS-TERM
  7037     ELSE
  7038        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7039     END-IF
  7040     EVALUATE TRUE
  7041        WHEN WS-TERM > +168
  7042           MOVE 15               TO P1
  7043        WHEN WS-TERM > +156
  7044           MOVE 14               TO P1
  7045        WHEN WS-TERM > +144
  7046           MOVE 13               TO P1
  7047        WHEN WS-TERM > +132
  7048           MOVE 12               TO P1
  7049        WHEN WS-TERM > +120
  7050           MOVE 11               TO P1
  7051        WHEN WS-TERM > +108
  7052           MOVE 10               TO P1
  7053        WHEN WS-TERM > +96
  7054           MOVE 9                TO P1
  7055        WHEN WS-TERM > +84
  7056           MOVE 8                TO P1
  7057        WHEN WS-TERM > +72
  7058           MOVE 7                TO P1
  7059        WHEN WS-TERM > +60
  7060           MOVE 6                TO P1
  7061        WHEN WS-TERM > +48
  7062           MOVE 5                TO P1
  7063        WHEN WS-TERM > +36
  7064           MOVE 4                TO P1
  7065        WHEN WS-TERM > +24
  7066           MOVE 3                TO P1
  7067        WHEN WS-TERM > +12
  7068           MOVE 2                TO P1
  7069        WHEN OTHER
  7070           MOVE 1                TO P1
  7071     END-EVALUATE
  7072     EVALUATE TRUE
  7073*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7074*          AND (DD-IU-PRESENT)
  7075*          MOVE 2                TO P2
  7076*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7077*          MOVE 1                TO P2
  7078        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7079           MOVE 2                TO P2
  7080        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7081           MOVE 3                TO P2
  7082        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7083           MOVE 4                TO P2
  7084        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7085           MOVE 5                TO P2
  7086        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7087           MOVE 6                TO P2
  7088        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7089           MOVE 7                TO P2
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 124
* SOCK03.cbl
  7090        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7091           MOVE 8                TO P2
  7092        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7093           MOVE 9                TO P2
  7094        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7095           MOVE 10               TO P2
  7096        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7097           MOVE 11               TO P2
  7098        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7099           MOVE 12               TO P2
  7100        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7101           MOVE 13               TO P2
  7102        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7103           MOVE 14               TO P2
  7104        WHEN OTHER
  7105           MOVE 15               TO P2
  7106     END-EVALUATE
  7107     .
  7108 0730-ENDBR.
  7109
  7110* EXEC CICS ENDBR
  7111*       DATASET  ('ERPDEF')
  7112*    END-EXEC
  7113     MOVE 'ERPDEF' TO DFHEIV1
  7114     MOVE 0
  7115       TO DFHEIV11
  7116*    MOVE '&2                    $   #00006537' TO DFHEIV0
  7117     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7118     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7119     MOVE X'2020233030303036353337' TO DFHEIV0(25:11)
  7120     CALL 'kxdfhei1' USING DFHEIV0,
  7121           DFHEIV1,
  7122           DFHEIV11,
  7123           DFHEIV99
  7124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7125     .
  7126 0730-EXIT.
  7127     EXIT.
  7128 0740-GET-ERCTBL.
  7129     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7130     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7131     MOVE 'A'                    TO CTBL-BEN-TYPE
  7132     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7133     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7134     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7135     IF RESP-NORMAL
  7136        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7137     ELSE
  7138        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7139        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7140        MOVE 'A'                    TO CTBL-BEN-TYPE
  7141        MOVE 'AA'                   TO CTBL-BEN-CODE
  7142        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7143        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7144        IF RESP-NORMAL
  7145           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7146        END-IF
  7147     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 125
* SOCK03.cbl
  7148     .
  7149 0740-EXIT.
  7150     EXIT.
  7151 0750-READ-ERCTBL.
  7152
  7153* EXEC CICS READ
  7154*         INTO    (COMM-TABLE-RECORD)
  7155*         DATASET ('ERCTBL')
  7156*         RIDFLD  (CTBL-KEY)
  7157*         RESP    (WS-RESPONSE)
  7158*    END-EXEC
  7159     MOVE LENGTH OF
  7160      COMM-TABLE-RECORD
  7161       TO DFHEIV11
  7162     MOVE 'ERCTBL' TO DFHEIV1
  7163*    MOVE '&"IL       E          (  N#00006567' TO DFHEIV0
  7164     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7165     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7166     MOVE X'204E233030303036353637' TO DFHEIV0(25:11)
  7167     CALL 'kxdfhei1' USING DFHEIV0,
  7168           DFHEIV1,
  7169           COMM-TABLE-RECORD,
  7170           DFHEIV11,
  7171           CTBL-KEY,
  7172           DFHEIV99,
  7173           DFHEIV99,
  7174           DFHEIV99
  7175     MOVE EIBRESP  TO WS-RESPONSE
  7176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7177     .
  7178 0750-EXIT.
  7179     EXIT.
  7180 0760-FIND-COMM.
  7181     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7182        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7183        OR (C1 > +3)
  7184     END-PERFORM
  7185     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7186        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7187        OR (C2 > +3)
  7188     END-PERFORM
  7189     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7190        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7191        OR (C3 > +3)
  7192     END-PERFORM
  7193     IF C1 > +3
  7194        MOVE +1                  TO C1
  7195     END-IF
  7196     IF C2 > +3
  7197        MOVE +1                  TO C2
  7198     END-IF
  7199     IF C3 > +3
  7200        MOVE +1                  TO C3
  7201     END-IF
  7202     IF C1 = +3
  7203        MOVE +18                 TO C0
  7204     ELSE
  7205        IF C1 = +2
* Micro Focus Server Express         V5.1 revision 000 28-May-19 13:56 Page 126
* SOCK03.cbl
  7206           MOVE +9               TO C0
  7207        END-IF
  7208     END-IF
  7209     IF C2 = +3
  7210        ADD +6                   TO C0
  7211     ELSE
  7212        IF C2 = +2
  7213           ADD +3                TO C0
  7214        END-IF
  7215     END-IF
  7216     ADD C3                      TO C0
  7217     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7218     .
  7219 0760-EXIT.
  7220     EXIT.
  7221 9700-DATE-LINK.
  7222
  7223* EXEC CICS LINK
  7224*         PROGRAM  ('ELDATCV')
  7225*         COMMAREA (DATE-CONVERSION-DATA)
  7226*         LENGTH   (DC-COMM-LENGTH)
  7227*    END-EXEC.
  7228     MOVE 'ELDATCV' TO DFHEIV1
  7229*    MOVE '."C                   (   #00006618' TO DFHEIV0
  7230     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7232     MOVE X'2020233030303036363138' TO DFHEIV0(25:11)
  7233     CALL 'kxdfhei1' USING DFHEIV0,
  7234           DFHEIV1,
  7235           DATE-CONVERSION-DATA,
  7236           DC-COMM-LENGTH,
  7237           DFHEIV99,
  7238           DFHEIV99,
  7239           DFHEIV99,
  7240           DFHEIV99
  7241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7242
  7243 9700-EXIT.
  7244      EXIT.
  7245
  7246 9999-DFHBACK SECTION.
  7247     MOVE '9%                    "   ' TO DFHEIV0
  7248     MOVE 'SOCK03' TO DFHEIV1
  7249     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7250     GOBACK.
  7251 9999-DFHEXIT.
  7252     IF DFHEIGDJ EQUAL 0001
  7253         NEXT SENTENCE.
  7254     MOVE '9%                    "   ' TO DFHEIV0
  7255     MOVE 'SOCK03' TO DFHEIV1
  7256     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7257     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       20048     Code:       30189
