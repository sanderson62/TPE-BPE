* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   1
* EL650.cbl
* Options: int("EL650.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL650.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL650.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL650.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL650 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 07/14/94 14:53:46.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.048.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   2
* EL650.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC4 - ACCOUNT MASTER MAINTENANCE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL650AI FILLER
    38* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    39* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    40*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    41* 121207  CR2007121100001  PEMA  SPACE OUT ORIG DLR NO ON COPY
    42* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    43* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    44* 111513  IR2013110500003  PEMA  CORRECT MAINT FUNC OF "N"
    45* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    46* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    47******************************************************************
    48
    49 ENVIRONMENT DIVISION.
    50 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   3
* EL650.cbl
    52 WORKING-STORAGE SECTION.
    53 01  DFH-START PIC X(04).
    54 77  FILLER  PIC  X(32) VALUE '********************************'.
    55 77  FILLER  PIC  X(32) VALUE '*    EL650 WORKING STORAGE     *'.
    56 77  FILLER  PIC  X(32) VALUE '********* VMOD=2.048 ***********'.
    57 77  d1                      pic s999 value +0 comp-3.
    58
    59 01  WS-COMM-LENGTH          PIC S9(4) COMP VALUE +1500.
    60
    61 01  ws-display-eff-date     pic x(10) value spaces.
    62 01  ws-display-exp-date     pic x(10) value spaces.
    63 01  WS-DATE-AREA.
    64     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    65     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    66
    67 01  STANDARD-AREAS.
    68     12  GETMAIN-SPACE           PIC  X      VALUE SPACE.
    69     12  MAP-NAME                PIC  X(8)   VALUE 'EL650A'.
    70     12  MAPSET-NAME             PIC  X(8)   VALUE 'EL650S'.
    71     12  SCREEN-NUMBER           PIC  X(4)   VALUE '650A'.
    72     12  TRANS-ID                PIC  X(4)   VALUE 'EXC4'.
    73     12  EL6311-TRANS-ID         PIC  X(4)   VALUE 'EXB1'.
    74     12  vp6311-trans-id         pic  x(4)   value 'VPB1'.
    75     12  EL1273-TRANS-ID         PIC  X(4)   VALUE 'EXX3'.
    76     12  EL652-TRANS-ID          PIC  X(4)   VALUE 'EXD4'.
    77     12  EL6523-TRANS-ID         PIC  X(4)   VALUE 'EXDD'.
    78     12  EL6311NC-TRANS-ID       PIC  X(4)   VALUE 'NXB1'.
    79     12  EL640-TRANS-ID          PIC  X(4)   VALUE 'EXC1'.
    80     12  EL658-TRANS-ID          PIC  X(4)   VALUE 'EXJ3'.
    81     12  EL130-TRANS-ID          PIC  X(4)   VALUE 'EX19'.
    82     12  EL6503-TRANS-ID         PIC  X(4)   VALUE 'EXC7'.
    83     12  EL6509-TRANS-ID         PIC  X(4)   VALUE 'EXDA'.
    84     12  EL6592-TRANS-ID         PIC  X(4)   VALUE 'EX66'.
    85     12  EL608-TRANS-ID          PIC  X(4)   VALUE 'EX1E'.
    86     12  THIS-PGM                PIC  X(8)   VALUE 'EL650'.
    87     12  PGM-NAME                PIC  X(8).
    88     12  RETURNED-FROM           PIC  X(8)   VALUE SPACES.
    89     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
    90     12  TIME-OUT-R  REDEFINES  TIME-IN.
    91         16  FILLER              PIC  X.
    92         16  TIME-OUT            PIC  99V99.
    93         16  FILLER              PIC  XX.
    94     12  XCTL-005                PIC  X(8)   VALUE 'EL005'.
    95     12  XCTL-010                PIC  X(8)   VALUE 'EL010'.
    96     12  XCTL-126                PIC  X(8)   VALUE 'EL126'.
    97     12  XCTL-EL601              PIC  X(8)   VALUE 'EL601 '.
    98     12  XCTL-6501               PIC  X(8)   VALUE 'EL6501'.
    99     12  XCTL-6502               PIC  X(8)   VALUE 'EL6502'.
   100     12  XCTL-6503               PIC  X(8)   VALUE 'EL6503'.
   101     12  XCTL-6504               PIC  X(8)   VALUE 'EL6504'.
   102     12  XCTL-6505               PIC  X(8)   VALUE 'EL6505'.
   103     12  XCTL-6506               PIC  X(8)   VALUE 'EL6506'.
   104     12  XCTL-6508               PIC  X(8)   VALUE 'EL6508'.
   105     12  XCTL-6509               PIC  X(8)   VALUE 'EL6509'.
   106     12  LINK-001                PIC  X(8)   VALUE 'EL001'.
   107     12  LINK-004                PIC  X(8)   VALUE 'EL004'.
   108     12  LINK-ELDATCV            PIC  X(8)   VALUE 'ELDATCV'.
   109     12  FILE-ID                 PIC  X(8)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   4
* EL650.cbl
   110     12  CNTL-FILE-ID            PIC  X(8)   VALUE 'ELCNTL'.
   111     12  ACCT-FILE-ID            PIC  X(8)   VALUE 'ERACCT'.
   112     12  COMP-FILE-ID            PIC  X(8)   VALUE 'ERCOMP'.
   113     12  NAME-FILE-ID            PIC  X(8)   VALUE 'ERNAME'.
   114     12  PEND2-FILE-ID           PIC  X(8)   VALUE 'ERPNDB2'.
   115     12  PLAN-FILE-ID            PIC  X(8)   VALUE 'ERPLAN'.
   116     12  ACCT2-FILE-ID           PIC  X(8)   VALUE 'ERACCT2'.
   117     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   118     12  PLAN-REC-LEN            PIC S9(4)   VALUE +420   COMP.
   119     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   120     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   121     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   122     12  ERGXRF-FILE-ID          PIC  X(8)   VALUE 'ERGXRF'.
   123     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   124     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   125     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   126     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   127     12  BIN-MIN-DATE            PIC  XX     VALUE LOW-VALUES.
   128     12  BIN-MAX-DATE            PIC  XX     VALUE LOW-VALUES.
   129     12  B4-ACCT-KEY.
   130         16  B4-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   131         16  B4-ACCT-CARRIER     PIC  X      VALUE SPACES.
   132         16  B4-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   133         16  B4-ACCT-STATE       PIC  XX     VALUE SPACES.
   134         16  B4-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   135         16  B4-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   136         16  B4-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   137     12  AF-ACCT-KEY.
   138         16  AF-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   139         16  AF-ACCT-CARRIER     PIC  X      VALUE SPACES.
   140         16  AF-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   141         16  AF-ACCT-STATE       PIC  XX     VALUE SPACES.
   142         16  AF-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   143         16  AF-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   144         16  AF-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   145     12  GX-AM-CONTROL-PRIMARY.
   146         16  GX-AM-COMPANY-CD    PIC  X      VALUE LOW-VALUES.
   147         16  GX-REST-OF-KEY      PIC  X(21)  VALUE SPACES.
   148         16  GX-AM-CNTL-FILLER   PIC  X(4)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   5
* EL650.cbl
   150*                                copy ERCGXRF.
   151******************************************************************
   152*                                                                *
   153*                                                                *
   154*                            ERCGXRF                             *
   155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   156*                            VMOD=2.002                          *
   157*                                                                *
   158*   ONLINE CREDIT SYSTEM                                         *
   159*                                                                *
   160*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   161*                                                                *
   162*   FILE TYPE = VSAM,KSDS                                        *
   163*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   164*                                                                *
   165*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   166*       ALTERNATE PATH = NONE                                    *
   167*                                                                *
   168*   LOG = NO                                                     *
   169*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   170*                                                                *
   171******************************************************************
   172
   173 01  AGENT-CROSS-REFERENCE.
   174     12  GX-RECORD-ID                PIC XX.
   175         88  VALID-GX-ID             VALUE 'GX'.
   176
   177     12  GX-CONTROL-PRIMARY.
   178         16  GX-COMPANY-CD           PIC X.
   179         16  GX-CARRIER              PIC X.
   180         16  GX-GROUPING             PIC X(6).
   181         16  GX-AGENT-NO             PIC X(10).
   182
   183     12  GX-MAINT-INFORMATION.
   184         16  GX-LAST-MAINT-DT        PIC XX.
   185         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   186         16  GX-LAST-MAINT-USER      PIC X(4).
   187         16  FILLER                  PIC X(9).
   188
   189     12  FILLER                      PIC X(37).
   190
   191     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   192
   193     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   194                            DEPENDING ON GX-AGENT-POINTER-CNT.
   195         16  GX-AM-CARRIER           PIC X.
   196         16  GX-AM-GROUPING          PIC X(6).
   197         16  GX-AM-STATE             PIC XX.
   198         16  GX-AM-ACCOUNT           PIC X(10).
   199         16  GX-AM-EXPIRATION-DT     PIC XX.
   200         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   201         16  GX-LAST-BILL-DT         PIC XX.
   202         16  GX-AM-EFF-DT            PIC XX.
   203         16  FILLER                  PIC X(4).
   204
   205******************************************************************
   206 01  WORK-AREAS-AND-SWITCHES.
   207     12  WS-PAGE-LINES               PIC  S99    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   6
* EL650.cbl
   208     12  WS-ACCT2-FOUND              PIC  X      VALUE 'N'.
   209     12  GETMAIN-SW                  PIC  X      VALUE SPACES.
   210     12  NEW-KEY-SAVE.
   211         16  NEW-KEY-COMPANY-CD      PIC  X      VALUE LOW-VALUES.
   212         16  NEW-KEY-CNTRL           PIC  X(19)  VALUE SPACES.
   213     12  WS-PLAN-KEY.
   214         16  EK-CCGSA-KEY.
   215           18  EK-COMPANY-CD         PIC  X     VALUE LOW-VALUES.
   216           18  EK-CARRIER            PIC  X     VALUE SPACES.
   217           18  EK-GROUPING           PIC  X(6)  VALUE SPACES.
   218           18  EK-STATE              PIC  XX    VALUE SPACES.
   219           18  EK-ACCOUNT            PIC  X(10) VALUE SPACES.
   220         16  EK-BTYPE                PIC  X     VALUE SPACES.
   221         16  EK-BCODE                PIC  XX    VALUE SPACES.
   222         16  EK-REVISION             PIC  XXX   VALUE SPACES.
   223     12  WS-EXP-SAVE                 PIC  XX    VALUE LOW-VALUES.
   224     12  CURRENT-SAVE                PIC  X(6)  VALUE SPACES.
   225     12  SAVE-ACCT-KEY               PIC  X(26).
   226     12  SAVE-CURR-EXP-DT            PIC  XX    VALUE LOW-VALUES.
   227     12  SAVE-CURR-EFF-DT            PIC  XX    VALUE LOW-VALUES.
   228     12  WS-EFFCHG-SAVE              PIC  9(11) VALUE ZEROS.
   229     12  WS-EXPCHG-SAVE              PIC  9(11) VALUE ZEROS.
   230     12  BIN-CURRENT-SAVE            PIC  XX    VALUE LOW-VALUES.
   231     12  WS-VERIFY-AREA.
   232         16  FILLER      OCCURS  33  TIMES
   233                             INDEXED  BY  WS-INDEX.
   234             20  WS-ACCT-KEY         PIC  X(20).
   235             20  WS-ACCT-EXP-DT      PIC  XX.
   236             20  WS-ACCT-EFF-DT      PIC  XX.
   237             20  WS-ACCT-HI-CERT     PIC  XX.
   238             20  WS-ACCT-LO-CERT     PIC  XX.
   239     12  WS-TEST-KEY                 PIC  X(20)  VALUE SPACES.
   240     12  WS-SAVE-VERIFY-KEY          PIC  X(20)  VALUE SPACES.
   241     12  WS-ACCT-VERIFY-KEY.
   242         16  WS-ACCT-VER-COMP-CD     PIC  X      VALUE LOW-VALUES.
   243         16  WS-ACCT-VER-CARR        PIC  X      VALUE SPACES.
   244         16  WS-ACCT-VER-GROUP       PIC  X(6)   VALUE SPACES.
   245         16  WS-ACCT-VER-STATE       PIC  XX     VALUE SPACES.
   246         16  WS-ACCT-VER-ACCOUNT     PIC  X(10)  VALUE SPACES.
   247         16  WS-ACCT-VER-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   248     12  filler                      pic x(10)   value spaces.
   249     12  KEY-SAVE.
   250         16  SV-CO                   PIC  X      VALUE LOW-VALUES.
   251         16  SV-CARRIER              PIC  X      VALUE SPACES.
   252         16  SV-GROUPING             PIC  X(6)   VALUE SPACES.
   253         16  SV-STATE                PIC  XX     VALUE SPACES.
   254         16  SV-ACCOUNT              PIC  X(10)  VALUE SPACES.
   255
   256     12  WS-DEEDIT-FIELD              PIC X(10)  VALUE SPACES.
   257     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   258                                      PIC X(10).
   259     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   260         16  FILLER                   PIC X(4).
   261         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   262
   263     12  WS-AXRF-KEY.
   264         16  WS-AXRF-COMPANY-CD      PIC  X     VALUE LOW-VALUES.
   265         16  WS-AXRF-CARRIER         PIC  X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   7
* EL650.cbl
   266         16  WS-AXRF-GROUPING        PIC  X(6)  VALUE SPACES.
   267         16  WS-AXRF-AGENT-NO        PIC  X(10) VALUE SPACES.
   268     12  AXRF-SUB                    PIC S9(4) COMP VALUE +0.
   269     12  GX-AGENT-SUB                PIC S9(4) COMP VALUE +0.
   270     12  COMM-WORK-SUB               PIC S9(4) COMP VALUE +0.
   271     12  COMM-WORK-SUB2              PIC S9(4) COMP VALUE +0.
   272     12  ELCNTL-KEY.
   273         16  CNTL-COMP-ID            PIC  X(3) VALUE SPACES.
   274         16  CNTL-REC-TYPE           PIC  X    VALUE SPACES.
   275         16  CNTL-ACCESS.
   276             20  CNTL-STATE          PIC  XX   VALUE SPACES.
   277             20  FILLER              PIC  X    VALUE SPACES.
   278             20  CNTL-CARRIER        PIC  X    VALUE SPACES.
   279         16  CNTL-SEQ-NO             PIC S9(4) COMP VALUE +0.
   280     12  ERPNDB-KEY.
   281         16  PNDB-COMPANY-CD-A1      PIC  X  VALUE LOW-VALUES.
   282         16  PNDB-CARRIER            PIC  X    VALUE SPACES.
   283         16  PNDB-GROUPING           PIC  X(6) VALUE SPACES.
   284         16  PNDB-STATE              PIC  XX   VALUE SPACES.
   285         16  PNDB-ACCOUNT            PIC  X(10) VALUE SPACES.
   286         16  PNDB-CERT-EFF-DT        PIC  XX    VALUE LOW-VALUES.
   287         16  PNDB-CERT-NO            PIC  X(11) VALUE SPACES.
   288         16  PNDB-ALT-CHG-SEQ-NO     PIC S9(4)   COMP VALUE +0.
   289         16  PNDB-RECORD-TYPE        PIC  X   VALUE SPACES.
   290     12  REC-SW                      PIC  9          VALUE 0.
   291         88  REC-FOUND                               VALUE 1.
   292     12  K-WITH-LINE-USED            PIC  9          VALUE 0.
   293         88  K-WITH-LINE-NO                          VALUE 1.
   294     12  RETURN-FROM-SW              PIC  9          VALUE 0.
   295         88  RETURNING-FROM-6501                     VALUE 1.
   296     12  BROWSE-STARTED-SW           PIC  X          VALUE ' '.
   297         88  BROWSE-STARTED                          VALUE 'Y'.
   298     12  FIRST-TIME-SW               PIC  X          VALUE ' '.
   299         88  FIRST-TIME                              VALUE 'Y'.
   300     12  FROM-WHERE-SW               PIC  X          VALUE ' '.
   301         88  FROM-DELETE                             VALUE '1'.
   302         88  FROM-CHANGE                             VALUE '2'.
   303     12  FROM-EL608-SW               PIC  X          VALUE 'N'.
   304     12  PENDING-BUSINESS-SW         PIC  X          VALUE 'N'.
   305         88  THERE-IS-PENDING-BUSINESS               VALUE 'Y'.
   306     12  PENDING-BROWSE-SW           PIC  X          VALUE 'N'.
   307         88  PENDING-BROWSE-STARTED                  VALUE 'Y'.
   308     12  TS-QUEUE.
   309         16  TS-SCREEN               PIC  X(4)   VALUE SPACES.
   310         16  TS-TERM                 PIC  X(4)   VALUE SPACES.
   311     12  TS-LENGTH                   PIC S9(4) COMP VALUE +640.
   312     12  TS-ITEM                     PIC S9(4) COMP VALUE +0.
   313     12  AGT-SUB                     PIC 99      VALUE ZEROS.
   314     12  VALID-AGT-SW                PIC X       VALUE 'N'.
   315
   316 01  ERROR-MESSAGES.
   317     12  ER-0000             PIC  X(4)       VALUE '0000'.
   318     12  ER-0004             PIC  X(4)       VALUE '0004'.
   319     12  ER-0008             PIC  X(4)       VALUE '0008'.
   320     12  ER-0022             PIC  X(4)       VALUE '0022'.
   321     12  ER-0023             PIC  X(4)       VALUE '0023'.
   322     12  ER-0029             PIC  X(4)       VALUE '0029'.
   323     12  ER-0042             PIC  X(4)       VALUE '0042'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   8
* EL650.cbl
   324     12  ER-0050             PIC  X(4)       VALUE '0050'.
   325     12  ER-0052             PIC  X(4)       VALUE '0052'.
   326     12  ER-0066             PIC  X(4)       VALUE '0066'.
   327     12  ER-0067             PIC  X(4)       VALUE '0067'.
   328     12  ER-0070             PIC  X(4)       VALUE '0070'.
   329     12  ER-0144             PIC  X(4)       VALUE '0144'.
   330     12  ER-0168             PIC  X(4)       VALUE '0168'.
   331     12  ER-0193             PIC  X(4)       VALUE '0193'.
   332     12  ER-0195             PIC  X(4)       VALUE '0195'.
   333     12  ER-0216             PIC  X(4)       VALUE '0216'.
   334     12  ER-0226             PIC  X(4)       VALUE '0226'.
   335     12  ER-0348             PIC  X(4)       VALUE '0348'.
   336     12  ER-0453             PIC  X(4)       VALUE '0453'.
   337     12  ER-0454             PIC  X(4)       VALUE '0454'.
   338     12  ER-0455             PIC  X(4)       VALUE '0455'.
   339     12  ER-0456             PIC  X(4)       VALUE '0456'.
   340     12  ER-0457             PIC  X(4)       VALUE '0457'.
   341     12  ER-0470             PIC  X(4)       VALUE '0470'.
   342     12  ER-0471             PIC  X(4)       VALUE '0471'.
   343     12  ER-0472             PIC  X(4)       VALUE '0472'.
   344     12  ER-0482             PIC  X(4)       VALUE '0482'.
   345     12  ER-0561             PIC  X(4)       VALUE '0561'.
   346     12  ER-0619             PIC  X(4)       VALUE '0619'.
   347     12  ER-0630             PIC  X(4)       VALUE '0630'.
   348     12  ER-0668             PIC  X(4)       VALUE '0668'.
   349     12  ER-0899             PIC  X(4)       VALUE '0899'.
   350     12  ER-1220             PIC  X(4)       VALUE '1220'.
   351     12  ER-1228             PIC  X(4)       VALUE '1228'.
   352     12  ER-1238             PIC  X(4)       VALUE '1238'.
   353     12  ER-1299             PIC  X(4)       VALUE '1299'.
   354     12  ER-1612             PIC  X(4)       VALUE '1612'.
   355     12  ER-2051             PIC  X(4)       VALUE '2051'.
   356     12  ER-2052             PIC  X(4)       VALUE '2052'.
   357     12  ER-2053             PIC  X(4)       VALUE '2053'.
   358     12  ER-2054             PIC  X(4)       VALUE '2054'.
   359     12  ER-2058             PIC  X(4)       VALUE '2058'.
   360     12  ER-2059             PIC  X(4)       VALUE '2059'.
   361     12  ER-2060             PIC  X(4)       VALUE '2060'.
   362     12  ER-2061             PIC  X(4)       VALUE '2061'.
   363     12  ER-2062             PIC  X(4)       VALUE '2062'.
   364     12  ER-2063             PIC  X(4)       VALUE '2063'.
   365     12  ER-2064             PIC  X(4)       VALUE '2064'.
   366     12  ER-2065             PIC  X(4)       VALUE '2065'.
   367     12  ER-2066             PIC  X(4)       VALUE '2066'.
   368     12  ER-2068             PIC  X(4)       VALUE '2068'.
   369     12  ER-2069             PIC  X(4)       VALUE '2069'.
   370     12  ER-2070             PIC  X(4)       VALUE '2070'.
   371     12  ER-2072             PIC  X(4)       VALUE '2072'.
   372     12  ER-2073             PIC  X(4)       VALUE '2073'.
   373     12  ER-2074             PIC  X(4)       VALUE '2074'.
   374     12  ER-2075             PIC  X(4)       VALUE '2075'.
   375     12  ER-2087             PIC  X(4)       VALUE '2087'.
   376     12  ER-2113             PIC  X(4)       VALUE '2113'.
   377     12  ER-2151             PIC  X(4)       VALUE '2151'.
   378     12  ER-2370             PIC  X(4)       VALUE '2370'.
   379     12  ER-2572             PIC  X(4)       VALUE '2572'.
   380     12  ER-3155             PIC  X(4)       VALUE '3155'.
   381     12  ER-3785             PIC  X(4)       VALUE '3785'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   9
* EL650.cbl
   382     12  ER-9638             PIC  X(4)       VALUE '9638'.
   383     12  ER-9999             PIC  X(4)       VALUE '9999'.
   384
   385 01  TEMP-STORAGE-RECORD.
   386     12  TS-ACCT-KEY     OCCURS  32  TIMES
   387                             INDEXED  BY  TS-INDEX
   388                                 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  10
* EL650.cbl
   390*    COPY ELCSCTM.
   391******************************************************************
   392*                                                                *
   393*                                                                *
   394*                            ELCSCTM                             *
   395*                            VMOD=2.001                          *
   396*                                                                *
   397*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   398*                                                                *
   399******************************************************************
   400 01  SECURITY-MESSAGE.
   401     12  FILLER                          PIC X(30)
   402            VALUE '** LOGIC SECURITY VIOLATION -'.
   403     12  SM-READ                         PIC X(6).
   404     12  FILLER                          PIC X(5)
   405            VALUE ' PGM='.
   406     12  SM-PGM                          PIC X(6).
   407     12  FILLER                          PIC X(5)
   408            VALUE ' OPR='.
   409     12  SM-PROCESSOR-ID                 PIC X(4).
   410     12  FILLER                          PIC X(6)
   411            VALUE ' TERM='.
   412     12  SM-TERMID                       PIC X(4).
   413     12  FILLER                          PIC XX   VALUE SPACE.
   414     12  SM-JUL-DATE                     PIC 9(5).
   415     12  FILLER                          PIC X    VALUE SPACE.
   416     12  SM-TIME                         PIC 99.99.
   417
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  11
* EL650.cbl
   419*    COPY ELCSCRTY.
   420******************************************************************
   421*                                                                *
   422*                                                                *
   423*                            ELCSCRTY                            *
   424*                            VMOD=2.001                          *
   425*                                                                *
   426*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   427*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   428*        SAVED IN PI-SECURITY-ADDRESS.                           *
   429*                                                                *
   430******************************************************************
   431 01  SECURITY-CONTROL.
   432     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   433     12  FILLER                       PIC XX    VALUE 'SC'.
   434     12  SC-CREDIT-CODES.
   435         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   436             20  SC-CREDIT-DISPLAY    PIC X.
   437             20  SC-CREDIT-UPDATE     PIC X.
   438     12  SC-CLAIMS-CODES.
   439         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   440             20  SC-CLAIMS-DISPLAY    PIC X.
   441             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  12
* EL650.cbl
   443*    COPY ELCLOGOF.
   444******************************************************************
   445*                                                                *
   446*                                                                *
   447*                            ELCLOGOF.                           *
   448*                            VMOD=2.001                          *
   449*                                                                *
   450*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   451*                                                                *
   452******************************************************************
   453 01  CLASIC-LOGOFF.
   454     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   455     12  LOGOFF-TEXT.
   456         16  FILLER          PIC X(5)    VALUE SPACES.
   457         16  LOGOFF-MSG.
   458             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   459             20  FILLER      PIC X       VALUE SPACES.
   460             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   461         16  FILLER          PIC X(80)
   462           VALUE '* YOU ARE NOW LOGGED OFF'.
   463         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   464         16  FILLER          PIC X       VALUE QUOTE.
   465         16  LOGOFF-SYS-MSG  PIC X(17)
   466           VALUE 'S CLAS-IC SYSTEM '.
   467     12  TEXT-MESSAGES.
   468         16  UNACCESS-MSG    PIC X(29)
   469             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   470         16  PGMIDERR-MSG    PIC X(17)
   471             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  13
* EL650.cbl
   473*    COPY ELCDATE.
   474******************************************************************
   475*                                                                *
   476*                                                                *
   477*                            ELCDATE.                            *
   478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   479*                            VMOD=2.003
   480*                                                                *
   481*                                                                *
   482*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   483*                 LENGTH = 200                                   *
   484******************************************************************
   485
   486 01  DATE-CONVERSION-DATA.
   487     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   488     12  DC-OPTION-CODE                PIC X.
   489         88  BIN-TO-GREG                VALUE ' '.
   490         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   491         88  EDIT-GREG-TO-BIN           VALUE '2'.
   492         88  YMD-GREG-TO-BIN            VALUE '3'.
   493         88  MDY-GREG-TO-BIN            VALUE '4'.
   494         88  JULIAN-TO-BIN              VALUE '5'.
   495         88  BIN-PLUS-ELAPSED           VALUE '6'.
   496         88  FIND-CENTURY               VALUE '7'.
   497         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   498         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   499         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   500         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   501         88  JULIAN-TO-BIN-3            VALUE 'C'.
   502         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   503         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   504         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   505         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   506         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   507         88  CHECK-LEAP-YEAR            VALUE 'H'.
   508         88  BIN-3-TO-GREG              VALUE 'I'.
   509         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   510         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   511         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   512         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   513         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   514         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   515         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   516         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   517         88  THREE-CHARACTER-BIN
   518                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   519         88  GREGORIAN-TO-BIN
   520                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   521         88  BIN-TO-GREGORIAN
   522                  VALUES ' ' '1' 'I' '8' 'G'.
   523         88  JULIAN-TO-BINARY
   524                  VALUES '5' 'C' 'E' 'F'.
   525     12  DC-ERROR-CODE                 PIC X.
   526         88  NO-CONVERSION-ERROR        VALUE ' '.
   527         88  DATE-CONVERSION-ERROR
   528                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   529         88  DATE-IS-ZERO               VALUE '1'.
   530         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  14
* EL650.cbl
   531         88  DATE-IS-INVALID            VALUE '3'.
   532         88  DATE1-GREATER-DATE2        VALUE '4'.
   533         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   534         88  DATE-INVALID-OPTION        VALUE '9'.
   535         88  INVALID-CENTURY            VALUE 'A'.
   536         88  ONLY-CENTURY               VALUE 'B'.
   537         88  ONLY-LEAP-YEAR             VALUE 'C'.
   538         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   539     12  DC-END-OF-MONTH               PIC X.
   540         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   541     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   542         88  USE-NORMAL-PROCESS         VALUE ' '.
   543         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   544         88  ADJUST-UP-100-YRS          VALUE '2'.
   545     12  FILLER                        PIC X.
   546     12  DC-CONVERSION-DATES.
   547         16  DC-BIN-DATE-1             PIC XX.
   548         16  DC-BIN-DATE-2             PIC XX.
   549         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   550         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   551                       DC-GREG-DATE-1-EDIT.
   552             20  DC-EDIT1-MONTH        PIC 99.
   553             20  SLASH1-1              PIC X.
   554             20  DC-EDIT1-DAY          PIC 99.
   555             20  SLASH1-2              PIC X.
   556             20  DC-EDIT1-YEAR         PIC 99.
   557         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   558         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   559                     DC-GREG-DATE-2-EDIT.
   560             20  DC-EDIT2-MONTH        PIC 99.
   561             20  SLASH2-1              PIC X.
   562             20  DC-EDIT2-DAY          PIC 99.
   563             20  SLASH2-2              PIC X.
   564             20  DC-EDIT2-YEAR         PIC 99.
   565         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   566         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   567                     DC-GREG-DATE-1-YMD.
   568             20  DC-YMD-YEAR           PIC 99.
   569             20  DC-YMD-MONTH          PIC 99.
   570             20  DC-YMD-DAY            PIC 99.
   571         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   572         16  DC-GREG-DATE-1-MDY-R REDEFINES
   573                      DC-GREG-DATE-1-MDY.
   574             20  DC-MDY-MONTH          PIC 99.
   575             20  DC-MDY-DAY            PIC 99.
   576             20  DC-MDY-YEAR           PIC 99.
   577         16  DC-GREG-DATE-1-ALPHA.
   578             20  DC-ALPHA-MONTH        PIC X(10).
   579             20  DC-ALPHA-DAY          PIC 99.
   580             20  FILLER                PIC XX.
   581             20  DC-ALPHA-CENTURY.
   582                 24 DC-ALPHA-CEN-N     PIC 99.
   583             20  DC-ALPHA-YEAR         PIC 99.
   584         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   585         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   586         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   587         16  DC-JULIAN-DATE            PIC 9(05).
   588         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  15
* EL650.cbl
   589                                       PIC 9(05).
   590         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   591             20  DC-JULIAN-YEAR        PIC 99.
   592             20  DC-JULIAN-DAYS        PIC 999.
   593         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   594         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   595         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   596     12  DATE-CONVERSION-VARIBLES.
   597         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   598         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   599             20  FILLER                PIC 9(3).
   600             20  HOLD-CEN-1-CCYY.
   601                 24  HOLD-CEN-1-CC     PIC 99.
   602                 24  HOLD-CEN-1-YY     PIC 99.
   603             20  HOLD-CEN-1-MO         PIC 99.
   604             20  HOLD-CEN-1-DA         PIC 99.
   605         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   606             20  HOLD-CEN-1-R-MO       PIC 99.
   607             20  HOLD-CEN-1-R-DA       PIC 99.
   608             20  HOLD-CEN-1-R-CCYY.
   609                 24  HOLD-CEN-1-R-CC   PIC 99.
   610                 24  HOLD-CEN-1-R-YY   PIC 99.
   611             20  FILLER                PIC 9(3).
   612         16  HOLD-CENTURY-1-X.
   613             20  FILLER                PIC X(3)  VALUE SPACES.
   614             20  HOLD-CEN-1-X-CCYY.
   615                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   616                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   617             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   618             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   619         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   620             20  HOLD-CEN-1-R-X-MO     PIC XX.
   621             20  HOLD-CEN-1-R-X-DA     PIC XX.
   622             20  HOLD-CEN-1-R-X-CCYY.
   623                 24  HOLD-CEN-1-R-X-CC PIC XX.
   624                 24  HOLD-CEN-1-R-X-YY PIC XX.
   625             20  FILLER                PIC XXX.
   626         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   627         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   628         16  DC-JULIAN-DATE-1          PIC 9(07).
   629         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   630             20  DC-JULIAN-1-CCYY.
   631                 24  DC-JULIAN-1-CC    PIC 99.
   632                 24  DC-JULIAN-1-YR    PIC 99.
   633             20  DC-JULIAN-DA-1        PIC 999.
   634         16  DC-JULIAN-DATE-2          PIC 9(07).
   635         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   636             20  DC-JULIAN-2-CCYY.
   637                 24  DC-JULIAN-2-CC    PIC 99.
   638                 24  DC-JULIAN-2-YR    PIC 99.
   639             20  DC-JULIAN-DA-2        PIC 999.
   640         16  DC-GREG-DATE-A-EDIT.
   641             20  DC-EDITA-MONTH        PIC 99.
   642             20  SLASHA-1              PIC X VALUE '/'.
   643             20  DC-EDITA-DAY          PIC 99.
   644             20  SLASHA-2              PIC X VALUE '/'.
   645             20  DC-EDITA-CCYY.
   646                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  16
* EL650.cbl
   647                 24  DC-EDITA-YEAR     PIC 99.
   648         16  DC-GREG-DATE-B-EDIT.
   649             20  DC-EDITB-MONTH        PIC 99.
   650             20  SLASHB-1              PIC X VALUE '/'.
   651             20  DC-EDITB-DAY          PIC 99.
   652             20  SLASHB-2              PIC X VALUE '/'.
   653             20  DC-EDITB-CCYY.
   654                 24  DC-EDITB-CENT     PIC 99.
   655                 24  DC-EDITB-YEAR     PIC 99.
   656         16  DC-GREG-DATE-CYMD         PIC 9(08).
   657         16  DC-GREG-DATE-CYMD-R REDEFINES
   658                              DC-GREG-DATE-CYMD.
   659             20  DC-CYMD-CEN           PIC 99.
   660             20  DC-CYMD-YEAR          PIC 99.
   661             20  DC-CYMD-MONTH         PIC 99.
   662             20  DC-CYMD-DAY           PIC 99.
   663         16  DC-GREG-DATE-MDCY         PIC 9(08).
   664         16  DC-GREG-DATE-MDCY-R REDEFINES
   665                              DC-GREG-DATE-MDCY.
   666             20  DC-MDCY-MONTH         PIC 99.
   667             20  DC-MDCY-DAY           PIC 99.
   668             20  DC-MDCY-CEN           PIC 99.
   669             20  DC-MDCY-YEAR          PIC 99.
   670    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   671        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   672    12  DC-EL310-DATE                  PIC X(21).
   673    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  17
* EL650.cbl
   675*    COPY ELCATTR.
   676******************************************************************
   677*                                                                *
   678*                            ELCATTR.                            *
   679*                            VMOD=2.001                          *
   680*                                                                *
   681*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   682*                                                                *
   683*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   684*                                                                *
   685*                   POS 1   P=PROTECTED                          *
   686*                           U=UNPROTECTED                        *
   687*                           S=ASKIP                              *
   688*                   POS 2   A=ALPHA/NUMERIC                      *
   689*                           N=NUMERIC                            *
   690*                   POS 3   N=NORMAL                             *
   691*                           B=BRIGHT                             *
   692*                           D=DARK                               *
   693*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   694*                           OF=MODIFIED DATA TAG OFF             *
   695*                                                                *
   696*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   697******************************************************************
   698 01  ATTRIBUTE-LIST.
   699     12  AL-PABOF            PIC X       VALUE 'Y'.
   700     12  AL-PABON            PIC X       VALUE 'Z'.
   701     12  AL-PADOF            PIC X       VALUE '%'.
   702     12  AL-PADON            PIC X       VALUE '_'.
   703     12  AL-PANOF            PIC X       VALUE '-'.
   704     12  AL-PANON            PIC X       VALUE '/'.
   705     12  AL-SABOF            PIC X       VALUE '8'.
   706     12  AL-SABON            PIC X       VALUE '9'.
   707     12  AL-SADOF            PIC X       VALUE '@'.
   708     12  AL-SADON            PIC X       VALUE QUOTE.
   709     12  AL-SANOF            PIC X       VALUE '0'.
   710     12  AL-SANON            PIC X       VALUE '1'.
   711     12  AL-UABOF            PIC X       VALUE 'H'.
   712     12  AL-UABON            PIC X       VALUE 'I'.
   713     12  AL-UADOF            PIC X       VALUE '<'.
   714     12  AL-UADON            PIC X       VALUE '('.
   715     12  AL-UANOF            PIC X       VALUE ' '.
   716     12  AL-UANON            PIC X       VALUE 'A'.
   717     12  AL-UNBOF            PIC X       VALUE 'Q'.
   718     12  AL-UNBON            PIC X       VALUE 'R'.
   719     12  AL-UNDOF            PIC X       VALUE '*'.
   720     12  AL-UNDON            PIC X       VALUE ')'.
   721     12  AL-UNNOF            PIC X       VALUE '&'.
   722     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  18
* EL650.cbl
   724*    COPY ELCEMIB.
   725******************************************************************
   726*                                                                *
   727*                                                                *
   728*                            ELCEMIB.                            *
   729*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   730*                            VMOD=2.005                          *
   731*                                                                *
   732*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   733*                                                                *
   734******************************************************************
   735 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   736     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   737     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   738     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   739     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   740     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   741     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   742     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   743     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   744     12  EMI-SWITCH1             PIC X        VALUE '1'.
   745         88  EMI-NO-ERRORS                    VALUE '1'.
   746         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   747         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   748     12  EMI-SWITCH2             PIC X        VALUE '1'.
   749         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   750     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   751         88  EMI-AREA1-EMPTY                  VALUE '1'.
   752         88  EMI-AREA1-FULL                   VALUE '2'.
   753     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   754         88  EMI-AREA2-EMPTY                  VALUE '1'.
   755         88  EMI-AREA2-FULL                   VALUE '2'.
   756     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   757         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   758         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   759         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   760         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   761         88  EMI-BYPASS-FATALS                VALUE 'X'.
   762     12  EMI-ERROR-LINES.
   763         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   764         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   765         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   766         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   767             20  EMI-ERR-CODES OCCURS 10 TIMES.
   768                 24  EMI-ERR-NUM         PIC X(4).
   769                 24  EMI-FILLER          PIC X.
   770                 24  EMI-SEV             PIC X.
   771                 24  FILLER              PIC X.
   772             20  FILLER                  PIC X(02).
   773     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   774         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   775             20  EMI-ERROR-NUMBER    PIC X(4).
   776             20  EMI-FILL            PIC X.
   777             20  EMI-SEVERITY        PIC X.
   778             20  FILLER              PIC X.
   779             20  EMI-ERROR-TEXT.
   780                 24  EMI-TEXT-VARIABLE   PIC X(10).
   781                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  19
* EL650.cbl
   782     12  EMI-SEVERITY-SAVE           PIC X.
   783         88  EMI-NOTE                    VALUE 'N'.
   784         88  EMI-WARNING                 VALUE 'W'.
   785         88  EMI-FORCABLE                VALUE 'F'.
   786         88  EMI-FATAL                   VALUE 'X'.
   787     12  EMI-MESSAGE-FLAG            PIC X.
   788         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   789         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   790     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   791     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   792         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   793         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   794         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   795     12  emi-claim-no                pic x(7).
   796     12  emi-claim-type              pic x(6).
   797     12  FILLER                      PIC X(124)  VALUE SPACES.
   798     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   799     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   800     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   801     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  20
* EL650.cbl
   803*    COPY ELCINTF.
   804******************************************************************
   805*                                                                *
   806*                                                                *
   807*                            ELCINTF.                            *
   808*                            VMOD=2.017                          *
   809*                                                                *
   810*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   811*                                                                *
   812*       LENGTH = 1024                                            *
   813*                                                                *
   814******************************************************************
   815*                   C H A N G E   L O G
   816*
   817* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   818*-----------------------------------------------------------------
   819*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   820* EFFECTIVE    NUMBER
   821*-----------------------------------------------------------------
   822* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   823******************************************************************
   824 01  PROGRAM-INTERFACE-BLOCK.
   825     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   826     12  PI-CALLING-PROGRAM              PIC X(8).
   827     12  PI-SAVED-PROGRAM-1              PIC X(8).
   828     12  PI-SAVED-PROGRAM-2              PIC X(8).
   829     12  PI-SAVED-PROGRAM-3              PIC X(8).
   830     12  PI-SAVED-PROGRAM-4              PIC X(8).
   831     12  PI-SAVED-PROGRAM-5              PIC X(8).
   832     12  PI-SAVED-PROGRAM-6              PIC X(8).
   833     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   834     12  PI-COMPANY-ID                   PIC XXX.
   835     12  PI-COMPANY-CD                   PIC X.
   836
   837     12  PI-COMPANY-PASSWORD             PIC X(8).
   838
   839     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   840
   841     12  PI-CONTROL-IN-PROGRESS.
   842         16  PI-CARRIER                  PIC X.
   843         16  PI-GROUPING                 PIC X(6).
   844         16  PI-STATE                    PIC XX.
   845         16  PI-ACCOUNT                  PIC X(10).
   846         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   847                                         PIC X(10).
   848         16  PI-CLAIM-CERT-GRP.
   849             20  PI-CLAIM-NO             PIC X(7).
   850             20  PI-CERT-NO.
   851                 25  PI-CERT-PRIME       PIC X(10).
   852                 25  PI-CERT-SFX         PIC X.
   853             20  PI-CERT-EFF-DT          PIC XX.
   854         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   855             20  PI-PLAN-CODE            PIC X(2).
   856             20  PI-REVISION-NUMBER      PIC X(3).
   857             20  PI-PLAN-EFF-DT          PIC X(2).
   858             20  PI-PLAN-EXP-DT          PIC X(2).
   859             20  FILLER                  PIC X(11).
   860         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  21
* EL650.cbl
   861             20  PI-OE-REFERENCE-1.
   862                 25  PI-OE-REF-1-PRIME   PIC X(18).
   863                 25  PI-OE-REF-1-SUFF    PIC XX.
   864
   865     12  PI-SESSION-IN-PROGRESS          PIC X.
   866         88  CLAIM-SESSION                   VALUE '1'.
   867         88  CREDIT-SESSION                  VALUE '2'.
   868         88  WARRANTY-SESSION                VALUE '3'.
   869         88  MORTGAGE-SESSION                VALUE '4'.
   870         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   871
   872
   873*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   874
   875     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   876     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   877
   878     12  PI-CREDIT-USER                  PIC X.
   879         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   880         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   881
   882     12  PI-CLAIM-USER                   PIC X.
   883         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   884         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   885
   886     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   887         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   888         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   889         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   890         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   891         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   892
   893     12  PI-PROCESSOR-ID                 PIC X(4).
   894
   895     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   896
   897     12  PI-MEMBER-CAPTION               PIC X(10).
   898
   899     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   900         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   901
   902     12  PI-LIFE-OVERRIDE-L1             PIC X.
   903     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   904     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   905     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   906
   907     12  PI-AH-OVERRIDE-L1               PIC X.
   908     12  PI-AH-OVERRIDE-L2               PIC XX.
   909     12  PI-AH-OVERRIDE-L6               PIC X(6).
   910     12  PI-AH-OVERRIDE-L12              PIC X(12).
   911
   912     12  PI-NEW-SYSTEM                   PIC X(2).
   913
   914     12  PI-PRIMARY-CERT-NO              PIC X(11).
   915     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   916         88  PI-USES-PAID-TO                 VALUE '1'.
   917     12  PI-CRDTCRD-SYSTEM.
   918         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  22
* EL650.cbl
   919             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   920             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   921         16  PI-CC-MONTH-END-DT          PIC XX.
   922     12  PI-PROCESSOR-PRINTER            PIC X(4).
   923
   924     12  PI-OE-REFERENCE-2.
   925         16  PI-OE-REF-2-PRIME           PIC X(10).
   926         16  PI-OE-REF-2-SUFF            PIC X.
   927
   928     12  PI-REM-TRM-CALC-OPTION          PIC X.
   929
   930     12  PI-LANGUAGE-TYPE                PIC X.
   931             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   932             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   933             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   934
   935     12  PI-POLICY-LINKAGE-IND           PIC X.
   936         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   937         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   938                                                   LOW-VALUES.
   939
   940     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   941     12  PI-CLAIM-PW-SESSION             PIC X(1).
   942         88  PI-CLAIM-CREDIT                 VALUE '1'.
   943         88  PI-CLAIM-CONVEN                 VALUE '2'.
   944
   945     12  PI-PROCESSOR-CSR-IND            PIC X.
   946         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   947         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   948
   949     12  FILLER                          PIC X(3).
   950
   951     12  PI-SYSTEM-LEVEL                 PIC X(145).
   952
   953     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   954         PI-SYSTEM-LEVEL.
   955
   956         16  PI-ENTRY-CODES.
   957             20  PI-ENTRY-CD-1           PIC X.
   958             20  PI-ENTRY-CD-2           PIC X.
   959
   960         16  PI-RETURN-CODES.
   961             20  PI-RETURN-CD-1          PIC X.
   962             20  PI-RETURN-CD-2          PIC X.
   963
   964         16  PI-UPDATE-STATUS-SAVE.
   965             20  PI-UPDATE-BY            PIC X(4).
   966             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   967
   968         16  PI-LOWER-CASE-LETTERS       PIC X.
   969             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   970
   971*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   972*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   973*            88  CARRIER-CLM-CNTL            VALUE '2'.
   974
   975         16  PI-CERT-ACCESS-CONTROL      PIC X.
   976             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  23
* EL650.cbl
   977             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   978             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   979             88  ACCNT-CNTL                  VALUE '3'.
   980             88  CARR-ACCNT-CNTL             VALUE '4'.
   981
   982         16  PI-PROCESSOR-CAP-LIST.
   983             20  PI-SYSTEM-CONTROLS.
   984                24 PI-SYSTEM-DISPLAY     PIC X.
   985                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   986                24 PI-SYSTEM-MODIFY      PIC X.
   987                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   988             20  FILLER                  PIC XX.
   989             20  PI-DISPLAY-CAP          PIC X.
   990                 88  DISPLAY-CAP             VALUE 'Y'.
   991             20  PI-MODIFY-CAP           PIC X.
   992                 88  MODIFY-CAP              VALUE 'Y'.
   993             20  PI-MSG-AT-LOGON-CAP     PIC X.
   994                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   995             20  PI-FORCE-CAP            PIC X.
   996                 88  FORCE-CAP               VALUE 'Y'.
   997
   998         16  PI-PROGRAM-CONTROLS.
   999             20  PI-PGM-PRINT-OPT        PIC X.
  1000             20  PI-PGM-FORMAT-OPT       PIC X.
  1001             20  PI-PGM-PROCESS-OPT      PIC X.
  1002             20  PI-PGM-TOTALS-OPT       PIC X.
  1003
  1004         16  PI-HELP-INTERFACE.
  1005             20  PI-LAST-ERROR-NO        PIC X(4).
  1006             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1007
  1008         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1009             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1010
  1011         16  PI-CR-CONTROL-IN-PROGRESS.
  1012             20  PI-CR-CARRIER           PIC X.
  1013             20  PI-CR-GROUPING          PIC X(6).
  1014             20  PI-CR-STATE             PIC XX.
  1015             20  PI-CR-ACCOUNT           PIC X(10).
  1016             20  PI-CR-FIN-RESP          PIC X(10).
  1017             20  PI-CR-TYPE              PIC X.
  1018
  1019         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1020
  1021         16  PI-CR-MONTH-END-DT          PIC XX.
  1022
  1023         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1024             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1025             88  PI-ZERO-CARRIER             VALUE '1'.
  1026             88  PI-ZERO-GROUPING            VALUE '2'.
  1027             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1028
  1029         16  PI-CARRIER-SECURITY         PIC X.
  1030             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1031
  1032         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1033             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1034             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  24
* EL650.cbl
  1035
  1036         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1037             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1038                                         INDEXED BY PI-ACCESS-NDX
  1039                                         PIC X.
  1040
  1041         16  PI-GA-BILLING-CONTROL       PIC X.
  1042             88  PI-GA-BILLING               VALUE '1'.
  1043
  1044         16  PI-MAIL-PROCESSING          PIC X.
  1045             88  PI-MAIL-YES                 VALUE 'Y'.
  1046
  1047         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1048
  1049         16  PI-AR-SYSTEM.
  1050             20  PI-AR-PROCESSING-CNTL   PIC X.
  1051                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1052             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1053             20  PI-AR-MONTH-END-DT      PIC XX.
  1054
  1055         16  PI-MP-SYSTEM.
  1056             20  PI-MORTGAGE-USER            PIC X.
  1057                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1058                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1059             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1060                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1061                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1062                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1063                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1064                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1065             20  PI-MP-MONTH-END-DT          PIC XX.
  1066             20  PI-MP-REFERENCE-NO.
  1067                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1068                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1069
  1070         16  PI-LABEL-CONTROL            PIC X(01).
  1071             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1072             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1073
  1074         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1075             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1076
  1077         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1078             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1079             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1080
  1081         16  FILLER                      PIC X(14).
  1082
  1083     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1084******************************************************************
  1085*    COPY ELC650PI.
  1086******************************************************************
  1087*
  1088*                            ELC650PI.
  1089*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1090*                            VMOD=2.007
  1091*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1092*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  25
* EL650.cbl
  1093* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1094*
  1095******************************************************************
  1096
  1097     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1098         16  PI-MAINT                   PIC X.
  1099         16  PI-PREV-ACCOUNT            PIC X(20).
  1100         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1101         16  PI-ACCT-KEY.
  1102             20  PI-ACCT-CCGSA-KEY.
  1103                 24  PI-ACCT-CO             PIC X.
  1104                 24  PI-ACCT-CARRIER        PIC X.
  1105                 24  PI-ACCT-GROUPING       PIC X(6).
  1106                 24  PI-ACCT-STATE          PIC XX.
  1107                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1108             20  PI-ACCT-EXP-DT           PIC XX.
  1109             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1110         16  PI-ACCT-ID                 PIC X(8).
  1111         16  PI-PLAN-KEY.
  1112             20  PI-PLAN-ACCT-KEY.
  1113                 24  PI-PLAN-COMPANY-CD PIC X.
  1114                 24  PI-PLAN-CARRIER    PIC X.
  1115                 24  PI-PLAN-GROUP      PIC X(6).
  1116                 24  PI-PLAN-STATE      PIC X(2).
  1117                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1118             20  PI-PLAN-BEN-TYPE       PIC X.
  1119             20  PI-PLAN-BEN            PIC XX.
  1120             20  PI-PLAN-REVISION       PIC X(3).
  1121         16  PI-WS-STATE                PIC XX.
  1122         16  PI-WS-CLASS                PIC XX.
  1123         16  PI-WS-DEV                  PIC X(3).
  1124         16  PI-WS-TYPE                 PIC X.
  1125         16  PI-WS-PLAN                 PIC XX.
  1126
  1127         16  PI-ERPNDB-ALT-KEY.
  1128             20  PI-PB-COMPANY-CD-A1    PIC X.
  1129             20  PI-PB-CARRIER          PIC X.
  1130             20  PI-PB-GROUPING         PIC X(6).
  1131             20  PI-PB-STATE            PIC XX.
  1132             20  PI-PB-ACCOUNT          PIC X(10).
  1133             20  PI-PB-CERT-EFF-DT      PIC XX.
  1134             20  PI-PB-CERT-NO          PIC X(10).
  1135             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1136             20  PI-PB-RECORD-TYPE      PIC X.
  1137
  1138         16  PI-DATE-RANGE-TABLE.
  1139             20  PI-TABLE-ENT OCCURS 32 TIMES
  1140                            INDEXED BY T-INDEX.
  1141                 24  PI-BIN-EFF-DT          PIC XX.
  1142                 24  PI-BIN-EXP-DT          PIC XX.
  1143                 24  PI-BIN-MAINT-DT        PIC XX.
  1144                 24  PI-BIN-LO-CERT         PIC XX.
  1145                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1146                 24  PI-BIN-HI-CERT         PIC XX.
  1147         16  PI-PAGE-NUMBER             PIC S9.
  1148             88  PI-FST-PAGE               VALUE +1.
  1149             88  PI-2ND-PAGE               VALUE +2.
  1150             88  PI-3RD-PAGE               VALUE +3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  26
* EL650.cbl
  1151             88  PI-LST-PAGE               VALUE +4.
  1152         16  PI-TOTAL-LINES             PIC S99.
  1153         16  PI-LINE-SELECTED    PIC S9.
  1154***  Y2K PROJ 7744
  1155         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1156         16  BIN-EFFCHG-SAVE     PIC XX.
  1157         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1158***  Y2K PROJ 7744
  1159         16  BIN-EXPCHG-SAVE     PIC XX.
  1160         16  PI-RECORD-ADDED-SW  PIC X.
  1161             88  PI-RECORD-ADDED            VALUE '1'.
  1162             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1163         16  PI-ACCNAME          PIC X(30).
  1164         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1165         16  PI-SV-MAINT         PIC X.
  1166         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1167         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1168         16  PI-UPDATE-SW        PIC X.
  1169             88  PI-CHANGES-MADE             VALUE '1'.
  1170         16  PI-NOTE-TYPE        PIC X.
  1171             88  PI-ACCT-NOTE                VALUE '1'.
  1172         16  PI-DMD-FILE-SW      PIC X.
  1173             88  END-OF-FILE                 VALUE 'E'.
  1174             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1175             88  FIRST-OCCURS                VALUE 'F'.
  1176         16  PI-DMD-OCCURS       PIC S999.
  1177         16  PI-DMD-SCREEN       PIC X.
  1178             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1179             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1180             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1181         16  PI-NAMEFLG          PIC X.
  1182         16  PI-EL650-DEL-SW     PIC X.
  1183         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1184         16  PI-DCC-PROD-CODE    PIC XXX.
  1185         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  27
* EL650.cbl
  1187*          16  PI-NAMEFLG       PIC X.
  1188
  1189*    COPY ELCJPFX.
  1190******************************************************************
  1191*                                                                *
  1192*                                                                *
  1193*                            ELCJPFX.                            *
  1194*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1195*                            VMOD=2.002                          *
  1196*                                                                *
  1197*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1198*                                                                *
  1199*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1200*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1201*        ELCNTL - CONTROL FILE                                   *
  1202*        ELMSTR - CLAIM MASTERS                                  *
  1203*        ELTRLR - ACTIVITY TRAILERS                              *
  1204*        ELCHKQ - CHECK QUE                                      *
  1205******************************************************************
  1206 01  JOURNAL-RECORD.
  1207     12  jp-date                     pic s9(5) comp-3.
  1208     12  jp-time                     pic s9(7) comp-3.
  1209     12  JP-USER-ID                  PIC X(4).
  1210     12  JP-FILE-ID                  PIC X(8).
  1211     12  JP-PROGRAM-ID               PIC X(8).
  1212     12  JP-RECORD-TYPE              PIC X.
  1213         88 JP-ADD              VALUE 'A'.
  1214         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1215         88 JP-AFTER-CHANGE     VALUE 'C'.
  1216         88 JP-DELETE           VALUE 'D'.
  1217         88 JP-GENERIC-DELETE   VALUE 'G'.
  1218         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1219         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1220     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1221     12  JP-RECORD-AREA
  1222
  1223
  1224                                 PIC  X(2000).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  28
* EL650.cbl
  1226*    COPY ELCAID.
  1227******************************************************************
  1228*                                                                *
  1229*                            ELCAID.                             *
  1230*                            VMOD=2.001                          *
  1231*                                                                *
  1232*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1233*                                                                *
  1234*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1235*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1236******************************************************************
  1237
  1238 01  DFHAID.
  1239   02  DFHNULL   PIC  X  VALUE  ' '.
  1240   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1241   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1242   02  DFHPEN    PIC  X  VALUE  '='.
  1243   02  DFHOPID   PIC  X  VALUE  'W'.
  1244   02  DFHPA1    PIC  X  VALUE  '%'.
  1245   02  DFHPA2    PIC  X  VALUE  '>'.
  1246   02  DFHPA3    PIC  X  VALUE  ','.
  1247   02  DFHPF1    PIC  X  VALUE  '1'.
  1248   02  DFHPF2    PIC  X  VALUE  '2'.
  1249   02  DFHPF3    PIC  X  VALUE  '3'.
  1250   02  DFHPF4    PIC  X  VALUE  '4'.
  1251   02  DFHPF5    PIC  X  VALUE  '5'.
  1252   02  DFHPF6    PIC  X  VALUE  '6'.
  1253   02  DFHPF7    PIC  X  VALUE  '7'.
  1254   02  DFHPF8    PIC  X  VALUE  '8'.
  1255   02  DFHPF9    PIC  X  VALUE  '9'.
  1256   02  DFHPF10   PIC  X  VALUE  ':'.
  1257   02  DFHPF11   PIC  X  VALUE  '#'.
  1258   02  DFHPF12   PIC  X  VALUE  '@'.
  1259   02  DFHPF13   PIC  X  VALUE  'A'.
  1260   02  DFHPF14   PIC  X  VALUE  'B'.
  1261   02  DFHPF15   PIC  X  VALUE  'C'.
  1262   02  DFHPF16   PIC  X  VALUE  'D'.
  1263   02  DFHPF17   PIC  X  VALUE  'E'.
  1264   02  DFHPF18   PIC  X  VALUE  'F'.
  1265   02  DFHPF19   PIC  X  VALUE  'G'.
  1266   02  DFHPF20   PIC  X  VALUE  'H'.
  1267   02  DFHPF21   PIC  X  VALUE  'I'.
  1268*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1269   02  DFHPF22   PIC  X  VALUE  '['.
  1270   02  DFHPF23   PIC  X  VALUE  '.'.
  1271   02  DFHPF24   PIC  X  VALUE  '<'.
  1272   02  DFHMSRE   PIC  X  VALUE  'X'.
  1273   02  DFHSTRF   PIC  X  VALUE  'h'.
  1274   02  DFHTRIG   PIC  X  VALUE  '"'.
  1275
  1276 01  FILLER  REDEFINES  DFHAID.
  1277     12  FILLER              PIC  X(8).
  1278     12  PF-VALUES           PIC  X      OCCURS  24  TIMES.
  1279     12  FILLER              PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  29
* EL650.cbl
  1281*    COPY EL650S.
  1282 01  EL650AI.
  1283     05  FILLER            PIC  X(0012).
  1284*    -------------------------------
  1285     05  DATEL PIC S9(0004) COMP.
  1286     05  DATEF PIC  X(0001).
  1287     05  FILLER REDEFINES DATEF.
  1288         10  DATEA PIC  X(0001).
  1289     05  DATEI PIC  X(0008).
  1290*    -------------------------------
  1291     05  TIMEL PIC S9(0004) COMP.
  1292     05  TIMEF PIC  X(0001).
  1293     05  FILLER REDEFINES TIMEF.
  1294         10  TIMEA PIC  X(0001).
  1295     05  TIMEI PIC  X(0005).
  1296*    -------------------------------
  1297     05  CMPNYIDL PIC S9(0004) COMP.
  1298     05  CMPNYIDF PIC  X(0001).
  1299     05  FILLER REDEFINES CMPNYIDF.
  1300         10  CMPNYIDA PIC  X(0001).
  1301     05  CMPNYIDI PIC  X(0003).
  1302*    -------------------------------
  1303     05  USERIDL PIC S9(0004) COMP.
  1304     05  USERIDF PIC  X(0001).
  1305     05  FILLER REDEFINES USERIDF.
  1306         10  USERIDA PIC  X(0001).
  1307     05  USERIDI PIC  X(0004).
  1308*    -------------------------------
  1309     05  MAINTL PIC S9(0004) COMP.
  1310     05  MAINTF PIC  X(0001).
  1311     05  FILLER REDEFINES MAINTF.
  1312         10  MAINTA PIC  X(0001).
  1313     05  MAINTI PIC  X(0001).
  1314*    -------------------------------
  1315     05  TRNMSG1L PIC S9(0004) COMP.
  1316     05  TRNMSG1F PIC  X(0001).
  1317     05  FILLER REDEFINES TRNMSG1F.
  1318         10  TRNMSG1A PIC  X(0001).
  1319     05  TRNMSG1I PIC  X(0017).
  1320*    -------------------------------
  1321     05  LINEL PIC S9(0004) COMP.
  1322     05  LINEF PIC  X(0001).
  1323     05  FILLER REDEFINES LINEF.
  1324         10  LINEA PIC  X(0001).
  1325     05  LINEI PIC  9.
  1326*    -------------------------------
  1327     05  ACARIERL PIC S9(0004) COMP.
  1328     05  ACARIERF PIC  X(0001).
  1329     05  FILLER REDEFINES ACARIERF.
  1330         10  ACARIERA PIC  X(0001).
  1331     05  ACARIERI PIC  X(0001).
  1332*    -------------------------------
  1333     05  AGROUPL PIC S9(0004) COMP.
  1334     05  AGROUPF PIC  X(0001).
  1335     05  FILLER REDEFINES AGROUPF.
  1336         10  AGROUPA PIC  X(0001).
  1337     05  AGROUPI PIC  X(0006).
  1338*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  30
* EL650.cbl
  1339     05  ASTATEL PIC S9(0004) COMP.
  1340     05  ASTATEF PIC  X(0001).
  1341     05  FILLER REDEFINES ASTATEF.
  1342         10  ASTATEA PIC  X(0001).
  1343     05  ASTATEI PIC  X(0002).
  1344*    -------------------------------
  1345     05  AACCTL PIC S9(0004) COMP.
  1346     05  AACCTF PIC  X(0001).
  1347     05  FILLER REDEFINES AACCTF.
  1348         10  AACCTA PIC  X(0001).
  1349     05  AACCTI PIC  X(0010).
  1350*    -------------------------------
  1351     05  NAMEFLGL PIC S9(0004) COMP.
  1352     05  NAMEFLGF PIC  X(0001).
  1353     05  FILLER REDEFINES NAMEFLGF.
  1354         10  NAMEFLGA PIC  X(0001).
  1355     05  NAMEFLGI PIC  X(0001).
  1356*    -------------------------------
  1357     05  NAMEL PIC S9(0004) COMP.
  1358     05  NAMEF PIC  X(0001).
  1359     05  FILLER REDEFINES NAMEF.
  1360         10  NAMEA PIC  X(0001).
  1361     05  NAMEI PIC  X(0030).
  1362*    -------------------------------
  1363     05  ARHDGL PIC S9(0004) COMP.
  1364     05  ARHDGF PIC  X(0001).
  1365     05  FILLER REDEFINES ARHDGF.
  1366         10  ARHDGA PIC  X(0001).
  1367     05  ARHDGI PIC  X(0010).
  1368*    -------------------------------
  1369     05  DET1L PIC S9(0004) COMP.
  1370     05  DET1F PIC  X(0001).
  1371     05  FILLER REDEFINES DET1F.
  1372         10  DET1A PIC  X(0001).
  1373     05  DET1I PIC  X(0070).
  1374*    -------------------------------
  1375     05  DET2L PIC S9(0004) COMP.
  1376     05  DET2F PIC  X(0001).
  1377     05  FILLER REDEFINES DET2F.
  1378         10  DET2A PIC  X(0001).
  1379     05  DET2I PIC  X(0070).
  1380*    -------------------------------
  1381     05  DET3L PIC S9(0004) COMP.
  1382     05  DET3F PIC  X(0001).
  1383     05  FILLER REDEFINES DET3F.
  1384         10  DET3A PIC  X(0001).
  1385     05  DET3I PIC  X(0070).
  1386*    -------------------------------
  1387     05  DET4L PIC S9(0004) COMP.
  1388     05  DET4F PIC  X(0001).
  1389     05  FILLER REDEFINES DET4F.
  1390         10  DET4A PIC  X(0001).
  1391     05  DET4I PIC  X(0070).
  1392*    -------------------------------
  1393     05  DET5L PIC S9(0004) COMP.
  1394     05  DET5F PIC  X(0001).
  1395     05  FILLER REDEFINES DET5F.
  1396         10  DET5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  31
* EL650.cbl
  1397     05  DET5I PIC  X(0070).
  1398*    -------------------------------
  1399     05  DET6L PIC S9(0004) COMP.
  1400     05  DET6F PIC  X(0001).
  1401     05  FILLER REDEFINES DET6F.
  1402         10  DET6A PIC  X(0001).
  1403     05  DET6I PIC  X(0070).
  1404*    -------------------------------
  1405     05  DET7L PIC S9(0004) COMP.
  1406     05  DET7F PIC  X(0001).
  1407     05  FILLER REDEFINES DET7F.
  1408         10  DET7A PIC  X(0001).
  1409     05  DET7I PIC  X(0070).
  1410*    -------------------------------
  1411     05  DET8L PIC S9(0004) COMP.
  1412     05  DET8F PIC  X(0001).
  1413     05  FILLER REDEFINES DET8F.
  1414         10  DET8A PIC  X(0001).
  1415     05  DET8I PIC  X(0070).
  1416*    -------------------------------
  1417     05  TRNMSG2L PIC S9(0004) COMP.
  1418     05  TRNMSG2F PIC  X(0001).
  1419     05  FILLER REDEFINES TRNMSG2F.
  1420         10  TRNMSG2A PIC  X(0001).
  1421     05  TRNMSG2I PIC  X(0020).
  1422*    -------------------------------
  1423     05  EFFCHGL PIC S9(0004) COMP.
  1424     05  EFFCHGF PIC  X(0001).
  1425     05  FILLER REDEFINES EFFCHGF.
  1426         10  EFFCHGA PIC  X(0001).
  1427     05  EFFCHGI PIC  X(0008).
  1428*    -------------------------------
  1429     05  EXPCHGL PIC S9(0004) COMP.
  1430     05  EXPCHGF PIC  X(0001).
  1431     05  FILLER REDEFINES EXPCHGF.
  1432         10  EXPCHGA PIC  X(0001).
  1433     05  EXPCHGI PIC  X(0008).
  1434*    -------------------------------
  1435     05  TRNMSG3L PIC S9(0004) COMP.
  1436     05  TRNMSG3F PIC  X(0001).
  1437     05  FILLER REDEFINES TRNMSG3F.
  1438         10  TRNMSG3A PIC  X(0001).
  1439     05  TRNMSG3I PIC  X(0003).
  1440*    -------------------------------
  1441     05  TRNTOL PIC S9(0004) COMP.
  1442     05  TRNTOF PIC  X(0001).
  1443     05  FILLER REDEFINES TRNTOF.
  1444         10  TRNTOA PIC  X(0001).
  1445     05  TRNTOI PIC  X(0019).
  1446*    -------------------------------
  1447     05  TRNTODTL PIC S9(0004) COMP.
  1448     05  TRNTODTF PIC  X(0001).
  1449     05  FILLER REDEFINES TRNTODTF.
  1450         10  TRNTODTA PIC  X(0001).
  1451     05  TRNTODTI PIC  X(0008).
  1452*    -------------------------------
  1453     05  TRNMSG4L PIC S9(0004) COMP.
  1454     05  TRNMSG4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  32
* EL650.cbl
  1455     05  FILLER REDEFINES TRNMSG4F.
  1456         10  TRNMSG4A PIC  X(0001).
  1457     05  TRNMSG4I PIC  X(0005).
  1458*    -------------------------------
  1459     05  TRNFROML PIC S9(0004) COMP.
  1460     05  TRNFROMF PIC  X(0001).
  1461     05  FILLER REDEFINES TRNFROMF.
  1462         10  TRNFROMA PIC  X(0001).
  1463     05  TRNFROMI PIC  X(0019).
  1464*    -------------------------------
  1465     05  TRNFRDTL PIC S9(0004) COMP.
  1466     05  TRNFRDTF PIC  X(0001).
  1467     05  FILLER REDEFINES TRNFRDTF.
  1468         10  TRNFRDTA PIC  X(0001).
  1469     05  TRNFRDTI PIC  X(0008).
  1470*    -------------------------------
  1471     05  ERRMSG1L PIC S9(0004) COMP.
  1472     05  ERRMSG1F PIC  X(0001).
  1473     05  FILLER REDEFINES ERRMSG1F.
  1474         10  ERRMSG1A PIC  X(0001).
  1475     05  ERRMSG1I PIC  X(0075).
  1476*    -------------------------------
  1477     05  ERRMSG2L PIC S9(0004) COMP.
  1478     05  ERRMSG2F PIC  X(0001).
  1479     05  FILLER REDEFINES ERRMSG2F.
  1480         10  ERRMSG2A PIC  X(0001).
  1481     05  ERRMSG2I PIC  X(0075).
  1482*    -------------------------------
  1483     05  PFENTERL PIC S9(0004) COMP.
  1484     05  PFENTERF PIC  X(0001).
  1485     05  FILLER REDEFINES PFENTERF.
  1486         10  PFENTERA PIC  X(0001).
  1487     05  PFENTERI PIC  9(2).
  1488 01  EL650AO REDEFINES EL650AI.
  1489     05  FILLER            PIC  X(0012).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  DATEO PIC  X(0008).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  TIMEO PIC  99.99.
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  CMPNYIDO PIC  X(0003).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  USERIDO PIC  X(0004).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  MAINTO PIC  X(0001).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  TRNMSG1O PIC  X(0017).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  LINEO PIC  X(0001).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  33
* EL650.cbl
  1513     05  ACARIERO PIC  X(0001).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  AGROUPO PIC  X(0006).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  ASTATEO PIC  X(0002).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  AACCTO PIC  X(0010).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  NAMEFLGO PIC  X(0001).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  NAMEO PIC  X(0030).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  ARHDGO PIC  X(0010).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  DET1O PIC  X(0070).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  DET2O PIC  X(0070).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  DET3O PIC  X(0070).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  DET4O PIC  X(0070).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  DET5O PIC  X(0070).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  DET6O PIC  X(0070).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  DET7O PIC  X(0070).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  DET8O PIC  X(0070).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  TRNMSG2O PIC  X(0020).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  EFFCHGO PIC  X(0008).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  EXPCHGO PIC  99B99B99.
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  TRNMSG3O PIC  X(0003).
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  TRNTOO PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  34
* EL650.cbl
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  TRNTODTO PIC  X(0008).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  TRNMSG4O PIC  X(0005).
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  TRNFROMO PIC  X(0019).
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  TRNFRDTO PIC  X(0008).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  ERRMSG1O PIC  X(0075).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  ERRMSG2O PIC  X(0075).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  PFENTERO PIC  X(0002).
  1592*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  35
* EL650.cbl
  1594 01  EL650R  REDEFINES  EL650AI.
  1595     12  FILLER                      PIC  X(153).
  1596     12  MAP-RECORD-AREA.
  1597         16  DATE-RANGES     OCCURS  8  TIMES
  1598                                 INDEXED  BY  M-INDEX.
  1599             20  FILLER              PIC  X(3).
  1600             20  MAP-EFF-DT          PIC  X(8).
  1601             20  FILLER              PIC  X(6).
  1602             20  MAP-EXP-DT          PIC  X(8).
  1603             20  MAP-EXP-DT-ED  REDEFINES
  1604                 MAP-EXP-DT          PIC 99B99B99.
  1605             20  FILLER              PIC  X(4).
  1606             20  MAP-LST-MAINT-DT    PIC  X(8).
  1607             20  FILLER              PIC  X(3).
  1608             20  MAP-LOW-CERT        PIC  X(8).
  1609             20  FILLER              PIC  X(3).
  1610             20  MAP-HIGH-CERT       PIC  X(8).
  1611             20  FILLER              PIC  X(4).
  1612             20  MAP-AR-DATE         PIC  X(8).
  1613             20  FILLER              PIC  XX.
  1614     12  FILLER                      PIC  X(286).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  36
* EL650.cbl
  1616****************************************************************
  1617*
  1618* Copyright (c) 2007 by Clerity Solutions, Inc.
  1619* All rights reserved.
  1620*
  1621****************************************************************
  1622 01  DFHEIV.
  1623   02  DFHEIV0               PIC X(35).
  1624   02  DFHEIV1               PIC X(08).
  1625   02  DFHEIV2               PIC X(08).
  1626   02  DFHEIV3               PIC X(08).
  1627   02  DFHEIV4               PIC X(06).
  1628   02  DFHEIV5               PIC X(04).
  1629   02  DFHEIV6               PIC X(04).
  1630   02  DFHEIV7               PIC X(02).
  1631   02  DFHEIV8               PIC X(02).
  1632   02  DFHEIV9               PIC X(01).
  1633   02  DFHEIV10              PIC S9(7) COMP-3.
  1634   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1635   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1636   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1637   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1638   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1639   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1640   02  DFHEIV17              PIC X(04).
  1641   02  DFHEIV18              PIC X(04).
  1642   02  DFHEIV19              PIC X(04).
  1643   02  DFHEIV20              USAGE IS POINTER.
  1644   02  DFHEIV21              USAGE IS POINTER.
  1645   02  DFHEIV22              USAGE IS POINTER.
  1646   02  DFHEIV23              USAGE IS POINTER.
  1647   02  DFHEIV24              USAGE IS POINTER.
  1648   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1649   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1650   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1651   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1652   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1653   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1654   02  FILLER                PIC X(02).
  1655   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1656   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1657   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1658   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1659   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1660 LINKAGE  SECTION.
  1661*****************************************************************
  1662*                                                               *
  1663* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1664* All rights reserved.                                          *
  1665*                                                               *
  1666*****************************************************************
  1667 01  dfheiblk.
  1668     02  eibtime          pic s9(7) comp-3.
  1669     02  eibdate          pic s9(7) comp-3.
  1670     02  eibtrnid         pic x(4).
  1671     02  eibtaskn         pic s9(7) comp-3.
  1672     02  eibtrmid         pic x(4).
  1673     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  37
* EL650.cbl
  1674     02  eibcposn         pic s9(4) comp.
  1675     02  eibcalen         pic s9(4) comp.
  1676     02  eibaid           pic x(1).
  1677     02  eibfiller1       pic x(1).
  1678     02  eibfn            pic x(2).
  1679     02  eibfiller2       pic x(2).
  1680     02  eibrcode         pic x(6).
  1681     02  eibfiller3       pic x(2).
  1682     02  eibds            pic x(8).
  1683     02  eibreqid         pic x(8).
  1684     02  eibrsrce         pic x(8).
  1685     02  eibsync          pic x(1).
  1686     02  eibfree          pic x(1).
  1687     02  eibrecv          pic x(1).
  1688     02  eibsend          pic x(1).
  1689     02  eibatt           pic x(1).
  1690     02  eibeoc           pic x(1).
  1691     02  eibfmh           pic x(1).
  1692     02  eibcompl         pic x(1).
  1693     02  eibsig           pic x(1).
  1694     02  eibconf          pic x(1).
  1695     02  eiberr           pic x(1).
  1696     02  eibrldbk         pic x(1).
  1697     02  eiberrcd         pic x(4).
  1698     02  eibsynrb         pic x(1).
  1699     02  eibnodat         pic x(1).
  1700     02  eibfiller5       pic x(2).
  1701     02  eibresp          pic 9(09) comp.
  1702     02  eibresp2         pic 9(09) comp.
  1703     02  dfheigdj         pic s9(4) comp.
  1704     02  dfheigdk         pic s9(4) comp.
  1705 01  DFHCOMMAREA             PIC  X(1500).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  38
* EL650.cbl
  1707*01 PARMLIST .
  1708*    12  FILLER              PIC S9(8)   COMP.
  1709*    12  ERACCT-POINTER      PIC S9(8)   COMP.
  1710*    12  ERCOMP-POINTER      PIC S9(8)   COMP.
  1711*    12  ERNAME-POINTER      PIC S9(8)   COMP.
  1712*    12  ERPLAN-POINTER      PIC S9(8)   COMP.
  1713*    12  ELCNTL-POINTER      PIC S9(8)   COMP.
  1714*    12  ERPNDB-POINTER      PIC S9(8)   COMP.
  1715*    12  AXRF-POINTER        PIC S9(8)   COMP.
  1716*    12  AXRF2-POINTER       PIC S9(8)   COMP.
  1717*    12  AXRF3-POINTER       PIC S9(8)   COMP.
  1718*    12  AXRF4-POINTER       PIC S9(8)   COMP.
  1719*    12  AXRF5-POINTER       PIC S9(8)   COMP.
  1720*    12  AXRF6-POINTER       PIC S9(8)   COMP.
  1721*    12  AXRF7-POINTER       PIC S9(8)   COMP.
  1722*    12  AXRF8-POINTER       PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  39
* EL650.cbl
  1724*    COPY ERCACCT.
  1725******************************************************************
  1726*                                                                *
  1727*                                                                *
  1728*                            ERCACCT                             *
  1729*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1730*                            VMOD=2.031                          *
  1731*                                                                *
  1732*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1733*                                                                *
  1734*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1735*   VSAM ACCOUNT MASTER FILES.                                   *
  1736*                                                                *
  1737*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1738*                                                                *
  1739*   FILE TYPE = VSAM,KSDS                                        *
  1740*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1741*                                                                *
  1742*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1743*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1744*                                                                *
  1745*   LOG = NO                                                     *
  1746*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1747*                                                                *
  1748*                                                                *
  1749******************************************************************
  1750*                   C H A N G E   L O G
  1751*
  1752* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1753*-----------------------------------------------------------------
  1754*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1755* EFFECTIVE    NUMBER
  1756*-----------------------------------------------------------------
  1757* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1758* 092705    2005050300006  PEMA  ADD SPP LEASES
  1759* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1760* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1761* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1762* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1763* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1764******************************************************************
  1765
  1766 01  ACCOUNT-MASTER.
  1767     12  AM-RECORD-ID                      PIC XX.
  1768         88  VALID-AM-ID                      VALUE 'AM'.
  1769
  1770     12  AM-CONTROL-PRIMARY.
  1771         16  AM-COMPANY-CD                 PIC X.
  1772         16  AM-MSTR-CNTRL.
  1773             20  AM-CONTROL-A.
  1774                 24  AM-CARRIER            PIC X.
  1775                 24  AM-GROUPING.
  1776                     28 AM-GROUPING-PREFIX PIC XXX.
  1777                     28 AM-GROUPING-PRIME  PIC XXX.
  1778                 24  AM-STATE              PIC XX.
  1779                 24  AM-ACCOUNT.
  1780                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1781                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  40
* EL650.cbl
  1782             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1783                                           PIC X(19).
  1784             20  AM-CNTRL-B.
  1785                 24  AM-EXPIRATION-DT      PIC XX.
  1786                 24  FILLER                PIC X(4).
  1787             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1788                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1789
  1790     12  AM-CONTROL-BY-VAR-GRP.
  1791         16  AM-COMPANY-CD-A1              PIC X.
  1792         16  AM-VG-CARRIER                 PIC X.
  1793         16  AM-VG-GROUPING                PIC X(6).
  1794         16  AM-VG-STATE                   PIC XX.
  1795         16  AM-VG-ACCOUNT                 PIC X(10).
  1796         16  AM-VG-DATE.
  1797             20  AM-VG-EXPIRATION-DT       PIC XX.
  1798             20  FILLER                    PIC X(4).
  1799         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1800                                           PIC 9(11)      COMP-3.
  1801     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1802         16  FILLER                        PIC X(10).
  1803         16  AM-VG-KEY3.
  1804             20  AM-VG3-ACCOUNT            PIC X(10).
  1805             20  AM-VG3-EXP-DT             PIC XX.
  1806         16  FILLER                        PIC X(4).
  1807     12  AM-MAINT-INFORMATION.
  1808         16  AM-LAST-MAINT-DT              PIC XX.
  1809         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1810         16  AM-LAST-MAINT-USER            PIC X(4).
  1811         16  FILLER                        PIC XX.
  1812
  1813     12  AM-EFFECTIVE-DT                   PIC XX.
  1814     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1815
  1816     12  AM-PREV-DATES  COMP-3.
  1817         16  AM-PREV-EXP-DT                PIC 9(11).
  1818         16  AM-PREV-EFF-DT                PIC 9(11).
  1819
  1820     12  AM-REPORT-CODE-1                  PIC X(10).
  1821     12  AM-REPORT-CODE-2                  PIC X(10).
  1822
  1823     12  AM-CITY-CODE                      PIC X(4).
  1824     12  AM-COUNTY-PARISH                  PIC X(6).
  1825
  1826     12  AM-NAME                           PIC X(30).
  1827     12  AM-PERSON                         PIC X(30).
  1828     12  AM-ADDRS                          PIC X(30).
  1829     12  AM-CITY.
  1830         16  AM-ADDR-CITY                  PIC X(28).
  1831         16  AM-ADDR-STATE                 PIC XX.
  1832     12  AM-ZIP.
  1833         16  AM-ZIP-PRIME.
  1834             20  AM-ZIP-PRI-1ST            PIC X.
  1835                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1836             20  FILLER                    PIC X(4).
  1837         16  AM-ZIP-PLUS4                  PIC X(4).
  1838     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1839         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  41
* EL650.cbl
  1840         16  AM-CAN-POSTAL-2               PIC XXX.
  1841         16  FILLER                        PIC XXX.
  1842     12  AM-TEL-NO.
  1843         16  AM-AREA-CODE                  PIC 999.
  1844         16  AM-TEL-PRE                    PIC 999.
  1845         16  AM-TEL-NBR                    PIC 9(4).
  1846     12  AM-TEL-LOC                        PIC X.
  1847         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1848         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1849
  1850     12  AM-COMM-STRUCTURE.
  1851         16  AM-DEFN-1.
  1852             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1853                 24  AM-AGT.
  1854                     28  AM-AGT-PREFIX     PIC X(4).
  1855                     28  AM-AGT-PRIME      PIC X(6).
  1856                 24  AM-COM-TYP            PIC X.
  1857                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1858                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1859                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1860                 24  AM-RECALC-LV-INDIC    PIC X.
  1861                 24  AM-RETRO-LV-INDIC     PIC X.
  1862                 24  AM-GL-CODES           PIC X.
  1863                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1864                 24  FILLER                PIC X(01).
  1865         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1866             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1867                 24  FILLER                PIC X(11).
  1868                 24  AM-L-COMA             PIC XXX.
  1869                 24  AM-J-COMA             PIC XXX.
  1870                 24  AM-A-COMA             PIC XXX.
  1871                 24  FILLER                PIC X(6).
  1872
  1873     12  AM-COMM-CHANGE-STATUS             PIC X.
  1874         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1875
  1876     12  AM-CSR-CODE                       PIC X(4).
  1877
  1878     12  AM-BILLING-STATUS                 PIC X.
  1879         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1880         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1881     12  AM-AUTO-REFUND-SW                 PIC X.
  1882         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1883         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1884     12  AM-GPCD                           PIC 99.
  1885     12  AM-IG                             PIC X.
  1886         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1887         88  AM-HAS-GROUP                     VALUE '2'.
  1888     12  AM-STATUS                         PIC X.
  1889         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1890         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1891         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1892         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1893         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1894         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1895     12  AM-REMIT-TO                       PIC 99.
  1896     12  AM-ID-NO                          PIC X(11).
  1897
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  42
* EL650.cbl
  1898     12  AM-CAL-TABLE                      PIC XX.
  1899     12  AM-LF-DEVIATION                   PIC XXX.
  1900     12  AM-AH-DEVIATION                   PIC XXX.
  1901     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1902     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1903     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1904     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1905     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1906     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1907
  1908     12  AM-USER-FIELDS.
  1909         16  AM-FLD-1                      PIC XX.
  1910         16  AM-FLD-2                      PIC XX.
  1911         16  AM-FLD-3                      PIC XX.
  1912         16  AM-FLD-4                      PIC XX.
  1913         16  AM-FLD-5                      PIC XX.
  1914
  1915     12  AM-1ST-PROD-DATE.
  1916         16  AM-1ST-PROD-YR                PIC XX.
  1917         16  AM-1ST-PROD-MO                PIC XX.
  1918         16  AM-1ST-PROD-DA                PIC XX.
  1919     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1920     12  AM-CERTS-PURGED-DATE.
  1921         16  AM-PUR-YR                     PIC XX.
  1922         16  AM-PUR-MO                     PIC XX.
  1923         16  AM-PUR-DA                     PIC XX.
  1924     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1925     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1926     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1927     12  AM-INACTIVE-DATE.
  1928         16  AM-INA-MO                     PIC 99.
  1929         16  AM-INA-DA                     PIC 99.
  1930         16  AM-INA-YR                     PIC 99.
  1931     12  AM-AR-HI-CERT-DATE                PIC XX.
  1932
  1933     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1934     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1935
  1936     12  AM-OB-PAYMENT-MODE                PIC X.
  1937         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1938         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1939         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1940         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1941
  1942     12  AM-AH-ONLY-INDICATOR              PIC X.
  1943         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1944         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1945
  1946     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1947
  1948     12  AM-OVER-SHORT.
  1949         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1950         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1951
  1952     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1953     12  AM-DCC-CLP-STATE                  PIC XX.
  1954
  1955     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  43
* EL650.cbl
  1956     12  AM-RECALC-REIN                    PIC X.
  1957
  1958     12  AM-REI-TABLE                      PIC XXX.
  1959     12  AM-REI-ET-LF                      PIC X.
  1960     12  AM-REI-ET-AH                      PIC X.
  1961     12  AM-REI-PE-LF                      PIC X.
  1962     12  AM-REI-PE-AH                      PIC X.
  1963     12  AM-REI-PRT-ST                     PIC X.
  1964     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1965     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1966     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1967     12  AM-REI-GROUP-A                    PIC X(6).
  1968     12  AM-REI-MORT                       PIC X(4).
  1969     12  AM-REI-PRT-OW                     PIC X.
  1970     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1971     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1972     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1973     12  AM-REI-GROUP-B                    PIC X(6).
  1974
  1975     12  AM-TRUST-TYPE                     PIC X(2).
  1976
  1977     12  AM-EMPLOYER-STMT-USED             PIC X.
  1978     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1979
  1980     12  AM-STD-AH-TYPE                    PIC XX.
  1981     12  AM-EARN-METHODS.
  1982         16  AM-EARN-METHOD-R              PIC X.
  1983             88 AM-REF-RL-R78                 VALUE 'R'.
  1984             88 AM-REF-RL-PR                  VALUE 'P'.
  1985             88 AM-REF-RL-MEAN                VALUE 'M'.
  1986             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1987         16  AM-EARN-METHOD-L              PIC X.
  1988             88 AM-REF-LL-R78                 VALUE 'R'.
  1989             88 AM-REF-LL-PR                  VALUE 'P'.
  1990             88 AM-REF-LL-MEAN                VALUE 'M'.
  1991             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1992         16  AM-EARN-METHOD-A              PIC X.
  1993             88 AM-REF-AH-R78                 VALUE 'R'.
  1994             88 AM-REF-AH-PR                  VALUE 'P'.
  1995             88 AM-REF-AH-MEAN                VALUE 'M'.
  1996             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1997             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1998             88 AM-REF-AH-NET                 VALUE 'N'.
  1999
  2000     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2001     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2002     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2003
  2004     12  AM-RET-Y-N                        PIC X.
  2005     12  AM-RET-P-E                        PIC X.
  2006     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2007     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2008     12  AM-RET-GRP                        PIC X(6).
  2009     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2010         16  AM-POOL-PRIME                 PIC XXX.
  2011         16  AM-POOL-SUB                   PIC XXX.
  2012     12  AM-RETRO-EARNINGS.
  2013         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  44
* EL650.cbl
  2014         16  AM-RET-EARN-L                 PIC X.
  2015         16  AM-RET-EARN-A                 PIC X.
  2016     12  AM-RET-ST-TAX-USE                 PIC X.
  2017         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2018         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2019     12  AM-RETRO-BEG-EARNINGS.
  2020         16  AM-RET-BEG-EARN-R             PIC X.
  2021         16  AM-RET-BEG-EARN-L             PIC X.
  2022         16  AM-RET-BEG-EARN-A             PIC X.
  2023     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2024     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2025
  2026     12  AM-USER-SELECT-OPTIONS.
  2027         16  AM-USER-SELECT-1              PIC X(10).
  2028         16  AM-USER-SELECT-2              PIC X(10).
  2029         16  AM-USER-SELECT-3              PIC X(10).
  2030         16  AM-USER-SELECT-4              PIC X(10).
  2031         16  AM-USER-SELECT-5              PIC X(10).
  2032
  2033     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2034
  2035     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2036
  2037     12  AM-RPT045A-SWITCH                 PIC X.
  2038         88  RPT045A-OFF                   VALUE 'N'.
  2039
  2040     12  AM-INSURANCE-LIMITS.
  2041         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2042         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2043
  2044     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2045         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2046
  2047     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2048         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2049         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2050
  2051     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2052
  2053     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2054     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2055     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2056     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2057     12  AM-DCC-UEF-STATE                  PIC XX.
  2058     12  FILLER                            PIC XXX.
  2059     12  AM-REPORT-CODE-3                  PIC X(10).
  2060*    12  FILLER                            PIC X(22).
  2061
  2062     12  AM-RESERVE-DATE.
  2063         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2064         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2065         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2066
  2067     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2068     12  AM-NOTIFICATION-TYPES.
  2069         16  AM-NOTIF-OF-LETTERS           PIC X.
  2070         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2071         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  45
* EL650.cbl
  2072         16  AM-NOTIF-OF-STATUS            PIC X.
  2073
  2074     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2075         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2076         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2077         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2078         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2079
  2080     12  AM-BENEFIT-CONTROLS.
  2081         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2082             20  AM-BENEFIT-CODE           PIC XX.
  2083             20  AM-BENEFIT-TYPE           PIC X.
  2084             20  AM-BENEFIT-REVISION       PIC XXX.
  2085             20  AM-BENEFIT-REM-TERM       PIC X.
  2086             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2087             20  FILLER                    PIC XX.
  2088         16  FILLER                        PIC X(80).
  2089
  2090     12  AM-TRANSFER-DATA.
  2091         16  AM-TRANSFERRED-FROM.
  2092             20  AM-TRNFROM-CARRIER        PIC X.
  2093             20  AM-TRNFROM-GROUPING.
  2094                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2095                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2096             20  AM-TRNFROM-STATE          PIC XX.
  2097             20  AM-TRNFROM-ACCOUNT.
  2098                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2099                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2100             20  AM-TRNFROM-DTE            PIC XX.
  2101         16  AM-TRANSFERRED-TO.
  2102             20  AM-TRNTO-CARRIER          PIC X.
  2103             20  AM-TRNTO-GROUPING.
  2104                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2105                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2106             20  AM-TRNTO-STATE            PIC XX.
  2107             20  AM-TRNTO-ACCOUNT.
  2108                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2109                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2110             20  AM-TRNTO-DTE              PIC XX.
  2111         16  FILLER                        PIC X(10).
  2112
  2113     12  AM-SAVED-REMIT-TO                 PIC 99.
  2114
  2115     12  AM-COMM-STRUCTURE-SAVED.
  2116         16  AM-DEFN-1-SAVED.
  2117             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2118                 24  AM-AGT-SV             PIC X(10).
  2119                 24  AM-COM-TYP-SV         PIC X.
  2120                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2121                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2122                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2123                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2124                 24  FILLER                PIC X.
  2125                 24  AM-GL-CODES-SV        PIC X.
  2126                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2127                 24  FILLER                PIC X.
  2128         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2129             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  46
* EL650.cbl
  2130                 24  FILLER                PIC X(11).
  2131                 24  AM-L-COMA-SV          PIC XXX.
  2132                 24  AM-J-COMA-SV          PIC XXX.
  2133                 24  AM-A-COMA-SV          PIC XXX.
  2134                 24  FILLER                PIC X(6).
  2135
  2136     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2137         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2138            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2139            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2140            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2141
  2142     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2143     12  FILLER                            PIC X(120).
  2144
  2145     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2146         16  AM-CONTROL-NAME               PIC X(30).
  2147         16  AM-EXECUTIVE-ONE.
  2148             20  AM-EXEC1-NAME             PIC X(15).
  2149             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2150                                                          COMP-3.
  2151             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2152                                                          COMP-3.
  2153         16  AM-EXECUTIVE-TWO.
  2154             20  AM-EXEC2-NAME             PIC X(15).
  2155             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2156                                                          COMP-3.
  2157             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2158                                                          COMP-3.
  2159
  2160     12  AM-RETRO-ADDITIONAL-DATA.
  2161         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2162         16  AM-RETRO-PREM-P-E             PIC X.
  2163         16  AM-RETRO-CLMS-P-I             PIC X.
  2164         16  AM-RETRO-RET-BRACKET-LF.
  2165             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2166                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2167                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2168             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2169                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2170                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2171             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2172                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2173                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2174         16  AM-RETRO-RET-BRACKET-AH.
  2175             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2176                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2177                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2178                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2179             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2180                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2181                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2182             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2183                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2184                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2185
  2186     12  AM-COMMENTS.
  2187         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  47
* EL650.cbl
  2188
  2189     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2190         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2191         16  AM-FLI-BILLING-CODE           PIC X.
  2192         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2193         16  AM-FLI-UNITED-IDENT           PIC X.
  2194         16  AM-FLI-INTEREST-LOST-DATA.
  2195             20  AM-FLI-BANK-NO            PIC X(5).
  2196             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2197             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2198             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2199         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2200             20  AM-FLI-AGT                PIC X(9).
  2201             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2202             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2203         16  FILLER                        PIC X(102).
  2204
  2205     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2206         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2207             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2208             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2209             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2210             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2211             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2212         16  FILLER                          PIC X(10).
  2213******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  48
* EL650.cbl
  2215*    COPY ERCCOMP.
  2216******************************************************************
  2217*                                                                *
  2218*                                                                *
  2219*                            ERCCOMP                             *
  2220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2221*                            VMOD=2.019                          *
  2222*                                                                *
  2223*   ONLINE CREDIT SYSTEM                                         *
  2224*                                                                *
  2225*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2226*                                                                *
  2227*   FILE TYPE = VSAM,KSDS                                        *
  2228*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2229*                                                                *
  2230*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2231*       ALTERNATE PATH = NONE                                    *
  2232*                                                                *
  2233*   LOG = NO                                                     *
  2234*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2235*                                                                *
  2236******************************************************************
  2237*                   C H A N G E   L O G
  2238*
  2239* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2240*-----------------------------------------------------------------
  2241*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2242* EFFECTIVE    NUMBER
  2243*-----------------------------------------------------------------
  2244* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2245* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2246* 092205    2005050300006  PEMA  ADD LEASE FEE
  2247* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2248* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2249* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2250* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2251* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2252* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2253******************************************************************
  2254
  2255 01  COMPENSATION-MASTER.
  2256     12  CO-RECORD-ID                          PIC XX.
  2257         88  VALID-CO-ID                          VALUE 'CO'.
  2258
  2259     12  CO-CONTROL-PRIMARY.
  2260         16  CO-COMPANY-CD                     PIC X.
  2261         16  CO-CONTROL.
  2262             20  CO-CTL-1.
  2263                 24  CO-CARR-GROUP.
  2264                     28  CO-CARRIER            PIC X.
  2265                     28  CO-GROUPING.
  2266                         32  CO-GROUP-PREFIX   PIC XXX.
  2267                         32  CO-GROUP-PRIME    PIC XXX.
  2268                 24  CO-RESP-NO.
  2269                     28  CO-RESP-PREFIX        PIC X(4).
  2270                     28  CO-RESP-PRIME         PIC X(6).
  2271             20  CO-CTL-2.
  2272                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  49
* EL650.cbl
  2273                     28  CO-ACCT-PREFIX        PIC X(4).
  2274                     28  CO-ACCT-PRIME         PIC X(6).
  2275         16  CO-TYPE                           PIC X.
  2276             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2277             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2278             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2279
  2280     12  CO-MAINT-INFORMATION.
  2281         16  CO-LAST-MAINT-DT                  PIC XX.
  2282         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2283         16  CO-LAST-MAINT-USER                PIC X(4).
  2284     12  FILLER                                PIC XX.
  2285     12  CO-STMT-TYPE                          PIC XXX.
  2286     12  CO-COMP-TYPE                          PIC X.
  2287         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2288     12  CO-STMT-OWNER                         PIC X(4).
  2289     12  CO-BALANCE-CONTROL                    PIC X.
  2290         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2291         88  CO-NO-BALANCE                        VALUE 'N'.
  2292
  2293     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2294         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2295         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2296         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2297
  2298     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2299         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2300         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2301
  2302     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2303     12  CO-GA-DIRECT-DEP                      PIC X.
  2304     12  CO-FUTURE-SPACE                       PIC X.
  2305         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2306
  2307     12  CO-ACCT-NAME                          PIC X(30).
  2308     12  CO-MAIL-NAME                          PIC X(30).
  2309     12  CO-ADDR-1                             PIC X(30).
  2310     12  CO-ADDR-2                             PIC X(30).
  2311     12  CO-ADDR-3.
  2312         16  CO-ADDR-CITY                      PIC X(27).
  2313         16  CO-ADDR-STATE                     PIC XX.
  2314     12  CO-CSO-1099                           PIC X.
  2315     12  CO-ZIP.
  2316         16  CO-ZIP-PRIME.
  2317             20  CO-ZIP-PRI-1ST                PIC X.
  2318                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2319             20  FILLER                        PIC X(4).
  2320         16  CO-ZIP-PLUS4                      PIC X(4).
  2321     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2322         16  CO-CAN-POSTAL-1                   PIC XXX.
  2323         16  CO-CAN-POSTAL-2                   PIC XXX.
  2324         16  FILLER                            PIC XXX.
  2325     12  CO-SOC-SEC                            PIC X(13).
  2326     12  CO-TELEPHONE.
  2327         16  CO-AREA-CODE                      PIC XXX.
  2328         16  CO-PREFIX                         PIC XXX.
  2329         16  CO-PHONE                          PIC X(4).
  2330
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  50
* EL650.cbl
  2331     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2332
  2333     12  CO-AR-BAL-LEVEL                       PIC X.
  2334         88  CO-AR-REF-LVL                        VALUE '1'.
  2335         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2336         88  CO-AR-BILL-LVL                       VALUE '2'.
  2337         88  CO-AR-AGT-LVL                        VALUE '3'.
  2338         88  CO-AR-FR-LVL                         VALUE '4'.
  2339
  2340     12  CO-AR-NORMAL-PRINT                    PIC X.
  2341         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2342         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2343
  2344     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2345
  2346     12  CO-AR-REPORTING                       PIC X.
  2347         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2348         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2349
  2350     12  CO-AR-PULL-CHECK                      PIC X.
  2351         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2352         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2353
  2354     12  CO-AR-BALANCE-PRINT                   PIC X.
  2355         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2356
  2357     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2358         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2359         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2360         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2361
  2362     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2363
  2364     12  CO-USER-CODE                          PIC X.
  2365     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2366
  2367******************************************************************
  2368*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2369*    THE LAST MONTH END RUN.
  2370******************************************************************
  2371
  2372     12  CO-LAST-ACTIVITY-DATE.
  2373         16  CO-ACT-YEAR                       PIC 99.
  2374         16  CO-ACT-MONTH                      PIC 99.
  2375         16  CO-ACT-DAY                        PIC 99.
  2376
  2377     12  CO-LAST-STMT-DT.
  2378         16  CO-LAST-STMT-YEAR                 PIC 99.
  2379         16  CO-LAST-STMT-MONTH                PIC 99.
  2380         16  CO-LAST-STMT-DAY                  PIC 99.
  2381
  2382     12  CO-MO-END-TOTALS.
  2383         16  CO-MONTHLY-TOTALS.
  2384             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2385             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2386             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2387             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2388             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  51
* EL650.cbl
  2389
  2390         16  CO-AGING-TOTALS.
  2391             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2392             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2393             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2394             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2395
  2396         16  CO-YTD-TOTALS.
  2397             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2398             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2399
  2400         16  CO-OVER-UNDER-TOTALS.
  2401             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2402             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2403
  2404     12  CO-MISCELLANEOUS-TOTALS.
  2405         16  CO-FICA-TOTALS.
  2406             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2407             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2408
  2409         16  CO-CLAIM-TOTALS.
  2410             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2411             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2412
  2413******************************************************************
  2414*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2415*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2416******************************************************************
  2417
  2418     12  CO-CURRENT-TOTALS.
  2419         16  CO-CURRENT-LAST-STMT-DT.
  2420             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2421             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2422             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2423
  2424         16  CO-CURRENT-MONTHLY-TOTALS.
  2425             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2426             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2427             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2428             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2429             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2430
  2431         16  CO-CURRENT-AGING-TOTALS.
  2432             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2433             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2434             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2435             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2436
  2437         16  CO-CURRENT-YTD-TOTALS.
  2438             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2439             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2440
  2441     12  CO-PAID-COMM-TOTALS.
  2442         16  CO-YTD-PAID-COMMS.
  2443             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2444             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2445
  2446     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  52
* EL650.cbl
  2447         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2448         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2449
  2450     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2451         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2452         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2453         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2454         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2455         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2456         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2457         88  CO-FINAL-LETTER                  VALUE 'F'.
  2458         88  CO-RECONCILING                   VALUE 'R'.
  2459         88  CO-PHONE-CALL                    VALUE 'P'.
  2460         88  CO-LEGAL                         VALUE 'L'.
  2461         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2462         88  CO-WRITE-OFF                     VALUE 'W'.
  2463         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2464
  2465     12  CO-CSR-CODE                       PIC X(4).
  2466
  2467     12  CO-GA-STATUS-INFO.
  2468         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2469         16  CO-GA-TERMINATION-DT          PIC XX.
  2470         16  CO-GA-STATUS-CODE             PIC X.
  2471             88  CO-GA-ACTIVE                 VALUE 'A'.
  2472             88  CO-GA-INACTIVE               VALUE 'I'.
  2473             88  CO-GA-PENDING                VALUE 'P'.
  2474         16  CO-GA-COMMENTS.
  2475             20  CO-GA-COMMENT-1           PIC X(40).
  2476             20  CO-GA-COMMENT-2           PIC X(40).
  2477             20  CO-GA-COMMENT-3           PIC X(40).
  2478             20  CO-GA-COMMENT-4           PIC X(40).
  2479
  2480     12  CO-RPTCD2                         PIC X(10).
  2481     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2482         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2483         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2484
  2485     12  CO-TYPE-AGENT                     PIC X(01).
  2486         88  CO-CORPORATION                   VALUE 'C'.
  2487         88  CO-PARTNERSHIP                   VALUE 'P'.
  2488         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2489         88  CO-TRUST                         VALUE 'T'.
  2490         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2491
  2492     12  CO-FAXNO.
  2493         16  CO-FAX-AREA-CODE                  PIC XXX.
  2494         16  CO-FAX-PREFIX                     PIC XXX.
  2495         16  CO-FAX-PHONE                      PIC X(4).
  2496
  2497     12  CO-BANK-INFORMATION.
  2498         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2499         16  CO-BANK-TRANSIT-NON REDEFINES
  2500             CO-BANK-TRANSIT-NO                PIC 9(8).
  2501
  2502         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2503     12  CO-MISC-DEDUCT-INFO REDEFINES
  2504                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  53
* EL650.cbl
  2505         16  CO-MD-GL-ACCT                     PIC X(10).
  2506         16  CO-MD-DIV                         PIC XX.
  2507         16  CO-MD-CENTER                      PIC X(4).
  2508         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2509         16  CO-CREATE-AP-CHECK                PIC X.
  2510         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2511         16  FILLER                            PIC XXX.
  2512     12  CO-ACH-STATUS                         PIC X.
  2513         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2514         88  CO-ACH-PENDING                        VALUE 'P'.
  2515
  2516     12  CO-BILL-SW                            PIC X.
  2517     12  CO-CONTROL-NAME                       PIC X(30).
  2518     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2519     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2520     12  CO-CLP-STATE                          PIC XX.
  2521     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2522     12  CO-SPP-REFUND-EDIT                    PIC X.
  2523
  2524******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  54
* EL650.cbl
  2526*    COPY ERCNAME.
  2527******************************************************************
  2528*                                                                *
  2529*                                                                *
  2530*                            ERCNAME                             *
  2531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2532*                            VMOD=2.003                          *
  2533*                                                                *
  2534*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2535*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2536*                                                                *
  2537*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2538*                                                                *
  2539*   FILE TYPE = VSAM,KSDS                                        *
  2540*   RECORD SIZE = 160   RECFORM = FIX                            *
  2541*                                                                *
  2542*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2543*                                                                *
  2544*   LOG = NO                                                     *
  2545*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2546*                                                                *
  2547*                                                                *
  2548******************************************************************
  2549
  2550 01  NAME-LOOKUP-MASTER.
  2551     12  NL-RECORD-ID                PIC  X(02).
  2552         88  VALID-NL-ID                         VALUE 'NL'.
  2553
  2554     12  NL-RECORD-KEY.
  2555         16  NL-CONTROL-PRIMARY.
  2556             20  NL-COMPANY-CD       PIC  X(01).
  2557             20  NL-NAME             PIC  X(30).
  2558             20  NL-RECORD-TYPE      PIC  X(01).
  2559                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2560                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2561                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2562
  2563         16  NL-ACCOUNT-MASTER.
  2564             20  NL-AM-COMPANY-CD    PIC  X(01).
  2565             20  NL-AM-CARRIER       PIC  X(01).
  2566             20  NL-AM-GROUPING      PIC  X(06).
  2567             20  NL-AM-STATE         PIC  X(02).
  2568             20  NL-AM-ACCOUNT       PIC  X(10).
  2569             20  FILLER              PIC  X(09).
  2570
  2571         16  NL-COMPENSATION-MASTER
  2572                                 REDEFINES  NL-ACCOUNT-MASTER.
  2573             20  NL-CO-COMPANY-CD    PIC  X(01).
  2574             20  NL-CO-CARRIER       PIC  X(01).
  2575             20  NL-CO-GROUPING      PIC  X(06).
  2576             20  NL-CO-RESP-NO       PIC  X(10).
  2577             20  NL-CO-ACCOUNT       PIC  X(10).
  2578             20  NL-CO-TYPE          PIC  X(01).
  2579
  2580         16  NL-REINSURANCE-RECORD
  2581                                 REDEFINES  NL-ACCOUNT-MASTER.
  2582             20  NL-RE-COMPANY-CD    PIC  X(01).
  2583             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  55
* EL650.cbl
  2584             20  NL-RE-COMPANY.
  2585                 24  NL-RE-COMP      PIC  X(03).
  2586                 24  NL-RE-CO-SUB    PIC  X(03).
  2587             20  NL-RE-TABLE         PIC  X(03).
  2588             20  FILLER              PIC  X(18).
  2589
  2590     12  NL-MAINT-INFORMATION.
  2591         16  NL-LAST-MAINT-DT        PIC  X(02).
  2592         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2593         16  NL-LAST-MAINT-USER      PIC  X(04).
  2594         16  FILLER                  PIC  X(10).
  2595
  2596     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2597         16  NL-RE-LEVEL             PIC  9(02).
  2598
  2599     12  NL-CITY                     PIC  X(15).
  2600     12  NL-ST                       PIC  XX.
  2601
  2602******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  56
* EL650.cbl
  2604*    COPY ERCPLAN.
  2605******************************************************************
  2606*                                                                *
  2607*                                                                *
  2608*                            ERCPLAN                             *
  2609*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2610*                            VMOD=2.003                          *
  2611*                                                                *
  2612*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2613*                                                                *
  2614*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2615*   PLAN MASTER                                                  *
  2616*                                                                *
  2617*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2618*                                                                *
  2619*   FILE TYPE = VSAM,KSDS                                        *
  2620*   RECORD SIZE = 420   RECFORM = FIX                            *
  2621*                                                                *
  2622*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2623*       ALTERNATE PATH1 = N/A                                    *
  2624*                                                                *
  2625*   LOG = NO                                                     *
  2626*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2627*                                                                *
  2628*                                                                *
  2629******************************************************************
  2630
  2631 01  PLAN-MASTER.
  2632     12  PL-RECORD-ID                      PIC XX.
  2633         88  VALID-PL-ID                      VALUE 'PL'.
  2634
  2635     12  PL-CONTROL-PRIMARY.
  2636         16  PL-COMPANY-CD                 PIC X.
  2637         16  PL-MSTR-CNTRL.
  2638             20  PL-CONTROL-A.
  2639                 24  PL-CARRIER            PIC X.
  2640                 24  PL-GROUPING           PIC X(6).
  2641                 24  PL-STATE              PIC XX.
  2642                 24  PL-ACCOUNT            PIC X(10).
  2643             20  PL-BENEFIT-TYPE           PIC X.
  2644             20  PL-BENEFIT-CODE           PIC XX.
  2645             20  PL-REVISION-NO            PIC X(3).
  2646
  2647     12  PL-CONTROL-BY-VAR-GRP.
  2648         16  PL-COMPANY-CD-A1              PIC X.
  2649         16  PL-VG-CARRIER                 PIC X.
  2650         16  PL-VG-GROUPING                PIC X(6).
  2651         16  PL-VG-STATE                   PIC XX.
  2652         16  PL-VG-ACCOUNT                 PIC X(10).
  2653         16  PL-BENEFIT-TYPE-A1            PIC X.
  2654         16  PL-BENEFIT-CODE-A1            PIC XX.
  2655         16  PL-REVISION-NO-A1             PIC 999.
  2656
  2657     12  PL-MAINT-INFORMATION.
  2658         16  PL-LAST-MAINT-DT              PIC XX.
  2659         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2660         16  PL-LAST-MAINT-USER            PIC X(4).
  2661         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  57
* EL650.cbl
  2662
  2663     12  PL-LIABILITY-LIMITS.
  2664         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2665         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2666             20  PL-LM-AGE                 PIC S99        COMP-3.
  2667             20  PL-LM-DUR                 PIC S999       COMP-3.
  2668             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2669             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2670
  2671     12  FILLER                            PIC X(30).
  2672
  2673     12  PL-GL-ACCOUNT-NOS.
  2674         16  PL-PREMIUM-GL                 PIC X(8).
  2675         16  PL-COMM-GL                    PIC X(8).
  2676         16  PL-CLAIM-GL                   PIC X(8).
  2677     12  FILLER                            PIC X(24).
  2678     12  PL-TOLERANCES.
  2679         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2680         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2681         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2682         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2683         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2684         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2685     12  PL-OVER-SHORT.
  2686         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2687         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2688     12  FILLER                            PIC X(24).
  2689     12  PLAN-MISC.
  2690         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2691         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2692         16  PL-IG                         PIC X.
  2693         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2694         16  PL-POLICY-FORM                PIC X(12).
  2695         16  PL-EDIT-FOR-FORM              PIC X(01).
  2696         16  PL-DEV-CODE                   PIC XXX.
  2697         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2698         16  PL-CALC-METHOD                PIC X.
  2699         16  PL-BENEFIT-GROUP              PIC X(05).
  2700         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2701
  2702         16  FILLER                        PIC X(99).
  2703******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  58
* EL650.cbl
  2705*    COPY ELCCNTL.
  2706******************************************************************
  2707*                                                                *
  2708*                                                                *
  2709*                            ELCCNTL.                            *
  2710*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2711*                            VMOD=2.059                          *
  2712*                                                                *
  2713*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2714*                                                                *
  2715*   FILE TYPE = VSAM,KSDS                                        *
  2716*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2717*                                                                *
  2718*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2719*       ALTERNATE INDEX = NONE                                   *
  2720*                                                                *
  2721*   LOG = YES                                                    *
  2722*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2723******************************************************************
  2724*                   C H A N G E   L O G
  2725*
  2726* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2727*-----------------------------------------------------------------
  2728*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2729* EFFECTIVE    NUMBER
  2730*-----------------------------------------------------------------
  2731* 082503                   PEMA  ADD BENEFIT GROUP
  2732* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2733* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2734* 092705    2005050300006  PEMA  ADD SPP LEASES
  2735* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2736* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2737* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2738* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2739* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2740* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2741* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2742* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2743* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2744* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2745******************************************************************
  2746*
  2747 01  CONTROL-FILE.
  2748     12  CF-RECORD-ID                       PIC XX.
  2749         88  VALID-CF-ID                        VALUE 'CF'.
  2750
  2751     12  CF-CONTROL-PRIMARY.
  2752         16  CF-COMPANY-ID                  PIC XXX.
  2753         16  CF-RECORD-TYPE                 PIC X.
  2754             88  CF-COMPANY-MASTER              VALUE '1'.
  2755             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2756             88  CF-STATE-MASTER                VALUE '3'.
  2757             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2758             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2759             88  CF-CARRIER-MASTER              VALUE '6'.
  2760             88  CF-MORTALITY-MASTER            VALUE '7'.
  2761             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2762             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  59
* EL650.cbl
  2763             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2764             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2765             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2766             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2767             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2768             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2769             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2770             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2771             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2772         16  CF-ACCESS-CD-GENL              PIC X(4).
  2773         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2774             20  CF-PROCESSOR               PIC X(4).
  2775         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2776             20  CF-STATE-CODE              PIC XX.
  2777             20  FILLER                     PIC XX.
  2778         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2779             20  FILLER                     PIC XX.
  2780             20  CF-HI-BEN-IN-REC           PIC XX.
  2781         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2782             20  FILLER                     PIC XXX.
  2783             20  CF-CARRIER-CNTL            PIC X.
  2784         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2785             20  FILLER                     PIC XX.
  2786             20  CF-HI-TYPE-IN-REC          PIC 99.
  2787         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2788             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2789                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2790             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2791             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2792         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2793             20  FILLER                     PIC X.
  2794             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2795         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2796             20  FILLER                     PIC XX.
  2797             20  CF-MORTGAGE-PLAN           PIC XX.
  2798         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2799
  2800     12  CF-LAST-MAINT-DT                   PIC XX.
  2801     12  CF-LAST-MAINT-BY                   PIC X(4).
  2802     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2803
  2804     12  CF-RECORD-BODY                     PIC X(728).
  2805
  2806
  2807****************************************************************
  2808*             COMPANY MASTER RECORD                            *
  2809****************************************************************
  2810
  2811     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2812         16  CF-COMPANY-ADDRESS.
  2813             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2814             20  CF-CL-IN-CARE-OF           PIC X(30).
  2815             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2816             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2817             20  CF-CL-CITY-STATE           PIC X(30).
  2818             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2819             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2820         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  60
* EL650.cbl
  2821         16  CF-COMPANY-PASSWORD            PIC X(8).
  2822         16  CF-SECURITY-OPTION             PIC X.
  2823             88  ALL-SECURITY                   VALUE '1'.
  2824             88  COMPANY-VERIFY                 VALUE '2'.
  2825             88  PROCESSOR-VERIFY               VALUE '3'.
  2826             88  NO-SECURITY                    VALUE '4'.
  2827             88  ALL-BUT-TERM                   VALUE '5'.
  2828         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2829             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2830         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2831             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2832         16  CF-INFORCE-LOCATION            PIC X.
  2833             88  CERTS-ARE-ONLINE               VALUE '1'.
  2834             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2835             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2836         16  CF-LOWER-CASE-LETTERS          PIC X.
  2837         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2838             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2839             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2840             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2841             88  CF-ACCNT-CNTL                  VALUE '3'.
  2842             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2843
  2844         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2845         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2846
  2847         16  CF-LGX-CREDIT-USER             PIC X.
  2848             88  CO-IS-NOT-USER                 VALUE 'N'.
  2849             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2850
  2851         16 CF-CREDIT-CALC-CODES.
  2852             20  CF-CR-REM-TERM-CALC PIC X.
  2853               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2854               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2855               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2856               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2857               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2858               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2859               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2860             20  CF-CR-R78-METHOD           PIC X.
  2861               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2862               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2863
  2864         16  CF-CLAIM-CONTROL-COUNTS.
  2865             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2866                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2867
  2868             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2869                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2870
  2871             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2872                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2873
  2874             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2875                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2876
  2877         16  CF-CURRENT-MONTH-END           PIC XX.
  2878
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  61
* EL650.cbl
  2879         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2880             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2881             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2882             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2883             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2884                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2885                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2886             20  CF-CO-PREM-REJECT-SW       PIC X.
  2887                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2888                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2889             20  CF-CO-REF-REJECT-SW        PIC X.
  2890                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2891                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2892
  2893         16  CF-CO-REPORTING-DT             PIC XX.
  2894         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2895         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2896           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2897           88  CF-CO-MONTH-END                  VALUE '1'.
  2898
  2899         16  CF-LGX-CLAIM-USER              PIC X.
  2900             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2901             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2902
  2903         16  CF-CREDIT-EDIT-CONTROLS.
  2904             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2905             20  CF-MIN-AGE                 PIC 99.
  2906             20  CF-DEFAULT-AGE             PIC 99.
  2907             20  CF-MIN-TERM                PIC S999      COMP-3.
  2908             20  CF-MAX-TERM                PIC S999      COMP-3.
  2909             20  CF-DEFAULT-SEX             PIC X.
  2910             20  CF-JOINT-AGE-INPUT         PIC X.
  2911                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2912             20  CF-BIRTH-DATE-INPUT        PIC X.
  2913                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2914             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2915                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2916                 88  CF-ZERO-CARRIER            VALUE '1'.
  2917                 88  CF-ZERO-GROUPING           VALUE '2'.
  2918                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2919             20  CF-EDIT-SW                 PIC X.
  2920                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2921             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2922             20  CF-CR-PR-METHOD            PIC X.
  2923               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2924               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2925             20  FILLER                     PIC X.
  2926
  2927         16  CF-CREDIT-MISC-CONTROLS.
  2928             20  CF-REIN-TABLE-SW           PIC X.
  2929                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2930             20  CF-COMP-TABLE-SW           PIC X.
  2931                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2932             20  CF-EXPERIENCE-RETENTION-AGE
  2933                                            PIC S9        COMP-3.
  2934             20  CF-CONVERSION-DT           PIC XX.
  2935             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2936             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  62
* EL650.cbl
  2937                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2938                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2939
  2940             20  CF-CR-CHECK-NO-CONTROL.
  2941                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2942                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2943                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2944                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2945                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2946                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2947
  2948                 24  CF-CR-CHECK-COUNT       REDEFINES
  2949                     CF-CR-CHECK-COUNTER      PIC X(4).
  2950
  2951                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2952                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2953
  2954                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2955                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2956                 24  CF-MAIL-PROCESSING       PIC X.
  2957                     88  MAIL-PROCESSING          VALUE 'Y'.
  2958
  2959         16  CF-MISC-SYSTEM-CONTROL.
  2960             20  CF-SYSTEM-C                 PIC X.
  2961                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2962             20  CF-SYSTEM-D                 PIC X.
  2963                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2964             20  CF-SOC-SEC-NO-SW            PIC X.
  2965                 88  SOC-SEC-NO-USED             VALUE '1'.
  2966             20  CF-MEMBER-NO-SW             PIC X.
  2967                 88  MEMBER-NO-USED              VALUE '1'.
  2968             20  CF-TAX-ID-NUMBER            PIC X(11).
  2969             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2970             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2971                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2972                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2973                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2974                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2975             20  CF-SYSTEM-E                 PIC X.
  2976                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2977
  2978         16  CF-LGX-LIFE-USER               PIC X.
  2979             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2980             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2981
  2982         16  CF-CR-MONTH-END-DT             PIC XX.
  2983
  2984         16  CF-FILE-MAINT-DATES.
  2985             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2986                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2987             20  CF-LAST-BATCH       REDEFINES
  2988                 CF-LAST-BATCH-NO               PIC X(4).
  2989             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2990             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2991             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2992             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2993             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2994             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  63
* EL650.cbl
  2995             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2996             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2997             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2998             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2999
  3000         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3001         16  FILLER                         PIC X.
  3002
  3003         16  CF-ALT-MORT-CODE               PIC X(4).
  3004         16  CF-MEMBER-CAPTION              PIC X(10).
  3005
  3006         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3007             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3008             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3009             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3010             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3011             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3012
  3013         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3014
  3015         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3016         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3017         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3018         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3019
  3020         16  CF-AH-OVERRIDE-L1              PIC X.
  3021         16  CF-AH-OVERRIDE-L2              PIC XX.
  3022         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3023         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3024
  3025         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3026         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3027
  3028         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3029         16  CF-AR-LAST-EL860-DT            PIC XX.
  3030         16  CF-MP-MONTH-END-DT             PIC XX.
  3031
  3032         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3033         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3034             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3035
  3036         16  CF-AR-MONTH-END-DT             PIC XX.
  3037
  3038         16  CF-CRDTCRD-USER                PIC X.
  3039             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3040             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3041
  3042         16  CF-CC-MONTH-END-DT             PIC XX.
  3043
  3044         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3045
  3046         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3047             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3048             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3049             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3050         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3051         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3052         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  64
* EL650.cbl
  3053         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3054             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3055             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3056         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3057         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3058         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3059             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3060         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3061
  3062         16  CF-CL-ZIP-CODE.
  3063             20  CF-CL-ZIP-PRIME.
  3064                 24  CF-CL-ZIP-1ST          PIC X.
  3065                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3066                 24  FILLER                 PIC X(4).
  3067             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3068         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3069             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3070             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3071             20  FILLER                     PIC XXX.
  3072
  3073         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3074         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3075         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3076         16  CF-CO-OPTION-START-DATE        PIC XX.
  3077         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3078           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3079                                                      '3' '4'.
  3080           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3081           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3082           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3083           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3084           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3085           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3086
  3087         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3088
  3089         16  CF-PAYMENT-APPROVAL-LEVELS.
  3090             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3091             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3092             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3093             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3094             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3095             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3096
  3097         16  CF-END-USER-REPORTING-USER     PIC X.
  3098             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3099             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3100
  3101         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3102             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3103             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3104
  3105         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3106
  3107         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3108         16  FILLER                         PIC X.
  3109
  3110         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  65
* EL650.cbl
  3111             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3112             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3113             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3114
  3115         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3116
  3117         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3118             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3119             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3120
  3121         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3122             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3123             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3124
  3125         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3126
  3127         16  CF-CO-ACH-ID-CODE              PIC  X.
  3128             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3129             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3130             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3131         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3132         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3133         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3134         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3135         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3136         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3137         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3138         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3139         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3140                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3141         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3142                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3143
  3144         16  CF-CO-OVER-SHORT.
  3145             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3146             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3147
  3148*         16  FILLER                         PIC X(102).
  3149         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3150             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3151             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3152
  3153         16  CF-AH-APPROVAL-DAYS.
  3154             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3155             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3156             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3157             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3158
  3159         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3160
  3161         16  CF-APPROV-LEV-5.
  3162             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3163             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3164             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3165
  3166         16  FILLER                         PIC X(68).
  3167****************************************************************
  3168*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  66
* EL650.cbl
  3169****************************************************************
  3170
  3171     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3172         16  CF-PROCESSOR-NAME              PIC X(30).
  3173         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3174         16  CF-PROCESSOR-TITLE             PIC X(26).
  3175         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3176                 88  MESSAGE-YES                VALUE 'Y'.
  3177                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3178
  3179*****************************************************
  3180****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3181****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3182****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3183****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3184*****************************************************
  3185
  3186         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3187             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3188             20  CF-APPLICATION-FORCE       PIC X.
  3189             20  CF-INDIVIDUAL-APP.
  3190                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3191                     28  CF-BROWSE-APP      PIC X.
  3192                     28  CF-UPDATE-APP      PIC X.
  3193
  3194         16  CF-CURRENT-TERM-ON             PIC X(4).
  3195         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3196             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3197             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3198             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3199             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3200             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3201             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3202             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3203         16  CF-PROCESSOR-CARRIER           PIC X.
  3204             88  NO-CARRIER-SECURITY            VALUE ' '.
  3205         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3206             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3207         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3208             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3209         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3210             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3211
  3212         16  CF-PROC-SYS-ACCESS-SW.
  3213             20  CF-PROC-CREDIT-CLAIMS-SW.
  3214                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3215                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3216                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3217                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3218             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3219                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3220                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3221             20  CF-PROC-LIFE-GNRLDGR-SW.
  3222                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3223                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3224                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3225                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3226             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  67
* EL650.cbl
  3227                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3228                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3229         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3230             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3231             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3232         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3233
  3234         16  CF-APPROVAL-LEVEL                  PIC X.
  3235             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3236             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3237             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3238             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3239             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3240
  3241         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3242
  3243         16  CF-LANGUAGE-TYPE                   PIC X.
  3244             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3245             88  CF-LANG-IS-FR                      VALUE 'F'.
  3246
  3247         16  CF-CSR-IND                         PIC X.
  3248         16  FILLER                             PIC X(239).
  3249
  3250****************************************************************
  3251*             PROCESSOR/REMINDERS RECORD                       *
  3252****************************************************************
  3253
  3254     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3255         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3256             20  CF-START-REMIND-DT         PIC XX.
  3257             20  CF-END-REMIND-DT           PIC XX.
  3258             20  CF-REMINDER-TEXT           PIC X(50).
  3259         16  FILLER                         PIC X(296).
  3260
  3261
  3262****************************************************************
  3263*             STATE MASTER RECORD                              *
  3264****************************************************************
  3265
  3266     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3267         16  CF-STATE-ABBREVIATION          PIC XX.
  3268         16  CF-STATE-NAME                  PIC X(25).
  3269         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3270         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3271             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3272             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3273             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3274             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3275                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3276                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3277             20  CF-ST-PREM-REJECT-SW       PIC X.
  3278                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3279                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3280             20  CF-ST-REF-REJECT-SW        PIC X.
  3281                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3282                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3283         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3284         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  68
* EL650.cbl
  3285         16  CF-ST-REFUND-RULES.
  3286             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3287             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3288             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3289         16  CF-ST-FST-PMT-EXTENSION.
  3290             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3291             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3292                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3293                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3294                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3295                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3296         16  CF-ST-STATE-CALL.
  3297             20  CF-ST-CALL-UNEARNED        PIC X.
  3298             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3299             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3300         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3301             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3302             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3303         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3304         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3305         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3306         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3307         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3308         16  FILLER                         PIC X.
  3309         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3310             20  CF-ST-BENEFIT-CD           PIC XX.
  3311             20  CF-ST-BENEFIT-KIND         PIC X.
  3312                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3313                 88  CF-ST-AH-KIND              VALUE 'A'.
  3314             20  CF-ST-REM-TERM-CALC        PIC X.
  3315                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3316                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3317                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3318                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3319                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3320                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3321                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3322                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3323
  3324             20  CF-ST-REFUND-CALC          PIC X.
  3325                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3326                 88  ST-REFD-BY-R78             VALUE '1'.
  3327                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3328                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3329                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3330                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3331                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3332                 88  ST-REFD-UTAH               VALUE '7'.
  3333                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3334                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3335                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3336
  3337             20  CF-ST-EARNING-CALC         PIC X.
  3338                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3339                 88  ST-EARN-BY-R78             VALUE '1'.
  3340                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3341                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3342                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  69
* EL650.cbl
  3343                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3344                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3345                 88  ST-EARN-MEAN               VALUE '8'.
  3346                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3347
  3348             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3349                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3350                 88  ST-OVRD-BY-R78             VALUE '1'.
  3351                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3352                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3353                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3354                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3355                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3356                 88  ST-OVRD-MEAN               VALUE '8'.
  3357                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3358             20  cf-st-extra-periods        pic 9.
  3359*            20  FILLER                     PIC X.
  3360
  3361         16  CF-ST-COMMISSION-CAPS.
  3362             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3363             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3364             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3365             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3366         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3367                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3368
  3369         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3370
  3371         16  CF-ST-STATUTORY-INTEREST.
  3372             20  CF-ST-STAT-DATE-FROM       PIC X.
  3373                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3374                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3375             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3376             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3377             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3378             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3379             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3380
  3381         16  CF-ST-OVER-SHORT.
  3382             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3383             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3384
  3385         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3386
  3387         16  CF-ST-RT-CALC                  PIC X.
  3388
  3389         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3390         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3391         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3392         16  CF-ST-RF-LR-CALC               PIC X.
  3393         16  CF-ST-RF-LL-CALC               PIC X.
  3394         16  CF-ST-RF-LN-CALC               PIC X.
  3395         16  CF-ST-RF-AH-CALC               PIC X.
  3396         16  CF-ST-RF-CP-CALC               PIC X.
  3397*        16  FILLER                         PIC X(206).
  3398*CIDMOD         16  FILLER                         PIC X(192).
  3399         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3400             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  70
* EL650.cbl
  3401         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3402         16  CF-ST-VFY-2ND-BENE             PIC X.
  3403         16  CF-ST-CAUSAL-STATE             PIC X.
  3404         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3405         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3406         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3407             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3408         16  CF-ST-NET-ONLY-STATE           PIC X.
  3409             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3410         16  FILLER                         PIC X(181).
  3411
  3412****************************************************************
  3413*             BENEFIT MASTER RECORD                            *
  3414****************************************************************
  3415
  3416     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3417         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3418             20  CF-BENEFIT-CODE            PIC XX.
  3419             20  CF-BENEFIT-NUMERIC  REDEFINES
  3420                 CF-BENEFIT-CODE            PIC XX.
  3421             20  CF-BENEFIT-ALPHA           PIC XXX.
  3422             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3423             20  CF-BENEFIT-COMMENT         PIC X(10).
  3424
  3425             20  CF-LF-COVERAGE-TYPE        PIC X.
  3426                 88  CF-REDUCING                VALUE 'R'.
  3427                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3428
  3429             20  CF-SPECIAL-CALC-CD         PIC X.
  3430                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3431                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3432                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3433                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3434                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3435                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3436                 88  CF-FARM-PLAN               VALUE 'F'.
  3437                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3438                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3439                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3440                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3441                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3442                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3443                 88  CF-PRUDENTIAL              VALUE 'P'.
  3444                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3445                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3446                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3447                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3448                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3449                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3450
  3451             20  CF-JOINT-INDICATOR         PIC X.
  3452                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3453
  3454*            20  FILLER                     PIC X(12).
  3455             20  cf-maximum-benefits        pic s999 comp-3.
  3456             20  FILLER                     PIC X(09).
  3457             20  CF-BENEFIT-CATEGORY        PIC X.
  3458             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  71
* EL650.cbl
  3459
  3460             20  CF-CO-REM-TERM-CALC        PIC X.
  3461                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3462                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3463                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3464                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3465                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3466
  3467             20  CF-CO-EARNINGS-CALC        PIC X.
  3468                 88  CO-EARN-BY-R78             VALUE '1'.
  3469                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3470                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3471                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3472                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3473                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3474                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3475                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3476
  3477             20  CF-CO-REFUND-CALC          PIC X.
  3478                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3479                 88  CO-REFD-BY-R78             VALUE '1'.
  3480                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3481                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3482                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3483                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3484                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3485                 88  CO-REFD-MEAN               VALUE '8'.
  3486                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3487                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3488                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3489
  3490             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3491                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3492                 88  CO-OVRD-BY-R78             VALUE '1'.
  3493                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3494                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3495                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3496                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3497                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3498                 88  CO-OVRD-MEAN               VALUE '8'.
  3499                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3500
  3501             20  CF-CO-BEN-I-G-CD           PIC X.
  3502                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3503                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3504                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3505
  3506         16  FILLER                         PIC X(304).
  3507
  3508
  3509****************************************************************
  3510*             CARRIER MASTER RECORD                            *
  3511****************************************************************
  3512
  3513     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3514         16  CF-ADDRESS-DATA.
  3515             20  CF-MAIL-TO-NAME            PIC X(30).
  3516             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  72
* EL650.cbl
  3517             20  CF-ADDRESS-LINE-1          PIC X(30).
  3518             20  CF-ADDRESS-LINE-2          PIC X(30).
  3519             20  CF-CITY-STATE              PIC X(30).
  3520             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3521             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3522
  3523         16  CF-CLAIM-NO-CONTROL.
  3524             20  CF-CLAIM-NO-METHOD         PIC X.
  3525                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3526                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3527                 88  CLAIM-NO-SEQ               VALUE '3'.
  3528                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3529             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3530                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3531                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3532                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3533
  3534         16  CF-CHECK-NO-CONTROL.
  3535             20  CF-CHECK-NO-METHOD         PIC X.
  3536                 88  CHECK-NO-MANUAL            VALUE '1'.
  3537                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3538                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3539                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3540             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3541                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3542
  3543         16  CF-DOMICILE-STATE              PIC XX.
  3544
  3545         16  CF-EXPENSE-CONTROLS.
  3546             20  CF-EXPENSE-METHOD          PIC X.
  3547                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3548                 88  DOLLARS-PER-PMT            VALUE '2'.
  3549                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3550                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3551             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3552             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3553
  3554         16  CF-CORRESPONDENCE-CONTROL.
  3555             20  CF-LETTER-RESEND-OPT       PIC X.
  3556                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3557                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3558             20  FILLER                     PIC X(4).
  3559
  3560         16  CF-RESERVE-CONTROLS.
  3561             20  CF-MANUAL-SW               PIC X.
  3562                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3563             20  CF-FUTURE-SW               PIC X.
  3564                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3565             20  CF-PTC-SW                  PIC X.
  3566                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3567             20  CF-IBNR-SW                 PIC X.
  3568                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3569             20  CF-PTC-LF-SW               PIC X.
  3570                 88  CF-LF-PTC-USED             VALUE '1'.
  3571             20  CF-CDT-ACCESS-METHOD       PIC X.
  3572                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3573                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3574                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  73
* EL650.cbl
  3575             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3576
  3577         16  CF-CLAIM-CALC-METHOD           PIC X.
  3578             88  360-PLUS-MONTHS                VALUE '1'.
  3579             88  365-PLUS-MONTHS                VALUE '2'.
  3580             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3581             88  360-DAILY                      VALUE '4'.
  3582             88  365-DAILY                      VALUE '5'.
  3583
  3584         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3585         16  FILLER                         PIC X(11).
  3586
  3587         16  CF-LIMIT-AMOUNTS.
  3588             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3589             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3590             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3591             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3592             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3593             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3594             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3595             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3596             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3597             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3598
  3599         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3600         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3601         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3602
  3603         16  CF-ZIP-CODE.
  3604             20  CF-ZIP-PRIME.
  3605                 24  CF-ZIP-1ST             PIC X.
  3606                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3607                 24  FILLER                 PIC X(4).
  3608             20  CF-ZIP-PLUS4               PIC X(4).
  3609         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3610             20  CF-CAN-POSTAL-1            PIC XXX.
  3611             20  CF-CAN-POSTAL-2            PIC XXX.
  3612             20  FILLER                     PIC XXX.
  3613
  3614         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3615         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3616         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3617
  3618         16  CF-RATING-SWITCH               PIC X.
  3619             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3620             88  CF-NO-RATING                   VALUE 'N'.
  3621
  3622         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3623
  3624         16  CF-CARRIER-OVER-SHORT.
  3625             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3626             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3627
  3628         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3629         16  CF-SECPAY-SWITCH               PIC X.
  3630             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3631             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3632         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  74
* EL650.cbl
  3633         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3634         16  FILLER                         PIC X(444).
  3635*        16  FILLER                         PIC X(452).
  3636
  3637
  3638****************************************************************
  3639*             MORTALITY MASTER RECORD                          *
  3640****************************************************************
  3641
  3642     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3643         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3644                                INDEXED BY CF-MORT-NDX.
  3645             20  CF-MORT-TABLE              PIC X(5).
  3646             20  CF-MORT-TABLE-TYPE         PIC X.
  3647                 88  CF-MORT-JOINT              VALUE 'J'.
  3648                 88  CF-MORT-SINGLE             VALUE 'S'.
  3649                 88  CF-MORT-COMBINED           VALUE 'C'.
  3650                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3651                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3652             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3653             20  CF-MORT-AGE-METHOD         PIC XX.
  3654                 88  CF-AGE-LAST                VALUE 'AL'.
  3655                 88  CF-AGE-NEAR                VALUE 'AN'.
  3656             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3657             20  CF-MORT-ADJUSTMENT-DIRECTION
  3658                                            PIC X.
  3659                 88  CF-MINUS                   VALUE '-'.
  3660                 88  CF-PLUS                    VALUE '+'.
  3661             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3662             20  CF-MORT-JOINT-CODE         PIC X.
  3663                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3664             20  CF-MORT-PC-Q               PIC X.
  3665                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3666             20  CF-MORT-TABLE-CODE         PIC X(4).
  3667             20  CF-MORT-COMMENTS           PIC X(15).
  3668             20  FILLER                     PIC X(14).
  3669
  3670         16  FILLER                         PIC X(251).
  3671
  3672
  3673****************************************************************
  3674*             BUSSINESS TYPE MASTER RECORD                     *
  3675****************************************************************
  3676
  3677     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3678* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3679* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3680* AND RECORD 05 IS TYPES 81-99
  3681         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3682             20  CF-BUSINESS-TITLE          PIC  X(19).
  3683             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3684                                            PIC S9V9(4) COMP-3.
  3685             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3686             20  FILLER                     PIC  X.
  3687         16  FILLER                         PIC  X(248).
  3688
  3689
  3690****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  75
* EL650.cbl
  3691*             TERMINAL MASTER RECORD                           *
  3692****************************************************************
  3693
  3694     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3695
  3696         16  CF-COMPANY-TERMINALS.
  3697             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3698                                  PIC X(4).
  3699         16  FILLER               PIC X(248).
  3700
  3701
  3702****************************************************************
  3703*             LIFE EDIT MASTER RECORD                          *
  3704****************************************************************
  3705
  3706     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3707         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3708             20  CF-LIFE-CODE-IN            PIC XX.
  3709             20  CF-LIFE-CODE-OUT           PIC XX.
  3710         16  FILLER                         PIC X(248).
  3711
  3712
  3713****************************************************************
  3714*             AH EDIT MASTER RECORD                            *
  3715****************************************************************
  3716
  3717     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3718         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3719             20  CF-AH-CODE-IN              PIC XXX.
  3720             20  CF-AH-CODE-OUT             PIC XX.
  3721         16  FILLER                         PIC X(248).
  3722
  3723
  3724****************************************************************
  3725*             CREDIBILITY TABLES                               *
  3726****************************************************************
  3727
  3728     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3729         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3730                             INDEXED BY CF-CRDB-NDX.
  3731             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3732             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3733             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3734         16  FILLER                         PIC  X(332).
  3735
  3736
  3737****************************************************************
  3738*             REPORT CUSTOMIZATION RECORD                      *
  3739****************************************************************
  3740
  3741     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3742         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3743             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3744             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3745             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3746**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3747****       A T-TRANSFER.                                   ****
  3748             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  76
* EL650.cbl
  3749
  3750         16  FILLER                         PIC XX.
  3751
  3752         16  CF-CARRIER-CNTL-OPT.
  3753             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3754                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3755                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3756             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3757                                            PIC X.
  3758         16  CF-GROUP-CNTL-OPT.
  3759             20  CF-GROUP-OPT-SEQ           PIC 9.
  3760                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3761                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3762             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3763                                            PIC X(6).
  3764         16  CF-STATE-CNTL-OPT.
  3765             20  CF-STATE-OPT-SEQ           PIC 9.
  3766                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3767                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3768             20  CF-STATE-SELECT OCCURS 3 TIMES
  3769                                            PIC XX.
  3770         16  CF-ACCOUNT-CNTL-OPT.
  3771             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3772                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3773                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3774             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3775                                            PIC X(10).
  3776         16  CF-BUS-TYP-CNTL-OPT.
  3777             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3778                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3779                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3780             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3781                                            PIC XX.
  3782         16  CF-LF-TYP-CNTL-OPT.
  3783             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3784                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3785                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3786             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3787                                            PIC XX.
  3788         16  CF-AH-TYP-CNTL-OPT.
  3789             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3790                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3791                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3792             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3793                                            PIC XX.
  3794         16  CF-REPTCD1-CNTL-OPT.
  3795             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3796                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3797                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3798             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3799                                            PIC X(10).
  3800         16  CF-REPTCD2-CNTL-OPT.
  3801             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3802                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3803                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3804             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3805                                            PIC X(10).
  3806         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  77
* EL650.cbl
  3807             20  CF-USER1-OPT-SEQ           PIC 9.
  3808                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3809                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3810             20  CF-USER1-SELECT OCCURS 3 TIMES
  3811                                            PIC X(10).
  3812         16  CF-USER2-CNTL-OPT.
  3813             20  CF-USER2-OPT-SEQ           PIC 9.
  3814                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3815                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3816             20  CF-USER2-SELECT OCCURS 3 TIMES
  3817                                            PIC X(10).
  3818         16  CF-USER3-CNTL-OPT.
  3819             20  CF-USER3-OPT-SEQ           PIC 9.
  3820                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3821                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3822             20  CF-USER3-SELECT OCCURS 3 TIMES
  3823                                            PIC X(10).
  3824         16  CF-USER4-CNTL-OPT.
  3825             20  CF-USER4-OPT-SEQ           PIC 9.
  3826                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3827                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3828             20  CF-USER4-SELECT OCCURS 3 TIMES
  3829                                            PIC X(10).
  3830         16  CF-USER5-CNTL-OPT.
  3831             20  CF-USER5-OPT-SEQ           PIC 9.
  3832                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3833                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3834             20  CF-USER5-SELECT OCCURS 3 TIMES
  3835                                            PIC X(10).
  3836         16  CF-REINS-CNTL-OPT.
  3837             20  CF-REINS-OPT-SEQ           PIC 9.
  3838                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3839                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3840             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3841                 24  CF-REINS-PRIME         PIC XXX.
  3842                 24  CF-REINS-SUB           PIC XXX.
  3843
  3844         16  CF-AGENT-CNTL-OPT.
  3845             20  CF-AGENT-OPT-SEQ           PIC 9.
  3846                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3847                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3848             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3849                                            PIC X(10).
  3850
  3851         16  FILLER                         PIC X(43).
  3852
  3853         16  CF-LOSS-RATIO-SELECT.
  3854             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3855             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3856         16  CF-ENTRY-DATE-SELECT.
  3857             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3858             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3859         16  CF-EFFECTIVE-DATE-SELECT.
  3860             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3861             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3862
  3863         16  CF-EXCEPTION-LIST-IND          PIC X.
  3864             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  78
* EL650.cbl
  3865
  3866         16  FILLER                         PIC X(318).
  3867
  3868****************************************************************
  3869*                  EXCEPTION REPORTING RECORD                  *
  3870****************************************************************
  3871
  3872     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3873         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3874             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3875
  3876         16  CF-COMBINED-LIFE-AH-OPT.
  3877             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3878             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3879             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3880             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3881
  3882         16  CF-LIFE-OPT.
  3883             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3884             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3885             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3886             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3887             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3888             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3889             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3890             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3891             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3892             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3893
  3894         16  CF-AH-OPT.
  3895             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3896             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3897             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3898             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3899             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3900             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3901             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3902             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3903             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3904             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3905
  3906         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3907             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3908             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3909             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3910
  3911         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3912
  3913         16  FILLER                         PIC X(673).
  3914
  3915
  3916****************************************************************
  3917*             MORTGAGE SYSTEM PLAN RECORD                      *
  3918****************************************************************
  3919
  3920     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3921         16  CF-PLAN-TYPE                   PIC X.
  3922             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  79
* EL650.cbl
  3923             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3924             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3925         16  CF-PLAN-ABBREV                 PIC XXX.
  3926         16  CF-PLAN-DESCRIPT               PIC X(10).
  3927         16  CF-PLAN-NOTES                  PIC X(20).
  3928         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3929         16  CF-PLAN-UNDERWRITING.
  3930             20  CF-PLAN-TERM-DATA.
  3931                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3932                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3933             20  CF-PLAN-AGE-DATA.
  3934                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3935                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3936                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3937             20  CF-PLAN-BENEFIT-DATA.
  3938                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3939                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3940                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3941                                            PIC S9(7)V99  COMP-3.
  3942         16  CF-PLAN-POLICY-FORMS.
  3943             20  CF-POLICY-FORM             PIC X(12).
  3944             20  CF-MASTER-APPLICATION      PIC X(12).
  3945             20  CF-MASTER-POLICY           PIC X(12).
  3946         16  CF-PLAN-RATING.
  3947             20  CF-RATE-CODE               PIC X(5).
  3948             20  CF-SEX-RATING              PIC X.
  3949                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3950                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3951             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3952             20  CF-SUB-STD-TYPE            PIC X.
  3953                 88  CF-PCT-OF-PREM            VALUE '1'.
  3954                 88  CF-PCT-OF-BENE            VALUE '2'.
  3955         16  CF-PLAN-PREM-TOLERANCES.
  3956             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3957             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3958         16  CF-PLAN-PYMT-TOLERANCES.
  3959             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3960             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3961         16  CF-PLAN-MISC-DATA.
  3962             20  FILLER                     PIC X.
  3963             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3964             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3965         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3966         16  CF-PLAN-IND-GRP                PIC X.
  3967             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3968                                                     '1'.
  3969             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3970                                                     '2'.
  3971         16  CF-MIB-SEARCH-SW               PIC X.
  3972             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3973             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3974             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3975             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3976         16  CF-ALPHA-SEARCH-SW             PIC X.
  3977             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3978             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3979             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3980             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  80
* EL650.cbl
  3981             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3982             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3983             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3984             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3985             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3986             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3987                                                     'A' 'B' 'C'
  3988                                                     'X' 'Y' 'Z'.
  3989         16  CF-EFF-DT-RULE-SW              PIC X.
  3990             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3991             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3992             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3993             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3994             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3995         16  FILLER                         PIC X(4).
  3996         16  CF-HEALTH-QUESTIONS            PIC X.
  3997             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3998         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3999         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4000         16  CF-PLAN-SNGL-JNT               PIC X.
  4001             88  CF-COMBINED-PLAN              VALUE 'C'.
  4002             88  CF-JNT-PLAN                   VALUE 'J'.
  4003             88  CF-SNGL-PLAN                  VALUE 'S'.
  4004         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4005         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4006         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4007         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4008         16  CF-RERATE-CNTL                 PIC  X.
  4009             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4010             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4011             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4012             88  CF-AUTO-RECALC                 VALUE '4'.
  4013         16  CF-BENEFIT-TYPE                PIC  X.
  4014             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4015             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4016         16  CF-POLICY-FEE                  PIC S999V99
  4017                                                    COMP-3.
  4018         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4019         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4020         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4021         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4022         16  FILLER                         PIC  X(32).
  4023         16  CF-TERMINATION-FORM            PIC  X(04).
  4024         16  FILLER                         PIC  X(08).
  4025         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4026                                                       COMP-3.
  4027         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4028         16  CF-ISSUE-LETTER                PIC  X(4).
  4029         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4030         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4031             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4032             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4033         16  CF-MP-REFUND-CALC              PIC X.
  4034             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4035             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4036             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4037             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4038             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  81
* EL650.cbl
  4039             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4040             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4041             88  CF-MP-REFD-MEAN                VALUE '8'.
  4042         16  CF-ALT-RATE-CODE               PIC  X(5).
  4043
  4044
  4045         16  FILLER                         PIC X(498).
  4046****************************************************************
  4047*             MORTGAGE COMPANY MASTER RECORD                   *
  4048****************************************************************
  4049
  4050     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4051         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4052         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4053             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4054             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4055             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4056             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4057             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4058
  4059         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4060         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4061         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4062         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4063         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4064
  4065         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4066             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4067         16  CF-MP-RECON-USE-IND            PIC X(1).
  4068             88  CF-MP-USE-RECON             VALUE 'Y'.
  4069         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4070             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4071         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4072             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4073             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4074         16  FILLER                         PIC X(1).
  4075         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4076             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4077         16  CF-MORTG-MIB-VERSION           PIC X.
  4078             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4079             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4080             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4081         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4082             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4083                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4084             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4085                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4086             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4087                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4088             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4089                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4090             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4091                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4092             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4093                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4094         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4095         16  FILLER                         PIC X(7).
  4096         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  82
* EL650.cbl
  4097             20  CF-MORTG-MIB-COMM          PIC X(5).
  4098             20  CF-MORTG-MIB-TERM          PIC X(5).
  4099         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4100             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4101         16  FILLER                         PIC X(03).
  4102         16  CF-MP-CHECK-NO-CONTROL.
  4103             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4104                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4105                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4106                                                ' ' LOW-VALUES.
  4107                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4108                                               VALUE '3'.
  4109         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4110         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4111         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4112             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4113                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4114             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4115                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4116             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4117                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4118             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4119                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4120             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4121                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4122             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4123                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4124         16  CF-MORTG-BILLING-AREA.
  4125             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4126                                            PIC X.
  4127         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4128         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4129         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4130         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4131             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4132             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4133         16  FILLER                         PIC X.
  4134         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4135             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4136             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4137         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4138         16  FILLER                         PIC X(8).
  4139         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4140         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4141         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4142         16  CF-ACH-COMPANY-ID.
  4143             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4144                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4145                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4146                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4147             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4148         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4149             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4150         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4151             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4152             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4153         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4154         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  83
* EL650.cbl
  4155         16  FILLER                         PIC X(536).
  4156
  4157****************************************************************
  4158*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4159****************************************************************
  4160
  4161     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4162         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4163             20  CF-FEMALE-HEIGHT.
  4164                 24  CF-FEMALE-FT           PIC 99.
  4165                 24  CF-FEMALE-IN           PIC 99.
  4166             20  CF-FEMALE-MIN-WT           PIC 999.
  4167             20  CF-FEMALE-MAX-WT           PIC 999.
  4168         16  FILLER                         PIC X(428).
  4169
  4170     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4171         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4172             20  CF-MALE-HEIGHT.
  4173                 24  CF-MALE-FT             PIC 99.
  4174                 24  CF-MALE-IN             PIC 99.
  4175             20  CF-MALE-MIN-WT             PIC 999.
  4176             20  CF-MALE-MAX-WT             PIC 999.
  4177         16  FILLER                         PIC X(428).
  4178******************************************************************
  4179*             AUTOMATIC ACTIVITY RECORD                          *
  4180******************************************************************
  4181     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4182         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4183             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4184             20  CF-SYS-LETTER-ID           PIC X(04).
  4185             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4186             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4187             20  CF-SYS-RESET-SW            PIC X(01).
  4188             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4189             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4190
  4191         16  FILLER                         PIC X(50).
  4192
  4193         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4194             20  CF-USER-ACTIVE-SW          PIC X(01).
  4195             20  CF-USER-LETTER-ID          PIC X(04).
  4196             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4197             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4198             20  CF-USER-RESET-SW           PIC X(01).
  4199             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4200             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4201             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4202
  4203         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  84
* EL650.cbl
  4205*    COPY ERCPNDB.
  4206******************************************************************
  4207*                                                                *
  4208*                                                                *
  4209*                            ERCPNDB.                            *
  4210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4211*                            VMOD=2.025                          *
  4212*                                                                *
  4213*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4214*                                                                *
  4215******************************************************************
  4216*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4217*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4218******************************************************************
  4219*                                                                *
  4220*                                                                *
  4221*   FILE TYPE = VSAM,KSDS                                        *
  4222*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4223*                                                                *
  4224*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4225*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4226*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4227*                                                 RKP=13,LEN=36  *
  4228*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4229*                                      AND CHG-SEQ.)             *
  4230*                                                RKP=49,LEN=11   *
  4231*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4232*                                      AND CHG-SEQ.)             *
  4233*                                                RKP=60,LEN=15   *
  4234*                                                                *
  4235*   LOG = NO                                                     *
  4236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4237******************************************************************
  4238******************************************************************
  4239*                   C H A N G E   L O G
  4240*
  4241* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4242*-----------------------------------------------------------------
  4243*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4244* EFFECTIVE    NUMBER
  4245*-----------------------------------------------------------------
  4246* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4247* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4248* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4249* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4250* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4251* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4252* 032306                   PEMA  ADD BOW LOAN NUMBER
  4253* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4254* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4255* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4256* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4257* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4258* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4259* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4260* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4261* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4262* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  85
* EL650.cbl
  4263******************************************************************
  4264
  4265 01  PENDING-BUSINESS.
  4266     12  PB-RECORD-ID                     PIC XX.
  4267         88  VALID-PB-ID                        VALUE 'PB'.
  4268
  4269     12  PB-CONTROL-PRIMARY.
  4270         16  PB-COMPANY-CD                PIC X.
  4271         16  PB-ENTRY-BATCH               PIC X(6).
  4272         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4273         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4274
  4275     12  PB-CONTROL-BY-ACCOUNT.
  4276         16  PB-COMPANY-CD-A1             PIC X.
  4277         16  PB-CARRIER                   PIC X.
  4278         16  PB-GROUPING.
  4279             20  PB-GROUPING-PREFIX       PIC XXX.
  4280             20  PB-GROUPING-PRIME        PIC XXX.
  4281         16  PB-STATE                     PIC XX.
  4282         16  PB-ACCOUNT.
  4283             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4284             20  PB-ACCOUNT-PRIME         PIC X(6).
  4285         16  PB-CERT-EFF-DT               PIC XX.
  4286         16  PB-CERT-NO.
  4287             20  PB-CERT-PRIME            PIC X(10).
  4288             20  PB-CERT-SFX              PIC X.
  4289         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4290
  4291         16  PB-RECORD-TYPE               PIC X.
  4292             88  PB-MAILING-DATA                VALUE '0'.
  4293             88  PB-ISSUE                       VALUE '1'.
  4294             88  PB-CANCELLATION                VALUE '2'.
  4295             88  PB-BATCH-TRAILER               VALUE '9'.
  4296
  4297     12  PB-CONTROL-BY-ORIG-BATCH.
  4298         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4299         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4300         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4301         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4302
  4303     12  PB-CONTROL-BY-CSR.
  4304         16  PB-CSR-COMPANY-CD            PIC X.
  4305         16  PB-CSR-ID                    PIC X(4).
  4306         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4307         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4308         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4309******************************************************************
  4310*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4311******************************************************************
  4312
  4313     12  PB-LAST-MAINT-DT                 PIC XX.
  4314     12  PB-LAST-MAINT-BY                 PIC X(4).
  4315     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4316
  4317     12  PB-RECORD-BODY                   PIC X(375).
  4318
  4319     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4320         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  86
* EL650.cbl
  4321             88  CLASIC-CREATED-CERT         VALUE '1'.
  4322         16  PB-I-NAME.
  4323             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4324             20  PB-I-INSURED-FIRST-NAME.
  4325                 24  PB-I-INSURED-1ST-INIT PIC X.
  4326                 24  FILLER                PIC X(9).
  4327             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4328         16  PB-I-AGE                     PIC S99   COMP-3.
  4329         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4330         16  PB-I-BIRTHDAY                PIC XX.
  4331         16  PB-I-INSURED-SEX             PIC X.
  4332             88  PB-SEX-MALE     VALUE 'M'.
  4333             88  PB-SEX-FEMALE   VALUE 'F'.
  4334
  4335         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4336         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4337         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4338         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4339         16  PB-I-SKIP-CODE               PIC X.
  4340             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4341             88  PB-SKIP-JULY              VALUE '1'.
  4342             88  PB-SKIP-AUGUST            VALUE '2'.
  4343             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4344             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4345             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4346             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4347             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4348             88  PB-SKIP-JUNE              VALUE '8'.
  4349             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4350             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4351             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4352         16  PB-I-TERM-TYPE               PIC X.
  4353             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4354             88  PB-PAID-WEEKLY            VALUE 'W'.
  4355             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4356             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4357             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4358         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4359         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4360         16  PB-I-DATA-ENTRY-SW           PIC X.
  4361             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4362             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4363             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4364             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4365         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4366         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4367*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4368         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4369         16  FILLER                       PIC X.
  4370
  4371         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4372             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4373             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4374                                                   '90' THRU '99'.
  4375         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4376                                          PIC XX.
  4377         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4378         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  87
* EL650.cbl
  4379                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4380         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4381         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4382                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4383         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4384         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4385         16  PB-I-CLP-AMOUNT REDEFINES
  4386                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4387         16  PB-I-LF-CALC-FLAG            PIC X.
  4388             88 PB-COMP-LF-PREM               VALUE '?'.
  4389         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4390         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4391         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4392         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4393         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4394         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4395         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4396         16  PB-I-LF-ABBR                 PIC XXX.
  4397         16  PB-I-LF-INPUT-CD             PIC XX.
  4398
  4399         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4400             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4401             88  PB-INVALID-AH               VALUE '  ' '00'
  4402                                                   '90' THRU '99'.
  4403         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4404         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4405         16  PB-I-AH-CALC-FLAG            PIC X.
  4406             88 PB-COMP-AH-PREM                  VALUE '?'.
  4407         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4408         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4409         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4410         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4411         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4412         16  PB-I-AH-ABBR                 PIC XXX.
  4413         16  PB-I-AH-INPUT-CD             PIC XXX.
  4414
  4415         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4416         16  PB-I-REIN-TABLE              PIC XXX.
  4417         16  PB-I-BUSINESS-TYPE           PIC 99.
  4418         16  PB-I-INDV-GRP-CD             PIC X.
  4419         16  PB-I-MORT-CODE.
  4420             20  PB-I-TABLE               PIC X.
  4421             20  PB-I-INTEREST            PIC XX.
  4422             20  PB-I-MORT-TYP            PIC X.
  4423         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4424         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4425         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4426         16  PB-I-INDV-GRP-OVRD           PIC X.
  4427         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4428         16  PB-I-SIG-SW                  PIC X.
  4429             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4430         16  PB-I-RATE-CLASS              PIC XX.
  4431         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4432         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4433         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4434         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4435         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4436         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  88
* EL650.cbl
  4437         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4438         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4439         16  PB-I-OB-FLAG                 PIC X.
  4440             88  PB-I-OB                      VALUE 'B'.
  4441             88  PB-I-SUMMARY                 VALUE 'Z'.
  4442         16  PB-I-ENTRY-STATUS            PIC X.
  4443             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4444                                              'M' '5' '9' '2'.
  4445             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4446             88  PB-I-POLICY-PENDING          VALUE '2'.
  4447             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4448             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4449             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4450             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4451             88  PB-I-REIN-ONLY               VALUE '9'.
  4452             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4453             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4454             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4455             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4456         16  PB-I-INT-CODE                PIC X.
  4457             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4458             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4459         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4460         16  PB-I-SOC-SEC-NO              PIC X(11).
  4461         16  PB-I-MEMBER-NO               PIC X(12).
  4462         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4463*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4464         16  PB-I-OLD-LOF                 PIC XXX.
  4465         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4466         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4467         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4468         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4469         16  PB-I-LIFE-INDICATOR          PIC X.
  4470             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4471         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4472         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4473                                          PIC S9(5)V99    COMP-3.
  4474         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4475             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4476             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4477         16  PB-I-1ST-PMT-DT              PIC XX.
  4478         16  PB-I-JOINT-INSURED.
  4479             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4480             20 PB-I-JOINT-FIRST-NAME.
  4481                24  PB-I-JOINT-FIRST-INIT PIC X.
  4482                24  FILLER                PIC X(9).
  4483             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4484*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4485         16  PB-I-BENEFICIARY-NAME.
  4486             20  PB-I-BANK-NUMBER         PIC X(10).
  4487             20  FILLER                   PIC X(15).
  4488         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4489         16  PB-I-REFERENCE               PIC X(12).
  4490         16  FILLER REDEFINES PB-I-REFERENCE.
  4491             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4492             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4493             20  PB-I-CLP-STATE           PIC XX.
  4494         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  89
* EL650.cbl
  4495             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4496             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4497             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4498         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4499         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4500         16  PB-I-RESIDENT-STATE          PIC XX.
  4501         16  PB-I-RATE-CODE               PIC X(4).
  4502         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4503         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4504         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4505         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4506         16  PB-I-BANK-NOCHRGB            PIC 99.
  4507         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4508         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4509
  4510     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4511         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4512             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4513         16  PB-C-CANCEL-ORIGIN           PIC X.
  4514             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4515         16  PB-C-LF-CANCEL-DT            PIC XX.
  4516         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4517         16  PB-C-LF-CALC-REQ             PIC X.
  4518             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4519         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4520         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4521         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4522             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4523         16  PB-C-AH-CANCEL-DT            PIC XX.
  4524         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4525         16  PB-C-AH-CALC-REQ             PIC X.
  4526             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4527         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4528         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4529         16  PB-C-LAST-NAME               PIC X(15).
  4530         16  PB-C-REFUND-SW               PIC X.
  4531             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4532             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4533         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4534         16  PB-C-PAYEE-CODE              PIC X(6).
  4535         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4536         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4537         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4538         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4539         16  PB-C-REFERENCE               PIC X(12).
  4540         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4541         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4542         16  PB-C-POST-CARD-IND           PIC X.
  4543         16  PB-C-CANCEL-REASON           PIC X.
  4544         16  PB-C-REF-INTERFACE-SW        PIC X.
  4545         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4546         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4547         16  FILLER                       PIC X(01).
  4548*        16  FILLER                       PIC X(18).
  4549         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4550*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4551         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4552         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  90
* EL650.cbl
  4553             20  PB-CI-INSURED-NAME.
  4554                 24  PB-CI-LAST-NAME      PIC X(15).
  4555                 24  PB-CI-INITIALS       PIC XX.
  4556             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4557             20  PB-CI-INSURED-SEX        PIC X.
  4558             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4559             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4560             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4561             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4562             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4563             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4564             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4565             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4566             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4567             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4568             20  PB-CI-RATE-CLASS         PIC XX.
  4569             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4570             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4571             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4572             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4573             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4574             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4575             20  PB-CI-LF-ABBR            PIC X(3).
  4576             20  PB-CI-AH-ABBR            PIC X(3).
  4577             20  PB-CI-OB-FLAG            PIC X.
  4578                 88  PB-CI-OB                VALUE 'B'.
  4579             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4580                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4581                                           'M' '4' '5' '9' '2'.
  4582                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4583                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4584                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4585                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4586                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4587                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4588                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4589                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4590                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4591                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4592                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4593                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4594                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4595             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4596                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4597                                           'M' '4' '5' '9' '2'.
  4598                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4599                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4600                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4601                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4602                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4603                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4604                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4605                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4606                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4607                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4608                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4609                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4610                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  91
* EL650.cbl
  4611             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4612             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4613             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4614             20  PB-CI-MEMBER-NO          PIC X(12).
  4615             20  PB-CI-INT-CODE           PIC X.
  4616                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4617                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4618             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4619             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4620             20  PB-CI-COMP-EXCP-SW       PIC X.
  4621                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4622                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4623             20  PB-CI-ENTRY-STATUS       PIC X.
  4624             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4625             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4626             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4627             20  PB-CI-DEATH-DT           PIC XX.
  4628             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4629             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4630             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4631             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4632             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4633             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4634             20  PB-CI-ENTRY-DT              PIC XX.
  4635             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4636             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4637             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4638             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4639             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4640             20  PB-CI-OLD-LOF               PIC XXX.
  4641*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4642             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4643             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4644             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4645             20  PB-CI-INDV-GRP-CD           PIC X.
  4646             20  PB-CI-BENEFICIARY-NAME.
  4647                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4648                 24  FILLER                  PIC X(15).
  4649             20  PB-CI-NOTE-SW               PIC X.
  4650             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4651             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4652             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4653             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4654             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4655             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4656             20  PB-CI-FIRST-NAME            PIC X(10).
  4657             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4658
  4659         16  FILLER                       PIC X(13).
  4660*032306  16  FILLER                       PIC X(27).
  4661*        16  FILLER                       PIC X(46).
  4662
  4663     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4664         16  FILLER                       PIC X(10).
  4665         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4666         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4667         16  PB-M-INSURED-MID-INIT        PIC X.
  4668         16  PB-M-INSURED-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  92
* EL650.cbl
  4669         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4670         16  PB-M-INSURED-SEX             PIC X.
  4671         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4672         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4673         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4674         16  PB-M-INSURED-CITY-STATE.
  4675             20  PB-M-INSURED-CITY        PIC X(28).
  4676             20  PB-M-INSURED-STATE       PIC XX.
  4677         16  PB-M-INSURED-ZIP-CODE.
  4678             20  PB-M-INSURED-ZIP-PRIME.
  4679                 24  PB-M-INSURED-ZIP-1   PIC X.
  4680                     88  PB-M-CANADIAN-POST-CODE
  4681                                             VALUE 'A' THRU 'Z'.
  4682                 24  FILLER               PIC X(4).
  4683             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4684         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4685                                        PB-M-INSURED-ZIP-CODE.
  4686             20  PM-M-INS-CAN-POST1       PIC XXX.
  4687             20  PM-M-INS-CAN-POST2       PIC XXX.
  4688             20  FILLER                   PIC XXX.
  4689         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4690         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4691         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4692         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4693         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4694         16  PB-M-CRED-BENE-CITYST.
  4695             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4696             20  PB-M-CRED-BENE-STATE     PIC XX.
  4697         16  FILLER                       PIC X(92).
  4698
  4699     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4700         16  FILLER                       PIC X(10).
  4701         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4702         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4703         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4704         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4705         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4706         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4707         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4708         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4709         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4710         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4711         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4712         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4713         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4714         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4715         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4716         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4717         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4718         16  PB-ACCOUNT-NAME              PIC X(30).
  4719         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4720         16  PB-REFERENCE                 PIC X(12).
  4721         16  PB-B-RECEIVED-DT             PIC XX.
  4722         16  FILLER                       PIC X(234).
  4723
  4724     12  PB-RECORD-STATUS.
  4725         16  PB-CREDIT-SELECT-DT          PIC XX.
  4726         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  93
* EL650.cbl
  4727         16  PB-BILLED-DT                 PIC XX.
  4728         16  PB-BILLING-STATUS            PIC X.
  4729             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4730             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4731             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4732         16  PB-RECORD-BILL               PIC X.
  4733             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4734             88  PB-RECORD-RETURNED           VALUE 'R'.
  4735             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4736             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4737             88  PB-OVERRIDE-AH               VALUE 'A'.
  4738             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4739         16  PB-BATCH-ENTRY               PIC X.
  4740             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4741             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4742             88  PB-REISSUED-CERT             VALUE 'E'.
  4743             88  PB-CASH-CERT                 VALUE 'C'.
  4744             88  PB-MONTHLY-CERT              VALUE 'M'.
  4745             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4746             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4747             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4748         16  PB-FORCE-CODE                PIC X.
  4749             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4750             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4751             88  PB-CANCEL-FORCE              VALUE '8'.
  4752             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4753             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4754             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4755             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4756             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4757             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4758             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4759         16  PB-FATAL-FLAG                PIC X.
  4760             88  PB-FATAL-ERRORS              VALUE 'X'.
  4761         16  PB-FORCE-ER-CD               PIC X.
  4762             88  PB-FORCE-ERRORS              VALUE 'F'.
  4763             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4764         16  PB-WARN-ER-CD                PIC X.
  4765             88  PB-WARNING-ERRORS            VALUE 'W'.
  4766         16  FILLER                       PIC X.
  4767         16  PB-OUT-BAL-CD                PIC X.
  4768             88  PB-OUT-OF-BAL                VALUE 'O'.
  4769         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4770         16  PB-AH-OVERRIDE-L1            PIC X.
  4771         16  PB-INPUT-DT                  PIC XX.
  4772         16  PB-INPUT-BY                  PIC X(4).
  4773         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4774         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4775         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4776         16  PB-LF-EARNING-METHOD         PIC X.
  4777         16  PB-AH-EARNING-METHOD         PIC X.
  4778         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4779         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4780         16  PB-REIN-CD                   PIC XXX.
  4781         16  PB-LF-REFUND-TYPE            PIC X.
  4782         16  PB-AH-REFUND-TYPE            PIC X.
  4783         16  PB-ACCT-EFF-DT               PIC XX.
  4784         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  94
* EL650.cbl
  4785         16  PB-COMPANY-ID                PIC X(3).
  4786         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4787         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4788         16  PB-SV-CARRIER                PIC X.
  4789         16  PB-SV-GROUPING               PIC X(6).
  4790         16  PB-SV-STATE                  PIC XX.
  4791         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4792         16  PB-GA-BILLING-INFO.
  4793             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4794                                          PIC XX.
  4795         16  PB-SV-REMIT-TO  REDEFINES
  4796             PB-GA-BILLING-INFO           PIC X(10).
  4797         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4798         16  PB-I-LOAN-OFFICER            PIC X(5).
  4799         16  PB-I-VIN                     PIC X(17).
  4800
  4801         16  FILLER                       PIC X(04).
  4802         16  IMNET-BYPASS-SW              PIC X.
  4803
  4804******************************************************************
  4805*                COMMON EDIT ERRORS                              *
  4806******************************************************************
  4807
  4808     12  PB-COMMON-ERRORS.
  4809         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4810                                           PIC S9(4)     COMP.
  4811
  4812******************************************************************
  4813*EJECT
  4814*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  95
* EL650.cbl
  4816 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  4817                          COMPENSATION-MASTER
  4818                          NAME-LOOKUP-MASTER PLAN-MASTER
  4819                          CONTROL-FILE PENDING-BUSINESS.
  4820 0000-DFHEXIT SECTION.
  4821     MOVE '9#                    $   ' TO DFHEIV0.
  4822     MOVE 'EL650' TO DFHEIV1.
  4823     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4824
  4825     MOVE LOW-VALUES             TO  WS-VERIFY-AREA.
  4826     INITIALIZE  TEMP-STORAGE-RECORD.
  4827
  4828     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4829     MOVE '5'                    TO  DC-OPTION-CODE.
  4830
  4831     PERFORM 9700-DATE-CONVERSION.
  4832
  4833     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4834     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4835     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4836     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  4837*    display ' beginning of program el650   '
  4838
  4839     IF EIBCALEN  =  0
  4840         GO TO 8800-UNAUTHORIZED-ACCESS.
  4841
  4842     MOVE SCREEN-NUMBER          TO  TS-SCREEN.
  4843     MOVE EIBTRMID               TO  TS-TERM.
  4844     MOVE LOW-VALUES             TO  EL650AI.
  4845
  4846     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4847         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4848
  4849     IF PI-CALLING-PROGRAM  NOT = THIS-PGM
  4850         IF PI-RETURN-TO-PROGRAM  NOT = THIS-PGM
  4851             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4852             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4853             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4854             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4855             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4856             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4857             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4858             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4859             MOVE LOW-VALUES            TO  PI-PROGRAM-WORK-AREA
  4860             MOVE ZEROS                 TO  PI-TOTAL-LINES
  4861                                            PI-LINE-SELECTED
  4862             MOVE SPACE                 TO  PI-RECORD-ADDED-SW
  4863             MOVE 1                     TO  PI-PAGE-NUMBER
  4864         ELSE
  4865             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4866             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4867             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4868             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4869             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4870             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4871             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4872             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4873
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  96
* EL650.cbl
  4874**************************************************************
  4875*               CLIENT "DMD" CUSTOM CODE
  4876* CHECK IF CONTROL PASSED FROM EL608 PROGRAM
  4877* START BROWSE BEGINNING WITH KEY PASSED BY EL608
  4878*              CSO CR# 6475
  4879     IF EIBTRNID  =  EL608-TRANS-ID
  4880         MOVE 1                     TO RETURN-FROM-SW
  4881         MOVE 'Y'                   TO FROM-EL608-SW
  4882         MOVE TRANS-ID              TO EIBTRNID
  4883         MOVE XCTL-EL601            TO PI-RETURN-TO-PROGRAM
  4884         MOVE PI-PREV-VG-ACCOUNT    TO PI-ACCT-CCGSA-KEY
  4885                                       KEY-SAVE
  4886         MOVE LOW-VALUES            TO PI-ACCT-EXP-DT
  4887                                       PI-ACCT-REST-OF-EXP
  4888                                       PI-DATE-RANGE-TABLE
  4889
  4890* EXEC CICS  HANDLE CONDITION
  4891*            NOTFND   (5340-END)
  4892*            ENDFILE  (5330-NOT-FOUND)
  4893*        END-EXEC
  4894*    MOVE '"$I''                  ! " #00004885' TO DFHEIV0
  4895     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4897     MOVE X'2220233030303034383835' TO DFHEIV0(25:11)
  4898     CALL 'kxdfhei1' USING DFHEIV0
  4899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4900         MOVE 'Y'                   TO FIRST-TIME-SW
  4901         MOVE ZEROS                 TO PI-TOTAL-LINES
  4902         SET T-INDEX
  4903             TS-INDEX  TO  +1
  4904         MOVE ACCT-FILE-ID          TO PI-ACCT-ID
  4905         MOVE 1                     TO PI-PAGE-NUMBER
  4906         MOVE 'S'                   TO PI-MAINT
  4907         MOVE DFHPF1                TO EIBAID
  4908         GO TO 1002-SHOW-NEW-RECORDS.
  4909*    END OF CLIENT "DMD" CUSTOM CODE
  4910**************************************************************
  4911
  4912     IF RETURNED-FROM = XCTL-6501 OR XCTL-6502 OR XCTL-6503 OR
  4913                        XCTL-6504 OR XCTL-6505 OR XCTL-6506 OR
  4914                        XCTL-6508
  4915         MOVE 1                     TO  RETURN-FROM-SW
  4916         MOVE PI-PREV-VG-ACCOUNT    TO  PI-ACCT-CCGSA-KEY
  4917         MOVE PI-ACCT-CCGSA-KEY     TO  KEY-SAVE
  4918         MOVE LOW-VALUES            TO  PI-ACCT-EXP-DT
  4919         GO TO 1002-SHOW-NEW-RECORDS.
  4920
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  97
* EL650.cbl
  4922     IF EIBTRNID  NOT =  TRANS-ID
  4923         IF EIBTRNID  NOT = EL640-TRANS-ID  AND
  4924            EIBTRNID  NOT = EL658-TRANS-ID  AND
  4925            EIBTRNID  NOT = EL6311-TRANS-ID AND
  4926            EIBTRNID  NOT = VP6311-TRANS-ID AND
  4927            EIBTRNID  NOT = EL1273-TRANS-ID AND
  4928            EIBTRNID  NOT = EL652-TRANS-ID  AND
  4929            EIBTRNID  NOT = EL6523-TRANS-ID AND
  4930            EIBTRNID  NOT = EL6311NC-TRANS-ID AND
  4931            EIBTRNID  NOT = EL130-TRANS-ID  AND
  4932            EIBTRNID  NOT = EL6592-TRANS-ID AND
  4933            EIBTRNID  NOT = EL6509-TRANS-ID
  4934            AND EIBTRNID NOT = EL6503-TRANS-ID
  4935             GO TO 8100-SEND-INITIAL-MAP
  4936         ELSE
  4937             IF PI-CR-CONTROL-IN-PROGRESS  = SPACES
  4938                 GO TO 8100-SEND-INITIAL-MAP
  4939             ELSE
  4940                 MOVE 'S'             TO  MAINTI
  4941                 MOVE PI-CR-CARRIER   TO  ACARIERI
  4942                 MOVE PI-CR-GROUPING  TO  AGROUPI
  4943                 MOVE PI-CR-STATE     TO  ASTATEI
  4944                 MOVE PI-CR-ACCOUNT   TO  AACCTI
  4945                 MOVE +1              TO  ACARIERL
  4946                                          MAINTL
  4947                 MOVE +6              TO  AGROUPL
  4948                 MOVE +2              TO  ASTATEL
  4949                 MOVE +10             TO  AACCTL
  4950                 GO TO 0330-EDIT-DATA.
  4951
  4952
  4953* EXEC CICS  HANDLE CONDITION
  4954*        PGMIDERR  (9600-PGMID-ERROR)
  4955*        ERROR     (9990-ABEND)
  4956*    END-EXEC.
  4957*    MOVE '"$L.                  ! # #00004941' TO DFHEIV0
  4958     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  4959     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4960     MOVE X'2320233030303034393431' TO DFHEIV0(25:11)
  4961     CALL 'kxdfhei1' USING DFHEIV0
  4962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4963
  4964
  4965     IF EIBAID  = DFHCLEAR
  4966         GO TO 9400-CLEAR.
  4967
  4968     IF PI-PROCESSOR-ID  =  'LGXX'
  4969         GO TO 0200-RECEIVE.
  4970
  4971
  4972* EXEC CICS  READQ TS
  4973*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4974*        INTO    (SECURITY-CONTROL)
  4975*        LENGTH  (SC-COMM-LENGTH)
  4976*        ITEM    (SC-ITEM)
  4977*    END-EXEC.
  4978*    MOVE '*$II   L              ''   #00004952' TO DFHEIV0
  4979     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  98
* EL650.cbl
  4980     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4981     MOVE X'2020233030303034393532' TO DFHEIV0(25:11)
  4982     CALL 'kxdfhei1' USING DFHEIV0,
  4983           PI-SECURITY-TEMP-STORE-ID,
  4984           SECURITY-CONTROL,
  4985           SC-COMM-LENGTH,
  4986           SC-ITEM,
  4987           DFHEIV99,
  4988           DFHEIV99
  4989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4990
  4991
  4992     MOVE SC-CREDIT-DISPLAY (04)  TO  PI-DISPLAY-CAP.
  4993     MOVE SC-CREDIT-UPDATE  (04)  TO  PI-MODIFY-CAP.
  4994
  4995     IF NOT DISPLAY-CAP
  4996         MOVE 'READ'             TO  SM-READ
  4997         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  4998         MOVE ER-0070            TO  EMI-ERROR
  4999         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5000         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  99
* EL650.cbl
  5002 0200-RECEIVE.
  5003     IF EIBAID  = DFHPA1  OR  DFHPA2  OR  DFHPA3
  5004         MOVE ER-0008            TO  EMI-ERROR
  5005         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5006         MOVE -1                 TO  MAINTL
  5007         GO TO 8200-SEND-DATAONLY.
  5008
  5009
  5010* EXEC CICS  RECEIVE
  5011*        MAP     (MAP-NAME)
  5012*        MAPSET  (MAPSET-NAME)
  5013*        INTO    (EL650AI)
  5014*    END-EXEC.
  5015     MOVE LENGTH OF
  5016      EL650AI
  5017       TO DFHEIV11
  5018*    MOVE '8"T I  L              ''   #00004976' TO DFHEIV0
  5019     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5020     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5021     MOVE X'2020233030303034393736' TO DFHEIV0(25:11)
  5022     CALL 'kxdfhei1' USING DFHEIV0,
  5023           MAP-NAME,
  5024           EL650AI,
  5025           DFHEIV11,
  5026           MAPSET-NAME,
  5027           DFHEIV99,
  5028           DFHEIV99
  5029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5030
  5031
  5032     IF PFENTERL  = ZERO
  5033         GO TO 0300-CHECK-PFKEYS.
  5034
  5035     IF EIBAID  NOT = DFHENTER
  5036         MOVE ER-0004            TO  EMI-ERROR
  5037         GO TO 0320-INPUT-ERROR.
  5038
  5039     IF (PFENTERI NUMERIC)
  5040       AND  (PFENTERI GREATER ZERO AND LESS 25)
  5041         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  5042     ELSE
  5043         MOVE ER-0029               TO  EMI-ERROR
  5044         GO TO 0320-INPUT-ERROR.
  5045
  5046 0300-CHECK-PFKEYS.
  5047     IF EIBAID  = DFHPF23
  5048         GO TO 8810-PF23.
  5049
  5050     IF EIBAID  = DFHPF24
  5051         GO TO 9200-RETURN-MAIN-MENU.
  5052
  5053     IF EIBAID  = DFHPF12
  5054         GO TO 9500-PF12.
  5055
  5056     IF MAINTL  NOT = ZERO   AND
  5057        MAINTI  NOT = SPACE  AND
  5058        EIBAID  NOT = DFHENTER
  5059          MOVE ER-0050            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 100
* EL650.cbl
  5060          GO TO 0320-INPUT-ERROR.
  5061
  5062     if (maintl not = zeros)
  5063        and (mainti not = 'D')
  5064        move spaces              to pi-el650-del-sw
  5065     end-if
  5066     IF EIBAID  = DFHPF1
  5067         GO TO 5300-FIND-NEXT-ACCOUNT.
  5068
  5069     IF EIBAID  = DFHPF2
  5070         GO TO 5400-FIND-PREV-ACCOUNT.
  5071
  5072     IF EIBAID  = DFHPF3
  5073         GO TO 5100-FIND-NEXT-RANGE.
  5074
  5075     IF EIBAID  = DFHPF4
  5076         GO TO 5200-FIND-PREV-RANGE.
  5077
  5078     IF EIBAID  = DFHPF5
  5079         GO TO 8900-PF5.
  5080
  5081     IF EIBAID  = DFHPF6
  5082        GO TO 8910-PF6
  5083     END-IF
  5084     IF EIBAID  = DFHENTER
  5085         GO TO 0330-EDIT-DATA.
  5086
  5087     MOVE ER-0029                TO  EMI-ERROR.
  5088
  5089 0320-INPUT-ERROR.
  5090     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5091
  5092     MOVE AL-UNBON               TO  PFENTERA.
  5093
  5094     IF PFENTERL  = ZERO
  5095         MOVE -1                 TO  MAINTL
  5096     ELSE
  5097         MOVE -1                 TO  PFENTERL.
  5098
  5099     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 101
* EL650.cbl
  5101 0330-EDIT-DATA.
  5102     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5103     MOVE '5'                    TO  DC-OPTION-CODE.
  5104
  5105     PERFORM 9700-DATE-CONVERSION.
  5106
  5107     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  5108     MOVE DC-GREG-DATE-1-YMD     TO  CURRENT-SAVE.
  5109
  5110     IF ACARIERL GREATER ZEROS
  5111         IF PI-CARRIER-SECURITY GREATER SPACES
  5112             IF ACARIERI = PI-CARRIER-SECURITY
  5113                 NEXT SENTENCE
  5114             ELSE
  5115                 MOVE -1         TO  ACARIERL
  5116                 MOVE ER-2370    TO  EMI-ERROR
  5117                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5118                 MOVE AL-UABON   TO  ACARIERA
  5119                 GO TO 8200-SEND-DATAONLY.
  5120
  5121     IF MAINTI  = 'S'
  5122       IF LINEL = ZEROS
  5123           MOVE 1 TO PI-PAGE-NUMBER
  5124           GO TO 1000-SHOW-ACCOUNT
  5125       ELSE
  5126           GO TO 1000-SHOW-ACCOUNT.
  5127
  5128     PERFORM 6800-COMPANY-REC-READ  THRU  6899-EXIT.
  5129
  5130     IF EMI-ERROR  NOT = ZEROS
  5131         MOVE -1                 TO  MAINTL
  5132         GO TO 8200-SEND-DATAONLY.
  5133
  5134     IF NOT  MODIFY-CAP
  5135         MOVE 'UPDATE'           TO  SM-READ
  5136         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5137         MOVE ER-0070            TO  EMI-ERROR
  5138         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5139         MOVE AL-UANON           TO  ACARIERA  AGROUPA
  5140                                     ASTATEA   AACCTA
  5141         GO TO 8100-SEND-INITIAL-MAP.
  5142
  5143     IF MAINTI  = 'A'
  5144         GO TO 1500-ADD-ACCOUNT.
  5145
  5146     IF MAINTI  = 'C'
  5147         IF PI-SV-MAINT IS EQUAL TO 'L'
  5148            MOVE -1              TO  MAINTL
  5149            MOVE AL-UABON        TO  MAINTA
  5150            MOVE ER-0899         TO  EMI-ERROR
  5151            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5152            GO TO 8200-SEND-DATAONLY
  5153         ELSE
  5154            GO TO 2000-CHANGE-ACCOUNT.
  5155
  5156     IF MAINTI  = 'D'
  5157         GO TO 2500-DELETE-ACCOUNT.
  5158
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 102
* EL650.cbl
  5159     IF MAINTI  = 'X'
  5160         GO TO 3000-CHANGE-EXPIRATION.
  5161
  5162     IF MAINTI  = 'E'
  5163         GO TO 3500-CHANGE-EFFECTIVE.
  5164
  5165     IF MAINTI  = 'L'
  5166         MOVE 'L'             TO  PI-SV-MAINT
  5167         GO TO 4000-CHANGE-ALL.
  5168
  5169     IF MAINTI  = 'K'
  5170       IF LINEL GREATER ZERO
  5171           GO TO 4900-CREATE-NEW-ACCOUNT
  5172        ELSE
  5173           GO TO 4500-CREATE-NEW-ACCOUNT.
  5174
  5175     IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5176         IF MAINTI  = 'T'
  5177             GO TO 4500-CREATE-NEW-ACCOUNT.
  5178
  5179     IF MAINTI  = 'N'
  5180         GO TO 5000-CREATE-NEW-RANGE.
  5181
  5182     MOVE ER-0023                TO  EMI-ERROR.
  5183
  5184     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5185
  5186     MOVE -1                     TO  MAINTL.
  5187     MOVE AL-UABON               TO  MAINTA.
  5188
  5189     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 103
* EL650.cbl
  5191 1000-SHOW-ACCOUNT.
  5192     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5193
  5194     IF LINEL GREATER ZEROS   AND
  5195        PI-TOTAL-LINES  NOT =  ZEROS
  5196         NEXT SENTENCE
  5197     ELSE
  5198         GO TO 1002-SHOW-NEW-RECORDS.
  5199
  5200     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5201
  5202     IF EMI-ERROR  NOT = ZEROS
  5203         GO TO 8200-SEND-DATAONLY.
  5204
  5205     SET T-INDEX                 TO  LINEI.
  5206
  5207     IF PI-2ND-PAGE
  5208         SET T-INDEX  UP  BY  8
  5209     ELSE
  5210     IF PI-3RD-PAGE
  5211         SET T-INDEX  UP  BY  16
  5212     ELSE
  5213     IF PI-LST-PAGE
  5214         SET T-INDEX  UP  BY  24.
  5215
  5216     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5217     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5218
  5219     IF PI-PREV-ACCOUNT  =  PI-ACCT-CCGSA-KEY
  5220         MOVE MAINTI             TO  PI-MAINT
  5221         MOVE XCTL-6501          TO  PGM-NAME
  5222         GO TO 9300-XCTL
  5223     ELSE
  5224         IF PI-PREV-VG-ACCOUNT = PI-ACCT-CCGSA-KEY
  5225             MOVE MAINTI         TO  PI-MAINT
  5226             MOVE XCTL-6501      TO  PGM-NAME
  5227             PERFORM 7400-READ-TEMP-STORAGE  THRU  7400-EXIT
  5228             SET TS-INDEX        TO  T-INDEX
  5229             MOVE TS-ACCT-KEY (TS-INDEX)
  5230                                 TO  PI-ACCT-CCGSA-KEY
  5231             GO TO 9300-XCTL.
  5232
  5233 1002-SHOW-NEW-RECORDS.
  5234
  5235* EXEC CICS  HANDLE CONDITION
  5236*         NOTFND   (1010-NOT-FOUND)
  5237*         ENDFILE  (1010-NOT-FOUND)
  5238*    END-EXEC.
  5239*    MOVE '"$I''                  ! $ #00005184' TO DFHEIV0
  5240     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5242     MOVE X'2420233030303035313834' TO DFHEIV0(25:11)
  5243     CALL 'kxdfhei1' USING DFHEIV0
  5244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5245
  5246
  5247     SET T-INDEX
  5248        TS-INDEX  TO  +1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 104
* EL650.cbl
  5249
  5250     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  5251
  5252     MOVE LOW-VALUES             TO  TEMP-STORAGE-RECORD.
  5253
  5254     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  5255
  5256     PERFORM 7100-START-BROWSE  THRU  7100-EXIT.
  5257
  5258     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  5259
  5260 1005-READ-ACCT.
  5261     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  5262
  5263     IF K-WITH-LINE-NO
  5264       IF SV-CARRIER   NOT = AM-CARRIER  OR
  5265          SV-GROUPING  NOT = AM-GROUPING OR
  5266          SV-STATE     NOT = AM-STATE    OR
  5267          SV-ACCOUNT   NOT = AM-ACCOUNT
  5268            GO TO 1010-NOT-FOUND.
  5269
  5270     IF SV-CO  NOT = AM-COMPANY-CD
  5271         GO TO 1010-NOT-FOUND.
  5272
  5273     IF SV-ACCOUNT  NOT =  AM-ACCOUNT
  5274         GO TO 1010-NOT-FOUND.
  5275
  5276     IF SV-STATE  NOT = AM-STATE
  5277       AND  (ST-ACCNT-CNTL
  5278       OR  CARR-ST-ACCNT-CNTL
  5279       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5280         GO TO 1010-NOT-FOUND.
  5281
  5282     IF SV-CARRIER  NOT =  AM-CARRIER
  5283       AND  (CARR-ACCNT-CNTL
  5284       OR  CARR-ST-ACCNT-CNTL
  5285       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5286         GO TO 1010-NOT-FOUND.
  5287
  5288     IF SV-GROUPING  NOT = AM-GROUPING
  5289       AND  CARR-GROUP-ST-ACCNT-CNTL
  5290         GO TO 1010-NOT-FOUND.
  5291
  5292     IF AM-TRNTO-DTE  =  SPACES
  5293         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  5294
  5295     IF AM-TRNFROM-DTE  = SPACES
  5296         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  5297
  5298     IF T-INDEX  = 1
  5299         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5300             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  5301             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  5302             MOVE SPACE              TO  DC-OPTION-CODE
  5303             PERFORM 9700-DATE-CONVERSION
  5304             IF DATE-CONVERSION-ERROR
  5305                 MOVE SPACES         TO  TRNTODTO
  5306             ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 105
* EL650.cbl
  5307                 MOVE DC-GREG-DATE-1-EDIT
  5308                                     TO  TRNTODTO.
  5309
  5310     IF T-INDEX  =  1
  5311         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5312             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  5313             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  5314             MOVE SPACE                TO  DC-OPTION-CODE
  5315             PERFORM 9700-DATE-CONVERSION
  5316             IF DATE-CONVERSION-ERROR
  5317                 MOVE SPACES           TO  TRNFRDTO
  5318             ELSE
  5319                 MOVE DC-GREG-DATE-1-EDIT
  5320                                       TO  TRNFRDTO.
  5321
  5322     IF T-INDEX  = 1
  5323         MOVE AM-CONTROL-PRIMARY  TO  PI-PREV-ACCOUNT
  5324         MOVE PI-ACCT-CCGSA-KEY   TO  PI-PREV-VG-ACCOUNT
  5325         MOVE AM-NAME             TO  NAMEO
  5326                                      PI-ACCNAME
  5327         MOVE SPACE               TO  NAMEFLGO
  5328                                      PI-NAMEFLG.
  5329
  5330     IF AM-NAME  NOT = NAMEO
  5331         MOVE '*'                TO  NAMEFLGO
  5332                                     PI-NAMEFLG.
  5333
  5334     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  5335
  5336     GO TO 1005-READ-ACCT.
  5337
  5338 1010-NOT-FOUND.
  5339     IF BROWSE-STARTED
  5340
  5341* EXEC CICS  ENDBR
  5342*            DATASET  (PI-ACCT-ID)
  5343*        END-EXEC.
  5344     MOVE 0
  5345       TO DFHEIV11
  5346*    MOVE '&2                    $   #00005282' TO DFHEIV0
  5347     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5348     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5349     MOVE X'2020233030303035323832' TO DFHEIV0(25:11)
  5350     CALL 'kxdfhei1' USING DFHEIV0,
  5351           PI-ACCT-ID,
  5352           DFHEIV11,
  5353           DFHEIV99
  5354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5355
  5356
  5357     IF T-INDEX  NOT = 1
  5358         PERFORM 7200-WRITE-TEMP-STORAGE  THRU  7200-EXIT
  5359         GO TO 7000-BUILD-OUTPUT-MAP.
  5360
  5361     MOVE ER-0226                TO  EMI-ERROR.
  5362
  5363     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5364
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 106
* EL650.cbl
  5365     MOVE -1                     TO  ACARIERL.
  5366     MOVE AL-UABON               TO  ACARIERA
  5367                                     AGROUPA
  5368                                     ASTATEA
  5369                                     AACCTA.
  5370
  5371     IF FROM-EL608-SW = 'Y'
  5372         MOVE SV-CARRIER     TO  ACARIERO
  5373         MOVE SV-GROUPING    TO  AGROUPO
  5374         MOVE SV-STATE       TO  ASTATEO
  5375         MOVE SV-ACCOUNT     TO  AACCTO
  5376         MOVE 'N'            TO  FROM-EL608-SW.
  5377
  5378     IF PI-MAINT = 'A'
  5379         IF PI-RECORD-NOT-CREATED
  5380             MOVE SV-CARRIER     TO  ACARIERO
  5381             MOVE SV-GROUPING    TO  AGROUPO
  5382             MOVE SV-STATE       TO  ASTATEO
  5383             MOVE SV-ACCOUNT     TO  AACCTO
  5384             MOVE ER-2151        TO  EMI-ERROR
  5385             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5386             MOVE 'S'            TO  PI-MAINT.
  5387
  5388     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 107
* EL650.cbl
  5390 1020-MOVE-TO-TABLE.
  5391     MOVE AM-EXPIRATION-DT       TO  PI-BIN-EXP-DT   (T-INDEX).
  5392     MOVE AM-EFFECTIVE-DT        TO  PI-BIN-EFF-DT   (T-INDEX).
  5393     MOVE AM-LAST-MAINT-DT       TO  PI-BIN-MAINT-DT (T-INDEX).
  5394     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5395     MOVE '3'                    TO  DC-OPTION-CODE.
  5396
  5397     PERFORM 9700-DATE-CONVERSION.
  5398
  5399     IF DATE-CONVERSION-ERROR
  5400         MOVE LOW-VALUES         TO  PI-BIN-HI-CERT (T-INDEX)
  5401     ELSE
  5402         MOVE DC-BIN-DATE-1      TO  PI-BIN-HI-CERT (T-INDEX).
  5403
  5404     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5405     MOVE '3'                    TO  DC-OPTION-CODE.
  5406
  5407     PERFORM 9700-DATE-CONVERSION.
  5408
  5409     IF DATE-CONVERSION-ERROR
  5410         MOVE LOW-VALUES         TO  PI-BIN-LO-CERT (T-INDEX)
  5411     ELSE
  5412         MOVE DC-BIN-DATE-1      TO  PI-BIN-LO-CERT (T-INDEX).
  5413
  5414     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
  5415     MOVE AM-CONTROL-PRIMARY     TO  TS-ACCT-KEY (TS-INDEX).
  5416
  5417     ADD 1                       TO  PI-TOTAL-LINES.
  5418
  5419     SET T-INDEX
  5420        TS-INDEX  UP  BY  +1.
  5421
  5422     IF T-INDEX  = +33
  5423         GO TO 7000-BUILD-OUTPUT-MAP.
  5424
  5425
  5426 1020-EXIT.
  5427     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 108
* EL650.cbl
  5429 1500-ADD-ACCOUNT.
  5430     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5431
  5432     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5433
  5434     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5435                                     PI-ACCT-REST-OF-EXP.
  5436
  5437     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  5438
  5439     IF REC-FOUND
  5440         MOVE -1                 TO  ACARIERL
  5441         MOVE ER-0561            TO  EMI-ERROR
  5442         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5443         GO TO 8200-SEND-DATAONLY.
  5444
  5445     MOVE NEW-KEY-SAVE           TO PI-ACCT-CCGSA-KEY.
  5446
  5447     PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT.
  5448
  5449     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5450
  5451     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  5452
  5453     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  5454         MOVE -1                 TO  EXPCHGL
  5455         MOVE ER-1228            TO  EMI-ERROR
  5456         MOVE AL-UABON           TO  EXPCHGA
  5457         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5458
  5459     IF NOT EMI-NO-ERRORS
  5460         GO TO 8200-SEND-DATAONLY.
  5461
  5462     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  5463
  5464     IF WS-ACCT2-FOUND  = 'Y'
  5465         PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  5466             VARYING  WS-INDEX  FROM  +1  BY  +1
  5467                UNTIL WS-INDEX GREATER +32.
  5468
  5469     IF NOT EMI-NO-ERRORS
  5470         GO TO 8200-SEND-DATAONLY.
  5471
  5472     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5473
  5474     MOVE NEW-KEY-SAVE           TO  PI-ACCT-CCGSA-KEY
  5475                                     PI-PREV-ACCOUNT
  5476                                     PI-PREV-VG-ACCOUNT.
  5477     MOVE LOW-VALUES             TO  PI-DATE-RANGE-TABLE
  5478                                     PI-ACCT-REST-OF-EXP.
  5479     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  5480                                     PI-BIN-EXP-DT (1)
  5481     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT (1).
  5482     MOVE 1                      TO  PI-TOTAL-LINES
  5483                                     PI-PAGE-NUMBER
  5484                                     PI-LINE-SELECTED.
  5485     MOVE SPACE                  TO  PI-RECORD-ADDED-SW.
  5486     MOVE MAINTI                 TO  PI-MAINT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 109
* EL650.cbl
  5487     MOVE XCTL-6501              TO  PGM-NAME.
  5488
  5489     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 110
* EL650.cbl
  5491 2000-CHANGE-ACCOUNT.
  5492     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5493
  5494     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5495
  5496     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5497
  5498     IF NOT EMI-NO-ERRORS
  5499         GO TO 8200-SEND-DATAONLY.
  5500
  5501     SET T-INDEX TO LINEI.
  5502
  5503     IF PI-2ND-PAGE
  5504         SET T-INDEX  UP  BY  8
  5505     ELSE
  5506     IF PI-3RD-PAGE
  5507         SET T-INDEX  UP  BY  16
  5508     ELSE
  5509     IF PI-LST-PAGE
  5510         SET T-INDEX  UP  BY  24.
  5511
  5512     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5513     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5514     MOVE MAINTI                   TO  PI-MAINT.
  5515     MOVE XCTL-6501                TO  PGM-NAME.
  5516
  5517     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 111
* EL650.cbl
  5519 2500-DELETE-ACCOUNT.
  5520     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5521
  5522     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5523
  5524     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5525
  5526     IF NOT EMI-NO-ERRORS
  5527         GO TO 8200-SEND-DATAONLY.
  5528
  5529     SET T-INDEX                 TO  LINEI.
  5530
  5531     IF PI-2ND-PAGE
  5532         SET T-INDEX  UP  BY  8
  5533     ELSE
  5534     IF PI-3RD-PAGE
  5535         SET T-INDEX  UP  BY  16
  5536     ELSE
  5537     IF PI-LST-PAGE
  5538         SET T-INDEX  UP  BY  24.
  5539
  5540     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  5541                                       BIN-MAX-DATE.
  5542     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5543     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-MIN-DATE.
  5544     MOVE '1'                      TO  FROM-WHERE-SW.
  5545
  5546     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5547       VARYING  T-INDEX  FROM  +1  BY  +1
  5548         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5549
  5550     MOVE SPACE                  TO  FROM-WHERE-SW.
  5551
  5552     IF NOT EMI-NO-ERRORS
  5553         GO TO 8200-SEND-DATAONLY.
  5554
  5555     SET T-INDEX TO LINEI.
  5556
  5557     IF PI-2ND-PAGE
  5558         SET T-INDEX  UP  BY  8
  5559     ELSE
  5560     IF PI-3RD-PAGE
  5561         SET T-INDEX  UP  BY  16
  5562     ELSE
  5563     IF PI-LST-PAGE
  5564         SET T-INDEX  UP  BY  24.
  5565
  5566
  5567* EXEC CICS  READ
  5568*        UPDATE
  5569*        DATASET  (PI-ACCT-ID)
  5570*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5571*        RIDFLD   (PI-ACCT-KEY)
  5572*    END-EXEC.
  5573*    MOVE '&"S        EU         (   #00005495' TO DFHEIV0
  5574     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5575     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5576     MOVE X'2020233030303035343935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 112
* EL650.cbl
  5577     CALL 'kxdfhei1' USING DFHEIV0,
  5578           PI-ACCT-ID,
  5579           DFHEIV20,
  5580           DFHEIV99,
  5581           PI-ACCT-KEY,
  5582           DFHEIV99,
  5583           DFHEIV99,
  5584           DFHEIV99
  5585     SET ADDRESS OF ACCOUNT-MASTER TO
  5586         DFHEIV20
  5587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5588
  5589
  5590     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES  OR
  5591        PI-BIN-HI-CERT (T-INDEX)  NOT =  LOW-VALUES
  5592         MOVE ER-2070            TO  EMI-ERROR
  5593         MOVE -1                 TO  MAINTL
  5594         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5595         GO TO 8200-SEND-DATAONLY.
  5596
  5597     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5598         MOVE 'N'                TO  PENDING-BUSINESS-SW
  5599     ELSE
  5600         PERFORM 2560-CHECK-PENDING-BUSINESS  THRU  2569-EXIT.
  5601
  5602     IF THERE-IS-PENDING-BUSINESS
  5603         MOVE ER-1612            TO  EMI-ERROR
  5604         MOVE -1                 TO  MAINTL
  5605         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5606         GO TO 8200-SEND-DATAONLY.
  5607
  5608     MOVE AM-CONTROL-PRIMARY     TO  B4-ACCT-KEY.
  5609     MOVE AM-EFFECTIVE-DT        TO  B4-ACCT-EFF-DT.
  5610
  5611     if pi-el650-del-sw = 'Y'
  5612        continue
  5613     else
  5614        move 'Y'                 to pi-el650-del-sw
  5615        move er-1299             to emi-error
  5616        perform 9900-error-format thru 9900-exit
  5617        MOVE 1 TO PI-PAGE-NUMBER
  5618        move spaces              to mainto
  5619        MOVE -1                  TO MAINTL
  5620        GO TO 1000-SHOW-ACCOUNT
  5621     end-if
  5622     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  5623
  5624****** DO NOT DELETE PLAN MASTER RECORDS IF MORE ACCT DATE RANGES
  5625     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5626         NEXT SENTENCE
  5627     ELSE
  5628         IF PI-TOTAL-LINES  = 1
  5629             PERFORM 4800-DELETE-PLAN-REC   THRU  4899-EXIT
  5630         end-if
  5631     end-if
  5632
  5633     MOVE 'D'                    TO  JP-RECORD-TYPE
  5634     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 113
* EL650.cbl
  5635
  5636
  5637* EXEC CICS  DELETE
  5638*        DATASET  (PI-ACCT-ID)
  5639*    END-EXEC
  5640*    MOVE '&(                    &   #00005548' TO DFHEIV0
  5641     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5642     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5643     MOVE X'2020233030303035353438' TO DFHEIV0(25:11)
  5644     CALL 'kxdfhei1' USING DFHEIV0,
  5645           PI-ACCT-ID,
  5646           DFHEIV99,
  5647           DFHEIV99,
  5648           DFHEIV99,
  5649           DFHEIV99
  5650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5651
  5652     PERFORM 8400-LOG-JOURNAL-RECORD
  5653
  5654     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT
  5655
  5656     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5657                                     PI-ACCT-REST-OF-EXP
  5658                                     LINEO
  5659     MOVE ER-0000                TO  EMI-ERROR
  5660
  5661     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5662
  5663     IF PI-TOTAL-LINES  = 1
  5664         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  5665         MOVE ZEROS              TO  PI-TOTAL-LINES
  5666         MOVE 1                  TO  PI-PAGE-NUMBER
  5667         GO TO 7000-BUILD-OUTPUT-MAP
  5668     end-if
  5669     GO TO 1002-SHOW-NEW-RECORDS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 114
* EL650.cbl
  5671 2550-CHECK-HI-LO-DATES.
  5672     IF FROM-CHANGE
  5673         GO TO 2550-CHECK-CHANGE.
  5674
  5675     IF PI-BIN-LO-CERT (T-INDEX)  =  LOW-VALUES  AND
  5676        PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  5677         GO TO 2550-CHECK-AR-DELETE.
  5678
  5679     IF ((PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5680          PI-BIN-HI-CERT (T-INDEX) LESS BIN-MAX-DATE)
  5681       OR
  5682         (PI-BIN-LO-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5683          PI-BIN-LO-CERT (T-INDEX) LESS BIN-MAX-DATE))
  5684       AND
  5685            (PI-PROCESSOR-ID  NOT =  'LGXX')
  5686         MOVE ER-2087            TO  EMI-ERROR
  5687         MOVE -1                 TO  MAINTL
  5688         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5689
  5690 2550-CHECK-AR-DELETE.
  5691     IF NOT PI-AR-PROCESSING
  5692         GO TO 2550-EXIT.
  5693
  5694     IF T-INDEX NOT = LINEI
  5695         GO TO 2550-EXIT.
  5696
  5697     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  5698        GO TO 2550-EXIT.
  5699
  5700     MOVE ER-3155                TO  EMI-ERROR
  5701     MOVE -1                     TO  MAINTL
  5702     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5703
  5704 2550-CHECK-CHANGE.
  5705     IF PI-BIN-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  5706         GO TO 2550-CHECK-AR-CHANGE.
  5707
  5708     IF PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5709         MOVE ER-2113            TO  EMI-ERROR
  5710         MOVE -1                 TO  MAINTL
  5711         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5712
  5713 2550-CHECK-AR-CHANGE.
  5714      IF NOT PI-AR-PROCESSING
  5715          GO TO 2550-EXIT.
  5716
  5717      IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES
  5718          GO TO 2550-EXIT.
  5719
  5720      IF PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5721         MOVE ER-3155            TO  EMI-ERROR
  5722         MOVE -1                 TO  MAINTL
  5723         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5724
  5725 2550-EXIT.
  5726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 115
* EL650.cbl
  5728 2560-CHECK-PENDING-BUSINESS.
  5729     MOVE 'N'                    TO  PENDING-BUSINESS-SW.
  5730     MOVE LOW-VALUES             TO  ERPNDB-KEY
  5731                                     PI-ERPNDB-ALT-KEY.
  5732     MOVE AM-COMPANY-CD-A1       TO  PNDB-COMPANY-CD-A1
  5733                                     PI-PB-COMPANY-CD-A1.
  5734     MOVE AM-VG-CARRIER          TO  PNDB-CARRIER
  5735                                     PI-PB-CARRIER.
  5736     MOVE AM-VG-GROUPING         TO  PNDB-GROUPING
  5737                                     PI-PB-GROUPING.
  5738     MOVE AM-VG-STATE            TO  PNDB-STATE
  5739                                     PI-PB-STATE.
  5740     MOVE AM-VG-ACCOUNT          TO  PNDB-ACCOUNT
  5741                                     PI-PB-ACCOUNT.
  5742
  5743
  5744* EXEC CICS  HANDLE CONDITION
  5745*         NOTFND   (2568-NO-RECORDS)
  5746*         ENDFILE  (2568-NO-RECORDS)
  5747*    END-EXEC.
  5748*    MOVE '"$I''                  ! % #00005643' TO DFHEIV0
  5749     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5751     MOVE X'2520233030303035363433' TO DFHEIV0(25:11)
  5752     CALL 'kxdfhei1' USING DFHEIV0
  5753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5754
  5755
  5756
  5757* EXEC CICS  STARTBR
  5758*        DATASET  (PEND2-FILE-ID)
  5759*        RIDFLD   (ERPNDB-KEY)
  5760*    END-EXEC.
  5761     MOVE 0
  5762       TO DFHEIV11
  5763*    MOVE '&,         G          &   #00005648' TO DFHEIV0
  5764     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5765     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5766     MOVE X'2020233030303035363438' TO DFHEIV0(25:11)
  5767     CALL 'kxdfhei1' USING DFHEIV0,
  5768           PEND2-FILE-ID,
  5769           ERPNDB-KEY,
  5770           DFHEIV99,
  5771           DFHEIV11,
  5772           DFHEIV99
  5773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5774
  5775
  5776     MOVE 'Y'                    TO  PENDING-BROWSE-SW.
  5777
  5778 2562-READ-NEXT-PENDING.
  5779
  5780* EXEC CICS  READNEXT
  5781*        DATASET  (PEND2-FILE-ID)
  5782*        RIDFLD   (ERPNDB-KEY)
  5783*        SET      (ADDRESS OF PENDING-BUSINESS)
  5784*    END-EXEC.
  5785     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 116
* EL650.cbl
  5786       TO DFHEIV11
  5787*    MOVE '&.S                   )   #00005656' TO DFHEIV0
  5788     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5789     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5790     MOVE X'2020233030303035363536' TO DFHEIV0(25:11)
  5791     CALL 'kxdfhei1' USING DFHEIV0,
  5792           PEND2-FILE-ID,
  5793           DFHEIV20,
  5794           DFHEIV99,
  5795           ERPNDB-KEY,
  5796           DFHEIV99,
  5797           DFHEIV11,
  5798           DFHEIV99,
  5799           DFHEIV99
  5800     SET ADDRESS OF PENDING-BUSINESS TO
  5801         DFHEIV20
  5802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5803
  5804
  5805     IF PB-COMPANY-CD-A1 = PI-PB-COMPANY-CD-A1 AND
  5806        PB-CARRIER       = PI-PB-CARRIER       AND
  5807        PB-GROUPING      = PI-PB-GROUPING      AND
  5808        PB-STATE         = PI-PB-STATE         AND
  5809        PB-ACCOUNT       = PI-PB-ACCOUNT
  5810            NEXT SENTENCE
  5811          ELSE
  5812            GO TO 2568-NO-RECORDS.
  5813
  5814     IF PB-ISSUE
  5815       OR  PB-CANCELLATION
  5816         NEXT SENTENCE
  5817     ELSE
  5818         GO TO 2562-READ-NEXT-PENDING.
  5819
  5820     IF PB-CERT-EFF-DT  IS EQUAL TO  AM-EFFECTIVE-DT
  5821         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5822         GO TO 2568-NO-RECORDS.
  5823
  5824     IF PB-CERT-EFF-DT  IS GREATER THAN  AM-EFFECTIVE-DT
  5825       AND PB-CERT-EFF-DT  IS LESS THAN  AM-EXPIRATION-DT
  5826         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5827         GO TO 2568-NO-RECORDS.
  5828
  5829     GO TO 2562-READ-NEXT-PENDING.
  5830
  5831 2568-NO-RECORDS.
  5832     IF PENDING-BROWSE-STARTED
  5833         MOVE ' '                TO  PENDING-BROWSE-SW
  5834
  5835* EXEC CICS ENDBR
  5836*           DATASET  (PEND2-FILE-ID)
  5837*       END-EXEC.
  5838     MOVE 0
  5839       TO DFHEIV11
  5840*    MOVE '&2                    $   #00005691' TO DFHEIV0
  5841     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5842     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5843     MOVE X'2020233030303035363931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 117
* EL650.cbl
  5844     CALL 'kxdfhei1' USING DFHEIV0,
  5845           PEND2-FILE-ID,
  5846           DFHEIV11,
  5847           DFHEIV99
  5848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5849
  5850
  5851 2569-EXIT.
  5852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 118
* EL650.cbl
  5854 3000-CHANGE-EXPIRATION.
  5855     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5856     PERFORM 6200-CHECK-KEY             THRU  6200-EXIT.
  5857     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5858     PERFORM 4100-BUILD-VERIFICATION    THRU  4199-EXIT.
  5859
  5860     SET T-INDEX  TO  PI-TOTAL-LINES.
  5861
  5862     PERFORM VARYING WS-INDEX FROM +1 BY +1
  5863             UNTIL  PI-BIN-EXP-DT (T-INDEX)
  5864                        =  WS-ACCT-EXP-DT (WS-INDEX)
  5865                 OR  WS-INDEX GREATER +32
  5866     END-PERFORM.
  5867
  5868     IF PI-BIN-EXP-DT (T-INDEX) = WS-ACCT-EXP-DT (WS-INDEX)
  5869         MOVE BIN-EXPCHG-SAVE    TO  WS-ACCT-EXP-DT (WS-INDEX)
  5870         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  5871             VARYING  WS-INDEX  FROM  +1  BY  +1
  5872               UNTIL  WS-INDEX GREATER +32
  5873     ELSE
  5874         MOVE ER-0453            TO  EMI-ERROR
  5875         MOVE -1                 TO  MAINTL
  5876         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5877
  5878     IF NOT EMI-NO-ERRORS
  5879         GO TO 8200-SEND-DATAONLY.
  5880
  5881     MOVE BIN-EXPCHG-SAVE        TO  BIN-MAX-DATE.
  5882     MOVE '2'                    TO  FROM-WHERE-SW.
  5883
  5884     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5885       VARYING  T-INDEX  FROM  +1  BY  +1
  5886         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5887
  5888     MOVE SPACE                  TO  FROM-WHERE-SW.
  5889
  5890     IF NOT EMI-NO-ERRORS
  5891         GO TO 8200-SEND-DATAONLY.
  5892
  5893     SET T-INDEX  TO  PI-TOTAL-LINES.
  5894     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  5895
  5896     IF NOT EMI-NO-ERRORS
  5897         GO TO 8200-SEND-DATAONLY.
  5898
  5899     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5900     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5901     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  5902     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  5903
  5904     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  5905
  5906     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  5907                                     AM-VG-EXPIRATION-DT
  5908                                     PI-BIN-EXP-DT (T-INDEX).
  5909     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  5910                                     PI-BIN-MAINT-DT (T-INDEX).
  5911     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 119
* EL650.cbl
  5912     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  5913
  5914     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  5915
  5916     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  5917
  5918     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  5919
  5920     MOVE SPACES                 TO  EXPCHGI.
  5921     MOVE AL-UANOF               TO  EXPCHGA.
  5922     MOVE ER-0000                TO  EMI-ERROR.
  5923
  5924     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5925
  5926     GO TO 7000-BUILD-OUTPUT-MAP.
  5927
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 120
* EL650.cbl
  5929 3100-DELETE-DATE-RANGE.
  5930
  5931* EXEC CICS GETMAIN
  5932*        LENGTH   (ACCT-REC-LEN)
  5933*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5934*        INITIMG  (GETMAIN-SPACE)
  5935*    END-EXEC.
  5936*    MOVE ',"IL                  $   #00005774' TO DFHEIV0
  5937     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5938     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5939     MOVE X'2020233030303035373734' TO DFHEIV0(25:11)
  5940     CALL 'kxdfhei1' USING DFHEIV0,
  5941           DFHEIV20,
  5942           ACCT-REC-LEN,
  5943           GETMAIN-SPACE
  5944     SET ADDRESS OF ACCOUNT-MASTER TO
  5945         DFHEIV20
  5946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5947
  5948
  5949
  5950* EXEC CICS  HANDLE CONDITION
  5951*        NOTFND   (3175-CONTINUE)
  5952*        ENDFILE  (3175-CONTINUE)
  5953*    END-EXEC.
  5954*    MOVE '"$I''                  ! & #00005780' TO DFHEIV0
  5955     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5957     MOVE X'2620233030303035373830' TO DFHEIV0(25:11)
  5958     CALL 'kxdfhei1' USING DFHEIV0
  5959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5960
  5961
  5962
  5963
  5964* EXEC CICS  READ
  5965*        UPDATE
  5966*        DATASET  (PI-ACCT-ID)
  5967*        INTO     (ACCOUNT-MASTER)
  5968*        RIDFLD   (PI-ACCT-KEY)
  5969*    END-EXEC.
  5970     MOVE LENGTH OF
  5971      ACCOUNT-MASTER
  5972       TO DFHEIV11
  5973*    MOVE '&"IL       EU         (   #00005786' TO DFHEIV0
  5974     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5975     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5976     MOVE X'2020233030303035373836' TO DFHEIV0(25:11)
  5977     CALL 'kxdfhei1' USING DFHEIV0,
  5978           PI-ACCT-ID,
  5979           ACCOUNT-MASTER,
  5980           DFHEIV11,
  5981           PI-ACCT-KEY,
  5982           DFHEIV99,
  5983           DFHEIV99,
  5984           DFHEIV99
  5985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5986
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 121
* EL650.cbl
  5987
  5988     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5989     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  5990     MOVE ACCT-FILE-ID           TO  FILE-ID.
  5991
  5992
  5993* EXEC CICS  DELETE
  5994*        DATASET  (PI-ACCT-ID)
  5995*    END-EXEC.
  5996*    MOVE '&(                    &   #00005797' TO DFHEIV0
  5997     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5998     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5999     MOVE X'2020233030303035373937' TO DFHEIV0(25:11)
  6000     CALL 'kxdfhei1' USING DFHEIV0,
  6001           PI-ACCT-ID,
  6002           DFHEIV99,
  6003           DFHEIV99,
  6004           DFHEIV99,
  6005           DFHEIV99
  6006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6007
  6008
  6009     PERFORM 8400-LOG-JOURNAL-RECORD.
  6010
  6011     GO TO 3199-EXIT.
  6012
  6013 3175-CONTINUE.
  6014     IF BROWSE-STARTED
  6015         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6016
  6017     MOVE ER-0226                TO  EMI-ERROR.
  6018
  6019     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6020
  6021     MOVE -1                     TO  MAINTL.
  6022
  6023     GO TO 8200-SEND-DATAONLY.
  6024
  6025 3199-EXIT.
  6026     EXIT.
  6027
  6028 3200-ADD-DATE-RANGE.
  6029     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6030     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6031
  6032
  6033* EXEC CICS  WRITE
  6034*        FROM     (ACCOUNT-MASTER)
  6035*        RIDFLD   (AM-CONTROL-PRIMARY)
  6036*        DATASET  (PI-ACCT-ID)
  6037*    END-EXEC.
  6038     MOVE LENGTH OF
  6039      ACCOUNT-MASTER
  6040       TO DFHEIV11
  6041*    MOVE '&$ L                  ''   #00005824' TO DFHEIV0
  6042     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6043     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6044     MOVE X'2020233030303035383234' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 122
* EL650.cbl
  6045     CALL 'kxdfhei1' USING DFHEIV0,
  6046           PI-ACCT-ID,
  6047           ACCOUNT-MASTER,
  6048           DFHEIV11,
  6049           AM-CONTROL-PRIMARY,
  6050           DFHEIV99,
  6051           DFHEIV99
  6052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6053
  6054
  6055     PERFORM 8400-LOG-JOURNAL-RECORD.
  6056
  6057 3299-EXIT.
  6058     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 123
* EL650.cbl
  6060 3500-CHANGE-EFFECTIVE.
  6061     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6062
  6063     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6064
  6065     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU  6000-EFF-EXIT.
  6066
  6067     IF NOT EMI-NO-ERRORS
  6068         GO TO 8200-SEND-DATAONLY.
  6069
  6070     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  6071
  6072     SET T-INDEX                 TO  +1.
  6073
  6074     PERFORM VARYING  WS-INDEX  FROM  +1  BY  +1
  6075             UNTIL  PI-BIN-EFF-DT (T-INDEX)
  6076                        =  WS-ACCT-EFF-DT (WS-INDEX)
  6077                 OR  WS-INDEX GREATER +32
  6078     END-PERFORM.
  6079
  6080     IF PI-BIN-EFF-DT (T-INDEX)
  6081                 = WS-ACCT-EFF-DT (WS-INDEX)
  6082         MOVE BIN-EFFCHG-SAVE    TO  WS-ACCT-EFF-DT (WS-INDEX)
  6083         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  6084             VARYING  WS-INDEX  FROM  +1  BY  +1
  6085               UNTIL  WS-INDEX GREATER +32
  6086     ELSE
  6087         MOVE ER-0453            TO  EMI-ERROR
  6088         MOVE -1                 TO  MAINTL
  6089         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6090
  6091     IF NOT EMI-NO-ERRORS
  6092         GO TO 8200-SEND-DATAONLY.
  6093
  6094     SET T-INDEX TO  1.
  6095
  6096     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  6097
  6098     IF NOT EMI-NO-ERRORS
  6099         GO TO 8200-SEND-DATAONLY.
  6100
  6101     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6102     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6103     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  6104     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  6105
  6106
  6107* EXEC CICS  READ
  6108*        UPDATE
  6109*        DATASET  (PI-ACCT-ID)
  6110*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6111*        RIDFLD   (PI-ACCT-KEY)
  6112*    END-EXEC.
  6113*    MOVE '&"S        EU         (   #00005881' TO DFHEIV0
  6114     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6115     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6116     MOVE X'2020233030303035383831' TO DFHEIV0(25:11)
  6117     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 124
* EL650.cbl
  6118           PI-ACCT-ID,
  6119           DFHEIV20,
  6120           DFHEIV99,
  6121           PI-ACCT-KEY,
  6122           DFHEIV99,
  6123           DFHEIV99,
  6124           DFHEIV99
  6125     SET ADDRESS OF ACCOUNT-MASTER TO
  6126         DFHEIV20
  6127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6128
  6129
  6130     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6131     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6132     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6133
  6134     PERFORM 8400-LOG-JOURNAL-RECORD.
  6135
  6136     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT
  6137                                     PI-BIN-EFF-DT (T-INDEX).
  6138     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  6139     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  6140                                     PI-BIN-MAINT-DT (T-INDEX).
  6141     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  6142     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  6143     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6144     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6145
  6146     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  6147
  6148
  6149* EXEC CICS  REWRITE
  6150*        FROM     (ACCOUNT-MASTER)
  6151*        DATASET  (PI-ACCT-ID)
  6152*    END-EXEC.
  6153     MOVE LENGTH OF
  6154      ACCOUNT-MASTER
  6155       TO DFHEIV11
  6156*    MOVE '&& L                  %   #00005906' TO DFHEIV0
  6157     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6158     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6159     MOVE X'2020233030303035393036' TO DFHEIV0(25:11)
  6160     CALL 'kxdfhei1' USING DFHEIV0,
  6161           PI-ACCT-ID,
  6162           ACCOUNT-MASTER,
  6163           DFHEIV11,
  6164           DFHEIV99
  6165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6166
  6167
  6168     PERFORM 8400-LOG-JOURNAL-RECORD.
  6169
  6170     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6171
  6172     MOVE SPACES                 TO  EFFCHGO.
  6173
  6174     MOVE ZERO                   TO  EFFCHGL
  6175                                     EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 125
* EL650.cbl
  6176
  6177     MOVE AL-UANOF               TO  EFFCHGA.
  6178
  6179     MOVE ER-0000                TO  EMI-ERROR.
  6180
  6181     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6182
  6183     GO TO 7000-BUILD-OUTPUT-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 126
* EL650.cbl
  6185 4000-CHANGE-ALL.
  6186     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6187
  6188     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6189
  6190     IF NOT EMI-NO-ERRORS
  6191         GO TO 8200-SEND-DATAONLY.
  6192
  6193     MOVE 1                      TO  PI-LINE-SELECTED.
  6194     MOVE MAINTI                 TO  PI-MAINT.
  6195     MOVE XCTL-6501              TO  PGM-NAME.
  6196
  6197     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 127
* EL650.cbl
  6199 4100-BUILD-VERIFICATION.
  6200     MOVE SPACES                 TO  BROWSE-STARTED-SW.
  6201
  6202     SET WS-INDEX  TO  +1.
  6203
  6204     MOVE 'N'                    TO  WS-ACCT2-FOUND.
  6205     MOVE PI-ACCT-KEY            TO  WS-ACCT-VERIFY-KEY.
  6206     MOVE LOW-VALUES             TO  WS-ACCT-VER-EXP-DT
  6207                                     WS-VERIFY-AREA.
  6208
  6209     IF ST-ACCNT-CNTL  OR
  6210        ACCNT-CNTL
  6211          MOVE SPACES             TO  WS-ACCT-VER-CARR.
  6212
  6213     IF ST-ACCNT-CNTL      OR
  6214        CARR-ST-ACCNT-CNTL OR
  6215        ACCNT-CNTL         OR
  6216        CARR-ACCNT-CNTL
  6217          MOVE SPACES             TO  WS-ACCT-VER-GROUP.
  6218
  6219     IF ACCNT-CNTL OR
  6220        CARR-ACCNT-CNTL
  6221          MOVE SPACES             TO  WS-ACCT-VER-STATE.
  6222
  6223     MOVE WS-ACCT-VERIFY-KEY     TO  WS-SAVE-VERIFY-KEY.
  6224
  6225
  6226* EXEC CICS  HANDLE CONDITION
  6227*        NOTFND   (4175-CONTINUE)
  6228*        ENDFILE  (4175-CONTINUE)
  6229*    END-EXEC.
  6230*    MOVE '"$I''                  ! '' #00005968' TO DFHEIV0
  6231     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6233     MOVE X'2720233030303035393638' TO DFHEIV0(25:11)
  6234     CALL 'kxdfhei1' USING DFHEIV0
  6235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6236
  6237
  6238
  6239* EXEC CICS  STARTBR
  6240*        DATASET  (ACCT2-FILE-ID)
  6241*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6242*        GTEQ
  6243*    END-EXEC.
  6244     MOVE 0
  6245       TO DFHEIV11
  6246*    MOVE '&,         G          &   #00005973' TO DFHEIV0
  6247     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6248     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6249     MOVE X'2020233030303035393733' TO DFHEIV0(25:11)
  6250     CALL 'kxdfhei1' USING DFHEIV0,
  6251           ACCT2-FILE-ID,
  6252           WS-ACCT-VERIFY-KEY,
  6253           DFHEIV99,
  6254           DFHEIV11,
  6255           DFHEIV99
  6256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 128
* EL650.cbl
  6257
  6258
  6259     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  6260
  6261 4150-READ-NEXT.
  6262
  6263* EXEC CICS  READNEXT
  6264*        DATASET  (ACCT2-FILE-ID)
  6265*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6266*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6267*    END-EXEC.
  6268     MOVE 0
  6269       TO DFHEIV11
  6270*    MOVE '&.S                   )   #00005982' TO DFHEIV0
  6271     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6272     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6273     MOVE X'2020233030303035393832' TO DFHEIV0(25:11)
  6274     CALL 'kxdfhei1' USING DFHEIV0,
  6275           ACCT2-FILE-ID,
  6276           DFHEIV20,
  6277           DFHEIV99,
  6278           WS-ACCT-VERIFY-KEY,
  6279           DFHEIV99,
  6280           DFHEIV11,
  6281           DFHEIV99,
  6282           DFHEIV99
  6283     SET ADDRESS OF ACCOUNT-MASTER TO
  6284         DFHEIV20
  6285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6286
  6287
  6288     MOVE AM-CONTROL-BY-VAR-GRP  TO  WS-TEST-KEY.
  6289
  6290     IF WS-TEST-KEY  NOT = WS-SAVE-VERIFY-KEY
  6291         GO TO 4175-CONTINUE.
  6292
  6293     MOVE 'Y'                    TO  WS-ACCT2-FOUND.
  6294     MOVE AM-CONTROL-PRIMARY     TO  WS-ACCT-KEY (WS-INDEX).
  6295     MOVE AM-VG-EXPIRATION-DT    TO  WS-ACCT-EXP-DT (WS-INDEX).
  6296     MOVE AM-EFFECTIVE-DT        TO  WS-ACCT-EFF-DT (WS-INDEX).
  6297     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6298     MOVE '3'                    TO  DC-OPTION-CODE.
  6299
  6300     PERFORM 9700-DATE-CONVERSION.
  6301
  6302     IF DATE-CONVERSION-ERROR
  6303         MOVE LOW-VALUES         TO  WS-ACCT-HI-CERT (WS-INDEX)
  6304     ELSE
  6305         MOVE DC-BIN-DATE-1      TO  WS-ACCT-HI-CERT (WS-INDEX).
  6306
  6307     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6308     MOVE '3'                    TO  DC-OPTION-CODE.
  6309
  6310     PERFORM 9700-DATE-CONVERSION.
  6311
  6312     IF DATE-CONVERSION-ERROR
  6313         MOVE LOW-VALUES         TO  WS-ACCT-LO-CERT (WS-INDEX)
  6314     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 129
* EL650.cbl
  6315         MOVE DC-BIN-DATE-1      TO  WS-ACCT-LO-CERT (WS-INDEX).
  6316
  6317     SET WS-INDEX  UP  BY  +1.
  6318
  6319     GO TO 4150-READ-NEXT.
  6320
  6321 4175-CONTINUE.
  6322     IF BROWSE-STARTED
  6323
  6324* EXEC CICS  ENDBR
  6325*            DATASET  (ACCT2-FILE-ID)
  6326*        END-EXEC
  6327     MOVE 0
  6328       TO DFHEIV11
  6329*    MOVE '&2                    $   #00006023' TO DFHEIV0
  6330     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6331     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6332     MOVE X'2020233030303036303233' TO DFHEIV0(25:11)
  6333     CALL 'kxdfhei1' USING DFHEIV0,
  6334           ACCT2-FILE-ID,
  6335           DFHEIV11,
  6336           DFHEIV99
  6337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6338         MOVE SPACES             TO  BROWSE-STARTED-SW.
  6339
  6340 4199-EXIT.
  6341     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 130
* EL650.cbl
  6343 4200-CHECK-VALIDITY.
  6344     IF (BIN-EXPCHG-SAVE GREATER
  6345                    WS-ACCT-EFF-DT (WS-INDEX))
  6346       AND  (BIN-EXPCHG-SAVE NOT GREATER
  6347                    WS-ACCT-EXP-DT (WS-INDEX))
  6348         MOVE ER-2051            TO  EMI-ERROR
  6349         MOVE -1                 TO  EXPCHGL
  6350         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6351
  6352     IF BIN-EFFCHG-SAVE NOT LESS WS-ACCT-EFF-DT (WS-INDEX) AND
  6353        BIN-EFFCHG-SAVE LESS     WS-ACCT-EXP-DT (WS-INDEX)
  6354          MOVE ER-2051            TO  EMI-ERROR
  6355          MOVE -1                 TO  EFFCHGL
  6356          PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6357
  6358 4200-EXIT.
  6359     EXIT.
  6360 4220-DISPLAY-VERI-TABLE.
  6361
  6362     perform varying d1 from +1 by +1 until
  6363        (d1 > +32)
  6364        or (ws-acct-eff-dt (d1) = low-values)
  6365        move ws-acct-eff-dt (d1) to dc-bin-date-1
  6366        move ' '                 to dc-option-code
  6367        perform 9700-date-conversion
  6368        move dc-greg-date-1-edit to ws-display-eff-date
  6369
  6370        move ws-acct-exp-dt (d1) to dc-bin-date-1
  6371        move ' '                 to dc-option-code
  6372        perform 9700-date-conversion
  6373        move dc-greg-date-1-edit to ws-display-exp-date
  6374
  6375        display ' date range ' d1 ' ' ws-display-eff-date
  6376                                  ' ' ws-display-exp-date
  6377     end-perform
  6378
  6379     .
  6380 4220-EXIT.
  6381     EXIT.
  6382
  6383 4300-VERIFY-INTEGRITY.
  6384     set d1 to ws-index
  6385     IF WS-ACCT-EFF-DT (WS-INDEX + 1)  = LOW-VALUES
  6386         SET WS-INDEX  TO  +32
  6387         GO TO 4399-EXIT.
  6388
  6389     IF ((WS-ACCT-EXP-DT (WS-INDEX)  =  BIN-EXPCHG-SAVE)  OR
  6390        (WS-ACCT-EFF-DT (WS-INDEX + 1)  =  BIN-EFFCHG-SAVE))
  6391                  AND
  6392        (WS-ACCT-EXP-DT (WS-INDEX) > WS-ACCT-EFF-DT (WS-INDEX))
  6393         SET WS-INDEX  TO  +33
  6394         GO TO 4399-EXIT.
  6395
  6396     IF (WS-ACCT-EXP-DT (WS-INDEX) NOT GREATER
  6397                    WS-ACCT-EFF-DT (WS-INDEX + 1))
  6398       AND  (WS-ACCT-EXP-DT (WS-INDEX) GREATER
  6399                    WS-ACCT-EFF-DT (WS-INDEX))
  6400         GO TO 4399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 131
* EL650.cbl
  6401
  6402     MOVE ER-2051                TO  EMI-ERROR.
  6403     MOVE -1                     TO  EXPCHGL.
  6404
  6405     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6406
  6407 4399-EXIT.
  6408     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 132
* EL650.cbl
  6410 4500-CREATE-NEW-ACCOUNT.
  6411     PERFORM 6100-BUILD-KEY            THRU 6199-EXIT.
  6412
  6413     PERFORM 6700-VERIFY-STATE-CARRIER THRU 6799-EXIT.
  6414
  6415     IF MAINTI = 'T'
  6416         PERFORM 6000-EDIT-EFFECTIVE-DATE THRU 6000-EFF-EXIT.
  6417
  6418     PERFORM 4100-BUILD-VERIFICATION THRU 4199-EXIT.
  6419
  6420     IF WS-ACCT2-FOUND = 'Y'
  6421         MOVE ER-0561            TO  EMI-ERROR
  6422         MOVE -1                 TO  MAINTL
  6423         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6424
  6425     MOVE SPACES                 TO  GETMAIN-SW.
  6426
  6427     IF NOT EMI-NO-ERRORS
  6428         GO TO 8200-SEND-DATAONLY.
  6429
  6430     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6431         MOVE ER-0453            TO  EMI-ERROR
  6432         MOVE -1                 TO  MAINTL
  6433         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6434         GO TO 8200-SEND-DATAONLY.
  6435
  6436     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6437
  6438     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6439                                     PI-ACCT-REST-OF-EXP.
  6440
  6441     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  6442
  6443     IF REC-FOUND
  6444         MOVE -1                 TO  ACARIERL
  6445         MOVE ER-0561            TO  EMI-ERROR
  6446         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6447         GO TO 8200-SEND-DATAONLY.
  6448
  6449     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6450     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6451                                     PI-ACCT-REST-OF-EXP.
  6452
  6453
  6454* EXEC CICS  HANDLE CONDITION
  6455*        NOTFND   (4530-NOT-FOUND)
  6456*        ENDFILE  (4530-NOT-FOUND)
  6457*    END-EXEC.
  6458*    MOVE '"$I''                  ! ( #00006141' TO DFHEIV0
  6459     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6461     MOVE X'2820233030303036313431' TO DFHEIV0(25:11)
  6462     CALL 'kxdfhei1' USING DFHEIV0
  6463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6464
  6465
  6466     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6467
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 133
* EL650.cbl
  6468 4510-READ-NEXT.
  6469     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6470
  6471     IF PI-ACCT-CCGSA-KEY  NOT = PI-PREV-ACCOUNT
  6472         GO TO 4540-END-COPY.
  6473
  6474     MOVE AM-EXPIRATION-DT       TO  WS-EXP-SAVE.
  6475     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6476     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6477     MOVE WS-EXP-SAVE            TO  AM-EXPIRATION-DT.
  6478
  6479     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  6480
  6481     IF MAINTI  = 'T'
  6482         MOVE '2'                TO  AM-STATUS
  6483         MOVE AM-ACCOUNT         TO  AM-AGT (1)
  6484         MOVE PI-ACCT-CARRIER    TO  AM-TRNFROM-CARRIER
  6485         MOVE PI-ACCT-GROUPING   TO  AM-TRNFROM-GROUPING
  6486         MOVE PI-ACCT-STATE      TO  AM-TRNFROM-STATE
  6487         MOVE PI-ACCT-ACCOUNT    TO  AM-TRNFROM-ACCOUNT
  6488         MOVE BIN-EFFCHG-SAVE    TO  AM-TRNFROM-DTE
  6489     ELSE
  6490         MOVE LOW-VALUES         TO  AM-AR-HI-CERT-DATE
  6491         MOVE ZEROS              TO  AM-HI-CERT-DATE
  6492                                     AM-LO-CERT-DATE
  6493         MOVE SPACES             TO  AM-1ST-PROD-DATE
  6494                                     AM-PREV-DATES
  6495                                     AM-ORIG-DEALER-NO
  6496     END-IF
  6497
  6498     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6499     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6500     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6501     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6502
  6503     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6504
  6505     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6506     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6507
  6508     PERFORM 6320-ENDBR THRU 6320-EXIT.
  6509
  6510
  6511* EXEC CICS GETMAIN
  6512*        LENGTH   (ACCT-REC-LEN)
  6513*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6514*        INITIMG  (GETMAIN-SPACE)
  6515*    END-EXEC.
  6516*    MOVE ',"IL                  $   #00006190' TO DFHEIV0
  6517     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6518     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6519     MOVE X'2020233030303036313930' TO DFHEIV0(25:11)
  6520     CALL 'kxdfhei1' USING DFHEIV0,
  6521           DFHEIV20,
  6522           ACCT-REC-LEN,
  6523           GETMAIN-SPACE
  6524     SET ADDRESS OF ACCOUNT-MASTER TO
  6525         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 134
* EL650.cbl
  6526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6527
  6528
  6529     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6530
  6531
  6532* EXEC CICS  WRITE
  6533*        DATASET  (PI-ACCT-ID)
  6534*        RIDFLD   (AM-CONTROL-PRIMARY)
  6535*        FROM     (ACCOUNT-MASTER)
  6536*    END-EXEC.
  6537     MOVE LENGTH OF
  6538      ACCOUNT-MASTER
  6539       TO DFHEIV11
  6540*    MOVE '&$ L                  ''   #00006198' TO DFHEIV0
  6541     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6542     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6543     MOVE X'2020233030303036313938' TO DFHEIV0(25:11)
  6544     CALL 'kxdfhei1' USING DFHEIV0,
  6545           PI-ACCT-ID,
  6546           ACCOUNT-MASTER,
  6547           DFHEIV11,
  6548           AM-CONTROL-PRIMARY,
  6549           DFHEIV99,
  6550           DFHEIV99
  6551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6552
  6553
  6554     MOVE PI-ACCT-ID             TO  FILE-ID.
  6555
  6556     PERFORM 8400-LOG-JOURNAL-RECORD.
  6557
  6558     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  6559     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6560
  6561     GO TO 4510-READ-NEXT.
  6562
  6563 4530-NOT-FOUND.
  6564     IF BROWSE-STARTED
  6565         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6566
  6567     MOVE ER-0226                TO  EMI-ERROR.
  6568
  6569     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6570
  6571     MOVE -1                     TO  MAINTL.
  6572
  6573     GO TO 8200-SEND-DATAONLY.
  6574
  6575 4540-END-COPY.
  6576     IF MAINTI = 'K'
  6577         IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  6578             NEXT SENTENCE
  6579         ELSE
  6580             PERFORM 4600-ADD-ERPLAN-RECORD THRU 4699-EXIT.
  6581
  6582     IF BROWSE-STARTED
  6583         PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 135
* EL650.cbl
  6584
  6585     IF MAINTI  NOT = 'T'
  6586         GO TO 4590-SHOW-NEW-ACCOUNT.
  6587
  6588     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6589     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6590                                     PI-ACCT-REST-OF-EXP.
  6591
  6592     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6593
  6594 4550-READ-NEXT.
  6595     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6596
  6597     IF PI-ACCT-CCGSA-KEY  NOT =  PI-PREV-ACCOUNT
  6598         GO TO 4570-END-REWRITE.
  6599
  6600
  6601* EXEC CICS  READ
  6602*        UPDATE
  6603*        DATASET  (PI-ACCT-ID)
  6604*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6605*        RIDFLD   (PI-ACCT-KEY)
  6606*    END-EXEC.
  6607*    MOVE '&"S        EU         (   #00006250' TO DFHEIV0
  6608     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6609     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6610     MOVE X'2020233030303036323530' TO DFHEIV0(25:11)
  6611     CALL 'kxdfhei1' USING DFHEIV0,
  6612           PI-ACCT-ID,
  6613           DFHEIV20,
  6614           DFHEIV99,
  6615           PI-ACCT-KEY,
  6616           DFHEIV99,
  6617           DFHEIV99,
  6618           DFHEIV99
  6619     SET ADDRESS OF ACCOUNT-MASTER TO
  6620         DFHEIV20
  6621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6622
  6623
  6624     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6625     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6626     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6627
  6628     PERFORM 8400-LOG-JOURNAL-RECORD.
  6629
  6630     MOVE NEW-KEY-CNTRL          TO  AM-TRANSFERRED-TO.
  6631     MOVE BIN-EFFCHG-SAVE        TO  AM-TRNTO-DTE.
  6632     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6633     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6634     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6635     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6636     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6637
  6638
  6639* EXEC CICS  REWRITE
  6640*        DATASET  (PI-ACCT-ID)
  6641*        FROM     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 136
* EL650.cbl
  6642*    END-EXEC.
  6643     MOVE LENGTH OF
  6644      ACCOUNT-MASTER
  6645       TO DFHEIV11
  6646*    MOVE '&& L                  %   #00006271' TO DFHEIV0
  6647     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6648     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6649     MOVE X'2020233030303036323731' TO DFHEIV0(25:11)
  6650     CALL 'kxdfhei1' USING DFHEIV0,
  6651           PI-ACCT-ID,
  6652           ACCOUNT-MASTER,
  6653           DFHEIV11,
  6654           DFHEIV99
  6655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6656
  6657
  6658     MOVE PI-ACCT-ID             TO  FILE-ID.
  6659
  6660     PERFORM 8400-LOG-JOURNAL-RECORD.
  6661
  6662     GO TO 4550-READ-NEXT.
  6663
  6664 4570-END-REWRITE.
  6665     IF BROWSE-STARTED
  6666         PERFORM 6320-ENDBR  THRU  6320-EXIT.
  6667
  6668     MOVE SPACES                 TO  MAINTI
  6669                                     EFFCHGI.
  6670     MOVE AL-UANOF               TO  EFFCHGA.
  6671
  6672 4590-SHOW-NEW-ACCOUNT.
  6673     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6674
  6675     MOVE NEW-KEY-SAVE           TO  PI-PREV-ACCOUNT
  6676                                     PI-ACCT-CCGSA-KEY.
  6677
  6678     MOVE -1                     TO  MAINTL.
  6679     MOVE ER-0000                TO  EMI-ERROR.
  6680
  6681     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6682
  6683     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT.
  6684
  6685     GO TO 1002-SHOW-NEW-RECORDS.
  6686
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 137
* EL650.cbl
  6688 4600-ADD-ERPLAN-RECORD.
  6689
  6690* EXEC CICS  HANDLE CONDITION
  6691*        NOTFND   (4699-EXIT)
  6692*        ENDFILE  (4689-EOF)
  6693*    END-EXEC.
  6694*    MOVE '"$I''                  ! ) #00006307' TO DFHEIV0
  6695     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6697     MOVE X'2920233030303036333037' TO DFHEIV0(25:11)
  6698     CALL 'kxdfhei1' USING DFHEIV0
  6699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6700
  6701
  6702     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6703     MOVE PI-PREV-ACCOUNT       TO EK-CCGSA-KEY.
  6704
  6705     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6706
  6707 4610-READ-NEXT.
  6708     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6709
  6710     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6711         GO TO 4689-EOF.
  6712
  6713     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  6714
  6715     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  6716     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  6717     MOVE EK-REVISION            TO  PL-REVISION-NO.
  6718
  6719     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  6720
  6721     MOVE PLAN-MASTER            TO  JP-RECORD-AREA.
  6722
  6723
  6724* EXEC CICS  ENDBR
  6725*        DATASET  (PLAN-FILE-ID)
  6726*    END-EXEC.
  6727     MOVE 0
  6728       TO DFHEIV11
  6729*    MOVE '&2                    $   #00006333' TO DFHEIV0
  6730     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6731     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6732     MOVE X'2020233030303036333333' TO DFHEIV0(25:11)
  6733     CALL 'kxdfhei1' USING DFHEIV0,
  6734           PLAN-FILE-ID,
  6735           DFHEIV11,
  6736           DFHEIV99
  6737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6738
  6739
  6740
  6741* EXEC CICS GETMAIN
  6742*        LENGTH   (PLAN-REC-LEN)
  6743*        SET      (ADDRESS OF PLAN-MASTER)
  6744*        INITIMG  (GETMAIN-SPACE)
  6745*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 138
* EL650.cbl
  6746*    MOVE ',"IL                  $   #00006337' TO DFHEIV0
  6747     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6748     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6749     MOVE X'2020233030303036333337' TO DFHEIV0(25:11)
  6750     CALL 'kxdfhei1' USING DFHEIV0,
  6751           DFHEIV20,
  6752           PLAN-REC-LEN,
  6753           GETMAIN-SPACE
  6754     SET ADDRESS OF PLAN-MASTER TO
  6755         DFHEIV20
  6756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6757
  6758
  6759     MOVE JP-RECORD-AREA         TO PLAN-MASTER.
  6760
  6761
  6762* EXEC CICS  WRITE
  6763*        DATASET  (PLAN-FILE-ID)
  6764*        RIDFLD   (PL-CONTROL-PRIMARY)
  6765*        FROM     (PLAN-MASTER)
  6766*    END-EXEC.
  6767     MOVE LENGTH OF
  6768      PLAN-MASTER
  6769       TO DFHEIV11
  6770*    MOVE '&$ L                  ''   #00006345' TO DFHEIV0
  6771     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6772     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6773     MOVE X'2020233030303036333435' TO DFHEIV0(25:11)
  6774     CALL 'kxdfhei1' USING DFHEIV0,
  6775           PLAN-FILE-ID,
  6776           PLAN-MASTER,
  6777           DFHEIV11,
  6778           PL-CONTROL-PRIMARY,
  6779           DFHEIV99,
  6780           DFHEIV99
  6781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6782
  6783
  6784     PERFORM 4700-STARTBR-PLAN  THRU 4700-EXIT.
  6785     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6786
  6787     GO TO 4610-READ-NEXT.
  6788
  6789 4689-EOF.
  6790
  6791* EXEC CICS  ENDBR
  6792*        DATASET  (PLAN-FILE-ID)
  6793*    END-EXEC.
  6794     MOVE 0
  6795       TO DFHEIV11
  6796*    MOVE '&2                    $   #00006357' TO DFHEIV0
  6797     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6798     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6799     MOVE X'2020233030303036333537' TO DFHEIV0(25:11)
  6800     CALL 'kxdfhei1' USING DFHEIV0,
  6801           PLAN-FILE-ID,
  6802           DFHEIV11,
  6803           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 139
* EL650.cbl
  6804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6805
  6806
  6807 4699-EXIT.
  6808      EXIT.
  6809
  6810 4700-STARTBR-PLAN.
  6811
  6812* EXEC CICS  STARTBR
  6813*        DATASET  (PLAN-FILE-ID)
  6814*        RIDFLD   (WS-PLAN-KEY)
  6815*    END-EXEC.
  6816     MOVE 0
  6817       TO DFHEIV11
  6818*    MOVE '&,         G          &   #00006365' TO DFHEIV0
  6819     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6820     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6821     MOVE X'2020233030303036333635' TO DFHEIV0(25:11)
  6822     CALL 'kxdfhei1' USING DFHEIV0,
  6823           PLAN-FILE-ID,
  6824           WS-PLAN-KEY,
  6825           DFHEIV99,
  6826           DFHEIV11,
  6827           DFHEIV99
  6828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6829
  6830
  6831 4700-EXIT.
  6832      EXIT.
  6833
  6834 4710-READNEXT-PLAN.
  6835
  6836* EXEC CICS  READNEXT
  6837*        DATASET  (PLAN-FILE-ID)
  6838*        SET      (ADDRESS OF PLAN-MASTER)
  6839*        RIDFLD   (WS-PLAN-KEY)
  6840*    END-EXEC.
  6841     MOVE 0
  6842       TO DFHEIV11
  6843*    MOVE '&.S                   )   #00006374' TO DFHEIV0
  6844     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6845     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6846     MOVE X'2020233030303036333734' TO DFHEIV0(25:11)
  6847     CALL 'kxdfhei1' USING DFHEIV0,
  6848           PLAN-FILE-ID,
  6849           DFHEIV20,
  6850           DFHEIV99,
  6851           WS-PLAN-KEY,
  6852           DFHEIV99,
  6853           DFHEIV11,
  6854           DFHEIV99,
  6855           DFHEIV99
  6856     SET ADDRESS OF PLAN-MASTER TO
  6857         DFHEIV20
  6858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6859
  6860
  6861 4710-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 140
* EL650.cbl
  6862      EXIT.
  6863
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 141
* EL650.cbl
  6865 4800-DELETE-PLAN-REC.
  6866
  6867* EXEC CICS  HANDLE CONDITION
  6868*        NOTFND   (4899-EXIT)
  6869*        ENDFILE  (4889-EOF)
  6870*    END-EXEC.
  6871*    MOVE '"$I''                  ! * #00006385' TO DFHEIV0
  6872     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6874     MOVE X'2A20233030303036333835' TO DFHEIV0(25:11)
  6875     CALL 'kxdfhei1' USING DFHEIV0
  6876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6877
  6878
  6879     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6880     MOVE AM-CONTROL-PRIMARY    TO EK-CCGSA-KEY
  6881                                   PI-PREV-ACCOUNT.
  6882
  6883 4805-STARTBR.
  6884     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6885
  6886 4810-READ-NEXT.
  6887     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6888
  6889     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6890         GO TO 4889-EOF.
  6891
  6892
  6893* EXEC CICS  ENDBR
  6894*        DATASET  (PLAN-FILE-ID)
  6895*    END-EXEC.
  6896     MOVE 0
  6897       TO DFHEIV11
  6898*    MOVE '&2                    $   #00006403' TO DFHEIV0
  6899     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6900     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6901     MOVE X'2020233030303036343033' TO DFHEIV0(25:11)
  6902     CALL 'kxdfhei1' USING DFHEIV0,
  6903           PLAN-FILE-ID,
  6904           DFHEIV11,
  6905           DFHEIV99
  6906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6907
  6908
  6909
  6910* EXEC CICS  READ
  6911*        UPDATE
  6912*        DATASET  (PLAN-FILE-ID)
  6913*        SET      (ADDRESS OF PLAN-MASTER)
  6914*        RIDFLD   (WS-PLAN-KEY)
  6915*    END-EXEC.
  6916*    MOVE '&"S        EU         (   #00006407' TO DFHEIV0
  6917     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6918     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6919     MOVE X'2020233030303036343037' TO DFHEIV0(25:11)
  6920     CALL 'kxdfhei1' USING DFHEIV0,
  6921           PLAN-FILE-ID,
  6922           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 142
* EL650.cbl
  6923           DFHEIV99,
  6924           WS-PLAN-KEY,
  6925           DFHEIV99,
  6926           DFHEIV99,
  6927           DFHEIV99
  6928     SET ADDRESS OF PLAN-MASTER TO
  6929         DFHEIV20
  6930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6931
  6932
  6933
  6934* EXEC CICS  DELETE
  6935*        DATASET  (PLAN-FILE-ID)
  6936*    END-EXEC.
  6937*    MOVE '&(                    &   #00006414' TO DFHEIV0
  6938     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6939     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6940     MOVE X'2020233030303036343134' TO DFHEIV0(25:11)
  6941     CALL 'kxdfhei1' USING DFHEIV0,
  6942           PLAN-FILE-ID,
  6943           DFHEIV99,
  6944           DFHEIV99,
  6945           DFHEIV99,
  6946           DFHEIV99
  6947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6948
  6949
  6950     GO TO 4805-STARTBR.
  6951
  6952 4889-EOF.
  6953
  6954* EXEC CICS  ENDBR
  6955*        DATASET  (PLAN-FILE-ID)
  6956*    END-EXEC.
  6957     MOVE 0
  6958       TO DFHEIV11
  6959*    MOVE '&2                    $   #00006421' TO DFHEIV0
  6960     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6961     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6962     MOVE X'2020233030303036343231' TO DFHEIV0(25:11)
  6963     CALL 'kxdfhei1' USING DFHEIV0,
  6964           PLAN-FILE-ID,
  6965           DFHEIV11,
  6966           DFHEIV99
  6967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6968
  6969
  6970 4899-EXIT.
  6971      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 143
* EL650.cbl
  6973 4900-CREATE-NEW-ACCOUNT.
  6974     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  6975
  6976     SET T-INDEX                 TO  LINEI.
  6977
  6978     IF PI-2ND-PAGE
  6979         SET T-INDEX  UP  BY  8
  6980     ELSE
  6981     IF PI-3RD-PAGE
  6982         SET T-INDEX  UP  BY  16
  6983     ELSE
  6984     IF PI-LST-PAGE
  6985         SET T-INDEX  UP  BY  24.
  6986
  6987     IF EFFCHGL NOT =  ZERO
  6988         PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT
  6989       ELSE
  6990         MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-EFFCHG-SAVE.
  6991
  6992     IF EXPCHGL NOT =  ZERO
  6993         PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT
  6994       ELSE
  6995         MOVE PI-BIN-EXP-DT (T-INDEX)  TO  BIN-EXPCHG-SAVE.
  6996
  6997     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  6998
  6999     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  7000         MOVE -1                 TO  EXPCHGL
  7001         MOVE ER-1228            TO  EMI-ERROR
  7002         MOVE AL-UABON           TO  EXPCHGA
  7003         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7004
  7005     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  7006
  7007     IF EMI-ERROR  NOT = ZEROS
  7008         GO TO 8200-SEND-DATAONLY.
  7009
  7010     MOVE SPACES                 TO  GETMAIN-SW.
  7011
  7012     IF NOT EMI-NO-ERRORS
  7013         GO TO 8200-SEND-DATAONLY.
  7014
  7015     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  7016         MOVE ER-0453            TO  EMI-ERROR
  7017         MOVE -1                 TO  MAINTL
  7018         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7019         GO TO 8200-SEND-DATAONLY.
  7020
  7021     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  7022
  7023     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7024
  7025     PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  7026         VARYING  WS-INDEX  FROM  +1  BY  +1
  7027            UNTIL WS-INDEX GREATER +32.
  7028
  7029     IF NOT EMI-NO-ERRORS
  7030         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 144
* EL650.cbl
  7031
  7032     MOVE PI-PREV-ACCOUNT          TO  PI-ACCT-CCGSA-KEY.
  7033     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7034     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7035
  7036     PERFORM 6500-READ-ACCT     THRU  6599-EXIT.
  7037
  7038     MOVE LOW-VALUES             TO  AM-AR-HI-CERT-DATE
  7039     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  7040                                     AM-LO-CERT-DATE
  7041     MOVE ZEROS                  TO  AM-DCC-MAX-MARKETING-FEE
  7042     MOVE SPACES                 TO  AM-1ST-PROD-DATE
  7043                                     AM-PREV-DATES
  7044                                     AM-ORIG-DEALER-NO
  7045
  7046     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  7047     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  7048     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  7049     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  7050
  7051     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  7052
  7053     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7054     MOVE 'A'                    TO  JP-RECORD-TYPE.
  7055
  7056
  7057* EXEC CICS GETMAIN
  7058*        LENGTH   (ACCT-REC-LEN)
  7059*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7060*        INITIMG  (GETMAIN-SPACE)
  7061*    END-EXEC.
  7062*    MOVE ',"IL                  $   #00006511' TO DFHEIV0
  7063     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7064     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7065     MOVE X'2020233030303036353131' TO DFHEIV0(25:11)
  7066     CALL 'kxdfhei1' USING DFHEIV0,
  7067           DFHEIV20,
  7068           ACCT-REC-LEN,
  7069           GETMAIN-SPACE
  7070     SET ADDRESS OF ACCOUNT-MASTER TO
  7071         DFHEIV20
  7072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7073
  7074
  7075     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  7076     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  7077     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  7078     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  7079     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7080                                     AM-VG-EXPIRATION-DT.
  7081
  7082     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  7083
  7084
  7085* EXEC CICS  HANDLE CONDITION
  7086*        DUPREC   (4580-DUPREC)
  7087*        DUPKEY   (4580-DUPREC)
  7088*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 145
* EL650.cbl
  7089*    MOVE '"$%$                  ! + #00006526' TO DFHEIV0
  7090     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7092     MOVE X'2B20233030303036353236' TO DFHEIV0(25:11)
  7093     CALL 'kxdfhei1' USING DFHEIV0
  7094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7095
  7096
  7097
  7098* EXEC CICS  WRITE
  7099*        DATASET  (PI-ACCT-ID)
  7100*        RIDFLD   (AM-CONTROL-PRIMARY)
  7101*        FROM     (ACCOUNT-MASTER)
  7102*    END-EXEC.
  7103     MOVE LENGTH OF
  7104      ACCOUNT-MASTER
  7105       TO DFHEIV11
  7106*    MOVE '&$ L                  ''   #00006531' TO DFHEIV0
  7107     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7108     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7109     MOVE X'2020233030303036353331' TO DFHEIV0(25:11)
  7110     CALL 'kxdfhei1' USING DFHEIV0,
  7111           PI-ACCT-ID,
  7112           ACCOUNT-MASTER,
  7113           DFHEIV11,
  7114           AM-CONTROL-PRIMARY,
  7115           DFHEIV99,
  7116           DFHEIV99
  7117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7118
  7119
  7120     MOVE PI-ACCT-ID             TO  FILE-ID.
  7121
  7122     PERFORM 8400-LOG-JOURNAL-RECORD.
  7123
  7124     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7125         NEXT SENTENCE
  7126     ELSE
  7127         PERFORM 4950-ADD-ERPLAN-RECORD THRU 4959-EXIT
  7128         PERFORM 4960-ADD-ERCOMP-RECORD THRU 4969-EXIT.
  7129
  7130 4580-DUPREC.
  7131     MOVE 1                  TO K-WITH-LINE-USED.
  7132     MOVE LOW-VALUES         TO EL650AI.
  7133
  7134     GO TO 4590-SHOW-NEW-ACCOUNT.
  7135
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 146
* EL650.cbl
  7137 4950-ADD-ERPLAN-RECORD.
  7138
  7139* EXEC CICS GETMAIN
  7140*        LENGTH   (PLAN-REC-LEN)
  7141*        SET      (ADDRESS OF PLAN-MASTER)
  7142*        INITIMG  (GETMAIN-SPACE)
  7143*    END-EXEC.
  7144*    MOVE ',"IL                  $   #00006555' TO DFHEIV0
  7145     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7146     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7147     MOVE X'2020233030303036353535' TO DFHEIV0(25:11)
  7148     CALL 'kxdfhei1' USING DFHEIV0,
  7149           DFHEIV20,
  7150           PLAN-REC-LEN,
  7151           GETMAIN-SPACE
  7152     SET ADDRESS OF PLAN-MASTER TO
  7153         DFHEIV20
  7154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7155
  7156
  7157
  7158* EXEC CICS  HANDLE CONDITION
  7159*        DUPREC   (4959-EXIT)
  7160*        DUPKEY   (4959-EXIT)
  7161*    END-EXEC.
  7162*    MOVE '"$%$                  ! , #00006561' TO DFHEIV0
  7163     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7165     MOVE X'2C20233030303036353631' TO DFHEIV0(25:11)
  7166     CALL 'kxdfhei1' USING DFHEIV0
  7167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7168
  7169
  7170     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  7171
  7172     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  7173     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  7174     MOVE EK-REVISION            TO  PL-REVISION-NO.
  7175
  7176     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  7177
  7178
  7179* EXEC CICS  WRITE
  7180*        DATASET  (PLAN-FILE-ID)
  7181*        RIDFLD   (PL-CONTROL-PRIMARY)
  7182*        FROM     (PLAN-MASTER)
  7183*    END-EXEC.
  7184     MOVE LENGTH OF
  7185      PLAN-MASTER
  7186       TO DFHEIV11
  7187*    MOVE '&$ L                  ''   #00006574' TO DFHEIV0
  7188     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7189     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7190     MOVE X'2020233030303036353734' TO DFHEIV0(25:11)
  7191     CALL 'kxdfhei1' USING DFHEIV0,
  7192           PLAN-FILE-ID,
  7193           PLAN-MASTER,
  7194           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 147
* EL650.cbl
  7195           PL-CONTROL-PRIMARY,
  7196           DFHEIV99,
  7197           DFHEIV99
  7198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7199
  7200
  7201 4959-EXIT.
  7202     EXIT.
  7203
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 148
* EL650.cbl
  7205 4960-ADD-ERCOMP-RECORD.
  7206
  7207* EXEC CICS GETMAIN
  7208*         LENGTH   (COMP-REC-LEN)
  7209*         SET      (ADDRESS OF COMPENSATION-MASTER)
  7210*         INITIMG  (GETMAIN-SPACE)
  7211*    END-EXEC.
  7212*    MOVE ',"IL                  $   #00006585' TO DFHEIV0
  7213     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7214     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7215     MOVE X'2020233030303036353835' TO DFHEIV0(25:11)
  7216     CALL 'kxdfhei1' USING DFHEIV0,
  7217           DFHEIV20,
  7218           COMP-REC-LEN,
  7219           GETMAIN-SPACE
  7220     SET ADDRESS OF COMPENSATION-MASTER TO
  7221         DFHEIV20
  7222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7223
  7224
  7225     MOVE SPACES                 TO COMPENSATION-MASTER.
  7226     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  7227                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  7228                   CO-OV30         CO-OV60      CO-OV90
  7229                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  7230                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  7231                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  7232                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  7233                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  7234                   CO-CURRENT-CUR     CO-CURRENT-OV30
  7235                   CO-CURRENT-OV60    CO-CURRENT-OV90
  7236                   CO-CURRENT-CUR-PMT
  7237                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  7238                   CO-ACT-YEAR        CO-ACT-MONTH
  7239                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  7240                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  7241                   CO-CURRENT-LAST-STMT-YEAR
  7242                   CO-CURRENT-LAST-STMT-MONTH
  7243                   CO-CURRENT-LAST-STMT-DAY
  7244                   CO-YTD-PAID-COM
  7245                   CO-YTD-PAID-OV co-ov120 co-current-ov120
  7246     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  7247     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  7248     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  7249     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  7250     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  7251
  7252     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  7253         MOVE ZEROS              TO CO-CARRIER
  7254     ELSE
  7255         MOVE AM-CARRIER         TO CO-CARRIER.
  7256
  7257     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  7258         MOVE ZEROS              TO CO-GROUPING
  7259     ELSE
  7260         MOVE AM-GROUPING        TO CO-GROUPING.
  7261
  7262     MOVE 'A'                    TO CO-TYPE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 149
* EL650.cbl
  7263     MOVE AM-NAME                TO CO-ACCT-NAME.
  7264     MOVE AM-PERSON              TO CO-MAIL-NAME.
  7265     MOVE AM-ADDRS               TO CO-ADDR-1.
  7266*    MOVE AM-CITY                TO CO-ADDR-3.
  7267     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  7268     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  7269     MOVE AM-ZIP                 TO CO-ZIP.
  7270     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  7271     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  7272     MOVE AM-ID-NO               TO CO-SOC-SEC.
  7273
  7274     IF AM-REMIT-TO NOT = ZERO
  7275         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  7276       ELSE
  7277         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  7278
  7279     MOVE +0                      TO AGT-SUB.
  7280
  7281     PERFORM 4970-FIND-C-AGT THRU 4970-EXIT.
  7282
  7283     IF VALID-AGT-SW = 'Y'
  7284         NEXT SENTENCE
  7285     ELSE
  7286         GO TO 4969-EXIT.
  7287
  7288     IF CO-RESP-NO = CO-ACCOUNT
  7289         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  7290     ELSE
  7291         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  7292
  7293     IF PI-AR-PROCESSING
  7294        MOVE 'G'                   TO CO-AR-REPORTING
  7295        MOVE '1'                   TO CO-AR-BAL-LEVEL
  7296        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  7297        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  7298
  7299     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  7300        MOVE 'N'                   TO CO-AR-REPORTING.
  7301
  7302     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  7303        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  7304
  7305     PERFORM 4980-ADD-COMPENSATION-NAME THRU 4980-EXIT.
  7306
  7307
  7308* EXEC CICS HANDLE CONDITION
  7309*         DUPREC   (4969-EXIT)
  7310*         DUPKEY   (4969-EXIT)
  7311*    END-EXEC.
  7312*    MOVE '"$%$                  ! - #00006673' TO DFHEIV0
  7313     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7315     MOVE X'2D20233030303036363733' TO DFHEIV0(25:11)
  7316     CALL 'kxdfhei1' USING DFHEIV0
  7317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7318
  7319
  7320
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 150
* EL650.cbl
  7321* EXEC CICS WRITE
  7322*        FROM      (COMPENSATION-MASTER)
  7323*        RIDFLD    (CO-CONTROL-PRIMARY)
  7324*        DATASET   (COMP-FILE-ID)
  7325*    END-EXEC.
  7326     MOVE LENGTH OF
  7327      COMPENSATION-MASTER
  7328       TO DFHEIV11
  7329*    MOVE '&$ L                  ''   #00006678' TO DFHEIV0
  7330     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7331     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7332     MOVE X'2020233030303036363738' TO DFHEIV0(25:11)
  7333     CALL 'kxdfhei1' USING DFHEIV0,
  7334           COMP-FILE-ID,
  7335           COMPENSATION-MASTER,
  7336           DFHEIV11,
  7337           CO-CONTROL-PRIMARY,
  7338           DFHEIV99,
  7339           DFHEIV99
  7340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7341
  7342
  7343 4969-EXIT.
  7344     EXIT.
  7345
  7346 4970-FIND-C-AGT.
  7347     ADD 1 TO  AGT-SUB.
  7348     IF AGT-SUB GREATER 10
  7349         MOVE 'N'                TO  VALID-AGT-SW
  7350         GO TO 4970-EXIT.
  7351
  7352     IF (AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F')
  7353         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  7354         MOVE 'Y'                TO  VALID-AGT-SW
  7355         GO TO 4970-EXIT
  7356     ELSE
  7357         GO TO 4970-FIND-C-AGT.
  7358
  7359 4970-EXIT.
  7360     EXIT.
  7361
  7362 4980-ADD-COMPENSATION-NAME.
  7363
  7364* EXEC CICS HANDLE CONDITION
  7365*         DUPREC   (4980-EXIT)
  7366*    END-EXEC.
  7367*    MOVE '"$%                   ! . #00006704' TO DFHEIV0
  7368     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7370     MOVE X'2E20233030303036373034' TO DFHEIV0(25:11)
  7371     CALL 'kxdfhei1' USING DFHEIV0
  7372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7373
  7374
  7375
  7376* EXEC CICS GETMAIN
  7377*         LENGTH   (NAME-REC-LEN)
  7378*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 151
* EL650.cbl
  7379*         INITIMG  (GETMAIN-SPACE)
  7380*    END-EXEC.
  7381*    MOVE ',"IL                  $   #00006708' TO DFHEIV0
  7382     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7383     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7384     MOVE X'2020233030303036373038' TO DFHEIV0(25:11)
  7385     CALL 'kxdfhei1' USING DFHEIV0,
  7386           DFHEIV20,
  7387           NAME-REC-LEN,
  7388           GETMAIN-SPACE
  7389     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7390         DFHEIV20
  7391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7392
  7393
  7394     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7395     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7396     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7397     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7398     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7399     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7400     MOVE CO-ADDR-CITY           TO  NL-CITY
  7401     MOVE CO-ADDR-STATE          TO  NL-ST
  7402     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7403     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7404     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7405     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7406     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7407     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7408     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7409
  7410
  7411* EXEC CICS WRITE
  7412*        FROM      (NAME-LOOKUP-MASTER)
  7413*        RIDFLD    (NL-CONTROL-PRIMARY)
  7414*        DATASET   (NAME-FILE-ID)
  7415*    END-EXEC.
  7416     MOVE LENGTH OF
  7417      NAME-LOOKUP-MASTER
  7418       TO DFHEIV11
  7419*    MOVE '&$ L                  ''   #00006730' TO DFHEIV0
  7420     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7421     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7422     MOVE X'2020233030303036373330' TO DFHEIV0(25:11)
  7423     CALL 'kxdfhei1' USING DFHEIV0,
  7424           NAME-FILE-ID,
  7425           NAME-LOOKUP-MASTER,
  7426           DFHEIV11,
  7427           NL-CONTROL-PRIMARY,
  7428           DFHEIV99,
  7429           DFHEIV99
  7430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7431
  7432
  7433 4980-EXIT.
  7434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 152
* EL650.cbl
  7436 5000-CREATE-NEW-RANGE.
  7437
  7438     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  7439     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  7440
  7441     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU 6000-EFF-EXIT.
  7442     PERFORM 6000-EDIT-EXPIRATION-DATE THRU 6000-EXP-EXIT.
  7443
  7444     SET T-INDEX TO PI-TOTAL-LINES.
  7445
  7446     PERFORM 600A-CHECK-HI-LO-DATES    THRU 600A-EXIT
  7447        VARYING T-INDEX FROM T-INDEX BY +1
  7448         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  7449
  7450     IF NOT EMI-NO-ERRORS
  7451         GO TO 8200-SEND-DATAONLY.
  7452
  7453     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7454     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7455
  7456     IF BIN-EFFCHG-SAVE NOT LESS BIN-EXPCHG-SAVE
  7457         MOVE -1                 TO  EFFCHGL EXPCHGL
  7458         MOVE AL-UANON           TO  EFFCHGA EXPCHGA
  7459         MOVE ER-2053            TO  EMI-ERROR
  7460         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7461
  7462     IF NOT EMI-NO-ERRORS
  7463         GO TO 8200-SEND-DATAONLY.
  7464
  7465***************************************************************
  7466*    NO EFFECTIVE DATE ENTERED, WILL USE CURRENT EXPIRATION   *
  7467*    DATE IF WITHIN LIMITS                                    *
  7468***************************************************************
  7469
  7470     IF EFFCHGL = ZERO
  7471         SET T-INDEX             TO  PI-TOTAL-LINES
  7472         IF PI-BIN-EXP-DT (T-INDEX)  =  HIGH-VALUES
  7473             MOVE ER-2060        TO  EMI-ERROR
  7474             MOVE -1             TO  EFFCHGL
  7475             MOVE AL-UABON       TO  EFFCHGA
  7476             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7477             GO TO 8200-SEND-DATAONLY
  7478         ELSE
  7479             IF PI-BIN-EXP-DT (T-INDEX) NOT LESS
  7480                    BIN-EXPCHG-SAVE
  7481                 MOVE ER-2061    TO  EMI-ERROR
  7482                 MOVE -1         TO  EXPCHGL
  7483                 MOVE AL-UABON   TO  EXPCHGA
  7484                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7485                 GO TO 8200-SEND-DATAONLY.
  7486
  7487     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7488
  7489*    display ' VERI TABLE BEFORE '
  7490*    perform 4220-DISPLAY-VERI-TABLE
  7491*                                thru 4220-exit
  7492     IF EFFCHGL = ZERO
  7493         MOVE PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 153
* EL650.cbl
  7494                                 TO WS-ACCT-EFF-DT (WS-INDEX)
  7495         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX)
  7496     ELSE
  7497         MOVE BIN-EFFCHG-SAVE    TO WS-ACCT-EFF-DT (WS-INDEX)
  7498                                    WS-ACCT-EXP-DT (WS-INDEX - 1)
  7499         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX).
  7500
  7501*    display ' VERI TABLE AFTER  '
  7502*    perform 4220-DISPLAY-VERI-TABLE
  7503*                                thru 4220-exit
  7504     PERFORM 4300-VERIFY-INTEGRITY  THRU  4399-EXIT
  7505         VARYING  WS-INDEX  FROM  +1  BY  +1
  7506           UNTIL  WS-INDEX  GREATER +32.
  7507
  7508     IF NOT EMI-NO-ERRORS
  7509         GO TO 8200-SEND-DATAONLY.
  7510
  7511     IF EFFCHGL  =  ZEROS
  7512         MOVE PI-BIN-EXP-DT (T-INDEX)
  7513                                  TO  PI-ACCT-EXP-DT
  7514                                      BIN-EFFCHG-SAVE
  7515                                      DC-BIN-DATE-1
  7516         MOVE SPACE               TO  DC-OPTION-CODE
  7517         PERFORM 9700-DATE-CONVERSION
  7518***  Y2K PROJ 7744
  7519         MOVE DC-GREG-DATE-1-YMD  TO  WS-EFFCHG-SAVE
  7520         MOVE DC-ALPHA-CENTURY    TO  WS-EFFCHG-SAVE(4:2)
  7521         MOVE WS-EFFCHG-SAVE      TO  EFFCHG-SAVE
  7522
  7523         PERFORM 5020-READ-PREV-REC
  7524         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT
  7525         GO TO 5005-EXIT
  7526     END-IF.
  7527***  Y2K PROJ 7744
  7528
  7529     IF NOT EMI-NO-ERRORS
  7530         GO TO 8200-SEND-DATAONLY.
  7531
  7532     SET T-INDEX  TO  PI-TOTAL-LINES.
  7533
  7534*    IF (EFFCHGL GREATER THAN +0) AND
  7535*       (EXPCHGL GREATER THAN +0)
  7536*       IF (PI-BIN-EXP-DT (T-INDEX) EQUAL HIGH-VALUES) AND
  7537*          (BIN-EXPCHG-SAVE EQUAL HIGH-VALUES)
  7538*          NEXT SENTENCE
  7539*       ELSE
  7540*          GO TO 5006-FIND-EXP-DATE.
  7541*
  7542
  7543
  7544***************************************************************
  7545*    EFFECTIVE DATE ENTERED, WILL REPLACE CURRENT EXPIRATION  *
  7546*    DATE IF ALL NINES AND CREATE NEW RANGE                   *
  7547***************************************************************
  7548     SET T-INDEX  TO  PI-TOTAL-LINES.
  7549
  7550     IF BROWSE-STARTED-SW EQUAL 'Y'
  7551        PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 154
* EL650.cbl
  7552
  7553     IF PI-BIN-EXP-DT (T-INDEX)  = HIGH-VALUES
  7554         IF PI-BIN-EFF-DT (T-INDEX) NOT LESS BIN-EFFCHG-SAVE
  7555             MOVE ER-2063             TO  EMI-ERROR
  7556             MOVE -1                  TO  EFFCHGL
  7557             MOVE AL-UABON            TO  EFFCHGA
  7558             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7559             GO TO 8200-SEND-DATAONLY
  7560         ELSE
  7561             MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  7562             MOVE LOW-VALUES              TO  PI-ACCT-REST-OF-EXP
  7563             MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7564             MOVE PI-BIN-EFF-DT (T-INDEX)
  7565                                      TO  B4-ACCT-EFF-DT
  7566             PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7567             MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7568                                          AM-VG-EXPIRATION-DT
  7569                                          PI-BIN-EXP-DT
  7570                                                    (T-INDEX)
  7571             MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7572             MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7573             PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7574             PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7575             PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7576             GO TO 5005-EXIT.
  7577
  7578***************************************************************
  7579*    EFFECTIVE DATE ENTERED, CHECK TO ENSURE EFFECTIVE        *
  7580*    DATE GREATER PREVIOUS EXPIRATION DATE                    *
  7581***************************************************************
  7582     SET T-INDEX  TO  PI-TOTAL-LINES.
  7583
  7584     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7585     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7586
  7587     IF BIN-EFFCHG-SAVE LESS PI-BIN-EXP-DT (T-INDEX)
  7588         PERFORM 5010-CHECK-VALID-NEW-RANGE  THRU  5010-EXIT
  7589     ELSE
  7590         PERFORM 5020-READ-PREV-REC
  7591         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT.
  7592
  7593 5005-EXIT.
  7594     MOVE SPACES                 TO  EFFCHGO
  7595                                     EXPCHGI.
  7596     MOVE AL-UANOF               TO  EFFCHGA
  7597                                     EXPCHGA.
  7598     MOVE ER-0000                TO  EMI-ERROR.
  7599
  7600     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7601
  7602     GO TO 7000-BUILD-OUTPUT-MAP.
  7603
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 155
* EL650.cbl
  7605 5006-FIND-EXP-DATE.
  7606     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  7607                                     PI-ACCT-REST-OF-EXP.
  7608     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7609
  7610     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7611         VARYING  T-INDEX  FROM  +1  BY  +1
  7612           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EFFCHG-SAVE.
  7613
  7614     IF BIN-EFFCHG-SAVE > PI-BIN-EXP-DT (T-INDEX)
  7615        MOVE ER-1220             TO  EMI-ERROR
  7616        MOVE -1                  TO  EFFCHGL
  7617        MOVE AL-UABON            TO  EFFCHGA
  7618        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7619        GO TO         8200-SEND-DATAONLY.
  7620
  7621     IF (BIN-EFFCHG-SAVE > PI-BIN-EFF-DT (T-INDEX)) AND
  7622        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7623        PERFORM 5007-CREATE-SUB-DATE-RANGES THRU 5007-EXIT
  7624        MOVE 1 TO PI-PAGE-NUMBER
  7625        GO TO 1000-SHOW-ACCOUNT
  7626     ELSE
  7627     IF (BIN-EFFCHG-SAVE = PI-BIN-EFF-DT (T-INDEX)) AND
  7628        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7629        PERFORM 5008-CREATE-SUB-DATE-RANGES THRU 5008-EXIT
  7630        MOVE 1 TO PI-PAGE-NUMBER
  7631        GO TO 1000-SHOW-ACCOUNT
  7632     ELSE
  7633        MOVE ER-2051             TO  EMI-ERROR
  7634        MOVE -1                  TO  EFFCHGL
  7635        MOVE AL-UABON            TO  EFFCHGA
  7636        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7637        GO TO 8200-SEND-DATAONLY.
  7638
  7639 5006-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 156
* EL650.cbl
  7641 5007-CREATE-SUB-DATE-RANGES.
  7642
  7643     IF BROWSE-STARTED-SW EQUAL 'Y'
  7644        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7645
  7646     IF NOT SYSTEM-MODIFY-CAP
  7647         MOVE 'UPDATE'           TO  SM-READ
  7648         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7649         MOVE ER-0070            TO  EMI-ERROR
  7650         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7651         GO TO 8100-SEND-INITIAL-MAP.
  7652
  7653
  7654* EXEC CICS GETMAIN
  7655*        LENGTH   (ACCT-REC-LEN)
  7656*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7657*        INITIMG  (GETMAIN-SPACE)
  7658*    END-EXEC.
  7659*    MOVE ',"IL                  $   #00006956' TO DFHEIV0
  7660     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7661     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7662     MOVE X'2020233030303036393536' TO DFHEIV0(25:11)
  7663     CALL 'kxdfhei1' USING DFHEIV0,
  7664           DFHEIV20,
  7665           ACCT-REC-LEN,
  7666           GETMAIN-SPACE
  7667     SET ADDRESS OF ACCOUNT-MASTER TO
  7668         DFHEIV20
  7669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7670
  7671
  7672
  7673* EXEC CICS  HANDLE CONDITION
  7674*        ENDFILE  (5007-EXIT)
  7675*        NOTFND   (5007-EXIT)
  7676*    END-EXEC.
  7677*    MOVE '"$''I                  ! / #00006962' TO DFHEIV0
  7678     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7680     MOVE X'2F20233030303036393632' TO DFHEIV0(25:11)
  7681     CALL 'kxdfhei1' USING DFHEIV0
  7682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7683
  7684
  7685     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7686     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7687
  7688
  7689* EXEC CICS  READ
  7690*        UPDATE
  7691*        DATASET  (PI-ACCT-ID)
  7692*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7693*        RIDFLD   (PI-ACCT-KEY)
  7694*    END-EXEC.
  7695*    MOVE '&"S        EU         (   #00006970' TO DFHEIV0
  7696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7698     MOVE X'2020233030303036393730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 157
* EL650.cbl
  7699     CALL 'kxdfhei1' USING DFHEIV0,
  7700           PI-ACCT-ID,
  7701           DFHEIV20,
  7702           DFHEIV99,
  7703           PI-ACCT-KEY,
  7704           DFHEIV99,
  7705           DFHEIV99,
  7706           DFHEIV99
  7707     SET ADDRESS OF ACCOUNT-MASTER TO
  7708         DFHEIV20
  7709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7710
  7711
  7712     MOVE AM-CONTROL-PRIMARY     TO  SAVE-ACCT-KEY.
  7713     MOVE AM-EXPIRATION-DT       TO  SAVE-CURR-EXP-DT.
  7714     MOVE AM-EFFECTIVE-DT        TO  SAVE-CURR-EFF-DT.
  7715     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7716     MOVE AM-EXPIRATION-DT       TO  AF-ACCT-EFF-DT.
  7717     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7718     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7719     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7720     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7721
  7722     MOVE BIN-EXPCHG-SAVE     TO  AM-EFFECTIVE-DT
  7723                                  PI-BIN-EFF-DT (T-INDEX).
  7724
  7725* EXEC CICS  REWRITE
  7726*        FROM     (ACCOUNT-MASTER)
  7727*        DATASET  (PI-ACCT-ID)
  7728*    END-EXEC.
  7729     MOVE LENGTH OF
  7730      ACCOUNT-MASTER
  7731       TO DFHEIV11
  7732*    MOVE '&& L                  %   #00006989' TO DFHEIV0
  7733     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7734     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7735     MOVE X'2020233030303036393839' TO DFHEIV0(25:11)
  7736     CALL 'kxdfhei1' USING DFHEIV0,
  7737           PI-ACCT-ID,
  7738           ACCOUNT-MASTER,
  7739           DFHEIV11,
  7740           DFHEIV99
  7741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7742
  7743
  7744
  7745* EXEC CICS SYNCPOINT
  7746*    END-EXEC.
  7747*    MOVE '6"                    !   #00006994' TO DFHEIV0
  7748     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7749     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7750     MOVE X'2020233030303036393934' TO DFHEIV0(25:11)
  7751     CALL 'kxdfhei1' USING DFHEIV0
  7752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7753
  7754
  7755     PERFORM 8400-LOG-JOURNAL-RECORD.
  7756     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 158
* EL650.cbl
  7757     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7758     MOVE LOW-VALUES          TO  AM-CNTRL-B.
  7759     MOVE SAVE-CURR-EFF-DT    TO  PI-BIN-EFF-DT (T-INDEX)
  7760                                  AM-EFFECTIVE-DT.
  7761     MOVE BIN-EFFCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7762                                  AM-EXPIRATION-DT
  7763                                  AM-VG-EXPIRATION-DT.
  7764     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7765                                  PI-BIN-MAINT-DT (T-INDEX).
  7766     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7767     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7768     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7769     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7770                                  AM-PREV-DATES.
  7771     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7772
  7773
  7774* EXEC CICS  HANDLE CONDITION
  7775*        ENDFILE  (5007-EXIT)
  7776*        NOTFND   (5007-EXIT)
  7777*        DUPREC   (5007-EXIT)
  7778*        ILLOGIC  (5007-EXIT)
  7779*        INVREQ   (5007-EXIT)
  7780*    END-EXEC.
  7781*    MOVE '"$''I%38               ! 0 #00007015' TO DFHEIV0
  7782     MOVE X'222427492533382020202020' TO DFHEIV0(1:12)
  7783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7784     MOVE X'3020233030303037303135' TO DFHEIV0(25:11)
  7785     CALL 'kxdfhei1' USING DFHEIV0
  7786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7787
  7788
  7789     MOVE 'AM'                TO AM-RECORD-ID.
  7790
  7791     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7792     PERFORM 8400-LOG-JOURNAL-RECORD.
  7793     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7794
  7795     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7796     MOVE BIN-EFFCHG-SAVE     TO  AM-EFFECTIVE-DT
  7797                                  PI-BIN-EFF-DT (T-INDEX).
  7798     MOVE BIN-EXPCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7799                                  AM-EXPIRATION-DT
  7800                                  AM-VG-EXPIRATION-DT.
  7801     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7802                                  PI-BIN-MAINT-DT (T-INDEX).
  7803     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7804     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7805                                  AM-PREV-DATES.
  7806     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7807     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7808     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7809     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7810     PERFORM 8400-LOG-JOURNAL-RECORD.
  7811     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7812
  7813     MOVE ZERO                TO EFFCHGL
  7814                                 EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 159
* EL650.cbl
  7815
  7816
  7817* EXEC CICS  HANDLE CONDITION
  7818*         NOTFND   (5015-NOT-FOUND)
  7819*         ENDFILE  (5015-NOT-FOUND)
  7820*    END-EXEC.
  7821*    MOVE '"$I''                  ! 1 #00007050' TO DFHEIV0
  7822     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7824     MOVE X'3120233030303037303530' TO DFHEIV0(25:11)
  7825     CALL 'kxdfhei1' USING DFHEIV0
  7826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7827
  7828
  7829 5007-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 160
* EL650.cbl
  7831 5008-CREATE-SUB-DATE-RANGES.
  7832
  7833     IF BROWSE-STARTED-SW EQUAL 'Y'
  7834        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7835
  7836     IF NOT SYSTEM-MODIFY-CAP
  7837         MOVE 'UPDATE'           TO  SM-READ
  7838         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7839         MOVE ER-0070            TO  EMI-ERROR
  7840         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7841         GO TO 8100-SEND-INITIAL-MAP.
  7842
  7843     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7844     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7845     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  7846     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  7847
  7848     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  7849
  7850     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7851                                     AM-VG-EXPIRATION-DT
  7852                                     PI-BIN-EXP-DT (T-INDEX).
  7853     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7854                                     PI-BIN-MAINT-DT (T-INDEX).
  7855     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7856     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7857
  7858     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7859
  7860     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7861
  7862     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7863
  7864     IF T-INDEX = PI-TOTAL-LINES
  7865        MOVE ZERO             TO EFFCHGL
  7866                                 EXPCHGL
  7867        GO TO 5008-EXIT.
  7868
  7869     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  7870     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  7871     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7872
  7873     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  7874
  7875     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7876         VARYING  T-INDEX  FROM T-INDEX  BY  +1
  7877           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EXPCHG-SAVE.
  7878
  7879     IF BROWSE-STARTED-SW EQUAL 'Y'
  7880        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7881
  7882
  7883* EXEC CICS  READ
  7884*        UPDATE
  7885*        DATASET  (PI-ACCT-ID)
  7886*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7887*        RIDFLD   (PI-ACCT-KEY)
  7888*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 161
* EL650.cbl
  7889*    MOVE '&"S        EU         (   #00007108' TO DFHEIV0
  7890     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7891     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7892     MOVE X'2020233030303037313038' TO DFHEIV0(25:11)
  7893     CALL 'kxdfhei1' USING DFHEIV0,
  7894           PI-ACCT-ID,
  7895           DFHEIV20,
  7896           DFHEIV99,
  7897           PI-ACCT-KEY,
  7898           DFHEIV99,
  7899           DFHEIV99,
  7900           DFHEIV99
  7901     SET ADDRESS OF ACCOUNT-MASTER TO
  7902         DFHEIV20
  7903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7904
  7905
  7906     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7907     MOVE ACCT-FILE-ID           TO  FILE-ID.
  7908     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7909
  7910     PERFORM 8400-LOG-JOURNAL-RECORD.
  7911
  7912     MOVE BIN-EXPCHG-SAVE        TO  AM-EFFECTIVE-DT
  7913                                     PI-BIN-EFF-DT (T-INDEX).
  7914     MOVE EXPCHG-SAVE            TO  AM-EFFECT-DT.
  7915     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7916                                     PI-BIN-MAINT-DT (T-INDEX).
  7917     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7918     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7919     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7920     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7921
  7922     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7923
  7924
  7925* EXEC CICS  REWRITE
  7926*        FROM     (ACCOUNT-MASTER)
  7927*        DATASET  (PI-ACCT-ID)
  7928*    END-EXEC.
  7929     MOVE LENGTH OF
  7930      ACCOUNT-MASTER
  7931       TO DFHEIV11
  7932*    MOVE '&& L                  %   #00007133' TO DFHEIV0
  7933     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7934     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7935     MOVE X'2020233030303037313333' TO DFHEIV0(25:11)
  7936     CALL 'kxdfhei1' USING DFHEIV0,
  7937           PI-ACCT-ID,
  7938           ACCOUNT-MASTER,
  7939           DFHEIV11,
  7940           DFHEIV99
  7941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7942
  7943
  7944     PERFORM 8400-LOG-JOURNAL-RECORD.
  7945
  7946     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 162
* EL650.cbl
  7947
  7948
  7949
  7950     MOVE ZERO                TO EFFCHGL
  7951                                 EXPCHGL.
  7952
  7953
  7954* EXEC CICS  HANDLE CONDITION
  7955*         NOTFND   (5015-NOT-FOUND)
  7956*         ENDFILE  (5015-NOT-FOUND)
  7957*    END-EXEC.
  7958*    MOVE '"$I''                  ! 2 #00007147' TO DFHEIV0
  7959     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7961     MOVE X'3220233030303037313437' TO DFHEIV0(25:11)
  7962     CALL 'kxdfhei1' USING DFHEIV0
  7963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7964
  7965
  7966 5008-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 163
* EL650.cbl
  7968 5010-CHECK-VALID-NEW-RANGE.
  7969
  7970***************************************************************
  7971*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7972*    CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED        *
  7973***************************************************************
  7974
  7975     IF PI-AR-PROCESSING
  7976        GO TO 5010-CHECK-AR-VALID-NEW-RANGE.
  7977
  7978     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7979                        GREATER BIN-EFFCHG-SAVE          AND
  7980                        GREATER PI-BIN-HI-CERT (T-INDEX)
  7981         MOVE PI-BIN-EXP-DT (T-INDEX)
  7982                                  TO  PI-ACCT-EXP-DT
  7983         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7984         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7985         MOVE PI-BIN-EFF-DT (T-INDEX)
  7986                                  TO  B4-ACCT-EFF-DT
  7987         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7988         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7989                                      AM-VG-EXPIRATION-DT
  7990                                      PI-BIN-EXP-DT (T-INDEX)
  7991         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  7992         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7993         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7994         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7995         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7996         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7997     ELSE
  7998         MOVE ER-2051             TO  EMI-ERROR
  7999         MOVE -1                  TO  EFFCHGL
  8000         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  8001         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8002         GO TO 8200-SEND-DATAONLY.
  8003
  8004     GO TO 5010-EXIT.
  8005
  8006 5010-CHECK-AR-VALID-NEW-RANGE.
  8007
  8008***************************************************************
  8009*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  8010*    A/R CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED    *
  8011***************************************************************
  8012
  8013     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  8014                        GREATER BIN-EFFCHG-SAVE          AND
  8015                        GREATER PI-BIN-AR-HI-CERT (T-INDEX)
  8016         MOVE PI-BIN-EXP-DT (T-INDEX)
  8017                                  TO  PI-ACCT-EXP-DT
  8018         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  8019         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  8020         MOVE PI-BIN-EFF-DT (T-INDEX)
  8021                                  TO  B4-ACCT-EFF-DT
  8022         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  8023         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  8024                                      AM-VG-EXPIRATION-DT
  8025                                      PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 164
* EL650.cbl
  8026         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  8027         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  8028         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  8029         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  8030         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  8031         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  8032     ELSE
  8033         MOVE ER-2051             TO  EMI-ERROR
  8034         MOVE -1                  TO  EFFCHGL
  8035         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  8036         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8037         GO TO 8200-SEND-DATAONLY.
  8038
  8039 5010-EXIT.
  8040     EXIT.
  8041
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 165
* EL650.cbl
  8043 5015-NOT-FOUND.
  8044     MOVE ER-0226                TO  EMI-ERROR.
  8045     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8046     MOVE -1                 TO  MAINTL.
  8047     GO TO 8200-SEND-DATAONLY.
  8048
  8049 5015-EXIT.
  8050     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 166
* EL650.cbl
  8052 5020-READ-PREV-REC.
  8053
  8054* EXEC CICS  READ
  8055*        DATASET  (PI-ACCT-ID)
  8056*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8057*        RIDFLD   (PI-ACCT-KEY)
  8058*    END-EXEC.
  8059*    MOVE '&"S        E          (   #00007239' TO DFHEIV0
  8060     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8062     MOVE X'2020233030303037323339' TO DFHEIV0(25:11)
  8063     CALL 'kxdfhei1' USING DFHEIV0,
  8064           PI-ACCT-ID,
  8065           DFHEIV20,
  8066           DFHEIV99,
  8067           PI-ACCT-KEY,
  8068           DFHEIV99,
  8069           DFHEIV99,
  8070           DFHEIV99
  8071     SET ADDRESS OF ACCOUNT-MASTER TO
  8072         DFHEIV20
  8073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8074
  8075
  8076 5050-CREATE-NEW-REC.
  8077     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  8078     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  8079                                     AM-VG-EXPIRATION-DT.
  8080     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  8081     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE
  8082                                     AM-1ST-PROD-DATE
  8083                                     AM-PREV-DATES
  8084                                     AM-BILLING-STATUS.
  8085     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  8086                                     AM-LO-CERT-DATE.
  8087
  8088     IF AM-AR-HI-CERT-DATE NOT LESS THAN AM-EFFECTIVE-DT
  8089        NEXT SENTENCE
  8090     ELSE
  8091        MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE.
  8092
  8093     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  8094     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  8095     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  8096
  8097     SET T-INDEX  UP  BY  1.
  8098     IF T-INDEX  GREATER 32
  8099         MOVE ER-2062            TO  EMI-ERROR
  8100         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8101         MOVE -1                 TO  MAINTL
  8102         GO TO 8200-SEND-DATAONLY.
  8103
  8104     ADD 1                       TO  PI-TOTAL-LINES.
  8105
  8106     MOVE LOW-VALUES             TO  PI-TABLE-ENT    (T-INDEX).
  8107     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT   (T-INDEX).
  8108     MOVE BIN-EXPCHG-SAVE        TO  PI-BIN-EXP-DT   (T-INDEX).
  8109     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 167
* EL650.cbl
  8110     MOVE BIN-CURRENT-SAVE       TO  PI-BIN-MAINT-DT (T-INDEX).
  8111
  8112     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  8113
  8114     MOVE 'A'                    TO  JP-RECORD-TYPE.
  8115     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  8116     MOVE ACCT-FILE-ID           TO  FILE-ID.
  8117
  8118
  8119* EXEC CICS  WRITE
  8120*        RIDFLD   (AM-CONTROL-PRIMARY)
  8121*        FROM     (ACCOUNT-MASTER)
  8122*        DATASET  (PI-ACCT-ID)
  8123*    END-EXEC.
  8124     MOVE LENGTH OF
  8125      ACCOUNT-MASTER
  8126       TO DFHEIV11
  8127*    MOVE '&$ L                  ''   #00007287' TO DFHEIV0
  8128     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8130     MOVE X'2020233030303037323837' TO DFHEIV0(25:11)
  8131     CALL 'kxdfhei1' USING DFHEIV0,
  8132           PI-ACCT-ID,
  8133           ACCOUNT-MASTER,
  8134           DFHEIV11,
  8135           AM-CONTROL-PRIMARY,
  8136           DFHEIV99,
  8137           DFHEIV99
  8138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8139
  8140
  8141     PERFORM 8400-LOG-JOURNAL-RECORD.
  8142
  8143     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  8144
  8145 5050-EXIT.
  8146     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 168
* EL650.cbl
  8148 5100-FIND-NEXT-RANGE.
  8149     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8150
  8151     IF PI-TOTAL-LINES  = ZERO
  8152         GO TO 5210-NO-DATA.
  8153
  8154     IF PI-LST-PAGE
  8155       OR (PI-FST-PAGE AND PI-TOTAL-LINES NOT GREATER 8)
  8156       OR (PI-2ND-PAGE AND PI-TOTAL-LINES NOT GREATER 16)
  8157       OR (PI-3RD-PAGE AND PI-TOTAL-LINES NOT GREATER 24)
  8158         MOVE ER-2065            TO  EMI-ERROR
  8159         MOVE -1                 TO  MAINTL
  8160         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8161         GO TO 8200-SEND-DATAONLY.
  8162
  8163     IF PI-FST-PAGE
  8164         MOVE 2                  TO  PI-PAGE-NUMBER
  8165     ELSE
  8166     IF PI-2ND-PAGE
  8167         MOVE 3                  TO  PI-PAGE-NUMBER
  8168     ELSE
  8169     IF PI-3RD-PAGE
  8170         MOVE 4                  TO  PI-PAGE-NUMBER.
  8171
  8172     GO TO 7000-BUILD-OUTPUT-MAP.
  8173
  8174 5200-FIND-PREV-RANGE.
  8175     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8176
  8177     IF PI-TOTAL-LINES  =  ZERO
  8178         GO TO 5210-NO-DATA.
  8179
  8180     IF PI-FST-PAGE
  8181         MOVE ER-2066            TO  EMI-ERROR
  8182         MOVE -1                 TO  MAINTL
  8183         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8184         GO TO 8200-SEND-DATAONLY.
  8185
  8186     IF PI-2ND-PAGE
  8187         MOVE 1                  TO  PI-PAGE-NUMBER
  8188     ELSE
  8189     IF PI-3RD-PAGE
  8190         MOVE 2                  TO  PI-PAGE-NUMBER
  8191     ELSE
  8192     IF PI-LST-PAGE
  8193         MOVE 3                  TO  PI-PAGE-NUMBER.
  8194
  8195     GO TO 7000-BUILD-OUTPUT-MAP.
  8196
  8197 5210-NO-DATA.
  8198     MOVE ER-2069                TO  EMI-ERROR.
  8199     MOVE -1                     TO  MAINTL.
  8200
  8201     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8202
  8203     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 169
* EL650.cbl
  8205 5300-FIND-NEXT-ACCOUNT.
  8206     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8207     MOVE 'Y'                    TO  FIRST-TIME-SW.
  8208
  8209     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8210         MOVE PI-COMPANY-CD      TO  PI-ACCT-CO
  8211     ELSE
  8212         PERFORM 6100-BUILD-KEY  THRU  6199-EXIT
  8213         MOVE HIGH-VALUES        TO  PI-ACCT-EXP-DT
  8214         MOVE LOW-VALUES         TO  PI-ACCT-REST-OF-EXP.
  8215
  8216     IF NOT EMI-NO-ERRORS
  8217         GO TO 8200-SEND-DATAONLY.
  8218
  8219
  8220* EXEC CICS  HANDLE CONDITION
  8221*        NOTFND   (5340-END)
  8222*        ENDFILE  (5330-NOT-FOUND)
  8223*    END-EXEC.
  8224*    MOVE '"$I''                  ! 3 #00007371' TO DFHEIV0
  8225     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8227     MOVE X'3320233030303037333731' TO DFHEIV0(25:11)
  8228     CALL 'kxdfhei1' USING DFHEIV0
  8229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8230
  8231
  8232 5305-START-BR.
  8233     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  8234
  8235     SET T-INDEX
  8236        TS-INDEX  TO  +1.
  8237
  8238     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  8239
  8240 5310-READ-NEXT.
  8241     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  8242
  8243     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8244         GO TO 5330-NOT-FOUND.
  8245
  8246     IF PI-CARRIER-SECURITY GREATER SPACES
  8247         IF PI-ACCT-CARRIER  =  PI-CARRIER-SECURITY
  8248             NEXT SENTENCE
  8249         ELSE
  8250             GO TO 5310-READ-NEXT.
  8251
  8252     IF FIRST-TIME
  8253         IF PI-ACCT-CCGSA-KEY  NOT = KEY-SAVE
  8254             MOVE SPACES             TO  FIRST-TIME-SW
  8255             MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE
  8256                                         PI-PREV-VG-ACCOUNT
  8257         ELSE
  8258             GO TO 5310-READ-NEXT.
  8259
  8260     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  8261         IF PI-COMPANY-CD  = PI-ACCT-CO
  8262             GO TO 5320-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 170
* EL650.cbl
  8263         ELSE
  8264             MOVE ER-0066        TO  EMI-ERROR
  8265             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8266             MOVE -1             TO  MAINTL
  8267             GO TO 8200-SEND-DATAONLY.
  8268
  8269     IF PI-ACCT-CCGSA-KEY  = KEY-SAVE
  8270         GO TO 5320-DISPLAY-RECORD
  8271     ELSE
  8272         MOVE 1                  TO  PI-PAGE-NUMBER
  8273         GO TO 7000-BUILD-OUTPUT-MAP.
  8274
  8275 5320-DISPLAY-RECORD.
  8276     IF T-INDEX  = 1
  8277         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  8278         MOVE SPACE              TO  NAMEFLGO
  8279                                     PI-NAMEFLG.
  8280
  8281     IF AM-TRNTO-DTE  =  SPACES
  8282         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  8283
  8284     IF AM-TRNFROM-DTE  = SPACES
  8285         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  8286
  8287     IF T-INDEX  = 1
  8288         IF PI-COMPANY-ID  = 'LGX'  OR
  8289                             'MIC'  OR  'MCC'
  8290             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  8291             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  8292             MOVE SPACE              TO  DC-OPTION-CODE
  8293             PERFORM 9700-DATE-CONVERSION
  8294             IF DATE-CONVERSION-ERROR
  8295                 MOVE SPACES         TO  TRNTODTO
  8296             ELSE
  8297                 MOVE DC-GREG-DATE-1-EDIT
  8298                                     TO  TRNTODTO.
  8299
  8300     IF T-INDEX  = 1
  8301         IF PI-COMPANY-ID  =  'LGX'  OR
  8302                              'MIC'  OR  'MCC'
  8303             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  8304             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  8305             MOVE SPACE                TO  DC-OPTION-CODE
  8306             PERFORM 9700-DATE-CONVERSION
  8307             IF DATE-CONVERSION-ERROR
  8308                 MOVE SPACES           TO  TRNFRDTO
  8309             ELSE
  8310                 MOVE DC-GREG-DATE-1-EDIT
  8311                                       TO  TRNFRDTO.
  8312
  8313     IF NAMEO  NOT = LOW-VALUES
  8314         IF AM-NAME  NOT = NAMEO
  8315             MOVE '*'            TO  NAMEFLGO
  8316                                     PI-NAMEFLG.
  8317
  8318     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8319
  8320     IF T-INDEX  = 1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 171
* EL650.cbl
  8321         MOVE AM-NAME                TO  NAMEO
  8322                                         PI-ACCNAME
  8323        ELSE
  8324         MOVE PI-ACCNAME             TO  NAMEO.
  8325
  8326     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  8327
  8328     GO TO 5310-READ-NEXT.
  8329
  8330 5330-NOT-FOUND.
  8331     IF BROWSE-STARTED
  8332         PERFORM 6320-ENDBR  THRU  6320-EXIT
  8333     ELSE
  8334         GO TO 5340-END.
  8335
  8336     IF PI-ACCT-ACCOUNT  = LOW-VALUE
  8337         MOVE ER-0472            TO  EMI-ERROR
  8338         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8339         MOVE -1                 TO  MAINTL
  8340         GO TO 8200-SEND-DATAONLY.
  8341
  8342     IF PI-ACCT-CCGSA-KEY  =  PI-PREV-ACCOUNT
  8343       AND  T-INDEX  NOT = 1
  8344         MOVE 1                  TO  PI-PAGE-NUMBER
  8345         GO TO 7000-BUILD-OUTPUT-MAP
  8346     ELSE
  8347         IF T-INDEX  NOT = 1
  8348             MOVE ER-0066        TO  EMI-ERROR
  8349             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8350             MOVE 1              TO  PI-PAGE-NUMBER
  8351             GO TO 7000-BUILD-OUTPUT-MAP.
  8352
  8353 5340-END.
  8354     MOVE ER-0066                TO  EMI-ERROR.
  8355
  8356     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8357
  8358     MOVE -1                     TO  MAINTL.
  8359
  8360     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 172
* EL650.cbl
  8362 5400-FIND-PREV-ACCOUNT.
  8363     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8364         GO TO 5430-NOT-FOUND.
  8365
  8366     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8367     MOVE PI-BIN-EXP-DT (1)      TO  PI-ACCT-EXP-DT.
  8368     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  8369
  8370
  8371* EXEC CICS  HANDLE CONDITION
  8372*        NOTFND   (5440-NOT-FOUND)
  8373*        ENDFILE  (5430-NOT-FOUND)
  8374*    END-EXEC.
  8375*    MOVE '"$I''                  ! 4 #00007514' TO DFHEIV0
  8376     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8377     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8378     MOVE X'3420233030303037353134' TO DFHEIV0(25:11)
  8379     CALL 'kxdfhei1' USING DFHEIV0
  8380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8381
  8382
  8383
  8384* EXEC CICS  STARTBR
  8385*        DATASET  (PI-ACCT-ID)
  8386*        RIDFLD   (PI-ACCT-KEY)
  8387*    END-EXEC.
  8388     MOVE 0
  8389       TO DFHEIV11
  8390*    MOVE '&,         G          &   #00007519' TO DFHEIV0
  8391     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8392     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8393     MOVE X'2020233030303037353139' TO DFHEIV0(25:11)
  8394     CALL 'kxdfhei1' USING DFHEIV0,
  8395           PI-ACCT-ID,
  8396           PI-ACCT-KEY,
  8397           DFHEIV99,
  8398           DFHEIV11,
  8399           DFHEIV99
  8400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8401
  8402
  8403     MOVE 'Y'                    TO  BROWSE-STARTED-SW
  8404                                     FIRST-TIME-SW.
  8405 5410-READ-PREV.
  8406
  8407* EXEC CICS  READPREV
  8408*        DATASET  (PI-ACCT-ID)
  8409*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8410*        RIDFLD   (PI-ACCT-KEY)
  8411*    END-EXEC.
  8412     MOVE 0
  8413       TO DFHEIV11
  8414*    MOVE '&0S                   )   #00007527' TO DFHEIV0
  8415     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8416     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8417     MOVE X'2020233030303037353237' TO DFHEIV0(25:11)
  8418     CALL 'kxdfhei1' USING DFHEIV0,
  8419           PI-ACCT-ID,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 173
* EL650.cbl
  8420           DFHEIV20,
  8421           DFHEIV99,
  8422           PI-ACCT-KEY,
  8423           DFHEIV99,
  8424           DFHEIV11,
  8425           DFHEIV99,
  8426           DFHEIV99
  8427     SET ADDRESS OF ACCOUNT-MASTER TO
  8428         DFHEIV20
  8429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8430
  8431
  8432     IF FIRST-TIME
  8433         MOVE SPACE              TO  FIRST-TIME-SW
  8434         GO TO 5410-READ-PREV.
  8435
  8436     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8437         GO TO 5430-NOT-FOUND.
  8438
  8439     IF PI-CARRIER-SECURITY GREATER SPACES
  8440         IF PI-ACCT-CARRIER  = PI-CARRIER-SECURITY
  8441             NEXT SENTENCE
  8442         ELSE
  8443             GO TO 5410-READ-PREV.
  8444
  8445     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8446     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE
  8447                                     PI-PREV-VG-ACCOUNT.
  8448     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  8449                                     PI-ACCT-REST-OF-EXP
  8450                                     PI-DATE-RANGE-TABLE.
  8451
  8452     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  8453
  8454
  8455* EXEC CICS  ENDBR
  8456*        DATASET  (PI-ACCT-ID)
  8457*    END-EXEC.
  8458     MOVE 0
  8459       TO DFHEIV11
  8460*    MOVE '&2                    $   #00007555' TO DFHEIV0
  8461     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8462     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8463     MOVE X'2020233030303037353535' TO DFHEIV0(25:11)
  8464     CALL 'kxdfhei1' USING DFHEIV0,
  8465           PI-ACCT-ID,
  8466           DFHEIV11,
  8467           DFHEIV99
  8468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8469
  8470
  8471     GO TO 5305-START-BR.
  8472
  8473 5430-NOT-FOUND.
  8474     IF BROWSE-STARTED
  8475         MOVE SPACE              TO  BROWSE-STARTED-SW
  8476
  8477* EXEC CICS  ENDBR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 174
* EL650.cbl
  8478*            DATASET  (PI-ACCT-ID)
  8479*        END-EXEC.
  8480     MOVE 0
  8481       TO DFHEIV11
  8482*    MOVE '&2                    $   #00007564' TO DFHEIV0
  8483     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8484     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8485     MOVE X'2020233030303037353634' TO DFHEIV0(25:11)
  8486     CALL 'kxdfhei1' USING DFHEIV0,
  8487           PI-ACCT-ID,
  8488           DFHEIV11,
  8489           DFHEIV99
  8490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8491
  8492
  8493     MOVE ER-0067                TO  EMI-ERROR.
  8494
  8495     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8496
  8497     MOVE -1                     TO  MAINTL.
  8498
  8499     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8500         GO TO 5300-FIND-NEXT-ACCOUNT.
  8501
  8502     GO TO 8200-SEND-DATAONLY.
  8503
  8504 5440-NOT-FOUND.
  8505     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8506
  8507     PERFORM 6310-READNEXT THRU 6310-EXIT.
  8508
  8509     GO TO 5410-READ-PREV.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 175
* EL650.cbl
  8511 5500-ADD-NEW-AXRF-RECORD.
  8512     IF NOT PI-GA-BILLING
  8513         GO TO 5599-EXIT.
  8514
  8515     MOVE +1                     TO  AXRF-SUB.
  8516
  8517*    IF MAINTI  = 'K'
  8518*        IF GETMAIN-SW  = 'X'
  8519*            GO TO 5510-BUILD-AXRF-KEY.
  8520
  8521     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8522
  8523*    EXEC CICS  GETMAIN
  8524*        LENGTH   (ERGXRF-REC-LEN)
  8525*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8526*        INITIMG  (GETMAIN-SPACE)
  8527*    END-EXEC.
  8528*    display ' beginning of CP displays  '
  8529*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8530*    display ' address         ==   '
  8531*              address of agent-cross-reference
  8532*    display ' contents        ==   '  agent-cross-reference (1:1)
  8533*    display ' end       of CP displays  '
  8534
  8535*    MOVE 'X'                    TO  GETMAIN-SW.
  8536
  8537 5510-BUILD-AXRF-KEY.
  8538     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8539
  8540     IF AXRF-SUB  =  +11
  8541         GO TO 5599-EXIT.
  8542
  8543     IF AM-AGT (AXRF-SUB)  =  SPACES  OR ZEROS OR LOW-VALUES
  8544         ADD +1 TO AXRF-SUB
  8545         GO TO 5510-BUILD-AXRF-KEY.
  8546
  8547     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O' AND 'P' AND 'S'
  8548         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8549         ADD +1 TO AXRF-SUB
  8550         GO TO 5510-BUILD-AXRF-KEY.
  8551
  8552     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8553
  8554     IF PI-ZERO-CARRIER  OR
  8555        PI-ZERO-CAR-GROUP
  8556         MOVE ZERO               TO  WS-AXRF-CARRIER
  8557     ELSE
  8558         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8559
  8560     IF PI-ZERO-GROUPING  OR
  8561        PI-ZERO-CAR-GROUP
  8562         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8563     ELSE
  8564         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8565
  8566     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8567
  8568
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 176
* EL650.cbl
  8569* EXEC CICS  HANDLE CONDITION
  8570*        ENDFILE  (5525-SKIP-REWRITE)
  8571*        NOTFND   (5525-SKIP-REWRITE)
  8572*    END-EXEC.
  8573*    MOVE '"$''I                  ! 5 #00007643' TO DFHEIV0
  8574     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8576     MOVE X'3520233030303037363433' TO DFHEIV0(25:11)
  8577     CALL 'kxdfhei1' USING DFHEIV0
  8578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8579
  8580
  8581
  8582* EXEC CICS  READ
  8583*        DATASET  (ERGXRF-FILE-ID)
  8584*        LENGTH   (ERGXRF-REC-LEN)
  8585*        INTO     (AGENT-CROSS-REFERENCE)
  8586*        RIDFLD   (WS-AXRF-KEY)
  8587*        EQUAL
  8588*        UPDATE
  8589*    END-EXEC.
  8590*    MOVE '&"IL       EU         (   #00007648' TO DFHEIV0
  8591     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8593     MOVE X'2020233030303037363438' TO DFHEIV0(25:11)
  8594     CALL 'kxdfhei1' USING DFHEIV0,
  8595           ERGXRF-FILE-ID,
  8596           AGENT-CROSS-REFERENCE,
  8597           ERGXRF-REC-LEN,
  8598           WS-AXRF-KEY,
  8599           DFHEIV99,
  8600           DFHEIV99,
  8601           DFHEIV99
  8602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8603
  8604
  8605     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8606     MOVE +1                     TO  GX-AGENT-SUB.
  8607
  8608     IF GX-AGENT-POINTER-CNT = +1006
  8609         GO TO 5525-SKIP-REWRITE.
  8610
  8611
  8612 5520-FIND-REC-LOCATION.
  8613     MOVE AM-COMPANY-CD          TO  GX-AM-COMPANY-CD.
  8614     MOVE GX-AGENT-POINTER (GX-AGENT-SUB)
  8615                                 TO  GX-REST-OF-KEY.
  8616     MOVE LOW-VALUES             TO  GX-AM-CNTL-FILLER.
  8617
  8618     IF GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY  OR
  8619        GX-AGENT-SUB          GREATER GX-AGENT-POINTER-CNT
  8620         NEXT SENTENCE
  8621     ELSE
  8622         ADD +1 TO GX-AGENT-SUB
  8623         GO TO 5520-FIND-REC-LOCATION.
  8624
  8625     MOVE GX-AGENT-POINTER-CNT   TO  COMM-WORK-SUB
  8626                                     COMM-WORK-SUB2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 177
* EL650.cbl
  8627
  8628     ADD +1 TO COMM-WORK-SUB2.
  8629
  8630     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  8631         NEXT SENTENCE
  8632      ELSE
  8633         PERFORM 5530-BUMP-AXRF-REC
  8634             VARYING  COMM-WORK-SUB  FROM  COMM-WORK-SUB  BY  -1
  8635               UNTIL  COMM-WORK-SUB2 = GX-AGENT-SUB.
  8636
  8637     ADD ERGXRF-INC-LEN TO  ERGXRF-REC-LEN.
  8638     ADD  +1 TO  GX-AGENT-POINTER-CNT.
  8639
  8640     MOVE AM-CARRIER        TO  GX-AM-CARRIER   (COMM-WORK-SUB2).
  8641     MOVE AM-GROUPING       TO  GX-AM-GROUPING  (COMM-WORK-SUB2).
  8642     MOVE AM-STATE          TO  GX-AM-STATE     (COMM-WORK-SUB2).
  8643     MOVE AM-ACCOUNT        TO  GX-AM-ACCOUNT   (COMM-WORK-SUB2).
  8644     MOVE AM-EXPIRATION-DT  TO  GX-AM-EXPIRATION-DT
  8645                                                (COMM-WORK-SUB2).
  8646     MOVE AM-EFFECTIVE-DT   TO  GX-AM-EFF-DT    (COMM-WORK-SUB2).
  8647     MOVE AXRF-SUB          TO  GX-AM-LEVEL-NO  (COMM-WORK-SUB2).
  8648     MOVE LOW-VALUES        TO  GX-LAST-BILL-DT (COMM-WORK-SUB2).
  8649     MOVE BIN-CURRENT-SAVE  TO  GX-LAST-MAINT-DT.
  8650     MOVE EIBTIME           TO  GX-LAST-MAINT-HHMMSS.
  8651     MOVE PI-PROCESSOR-ID   TO  GX-LAST-MAINT-USER.
  8652     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
  8653     if ergxrf-rec-len > +31264
  8654        move +31264          to ergxrf-rec-len
  8655        move +1006           to gx-agent-pointer-cnt
  8656     end-if
  8657
  8658
  8659* EXEC CICS  REWRITE
  8660*        FROM     (AGENT-CROSS-REFERENCE)
  8661*        LENGTH   (ERGXRF-REC-LEN)
  8662*        DATASET  (ERGXRF-FILE-ID)
  8663*    END-EXEC.
  8664*    MOVE '&& L                  %   #00007710' TO DFHEIV0
  8665     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8666     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8667     MOVE X'2020233030303037373130' TO DFHEIV0(25:11)
  8668     CALL 'kxdfhei1' USING DFHEIV0,
  8669           ERGXRF-FILE-ID,
  8670           AGENT-CROSS-REFERENCE,
  8671           ERGXRF-REC-LEN,
  8672           DFHEIV99
  8673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8674
  8675
  8676 5525-SKIP-REWRITE.
  8677
  8678     ADD +1 TO AXRF-SUB.
  8679
  8680     GO TO 5510-BUILD-AXRF-KEY.
  8681
  8682 5530-BUMP-AXRF-REC.
  8683     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8684                          TO  GX-AGENT-POINTER (COMM-WORK-SUB2).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 178
* EL650.cbl
  8685
  8686     SUBTRACT +1  FROM  COMM-WORK-SUB2.
  8687
  8688 5599-EXIT.
  8689     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 179
* EL650.cbl
  8691 5600-CHG-AXRF-RECORDS.
  8692     IF NOT PI-GA-BILLING
  8693         GO TO 5699-EXIT.
  8694
  8695     MOVE +1                     TO  AXRF-SUB.
  8696     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8697
  8698*    IF GETMAIN-SW  = 'X'
  8699*        GO TO 5610-BUILD-AXRF-KEY.
  8700
  8701*    EXEC CICS  GETMAIN
  8702*        LENGTH   (ERGXRF-REC-LEN)
  8703*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8704*        INITIMG  (GETMAIN-SPACE)
  8705*    END-EXEC.
  8706*
  8707*    display ' beginning of CP displays  '
  8708*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8709*    display ' address         ==   '
  8710*              address of agent-cross-reference
  8711*    display ' contents        ==   '  agent-cross-reference (1:1)
  8712*    display ' end       of CP displays  '
  8713
  8714*    MOVE 'X'                    TO  GETMAIN-SW.
  8715
  8716 5610-BUILD-AXRF-KEY.
  8717     IF AXRF-SUB  = +11
  8718         GO TO 5699-EXIT.
  8719
  8720     IF AM-AGT (AXRF-SUB)  = SPACES OR ZEROS OR LOW-VALUES
  8721         ADD +1 TO AXRF-SUB
  8722         GO TO 5610-BUILD-AXRF-KEY.
  8723
  8724     IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'S'
  8725         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8726         ADD +1 TO AXRF-SUB
  8727         GO TO 5610-BUILD-AXRF-KEY.
  8728
  8729     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8730     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8731
  8732     IF PI-ZERO-CARRIER OR
  8733        PI-ZERO-CAR-GROUP
  8734         MOVE ZERO               TO  WS-AXRF-CARRIER
  8735     ELSE
  8736         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8737
  8738     IF PI-ZERO-GROUPING  OR
  8739        PI-ZERO-CAR-GROUP
  8740         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8741     ELSE
  8742         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8743
  8744     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8745
  8746
  8747* EXEC CICS  HANDLE CONDITION
  8748*        ENDFILE  (5615-SKIP-REWRITE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 180
* EL650.cbl
  8749*        NOTFND   (5615-SKIP-REWRITE)
  8750*    END-EXEC.
  8751*    MOVE '"$''I                  ! 6 #00007786' TO DFHEIV0
  8752     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8754     MOVE X'3620233030303037373836' TO DFHEIV0(25:11)
  8755     CALL 'kxdfhei1' USING DFHEIV0
  8756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8757
  8758
  8759
  8760* EXEC CICS  READ
  8761*        DATASET  (ERGXRF-FILE-ID)
  8762*        LENGTH   (ERGXRF-REC-LEN)
  8763*        INTO     (AGENT-CROSS-REFERENCE)
  8764*        RIDFLD   (WS-AXRF-KEY)
  8765*        EQUAL
  8766*        UPDATE
  8767*    END-EXEC.
  8768*    MOVE '&"IL       EU         (   #00007791' TO DFHEIV0
  8769     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8770     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8771     MOVE X'2020233030303037373931' TO DFHEIV0(25:11)
  8772     CALL 'kxdfhei1' USING DFHEIV0,
  8773           ERGXRF-FILE-ID,
  8774           AGENT-CROSS-REFERENCE,
  8775           ERGXRF-REC-LEN,
  8776           WS-AXRF-KEY,
  8777           DFHEIV99,
  8778           DFHEIV99,
  8779           DFHEIV99
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8781
  8782
  8783     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8784
  8785     PERFORM VARYING GX-AGENT-SUB FROM +1 BY +1
  8786             UNTIL
  8787       (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT)
  8788            OR
  8789       (GX-AM-ACCOUNT       (GX-AGENT-SUB) = B4-ACCT-ACCOUNT  AND
  8790        GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = B4-ACCT-EXP-DT   AND
  8791        GX-AM-EFF-DT        (GX-AGENT-SUB) = B4-ACCT-EFF-DT   AND
  8792        GX-AM-CARRIER       (GX-AGENT-SUB) = B4-ACCT-CARRIER  AND
  8793        GX-AM-GROUPING      (GX-AGENT-SUB) = B4-ACCT-GROUPING AND
  8794        GX-AM-STATE         (GX-AGENT-SUB) = B4-ACCT-STATE)
  8795     END-PERFORM.
  8796
  8797     IF MAINTI  = 'D'
  8798        IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8799            MOVE GX-AGENT-SUB    TO  COMM-WORK-SUB
  8800            PERFORM 5630-BUMP-RECORDS
  8801                VARYING  GX-AGENT-SUB  FROM  GX-AGENT-SUB  BY  +1
  8802                  UNTIL  GX-AGENT-SUB  = GX-AGENT-POINTER-CNT
  8803            SUBTRACT ERGXRF-INC-LEN  FROM  ERGXRF-REC-LEN
  8804            SUBTRACT +1              FROM  GX-AGENT-POINTER-CNT
  8805            GO TO 5615-REWRITE-AXRF-RECORD.
  8806
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 181
* EL650.cbl
  8807     IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8808        MOVE AF-ACCT-EFF-DT  TO GX-AM-EFF-DT        (GX-AGENT-SUB)
  8809        MOVE AF-ACCT-EXP-DT  TO GX-AM-EXPIRATION-DT (GX-AGENT-SUB)
  8810        MOVE AXRF-SUB        TO GX-AM-LEVEL-NO      (GX-AGENT-SUB)
  8811        GO TO 5615-REWRITE-AXRF-RECORD.
  8812
  8813
  8814* EXEC CICS  UNLOCK
  8815*        DATASET  (ERGXRF-FILE-ID)
  8816*    END-EXEC.
  8817*    MOVE '&*                    #   #00007830' TO DFHEIV0
  8818     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8819     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8820     MOVE X'2020233030303037383330' TO DFHEIV0(25:11)
  8821     CALL 'kxdfhei1' USING DFHEIV0,
  8822           ERGXRF-FILE-ID,
  8823           DFHEIV99
  8824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8825
  8826
  8827     GO TO 5615-SKIP-REWRITE.
  8828
  8829 5615-REWRITE-AXRF-RECORD.
  8830     IF MAINTI  = 'D'
  8831       AND  GX-AGENT-POINTER-CNT  =  +0
  8832
  8833* EXEC CICS  DELETE
  8834*            DATASET  (ERGXRF-FILE-ID)
  8835*        END-EXEC
  8836*    MOVE '&(                    &   #00007839' TO DFHEIV0
  8837     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8838     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8839     MOVE X'2020233030303037383339' TO DFHEIV0(25:11)
  8840     CALL 'kxdfhei1' USING DFHEIV0,
  8841           ERGXRF-FILE-ID,
  8842           DFHEIV99,
  8843           DFHEIV99,
  8844           DFHEIV99,
  8845           DFHEIV99
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8847     ELSE
  8848         MOVE BIN-CURRENT-SAVE   TO  GX-LAST-MAINT-DT
  8849         MOVE EIBTIME            TO  GX-LAST-MAINT-HHMMSS
  8850         MOVE PI-PROCESSOR-ID    TO  GX-LAST-MAINT-USER
  8851         compute ergxrf-rec-len =
  8852              (gx-agent-pointer-cnt * +31) + +78
  8853         if ergxrf-rec-len > +31264
  8854            move +31264          to ergxrf-rec-len
  8855            move +1006           to gx-agent-pointer-cnt
  8856         end-if
  8857
  8858* EXEC CICS  REWRITE
  8859*            FROM     (AGENT-CROSS-REFERENCE)
  8860*            LENGTH   (ERGXRF-REC-LEN)
  8861*            DATASET  (ERGXRF-FILE-ID)
  8862*        END-EXEC.
  8863*    MOVE '&& L                  %   #00007852' TO DFHEIV0
  8864     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 182
* EL650.cbl
  8865     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8866     MOVE X'2020233030303037383532' TO DFHEIV0(25:11)
  8867     CALL 'kxdfhei1' USING DFHEIV0,
  8868           ERGXRF-FILE-ID,
  8869           AGENT-CROSS-REFERENCE,
  8870           ERGXRF-REC-LEN,
  8871           DFHEIV99
  8872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8873
  8874
  8875 5615-SKIP-REWRITE.
  8876     ADD +1  TO  AXRF-SUB.
  8877
  8878     GO TO 5610-BUILD-AXRF-KEY.
  8879
  8880 5630-BUMP-RECORDS.
  8881     ADD +1  TO  COMM-WORK-SUB.
  8882
  8883     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8884                            TO  GX-AGENT-POINTER (GX-AGENT-SUB).
  8885
  8886 5699-EXIT.
  8887     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 183
* EL650.cbl
  8889 6000-EDIT-EFFECTIVE-DATE.
  8890     IF EFFCHGL  NOT =  ZEROS
  8891         MOVE EFFCHGI                  TO  WS-DT-DEEDIT-FIELD
  8892         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8893         MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8894         MOVE '4'                      TO  DC-OPTION-CODE
  8895         PERFORM 9700-DATE-CONVERSION
  8896         IF DATE-CONVERSION-ERROR
  8897             MOVE ER-0348              TO  EMI-ERROR
  8898             MOVE -1                   TO  EFFCHGL
  8899             MOVE AL-UABON             TO  EFFCHGA
  8900             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8901         ELSE
  8902             MOVE DC-GREG-DATE-1-EDIT  TO  EFFCHGI
  8903             MOVE AL-UANON             TO  EFFCHGA
  8904***  Y2K PROJ 7744
  8905             MOVE DC-GREG-DATE-1-YMD   TO  WS-EFFCHG-SAVE
  8906             MOVE DC-ALPHA-CENTURY     TO  WS-EFFCHG-SAVE(4:2)
  8907             MOVE WS-EFFCHG-SAVE       TO  EFFCHG-SAVE
  8908             MOVE DC-BIN-DATE-1        TO  BIN-EFFCHG-SAVE
  8909         END-IF
  8910***  Y2K PROJ 7744
  8911     ELSE
  8912         IF MAINTI  NOT = 'N'
  8913             MOVE ER-0216              TO  EMI-ERROR
  8914             MOVE -1                   TO  EFFCHGL
  8915             MOVE AL-UABON             TO  EFFCHGA
  8916             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8917
  8918 6000-EFF-EXIT.
  8919     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 184
* EL650.cbl
  8921 6000-EDIT-EXPIRATION-DATE.
  8922***  Y2K PROJ 7744
  8923     IF EXPCHGL  NOT = ZEROS
  8924         MOVE EXPCHGI                  TO  WS-DT-DEEDIT-FIELD
  8925         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8926         IF WS-DEEDIT-FIELD-DATE-OUT NOT LESS 999999
  8927             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EXPCHGO
  8928             INSPECT EXPCHGI CONVERTING SPACES TO '/'
  8929             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8930             MOVE 99999999999              TO  EXPCHG-SAVE
  8931         ELSE
  8932             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8933             MOVE '4'                      TO  DC-OPTION-CODE
  8934             PERFORM 9700-DATE-CONVERSION
  8935             IF DATE-CONVERSION-ERROR
  8936                 MOVE ER-0454              TO  EMI-ERROR
  8937                 MOVE -1                   TO  EXPCHGL
  8938                 MOVE AL-UABON             TO  EXPCHGA
  8939                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8940             ELSE
  8941                 MOVE DC-GREG-DATE-1-EDIT  TO  EXPCHGI
  8942                 MOVE AL-UANON             TO  EXPCHGA
  8943                 MOVE DC-GREG-DATE-1-YMD   TO  WS-EXPCHG-SAVE
  8944                 MOVE DC-ALPHA-CENTURY     TO  WS-EXPCHG-SAVE(4:2)
  8945                 MOVE WS-EXPCHG-SAVE       TO  EXPCHG-SAVE
  8946                 MOVE DC-BIN-DATE-1        TO  BIN-EXPCHG-SAVE
  8947             END-IF
  8948         END-IF
  8949     ELSE
  8950         IF MAINTI  NOT =  'N'
  8951             MOVE ER-2058                  TO  EMI-ERROR
  8952             MOVE -1                       TO  EXPCHGL
  8953             MOVE AL-UABON                 TO  EXPCHGA
  8954             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8955         ELSE
  8956             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8957             MOVE 99999999999              TO  EXPCHG-SAVE
  8958         END-IF
  8959     END-IF.
  8960***  Y2K PROJ 7744
  8961
  8962 6000-EXP-EXIT.
  8963     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 185
* EL650.cbl
  8965 6000-EDIT-LINE.
  8966     IF LINEL  = ZEROS
  8967         GO TO 6000-NO-LINE.
  8968
  8969     MOVE AL-UNNON               TO  LINEA.
  8970
  8971     IF LINEI NOT NUMERIC
  8972         GO TO 6000-LINE-ERROR.
  8973
  8974     IF LINEI LESS 1 OR GREATER 8 OR GREATER PI-TOTAL-LINES
  8975         GO TO 6000-LINE-ERROR.
  8976
  8977     MOVE PI-TOTAL-LINES         TO WS-PAGE-LINES.
  8978
  8979     IF PI-2ND-PAGE
  8980         SUBTRACT 8 FROM WS-PAGE-LINES
  8981     ELSE
  8982     IF PI-3RD-PAGE
  8983         SUBTRACT 16 FROM WS-PAGE-LINES
  8984     ELSE
  8985     IF PI-LST-PAGE
  8986         SUBTRACT 24 FROM WS-PAGE-LINES.
  8987
  8988     IF LINEI GREATER WS-PAGE-LINES
  8989         GO TO 6000-LINE-ERROR.
  8990
  8991     MOVE LINEI                  TO  PI-LINE-SELECTED.
  8992
  8993     GO TO 6000-LIN-EXIT.
  8994
  8995 6000-NO-LINE.
  8996     IF PI-TOTAL-LINES  = 1
  8997         MOVE 1                  TO  PI-LINE-SELECTED
  8998                                     LINEI
  8999         MOVE AL-UNNON           TO  LINEA
  9000         GO TO 6000-LIN-EXIT.
  9001
  9002 6000-LINE-ERROR.
  9003     MOVE ER-2064                TO  EMI-ERROR.
  9004     MOVE -1                     TO  LINEL.
  9005     MOVE AL-UABON               TO  LINEA.
  9006
  9007     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9008
  9009 6000-LIN-EXIT.
  9010     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 186
* EL650.cbl
  9012 600A-CHECK-HI-LO-DATES.
  9013
  9014     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9015         GO TO 600A-CHECK-AR-DATES.
  9016
  9017     IF BIN-EFFCHG-SAVE GREATER THAN PI-BIN-EFF-DT (T-INDEX)
  9018     IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9019         MOVE ER-2113            TO  EMI-ERROR
  9020         MOVE -1                 TO  MAINTL
  9021         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9022
  9023*    IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9024*        MOVE ER-2113            TO  EMI-ERROR
  9025*        MOVE -1                 TO  MAINTL
  9026*        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9027
  9028 600A-CHECK-AR-DATES.
  9029     IF NOT PI-AR-PROCESSING
  9030         GO TO 600A-EXIT.
  9031
  9032     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  9033        GO TO 600A-EXIT.
  9034
  9035     IF (PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9036         MOVE ER-2113            TO  EMI-ERROR
  9037         MOVE -1                 TO  MAINTL
  9038         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9039
  9040 600A-EXIT.
  9041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 187
* EL650.cbl
  9043 6010-DATE-CHECK.
  9044     IF MAINTI  = 'E'
  9045         GO TO 6010-CHECK-EFF.
  9046
  9047     IF PI-BIN-HI-CERT (T-INDEX)  NOT = LOW-VALUES
  9048         IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-HI-CERT (T-INDEX)
  9049             MOVE ER-2072        TO  EMI-ERROR
  9050             MOVE -1             TO  EXPCHGL
  9051             MOVE AL-UABON       TO  EXPCHGA
  9052             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9053
  9054     IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-EFF-DT (T-INDEX)
  9055         MOVE ER-2074            TO  EMI-ERROR
  9056         MOVE -1                 TO  EXPCHGL
  9057         MOVE AL-UABON           TO  EXPCHGA
  9058         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9059
  9060     GO TO 6010-EXIT.
  9061
  9062 6010-CHECK-EFF.
  9063     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES
  9064        IF (BIN-EFFCHG-SAVE >= PI-BIN-LO-CERT (T-INDEX))
  9065           AND (PI-PROCESSOR-ID NOT = 'PEMA')
  9066           MOVE ER-2073          TO EMI-ERROR
  9067           MOVE -1               TO EFFCHGL
  9068           MOVE AL-UABON         TO EFFCHGA
  9069           PERFORM 9900-ERROR-FORMAT
  9070                                 THRU 9900-EXIT
  9071        END-IF
  9072     END-IF
  9073
  9074     IF BIN-EFFCHG-SAVE NOT LESS PI-BIN-EXP-DT (T-INDEX)
  9075         MOVE ER-2075            TO  EMI-ERROR
  9076         MOVE -1                 TO  EFFCHGL
  9077         MOVE AL-UABON           TO  EFFCHGA
  9078         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9079
  9080 6010-EXIT.
  9081     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 188
* EL650.cbl
  9083 6100-BUILD-KEY.
  9084     MOVE LOW-VALUES             TO  PI-ACCT-KEY.
  9085     MOVE PI-COMPANY-CD          TO  PI-ACCT-CO.
  9086
  9087     IF ACARIERI  =  SPACES  OR  LOW-VALUES
  9088         IF MAINTI  = 'S'
  9089           OR  FIRST-TIME
  9090             MOVE SPACES         TO  PI-ACCT-CARRIER
  9091         ELSE
  9092             MOVE -1             TO  ACARIERL
  9093             MOVE ER-2059        TO  EMI-ERROR
  9094             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9095     ELSE
  9096         MOVE AL-UANON           TO  ACARIERA
  9097         MOVE ACARIERI           TO  PI-ACCT-CARRIER.
  9098
  9099     IF AGROUPI  =  SPACES  OR  LOW-VALUES
  9100         IF MAINTI  = 'S'
  9101           OR  FIRST-TIME
  9102             MOVE SPACES         TO  PI-ACCT-GROUPING
  9103         ELSE
  9104             MOVE -1             TO  AGROUPL
  9105             MOVE ER-2059        TO  EMI-ERROR
  9106             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9107     ELSE
  9108         IF AGROUPI  =  '0     '
  9109             MOVE -1             TO  AGROUPL
  9110             MOVE ER-0195        TO  EMI-ERROR
  9111             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9112         ELSE
  9113             MOVE AL-UANON       TO  AGROUPA
  9114             MOVE AGROUPI        TO  PI-ACCT-GROUPING.
  9115
  9116     IF ASTATEI  = SPACES  OR  LOW-VALUES
  9117         IF MAINTI  =  'S'
  9118           OR  FIRST-TIME
  9119             MOVE SPACES         TO  PI-ACCT-STATE
  9120         ELSE
  9121             MOVE -1             TO  ASTATEL
  9122             MOVE ER-2059        TO  EMI-ERROR
  9123             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9124     ELSE
  9125         MOVE AL-UANON           TO  ASTATEA
  9126         MOVE ASTATEI            TO  PI-ACCT-STATE.
  9127
  9128     IF AACCTI  = SPACES  OR  LOW-VALUES
  9129        IF MAINTI  = 'S'
  9130          OR  FIRST-TIME
  9131            MOVE SPACES          TO  PI-ACCT-ACCOUNT
  9132        ELSE
  9133            MOVE -1              TO  AACCTL
  9134            MOVE ER-2059         TO  EMI-ERROR
  9135            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9136     ELSE
  9137         MOVE AL-UANON           TO  AACCTA
  9138         MOVE AACCTI             TO  PI-ACCT-ACCOUNT.
  9139
  9140     IF PI-ACCT-CARRIER  = SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 189
* EL650.cbl
  9141       AND  (CARR-ACCNT-CNTL
  9142       OR   CARR-ST-ACCNT-CNTL
  9143       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9144         MOVE ER-0193            TO  EMI-ERROR
  9145         MOVE -1                 TO  ACARIERL
  9146         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9147
  9148     IF PI-ACCT-GROUPING  =  SPACES
  9149       AND  CARR-GROUP-ST-ACCNT-CNTL
  9150         MOVE ER-0195            TO  EMI-ERROR
  9151         MOVE -1                 TO  AGROUPL
  9152         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9153
  9154     IF PI-ACCT-STATE  = SPACES
  9155       AND  (ST-ACCNT-CNTL
  9156       OR   CARR-ST-ACCNT-CNTL
  9157       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9158         MOVE ER-0144            TO  EMI-ERROR
  9159         MOVE -1                 TO  ASTATEL
  9160         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9161
  9162     IF MAINTI  =  'S'
  9163       OR  FIRST-TIME
  9164         NEXT SENTENCE
  9165     ELSE
  9166         MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE.
  9167
  9168     IF NOT EMI-NO-ERRORS
  9169         IF EIBTRNID = EL6311-TRANS-ID OR VP6311-TRANS-ID
  9170             GO TO 8100-SEND-INITIAL-MAP
  9171           ELSE
  9172             GO TO 8200-SEND-DATAONLY.
  9173
  9174     IF PI-ACCT-CARRIER   = SPACES  OR
  9175        PI-ACCT-STATE     = SPACES  OR
  9176        PI-ACCT-GROUPING  = SPACES
  9177         MOVE ACCT2-FILE-ID      TO  PI-ACCT-ID
  9178     ELSE
  9179         MOVE ACCT-FILE-ID       TO  PI-ACCT-ID.
  9180
  9181     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  9182                                     PI-ACCT-REST-OF-EXP.
  9183
  9184 6199-EXIT.
  9185     EXIT.
  9186
  9187 6200-CHECK-KEY.
  9188     IF PI-PREV-ACCOUNT  NOT = PI-ACCT-CCGSA-KEY
  9189         MOVE ER-0453            TO  EMI-ERROR
  9190         MOVE -1                 TO  MAINTL
  9191         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9192
  9193 6200-EXIT.
  9194     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 190
* EL650.cbl
  9196 6300-STARTBR.
  9197     MOVE ACCT-FILE-ID           TO  PI-ACCT-ID.
  9198
  9199
  9200* EXEC CICS  STARTBR
  9201*        DATASET  (PI-ACCT-ID)
  9202*        RIDFLD   (PI-ACCT-KEY)
  9203*    END-EXEC.
  9204     MOVE 0
  9205       TO DFHEIV11
  9206*    MOVE '&,         G          &   #00008182' TO DFHEIV0
  9207     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9208     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9209     MOVE X'2020233030303038313832' TO DFHEIV0(25:11)
  9210     CALL 'kxdfhei1' USING DFHEIV0,
  9211           PI-ACCT-ID,
  9212           PI-ACCT-KEY,
  9213           DFHEIV99,
  9214           DFHEIV11,
  9215           DFHEIV99
  9216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9217
  9218
  9219     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  9220     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  9221
  9222 6300-EXIT.
  9223     EXIT.
  9224
  9225 6310-READNEXT.
  9226
  9227* EXEC CICS  READNEXT
  9228*        DATASET  (PI-ACCT-ID)
  9229*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9230*        RIDFLD   (PI-ACCT-KEY)
  9231*    END-EXEC.
  9232     MOVE 0
  9233       TO DFHEIV11
  9234*    MOVE '&.S                   )   #00008194' TO DFHEIV0
  9235     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9236     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9237     MOVE X'2020233030303038313934' TO DFHEIV0(25:11)
  9238     CALL 'kxdfhei1' USING DFHEIV0,
  9239           PI-ACCT-ID,
  9240           DFHEIV20,
  9241           DFHEIV99,
  9242           PI-ACCT-KEY,
  9243           DFHEIV99,
  9244           DFHEIV11,
  9245           DFHEIV99,
  9246           DFHEIV99
  9247     SET ADDRESS OF ACCOUNT-MASTER TO
  9248         DFHEIV20
  9249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9250
  9251
  9252 6310-EXIT.
  9253     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 191
* EL650.cbl
  9254
  9255 6320-ENDBR.
  9256     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  9257
  9258
  9259* EXEC CICS  ENDBR
  9260*        DATASET  (PI-ACCT-ID)
  9261*    END-EXEC.
  9262     MOVE 0
  9263       TO DFHEIV11
  9264*    MOVE '&2                    $   #00008206' TO DFHEIV0
  9265     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9266     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9267     MOVE X'2020233030303038323036' TO DFHEIV0(25:11)
  9268     CALL 'kxdfhei1' USING DFHEIV0,
  9269           PI-ACCT-ID,
  9270           DFHEIV11,
  9271           DFHEIV99
  9272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9273
  9274
  9275 6320-EXIT.
  9276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 192
* EL650.cbl
  9278 6400-BUILD-VG-KEY.
  9279     MOVE AM-CONTROL-PRIMARY     TO  AM-CONTROL-BY-VAR-GRP.
  9280
  9281     IF ST-ACCNT-CNTL
  9282         MOVE SPACES             TO  AM-VG-CARRIER
  9283                                     AM-VG-GROUPING.
  9284
  9285     IF CARR-ST-ACCNT-CNTL
  9286         MOVE SPACES             TO  AM-VG-GROUPING.
  9287
  9288     IF ACCNT-CNTL
  9289         MOVE SPACES             TO  AM-VG-CARRIER
  9290                                     AM-VG-STATE
  9291                                     AM-VG-GROUPING.
  9292
  9293     IF CARR-ACCNT-CNTL
  9294         MOVE SPACES             TO  AM-VG-STATE
  9295                                     AM-VG-GROUPING.
  9296
  9297 6499-EXIT.
  9298     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 193
* EL650.cbl
  9300 6500-READ-ACCT.
  9301
  9302* EXEC CICS  HANDLE CONDITION
  9303*        NOTFND  (6599-EXIT)
  9304*    END-EXEC.
  9305*    MOVE '"$I                   ! 7 #00008236' TO DFHEIV0
  9306     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9308     MOVE X'3720233030303038323336' TO DFHEIV0(25:11)
  9309     CALL 'kxdfhei1' USING DFHEIV0
  9310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9311
  9312
  9313     MOVE ZERO                   TO  REC-SW.
  9314
  9315
  9316* EXEC CICS  READ
  9317*        GTEQ
  9318*        DATASET  (ACCT-FILE-ID)
  9319*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9320*        RIDFLD   (PI-ACCT-KEY)
  9321*    END-EXEC.
  9322*    MOVE '&"S        G          (   #00008242' TO DFHEIV0
  9323     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9325     MOVE X'2020233030303038323432' TO DFHEIV0(25:11)
  9326     CALL 'kxdfhei1' USING DFHEIV0,
  9327           ACCT-FILE-ID,
  9328           DFHEIV20,
  9329           DFHEIV99,
  9330           PI-ACCT-KEY,
  9331           DFHEIV99,
  9332           DFHEIV99,
  9333           DFHEIV99
  9334     SET ADDRESS OF ACCOUNT-MASTER TO
  9335         DFHEIV20
  9336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9337
  9338
  9339     MOVE AM-CONTROL-PRIMARY     TO  PI-ACCT-KEY.
  9340     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  9341
  9342     IF PI-ACCT-CCGSA-KEY  = NEW-KEY-SAVE
  9343         MOVE 1                  TO  REC-SW.
  9344
  9345 6599-EXIT.
  9346     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 194
* EL650.cbl
  9348 6600-UPDATE-MAINT-DT.
  9349     MOVE SPACES                 TO  ELCNTL-KEY.
  9350     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9351     MOVE '1'                    TO  CNTL-REC-TYPE.
  9352     MOVE +0                     TO  CNTL-SEQ-NO.
  9353
  9354
  9355* EXEC CICS  HANDLE CONDITION
  9356*        NOTFND  (6699-EXIT)
  9357*    END-EXEC.
  9358*    MOVE '"$I                   ! 8 #00008264' TO DFHEIV0
  9359     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9361     MOVE X'3820233030303038323634' TO DFHEIV0(25:11)
  9362     CALL 'kxdfhei1' USING DFHEIV0
  9363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9364
  9365
  9366
  9367* EXEC CICS  READ
  9368*        UPDATE
  9369*        DATASET  (CNTL-FILE-ID)
  9370*        SET      (ADDRESS OF CONTROL-FILE)
  9371*        RIDFLD   (ELCNTL-KEY)
  9372*    END-EXEC.
  9373*    MOVE '&"S        EU         (   #00008268' TO DFHEIV0
  9374     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9375     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9376     MOVE X'2020233030303038323638' TO DFHEIV0(25:11)
  9377     CALL 'kxdfhei1' USING DFHEIV0,
  9378           CNTL-FILE-ID,
  9379           DFHEIV20,
  9380           DFHEIV99,
  9381           ELCNTL-KEY,
  9382           DFHEIV99,
  9383           DFHEIV99,
  9384           DFHEIV99
  9385     SET ADDRESS OF CONTROL-FILE TO
  9386         DFHEIV20
  9387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9388
  9389
  9390     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9391     MOVE 'B'                    TO  JP-RECORD-TYPE.
  9392     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9393
  9394     PERFORM 8400-LOG-JOURNAL-RECORD.
  9395
  9396     MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.
  9397     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9398     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9399     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9400
  9401
  9402* EXEC CICS  REWRITE
  9403*        DATASET  (CNTL-FILE-ID)
  9404*        FROM     (CONTROL-FILE)
  9405*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 195
* EL650.cbl
  9406     MOVE LENGTH OF
  9407      CONTROL-FILE
  9408       TO DFHEIV11
  9409*    MOVE '&& L                  %   #00008286' TO DFHEIV0
  9410     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9411     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9412     MOVE X'2020233030303038323836' TO DFHEIV0(25:11)
  9413     CALL 'kxdfhei1' USING DFHEIV0,
  9414           CNTL-FILE-ID,
  9415           CONTROL-FILE,
  9416           DFHEIV11,
  9417           DFHEIV99
  9418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9419
  9420
  9421     PERFORM 8400-LOG-JOURNAL-RECORD.
  9422
  9423 6699-EXIT.
  9424     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 196
* EL650.cbl
  9426 6700-VERIFY-STATE-CARRIER.
  9427     IF PI-ACCT-CARRIER  = SPACES
  9428         GO TO 6750-CHECK-STATE.
  9429
  9430     MOVE SPACES                 TO  ELCNTL-KEY.
  9431     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9432     MOVE '6'                    TO  CNTL-REC-TYPE.
  9433     MOVE PI-ACCT-CARRIER        TO  CNTL-CARRIER
  9434     MOVE +0                     TO  CNTL-SEQ-NO.
  9435
  9436
  9437* EXEC CICS  HANDLE CONDITION
  9438*        NOTFND  (6720-NO-CARRIER)
  9439*    END-EXEC.
  9440*    MOVE '"$I                   ! 9 #00008306' TO DFHEIV0
  9441     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9443     MOVE X'3920233030303038333036' TO DFHEIV0(25:11)
  9444     CALL 'kxdfhei1' USING DFHEIV0
  9445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9446
  9447
  9448
  9449* EXEC CICS  READ
  9450*        DATASET  (CNTL-FILE-ID)
  9451*        SET      (ADDRESS OF CONTROL-FILE)
  9452*        RIDFLD   (ELCNTL-KEY)
  9453*    END-EXEC.
  9454*    MOVE '&"S        E          (   #00008310' TO DFHEIV0
  9455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9457     MOVE X'2020233030303038333130' TO DFHEIV0(25:11)
  9458     CALL 'kxdfhei1' USING DFHEIV0,
  9459           CNTL-FILE-ID,
  9460           DFHEIV20,
  9461           DFHEIV99,
  9462           ELCNTL-KEY,
  9463           DFHEIV99,
  9464           DFHEIV99,
  9465           DFHEIV99
  9466     SET ADDRESS OF CONTROL-FILE TO
  9467         DFHEIV20
  9468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9469
  9470
  9471     GO TO 6750-CHECK-STATE.
  9472
  9473 6720-NO-CARRIER.
  9474     MOVE ER-0193                TO  EMI-ERROR.
  9475     MOVE -1                     TO  ACARIERL.
  9476     MOVE AL-UABON               TO  ACARIERA.
  9477
  9478     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9479
  9480 6750-CHECK-STATE.
  9481     IF PI-ACCT-STATE  =  SPACES
  9482         GO TO 6799-EXIT.
  9483
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 197
* EL650.cbl
  9484     MOVE SPACES                 TO  ELCNTL-KEY.
  9485     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9486     MOVE '3'                    TO  CNTL-REC-TYPE.
  9487     MOVE PI-ACCT-STATE          TO  CNTL-STATE.
  9488     MOVE +0                     TO  CNTL-SEQ-NO.
  9489
  9490
  9491* EXEC CICS  HANDLE CONDITION
  9492*        NOTFND  (6780-NO-STATE)
  9493*    END-EXEC.
  9494*    MOVE '"$I                   ! : #00008335' TO DFHEIV0
  9495     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9497     MOVE X'3A20233030303038333335' TO DFHEIV0(25:11)
  9498     CALL 'kxdfhei1' USING DFHEIV0
  9499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9500
  9501
  9502
  9503* EXEC CICS  READ
  9504*        DATASET  (CNTL-FILE-ID)
  9505*        SET      (ADDRESS OF CONTROL-FILE)
  9506*        RIDFLD   (ELCNTL-KEY)
  9507*    END-EXEC.
  9508*    MOVE '&"S        E          (   #00008339' TO DFHEIV0
  9509     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9510     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9511     MOVE X'2020233030303038333339' TO DFHEIV0(25:11)
  9512     CALL 'kxdfhei1' USING DFHEIV0,
  9513           CNTL-FILE-ID,
  9514           DFHEIV20,
  9515           DFHEIV99,
  9516           ELCNTL-KEY,
  9517           DFHEIV99,
  9518           DFHEIV99,
  9519           DFHEIV99
  9520     SET ADDRESS OF CONTROL-FILE TO
  9521         DFHEIV20
  9522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9523
  9524
  9525     GO TO 6799-EXIT.
  9526
  9527 6780-NO-STATE.
  9528     MOVE ER-0144                TO  EMI-ERROR.
  9529     MOVE -1                     TO  ASTATEL.
  9530     MOVE AL-UABON               TO  ASTATEA.
  9531
  9532     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9533
  9534 6799-EXIT.
  9535     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 198
* EL650.cbl
  9537 6800-COMPANY-REC-READ.
  9538     MOVE SPACES                 TO  ELCNTL-KEY.
  9539     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9540     MOVE '1'                    TO  CNTL-REC-TYPE.
  9541     MOVE +0                     TO  CNTL-SEQ-NO.
  9542
  9543
  9544* EXEC CICS  HANDLE CONDITION
  9545*        NOTFND  (6880-NO-COMP)
  9546*    END-EXEC.
  9547*    MOVE '"$I                   ! ; #00008363' TO DFHEIV0
  9548     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9550     MOVE X'3B20233030303038333633' TO DFHEIV0(25:11)
  9551     CALL 'kxdfhei1' USING DFHEIV0
  9552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9553
  9554
  9555
  9556* EXEC CICS  READ
  9557*        DATASET  (CNTL-FILE-ID)
  9558*        SET      (ADDRESS OF CONTROL-FILE)
  9559*        RIDFLD   (ELCNTL-KEY)
  9560*    END-EXEC.
  9561*    MOVE '&"S        E          (   #00008367' TO DFHEIV0
  9562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9564     MOVE X'2020233030303038333637' TO DFHEIV0(25:11)
  9565     CALL 'kxdfhei1' USING DFHEIV0,
  9566           CNTL-FILE-ID,
  9567           DFHEIV20,
  9568           DFHEIV99,
  9569           ELCNTL-KEY,
  9570           DFHEIV99,
  9571           DFHEIV99,
  9572           DFHEIV99
  9573     SET ADDRESS OF CONTROL-FILE TO
  9574         DFHEIV20
  9575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9576
  9577
  9578     IF CF-ACCOUNT-MSTR-MAINT-DT  = LOW-VALUES
  9579         MOVE ER-2572            TO  EMI-ERROR
  9580         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9581
  9582     GO TO 6899-EXIT.
  9583
  9584 6880-NO-COMP.
  9585     MOVE ER-0022                TO  EMI-ERROR.
  9586
  9587     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9588
  9589 6899-EXIT.
  9590     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 199
* EL650.cbl
  9592 7000-BUILD-OUTPUT-MAP.
  9593     IF RETURNING-FROM-6501
  9594         MOVE PI-PREV-VG-ACCOUNT  TO  KEY-SAVE.
  9595
  9596     IF PI-COMPANY-ID  = 'LGX'  OR  'MIC'  OR  'MCC'
  9597         MOVE AL-SANOF           TO  TRNMSG1A
  9598                                     TRNMSG2A
  9599                                     TRNMSG3A
  9600                                     TRNMSG4A.
  9601
  9602     MOVE AL-UANON               TO  ACARIERA
  9603                                     AGROUPA
  9604                                     ASTATEA
  9605                                     AACCTA.
  9606     MOVE SV-CARRIER             TO  ACARIERO.
  9607     MOVE SV-GROUPING            TO  AGROUPO.
  9608     MOVE SV-STATE               TO  ASTATEO.
  9609     MOVE SV-ACCOUNT             TO  AACCTO.
  9610
  9611     SET M-INDEX  TO  1.
  9612
  9613     MOVE LOW-VALUES             TO  MAP-RECORD-AREA.
  9614
  9615     IF PI-MAINT  = 'A'
  9616       AND  PI-RECORD-NOT-CREATED
  9617         MOVE ER-2151            TO  EMI-ERROR
  9618         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9619         GO TO 7000-END.
  9620
  9621     IF PI-FST-PAGE
  9622         SET T-INDEX   TO  1
  9623     ELSE
  9624     IF PI-2ND-PAGE
  9625         SET T-INDEX   TO  9
  9626     ELSE
  9627     IF PI-3RD-PAGE
  9628         SET T-INDEX   TO  17
  9629     ELSE
  9630         SET T-INDEX   TO  25.
  9631
  9632 7000-LOOP.
  9633     IF PI-BIN-EXP-DT (T-INDEX)  NOT = HIGH-VALUES
  9634         MOVE PI-BIN-EXP-DT (T-INDEX)
  9635                                 TO  DC-BIN-DATE-1
  9636         MOVE SPACE              TO  DC-OPTION-CODE
  9637         PERFORM 9700-DATE-CONVERSION
  9638         IF DATE-CONVERSION-ERROR
  9639             MOVE SPACES         TO  MAP-EXP-DT (M-INDEX)
  9640         ELSE
  9641             MOVE DC-GREG-DATE-1-EDIT
  9642                                 TO  MAP-EXP-DT (M-INDEX)
  9643     ELSE
  9644         MOVE 999999             TO  MAP-EXP-DT-ED (M-INDEX)
  9645         INSPECT MAP-EXP-DT-ED (M-INDEX) CONVERTING SPACES TO '/'.
  9646
  9647     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  DC-BIN-DATE-1.
  9648     MOVE SPACE                    TO  DC-OPTION-CODE.
  9649
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 200
* EL650.cbl
  9650     PERFORM 9700-DATE-CONVERSION.
  9651
  9652     IF DATE-CONVERSION-ERROR
  9653         MOVE SPACES               TO  MAP-EFF-DT (M-INDEX)
  9654     ELSE
  9655         MOVE DC-GREG-DATE-1-EDIT  TO  MAP-EFF-DT (M-INDEX).
  9656
  9657     IF PI-BIN-MAINT-DT (T-INDEX)  = LOW-VALUES
  9658         MOVE SPACES             TO  MAP-LST-MAINT-DT (M-INDEX)
  9659     ELSE
  9660         MOVE PI-BIN-MAINT-DT (T-INDEX)
  9661                                 TO  DC-BIN-DATE-1
  9662         MOVE SPACE              TO  DC-OPTION-CODE
  9663         PERFORM 9700-DATE-CONVERSION
  9664         IF DATE-CONVERSION-ERROR
  9665             MOVE SPACES         TO  MAP-LST-MAINT-DT (M-INDEX)
  9666         ELSE
  9667             MOVE DC-GREG-DATE-1-EDIT
  9668                                 TO  MAP-LST-MAINT-DT (M-INDEX).
  9669
  9670     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9671         MOVE SPACES             TO  MAP-HIGH-CERT (M-INDEX)
  9672     ELSE
  9673         MOVE PI-BIN-HI-CERT (T-INDEX)
  9674                                 TO  DC-BIN-DATE-1
  9675         MOVE SPACE              TO  DC-OPTION-CODE
  9676         PERFORM 9700-DATE-CONVERSION
  9677         IF DATE-CONVERSION-ERROR
  9678             MOVE SPACES         TO  MAP-HIGH-CERT (M-INDEX)
  9679         ELSE
  9680             MOVE DC-GREG-DATE-1-EDIT
  9681                                 TO  MAP-HIGH-CERT (M-INDEX).
  9682
  9683     IF PI-BIN-LO-CERT (T-INDEX)  = LOW-VALUES
  9684         MOVE SPACES             TO  MAP-LOW-CERT (M-INDEX)
  9685     ELSE
  9686         MOVE PI-BIN-LO-CERT (T-INDEX)
  9687                                 TO  DC-BIN-DATE-1
  9688         MOVE SPACE              TO  DC-OPTION-CODE
  9689         PERFORM 9700-DATE-CONVERSION
  9690         IF DATE-CONVERSION-ERROR
  9691             MOVE SPACES         TO  MAP-LOW-CERT (M-INDEX)
  9692         ELSE
  9693             MOVE DC-GREG-DATE-1-EDIT
  9694                                 TO  MAP-LOW-CERT (M-INDEX).
  9695
  9696     IF PI-BIN-AR-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  9697         MOVE SPACES             TO  MAP-AR-DATE (M-INDEX)
  9698     ELSE
  9699         MOVE PI-BIN-AR-HI-CERT (T-INDEX)
  9700                                 TO  DC-BIN-DATE-1
  9701         MOVE SPACE              TO  DC-OPTION-CODE
  9702         PERFORM 9700-DATE-CONVERSION
  9703         IF DATE-CONVERSION-ERROR
  9704             MOVE SPACES         TO  MAP-AR-DATE (M-INDEX)
  9705         ELSE
  9706             MOVE DC-GREG-DATE-1-EDIT
  9707                                 TO  MAP-AR-DATE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 201
* EL650.cbl
  9708
  9709     IF M-INDEX  =  8  OR
  9710        T-INDEX  =  PI-TOTAL-LINES
  9711         NEXT SENTENCE
  9712     ELSE
  9713         SET M-INDEX
  9714             T-INDEX  UP  BY  1
  9715         GO TO 7000-LOOP.
  9716
  9717     IF M-INDEX  =  8
  9718       AND  T-INDEX  LESS THAN  PI-TOTAL-LINES
  9719         MOVE ER-0668            TO  EMI-ERROR
  9720         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9721
  9722     IF T-INDEX  =  PI-TOTAL-LINES
  9723         MOVE ER-0630            TO  EMI-ERROR
  9724         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9725
  9726 7000-END.
  9727     MOVE -1                     TO  MAINTL.
  9728     MOVE MAINTI                 TO  PI-MAINT.
  9729
  9730     IF MAINTI  = 'S'  OR  'D'
  9731       OR  RETURNING-FROM-6501
  9732         MOVE LOW-VALUES         TO  MAINTI
  9733         MOVE PI-ACCNAME         TO  NAMEO
  9734         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9735         GO TO 8100-SEND-INITIAL-MAP.
  9736
  9737     IF EIBAID  =  DFHPF1  OR  DFHPF2  OR
  9738                   DFHPF3  OR  DFHPF4
  9739         MOVE 'S'                TO  PI-MAINT
  9740         MOVE PI-ACCNAME         TO  NAMEO
  9741         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9742         GO TO 8100-SEND-INITIAL-MAP.
  9743
  9744     IF MAINTI  = 'N' OR 'E' OR 'X'
  9745        MOVE SPACES                 TO  BIN-EXPCHG-SAVE
  9746                                        BIN-EFFCHG-SAVE
  9747        MOVE SPACES                 TO  EFFCHGI
  9748                                        EXPCHGI
  9749        MOVE AL-UANOF               TO  EFFCHGA
  9750                                        EXPCHGA
  9751        MOVE SPACES                 TO  PI-MAINT
  9752        MOVE SPACES                 TO  MAINTI
  9753                                        MAINTO
  9754        MOVE AL-UANOF               TO  MAINTA.
  9755
  9756     IF K-WITH-LINE-NO
  9757         MOVE ZERO         TO K-WITH-LINE-USED
  9758         GO TO 8100-SEND-INITIAL-MAP.
  9759
  9760     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 202
* EL650.cbl
  9762 7100-START-BROWSE.
  9763
  9764* EXEC CICS  STARTBR
  9765*        DATASET  (PI-ACCT-ID)
  9766*        RIDFLD   (PI-ACCT-KEY)
  9767*    END-EXEC.
  9768     MOVE 0
  9769       TO DFHEIV11
  9770*    MOVE '&,         G          &   #00008558' TO DFHEIV0
  9771     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9772     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9773     MOVE X'2020233030303038353538' TO DFHEIV0(25:11)
  9774     CALL 'kxdfhei1' USING DFHEIV0,
  9775           PI-ACCT-ID,
  9776           PI-ACCT-KEY,
  9777           DFHEIV99,
  9778           DFHEIV11,
  9779           DFHEIV99
  9780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9781
  9782
  9783 7100-EXIT.
  9784     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 203
* EL650.cbl
  9786 7200-WRITE-TEMP-STORAGE.
  9787     PERFORM 7300-DELETE-TEMP-STORAGE  THRU  7300-EXIT.
  9788
  9789
  9790* EXEC CICS  HANDLE CONDITION
  9791*        ITEMERR  (7200-EXIT)
  9792*        QIDERR   (7200-EXIT)
  9793*    END-EXEC.
  9794*    MOVE '"$<N                  ! < #00008569' TO DFHEIV0
  9795     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9796     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9797     MOVE X'3C20233030303038353639' TO DFHEIV0(25:11)
  9798     CALL 'kxdfhei1' USING DFHEIV0
  9799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9800
  9801
  9802     MOVE +0                     TO  TS-ITEM.
  9803
  9804
  9805* EXEC CICS  WRITEQ TS
  9806*        QUEUE   (TS-QUEUE)
  9807*        FROM    (TEMP-STORAGE-RECORD)
  9808*        LENGTH  (TS-LENGTH)
  9809*        ITEM    (TS-ITEM)
  9810*    END-EXEC.
  9811*    MOVE '*" I                  ''   #00008576' TO DFHEIV0
  9812     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  9813     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9814     MOVE X'2020233030303038353736' TO DFHEIV0(25:11)
  9815     CALL 'kxdfhei1' USING DFHEIV0,
  9816           TS-QUEUE,
  9817           TEMP-STORAGE-RECORD,
  9818           TS-LENGTH,
  9819           TS-ITEM,
  9820           DFHEIV99,
  9821           DFHEIV99
  9822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9823
  9824
  9825 7200-EXIT.
  9826     EXIT.
  9827
  9828 7300-DELETE-TEMP-STORAGE.
  9829
  9830* EXEC CICS  HANDLE CONDITION
  9831*        ITEMERR  (7300-EXIT)
  9832*        QIDERR   (7300-EXIT)
  9833*    END-EXEC.
  9834*    MOVE '"$<N                  ! = #00008587' TO DFHEIV0
  9835     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9837     MOVE X'3D20233030303038353837' TO DFHEIV0(25:11)
  9838     CALL 'kxdfhei1' USING DFHEIV0
  9839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9840
  9841
  9842
  9843* EXEC CICS  DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 204
* EL650.cbl
  9844*        QUEUE  (TS-QUEUE)
  9845*    END-EXEC.
  9846*    MOVE '*&                    #   #00008592' TO DFHEIV0
  9847     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9848     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9849     MOVE X'2020233030303038353932' TO DFHEIV0(25:11)
  9850     CALL 'kxdfhei1' USING DFHEIV0,
  9851           TS-QUEUE,
  9852           DFHEIV99
  9853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9854
  9855
  9856 7300-EXIT.
  9857     EXIT.
  9858
  9859 7400-READ-TEMP-STORAGE.
  9860
  9861* EXEC CICS  HANDLE CONDITION
  9862*        ITEMERR  (7400-EXIT)
  9863*        QIDERR   (7400-EXIT)
  9864*    END-EXEC.
  9865*    MOVE '"$<N                  ! > #00008600' TO DFHEIV0
  9866     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9868     MOVE X'3E20233030303038363030' TO DFHEIV0(25:11)
  9869     CALL 'kxdfhei1' USING DFHEIV0
  9870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9871
  9872
  9873     MOVE +1                     TO  TS-ITEM.
  9874
  9875
  9876* EXEC CICS  READQ TS
  9877*        QUEUE   (TS-QUEUE)
  9878*        INTO    (TEMP-STORAGE-RECORD)
  9879*        LENGTH  (TS-LENGTH)
  9880*        ITEM    (TS-ITEM)
  9881*    END-EXEC.
  9882*    MOVE '*$II   L              ''   #00008607' TO DFHEIV0
  9883     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9885     MOVE X'2020233030303038363037' TO DFHEIV0(25:11)
  9886     CALL 'kxdfhei1' USING DFHEIV0,
  9887           TS-QUEUE,
  9888           TEMP-STORAGE-RECORD,
  9889           TS-LENGTH,
  9890           TS-ITEM,
  9891           DFHEIV99,
  9892           DFHEIV99
  9893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9894
  9895
  9896 7400-EXIT.
  9897     EXIT.
  9898
  9899 8100-SEND-INITIAL-MAP.
  9900     MOVE SAVE-DATE              TO  DATEO.
  9901     MOVE EIBTIME                TO  TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 205
* EL650.cbl
  9902     MOVE TIME-OUT               TO  TIMEO.
  9903     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9904     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9905     MOVE -1                     TO  MAINTL.
  9906     MOVE AL-UABON               TO  MAINTA.
  9907     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9908     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9909
  9910     IF PI-AR-PROCESSING
  9911        MOVE AL-PANOF            TO  ARHDGA.
  9912
  9913
  9914* EXEC CICS  SEND
  9915*        MAP     (MAP-NAME)
  9916*        MAPSET  (MAPSET-NAME)
  9917*        FROM    (EL650AO)
  9918*        ERASE
  9919*        CURSOR
  9920*    END-EXEC.
  9921     MOVE LENGTH OF
  9922      EL650AO
  9923       TO DFHEIV12
  9924     MOVE -1
  9925       TO DFHEIV11
  9926*    MOVE '8$     CT  E    H L F ,   #00008631' TO DFHEIV0
  9927     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9928     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9929     MOVE X'2020233030303038363331' TO DFHEIV0(25:11)
  9930     CALL 'kxdfhei1' USING DFHEIV0,
  9931           MAP-NAME,
  9932           EL650AO,
  9933           DFHEIV12,
  9934           MAPSET-NAME,
  9935           DFHEIV99,
  9936           DFHEIV99,
  9937           DFHEIV99,
  9938           DFHEIV11,
  9939           DFHEIV99,
  9940           DFHEIV99,
  9941           DFHEIV99
  9942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9943
  9944
  9945     GO TO 9100-RETURN-TRAN.
  9946
  9947 8200-SEND-DATAONLY.
  9948     MOVE SAVE-DATE              TO  DATEO.
  9949     MOVE EIBTIME                TO  TIME-IN.
  9950     MOVE TIME-OUT               TO  TIMEO.
  9951     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9952     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9953     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9954     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9955
  9956
  9957* EXEC CICS  SEND
  9958*        MAP     (MAP-NAME)
  9959*        MAPSET  (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 206
* EL650.cbl
  9960*        FROM    (EL650AO)
  9961*        DATAONLY
  9962*        CURSOR
  9963*    END-EXEC.
  9964     MOVE LENGTH OF
  9965      EL650AO
  9966       TO DFHEIV12
  9967     MOVE -1
  9968       TO DFHEIV11
  9969*    MOVE '8$D    CT       H L F ,   #00008650' TO DFHEIV0
  9970     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9971     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9972     MOVE X'2020233030303038363530' TO DFHEIV0(25:11)
  9973     CALL 'kxdfhei1' USING DFHEIV0,
  9974           MAP-NAME,
  9975           EL650AO,
  9976           DFHEIV12,
  9977           MAPSET-NAME,
  9978           DFHEIV99,
  9979           DFHEIV99,
  9980           DFHEIV99,
  9981           DFHEIV11,
  9982           DFHEIV99,
  9983           DFHEIV99,
  9984           DFHEIV99
  9985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9986
  9987
  9988     GO TO 9100-RETURN-TRAN.
  9989
  9990 8300-SEND-TEXT.
  9991
  9992* EXEC CICS  SEND TEXT
  9993*        FROM    (LOGOFF-TEXT)
  9994*        LENGTH  (LOGOFF-LENGTH)
  9995*        ERASE
  9996*        FREEKB
  9997*    END-EXEC.
  9998*    MOVE '8&      T  E F  H   F -   #00008661' TO DFHEIV0
  9999     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10000     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10001     MOVE X'2020233030303038363631' TO DFHEIV0(25:11)
 10002     CALL 'kxdfhei1' USING DFHEIV0,
 10003           LOGOFF-TEXT,
 10004           LOGOFF-LENGTH,
 10005           DFHEIV99,
 10006           DFHEIV99,
 10007           DFHEIV99,
 10008           DFHEIV99,
 10009           DFHEIV99,
 10010           DFHEIV99,
 10011           DFHEIV99,
 10012           DFHEIV99,
 10013           DFHEIV99,
 10014           DFHEIV99
 10015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10016
 10017
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 207
* EL650.cbl
 10018
 10019* EXEC CICS  RETURN
 10020*    END-EXEC.
 10021*    MOVE '.(                    ''   #00008668' TO DFHEIV0
 10022     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10023     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10024     MOVE X'2020233030303038363638' TO DFHEIV0(25:11)
 10025     CALL 'kxdfhei1' USING DFHEIV0,
 10026           DFHEIV99,
 10027           DFHEIV99,
 10028           DFHEIV99,
 10029           DFHEIV99,
 10030           DFHEIV99,
 10031           DFHEIV99
 10032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10033
 10034
 10035 8400-LOG-JOURNAL-RECORD.
 10036*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
 10037*    MOVE FILE-ID                TO  JP-FILE-ID.
 10038*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
 10039*
 10040*    IF PI-JOURNAL-FILE-ID  NOT =  ZERO
 10041*        EXEC CICS  JOURNAL
 10042*            JFILEID  (PI-JOURNAL-FILE-ID)
 10043*            JTYPEID  ('ER')
 10044*            FROM     (JOURNAL-RECORD)
 10045*            LENGTH   (2023)
 10046*        END-EXEC.
 10047
 10048 8600-DEEDIT.
 10049
 10050* EXEC CICS  BIF DEEDIT
 10051*        FIELD   (WS-DEEDIT-FIELD)
 10052*        LENGTH  (10)
 10053*    END-EXEC.
 10054     MOVE 10
 10055       TO DFHEIV11
 10056*    MOVE '@"L                   #   #00008685' TO DFHEIV0
 10057     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10059     MOVE X'2020233030303038363835' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0,
 10061           WS-DEEDIT-FIELD,
 10062           DFHEIV11
 10063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10064
 10065 8600-EXIT.
 10066      EXIT.
 10067 8800-UNAUTHORIZED-ACCESS.
 10068     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10069
 10070     GO TO 8300-SEND-TEXT.
 10071
 10072 8810-PF23.
 10073     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10074     MOVE XCTL-005               TO  PGM-NAME.
 10075
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 208
* EL650.cbl
 10076     GO TO 9300-XCTL.
 10077
 10078 8900-PF5.
 10079     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10080         MOVE ER-3785            TO  EMI-ERROR
 10081         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 10082         MOVE -1                 TO  MAINTL
 10083         GO TO 8200-SEND-DATAONLY.
 10084
 10085     MOVE PI-PREV-VG-ACCOUNT     TO  PI-ACCT-CCGSA-KEY.
 10086
 10087     MOVE XCTL-6509              TO  PGM-NAME.
 10088
 10089     GO TO 9300-XCTL.
 10090
 10091 8910-PF6.
 10092     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10093        MOVE ER-3785             TO EMI-ERROR
 10094        PERFORM 9900-ERROR-FORMAT
 10095                                 THRU 9900-EXIT
 10096        MOVE -1                  TO MAINTL
 10097        GO TO 8200-SEND-DATAONLY
 10098     END-IF
 10099     MOVE PI-PREV-VG-ACCOUNT     TO PI-ACCT-CCGSA-KEY
 10100     MOVE XCTL-6503              TO PGM-NAME
 10101     GO TO 9300-XCTL
 10102     .
 10103 9100-RETURN-TRAN.
 10104     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10105     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10106
 10107* EXEC CICS  RETURN
 10108*        TRANSID   (TRANS-ID)
 10109*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10110*        LENGTH    (WS-COMM-LENGTH)
 10111*    END-EXEC.
 10112*    MOVE '.(CT                  ''   #00008730' TO DFHEIV0
 10113     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10114     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10115     MOVE X'2020233030303038373330' TO DFHEIV0(25:11)
 10116     CALL 'kxdfhei1' USING DFHEIV0,
 10117           TRANS-ID,
 10118           PROGRAM-INTERFACE-BLOCK,
 10119           WS-COMM-LENGTH,
 10120           DFHEIV99,
 10121           DFHEIV99,
 10122           DFHEIV99
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
 10126 9200-RETURN-MAIN-MENU.
 10127     MOVE XCTL-126               TO  PGM-NAME.
 10128
 10129     GO TO 9300-XCTL.
 10130
 10131 9300-XCTL.
 10132
 10133* EXEC CICS  XCTL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 209
* EL650.cbl
 10134*        PROGRAM   (PGM-NAME)
 10135*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10136*        LENGTH    (WS-COMM-LENGTH)
 10137*    END-EXEC.
 10138*    MOVE '.$C                   %   #00008742' TO DFHEIV0
 10139     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10141     MOVE X'2020233030303038373432' TO DFHEIV0(25:11)
 10142     CALL 'kxdfhei1' USING DFHEIV0,
 10143           PGM-NAME,
 10144           PROGRAM-INTERFACE-BLOCK,
 10145           WS-COMM-LENGTH,
 10146           DFHEIV99
 10147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10148
 10149
 10150 9400-CLEAR.
 10151     MOVE SPACES                 TO  PI-SV-MAINT.
 10152     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10153
 10154     GO TO 9300-XCTL.
 10155
 10156 9500-PF12.
 10157     MOVE XCTL-010               TO  PGM-NAME.
 10158
 10159     GO TO 9300-XCTL.
 10160
 10161 9600-PGMID-ERROR.
 10162
 10163* EXEC CICS  HANDLE CONDITION
 10164*        PGMIDERR  (8300-SEND-TEXT)
 10165*    END-EXEC.
 10166*    MOVE '"$L                   ! ? #00008760' TO DFHEIV0
 10167     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10169     MOVE X'3F20233030303038373630' TO DFHEIV0(25:11)
 10170     CALL 'kxdfhei1' USING DFHEIV0
 10171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10172
 10173
 10174     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10175     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10176     MOVE XCTL-005               TO  PGM-NAME.
 10177     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10178     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10179
 10180     GO TO 9300-XCTL.
 10181
 10182 9700-DATE-CONVERSION.
 10183     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10184
 10185
 10186* EXEC CICS  LINK
 10187*        PROGRAM   (PGM-NAME)
 10188*        COMMAREA  (DATE-CONVERSION-DATA)
 10189*        LENGTH    (DC-COMM-LENGTH)
 10190*    END-EXEC.
 10191*    MOVE '."C                   (   #00008775' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 210
* EL650.cbl
 10192     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10194     MOVE X'2020233030303038373735' TO DFHEIV0(25:11)
 10195     CALL 'kxdfhei1' USING DFHEIV0,
 10196           PGM-NAME,
 10197           DATE-CONVERSION-DATA,
 10198           DC-COMM-LENGTH,
 10199           DFHEIV99,
 10200           DFHEIV99,
 10201           DFHEIV99,
 10202           DFHEIV99
 10203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10204
 10205
 10206 9900-ERROR-FORMAT.
 10207     IF NOT EMI-ERRORS-COMPLETE
 10208         MOVE LINK-001           TO  PGM-NAME
 10209
 10210* EXEC CICS  LINK
 10211*            PROGRAM   (PGM-NAME)
 10212*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10213*            LENGTH    (EMI-COMM-LENGTH)
 10214*        END-EXEC.
 10215*    MOVE '."C                   (   #00008784' TO DFHEIV0
 10216     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10217     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10218     MOVE X'2020233030303038373834' TO DFHEIV0(25:11)
 10219     CALL 'kxdfhei1' USING DFHEIV0,
 10220           PGM-NAME,
 10221           ERROR-MESSAGE-INTERFACE-BLOCK,
 10222           EMI-COMM-LENGTH,
 10223           DFHEIV99,
 10224           DFHEIV99,
 10225           DFHEIV99,
 10226           DFHEIV99
 10227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10228
 10229
 10230 9900-EXIT.
 10231     EXIT.
 10232
 10233 9990-ABEND.
 10234     MOVE LINK-004               TO  PGM-NAME.
 10235     MOVE DFHEIBLK               TO  EMI-LINE1.
 10236
 10237
 10238* EXEC CICS  LINK
 10239*        PROGRAM   (PGM-NAME)
 10240*        COMMAREA  (EMI-LINE1)
 10241*        LENGTH    (72)
 10242*    END-EXEC.
 10243     MOVE 72
 10244       TO DFHEIV11
 10245*    MOVE '."C                   (   #00008797' TO DFHEIV0
 10246     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10248     MOVE X'2020233030303038373937' TO DFHEIV0(25:11)
 10249     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 211
* EL650.cbl
 10250           PGM-NAME,
 10251           EMI-LINE1,
 10252           DFHEIV11,
 10253           DFHEIV99,
 10254           DFHEIV99,
 10255           DFHEIV99,
 10256           DFHEIV99
 10257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10258
 10259
 10260     MOVE -1                     TO  MAINTL.
 10261
 10262     GO TO 8200-SEND-DATAONLY.
 10263
 10264 9995-SECURITY-VIOLATION.
 10265*                            COPY ELCSCTP.
 10266******************************************************************
 10267*                                                                *
 10268*                            ELCSCTP                             *
 10269*                            VMOD=2.001                          *
 10270*                                                                *
 10271*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10272******************************************************************
 10273
 10274
 10275     MOVE EIBDATE          TO SM-JUL-DATE.
 10276     MOVE EIBTRMID         TO SM-TERMID.
 10277     MOVE THIS-PGM         TO SM-PGM.
 10278     MOVE EIBTIME          TO TIME-IN.
 10279     MOVE TIME-OUT         TO SM-TIME.
 10280     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10281
 10282
 10283* EXEC CICS LINK
 10284*         PROGRAM  ('EL003')
 10285*         COMMAREA (SECURITY-MESSAGE)
 10286*         LENGTH   (80)
 10287*    END-EXEC.
 10288     MOVE 'EL003' TO DFHEIV1
 10289     MOVE 80
 10290       TO DFHEIV11
 10291*    MOVE '."C                   (   #00008825' TO DFHEIV0
 10292     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10293     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10294     MOVE X'2020233030303038383235' TO DFHEIV0(25:11)
 10295     CALL 'kxdfhei1' USING DFHEIV0,
 10296           DFHEIV1,
 10297           SECURITY-MESSAGE,
 10298           DFHEIV11,
 10299           DFHEIV99,
 10300           DFHEIV99,
 10301           DFHEIV99,
 10302           DFHEIV99
 10303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10304
 10305
 10306******************************************************************
 10307
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 212
* EL650.cbl
 10308
 10309 9995-EXIT.
 10310     EXIT.
 10311
 10312 9999-DFHBACK SECTION.
 10313     MOVE '9%                    "   ' TO DFHEIV0
 10314     MOVE 'EL650' TO DFHEIV1
 10315     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10316     GOBACK.
 10317 9999-DFHEXIT.
 10318     IF DFHEIGDJ EQUAL 0001
 10319         NEXT SENTENCE
 10320     ELSE IF DFHEIGDJ EQUAL 2
 10321         GO TO 5340-END,
 10322               5330-NOT-FOUND
 10323         DEPENDING ON DFHEIGDI
 10324     ELSE IF DFHEIGDJ EQUAL 3
 10325         GO TO 9600-PGMID-ERROR,
 10326               9990-ABEND
 10327         DEPENDING ON DFHEIGDI
 10328     ELSE IF DFHEIGDJ EQUAL 4
 10329         GO TO 1010-NOT-FOUND,
 10330               1010-NOT-FOUND
 10331         DEPENDING ON DFHEIGDI
 10332     ELSE IF DFHEIGDJ EQUAL 5
 10333         GO TO 2568-NO-RECORDS,
 10334               2568-NO-RECORDS
 10335         DEPENDING ON DFHEIGDI
 10336     ELSE IF DFHEIGDJ EQUAL 6
 10337         GO TO 3175-CONTINUE,
 10338               3175-CONTINUE
 10339         DEPENDING ON DFHEIGDI
 10340     ELSE IF DFHEIGDJ EQUAL 7
 10341         GO TO 4175-CONTINUE,
 10342               4175-CONTINUE
 10343         DEPENDING ON DFHEIGDI
 10344     ELSE IF DFHEIGDJ EQUAL 8
 10345         GO TO 4530-NOT-FOUND,
 10346               4530-NOT-FOUND
 10347         DEPENDING ON DFHEIGDI
 10348     ELSE IF DFHEIGDJ EQUAL 9
 10349         GO TO 4699-EXIT,
 10350               4689-EOF
 10351         DEPENDING ON DFHEIGDI
 10352     ELSE IF DFHEIGDJ EQUAL 10
 10353         GO TO 4899-EXIT,
 10354               4889-EOF
 10355         DEPENDING ON DFHEIGDI
 10356     ELSE IF DFHEIGDJ EQUAL 11
 10357         GO TO 4580-DUPREC,
 10358               4580-DUPREC
 10359         DEPENDING ON DFHEIGDI
 10360     ELSE IF DFHEIGDJ EQUAL 12
 10361         GO TO 4959-EXIT,
 10362               4959-EXIT
 10363         DEPENDING ON DFHEIGDI
 10364     ELSE IF DFHEIGDJ EQUAL 13
 10365         GO TO 4969-EXIT,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 213
* EL650.cbl
 10366               4969-EXIT
 10367         DEPENDING ON DFHEIGDI
 10368     ELSE IF DFHEIGDJ EQUAL 14
 10369         GO TO 4980-EXIT
 10370         DEPENDING ON DFHEIGDI
 10371     ELSE IF DFHEIGDJ EQUAL 15
 10372         GO TO 5007-EXIT,
 10373               5007-EXIT
 10374         DEPENDING ON DFHEIGDI
 10375     ELSE IF DFHEIGDJ EQUAL 16
 10376         GO TO 5007-EXIT,
 10377               5007-EXIT,
 10378               5007-EXIT,
 10379               5007-EXIT,
 10380               5007-EXIT
 10381         DEPENDING ON DFHEIGDI
 10382     ELSE IF DFHEIGDJ EQUAL 17
 10383         GO TO 5015-NOT-FOUND,
 10384               5015-NOT-FOUND
 10385         DEPENDING ON DFHEIGDI
 10386     ELSE IF DFHEIGDJ EQUAL 18
 10387         GO TO 5015-NOT-FOUND,
 10388               5015-NOT-FOUND
 10389         DEPENDING ON DFHEIGDI
 10390     ELSE IF DFHEIGDJ EQUAL 19
 10391         GO TO 5340-END,
 10392               5330-NOT-FOUND
 10393         DEPENDING ON DFHEIGDI
 10394     ELSE IF DFHEIGDJ EQUAL 20
 10395         GO TO 5440-NOT-FOUND,
 10396               5430-NOT-FOUND
 10397         DEPENDING ON DFHEIGDI
 10398     ELSE IF DFHEIGDJ EQUAL 21
 10399         GO TO 5525-SKIP-REWRITE,
 10400               5525-SKIP-REWRITE
 10401         DEPENDING ON DFHEIGDI
 10402     ELSE IF DFHEIGDJ EQUAL 22
 10403         GO TO 5615-SKIP-REWRITE,
 10404               5615-SKIP-REWRITE
 10405         DEPENDING ON DFHEIGDI
 10406     ELSE IF DFHEIGDJ EQUAL 23
 10407         GO TO 6599-EXIT
 10408         DEPENDING ON DFHEIGDI
 10409     ELSE IF DFHEIGDJ EQUAL 24
 10410         GO TO 6699-EXIT
 10411         DEPENDING ON DFHEIGDI
 10412     ELSE IF DFHEIGDJ EQUAL 25
 10413         GO TO 6720-NO-CARRIER
 10414         DEPENDING ON DFHEIGDI
 10415     ELSE IF DFHEIGDJ EQUAL 26
 10416         GO TO 6780-NO-STATE
 10417         DEPENDING ON DFHEIGDI
 10418     ELSE IF DFHEIGDJ EQUAL 27
 10419         GO TO 6880-NO-COMP
 10420         DEPENDING ON DFHEIGDI
 10421     ELSE IF DFHEIGDJ EQUAL 28
 10422         GO TO 7200-EXIT,
 10423               7200-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 214
* EL650.cbl
 10424         DEPENDING ON DFHEIGDI
 10425     ELSE IF DFHEIGDJ EQUAL 29
 10426         GO TO 7300-EXIT,
 10427               7300-EXIT
 10428         DEPENDING ON DFHEIGDI
 10429     ELSE IF DFHEIGDJ EQUAL 30
 10430         GO TO 7400-EXIT,
 10431               7400-EXIT
 10432         DEPENDING ON DFHEIGDI
 10433     ELSE IF DFHEIGDJ EQUAL 31
 10434         GO TO 8300-SEND-TEXT
 10435         DEPENDING ON DFHEIGDI.
 10436     MOVE '9%                    "   ' TO DFHEIV0
 10437     MOVE 'EL650' TO DFHEIV1
 10438     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10439     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40228     Code:       34374
