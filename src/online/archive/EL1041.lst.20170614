* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   1
* EL1041.cbl
* Options: int("EL1041.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1041.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1041.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1041.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1041.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   2
* EL1041.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS
    19*    SCREENS     - EL104Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31*-----------------------------------------------------------------
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 041513    2013011500003  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    40* 092413    2013062000003  AJRA  ADD BARCODE IND (USE ZREC COPYBOO
    41* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    42*-----------------------------------------------------------------
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*   EL1041 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    50 77  M1                          PIC S999 COMP-3 VALUE +0.
    51 77  M2                          PIC S999 COMP-3 VALUE +0.
    52 77  WS-STOP-SW                  PIC X  VALUE ' '.
    53     88  I-SAY-TO-STOP              VALUE 'Y'.
    54 77  WS-FIND-SW                  PIC X  VALUE ' '.
    55     88  WE-FOUND-IT                VALUE 'Y'.
    56 77  WS-DONE-WITH-ENCC           PIC X  VALUE ' '.
    57     88  DONE-WITH-ENCC             VALUE 'Y'.
    58 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    59 01  ACCESS-KEYS.
    60     12  ELLETR-KEY.
    61         16  ELLETR-COMPANY-CD   PIC X.
    62         16  ELLETR-ACCESS-CD    PIC X(12).
    63         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    64
    65     12  ELENCC-KEY.
    66         16  ELENCC-COMPANY-CD    PIC X.
    67         16  ELENCC-REC-TYPE      PIC X.
    68         16  ELENCC-ENC-CODE      PIC X(5).
    69         16  F                    PIC X(09).
    70 01  WS-DATE-AREA.
    71     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   3
* EL1041.cbl
    72     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    73 01  MISC-WORK-AREAS.
    74     12  WS-RESPONSE             PIC S9(8)   COMP.
    75         88  RESP-NORMAL              VALUE +00.
    76         88  RESP-ERROR               VALUE +01.
    77         88  RESP-NOTFND              VALUE +13.
    78         88  RESP-NOTOPEN             VALUE +19.
    79         88  RESP-ENDFILE             VALUE +20.
    80     12  WS-NUMVAL.
    81         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    82         16  WS-9V999-OF-DEEDIT REDEFINES
    83             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    84     12  DEEDIT-FIELD                PIC X(11).
    85     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    86                                     PIC S9(11).
    87     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    88                                     PIC S9(09)V99.
    89
    90     12  WS-TEST-STATE               PIC X(2) VALUE SPACES.
    91         88 STATE-SPECIFIC    VALUES 'AK','AL','AR','AS','AZ',
    92            'CA','CO','CT','DC','DE','FL','GA','GU','HI','IA',
    93            'ID','IL','IN','KS','KY','LA','MA','MD','ME','MI',
    94            'MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM',
    95            'NV','NY','OH','OK','OR','PA','PR','RI','SC','SD',
    96            'TN','TX','UT','VA','VI','VT','WA','WI','WV','WY'.
    97 01  STANDARD-AREAS.
    98     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    99     12  TRANS-ID                    PIC X(04)   VALUE 'EX1E'.
   100     12  PGM-NAME                    PIC X(08).
   101     12  TIME-IN                     PIC S9(07).
   102     12  TIME-OUT-R  REDEFINES TIME-IN.
   103         16  FILLER                  PIC X(01).
   104         16  TIME-OUT                PIC 99V99.
   105         16  FILLER                  PIC X(02).
   106     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
   107     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
   108     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
   109     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
   110     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
   111     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
   112     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
   113     12  THIS-PGM                    PIC X(08)   VALUE 'EL1041'.
   114     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   115     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   116     12  ELENCC-FILE-ID              PIC X(08)   VALUE 'ELENCC'.
   117     12  ELENCC-LENGTH               PIC S9(04)  VALUE +400  COMP.
   118     12  SUB                         PIC 9(02).
   119     12  SUB-1                       PIC 9(02).
   120     12  SUB2                        PIC 9(02).
   121     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   122     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1041S'.
   123     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL104Z'.
   124     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   125     12  HOLD-ENC-CODES              PIC X(120)  VALUE SPACES.
   126     12  WS-SUB1                     PIC S9(03).
   127     12  WS-SUB2                     PIC S9(03).
   128     12  WS-SUB3                     PIC S9(03).
   129****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   4
* EL1041.cbl
   130*                                    COPY ELCZREC.
   131******************************************************************
   132*                                                                *
   133*                                                                *
   134*                            ELCZREC.                            *
   135*                                                                *
   136*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   137*                                                                *
   138******************************************************************
   139*-----------------------------------------------------------------
   140*                   C H A N G E   L O G
   141*
   142* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   143*-----------------------------------------------------------------
   144*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   145* EFFECTIVE    NUMBER
   146*-----------------------------------------------------------------
   147* 122011    2011022800001  AJRA  NEW FILE
   148* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   149* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   150* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   151* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   152*-----------------------------------------------------------------
   153 01  W-Z-CONTROL-DATA.
   154     05  W-NUMBER-OF-COPIES      PIC  9.
   155     05  FILLER                  PIC  X.
   156     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   157     05  FILLER                  PIC  X.
   158     05  W-DAYS-TO-RESEND        PIC  999.
   159     05  FILLER                  PIC  X.
   160     05  W-FORM-TO-RESEND        PIC  X(4).
   161     05  W-ADD-BAR-CODE          PIC  X.
   162     05  W-PROMPT-LETTER         PIC  X.
   163     05  W-HAS-RETURN-ENV        PIC  X.
   164     05  W-ENCLOSURE-CD          PIC  XXX.
   165     05  W-SIG-FLAG-DEFAULT      PIC  X.
   166     05  W-AUTO-CLOSE-IND        PIC  X.
   167     05  FILLER                  PIC  X.
   168     05  W-LETTER-TO-BENE        PIC  X.
   169     05  FILLER                  PIC  X.
   170     05  W-LETTER-TO-ACCT        PIC  X.
   171     05  FILLER                  PIC  X.
   172     05  W-LETTER-TYPE           PIC  X.
   173     05  FILLER                  PIC  X.
   174     05  W-PRINT-CERTIFICATE     PIC  X.
   175     05  FILLER                  PIC  X.
   176     05  W-REFUND-REQUIRED       PIC  X.
   177     05  FILLER                  PIC  X.
   178     05  W-ONBASE-CODE           PIC  XX.
   179     05  FILLER                  PIC  X.
   180     05  W-ACCT-SUMM             PIC  X.
   181     05  FILLER                  PIC  X.
   182     05  W-CSO-SUMM              PIC  X.
   183     05  FILLER                  PIC  X.
   184     05  W-REASONS-REQUIRED      PIC  X.
   185     05  FILLER                  PIC  X(29).
   186*                                    COPY ELCSCTM.
   187******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   5
* EL1041.cbl
   188*                                                                *
   189*                                                                *
   190*                            ELCSCTM                             *
   191*                            VMOD=2.001                          *
   192*                                                                *
   193*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   194*                                                                *
   195******************************************************************
   196 01  SECURITY-MESSAGE.
   197     12  FILLER                          PIC X(30)
   198            VALUE '** LOGIC SECURITY VIOLATION -'.
   199     12  SM-READ                         PIC X(6).
   200     12  FILLER                          PIC X(5)
   201            VALUE ' PGM='.
   202     12  SM-PGM                          PIC X(6).
   203     12  FILLER                          PIC X(5)
   204            VALUE ' OPR='.
   205     12  SM-PROCESSOR-ID                 PIC X(4).
   206     12  FILLER                          PIC X(6)
   207            VALUE ' TERM='.
   208     12  SM-TERMID                       PIC X(4).
   209     12  FILLER                          PIC XX   VALUE SPACE.
   210     12  SM-JUL-DATE                     PIC 9(5).
   211     12  FILLER                          PIC X    VALUE SPACE.
   212     12  SM-TIME                         PIC 99.99.
   213
   214*                                    COPY ELCSCRTY.
   215******************************************************************
   216*                                                                *
   217*                                                                *
   218*                            ELCSCRTY                            *
   219*                            VMOD=2.001                          *
   220*                                                                *
   221*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   222*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   223*        SAVED IN PI-SECURITY-ADDRESS.                           *
   224*                                                                *
   225******************************************************************
   226 01  SECURITY-CONTROL.
   227     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   228     12  FILLER                       PIC XX    VALUE 'SC'.
   229     12  SC-CREDIT-CODES.
   230         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   231             20  SC-CREDIT-DISPLAY    PIC X.
   232             20  SC-CREDIT-UPDATE     PIC X.
   233     12  SC-CLAIMS-CODES.
   234         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   235             20  SC-CLAIMS-DISPLAY    PIC X.
   236             20  SC-CLAIMS-UPDATE     PIC X.
   237 01  ERROR-MESSAGES.
   238     12  ER-0000                     PIC X(04)   VALUE '0000'.
   239     12  ER-0005                     PIC X(04)   VALUE '0005'.
   240     12  ER-0023                     PIC X(04)   VALUE '0023'.
   241     12  ER-0029                     PIC X(04)   VALUE '0029'.
   242     12  ER-0050                     PIC X(04)   VALUE '0050'.
   243     12  ER-0068                     PIC X(04)   VALUE '0068'.
   244     12  ER-0070                     PIC X(04)   VALUE '0070'.
   245     12  ER-0130                     PIC X(04)   VALUE '0130'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   6
* EL1041.cbl
   246     12  ER-0131                     PIC X(04)   VALUE '0131'.
   247     12  ER-0132                     PIC X(04)   VALUE '0132'.
   248     12  ER-0138                     PIC X(04)   VALUE '0138'.
   249     12  ER-0144                     PIC X(04)   VALUE '0144'.
   250     12  ER-0145                     PIC X(04)   VALUE '0145'.
   251     12  ER-0184                     PIC X(04)   VALUE '0184'.
   252     12  ER-0418                     PIC X(04)   VALUE '0418'.
   253     12  ER-0491                     PIC X(04)   VALUE '0491'.
   254     12  ER-0582                     PIC X(04)   VALUE '0582'.
   255     12  ER-0627                     PIC X(04)   VALUE '0627'.
   256     12  ER-0701                     PIC X(04)   VALUE '0701'.
   257     12  ER-0702                     PIC X(04)   VALUE '0702'.
   258     12  ER-0703                     PIC X(04)   VALUE '0703'.
   259     12  ER-0704                     PIC X(04)   VALUE '0704'.
   260     12  ER-0705                     PIC X(04)   VALUE '0705'.
   261     12  ER-0706                     PIC X(04)   VALUE '0706'.
   262     12  ER-0707                     PIC X(04)   VALUE '0707'.
   263     12  ER-0708                     PIC X(04)   VALUE '0708'.
   264     12  ER-0709                     PIC X(04)   VALUE '0709'.
   265     12  ER-0710                     PIC X(04)   VALUE '0710'.
   266     12  ER-0711                     PIC X(04)   VALUE '0711'.
   267     12  ER-0712                     PIC X(04)   VALUE '0712'.
   268     12  ER-0713                     PIC X(04)   VALUE '0713'.
   269     12  ER-0717                     PIC X(04)   VALUE '0717'.
   270     12  ER-0718                     PIC X(04)   VALUE '0718'.
   271     12  ER-0719                     PIC X(04)   VALUE '0719'.
   272     12  ER-0720                     PIC X(04)   VALUE '0720'.
   273     12  ER-0721                     PIC X(04)   VALUE '0721'.
   274     12  ER-0722                     PIC X(04)   VALUE '0722'.
   275     12  ER-0723                     PIC X(04)   VALUE '0723'.
   276     12  ER-0724                     PIC X(04)   VALUE '0724'.
   277     12  ER-0725                     PIC X(04)   VALUE '0725'.
   278     12  ER-0726                     PIC X(04)   VALUE '0726'.
   279     12  ER-0727                     PIC X(04)   VALUE '0727'.
   280     12  ER-0729                     PIC X(04)   VALUE '0729'.
   281     12  ER-0754                     PIC X(04)   VALUE '0754'.
   282     12  ER-1560                     PIC X(04)   VALUE '1560'.
   283     12  ER-1562                     PIC X(04)   VALUE '1562'.
   284     12  ER-2241                     PIC X(04)   VALUE '2241'.
   285     12  ER-2276                     PIC X(04)   VALUE '2276'.
   286     12  ER-7008                     PIC X(04)   VALUE '7008'.
   287     12  ER-7031                     PIC X(04)   VALUE '7031'.
   288     12  ER-7123                     PIC X(04)   VALUE '7123'.
   289     12  ER-8150                     PIC X(04)   VALUE '8150'.
   290     12  ER-9999                     PIC XXXX    VALUE '9999'.
   291*                                    COPY ELCDATE.
   292******************************************************************
   293*                                                                *
   294*                                                                *
   295*                            ELCDATE.                            *
   296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   297*                            VMOD=2.003
   298*                                                                *
   299*                                                                *
   300*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   301*                 LENGTH = 200                                   *
   302******************************************************************
   303
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   7
* EL1041.cbl
   304 01  DATE-CONVERSION-DATA.
   305     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   306     12  DC-OPTION-CODE                PIC X.
   307         88  BIN-TO-GREG                VALUE ' '.
   308         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   309         88  EDIT-GREG-TO-BIN           VALUE '2'.
   310         88  YMD-GREG-TO-BIN            VALUE '3'.
   311         88  MDY-GREG-TO-BIN            VALUE '4'.
   312         88  JULIAN-TO-BIN              VALUE '5'.
   313         88  BIN-PLUS-ELAPSED           VALUE '6'.
   314         88  FIND-CENTURY               VALUE '7'.
   315         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   316         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   317         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   318         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   319         88  JULIAN-TO-BIN-3            VALUE 'C'.
   320         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   321         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   322         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   323         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   324         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   325         88  CHECK-LEAP-YEAR            VALUE 'H'.
   326         88  BIN-3-TO-GREG              VALUE 'I'.
   327         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   328         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   329         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   330         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   331         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   332         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   333         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   334         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   335         88  THREE-CHARACTER-BIN
   336                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   337         88  GREGORIAN-TO-BIN
   338                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   339         88  BIN-TO-GREGORIAN
   340                  VALUES ' ' '1' 'I' '8' 'G'.
   341         88  JULIAN-TO-BINARY
   342                  VALUES '5' 'C' 'E' 'F'.
   343     12  DC-ERROR-CODE                 PIC X.
   344         88  NO-CONVERSION-ERROR        VALUE ' '.
   345         88  DATE-CONVERSION-ERROR
   346                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   347         88  DATE-IS-ZERO               VALUE '1'.
   348         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   349         88  DATE-IS-INVALID            VALUE '3'.
   350         88  DATE1-GREATER-DATE2        VALUE '4'.
   351         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   352         88  DATE-INVALID-OPTION        VALUE '9'.
   353         88  INVALID-CENTURY            VALUE 'A'.
   354         88  ONLY-CENTURY               VALUE 'B'.
   355         88  ONLY-LEAP-YEAR             VALUE 'C'.
   356         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   357     12  DC-END-OF-MONTH               PIC X.
   358         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   359     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   360         88  USE-NORMAL-PROCESS         VALUE ' '.
   361         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   8
* EL1041.cbl
   362         88  ADJUST-UP-100-YRS          VALUE '2'.
   363     12  FILLER                        PIC X.
   364     12  DC-CONVERSION-DATES.
   365         16  DC-BIN-DATE-1             PIC XX.
   366         16  DC-BIN-DATE-2             PIC XX.
   367         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   368         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   369                       DC-GREG-DATE-1-EDIT.
   370             20  DC-EDIT1-MONTH        PIC 99.
   371             20  SLASH1-1              PIC X.
   372             20  DC-EDIT1-DAY          PIC 99.
   373             20  SLASH1-2              PIC X.
   374             20  DC-EDIT1-YEAR         PIC 99.
   375         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   376         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   377                     DC-GREG-DATE-2-EDIT.
   378             20  DC-EDIT2-MONTH        PIC 99.
   379             20  SLASH2-1              PIC X.
   380             20  DC-EDIT2-DAY          PIC 99.
   381             20  SLASH2-2              PIC X.
   382             20  DC-EDIT2-YEAR         PIC 99.
   383         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   384         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   385                     DC-GREG-DATE-1-YMD.
   386             20  DC-YMD-YEAR           PIC 99.
   387             20  DC-YMD-MONTH          PIC 99.
   388             20  DC-YMD-DAY            PIC 99.
   389         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   390         16  DC-GREG-DATE-1-MDY-R REDEFINES
   391                      DC-GREG-DATE-1-MDY.
   392             20  DC-MDY-MONTH          PIC 99.
   393             20  DC-MDY-DAY            PIC 99.
   394             20  DC-MDY-YEAR           PIC 99.
   395         16  DC-GREG-DATE-1-ALPHA.
   396             20  DC-ALPHA-MONTH        PIC X(10).
   397             20  DC-ALPHA-DAY          PIC 99.
   398             20  FILLER                PIC XX.
   399             20  DC-ALPHA-CENTURY.
   400                 24 DC-ALPHA-CEN-N     PIC 99.
   401             20  DC-ALPHA-YEAR         PIC 99.
   402         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   403         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   404         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   405         16  DC-JULIAN-DATE            PIC 9(05).
   406         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   407                                       PIC 9(05).
   408         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   409             20  DC-JULIAN-YEAR        PIC 99.
   410             20  DC-JULIAN-DAYS        PIC 999.
   411         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   412         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   413         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   414     12  DATE-CONVERSION-VARIBLES.
   415         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   416         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   417             20  FILLER                PIC 9(3).
   418             20  HOLD-CEN-1-CCYY.
   419                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   9
* EL1041.cbl
   420                 24  HOLD-CEN-1-YY     PIC 99.
   421             20  HOLD-CEN-1-MO         PIC 99.
   422             20  HOLD-CEN-1-DA         PIC 99.
   423         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   424             20  HOLD-CEN-1-R-MO       PIC 99.
   425             20  HOLD-CEN-1-R-DA       PIC 99.
   426             20  HOLD-CEN-1-R-CCYY.
   427                 24  HOLD-CEN-1-R-CC   PIC 99.
   428                 24  HOLD-CEN-1-R-YY   PIC 99.
   429             20  FILLER                PIC 9(3).
   430         16  HOLD-CENTURY-1-X.
   431             20  FILLER                PIC X(3)  VALUE SPACES.
   432             20  HOLD-CEN-1-X-CCYY.
   433                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   434                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   435             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   436             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   437         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   438             20  HOLD-CEN-1-R-X-MO     PIC XX.
   439             20  HOLD-CEN-1-R-X-DA     PIC XX.
   440             20  HOLD-CEN-1-R-X-CCYY.
   441                 24  HOLD-CEN-1-R-X-CC PIC XX.
   442                 24  HOLD-CEN-1-R-X-YY PIC XX.
   443             20  FILLER                PIC XXX.
   444         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   445         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   446         16  DC-JULIAN-DATE-1          PIC 9(07).
   447         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   448             20  DC-JULIAN-1-CCYY.
   449                 24  DC-JULIAN-1-CC    PIC 99.
   450                 24  DC-JULIAN-1-YR    PIC 99.
   451             20  DC-JULIAN-DA-1        PIC 999.
   452         16  DC-JULIAN-DATE-2          PIC 9(07).
   453         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   454             20  DC-JULIAN-2-CCYY.
   455                 24  DC-JULIAN-2-CC    PIC 99.
   456                 24  DC-JULIAN-2-YR    PIC 99.
   457             20  DC-JULIAN-DA-2        PIC 999.
   458         16  DC-GREG-DATE-A-EDIT.
   459             20  DC-EDITA-MONTH        PIC 99.
   460             20  SLASHA-1              PIC X VALUE '/'.
   461             20  DC-EDITA-DAY          PIC 99.
   462             20  SLASHA-2              PIC X VALUE '/'.
   463             20  DC-EDITA-CCYY.
   464                 24  DC-EDITA-CENT     PIC 99.
   465                 24  DC-EDITA-YEAR     PIC 99.
   466         16  DC-GREG-DATE-B-EDIT.
   467             20  DC-EDITB-MONTH        PIC 99.
   468             20  SLASHB-1              PIC X VALUE '/'.
   469             20  DC-EDITB-DAY          PIC 99.
   470             20  SLASHB-2              PIC X VALUE '/'.
   471             20  DC-EDITB-CCYY.
   472                 24  DC-EDITB-CENT     PIC 99.
   473                 24  DC-EDITB-YEAR     PIC 99.
   474         16  DC-GREG-DATE-CYMD         PIC 9(08).
   475         16  DC-GREG-DATE-CYMD-R REDEFINES
   476                              DC-GREG-DATE-CYMD.
   477             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  10
* EL1041.cbl
   478             20  DC-CYMD-YEAR          PIC 99.
   479             20  DC-CYMD-MONTH         PIC 99.
   480             20  DC-CYMD-DAY           PIC 99.
   481         16  DC-GREG-DATE-MDCY         PIC 9(08).
   482         16  DC-GREG-DATE-MDCY-R REDEFINES
   483                              DC-GREG-DATE-MDCY.
   484             20  DC-MDCY-MONTH         PIC 99.
   485             20  DC-MDCY-DAY           PIC 99.
   486             20  DC-MDCY-CEN           PIC 99.
   487             20  DC-MDCY-YEAR          PIC 99.
   488    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   489        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   490    12  DC-EL310-DATE                  PIC X(21).
   491    12  FILLER                         PIC X(28).
   492*                                    COPY ELCLOGOF.
   493******************************************************************
   494*                                                                *
   495*                                                                *
   496*                            ELCLOGOF.                           *
   497*                            VMOD=2.001                          *
   498*                                                                *
   499*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   500*                                                                *
   501******************************************************************
   502 01  CLASIC-LOGOFF.
   503     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   504     12  LOGOFF-TEXT.
   505         16  FILLER          PIC X(5)    VALUE SPACES.
   506         16  LOGOFF-MSG.
   507             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   508             20  FILLER      PIC X       VALUE SPACES.
   509             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   510         16  FILLER          PIC X(80)
   511           VALUE '* YOU ARE NOW LOGGED OFF'.
   512         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   513         16  FILLER          PIC X       VALUE QUOTE.
   514         16  LOGOFF-SYS-MSG  PIC X(17)
   515           VALUE 'S CLAS-IC SYSTEM '.
   516     12  TEXT-MESSAGES.
   517         16  UNACCESS-MSG    PIC X(29)
   518             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   519         16  PGMIDERR-MSG    PIC X(17)
   520             VALUE 'PROGRAM NOT FOUND'.
   521*                                    COPY ELCATTR.
   522******************************************************************
   523*                                                                *
   524*                            ELCATTR.                            *
   525*                            VMOD=2.001                          *
   526*                                                                *
   527*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   528*                                                                *
   529*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   530*                                                                *
   531*                   POS 1   P=PROTECTED                          *
   532*                           U=UNPROTECTED                        *
   533*                           S=ASKIP                              *
   534*                   POS 2   A=ALPHA/NUMERIC                      *
   535*                           N=NUMERIC                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  11
* EL1041.cbl
   536*                   POS 3   N=NORMAL                             *
   537*                           B=BRIGHT                             *
   538*                           D=DARK                               *
   539*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   540*                           OF=MODIFIED DATA TAG OFF             *
   541*                                                                *
   542*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   543******************************************************************
   544 01  ATTRIBUTE-LIST.
   545     12  AL-PABOF            PIC X       VALUE 'Y'.
   546     12  AL-PABON            PIC X       VALUE 'Z'.
   547     12  AL-PADOF            PIC X       VALUE '%'.
   548     12  AL-PADON            PIC X       VALUE '_'.
   549     12  AL-PANOF            PIC X       VALUE '-'.
   550     12  AL-PANON            PIC X       VALUE '/'.
   551     12  AL-SABOF            PIC X       VALUE '8'.
   552     12  AL-SABON            PIC X       VALUE '9'.
   553     12  AL-SADOF            PIC X       VALUE '@'.
   554     12  AL-SADON            PIC X       VALUE QUOTE.
   555     12  AL-SANOF            PIC X       VALUE '0'.
   556     12  AL-SANON            PIC X       VALUE '1'.
   557     12  AL-UABOF            PIC X       VALUE 'H'.
   558     12  AL-UABON            PIC X       VALUE 'I'.
   559     12  AL-UADOF            PIC X       VALUE '<'.
   560     12  AL-UADON            PIC X       VALUE '('.
   561     12  AL-UANOF            PIC X       VALUE ' '.
   562     12  AL-UANON            PIC X       VALUE 'A'.
   563     12  AL-UNBOF            PIC X       VALUE 'Q'.
   564     12  AL-UNBON            PIC X       VALUE 'R'.
   565     12  AL-UNDOF            PIC X       VALUE '*'.
   566     12  AL-UNDON            PIC X       VALUE ')'.
   567     12  AL-UNNOF            PIC X       VALUE '&'.
   568     12  AL-UNNON            PIC X       VALUE 'J'.
   569*                                    COPY ELCEMIB.
   570******************************************************************
   571*                                                                *
   572*                                                                *
   573*                            ELCEMIB.                            *
   574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   575*                            VMOD=2.005                          *
   576*                                                                *
   577*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   578*                                                                *
   579******************************************************************
   580 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   581     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   582     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   583     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   584     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   585     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   586     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   587     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   588     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   589     12  EMI-SWITCH1             PIC X        VALUE '1'.
   590         88  EMI-NO-ERRORS                    VALUE '1'.
   591         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   592         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   593     12  EMI-SWITCH2             PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  12
* EL1041.cbl
   594         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   595     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   596         88  EMI-AREA1-EMPTY                  VALUE '1'.
   597         88  EMI-AREA1-FULL                   VALUE '2'.
   598     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   599         88  EMI-AREA2-EMPTY                  VALUE '1'.
   600         88  EMI-AREA2-FULL                   VALUE '2'.
   601     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   602         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   603         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   604         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   605         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   606         88  EMI-BYPASS-FATALS                VALUE 'X'.
   607     12  EMI-ERROR-LINES.
   608         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   609         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   610         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   611         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   612             20  EMI-ERR-CODES OCCURS 10 TIMES.
   613                 24  EMI-ERR-NUM         PIC X(4).
   614                 24  EMI-FILLER          PIC X.
   615                 24  EMI-SEV             PIC X.
   616                 24  FILLER              PIC X.
   617             20  FILLER                  PIC X(02).
   618     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   619         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   620             20  EMI-ERROR-NUMBER    PIC X(4).
   621             20  EMI-FILL            PIC X.
   622             20  EMI-SEVERITY        PIC X.
   623             20  FILLER              PIC X.
   624             20  EMI-ERROR-TEXT.
   625                 24  EMI-TEXT-VARIABLE   PIC X(10).
   626                 24  FILLER          PIC X(55).
   627     12  EMI-SEVERITY-SAVE           PIC X.
   628         88  EMI-NOTE                    VALUE 'N'.
   629         88  EMI-WARNING                 VALUE 'W'.
   630         88  EMI-FORCABLE                VALUE 'F'.
   631         88  EMI-FATAL                   VALUE 'X'.
   632     12  EMI-MESSAGE-FLAG            PIC X.
   633         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   634         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   635     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   636     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   637         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   638         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   639         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   640     12  emi-claim-no                pic x(7).
   641     12  emi-claim-type              pic x(6).
   642     12  FILLER                      PIC X(124)  VALUE SPACES.
   643     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   644     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   645     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   646     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   647*                                    COPY ELCJPFX.
   648******************************************************************
   649*                                                                *
   650*                                                                *
   651*                            ELCJPFX.                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  13
* EL1041.cbl
   652*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   653*                            VMOD=2.002                          *
   654*                                                                *
   655*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   656*                                                                *
   657*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   658*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   659*        ELCNTL - CONTROL FILE                                   *
   660*        ELMSTR - CLAIM MASTERS                                  *
   661*        ELTRLR - ACTIVITY TRAILERS                              *
   662*        ELCHKQ - CHECK QUE                                      *
   663******************************************************************
   664 01  JOURNAL-RECORD.
   665     12  jp-date                     pic s9(5) comp-3.
   666     12  jp-time                     pic s9(7) comp-3.
   667     12  JP-USER-ID                  PIC X(4).
   668     12  JP-FILE-ID                  PIC X(8).
   669     12  JP-PROGRAM-ID               PIC X(8).
   670     12  JP-RECORD-TYPE              PIC X.
   671         88 JP-ADD              VALUE 'A'.
   672         88 JP-BEFORE-CHANGE    VALUE 'B'.
   673         88 JP-AFTER-CHANGE     VALUE 'C'.
   674         88 JP-DELETE           VALUE 'D'.
   675         88 JP-GENERIC-DELETE   VALUE 'G'.
   676         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   677         88 JP-KEY-CHG-ADD      VALUE 'N'.
   678     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   679     12  JP-RECORD-AREA
   680
   681
   682                                     PIC X(530).
   683*                                    COPY ELCINTF.
   684******************************************************************
   685*                                                                *
   686*                                                                *
   687*                            ELCINTF.                            *
   688*                            VMOD=2.017                          *
   689*                                                                *
   690*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   691*                                                                *
   692*       LENGTH = 1024                                            *
   693*                                                                *
   694******************************************************************
   695*                   C H A N G E   L O G
   696*
   697* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   698*-----------------------------------------------------------------
   699*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   700* EFFECTIVE    NUMBER
   701*-----------------------------------------------------------------
   702* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   703******************************************************************
   704 01  PROGRAM-INTERFACE-BLOCK.
   705     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   706     12  PI-CALLING-PROGRAM              PIC X(8).
   707     12  PI-SAVED-PROGRAM-1              PIC X(8).
   708     12  PI-SAVED-PROGRAM-2              PIC X(8).
   709     12  PI-SAVED-PROGRAM-3              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  14
* EL1041.cbl
   710     12  PI-SAVED-PROGRAM-4              PIC X(8).
   711     12  PI-SAVED-PROGRAM-5              PIC X(8).
   712     12  PI-SAVED-PROGRAM-6              PIC X(8).
   713     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   714     12  PI-COMPANY-ID                   PIC XXX.
   715     12  PI-COMPANY-CD                   PIC X.
   716
   717     12  PI-COMPANY-PASSWORD             PIC X(8).
   718
   719     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   720
   721     12  PI-CONTROL-IN-PROGRESS.
   722         16  PI-CARRIER                  PIC X.
   723         16  PI-GROUPING                 PIC X(6).
   724         16  PI-STATE                    PIC XX.
   725         16  PI-ACCOUNT                  PIC X(10).
   726         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   727                                         PIC X(10).
   728         16  PI-CLAIM-CERT-GRP.
   729             20  PI-CLAIM-NO             PIC X(7).
   730             20  PI-CERT-NO.
   731                 25  PI-CERT-PRIME       PIC X(10).
   732                 25  PI-CERT-SFX         PIC X.
   733             20  PI-CERT-EFF-DT          PIC XX.
   734         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   735             20  PI-PLAN-CODE            PIC X(2).
   736             20  PI-REVISION-NUMBER      PIC X(3).
   737             20  PI-PLAN-EFF-DT          PIC X(2).
   738             20  PI-PLAN-EXP-DT          PIC X(2).
   739             20  FILLER                  PIC X(11).
   740         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   741             20  PI-OE-REFERENCE-1.
   742                 25  PI-OE-REF-1-PRIME   PIC X(18).
   743                 25  PI-OE-REF-1-SUFF    PIC XX.
   744
   745     12  PI-SESSION-IN-PROGRESS          PIC X.
   746         88  CLAIM-SESSION                   VALUE '1'.
   747         88  CREDIT-SESSION                  VALUE '2'.
   748         88  WARRANTY-SESSION                VALUE '3'.
   749         88  MORTGAGE-SESSION                VALUE '4'.
   750         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   751
   752
   753*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   754
   755     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   756     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   757
   758     12  PI-CREDIT-USER                  PIC X.
   759         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   760         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   761
   762     12  PI-CLAIM-USER                   PIC X.
   763         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   764         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   765
   766     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   767         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  15
* EL1041.cbl
   768         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   769         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   770         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   771         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   772
   773     12  PI-PROCESSOR-ID                 PIC X(4).
   774
   775     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   776
   777     12  PI-MEMBER-CAPTION               PIC X(10).
   778
   779     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   780         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   781
   782     12  PI-LIFE-OVERRIDE-L1             PIC X.
   783     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   784     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   785     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   786
   787     12  PI-AH-OVERRIDE-L1               PIC X.
   788     12  PI-AH-OVERRIDE-L2               PIC XX.
   789     12  PI-AH-OVERRIDE-L6               PIC X(6).
   790     12  PI-AH-OVERRIDE-L12              PIC X(12).
   791
   792     12  PI-NEW-SYSTEM                   PIC X(2).
   793
   794     12  PI-PRIMARY-CERT-NO              PIC X(11).
   795     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   796         88  PI-USES-PAID-TO                 VALUE '1'.
   797     12  PI-CRDTCRD-SYSTEM.
   798         16  PI-CRDTCRD-USER             PIC X.
   799             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   800             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   801         16  PI-CC-MONTH-END-DT          PIC XX.
   802     12  PI-PROCESSOR-PRINTER            PIC X(4).
   803
   804     12  PI-OE-REFERENCE-2.
   805         16  PI-OE-REF-2-PRIME           PIC X(10).
   806         16  PI-OE-REF-2-SUFF            PIC X.
   807
   808     12  PI-REM-TRM-CALC-OPTION          PIC X.
   809
   810     12  PI-LANGUAGE-TYPE                PIC X.
   811             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   812             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   813             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   814
   815     12  PI-POLICY-LINKAGE-IND           PIC X.
   816         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   817         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   818                                                   LOW-VALUES.
   819
   820     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   821     12  PI-CLAIM-PW-SESSION             PIC X(1).
   822         88  PI-CLAIM-CREDIT                 VALUE '1'.
   823         88  PI-CLAIM-CONVEN                 VALUE '2'.
   824
   825     12  PI-PROCESSOR-CSR-IND            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  16
* EL1041.cbl
   826         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   827         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   828
   829     12  FILLER                          PIC X(3).
   830
   831     12  PI-SYSTEM-LEVEL                 PIC X(145).
   832
   833     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   834         PI-SYSTEM-LEVEL.
   835
   836         16  PI-ENTRY-CODES.
   837             20  PI-ENTRY-CD-1           PIC X.
   838             20  PI-ENTRY-CD-2           PIC X.
   839
   840         16  PI-RETURN-CODES.
   841             20  PI-RETURN-CD-1          PIC X.
   842             20  PI-RETURN-CD-2          PIC X.
   843
   844         16  PI-UPDATE-STATUS-SAVE.
   845             20  PI-UPDATE-BY            PIC X(4).
   846             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   847
   848         16  PI-LOWER-CASE-LETTERS       PIC X.
   849             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   850
   851*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   852*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   853*            88  CARRIER-CLM-CNTL            VALUE '2'.
   854
   855         16  PI-CERT-ACCESS-CONTROL      PIC X.
   856             88  ST-ACCNT-CNTL               VALUE ' '.
   857             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   858             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   859             88  ACCNT-CNTL                  VALUE '3'.
   860             88  CARR-ACCNT-CNTL             VALUE '4'.
   861
   862         16  PI-PROCESSOR-CAP-LIST.
   863             20  PI-SYSTEM-CONTROLS.
   864                24 PI-SYSTEM-DISPLAY     PIC X.
   865                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   866                24 PI-SYSTEM-MODIFY      PIC X.
   867                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   868             20  FILLER                  PIC XX.
   869             20  PI-DISPLAY-CAP          PIC X.
   870                 88  DISPLAY-CAP             VALUE 'Y'.
   871             20  PI-MODIFY-CAP           PIC X.
   872                 88  MODIFY-CAP              VALUE 'Y'.
   873             20  PI-MSG-AT-LOGON-CAP     PIC X.
   874                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   875             20  PI-FORCE-CAP            PIC X.
   876                 88  FORCE-CAP               VALUE 'Y'.
   877
   878         16  PI-PROGRAM-CONTROLS.
   879             20  PI-PGM-PRINT-OPT        PIC X.
   880             20  PI-PGM-FORMAT-OPT       PIC X.
   881             20  PI-PGM-PROCESS-OPT      PIC X.
   882             20  PI-PGM-TOTALS-OPT       PIC X.
   883
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  17
* EL1041.cbl
   884         16  PI-HELP-INTERFACE.
   885             20  PI-LAST-ERROR-NO        PIC X(4).
   886             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   887
   888         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   889             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   890
   891         16  PI-CR-CONTROL-IN-PROGRESS.
   892             20  PI-CR-CARRIER           PIC X.
   893             20  PI-CR-GROUPING          PIC X(6).
   894             20  PI-CR-STATE             PIC XX.
   895             20  PI-CR-ACCOUNT           PIC X(10).
   896             20  PI-CR-FIN-RESP          PIC X(10).
   897             20  PI-CR-TYPE              PIC X.
   898
   899         16  PI-CR-BATCH-NUMBER          PIC X(6).
   900
   901         16  PI-CR-MONTH-END-DT          PIC XX.
   902
   903         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   904             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   905             88  PI-ZERO-CARRIER             VALUE '1'.
   906             88  PI-ZERO-GROUPING            VALUE '2'.
   907             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   908
   909         16  PI-CARRIER-SECURITY         PIC X.
   910             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   911
   912         16  PI-ACCOUNT-SECURITY         PIC X(10).
   913             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   914             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   915
   916         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   917             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   918                                         INDEXED BY PI-ACCESS-NDX
   919                                         PIC X.
   920
   921         16  PI-GA-BILLING-CONTROL       PIC X.
   922             88  PI-GA-BILLING               VALUE '1'.
   923
   924         16  PI-MAIL-PROCESSING          PIC X.
   925             88  PI-MAIL-YES                 VALUE 'Y'.
   926
   927         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   928
   929         16  PI-AR-SYSTEM.
   930             20  PI-AR-PROCESSING-CNTL   PIC X.
   931                 88  PI-AR-PROCESSING        VALUE 'Y'.
   932             20  PI-AR-SUMMARY-CODE      PIC X(6).
   933             20  PI-AR-MONTH-END-DT      PIC XX.
   934
   935         16  PI-MP-SYSTEM.
   936             20  PI-MORTGAGE-USER            PIC X.
   937                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   938                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   939             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   940                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   941                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  18
* EL1041.cbl
   942                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   943                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   944                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   945             20  PI-MP-MONTH-END-DT          PIC XX.
   946             20  PI-MP-REFERENCE-NO.
   947                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   948                 24  PI-MP-REFERENCE-SFX     PIC XX.
   949
   950         16  PI-LABEL-CONTROL            PIC X(01).
   951             88  PI-CREATE-LABELS                    VALUE 'Y'.
   952             88  PI-BYPASS-LABELS                    VALUE 'N'.
   953
   954         16  PI-BILL-GROUPING-CODE       PIC X(01).
   955             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   956
   957         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   958             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   959             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   960
   961         16  FILLER                      PIC X(14).
   962
   963     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   964******************************************************************
   965     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   966*                                    COPY ELC1042.
   967******************************************************************
   968*                                                                *
   969*                                                                *
   970*                           ELC1042                              *
   971*                            VMOD=2.002                          *
   972*                                                                *
   973*    NOTE                                                        *
   974*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   975*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   976*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   977*        TO THESE PROGRAMS.                                      *
   978*                                                                *
   979*    NOTE                                                        *
   980*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   981*        USE ONLY!                                               *
   982*                                                                *
   983******************************************************************
   984
   985         16  PI-1042-WA.
   986             20  PI-ACTION       PIC  X(01).
   987                 88 PI-SHOW-MODE           VALUE '1'.
   988                 88 PI-CLEAR-MODE          VALUE '2'.
   989                 88 PI-CREATE-MODE         VALUE '3'.
   990             20  PI-COMM-CONTROL PIC  X(12).
   991             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   992             20  PI-EOF-SW       PIC  X(01).
   993                 88  PI-FILE-EOF           VALUE 'Y'.
   994             20  PI-FILETYP      PIC  X(01).
   995             20  PI-FORM-SQUEEZE-CONTROL
   996                                 PIC  X(01).
   997                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   998                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   999             20  PI-LAST-CONTROL PIC  X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  19
* EL1041.cbl
  1000             20  PI-TEMP-STOR-ITEMS
  1001                                 PIC S9(04) COMP.
  1002             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1003             20  PI-UPDATE-SW    PIC  9(01).
  1004                 88 ANY-UPDATES            VALUE 1.
  1005             20  PI-104-SCREEN-SENT-IND
  1006                                 PIC  X(01).
  1007                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1008                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1009             20  PI-1042-SCREEN-SENT-IND
  1010                                 PIC  X(01).
  1011                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1012                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1013             20  PI-1042-ARCHIVE-IND
  1014                                 PIC  X(01).
  1015                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1016             20  FILLER          PIC  X(29).
  1017         16  PI-PREV-LETR-KEY        PIC X(15).
  1018         16  PI-CURR-LETR-KEY        PIC X(15).
  1019         16  PI-UPDATE-DT            PIC XX.
  1020         16  PI-ENC-CODES            PIC X(120).
  1021         16  PI-SPLIT-SUB            PIC S9(3)  COMP.
  1022         16  FILLER                  PIC X(434).
  1023*                                    COPY ELCAID.
  1024******************************************************************
  1025*                                                                *
  1026*                            ELCAID.                             *
  1027*                            VMOD=2.001                          *
  1028*                                                                *
  1029*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1030*                                                                *
  1031*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1032*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1033******************************************************************
  1034
  1035 01  DFHAID.
  1036   02  DFHNULL   PIC  X  VALUE  ' '.
  1037   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1038   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1039   02  DFHPEN    PIC  X  VALUE  '='.
  1040   02  DFHOPID   PIC  X  VALUE  'W'.
  1041   02  DFHPA1    PIC  X  VALUE  '%'.
  1042   02  DFHPA2    PIC  X  VALUE  '>'.
  1043   02  DFHPA3    PIC  X  VALUE  ','.
  1044   02  DFHPF1    PIC  X  VALUE  '1'.
  1045   02  DFHPF2    PIC  X  VALUE  '2'.
  1046   02  DFHPF3    PIC  X  VALUE  '3'.
  1047   02  DFHPF4    PIC  X  VALUE  '4'.
  1048   02  DFHPF5    PIC  X  VALUE  '5'.
  1049   02  DFHPF6    PIC  X  VALUE  '6'.
  1050   02  DFHPF7    PIC  X  VALUE  '7'.
  1051   02  DFHPF8    PIC  X  VALUE  '8'.
  1052   02  DFHPF9    PIC  X  VALUE  '9'.
  1053   02  DFHPF10   PIC  X  VALUE  ':'.
  1054   02  DFHPF11   PIC  X  VALUE  '#'.
  1055   02  DFHPF12   PIC  X  VALUE  '@'.
  1056   02  DFHPF13   PIC  X  VALUE  'A'.
  1057   02  DFHPF14   PIC  X  VALUE  'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  20
* EL1041.cbl
  1058   02  DFHPF15   PIC  X  VALUE  'C'.
  1059   02  DFHPF16   PIC  X  VALUE  'D'.
  1060   02  DFHPF17   PIC  X  VALUE  'E'.
  1061   02  DFHPF18   PIC  X  VALUE  'F'.
  1062   02  DFHPF19   PIC  X  VALUE  'G'.
  1063   02  DFHPF20   PIC  X  VALUE  'H'.
  1064   02  DFHPF21   PIC  X  VALUE  'I'.
  1065*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1066   02  DFHPF22   PIC  X  VALUE  '['.
  1067   02  DFHPF23   PIC  X  VALUE  '.'.
  1068   02  DFHPF24   PIC  X  VALUE  '<'.
  1069   02  DFHMSRE   PIC  X  VALUE  'X'.
  1070   02  DFHSTRF   PIC  X  VALUE  'h'.
  1071   02  DFHTRIG   PIC  X  VALUE  '"'.
  1072 01  FILLER    REDEFINES DFHAID.
  1073     12  FILLER                      PIC X(08).
  1074     12  PF-VALUES                   PIC X         OCCURS 24.
  1075*                                    COPY EL1041S.
  1076 01  EL104ZI.
  1077     05  FILLER            PIC  X(0012).
  1078*    -------------------------------
  1079     05  DATEL PIC S9(0004) COMP.
  1080     05  DATEF PIC  X(0001).
  1081     05  FILLER REDEFINES DATEF.
  1082         10  DATEA PIC  X(0001).
  1083     05  FILLER            PIC  X(3).
  1084     05  DATEI PIC  X(0008).
  1085*    -------------------------------
  1086     05  TIMEL PIC S9(0004) COMP.
  1087     05  TIMEF PIC  X(0001).
  1088     05  FILLER REDEFINES TIMEF.
  1089         10  TIMEA PIC  X(0001).
  1090     05  FILLER            PIC  X(3).
  1091     05  TIMEI PIC  X(0005).
  1092*    -------------------------------
  1093     05  CMPNYIDL PIC S9(0004) COMP.
  1094     05  CMPNYIDF PIC  X(0001).
  1095     05  FILLER REDEFINES CMPNYIDF.
  1096         10  CMPNYIDA PIC  X(0001).
  1097     05  FILLER            PIC  X(3).
  1098     05  CMPNYIDI PIC  X(0003).
  1099*    -------------------------------
  1100     05  USERIDL PIC S9(0004) COMP.
  1101     05  USERIDF PIC  X(0001).
  1102     05  FILLER REDEFINES USERIDF.
  1103         10  USERIDA PIC  X(0001).
  1104     05  FILLER            PIC  X(3).
  1105     05  USERIDI PIC  X(0004).
  1106*    -------------------------------
  1107     05  MAINTL PIC S9(0004) COMP.
  1108     05  MAINTF PIC  X(0001).
  1109     05  FILLER REDEFINES MAINTF.
  1110         10  MAINTA PIC  X(0001).
  1111     05  FILLER            PIC  X(3).
  1112     05  MAINTI PIC  X(0001).
  1113*    -------------------------------
  1114     05  LSTUSRL PIC S9(0004) COMP.
  1115     05  LSTUSRF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  21
* EL1041.cbl
  1116     05  FILLER REDEFINES LSTUSRF.
  1117         10  LSTUSRA PIC  X(0001).
  1118     05  FILLER            PIC  X(3).
  1119     05  LSTUSRI PIC  X(0004).
  1120*    -------------------------------
  1121     05  LSTDTEL PIC S9(0004) COMP.
  1122     05  LSTDTEF PIC  X(0001).
  1123     05  FILLER REDEFINES LSTDTEF.
  1124         10  LSTDTEA PIC  X(0001).
  1125     05  FILLER            PIC  X(3).
  1126     05  LSTDTEI PIC  X(0008).
  1127*    -------------------------------
  1128     05  LSTTIMEL PIC S9(0004) COMP.
  1129     05  LSTTIMEF PIC  X(0001).
  1130     05  FILLER REDEFINES LSTTIMEF.
  1131         10  LSTTIMEA PIC  X(0001).
  1132     05  FILLER            PIC  X(3).
  1133     05  LSTTIMEI PIC  X(0005).
  1134*    -------------------------------
  1135     05  ZLETRL PIC S9(0004) COMP.
  1136     05  ZLETRF PIC  X(0001).
  1137     05  FILLER REDEFINES ZLETRF.
  1138         10  ZLETRA PIC  X(0001).
  1139     05  FILLER            PIC  X(3).
  1140     05  ZLETRI PIC  X(0004).
  1141*    -------------------------------
  1142     05  ZCOPIESL PIC S9(0004) COMP.
  1143     05  ZCOPIESF PIC  X(0001).
  1144     05  FILLER REDEFINES ZCOPIESF.
  1145         10  ZCOPIESA PIC  X(0001).
  1146     05  FILLER            PIC  X(3).
  1147     05  ZCOPIESI PIC  X(0001).
  1148*    -------------------------------
  1149     05  ZPROMPTL PIC S9(0004) COMP.
  1150     05  ZPROMPTF PIC  X(0001).
  1151     05  FILLER REDEFINES ZPROMPTF.
  1152         10  ZPROMPTA PIC  X(0001).
  1153     05  FILLER            PIC  X(3).
  1154     05  ZPROMPTI PIC  X(0001).
  1155*    -------------------------------
  1156     05  ZENCCDL PIC S9(0004) COMP.
  1157     05  ZENCCDF PIC  X(0001).
  1158     05  FILLER REDEFINES ZENCCDF.
  1159         10  ZENCCDA PIC  X(0001).
  1160     05  FILLER            PIC  X(3).
  1161     05  ZENCCDI PIC  X(0003).
  1162*    -------------------------------
  1163     05  ZRDAYSL PIC S9(0004) COMP.
  1164     05  ZRDAYSF PIC  X(0001).
  1165     05  FILLER REDEFINES ZRDAYSF.
  1166         10  ZRDAYSA PIC  X(0001).
  1167     05  FILLER            PIC  X(3).
  1168     05  ZRDAYSI PIC  X(0003).
  1169*    -------------------------------
  1170     05  ZFORML PIC S9(0004) COMP.
  1171     05  ZFORMF PIC  X(0001).
  1172     05  FILLER REDEFINES ZFORMF.
  1173         10  ZFORMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  22
* EL1041.cbl
  1174     05  FILLER            PIC  X(3).
  1175     05  ZFORMI PIC  X(0004).
  1176*    -------------------------------
  1177     05  ZBENEL PIC S9(0004) COMP.
  1178     05  ZBENEF PIC  X(0001).
  1179     05  FILLER REDEFINES ZBENEF.
  1180         10  ZBENEA PIC  X(0001).
  1181     05  FILLER            PIC  X(3).
  1182     05  ZBENEI PIC  X(0001).
  1183*    -------------------------------
  1184     05  ZBARCODL PIC S9(0004) COMP.
  1185     05  ZBARCODF PIC  X(0001).
  1186     05  FILLER REDEFINES ZBARCODF.
  1187         10  ZBARCODA PIC  X(0001).
  1188     05  FILLER            PIC  X(3).
  1189     05  ZBARCODI PIC  X(0001).
  1190*    -------------------------------
  1191     05  ZRETENVL PIC S9(0004) COMP.
  1192     05  ZRETENVF PIC  X(0001).
  1193     05  FILLER REDEFINES ZRETENVF.
  1194         10  ZRETENVA PIC  X(0001).
  1195     05  FILLER            PIC  X(3).
  1196     05  ZRETENVI PIC  X(0001).
  1197*    -------------------------------
  1198     05  ZCODES1L PIC S9(0004) COMP.
  1199     05  ZCODES1F PIC  X(0001).
  1200     05  FILLER REDEFINES ZCODES1F.
  1201         10  ZCODES1A PIC  X(0001).
  1202     05  FILLER            PIC  X(3).
  1203     05  ZCODES1I PIC  X(0053).
  1204*    -------------------------------
  1205     05  ZCODES2L PIC S9(0004) COMP.
  1206     05  ZCODES2F PIC  X(0001).
  1207     05  FILLER REDEFINES ZCODES2F.
  1208         10  ZCODES2A PIC  X(0001).
  1209     05  FILLER            PIC  X(3).
  1210     05  ZCODES2I PIC  X(0078).
  1211*    -------------------------------
  1212     05  DCCOPTL PIC S9(0004) COMP.
  1213     05  DCCOPTF PIC  X(0001).
  1214     05  FILLER REDEFINES DCCOPTF.
  1215         10  DCCOPTA PIC  X(0001).
  1216     05  FILLER            PIC  X(3).
  1217     05  DCCOPTI PIC  X(0035).
  1218*    -------------------------------
  1219     05  ZFADAYSL PIC S9(0004) COMP.
  1220     05  ZFADAYSF PIC  X(0001).
  1221     05  FILLER REDEFINES ZFADAYSF.
  1222         10  ZFADAYSA PIC  X(0001).
  1223     05  FILLER            PIC  X(3).
  1224     05  ZFADAYSI PIC  X(0003).
  1225*    -------------------------------
  1226     05  ZACLOSEL PIC S9(0004) COMP.
  1227     05  ZACLOSEF PIC  X(0001).
  1228     05  FILLER REDEFINES ZACLOSEF.
  1229         10  ZACLOSEA PIC  X(0001).
  1230     05  FILLER            PIC  X(3).
  1231     05  ZACLOSEI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  23
* EL1041.cbl
  1232*    -------------------------------
  1233     05  ERRMSGL PIC S9(0004) COMP.
  1234     05  ERRMSGF PIC  X(0001).
  1235     05  FILLER REDEFINES ERRMSGF.
  1236         10  ERRMSGA PIC  X(0001).
  1237     05  FILLER            PIC  X(3).
  1238     05  ERRMSGI PIC  X(0072).
  1239*    -------------------------------
  1240     05  PFKEYL PIC S9(0004) COMP.
  1241     05  PFKEYF PIC  X(0001).
  1242     05  FILLER REDEFINES PFKEYF.
  1243         10  PFKEYA PIC  X(0001).
  1244     05  FILLER            PIC  X(3).
  1245     05  PFKEYI PIC  99.
  1246 01  EL104ZO REDEFINES EL104ZI.
  1247     05  FILLER            PIC  X(0012).
  1248*    -------------------------------
  1249     05  FILLER            PIC  X(3).
  1250     05  DATEC PIC  X(0001).
  1251     05  DATEH PIC  X(0001).
  1252     05  DATEU PIC  X(0001).
  1253     05  DATEO PIC  X(0008).
  1254*    -------------------------------
  1255     05  FILLER            PIC  X(3).
  1256     05  TIMEC PIC  X(0001).
  1257     05  TIMEH PIC  X(0001).
  1258     05  TIMEU PIC  X(0001).
  1259     05  TIMEO PIC  99.99.
  1260*    -------------------------------
  1261     05  FILLER            PIC  X(3).
  1262     05  CMPNYIDC PIC  X(0001).
  1263     05  CMPNYIDH PIC  X(0001).
  1264     05  CMPNYIDU PIC  X(0001).
  1265     05  CMPNYIDO PIC  X(0003).
  1266*    -------------------------------
  1267     05  FILLER            PIC  X(3).
  1268     05  USERIDC PIC  X(0001).
  1269     05  USERIDH PIC  X(0001).
  1270     05  USERIDU PIC  X(0001).
  1271     05  USERIDO PIC  X(0004).
  1272*    -------------------------------
  1273     05  FILLER            PIC  X(3).
  1274     05  MAINTC PIC  X(0001).
  1275     05  MAINTH PIC  X(0001).
  1276     05  MAINTU PIC  X(0001).
  1277     05  MAINTO PIC  X(0001).
  1278*    -------------------------------
  1279     05  FILLER            PIC  X(3).
  1280     05  LSTUSRC PIC  X(0001).
  1281     05  LSTUSRH PIC  X(0001).
  1282     05  LSTUSRU PIC  X(0001).
  1283     05  LSTUSRO PIC  X(0004).
  1284*    -------------------------------
  1285     05  FILLER            PIC  X(3).
  1286     05  LSTDTEC PIC  X(0001).
  1287     05  LSTDTEH PIC  X(0001).
  1288     05  LSTDTEU PIC  X(0001).
  1289     05  LSTDTEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  24
* EL1041.cbl
  1290*    -------------------------------
  1291     05  FILLER            PIC  X(3).
  1292     05  LSTTIMEC PIC  X(0001).
  1293     05  LSTTIMEH PIC  X(0001).
  1294     05  LSTTIMEU PIC  X(0001).
  1295     05  LSTTIMEO PIC  99.99.
  1296*    -------------------------------
  1297     05  FILLER            PIC  X(3).
  1298     05  ZLETRC PIC  X(0001).
  1299     05  ZLETRH PIC  X(0001).
  1300     05  ZLETRU PIC  X(0001).
  1301     05  ZLETRO PIC  X(0004).
  1302*    -------------------------------
  1303     05  FILLER            PIC  X(3).
  1304     05  ZCOPIESC PIC  X(0001).
  1305     05  ZCOPIESH PIC  X(0001).
  1306     05  ZCOPIESU PIC  X(0001).
  1307     05  ZCOPIESO PIC  9.
  1308*    -------------------------------
  1309     05  FILLER            PIC  X(3).
  1310     05  ZPROMPTC PIC  X(0001).
  1311     05  ZPROMPTH PIC  X(0001).
  1312     05  ZPROMPTU PIC  X(0001).
  1313     05  ZPROMPTO PIC  X(0001).
  1314*    -------------------------------
  1315     05  FILLER            PIC  X(3).
  1316     05  ZENCCDC PIC  X(0001).
  1317     05  ZENCCDH PIC  X(0001).
  1318     05  ZENCCDU PIC  X(0001).
  1319     05  ZENCCDO PIC  X(0003).
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(3).
  1322     05  ZRDAYSC PIC  X(0001).
  1323     05  ZRDAYSH PIC  X(0001).
  1324     05  ZRDAYSU PIC  X(0001).
  1325     05  ZRDAYSO PIC  999.
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(3).
  1328     05  ZFORMC PIC  X(0001).
  1329     05  ZFORMH PIC  X(0001).
  1330     05  ZFORMU PIC  X(0001).
  1331     05  ZFORMO PIC  X(0004).
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(3).
  1334     05  ZBENEC PIC  X(0001).
  1335     05  ZBENEH PIC  X(0001).
  1336     05  ZBENEU PIC  X(0001).
  1337     05  ZBENEO PIC  X(0001).
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(3).
  1340     05  ZBARCODC PIC  X(0001).
  1341     05  ZBARCODH PIC  X(0001).
  1342     05  ZBARCODU PIC  X(0001).
  1343     05  ZBARCODO PIC  X(0001).
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(3).
  1346     05  ZRETENVC PIC  X(0001).
  1347     05  ZRETENVH PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  25
* EL1041.cbl
  1348     05  ZRETENVU PIC  X(0001).
  1349     05  ZRETENVO PIC  X(0001).
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(3).
  1352     05  ZCODES1C PIC  X(0001).
  1353     05  ZCODES1H PIC  X(0001).
  1354     05  ZCODES1U PIC  X(0001).
  1355     05  ZCODES1O PIC  X(0053).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(3).
  1358     05  ZCODES2C PIC  X(0001).
  1359     05  ZCODES2H PIC  X(0001).
  1360     05  ZCODES2U PIC  X(0001).
  1361     05  ZCODES2O PIC  X(0078).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(3).
  1364     05  DCCOPTC PIC  X(0001).
  1365     05  DCCOPTH PIC  X(0001).
  1366     05  DCCOPTU PIC  X(0001).
  1367     05  DCCOPTO PIC  X(0035).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(3).
  1370     05  ZFADAYSC PIC  X(0001).
  1371     05  ZFADAYSH PIC  X(0001).
  1372     05  ZFADAYSU PIC  X(0001).
  1373     05  ZFADAYSO PIC  999.
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(3).
  1376     05  ZACLOSEC PIC  X(0001).
  1377     05  ZACLOSEH PIC  X(0001).
  1378     05  ZACLOSEU PIC  X(0001).
  1379     05  ZACLOSEO PIC  X(0001).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(3).
  1382     05  ERRMSGC PIC  X(0001).
  1383     05  ERRMSGH PIC  X(0001).
  1384     05  ERRMSGU PIC  X(0001).
  1385     05  ERRMSGO PIC  X(0072).
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(3).
  1388     05  PFKEYC PIC  X(0001).
  1389     05  PFKEYH PIC  X(0001).
  1390     05  PFKEYU PIC  X(0001).
  1391     05  PFKEYO PIC  99.
  1392*    -------------------------------
  1393****************************************************************
  1394*
  1395* Copyright (c) 2007 by Clerity Solutions, Inc.
  1396* All rights reserved.
  1397*
  1398****************************************************************
  1399 01  DFHEIV.
  1400   02  DFHEIV0               PIC X(35).
  1401   02  DFHEIV1               PIC X(08).
  1402   02  DFHEIV2               PIC X(08).
  1403   02  DFHEIV3               PIC X(08).
  1404   02  DFHEIV4               PIC X(06).
  1405   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  26
* EL1041.cbl
  1406   02  DFHEIV6               PIC X(04).
  1407   02  DFHEIV7               PIC X(02).
  1408   02  DFHEIV8               PIC X(02).
  1409   02  DFHEIV9               PIC X(01).
  1410   02  DFHEIV10              PIC S9(7) COMP-3.
  1411   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1412   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1413   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1414   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1415   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1416   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1417   02  DFHEIV17              PIC X(04).
  1418   02  DFHEIV18              PIC X(04).
  1419   02  DFHEIV19              PIC X(04).
  1420   02  DFHEIV20              USAGE IS POINTER.
  1421   02  DFHEIV21              USAGE IS POINTER.
  1422   02  DFHEIV22              USAGE IS POINTER.
  1423   02  DFHEIV23              USAGE IS POINTER.
  1424   02  DFHEIV24              USAGE IS POINTER.
  1425   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1426   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1427   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1428   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1429   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1430   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1431   02  FILLER                PIC X(02).
  1432   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1433   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1434   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1435   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1436   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1437 LINKAGE  SECTION.
  1438*****************************************************************
  1439*                                                               *
  1440* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1441* All rights reserved.                                          *
  1442*                                                               *
  1443*****************************************************************
  1444 01  dfheiblk.
  1445     02  eibtime          pic s9(7) comp-3.
  1446     02  eibdate          pic s9(7) comp-3.
  1447     02  eibtrnid         pic x(4).
  1448     02  eibtaskn         pic s9(7) comp-3.
  1449     02  eibtrmid         pic x(4).
  1450     02  dfheigdi         pic s9(4) comp.
  1451     02  eibcposn         pic s9(4) comp.
  1452     02  eibcalen         pic s9(4) comp.
  1453     02  eibaid           pic x(1).
  1454     02  eibfiller1       pic x(1).
  1455     02  eibfn            pic x(2).
  1456     02  eibfiller2       pic x(2).
  1457     02  eibrcode         pic x(6).
  1458     02  eibfiller3       pic x(2).
  1459     02  eibds            pic x(8).
  1460     02  eibreqid         pic x(8).
  1461     02  eibrsrce         pic x(8).
  1462     02  eibsync          pic x(1).
  1463     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  27
* EL1041.cbl
  1464     02  eibrecv          pic x(1).
  1465     02  eibsend          pic x(1).
  1466     02  eibatt           pic x(1).
  1467     02  eibeoc           pic x(1).
  1468     02  eibfmh           pic x(1).
  1469     02  eibcompl         pic x(1).
  1470     02  eibsig           pic x(1).
  1471     02  eibconf          pic x(1).
  1472     02  eiberr           pic x(1).
  1473     02  eibrldbk         pic x(1).
  1474     02  eiberrcd         pic x(4).
  1475     02  eibsynrb         pic x(1).
  1476     02  eibnodat         pic x(1).
  1477     02  eibfiller5       pic x(2).
  1478     02  eibresp          pic 9(09) comp.
  1479     02  eibresp2         pic 9(09) comp.
  1480     02  dfheigdj         pic s9(4) comp.
  1481     02  dfheigdk         pic s9(4) comp.
  1482 01  DFHCOMMAREA                     PIC X(1024).
  1483*                                    COPY ELCTEXT.
  1484******************************************************************
  1485*                                                                *
  1486*                                                                *
  1487*                            ELCTEXT.                            *
  1488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1489*                            VMOD=2.008                          *
  1490*                                                                *
  1491*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1492*                                     FORM LETTERS,              *
  1493*                                     CERT FORM DISPLAY.
  1494*                                                                *
  1495*   FILE TYPE = VSAM,KSDS                                        *
  1496*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1497*                                                                *
  1498*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1499*       ALTERNATE INDEX = NONE                                   *
  1500*                                                                *
  1501*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1502*       ALTERNATE INDEX = NONE                                   *
  1503*                                                                *
  1504*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1505*       ALTERNATE INDEX = NONE                                   *
  1506*                                                                *
  1507*   LOG = NO                                                     *
  1508*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1509******************************************************************
  1510 01  TEXT-FILES.
  1511     12  TEXT-FILE-ID                PIC XX.
  1512         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1513         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1514         88  HELP-FILE-TEXT             VALUE 'TH'.
  1515
  1516     12  TX-CONTROL-PRIMARY.
  1517         16  TX-COMPANY-CD           PIC X.
  1518             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1519         16  TX-ACCESS-CD-GENL       PIC X(12).
  1520
  1521         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  28
* EL1041.cbl
  1522             20  TX-LETTER-NO        PIC X(4).
  1523             20  FILLER              PIC X(8).
  1524
  1525         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1526             20  TX-FORM-NO          PIC X(12).
  1527
  1528         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1529             20  TX-HELP-TYPE        PIC X.
  1530                 88  HELP-FOR-GENERAL   VALUE ' '.
  1531                 88  HELP-BY-SCREEN     VALUE 'S'.
  1532                 88  HELP-BY-ERROR      VALUE 'E'.
  1533             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1534                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1535             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1536                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1537             20  FILLER              PIC X(4).
  1538
  1539         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1540
  1541     12  TX-PROCESS-CONTROL          PIC XX.
  1542         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1543
  1544     12  TX-TEXT-LINE                PIC X(70).
  1545
  1546     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1547         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1548         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1549         88  TX-VALID-FORM-SQUEEZE-VALUE
  1550                                        VALUE 'Y' ' '.
  1551
  1552     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1553         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1554         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1555         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1556         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1557         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1558         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1559         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1560                                              'K' 'N' ' '
  1561                                              'Z'.
  1562
  1563     12  TX-ARCHIVE-SW               PIC X.
  1564         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1565         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1566         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1567
  1568     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1569     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1570
  1571     12  TX-BSR-CODE                 PIC X.
  1572         88  TX-BSR-LETTER              VALUE 'B'.
  1573         88  TX-NON-BSR-LETTER          VALUE ' '.
  1574
  1575     12  FILLER                      PIC X.
  1576*****************************************************************
  1577*                                    COPY ELCENCC.
  1578******************************************************************
  1579*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  29
* EL1041.cbl
  1580*                                                                *
  1581*                            ELCENCC                             *
  1582*                            VMOD=2.001                          *
  1583*                                                                *
  1584*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  1585*                                                                *
  1586*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  1587*   A NAPERSOFT DOCUMENT                                         *
  1588*                                                                *
  1589*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  1590*                                                                *
  1591*   FILE TYPE = VSAM,KSDS                                        *
  1592*   RECORD SIZE = 400   RECFORM = FIX                            *
  1593*                                                                *
  1594*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  1595*                                                                *
  1596*   LOG = NO                                                     *
  1597*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1598*                                                                *
  1599*                                                                *
  1600******************************************************************
  1601*                   C H A N G E   L O G
  1602*
  1603* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1604*-----------------------------------------------------------------
  1605*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1606* EFFECTIVE    NUMBER
  1607*-----------------------------------------------------------------
  1608* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  1609******************************************************************
  1610 01  ENCLOSURE-CODES.
  1611     12  NC-RECORD-ID                      PIC XX.
  1612         88  VALID-NC-ID                      VALUE 'NC'.
  1613     12  NC-CONTROL-PRIMARY.
  1614         16  NC-COMPANY-CD                 PIC X.
  1615         16  NC-REC-TYPE                   PIC X.
  1616             88  NC-CLAIMS                   VALUE '1'.
  1617             88  NC-ADMIN                    VALUE '2'.
  1618         16  NC-ENC-CODE                   PIC X(5).
  1619         16  FILLER                        PIC X(09).
  1620     12  NC-MAINT-INFORMATION.
  1621         16  NC-LAST-MAINT-DT              PIC XX.
  1622         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1623         16  NC-LAST-MAINT-USER            PIC X(4).
  1624         16  FILLER                        PIC XX.
  1625     12  NC-OUTPUT-STACK                   PIC XXX.
  1626     12  NC-ENCLOSURE-LINE                 PIC X(100).
  1627     12  NC-ATTACHMENTS                    PIC X(100).
  1628     12  NC-FUTURE                         PIC X(50).
  1629     12  FILLER                            PIC X(117).
  1630******************************************************************
  1631 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES
  1632                          ENCLOSURE-CODES.
  1633 0000-DFHEXIT SECTION.
  1634     MOVE '9#                    $   ' TO DFHEIV0.
  1635     MOVE 'EL1041' TO DFHEIV1.
  1636     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1637     MOVE EIBDATE                TO DC-JULIAN-YYDDD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  30
* EL1041.cbl
  1638     MOVE '5'                    TO DC-OPTION-CODE
  1639     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1640     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1641     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1642     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1643     IF EIBCALEN = 0
  1644        GO TO 8800-UNAUTHORIZED-ACCESS.
  1645     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1646     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1647     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1648
  1649* EXEC CICS HANDLE CONDITION
  1650*        DUPREC     (8850-DUPREC)
  1651*        NOTOPEN    (8870-NOTOPEN)
  1652*        NOTFND     (8880-NOT-FOUND)
  1653*        PGMIDERR   (9600-PGMID-ERROR)
  1654*        ERROR      (9990-ABEND)
  1655*    END-EXEC.
  1656*    MOVE '"$%JIL.               ! " #00001644' TO DFHEIV0
  1657     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1658     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1659     MOVE X'2220233030303031363434' TO DFHEIV0(25:11)
  1660     CALL 'kxdfhei1' USING DFHEIV0
  1661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1662
  1663     .
  1664 0150-SET-PROGRAM-SAVES.
  1665     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1666         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1667             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1668             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1669             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1670             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1671             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1672             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1673             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1674             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1675         ELSE
  1676             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1677             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1678             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1679             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1680             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1681             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1682             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1683             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1684     ELSE
  1685         GO TO 0200-RECEIVE.
  1686     DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1687     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1688     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1689     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1690     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1691                                    PI-PREV-LETR-KEY
  1692
  1693     PERFORM 6500-BUILD-CURRENT-CODES THRU 6500-EXIT
  1694
  1695     GO TO 1000-SHOW-LETR-RECORD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  31
* EL1041.cbl
  1696     .
  1697 0200-RECEIVE.
  1698     IF EIBAID = DFHCLEAR
  1699        GO TO 9400-CLEAR.
  1700     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1701         MOVE LOW-VALUES             TO  EL104ZI
  1702         MOVE ER-7008                TO  EMI-ERROR
  1703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1704         MOVE -1                     TO  MAINTL
  1705         GO TO 8200-SEND-DATAONLY.
  1706     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1707         NEXT SENTENCE
  1708     ELSE
  1709
  1710* EXEC CICS READQ TS
  1711*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1712*            INTO   (SECURITY-CONTROL)
  1713*            LENGTH (SC-COMM-LENGTH)
  1714*            ITEM   (SC-ITEM)
  1715*        END-EXEC
  1716*    MOVE '*$II   L              ''   #00001697' TO DFHEIV0
  1717     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1719     MOVE X'2020233030303031363937' TO DFHEIV0(25:11)
  1720     CALL 'kxdfhei1' USING DFHEIV0,
  1721           PI-SECURITY-TEMP-STORE-ID,
  1722           SECURITY-CONTROL,
  1723           SC-COMM-LENGTH,
  1724           SC-ITEM,
  1725           DFHEIV99,
  1726           DFHEIV99
  1727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1728         MOVE SC-CLAIMS-DISPLAY (4)  TO  PI-DISPLAY-CAP
  1729         MOVE SC-CLAIMS-UPDATE  (4)  TO  PI-MODIFY-CAP.
  1730
  1731* EXEC CICS RECEIVE
  1732*        MAP      (WS-MAP-NAME)
  1733*        MAPSET   (MAPSET-NAME)
  1734*        INTO     (EL104ZI)
  1735*    END-EXEC
  1736     MOVE LENGTH OF
  1737      EL104ZI
  1738       TO DFHEIV11
  1739*    MOVE '8"T I  L              ''   #00001705' TO DFHEIV0
  1740     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1742     MOVE X'2020233030303031373035' TO DFHEIV0(25:11)
  1743     CALL 'kxdfhei1' USING DFHEIV0,
  1744           WS-MAP-NAME,
  1745           EL104ZI,
  1746           DFHEIV11,
  1747           MAPSET-NAME,
  1748           DFHEIV99,
  1749           DFHEIV99
  1750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1751     IF PFKEYL = +0
  1752         GO TO 0300-CHECK-PFKEYS.
  1753     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  32
* EL1041.cbl
  1754         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1755     ELSE
  1756         MOVE ER-0029                TO  EMI-ERROR
  1757         GO TO 0320-INPUT-ERROR.
  1758 0300-CHECK-PFKEYS.
  1759     DISPLAY ' MADE IT TO 0300 '
  1760     IF EIBAID EQUAL DFHPF23
  1761         GO TO 8810-PF23.
  1762     IF EIBAID EQUAL DFHPF24
  1763         GO TO 9200-RETURN-MAIN-MENU.
  1764     IF EIBAID EQUAL DFHPF12
  1765         GO TO 9500-PF12.
  1766     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1767         MOVE ER-0050            TO EMI-ERROR
  1768         GO TO 0320-INPUT-ERROR.
  1769     IF EIBAID EQUAL DFHENTER
  1770         GO TO 0330-EDIT-DATA.
  1771     MOVE ER-0029                    TO  EMI-ERROR.
  1772 0320-INPUT-ERROR.
  1773     DISPLAY ' MADE IT TO 0320 '
  1774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1775     MOVE AL-UNBON                   TO  PFKEYA.
  1776     MOVE -1                         TO  PFKEYL.
  1777     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  33
* EL1041.cbl
  1779 0330-EDIT-DATA.
  1780     IF NOT DISPLAY-CAP
  1781         MOVE 'READ'                 TO  SM-READ
  1782         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1783         MOVE ER-0070                TO  EMI-ERROR
  1784         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1785         MOVE -1                     TO  MAINTL
  1786         GO TO 8100-SEND-INITIAL-MAP.
  1787     IF MAINTI EQUAL 'S'
  1788        GO TO 1000-SHOW-LETR-RECORD.
  1789     IF MAINTI = 'C' OR 'A'
  1790        IF NOT MODIFY-CAP
  1791           PERFORM 9995-SECURITY-VIOLATION
  1792                                 THRU 9995-EXIT
  1793           MOVE ER-0070          TO EMI-ERROR
  1794           PERFORM 9900-ERROR-FORMAT
  1795                                 THRU 9900-EXIT
  1796           MOVE LOW-VALUES       TO EL104ZO
  1797           MOVE -1               TO MAINTL
  1798           GO TO 8100-SEND-INITIAL-MAP
  1799        END-IF
  1800     END-IF
  1801     IF MAINTI = 'C'
  1802        GO TO 2000-CHANGE-LETR-RECORD
  1803     END-IF
  1804     IF MAINTI = 'A'
  1805        GO TO 3000-ADD-LETR-RECORD
  1806     END-IF
  1807     MOVE ER-0023                    TO  EMI-ERROR.
  1808     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1809     MOVE -1                         TO  MAINTL.
  1810     MOVE AL-UABON                   TO  MAINTA.
  1811     GO TO 8200-SEND-DATAONLY.
  1812 1000-SHOW-LETR-RECORD.
  1813     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1814
  1815* EXEC CICS STARTBR
  1816*        DATASET   (ELLETR-FILE-ID)
  1817*        RIDFLD    (ELLETR-KEY)
  1818*        GTEQ
  1819*        RESP      (WS-RESPONSE)
  1820*    END-EXEC
  1821     MOVE 0
  1822       TO DFHEIV11
  1823*    MOVE '&,         G          &  N#00001773' TO DFHEIV0
  1824     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1825     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1826     MOVE X'204E233030303031373733' TO DFHEIV0(25:11)
  1827     CALL 'kxdfhei1' USING DFHEIV0,
  1828           ELLETR-FILE-ID,
  1829           ELLETR-KEY,
  1830           DFHEIV99,
  1831           DFHEIV11,
  1832           DFHEIV99
  1833     MOVE EIBRESP  TO WS-RESPONSE
  1834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1835     IF RESP-NORMAL
  1836        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  34
* EL1041.cbl
  1837           OR WE-FOUND-IT
  1838
  1839* EXEC CICS READNEXT
  1840*              DATASET    (ELLETR-FILE-ID)
  1841*              SET        (ADDRESS OF TEXT-FILES)
  1842*              RIDFLD     (ELLETR-KEY)
  1843*              RESP       (WS-RESPONSE)
  1844*          END-EXEC
  1845     MOVE 0
  1846       TO DFHEIV11
  1847*    MOVE '&.S                   )  N#00001782' TO DFHEIV0
  1848     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1849     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1850     MOVE X'204E233030303031373832' TO DFHEIV0(25:11)
  1851     CALL 'kxdfhei1' USING DFHEIV0,
  1852           ELLETR-FILE-ID,
  1853           DFHEIV20,
  1854           DFHEIV99,
  1855           ELLETR-KEY,
  1856           DFHEIV99,
  1857           DFHEIV11,
  1858           DFHEIV99,
  1859           DFHEIV99
  1860     SET ADDRESS OF TEXT-FILES TO
  1861         DFHEIV20
  1862     MOVE EIBRESP  TO WS-RESPONSE
  1863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1864           IF (RESP-NORMAL)
  1865              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1866              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1867                 SET WE-FOUND-IT   TO TRUE
  1868              END-IF
  1869           ELSE
  1870              SET I-SAY-TO-STOP  TO TRUE
  1871           END-IF
  1872        END-PERFORM
  1873     END-IF
  1874     IF WE-FOUND-IT
  1875        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1876                                    PI-PREV-LETR-KEY
  1877        GO TO 7000-BUILD-OUTPUT-MAP
  1878     END-IF
  1879     MOVE ER-0418                TO EMI-ERROR.
  1880     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1881     MOVE -1                     TO MAINTL
  1882     MOVE 'A'                    TO MAINTI
  1883     MOVE AL-UANON               TO MAINTA
  1884     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1885     MOVE +4                     TO ZLETRL
  1886     MOVE AL-UANON               TO ZLETRA
  1887     GO TO 8100-SEND-INITIAL-MAP
  1888     .
  1889 2000-CHANGE-LETR-RECORD.
  1890     display ' made it to 2000 '
  1891     display ' curr   ' pi-curr-letr-key
  1892     display ' prev   ' pi-prev-letr-key
  1893     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1894        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  35
* EL1041.cbl
  1895        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1896        MOVE -1                  TO MAINTL
  1897        GO TO 8200-SEND-DATAONLY
  1898     END-IF
  1899     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1900     IF NOT EMI-NO-ERRORS
  1901         GO TO 8200-SEND-DATAONLY.
  1902     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1903     .
  1904 2000-CHANGE-CONTINUE.
  1905
  1906* EXEC CICS READ
  1907*        DATASET    (ELLETR-FILE-ID)
  1908*        SET        (ADDRESS OF TEXT-FILES)
  1909*        RIDFLD     (ELLETR-KEY)
  1910*        UPDATE
  1911*        RESP       (WS-RESPONSE)
  1912*    END-EXEC
  1913*    MOVE '&"S        EU         (  N#00001829' TO DFHEIV0
  1914     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1915     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1916     MOVE X'204E233030303031383239' TO DFHEIV0(25:11)
  1917     CALL 'kxdfhei1' USING DFHEIV0,
  1918           ELLETR-FILE-ID,
  1919           DFHEIV20,
  1920           DFHEIV99,
  1921           ELLETR-KEY,
  1922           DFHEIV99,
  1923           DFHEIV99,
  1924           DFHEIV99
  1925     SET ADDRESS OF TEXT-FILES TO
  1926         DFHEIV20
  1927     MOVE EIBRESP  TO WS-RESPONSE
  1928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1929     IF RESP-NOTFND
  1930        IF ELLETR-SEQ-NO = +0
  1931           GO TO 3000-CONTINUE-ADD
  1932        END-IF
  1933     END-IF
  1934     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1935        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1936
  1937* EXEC CICS UNLOCK
  1938*            DATASET   (ELLETR-FILE-ID)
  1939*        END-EXEC
  1940*    MOVE '&*                    #   #00001843' TO DFHEIV0
  1941     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1942     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1943     MOVE X'2020233030303031383433' TO DFHEIV0(25:11)
  1944     CALL 'kxdfhei1' USING DFHEIV0,
  1945           ELLETR-FILE-ID,
  1946           DFHEIV99
  1947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1948         MOVE ER-0068                TO  EMI-ERROR
  1949         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1950         GO TO 1000-SHOW-LETR-RECORD.
  1951     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1952     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  36
* EL1041.cbl
  1953     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1954     IF ZCOPIESL > +0
  1955        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1956     END-IF
  1957     IF ZFADAYSL > +0
  1958        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1959     END-IF
  1960     IF ZRDAYSL > +0
  1961        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  1962     END-IF
  1963     IF ZFORML > +0
  1964        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1965     END-IF
  1966     IF ZPROMPTL > +0
  1967        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1968     END-IF
  1969     IF ZENCCDL > +0
  1970        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1971     END-IF
  1972     IF ZACLOSEL > +0
  1973        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1974     END-IF
  1975     IF ZBENEL > +0
  1976        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1977     END-IF
  1978
  1979     IF ZBARCODL > +0
  1980        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  1981     END-IF
  1982
  1983     IF ZRETENVL > +0
  1984        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  1985     END-IF
  1986     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1987     .
  1988 2000-CONTINUE-CHANGE.
  1989     DISPLAY ' ABOUT TO REWRITE '
  1990
  1991* EXEC CICS REWRITE
  1992*        DATASET   (ELLETR-FILE-ID)
  1993*        FROM      (TEXT-FILES)
  1994*    END-EXEC.
  1995     MOVE LENGTH OF
  1996      TEXT-FILES
  1997       TO DFHEIV11
  1998*    MOVE '&& L                  %   #00001888' TO DFHEIV0
  1999     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2000     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2001     MOVE X'2020233030303031383838' TO DFHEIV0(25:11)
  2002     CALL 'kxdfhei1' USING DFHEIV0,
  2003           ELLETR-FILE-ID,
  2004           TEXT-FILES,
  2005           DFHEIV11,
  2006           DFHEIV99
  2007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2008
  2009     MOVE ER-0000                    TO  EMI-ERROR.
  2010     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  37
* EL1041.cbl
  2011     GO TO 1000-SHOW-LETR-RECORD
  2012     .
  2013 3000-ADD-LETR-RECORD.
  2014     display ' made it to 3000 '
  2015     display ' curr   ' pi-curr-letr-key
  2016     display ' prev   ' pi-prev-letr-key
  2017     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2018     .
  2019 3000-CONTINUE-ADD.
  2020     IF NOT EMI-NO-ERRORS
  2021        GO TO 8200-SEND-DATAONLY
  2022     END-IF
  2023     MOVE SPACES                 TO ELLETR-KEY
  2024     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  2025     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  2026     MOVE +0                     TO ELLETR-SEQ-NO
  2027
  2028* EXEC CICS READ
  2029*        DATASET    (ELLETR-FILE-ID)
  2030*        SET        (ADDRESS OF TEXT-FILES)
  2031*        RIDFLD     (ELLETR-KEY)
  2032*        GTEQ
  2033*        RESP       (WS-RESPONSE)
  2034*    END-EXEC
  2035*    MOVE '&"S        G          (  N#00001910' TO DFHEIV0
  2036     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2038     MOVE X'204E233030303031393130' TO DFHEIV0(25:11)
  2039     CALL 'kxdfhei1' USING DFHEIV0,
  2040           ELLETR-FILE-ID,
  2041           DFHEIV20,
  2042           DFHEIV99,
  2043           ELLETR-KEY,
  2044           DFHEIV99,
  2045           DFHEIV99,
  2046           DFHEIV99
  2047     SET ADDRESS OF TEXT-FILES TO
  2048         DFHEIV20
  2049     MOVE EIBRESP  TO WS-RESPONSE
  2050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2051     IF RESP-NORMAL
  2052        IF TX-LETTER-NO = ZLETRI
  2053           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2054              MOVE ER-0132       TO EMI-ERROR
  2055              PERFORM 9900-ERROR-FORMAT
  2056                                 THRU 9900-EXIT
  2057              MOVE -1            TO ZLETRL
  2058              MOVE AL-UABON      TO ZLETRA
  2059              GO TO 8200-SEND-DATAONLY
  2060           ELSE
  2061              MOVE +0            TO WS-SEQ-NO-TO-USE
  2062           END-IF
  2063        ELSE
  2064           MOVE +1               TO WS-SEQ-NO-TO-USE
  2065        END-IF
  2066     ELSE
  2067        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2068     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  38
* EL1041.cbl
  2069
  2070* EXEC CICS GETMAIN
  2071*       SET(ADDRESS OF TEXT-FILES)
  2072*       LENGTH(ELLETR-LENGTH)
  2073*    END-EXEC
  2074*    MOVE '," L                  $   #00001935' TO DFHEIV0
  2075     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2076     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2077     MOVE X'2020233030303031393335' TO DFHEIV0(25:11)
  2078     CALL 'kxdfhei1' USING DFHEIV0,
  2079           DFHEIV20,
  2080           ELLETR-LENGTH,
  2081           DFHEIV99
  2082     SET ADDRESS OF TEXT-FILES TO
  2083         DFHEIV20
  2084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2085     MOVE SPACES                 TO TEXT-FILES
  2086     MOVE 'TL'                   TO TEXT-FILE-ID
  2087     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2088     MOVE ZLETRI                 TO TX-LETTER-NO
  2089     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2090     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2091     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2092     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2093     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2094     IF ZCOPIESL > +0
  2095        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2096     ELSE
  2097        MOVE 1                   TO W-NUMBER-OF-COPIES
  2098     END-IF
  2099     IF ZFADAYSL > +0
  2100        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2101     ELSE
  2102        MOVE ZEROS               TO W-DAYS-TO-FOLLOW-UP
  2103     END-IF
  2104     IF ZRDAYSL > +0
  2105        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2106     ELSE
  2107        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2108     END-IF
  2109     IF ZFORML > +0
  2110        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2111     END-IF
  2112     IF ZPROMPTL > +0
  2113        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2114     END-IF
  2115     IF ZENCCDL > +0
  2116        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2117     END-IF
  2118     IF ZACLOSEL > +0
  2119        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2120     END-IF
  2121     IF ZBENEL > +0
  2122        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2123     END-IF
  2124
  2125     IF ZBARCODL > +0
  2126        MOVE ZBARCODI            TO W-ADD-BAR-CODE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  39
* EL1041.cbl
  2127     END-IF
  2128
  2129     IF ZRETENVL > +0
  2130        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2131     END-IF
  2132     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2133     DISPLAY ' ABOUT TO WRITE '
  2134     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2135                                    PI-CURR-LETR-KEY
  2136                                    PI-PREV-LETR-KEY
  2137
  2138* EXEC CICS WRITE
  2139*       DATASET (ELLETR-FILE-ID)
  2140*       FROM    (TEXT-FILES)
  2141*       RIDFLD  (ELLETR-KEY)
  2142*    END-EXEC
  2143     MOVE LENGTH OF
  2144      TEXT-FILES
  2145       TO DFHEIV11
  2146*    MOVE '&$ L                  ''   #00001991' TO DFHEIV0
  2147     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2148     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2149     MOVE X'2020233030303031393931' TO DFHEIV0(25:11)
  2150     CALL 'kxdfhei1' USING DFHEIV0,
  2151           ELLETR-FILE-ID,
  2152           TEXT-FILES,
  2153           DFHEIV11,
  2154           ELLETR-KEY,
  2155           DFHEIV99,
  2156           DFHEIV99
  2157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2158     MOVE ER-0000                    TO  EMI-ERROR.
  2159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2160     GO TO 1000-SHOW-LETR-RECORD
  2161     .
  2162 5000-FIND-NEXT-PROD-RECORD.
  2163*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2164*
  2165*    EXEC CICS STARTBR
  2166*        DATASET   (ELLETR-FILE-ID)
  2167*        RIDFLD    (ELLETR-KEY)
  2168*        GTEQ
  2169*        RESP      (WS-RESPONSE)
  2170*    END-EXEC
  2171*
  2172*    IF NOT RESP-NORMAL
  2173*       MOVE -1                  TO PFKEYL
  2174*       MOVE ER-0130             TO EMI-ERROR
  2175*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2176*       GO TO 8200-SEND-DATAONLY
  2177*    END-IF
  2178     .
  2179 5000-READNEXT-LOOP.
  2180*    EXEC CICS READNEXT
  2181*        DATASET   (ELLETR-FILE-ID)
  2182*        SET       (ADDRESS OF PRODUCT-MASTER)
  2183*        RIDFLD    (ELLETR-KEY)
  2184*        RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  40
* EL1041.cbl
  2185*    END-EXEC
  2186*
  2187*    IF (NOT RESP-NORMAL)
  2188*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2189*       PERFORM 5000-END-BROWSE
  2190*       MOVE -1                  TO PFKEYL
  2191*       MOVE ER-0130             TO EMI-ERROR
  2192*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2193*       GO TO 1000-SHOW-LETR-RECORD
  2194*    END-IF
  2195*
  2196*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2197*       GO TO 5000-READNEXT-LOOP
  2198*    END-IF
  2199*
  2200*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2201*
  2202*    PERFORM 5000-END-BROWSE
  2203*    GO TO 7000-BUILD-OUTPUT-MAP
  2204     .
  2205 5000-END-BROWSE.
  2206*    EXEC CICS ENDBR
  2207*        DATASET   (ELLETR-FILE-ID)
  2208*    END-EXEC
  2209     .
  2210 5100-FIND-PREV-PROD-RECORD.
  2211*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2212*    IF STATEL > +0
  2213*       MOVE STATEI              TO ELLETR-STATE
  2214*    END-IF
  2215*    IF PRODCDL > +0
  2216*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2217*    END-IF
  2218*    IF BENTYPL > +0
  2219*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2220*    IF BENCODEL > +0
  2221*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2222*    IF EXPDTL IS GREATER THAN +0
  2223*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2224*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2225*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2226*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2227*        ELSE
  2228*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2229*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2230*          END-STRING
  2231*           MOVE 'L'                    TO  DC-OPTION-CODE
  2232*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2233*            IF NO-CONVERSION-ERROR
  2234*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2235*            ELSE
  2236*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2237*
  2238*    EXEC CICS HANDLE CONDITION
  2239*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2240*    END-EXEC.
  2241*
  2242*    EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  41
* EL1041.cbl
  2243*        DATASET   (ELLETR-FILE-ID)
  2244*        RIDFLD    (ELLETR-KEY)
  2245*        GTEQ
  2246*    END-EXEC.
  2247 5100-READPREV-LOOP.
  2248*    EXEC CICS READPREV
  2249*        DATASET   (ELLETR-FILE-ID)
  2250*        SET       (ADDRESS OF PRODUCT-MASTER)
  2251*        RIDFLD    (ELLETR-KEY)
  2252*    END-EXEC.
  2253*
  2254*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2255*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2256*
  2257*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2258*        GO TO 5100-READPREV-LOOP.
  2259*
  2260*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2261*
  2262*    GO TO 7000-BUILD-OUTPUT-MAP.
  2263 5100-END-BROWSE.
  2264*    EXEC CICS ENDBR
  2265*        DATASET   (ELLETR-FILE-ID)
  2266*    END-EXEC.
  2267 5100-UNSUCCESSFUL-SEARCH.
  2268     PERFORM 5100-END-BROWSE.
  2269     MOVE ER-0131                    TO  EMI-ERROR.
  2270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2271     GO TO 1000-SHOW-LETR-RECORD.
  2272     .
  2273 6000-EDIT-INPUT-DATA.
  2274     IF MAINTI = 'A'
  2275        IF ZLETRL > +0
  2276           AND ZLETRI NOT = SPACES
  2277           CONTINUE
  2278        ELSE
  2279           MOVE AL-UNBON         TO ZCOPIESA
  2280           MOVE -1               TO ZCOPIESL
  2281           MOVE ER-0005          TO EMI-ERROR
  2282           PERFORM 9900-ERROR-FORMAT
  2283                                 THRU 9900-EXIT
  2284        END-IF
  2285     END-IF
  2286     IF ZCOPIESL > +0
  2287        IF ZCOPIESI NUMERIC
  2288           CONTINUE
  2289        ELSE
  2290           MOVE AL-UNBON         TO ZCOPIESA
  2291           MOVE -1               TO ZCOPIESL
  2292           MOVE ER-0184          TO EMI-ERROR
  2293           PERFORM 9900-ERROR-FORMAT
  2294                                 THRU 9900-EXIT
  2295        END-IF
  2296     END-IF
  2297     IF ZFADAYSL > +0
  2298        IF ZFADAYSI NUMERIC
  2299           CONTINUE
  2300        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  42
* EL1041.cbl
  2301           MOVE AL-UNBON         TO ZFADAYSA
  2302           MOVE -1               TO ZFADAYSL
  2303           MOVE ER-0491          TO EMI-ERROR
  2304           PERFORM 9900-ERROR-FORMAT
  2305                                 THRU 9900-EXIT
  2306        END-IF
  2307     END-IF
  2308     IF ZRDAYSL > +0
  2309        IF ZRDAYSI NUMERIC
  2310           CONTINUE
  2311        ELSE
  2312           MOVE AL-UNBON         TO ZRDAYSA
  2313           MOVE -1               TO ZRDAYSL
  2314           MOVE ER-0491          TO EMI-ERROR
  2315           PERFORM 9900-ERROR-FORMAT
  2316                                 THRU 9900-EXIT
  2317        END-IF
  2318     END-IF
  2319     IF ZPROMPTL > +0
  2320        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2321           CONTINUE
  2322        ELSE
  2323           MOVE AL-UABON         TO ZPROMPTA
  2324           MOVE -1               TO ZPROMPTL
  2325           MOVE ER-0627          TO EMI-ERROR
  2326           PERFORM 9900-ERROR-FORMAT
  2327                                 THRU 9900-EXIT
  2328        END-IF
  2329     END-IF
  2330     IF MAINTI = 'A'
  2331        AND ZENCCDL <= 0
  2332        MOVE AL-UABON            TO ZENCCDA
  2333        MOVE -1                  TO ZENCCDL
  2334        MOVE ER-1560             TO EMI-ERROR
  2335        PERFORM 9900-ERROR-FORMAT
  2336                                 THRU 9900-EXIT
  2337     END-IF
  2338     IF ZENCCDL > +0
  2339        IF ZENCCDI = '@'
  2340            CONTINUE
  2341        ELSE
  2342           MOVE SPACES             TO ELENCC-KEY
  2343           MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2344           MOVE '1'                TO ELENCC-REC-TYPE
  2345           MOVE ZENCCDI            TO ELENCC-ENC-CODE
  2346
  2347
  2348* EXEC CICS READ
  2349*              DATASET    (ELENCC-FILE-ID)
  2350*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2351*              RIDFLD     (ELENCC-KEY)
  2352*              RESP       (WS-RESPONSE)
  2353*          END-EXEC
  2354*    MOVE '&"S        E          (  N#00002185' TO DFHEIV0
  2355     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2357     MOVE X'204E233030303032313835' TO DFHEIV0(25:11)
  2358     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  43
* EL1041.cbl
  2359           ELENCC-FILE-ID,
  2360           DFHEIV20,
  2361           DFHEIV99,
  2362           ELENCC-KEY,
  2363           DFHEIV99,
  2364           DFHEIV99,
  2365           DFHEIV99
  2366     SET ADDRESS OF ENCLOSURE-CODES TO
  2367         DFHEIV20
  2368     MOVE EIBRESP  TO WS-RESPONSE
  2369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2370
  2371           IF RESP-NORMAL
  2372              CONTINUE
  2373           ELSE
  2374              MOVE AL-UABON         TO ZENCCDA
  2375              MOVE -1               TO ZENCCDL
  2376              MOVE ER-1560          TO EMI-ERROR
  2377              PERFORM 9900-ERROR-FORMAT
  2378                                 THRU 9900-EXIT
  2379           END-IF
  2380        END-IF
  2381     END-IF
  2382     IF ZACLOSEL > +0
  2383        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2384           CONTINUE
  2385        ELSE
  2386           MOVE -1               TO ZACLOSEL
  2387           MOVE AL-UABON         TO ZACLOSEA
  2388           MOVE ER-1562          TO EMI-ERROR
  2389           PERFORM 9900-ERROR-FORMAT
  2390                                 THRU 9900-EXIT
  2391        END-IF
  2392     END-IF
  2393     IF ZBENEL > +0
  2394        IF ZBENEI = 'Y' OR 'N' OR ' '
  2395           CONTINUE
  2396        ELSE
  2397           MOVE AL-UABON         TO ZBENEA
  2398           MOVE -1               TO ZBENEL
  2399           MOVE ER-0627          TO EMI-ERROR
  2400           PERFORM 9900-ERROR-FORMAT
  2401                                 THRU 9900-EXIT
  2402        END-IF
  2403     END-IF
  2404
  2405     IF ZBARCODL > +0
  2406        IF ZBARCODI = 'Y' OR 'N' OR ' '
  2407           CONTINUE
  2408        ELSE
  2409           MOVE AL-UABON         TO ZBARCODA
  2410           MOVE -1               TO ZBARCODL
  2411           MOVE ER-0627          TO EMI-ERROR
  2412           PERFORM 9900-ERROR-FORMAT
  2413                                 THRU 9900-EXIT
  2414        END-IF
  2415     END-IF
  2416
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  44
* EL1041.cbl
  2417     IF ZRETENVL > +0
  2418        IF ZRETENVI = 'Y' OR 'N' OR ' '
  2419           CONTINUE
  2420        ELSE
  2421           MOVE AL-UABON         TO ZRETENVA
  2422           MOVE -1               TO ZRETENVL
  2423           MOVE ER-0627          TO EMI-ERROR
  2424           PERFORM 9900-ERROR-FORMAT
  2425                                 THRU 9900-EXIT
  2426        END-IF
  2427     END-IF
  2428     .
  2429 6000-EXIT.
  2430     EXIT.
  2431
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  45
* EL1041.cbl
  2433 6500-BUILD-CURRENT-CODES.
  2434      MOVE SPACES             TO ELENCC-KEY
  2435      MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2436      MOVE '1'                TO ELENCC-REC-TYPE
  2437      MOVE LOW-VALUES         TO ELENCC-ENC-CODE
  2438      MOVE SPACES             TO HOLD-ENC-CODES
  2439      MOVE '@'                TO HOLD-ENC-CODES (1:1)
  2440      MOVE HOLD-ENC-CODES     TO PI-ENC-CODES
  2441
  2442
  2443* EXEC CICS STARTBR
  2444*        DATASET   (ELENCC-FILE-ID)
  2445*        RIDFLD    (ELENCC-KEY)
  2446*        GTEQ
  2447*        RESP      (WS-RESPONSE)
  2448*     END-EXEC
  2449     MOVE 0
  2450       TO DFHEIV11
  2451*    MOVE '&,         G          &  N#00002263' TO DFHEIV0
  2452     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2454     MOVE X'204E233030303032323633' TO DFHEIV0(25:11)
  2455     CALL 'kxdfhei1' USING DFHEIV0,
  2456           ELENCC-FILE-ID,
  2457           ELENCC-KEY,
  2458           DFHEIV99,
  2459           DFHEIV11,
  2460           DFHEIV99
  2461     MOVE EIBRESP  TO WS-RESPONSE
  2462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2463
  2464      IF RESP-NORMAL
  2465        PERFORM UNTIL DONE-WITH-ENCC
  2466           MOVE PI-ENC-CODES TO HOLD-ENC-CODES
  2467
  2468* EXEC CICS READNEXT
  2469*              DATASET    (ELENCC-FILE-ID)
  2470*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2471*              RIDFLD     (ELENCC-KEY)
  2472*              RESP       (WS-RESPONSE)
  2473*          END-EXEC
  2474     MOVE 0
  2475       TO DFHEIV11
  2476*    MOVE '&.S                   )  N#00002273' TO DFHEIV0
  2477     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2478     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2479     MOVE X'204E233030303032323733' TO DFHEIV0(25:11)
  2480     CALL 'kxdfhei1' USING DFHEIV0,
  2481           ELENCC-FILE-ID,
  2482           DFHEIV20,
  2483           DFHEIV99,
  2484           ELENCC-KEY,
  2485           DFHEIV99,
  2486           DFHEIV11,
  2487           DFHEIV99,
  2488           DFHEIV99
  2489     SET ADDRESS OF ENCLOSURE-CODES TO
  2490         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  46
* EL1041.cbl
  2491     MOVE EIBRESP  TO WS-RESPONSE
  2492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2493           IF (RESP-NORMAL)
  2494              AND (ELENCC-COMPANY-CD = PI-COMPANY-CD)
  2495              AND (ELENCC-REC-TYPE = '1')
  2496                 PERFORM VARYING WS-SUB1 FROM 5 BY -1
  2497                      UNTIL ELENCC-ENC-CODE (WS-SUB1:1) <> ' '
  2498                 END-PERFORM
  2499                 IF WS-SUB1 > 2
  2500                     SUBTRACT +1 FROM WS-SUB1
  2501                 END-IF
  2502                 MOVE ELENCC-ENC-CODE (WS-SUB1:2) TO
  2503                             WS-TEST-STATE
  2504                 IF STATE-SPECIFIC AND
  2505                    ELENCC-ENC-CODE NOT = 'ENV'
  2506                    CONTINUE
  2507                 ELSE
  2508                    STRING HOLD-ENC-CODES DELIMITED BY ' '
  2509                         ','
  2510                         ELENCC-ENC-CODE DELIMITED BY ' '
  2511                    INTO PI-ENC-CODES
  2512                 end-if
  2513           ELSE
  2514              SET DONE-WITH-ENCC  TO TRUE
  2515           END-IF
  2516        END-PERFORM
  2517     END-IF
  2518
  2519     MOVE +53 TO PI-SPLIT-SUB
  2520     PERFORM UNTIL PI-ENC-CODES (PI-SPLIT-SUB:1) = ' ' OR ','
  2521         SUBTRACT +1 FROM PI-SPLIT-SUB
  2522     END-PERFORM
  2523
  2524     .
  2525 6500-EXIT.
  2526     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  47
* EL1041.cbl
  2528 7000-BUILD-OUTPUT-MAP.
  2529     MOVE LOW-VALUES             TO EL104ZO
  2530     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2531     MOVE TX-LETTER-NO           TO ZLETRO
  2532     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2533     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2534     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2535     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2536     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2537     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2538     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2539     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2540     MOVE W-ADD-BAR-CODE         TO ZBARCODO
  2541     MOVE W-HAS-RETURN-ENV       TO ZRETENVO
  2542     MOVE PI-SPLIT-SUB           TO WS-SUB1
  2543     COMPUTE WS-SUB2 = PI-SPLIT-SUB + 1
  2544     COMPUTE WS-SUB3 = 120 - PI-SPLIT-SUB
  2545     MOVE PI-ENC-CODES (1:WS-SUB1) TO ZCODES1O
  2546     MOVE PI-ENC-CODES (WS-SUB2:WS-SUB3) TO ZCODES2O
  2547     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2548                                    PI-UPDATE-BY
  2549     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2550                                    DC-BIN-DATE-1
  2551     MOVE ' '                    TO DC-OPTION-CODE
  2552     MOVE +0                     TO DC-ELAPSED-DAYS
  2553                                     DC-ELAPSED-MONTHS.
  2554     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2555     IF NO-CONVERSION-ERROR
  2556        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2557     ELSE
  2558        MOVE LOW-VALUES          TO LSTDTEO
  2559     END-IF
  2560     MOVE -1                     TO MAINTL
  2561     .
  2562 8100-SEND-INITIAL-MAP.
  2563     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2564     MOVE EIBTIME                    TO  TIME-IN.
  2565     MOVE SAVE-DATE                  TO  DATEO.
  2566     MOVE TIME-OUT                   TO  TIMEO
  2567     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2568     MOVE PI-PROCESSOR-ID        TO USERIDO
  2569     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
  2570        MOVE '6-IU CLM FORM,   7-CONTINUING IU,  ' TO DCCOPTO
  2571     END-IF
  2572
  2573* EXEC CICS SEND
  2574*        MAP      (WS-MAP-NAME)
  2575*        MAPSET   (MAPSET-NAME)
  2576*        FROM     (EL104ZO)
  2577*        ERASE
  2578*        CURSOR
  2579*    END-EXEC.
  2580     MOVE LENGTH OF
  2581      EL104ZO
  2582       TO DFHEIV12
  2583     MOVE -1
  2584       TO DFHEIV11
  2585*    MOVE '8$     CT  E    H L F ,   #00002358' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  48
* EL1041.cbl
  2586     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2587     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2588     MOVE X'2020233030303032333538' TO DFHEIV0(25:11)
  2589     CALL 'kxdfhei1' USING DFHEIV0,
  2590           WS-MAP-NAME,
  2591           EL104ZO,
  2592           DFHEIV12,
  2593           MAPSET-NAME,
  2594           DFHEIV99,
  2595           DFHEIV99,
  2596           DFHEIV99,
  2597           DFHEIV11,
  2598           DFHEIV99,
  2599           DFHEIV99,
  2600           DFHEIV99
  2601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2602
  2603     MOVE '104Z'                 TO PI-CURRENT-SCREEN-NO
  2604     GO TO 9100-RETURN-TRAN
  2605     .
  2606 8200-SEND-DATAONLY.
  2607     DISPLAY ' MADE IT TO 8200 '
  2608     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2609     MOVE EIBTIME                    TO  TIME-IN.
  2610     MOVE SAVE-DATE                  TO  DATEO.
  2611     MOVE TIME-OUT                   TO  TIMEO.
  2612     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2613     MOVE PI-PROCESSOR-ID        TO USERIDO
  2614
  2615* EXEC CICS SEND
  2616*        MAP      (WS-MAP-NAME)
  2617*        MAPSET   (MAPSET-NAME)
  2618*        FROM     (EL104ZO)
  2619*        DATAONLY
  2620*        CURSOR
  2621*    END-EXEC.
  2622     MOVE LENGTH OF
  2623      EL104ZO
  2624       TO DFHEIV12
  2625     MOVE -1
  2626       TO DFHEIV11
  2627*    MOVE '8$D    CT       H L F ,   #00002376' TO DFHEIV0
  2628     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2629     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2630     MOVE X'2020233030303032333736' TO DFHEIV0(25:11)
  2631     CALL 'kxdfhei1' USING DFHEIV0,
  2632           WS-MAP-NAME,
  2633           EL104ZO,
  2634           DFHEIV12,
  2635           MAPSET-NAME,
  2636           DFHEIV99,
  2637           DFHEIV99,
  2638           DFHEIV99,
  2639           DFHEIV11,
  2640           DFHEIV99,
  2641           DFHEIV99,
  2642           DFHEIV99
  2643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  49
* EL1041.cbl
  2644
  2645     GO TO 9100-RETURN-TRAN
  2646     .
  2647 8300-SEND-TEXT.
  2648
  2649* EXEC CICS SEND TEXT
  2650*        FROM  (LOGOFF-TEXT)
  2651*        LENGTH(LOGOFF-LENGTH)
  2652*        ERASE
  2653*        FREEKB
  2654*    END-EXEC.
  2655*    MOVE '8&      T  E F  H   F -   #00002386' TO DFHEIV0
  2656     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2657     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2658     MOVE X'2020233030303032333836' TO DFHEIV0(25:11)
  2659     CALL 'kxdfhei1' USING DFHEIV0,
  2660           LOGOFF-TEXT,
  2661           LOGOFF-LENGTH,
  2662           DFHEIV99,
  2663           DFHEIV99,
  2664           DFHEIV99,
  2665           DFHEIV99,
  2666           DFHEIV99,
  2667           DFHEIV99,
  2668           DFHEIV99,
  2669           DFHEIV99,
  2670           DFHEIV99,
  2671           DFHEIV99
  2672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2673
  2674
  2675* EXEC CICS RETURN
  2676*        END-EXEC.
  2677*    MOVE '.(                    ''   #00002392' TO DFHEIV0
  2678     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2679     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2680     MOVE X'2020233030303032333932' TO DFHEIV0(25:11)
  2681     CALL 'kxdfhei1' USING DFHEIV0,
  2682           DFHEIV99,
  2683           DFHEIV99,
  2684           DFHEIV99,
  2685           DFHEIV99,
  2686           DFHEIV99,
  2687           DFHEIV99
  2688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2689
  2690     .
  2691 8500-DEEDIT.
  2692     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2693                                 TO WS-9V999-OF-DEEDIT
  2694     .
  2695 8500-EXIT.
  2696     EXIT.
  2697 8600-DEEDIT.
  2698     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2699                                 TO WS-NUMVAL-OF-DEEDIT
  2700     .
  2701 8600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  50
* EL1041.cbl
  2702     EXIT.
  2703 8800-UNAUTHORIZED-ACCESS.
  2704     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2705     GO TO 8300-SEND-TEXT.
  2706 8810-PF23.
  2707     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2708     MOVE XCTL-005                   TO  PGM-NAME.
  2709     GO TO 9300-XCTL.
  2710 8850-DUPREC.
  2711     MOVE ER-0132                    TO  EMI-ERROR.
  2712     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2713     MOVE -1                         TO  MAINTL
  2714     MOVE AL-UABON                   TO  ZLETRA
  2715     GO TO 8100-SEND-INITIAL-MAP.
  2716 8870-NOTOPEN.
  2717     MOVE LOW-VALUES                 TO  EL104ZO.
  2718     MOVE -1                         TO  MAINTL.
  2719     MOVE ER-0701                    TO  EMI-ERROR.
  2720     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2721     GO TO 8100-SEND-INITIAL-MAP.
  2722 8880-NOT-FOUND.
  2723     MOVE ER-0702                    TO  EMI-ERROR.
  2724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2725     MOVE -1                         TO  MAINTL
  2726     MOVE AL-UABON                   TO  ZLETRA
  2727     GO TO 8100-SEND-INITIAL-MAP.
  2728     .
  2729 9100-RETURN-TRAN.
  2730     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2731
  2732* EXEC CICS RETURN
  2733*        TRANSID    (TRANS-ID)
  2734*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2735*        LENGTH     (PI-COMM-LENGTH)
  2736*    END-EXEC.
  2737*    MOVE '.(CT                  ''   #00002435' TO DFHEIV0
  2738     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2739     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2740     MOVE X'2020233030303032343335' TO DFHEIV0(25:11)
  2741     CALL 'kxdfhei1' USING DFHEIV0,
  2742           TRANS-ID,
  2743           PROGRAM-INTERFACE-BLOCK,
  2744           PI-COMM-LENGTH,
  2745           DFHEIV99,
  2746           DFHEIV99,
  2747           DFHEIV99
  2748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2749
  2750 9200-RETURN-MAIN-MENU.
  2751     MOVE XCTL-626                   TO  PGM-NAME.
  2752     GO TO 9300-XCTL.
  2753 9300-XCTL.
  2754
  2755* EXEC CICS XCTL
  2756*        PROGRAM    (PGM-NAME)
  2757*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2758*        LENGTH     (PI-COMM-LENGTH)
  2759*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  51
* EL1041.cbl
  2760*    MOVE '.$C                   %   #00002444' TO DFHEIV0
  2761     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2762     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2763     MOVE X'2020233030303032343434' TO DFHEIV0(25:11)
  2764     CALL 'kxdfhei1' USING DFHEIV0,
  2765           PGM-NAME,
  2766           PROGRAM-INTERFACE-BLOCK,
  2767           PI-COMM-LENGTH,
  2768           DFHEIV99
  2769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2770
  2771 9400-CLEAR.
  2772     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2773     GO TO 9300-XCTL.
  2774 9500-PF12.
  2775     MOVE XCTL-010                   TO  PGM-NAME.
  2776     GO TO 9300-XCTL.
  2777 9600-PGMID-ERROR.
  2778
  2779* EXEC CICS HANDLE CONDITION
  2780*        PGMIDERR   (8300-SEND-TEXT)
  2781*    END-EXEC.
  2782*    MOVE '"$L                   ! # #00002456' TO DFHEIV0
  2783     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2785     MOVE X'2320233030303032343536' TO DFHEIV0(25:11)
  2786     CALL 'kxdfhei1' USING DFHEIV0
  2787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2788
  2789     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2790     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2791     MOVE XCTL-005                   TO  PGM-NAME.
  2792     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2793     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2794     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  52
* EL1041.cbl
  2796 9700-LINK-DATE-CONVERT.
  2797
  2798* EXEC CICS LINK
  2799*        PROGRAM    ('ELDATCV')
  2800*        COMMAREA   (DATE-CONVERSION-DATA)
  2801*        LENGTH     (DC-COMM-LENGTH)
  2802*    END-EXEC.
  2803     MOVE 'ELDATCV' TO DFHEIV1
  2804*    MOVE '."C                   (   #00002467' TO DFHEIV0
  2805     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2807     MOVE X'2020233030303032343637' TO DFHEIV0(25:11)
  2808     CALL 'kxdfhei1' USING DFHEIV0,
  2809           DFHEIV1,
  2810           DATE-CONVERSION-DATA,
  2811           DC-COMM-LENGTH,
  2812           DFHEIV99,
  2813           DFHEIV99,
  2814           DFHEIV99,
  2815           DFHEIV99
  2816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2817
  2818 9700-EXIT.
  2819     EXIT.
  2820 9900-ERROR-FORMAT.
  2821     IF NOT EMI-ERRORS-COMPLETE
  2822         MOVE LINK-001               TO  PGM-NAME
  2823
  2824* EXEC CICS LINK
  2825*            PROGRAM    (PGM-NAME)
  2826*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2827*            LENGTH     (EMI-COMM-LENGTH)
  2828*        END-EXEC.
  2829*    MOVE '."C                   (   #00002477' TO DFHEIV0
  2830     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2831     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2832     MOVE X'2020233030303032343737' TO DFHEIV0(25:11)
  2833     CALL 'kxdfhei1' USING DFHEIV0,
  2834           PGM-NAME,
  2835           ERROR-MESSAGE-INTERFACE-BLOCK,
  2836           EMI-COMM-LENGTH,
  2837           DFHEIV99,
  2838           DFHEIV99,
  2839           DFHEIV99,
  2840           DFHEIV99
  2841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2842
  2843 9900-EXIT.
  2844     EXIT.
  2845 9990-ABEND.
  2846     MOVE LINK-004                   TO  PGM-NAME.
  2847     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2848
  2849* EXEC CICS LINK
  2850*        PROGRAM   (PGM-NAME)
  2851*        COMMAREA  (EMI-LINE1)
  2852*        LENGTH    (72)
  2853*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  53
* EL1041.cbl
  2854     MOVE 72
  2855       TO DFHEIV11
  2856*    MOVE '."C                   (   #00002487' TO DFHEIV0
  2857     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2858     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2859     MOVE X'2020233030303032343837' TO DFHEIV0(25:11)
  2860     CALL 'kxdfhei1' USING DFHEIV0,
  2861           PGM-NAME,
  2862           EMI-LINE1,
  2863           DFHEIV11,
  2864           DFHEIV99,
  2865           DFHEIV99,
  2866           DFHEIV99,
  2867           DFHEIV99
  2868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2869
  2870     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  54
* EL1041.cbl
  2872 9995-SECURITY-VIOLATION.
  2873*                            COPY ELCSCTP.
  2874******************************************************************
  2875*                                                                *
  2876*                            ELCSCTP                             *
  2877*                            VMOD=2.001                          *
  2878*                                                                *
  2879*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2880******************************************************************
  2881
  2882
  2883     MOVE EIBDATE          TO SM-JUL-DATE.
  2884     MOVE EIBTRMID         TO SM-TERMID.
  2885     MOVE THIS-PGM         TO SM-PGM.
  2886     MOVE EIBTIME          TO TIME-IN.
  2887     MOVE TIME-OUT         TO SM-TIME.
  2888     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2889
  2890
  2891* EXEC CICS LINK
  2892*         PROGRAM  ('EL003')
  2893*         COMMAREA (SECURITY-MESSAGE)
  2894*         LENGTH   (80)
  2895*    END-EXEC.
  2896     MOVE 'EL003' TO DFHEIV1
  2897     MOVE 80
  2898       TO DFHEIV11
  2899*    MOVE '."C                   (   #00002512' TO DFHEIV0
  2900     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2901     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2902     MOVE X'2020233030303032353132' TO DFHEIV0(25:11)
  2903     CALL 'kxdfhei1' USING DFHEIV0,
  2904           DFHEIV1,
  2905           SECURITY-MESSAGE,
  2906           DFHEIV11,
  2907           DFHEIV99,
  2908           DFHEIV99,
  2909           DFHEIV99,
  2910           DFHEIV99
  2911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2912
  2913
  2914******************************************************************
  2915
  2916 9995-EXIT.
  2917     EXIT.
  2918
  2919 9999-DFHBACK SECTION.
  2920     MOVE '9%                    "   ' TO DFHEIV0
  2921     MOVE 'EL1041' TO DFHEIV1
  2922     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2923     GOBACK.
  2924 9999-DFHEXIT.
  2925     IF DFHEIGDJ EQUAL 0001
  2926         NEXT SENTENCE
  2927     ELSE IF DFHEIGDJ EQUAL 2
  2928         GO TO 8850-DUPREC,
  2929               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  55
* EL1041.cbl
  2930               8880-NOT-FOUND,
  2931               9600-PGMID-ERROR,
  2932               9990-ABEND
  2933         DEPENDING ON DFHEIGDI
  2934     ELSE IF DFHEIGDJ EQUAL 3
  2935         GO TO 8300-SEND-TEXT
  2936         DEPENDING ON DFHEIGDI.
  2937     MOVE '9%                    "   ' TO DFHEIV0
  2938     MOVE 'EL1041' TO DFHEIV1
  2939     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2940     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4940     Code:        8010
