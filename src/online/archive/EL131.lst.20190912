* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    48* 021418  CR2017110200001  TANA  EDIT NAME CHANGE AGST INSRD TYPE
    49* 052918  CR2018031500002  TANA  Add Message for filing time limit
    50* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    51* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    52******************************************************************
    53
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   3
* EL131.cbl
    55 ENVIRONMENT DIVISION.
    56
    57 DATA DIVISION.
    58
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61
    62 77  FILLER  PIC X(32)  VALUE '********************************'.
    63 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    64 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    65 77  s1                          pic s999 comp-3 value+0.
    66 77  s2                          pic s999 comp-3 value+0.
    67 77  a1                          pic s999 comp-3 value+0.
    68 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    69 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    70 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    71 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    72 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    73 77  ws-max-extension            pic s999 comp-3 value +0.
    74 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    75 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    76 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    77     88  ERPDEF-FOUND                 VALUE 'Y'.
    78 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    79     88  TRLR-FILE-EOF                VALUE 'Y'.
    80 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    81     88  PAYMENT-PENDING              VALUE 'Y'.
    82 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    83     88  AUTH-RCVD                    VALUE 'Y'.
    84     88  NO-AUTH-RCVD                 VALUE 'N'.
    85 77  ws-eracct-sw                pic x  value ' '.
    86     88  acct-found                value 'Y'.
    87 77  ws-benper-sw                pic x   value ' '.
    88     88  good-benper               value 'Y'.
    89 77  ws-claim-type               pic x value ' '.
    90 77  ws-ben-per                  pic 99 value 00.
    91 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    92 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    93 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    94 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    95
    96 01  LCP-TIME-OF-DAY-XX.
    97     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    98     05  FILLER                    PIC 99.
    99 01  LCP-CICS-TIME                 PIC 9(15).
   100*                            COPY ELCSCTM.
   101******************************************************************
   102*                                                                *
   103*                                                                *
   104*                            ELCSCTM                             *
   105*                            VMOD=2.001                          *
   106*                                                                *
   107*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   108*                                                                *
   109******************************************************************
   110 01  SECURITY-MESSAGE.
   111     12  FILLER                          PIC X(30)
   112            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   4
* EL131.cbl
   113     12  SM-READ                         PIC X(6).
   114     12  FILLER                          PIC X(5)
   115            VALUE ' PGM='.
   116     12  SM-PGM                          PIC X(6).
   117     12  FILLER                          PIC X(5)
   118            VALUE ' OPR='.
   119     12  SM-PROCESSOR-ID                 PIC X(4).
   120     12  FILLER                          PIC X(6)
   121            VALUE ' TERM='.
   122     12  SM-TERMID                       PIC X(4).
   123     12  FILLER                          PIC XX   VALUE SPACE.
   124     12  SM-JUL-DATE                     PIC 9(5).
   125     12  FILLER                          PIC X    VALUE SPACE.
   126     12  SM-TIME                         PIC 99.99.
   127
   128
   129*                            COPY ELCSCRTY.
   130******************************************************************
   131*                                                                *
   132*                                                                *
   133*                            ELCSCRTY                            *
   134*                            VMOD=2.001                          *
   135*                                                                *
   136*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   137*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   138*        SAVED IN PI-SECURITY-ADDRESS.                           *
   139*                                                                *
   140******************************************************************
   141 01  SECURITY-CONTROL.
   142     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   143     12  FILLER                       PIC XX    VALUE 'SC'.
   144     12  SC-CREDIT-CODES.
   145         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   146             20  SC-CREDIT-DISPLAY    PIC X.
   147             20  SC-CREDIT-UPDATE     PIC X.
   148     12  SC-CLAIMS-CODES.
   149         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   150             20  SC-CLAIMS-DISPLAY    PIC X.
   151             20  SC-CLAIMS-UPDATE     PIC X.
   152
   153*                            COPY ELCNWA.
   154*****************************************************************
   155*                                                               *
   156*                                                               *
   157*                            ELCNWA.                            *
   158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   159*                            VMOD=2.003                         *
   160*                                                               *
   161*            M O V E   N A M E   W O R K   A R E A.             *
   162*                                                               *
   163*****************************************************************.
   164
   165 01  WS-NAME-WORK-AREA.
   166     05  WS-INSURED-LAST-NAME        PIC X(15).
   167     05  WS-INSURED-1ST-NAME         PIC X(12).
   168     05  WS-INSURED-MID-INIT         PIC X.
   169
   170     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   5
* EL131.cbl
   171         10  WS-NW                   PIC X
   172             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   173
   174     05  WS-NAME-WORK2.
   175         10  WS-NW2                  PIC X
   176             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   177                                        NWA-INDEX0.
   178
   179     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   180                                     COMP-3.
   181
   182
   183 01  ws-dcc-error-line.
   184     05  filler occurs 15.
   185         10  ws-error-no        pic x(4).
   186 01  WS-DATE-AREA.
   187     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   188     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   189     12  SAVE-DATE-CCYYMMDD.
   190         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   191         16  SAVE-DATE-YMD.
   192             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   193             20  FILLER         PIC X(4)    VALUE SPACES.
   194
   195 01  WS-BLANK                   PIC X       VALUE ' '.
   196
   197 01  CSO-WORK-FIELDS.
   198     05  WS-HOLD-CLAIM-STATUS    PIC X.
   199     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   200     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   201         10  WS-RECURRENT-YN     PIC X.
   202         10  FILLER              PIC X.
   203
   204 01  LITERALS-NUMBERS.
   205     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   206     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   207     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   208     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   209     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   210     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   211     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   212     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   213
   214     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   215     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   216     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   217     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   218     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   219     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   220     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   221     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   222     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   223     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   224
   225     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   226
   227     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   228
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   6
* EL131.cbl
   229     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   230     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   231     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   232     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   233     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   234     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   235     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   236     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   237     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   238     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   239     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   240     12  WS-CONTEST-NOTE      PIC X(44)
   241         VALUE 'CONTRACT NOW CONTESTABLE - INC/RPT DT CHGD'.
   242     12  WS-FILE-LIM-NOTE     PIC X(44)
   243         VALUE 'FILING TIME LIMIT OK - INCRD DT CHGD'.
   244
   245     12  WS-FILING-NOTE     PIC X(30)
   246         VALUE 'FILING TIME LIMIT EXCEEDED'.
   247
   248     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   249     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   250     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   251     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   252         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   253     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   254     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   255     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   256     12  WS-ICD-CODE-1           PIC X(8).
   257     12  WS-ICD-CODE-2           PIC X(8).
   258     12  WS-CLAIM-SEQU.
   259         16  FILLER              PIC X VALUE '('.
   260         16  WS-CURRENT-SEQU     PIC Z9.
   261         16  FILLER              PIC X(04) VALUE ' OF '.
   262         16  WS-OF-SEQU          PIC Z9.
   263         16  FILLER              PIC X VALUE ')'.
   264     12  WS-EDIT-BEN-CODE        PIC XX.
   265         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   266                                          '90' THRU '99'.
   267
   268     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   269     12  WS-EDIT-NUMBER          PIC ZZZ9.
   270
   271     12  WS-RESPONSE             PIC S9(8)   COMP.
   272         88  WS-RESP-NORMAL              VALUE +00.
   273         88  WS-RESP-ERROR               VALUE +01.
   274         88  WS-RESP-NOTFND              VALUE +13.
   275         88  WS-RESP-DUPKEY              VALUE +15.
   276         88  WS-RESP-NOTOPEN             VALUE +19.
   277         88  WS-RESP-ENDFILE             VALUE +20.
   278
   279     12  WS-MOS-PAID             PIC 999.
   280     12  WS-ODD-DAYS             PIC 99.
   281     12  WS-REM-MOS              PIC 999.
   282     12  WS-REM-DAYS             PIC 99.
   283     12  WS-TERM-IN-DAYS         PIC 9(4).
   284     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   285
   286     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   7
* EL131.cbl
   287     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   288     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   289     12  WS-RESET-SW             PIC X       VALUE 'N'.
   290     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   291     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   292     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   293
   294 01  DMD-DATE-YYYYMMDD.
   295     12  DMD-DECADE          PIC XX      VALUE SPACES.
   296     12  DMD-YYMMDD.
   297         16  DMD-YY          PIC XX      VALUE SPACES.
   298         16  DMD-MM          PIC XX      VALUE SPACES.
   299         16  DMD-DD          PIC XX      VALUE SPACES.
   300
   301 01  DMD-DATE-MMDDYYYY.
   302     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   303     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   304     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   305     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   306     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   307     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   308
   309 01  WS-MAIL-CODE.
   310     12  FILLER              PIC X.
   311     12  DMD-MAIL-CODE.
   312         16  WS-MAIL-4       PIC X(4).
   313         16  WS-MAIL-5       PIC X.
   314     12  FILLER              PIC X(4).
   315
   316     12  W-NAME-LAST             PIC  X(15).
   317     12  W-NAME-FIRST            PIC  X(15).
   318     12  W-NAME-MIDDLE.
   319         16  FILLER              PIC  X.
   320         16  W-NAME-MIDDLE-2     PIC  X.
   321         16  FILLER              PIC  X(13).
   322
   323*    COPY ELCDCTB.
   324******************************************************************
   325*                                                                *
   326*                                                                *
   327*                            ELCDCTB.                            *
   328*                            VMOD=2.002                          *
   329*                                                                *
   330*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   331*       COMMUNICATIONS AREA                                      *
   332*                                                                *
   333******************************************************************
   334 01  DCT-COMMUNICATION-AREA.
   335     12  DCT-BILLING-BANK-ID      PIC  X(05).
   336     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   337     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   338     12  DCT-PRODUCT-CODE         PIC  X(02).
   339     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   340     12  DCT-RETURN-CODE          PIC  X(02).
   341     12  DCT-MAIL-CODE            PIC  X(05).
   342     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   343     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   8
* EL131.cbl
   345 01  ERROR-SWITCHES.
   346     12  ERROR-SWITCH            PIC X.
   347         88  SCREEN-ERROR                    VALUE 'X'.
   348     12  MSTR-KEY-SWITCH         PIC X.
   349         88  MSTR-KEY-CHANGED                VALUE 'X'.
   350     12  CERT-KEY-SWITCH         PIC X.
   351*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   352         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   353*********SET TO Y IF PRIMARY KEY WILL CHANGE
   354         88  CERT-KEY-CHANGED                VALUE 'Y'.
   355     12  MSTR-SWITCH             PIC X.
   356         88  MSTR-UPDATES                    VALUE 'X'.
   357     12  crtt-switch             pic x value spaces.
   358         88  crtt-update             value 'X'.
   359     12  CERT-SWITCH             PIC X.
   360         88  CERT-UPDATES                    VALUE 'X'.
   361     12  UPDATE-SWITCH           PIC X.
   362         88  UPDATES-PRESENT                 VALUE 'X'.
   363     12  TRLR-SWITCH             PIC X.
   364         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   365         88  UPDATE-MADE                     VALUE 'Y'.
   366     12  NINETY-TRLR-SWITCH      PIC X.
   367         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   368     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   369         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   370     12  EARNINGS-CALC-SWITCH    PIC X.
   371         88  TEX-REG                         VALUE '4'.
   372         88  NET-PAY                         VALUE '5'.
   373     12  DLYACTV-SW              PIC X       VALUE 'N'.
   374         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page   9
* EL131.cbl
   376 01  EDIT-WORK-AREA.
   377     12  COUNT-2                 PIC 9.
   378     12  CALL-PGM                PIC X(8).
   379     12  TRANS-ID                PIC X(4).
   380     12  CHECK-PFKEYS            PIC 99.
   381     12  CHECK-MAINT             PIC X.
   382         88  ADD-ALPHA-RECORD                VALUE 'A'.
   383         88  CHANGE-CLAIM                    VALUE 'C'.
   384         88  DELETE-CLAIM                    VALUE 'D'.
   385         88  CHANGE-NAME                     VALUE 'N'.
   386         88  VALID-OPTIONS                   VALUE 'A' 'C'
   387                                                   'D' 'N'.
   388
   389     12  HOLD-BENEFIT            PIC XX.
   390     12  HOLD-FREQ               PIC XX.
   391     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   392     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   393     12  HOLD-PDTHRU             PIC XX.
   394     12  HOLD-ADDON              PIC XX.
   395     12  HOLD-NODAYS             PIC 9(4).
   396     12  HOLD-NOPMTS             PIC 9(3).
   397     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   398     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   399     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   400     12  HOLD-BIRTH              PIC XX.
   401     12  HOLD-END                PIC XX.
   402     12  HOLD-EFF                PIC XX.
   403     12  HOLD-ENTRY              PIC XX.
   404     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   405     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   406     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   407     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   408     12  HOLD-LF-CV-CAN          PIC XX.
   409     12  HOLD-AH-CV-CAN          PIC XX.
   410     12  DIVIDE-QUOT             PIC 9(3).
   411     12  DIVIDE-REM              PIC 9(3).
   412
   413     12  WS-ALPHA-DATE.
   414         16  WS-ALPHA-YEAR.
   415             20  WS-ALPHA-YY-1   PIC 99.
   416             20  WS-ALPHA-YY-2   PIC 99.
   417         16  WS-ALPHA-MM         PIC 99.
   418         16  WS-ALPHA-DD         PIC 99.
   419
   420     12  BUILD-VALID-DATE.
   421         16  BUILD-MONTH         PIC 99.
   422         16  BUILD-DAY           PIC 99.
   423         16  BUILD-YEAR          PIC 99.
   424     12  DEEDIT-MMYY-INPUT.
   425         16  FILLER              PIC X.
   426         16  DEEDIT-MONTH        PIC XX.
   427         16  DEEDIT-YEAR         PIC XX.
   428     12  DEEDIT-BEN              PIC 9(9)V99.
   429     12  DEEDIT-DATE-INPUT.
   430         16  FILLER              PIC XX.
   431         16  DEEDIT-DATE         PIC X(6).
   432     12  WORK-DATE-MDY.
   433         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  10
* EL131.cbl
   434         16  FILLER              PIC X(4).
   435         16  YEAR-WORK           PIC XX.
   436     12  WORK-DATE-MY.
   437         16  WORK-MONTH          PIC XX.
   438         16  WORK-SLASH          PIC X       VALUE '/'.
   439         16  WORK-YEAR           PIC XX.
   440     12  HOLD-DATE.
   441         16  HOLD-MONTH          PIC 99.
   442         16  FILLER              PIC X(4).
   443         16  HOLD-YEAR           PIC 99.
   444     12  SPLIT-INFO-LINE-1.
   445         16  SPLIT-INFO-DESC     PIC X(15).
   446         16  FILLER              PIC X(5)    VALUE ' OLD='.
   447         16  SPLIT-INFO-OLD      PIC X(40).
   448     12  EFF-TERM-MO             PIC 9(4).
   449     12  CURR-MO                 PIC 9(4).
   450     12  WS-BIN-CURRENT-DT       PIC XX.
   451     12  WS-CALC-METHOD          PIC X.
   452     12  WS-INITIALS.
   453         16  WS-INIT-1           PIC X.
   454         16  WS-INIT-2           PIC X.
   455     12  WS-REIN-TABLE.
   456         16  WS-REIN-1           PIC X.
   457         16  WS-REIN-2           PIC X.
   458         16  WS-REIN-3           PIC X.
   459     12  PI-KEY.
   460         16  PI-TERM             PIC X(4).
   461         16  PI-QUAL             PIC X(4).
   462     12  CHECK-KEY               PIC X(20).
   463     12  SAVE-ACCT-KEY           PIC X(20).
   464     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   465     12  WS-SOC-SEC-NUMBER.
   466         16  WS-SOC-SEC-NO       PIC 9(9).
   467         16  WS-SOC-SEC-BLANK    PIC X(2).
   468     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   469         16  WS-SSN-1-3          PIC 9(3).
   470         16  WS-SSN-DASH1        PIC X(1).
   471         16  WS-SSN-4-5          PIC 9(2).
   472         16  WS-SSN-DASH2        PIC X(1).
   473         16  WS-SSN-6-9          PIC 9(4).
   474     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   475     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   476
   477 01  WS-SAVE-FIELDS.
   478     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   479     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   480     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   481     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   482     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   483     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   484     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   485     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   486     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   487     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   488     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   489     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   490     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   491     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  11
* EL131.cbl
   492     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   493     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   494     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   495     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   496     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   497     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   498     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   499     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   500     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   501     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   502     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   503     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   504     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   505     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   506     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   507     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   508     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   509     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   510     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   511     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   512     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   513     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   514     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   515     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   516     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   517     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   518     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   519     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   520     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   521     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   522     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   523     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   524     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   525     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   526     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   527     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   528     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   529     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   530     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   531     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   532     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   533
   534 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   535     12  M                   PIC S9(7)V99           VALUE ZEROS.
   536     12  L                   PIC S9(7)V99           VALUE ZEROS.
   537     12  N                   PIC S9(3)              VALUE ZEROS.
   538     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   539     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   540     12  I                   PIC S99V9(5)           VALUE ZEROS.
   541     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   542     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   543     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   544     12  R                   PIC S9(3)              VALUE ZEROS.
   545     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   546     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   547     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   548     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   549     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  12
* EL131.cbl
   550     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   551     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   552     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   553     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   554
   555 01  TERM-CALC-WORK-AREA.
   556     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   557     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   558     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   559     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   560     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   561     12  V-EXPONENTS.
   562        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   563     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   564
   565 01  TIME-IN.
   566     12  UN-HOURS                PIC XX.
   567     12  UN-MINUTES              PIC XX.
   568     12  FILLER                  PIC XX.
   569
   570 01  TIME-OUT.
   571     12  FOR-HOURS               PIC XX.
   572     12  FILLER                  PIC X       VALUE '.'.
   573     12  FOR-MINUTES             PIC XX.
   574
   575 01  ERROR-NUMBERS.
   576     12  ER-0000                 PIC X(4)    VALUE '0000'.
   577     12  ER-0004                 PIC X(4)    VALUE '0004'.
   578     12  ER-0008                 PIC X(4)    VALUE '0008'.
   579     12  ER-0023                 PIC X(4)    VALUE '0023'.
   580     12  ER-0029                 PIC X(4)    VALUE '0029'.
   581     12  ER-0068                 PIC X(4)    VALUE '0068'.
   582     12  ER-0070                 PIC X(4)    VALUE '0070'.
   583     12  ER-0149                 PIC X(4)    VALUE '0149'.
   584     12  ER-0154                 PIC X(4)    VALUE '0154'.
   585     12  ER-0169                 PIC X(4)    VALUE '0169'.
   586     12  ER-0192                 PIC X(4)    VALUE '0192'.
   587     12  ER-0199                 PIC X(4)    VALUE '0199'.
   588     12  ER-0203                 PIC X(4)    VALUE '0203'.
   589     12  ER-0204                 PIC X(4)    VALUE '0204'.
   590     12  ER-0205                 PIC X(4)    VALUE '0205'.
   591     12  ER-0206                 PIC X(4)    VALUE '0206'.
   592     12  ER-0208                 PIC X(4)    VALUE '0208'.
   593     12  ER-0210                 PIC X(4)    VALUE '0210'.
   594     12  ER-0215                 PIC X(4)    VALUE '0215'.
   595     12  ER-0219                 PIC X(4)    VALUE '0219'.
   596     12  ER-0220                 PIC X(4)    VALUE '0220'.
   597     12  ER-0222                 PIC X(4)    VALUE '0222'.
   598     12  ER-0223                 PIC X(4)    VALUE '0223'.
   599     12  ER-0224                 PIC X(4)    VALUE '0224'.
   600     12  ER-0227                 PIC X(4)    VALUE '0227'.
   601     12  ER-0230                 PIC X(4)    VALUE '0230'.
   602     12  ER-0232                 PIC X(4)    VALUE '0232'.
   603     12  ER-0233                 PIC X(4)    VALUE '0233'.
   604     12  ER-0236                 PIC X(4)    VALUE '0236'.
   605     12  ER-0237                 PIC X(4)    VALUE '0237'.
   606     12  ER-0238                 PIC X(4)    VALUE '0238'.
   607     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  13
* EL131.cbl
   608     12  ER-0241                 PIC X(4)    VALUE '0241'.
   609     12  ER-0243                 PIC X(4)    VALUE '0243'.
   610     12  ER-0244                 PIC X(4)    VALUE '0244'.
   611     12  ER-0246                 PIC X(4)    VALUE '0246'.
   612     12  ER-0247                 PIC X(4)    VALUE '0247'.
   613     12  ER-0248                 PIC X(4)    VALUE '0248'.
   614     12  ER-0250                 PIC X(4)    VALUE '0250'.
   615     12  ER-0251                 PIC X(4)    VALUE '0251'.
   616     12  ER-0253                 PIC X(4)    VALUE '0253'.
   617     12  ER-0256                 PIC X(4)    VALUE '0256'.
   618     12  ER-0257                 PIC X(4)    VALUE '0257'.
   619     12  ER-0258                 PIC X(4)    VALUE '0258'.
   620     12  ER-0259                 PIC X(4)    VALUE '0259'.
   621     12  ER-0260                 PIC X(4)    VALUE '0260'.
   622     12  ER-0261                 PIC X(4)    VALUE '0261'.
   623     12  ER-0262                 PIC X(4)    VALUE '0262'.
   624     12  ER-0263                 PIC X(4)    VALUE '0263'.
   625     12  ER-0273                 PIC X(4)    VALUE '0273'.
   626     12  ER-0274                 PIC X(4)    VALUE '0274'.
   627     12  ER-0276                 PIC X(4)    VALUE '0276'.
   628     12  ER-0282                 PIC X(4)    VALUE '0282'.
   629     12  ER-0283                 PIC X(4)    VALUE '0283'.
   630     12  ER-0309                 PIC X(4)    VALUE '0309'.
   631     12  ER-0310                 PIC X(4)    VALUE '0310'.
   632     12  ER-0311                 PIC X(4)    VALUE '0311'.
   633     12  ER-0333                 PIC X(4)    VALUE '0333'.
   634     12  ER-0360                 PIC X(4)    VALUE '0360'.
   635     12  ER-0377                 PIC X(4)    VALUE '0377'.
   636     12  ER-0402                 PIC X(4)    VALUE '0402'.
   637     12  ER-0416                 PIC X(4)    VALUE '0416'.
   638     12  ER-0426                 PIC X(4)    VALUE '0426'.
   639     12  ER-0427                 PIC X(4)    VALUE '0427'.
   640     12  ER-0428                 PIC X(4)    VALUE '0428'.
   641     12  ER-0429                 PIC X(4)    VALUE '0429'.
   642     12  ER-0430                 PIC X(4)    VALUE '0430'.
   643     12  ER-0458                 PIC X(4)    VALUE '0458'.
   644     12  ER-0475                 PIC X(4)    VALUE '0475'.
   645     12  ER-0491                 PIC X(4)    VALUE '0491'.
   646     12  ER-0509                 PIC X(4)    VALUE '0509'.
   647     12  ER-0510                 PIC X(4)    VALUE '0510'.
   648     12  ER-0511                 PIC X(4)    VALUE '0511'.
   649     12  ER-0512                 PIC X(4)    VALUE '0512'.
   650     12  ER-0519                 PIC X(4)    VALUE '0519'.
   651     12  ER-0520                 PIC X(4)    VALUE '0520'.
   652     12  ER-0521                 PIC X(4)    VALUE '0521'.
   653     12  ER-0547                 PIC X(4)    VALUE '0547'.
   654     12  ER-0548                 PIC X(4)    VALUE '0548'.
   655     12  ER-0549                 PIC X(4)    VALUE '0549'.
   656     12  ER-0565                 PIC X(4)    VALUE '0565'.
   657     12  ER-0598                 PIC X(4)    VALUE '0598'.
   658     12  ER-0639                 PIC X(4)    VALUE '0639'.
   659     12  ER-0797                 PIC X(4)    VALUE '0797'.
   660     12  ER-0802                 PIC X(4)    VALUE '0802'.
   661     12  ER-0803                 PIC X(4)    VALUE '0803'.
   662     12  ER-0849                 PIC X(4)    VALUE '0849'.
   663     12  ER-0885                 PIC X(4)    VALUE '0885'.
   664     12  ER-0887                 PIC X(4)    VALUE '0887'.
   665     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  14
* EL131.cbl
   666     12  ER-0921                 PIC X(4)    VALUE '0921'.
   667     12  ER-0938                 PIC X(4)    VALUE '0938'.
   668     12  ER-0946                 PIC X(4)    VALUE '0946'.
   669     12  ER-0947                 PIC X(4)    VALUE '0947'.
   670     12  ER-0948                 PIC X(4)    VALUE '0948'.
   671     12  ER-0949                 PIC X(4)    VALUE '0949'.
   672     12  ER-0950                 PIC X(4)    VALUE '0950'.
   673     12  ER-0951                 PIC X(4)    VALUE '0951'.
   674     12  ER-0954                 PIC X(4)    VALUE '0954'.
   675     12  ER-0974                 PIC X(4)    VALUE '0974'.
   676     12  ER-0975                 PIC X(4)    VALUE '0975'.
   677     12  ER-0992                 PIC X(4)    VALUE '0992'.
   678     12  er-1581                 pic x(4)    value '1581'.
   679     12  ER-1651                 PIC X(4)    VALUE '1651'.
   680     12  ER-1652                 PIC X(4)    VALUE '1652'.
   681     12  ER-1653                 PIC X(4)    VALUE '1653'.
   682     12  ER-1654                 PIC X(4)    VALUE '1654'.
   683     12  ER-1655                 PIC X(4)    VALUE '1655'.
   684     12  er-1656                 pic x(4)    value '1656'.
   685     12  ER-1661                 PIC X(4)    VALUE '1661'.
   686     12  ER-1662                 PIC X(4)    VALUE '1662'.
   687     12  ER-1663                 PIC X(4)    VALUE '1663'.
   688     12  er-1664                 pic x(4)    value '1664'.
   689     12  er-1665                 pic x(4)    value '1665'.
   690     12  er-1666                 pic x(4)    value '1666'.
   691     12  er-1668                 pic x(4)    value '1668'.
   692     12  er-1669                 pic x(4)    value '1669'.
   693     12  er-1675                 pic x(4)    value '1675'.
   694     12  er-1676                 pic x(4)    value '1676'.
   695     12  ER-1678                 PIC X(4)    VALUE '1678'.
   696     12  ER-1679                 PIC X(4)    VALUE '1679'.
   697     12  ER-1772                 PIC X(4)    VALUE '1772'.
   698     12  ER-1773                 PIC X(4)    VALUE '1773'.
   699     12  ER-1778                 PIC X(4)    VALUE '1778'.
   700     12  ER-2280                 PIC X(4)    VALUE '2280'.
   701     12  ER-2878                 PIC X(4)    VALUE '2878'.
   702     12  ER-7572                 PIC X(4)    VALUE '7572'.
   703     12  ER-7641                 PIC X(4)    VALUE '7641'.
   704     12  ER-7642                 PIC X(4)    VALUE '7642'.
   705     12  ER-7650                 PIC X(4)    VALUE '7650'.
   706     12  ER-7651                 PIC X(4)    VALUE '7651'.
   707     12  ER-7687                 PIC X(4)    VALUE '7687'.
   708     12  ER-7689                 PIC X(4)    VALUE '7689'.
   709     12  ER-7690                 PIC X(4)    VALUE '7690'.
   710     12  ER-7691                 PIC X(4)    VALUE '7691'.
   711     12  ER-8003                 PIC X(4)    VALUE '8003'.
   712     12  ER-8051                 PIC X(4)    VALUE '8051'.
   713     12  ER-8052                 PIC X(4)    VALUE '8052'.
   714     12  ER-8053                 PIC X(4)    VALUE '8053'.
   715     12  ER-8054                 PIC X(4)    VALUE '8054'.
   716     12  ER-8055                 PIC X(4)    VALUE '8055'.
   717     12  ER-8056                 PIC X(4)    VALUE '8056'.
   718     12  ER-8057                 PIC X(4)    VALUE '8057'.
   719     12  ER-8058                 PIC X(4)    VALUE '8058'.
   720     12  ER-8059                 PIC X(4)    VALUE '8059'.
   721     12  ER-8060                 PIC X(4)    VALUE '8060'.
   722     12  ER-8061                 PIC X(4)    VALUE '8061'.
   723     12  ER-8062                 PIC X(4)    VALUE '8062'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  15
* EL131.cbl
   724     12  ER-8063                 PIC X(4)    VALUE '8063'.
   725     12  ER-8064                 PIC X(4)    VALUE '8064'.
   726     12  ER-8065                 PIC X(4)    VALUE '8065'.
   727     12  ER-8066                 PIC X(4)    VALUE '8066'.
   728     12  ER-8152                 PIC X(4)    VALUE '8152'.
   729     12  ER-8153                 PIC X(4)    VALUE '8153'.
   730     12  ER-8154                 PIC X(4)    VALUE '8154'.
   731     12  ER-8155                 PIC X(4)    VALUE '8155'.
   732 01  ERPDEF-KEY-SAVE             PIC X(18).
   733 01  ERPDEF-KEY.
   734     12  ERPDEF-COMPANY-CD       PIC X.
   735     12  ERPDEF-STATE            PIC XX.
   736     12  ERPDEF-PROD-CD          PIC XXX.
   737     12  F                       PIC X(7).
   738     12  ERPDEF-BEN-TYPE         PIC X.
   739     12  ERPDEF-BEN-CODE         PIC XX.
   740     12  ERPDEF-EXP-DT           PIC XX.
   741 01  MSTR-KEY.
   742     12  COMPANY-CODE            PIC X.
   743     12  CARRIER-CODE            PIC X.
   744     12  CLAIM-NO                PIC X(7).
   745     12  CERT-NO.
   746         16  CERT-NO-PRIME       PIC X(10).
   747         16  CERT-NO-SUFX        PIC X.
   748
   749 01  WS-SAVE-CLAIM-KEY.
   750     12  WS-SAVE-COMPANY-CD      PIC X.
   751     12  WS-SAVE-CARRIER         PIC X.
   752     12  WS-SAVE-CLAIM-NO        PIC X(7).
   753     12  WS-SAVE-CERT-NO.
   754         16  WS-CERT-NO-PRIME    PIC X(10).
   755         16  WS-CERT-NO-SUFX     PIC X.
   756
   757 01  CERT-KEY.
   758     12  CERT-COMPANY-CODE       PIC X.
   759     12  CERT-CARRIER            PIC X.
   760     12  CERT-GROUP              PIC X(6).
   761     12  CERT-STATE              PIC XX.
   762     12  CERT-ACCOUNT            PIC X(10).
   763     12  CERT-DATE               PIC XX.
   764     12  CERT-CERT.
   765         16  CERT-CERT-PRIME     PIC X(10).
   766         16  CERT-CERT-SUFX      PIC X.
   767
   768 01  ELCRTT-KEY.
   769     05  CTRLR-COMP-CD       PIC X.
   770     05  CTRLR-CARRIER       PIC X.
   771     05  CTRLR-GROUPING      PIC X(6).
   772     05  CTRLR-STATE         PIC X(2).
   773     05  CTRLR-ACCOUNT       PIC X(10).
   774     05  CTRLR-EFF-DT        PIC XX.
   775     05  CTRLR-CERT-NO       PIC X(11).
   776     05  CTRLR-REC-TYPE      PIC X.
   777 01  NOTE-KEY.
   778     12  NOTE-COMP-CD            PIC X.
   779     12  NOTE-CERT-KEY.
   780         16  NOTE-CARRIER        PIC X.
   781         16  NOTE-GROUP          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  16
* EL131.cbl
   782         16  NOTE-STATE          PIC XX.
   783         16  NOTE-ACCOUNT        PIC X(10).
   784         16  NOTE-DATE           PIC XX.
   785         16  NOTE-CERT-NO        PIC X(11).
   786
   787 01  TRLR-KEY.
   788     12  TRLR-MAIN-KEY.
   789         16  TRLR-COMPANY-CD     PIC X.
   790         16  TRLR-CARRIER        PIC X.
   791         16  TRLR-CLAIM-NO       PIC X(07).
   792         16  TRLR-CERT-NO        PIC X(11).
   793     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   794
   795 01  BENEFIT-KEY.
   796     12  BEN-CO-ID               PIC X(3).
   797     12  BEN-REC-TYPE            PIC X.
   798     12  FILLER                  PIC XX.
   799     12  BEN-ACC-CD              PIC XX.
   800     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   801
   802 01  CNTL-KEY.
   803     12  CNTL-CO-ID              PIC X(3).
   804     12  CNTL-REC-TYPE           PIC X.
   805     12  CNTL-PROC-ID            PIC X(4).
   806     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   807         16  CNTL-STATE-NUMBER   PIC XX.
   808         16  FILLER              PIC XX.
   809     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   810         16  FILLER              PIC X(3).
   811         16  CNTL-CARRIER        PIC X.
   812     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   813
   814 01  ACTQ-KEY                    PIC X(20).
   815
   816 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   817
   818 01  CHKQ-KEY.
   819     12  CHKQ-COMPANY-CODE       PIC X.
   820     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   821     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   822
   823 01  ARCH-KEY.
   824     12  ARCH-COMPANY-CODE       PIC X.
   825     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   826     12  ARCH-RECORD-TYPE        PIC X.
   827     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   828
   829 01  ACCT-KEY.
   830     05  ACCT-PARTIAL-KEY.
   831         12  ACCT-COMPANY-CODE   PIC X.
   832         12  ACCT-CARRIER        PIC X.
   833         12  ACCT-GROUP          PIC X(6).
   834         12  ACCT-STATE          PIC XX.
   835         12  ACCT-ACCOUNT        PIC X(10).
   836     05  ACCT-DATE               PIC XX.
   837
   838 01  WS-ELBENE-KEY.
   839     12  WS-ELBENE-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  17
* EL131.cbl
   840     12  WS-ELBENE-RECORD-TYPE   PIC X.
   841     12  WS-ELBENE-ID            PIC X(10).
   842
   843 01  ELALPH-KEY.
   844     12  ELALPH-COMPANY-CD       PIC X.
   845     12  ELALPH-SOURCE           PIC X.
   846     12  ELALPH-NAME.
   847         16  ELALPH-LAST-NAME    PIC X(15).
   848         16  ELALPH-FIRST-NAME.
   849             20  ELALPH-FIRST-INIT   PIC X.
   850             20  FILLER              PIC X(11).
   851         16  ELALPH-MIDDLE-INIT  PIC X.
   852     12  ELALPH-DATE             PIC X(08).
   853     12  ELALPH-TIME             PIC S9(04)    COMP.
   854
   855 01  COMP-LENGTHS.
   856     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   857     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   858     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   859     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   860     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   861     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   862     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   863     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   864     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   865     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   866     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   867     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   868     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   869     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  18
* EL131.cbl
   871*                                COPY ELCLNKLT.
   872******************************************************************
   873*                                                                *
   874*                                                                *
   875*                           ELCLNKLT                             *
   876*                            VMOD=2.003                          *
   877*                                                                *
   878*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   879*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   880*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   881*                                                                *
   882*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   883*   COMPLETING THE REQUIRED FIELDS.                              *
   884*                                                                *
   885*   THE CALLING PROGRAM SHOULD CHECK:                            *
   886*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   887*                              9999 INDICATES AN UNKNOWN ABEND   *
   888*                                   WAS DETECTED.                *
   889*                              ALL OTHER VALUES ARE NORMAL ERROR *
   890*                              CODES FOUND IN THE ERROR FILE.    *
   891******************************************************************
   892 01  W-1523-LINKDATA.
   893     12  W-1523-COMMON-PI-DATA.
   894         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   895         16  FILLER              PIC  X(67).
   896         16  W-1523-COMPANY-CD   PIC  X(01).
   897         16  FILLER              PIC  X(10).
   898         16  W-1523-CONTROL-IN-PROGRESS.
   899             20  W-1523-CARRIER  PIC  X(01).
   900             20  W-1523-GROUPING PIC  X(06).
   901             20  W-1523-STATE    PIC  X(02).
   902             20  W-1523-ACCOUNT  PIC  X(10).
   903             20  W-1523-CLAIM-CERT-GRP.
   904                 24  W-1523-CLAIM-NO
   905                                 PIC  X(07).
   906                 24  W-1523-CERT-NO.
   907                     28  W-1523-CERT-PRIME
   908                                 PIC  X(10).
   909                     28  W-1523-CERT-SFX
   910                                 PIC  X(01).
   911                 24  W-1523-CERT-EFF-DT
   912                                 PIC  X(02).
   913         16  FILLER              PIC X(265).
   914
   915     12  W-1523-WORK-AREA.
   916         16  W-1523-FORM-NUMBER  PIC  X(04).
   917         16  W-1523-NUMBER-COPIES
   918                                 PIC  9(01).
   919         16  W-1523-ADDR-TYPE    PIC  X(02).
   920         16  W-1523-FOLLOW-UP-DATE
   921                                 PIC  X(02).
   922         16  W-1523-RESEND-DATE  PIC  X(02).
   923         16  W-1523-ERROR-CODE   PIC  9(04).
   924             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   925             88  W-1523-FATAL-ERROR
   926                                    VALUES  0006 0013 0042
   927                                            0154 0168 0169
   928                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  19
* EL131.cbl
   929                                            0179 0186 0281
   930                                            0332 2055 3697
   931                                            3698 3699 3770
   932                                            3771 3772 7675
   933                                            9106 9808 9883
   934                                            9887.
   935             88  W-1523-STOP-ERRORS
   936                                    VALUES  0013 0042 0154
   937                                            0168 0169 0172
   938                                            0281 0332 2055
   939                                            3698 3699 7675
   940                                            9106 9808 9883
   941                                            9999.
   942         16  W-1523-REASON       PIC  X(70).
   943         16  W-1523-ARCHIVE-NUMBER
   944                                 PIC  9(08).
   945     12  W-1523-POINTER-AREA.
   946         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   947         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   948         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   949         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   950         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  20
* EL131.cbl
   952*                                COPY ELCINTF.
   953******************************************************************
   954*                                                                *
   955*                                                                *
   956*                            ELCINTF.                            *
   957*                            VMOD=2.017                          *
   958*                                                                *
   959*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   960*                                                                *
   961*       LENGTH = 1024                                            *
   962*                                                                *
   963******************************************************************
   964*                   C H A N G E   L O G
   965*
   966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   967*-----------------------------------------------------------------
   968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   969* EFFECTIVE    NUMBER
   970*-----------------------------------------------------------------
   971* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   972******************************************************************
   973 01  PROGRAM-INTERFACE-BLOCK.
   974     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   975     12  PI-CALLING-PROGRAM              PIC X(8).
   976     12  PI-SAVED-PROGRAM-1              PIC X(8).
   977     12  PI-SAVED-PROGRAM-2              PIC X(8).
   978     12  PI-SAVED-PROGRAM-3              PIC X(8).
   979     12  PI-SAVED-PROGRAM-4              PIC X(8).
   980     12  PI-SAVED-PROGRAM-5              PIC X(8).
   981     12  PI-SAVED-PROGRAM-6              PIC X(8).
   982     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   983     12  PI-COMPANY-ID                   PIC XXX.
   984     12  PI-COMPANY-CD                   PIC X.
   985
   986     12  PI-COMPANY-PASSWORD             PIC X(8).
   987
   988     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   989
   990     12  PI-CONTROL-IN-PROGRESS.
   991         16  PI-CARRIER                  PIC X.
   992         16  PI-GROUPING                 PIC X(6).
   993         16  PI-STATE                    PIC XX.
   994         16  PI-ACCOUNT                  PIC X(10).
   995         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   996                                         PIC X(10).
   997         16  PI-CLAIM-CERT-GRP.
   998             20  PI-CLAIM-NO             PIC X(7).
   999             20  PI-CERT-NO.
  1000                 25  PI-CERT-PRIME       PIC X(10).
  1001                 25  PI-CERT-SFX         PIC X.
  1002             20  PI-CERT-EFF-DT          PIC XX.
  1003         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1004             20  PI-PLAN-CODE            PIC X(2).
  1005             20  PI-REVISION-NUMBER      PIC X(3).
  1006             20  PI-PLAN-EFF-DT          PIC X(2).
  1007             20  PI-PLAN-EXP-DT          PIC X(2).
  1008             20  FILLER                  PIC X(11).
  1009         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  21
* EL131.cbl
  1010             20  PI-OE-REFERENCE-1.
  1011                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1012                 25  PI-OE-REF-1-SUFF    PIC XX.
  1013
  1014     12  PI-SESSION-IN-PROGRESS          PIC X.
  1015         88  CLAIM-SESSION                   VALUE '1'.
  1016         88  CREDIT-SESSION                  VALUE '2'.
  1017         88  WARRANTY-SESSION                VALUE '3'.
  1018         88  MORTGAGE-SESSION                VALUE '4'.
  1019         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1020
  1021
  1022*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1023
  1024     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1025     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1026
  1027     12  PI-CREDIT-USER                  PIC X.
  1028         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1029         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1030
  1031     12  PI-CLAIM-USER                   PIC X.
  1032         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1033         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1034
  1035     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1036         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1037         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1038         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1039         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1040         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1041
  1042     12  PI-PROCESSOR-ID                 PIC X(4).
  1043
  1044     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1045
  1046     12  PI-MEMBER-CAPTION               PIC X(10).
  1047
  1048     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1049         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1050
  1051     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1052     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1053     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1054     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1055
  1056     12  PI-AH-OVERRIDE-L1               PIC X.
  1057     12  PI-AH-OVERRIDE-L2               PIC XX.
  1058     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1059     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1060
  1061     12  PI-NEW-SYSTEM                   PIC X(2).
  1062
  1063     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1064     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1065         88  PI-USES-PAID-TO                 VALUE '1'.
  1066     12  PI-CRDTCRD-SYSTEM.
  1067         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  22
* EL131.cbl
  1068             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1069             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1070         16  PI-CC-MONTH-END-DT          PIC XX.
  1071     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1072
  1073     12  PI-OE-REFERENCE-2.
  1074         16  PI-OE-REF-2-PRIME           PIC X(10).
  1075         16  PI-OE-REF-2-SUFF            PIC X.
  1076
  1077     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1078
  1079     12  PI-LANGUAGE-TYPE                PIC X.
  1080             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1081             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1082             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1083
  1084     12  PI-POLICY-LINKAGE-IND           PIC X.
  1085         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1086         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1087                                                   LOW-VALUES.
  1088
  1089     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1090     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1091         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1092         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1093
  1094     12  PI-PROCESSOR-CSR-IND            PIC X.
  1095         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1096         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1097
  1098     12  FILLER                          PIC X(3).
  1099
  1100     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1101
  1102     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1103         PI-SYSTEM-LEVEL.
  1104
  1105         16  PI-ENTRY-CODES.
  1106             20  PI-ENTRY-CD-1           PIC X.
  1107             20  PI-ENTRY-CD-2           PIC X.
  1108
  1109         16  PI-RETURN-CODES.
  1110             20  PI-RETURN-CD-1          PIC X.
  1111             20  PI-RETURN-CD-2          PIC X.
  1112
  1113         16  PI-UPDATE-STATUS-SAVE.
  1114             20  PI-UPDATE-BY            PIC X(4).
  1115             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1116
  1117         16  PI-LOWER-CASE-LETTERS       PIC X.
  1118             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1119
  1120*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1121*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1122*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1123
  1124         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1125             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  23
* EL131.cbl
  1126             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1127             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1128             88  ACCNT-CNTL                  VALUE '3'.
  1129             88  CARR-ACCNT-CNTL             VALUE '4'.
  1130
  1131         16  PI-PROCESSOR-CAP-LIST.
  1132             20  PI-SYSTEM-CONTROLS.
  1133                24 PI-SYSTEM-DISPLAY     PIC X.
  1134                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1135                24 PI-SYSTEM-MODIFY      PIC X.
  1136                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1137             20  FILLER                  PIC XX.
  1138             20  PI-DISPLAY-CAP          PIC X.
  1139                 88  DISPLAY-CAP             VALUE 'Y'.
  1140             20  PI-MODIFY-CAP           PIC X.
  1141                 88  MODIFY-CAP              VALUE 'Y'.
  1142             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1143                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1144             20  PI-FORCE-CAP            PIC X.
  1145                 88  FORCE-CAP               VALUE 'Y'.
  1146
  1147         16  PI-PROGRAM-CONTROLS.
  1148             20  PI-PGM-PRINT-OPT        PIC X.
  1149             20  PI-PGM-FORMAT-OPT       PIC X.
  1150             20  PI-PGM-PROCESS-OPT      PIC X.
  1151             20  PI-PGM-TOTALS-OPT       PIC X.
  1152
  1153         16  PI-HELP-INTERFACE.
  1154             20  PI-LAST-ERROR-NO        PIC X(4).
  1155             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1156
  1157         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1158             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1159
  1160         16  PI-CR-CONTROL-IN-PROGRESS.
  1161             20  PI-CR-CARRIER           PIC X.
  1162             20  PI-CR-GROUPING          PIC X(6).
  1163             20  PI-CR-STATE             PIC XX.
  1164             20  PI-CR-ACCOUNT           PIC X(10).
  1165             20  PI-CR-FIN-RESP          PIC X(10).
  1166             20  PI-CR-TYPE              PIC X.
  1167
  1168         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1169
  1170         16  PI-CR-MONTH-END-DT          PIC XX.
  1171
  1172         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1173             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1174             88  PI-ZERO-CARRIER             VALUE '1'.
  1175             88  PI-ZERO-GROUPING            VALUE '2'.
  1176             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1177
  1178         16  PI-CARRIER-SECURITY         PIC X.
  1179             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1180
  1181         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1182             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1183             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  24
* EL131.cbl
  1184
  1185         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1186             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1187                                         INDEXED BY PI-ACCESS-NDX
  1188                                         PIC X.
  1189
  1190         16  PI-GA-BILLING-CONTROL       PIC X.
  1191             88  PI-GA-BILLING               VALUE '1'.
  1192
  1193         16  PI-MAIL-PROCESSING          PIC X.
  1194             88  PI-MAIL-YES                 VALUE 'Y'.
  1195
  1196         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1197
  1198         16  PI-AR-SYSTEM.
  1199             20  PI-AR-PROCESSING-CNTL   PIC X.
  1200                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1201             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1202             20  PI-AR-MONTH-END-DT      PIC XX.
  1203
  1204         16  PI-MP-SYSTEM.
  1205             20  PI-MORTGAGE-USER            PIC X.
  1206                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1207                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1208             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1209                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1210                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1211                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1212                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1213                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1214             20  PI-MP-MONTH-END-DT          PIC XX.
  1215             20  PI-MP-REFERENCE-NO.
  1216                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1217                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1218
  1219         16  PI-LABEL-CONTROL            PIC X(01).
  1220             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1221             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1222
  1223         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1224             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1225
  1226         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1227             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1228             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1229
  1230         16  FILLER                      PIC X(14).
  1231
  1232     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1233******************************************************************
  1234     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1235         16  PI-NO-PMTS                    PIC 9(4).
  1236         16  PI-CERT-SWITCH                PIC X.
  1237             88  CREATED-CERT              VALUE '2'.
  1238         16  PI-PREM-TYPE                  PIC X.
  1239         16  PI-SAVE-CERT-NO.
  1240             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1241             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  25
* EL131.cbl
  1242         16  FILLER                        PIC X(46).
  1243         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1244         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1245         16  PI-REC-FOUND-SW               PIC X.
  1246         16  PI-LETTER-SW                  PIC X.
  1247         16  PI-PREV-TRLR-KEY              PIC X(22).
  1248         16  pi-claim-type                 pic x.
  1249         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1250         16  pi-approval-level             pic x.
  1251         16  FILLER                        PIC X(543).
  1252
  1253 01  SAVE-RECORD                 PIC X(450).
  1254
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  26
* EL131.cbl
  1256*                                COPY ELCLOGOF SUPPRESS.
  1257******************************************************************
  1258*                                                                *
  1259*                                                                *
  1260*                            ELCLOGOF.                           *
  1261*                            VMOD=2.001                          *
  1262*                                                                *
  1263*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1264*                                                                *
  1265******************************************************************
  1266 01  CLASIC-LOGOFF.
  1267     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1268     12  LOGOFF-TEXT.
  1269         16  FILLER          PIC X(5)    VALUE SPACES.
  1270         16  LOGOFF-MSG.
  1271             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1272             20  FILLER      PIC X       VALUE SPACES.
  1273             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1274         16  FILLER          PIC X(80)
  1275           VALUE '* YOU ARE NOW LOGGED OFF'.
  1276         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1277         16  FILLER          PIC X       VALUE QUOTE.
  1278         16  LOGOFF-SYS-MSG  PIC X(17)
  1279           VALUE 'S CLAS-IC SYSTEM '.
  1280     12  TEXT-MESSAGES.
  1281         16  UNACCESS-MSG    PIC X(29)
  1282             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1283         16  PGMIDERR-MSG    PIC X(17)
  1284             VALUE 'PROGRAM NOT FOUND'.
  1285
  1286*                                COPY ELCATTR SUPPRESS.
  1287******************************************************************
  1288*                                                                *
  1289*                            ELCATTR.                            *
  1290*                            VMOD=2.001                          *
  1291*                                                                *
  1292*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1293*                                                                *
  1294*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1295*                                                                *
  1296*                   POS 1   P=PROTECTED                          *
  1297*                           U=UNPROTECTED                        *
  1298*                           S=ASKIP                              *
  1299*                   POS 2   A=ALPHA/NUMERIC                      *
  1300*                           N=NUMERIC                            *
  1301*                   POS 3   N=NORMAL                             *
  1302*                           B=BRIGHT                             *
  1303*                           D=DARK                               *
  1304*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1305*                           OF=MODIFIED DATA TAG OFF             *
  1306*                                                                *
  1307*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1308******************************************************************
  1309 01  ATTRIBUTE-LIST.
  1310     12  AL-PABOF            PIC X       VALUE 'Y'.
  1311     12  AL-PABON            PIC X       VALUE 'Z'.
  1312     12  AL-PADOF            PIC X       VALUE '%'.
  1313     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  27
* EL131.cbl
  1314     12  AL-PANOF            PIC X       VALUE '-'.
  1315     12  AL-PANON            PIC X       VALUE '/'.
  1316     12  AL-SABOF            PIC X       VALUE '8'.
  1317     12  AL-SABON            PIC X       VALUE '9'.
  1318     12  AL-SADOF            PIC X       VALUE '@'.
  1319     12  AL-SADON            PIC X       VALUE QUOTE.
  1320     12  AL-SANOF            PIC X       VALUE '0'.
  1321     12  AL-SANON            PIC X       VALUE '1'.
  1322     12  AL-UABOF            PIC X       VALUE 'H'.
  1323     12  AL-UABON            PIC X       VALUE 'I'.
  1324     12  AL-UADOF            PIC X       VALUE '<'.
  1325     12  AL-UADON            PIC X       VALUE '('.
  1326     12  AL-UANOF            PIC X       VALUE ' '.
  1327     12  AL-UANON            PIC X       VALUE 'A'.
  1328     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1329     12  AL-UNBON            PIC X       VALUE 'R'.
  1330     12  AL-UNDOF            PIC X       VALUE '*'.
  1331     12  AL-UNDON            PIC X       VALUE ')'.
  1332     12  AL-UNNOF            PIC X       VALUE '&'.
  1333     12  AL-UNNON            PIC X       VALUE 'J'.
  1334
  1335*                                COPY ELCAID SUPPRESS.
  1336******************************************************************
  1337*                                                                *
  1338*                            ELCAID.                             *
  1339*                            VMOD=2.001                          *
  1340*                                                                *
  1341*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1342*                                                                *
  1343*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1344*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1345******************************************************************
  1346
  1347 01  DFHAID.
  1348   02  DFHNULL   PIC  X  VALUE  ' '.
  1349   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1350   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1351   02  DFHPEN    PIC  X  VALUE  '='.
  1352   02  DFHOPID   PIC  X  VALUE  'W'.
  1353   02  DFHPA1    PIC  X  VALUE  '%'.
  1354   02  DFHPA2    PIC  X  VALUE  '>'.
  1355   02  DFHPA3    PIC  X  VALUE  ','.
  1356   02  DFHPF1    PIC  X  VALUE  '1'.
  1357   02  DFHPF2    PIC  X  VALUE  '2'.
  1358   02  DFHPF3    PIC  X  VALUE  '3'.
  1359   02  DFHPF4    PIC  X  VALUE  '4'.
  1360   02  DFHPF5    PIC  X  VALUE  '5'.
  1361   02  DFHPF6    PIC  X  VALUE  '6'.
  1362   02  DFHPF7    PIC  X  VALUE  '7'.
  1363   02  DFHPF8    PIC  X  VALUE  '8'.
  1364   02  DFHPF9    PIC  X  VALUE  '9'.
  1365   02  DFHPF10   PIC  X  VALUE  ':'.
  1366   02  DFHPF11   PIC  X  VALUE  '#'.
  1367   02  DFHPF12   PIC  X  VALUE  '@'.
  1368   02  DFHPF13   PIC  X  VALUE  'A'.
  1369   02  DFHPF14   PIC  X  VALUE  'B'.
  1370   02  DFHPF15   PIC  X  VALUE  'C'.
  1371   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  28
* EL131.cbl
  1372   02  DFHPF17   PIC  X  VALUE  'E'.
  1373   02  DFHPF18   PIC  X  VALUE  'F'.
  1374   02  DFHPF19   PIC  X  VALUE  'G'.
  1375   02  DFHPF20   PIC  X  VALUE  'H'.
  1376   02  DFHPF21   PIC  X  VALUE  'I'.
  1377*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1378   02  DFHPF22   PIC  X  VALUE  '['.
  1379   02  DFHPF23   PIC  X  VALUE  '.'.
  1380   02  DFHPF24   PIC  X  VALUE  '<'.
  1381   02  DFHMSRE   PIC  X  VALUE  'X'.
  1382   02  DFHSTRF   PIC  X  VALUE  'h'.
  1383   02  DFHTRIG   PIC  X  VALUE  '"'.
  1384 01  FILLER REDEFINES DFHAID.
  1385     12  FILLER                  PIC X(8).
  1386     12  AID-KEYS OCCURS 24 TIMES.
  1387         16  FILLER              PIC X.
  1388
  1389*                                COPY EL131S.
  1390 01  EL131AI.
  1391     05  FILLER            PIC  X(0012).
  1392*    -------------------------------
  1393     05  DATEL PIC S9(0004) COMP.
  1394     05  DATEF PIC  X(0001).
  1395     05  FILLER REDEFINES DATEF.
  1396         10  DATEA PIC  X(0001).
  1397     05  DATEI PIC  X(0008).
  1398*    -------------------------------
  1399     05  TIMEL PIC S9(0004) COMP.
  1400     05  TIMEF PIC  X(0001).
  1401     05  FILLER REDEFINES TIMEF.
  1402         10  TIMEA PIC  X(0001).
  1403     05  TIMEI PIC  X(0005).
  1404*    -------------------------------
  1405     05  SEQUL PIC S9(0004) COMP.
  1406     05  SEQUF PIC  X(0001).
  1407     05  FILLER REDEFINES SEQUF.
  1408         10  SEQUA PIC  X(0001).
  1409     05  SEQUI PIC  X(0010).
  1410*    -------------------------------
  1411     05  COMPL PIC S9(0004) COMP.
  1412     05  COMPF PIC  X(0001).
  1413     05  FILLER REDEFINES COMPF.
  1414         10  COMPA PIC  X(0001).
  1415     05  COMPI PIC  X(0003).
  1416*    -------------------------------
  1417     05  USERIDL PIC S9(0004) COMP.
  1418     05  USERIDF PIC  X(0001).
  1419     05  FILLER REDEFINES USERIDF.
  1420         10  USERIDA PIC  X(0001).
  1421     05  USERIDI PIC  X(0004).
  1422*    -------------------------------
  1423     05  LABEL1L PIC S9(0004) COMP.
  1424     05  LABEL1F PIC  X(0001).
  1425     05  FILLER REDEFINES LABEL1F.
  1426         10  LABEL1A PIC  X(0001).
  1427     05  LABEL1I PIC  X(0011).
  1428*    -------------------------------
  1429     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  29
* EL131.cbl
  1430     05  PCERTNOF PIC  X(0001).
  1431     05  FILLER REDEFINES PCERTNOF.
  1432         10  PCERTNOA PIC  X(0001).
  1433     05  PCERTNOI PIC  X(0010).
  1434*    -------------------------------
  1435     05  PSUFXL PIC S9(0004) COMP.
  1436     05  PSUFXF PIC  X(0001).
  1437     05  FILLER REDEFINES PSUFXF.
  1438         10  PSUFXA PIC  X(0001).
  1439     05  PSUFXI PIC  X(0001).
  1440*    -------------------------------
  1441     05  CCNOL PIC S9(0004) COMP.
  1442     05  CCNOF PIC  X(0001).
  1443     05  FILLER REDEFINES CCNOF.
  1444         10  CCNOA PIC  X(0001).
  1445     05  CCNOI PIC  X(0016).
  1446*    -------------------------------
  1447     05  MAINTL PIC S9(0004) COMP.
  1448     05  MAINTF PIC  X(0001).
  1449     05  FILLER REDEFINES MAINTF.
  1450         10  MAINTA PIC  X(0001).
  1451     05  MAINTI PIC  X(0001).
  1452*    -------------------------------
  1453     05  CLAIML PIC S9(0004) COMP.
  1454     05  CLAIMF PIC  X(0001).
  1455     05  FILLER REDEFINES CLAIMF.
  1456         10  CLAIMA PIC  X(0001).
  1457     05  CLAIMI PIC  X(0007).
  1458*    -------------------------------
  1459     05  CARRL PIC S9(0004) COMP.
  1460     05  CARRF PIC  X(0001).
  1461     05  FILLER REDEFINES CARRF.
  1462         10  CARRA PIC  X(0001).
  1463     05  CARRI PIC  X(0001).
  1464*    -------------------------------
  1465     05  CERTL PIC S9(0004) COMP.
  1466     05  CERTF PIC  X(0001).
  1467     05  FILLER REDEFINES CERTF.
  1468         10  CERTA PIC  X(0001).
  1469     05  CERTI PIC  X(0010).
  1470*    -------------------------------
  1471     05  SUFXL PIC S9(0004) COMP.
  1472     05  SUFXF PIC  X(0001).
  1473     05  FILLER REDEFINES SUFXF.
  1474         10  SUFXA PIC  X(0001).
  1475     05  SUFXI PIC  X(0001).
  1476*    -------------------------------
  1477     05  TYPEL PIC S9(0004) COMP.
  1478     05  TYPEF PIC  X(0001).
  1479     05  FILLER REDEFINES TYPEF.
  1480         10  TYPEA PIC  X(0001).
  1481     05  TYPEI PIC  X(0001).
  1482*    -------------------------------
  1483     05  BENPERL PIC S9(0004) COMP.
  1484     05  BENPERF PIC  X(0001).
  1485     05  FILLER REDEFINES BENPERF.
  1486         10  BENPERA PIC  X(0001).
  1487     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  30
* EL131.cbl
  1488*    -------------------------------
  1489     05  INSTYPEL PIC S9(0004) COMP.
  1490     05  INSTYPEF PIC  X(0001).
  1491     05  FILLER REDEFINES INSTYPEF.
  1492         10  INSTYPEA PIC  X(0001).
  1493     05  INSTYPEI PIC  X(0001).
  1494*    -------------------------------
  1495     05  STATUSL PIC S9(0004) COMP.
  1496     05  STATUSF PIC  X(0001).
  1497     05  FILLER REDEFINES STATUSF.
  1498         10  STATUSA PIC  X(0001).
  1499     05  STATUSI PIC  X(0006).
  1500*    -------------------------------
  1501     05  INCL PIC S9(0004) COMP.
  1502     05  INCF PIC  X(0001).
  1503     05  FILLER REDEFINES INCF.
  1504         10  INCA PIC  X(0001).
  1505     05  INCI PIC  X(0008).
  1506*    -------------------------------
  1507     05  REPL PIC S9(0004) COMP.
  1508     05  REPF PIC  X(0001).
  1509     05  FILLER REDEFINES REPF.
  1510         10  REPA PIC  X(0001).
  1511     05  REPI PIC  X(0008).
  1512*    -------------------------------
  1513     05  ICD1L PIC S9(0004) COMP.
  1514     05  ICD1F PIC  X(0001).
  1515     05  FILLER REDEFINES ICD1F.
  1516         10  ICD1A PIC  X(0001).
  1517     05  ICD1I PIC  X(0008).
  1518*    -------------------------------
  1519     05  ICD2L PIC S9(0004) COMP.
  1520     05  ICD2F PIC  X(0001).
  1521     05  FILLER REDEFINES ICD2F.
  1522         10  ICD2A PIC  X(0001).
  1523     05  ICD2I PIC  X(0008).
  1524*    -------------------------------
  1525     05  DIAGL PIC S9(0004) COMP.
  1526     05  DIAGF PIC  X(0001).
  1527     05  FILLER REDEFINES DIAGF.
  1528         10  DIAGA PIC  X(0001).
  1529     05  DIAGI PIC  X(0060).
  1530*    -------------------------------
  1531     05  ACCSWL PIC S9(0004) COMP.
  1532     05  ACCSWF PIC  X(0001).
  1533     05  FILLER REDEFINES ACCSWF.
  1534         10  ACCSWA PIC  X(0001).
  1535     05  ACCSWI PIC  X(0001).
  1536*    -------------------------------
  1537     05  BENEL PIC S9(0004) COMP.
  1538     05  BENEF PIC  X(0001).
  1539     05  FILLER REDEFINES BENEF.
  1540         10  BENEA PIC  X(0001).
  1541     05  BENEI PIC  X(0010).
  1542*    -------------------------------
  1543     05  BIRTHL PIC S9(0004) COMP.
  1544     05  BIRTHF PIC  X(0001).
  1545     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  31
* EL131.cbl
  1546         10  BIRTHA PIC  X(0001).
  1547     05  BIRTHI PIC  X(0008).
  1548*    -------------------------------
  1549     05  SOCIALL PIC S9(0004) COMP.
  1550     05  SOCIALF PIC  X(0001).
  1551     05  FILLER REDEFINES SOCIALF.
  1552         10  SOCIALA PIC  X(0001).
  1553     05  SOCIALI PIC  X(0011).
  1554*    -------------------------------
  1555     05  SEXL PIC S9(0004) COMP.
  1556     05  SEXF PIC  X(0001).
  1557     05  FILLER REDEFINES SEXF.
  1558         10  SEXA PIC  X(0001).
  1559     05  SEXI PIC  X(0001).
  1560*    -------------------------------
  1561     05  MLNAMEL PIC S9(0004) COMP.
  1562     05  MLNAMEF PIC  X(0001).
  1563     05  FILLER REDEFINES MLNAMEF.
  1564         10  MLNAMEA PIC  X(0001).
  1565     05  MLNAMEI PIC  X(0015).
  1566*    -------------------------------
  1567     05  MFNAMEL PIC S9(0004) COMP.
  1568     05  MFNAMEF PIC  X(0001).
  1569     05  FILLER REDEFINES MFNAMEF.
  1570         10  MFNAMEA PIC  X(0001).
  1571     05  MFNAMEI PIC  X(0012).
  1572*    -------------------------------
  1573     05  MMINITL PIC S9(0004) COMP.
  1574     05  MMINITF PIC  X(0001).
  1575     05  FILLER REDEFINES MMINITF.
  1576         10  MMINITA PIC  X(0001).
  1577     05  MMINITI PIC  X(0001).
  1578*    -------------------------------
  1579     05  AUTHRCVL PIC S9(0004) COMP.
  1580     05  AUTHRCVF PIC  X(0001).
  1581     05  FILLER REDEFINES AUTHRCVF.
  1582         10  AUTHRCVA PIC  X(0001).
  1583     05  AUTHRCVI PIC  X(0001).
  1584*    -------------------------------
  1585     05  CRTLNMEL PIC S9(0004) COMP.
  1586     05  CRTLNMEF PIC  X(0001).
  1587     05  FILLER REDEFINES CRTLNMEF.
  1588         10  CRTLNMEA PIC  X(0001).
  1589     05  CRTLNMEI PIC  X(0015).
  1590*    -------------------------------
  1591     05  CRTFNMEL PIC S9(0004) COMP.
  1592     05  CRTFNMEF PIC  X(0001).
  1593     05  FILLER REDEFINES CRTFNMEF.
  1594         10  CRTFNMEA PIC  X(0001).
  1595     05  CRTFNMEI PIC  X(0012).
  1596*    -------------------------------
  1597     05  CRTINITL PIC S9(0004) COMP.
  1598     05  CRTINITF PIC  X(0001).
  1599     05  FILLER REDEFINES CRTINITF.
  1600         10  CRTINITA PIC  X(0001).
  1601     05  CRTINITI PIC  X(0001).
  1602*    -------------------------------
  1603     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  32
* EL131.cbl
  1604     05  LOANBALF PIC  X(0001).
  1605     05  FILLER REDEFINES LOANBALF.
  1606         10  LOANBALA PIC  X(0001).
  1607     05  LOANBALI PIC  9(7)V99.
  1608*    -------------------------------
  1609     05  PROCL PIC S9(0004) COMP.
  1610     05  PROCF PIC  X(0001).
  1611     05  FILLER REDEFINES PROCF.
  1612         10  PROCA PIC  X(0001).
  1613     05  PROCI PIC  X(0004).
  1614*    -------------------------------
  1615     05  SUPVL PIC S9(0004) COMP.
  1616     05  SUPVF PIC  X(0001).
  1617     05  FILLER REDEFINES SUPVF.
  1618         10  SUPVA PIC  X(0001).
  1619     05  SUPVI PIC  X(0001).
  1620*    -------------------------------
  1621     05  PRICDL PIC S9(0004) COMP.
  1622     05  PRICDF PIC  X(0001).
  1623     05  FILLER REDEFINES PRICDF.
  1624         10  PRICDA PIC  X(0001).
  1625     05  PRICDI PIC  X(0001).
  1626*    -------------------------------
  1627     05  CRITPL PIC S9(0004) COMP.
  1628     05  CRITPF PIC  X(0001).
  1629     05  FILLER REDEFINES CRITPF.
  1630         10  CRITPA PIC  X(0001).
  1631     05  CRITPI PIC  X(0002).
  1632*    -------------------------------
  1633     05  EXTENSL PIC S9(0004) COMP.
  1634     05  EXTENSF PIC  X(0001).
  1635     05  FILLER REDEFINES EXTENSF.
  1636         10  EXTENSA PIC  X(0001).
  1637     05  EXTENSI PIC  99.
  1638*    -------------------------------
  1639     05  FILETOL PIC S9(0004) COMP.
  1640     05  FILETOF PIC  X(0001).
  1641     05  FILLER REDEFINES FILETOF.
  1642         10  FILETOA PIC  X(0001).
  1643     05  FILETOI PIC  X(0004).
  1644*    -------------------------------
  1645     05  PTHRHDGL PIC S9(0004) COMP.
  1646     05  PTHRHDGF PIC  X(0001).
  1647     05  FILLER REDEFINES PTHRHDGF.
  1648         10  PTHRHDGA PIC  X(0001).
  1649     05  PTHRHDGI PIC  X(0010).
  1650*    -------------------------------
  1651     05  PDTHRUL PIC S9(0004) COMP.
  1652     05  PDTHRUF PIC  X(0001).
  1653     05  FILLER REDEFINES PDTHRUF.
  1654         10  PDTHRUA PIC  X(0001).
  1655     05  PDTHRUI PIC  X(0008).
  1656*    -------------------------------
  1657     05  PDAMTL PIC S9(0004) COMP.
  1658     05  PDAMTF PIC  X(0001).
  1659     05  FILLER REDEFINES PDAMTF.
  1660         10  PDAMTA PIC  X(0001).
  1661     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  33
* EL131.cbl
  1662*    -------------------------------
  1663     05  NODAYSL PIC S9(0004) COMP.
  1664     05  NODAYSF PIC  X(0001).
  1665     05  FILLER REDEFINES NODAYSF.
  1666         10  NODAYSA PIC  X(0001).
  1667     05  NODAYSI PIC  9(5).
  1668*    -------------------------------
  1669     05  NOPMTSL PIC S9(0004) COMP.
  1670     05  NOPMTSF PIC  X(0001).
  1671     05  FILLER REDEFINES NOPMTSF.
  1672         10  NOPMTSA PIC  X(0001).
  1673     05  NOPMTSI PIC  9(4).
  1674*    -------------------------------
  1675     05  FORMTYPL PIC S9(0004) COMP.
  1676     05  FORMTYPF PIC  X(0001).
  1677     05  FILLER REDEFINES FORMTYPF.
  1678         10  FORMTYPA PIC  X(0001).
  1679     05  FORMTYPI PIC  X(0001).
  1680*    -------------------------------
  1681     05  ESTL PIC S9(0004) COMP.
  1682     05  ESTF PIC  X(0001).
  1683     05  FILLER REDEFINES ESTF.
  1684         10  ESTA PIC  X(0001).
  1685     05  ESTI PIC  X(0008).
  1686*    -------------------------------
  1687     05  AUIDL PIC S9(0004) COMP.
  1688     05  AUIDF PIC  X(0001).
  1689     05  FILLER REDEFINES AUIDF.
  1690         10  AUIDA PIC  X(0001).
  1691     05  AUIDI PIC  X(0004).
  1692*    -------------------------------
  1693     05  OCCL PIC S9(0004) COMP.
  1694     05  OCCF PIC  X(0001).
  1695     05  FILLER REDEFINES OCCF.
  1696         10  OCCA PIC  X(0001).
  1697     05  OCCI PIC  X(0006).
  1698*    -------------------------------
  1699     05  MNTDTL PIC S9(0004) COMP.
  1700     05  MNTDTF PIC  X(0001).
  1701     05  FILLER REDEFINES MNTDTF.
  1702         10  MNTDTA PIC  X(0001).
  1703     05  MNTDTI PIC  X(0008).
  1704*    -------------------------------
  1705     05  MNTTYPEL PIC S9(0004) COMP.
  1706     05  MNTTYPEF PIC  X(0001).
  1707     05  FILLER REDEFINES MNTTYPEF.
  1708         10  MNTTYPEA PIC  X(0001).
  1709     05  MNTTYPEI PIC  X(0006).
  1710*    -------------------------------
  1711     05  CERTCARL PIC S9(0004) COMP.
  1712     05  CERTCARF PIC  X(0001).
  1713     05  FILLER REDEFINES CERTCARF.
  1714         10  CERTCARA PIC  X(0001).
  1715     05  CERTCARI PIC  X(0001).
  1716*    -------------------------------
  1717     05  CERTGRPL PIC S9(0004) COMP.
  1718     05  CERTGRPF PIC  X(0001).
  1719     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  34
* EL131.cbl
  1720         10  CERTGRPA PIC  X(0001).
  1721     05  CERTGRPI PIC  X(0006).
  1722*    -------------------------------
  1723     05  CERTSTL PIC S9(0004) COMP.
  1724     05  CERTSTF PIC  X(0001).
  1725     05  FILLER REDEFINES CERTSTF.
  1726         10  CERTSTA PIC  X(0001).
  1727     05  CERTSTI PIC  X(0002).
  1728*    -------------------------------
  1729     05  CERTACTL PIC S9(0004) COMP.
  1730     05  CERTACTF PIC  X(0001).
  1731     05  FILLER REDEFINES CERTACTF.
  1732         10  CERTACTA PIC  X(0001).
  1733     05  CERTACTI PIC  X(0010).
  1734*    -------------------------------
  1735     05  CERTEFFL PIC S9(0004) COMP.
  1736     05  CERTEFFF PIC  X(0001).
  1737     05  FILLER REDEFINES CERTEFFF.
  1738         10  CERTEFFA PIC  X(0001).
  1739     05  CERTEFFI PIC  X(0008).
  1740*    -------------------------------
  1741     05  ISSAGEL PIC S9(0004) COMP.
  1742     05  ISSAGEF PIC  X(0001).
  1743     05  FILLER REDEFINES ISSAGEF.
  1744         10  ISSAGEA PIC  X(0001).
  1745     05  ISSAGEI PIC  X(0002).
  1746*    -------------------------------
  1747     05  APRL PIC S9(0004) COMP.
  1748     05  APRF PIC  X(0001).
  1749     05  FILLER REDEFINES APRF.
  1750         10  APRA PIC  X(0001).
  1751     05  APRI PIC  9(4)V9(4).
  1752*    -------------------------------
  1753     05  PMTFREQL PIC S9(0004) COMP.
  1754     05  PMTFREQF PIC  X(0001).
  1755     05  FILLER REDEFINES PMTFREQF.
  1756         10  PMTFREQA PIC  X(0001).
  1757     05  PMTFREQI PIC  99.
  1758*    -------------------------------
  1759     05  INDGRPL PIC S9(0004) COMP.
  1760     05  INDGRPF PIC  X(0001).
  1761     05  FILLER REDEFINES INDGRPF.
  1762         10  INDGRPA PIC  X(0001).
  1763     05  INDGRPI PIC  X(0001).
  1764*    -------------------------------
  1765     05  PREMTYPL PIC S9(0004) COMP.
  1766     05  PREMTYPF PIC  X(0001).
  1767     05  FILLER REDEFINES PREMTYPF.
  1768         10  PREMTYPA PIC  X(0001).
  1769     05  PREMTYPI PIC  X(0001).
  1770*    -------------------------------
  1771     05  REINCDL PIC S9(0004) COMP.
  1772     05  REINCDF PIC  X(0001).
  1773     05  FILLER REDEFINES REINCDF.
  1774         10  REINCDA PIC  X(0001).
  1775     05  REINCDI PIC  X(0001).
  1776*    -------------------------------
  1777     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  35
* EL131.cbl
  1778     05  JNTLNMEF PIC  X(0001).
  1779     05  FILLER REDEFINES JNTLNMEF.
  1780         10  JNTLNMEA PIC  X(0001).
  1781     05  JNTLNMEI PIC  X(0015).
  1782*    -------------------------------
  1783     05  JNTFNMEL PIC S9(0004) COMP.
  1784     05  JNTFNMEF PIC  X(0001).
  1785     05  FILLER REDEFINES JNTFNMEF.
  1786         10  JNTFNMEA PIC  X(0001).
  1787     05  JNTFNMEI PIC  X(0012).
  1788*    -------------------------------
  1789     05  JNTINITL PIC S9(0004) COMP.
  1790     05  JNTINITF PIC  X(0001).
  1791     05  FILLER REDEFINES JNTINITF.
  1792         10  JNTINITA PIC  X(0001).
  1793     05  JNTINITI PIC  X(0001).
  1794*    -------------------------------
  1795     05  JNTAGEL PIC S9(0004) COMP.
  1796     05  JNTAGEF PIC  X(0001).
  1797     05  FILLER REDEFINES JNTAGEF.
  1798         10  JNTAGEA PIC  X(0001).
  1799     05  JNTAGEI PIC  X(0002).
  1800*    -------------------------------
  1801     05  ADDONDTL PIC S9(0004) COMP.
  1802     05  ADDONDTF PIC  X(0001).
  1803     05  FILLER REDEFINES ADDONDTF.
  1804         10  ADDONDTA PIC  X(0001).
  1805     05  ADDONDTI PIC  X(0008).
  1806*    -------------------------------
  1807     05  LCVDSCRL PIC S9(0004) COMP.
  1808     05  LCVDSCRF PIC  X(0001).
  1809     05  FILLER REDEFINES LCVDSCRF.
  1810         10  LCVDSCRA PIC  X(0001).
  1811     05  LCVDSCRI PIC  X(0006).
  1812*    -------------------------------
  1813     05  LCVKINDL PIC S9(0004) COMP.
  1814     05  LCVKINDF PIC  X(0001).
  1815     05  FILLER REDEFINES LCVKINDF.
  1816         10  LCVKINDA PIC  X(0001).
  1817     05  LCVKINDI PIC  X(0003).
  1818*    -------------------------------
  1819     05  LCVCDL PIC S9(0004) COMP.
  1820     05  LCVCDF PIC  X(0001).
  1821     05  FILLER REDEFINES LCVCDF.
  1822         10  LCVCDA PIC  X(0001).
  1823     05  LCVCDI PIC  X(0002).
  1824*    -------------------------------
  1825     05  LCVOTRML PIC S9(0004) COMP.
  1826     05  LCVOTRMF PIC  X(0001).
  1827     05  FILLER REDEFINES LCVOTRMF.
  1828         10  LCVOTRMA PIC  X(0001).
  1829     05  LCVOTRMI PIC  999.
  1830*    -------------------------------
  1831     05  LCVRTRML PIC S9(0004) COMP.
  1832     05  LCVRTRMF PIC  X(0001).
  1833     05  FILLER REDEFINES LCVRTRMF.
  1834         10  LCVRTRMA PIC  X(0001).
  1835     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  36
* EL131.cbl
  1836*    -------------------------------
  1837     05  LCVRATEL PIC S9(0004) COMP.
  1838     05  LCVRATEF PIC  X(0001).
  1839     05  FILLER REDEFINES LCVRATEF.
  1840         10  LCVRATEA PIC  X(0001).
  1841     05  LCVRATEI PIC  9999V99.
  1842*    -------------------------------
  1843     05  LCVBENEL PIC S9(0004) COMP.
  1844     05  LCVBENEF PIC  X(0001).
  1845     05  FILLER REDEFINES LCVBENEF.
  1846         10  LCVBENEA PIC  X(0001).
  1847     05  LCVBENEI PIC  9(9)V99.
  1848*    -------------------------------
  1849     05  LCVFORML PIC S9(0004) COMP.
  1850     05  LCVFORMF PIC  X(0001).
  1851     05  FILLER REDEFINES LCVFORMF.
  1852         10  LCVFORMA PIC  X(0001).
  1853     05  LCVFORMI PIC  X(0012).
  1854*    -------------------------------
  1855     05  LCVCNDTL PIC S9(0004) COMP.
  1856     05  LCVCNDTF PIC  X(0001).
  1857     05  FILLER REDEFINES LCVCNDTF.
  1858         10  LCVCNDTA PIC  X(0001).
  1859     05  LCVCNDTI PIC  X(0008).
  1860*    -------------------------------
  1861     05  LCVEXITL PIC S9(0004) COMP.
  1862     05  LCVEXITF PIC  X(0001).
  1863     05  FILLER REDEFINES LCVEXITF.
  1864         10  LCVEXITA PIC  X(0001).
  1865     05  LCVEXITI PIC  X(0008).
  1866*    -------------------------------
  1867     05  LCVSTATL PIC S9(0004) COMP.
  1868     05  LCVSTATF PIC  X(0001).
  1869     05  FILLER REDEFINES LCVSTATF.
  1870         10  LCVSTATA PIC  X(0001).
  1871     05  LCVSTATI PIC  X(0006).
  1872*    -------------------------------
  1873     05  ACVDSCRL PIC S9(0004) COMP.
  1874     05  ACVDSCRF PIC  X(0001).
  1875     05  FILLER REDEFINES ACVDSCRF.
  1876         10  ACVDSCRA PIC  X(0001).
  1877     05  ACVDSCRI PIC  X(0006).
  1878*    -------------------------------
  1879     05  ACVKINDL PIC S9(0004) COMP.
  1880     05  ACVKINDF PIC  X(0001).
  1881     05  FILLER REDEFINES ACVKINDF.
  1882         10  ACVKINDA PIC  X(0001).
  1883     05  ACVKINDI PIC  X(0003).
  1884*    -------------------------------
  1885     05  ACVCDL PIC S9(0004) COMP.
  1886     05  ACVCDF PIC  X(0001).
  1887     05  FILLER REDEFINES ACVCDF.
  1888         10  ACVCDA PIC  X(0001).
  1889     05  ACVCDI PIC  X(0002).
  1890*    -------------------------------
  1891     05  ACVOTRML PIC S9(0004) COMP.
  1892     05  ACVOTRMF PIC  X(0001).
  1893     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  37
* EL131.cbl
  1894         10  ACVOTRMA PIC  X(0001).
  1895     05  ACVOTRMI PIC  999.
  1896*    -------------------------------
  1897     05  ACVRTRML PIC S9(0004) COMP.
  1898     05  ACVRTRMF PIC  X(0001).
  1899     05  FILLER REDEFINES ACVRTRMF.
  1900         10  ACVRTRMA PIC  X(0001).
  1901     05  ACVRTRMI PIC  X(0003).
  1902*    -------------------------------
  1903     05  ACVRATEL PIC S9(0004) COMP.
  1904     05  ACVRATEF PIC  X(0001).
  1905     05  FILLER REDEFINES ACVRATEF.
  1906         10  ACVRATEA PIC  X(0001).
  1907     05  ACVRATEI PIC  9999V99.
  1908*    -------------------------------
  1909     05  ACVBENEL PIC S9(0004) COMP.
  1910     05  ACVBENEF PIC  X(0001).
  1911     05  FILLER REDEFINES ACVBENEF.
  1912         10  ACVBENEA PIC  X(0001).
  1913     05  ACVBENEI PIC  9(9)V99.
  1914*    -------------------------------
  1915     05  ACVFORML PIC S9(0004) COMP.
  1916     05  ACVFORMF PIC  X(0001).
  1917     05  FILLER REDEFINES ACVFORMF.
  1918         10  ACVFORMA PIC  X(0001).
  1919     05  ACVFORMI PIC  X(0012).
  1920*    -------------------------------
  1921     05  ACVCNDTL PIC S9(0004) COMP.
  1922     05  ACVCNDTF PIC  X(0001).
  1923     05  FILLER REDEFINES ACVCNDTF.
  1924         10  ACVCNDTA PIC  X(0001).
  1925     05  ACVCNDTI PIC  X(0008).
  1926*    -------------------------------
  1927     05  ACVEXITL PIC S9(0004) COMP.
  1928     05  ACVEXITF PIC  X(0001).
  1929     05  FILLER REDEFINES ACVEXITF.
  1930         10  ACVEXITA PIC  X(0001).
  1931     05  ACVEXITI PIC  X(0008).
  1932*    -------------------------------
  1933     05  ACVSTATL PIC S9(0004) COMP.
  1934     05  ACVSTATF PIC  X(0001).
  1935     05  FILLER REDEFINES ACVSTATF.
  1936         10  ACVSTATA PIC  X(0001).
  1937     05  ACVSTATI PIC  X(0006).
  1938*    -------------------------------
  1939     05  LABEL2L PIC S9(0004) COMP.
  1940     05  LABEL2F PIC  X(0001).
  1941     05  FILLER REDEFINES LABEL2F.
  1942         10  LABEL2A PIC  X(0001).
  1943     05  LABEL2I PIC  X(0014).
  1944*    -------------------------------
  1945     05  BCERT1L PIC S9(0004) COMP.
  1946     05  BCERT1F PIC  X(0001).
  1947     05  FILLER REDEFINES BCERT1F.
  1948         10  BCERT1A PIC  X(0001).
  1949     05  BCERT1I PIC  X(0010).
  1950*    -------------------------------
  1951     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  38
* EL131.cbl
  1952     05  BSUFX1F PIC  X(0001).
  1953     05  FILLER REDEFINES BSUFX1F.
  1954         10  BSUFX1A PIC  X(0001).
  1955     05  BSUFX1I PIC  X(0001).
  1956*    -------------------------------
  1957     05  BCERT2L PIC S9(0004) COMP.
  1958     05  BCERT2F PIC  X(0001).
  1959     05  FILLER REDEFINES BCERT2F.
  1960         10  BCERT2A PIC  X(0001).
  1961     05  BCERT2I PIC  X(0010).
  1962*    -------------------------------
  1963     05  BSUFX2L PIC S9(0004) COMP.
  1964     05  BSUFX2F PIC  X(0001).
  1965     05  FILLER REDEFINES BSUFX2F.
  1966         10  BSUFX2A PIC  X(0001).
  1967     05  BSUFX2I PIC  X(0001).
  1968*    -------------------------------
  1969     05  BCERT3L PIC S9(0004) COMP.
  1970     05  BCERT3F PIC  X(0001).
  1971     05  FILLER REDEFINES BCERT3F.
  1972         10  BCERT3A PIC  X(0001).
  1973     05  BCERT3I PIC  X(0010).
  1974*    -------------------------------
  1975     05  BSUFX3L PIC S9(0004) COMP.
  1976     05  BSUFX3F PIC  X(0001).
  1977     05  FILLER REDEFINES BSUFX3F.
  1978         10  BSUFX3A PIC  X(0001).
  1979     05  BSUFX3I PIC  X(0001).
  1980*    -------------------------------
  1981     05  BCERT4L PIC S9(0004) COMP.
  1982     05  BCERT4F PIC  X(0001).
  1983     05  FILLER REDEFINES BCERT4F.
  1984         10  BCERT4A PIC  X(0001).
  1985     05  BCERT4I PIC  X(0010).
  1986*    -------------------------------
  1987     05  BSUFX4L PIC S9(0004) COMP.
  1988     05  BSUFX4F PIC  X(0001).
  1989     05  FILLER REDEFINES BSUFX4F.
  1990         10  BSUFX4A PIC  X(0001).
  1991     05  BSUFX4I PIC  X(0001).
  1992*    -------------------------------
  1993     05  BCERT5L PIC S9(0004) COMP.
  1994     05  BCERT5F PIC  X(0001).
  1995     05  FILLER REDEFINES BCERT5F.
  1996         10  BCERT5A PIC  X(0001).
  1997     05  BCERT5I PIC  X(0010).
  1998*    -------------------------------
  1999     05  BSUFX5L PIC S9(0004) COMP.
  2000     05  BSUFX5F PIC  X(0001).
  2001     05  FILLER REDEFINES BSUFX5F.
  2002         10  BSUFX5A PIC  X(0001).
  2003     05  BSUFX5I PIC  X(0001).
  2004*    -------------------------------
  2005     05  MSG1L PIC S9(0004) COMP.
  2006     05  MSG1F PIC  X(0001).
  2007     05  FILLER REDEFINES MSG1F.
  2008         10  MSG1A PIC  X(0001).
  2009     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  39
* EL131.cbl
  2010*    -------------------------------
  2011     05  MSG2L PIC S9(0004) COMP.
  2012     05  MSG2F PIC  X(0001).
  2013     05  FILLER REDEFINES MSG2F.
  2014         10  MSG2A PIC  X(0001).
  2015     05  MSG2I PIC  X(0072).
  2016*    -------------------------------
  2017     05  PFKEYL PIC S9(0004) COMP.
  2018     05  PFKEYF PIC  X(0001).
  2019     05  FILLER REDEFINES PFKEYF.
  2020         10  PFKEYA PIC  X(0001).
  2021     05  PFKEYI PIC  99.
  2022*    -------------------------------
  2023     05  PFKEY6L PIC S9(0004) COMP.
  2024     05  PFKEY6F PIC  X(0001).
  2025     05  FILLER REDEFINES PFKEY6F.
  2026         10  PFKEY6A PIC  X(0001).
  2027     05  PFKEY6I PIC  X(0016).
  2028 01  EL131AO REDEFINES EL131AI.
  2029     05  FILLER            PIC  X(0012).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  DATEO PIC  X(0008).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  TIMEO PIC  99.99.
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  SEQUO PIC  X(0010).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  COMPO PIC  X(0003).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  USERIDO PIC  X(0004).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  LABEL1O PIC  X(0011).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  PCERTNOO PIC  X(0010).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  PSUFXO PIC  X(0001).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  CCNOO PIC  X(0016).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  MAINTO PIC  X(0001).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  CLAIMO PIC  X(0007).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  CARRO PIC  X(0001).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  40
* EL131.cbl
  2068     05  CERTO PIC  X(0010).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  SUFXO PIC  X(0001).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  TYPEO PIC  X(0001).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  BENPERO PIC  X(0002).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  INSTYPEO PIC  X(0001).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  STATUSO PIC  X(0006).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  INCO PIC  X(0008).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  REPO PIC  X(0008).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  ICD1O PIC  X(0008).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  ICD2O PIC  X(0008).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  DIAGO PIC  X(0060).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  ACCSWO PIC  X(0001).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  BENEO PIC  X(0010).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  BIRTHO PIC  X(0008).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  SOCIALO PIC  X(0011).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  SEXO PIC  X(0001).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  MLNAMEO PIC  X(0015).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  MFNAMEO PIC  X(0012).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  MMINITO PIC  X(0001).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  41
* EL131.cbl
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  CRTLNMEO PIC  X(0015).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  CRTFNMEO PIC  X(0012).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  CRTINITO PIC  X(0001).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  LOANBALO PIC  ZZZZZ9.99.
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  PROCO PIC  X(0004).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  SUPVO PIC  X(0001).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  PRICDO PIC  X(0001).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  CRITPO PIC  X(0002).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  EXTENSO PIC  X(0002).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  FILETOO PIC  X(0004).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  PTHRHDGO PIC  X(0010).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  PDTHRUO PIC  X(0008).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  PDAMTO PIC  Z(06).99.
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  NODAYSO PIC  ZZZ99.
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  NOPMTSO PIC  ZZ99.
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  FORMTYPO PIC  X(0001).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  ESTO PIC  X(0008).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  AUIDO PIC  X(0004).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  OCCO PIC  X(0006).
  2183*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  42
* EL131.cbl
  2184     05  FILLER            PIC  X(0003).
  2185     05  MNTDTO PIC  X(0008).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  MNTTYPEO PIC  X(0006).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  CERTCARO PIC  X(0001).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  CERTGRPO PIC  X(0006).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  CERTSTO PIC  X(0002).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  CERTACTO PIC  X(0010).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  CERTEFFO PIC  X(0008).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  ISSAGEO PIC  X(0002).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  APRO PIC  9(3).9(4).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  PMTFREQO PIC  99.
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  INDGRPO PIC  X(0001).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  PREMTYPO PIC  X(0001).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  REINCDO PIC  X(0001).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  JNTLNMEO PIC  X(0015).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  JNTFNMEO PIC  X(0012).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  JNTINITO PIC  X(0001).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  JNTAGEO PIC  X(0002).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  ADDONDTO PIC  X(0008).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  LCVDSCRO PIC  X(0006).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  43
* EL131.cbl
  2242     05  LCVKINDO PIC  X(0003).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  LCVCDO PIC  X(0002).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  LCVOTRMO PIC  999.
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  LCVRTRMO PIC  999.
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  LCVRATEO PIC  ZZZ.ZZ.
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  LCVFORMO PIC  X(0012).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  LCVCNDTO PIC  X(0008).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  LCVEXITO PIC  X(0008).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  LCVSTATO PIC  X(0006).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  ACVDSCRO PIC  X(0006).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  ACVKINDO PIC  X(0003).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  ACVCDO PIC  X(0002).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  ACVOTRMO PIC  999.
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  ACVRTRMO PIC  999.
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  ACVRATEO PIC  ZZZ.ZZ.
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  ACVFORMO PIC  X(0012).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  ACVCNDTO PIC  X(0008).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  44
* EL131.cbl
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  ACVSTATO PIC  X(0006).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  LABEL2O PIC  X(0014).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  BCERT1O PIC  X(0010).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  BSUFX1O PIC  X(0001).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  BCERT2O PIC  X(0010).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  BSUFX2O PIC  X(0001).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  BCERT3O PIC  X(0010).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  BSUFX3O PIC  X(0001).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  BCERT4O PIC  X(0010).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  BSUFX4O PIC  X(0001).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  BCERT5O PIC  X(0010).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  BSUFX5O PIC  X(0001).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  MSG1O PIC  X(0072).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  MSG2O PIC  X(0072).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  PFKEYO PIC  X(0002).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  PFKEY6O PIC  X(0016).
  2348*    -------------------------------
  2349
  2350*                                COPY ELCEMIB SUPPRESS.
  2351******************************************************************
  2352*                                                                *
  2353*                                                                *
  2354*                            ELCEMIB.                            *
  2355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2356*                            VMOD=2.005                          *
  2357*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  45
* EL131.cbl
  2358*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2359*                                                                *
  2360******************************************************************
  2361 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2362     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2363     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2364     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2365     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2366     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2367     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2368     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2369     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2370     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2371         88  EMI-NO-ERRORS                    VALUE '1'.
  2372         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2373         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2374     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2375         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2376     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2377         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2378         88  EMI-AREA1-FULL                   VALUE '2'.
  2379     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2380         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2381         88  EMI-AREA2-FULL                   VALUE '2'.
  2382     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2383         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2384         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2385         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2386         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2387         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2388     12  EMI-ERROR-LINES.
  2389         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2390         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2391         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2392         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2393             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2394                 24  EMI-ERR-NUM         PIC X(4).
  2395                 24  EMI-FILLER          PIC X.
  2396                 24  EMI-SEV             PIC X.
  2397                 24  FILLER              PIC X.
  2398             20  FILLER                  PIC X(02).
  2399     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2400         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2401             20  EMI-ERROR-NUMBER    PIC X(4).
  2402             20  EMI-FILL            PIC X.
  2403             20  EMI-SEVERITY        PIC X.
  2404             20  FILLER              PIC X.
  2405             20  EMI-ERROR-TEXT.
  2406                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2407                 24  FILLER          PIC X(55).
  2408     12  EMI-SEVERITY-SAVE           PIC X.
  2409         88  EMI-NOTE                    VALUE 'N'.
  2410         88  EMI-WARNING                 VALUE 'W'.
  2411         88  EMI-FORCABLE                VALUE 'F'.
  2412         88  EMI-FATAL                   VALUE 'X'.
  2413     12  EMI-MESSAGE-FLAG            PIC X.
  2414         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2415         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  46
* EL131.cbl
  2416     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2417     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2418         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2419         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2420         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2421     12  emi-claim-no                pic x(7).
  2422     12  emi-claim-type              pic x(6).
  2423     12  FILLER                      PIC X(124)  VALUE SPACES.
  2424     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2425     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2426     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2427     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2428
  2429*                                COPY ELCJPFX SUPPRESS.
  2430******************************************************************
  2431*                                                                *
  2432*                                                                *
  2433*                            ELCJPFX.                            *
  2434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2435*                            VMOD=2.002                          *
  2436*                                                                *
  2437*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2438*                                                                *
  2439*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2440*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2441*        ELCNTL - CONTROL FILE                                   *
  2442*        ELMSTR - CLAIM MASTERS                                  *
  2443*        ELTRLR - ACTIVITY TRAILERS                              *
  2444*        ELCHKQ - CHECK QUE                                      *
  2445******************************************************************
  2446 01  JOURNAL-RECORD.
  2447     12  jp-date                     pic s9(5) comp-3.
  2448     12  jp-time                     pic s9(7) comp-3.
  2449     12  JP-USER-ID                  PIC X(4).
  2450     12  JP-FILE-ID                  PIC X(8).
  2451     12  JP-PROGRAM-ID               PIC X(8).
  2452     12  JP-RECORD-TYPE              PIC X.
  2453         88 JP-ADD              VALUE 'A'.
  2454         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2455         88 JP-AFTER-CHANGE     VALUE 'C'.
  2456         88 JP-DELETE           VALUE 'D'.
  2457         88 JP-GENERIC-DELETE   VALUE 'G'.
  2458         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2459         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2460     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2461     12  JP-RECORD-AREA
  2462
  2463
  2464                                 PIC X(750).
  2465
  2466*                                COPY ELCCALC.
  2467******************************************************************
  2468*                                                                *
  2469*                           ELCCALC.                            *
  2470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2471*                            VMOD=2.025                          *
  2472*                                                                *
  2473*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  47
* EL131.cbl
  2474*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2475*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2476*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2477*                                                                *
  2478*  PASSED TO ELRTRM                                              *
  2479*  -----------------                                             *
  2480*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2481*  ORIGINAL TERM                                                 *
  2482*  BEGINNING DATE                                                *
  2483*  ENDING DATE                                                   *
  2484*  COMPANY I.D.                                                  *
  2485*  ACCOUNT MASTER USER FIELD                                     *
  2486*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2487*  FREE LOOK DAYS                                                *
  2488*                                                                *
  2489*  RETURNED FROM ELRTRM                                          *
  2490*  ---------------------                                         *
  2491*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2492*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2493*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2494*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2495*----------------------------------------------------------------*
  2496*  PASSED TO ELRAMT                                              *
  2497*  ----------------                                              *
  2498*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2499*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2500*  ORIGINAL AMOUNT                                               *
  2501*  ALTERNATE BENEFIT (BALLON)                                    *
  2502*  A.P.R. - NET PAY ONLY                                         *
  2503*  METHOD
  2504*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2505*  COMPANY I.D.                                                  *
  2506*  BENEFIT TYPE                                                  *
  2507*                                                                *
  2508*  RETURNED FROM ELRAMT                                          *
  2509*  --------------------                                          *
  2510*  REMAINING AMOUNT 1 - CURRENT                                  *
  2511*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2512*  REMAINING AMOUNT FACTOR
  2513*----------------------------------------------------------------*
  2514*  PASSED TO ELRESV                                              *
  2515*  -----------------                                             *
  2516*  CERTIFICATE EFFECTIVE DATE                                    *
  2517*  VALUATION DATE                                                *
  2518*  PAID THRU DATE                                                *
  2519*  BENEFIT                                                       *
  2520*  INCURRED DATE                                                 *
  2521*  REPORTED DATE                                                 *
  2522*  ISSUE AGE                                                     *
  2523*  TERM                                                          *
  2524*  CDT PERCENT                                                   *
  2525*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2526* *CLAIM TYPE (LIFE, A/H)                                        *
  2527* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2528* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2529*                                                                *
  2530*  RETURNED FROM ELRESV                                          *
  2531*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  48
* EL131.cbl
  2532*  CDT TABLE USED                                                *
  2533*  CDT FACTOR USED                                               *
  2534*  PAY TO CURRENT RESERVE                                        *
  2535*  I.B.N.R. - A/H ONLY                                           *
  2536*  FUTURE (ACCRUED) AH ONLY                                      *
  2537*----------------------------------------------------------------*
  2538*  PASSED TO ELRATE                                              *
  2539*  ----------------                                              *
  2540*  CERT ISSUE DATE                                               *
  2541*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2542*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2543*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2544*  STATE CODE (CLIENT DEFINED)                                   *
  2545*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2546*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2547*  DEVIATION CODE                                                *
  2548*  ISSUE AGE                                                     *
  2549*  ORIGINAL BENEFIT AMOUNT                                       *
  2550*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2551*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2552*  BENEFIT KIND (LIFE OR A/H)                                    *
  2553*  A.P.R.                                                        *
  2554*  METHOD
  2555*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2556*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2557*  COMPANY I.D. (3 CHARACTER)                                    *
  2558*  BENEFIT CODE                                                  *
  2559*  BENEFIT OVERRIDE CODE                                         *
  2560*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2561*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2562*  JOINT INDICATOR (CSL ONLY)                                    *
  2563*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2564*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2565*                                                                *
  2566*  RETURNED FROM ELRATE                                          *
  2567*  --------------------                                          *
  2568*  CALCULATED PREMIUM                                            *
  2569*  PREMIUM RATE                                                  *
  2570*  MORTALITY CODE                                                *
  2571*  MAX ATTAINED AGE                                              *
  2572*  MAX AGE                                                       *
  2573*  MAX TERM                                                      *
  2574*  MAX MONTHLY BENEFIT                                           *
  2575*  MAX TOTAL BENIFIT                                             *
  2576*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2577*----------------------------------------------------------------*
  2578*  PASSED TO ELRFND                                              *
  2579*  ----------------                                              *
  2580*  CERT ISSUE DATE                                               *
  2581*  REFUND DATE                                                   *
  2582*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2583*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2584*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2585*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2586*  STATE CODE (CLIENT DEFINED)                                   *
  2587*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2588*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2589*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  49
* EL131.cbl
  2590*  ISSUE AGE                                                     *
  2591*  ORIGINAL BENEFIT AMOUNT                                       *
  2592*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2593*  PROCESS TYPE (CANCEL)                                         *
  2594*  BENEFIT KIND (LIFE OR A/H)                                    *
  2595*  A.P.R.                                                        *
  2596*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2597*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2598*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2599*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2600*  COMPANY I.D. (3 CHARACTER)                                    *
  2601*  BENEFIT CODE                                                  *
  2602*  BENEFIT OVERRIDE CODE                                         *
  2603*                                                                *
  2604*  RETURNED FROM ELRFND                                          *
  2605*  --------------------                                          *
  2606*  CALCULATED REFUND                                             *
  2607*----------------------------------------------------------------*
  2608*  PASSED TO ELEARN                                              *
  2609*  ----------------                                              *
  2610*  CERT ISSUE DATE                                               *
  2611*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2612*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2613*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2614*  STATE CODE (CLIENT DEFINED)                                   *
  2615*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2616*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2617*  DEVIATION CODE                                                *
  2618*  ISSUE AGE                                                     *
  2619*  ORIGINAL BENEFIT AMOUNT                                       *
  2620*  BENEFIT KIND (LIFE OR A/H)                                    *
  2621*  A.P.R.                                                        *
  2622*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2623*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2624*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2625*  COMPANY I.D. (3 CHARACTER)                                    *
  2626*  BENEFIT CODE                                                  *
  2627*  BENEFIT OVERRIDE CODE                                         *
  2628*                                                                *
  2629*  RETURNED FROM ELEARN                                          *
  2630*  --------------------                                          *
  2631*  INDICATED  EARNINGS                                           *
  2632*----------------------------------------------------------------*
  2633*                 LENGTH = 450                                   *
  2634*                                                                *
  2635******************************************************************
  2636******************************************************************
  2637*                   C H A N G E   L O G
  2638*
  2639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2640*-----------------------------------------------------------------
  2641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2642* EFFECTIVE    NUMBER
  2643*-----------------------------------------------------------------
  2644* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2645* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2646* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2647* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  50
* EL131.cbl
  2648* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2649* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2650* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2651* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2652* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2653* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2654* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2655******************************************************************
  2656
  2657 01  CALCULATION-PASS-AREA.
  2658     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2659                                     COMP.
  2660
  2661     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2662       88  NO-CP-ERROR                             VALUE ZERO.
  2663       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2664                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2665       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2666       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2667       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2668       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2669       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2670       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2671       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2672       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2673       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2674       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2675       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2676       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2677       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2678       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2679       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2680       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2681       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2682
  2683     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2684       88  NO-CP-ERROR-2                           VALUE ZERO.
  2685***********************  INPUT AREAS ****************************
  2686
  2687     12  CP-CALCULATION-AREA.
  2688         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2689         16  CP-CERT-EFF-DT        PIC XX.
  2690         16  CP-VALUATION-DT       PIC XX.
  2691         16  CP-PAID-THRU-DT       PIC XX.
  2692         16  CP-BENEFIT-TYPE       PIC X.
  2693           88  CP-AH                               VALUE 'A' 'D'
  2694                                                   'I' 'U'.
  2695           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2696           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2697         16  CP-INCURRED-DT        PIC XX.
  2698         16  CP-REPORTED-DT        PIC XX.
  2699         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2700         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2701         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2702                                     COMP-3.
  2703         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2704                                     COMP-3.
  2705         16  CP-CDT-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  51
* EL131.cbl
  2706           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2707           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2708           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2709         16  CP-CLAIM-TYPE         PIC X.
  2710           88  CP-AH-CLAIM                         VALUE 'A'.
  2711           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2712         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2713                                     COMP-3.
  2714         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2715                                     COMP-3.
  2716         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2717                                     COMP-3.
  2718         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2719                                     COMP-3.
  2720         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2721                                     COMP-3.
  2722         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2723                                     COMP-3.
  2724         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2725                                     COMP-3.
  2726         16  CP-REM-TERM-METHOD    PIC X.
  2727           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2728           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2729           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2730           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2731           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2732           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2733           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2734         16  CP-EARNING-METHOD     PIC X.
  2735           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2736           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2737           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2738           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2739           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2740           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2741           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2742           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2743           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2744           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2745           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2746           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2747           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2748           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2749         16  CP-PROCESS-TYPE       PIC X.
  2750           88  CP-CLAIM                            VALUE '1'.
  2751           88  CP-CANCEL                           VALUE '2'.
  2752           88  CP-ISSUE                            VALUE '3'.
  2753         16  CP-SPECIAL-CALC-CD    PIC X.
  2754           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2755           88  CP-1-MTH-INTEREST               VALUE ' '.
  2756           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2757           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2758           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2759           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2760           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2761           88  CP-FARM-PLAN                    VALUE 'F'.
  2762           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2763           88  CP-2-MTH-INTEREST               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  52
* EL131.cbl
  2764           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2765           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2766           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2767           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2768           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2769           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2770           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2771           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2772                                                     'W' 'X'.
  2773           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2774           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2775           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2776           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2777           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2778           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2779           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2780           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2781           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2782           88  CP-CSL-METH-1                   VALUE '5'.
  2783           88  CP-CSL-METH-2                   VALUE '6'.
  2784           88  CP-CSL-METH-3                   VALUE '7'.
  2785           88  CP-CSL-METH-4                   VALUE '8'.
  2786
  2787         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2788                                     COMP-3.
  2789         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2790         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2791         16  CP-STATE              PIC XX          VALUE SPACE.
  2792         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2793         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2794           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2795               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2796         16  CP-R78-OPTION         PIC X.
  2797           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2798           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2799
  2800         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2801         16  CP-IBNR-RESERVE-SW    PIC X.
  2802         16  CP-CLAIM-STATUS       PIC X.
  2803         16  CP-RATE-FILE          PIC X.
  2804         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2805                                     COMP-3.
  2806
  2807         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2808         16  CP-AH-OVERRIDE-CODE   PIC X.
  2809
  2810         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2811                                     COMP-3.
  2812         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2813                                   PIC S9(5)V99 COMP-3.
  2814         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2815                                     COMP-3.
  2816         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2817                                     COMP-3.
  2818         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2819                                     COMP-3.
  2820         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2821                                  PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  53
* EL131.cbl
  2822
  2823         16  CP-PAID-FROM-DATE     PIC X(02).
  2824         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2825         16  CP-EXT-DAYS-CALC      PIC X.
  2826           88  CP-EXT-NO-CHG                   VALUE ' '.
  2827           88  CP-EXT-CHG-LF                   VALUE '1'.
  2828           88  CP-EXT-CHG-AH                   VALUE '2'.
  2829           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2830         16  CP-DOMICILE-STATE     PIC XX.
  2831         16  CP-CARRIER            PIC X.
  2832         16  CP-REIN-FLAG          PIC X.
  2833         16  CP-REM-TRM-CALC-OPTION PIC X.
  2834           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2835                      '2' '3' '4' '5'.
  2836           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2837           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2838           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2839           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2840           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2841           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2842           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2843           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2844         16  CP-SIG-SWITCH         PIC X.
  2845         16  CP-RATING-METHOD      PIC X.
  2846           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2847           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2848           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2849           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2850           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2851           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2852           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2853           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2854           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2855         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2856                                     COMP-3.
  2857         16  CP-BEN-CATEGORY       PIC X.
  2858         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2859         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2860                                   PIC S99V9(5) COMP-3.
  2861         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2862         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2863                                   PIC S99V9(5) COMP-3.
  2864         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2865         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2866         16  CP-EXPIRE-DT          PIC XX.
  2867         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2868         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2869         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2870         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2871         16  CP-DDF-SPEC-CALC      PIC X.
  2872             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2873             88  CP-CALC-CLP              VALUE 'C'.
  2874         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2875         16  CP-CANCEL-REASON      PIC X.
  2876         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2877         16  CP-PMT-MODE           PIC X.
  2878         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2879         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  54
* EL131.cbl
  2880         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2881         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2882         16  FILLER                PIC X.
  2883
  2884***************    OUTPUT FROM ELRESV   ************************
  2885
  2886         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2887
  2888         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2889                                     COMP-3.
  2890         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2891                                     COMP-3.
  2892         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2893                                     COMP-3.
  2894         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2895                                     COMP-3.
  2896         16  FILLER                PIC X(09).
  2897***************    OUTPUT FROM ELRTRM   *************************
  2898
  2899         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2900                                     COMP-3.
  2901         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2902                                     COMP-3.
  2903         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2904                                     COMP-3.
  2905         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2906                                     COMP-3.
  2907         16  FILLER                PIC X(12).
  2908
  2909***************    OUTPUT FROM ELRAMT   *************************
  2910
  2911         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2912                                     COMP-3.
  2913         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2914                                     COMP-3.
  2915         16  FILLER                PIC X(12).
  2916
  2917***************    OUTPUT FROM ELRATE   *************************
  2918
  2919         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2920                                     COMP-3.
  2921         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2922                                     COMP-3.
  2923         16  CP-MORTALITY-CODE     PIC X(4).
  2924         16  CP-RATE-EDIT-FLAG     PIC X.
  2925             88  CP-RATES-NEED-APR                  VALUE '1'.
  2926         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2927                                     COMP-3.
  2928         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2929         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2930         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2931                                   PIC S9(7)V99 COMP-3.
  2932         16  FILLER                PIC X(07).
  2933
  2934***************    OUTPUT FROM ELRFND   *************************
  2935
  2936         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2937                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  55
* EL131.cbl
  2938         16  CP-REFUND-TYPE-USED   PIC X.
  2939           88  CP-R-AS-R78                         VALUE '1'.
  2940           88  CP-R-AS-PRORATA                     VALUE '2'.
  2941           88  CP-R-AS-CALIF                       VALUE '3'.
  2942           88  CP-R-AS-TEXAS                       VALUE '4'.
  2943           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2944           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2945           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2946           88  CP-R-AS-MEAN                        VALUE '8'.
  2947           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2948           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2949           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2950           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2951           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2952           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2953         16  FILLER                PIC X(12).
  2954
  2955***************    OUTPUT FROM ELEARN   *************************
  2956
  2957         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2958                                     COMP-3.
  2959         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2960                                     COMP-3.
  2961         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2962                                     COMP-3.
  2963         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2964                                     COMP-3.
  2965         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2966                                     COMP-3.
  2967         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2968                                     COMP-3.
  2969         16  CP-EARNING-TYPE-USED  PIC X.
  2970           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2971           88  CP-E-AS-R78                         VALUE '1'.
  2972           88  CP-E-AS-PRORATA                     VALUE '2'.
  2973           88  CP-E-AS-TEXAS                       VALUE '4'.
  2974           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2975           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2976           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2977           88  CP-E-AS-MEAN                        VALUE '8'.
  2978           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2979         16  FILLER                PIC X(12).
  2980
  2981***************    OUTPUT FROM ELPMNT   *************************
  2982
  2983         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2984                                     COMP-3.
  2985         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2986                                     COMP-3.
  2987         16  FILLER                PIC X(12).
  2988
  2989***************   MISC WORK AREAS    *****************************
  2990         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2991                                     COMP-3.
  2992         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2993                                     COMP-3.
  2994         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2995                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  56
* EL131.cbl
  2996         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2997                                     COMP-3.
  2998         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2999                                     COMP-3.
  3000         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3001                                     COMP-3.
  3002         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3003             88  OPEN-RATE-FILE                   VALUE 'O'.
  3004             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3005             88  IO-ERROR                         VALUE 'E'.
  3006
  3007         16  CP-FIRST-PAY-DATE     PIC XX.
  3008
  3009         16  CP-JOINT-INDICATOR    PIC X.
  3010
  3011         16  CP-RESERVE-REMAINING-TERM
  3012                                   PIC S9(4)V9    VALUE ZERO
  3013                                     COMP-3.
  3014
  3015         16  CP-INSURED-BIRTH-DT   PIC XX.
  3016
  3017         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3018                                     COMP-3.
  3019
  3020         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3021                                     COMP-3.
  3022
  3023         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3024                                     COMP-3.
  3025
  3026         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3027                                     COMP-3.
  3028
  3029         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3030                                     COMP-3.
  3031
  3032         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3033                                     COMP-3.
  3034
  3035         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3036                                     COMP-3.
  3037
  3038         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3039             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3040
  3041         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3042                                     COMP-3.
  3043         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3044                                     COMP-3.
  3045         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3046         16  cp-extra-periods      pic 9 value zeros.
  3047         16  cp-net-only-state     pic x value spaces.
  3048         16  FILLER                PIC X(13).
  3049******************************************************************
  3050
  3051*                                COPY ELCDATE.
  3052******************************************************************
  3053*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  57
* EL131.cbl
  3054*                                                                *
  3055*                            ELCDATE.                            *
  3056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3057*                            VMOD=2.003
  3058*                                                                *
  3059*                                                                *
  3060*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3061*                 LENGTH = 200                                   *
  3062******************************************************************
  3063
  3064 01  DATE-CONVERSION-DATA.
  3065     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3066     12  DC-OPTION-CODE                PIC X.
  3067         88  BIN-TO-GREG                VALUE ' '.
  3068         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3069         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3070         88  YMD-GREG-TO-BIN            VALUE '3'.
  3071         88  MDY-GREG-TO-BIN            VALUE '4'.
  3072         88  JULIAN-TO-BIN              VALUE '5'.
  3073         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3074         88  FIND-CENTURY               VALUE '7'.
  3075         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3076         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3077         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3078         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3079         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3080         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3081         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3082         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3083         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3084         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3085         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3086         88  BIN-3-TO-GREG              VALUE 'I'.
  3087         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3088         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3089         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3090         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3091         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3092         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3093         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3094         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3095         88  THREE-CHARACTER-BIN
  3096                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3097         88  GREGORIAN-TO-BIN
  3098                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3099         88  BIN-TO-GREGORIAN
  3100                  VALUES ' ' '1' 'I' '8' 'G'.
  3101         88  JULIAN-TO-BINARY
  3102                  VALUES '5' 'C' 'E' 'F'.
  3103     12  DC-ERROR-CODE                 PIC X.
  3104         88  NO-CONVERSION-ERROR        VALUE ' '.
  3105         88  DATE-CONVERSION-ERROR
  3106                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3107         88  DATE-IS-ZERO               VALUE '1'.
  3108         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3109         88  DATE-IS-INVALID            VALUE '3'.
  3110         88  DATE1-GREATER-DATE2        VALUE '4'.
  3111         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  58
* EL131.cbl
  3112         88  DATE-INVALID-OPTION        VALUE '9'.
  3113         88  INVALID-CENTURY            VALUE 'A'.
  3114         88  ONLY-CENTURY               VALUE 'B'.
  3115         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3116         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3117     12  DC-END-OF-MONTH               PIC X.
  3118         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3119     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3120         88  USE-NORMAL-PROCESS         VALUE ' '.
  3121         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3122         88  ADJUST-UP-100-YRS          VALUE '2'.
  3123     12  FILLER                        PIC X.
  3124     12  DC-CONVERSION-DATES.
  3125         16  DC-BIN-DATE-1             PIC XX.
  3126         16  DC-BIN-DATE-2             PIC XX.
  3127         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3128         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3129                       DC-GREG-DATE-1-EDIT.
  3130             20  DC-EDIT1-MONTH        PIC 99.
  3131             20  SLASH1-1              PIC X.
  3132             20  DC-EDIT1-DAY          PIC 99.
  3133             20  SLASH1-2              PIC X.
  3134             20  DC-EDIT1-YEAR         PIC 99.
  3135         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3136         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3137                     DC-GREG-DATE-2-EDIT.
  3138             20  DC-EDIT2-MONTH        PIC 99.
  3139             20  SLASH2-1              PIC X.
  3140             20  DC-EDIT2-DAY          PIC 99.
  3141             20  SLASH2-2              PIC X.
  3142             20  DC-EDIT2-YEAR         PIC 99.
  3143         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3144         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3145                     DC-GREG-DATE-1-YMD.
  3146             20  DC-YMD-YEAR           PIC 99.
  3147             20  DC-YMD-MONTH          PIC 99.
  3148             20  DC-YMD-DAY            PIC 99.
  3149         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3150         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3151                      DC-GREG-DATE-1-MDY.
  3152             20  DC-MDY-MONTH          PIC 99.
  3153             20  DC-MDY-DAY            PIC 99.
  3154             20  DC-MDY-YEAR           PIC 99.
  3155         16  DC-GREG-DATE-1-ALPHA.
  3156             20  DC-ALPHA-MONTH        PIC X(10).
  3157             20  DC-ALPHA-DAY          PIC 99.
  3158             20  FILLER                PIC XX.
  3159             20  DC-ALPHA-CENTURY.
  3160                 24 DC-ALPHA-CEN-N     PIC 99.
  3161             20  DC-ALPHA-YEAR         PIC 99.
  3162         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3163         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3164         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3165         16  DC-JULIAN-DATE            PIC 9(05).
  3166         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3167                                       PIC 9(05).
  3168         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3169             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  59
* EL131.cbl
  3170             20  DC-JULIAN-DAYS        PIC 999.
  3171         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3172         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3173         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3174     12  DATE-CONVERSION-VARIBLES.
  3175         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3176         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3177             20  FILLER                PIC 9(3).
  3178             20  HOLD-CEN-1-CCYY.
  3179                 24  HOLD-CEN-1-CC     PIC 99.
  3180                 24  HOLD-CEN-1-YY     PIC 99.
  3181             20  HOLD-CEN-1-MO         PIC 99.
  3182             20  HOLD-CEN-1-DA         PIC 99.
  3183         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3184             20  HOLD-CEN-1-R-MO       PIC 99.
  3185             20  HOLD-CEN-1-R-DA       PIC 99.
  3186             20  HOLD-CEN-1-R-CCYY.
  3187                 24  HOLD-CEN-1-R-CC   PIC 99.
  3188                 24  HOLD-CEN-1-R-YY   PIC 99.
  3189             20  FILLER                PIC 9(3).
  3190         16  HOLD-CENTURY-1-X.
  3191             20  FILLER                PIC X(3)  VALUE SPACES.
  3192             20  HOLD-CEN-1-X-CCYY.
  3193                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3194                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3195             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3196             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3197         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3198             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3199             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3200             20  HOLD-CEN-1-R-X-CCYY.
  3201                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3202                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3203             20  FILLER                PIC XXX.
  3204         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3205         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3206         16  DC-JULIAN-DATE-1          PIC 9(07).
  3207         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3208             20  DC-JULIAN-1-CCYY.
  3209                 24  DC-JULIAN-1-CC    PIC 99.
  3210                 24  DC-JULIAN-1-YR    PIC 99.
  3211             20  DC-JULIAN-DA-1        PIC 999.
  3212         16  DC-JULIAN-DATE-2          PIC 9(07).
  3213         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3214             20  DC-JULIAN-2-CCYY.
  3215                 24  DC-JULIAN-2-CC    PIC 99.
  3216                 24  DC-JULIAN-2-YR    PIC 99.
  3217             20  DC-JULIAN-DA-2        PIC 999.
  3218         16  DC-GREG-DATE-A-EDIT.
  3219             20  DC-EDITA-MONTH        PIC 99.
  3220             20  SLASHA-1              PIC X VALUE '/'.
  3221             20  DC-EDITA-DAY          PIC 99.
  3222             20  SLASHA-2              PIC X VALUE '/'.
  3223             20  DC-EDITA-CCYY.
  3224                 24  DC-EDITA-CENT     PIC 99.
  3225                 24  DC-EDITA-YEAR     PIC 99.
  3226         16  DC-GREG-DATE-B-EDIT.
  3227             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  60
* EL131.cbl
  3228             20  SLASHB-1              PIC X VALUE '/'.
  3229             20  DC-EDITB-DAY          PIC 99.
  3230             20  SLASHB-2              PIC X VALUE '/'.
  3231             20  DC-EDITB-CCYY.
  3232                 24  DC-EDITB-CENT     PIC 99.
  3233                 24  DC-EDITB-YEAR     PIC 99.
  3234         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3235         16  DC-GREG-DATE-CYMD-R REDEFINES
  3236                              DC-GREG-DATE-CYMD.
  3237             20  DC-CYMD-CEN           PIC 99.
  3238             20  DC-CYMD-YEAR          PIC 99.
  3239             20  DC-CYMD-MONTH         PIC 99.
  3240             20  DC-CYMD-DAY           PIC 99.
  3241         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3242         16  DC-GREG-DATE-MDCY-R REDEFINES
  3243                              DC-GREG-DATE-MDCY.
  3244             20  DC-MDCY-MONTH         PIC 99.
  3245             20  DC-MDCY-DAY           PIC 99.
  3246             20  DC-MDCY-CEN           PIC 99.
  3247             20  DC-MDCY-YEAR          PIC 99.
  3248    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3249        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3250    12  DC-EL310-DATE                  PIC X(21).
  3251    12  FILLER                         PIC X(28).
  3252
  3253*                                COPY ELCDMO.
  3254******************************************************************
  3255*                                                                *
  3256*                                                                *
  3257*                            ELCDMO.                             *
  3258*                            VMOD=2.004                          *
  3259*                                                                *
  3260*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3261*        COMMUNICATION AREA                                      *
  3262*   FILE TYPE = NA                                               *
  3263*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3264*                                                                *
  3265******************************************************************
  3266 01  DMO-COMMUNICATION-AREA.
  3267     12  DM-RECORD-TYPE                  PIC  X(02).
  3268             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3269             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3270             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3271     12  DM-DIST-CODE                    PIC  X(04).
  3272     12  DM-MAIL-CODE                    PIC  X(05).
  3273     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3274     12  DM-INSURED-NAME                 PIC  X(30).
  3275     12  DM-CLAIM-NO                     PIC  X(07).
  3276     12  DM-CLAIM-TYPE                   PIC  X.
  3277
  3278     12  DM-STATUS-DATA-AREA.
  3279         16  DM-CLAIM-STATUS             PIC  X.
  3280             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3281             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3282             88  DM-CLOSED                        VALUE '3'.
  3283             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3284             88  DM-DEFAULT                       VALUE '9'.
  3285         16  DM-STATUS-DATE              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  61
* EL131.cbl
  3286******YYYYMMDD
  3287         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3288             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3289             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3290             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3291             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3292             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3293             88  DM-RE-OPENED                     VALUE 'R'.
  3294             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3295             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3296             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3297         16  DM-STAT-CARRIER             PIC X.
  3298
  3299     12  DM-DRAFT-DATA-AREA.
  3300         16  DM-PAYMENT-TYPE             PIC  X.
  3301             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3302         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3303         16  DM-PAYMENT-DATE             PIC  X(08).
  3304******YYYYMMDD
  3305         16  DM-CERT-NO                  PIC  X(11).
  3306         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3307         16  DM-CARRIER                  PIC  X.
  3308
  3309     12  DM-RETURN-CODE                  PIC  XX.
  3310*                                COPY ERCPDEF.
  3311******************************************************************
  3312*                                                                *
  3313*                                                                *
  3314*                            ERCPDEF.                            *
  3315*                                                                *
  3316*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3317*                                                                *
  3318*    FILE TYPE = VSAM,KSDS                                       *
  3319*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3320*                                                                *
  3321*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3322*                                                                *
  3323*    LOG = YES                                                   *
  3324*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3325******************************************************************
  3326*                   C H A N G E   L O G
  3327*
  3328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3329*-----------------------------------------------------------------
  3330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3331* EFFECTIVE    NUMBER
  3332*-----------------------------------------------------------------
  3333* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3334* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3335* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3336* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3337******************************************************************
  3338 01  PRODUCT-MASTER.
  3339    12  PD-RECORD-ID                 PIC X(02).
  3340        88  VALID-PD-ID                  VALUE 'PD'.
  3341    12  PD-CONTROL-PRIMARY.
  3342        16  PD-COMPANY-CD            PIC X.
  3343        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  62
* EL131.cbl
  3344        16  PD-PRODUCT-CD            PIC XXX.
  3345        16  PD-FILLER                PIC X(7).
  3346        16  PD-BEN-TYPE              PIC X.
  3347        16  PD-BEN-CODE              PIC XX.
  3348        16  PD-PROD-EXP-DT           PIC XX.
  3349    12  FILLER                       PIC X(50).
  3350    12  PD-PRODUCT-DATA OCCURS 8.
  3351        16  PD-PROD-CODE             PIC X.
  3352            88  PD-PROD-LIFE           VALUE 'L'.
  3353            88  PD-PROD-PROP           VALUE 'P'.
  3354            88  PD-PROD-AH             VALUE 'A'.
  3355            88  PD-PROD-IU             VALUE 'I'.
  3356            88  PD-PROD-GAP            VALUE 'G'.
  3357            88  PD-PROD-FAML           VALUE 'F'.
  3358            88  PD-PROD-OTH            VALUE 'O'.
  3359        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3360        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3361        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3362        16  PD-MAX-TERM              PIC S999        COMP-3.
  3363        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3364        16  FILLER                   PIC X.
  3365        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3366        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3367        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3368        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3369        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3370        16  PD-REC-CRIT-PERIOD       PIC 99.
  3371        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3372            20  PD-RECURRING-YN      PIC X.
  3373            20  FILLER               PIC X.
  3374        16  PD-RTW-MOS               PIC 99.
  3375        16  PD-MAX-EXTENSION         PIC 99.
  3376        16  pd-ben-pct               pic sv999 comp-3.
  3377*       16  FILLER                   PIC XX.
  3378    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3379    12  PD-TERM-LIMITS OCCURS 15.
  3380        16  PD-LOW-TERM              PIC S999        COMP-3.
  3381        16  PD-HI-TERM               PIC S999        COMP-3.
  3382*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3383    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3384        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3385        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3386    12  PD-EARN-FACTORS.
  3387        16  FILLER OCCURS 15.
  3388            20  FILLER OCCURS 15.
  3389                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3390    12  PD-PRODUCT-DESC              PIC X(80).
  3391    12  PD-TRUNCATED                 PIC X.
  3392    12  FILLER                       PIC X(59).
  3393    12  PD-MAINT-INFORMATION.
  3394        16  PD-LAST-MAINT-DT         PIC X(02).
  3395        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3396        16  PD-LAST-MAINT-BY         PIC X(04).
  3397*                                COPY ELCCRTT.
  3398******************************************************************
  3399*                                                                *
  3400*                            ELCCRTT.                            *
  3401*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  63
* EL131.cbl
  3402*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3403*                                                                *
  3404*   FILE TYPE = VSAM,KSDS                                        *
  3405*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3406*                                                                *
  3407*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3408*                                                                *
  3409*   LOG = YES                                                    *
  3410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3411******************************************************************
  3412*                   C H A N G E   L O G
  3413*
  3414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3415*-----------------------------------------------------------------
  3416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3417* EFFECTIVE    NUMBER
  3418*-----------------------------------------------------------------
  3419* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3420* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3421* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3422* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3423* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3424* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3425* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3426* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3427* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3428* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3429* 091318  CR2018073000001  PEMA  ADD Refund methods
  3430* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3431******************************************************************
  3432
  3433 01  CERTIFICATE-TRAILERS.
  3434     12  CS-RECORD-ID                      PIC XX.
  3435         88  VALID-CS-ID                      VALUE 'CS'.
  3436
  3437     12  CS-CONTROL-PRIMARY.
  3438         16  CS-COMPANY-CD                 PIC X.
  3439         16  CS-CARRIER                    PIC X.
  3440         16  CS-GROUPING                   PIC X(6).
  3441         16  CS-STATE                      PIC XX.
  3442         16  CS-ACCOUNT                    PIC X(10).
  3443         16  CS-CERT-EFF-DT                PIC XX.
  3444         16  CS-CERT-NO.
  3445             20  CS-CERT-PRIME             PIC X(10).
  3446             20  CS-CERT-SFX               PIC X.
  3447         16  CS-TRAILER-TYPE               PIC X.
  3448             88  COMM-TRLR           VALUE 'A'.
  3449             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3450             88  CERT-DATA-TRLR      VALUE 'C'.
  3451
  3452     12  CS-DATA-AREA                      PIC X(516).
  3453
  3454     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3455         16  CS-BANK-COMMISSION-AREA.
  3456             20  CS-BANK-COMMS       OCCURS 10.
  3457                 24  CS-AGT                PIC X(10).
  3458                 24  CS-COM-TYP            PIC X.
  3459                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  64
* EL131.cbl
  3460                 24  CS-RECALC-LV-INDIC    PIC X.
  3461                 24  FILLER                PIC X(10).
  3462         16  FILLER                        PIC X(256).
  3463
  3464     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3465****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3466         16  CS-MB-CLAIM-DATA OCCURS 24.
  3467             20  CS-CLAIM-NO               PIC X(7).
  3468             20  CS-CLAIM-TYPE             PIC X.
  3469                 88  CS-AH-CLM               VALUE 'A'.
  3470                 88  CS-IU-CLM               VALUE 'I'.
  3471                 88  CS-GP-CLM               VALUE 'G'.
  3472                 88  CS-LF-CLM               VALUE 'L'.
  3473                 88  CS-PR-CLM               VALUE 'P'.
  3474                 88  CS-FL-CLM               VALUE 'F'.
  3475                 88  CS-OT-CLM               VALUE 'O'.
  3476             20  CS-INSURED-TYPE           PIC X.
  3477                 88  CS-PRIM-INSURED          VALUE 'P'.
  3478                 88  CS-CO-BORROWER           VALUE 'C'.
  3479             20  CS-BENEFIT-PERIOD         PIC 99.
  3480             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3481             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3482             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3483         16  FILLER                        PIC X(12).
  3484     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3485         16  CS-VIN-NUMBER                 PIC X(17).
  3486         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3487         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3488         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3489         16  cs-agent-name.
  3490             20  cs-agent-fname            pic x(20).
  3491             20  cs-agent-mi               pic x.
  3492             20  cs-agent-lname            pic x(25).
  3493         16  cs-license-no                 pic x(15).
  3494         16  cs-npn-number                 pic x(10).
  3495         16  cs-agent-edit-status          pic x.
  3496             88  cs-ae-refer-to-manager      value 'M'.
  3497             88  cs-ae-cover-sheet           value 'C'.
  3498             88  cs-ae-sig-form              value 'S'.
  3499             88  cs-ae-verified              value 'V'.
  3500             88  cs-unidentified-signature   value 'U'.
  3501             88  cs-cert-returned            value 'R'.
  3502             88  cs-accept-no-commission     value 'N'.
  3503         16  cs-year                       pic 9999.
  3504         16  cs-make                       pic x(20).
  3505         16  cs-model                      pic x(20).
  3506         16  cs-future                     pic x(20).
  3507         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3508         16  cs-claim-verification-status  pic x.
  3509             88  cs-clm-ver-eligible         value 'A'.
  3510             88  cs-clm-ver-partial-elig     value 'B'.
  3511             88  cs-clm-ver-not-eligible     value 'C'.
  3512             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3513             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3514             88  cs-clm-ver-ND-CERT          value 'F'.
  3515             88  cs-clm-ver-spec-other       value 'G'.
  3516             88  cs-clam-ver-pratial-corrected
  3517                                             value 'H'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  65
* EL131.cbl
  3518             88  cs-clm-ver-no-matches       value 'I'.
  3519             88  cs-clm-ver-not-elig-corrected
  3520                                             value 'J'.
  3521             88  cs-clm-ver-needs-review     value 'R'.
  3522             88  cs-clm-ver-sent-to-claims   value 'W'.
  3523         16  CS-LF-REFUND-METHOD           PIC X.
  3524         16  CS-AH-REFUND-METHOD           PIC X.
  3525         16  FILLER                        PIC X(353). *> was 420
  3526*        16  FILLER                        PIC X(496).
  3527
  3528****************************************************************
  3529*
  3530* Copyright (c) 2007-2013 Dell Inc.
  3531* All rights reserved.
  3532*
  3533****************************************************************
  3534 01  DFHEIV.
  3535   02  DFHEIV0               PIC X(35).
  3536   02  DFHEIV1               PIC X(08).
  3537   02  DFHEIV2               PIC X(08).
  3538   02  DFHEIV3               PIC X(08).
  3539   02  DFHEIV4               PIC X(06).
  3540   02  DFHEIV5               PIC X(04).
  3541   02  DFHEIV6               PIC X(04).
  3542   02  DFHEIV7               PIC X(02).
  3543   02  DFHEIV8               PIC X(02).
  3544   02  DFHEIV9               PIC X(01).
  3545   02  DFHEIV10              PIC S9(7) COMP-3.
  3546   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3547   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3548   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3549   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3550   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3551   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3552   02  DFHEIV17              PIC X(04).
  3553   02  DFHEIV18              PIC X(04).
  3554   02  DFHEIV19              PIC X(04).
  3555   02  DFHEIV20              USAGE IS POINTER.
  3556   02  DFHEIV21              USAGE IS POINTER.
  3557   02  DFHEIV22              USAGE IS POINTER.
  3558   02  DFHEIV23              USAGE IS POINTER.
  3559   02  DFHEIV24              USAGE IS POINTER.
  3560   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3561   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3562   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3563   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3564   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3565   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3566   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3567   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3568   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3569   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3570   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3571   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3572   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3573   02  FILLER                PIC X(02).
  3574   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3575   02  DFHEIVL0              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  66
* EL131.cbl
  3576   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3577   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3578   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3579   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3580   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3581 LINKAGE  SECTION.
  3582*****************************************************************
  3583*                                                               *
  3584* Copyright (c) 2007-2013 Dell Inc.                             *
  3585* All rights reserved.                                          *
  3586*                                                               *
  3587*****************************************************************
  3588 01  dfheiblk.
  3589     02  eibtime          pic s9(7) comp-3.
  3590     02  eibdate          pic s9(7) comp-3.
  3591     02  eibtrnid         pic x(4).
  3592     02  eibtaskn         pic s9(7) comp-3.
  3593     02  eibtrmid         pic x(4).
  3594     02  dfheigdi         pic s9(4) comp.
  3595     02  eibcposn         pic s9(4) comp.
  3596     02  eibcalen         pic s9(4) comp.
  3597     02  eibaid           pic x(1).
  3598     02  eibfiller1       pic x(1).
  3599     02  eibfn            pic x(2).
  3600     02  eibfiller2       pic x(2).
  3601     02  eibrcode         pic x(6).
  3602     02  eibfiller3       pic x(2).
  3603     02  eibds            pic x(8).
  3604     02  eibreqid         pic x(8).
  3605     02  eibrsrce         pic x(8).
  3606     02  eibsync          pic x(1).
  3607     02  eibfree          pic x(1).
  3608     02  eibrecv          pic x(1).
  3609     02  eibsend          pic x(1).
  3610     02  eibatt           pic x(1).
  3611     02  eibeoc           pic x(1).
  3612     02  eibfmh           pic x(1).
  3613     02  eibcompl         pic x(1).
  3614     02  eibsig           pic x(1).
  3615     02  eibconf          pic x(1).
  3616     02  eiberr           pic x(1).
  3617     02  eibrldbk         pic x(1).
  3618     02  eiberrcd         pic x(4).
  3619     02  eibsynrb         pic x(1).
  3620     02  eibnodat         pic x(1).
  3621     02  eibfiller5       pic x(2).
  3622     02  eibresp          pic s9(8) comp.
  3623     02  eibresp2         pic s9(8) comp.
  3624     02  dfheigdj         pic s9(4) comp.
  3625     02  dfheigdk         pic s9(4) comp.
  3626 01  DFHCOMMAREA                 PIC X(1024).
  3627
  3628*                                COPY ELCMSTR.
  3629******************************************************************
  3630*                                                                *
  3631*                            ELCMSTR.                            *
  3632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3633*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  67
* EL131.cbl
  3634*                                                                *
  3635*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3636*                                                                *
  3637*   FILE TYPE = VSAM,KSDS                                        *
  3638*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3639*                                                                *
  3640*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3641*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3642*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3643*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3644*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3645*                                                 RKP=75,LEN=21  *
  3646*                                                                *
  3647*   **** NOTE ****                                               *
  3648*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3649*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3650*                                                                *
  3651*   LOG = YES                                                    *
  3652*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3653******************************************************************
  3654*                   C H A N G E   L O G
  3655*
  3656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3657*-----------------------------------------------------------------
  3658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3659* EFFECTIVE    NUMBER
  3660*-----------------------------------------------------------------
  3661* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3662* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3663* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3664* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3665* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3666* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3667* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3668******************************************************************
  3669 01  CLAIM-MASTER.
  3670     12  CL-RECORD-ID                PIC XX.
  3671         88  VALID-CL-ID         VALUE 'CL'.
  3672
  3673     12  CL-CONTROL-PRIMARY.
  3674         16  CL-COMPANY-CD           PIC X.
  3675         16  CL-CARRIER              PIC X.
  3676         16  CL-CLAIM-NO             PIC X(7).
  3677         16  CL-CERT-NO.
  3678             20  CL-CERT-PRIME       PIC X(10).
  3679             20  CL-CERT-SFX         PIC X.
  3680
  3681     12  CL-CONTROL-BY-NAME.
  3682         16  CL-COMPANY-CD-A1        PIC X.
  3683         16  CL-INSURED-LAST-NAME    PIC X(15).
  3684         16  CL-INSURED-NAME.
  3685             20  CL-INSURED-1ST-NAME PIC X(12).
  3686             20  CL-INSURED-MID-INIT PIC X.
  3687
  3688     12  CL-CONTROL-BY-SSN.
  3689         16  CL-COMPANY-CD-A2        PIC X.
  3690         16  CL-SOC-SEC-NO.
  3691             20  CL-SSN-STATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  68
* EL131.cbl
  3692             20  CL-SSN-ACCOUNT      PIC X(6).
  3693             20  CL-SSN-LN3          PIC X(3).
  3694
  3695     12  CL-CONTROL-BY-CERT-NO.
  3696         16  CL-COMPANY-CD-A4        PIC X.
  3697         16  CL-CERT-NO-A4.
  3698             20  CL-CERT-A4-PRIME    PIC X(10).
  3699             20  CL-CERT-A4-SFX      PIC X.
  3700
  3701     12  CL-CONTROL-BY-CCN.
  3702         16  CL-COMPANY-CD-A5        PIC X.
  3703         16  CL-CCN-A5.
  3704             20  CL-CCN.
  3705                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3706                 24  CL-CCN-PRIME-A5 PIC X(12).
  3707             20  CL-CCN-FILLER-A5    PIC X(4).
  3708
  3709     12  CL-INSURED-PROFILE-DATA.
  3710         16  CL-INSURED-BIRTH-DT     PIC XX.
  3711         16  CL-INSURED-SEX-CD       PIC X.
  3712             88  INSURED-IS-MALE        VALUE 'M'.
  3713             88  INSURED-IS-FEMALE      VALUE 'F'.
  3714             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3715         16  CL-INSURED-OCC-CD       PIC X(6).
  3716         16  FILLER                  PIC X(5).
  3717
  3718     12  CL-PROCESSING-INFO.
  3719         16  CL-PROCESSOR-ID         PIC X(4).
  3720         16  CL-CLAIM-STATUS         PIC X.
  3721             88  CLAIM-IS-OPEN          VALUE 'O'.
  3722             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3723         16  CL-CLAIM-TYPE           PIC X.
  3724*            88  AH-CLAIM               VALUE 'A'.
  3725*            88  LIFE-CLAIM             VALUE 'L'.
  3726*            88  PROPERTY-CLAIM         VALUE 'P'.
  3727*            88  IUI-CLAIM              VALUE 'I'.
  3728*            88  GAP-CLAIM              VALUE 'G'.
  3729*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3730*            88  OTHER-CLAIM            VALUE 'O'.
  3731         16  CL-CLAIM-PREM-TYPE      PIC X.
  3732             88  SINGLE-PREMIUM         VALUE '1'.
  3733             88  O-B-COVERAGE           VALUE '2'.
  3734             88  OPEN-END-COVERAGE      VALUE '3'.
  3735         16  CL-INCURRED-DT          PIC XX.
  3736         16  CL-REPORTED-DT          PIC XX.
  3737         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3738         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3739         16  CL-LAST-PMT-DT          PIC XX.
  3740         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3741         16  CL-PAID-THRU-DT         PIC XX.
  3742         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3743         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3744         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3745         16  CL-PMT-CALC-METHOD      PIC X.
  3746             88  CL-360-DAY-YR          VALUE '1'.
  3747             88  CL-365-DAY-YR          VALUE '2'.
  3748             88  CL-FULL-MONTHS         VALUE '3'.
  3749         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  69
* EL131.cbl
  3750
  3751         16  CL-PRIME-CERT-NO.
  3752             20  CL-PRIME-CERT-PRIME PIC X(10).
  3753             20  CL-PRIME-CERT-SFX   PIC X.
  3754
  3755         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3756             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3757             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3758
  3759         16  CL-MICROFILM-NO         PIC X(10).
  3760         16  FILLER REDEFINES CL-MICROFILM-NO.
  3761             20  CL-BENEFIT-PERIOD   PIC 99.
  3762             20  FILLER              PIC X(8).
  3763         16  CL-PROG-FORM-TYPE       PIC X.
  3764         16  CL-LAST-ADD-ON-DT       PIC XX.
  3765
  3766         16  CL-LAST-REOPEN-DT       PIC XX.
  3767         16  CL-LAST-CLOSE-DT        PIC XX.
  3768         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3769             88  FINAL-PAID             VALUE '1'.
  3770             88  CLAIM-DENIED           VALUE '2'.
  3771             88  AUTO-CLOSE             VALUE '3'.
  3772             88  MANUAL-CLOSE           VALUE '4'.
  3773             88  BENEFITS-CHANGED       VALUE 'C'.
  3774             88  SETUP-ERRORS           VALUE 'E'.
  3775         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3776         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3777         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3778             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3779         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3780         16  FILLER                  PIC X.
  3781
  3782     12  CL-CERTIFICATE-DATA.
  3783         16  CL-CERT-ORIGIN          PIC X.
  3784             88  CERT-WAS-ONLINE        VALUE '1'.
  3785             88  CERT-WAS-CREATED       VALUE '2'.
  3786             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3787         16  CL-CERT-KEY-DATA.
  3788             20  CL-CERT-CARRIER     PIC X.
  3789             20  CL-CERT-GROUPING    PIC X(6).
  3790             20  CL-CERT-STATE       PIC XX.
  3791             20  CL-CERT-ACCOUNT.
  3792                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3793                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3794             20  CL-CERT-EFF-DT      PIC XX.
  3795
  3796     12  CL-STATUS-CONTROLS.
  3797         16  CL-PRIORITY-CD          PIC X.
  3798             88  CONFIDENTIAL-DATA      VALUE '8'.
  3799             88  HIGHEST-PRIORITY       VALUE '9'.
  3800         16  CL-SUPV-ATTN-CD         PIC X.
  3801             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3802             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3803         16  CL-PURGED-DT            PIC XX.
  3804         16  CL-RESTORED-DT          PIC XX.
  3805         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3806         16  CL-NEXT-RESEND-DT       PIC XX.
  3807         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  70
* EL131.cbl
  3808         16  CL-CRITICAL-PERIOD      PIC 99.
  3809*        16  FILLER                  PIC XX.
  3810         16  CL-LAST-MAINT-DT        PIC XX.
  3811         16  CL-LAST-MAINT-USER      PIC X(4).
  3812         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3813         16  CL-LAST-MAINT-TYPE      PIC X.
  3814             88  CLAIM-SET-UP           VALUE ' '.
  3815             88  PAYMENT-MADE           VALUE '1'.
  3816             88  LETTER-SENT            VALUE '2'.
  3817             88  MASTER-WAS-ALTERED     VALUE '3'.
  3818             88  MASTER-WAS-RESTORED    VALUE '4'.
  3819             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3820             88  FILE-CONVERTED         VALUE '6'.
  3821             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3822             88  ERROR-CORRECTION       VALUE 'E'.
  3823         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3824         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3825         16  CL-BENEFICIARY          PIC X(10).
  3826         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3827         16  CL-DENIAL-TYPE          PIC X.
  3828             88  CL-TYPE-DENIAL          VALUE '1'.
  3829             88  CL-TYPE-RESCISSION      VALUE '2'.
  3830             88  CL-TYPE-REFORMATION     VALUE '3'.
  3831             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3832             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3833         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3834         16  filler                  pic x(3).
  3835*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3836*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3837*        16  CL-RTW-DT               PIC XX.
  3838
  3839     12  CL-TRAILER-CONTROLS.
  3840         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3841             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3842             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3843             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3844         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3845         16  FILLER                  PIC XX.
  3846         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3847         16  CL-ADDRESS-TRAILER-CNT.
  3848             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3849                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3850             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3851                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3852             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3853                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3854             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3855                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3856             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3857                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3858             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3859                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3860             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3861                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3862
  3863     12  CL-CV-REFERENCE-NO.
  3864         16  CL-CV-REFNO-PRIME       PIC X(18).
  3865         16  CL-CV-REFNO-SFX         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  71
* EL131.cbl
  3866
  3867     12  CL-FILE-LOCATION            PIC X(4).
  3868
  3869     12  CL-PROCESS-ERRORS.
  3870         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3871             88  NO-FATAL-ERRORS        VALUE ZERO.
  3872         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3873             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3874
  3875     12  CL-PRODUCT-CD               PIC X.
  3876
  3877     12  CL-CURRENT-KEY-DATA.
  3878         16  CL-CURRENT-CARRIER      PIC X.
  3879         16  CL-CURRENT-GROUPING     PIC X(6).
  3880         16  CL-CURRENT-STATE        PIC XX.
  3881         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3882
  3883     12  CL-ASSOCIATES               PIC X.
  3884         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3885         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3886         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3887         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3888
  3889     12  CL-ACTIVITY-CODE            PIC 99.
  3890     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3891     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3892
  3893     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3894     12  CL-LAG-REPORT-CODE          PIC 9.
  3895     12  CL-LOAN-TYPE                PIC XX.
  3896     12  CL-LEGAL-STATE              PIC XX.
  3897
  3898     12  CL-YESNOSW                  PIC X.
  3899     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3900         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3901         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3902         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3903     12  cl-insured-type             pic x.
  3904         88  cl-claim-on-primary         value 'P'.
  3905         88  cl-claim-on-co-borrower     value 'C'.
  3906     12  cl-benefit-expiration-dt    PIC XX.
  3907
  3908*                                COPY ELCCERT.
  3909******************************************************************
  3910*                                                                *
  3911*                            ELCCERT.                            *
  3912*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3913*                            VMOD=2.013                          *
  3914*                                                                *
  3915*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3916*                                                                *
  3917*   FILE TYPE = VSAM,KSDS                                        *
  3918*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3919*                                                                *
  3920*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3921*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3922*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3923*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  72
* EL131.cbl
  3924*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3925*                                                                *
  3926*   LOG = YES                                                    *
  3927*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3928******************************************************************
  3929*                   C H A N G E   L O G
  3930*
  3931* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3932*-----------------------------------------------------------------
  3933*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3934* EFFECTIVE    NUMBER
  3935*-----------------------------------------------------------------
  3936* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3937* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3938* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3939* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3940* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3941* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3942* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3943* 032612  CR2011110200001  PEMA  AHL CHANGES
  3944* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3945* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3946* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  3947******************************************************************
  3948
  3949 01  CERTIFICATE-MASTER.
  3950     12  CM-RECORD-ID                      PIC XX.
  3951         88  VALID-CM-ID                      VALUE 'CM'.
  3952
  3953     12  CM-CONTROL-PRIMARY.
  3954         16  CM-COMPANY-CD                 PIC X.
  3955         16  CM-CARRIER                    PIC X.
  3956         16  CM-GROUPING.
  3957             20  CM-GROUPING-PREFIX        PIC X(3).
  3958             20  CM-GROUPING-PRIME         PIC X(3).
  3959         16  CM-STATE                      PIC XX.
  3960         16  CM-ACCOUNT.
  3961             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3962             20  CM-ACCOUNT-PRIME          PIC X(6).
  3963         16  CM-CERT-EFF-DT                PIC XX.
  3964         16  CM-CERT-NO.
  3965             20  CM-CERT-PRIME             PIC X(10).
  3966             20  CM-CERT-SFX               PIC X.
  3967
  3968     12  CM-CONTROL-BY-NAME.
  3969         16  CM-COMPANY-CD-A1              PIC X.
  3970         16  CM-INSURED-LAST-NAME          PIC X(15).
  3971         16  CM-INSURED-INITIALS.
  3972             20  CM-INSURED-INITIAL1       PIC X.
  3973             20  CM-INSURED-INITIAL2       PIC X.
  3974
  3975     12  CM-CONTROL-BY-SSN.
  3976         16  CM-COMPANY-CD-A2              PIC X.
  3977         16  CM-SOC-SEC-NO.
  3978             20  CM-SSN-STATE              PIC XX.
  3979             20  CM-SSN-ACCOUNT            PIC X(6).
  3980             20  CM-SSN-LN3.
  3981                 25  CM-INSURED-INITIALS-A2.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  73
* EL131.cbl
  3982                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3983                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3984                 25 CM-PART-LAST-NAME-A2         PIC X.
  3985
  3986     12  CM-CONTROL-BY-CERT-NO.
  3987         16  CM-COMPANY-CD-A4              PIC X.
  3988         16  CM-CERT-NO-A4                 PIC X(11).
  3989
  3990     12  CM-CONTROL-BY-MEMB.
  3991         16  CM-COMPANY-CD-A5              PIC X.
  3992         16  CM-MEMBER-NO.
  3993             20  CM-MEMB-STATE             PIC XX.
  3994             20  CM-MEMB-ACCOUNT           PIC X(6).
  3995             20  CM-MEMB-LN4.
  3996                 25  CM-INSURED-INITIALS-A5.
  3997                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3998                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3999                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4000
  4001     12  CM-INSURED-PROFILE-DATA.
  4002         16  CM-INSURED-FIRST-NAME.
  4003             20  CM-INSURED-1ST-INIT       PIC X.
  4004             20  FILLER                    PIC X(9).
  4005         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4006         16  CM-INSURED-SEX                PIC X.
  4007             88  CM-SEX-MALE                  VALUE 'M'.
  4008             88  CM-SEX-FEMAL                 VALUE 'F'.
  4009         16  CM-INSURED-JOINT-AGE          PIC 99.
  4010         16  CM-JOINT-INSURED-NAME.
  4011             20  CM-JT-LAST-NAME           PIC X(15).
  4012             20  CM-JT-FIRST-NAME.
  4013                 24  CM-JT-1ST-INIT        PIC X.
  4014                 24  FILLER                PIC X(9).
  4015             20  CM-JT-INITIAL             PIC X.
  4016
  4017     12  CM-LIFE-DATA.
  4018         16  CM-LF-BENEFIT-CD              PIC XX.
  4019         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4020         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4021         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4022         16  CM-LF-DEV-CODE                PIC XXX.
  4023         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4024         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4025         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4026         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4027         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4028         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4029         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4030         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4031         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4032         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4033         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4034         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4035         16  cm-temp-epiq                  pic xx.
  4036             88  EPIQ-CLASS                  value 'EQ'.
  4037*        16  FILLER                        PIC XX.
  4038
  4039     12  CM-AH-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  74
* EL131.cbl
  4040         16  CM-AH-BENEFIT-CD              PIC XX.
  4041         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4042         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4043         16  CM-AH-DEV-CODE                PIC XXX.
  4044         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4045         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4046         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4047         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4048         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4049         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4050         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4051         16  CM-AH-PAID-THRU-DT            PIC XX.
  4052             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4053         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4054         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4055         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4056         16  FILLER                        PIC X.
  4057
  4058     12  CM-LOAN-INFORMATION.
  4059         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4060         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4061                                           PIC S9(5)V99  COMP-3.
  4062         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4063         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4064         16  CM-PAY-FREQUENCY              PIC S99.
  4065         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4066         16  CM-RATE-CLASS                 PIC XX.
  4067         16  CM-BENEFICIARY                PIC X(25).
  4068         16  CM-POLICY-FORM-NO             PIC X(12).
  4069         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4070         16  CM-LAST-ADD-ON-DT             PIC XX.
  4071         16  CM-DEDUCTIBLE-AMOUNTS.
  4072             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4073             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4074         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4075             20  CM-RESIDENT-STATE         PIC XX.
  4076             20  CM-RATE-CODE              PIC X(4).
  4077             20  FILLER                    PIC XX.
  4078         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4079             20  CM-LOAN-OFFICER           PIC X(5).
  4080             20  FILLER                    PIC XXX.
  4081         16  CM-CSR-CODE                   PIC XXX.
  4082         16  CM-UNDERWRITING-CODE          PIC X.
  4083             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4084         16  CM-POST-CARD-IND              PIC X.
  4085         16  CM-REF-INTERFACE-SW           PIC X.
  4086         16  CM-PREMIUM-TYPE               PIC X.
  4087             88  CM-SING-PRM                  VALUE '1'.
  4088             88  CM-O-B-COVERAGE              VALUE '2'.
  4089             88  CM-OPEN-END                  VALUE '3'.
  4090         16  CM-IND-GRP-TYPE               PIC X.
  4091             88  CM-INDIVIDUAL                VALUE 'I'.
  4092             88  CM-GROUP                     VALUE 'G'.
  4093         16  CM-SKIP-CODE                  PIC X.
  4094             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4095             88  SKIP-JULY                    VALUE '1'.
  4096             88  SKIP-AUGUST                  VALUE '2'.
  4097             88  SKIP-SEPTEMBER               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  75
* EL131.cbl
  4098             88  SKIP-JULY-AUG                VALUE '4'.
  4099             88  SKIP-AUG-SEPT                VALUE '5'.
  4100             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4101             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4102             88  SKIP-JUNE                    VALUE '8'.
  4103             88  SKIP-JUNE-JULY               VALUE '9'.
  4104             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4105             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4106         16  CM-PAYMENT-MODE               PIC X.
  4107             88  PAY-MONTHLY                  VALUE SPACE.
  4108             88  PAY-WEEKLY                   VALUE '1'.
  4109             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4110             88  PAY-BI-WEEKLY                VALUE '3'.
  4111             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4112         16  CM-LOAN-NUMBER                PIC X(8).
  4113         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4114         16  CM-OLD-LOF                    PIC XXX.
  4115*        16  CM-LOAN-OFFICER               PIC XXX.
  4116         16  CM-REIN-TABLE                 PIC XXX.
  4117         16  CM-SPECIAL-REIN-CODE          PIC X.
  4118         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4119         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4120         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4121
  4122     12  CM-STATUS-DATA.
  4123         16  CM-ENTRY-STATUS               PIC X.
  4124         16  CM-ENTRY-DT                   PIC XX.
  4125
  4126         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4127         16  CM-LF-CANCEL-DT               PIC XX.
  4128         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4129
  4130         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4131         16  CM-LF-DEATH-DT                PIC XX.
  4132         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4133
  4134         16  CM-LF-CURRENT-STATUS          PIC X.
  4135             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4136                                                'M' '4' '5' '9'.
  4137             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4138             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4139             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4140             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4141             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4142             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4143             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4144             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4145             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4146             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4147             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4148             88  CM-LF-DECLINED               VALUE 'D'.
  4149             88  CM-LF-VOIDED                 VALUE 'V'.
  4150
  4151         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4152         16  CM-AH-CANCEL-DT               PIC XX.
  4153         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4154
  4155         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  76
* EL131.cbl
  4156         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4157         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4158
  4159         16  CM-AH-CURRENT-STATUS          PIC X.
  4160             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4161                                                'M' '4' '5' '9'.
  4162             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4163             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4164             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4165             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4166             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4167             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4168             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4169             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4170             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4171             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4172             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4173             88  CM-AH-DECLINED               VALUE 'D'.
  4174             88  CM-AH-VOIDED                 VALUE 'V'.
  4175
  4176         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4177             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4178             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4179             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4180         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4181
  4182         16  CM-ENTRY-BATCH                PIC X(6).
  4183         16  CM-LF-EXIT-BATCH              PIC X(6).
  4184         16  CM-AH-EXIT-BATCH              PIC X(6).
  4185         16  CM-LAST-MONTH-END             PIC XX.
  4186
  4187     12  CM-NOTE-SW                        PIC X.
  4188         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4189         88  CERT-NOTES-PRESENT               VALUE '1'.
  4190         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4191         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4192         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4193         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4194         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4195         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4196     12  CM-COMP-EXCP-SW                   PIC X.
  4197         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4198         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4199     12  CM-INSURED-ADDRESS-SW             PIC X.
  4200         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4201         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4202
  4203*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4204     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4205     12  FILLER                            PIC X.
  4206
  4207*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4208     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4209     12  FILLER                            PIC X.
  4210*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4211     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4212
  4213     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  77
* EL131.cbl
  4214         88  CERT-ADDED-BATCH                 VALUE ' '.
  4215         88  CERT-ADDED-ONLINE                VALUE '1'.
  4216         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4217         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4218         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4219     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4220         88  CERT-AS-LOADED                   VALUE ' '.
  4221         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4222         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4223         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4224         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4225         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4226         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4227         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4228
  4229     12  CM-ACCOUNT-COMM-PCTS.
  4230         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4231         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4232
  4233     12  CM-USER-FIELD                     PIC X.
  4234     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4235     12  CM-CLP-STATE                      PIC XX.
  4236     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4237     12  CM-USER-RESERVED                  PIC XXX.
  4238     12  FILLER REDEFINES CM-USER-RESERVED.
  4239         16  CM-AH-CLASS-CD                PIC XX.
  4240         16  F                             PIC X.
  4241******************************************************************
  4242
  4243*                                COPY ELCTRLR.
  4244******************************************************************
  4245*                                                                *
  4246*                            ELCTRLR.                            *
  4247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4248*                            VMOD=2.014                          *
  4249*                                                                *
  4250*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4251*                                                                *
  4252*   FILE TYPE = VSAM,KSDS                                        *
  4253*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4254*                                                                *
  4255*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4256*       ALTERNATE INDEX = NONE                                   *
  4257*                                                                *
  4258*   LOG = YES                                                    *
  4259*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4260******************************************************************
  4261*                   C H A N G E   L O G
  4262*
  4263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4264*-----------------------------------------------------------------
  4265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4266* EFFECTIVE    NUMBER
  4267*-----------------------------------------------------------------
  4268* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4269* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4270* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4271* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  78
* EL131.cbl
  4272* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4273* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4274* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4275* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4276* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4277* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4278* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4279* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4280* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4281* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4282* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4283* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4284* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4285* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4286* 040814    2014030500002  AJRA  ADD ICD CODES
  4287* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4288* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4289* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4290* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4291******************************************************************
  4292 01  ACTIVITY-TRAILERS.
  4293     12  AT-RECORD-ID                    PIC XX.
  4294         88  VALID-AT-ID                       VALUE 'AT'.
  4295
  4296     12  AT-CONTROL-PRIMARY.
  4297         16  AT-COMPANY-CD               PIC X.
  4298         16  AT-CARRIER                  PIC X.
  4299         16  AT-CLAIM-NO                 PIC X(7).
  4300         16  AT-CERT-NO.
  4301             20  AT-CERT-PRIME           PIC X(10).
  4302             20  AT-CERT-SFX             PIC X.
  4303         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4304             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4305             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4306             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4307             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4308             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4309             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4310             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4311             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4312             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4313             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4314             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4315             88  AT-BENEFICIARY-TRL           VALUE +91.
  4316             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4317             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4318             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4319             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4320
  4321     12  AT-TRAILER-TYPE                 PIC X.
  4322         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4323         88  PAYMENT-TR                       VALUE '2'.
  4324         88  AUTO-PAY-TR                      VALUE '3'.
  4325         88  CORRESPONDENCE-TR                VALUE '4'.
  4326         88  ADDRESS-TR                       VALUE '5'.
  4327         88  GENERAL-INFO-TR                  VALUE '6'.
  4328         88  AUTO-PROMPT-TR                   VALUE '7'.
  4329         88  DENIAL-TR                        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  79
* EL131.cbl
  4330         88  INCURRED-CHG-TR                  VALUE '9'.
  4331         88  FORM-CONTROL-TR                  VALUE 'A'.
  4332
  4333     12  AT-RECORDED-DT                  PIC XX.
  4334     12  AT-RECORDED-BY                  PIC X(4).
  4335     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4336
  4337     12  AT-TRAILER-BODY                 PIC X(165).
  4338
  4339     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4340         16  AT-RESERVE-CONTROLS.
  4341             20  AT-MANUAL-SW            PIC X.
  4342                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4343             20  AT-FUTURE-SW            PIC X.
  4344                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4345             20  AT-PTC-SW               PIC X.
  4346                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4347             20  AT-IBNR-SW              PIC X.
  4348                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4349             20  AT-PTC-LF-SW            PIC X.
  4350                 88  AT-LF-PTC-USED          VALUE '1'.
  4351             20  AT-CDT-ACCESS-METHOD    PIC X.
  4352                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4353                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4354                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4355             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4356         16  AT-LAST-COMPUTED-DT         PIC XX.
  4357         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4358         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4359         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4360         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4361         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4362         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4363         16  AT-EXPENSE-CONTROLS.
  4364             20  AT-EXPENSE-METHOD       PIC X.
  4365                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4366                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4367                 88  PERCENT-OF-PMT           VALUE '3'.
  4368                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4369             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4370             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4371         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4372         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4373
  4374         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4375         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4376
  4377*        16  FILLER                      PIC X(53).
  4378         16  FILLER                      PIC X(47).
  4379
  4380         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4381         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4382
  4383         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4384             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4385             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4386*                    C = CLOSED
  4387*                    O = OPEN
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  80
* EL131.cbl
  4388             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4389*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4390
  4391     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4392         16  AT-PAYMENT-TYPE             PIC X.
  4393             88  PARTIAL-PAYMENT                VALUE '1'.
  4394             88  FINAL-PAYMENT                  VALUE '2'.
  4395             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4396             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4397             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4398             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4399             88  VOIDED-PAYMENT                 VALUE '9'.
  4400             88  TRANSFER                       VALUE 'T'.
  4401             88  LIFE-INTEREST                  VALUE 'I'.
  4402
  4403         16  AT-CLAIM-TYPE               PIC X.
  4404             88  PAID-FOR-AH                    VALUE 'A'.
  4405             88  PAID-FOR-LIFE                  VALUE 'L'.
  4406             88  PAID-FOR-IUI                   VALUE 'I'.
  4407             88  PAID-FOR-GAP                   VALUE 'G'.
  4408             88  PAID-FOR-FAM                   VALUE 'F'.
  4409             88  PAID-FOR-OTH                   VALUE 'O'.
  4410         16  AT-CLAIM-PREM-TYPE          PIC X.
  4411             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4412             88  AT-O-B-COVERAGE                VALUE '2'.
  4413             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4414         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4415         16  AT-CHECK-NO                 PIC X(7).
  4416         16  AT-PAID-FROM-DT             PIC XX.
  4417         16  AT-PAID-THRU-DT             PIC XX.
  4418         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4419         16  AT-ACH-PAYMENT              PIC X.
  4420*        16  FILLER                      PIC X.
  4421         16  AT-PAYEES-NAME              PIC X(30).
  4422         16  AT-PAYMENT-ORIGIN           PIC X.
  4423             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4424             88  ONLINE-AUTO-PMT                VALUE '2'.
  4425             88  OFFLINE-PMT                    VALUE '3'.
  4426         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4427         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4428         16  AT-VOID-DATA.
  4429             20  AT-VOID-DT              PIC XX.
  4430*00144       20  AT-VOID-REASON          PIC X(30).
  4431             20  AT-VOID-REASON          PIC X(26).
  4432         16  AT-PMT-APPROVED-BY          PIC X(04).
  4433         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4434         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4435         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4436                                         PIC S99V9(5)  COMP-3.
  4437         16  AT-CREDIT-INTERFACE.
  4438             20  AT-PMT-SELECT-DT        PIC XX.
  4439                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4440             20  AT-PMT-ACCEPT-DT        PIC XX.
  4441                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4442             20  AT-VOID-SELECT-DT       PIC XX.
  4443                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4444             20  AT-VOID-ACCEPT-DT       PIC XX.
  4445                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  81
* EL131.cbl
  4446
  4447         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4448                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4449                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4450         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4451
  4452         16  AT-FORCE-CONTROL            PIC X.
  4453             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4454         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4455         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4456         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4457         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4458         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4459         16  AT-BENEFIT-TYPE             PIC X.
  4460
  4461         16  AT-EXPENSE-TYPE             PIC X.
  4462         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4463
  4464         16  AT-PAYEE-TYPE-CD.
  4465             20  AT-PAYEE-TYPE           PIC X.
  4466                 88  INSURED-PAID           VALUE 'I'.
  4467                 88  BENEFICIARY-PAID       VALUE 'B'.
  4468                 88  ACCOUNT-PAID           VALUE 'A'.
  4469                 88  OTHER-1-PAID           VALUE 'O'.
  4470                 88  OTHER-2-PAID           VALUE 'Q'.
  4471                 88  DOCTOR-PAID            VALUE 'P'.
  4472                 88  EMPLOYER-PAID          VALUE 'E'.
  4473             20  AT-PAYEE-SEQ            PIC X.
  4474
  4475         16  AT-CASH-PAYMENT             PIC X.
  4476         16  AT-GROUPED-PAYMENT          PIC X.
  4477         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4478         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4479         16  AT-APPROVED-LEVEL           PIC X.
  4480         16  AT-VOID-TYPE                PIC X.
  4481             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4482             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4483         16  AT-AIG-UNEMP-IND            PIC X.
  4484             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4485         16  AT-ASSOCIATES               PIC X.
  4486             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4487             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4488
  4489         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4490         16  AT-CV-PMT-CODE              PIC X.
  4491             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4492             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4493             88  FULL-ADD-PAYMENT           VALUE '3'.
  4494             88  HALF-ADD-PAYMENT           VALUE '4'.
  4495             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4496             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4497             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4498             88  ADDL-PAYMENT               VALUE '8'.
  4499
  4500         16  AT-EOB-CODE1                PIC XXX.
  4501         16  AT-EOB-CODE2                PIC XXX.
  4502         16  AT-EOB-CODE3                PIC XXX.
  4503         16  FILLER REDEFINES AT-EOB-CODE3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  82
* EL131.cbl
  4504             20  AT-PRINT-CLM-FORM       PIC X.
  4505             20  AT-PRINT-SURVEY         PIC X.
  4506             20  AT-SPECIAL-RELEASE      PIC X.
  4507         16  AT-EOB-CODE4                PIC XXX.
  4508         16  FILLER REDEFINES AT-EOB-CODE4.
  4509             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4510             20  FILLER                  PIC X.
  4511         16  AT-EOB-CODE5                PIC XXX.
  4512         16  FILLER REDEFINES AT-EOB-CODE5.
  4513             20  AT-PMT-PROOF-DT         PIC XX.
  4514             20  FILLER                  PIC X.
  4515
  4516         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4517             88  AT-PRINT-EOB            VALUE 'Y'.
  4518
  4519         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4520         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4521
  4522     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4523         16  AT-SCHEDULE-START-DT        PIC XX.
  4524         16  AT-SCHEDULE-END-DT          PIC XX.
  4525         16  AT-TERMINATED-DT            PIC XX.
  4526         16  AT-LAST-PMT-TYPE            PIC X.
  4527             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4528             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4529         16  AT-FIRST-PMT-DATA.
  4530             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4531             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4532             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4533         16  AT-REGULAR-PMT-DATA.
  4534             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4535             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4536             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4537         16  AT-AUTO-PAYEE-CD.
  4538             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4539                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4540                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4541                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4542                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4543                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4544             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4545         16  AT-AUTO-PAY-DAY             PIC 99.
  4546         16  AT-AUTO-CASH                PIC X.
  4547             88  AT-CASH                      VALUE 'Y'.
  4548             88  AT-NON-CASH                  VALUE 'N'.
  4549*        16  FILLER                      PIC X(129).
  4550         16  AT-AUTO-END-LETTER          PIC X(4).
  4551         16  FILLER                      PIC X(125).
  4552
  4553         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4554         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4555
  4556     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4557         16  AT-LETTER-SENT-DT           PIC XX.
  4558         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4559         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4560         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4561         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  83
* EL131.cbl
  4562         16  AT-LETTER-ORIGIN            PIC X.
  4563             88  ONLINE-CREATION              VALUE '1' '3'.
  4564             88  OFFLINE-CREATION             VALUE '2' '4'.
  4565             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4566             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4567         16  AT-STD-LETTER-FORM          PIC X(4).
  4568         16  AT-REASON-TEXT              PIC X(70).
  4569         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4570         16  AT-ADDRESEE-TYPE            PIC X.
  4571              88  INSURED-ADDRESEE            VALUE 'I'.
  4572              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4573              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4574              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4575              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4576              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4577              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4578         16  AT-ADDRESSEE-NAME           PIC X(30).
  4579         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4580         16  AT-RESEND-PRINT-DATE        PIC XX.
  4581         16  AT-CORR-SOL-UNSOL           PIC X.
  4582         16  AT-LETTER-PURGED-DT         PIC XX.
  4583*
  4584*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4585*
  4586         16  AT-CSO-REDEFINITION.
  4587             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4588             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4589             20  AT-LETTER-TO-BENE       PIC X(1).
  4590             20  AT-STOP-LETTER-DT       PIC X(2).
  4591             20  AT-AUTH-RCVD            PIC X(1).
  4592             20  FILLER                  PIC X(18).
  4593*             20  FILLER                  PIC X(27).
  4594             20  AT-CSO-LETTER-STATUS    PIC X.
  4595                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4596                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4597                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4598             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4599             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4600*
  4601*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4602*
  4603*        16  FILLER                      PIC X(26).
  4604*
  4605*        16  AT-DMD-BSR-CODE             PIC X.
  4606*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4607*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4608*
  4609*        16  AT-DMD-LETTER-STATUS        PIC X.
  4610*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4611*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4612*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4613*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4614*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4615
  4616         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4617         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4618
  4619     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  84
* EL131.cbl
  4620         16  AT-ADDRESS-TYPE             PIC X.
  4621             88  INSURED-ADDRESS               VALUE 'I'.
  4622             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4623             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4624             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4625             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4626             88  OTHER-ADDRESS-1               VALUE 'O'.
  4627             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4628         16  AT-MAIL-TO-NAME             PIC X(30).
  4629         16  AT-ADDRESS-LINE-1           PIC X(30).
  4630         16  AT-ADDRESS-LINE-2           PIC X(30).
  4631         16  AT-CITY-STATE.
  4632             20  AT-CITY                 PIC X(28).
  4633             20  AT-STATE                PIC XX.
  4634         16  AT-ZIP.
  4635             20  AT-ZIP-CODE.
  4636                 24  AT-ZIP-1ST          PIC X.
  4637                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4638                 24  FILLER              PIC X(4).
  4639             20  AT-ZIP-PLUS4            PIC X(4).
  4640         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4641             20  AT-CAN-POSTAL-1         PIC XXX.
  4642             20  AT-CAN-POSTAL-2         PIC XXX.
  4643             20  FILLER                  PIC XXX.
  4644         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4645*         16  FILLER                      PIC X(23).
  4646         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4647         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4648         16  FILLER                      PIC X(13).
  4649         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4650         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4651
  4652     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4653         16  AT-INFO-LINE-1              PIC X(60).
  4654         16  FILLER REDEFINES AT-INFO-LINE-1.
  4655             20  AT-NOTE-ERROR-NO OCCURS 15
  4656                                         PIC X(4).
  4657         16  AT-INFO-LINE-2              PIC X(60).
  4658         16  FILLER REDEFINES AT-INFO-LINE-2.
  4659             20  AT-ICD-CODE-1           PIC X(8).
  4660             20  AT-ICD-CODE-2           PIC X(8).
  4661             20  FILLER                  PIC X(44).
  4662         16  AT-INFO-TRAILER-TYPE        PIC X.
  4663             88  AT-ERRORS-NOTE          VALUE 'E'.
  4664             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4665             88  AT-CALL-NOTE            VALUE 'C'.
  4666             88  AT-MAINT-NOTE           VALUE 'M'.
  4667             88  AT-CERT-CHANGE          VALUE 'X'.
  4668             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4669             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4670             88  AT-CERT-CANCELLED       VALUE 'T'.
  4671         16  AT-CALL-TYPE                PIC X.
  4672             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4673             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4674         16  AT-NOTE-CONTINUATION        PIC X.
  4675             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4676         16  AT-EOB-CODES-EXIST          PIC X.
  4677             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  85
* EL131.cbl
  4678         16  FILLER                      PIC X(35).
  4679         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4680         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4681
  4682     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4683         16  AT-PROMPT-LINE-1            PIC X(60).
  4684         16  AT-PROMPT-LINE-2            PIC X(60).
  4685         16  AT-PROMPT-START-DT          PIC XX.
  4686         16  AT-PROMPT-END-DT            PIC XX.
  4687         16  FILLER                      PIC X(35).
  4688         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4689         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4690
  4691     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4692         16  AT-DENIAL-INFO-1            PIC X(60).
  4693         16  AT-DENIAL-INFO-2            PIC X(60).
  4694         16  AT-DENIAL-DT                PIC XX.
  4695         16  AT-RETRACTION-DT            PIC XX.
  4696         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4697*         16  FILLER                      PIC X(31).
  4698         16  AT-DENIAL-PROOF-DT          PIC XX.
  4699         16  FILLER                      PIC X(29).
  4700         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4701         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4702
  4703     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4704         16  AT-OLD-INCURRED-DT          PIC XX.
  4705         16  AT-OLD-REPORTED-DT          PIC XX.
  4706         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4707         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4708         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4709         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4710         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4711         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4712         16  FILLER                      PIC X(26).
  4713         16  AT-OLD-DIAG-CODE            PIC X(6).
  4714         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4715         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4716         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4717         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4718         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4719         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4720         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4721         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4722         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4723         16  FILLER                      PIC X(9).
  4724         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4725
  4726     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4727         16  AT-FORM-SEND-ON-DT          PIC XX.
  4728         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4729         16  AT-FORM-RE-SEND-DT          PIC XX.
  4730         16  AT-FORM-ANSWERED-DT         PIC XX.
  4731         16  AT-FORM-PRINTED-DT          PIC XX.
  4732         16  AT-FORM-REPRINT-DT          PIC XX.
  4733         16  AT-FORM-TYPE                PIC X.
  4734             88  INITIAL-FORM                  VALUE '1'.
  4735             88  PROGRESS-FORM                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  86
* EL131.cbl
  4736         16  AT-INSTRUCT-LN-1            PIC X(28).
  4737         16  AT-INSTRUCT-LN-2            PIC X(28).
  4738         16  AT-INSTRUCT-LN-3            PIC X(28).
  4739         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4740         16  AT-FORM-ADDRESS             PIC X.
  4741             88  FORM-TO-INSURED              VALUE 'I'.
  4742             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4743             88  FORM-TO-OTHER-1              VALUE 'O'.
  4744             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4745         16  AT-RELATED-1.
  4746             20 AT-REL-CARR-1            PIC X.
  4747             20 AT-REL-CLAIM-1           PIC X(7).
  4748             20 AT-REL-CERT-1            PIC X(11).
  4749         16  AT-RELATED-2.
  4750             20 AT-REL-CARR-2            PIC X.
  4751             20 AT-REL-CLAIM-2           PIC X(7).
  4752             20 AT-REL-CERT-2            PIC X(11).
  4753         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4754         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4755         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4756         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4757         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4758         16  AT-STOP-FORM-DT             PIC X(2).
  4759
  4760         16  FILLER                      PIC X(09).
  4761         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4762         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4763******************************************************************
  4764
  4765*                                COPY ELCCNTL.
  4766******************************************************************
  4767*                                                                *
  4768*                                                                *
  4769*                            ELCCNTL.                            *
  4770*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4771*                            VMOD=2.059                          *
  4772*                                                                *
  4773*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4774*                                                                *
  4775*   FILE TYPE = VSAM,KSDS                                        *
  4776*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4777*                                                                *
  4778*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4779*       ALTERNATE INDEX = NONE                                   *
  4780*                                                                *
  4781*   LOG = YES                                                    *
  4782*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4783******************************************************************
  4784*                   C H A N G E   L O G
  4785*
  4786* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4787*-----------------------------------------------------------------
  4788*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4789* EFFECTIVE    NUMBER
  4790*-----------------------------------------------------------------
  4791* 082503                   PEMA  ADD BENEFIT GROUP
  4792* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4793* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  87
* EL131.cbl
  4794* 092705    2005050300006  PEMA  ADD SPP LEASES
  4795* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4796* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4797* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4798* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4799* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4800* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4801* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4802* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4803* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4804* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4805* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4806******************************************************************
  4807*
  4808 01  CONTROL-FILE.
  4809     12  CF-RECORD-ID                       PIC XX.
  4810         88  VALID-CF-ID                        VALUE 'CF'.
  4811
  4812     12  CF-CONTROL-PRIMARY.
  4813         16  CF-COMPANY-ID                  PIC XXX.
  4814         16  CF-RECORD-TYPE                 PIC X.
  4815             88  CF-COMPANY-MASTER              VALUE '1'.
  4816             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4817             88  CF-STATE-MASTER                VALUE '3'.
  4818             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4819             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4820             88  CF-CARRIER-MASTER              VALUE '6'.
  4821             88  CF-MORTALITY-MASTER            VALUE '7'.
  4822             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4823             88  CF-TERMINAL-MASTER             VALUE '9'.
  4824             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4825             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4826             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4827             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4828             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4829             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4830             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4831             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4832             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4833         16  CF-ACCESS-CD-GENL              PIC X(4).
  4834         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4835             20  CF-PROCESSOR               PIC X(4).
  4836         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4837             20  CF-STATE-CODE              PIC XX.
  4838             20  FILLER                     PIC XX.
  4839         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4840             20  FILLER                     PIC XX.
  4841             20  CF-HI-BEN-IN-REC           PIC XX.
  4842         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4843             20  FILLER                     PIC XXX.
  4844             20  CF-CARRIER-CNTL            PIC X.
  4845         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4846             20  FILLER                     PIC XX.
  4847             20  CF-HI-TYPE-IN-REC          PIC 99.
  4848         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4849             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4850                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4851             20  CF-CRDB-BENEFIT-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  88
* EL131.cbl
  4852             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4853         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4854             20  FILLER                     PIC X.
  4855             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4856         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4857             20  FILLER                     PIC XX.
  4858             20  CF-MORTGAGE-PLAN           PIC XX.
  4859         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4860
  4861     12  CF-LAST-MAINT-DT                   PIC XX.
  4862     12  CF-LAST-MAINT-BY                   PIC X(4).
  4863     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4864
  4865     12  CF-RECORD-BODY                     PIC X(728).
  4866
  4867
  4868****************************************************************
  4869*             COMPANY MASTER RECORD                            *
  4870****************************************************************
  4871
  4872     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4873         16  CF-COMPANY-ADDRESS.
  4874             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4875             20  CF-CL-IN-CARE-OF           PIC X(30).
  4876             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4877             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4878             20  CF-CL-CITY-STATE           PIC X(30).
  4879             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4880             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4881         16  CF-COMPANY-CD                  PIC X.
  4882         16  CF-COMPANY-PASSWORD            PIC X(8).
  4883         16  CF-SECURITY-OPTION             PIC X.
  4884             88  ALL-SECURITY                   VALUE '1'.
  4885             88  COMPANY-VERIFY                 VALUE '2'.
  4886             88  PROCESSOR-VERIFY               VALUE '3'.
  4887             88  NO-SECURITY                    VALUE '4'.
  4888             88  ALL-BUT-TERM                   VALUE '5'.
  4889         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4890             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4891         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4892             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4893         16  CF-INFORCE-LOCATION            PIC X.
  4894             88  CERTS-ARE-ONLINE               VALUE '1'.
  4895             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4896             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4897         16  CF-LOWER-CASE-LETTERS          PIC X.
  4898         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4899             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4900             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4901             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4902             88  CF-ACCNT-CNTL                  VALUE '3'.
  4903             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4904
  4905         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4906         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4907
  4908         16  CF-LGX-CREDIT-USER             PIC X.
  4909             88  CO-IS-NOT-USER                 VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  89
* EL131.cbl
  4910             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4911
  4912         16 CF-CREDIT-CALC-CODES.
  4913             20  CF-CR-REM-TERM-CALC PIC X.
  4914               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4915               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4916               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4917               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4918               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4919               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4920               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4921             20  CF-CR-R78-METHOD           PIC X.
  4922               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4923               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4924
  4925         16  CF-CLAIM-CONTROL-COUNTS.
  4926             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4927                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4928
  4929             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4930                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4931
  4932             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4933                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4934
  4935             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4936                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4937
  4938         16  CF-CURRENT-MONTH-END           PIC XX.
  4939
  4940         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4941             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4942             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4943             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4944             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4945                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4946                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4947             20  CF-CO-PREM-REJECT-SW       PIC X.
  4948                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4949                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4950             20  CF-CO-REF-REJECT-SW        PIC X.
  4951                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4952                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4953
  4954         16  CF-CO-REPORTING-DT             PIC XX.
  4955         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4956         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4957           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4958           88  CF-CO-MONTH-END                  VALUE '1'.
  4959
  4960         16  CF-LGX-CLAIM-USER              PIC X.
  4961             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4962             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4963
  4964         16  CF-CREDIT-EDIT-CONTROLS.
  4965             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4966             20  CF-MIN-AGE                 PIC 99.
  4967             20  CF-DEFAULT-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  90
* EL131.cbl
  4968             20  CF-MIN-TERM                PIC S999      COMP-3.
  4969             20  CF-MAX-TERM                PIC S999      COMP-3.
  4970             20  CF-DEFAULT-SEX             PIC X.
  4971             20  CF-JOINT-AGE-INPUT         PIC X.
  4972                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4973             20  CF-BIRTH-DATE-INPUT        PIC X.
  4974                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4975             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4976                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4977                 88  CF-ZERO-CARRIER            VALUE '1'.
  4978                 88  CF-ZERO-GROUPING           VALUE '2'.
  4979                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4980             20  CF-EDIT-SW                 PIC X.
  4981                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4982             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4983             20  CF-CR-PR-METHOD            PIC X.
  4984               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4985               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4986             20  FILLER                     PIC X.
  4987
  4988         16  CF-CREDIT-MISC-CONTROLS.
  4989             20  CF-REIN-TABLE-SW           PIC X.
  4990                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4991             20  CF-COMP-TABLE-SW           PIC X.
  4992                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4993             20  CF-EXPERIENCE-RETENTION-AGE
  4994                                            PIC S9        COMP-3.
  4995             20  CF-CONVERSION-DT           PIC XX.
  4996             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4997             20  CF-RUN-FREQUENCY-SW        PIC X.
  4998                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4999                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5000
  5001             20  CF-CR-CHECK-NO-CONTROL.
  5002                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5003                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5004                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5005                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5006                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5007                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5008
  5009                 24  CF-CR-CHECK-COUNT       REDEFINES
  5010                     CF-CR-CHECK-COUNTER      PIC X(4).
  5011
  5012                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5013                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5014
  5015                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5016                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5017                 24  CF-MAIL-PROCESSING       PIC X.
  5018                     88  MAIL-PROCESSING          VALUE 'Y'.
  5019
  5020         16  CF-MISC-SYSTEM-CONTROL.
  5021             20  CF-SYSTEM-C                 PIC X.
  5022                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5023             20  CF-SYSTEM-D                 PIC X.
  5024                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5025             20  CF-SOC-SEC-NO-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  91
* EL131.cbl
  5026                 88  SOC-SEC-NO-USED             VALUE '1'.
  5027             20  CF-MEMBER-NO-SW             PIC X.
  5028                 88  MEMBER-NO-USED              VALUE '1'.
  5029             20  CF-TAX-ID-NUMBER            PIC X(11).
  5030             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5031             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5032                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5033                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5034                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5035                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5036             20  CF-SYSTEM-E                 PIC X.
  5037                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5038
  5039         16  CF-LGX-LIFE-USER               PIC X.
  5040             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5041             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5042
  5043         16  CF-CR-MONTH-END-DT             PIC XX.
  5044
  5045         16  CF-FILE-MAINT-DATES.
  5046             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5047                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5048             20  CF-LAST-BATCH       REDEFINES
  5049                 CF-LAST-BATCH-NO               PIC X(4).
  5050             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5051             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5052             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5053             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5054             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5055             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5056             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5057             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5058             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5059             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5060
  5061         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5062         16  FILLER                         PIC X.
  5063
  5064         16  CF-ALT-MORT-CODE               PIC X(4).
  5065         16  CF-MEMBER-CAPTION              PIC X(10).
  5066
  5067         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5068             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5069             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5070             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5071             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5072             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5073
  5074         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5075
  5076         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5077         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5078         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5079         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5080
  5081         16  CF-AH-OVERRIDE-L1              PIC X.
  5082         16  CF-AH-OVERRIDE-L2              PIC XX.
  5083         16  CF-AH-OVERRIDE-L6              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  92
* EL131.cbl
  5084         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5085
  5086         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5087         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5088
  5089         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5090         16  CF-AR-LAST-EL860-DT            PIC XX.
  5091         16  CF-MP-MONTH-END-DT             PIC XX.
  5092
  5093         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5094         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5095             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5096
  5097         16  CF-AR-MONTH-END-DT             PIC XX.
  5098
  5099         16  CF-CRDTCRD-USER                PIC X.
  5100             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5101             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5102
  5103         16  CF-CC-MONTH-END-DT             PIC XX.
  5104
  5105         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5106
  5107         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5108             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5109             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5110             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5111         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5112         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5113         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5114         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5115             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5116             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5117         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5118         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5119         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5120             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5121         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5122
  5123         16  CF-CL-ZIP-CODE.
  5124             20  CF-CL-ZIP-PRIME.
  5125                 24  CF-CL-ZIP-1ST          PIC X.
  5126                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5127                 24  FILLER                 PIC X(4).
  5128             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5129         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5130             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5131             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5132             20  FILLER                     PIC XXX.
  5133
  5134         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5135         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5136         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5137         16  CF-CO-OPTION-START-DATE        PIC XX.
  5138         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5139           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5140                                                      '3' '4'.
  5141           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  93
* EL131.cbl
  5142           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5143           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5144           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5145           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5146           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5147
  5148         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5149
  5150         16  CF-PAYMENT-APPROVAL-LEVELS.
  5151             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5152             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5153             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5154             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5155             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5156             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5157
  5158         16  CF-END-USER-REPORTING-USER     PIC X.
  5159             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5160             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5161
  5162         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5163             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5164             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5165
  5166         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5167
  5168         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5169         16  FILLER                         PIC X.
  5170
  5171         16  CF-CREDIT-ARCHIVE-CNTL.
  5172             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5173             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5174             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5175
  5176         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5177
  5178         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5179             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5180             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5181
  5182         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5183             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5184             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5185
  5186         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5187
  5188         16  CF-CO-ACH-ID-CODE              PIC  X.
  5189             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5190             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5191             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5192         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5193         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5194         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5195         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5196         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5197         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5198         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5199         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  94
* EL131.cbl
  5200         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5201                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5202         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5203                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5204
  5205         16  CF-CO-OVER-SHORT.
  5206             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5207             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5208
  5209*         16  FILLER                         PIC X(102).
  5210         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5211             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5212             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5213
  5214         16  CF-AH-APPROVAL-DAYS.
  5215             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5216             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5217             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5218             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5219
  5220         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5221
  5222         16  CF-APPROV-LEV-5.
  5223             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5224             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5225             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5226
  5227         16  FILLER                         PIC X(68).
  5228****************************************************************
  5229*             PROCESSOR/USER RECORD                            *
  5230****************************************************************
  5231
  5232     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5233         16  CF-PROCESSOR-NAME              PIC X(30).
  5234         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5235         16  CF-PROCESSOR-TITLE             PIC X(26).
  5236         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5237                 88  MESSAGE-YES                VALUE 'Y'.
  5238                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5239
  5240*****************************************************
  5241****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5242****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5243****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5244****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5245*****************************************************
  5246
  5247         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5248             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5249             20  CF-APPLICATION-FORCE       PIC X.
  5250             20  CF-INDIVIDUAL-APP.
  5251                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5252                     28  CF-BROWSE-APP      PIC X.
  5253                     28  CF-UPDATE-APP      PIC X.
  5254
  5255         16  CF-CURRENT-TERM-ON             PIC X(4).
  5256         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5257             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  95
* EL131.cbl
  5258             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5259             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5260             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5261             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5262             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5263             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5264         16  CF-PROCESSOR-CARRIER           PIC X.
  5265             88  NO-CARRIER-SECURITY            VALUE ' '.
  5266         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5267             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5268         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5269             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5270         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5271             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5272
  5273         16  CF-PROC-SYS-ACCESS-SW.
  5274             20  CF-PROC-CREDIT-CLAIMS-SW.
  5275                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5276                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5277                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5278                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5279             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5280                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5281                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5282             20  CF-PROC-LIFE-GNRLDGR-SW.
  5283                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5284                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5285                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5286                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5287             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5288                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5289                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5290         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5291             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5292             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5293         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5294
  5295         16  CF-APPROVAL-LEVEL                  PIC X.
  5296             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5297             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5298             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5299             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5300             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5301
  5302         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5303
  5304         16  CF-LANGUAGE-TYPE                   PIC X.
  5305             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5306             88  CF-LANG-IS-FR                      VALUE 'F'.
  5307
  5308         16  CF-CSR-IND                         PIC X.
  5309         16  FILLER                             PIC X(239).
  5310
  5311****************************************************************
  5312*             PROCESSOR/REMINDERS RECORD                       *
  5313****************************************************************
  5314
  5315     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  96
* EL131.cbl
  5316         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5317             20  CF-START-REMIND-DT         PIC XX.
  5318             20  CF-END-REMIND-DT           PIC XX.
  5319             20  CF-REMINDER-TEXT           PIC X(50).
  5320         16  FILLER                         PIC X(296).
  5321
  5322
  5323****************************************************************
  5324*             STATE MASTER RECORD                              *
  5325****************************************************************
  5326
  5327     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5328         16  CF-STATE-ABBREVIATION          PIC XX.
  5329         16  CF-STATE-NAME                  PIC X(25).
  5330         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5331         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5332             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5333             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5334             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5335             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5336                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5337                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5338             20  CF-ST-PREM-REJECT-SW       PIC X.
  5339                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5340                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5341             20  CF-ST-REF-REJECT-SW        PIC X.
  5342                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5343                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5344         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5345         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5346         16  CF-ST-REFUND-RULES.
  5347             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5348             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5349             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5350         16  CF-ST-FST-PMT-EXTENSION.
  5351             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5352             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5353                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5354                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5355                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5356                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5357         16  CF-ST-STATE-CALL.
  5358             20  CF-ST-CALL-UNEARNED        PIC X.
  5359             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5360             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5361         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5362             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5363             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5364         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5365         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5366         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5367         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5368         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5369         16  FILLER                         PIC X.
  5370         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5371             20  CF-ST-BENEFIT-CD           PIC XX.
  5372             20  CF-ST-BENEFIT-KIND         PIC X.
  5373                 88  CF-ST-LIFE-KIND            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  97
* EL131.cbl
  5374                 88  CF-ST-AH-KIND              VALUE 'A'.
  5375             20  CF-ST-REM-TERM-CALC        PIC X.
  5376                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5377                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5378                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5379                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5380                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5381                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5382                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5383                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5384
  5385             20  CF-ST-REFUND-CALC          PIC X.
  5386                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5387                 88  ST-REFD-BY-R78             VALUE '1'.
  5388                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5389                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5390                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5391                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5392                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5393                 88  ST-REFD-UTAH               VALUE '7'.
  5394                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5395                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5396                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5397
  5398             20  CF-ST-EARNING-CALC         PIC X.
  5399                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5400                 88  ST-EARN-BY-R78             VALUE '1'.
  5401                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5402                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5403                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5404                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5405                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5406                 88  ST-EARN-MEAN               VALUE '8'.
  5407                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5408
  5409             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5410                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5411                 88  ST-OVRD-BY-R78             VALUE '1'.
  5412                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5413                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5414                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5415                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5416                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5417                 88  ST-OVRD-MEAN               VALUE '8'.
  5418                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5419             20  cf-st-extra-periods        pic 9.
  5420*            20  FILLER                     PIC X.
  5421
  5422         16  CF-ST-COMMISSION-CAPS.
  5423             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5424             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5425             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5426             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5427         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5428                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5429                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5430                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5431
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  98
* EL131.cbl
  5432         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5433
  5434         16  CF-ST-STATUTORY-INTEREST.
  5435             20  CF-ST-STAT-DATE-FROM       PIC X.
  5436                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5437                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5438             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5439             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5440             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5441             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5442             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5443
  5444         16  CF-ST-OVER-SHORT.
  5445             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5446             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5447
  5448         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5449
  5450         16  CF-ST-RT-CALC                  PIC X.
  5451
  5452         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5453         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5454         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5455         16  CF-ST-RF-LR-CALC               PIC X.
  5456         16  CF-ST-RF-LL-CALC               PIC X.
  5457         16  CF-ST-RF-LN-CALC               PIC X.
  5458         16  CF-ST-RF-AH-CALC               PIC X.
  5459         16  CF-ST-RF-CP-CALC               PIC X.
  5460*        16  FILLER                         PIC X(206).
  5461*CIDMOD         16  FILLER                         PIC X(192).
  5462         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5463             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5464         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5465         16  CF-ST-VFY-2ND-BENE             PIC X.
  5466         16  CF-ST-CAUSAL-STATE             PIC X.
  5467         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5468         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5469         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5470             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5471         16  CF-ST-NET-ONLY-STATE           PIC X.
  5472             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5473         16  cf-commission-cap-required     pic x.
  5474         16  CF-ST-GA-COMMISSION-CAPS.
  5475             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5476             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5477             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5478             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5479         16  CF-ST-TOT-COMMISSION-CAPS.
  5480             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5481             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5482             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5483             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5484         16  FILLER                         PIC X(156).
  5485
  5486****************************************************************
  5487*             BENEFIT MASTER RECORD                            *
  5488****************************************************************
  5489
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page  99
* EL131.cbl
  5490     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5491         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5492             20  CF-BENEFIT-CODE            PIC XX.
  5493             20  CF-BENEFIT-NUMERIC  REDEFINES
  5494                 CF-BENEFIT-CODE            PIC XX.
  5495             20  CF-BENEFIT-ALPHA           PIC XXX.
  5496             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5497             20  CF-BENEFIT-COMMENT         PIC X(10).
  5498
  5499             20  CF-LF-COVERAGE-TYPE        PIC X.
  5500                 88  CF-REDUCING                VALUE 'R'.
  5501                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5502
  5503             20  CF-SPECIAL-CALC-CD         PIC X.
  5504                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5505                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5506                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5507                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5508                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5509                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5510                 88  CF-FARM-PLAN               VALUE 'F'.
  5511                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5512                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5513                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5514                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5515                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5516                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5517                 88  CF-PRUDENTIAL              VALUE 'P'.
  5518                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5519                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5520                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5521                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5522                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5523                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5524
  5525             20  CF-JOINT-INDICATOR         PIC X.
  5526                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5527
  5528*            20  FILLER                     PIC X(12).
  5529             20  cf-maximum-benefits        pic s999 comp-3.
  5530             20  FILLER                     PIC X(09).
  5531             20  CF-BENEFIT-CATEGORY        PIC X.
  5532             20  CF-LOAN-TYPE               PIC X(8).
  5533
  5534             20  CF-CO-REM-TERM-CALC        PIC X.
  5535                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5536                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5537                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5538                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5539                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5540
  5541             20  CF-CO-EARNINGS-CALC        PIC X.
  5542                 88  CO-EARN-BY-R78             VALUE '1'.
  5543                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5544                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5545                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5546                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5547                 88  CO-EARN-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 100
* EL131.cbl
  5548                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5549                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5550
  5551             20  CF-CO-REFUND-CALC          PIC X.
  5552                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5553                 88  CO-REFD-BY-R78             VALUE '1'.
  5554                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5555                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5556                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5557                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5558                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5559                 88  CO-REFD-MEAN               VALUE '8'.
  5560                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5561                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5562                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5563
  5564             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5565                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5566                 88  CO-OVRD-BY-R78             VALUE '1'.
  5567                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5568                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5569                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5570                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5571                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5572                 88  CO-OVRD-MEAN               VALUE '8'.
  5573                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5574
  5575             20  CF-CO-BEN-I-G-CD           PIC X.
  5576                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5577                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5578                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5579
  5580         16  FILLER                         PIC X(304).
  5581
  5582
  5583****************************************************************
  5584*             CARRIER MASTER RECORD                            *
  5585****************************************************************
  5586
  5587     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5588         16  CF-ADDRESS-DATA.
  5589             20  CF-MAIL-TO-NAME            PIC X(30).
  5590             20  CF-IN-CARE-OF              PIC X(30).
  5591             20  CF-ADDRESS-LINE-1          PIC X(30).
  5592             20  CF-ADDRESS-LINE-2          PIC X(30).
  5593             20  CF-CITY-STATE              PIC X(30).
  5594             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5595             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5596
  5597         16  CF-CLAIM-NO-CONTROL.
  5598             20  CF-CLAIM-NO-METHOD         PIC X.
  5599                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5600                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5601                 88  CLAIM-NO-SEQ               VALUE '3'.
  5602                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5603             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5604                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5605                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 101
* EL131.cbl
  5606                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5607
  5608         16  CF-CHECK-NO-CONTROL.
  5609             20  CF-CHECK-NO-METHOD         PIC X.
  5610                 88  CHECK-NO-MANUAL            VALUE '1'.
  5611                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5612                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5613                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5614             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5615                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5616
  5617         16  CF-DOMICILE-STATE              PIC XX.
  5618
  5619         16  CF-EXPENSE-CONTROLS.
  5620             20  CF-EXPENSE-METHOD          PIC X.
  5621                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5622                 88  DOLLARS-PER-PMT            VALUE '2'.
  5623                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5624                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5625             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5626             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5627
  5628         16  CF-CORRESPONDENCE-CONTROL.
  5629             20  CF-LETTER-RESEND-OPT       PIC X.
  5630                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5631                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5632             20  FILLER                     PIC X(4).
  5633
  5634         16  CF-RESERVE-CONTROLS.
  5635             20  CF-MANUAL-SW               PIC X.
  5636                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5637             20  CF-FUTURE-SW               PIC X.
  5638                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5639             20  CF-PTC-SW                  PIC X.
  5640                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5641             20  CF-IBNR-SW                 PIC X.
  5642                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5643             20  CF-PTC-LF-SW               PIC X.
  5644                 88  CF-LF-PTC-USED             VALUE '1'.
  5645             20  CF-CDT-ACCESS-METHOD       PIC X.
  5646                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5647                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5648                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5649             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5650
  5651         16  CF-CLAIM-CALC-METHOD           PIC X.
  5652             88  360-PLUS-MONTHS                VALUE '1'.
  5653             88  365-PLUS-MONTHS                VALUE '2'.
  5654             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5655             88  360-DAILY                      VALUE '4'.
  5656             88  365-DAILY                      VALUE '5'.
  5657
  5658         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5659         16  FILLER                         PIC X(11).
  5660
  5661         16  CF-LIMIT-AMOUNTS.
  5662             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5663             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 102
* EL131.cbl
  5664             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5665             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5666             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5667             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5668             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5669             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5670             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5671             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5672
  5673         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5674         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5675         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5676
  5677         16  CF-ZIP-CODE.
  5678             20  CF-ZIP-PRIME.
  5679                 24  CF-ZIP-1ST             PIC X.
  5680                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5681                 24  FILLER                 PIC X(4).
  5682             20  CF-ZIP-PLUS4               PIC X(4).
  5683         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5684             20  CF-CAN-POSTAL-1            PIC XXX.
  5685             20  CF-CAN-POSTAL-2            PIC XXX.
  5686             20  FILLER                     PIC XXX.
  5687
  5688         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5689         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5690         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5691
  5692         16  CF-RATING-SWITCH               PIC X.
  5693             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5694             88  CF-NO-RATING                   VALUE 'N'.
  5695
  5696         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5697
  5698         16  CF-CARRIER-OVER-SHORT.
  5699             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5700             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5701
  5702         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5703         16  CF-SECPAY-SWITCH               PIC X.
  5704             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5705             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5706         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5707         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5708         16  FILLER                         PIC X(444).
  5709*        16  FILLER                         PIC X(452).
  5710
  5711
  5712****************************************************************
  5713*             MORTALITY MASTER RECORD                          *
  5714****************************************************************
  5715
  5716     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5717         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5718                                INDEXED BY CF-MORT-NDX.
  5719             20  CF-MORT-TABLE              PIC X(5).
  5720             20  CF-MORT-TABLE-TYPE         PIC X.
  5721                 88  CF-MORT-JOINT              VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 103
* EL131.cbl
  5722                 88  CF-MORT-SINGLE             VALUE 'S'.
  5723                 88  CF-MORT-COMBINED           VALUE 'C'.
  5724                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5725                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5726             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5727             20  CF-MORT-AGE-METHOD         PIC XX.
  5728                 88  CF-AGE-LAST                VALUE 'AL'.
  5729                 88  CF-AGE-NEAR                VALUE 'AN'.
  5730             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5731             20  CF-MORT-ADJUSTMENT-DIRECTION
  5732                                            PIC X.
  5733                 88  CF-MINUS                   VALUE '-'.
  5734                 88  CF-PLUS                    VALUE '+'.
  5735             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5736             20  CF-MORT-JOINT-CODE         PIC X.
  5737                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5738             20  CF-MORT-PC-Q               PIC X.
  5739                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5740             20  CF-MORT-TABLE-CODE         PIC X(4).
  5741             20  CF-MORT-COMMENTS           PIC X(15).
  5742             20  FILLER                     PIC X(14).
  5743
  5744         16  FILLER                         PIC X(251).
  5745
  5746
  5747****************************************************************
  5748*             BUSSINESS TYPE MASTER RECORD                     *
  5749****************************************************************
  5750
  5751     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5752* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5753* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5754* AND RECORD 05 IS TYPES 81-99
  5755         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5756             20  CF-BUSINESS-TITLE          PIC  X(19).
  5757             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5758                                            PIC S9V9(4) COMP-3.
  5759             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5760             20  FILLER                     PIC  X.
  5761         16  FILLER                         PIC  X(248).
  5762
  5763
  5764****************************************************************
  5765*             TERMINAL MASTER RECORD                           *
  5766****************************************************************
  5767
  5768     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5769
  5770         16  CF-COMPANY-TERMINALS.
  5771             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5772                                  PIC X(4).
  5773         16  FILLER               PIC X(248).
  5774
  5775
  5776****************************************************************
  5777*             LIFE EDIT MASTER RECORD                          *
  5778****************************************************************
  5779
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 104
* EL131.cbl
  5780     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5781         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5782             20  CF-LIFE-CODE-IN            PIC XX.
  5783             20  CF-LIFE-CODE-OUT           PIC XX.
  5784         16  FILLER                         PIC X(248).
  5785
  5786
  5787****************************************************************
  5788*             AH EDIT MASTER RECORD                            *
  5789****************************************************************
  5790
  5791     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5792         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5793             20  CF-AH-CODE-IN              PIC XXX.
  5794             20  CF-AH-CODE-OUT             PIC XX.
  5795         16  FILLER                         PIC X(248).
  5796
  5797
  5798****************************************************************
  5799*             CREDIBILITY TABLES                               *
  5800****************************************************************
  5801
  5802     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5803         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5804                             INDEXED BY CF-CRDB-NDX.
  5805             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5806             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5807             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5808         16  FILLER                         PIC  X(332).
  5809
  5810
  5811****************************************************************
  5812*             REPORT CUSTOMIZATION RECORD                      *
  5813****************************************************************
  5814
  5815     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5816         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5817             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5818             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5819             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5820**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5821****       A T-TRANSFER.                                   ****
  5822             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5823
  5824         16  FILLER                         PIC XX.
  5825
  5826         16  CF-CARRIER-CNTL-OPT.
  5827             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5828                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5829                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5830             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5831                                            PIC X.
  5832         16  CF-GROUP-CNTL-OPT.
  5833             20  CF-GROUP-OPT-SEQ           PIC 9.
  5834                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5835                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5836             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5837                                            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 105
* EL131.cbl
  5838         16  CF-STATE-CNTL-OPT.
  5839             20  CF-STATE-OPT-SEQ           PIC 9.
  5840                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5841                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5842             20  CF-STATE-SELECT OCCURS 3 TIMES
  5843                                            PIC XX.
  5844         16  CF-ACCOUNT-CNTL-OPT.
  5845             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5846                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5847                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5848             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5849                                            PIC X(10).
  5850         16  CF-BUS-TYP-CNTL-OPT.
  5851             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5852                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5853                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5854             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5855                                            PIC XX.
  5856         16  CF-LF-TYP-CNTL-OPT.
  5857             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5858                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5859                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5860             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5861                                            PIC XX.
  5862         16  CF-AH-TYP-CNTL-OPT.
  5863             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5864                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5865                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5866             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5867                                            PIC XX.
  5868         16  CF-REPTCD1-CNTL-OPT.
  5869             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5870                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5871                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5872             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5873                                            PIC X(10).
  5874         16  CF-REPTCD2-CNTL-OPT.
  5875             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5876                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5877                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5878             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5879                                            PIC X(10).
  5880         16  CF-USER1-CNTL-OPT.
  5881             20  CF-USER1-OPT-SEQ           PIC 9.
  5882                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5883                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5884             20  CF-USER1-SELECT OCCURS 3 TIMES
  5885                                            PIC X(10).
  5886         16  CF-USER2-CNTL-OPT.
  5887             20  CF-USER2-OPT-SEQ           PIC 9.
  5888                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5889                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5890             20  CF-USER2-SELECT OCCURS 3 TIMES
  5891                                            PIC X(10).
  5892         16  CF-USER3-CNTL-OPT.
  5893             20  CF-USER3-OPT-SEQ           PIC 9.
  5894                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5895                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 106
* EL131.cbl
  5896             20  CF-USER3-SELECT OCCURS 3 TIMES
  5897                                            PIC X(10).
  5898         16  CF-USER4-CNTL-OPT.
  5899             20  CF-USER4-OPT-SEQ           PIC 9.
  5900                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5901                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5902             20  CF-USER4-SELECT OCCURS 3 TIMES
  5903                                            PIC X(10).
  5904         16  CF-USER5-CNTL-OPT.
  5905             20  CF-USER5-OPT-SEQ           PIC 9.
  5906                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5907                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5908             20  CF-USER5-SELECT OCCURS 3 TIMES
  5909                                            PIC X(10).
  5910         16  CF-REINS-CNTL-OPT.
  5911             20  CF-REINS-OPT-SEQ           PIC 9.
  5912                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5913                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5914             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5915                 24  CF-REINS-PRIME         PIC XXX.
  5916                 24  CF-REINS-SUB           PIC XXX.
  5917
  5918         16  CF-AGENT-CNTL-OPT.
  5919             20  CF-AGENT-OPT-SEQ           PIC 9.
  5920                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5921                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5922             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5923                                            PIC X(10).
  5924
  5925         16  FILLER                         PIC X(43).
  5926
  5927         16  CF-LOSS-RATIO-SELECT.
  5928             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5929             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5930         16  CF-ENTRY-DATE-SELECT.
  5931             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5932             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5933         16  CF-EFFECTIVE-DATE-SELECT.
  5934             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5935             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5936
  5937         16  CF-EXCEPTION-LIST-IND          PIC X.
  5938             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5939
  5940         16  FILLER                         PIC X(318).
  5941
  5942****************************************************************
  5943*                  EXCEPTION REPORTING RECORD                  *
  5944****************************************************************
  5945
  5946     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5947         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5948             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5949
  5950         16  CF-COMBINED-LIFE-AH-OPT.
  5951             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5952             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5953             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 107
* EL131.cbl
  5954             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5955
  5956         16  CF-LIFE-OPT.
  5957             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5958             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5959             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5960             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5961             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5962             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5963             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5964             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5965             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5966             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5967
  5968         16  CF-AH-OPT.
  5969             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5970             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5971             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5972             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5973             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5974             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5975             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5976             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5977             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5978             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5979
  5980         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5981             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5982             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5983             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5984
  5985         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5986
  5987         16  FILLER                         PIC X(673).
  5988
  5989
  5990****************************************************************
  5991*             MORTGAGE SYSTEM PLAN RECORD                      *
  5992****************************************************************
  5993
  5994     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5995         16  CF-PLAN-TYPE                   PIC X.
  5996             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5997             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5998             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5999         16  CF-PLAN-ABBREV                 PIC XXX.
  6000         16  CF-PLAN-DESCRIPT               PIC X(10).
  6001         16  CF-PLAN-NOTES                  PIC X(20).
  6002         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6003         16  CF-PLAN-UNDERWRITING.
  6004             20  CF-PLAN-TERM-DATA.
  6005                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6006                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6007             20  CF-PLAN-AGE-DATA.
  6008                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6009                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6010                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6011             20  CF-PLAN-BENEFIT-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 108
* EL131.cbl
  6012                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6013                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6014                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6015                                            PIC S9(7)V99  COMP-3.
  6016         16  CF-PLAN-POLICY-FORMS.
  6017             20  CF-POLICY-FORM             PIC X(12).
  6018             20  CF-MASTER-APPLICATION      PIC X(12).
  6019             20  CF-MASTER-POLICY           PIC X(12).
  6020         16  CF-PLAN-RATING.
  6021             20  CF-RATE-CODE               PIC X(5).
  6022             20  CF-SEX-RATING              PIC X.
  6023                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6024                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6025             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6026             20  CF-SUB-STD-TYPE            PIC X.
  6027                 88  CF-PCT-OF-PREM            VALUE '1'.
  6028                 88  CF-PCT-OF-BENE            VALUE '2'.
  6029         16  CF-PLAN-PREM-TOLERANCES.
  6030             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6031             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6032         16  CF-PLAN-PYMT-TOLERANCES.
  6033             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6034             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6035         16  CF-PLAN-MISC-DATA.
  6036             20  FILLER                     PIC X.
  6037             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6038             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6039         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6040         16  CF-PLAN-IND-GRP                PIC X.
  6041             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6042                                                     '1'.
  6043             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6044                                                     '2'.
  6045         16  CF-MIB-SEARCH-SW               PIC X.
  6046             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6047             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6048             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6049             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6050         16  CF-ALPHA-SEARCH-SW             PIC X.
  6051             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6052             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6053             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6054             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6055             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6056             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6057             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6058             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6059             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6060             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6061                                                     'A' 'B' 'C'
  6062                                                     'X' 'Y' 'Z'.
  6063         16  CF-EFF-DT-RULE-SW              PIC X.
  6064             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6065             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6066             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6067             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6068             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6069         16  FILLER                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 109
* EL131.cbl
  6070         16  CF-HEALTH-QUESTIONS            PIC X.
  6071             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6072         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6073         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6074         16  CF-PLAN-SNGL-JNT               PIC X.
  6075             88  CF-COMBINED-PLAN              VALUE 'C'.
  6076             88  CF-JNT-PLAN                   VALUE 'J'.
  6077             88  CF-SNGL-PLAN                  VALUE 'S'.
  6078         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6079         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6080         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6081         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6082         16  CF-RERATE-CNTL                 PIC  X.
  6083             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6084             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6085             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6086             88  CF-AUTO-RECALC                 VALUE '4'.
  6087         16  CF-BENEFIT-TYPE                PIC  X.
  6088             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6089             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6090         16  CF-POLICY-FEE                  PIC S999V99
  6091                                                    COMP-3.
  6092         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6093         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6094         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6095         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6096         16  FILLER                         PIC  X(32).
  6097         16  CF-TERMINATION-FORM            PIC  X(04).
  6098         16  FILLER                         PIC  X(08).
  6099         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6100                                                       COMP-3.
  6101         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6102         16  CF-ISSUE-LETTER                PIC  X(4).
  6103         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6104         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6105             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6106             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6107         16  CF-MP-REFUND-CALC              PIC X.
  6108             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6109             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6110             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6111             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6112             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6113             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6114             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6115             88  CF-MP-REFD-MEAN                VALUE '8'.
  6116         16  CF-ALT-RATE-CODE               PIC  X(5).
  6117
  6118
  6119         16  FILLER                         PIC X(498).
  6120****************************************************************
  6121*             MORTGAGE COMPANY MASTER RECORD                   *
  6122****************************************************************
  6123
  6124     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6125         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6126         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6127             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 110
* EL131.cbl
  6128             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6129             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6130             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6131             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6132
  6133         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6134         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6135         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6136         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6137         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6138
  6139         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6140             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6141         16  CF-MP-RECON-USE-IND            PIC X(1).
  6142             88  CF-MP-USE-RECON             VALUE 'Y'.
  6143         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6144             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6145         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6146             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6147             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6148         16  FILLER                         PIC X(1).
  6149         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6150             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6151         16  CF-MORTG-MIB-VERSION           PIC X.
  6152             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6153             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6154             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6155         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6156             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6157                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6158             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6159                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6160             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6161                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6162             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6163                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6164             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6165                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6166             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6167                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6168         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6169         16  FILLER                         PIC X(7).
  6170         16  CF-MORTG-DESTINATION-SYMBOL.
  6171             20  CF-MORTG-MIB-COMM          PIC X(5).
  6172             20  CF-MORTG-MIB-TERM          PIC X(5).
  6173         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6174             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6175         16  FILLER                         PIC X(03).
  6176         16  CF-MP-CHECK-NO-CONTROL.
  6177             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6178                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6179                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6180                                                ' ' LOW-VALUES.
  6181                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6182                                               VALUE '3'.
  6183         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6184         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6185         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 111
* EL131.cbl
  6186             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6187                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6188             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6189                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6190             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6191                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6192             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6193                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6194             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6195                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6196             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6197                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6198         16  CF-MORTG-BILLING-AREA.
  6199             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6200                                            PIC X.
  6201         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6202         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6203         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6204         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6205             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6206             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6207         16  FILLER                         PIC X.
  6208         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6209             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6210             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6211         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6212         16  FILLER                         PIC X(8).
  6213         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6214         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6215         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6216         16  CF-ACH-COMPANY-ID.
  6217             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6218                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6219                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6220                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6221             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6222         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6223             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6224         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6225             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6226             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6227         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6228         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6229         16  FILLER                         PIC X(536).
  6230
  6231****************************************************************
  6232*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6233****************************************************************
  6234
  6235     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6236         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6237             20  CF-FEMALE-HEIGHT.
  6238                 24  CF-FEMALE-FT           PIC 99.
  6239                 24  CF-FEMALE-IN           PIC 99.
  6240             20  CF-FEMALE-MIN-WT           PIC 999.
  6241             20  CF-FEMALE-MAX-WT           PIC 999.
  6242         16  FILLER                         PIC X(428).
  6243
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 112
* EL131.cbl
  6244     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6245         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6246             20  CF-MALE-HEIGHT.
  6247                 24  CF-MALE-FT             PIC 99.
  6248                 24  CF-MALE-IN             PIC 99.
  6249             20  CF-MALE-MIN-WT             PIC 999.
  6250             20  CF-MALE-MAX-WT             PIC 999.
  6251         16  FILLER                         PIC X(428).
  6252******************************************************************
  6253*             AUTOMATIC ACTIVITY RECORD                          *
  6254******************************************************************
  6255     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6256         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6257             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6258             20  CF-SYS-LETTER-ID           PIC X(04).
  6259             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6260             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6261             20  CF-SYS-RESET-SW            PIC X(01).
  6262             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6263             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6264
  6265         16  FILLER                         PIC X(50).
  6266
  6267         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6268             20  CF-USER-ACTIVE-SW          PIC X(01).
  6269             20  CF-USER-LETTER-ID          PIC X(04).
  6270             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6271             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6272             20  CF-USER-RESET-SW           PIC X(01).
  6273             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6274             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6275             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6276
  6277         16  FILLER                         PIC X(246).
  6278
  6279*                                COPY ELCACTQ.
  6280******************************************************************
  6281*                                                                *
  6282*                            ELCACTQ.                            *
  6283*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6284*                            VMOD=2.004                          *
  6285*                                                                *
  6286*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6287*                                                                *
  6288*   FILE TYPE = VSAM,KSDS                                        *
  6289*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6290*                                                                *
  6291*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6292*       ALTERNATE INDEX = NONE                                   *
  6293*                                                                *
  6294*   LOG = YES                                                    *
  6295*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6296*                                                                *
  6297*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6298******************************************************************
  6299
  6300 01  ACTIVITY-QUE.
  6301     12  AQ-RECORD-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 113
* EL131.cbl
  6302         88  VALID-AQ-ID                VALUE 'AQ'.
  6303
  6304     12  AQ-CONTROL-PRIMARY.
  6305         16  AQ-COMPANY-CD           PIC X.
  6306         16  AQ-CARRIER              PIC X.
  6307         16  AQ-CLAIM-NO             PIC X(7).
  6308         16  AQ-CERT-NO.
  6309             20  AQ-CERT-PRIME       PIC X(10).
  6310             20  AQ-CERT-SFX         PIC X.
  6311
  6312     12  AQ-PENDING-ACTIVITY-FLAGS.
  6313         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6314         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6315             88  PENDING-PAYMENTS       VALUE '1'.
  6316         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6317             88  PENDING-FULL-PRINT     VALUE '1'.
  6318             88  PENDING-PART-PRINT     VALUE '2'.
  6319         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6320             88  PENDING-LETTERS        VALUE '1'.
  6321         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6322             88  PENDING-RESTORE        VALUE 'C'.
  6323             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6324
  6325     12  FILLER                      PIC X(20).
  6326
  6327     12  AQ-RESEND-DATE              PIC XX.
  6328     12  AQ-FOLLOWUP-DATE            PIC XX.
  6329     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6330     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6331     12  AQ-AUTO-LETTER              PIC X(4).
  6332     12  FILLER                      PIC XX.
  6333     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6334*****************************************************************
  6335
  6336*                                COPY ERCACCT.
  6337******************************************************************
  6338*                                                                *
  6339*                                                                *
  6340*                            ERCACCT                             *
  6341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6342*                            VMOD=2.031                          *
  6343*                                                                *
  6344*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6345*                                                                *
  6346*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6347*   VSAM ACCOUNT MASTER FILES.                                   *
  6348*                                                                *
  6349*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6350*                                                                *
  6351*   FILE TYPE = VSAM,KSDS                                        *
  6352*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6353*                                                                *
  6354*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6355*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6356*                                                                *
  6357*   LOG = NO                                                     *
  6358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6359*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 114
* EL131.cbl
  6360*                                                                *
  6361******************************************************************
  6362*                   C H A N G E   L O G
  6363*
  6364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6365*-----------------------------------------------------------------
  6366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6367* EFFECTIVE    NUMBER
  6368*-----------------------------------------------------------------
  6369* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6370* 092705    2005050300006  PEMA  ADD SPP LEASES
  6371* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6372* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6373* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6374* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6375* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6376* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6377******************************************************************
  6378
  6379 01  ACCOUNT-MASTER.
  6380     12  AM-RECORD-ID                      PIC XX.
  6381         88  VALID-AM-ID                      VALUE 'AM'.
  6382
  6383     12  AM-CONTROL-PRIMARY.
  6384         16  AM-COMPANY-CD                 PIC X.
  6385         16  AM-MSTR-CNTRL.
  6386             20  AM-CONTROL-A.
  6387                 24  AM-CARRIER            PIC X.
  6388                 24  AM-GROUPING.
  6389                     28 AM-GROUPING-PREFIX PIC XXX.
  6390                     28 AM-GROUPING-PRIME  PIC XXX.
  6391                 24  AM-STATE              PIC XX.
  6392                 24  AM-ACCOUNT.
  6393                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6394                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6395             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6396                                           PIC X(19).
  6397             20  AM-CNTRL-B.
  6398                 24  AM-EXPIRATION-DT      PIC XX.
  6399                 24  FILLER                PIC X(4).
  6400             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6401                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6402
  6403     12  AM-CONTROL-BY-VAR-GRP.
  6404         16  AM-COMPANY-CD-A1              PIC X.
  6405         16  AM-VG-CARRIER                 PIC X.
  6406         16  AM-VG-GROUPING                PIC X(6).
  6407         16  AM-VG-STATE                   PIC XX.
  6408         16  AM-VG-ACCOUNT                 PIC X(10).
  6409         16  AM-VG-DATE.
  6410             20  AM-VG-EXPIRATION-DT       PIC XX.
  6411             20  FILLER                    PIC X(4).
  6412         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6413                                           PIC 9(11)      COMP-3.
  6414     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6415         16  FILLER                        PIC X(10).
  6416         16  AM-VG-KEY3.
  6417             20  AM-VG3-ACCOUNT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 115
* EL131.cbl
  6418             20  AM-VG3-EXP-DT             PIC XX.
  6419         16  FILLER                        PIC X(4).
  6420     12  AM-MAINT-INFORMATION.
  6421         16  AM-LAST-MAINT-DT              PIC XX.
  6422         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6423         16  AM-LAST-MAINT-USER            PIC X(4).
  6424         16  FILLER                        PIC XX.
  6425
  6426     12  AM-EFFECTIVE-DT                   PIC XX.
  6427     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6428
  6429     12  AM-PREV-DATES  COMP-3.
  6430         16  AM-PREV-EXP-DT                PIC 9(11).
  6431         16  AM-PREV-EFF-DT                PIC 9(11).
  6432
  6433     12  AM-REPORT-CODE-1                  PIC X(10).
  6434     12  AM-REPORT-CODE-2                  PIC X(10).
  6435
  6436     12  AM-CITY-CODE                      PIC X(4).
  6437     12  AM-COUNTY-PARISH                  PIC X(6).
  6438
  6439     12  AM-NAME                           PIC X(30).
  6440     12  AM-PERSON                         PIC X(30).
  6441     12  AM-ADDRS                          PIC X(30).
  6442     12  AM-CITY.
  6443         16  AM-ADDR-CITY                  PIC X(28).
  6444         16  AM-ADDR-STATE                 PIC XX.
  6445     12  AM-ZIP.
  6446         16  AM-ZIP-PRIME.
  6447             20  AM-ZIP-PRI-1ST            PIC X.
  6448                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6449             20  FILLER                    PIC X(4).
  6450         16  AM-ZIP-PLUS4                  PIC X(4).
  6451     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6452         16  AM-CAN-POSTAL-1               PIC XXX.
  6453         16  AM-CAN-POSTAL-2               PIC XXX.
  6454         16  FILLER                        PIC XXX.
  6455     12  AM-TEL-NO.
  6456         16  AM-AREA-CODE                  PIC 999.
  6457         16  AM-TEL-PRE                    PIC 999.
  6458         16  AM-TEL-NBR                    PIC 9(4).
  6459     12  AM-TEL-LOC                        PIC X.
  6460         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6461         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6462
  6463     12  AM-COMM-STRUCTURE.
  6464         16  AM-DEFN-1.
  6465             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6466                 24  AM-AGT.
  6467                     28  AM-AGT-PREFIX     PIC X(4).
  6468                     28  AM-AGT-PRIME      PIC X(6).
  6469                 24  AM-COM-TYP            PIC X.
  6470                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6471                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6472                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6473                 24  AM-RECALC-LV-INDIC    PIC X.
  6474                 24  AM-RETRO-LV-INDIC     PIC X.
  6475                 24  AM-GL-CODES           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 116
* EL131.cbl
  6476                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6477                 24  FILLER                PIC X(01).
  6478         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6479             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6480                 24  FILLER                PIC X(11).
  6481                 24  AM-L-COMA             PIC XXX.
  6482                 24  AM-J-COMA             PIC XXX.
  6483                 24  AM-A-COMA             PIC XXX.
  6484                 24  FILLER                PIC X(6).
  6485
  6486     12  AM-COMM-CHANGE-STATUS             PIC X.
  6487         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6488
  6489     12  AM-CSR-CODE                       PIC X(4).
  6490
  6491     12  AM-BILLING-STATUS                 PIC X.
  6492         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6493         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6494     12  AM-AUTO-REFUND-SW                 PIC X.
  6495         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6496         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6497     12  AM-GPCD                           PIC 99.
  6498     12  AM-IG                             PIC X.
  6499         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6500         88  AM-HAS-GROUP                     VALUE '2'.
  6501     12  AM-STATUS                         PIC X.
  6502         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6503         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6504         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6505         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6506         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6507         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6508         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6509         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6510         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6511         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6512     12  AM-REMIT-TO                       PIC 99.
  6513     12  AM-ID-NO                          PIC X(11).
  6514
  6515     12  AM-CAL-TABLE                      PIC XX.
  6516     12  AM-LF-DEVIATION                   PIC XXX.
  6517     12  AM-AH-DEVIATION                   PIC XXX.
  6518     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6519     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6520     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6521     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6522     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6523     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6524
  6525     12  AM-USER-FIELDS.
  6526         16  AM-FLD-1                      PIC XX.
  6527         16  AM-FLD-2                      PIC XX.
  6528         16  AM-FLD-3                      PIC XX.
  6529         16  AM-FLD-4                      PIC XX.
  6530         16  AM-FLD-5                      PIC XX.
  6531
  6532     12  AM-1ST-PROD-DATE.
  6533         16  AM-1ST-PROD-YR                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 117
* EL131.cbl
  6534         16  AM-1ST-PROD-MO                PIC XX.
  6535         16  AM-1ST-PROD-DA                PIC XX.
  6536     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6537     12  AM-CERTS-PURGED-DATE.
  6538         16  AM-PUR-YR                     PIC XX.
  6539         16  AM-PUR-MO                     PIC XX.
  6540         16  AM-PUR-DA                     PIC XX.
  6541     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6542     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6543     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6544     12  AM-INACTIVE-DATE.
  6545         16  AM-INA-MO                     PIC 99.
  6546         16  AM-INA-DA                     PIC 99.
  6547         16  AM-INA-YR                     PIC 99.
  6548     12  AM-AR-HI-CERT-DATE                PIC XX.
  6549
  6550     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6551     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6552
  6553     12  AM-OB-PAYMENT-MODE                PIC X.
  6554         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6555         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6556         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6557         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6558
  6559     12  AM-AH-ONLY-INDICATOR              PIC X.
  6560         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6561         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6562
  6563     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6564
  6565     12  AM-OVER-SHORT.
  6566         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6567         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6568
  6569     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6570     12  AM-DCC-CLP-STATE                  PIC XX.
  6571
  6572     12  AM-RECALC-COMM                    PIC X.
  6573     12  AM-RECALC-REIN                    PIC X.
  6574
  6575     12  AM-REI-TABLE                      PIC XXX.
  6576     12  AM-REI-ET-LF                      PIC X.
  6577     12  AM-REI-ET-AH                      PIC X.
  6578     12  AM-REI-PE-LF                      PIC X.
  6579     12  AM-REI-PE-AH                      PIC X.
  6580     12  AM-REI-PRT-ST                     PIC X.
  6581     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6582     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6583     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6584     12  AM-REI-GROUP-A                    PIC X(6).
  6585     12  AM-REI-MORT                       PIC X(4).
  6586     12  AM-REI-PRT-OW                     PIC X.
  6587     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6588     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6589     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6590     12  AM-REI-GROUP-B                    PIC X(6).
  6591
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 118
* EL131.cbl
  6592     12  AM-TRUST-TYPE                     PIC X(2).
  6593
  6594     12  AM-EMPLOYER-STMT-USED             PIC X.
  6595     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6596
  6597     12  AM-STD-AH-TYPE                    PIC XX.
  6598     12  AM-EARN-METHODS.
  6599         16  AM-EARN-METHOD-R              PIC X.
  6600             88 AM-REF-RL-R78                 VALUE 'R'.
  6601             88 AM-REF-RL-PR                  VALUE 'P'.
  6602             88 AM-REF-RL-MEAN                VALUE 'M'.
  6603             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6604         16  AM-EARN-METHOD-L              PIC X.
  6605             88 AM-REF-LL-R78                 VALUE 'R'.
  6606             88 AM-REF-LL-PR                  VALUE 'P'.
  6607             88 AM-REF-LL-MEAN                VALUE 'M'.
  6608             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6609         16  AM-EARN-METHOD-A              PIC X.
  6610             88 AM-REF-AH-R78                 VALUE 'R'.
  6611             88 AM-REF-AH-PR                  VALUE 'P'.
  6612             88 AM-REF-AH-MEAN                VALUE 'M'.
  6613             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6614             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6615             88 AM-REF-AH-NET                 VALUE 'N'.
  6616
  6617     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6618     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6619     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6620
  6621     12  AM-RET-Y-N                        PIC X.
  6622     12  AM-RET-P-E                        PIC X.
  6623     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6624     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6625     12  AM-RET-GRP                        PIC X(6).
  6626     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6627         16  AM-POOL-PRIME                 PIC XXX.
  6628         16  AM-POOL-SUB                   PIC XXX.
  6629     12  AM-RETRO-EARNINGS.
  6630         16  AM-RET-EARN-R                 PIC X.
  6631         16  AM-RET-EARN-L                 PIC X.
  6632         16  AM-RET-EARN-A                 PIC X.
  6633     12  AM-RET-ST-TAX-USE                 PIC X.
  6634         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6635         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6636     12  AM-RETRO-BEG-EARNINGS.
  6637         16  AM-RET-BEG-EARN-R             PIC X.
  6638         16  AM-RET-BEG-EARN-L             PIC X.
  6639         16  AM-RET-BEG-EARN-A             PIC X.
  6640     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6641     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6642
  6643     12  AM-USER-SELECT-OPTIONS.
  6644         16  AM-USER-SELECT-1              PIC X(10).
  6645         16  AM-USER-SELECT-2              PIC X(10).
  6646         16  AM-USER-SELECT-3              PIC X(10).
  6647         16  AM-USER-SELECT-4              PIC X(10).
  6648         16  AM-USER-SELECT-5              PIC X(10).
  6649
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 119
* EL131.cbl
  6650     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6651
  6652     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6653
  6654     12  AM-RPT045A-SWITCH                 PIC X.
  6655         88  RPT045A-OFF                   VALUE 'N'.
  6656
  6657     12  AM-INSURANCE-LIMITS.
  6658         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6659         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6660
  6661     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6662         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6663
  6664     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6665         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6666         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6667
  6668     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6669
  6670     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6671     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6672     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6673     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6674     12  AM-DCC-UEF-STATE                  PIC XX.
  6675     12  FILLER                            PIC XXX.
  6676     12  AM-REPORT-CODE-3                  PIC X(10).
  6677*    12  FILLER                            PIC X(22).
  6678
  6679     12  AM-RESERVE-DATE.
  6680         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6681         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6682         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6683
  6684     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6685     12  AM-NOTIFICATION-TYPES.
  6686         16  AM-NOTIF-OF-LETTERS           PIC X.
  6687         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6688         16  AM-NOTIF-OF-REPORTS           PIC X.
  6689         16  AM-NOTIF-OF-STATUS            PIC X.
  6690
  6691     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6692         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6693         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6694         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6695         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6696
  6697     12  AM-BENEFIT-CONTROLS.
  6698         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6699             20  AM-BENEFIT-CODE           PIC XX.
  6700             20  AM-BENEFIT-TYPE           PIC X.
  6701             20  AM-BENEFIT-REVISION       PIC XXX.
  6702             20  AM-BENEFIT-REM-TERM       PIC X.
  6703             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6704             20  FILLER                    PIC XX.
  6705         16  FILLER                        PIC X(80).
  6706
  6707     12  AM-TRANSFER-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 120
* EL131.cbl
  6708         16  AM-TRANSFERRED-FROM.
  6709             20  AM-TRNFROM-CARRIER        PIC X.
  6710             20  AM-TRNFROM-GROUPING.
  6711                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6712                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6713             20  AM-TRNFROM-STATE          PIC XX.
  6714             20  AM-TRNFROM-ACCOUNT.
  6715                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6716                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6717             20  AM-TRNFROM-DTE            PIC XX.
  6718         16  AM-TRANSFERRED-TO.
  6719             20  AM-TRNTO-CARRIER          PIC X.
  6720             20  AM-TRNTO-GROUPING.
  6721                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6722                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6723             20  AM-TRNTO-STATE            PIC XX.
  6724             20  AM-TRNTO-ACCOUNT.
  6725                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6726                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6727             20  AM-TRNTO-DTE              PIC XX.
  6728         16  FILLER                        PIC X(10).
  6729
  6730     12  AM-SAVED-REMIT-TO                 PIC 99.
  6731
  6732     12  AM-COMM-STRUCTURE-SAVED.
  6733         16  AM-DEFN-1-SAVED.
  6734             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6735                 24  AM-AGT-SV             PIC X(10).
  6736                 24  AM-COM-TYP-SV         PIC X.
  6737                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6738                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6739                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6740                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6741                 24  FILLER                PIC X.
  6742                 24  AM-GL-CODES-SV        PIC X.
  6743                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6744                 24  FILLER                PIC X.
  6745         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6746             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6747                 24  FILLER                PIC X(11).
  6748                 24  AM-L-COMA-SV          PIC XXX.
  6749                 24  AM-J-COMA-SV          PIC XXX.
  6750                 24  AM-A-COMA-SV          PIC XXX.
  6751                 24  FILLER                PIC X(6).
  6752
  6753     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6754         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6755            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6756            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6757            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6758
  6759     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6760     12  FILLER                            PIC X(120).
  6761
  6762     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6763         16  AM-CONTROL-NAME               PIC X(30).
  6764         16  AM-EXECUTIVE-ONE.
  6765             20  AM-EXEC1-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 121
* EL131.cbl
  6766             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6767                                                          COMP-3.
  6768             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6769                                                          COMP-3.
  6770         16  AM-EXECUTIVE-TWO.
  6771             20  AM-EXEC2-NAME             PIC X(15).
  6772             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6773                                                          COMP-3.
  6774             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6775                                                          COMP-3.
  6776
  6777     12  AM-RETRO-ADDITIONAL-DATA.
  6778         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6779         16  AM-RETRO-PREM-P-E             PIC X.
  6780         16  AM-RETRO-CLMS-P-I             PIC X.
  6781         16  AM-RETRO-RET-BRACKET-LF.
  6782             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6783                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6784                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6785             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6786                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6787                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6788             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6789                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6790                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6791         16  AM-RETRO-RET-BRACKET-AH.
  6792             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6793                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6794                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6795                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6796             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6797                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6798                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6799             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6800                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6801                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6802
  6803     12  AM-COMMENTS.
  6804         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6805
  6806     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6807         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6808         16  AM-FLI-BILLING-CODE           PIC X.
  6809         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6810         16  AM-FLI-UNITED-IDENT           PIC X.
  6811         16  AM-FLI-INTEREST-LOST-DATA.
  6812             20  AM-FLI-BANK-NO            PIC X(5).
  6813             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6814             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6815             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6816         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6817             20  AM-FLI-AGT                PIC X(9).
  6818             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6819             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6820         16  FILLER                        PIC X(102).
  6821
  6822     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6823         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 122
* EL131.cbl
  6824             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6825             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6826             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6827             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6828             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6829         16  FILLER                          PIC X(10).
  6830******************************************************************
  6831
  6832*                                COPY ELCCHKQ.
  6833******************************************************************
  6834*                                                                *
  6835*                                                                *
  6836*                            ELCCHKQ.                            *
  6837*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6838*                            VMOD=2.007                          *
  6839*                                                                *
  6840*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6841*                                                                *
  6842*   FILE TYPE = VSAM,KSDS                                        *
  6843*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6844*                                                                *
  6845*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6846*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6847*                                                                *
  6848*   LOG = YES                                                    *
  6849*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6850******************************************************************
  6851 01  CHECK-QUE.
  6852     12  CQ-RECORD-ID                PIC XX.
  6853         88  VALID-CQ-ID         VALUE 'CQ'.
  6854
  6855     12  CQ-CONTROL-PRIMARY.
  6856         16  CQ-COMPANY-CD           PIC X.
  6857         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6858         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6859
  6860     12  CQ-CONTROL-BY-PAYEE.
  6861         16  CQ-CONTROL-BY-NUMBER.
  6862             20  CQ-COMPANY-CD-A1     PIC X.
  6863             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6864         16  CQ-PAYEE-CARRIER        PIC X.
  6865         16  CQ-PAYEE-GROUPING       PIC X(6).
  6866         16  CQ-PAYEE-STATE          PIC XX.
  6867         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6868         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6869
  6870     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6871         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6872         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6873         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6874         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6875         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6876         16  FILLER                  PIC X(3).
  6877
  6878     12  CQ-ENTRY-TYPE               PIC X.
  6879             88  CHECK-ON-QUE           VALUE 'Q'.
  6880             88  ALIGNMENT-CHECK        VALUE 'A'.
  6881             88  SPOILED-CHECK          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 123
* EL131.cbl
  6882             88  PAYMENT-ABORTED        VALUE 'X'.
  6883
  6884     12  CQ-CLAIM-MAST-CNTL.
  6885         16  CQ-CARRIER              PIC X.
  6886         16  CQ-CLAIM-NO             PIC X(7).
  6887         16  CQ-CERT-NO.
  6888             20  CQ-CERT-PRIME       PIC X(10).
  6889             20  CQ-CERT-SFX         PIC X.
  6890         16  CQ-CLAIM-TYPE           PIC X.
  6891             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6892             88  CQ-AH-CLAIM            VALUE 'A'.
  6893         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6894             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6895             88  CQ-O-B-COVERAGE        VALUE '2'.
  6896             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6897
  6898     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6899     12  CQ-CHECK-NUMBER             PIC X(7).
  6900     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6901     12  CQ-PAYMENT-TYPE             PIC X.
  6902             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6903             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6904             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6905             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6906             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6907             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6908             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6909             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6910     12  CQ-VOID-INDICATOR           PIC X.
  6911             88  CHECK-IS-STOPPED          VALUE 'S'.
  6912             88  CHECK-IS-VOID             VALUE 'V'.
  6913     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6914     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6915     12  CQ-CHECK-BY-USER            PIC X(4).
  6916     12  CQ-PRE-NUMBERING-SW         PIC X.
  6917       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6918       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6919
  6920     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6921     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6922     12  CQ-LEDGER-FLAG              PIC X(01).
  6923     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6924     12  CQ-LAST-UPDATED-DT          PIC XX.
  6925     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6926     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6927
  6928     12  FILLER                      PIC X(04).
  6929
  6930******************************************************************
  6931
  6932*                                COPY ELCARCH.
  6933******************************************************************
  6934*                                                                *
  6935*                            ELCARCH.                            *
  6936*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6937*                            VMOD=2.007                          *
  6938*                                                                *
  6939*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 124
* EL131.cbl
  6940*                                                                *
  6941*   FILE TYPE = VSAM,KSDS                                        *
  6942*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6943*                                                                *
  6944*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6945*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6946*                                                                *
  6947*   LOG = NO                                                     *
  6948*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6949*                                                                *
  6950*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6951******************************************************************
  6952 01  LETTER-ARCHIVE.
  6953     12  LA-RECORD-ID                PIC XX.
  6954         88  VALID-LA-ID                VALUE 'LA'.
  6955
  6956     12  LA-CONTROL-PRIMARY.
  6957         16  LA-COMPANY-CD           PIC X.
  6958         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6959         16  LA-RECORD-TYPE          PIC X.
  6960             88  LA-HEADER-DATA         VALUE '1'.
  6961             88  LA-ADDRESS-DATA        VALUE '2'.
  6962             88  LA-TEXT-DATA           VALUE '3'.
  6963             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6964         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6965
  6966     12  LA-CONTROL-BY-TYPE.
  6967         16  LA-COMPANY-CD-A1        PIC X.
  6968         16  LA-RECORD-TYPE-A1       PIC X.
  6969         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6970         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6971
  6972     12  LA-TEXT-RECORD.
  6973         16  LA-SKIP-CONTROL         PIC XX.
  6974             88  NO-LINES-SKIPPED       VALUE SPACES.
  6975             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6976         16  LA-TEXT-LINE            PIC X(70).
  6977
  6978     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6979         16  FILLER                  PIC XX.
  6980         16  LA-ADDRESS-LINE         PIC X(30).
  6981         16  FILLER                  PIC X(40).
  6982
  6983     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6984         16  FILLER                  PIC XX.
  6985         16  LA-CARRIER              PIC X.
  6986         16  LA-CLAIM-NO             PIC X(7).
  6987         16  LA-CERT-NO.
  6988             20  LA-CERT-PRIME       PIC X(10).
  6989             20  LA-CERT-SFX         PIC X.
  6990         16  LA-NO-OF-COPIES         PIC S9.
  6991         16  LA-RESEND-DATE          PIC XX.
  6992         16  LA-PROCESSOR-CD         PIC X(4).
  6993         16  LA-CREATION-DT          PIC XX.
  6994         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6995         16  LA-RESEND-PRINT-DATE    PIC XX.
  6996         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6997         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 125
* EL131.cbl
  6998*
  6999* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7000*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7001*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7002*   I        20  LA-DMD-RES-ST           PIC XX.
  7003*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7004*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7005*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7006*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7007*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7008*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7009*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7010*   I        20  LA-DMD-UND-CODE         PIC XX.
  7011*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7012*   V    16  FILLER                  PIC X(15).
  7013* -----
  7014*
  7015* REINSERTED  CSO  MODS
  7016*
  7017         16  FILLER.
  7018             20  FILLER                  PIC X(29).
  7019             20  LA-CSO-LETTER-STATUS    PIC X.
  7020                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7021                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7022                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7023             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7024             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7025*
  7026
  7027     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7028         16  FILLER                  PIC XX.
  7029         16  LA4-CARRIER             PIC X.
  7030         16  LA4-CLAIM-NO            PIC X(7).
  7031         16  LA4-CERT-NO.
  7032             20  LA4-CERT-PRIME      PIC X(10).
  7033             20  LA4-CERT-SFX        PIC X.
  7034         16  LA4-NO-OF-COPIES        PIC S9.
  7035         16  LA4-RESEND-DATE         PIC XX.
  7036         16  LA4-PROCESSOR-CD        PIC X(4).
  7037         16  LA4-CREATION-DT         PIC XX.
  7038         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7039         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7040         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7041         16  LA4-FORM-TYPE           PIC X.
  7042             88  LA4-INITIAL-FORM    VALUE '1'.
  7043             88  LA4-PROGRESS-FORM   VALUE '2'.
  7044         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7045         16  LA4-STATE               PIC X(02).
  7046         16  FILLER                  PIC X(31).
  7047******************************************************************
  7048
  7049*                                COPY ELCBENE.
  7050******************************************************************
  7051*                                                                *
  7052*                            ELCBENE.                            *
  7053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7054*                            VMOD=2.006                          *
  7055*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 126
* EL131.cbl
  7056*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7057*                                                                *
  7058*   FILE TYPE = VSAM,KSDS                                        *
  7059*   RECORD SIZE = 500   RECFORM = FIX                            *
  7060*                                                                *
  7061*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7062*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7063*                                                                *
  7064*   LOG = YES                                                    *
  7065*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7066*                                                                *
  7067*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7068******************************************************************
  7069*                   C H A N G E   L O G
  7070*
  7071* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7072*-----------------------------------------------------------------
  7073*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7074* EFFECTIVE    NUMBER
  7075*-----------------------------------------------------------------
  7076* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7077* 082317  CR2017082100003  PEMA  Add sub type
  7078******************************************************************
  7079
  7080 01  BENEFICIARY-MASTER.
  7081     12  BE-RECORD-ID                PIC XX.
  7082         88  VALID-BE-ID                VALUE 'BE'.
  7083
  7084     12  BE-CONTROL-PRIMARY.
  7085         16  BE-COMPANY-CD           PIC X.
  7086         16  BE-RECORD-TYPE          PIC X.
  7087             88  BENEFICIARY-RECORD  VALUE 'B'.
  7088             88  ADJUSTOR-RECORD     VALUE 'A'.
  7089         16  BE-BENEFICIARY          PIC X(10).
  7090     12  BE-CONTROL-BY-NAME.
  7091         16  BE-COMPANY-CD-A1        PIC X.
  7092         16  BE-RECORD-TYPE-A1       PIC X.
  7093         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7094         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7095
  7096     12  BE-LAST-MAINT-DT            PIC XX.
  7097     12  BE-LAST-MAINT-BY            PIC X(4).
  7098     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7099
  7100     12  BE-ADDRESS-DATA.
  7101         16  BE-MAIL-TO-NAME         PIC X(30).
  7102         16  BE-ADDRESS-LINE-1       PIC X(30).
  7103         16  BE-ADDRESS-LINE-2       PIC X(30).
  7104         16  BE-ADDRESS-LINE-3       PIC X(30).
  7105         16  BE-CITY-STATE.
  7106             20  BE-CITY             PIC X(28).
  7107             20  BE-STATE            PIC XX.
  7108         16  BE-ZIP-CODE.
  7109             20  BE-ZIP-PRIME.
  7110                 24  BE-ZIP-1ST      PIC X.
  7111                     88  BE-CANADIAN-POST-CODE
  7112                                         VALUE 'A' THRU 'Z'.
  7113                 24  FILLER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 127
* EL131.cbl
  7114             20  BE-ZIP-PLUS4        PIC X(4).
  7115         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7116             20  BE-CAN-POSTAL-1     PIC XXX.
  7117             20  BE-CAN-POSTAL-2     PIC XXX.
  7118             20  FILLER              PIC XXX.
  7119         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7120         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7121
  7122******************************************************************
  7123*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7124*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7125******************************************************************
  7126     12  BE-CARRIER                  PIC X.
  7127
  7128     12  BE-ADDRESS-DATA2.
  7129         16  BE-MAIL-TO-NAME2        PIC X(30).
  7130         16  BE-ADDRESS-LINE-12      PIC X(30).
  7131         16  BE-ADDRESS-LINE-22      PIC X(30).
  7132         16  BE-ADDRESS-LINE-32      PIC X(30).
  7133         16  BE-CITY-STATE2.
  7134             20  BE-CITY2            PIC X(28).
  7135             20  BE-STATE2           PIC XX.
  7136         16  BE-ZIP-CODE2.
  7137             20  BE-ZIP-PRIME2.
  7138                 24  BE-ZIP-1ST2     PIC X.
  7139                     88  BE-CANADIAN-POST-CODE2
  7140                                         VALUE 'A' THRU 'Z'.
  7141                 24  FILLER          PIC X(4).
  7142             20  BE-ZIP-PLUS42       PIC X(4).
  7143         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7144             20  BE-CAN-POSTAL-12    PIC XXX.
  7145             20  BE-CAN-POSTAL-22    PIC XXX.
  7146             20  FILLER              PIC XXX.
  7147         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7148         16  BE-ACH-DATA.
  7149             20  BE-ACH-YES-OR-NO    PIC X.
  7150                 88  BE-ON-ACH       VALUE 'Y'.
  7151                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7152             20  BE-ACH-ABA-ROUTING-NUMBER
  7153                                     PIC X(15).
  7154             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7155                                     PIC X(20).
  7156             20  BE-ACH-SUB-TYPE     PIC XX.
  7157             20  FILLER              PIC X(23).
  7158         16  BE-BILLING-STMT-DATA.
  7159*            20  BE-BSR              PIC X.
  7160*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7161*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7162*            20  BE-BSR-FROM         PIC X(30).
  7163*            20  BE-BSR-DEPT         PIC X(30).
  7164             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7165             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7166             20  BE-OUTPUT-TYPE      PIC X.
  7167                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7168                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7169
  7170     12  FILLER                      PIC X(28).
  7171******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 128
* EL131.cbl
  7172
  7173*                                COPY ELCDAR.
  7174******************************************************************
  7175*                                                                *
  7176*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7177*   FILE TYPE = VSAM,KSDS                                        *
  7178*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7179*   BASE CLUSTER = DLYACTV                                       *
  7180*   LOG = YES                                                    *
  7181*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7182*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7183*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7184*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7185*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7186*               BY PROGRAM "LGINFCE".                            *
  7187*                                                                *
  7188******************************************************************
  7189 01  DAILY-ACTIVITY-RECORD.
  7190     05  DA-KEY.
  7191         10  DA-COMP-CD          PIC X.
  7192         10  DA-CARRIER          PIC X.
  7193         10  DA-CLAIM-NO         PIC X(7).
  7194         10  DA-CERT-NO.
  7195             15  DA-CERT-PRIME   PIC X(10).
  7196             15  DA-CERT-SFX     PIC X.
  7197     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7198     05  DA-RECORD-TYPE          PIC X.
  7199     05  FILLER                  PIC X(2).
  7200******************************************************************
  7201
  7202*                                COPY ELCALPH.
  7203******************************************************************
  7204*                                                                *
  7205*                            ELCALPH.                            *
  7206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7207*                            VMOD=2.003                          *
  7208*                                                                *
  7209*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7210*                                                                *
  7211*   FILE TYPE = VSAM,KSDS                                        *
  7212*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7213*                                                                *
  7214*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7215*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7216*                                                                *
  7217*   LOG = YES                                                    *
  7218*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7219*                                                                *
  7220*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7221******************************************************************
  7222
  7223 01  ALPHA-INDEX.
  7224     12  AI-RECORD-ID                         PIC XX.
  7225         88  VALID-AI-ID                  VALUE 'AI'.
  7226     12  AI-CONTROL-PRIMARY.
  7227         16  AI-COMPANY-CD                     PIC X.
  7228         16  AI-SOURCE                         PIC X.
  7229             88  AI-CLAIM-SYSTEM          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 129
* EL131.cbl
  7230             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7231         16  AI-NAME.
  7232             20  AI-LAST-NAME                  PIC X(15).
  7233             20  AI-FIRST-NAME.
  7234                 24  AI-FIRST-INITIAL          PIC X.
  7235                 24  FILLER                    PIC X(11).
  7236             20  AI-MIDDLE-INIT                PIC X.
  7237         16  AI-DATE                           PIC X(8).
  7238         16  AI-TIME                           PIC S9(07) COMP-3.
  7239
  7240     12  AI-CONTROL-BY-ADMIN-KEY.
  7241         16  AI-CM-COMPANY-CD                  PIC X.
  7242         16  AI-CM-SOURCE                      PIC X.
  7243         16  AI-CM-CARRIER                     PIC X.
  7244         16  AI-CM-GROUPING.
  7245             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7246             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7247         16  AI-CM-STATE                       PIC XX.
  7248         16  AI-CM-PRODUCER.
  7249             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7250             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7251         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7252         16  AI-CM-CERTIFICATE-NUMBER.
  7253             20  AI-CM-CERT-PRIME              PIC X(10).
  7254             20  AI-CM-CERT-SFX                PIC X.
  7255         16  AI-CM-DATE                        PIC X(8).
  7256         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7257         16  FILLER                            PIC X(11).
  7258
  7259     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7260         AI-CONTROL-BY-ADMIN-KEY.
  7261         16  AI-CL-COMPANY-CD                  PIC X.
  7262         16  AI-CL-SOURCE                      PIC X.
  7263         16  AI-CL-CARRIER                     PIC X.
  7264         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7265         16  AI-CL-CERTIFICATE-NUMBER.
  7266             20  AI-CL-CERT-PRIME              PIC X(10).
  7267             20  AI-CL-CERT-SFX                PIC X.
  7268         16  AI-CL-DATE                        PIC X(8).
  7269         16  AI-CL-INCURRED-DATE               PIC XX.
  7270         16  AI-CL-CLOSE-DATE                  PIC XX.
  7271         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7272         16  AI-CREDIT-CARD-NUMBER.
  7273             20  AI-CCN.
  7274                 24  AI-CCN-PREFIX             PIC X(4).
  7275                 24  AI-CCN-PRIME              PIC X(12).
  7276             20  AI-CCN-FILLER                 PIC X(4).
  7277
  7278     12  AI-MAINT-INFO.
  7279         16  AI-LAST-MAINT-BY                  PIC X(4).
  7280         16  AI-LAST-MAINT-DT                  PIC XX.
  7281         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7282
  7283     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7284
  7285     12  FILLER                                PIC X(15).
  7286
  7287
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 130
* EL131.cbl
  7288*                                COPY ERCDMDNT.
  7289******************************************************************
  7290*                                                                *
  7291*                            ERCDMDNT                            *
  7292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7293*                            VMOD=2.005                          *
  7294*                                                                *
  7295*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7296*                                                                *
  7297*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7298*                                                                *
  7299*        FILE TYPE= VSAM,KSDS                                    *
  7300*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7301*                                                                *
  7302*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7303*                                                                *
  7304*        LOG = YES                                               *
  7305*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7306*                                                                *
  7307******************************************************************
  7308
  7309 01  CERTIFICATE-NOTE.
  7310     12  CN-RECORD-ID                     PIC  XX.
  7311         88  VALID-CN-ID                      VALUE 'CN'.
  7312
  7313     12  CN-CONTROL-PRIMARY.
  7314         16  CN-COMPANY-CD                PIC X.
  7315         16  CN-CERT-KEY.
  7316             20  CN-CARRIER               PIC X.
  7317             20  CN-GROUPING.
  7318                 24  CN-GROUPING-PREFIX   PIC XXX.
  7319                 24  CN-GROUPING-PRIME    PIC XXX.
  7320             20  CN-STATE                 PIC XX.
  7321             20  CN-ACCOUNT.
  7322                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7323                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7324             20  CN-CERT-EFF-DT           PIC XX.
  7325             20  CN-CERT-NO.
  7326                 24  CN-CERT-PRIME        PIC X(10).
  7327                 24  CN-CERT-SFX          PIC X.
  7328
  7329     12  CN-BILLING-START-LINE-NO         PIC 99.
  7330     12  CN-BILLING-END-LINE-NO           PIC 99.
  7331
  7332     12  CN-LINES.
  7333         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7334
  7335     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7336         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7337         16  CN-CSI-GENERAL-DATA-AREA.
  7338             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7339
  7340         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7341             CN-CSI-GENERAL-DATA-AREA.
  7342             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7343             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7344             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7345             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 131
* EL131.cbl
  7346             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7347             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7348             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7349             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7350             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7351             20  FILLER                       PIC XX.
  7352             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7353             20  FILLER                       PIC X(38).
  7354
  7355         16  CN-CSI-PRODUCT-DATA-AREA.
  7356             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7357
  7358         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7359             CN-CSI-PRODUCT-DATA-AREA.
  7360             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7361             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7362             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7363             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7364             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7365             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7366             20  FILLER                   PIC XX.
  7367             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7368             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7369             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7370             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7371             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7372             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7373             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7374             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7375             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7376             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7377             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7378             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7379             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7380             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7381             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7382             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7383             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7384             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7385             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7386             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7387             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7388             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7389             20  FILLER                   PIC X(25).
  7390
  7391         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7392             CN-CSI-CREDIT-CARD-DATA.
  7393             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7394             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7395             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7396             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7397             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7398             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7399             20  FILLER                   PIC XX.
  7400             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7401             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7402             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7403             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 132
* EL131.cbl
  7404             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7405             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7406             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7407             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7408             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7409             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7410             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7411             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7412             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7413             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7414             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7415             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7416             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7417             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7418             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7419             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7420             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7421             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7422             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7423             20  FILLER                   PIC X(17).
  7424
  7425         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7426             CN-CSI-FAMILY-LEAVE-DATA.
  7427             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7428             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7429             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7430             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7431             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7432             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7433             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7434             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7435             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7436             20  CN-CSI-SL-INT-ON-PROCEEDS
  7437                                          PIC S9(5)V99  COMP-3.
  7438             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7439             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7440             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7441             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7442             20  CN-CSI-SL-POLICY-BENEFITS
  7443                                          PIC S9(5)V99  COMP-3.
  7444             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7445             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7446             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7447             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7448             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7449             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7450             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7451             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7452             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7453             20  CN-CSI-SL-STATE-NOT      PIC X.
  7454             20  FILLER                   PIC XX.
  7455
  7456         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7457             CN-CSI-SENIOR-LIFE-DATA.
  7458             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7459             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7460             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7461                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 133
* EL131.cbl
  7462             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7463             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7464             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7465             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7466             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7467             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7468             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7469             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7470             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7471             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7472             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7473             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7474             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7475             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7476             20  CN-CSI-PP-REPAIR         PIC X.
  7477             20  CN-CSI-PP-REPLACE        PIC X.
  7478             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7479             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7480             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7481             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7482             20  FILLER                   PIC X(5).
  7483
  7484         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7485             CN-CSI-PURCH-PROP-DATA.
  7486             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7487             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7488             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7489             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7490             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7491             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7492             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7493             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7494             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7495             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7496             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7497             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7498             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7499             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7500             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7501             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7502             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7503             20  CN-CSI-EW-REPLACE        PIC X.
  7504             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7505             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7506             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7507             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7508             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7509             20  FILLER                   PIC X(4).
  7510
  7511     12  CN-LAST-MAINT-DT                 PIC XX.
  7512     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7513     12  CN-LAST-MAINT-USER               PIC X(4).
  7514     12  FILLER                           PIC X(6).
  7515
  7516******************************************************************
  7517
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 134
* EL131.cbl
  7519 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7520                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7521                          CONTROL-FILE ACTIVITY-QUE
  7522                          ACCOUNT-MASTER CHECK-QUE
  7523                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7524                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7525                          CERTIFICATE-NOTE.
  7526 0000-DFHEXIT SECTION.
  7527     MOVE '9#                    $   ' TO DFHEIV0.
  7528     MOVE 'EL131' TO DFHEIV1.
  7529     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7530
  7531     IF EIBCALEN = ZERO
  7532         GO TO 8800-UNAUTHORIZED-ACCESS.
  7533
  7534     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7535     MOVE '5'                    TO DC-OPTION-CODE.
  7536     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7537     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7538     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7539     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7540
  7541     IF SAVE-DATE-YY GREATER 70
  7542         MOVE 19                 TO SAVE-DATE-CC
  7543      ELSE
  7544         MOVE 20                 TO SAVE-DATE-CC.
  7545
  7546
  7547* EXEC CICS HANDLE CONDITION
  7548*        PGMIDERR (8820-XCTL-ERROR)
  7549*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7550*        ERROR    (9990-ABEND)
  7551*    END-EXEC.
  7552*    MOVE '"$LI.                 ! " #00007542' TO DFHEIV0
  7553     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7555     MOVE X'2220233030303037353432' TO DFHEIV0(25:11)
  7556     CALL 'kxdfhei1' USING DFHEIV0
  7557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7558
  7559
  7560     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7561     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7562     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7563
  7564     INITIALIZE    EDIT-WORK-AREA.
  7565     MOVE '/'                    TO WORK-SLASH.
  7566     MOVE SPACES                 TO ERROR-SWITCHES.
  7567
  7568     MOVE TRAN-ID                TO TRANS-ID.
  7569     MOVE EIBTRMID               TO PI-TERM.
  7570     MOVE MAP-ID                 TO PI-QUAL.
  7571
  7572     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7573
  7574     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7575         MOVE LOW-VALUES         TO EL131AO
  7576         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 135
* EL131.cbl
  7577         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7578         MOVE -1                 TO MAINTL
  7579         GO TO 8110-SEND-DATA.
  7580
  7581     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7582         MOVE LOW-VALUES         TO EL131AO
  7583         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7584         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7585         MOVE 'X'                TO PI-RETURN-CD-1
  7586         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7587         MOVE -1                 TO MAINTL
  7588         IF WS-RETURNED-FROM = XCTL-EL114
  7589             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7590         END-IF
  7591         GO TO 8100-SEND-MAP.
  7592
  7593     IF EIBAID = DFHCLEAR
  7594         GO TO 8200-RETURN-PRIOR.
  7595
  7596     IF PI-PROCESSOR-ID = 'LGXX'
  7597         NEXT SENTENCE
  7598     ELSE
  7599
  7600* EXEC CICS READQ TS
  7601*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7602*            INTO    (SECURITY-CONTROL)
  7603*            LENGTH  (SC-COMM-LENGTH)
  7604*            ITEM    (SC-ITEM)
  7605*        END-EXEC
  7606*    MOVE '*$II   L              ''   #00007587' TO DFHEIV0
  7607     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7608     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7609     MOVE X'2020233030303037353837' TO DFHEIV0(25:11)
  7610     CALL 'kxdfhei1' USING DFHEIV0,
  7611           PI-SECURITY-TEMP-STORE-ID,
  7612           SECURITY-CONTROL,
  7613           SC-COMM-LENGTH,
  7614           SC-ITEM,
  7615           DFHEIV99,
  7616           DFHEIV99
  7617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7618         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7619         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7620         IF NOT DISPLAY-CAP
  7621             MOVE 'READ'               TO  SM-READ
  7622             PERFORM 9995-SECURITY-VIOLATION
  7623             MOVE ER-0070              TO  EMI-ERROR
  7624             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7625             GO TO 8100-SEND-MAP.
  7626
  7627
  7628* EXEC CICS RECEIVE
  7629*        MAP    ('EL131A')
  7630*        MAPSET ('EL131S')
  7631*    END-EXEC.
  7632     MOVE 'EL131A' TO DFHEIV1
  7633     MOVE 'EL131S' TO DFHEIV2
  7634*    MOVE '8"T                   ''   #00007602' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 136
* EL131.cbl
  7635     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7637     MOVE X'2020233030303037363032' TO DFHEIV0(25:11)
  7638     CALL 'kxdfhei1' USING DFHEIV0,
  7639           DFHEIV1,
  7640           EL131AI,
  7641           DFHEIV99,
  7642           DFHEIV2,
  7643           DFHEIV99,
  7644           DFHEIV99
  7645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7646
  7647
  7648     IF PFKEYL GREATER THAN ZERO
  7649         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7650
  7651     IF SCREEN-ERROR
  7652         MOVE ER-0004 TO EMI-ERROR
  7653         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7654         MOVE -1 TO MAINTL
  7655         GO TO 8110-SEND-DATA.
  7656
  7657     IF EIBAID = DFHPF3
  7658         GO TO 8500-TRLR-MNT.
  7659
  7660     IF EIBAID = DFHPF4
  7661         GO TO 8600-ADDR-MNT.
  7662
  7663     IF EIBAID = DFHPF5
  7664         GO TO 8700-CERT-MNT.
  7665
  7666     IF PI-COMPANY-ID = 'DMD'
  7667       IF EIBAID = DFHPF6
  7668         GO TO 8750-DMD-CLM-FIX.
  7669
  7670     IF EIBAID = DFHPF7
  7671         GO TO 4000-FORCE-ERRORS.
  7672
  7673     IF EIBAID = DFHPF12
  7674         GO TO 8300-GET-HELP.
  7675
  7676     IF EIBAID = DFHPF15
  7677         GO TO 8725-BENEFICIARY-MNT
  7678     END-IF.
  7679
  7680     IF EIBAID = DFHPF23
  7681         GO TO 8810-PF23-ENTERED.
  7682
  7683     IF EIBAID = DFHPF24
  7684         GO TO 8400-RETURN-MASTER.
  7685
  7686     IF EIBAID NOT = DFHENTER
  7687         MOVE ER-0029            TO EMI-ERROR
  7688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7689         MOVE -1                 TO MAINTL
  7690         GO TO 8110-SEND-DATA.
  7691
  7692     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 137
* EL131.cbl
  7693         MOVE ER-0311            TO EMI-ERROR
  7694         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7695         MOVE -1                 TO MAINTL
  7696         GO TO 8110-SEND-DATA.
  7697
  7698     IF MAINTI = 'A'
  7699         GO TO 0500-ADD-ALPHA-ONLY.
  7700
  7701     IF MAINTI = 'N'
  7702         GO TO 0600-CHANGE-NAME.
  7703
  7704     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7705     PERFORM 1030-EDIT-NAME THRU 1030-EXIT.
  7706
  7707     IF SCREEN-ERROR
  7708         GO TO 8110-SEND-DATA.
  7709
  7710     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7711         MOVE ER-0276            TO EMI-ERROR
  7712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7713         MOVE -1                 TO MAINTL
  7714         GO TO 8110-SEND-DATA.
  7715
  7716     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7717
  7718     IF SCREEN-ERROR
  7719         GO TO 8110-SEND-DATA.
  7720
  7721     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7722
  7723     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7724
  7725     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7726         GO TO 8110-SEND-DATA.
  7727
  7728     IF EMI-FATAL-CTR GREATER THAN ZERO
  7729         GO TO 8110-SEND-DATA.
  7730
  7731     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7732
  7733     IF WS-OPEN-CLOSE-SW = 'Y'
  7734         IF PI-LETTER-SW = 'Y'
  7735             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7736             MOVE 'T'            TO  CNTL-REC-TYPE
  7737             MOVE SPACES         TO  CNTL-PROC-ID
  7738             MOVE +0             TO  CNTL-SEQ-NO
  7739
  7740* EXEC CICS READ
  7741*                DATASET   (CNTL-FILE-ID)
  7742*                RIDFLD    (CNTL-KEY)
  7743*                SET       (ADDRESS OF CONTROL-FILE)
  7744*            END-EXEC
  7745*    MOVE '&"S        E          (   #00007698' TO DFHEIV0
  7746     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7748     MOVE X'2020233030303037363938' TO DFHEIV0(25:11)
  7749     CALL 'kxdfhei1' USING DFHEIV0,
  7750           CNTL-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 138
* EL131.cbl
  7751           DFHEIV20,
  7752           DFHEIV99,
  7753           CNTL-KEY,
  7754           DFHEIV99,
  7755           DFHEIV99,
  7756           DFHEIV99
  7757     SET ADDRESS OF CONTROL-FILE TO
  7758         DFHEIV20
  7759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7760             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7761
  7762     MOVE ER-0000                TO EMI-ERROR.
  7763     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7764
  7765     MOVE SPACE                  TO MAINTO.
  7766     MOVE -1                     TO MAINTL.
  7767     GO TO 8100-SEND-MAP.
  7768
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 139
* EL131.cbl
  7770 0100-UPDATE-PI.
  7771
  7772     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7773     IF WS-RETURNED-FROM = XCTL-EL114
  7774***sometimes there is crap in positions 7-10 when no code was sele
  7775        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7776          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7777        END-IF
  7778     END-IF.
  7779
  7780     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7781         GO TO 0110-UPDATE-UP.
  7782
  7783     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7784     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7785     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7786     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7787     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7788     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7789     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7790     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7791     GO TO 0120-UPDATE-PI-EXIT.
  7792
  7793 0110-UPDATE-UP.
  7794     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7795     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7796     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7797     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7798     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7799     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7800     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7801     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7802
  7803
  7804* EXEC CICS HANDLE CONDITION
  7805*         QIDERR    (0130-TS-ERROR)
  7806*         ITEMERR   (0130-TS-ERROR)
  7807*    END-EXEC.
  7808*    MOVE '"$N<                  ! # #00007746' TO DFHEIV0
  7809     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7811     MOVE X'2320233030303037373436' TO DFHEIV0(25:11)
  7812     CALL 'kxdfhei1' USING DFHEIV0
  7813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7814
  7815
  7816     IF WS-RETURNED-FROM = XCTL-EL114
  7817
  7818* EXEC CICS READQ TS
  7819*            QUEUE    (PI-KEY)
  7820*            INTO     (EL131AI)
  7821*            LENGTH   (MAP-LENGTH)
  7822*       END-EXEC
  7823*    MOVE '*$I    L              ''   #00007752' TO DFHEIV0
  7824     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7825     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7826     MOVE X'2020233030303037373532' TO DFHEIV0(25:11)
  7827     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 140
* EL131.cbl
  7828           PI-KEY,
  7829           EL131AI,
  7830           MAP-LENGTH,
  7831           DFHEIV99,
  7832           DFHEIV99,
  7833           DFHEIV99
  7834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7835
  7836        IF WS-SAVE-BENEFICIARY > SPACES
  7837            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7838            MOVE +10            TO BENEL
  7839            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7840        END-IF
  7841        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7842     END-IF.
  7843
  7844
  7845* EXEC CICS READQ TS
  7846*         QUEUE    (PI-KEY)
  7847*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7848*         LENGTH   (PI-COMM-LENGTH)
  7849*    END-EXEC.
  7850*    MOVE '*$I    L              ''   #00007766' TO DFHEIV0
  7851     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7852     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7853     MOVE X'2020233030303037373636' TO DFHEIV0(25:11)
  7854     CALL 'kxdfhei1' USING DFHEIV0,
  7855           PI-KEY,
  7856           PROGRAM-INTERFACE-BLOCK,
  7857           PI-COMM-LENGTH,
  7858           DFHEIV99,
  7859           DFHEIV99,
  7860           DFHEIV99
  7861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7862
  7863
  7864
  7865* EXEC CICS DELETEQ TS
  7866*         QUEUE    (PI-KEY)
  7867*    END-EXEC.
  7868*    MOVE '*&                    #   #00007772' TO DFHEIV0
  7869     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7870     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7871     MOVE X'2020233030303037373732' TO DFHEIV0(25:11)
  7872     CALL 'kxdfhei1' USING DFHEIV0,
  7873           PI-KEY,
  7874           DFHEIV99
  7875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7876
  7877
  7878 0120-UPDATE-PI-EXIT.
  7879     EXIT.
  7880
  7881 0130-TS-ERROR.
  7882     MOVE LOW-VALUES             TO EL131AO.
  7883     MOVE ER-0192                TO EMI-ERROR.
  7884
  7885     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 141
* EL131.cbl
  7886
  7887     GO TO 8100-SEND-MAP.
  7888
  7889 0200-TRANS-PF.
  7890     IF EIBAID NOT = DFHENTER
  7891         MOVE 'X'                TO ERROR-SWITCH
  7892         GO TO 0210-EXIT.
  7893
  7894     IF PFKEYI NOT NUMERIC
  7895         MOVE 'X'                TO ERROR-SWITCH
  7896         GO TO 0210-EXIT.
  7897
  7898     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7899
  7900     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7901         MOVE 'X' TO ERROR-SWITCH
  7902         GO TO 0210-EXIT.
  7903
  7904     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7905
  7906 0210-EXIT.
  7907     EXIT.
  7908
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 142
* EL131.cbl
  7910 0500-ADD-ALPHA-ONLY.
  7911******************************************************************
  7912*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7913*    RECORD.                                                     *
  7914******************************************************************
  7915
  7916     IF MLNAMEL = +0 AND
  7917        MFNAMEL = +0 AND
  7918        MMINITL = +0
  7919         MOVE ER-0797                TO  EMI-ERROR
  7920         MOVE -1                     TO  MAINTL
  7921         MOVE AL-UABON               TO  MAINTA
  7922         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7923         GO TO 8110-SEND-DATA.
  7924
  7925     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7926     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7927     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7928     MOVE PI-CERT-NO                 TO  CERT-NO.
  7929
  7930
  7931* EXEC CICS READ
  7932*        DATASET   (CLMS-FILE-ID)
  7933*        RIDFLD    (MSTR-KEY)
  7934*        SET       (ADDRESS OF CLAIM-MASTER)
  7935*    END-EXEC.
  7936*    MOVE '&"S        E          (   #00007828' TO DFHEIV0
  7937     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7938     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7939     MOVE X'2020233030303037383238' TO DFHEIV0(25:11)
  7940     CALL 'kxdfhei1' USING DFHEIV0,
  7941           CLMS-FILE-ID,
  7942           DFHEIV20,
  7943           DFHEIV99,
  7944           MSTR-KEY,
  7945           DFHEIV99,
  7946           DFHEIV99,
  7947           DFHEIV99
  7948     SET ADDRESS OF CLAIM-MASTER TO
  7949         DFHEIV20
  7950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7951
  7952
  7953
  7954* EXEC CICS GETMAIN
  7955*        SET       (ADDRESS OF ALPHA-INDEX)
  7956*        LENGTH    (ALPH-LENGTH)
  7957*        INITIMG   (GETMAIN-SPACE)
  7958*    END-EXEC.
  7959*    MOVE ',"IL                  $   #00007834' TO DFHEIV0
  7960     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7961     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7962     MOVE X'2020233030303037383334' TO DFHEIV0(25:11)
  7963     CALL 'kxdfhei1' USING DFHEIV0,
  7964           DFHEIV20,
  7965           ALPH-LENGTH,
  7966           GETMAIN-SPACE
  7967     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 143
* EL131.cbl
  7968         DFHEIV20
  7969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7970
  7971
  7972     MOVE 'AI'                       TO  AI-RECORD-ID.
  7973     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7974                                         AI-CL-COMPANY-CD.
  7975     MOVE 'C'                        TO  AI-SOURCE
  7976                                         AI-CL-SOURCE.
  7977
  7978     IF MLNAMEL IS GREATER THAN +0
  7979         MOVE MLNAMEI                TO  AI-LAST-NAME
  7980     ELSE
  7981         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7982
  7983     IF MFNAMEL IS GREATER THAN +0
  7984         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7985     ELSE
  7986         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7987
  7988     IF MMINITL IS GREATER THAN +0
  7989         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7990     ELSE
  7991         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7992
  7993     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7994     MOVE '5'                        TO  DC-OPTION-CODE.
  7995     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7996     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7997     IF BUILD-YEAR IS GREATER THAN 50
  7998         MOVE '19'                   TO  WS-ALPHA-YY-1
  7999         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8000         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8001         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8002     ELSE
  8003         MOVE '20'                   TO  WS-ALPHA-YY-1
  8004         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8005         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8006         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8007
  8008     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8009                                         AI-CL-DATE.
  8010
  8011     MOVE EIBTIME                    TO  AI-TIME
  8012                                         AI-CL-TIME.
  8013
  8014     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8015     MOVE 'C'                        TO  AI-CL-SOURCE.
  8016     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8017     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8018     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8019     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8020     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8021
  8022     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8023     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8024     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8025
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 144
* EL131.cbl
  8026
  8027* EXEC CICS WRITE
  8028*        DATASET   (ALPH-FILE-ID)
  8029*        RIDFLD    (AI-CONTROL-PRIMARY)
  8030*        FROM      (ALPHA-INDEX)
  8031*    END-EXEC.
  8032     MOVE LENGTH OF
  8033      ALPHA-INDEX
  8034       TO DFHEIV11
  8035*    MOVE '&$ L                  ''   #00007894' TO DFHEIV0
  8036     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8037     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8038     MOVE X'2020233030303037383934' TO DFHEIV0(25:11)
  8039     CALL 'kxdfhei1' USING DFHEIV0,
  8040           ALPH-FILE-ID,
  8041           ALPHA-INDEX,
  8042           DFHEIV11,
  8043           AI-CONTROL-PRIMARY,
  8044           DFHEIV99,
  8045           DFHEIV99
  8046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8047
  8048
  8049     MOVE LOW-VALUES                 TO  EL131AO.
  8050     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8051     MOVE ER-0000                    TO  EMI-ERROR.
  8052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8053     MOVE -1                         TO  MAINTL.
  8054     GO TO 8100-SEND-MAP.
  8055
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 145
* EL131.cbl
  8057 0600-CHANGE-NAME.
  8058******************************************************************
  8059*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8060*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8061******************************************************************
  8062
  8063     IF MLNAMEL = +0 AND
  8064        MFNAMEL = +0 AND
  8065        MMINITL = +0
  8066         MOVE ER-0276                TO  EMI-ERROR
  8067         MOVE -1                     TO  MAINTL
  8068         MOVE AL-UABON               TO  MAINTA
  8069         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8070         GO TO 8110-SEND-DATA.
  8071
  8072     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8073     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8074     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8075     MOVE PI-CERT-NO                 TO  CERT-NO.
  8076
  8077
  8078* EXEC CICS READ
  8079*        DATASET   (CLMS-FILE-ID)
  8080*        RIDFLD    (MSTR-KEY)
  8081*        SET       (ADDRESS OF CLAIM-MASTER)
  8082*    END-EXEC.
  8083*    MOVE '&"S        E          (   #00007928' TO DFHEIV0
  8084     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8085     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8086     MOVE X'2020233030303037393238' TO DFHEIV0(25:11)
  8087     CALL 'kxdfhei1' USING DFHEIV0,
  8088           CLMS-FILE-ID,
  8089           DFHEIV20,
  8090           DFHEIV99,
  8091           MSTR-KEY,
  8092           DFHEIV99,
  8093           DFHEIV99,
  8094           DFHEIV99
  8095     SET ADDRESS OF CLAIM-MASTER TO
  8096         DFHEIV20
  8097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8098
  8099
  8100
  8101* EXEC CICS GETMAIN
  8102*        SET       (ADDRESS OF ALPHA-INDEX)
  8103*        LENGTH    (ALPH-LENGTH)
  8104*        INITIMG   (GETMAIN-SPACE)
  8105*    END-EXEC.
  8106*    MOVE ',"IL                  $   #00007934' TO DFHEIV0
  8107     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8108     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8109     MOVE X'2020233030303037393334' TO DFHEIV0(25:11)
  8110     CALL 'kxdfhei1' USING DFHEIV0,
  8111           DFHEIV20,
  8112           ALPH-LENGTH,
  8113           GETMAIN-SPACE
  8114     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 146
* EL131.cbl
  8115         DFHEIV20
  8116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8117
  8118
  8119     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  8120     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  8121     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  8122     MOVE CL-CERT-STATE          TO CERT-STATE
  8123     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  8124     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  8125     MOVE CL-CERT-NO             TO CERT-CERT
  8126
  8127
  8128* EXEC CICS READ
  8129*       DATASET   (CERT-FILE-ID)
  8130*       RIDFLD    (CERT-KEY)
  8131*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  8132*       RESP      (WS-RESPONSE)
  8133*    END-EXEC
  8134*    MOVE '&"S        E          (  N#00007948' TO DFHEIV0
  8135     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8137     MOVE X'204E233030303037393438' TO DFHEIV0(25:11)
  8138     CALL 'kxdfhei1' USING DFHEIV0,
  8139           CERT-FILE-ID,
  8140           DFHEIV20,
  8141           DFHEIV99,
  8142           CERT-KEY,
  8143           DFHEIV99,
  8144           DFHEIV99,
  8145           DFHEIV99
  8146     SET ADDRESS OF CERTIFICATE-MASTER TO
  8147         DFHEIV20
  8148     MOVE EIBRESP  TO WS-RESPONSE
  8149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8150
  8151     IF INSTYPEL > ZEROS
  8152        MOVE INSTYPEI TO CL-INSURED-TYPE
  8153     END-IF
  8154
  8155     IF MFNAMEL > +0
  8156        IF CL-INSURED-TYPE = 'C'
  8157          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  8158           MOVE ER-1675             TO EMI-ERROR
  8159           MOVE -1                  TO MFNAMEL
  8160           MOVE AL-UABON            TO MFNAMEA
  8161           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8162           GO TO 8110-SEND-DATA
  8163        ELSE
  8164          IF CL-INSURED-TYPE = 'P'
  8165            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  8166             MOVE ER-1676             TO EMI-ERROR
  8167             MOVE -1                  TO MFNAMEL
  8168             MOVE AL-UABON            TO MFNAMEA
  8169             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8170             GO TO 8110-SEND-DATA
  8171          END-IF
  8172        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 147
* EL131.cbl
  8173     END-IF
  8174     MOVE 'AI'                       TO  AI-RECORD-ID.
  8175     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8176                                         AI-CL-COMPANY-CD.
  8177     MOVE 'C'                        TO  AI-SOURCE
  8178                                         AI-CL-SOURCE.
  8179
  8180     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8181     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8182     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8183
  8184     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8185     MOVE '5'                        TO  DC-OPTION-CODE.
  8186     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8187     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8188     IF BUILD-YEAR IS GREATER THAN 50
  8189         MOVE '19'                   TO  WS-ALPHA-YY-1
  8190         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8191         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8192         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8193     ELSE
  8194         MOVE '20'                   TO  WS-ALPHA-YY-1
  8195         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8196         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8197         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8198
  8199     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8200                                         AI-CL-DATE.
  8201
  8202     MOVE EIBTIME                    TO  AI-TIME
  8203                                         AI-CL-TIME.
  8204
  8205     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8206     MOVE 'C'                        TO  AI-CL-SOURCE.
  8207     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8208     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8209     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8210     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8211     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8212
  8213     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8214     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8215     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8216
  8217     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8218         MOVE 'Y'                TO CL-YESNOSW
  8219     END-IF.
  8220
  8221
  8222* EXEC CICS WRITE
  8223*        DATASET   (ALPH-FILE-ID)
  8224*        RIDFLD    (AI-CONTROL-PRIMARY)
  8225*        FROM      (ALPHA-INDEX)
  8226*    END-EXEC.
  8227     MOVE LENGTH OF
  8228      ALPHA-INDEX
  8229       TO DFHEIV11
  8230*    MOVE '&$ L                  ''   #00008025' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 148
* EL131.cbl
  8231     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8233     MOVE X'2020233030303038303235' TO DFHEIV0(25:11)
  8234     CALL 'kxdfhei1' USING DFHEIV0,
  8235           ALPH-FILE-ID,
  8236           ALPHA-INDEX,
  8237           DFHEIV11,
  8238           AI-CONTROL-PRIMARY,
  8239           DFHEIV99,
  8240           DFHEIV99
  8241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8242
  8243
  8244
  8245* EXEC CICS READ
  8246*        DATASET   (CLMS-FILE-ID)
  8247*        RIDFLD    (MSTR-KEY)
  8248*        SET       (ADDRESS OF CLAIM-MASTER)
  8249*        UPDATE
  8250*    END-EXEC.
  8251*    MOVE '&"S        EU         (   #00008031' TO DFHEIV0
  8252     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8253     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8254     MOVE X'2020233030303038303331' TO DFHEIV0(25:11)
  8255     CALL 'kxdfhei1' USING DFHEIV0,
  8256           CLMS-FILE-ID,
  8257           DFHEIV20,
  8258           DFHEIV99,
  8259           MSTR-KEY,
  8260           DFHEIV99,
  8261           DFHEIV99,
  8262           DFHEIV99
  8263     SET ADDRESS OF CLAIM-MASTER TO
  8264         DFHEIV20
  8265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8266
  8267
  8268     if (cl-priority-cd = '8')
  8269        and (pi-processor-id not = 'PEMA'and 'JMS '
  8270             AND 'AMWA' AND 'KMSB')
  8271        MOVE ER-8003             TO EMI-ERROR
  8272        PERFORM 9900-ERROR-FORMAT
  8273                                 THRU 9900-EXIT
  8274        MOVE -1                  TO MAINTL
  8275        GO TO 8110-SEND-DATA
  8276     end-if
  8277
  8278     IF MLNAMEL IS GREATER THAN +0
  8279         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8280
  8281     IF MFNAMEL IS GREATER THAN +0
  8282         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8283
  8284     IF MMINITL IS GREATER THAN +0
  8285         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
  8286
  8287     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8288     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 149
* EL131.cbl
  8289     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8290     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8291
  8292     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8293         MOVE 'Y'                TO CL-YESNOSW
  8294     END-IF.
  8295
  8296
  8297* EXEC CICS HANDLE CONDITION
  8298*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8299*    END-EXEC.
  8300*    MOVE '"$$                   ! $ #00008066' TO DFHEIV0
  8301     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8303     MOVE X'2420233030303038303636' TO DFHEIV0(25:11)
  8304     CALL 'kxdfhei1' USING DFHEIV0
  8305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8306
  8307
  8308
  8309* EXEC CICS REWRITE
  8310*        DATASET   (CLMS-FILE-ID)
  8311*        FROM      (CLAIM-MASTER)
  8312*    END-EXEC.
  8313     MOVE LENGTH OF
  8314      CLAIM-MASTER
  8315       TO DFHEIV11
  8316*    MOVE '&& L                  %   #00008070' TO DFHEIV0
  8317     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8318     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8319     MOVE X'2020233030303038303730' TO DFHEIV0(25:11)
  8320     CALL 'kxdfhei1' USING DFHEIV0,
  8321           CLMS-FILE-ID,
  8322           CLAIM-MASTER,
  8323           DFHEIV11,
  8324           DFHEIV99
  8325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8326
  8327
  8328 0600-CONTINUE-NAME-UPDATE.
  8329
  8330     MOVE LOW-VALUES                 TO  EL131AO.
  8331     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8332     MOVE ER-0000                    TO  EMI-ERROR.
  8333     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8334     MOVE -1                         TO  MAINTL.
  8335     GO TO 8100-SEND-MAP.
  8336
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 150
* EL131.cbl
  8338 1000-EDIT-SCREEN.
  8339
  8340     MOVE MAINTI                 TO CHECK-MAINT.
  8341
  8342     IF NOT VALID-OPTIONS
  8343         MOVE 'X'                TO ERROR-SWITCH
  8344         MOVE -1                 TO MAINTL
  8345         MOVE AL-UABON           TO MAINTA
  8346         MOVE ER-0023            TO EMI-ERROR
  8347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8348         GO TO 1010-EXIT.
  8349
  8350     IF NOT MODIFY-CAP
  8351         MOVE 'UPDATE'           TO  SM-READ
  8352         PERFORM 9995-SECURITY-VIOLATION
  8353         MOVE ER-0070               TO  EMI-ERROR
  8354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8355         GO TO 8100-SEND-MAP.
  8356
  8357     IF DELETE-CLAIM
  8358         MOVE AL-UANON TO MAINTA
  8359         GO TO 1010-EXIT.
  8360
  8361     MOVE AL-UANON               TO MAINTA.
  8362
  8363     IF CCNOI GREATER THAN LOW-VALUES
  8364         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8365
  8366     IF PI-COMPANY-ID = 'CSL'
  8367        CONTINUE
  8368     ELSE
  8369        IF TYPEL > ZERO
  8370           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8371              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8372                    PI-LIFE-OVERRIDE-L1 OR 'O'))
  8373                       OR
  8374              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8375              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8376                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F' OR 'O'))
  8377              MOVE AL-UANON      TO TYPEA
  8378              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8379           ELSE
  8380              MOVE ER-0199       TO EMI-ERROR
  8381              PERFORM 9900-ERROR-FORMAT
  8382                                 THRU 9900-EXIT
  8383              MOVE AL-UABON      TO TYPEA
  8384              MOVE -1            TO TYPEL
  8385              MOVE 'X'           TO ERROR-SWITCH
  8386           END-IF
  8387        ELSE
  8388           MOVE AL-UANOF         TO TYPEA
  8389        END-IF
  8390     END-IF
  8391     IF STATUSI GREATER THAN LOW-VALUES
  8392         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8393             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8394             MOVE AL-UANON       TO STATUSA
  8395             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 151
* EL131.cbl
  8396             MOVE 'Y'            TO DLYACTV-SW
  8397         ELSE
  8398             MOVE ER-0333        TO EMI-ERROR
  8399             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8400             MOVE AL-UABON       TO STATUSA
  8401             MOVE -1             TO STATUSL
  8402             MOVE 'X'            TO ERROR-SWITCH
  8403         END-IF
  8404     ELSE
  8405         MOVE SPACE              TO TRLR-SWITCH
  8406         MOVE 'N'                TO DLYACTV-SW
  8407         MOVE AL-UANOF           TO STATUSA.
  8408
  8409     IF PROCI GREATER THAN LOW-VALUES
  8410         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8411     ELSE
  8412         MOVE AL-UANOF TO PROCA.
  8413
  8414     IF SEXI GREATER THAN LOW-VALUES
  8415         IF SEXI = 'F' OR 'M'
  8416             MOVE AL-UANON       TO SEXA
  8417             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8418           ELSE
  8419             MOVE ER-0219        TO EMI-ERROR
  8420             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8421             MOVE AL-UABON       TO SEXA
  8422             MOVE -1             TO SEXL
  8423             MOVE 'X'            TO ERROR-SWITCH
  8424       ELSE
  8425         MOVE AL-UANOF           TO SEXA.
  8426
  8427     IF BIRTHL = +0
  8428         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8429         MOVE AL-UANOF           TO  BIRTHA
  8430         GO TO 1000-CONTINUE-EDITS.
  8431
  8432     IF BIRTHI = SPACES
  8433         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8434         MOVE 'X'                TO  UPDATE-SWITCH
  8435                                     MSTR-SWITCH
  8436         GO TO 1000-CONTINUE-EDITS.
  8437
  8438     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8439     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8440     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8441     MOVE '4'                    TO  DC-OPTION-CODE.
  8442     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8443     IF DATE-CONVERSION-ERROR
  8444         MOVE ER-0220            TO  EMI-ERROR
  8445         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8446         MOVE AL-UABON           TO  BIRTHA
  8447         MOVE -1                 TO  BIRTHL
  8448         MOVE 'X'                TO  ERROR-SWITCH
  8449         GO TO 1000-CONTINUE-EDITS.
  8450
  8451******************************************************************
  8452**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8453**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 152
* EL131.cbl
  8454**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8455******************************************************************
  8456     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8457         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8458         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8459         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8460         MOVE '4'                TO  DC-OPTION-CODE
  8461         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8462         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8463                                     DC-ELAPSED-DAYS
  8464         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8465         IF DATE-CONVERSION-ERROR
  8466             MOVE ER-0220        TO  EMI-ERROR
  8467             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8468             MOVE AL-UABON       TO  BIRTHA
  8469             MOVE -1             TO  BIRTHL
  8470             MOVE 'X'            TO  ERROR-SWITCH
  8471             GO TO 1000-CONTINUE-EDITS.
  8472
  8473     MOVE AL-UANON               TO  BIRTHA.
  8474     MOVE 'X'                    TO  UPDATE-SWITCH
  8475                                     MSTR-SWITCH.
  8476     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8477     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8478     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8479
  8480 1000-CONTINUE-EDITS.
  8481
  8482     IF SOCIALI GREATER THAN LOW-VALUES
  8483         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8484         IF WS-SOC-SEC-NO NUMERIC AND
  8485           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8486             NEXT SENTENCE
  8487         ELSE
  8488            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8489               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8490               WS-SSN-DASH2 = '-'
  8491                 NEXT SENTENCE
  8492            ELSE
  8493                 MOVE ER-0887        TO  EMI-ERROR
  8494                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8495                 MOVE AL-UABON       TO  SOCIALA
  8496                 MOVE -1             TO  SOCIALL
  8497                 MOVE 'X'            TO  ERROR-SWITCH
  8498            END-IF
  8499        END-IF
  8500     END-IF.
  8501     if critpl > zeros
  8502        and critpi numeric
  8503        move al-uanon            to critpa
  8504        move 'X'                 to update-switch
  8505     end-if
  8506     IF SOCIALI GREATER THAN LOW-VALUES
  8507         MOVE AL-UANON           TO SOCIALA
  8508         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8509     ELSE
  8510         MOVE AL-UANOF           TO SOCIALA.
  8511
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 153
* EL131.cbl
  8512     IF OCCI GREATER THAN LOW-VALUES
  8513         MOVE AL-UANON           TO OCCA
  8514         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8515     ELSE
  8516         MOVE AL-UANOF           TO OCCA.
  8517
  8518     IF BENEL NOT GREATER THAN ZERO
  8519            GO TO 1005-CONTINUE-EDITS.
  8520
  8521     IF BENEI = SPACES
  8522        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8523           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8524           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8525           IF AUTO-PAY-TO-BENE = 'Y'
  8526               MOVE ER-1773      TO  EMI-ERROR
  8527               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8528               MOVE 'X'          TO ERROR-SWITCH
  8529               MOVE AL-UABON     TO BENEA
  8530               MOVE -1           TO BENEL
  8531           ELSE
  8532               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8533           END-IF
  8534        ELSE
  8535           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8536           IF PAYMENT-PENDING
  8537               MOVE ER-1772      TO  EMI-ERROR
  8538               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8539               MOVE 'X'          TO ERROR-SWITCH
  8540               MOVE AL-UABON     TO BENEA
  8541               MOVE -1           TO BENEL
  8542           END-IF
  8543           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8544        END-IF
  8545        GO TO 1005-CONTINUE-EDITS.
  8546
  8547
  8548* EXEC CICS HANDLE CONDITION
  8549*        NOTFND (1004-BENE-NOT-FOUND)
  8550*    END-EXEC.
  8551*    MOVE '"$I                   ! % #00008294' TO DFHEIV0
  8552     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8554     MOVE X'2520233030303038323934' TO DFHEIV0(25:11)
  8555     CALL 'kxdfhei1' USING DFHEIV0
  8556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8557
  8558
  8559     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8560     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8561     MOVE BENEI                  TO  WS-ELBENE-ID.
  8562
  8563
  8564* EXEC CICS READ
  8565*        DATASET ('ELBENE')
  8566*        RIDFLD  (WS-ELBENE-KEY)
  8567*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8568*    END-EXEC.
  8569     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 154
* EL131.cbl
  8570*    MOVE '&"S        E          (   #00008302' TO DFHEIV0
  8571     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8573     MOVE X'2020233030303038333032' TO DFHEIV0(25:11)
  8574     CALL 'kxdfhei1' USING DFHEIV0,
  8575           DFHEIV1,
  8576           DFHEIV20,
  8577           DFHEIV99,
  8578           WS-ELBENE-KEY,
  8579           DFHEIV99,
  8580           DFHEIV99,
  8581           DFHEIV99
  8582     SET ADDRESS OF BENEFICIARY-MASTER TO
  8583         DFHEIV20
  8584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8585
  8586
  8587     MOVE AL-UANON               TO  BENEA.
  8588     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8589
  8590     GO TO 1005-CONTINUE-EDITS.
  8591
  8592 1004-BENE-NOT-FOUND.
  8593     MOVE ER-0565                TO  EMI-ERROR.
  8594
  8595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8596     MOVE 'X'                    TO ERROR-SWITCH.
  8597     MOVE AL-UABON               TO BENEA.
  8598     MOVE -1                     TO BENEL.
  8599
  8600 1005-CONTINUE-EDITS.
  8601
  8602     IF DIAGI GREATER THAN LOW-VALUES
  8603         MOVE AL-UANON           TO DIAGA
  8604         MOVE 'X'                TO UPDATE-SWITCH
  8605                                    NINETY-TRLR-SWITCH
  8606     ELSE
  8607         MOVE AL-UANOF           TO DIAGA.
  8608
  8609     IF ICD1I GREATER THAN LOW-VALUES
  8610         IF (ICD1I GREATER THAN SPACES) AND
  8611            (ICD1I(4:1) NOT = '.')
  8612             IF ICD1I(4:1) = ' '
  8613                 MOVE '.' TO ICD1I(4:1)
  8614             ELSE
  8615                 IF ICD1I(8:1) = ' '
  8616                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8617                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8618                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8619                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8620                     MOVE '.'        TO ICD1I(4:1)
  8621                 END-IF
  8622             END-IF
  8623         END-IF
  8624         IF (ICD1I GREATER THAN SPACES) AND
  8625            (ICD1I(1:1) NOT > ' ' OR
  8626             ICD1I(2:1) NOT > ' ' OR
  8627             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 155
* EL131.cbl
  8628             ICD1I(4:1) NOT = '.')
  8629              MOVE ER-0992        TO  EMI-ERROR
  8630              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8631              MOVE 'X'            TO ERROR-SWITCH
  8632              MOVE AL-UABON       TO ICD1A
  8633              MOVE -1             TO ICD1L
  8634         ELSE
  8635             MOVE AL-UANON       TO ICD1A
  8636             MOVE 'X'            TO UPDATE-SWITCH
  8637                                    NINETY-TRLR-SWITCH
  8638         END-IF
  8639     ELSE
  8640         MOVE AL-UANOF           TO ICD1A
  8641     END-IF.
  8642
  8643     IF ICD2I GREATER THAN LOW-VALUES
  8644         IF (ICD2I GREATER THAN SPACES) AND
  8645            (ICD2I(4:1) NOT = '.')
  8646             IF ICD2I(4:1) = ' '
  8647                 MOVE '.' TO ICD2I(4:1)
  8648             ELSE
  8649                 IF ICD2I(8:1) = ' '
  8650                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8651                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8652                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8653                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8654                     MOVE '.'        TO ICD2I(4:1)
  8655                 END-IF
  8656             END-IF
  8657         END-IF
  8658         IF (ICD2I GREATER THAN SPACES) AND
  8659            (ICD2I(1:1) NOT > ' ' OR
  8660             ICD2I(2:1) NOT > ' ' OR
  8661             ICD2I(3:1) NOT > ' ' OR
  8662             ICD2I(4:1) NOT = '.')
  8663              MOVE ER-0992        TO EMI-ERROR
  8664              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8665              MOVE 'X'            TO ERROR-SWITCH
  8666              MOVE AL-UABON       TO ICD2A
  8667              MOVE -1             TO ICD2L
  8668         ELSE
  8669             MOVE AL-UANON       TO ICD2A
  8670             MOVE 'X'            TO UPDATE-SWITCH
  8671                                    NINETY-TRLR-SWITCH
  8672         END-IF
  8673     ELSE
  8674         MOVE AL-UANOF           TO ICD2A
  8675     END-IF.
  8676
  8677*    IF CAUSEI GREATER THAN LOW-VALUES
  8678*        MOVE AL-UANON           TO CAUSEA
  8679*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8680*    ELSE
  8681*        MOVE AL-UANOF           TO CAUSEA.
  8682
  8683*    IF ENDL GREATER THAN ZERO
  8684*        MOVE LOW-VALUES         TO HOLD-END
  8685*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 156
* EL131.cbl
  8686*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8687*        ELSE
  8688*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8689*            EXEC CICS BIF DEEDIT
  8690*                FIELD    (DEEDIT-DATE-INPUT)
  8691*                LENGTH   (DATE-LENGTH)
  8692*            END-EXEC
  8693*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8694*            MOVE '4'            TO DC-OPTION-CODE
  8695*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8696*            IF NOT DATE-CONVERSION-ERROR
  8697*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8698*                MOVE AL-UANON   TO ENDA
  8699*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8700*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8701*            ELSE
  8702*                MOVE ER-0224    TO EMI-ERROR
  8703*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8704*                MOVE AL-UABON   TO ENDA
  8705*                MOVE -1         TO ENDL
  8706*                MOVE 'X'        TO ERROR-SWITCH
  8707*      ELSE
  8708*          MOVE AL-UANOF         TO ENDA.
  8709
  8710     IF INCL GREATER THAN ZERO
  8711         MOVE LOW-VALUES         TO HOLD-INCUR
  8712         IF INCI = SPACES
  8713             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8714         ELSE
  8715             MOVE INCI           TO DEEDIT-DATE-INPUT
  8716
  8717* EXEC CICS BIF DEEDIT
  8718*                FIELD    (DEEDIT-DATE-INPUT)
  8719*                LENGTH   (DATE-LENGTH)
  8720*            END-EXEC
  8721*    MOVE '@"L                   #   #00008437' TO DFHEIV0
  8722     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8723     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8724     MOVE X'2020233030303038343337' TO DFHEIV0(25:11)
  8725     CALL 'kxdfhei1' USING DFHEIV0,
  8726           DEEDIT-DATE-INPUT,
  8727           DATE-LENGTH
  8728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8729             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8730             MOVE '4'            TO DC-OPTION-CODE
  8731             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8732             IF NOT DATE-CONVERSION-ERROR
  8733                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8734                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8735                 MOVE AL-UANON           TO INCA
  8736                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8737             ELSE
  8738                 MOVE ER-0222    TO EMI-ERROR
  8739                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8740                 MOVE AL-UABON   TO INCA
  8741                 MOVE -1         TO INCL
  8742                 MOVE 'X'        TO ERROR-SWITCH
  8743       ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 157
* EL131.cbl
  8744           IF PI-NO-PMTS = ZEROS
  8745               MOVE AL-UANOF     TO INCA.
  8746
  8747     IF REPL GREATER THAN ZERO
  8748         MOVE LOW-VALUES         TO HOLD-REPORTED
  8749         IF REPI = SPACES
  8750             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8751         ELSE
  8752             MOVE REPI           TO DEEDIT-DATE-INPUT
  8753
  8754* EXEC CICS BIF DEEDIT
  8755*                FIELD    (DEEDIT-DATE-INPUT)
  8756*                LENGTH   (DATE-LENGTH)
  8757*            END-EXEC
  8758*    MOVE '@"L                   #   #00008465' TO DFHEIV0
  8759     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8760     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8761     MOVE X'2020233030303038343635' TO DFHEIV0(25:11)
  8762     CALL 'kxdfhei1' USING DFHEIV0,
  8763           DEEDIT-DATE-INPUT,
  8764           DATE-LENGTH
  8765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8766             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8767             MOVE '4'            TO DC-OPTION-CODE
  8768             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8769             IF NOT DATE-CONVERSION-ERROR
  8770                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8771                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8772                 MOVE AL-UANON   TO REPA
  8773                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8774             ELSE
  8775                 MOVE ER-0223    TO EMI-ERROR
  8776                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8777                 MOVE AL-UABON   TO REPA
  8778                 MOVE -1         TO REPL
  8779                 MOVE 'X'        TO ERROR-SWITCH
  8780       ELSE
  8781         MOVE AL-UANOF TO REPA.
  8782
  8783     IF PDTHRUI GREATER THAN LOW-VALUES
  8784        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8785        IF PDTHRUI = SPACES
  8786           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8787        ELSE
  8788           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8789
  8790* EXEC CICS BIF DEEDIT
  8791*               FIELD    (DEEDIT-DATE-INPUT)
  8792*               LENGTH   (DATE-LENGTH)
  8793*          END-EXEC
  8794*    MOVE '@"L                   #   #00008492' TO DFHEIV0
  8795     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8796     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8797     MOVE X'2020233030303038343932' TO DFHEIV0(25:11)
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           DEEDIT-DATE-INPUT,
  8800           DATE-LENGTH
  8801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 158
* EL131.cbl
  8802           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8803           MOVE '4'            TO DC-OPTION-CODE
  8804           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8805           IF NOT DATE-CONVERSION-ERROR
  8806              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8807              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8808              MOVE AL-UANON   TO PDTHRUA
  8809              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8810              IF PI-USES-PAID-TO
  8811                 MOVE '6'            TO DC-OPTION-CODE
  8812                 MOVE -1             TO DC-ELAPSED-DAYS
  8813                 MOVE +0             TO DC-ELAPSED-MONTHS
  8814                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8815                 IF NO-CONVERSION-ERROR
  8816                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8817                 ELSE
  8818                    NEXT SENTENCE
  8819              ELSE
  8820                 NEXT SENTENCE
  8821           ELSE
  8822              MOVE ER-0475    TO EMI-ERROR
  8823              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8824              MOVE AL-UABON   TO PDTHRUA
  8825              MOVE -1         TO PDTHRUL
  8826              MOVE 'X'        TO ERROR-SWITCH
  8827     ELSE
  8828        IF MODIFY-CAP
  8829           MOVE AL-UANOF        TO PDTHRUA.
  8830
  8831     IF PDAMTL GREATER THAN +0
  8832         MOVE ZEROS              TO HOLD-PDAMT
  8833
  8834* EXEC CICS BIF DEEDIT
  8835*            FIELD    (PDAMTI)
  8836*            LENGTH   (9)
  8837*        END-EXEC
  8838     MOVE 9
  8839       TO DFHEIV11
  8840*    MOVE '@"L                   #   #00008527' TO DFHEIV0
  8841     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8842     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8843     MOVE X'2020233030303038353237' TO DFHEIV0(25:11)
  8844     CALL 'kxdfhei1' USING DFHEIV0,
  8845           PDAMTI,
  8846           DFHEIV11
  8847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8848         IF PDAMTI NUMERIC
  8849             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8850             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8851             MOVE AL-UNNON       TO PDAMTA
  8852         ELSE
  8853             MOVE ER-0547        TO EMI-ERROR
  8854             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8855             MOVE AL-UNBON       TO PDAMTA
  8856             MOVE -1             TO PDAMTL
  8857             MOVE 'X'            TO ERROR-SWITCH
  8858     ELSE
  8859         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 159
* EL131.cbl
  8860            MOVE AL-UNNOF        TO PDAMTA.
  8861
  8862     IF NODAYSI GREATER THAN LOW-VALUES
  8863         MOVE ZEROS              TO HOLD-NODAYS
  8864
  8865* EXEC CICS BIF DEEDIT
  8866*            FIELD (NODAYSI)
  8867*            LENGTH (5)
  8868*        END-EXEC
  8869     MOVE 5
  8870       TO DFHEIV11
  8871*    MOVE '@"L                   #   #00008547' TO DFHEIV0
  8872     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8873     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8874     MOVE X'2020233030303038353437' TO DFHEIV0(25:11)
  8875     CALL 'kxdfhei1' USING DFHEIV0,
  8876           NODAYSI,
  8877           DFHEIV11
  8878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8879         IF NODAYSI NUMERIC
  8880             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8881             MOVE AL-UNNON       TO NODAYSA
  8882             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8883         ELSE
  8884             MOVE ER-0491        TO EMI-ERROR
  8885             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8886             MOVE AL-UNBON       TO NODAYSA
  8887             MOVE -1             TO NODAYSL
  8888             MOVE 'X'            TO ERROR-SWITCH
  8889     ELSE
  8890         IF MODIFY-CAP
  8891            MOVE AL-UNNOF        TO NODAYSA.
  8892
  8893     IF NOPMTSI GREATER THAN LOW-VALUES
  8894         MOVE ZEROS              TO HOLD-NOPMTS
  8895
  8896* EXEC CICS BIF DEEDIT
  8897*            FIELD (NOPMTSI)
  8898*            LENGTH (4)
  8899*        END-EXEC
  8900     MOVE 4
  8901       TO DFHEIV11
  8902*    MOVE '@"L                   #   #00008567' TO DFHEIV0
  8903     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8904     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8905     MOVE X'2020233030303038353637' TO DFHEIV0(25:11)
  8906     CALL 'kxdfhei1' USING DFHEIV0,
  8907           NOPMTSI,
  8908           DFHEIV11
  8909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8910         IF NOPMTSI NUMERIC
  8911             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8912             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8913             MOVE AL-UNNON       TO NOPMTSA
  8914           ELSE
  8915             MOVE ER-0548        TO EMI-ERROR
  8916             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8917             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 160
* EL131.cbl
  8918             MOVE -1             TO NOPMTSL
  8919             MOVE 'X'            TO ERROR-SWITCH
  8920       ELSE
  8921         IF MODIFY-CAP
  8922            MOVE AL-UNNOF        TO NOPMTSA.
  8923
  8924     IF FORMTYPI GREATER THAN LOW-VALUES
  8925         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8926             MOVE AL-UANON       TO FORMTYPA
  8927             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8928           ELSE
  8929             MOVE ER-7650        TO EMI-ERROR
  8930             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8931             MOVE AL-UABON       TO FORMTYPA
  8932             MOVE -1             TO FORMTYPL
  8933             MOVE 'X'            TO ERROR-SWITCH
  8934       ELSE
  8935         MOVE AL-UANOF           TO FORMTYPA.
  8936
  8937     IF PRICDL GREATER THAN ZERO
  8938         IF (PRICDI = ' ') OR
  8939            (PRICDI GREATER THAN ZERO   AND
  8940             PRICDI NOT GREATER THAN '9')
  8941             MOVE AL-UANON       TO PRICDA
  8942             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8943         ELSE
  8944             MOVE ER-0274        TO EMI-ERROR
  8945             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8946             MOVE AL-UABON       TO PRICDA
  8947             MOVE -1             TO PRICDL
  8948             MOVE 'X'            TO ERROR-SWITCH
  8949     ELSE
  8950         MOVE AL-UANOF TO PRICDA.
  8951
  8952     IF PI-COMPANY-ID = 'DMD'
  8953     IF PRICDL GREATER THAN ZERO
  8954       IF SYSTEM-MODIFY-CAP  OR
  8955          PI-PROCESSOR-ID = 'LGXX'
  8956             NEXT SENTENCE
  8957           ELSE
  8958            IF CL-PRIORITY-CD = '9'  OR
  8959               PRICDI         = '9'
  8960                  MOVE ER-0938        TO EMI-ERROR
  8961                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8962                  MOVE AL-UABON       TO PRICDA
  8963                  MOVE -1             TO PRICDL
  8964                  MOVE 'X'            TO ERROR-SWITCH.
  8965
  8966     IF FILETOL GREATER THAN ZERO
  8967         MOVE AL-UANON           TO FILETOA
  8968         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8969     ELSE
  8970         MOVE AL-UANOF TO FILETOA.
  8971
  8972     IF SUPVL GREATER THAN ZERO
  8973         IF SUPVI = 'Y' OR 'N' OR SPACE
  8974             MOVE AL-UANON       TO SUPVA
  8975             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 161
* EL131.cbl
  8976         ELSE
  8977             MOVE ER-0230        TO EMI-ERROR
  8978             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8979             MOVE AL-UABON       TO SUPVA
  8980             MOVE -1             TO SUPVL
  8981             MOVE 'X'            TO ERROR-SWITCH
  8982     ELSE
  8983         MOVE AL-UANOF           TO SUPVA.
  8984
  8985     IF MLNAMEL GREATER THAN ZERO
  8986         IF MLNAMEI GREATER THAN SPACES
  8987            MOVE AL-UANON        TO MLNAMEA
  8988            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8989                                     MSTR-KEY-SWITCH
  8990         ELSE
  8991            MOVE ER-0236         TO EMI-ERROR
  8992            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8993            MOVE AL-UABON        TO MLNAMEA
  8994            MOVE -1              TO MLNAMEL
  8995            MOVE 'X'             TO ERROR-SWITCH
  8996     ELSE
  8997         MOVE AL-UANOF           TO MLNAMEA.
  8998
  8999     IF MFNAMEI GREATER THAN LOW-VALUES
  9000         MOVE AL-UANON           TO MFNAMEA
  9001         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  9002     ELSE
  9003         MOVE AL-UANOF           TO MFNAMEA.
  9004
  9005     IF MMINITI GREATER THAN LOW-VALUES
  9006         MOVE AL-UANON           TO MMINITA
  9007         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  9008     ELSE
  9009         MOVE AL-UANOF           TO MMINITA.
  9010
  9011     IF CRTLNMEI GREATER THAN LOW-VALUES
  9012         IF CRTLNMEI NOT = SPACES
  9013            MOVE AL-UANON        TO CRTLNMEA
  9014            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  9015                                     CERT-KEY-SWITCH
  9016        ELSE
  9017            MOVE ER-0236         TO EMI-ERROR
  9018            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9019            MOVE AL-UABON        TO CRTLNMEA
  9020            MOVE -1              TO CRTLNMEL
  9021            MOVE 'X'             TO ERROR-SWITCH
  9022     ELSE
  9023         MOVE AL-UANOF           TO CRTLNMEA.
  9024
  9025     IF CRTFNMEI GREATER THAN LOW-VALUES
  9026         MOVE AL-UANON           TO CRTFNMEA
  9027         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9028     ELSE
  9029         MOVE AL-UANOF           TO CRTFNMEA.
  9030
  9031     IF CRTINITI GREATER THAN LOW-VALUES
  9032         MOVE AL-UANON           TO CRTINITA
  9033         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 162
* EL131.cbl
  9034     ELSE
  9035         MOVE AL-UANOF           TO CRTINITA.
  9036
  9037     IF ISSAGEL GREATER THAN ZERO
  9038         IF ISSAGEI NUMERIC
  9039            MOVE AL-UANON        TO ISSAGEA
  9040            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9041         ELSE
  9042            MOVE ER-0237         TO EMI-ERROR
  9043            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9044            MOVE AL-UABON        TO ISSAGEA
  9045            MOVE -1              TO ISSAGEL
  9046            MOVE 'X'             TO ERROR-SWITCH
  9047     ELSE
  9048         MOVE AL-UANOF           TO ISSAGEA.
  9049
  9050     IF JNTFNMEI GREATER THAN LOW-VALUES
  9051         MOVE AL-UANON           TO JNTFNMEA
  9052         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9053     ELSE
  9054         MOVE AL-UANOF           TO JNTFNMEA.
  9055
  9056     IF JNTLNMEI GREATER THAN LOW-VALUES
  9057         MOVE AL-UANON           TO JNTLNMEA
  9058         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9059     ELSE
  9060         MOVE AL-UANOF           TO JNTLNMEA.
  9061
  9062     IF JNTINITI GREATER THAN LOW-VALUES
  9063         MOVE AL-UANON           TO JNTINITA
  9064         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9065     ELSE
  9066         MOVE AL-UANOF           TO JNTINITA.
  9067
  9068     IF JNTAGEL GREATER THAN ZERO
  9069         IF JNTAGEI NUMERIC
  9070            MOVE AL-UANON        TO JNTAGEA
  9071            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9072         ELSE
  9073            MOVE ER-0238         TO EMI-ERROR
  9074            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9075            MOVE AL-UABON        TO JNTAGEA
  9076            MOVE -1              TO JNTAGEL
  9077            MOVE 'X'             TO ERROR-SWITCH
  9078     ELSE
  9079         MOVE AL-UANOF           TO JNTAGEA.
  9080
  9081     IF ADDONDTI GREATER THAN LOW-VALUES
  9082         MOVE LOW-VALUES         TO HOLD-ADDON
  9083         IF ADDONDTI = SPACES
  9084             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  9085         ELSE
  9086             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  9087
  9088* EXEC CICS BIF DEEDIT
  9089*                FIELD    (DEEDIT-DATE-INPUT)
  9090*                LENGTH   (DATE-LENGTH)
  9091*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 163
* EL131.cbl
  9092*    MOVE '@"L                   #   #00008748' TO DFHEIV0
  9093     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9094     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9095     MOVE X'2020233030303038373438' TO DFHEIV0(25:11)
  9096     CALL 'kxdfhei1' USING DFHEIV0,
  9097           DEEDIT-DATE-INPUT,
  9098           DATE-LENGTH
  9099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9100             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9101             MOVE '4'            TO DC-OPTION-CODE
  9102             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9103             IF NOT DATE-CONVERSION-ERROR
  9104                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  9105                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  9106                                                  CERT-SWITCH
  9107                 MOVE AL-UANON   TO ADDONDTA
  9108                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  9109             ELSE
  9110                 MOVE ER-7651    TO EMI-ERROR
  9111                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9112                 MOVE AL-UABON   TO ADDONDTA
  9113                 MOVE -1         TO ADDONDTL
  9114                 MOVE 'X'        TO ERROR-SWITCH
  9115       ELSE
  9116         MOVE AL-UANOF TO ADDONDTA.
  9117
  9118     IF LCVCDI GREATER THAN LOW-VALUES
  9119         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9120         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9121     ELSE
  9122         MOVE AL-UANOF           TO LCVCDA.
  9123
  9124     IF ACVCDI GREATER THAN LOW-VALUES
  9125         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9126         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9127     ELSE
  9128         MOVE AL-UANOF           TO ACVCDA.
  9129
  9130     IF LCVOTRMI GREATER THAN LOW-VALUES
  9131
  9132* EXEC CICS BIF DEEDIT
  9133*            FIELD (LCVOTRMI)
  9134*            LENGTH(3)
  9135*        END-EXEC
  9136     MOVE 3
  9137       TO DFHEIV11
  9138*    MOVE '@"L                   #   #00008783' TO DFHEIV0
  9139     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9140     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9141     MOVE X'2020233030303038373833' TO DFHEIV0(25:11)
  9142     CALL 'kxdfhei1' USING DFHEIV0,
  9143           LCVOTRMI,
  9144           DFHEIV11
  9145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9146         IF LCVOTRMI IS NUMERIC
  9147             MOVE LCVOTRMI       TO LCVOTRMO
  9148             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9149             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 164
* EL131.cbl
  9150         ELSE
  9151             MOVE ER-0241        TO EMI-ERROR
  9152             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9153             MOVE AL-UNBON       TO LCVOTRMA
  9154             MOVE 'X'            TO ERROR-SWITCH
  9155             MOVE -1             TO LCVOTRML
  9156     ELSE
  9157         MOVE AL-UANOF           TO LCVOTRMA.
  9158
  9159     IF ACVOTRMI GREATER THAN LOW-VALUES
  9160
  9161* EXEC CICS BIF DEEDIT
  9162*            FIELD (ACVOTRMI)
  9163*            LENGTH(3)
  9164*        END-EXEC
  9165     MOVE 3
  9166       TO DFHEIV11
  9167*    MOVE '@"L                   #   #00008801' TO DFHEIV0
  9168     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9169     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9170     MOVE X'2020233030303038383031' TO DFHEIV0(25:11)
  9171     CALL 'kxdfhei1' USING DFHEIV0,
  9172           ACVOTRMI,
  9173           DFHEIV11
  9174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9175         IF ACVOTRMI IS NUMERIC
  9176             MOVE ACVOTRMI       TO ACVOTRMO
  9177             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9178             MOVE AL-UANON       TO ACVOTRMA
  9179         ELSE
  9180             MOVE ER-0241        TO EMI-ERROR
  9181             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9182             MOVE AL-UNBON       TO ACVOTRMA
  9183             MOVE 'X'            TO ERROR-SWITCH
  9184             MOVE -1             TO ACVOTRML
  9185     ELSE
  9186         MOVE AL-UANOF           TO ACVOTRMA.
  9187
  9188     IF LCVRATEL GREATER THAN +0
  9189
  9190* EXEC CICS BIF DEEDIT
  9191*            FIELD (LCVRATEI)
  9192*            LENGTH(6)
  9193*        END-EXEC
  9194     MOVE 6
  9195       TO DFHEIV11
  9196*    MOVE '@"L                   #   #00008819' TO DFHEIV0
  9197     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9198     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9199     MOVE X'2020233030303038383139' TO DFHEIV0(25:11)
  9200     CALL 'kxdfhei1' USING DFHEIV0,
  9201           LCVRATEI,
  9202           DFHEIV11
  9203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9204         IF LCVRATEI IS NUMERIC
  9205             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9206             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9207             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 165
* EL131.cbl
  9208         ELSE
  9209             MOVE ER-2280        TO EMI-ERROR
  9210             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9211             MOVE AL-UNBON       TO LCVRATEA
  9212             MOVE 'X'            TO ERROR-SWITCH
  9213             MOVE -1             TO LCVRATEL
  9214     ELSE
  9215         MOVE AL-UNNOF           TO LCVRATEA.
  9216
  9217     IF ACVRATEL GREATER THAN +0
  9218
  9219* EXEC CICS BIF DEEDIT
  9220*            FIELD (ACVRATEI)
  9221*            LENGTH(6)
  9222*        END-EXEC
  9223     MOVE 6
  9224       TO DFHEIV11
  9225*    MOVE '@"L                   #   #00008837' TO DFHEIV0
  9226     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9227     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9228     MOVE X'2020233030303038383337' TO DFHEIV0(25:11)
  9229     CALL 'kxdfhei1' USING DFHEIV0,
  9230           ACVRATEI,
  9231           DFHEIV11
  9232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9233         IF ACVRATEI IS NUMERIC
  9234             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9235             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9236             MOVE AL-UNNON       TO ACVRATEA
  9237         ELSE
  9238             MOVE ER-2280        TO EMI-ERROR
  9239             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9240             MOVE AL-UNBON       TO ACVRATEA
  9241             MOVE 'X'            TO ERROR-SWITCH
  9242             MOVE -1             TO ACVRATEL
  9243     ELSE
  9244         MOVE AL-UNNOF           TO ACVRATEA.
  9245
  9246     IF LCVBENEL GREATER THAN ZERO
  9247
  9248* EXEC CICS BIF DEEDIT
  9249*            FIELD (LCVBENEI)
  9250*            LENGTH (11)
  9251*        END-EXEC
  9252     MOVE 11
  9253       TO DFHEIV11
  9254*    MOVE '@"L                   #   #00008855' TO DFHEIV0
  9255     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9256     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9257     MOVE X'2020233030303038383535' TO DFHEIV0(25:11)
  9258     CALL 'kxdfhei1' USING DFHEIV0,
  9259           LCVBENEI,
  9260           DFHEIV11
  9261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9262         IF LCVBENEI IS NUMERIC
  9263            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9264            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9265            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 166
* EL131.cbl
  9266         ELSE
  9267            MOVE ER-0243         TO EMI-ERROR
  9268            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9269            MOVE AL-UNBON        TO LCVBENEA
  9270            MOVE -1              TO LCVBENEL
  9271            MOVE 'X'             TO ERROR-SWITCH
  9272     ELSE
  9273         MOVE AL-UANOF           TO LCVBENEA.
  9274
  9275     IF ACVBENEL GREATER THAN ZERO
  9276
  9277* EXEC CICS BIF DEEDIT
  9278*            FIELD (ACVBENEI)
  9279*            LENGTH (11)
  9280*        END-EXEC
  9281     MOVE 11
  9282       TO DFHEIV11
  9283*    MOVE '@"L                   #   #00008873' TO DFHEIV0
  9284     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9285     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9286     MOVE X'2020233030303038383733' TO DFHEIV0(25:11)
  9287     CALL 'kxdfhei1' USING DFHEIV0,
  9288           ACVBENEI,
  9289           DFHEIV11
  9290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9291         IF ACVBENEI IS NUMERIC
  9292            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9293            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9294            MOVE AL-UNNON        TO ACVBENEA
  9295         ELSE
  9296            MOVE ER-0243         TO EMI-ERROR
  9297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9298            MOVE AL-UNBON        TO ACVBENEA
  9299            MOVE -1              TO ACVBENEL
  9300            MOVE 'X'             TO ERROR-SWITCH
  9301     ELSE
  9302         MOVE AL-UANOF           TO ACVBENEA.
  9303
  9304     IF LCVFORMI GREATER THAN LOW-VALUES
  9305        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9306        MOVE AL-UANON            TO LCVFORMA
  9307     ELSE
  9308        MOVE AL-UANOF            TO LCVFORMA.
  9309
  9310     IF ACVFORMI GREATER THAN LOW-VALUES
  9311        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9312        MOVE AL-UANON            TO ACVFORMA
  9313     ELSE
  9314        MOVE AL-UANOF            TO ACVFORMA.
  9315
  9316     IF LCVCNDTL GREATER THAN ZERO
  9317         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9318         IF LCVCNDTI = SPACES
  9319             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9320         ELSE
  9321             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9322             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9323             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 167
* EL131.cbl
  9324             MOVE '4'            TO DC-OPTION-CODE
  9325             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9326             IF NOT DATE-CONVERSION-ERROR
  9327                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9328                 MOVE AL-UANON   TO LCVCNDTA
  9329                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9330                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9331             ELSE
  9332                 MOVE ER-0246    TO EMI-ERROR
  9333                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9334                 MOVE AL-UABON   TO LCVCNDTA
  9335                 MOVE -1         TO LCVCNDTL
  9336                 MOVE 'X'        TO ERROR-SWITCH
  9337     ELSE
  9338         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9339         MOVE AL-UANOF           TO LCVCNDTA.
  9340
  9341     IF ACVCNDTL GREATER THAN ZERO
  9342         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9343         IF ACVCNDTI = SPACES
  9344             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9345         ELSE
  9346             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9347             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9348             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9349             MOVE '4'            TO DC-OPTION-CODE
  9350             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9351             IF NOT DATE-CONVERSION-ERROR
  9352                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9353                 MOVE AL-UANON   TO ACVCNDTA
  9354                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9355                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9356             ELSE
  9357                 MOVE ER-0246    TO EMI-ERROR
  9358                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9359                 MOVE AL-UABON   TO ACVCNDTA
  9360                 MOVE -1         TO ACVCNDTL
  9361                 MOVE 'X'        TO ERROR-SWITCH
  9362     ELSE
  9363         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9364         MOVE AL-UANOF           TO ACVCNDTA.
  9365
  9366     IF APRL GREATER THAN +0
  9367
  9368* EXEC CICS BIF DEEDIT
  9369*            FIELD    (APRI)
  9370*            LENGTH   (8)
  9371*        END-EXEC
  9372     MOVE 8
  9373       TO DFHEIV11
  9374*    MOVE '@"L                   #   #00008953' TO DFHEIV0
  9375     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9376     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9377     MOVE X'2020233030303038393533' TO DFHEIV0(25:11)
  9378     CALL 'kxdfhei1' USING DFHEIV0,
  9379           APRI,
  9380           DFHEIV11
  9381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 168
* EL131.cbl
  9382         IF APRI NUMERIC
  9383            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9384            MOVE APRI            TO HOLD-APR APRO
  9385            MOVE AL-UANON        TO APRA
  9386          ELSE
  9387            MOVE ER-0259         TO EMI-ERROR
  9388            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9389            MOVE AL-UABON        TO APRA
  9390            MOVE -1              TO APRL
  9391            MOVE 'X'             TO ERROR-SWITCH
  9392     ELSE
  9393         MOVE AL-UANOF           TO APRA.
  9394
  9395     IF PMTFREQL GREATER THAN ZERO
  9396
  9397* EXEC CICS BIF DEEDIT
  9398*            FIELD    (PMTFREQI)
  9399*            LENGTH   (2)
  9400*        END-EXEC
  9401     MOVE 2
  9402       TO DFHEIV11
  9403*    MOVE '@"L                   #   #00008971' TO DFHEIV0
  9404     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9405     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9406     MOVE X'2020233030303038393731' TO DFHEIV0(25:11)
  9407     CALL 'kxdfhei1' USING DFHEIV0,
  9408           PMTFREQI,
  9409           DFHEIV11
  9410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9411         IF PMTFREQI NUMERIC
  9412            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9413            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9414            MOVE AL-UANON        TO PMTFREQA
  9415          ELSE
  9416            MOVE ER-0427         TO EMI-ERROR
  9417            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9418            MOVE AL-UABON        TO PMTFREQA
  9419            MOVE -1              TO PMTFREQL
  9420            MOVE 'X'             TO ERROR-SWITCH
  9421     ELSE
  9422         MOVE AL-UANOF           TO PMTFREQA.
  9423
  9424     IF INDGRPL GREATER THAN ZERO
  9425         IF INDGRPI = 'I' OR 'G' OR SPACE
  9426             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9427             MOVE AL-UANON       TO INDGRPA
  9428          ELSE
  9429             MOVE ER-0260        TO EMI-ERROR
  9430             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9431             MOVE AL-UABON       TO INDGRPA
  9432             MOVE -1             TO INDGRPL
  9433             MOVE 'X'            TO ERROR-SWITCH
  9434     ELSE
  9435         MOVE AL-UANOF           TO INDGRPA.
  9436
  9437     IF PREMTYPL GREATER THAN ZERO
  9438         IF PREMTYPI = '1' OR '2' OR '3'
  9439            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 169
* EL131.cbl
  9440            MOVE AL-UNNON        TO PREMTYPA
  9441            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9442          ELSE
  9443            MOVE ER-0227         TO EMI-ERROR
  9444            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9445            MOVE AL-UNBON        TO PREMTYPA
  9446            MOVE -1              TO PREMTYPL
  9447            MOVE 'X'             TO ERROR-SWITCH
  9448     ELSE
  9449         MOVE AL-UANOF           TO PREMTYPA.
  9450
  9451     IF LOANBALL GREATER THAN ZERO
  9452
  9453* EXEC CICS BIF DEEDIT
  9454*             FIELD    (LOANBALI)
  9455*             LENGTH   (9)
  9456*        END-EXEC
  9457     MOVE 9
  9458       TO DFHEIV11
  9459*    MOVE '@"L                   #   #00009016' TO DFHEIV0
  9460     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9461     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9462     MOVE X'2020233030303039303136' TO DFHEIV0(25:11)
  9463     CALL 'kxdfhei1' USING DFHEIV0,
  9464           LOANBALI,
  9465           DFHEIV11
  9466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9467         IF LOANBALI NUMERIC
  9468             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9469             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9470             MOVE AL-UNNON TO LOANBALA
  9471         ELSE
  9472             MOVE ER-0639        TO EMI-ERROR
  9473             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9474             MOVE AL-UNBON       TO LOANBALA
  9475             MOVE -1             TO LOANBALL
  9476             MOVE 'X'            TO ERROR-SWITCH
  9477     ELSE
  9478         MOVE AL-UNNOF           TO LOANBALA.
  9479
  9480*    IF LOANNOL GREATER THAN ZERO
  9481*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9482*          MOVE AL-UANON            TO LOANNOA
  9483*       ELSE
  9484*          MOVE AL-UANOF            TO LOANNOA.
  9485
  9486     IF REINCDI GREATER THAN LOW-VALUES
  9487        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9488        MOVE AL-UANON            TO REINCDA
  9489     ELSE
  9490        MOVE AL-UANOF            TO REINCDA.
  9491
  9492     IF CERTI GREATER THAN LOW-VALUES
  9493         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9494     ELSE
  9495         MOVE AL-UANOF           TO CERTA.
  9496
  9497     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 170
* EL131.cbl
  9498         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9499     ELSE
  9500         MOVE AL-UANOF           TO CERTEFFA.
  9501
  9502     IF CERTACTI GREATER THAN LOW-VALUES
  9503         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9504     ELSE
  9505         MOVE AL-UANOF           TO CERTACTA.
  9506
  9507     IF CERTSTI GREATER THAN LOW-VALUES
  9508         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9509     ELSE
  9510         MOVE AL-UANOF           TO CERTSTA.
  9511
  9512     IF CERTCARI GREATER THAN LOW-VALUES
  9513         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9514     ELSE
  9515         MOVE AL-UANOF           TO CERTCARA.
  9516
  9517     IF DLYACTV-RECORD-NEEDED
  9518         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9519                 1150-EXIT
  9520     END-IF.
  9521
  9522     IF CERTEFFI GREATER LOW-VALUES OR
  9523        CERTACTI GREATER LOW-VALUES OR
  9524        CERTSTI  GREATER LOW-VALUES OR
  9525        CERTCARI GREATER LOW-VALUES OR
  9526        CERTGRPI GREATER LOW-VALUES
  9527        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9528
  9529*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9530*      IF PI-PREM-TYPE NOT = '1'  AND
  9531*         PI-NO-PMTS = ZEROS
  9532*          IF LOANBALL GREATER +0 OR
  9533*             ACVBENEL GREATER +0
  9534*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9535     if not acct-found
  9536        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9537     end-if
  9538     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9539     MOVE PI-CARRIER             TO CARRIER-CODE
  9540     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9541     MOVE PI-CERT-NO             TO CERT-NO
  9542
  9543* EXEC CICS READ
  9544*        DATASET   (CLMS-FILE-ID)
  9545*        RIDFLD    (MSTR-KEY)
  9546*        SET       (ADDRESS OF CLAIM-MASTER)
  9547*        RESP      (WS-RESPONSE)
  9548*    END-EXEC
  9549*    MOVE '&"S        E          (  N#00009095' TO DFHEIV0
  9550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9552     MOVE X'204E233030303039303935' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0,
  9554           CLMS-FILE-ID,
  9555           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 171
* EL131.cbl
  9556           DFHEIV99,
  9557           MSTR-KEY,
  9558           DFHEIV99,
  9559           DFHEIV99,
  9560           DFHEIV99
  9561     SET ADDRESS OF CLAIM-MASTER TO
  9562         DFHEIV20
  9563     MOVE EIBRESP  TO WS-RESPONSE
  9564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9565     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9566     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9567     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9568     MOVE CL-CERT-STATE          TO CERT-STATE
  9569     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9570     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9571     MOVE CL-CERT-NO             TO CERT-CERT
  9572
  9573* EXEC CICS READ
  9574*       DATASET   (CERT-FILE-ID)
  9575*       RIDFLD    (CERT-KEY)
  9576*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9577*       RESP      (WS-RESPONSE)
  9578*    END-EXEC
  9579*    MOVE '&"S        E          (  N#00009108' TO DFHEIV0
  9580     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9582     MOVE X'204E233030303039313038' TO DFHEIV0(25:11)
  9583     CALL 'kxdfhei1' USING DFHEIV0,
  9584           CERT-FILE-ID,
  9585           DFHEIV20,
  9586           DFHEIV99,
  9587           CERT-KEY,
  9588           DFHEIV99,
  9589           DFHEIV99,
  9590           DFHEIV99
  9591     SET ADDRESS OF CERTIFICATE-MASTER TO
  9592         DFHEIV20
  9593     MOVE EIBRESP  TO WS-RESPONSE
  9594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9595     if mfnamei > low-values
  9596        move mfnamei to w-name-first
  9597     else
  9598        move cl-insured-1st-name to w-name-first
  9599     end-if
  9600     if mlnamei > low-values
  9601        move mlnamei to w-name-last
  9602     else
  9603        move cl-insured-last-name to w-name-last
  9604     end-if
  9605     if instypel > zeros
  9606        evaluate true
  9607           when cl-no-of-days-paid > zeros
  9608              move er-1668       to emi-error
  9609              perform 9900-error-format
  9610                                 thru 9900-exit
  9611              move al-uabon      to instypea
  9612              move -1            to instypel
  9613              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 172
* EL131.cbl
  9614           when instypei = 'C'
  9615              if w-name-first (1:10) = cm-insured-first-name
  9616                 move er-1666    to emi-error
  9617                 PERFORM 9900-ERROR-FORMAT
  9618                                 THRU 9900-EXIT
  9619                 move al-uabon   to instypea
  9620                 move -1         to instypel
  9621                 move 'X'        to error-switch
  9622              end-if
  9623           when instypei = 'P'
  9624              if (w-name-first (1:10) <> cm-insured-first-name)
  9625                 or (w-name-last <> cm-insured-last-name)
  9626                 move er-1676    to emi-error
  9627                 PERFORM 9900-ERROR-FORMAT
  9628                                 THRU 9900-EXIT
  9629                 move al-uabon   to instypea
  9630                 move -1         to instypel
  9631                 move 'X'        to error-switch
  9632              end-if
  9633        end-evaluate
  9634     end-if
  9635*    if (instypel > zeros)
  9636*       and (cl-no-of-days-paid > zero)
  9637*       move er-1668             to emi-error
  9638*       perform 9900-error-format thru 9900-exit
  9639*       move al-uabon            to instypea
  9640*       move -1                  to instypel
  9641*       move 'X'                 to error-switch
  9642*    end-if
  9643*
  9644*    if instypel > zero
  9645*       if instypei = 'C'
  9646*          if w-name-first (1:10) = cm-insured-first-name
  9647*             move er-1666          to emi-error
  9648*             PERFORM 9900-ERROR-FORMAT
  9649*                                   THRU 9900-EXIT
  9650*             move al-uabon         to instypea
  9651*             move -1               to instypel
  9652*             move 'X'              to error-switch
  9653*          end-if
  9654*       end-if
  9655*    end-if
  9656     if (pi-company-id = 'DCC' OR 'VPP')
  9657        and (acct-found)
  9658        perform 2120-check-pdef  thru 2120-exit
  9659        IF EXTENSL > ZERO
  9660           IF EXTENSI NUMERIC
  9661              IF EXTENSI >  WS-MAX-EXTENSION
  9662                AND ERPDEF-FOUND
  9663                 MOVE ER-1678          TO EMI-ERROR
  9664                 PERFORM 9900-ERROR-FORMAT
  9665                                       THRU 9900-EXIT
  9666                 MOVE AL-UABON         TO EXTENSA
  9667                 MOVE -1               TO EXTENSL
  9668                 MOVE 'X'              TO ERROR-SWITCH
  9669              ELSE
  9670                 MOVE 'X'              TO UPDATE-SWITCH
  9671              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 173
* EL131.cbl
  9672           ELSE
  9673              MOVE ER-1778          TO EMI-ERROR
  9674              PERFORM 9900-ERROR-FORMAT
  9675                                    THRU 9900-EXIT
  9676              MOVE AL-UABON         TO EXTENSA
  9677              MOVE -1               TO EXTENSL
  9678              MOVE 'X'              TO ERROR-SWITCH
  9679           END-IF
  9680        END-IF
  9681     end-if
  9682     if benperl > zeros
  9683        move al-uanon            to benpera
  9684     end-if
  9685     if benperl > zeros
  9686        if benperi numeric
  9687           perform 1015-edit-benefit-period
  9688                                 thru 1015-exit
  9689        else
  9690           move er-1669          to emi-error
  9691           PERFORM 9900-ERROR-FORMAT
  9692                                 THRU 9900-EXIT
  9693           move al-uabon         to benpera
  9694           move -1               to benperl
  9695           move 'X'              to error-switch
  9696        end-if
  9697    end-if
  9698     if instypel > zeros
  9699        if instypei = 'P' OR 'C'
  9700           move 'X'              to update-switch
  9701                                    mstr-switch
  9702           move al-uanon         to instypea
  9703        else
  9704            move er-1654          to emi-error
  9705           PERFORM 9900-ERROR-FORMAT
  9706                                 THRU 9900-EXIT
  9707           move al-uabon         to instypea
  9708           move -1               to instypel
  9709           move 'X'              to error-switch
  9710        end-if
  9711    end-if
  9712     if accswl > zeros
  9713        if accswi = 'Y' OR 'N'
  9714           MOVE 'X'              TO UPDATE-SWITCH
  9715                                    MSTR-SWITCH
  9716           MOVE AL-UANON         TO accswa
  9717*       else
  9718*          move er-1656          to emi-error
  9719*          PERFORM 9900-ERROR-FORMAT
  9720*                                THRU 9900-EXIT
  9721*          move al-uabon         to accswa
  9722*          move -1               to accswl
  9723*          move 'X'              to error-switch
  9724*          move al-uanof         to accswa
  9725        end-if
  9726     end-if
  9727     IF CERTL = ZEROS AND
  9728        SUFXL = ZEROS
  9729          GO TO 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 174
* EL131.cbl
  9730
  9731     IF CERTL GREATER THAN ZEROS
  9732         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9733             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9734             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9735             MOVE 'X'            TO ERROR-SWITCH
  9736             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9737
  9738     IF SUFXL GREATER THAN ZEROS
  9739         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9740             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9741             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9742             MOVE 'X'            TO ERROR-SWITCH
  9743             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9744
  9745 1010-EXIT.
  9746     EXIT.
  9747
  9748 1015-edit-benefit-period.
  9749     move ' '                    to ws-benper-sw
  9750     evaluate true
  9751        when not erpdef-found
  9752           set good-benper       to true
  9753        when pd-recurring-yn (a1) = 'Y'
  9754           set good-benper       to true
  9755        when pd-recurring-yn (a1) = 'N'
  9756           if benperi < 02
  9757              set good-benper    to true
  9758           end-if
  9759        when pd-rec-crit-period (a1) numeric
  9760           if benperi <= pd-rec-crit-period (a1)
  9761              set good-benper    to true
  9762           end-if
  9763     end-evaluate
  9764     MOVE CERT-KEY               TO ELCRTT-KEY
  9765     MOVE 'B'                    TO CTRLR-REC-TYPE
  9766
  9767* EXEC CICS READ
  9768*       DATASET   ('ELCRTT')
  9769*       RIDFLD    (ELCRTT-KEY)
  9770*       INTO      (CERTIFICATE-TRAILERS)
  9771*       RESP      (WS-RESPONSE)
  9772*    END-EXEC
  9773     MOVE LENGTH OF
  9774      CERTIFICATE-TRAILERS
  9775       TO DFHEIV11
  9776     MOVE 'ELCRTT' TO DFHEIV1
  9777*    MOVE '&"IL       E          (  N#00009285' TO DFHEIV0
  9778     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9780     MOVE X'204E233030303039323835' TO DFHEIV0(25:11)
  9781     CALL 'kxdfhei1' USING DFHEIV0,
  9782           DFHEIV1,
  9783           CERTIFICATE-TRAILERS,
  9784           DFHEIV11,
  9785           ELCRTT-KEY,
  9786           DFHEIV99,
  9787           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 175
* EL131.cbl
  9788           DFHEIV99
  9789     MOVE EIBRESP  TO WS-RESPONSE
  9790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9791     IF WS-RESP-NORMAL
  9792        perform varying s1 from +1 by +1 until
  9793           (s1 > +24)
  9794           or ((cs-claim-type (s1) = cl-claim-type)
  9795           and (cs-insured-type (s1) = cl-insured-type)
  9796           and (cs-benefit-period (s1) > benperi))
  9797        end-perform
  9798        if s1 < +25
  9799           move er-1665          to emi-error
  9800           PERFORM 9900-ERROR-FORMAT
  9801                                 THRU 9900-EXIT
  9802           move al-uabon         to benpera
  9803           move -1               to benperl
  9804           move 'X'              to error-switch
  9805           go to 1015-exit
  9806*       else
  9807*          set good-benper       to true
  9808        end-if
  9809     end-if
  9810     if good-benper
  9811        move 'X'                 to update-switch
  9812                                    mstr-switch
  9813        move al-uanon            to benpera
  9814     else
  9815        move er-1669             to emi-error
  9816        PERFORM 9900-ERROR-FORMAT
  9817                                 THRU 9900-EXIT
  9818        move al-uabon            to benpera
  9819        move -1                  to benperl
  9820        move 'X'                 to error-switch
  9821     end-if
  9822     .
  9823 1015-exit.
  9824     exit.
  9825 1030-EDIT-NAME.
  9826     IF INSTYPEL > ZEROS
  9827        MOVE INSTYPEI TO CL-INSURED-TYPE
  9828     END-IF
  9829     IF MFNAMEL > +0
  9830        IF CL-INSURED-TYPE = 'C'
  9831          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  9832           MOVE ER-1675             TO EMI-ERROR
  9833           MOVE -1                  TO MFNAMEL
  9834           MOVE AL-UABON            TO MFNAMEA
  9835           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9836           MOVE 'X'                 TO ERROR-SWITCH
  9837        ELSE
  9838          IF CL-INSURED-TYPE = 'P'
  9839            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  9840             MOVE ER-1676             TO EMI-ERROR
  9841             MOVE -1                  TO MFNAMEL
  9842             MOVE AL-UABON            TO MFNAMEA
  9843             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9844             MOVE 'X'                 TO ERROR-SWITCH
  9845          END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 176
* EL131.cbl
  9846        END-IF
  9847     END-IF.
  9848
  9849 1030-EXIT.
  9850     EXIT.
  9851 1050-EDIT-BENE.
  9852     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9853     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9854     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9855     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9856     MOVE 1000               TO TRLR-SEQ-NO.
  9857
  9858
  9859* EXEC CICS HANDLE CONDITION
  9860*         NOTFND    (1052-DONE)
  9861*         ENDFILE   (1052-DONE)
  9862*    END-EXEC.
  9863*    MOVE '"$I''                  ! & #00009358' TO DFHEIV0
  9864     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9866     MOVE X'2620233030303039333538' TO DFHEIV0(25:11)
  9867     CALL 'kxdfhei1' USING DFHEIV0
  9868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9869
  9870
  9871
  9872* EXEC CICS STARTBR
  9873*        DATASET (TRLR-FILE-ID)
  9874*        RIDFLD  (TRLR-KEY)
  9875*    END-EXEC
  9876     MOVE 0
  9877       TO DFHEIV11
  9878*    MOVE '&,         G          &   #00009363' TO DFHEIV0
  9879     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9880     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9881     MOVE X'2020233030303039333633' TO DFHEIV0(25:11)
  9882     CALL 'kxdfhei1' USING DFHEIV0,
  9883           TRLR-FILE-ID,
  9884           TRLR-KEY,
  9885           DFHEIV99,
  9886           DFHEIV11,
  9887           DFHEIV99
  9888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9889
  9890
  9891     MOVE SPACES TO WS-TRLR-FILE-EOF
  9892                    WS-PAYMENT-PENDING
  9893     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9894       UNTIL  TRLR-FILE-EOF
  9895         OR PAYMENT-PENDING
  9896
  9897
  9898* EXEC CICS ENDBR
  9899*        DATASET (TRLR-FILE-ID)
  9900*    END-EXEC.
  9901     MOVE 0
  9902       TO DFHEIV11
  9903*    MOVE '&2                    $   #00009375' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 177
* EL131.cbl
  9904     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9905     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9906     MOVE X'2020233030303039333735' TO DFHEIV0(25:11)
  9907     CALL 'kxdfhei1' USING DFHEIV0,
  9908           TRLR-FILE-ID,
  9909           DFHEIV11,
  9910           DFHEIV99
  9911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9912
  9913 1050-EXIT.
  9914     EXIT.
  9915
  9916 1052-READ-TRLR.
  9917
  9918* EXEC CICS READNEXT
  9919*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9920*         DATASET  (TRLR-FILE-ID)
  9921*         RIDFLD   (TRLR-KEY)
  9922*    END-EXEC.
  9923     MOVE 0
  9924       TO DFHEIV11
  9925*    MOVE '&.S                   )   #00009382' TO DFHEIV0
  9926     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9927     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9928     MOVE X'2020233030303039333832' TO DFHEIV0(25:11)
  9929     CALL 'kxdfhei1' USING DFHEIV0,
  9930           TRLR-FILE-ID,
  9931           DFHEIV20,
  9932           DFHEIV99,
  9933           TRLR-KEY,
  9934           DFHEIV99,
  9935           DFHEIV11,
  9936           DFHEIV99,
  9937           DFHEIV99
  9938     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9939         DFHEIV20
  9940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9941
  9942
  9943     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9944       AND PI-CARRIER  = TRLR-CARRIER
  9945       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9946       AND PI-CERT-NO  = TRLR-CERT-NO
  9947        CONTINUE
  9948     ELSE
  9949        GO TO 1052-DONE
  9950     END-IF.
  9951
  9952     IF PAYMENT-TR
  9953       AND BENEFICIARY-PAID
  9954       AND AT-VOID-DT = LOW-VALUES
  9955       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9956         SET PAYMENT-PENDING TO TRUE
  9957     END-IF.
  9958
  9959     IF CORRESPONDENCE-TR
  9960        IF AT-AUTH-RCVD = 'Y'
  9961           SET AUTH-RCVD TO TRUE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 178
* EL131.cbl
  9962        ELSE
  9963        IF AT-AUTH-RCVD = 'N'
  9964           SET NO-AUTH-RCVD TO TRUE
  9965        END-IF
  9966        END-IF
  9967     END-IF.
  9968
  9969     GO TO 1052-EXIT.
  9970
  9971 1052-DONE.
  9972     SET TRLR-FILE-EOF TO TRUE.
  9973 1052-EXIT.
  9974     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 179
* EL131.cbl
  9976 1120-EDIT-PROC.
  9977     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9978     MOVE '2'                    TO CNTL-REC-TYPE.
  9979     MOVE PROCI                  TO CNTL-PROC-ID.
  9980     MOVE ZERO                   TO CNTL-SEQ-NO.
  9981
  9982
  9983* EXEC CICS HANDLE CONDITION
  9984*         NOTFND    (1120-CNTL-NOTFND)
  9985*    END-EXEC.
  9986*    MOVE '"$I                   ! '' #00009427' TO DFHEIV0
  9987     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9989     MOVE X'2720233030303039343237' TO DFHEIV0(25:11)
  9990     CALL 'kxdfhei1' USING DFHEIV0
  9991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9992
  9993
  9994
  9995* EXEC CICS READ
  9996*         SET      (ADDRESS OF CONTROL-FILE)
  9997*         DATASET  (CNTL-FILE-ID)
  9998*         RIDFLD   (CNTL-KEY)
  9999*    END-EXEC.
 10000*    MOVE '&"S        E          (   #00009431' TO DFHEIV0
 10001     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10003     MOVE X'2020233030303039343331' TO DFHEIV0(25:11)
 10004     CALL 'kxdfhei1' USING DFHEIV0,
 10005           CNTL-FILE-ID,
 10006           DFHEIV20,
 10007           DFHEIV99,
 10008           CNTL-KEY,
 10009           DFHEIV99,
 10010           DFHEIV99,
 10011           DFHEIV99
 10012     SET ADDRESS OF CONTROL-FILE TO
 10013         DFHEIV20
 10014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10015
 10016
 10017     MOVE AL-UANON               TO PROCA.
 10018     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
 10019     GO TO 1120-EXIT.
 10020
 10021 1120-CNTL-NOTFND.
 10022     MOVE ER-0273                TO EMI-ERROR.
 10023     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10024     MOVE AL-UABON               TO PROCA.
 10025     MOVE -1                     TO PROCL.
 10026     MOVE 'X'                    TO ERROR-SWITCH.
 10027
 10028 1120-EXIT.
 10029     EXIT.
 10030
 10031*************************************************************
 10032*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
 10033*************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 180
* EL131.cbl
 10034
 10035 1150-OUTPUT-ACTIVITY-RECORD.
 10036
 10037
 10038* EXEC CICS GETMAIN
 10039*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 10040*        LENGTH (25)
 10041*        INITIMG (WS-BLANK)
 10042*    END-EXEC.
 10043     MOVE 25
 10044       TO DFHEIV11
 10045*    MOVE ',"IL                  $   #00009457' TO DFHEIV0
 10046     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10047     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10048     MOVE X'2020233030303039343537' TO DFHEIV0(25:11)
 10049     CALL 'kxdfhei1' USING DFHEIV0,
 10050           DFHEIV20,
 10051           DFHEIV11,
 10052           WS-BLANK
 10053     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 10054         DFHEIV20
 10055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10056
 10057
 10058     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 10059     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 10060     MOVE PI-CARRIER             TO DA-CARRIER.
 10061     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
 10062     MOVE PI-CERT-NO             TO DA-CERT-NO.
 10063     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
 10064     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
 10065
 10066
 10067* EXEC CICS HANDLE CONDITION
 10068*        NOTOPEN (1150-NOTOPEN-ERROR)
 10069*        DUPREC (1150-EXIT)
 10070*    END-EXEC.
 10071*    MOVE '"$J%                  ! ( #00009471' TO DFHEIV0
 10072     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10074     MOVE X'2820233030303039343731' TO DFHEIV0(25:11)
 10075     CALL 'kxdfhei1' USING DFHEIV0
 10076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10077
 10078     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
 10079     MOVE 'DLYACTV'              TO JP-FILE-ID.
 10080     MOVE 'A'                    TO JP-RECORD-TYPE.
 10081     MOVE +48                    TO JOURNAL-LENGTH.
 10082
 10083
 10084* EXEC CICS WRITE
 10085*        DATASET ('DLYACTV')
 10086*        RIDFLD (DA-KEY)
 10087*        FROM (DAILY-ACTIVITY-RECORD)
 10088*        LENGTH (25)
 10089*    END-EXEC.
 10090     MOVE 'DLYACTV' TO DFHEIV1
 10091     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 181
* EL131.cbl
 10092       TO DFHEIV11
 10093*    MOVE '&$ L                  ''   #00009480' TO DFHEIV0
 10094     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10095     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10096     MOVE X'2020233030303039343830' TO DFHEIV0(25:11)
 10097     CALL 'kxdfhei1' USING DFHEIV0,
 10098           DFHEIV1,
 10099           DAILY-ACTIVITY-RECORD,
 10100           DFHEIV11,
 10101           DA-KEY,
 10102           DFHEIV99,
 10103           DFHEIV99
 10104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10105
 10106
 10107     GO TO 1150-EXIT.
 10108
 10109 1150-NOTOPEN-ERROR.
 10110
 10111     MOVE '2955'                 TO EMI-ERROR.
 10112     MOVE -1                     TO MAINTL.
 10113     MOVE AL-UANON               TO MAINTA.
 10114     MOVE 'X'                    TO ERROR-SWITCH.
 10115     PERFORM 9900-ERROR-FORMAT THRU
 10116             9900-EXIT.
 10117
 10118 1150-EXIT.
 10119     EXIT.
 10120
 10121*************************************************************
 10122*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
 10123*************************************************************
 10124
 10125 1240-EDIT-LIFE-CODE.
 10126
 10127     IF INVALID-BENEFIT-CODE
 10128         GO TO 1240-SET-ERROR.
 10129
 10130     MOVE SPACES                 TO BENEFIT-KEY.
 10131     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10132     MOVE '4'                    TO BEN-REC-TYPE.
 10133     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10134     MOVE ZERO                   TO BEN-SEQ-NO.
 10135
 10136
 10137* EXEC CICS READ GTEQ
 10138*         DATASET  (CNTL-FILE-ID)
 10139*         RIDFLD   (BENEFIT-KEY)
 10140*         SET      (ADDRESS OF CONTROL-FILE)
 10141*    END-EXEC.
 10142*    MOVE '&"S        G          (   #00009516' TO DFHEIV0
 10143     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10145     MOVE X'2020233030303039353136' TO DFHEIV0(25:11)
 10146     CALL 'kxdfhei1' USING DFHEIV0,
 10147           CNTL-FILE-ID,
 10148           DFHEIV20,
 10149           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 182
* EL131.cbl
 10150           BENEFIT-KEY,
 10151           DFHEIV99,
 10152           DFHEIV99,
 10153           DFHEIV99
 10154     SET ADDRESS OF CONTROL-FILE TO
 10155         DFHEIV20
 10156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10157
 10158
 10159     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10160        CF-RECORD-TYPE NOT = '4'
 10161         GO TO 1240-SET-ERROR.
 10162
 10163     MOVE ZERO                   TO COUNT-2.
 10164     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10165
 10166     IF SCREEN-ERROR
 10167         GO TO 1240-SET-ERROR.
 10168
 10169 1240-SET-CODE-SWITCHES.
 10170     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10171     MOVE AL-UANON               TO LCVCDA.
 10172     GO TO 1240-EXIT.
 10173
 10174 1240-SET-ERROR.
 10175     MOVE ER-0240                TO EMI-ERROR.
 10176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10177     MOVE 'X'                    TO ERROR-SWITCH.
 10178     MOVE AL-UABON               TO LCVCDA.
 10179     MOVE -1                     TO LCVCDL.
 10180
 10181 1240-EXIT.
 10182     EXIT.
 10183
 10184 1310-EDIT-AH-CODE.
 10185     IF INVALID-BENEFIT-CODE
 10186         GO TO 1310-SET-ERROR.
 10187
 10188     MOVE SPACES                 TO BENEFIT-KEY.
 10189     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10190     MOVE '5'                    TO BEN-REC-TYPE.
 10191     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10192     MOVE ZERO                   TO BEN-SEQ-NO.
 10193
 10194
 10195* EXEC CICS READ GTEQ
 10196*         DATASET  (CNTL-FILE-ID)
 10197*         RIDFLD   (BENEFIT-KEY)
 10198*         SET      (ADDRESS OF CONTROL-FILE)
 10199*    END-EXEC.
 10200*    MOVE '&"S        G          (   #00009557' TO DFHEIV0
 10201     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10203     MOVE X'2020233030303039353537' TO DFHEIV0(25:11)
 10204     CALL 'kxdfhei1' USING DFHEIV0,
 10205           CNTL-FILE-ID,
 10206           DFHEIV20,
 10207           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 183
* EL131.cbl
 10208           BENEFIT-KEY,
 10209           DFHEIV99,
 10210           DFHEIV99,
 10211           DFHEIV99
 10212     SET ADDRESS OF CONTROL-FILE TO
 10213         DFHEIV20
 10214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10215
 10216
 10217     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10218        CF-RECORD-TYPE NOT = '5'
 10219         GO TO 1310-SET-ERROR.
 10220
 10221     MOVE ZERO                   TO COUNT-2.
 10222     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10223     IF SCREEN-ERROR
 10224         GO TO 1310-SET-ERROR.
 10225
 10226 1310-SET-CODE-SWITCHES.
 10227     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10228     MOVE AL-UANON               TO ACVCDA.
 10229     GO TO 1310-EXIT.
 10230
 10231 1310-SET-ERROR.
 10232     MOVE ER-0250                TO EMI-ERROR.
 10233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10234     MOVE AL-UABON               TO ACVCDA.
 10235     MOVE 'X'                    TO ERROR-SWITCH.
 10236     MOVE -1                     TO ACVCDL.
 10237
 10238 1310-EXIT.
 10239     EXIT.
 10240
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 184
* EL131.cbl
 10242 1460-EDIT-CERT-NO.
 10243     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10244     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10245
 10246     IF WS-SAVE-CERT-NO = SPACES
 10247         MOVE ER-0203            TO EMI-ERROR
 10248         GO TO 1460-CERT-NO-ERROR.
 10249
 10250     IF WS-CERT-NO-PRIME = SPACES AND
 10251        WS-CERT-NO-SUFX GREATER THAN SPACE
 10252            MOVE ER-0210         TO EMI-ERROR
 10253            GO TO 1460-CERT-NO-ERROR.
 10254
 10255     MOVE 'X'                    TO UPDATE-SWITCH.
 10256     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10257     MOVE AL-UANON               TO CERTA.
 10258
 10259     IF SUFXL IS GREATER THAN 0
 10260         MOVE AL-UANON           TO SUFXA.
 10261
 10262     GO TO 1460-EXIT.
 10263
 10264 1460-CERT-NO-ERROR.
 10265     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10266     MOVE AL-UABON               TO SUFXA.
 10267     MOVE AL-UABON               TO CERTA.
 10268     MOVE -1                     TO CERTL.
 10269     MOVE 'X'                    TO ERROR-SWITCH.
 10270
 10271 1460-EXIT.
 10272     EXIT.
 10273
 10274 1470-EDIT-EFF.
 10275     IF CERTEFFI = SPACES
 10276         GO TO 1470-DATE-ERROR.
 10277
 10278     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10279     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10280     IF DEEDIT-DATE = ZERO
 10281         GO TO 1470-DATE-ERROR.
 10282
 10283     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10284     MOVE '4'                    TO DC-OPTION-CODE.
 10285     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10286     IF NOT DATE-CONVERSION-ERROR
 10287         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10288         MOVE AL-UANON           TO CERTEFFA
 10289         MOVE 'X'                TO UPDATE-SWITCH
 10290         MOVE 'Y'                TO CERT-KEY-SWITCH
 10291         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10292         GO TO 1470-EXIT.
 10293
 10294 1470-DATE-ERROR.
 10295     MOVE ER-0215                TO EMI-ERROR.
 10296     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10297     MOVE AL-UABON               TO CERTEFFA.
 10298     MOVE -1                     TO CERTEFFL.
 10299     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 185
* EL131.cbl
 10300
 10301 1470-EXIT.
 10302     EXIT.
 10303
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 186
* EL131.cbl
 10305 1480-EDIT-ACCT.
 10306     IF CERTACTI = SPACES
 10307         MOVE ER-0232            TO EMI-ERROR
 10308         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10309         MOVE AL-UABON           TO CERTACTA
 10310         MOVE -1                 TO CERTACTL
 10311         MOVE 'X'                TO ERROR-SWITCH
 10312     ELSE
 10313         MOVE 'X'                TO UPDATE-SWITCH
 10314         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10315
 10316 1480-EXIT.
 10317     EXIT.
 10318
 10319 1490-EDIT-STATE.
 10320     IF CERTSTI = SPACES
 10321         MOVE ER-0233            TO EMI-ERROR
 10322         GO TO 1490-STATE-ERROR.
 10323
 10324     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10325     MOVE '3'                    TO CNTL-REC-TYPE.
 10326     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10327     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10328     MOVE ZERO                   TO CNTL-SEQ-NO.
 10329
 10330
 10331* EXEC CICS HANDLE CONDITION
 10332*         NOTFND (1490-STATE-NOTFND)
 10333*    END-EXEC.
 10334*    MOVE '"$I                   ! ) #00009676' TO DFHEIV0
 10335     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10337     MOVE X'2920233030303039363736' TO DFHEIV0(25:11)
 10338     CALL 'kxdfhei1' USING DFHEIV0
 10339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10340
 10341
 10342
 10343* EXEC CICS READ
 10344*         SET        (ADDRESS OF CONTROL-FILE)
 10345*         DATASET    ('ELCNTL')
 10346*         RIDFLD     (CNTL-KEY)
 10347*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10348*         GENERIC
 10349*    END-EXEC.
 10350     MOVE 'ELCNTL' TO DFHEIV1
 10351*    MOVE '&"S  KG    E          (   #00009680' TO DFHEIV0
 10352     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10353     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10354     MOVE X'2020233030303039363830' TO DFHEIV0(25:11)
 10355     CALL 'kxdfhei1' USING DFHEIV0,
 10356           DFHEIV1,
 10357           DFHEIV20,
 10358           DFHEIV99,
 10359           CNTL-KEY,
 10360           CNTL-GENERIC-LENGTH,
 10361           DFHEIV99,
 10362           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 187
* EL131.cbl
 10363     SET ADDRESS OF CONTROL-FILE TO
 10364         DFHEIV20
 10365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10366
 10367
 10368     MOVE AL-UANON               TO CERTSTA.
 10369     MOVE 'X'                    TO UPDATE-SWITCH.
 10370     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10371     GO TO 1490-EXIT.
 10372
 10373 1490-STATE-NOTFND.
 10374     MOVE ER-0149                TO EMI-ERROR.
 10375
 10376 1490-STATE-ERROR.
 10377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10378     MOVE AL-UABON               TO CERTSTA.
 10379     MOVE -1                     TO CERTSTL.
 10380     MOVE 'X'                    TO ERROR-SWITCH.
 10381
 10382 1490-EXIT.
 10383     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 188
* EL131.cbl
 10385 1500-EDIT-CARR.
 10386     IF CERTCARI = SPACES
 10387         GO TO 1500-CARR-NOTFND.
 10388
 10389     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10390     MOVE '6'                    TO CNTL-REC-TYPE.
 10391     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10392     MOVE CERTCARI               TO CNTL-CARRIER.
 10393     MOVE ZERO                   TO CNTL-SEQ-NO.
 10394
 10395
 10396* EXEC CICS HANDLE CONDITION
 10397*         NOTFND   (1500-CARR-NOTFND)
 10398*    END-EXEC.
 10399*    MOVE '"$I                   ! * #00009715' TO DFHEIV0
 10400     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10402     MOVE X'2A20233030303039373135' TO DFHEIV0(25:11)
 10403     CALL 'kxdfhei1' USING DFHEIV0
 10404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10405
 10406
 10407
 10408* EXEC CICS READ
 10409*         SET        (ADDRESS OF CONTROL-FILE)
 10410*         DATASET    ('ELCNTL')
 10411*         RIDFLD     (CNTL-KEY)
 10412*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10413*         GENERIC
 10414*    END-EXEC.
 10415     MOVE 'ELCNTL' TO DFHEIV1
 10416*    MOVE '&"S  KG    E          (   #00009719' TO DFHEIV0
 10417     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10419     MOVE X'2020233030303039373139' TO DFHEIV0(25:11)
 10420     CALL 'kxdfhei1' USING DFHEIV0,
 10421           DFHEIV1,
 10422           DFHEIV20,
 10423           DFHEIV99,
 10424           CNTL-KEY,
 10425           CNTL-GENERIC-LENGTH,
 10426           DFHEIV99,
 10427           DFHEIV99
 10428     SET ADDRESS OF CONTROL-FILE TO
 10429         DFHEIV20
 10430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10431
 10432
 10433     MOVE AL-UANON               TO CERTCARA.
 10434     MOVE 'X'                    TO UPDATE-SWITCH.
 10435     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10436     GO TO 1500-EXIT.
 10437
 10438 1500-CARR-NOTFND.
 10439     MOVE ER-0360                TO EMI-ERROR.
 10440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10441     MOVE AL-UABON               TO CERTCARA.
 10442     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 189
* EL131.cbl
 10443     MOVE 'X'                    TO ERROR-SWITCH.
 10444
 10445 1500-EXIT.
 10446     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 190
* EL131.cbl
 10448 1510-DEEDIT-DATE.
 10449
 10450* EXEC CICS BIF DEEDIT
 10451*         FIELD    (DEEDIT-DATE-INPUT)
 10452*         LENGTH   (DATE-LENGTH)
 10453*    END-EXEC.
 10454*    MOVE '@"L                   #   #00009743' TO DFHEIV0
 10455     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10456     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10457     MOVE X'2020233030303039373433' TO DFHEIV0(25:11)
 10458     CALL 'kxdfhei1' USING DFHEIV0,
 10459           DEEDIT-DATE-INPUT,
 10460           DATE-LENGTH
 10461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10462
 10463
 10464 1510-EXIT.
 10465     EXIT.
 10466
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 191
* EL131.cbl
 10468 1620-VERIFY-ACCT.
 10469
 10470     move ' '                    to ws-eracct-sw
 10471     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10472     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10473     MOVE PI-GROUPING            TO ACCT-GROUP.
 10474     MOVE PI-STATE               TO ACCT-STATE.
 10475     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10476
 10477     IF CERTEFFI GREATER THAN LOW-VALUES
 10478         MOVE HOLD-EFF           TO ACCT-DATE
 10479     ELSE
 10480         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10481
 10482     IF CERTACTI GREATER THAN LOW-VALUES
 10483         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10484     IF CERTSTI GREATER THAN LOW-VALUES
 10485         MOVE CERTSTI            TO  ACCT-STATE.
 10486     IF CERTCARI GREATER THAN LOW-VALUES
 10487         MOVE CERTCARI           TO  ACCT-CARRIER.
 10488     IF CERTGRPI GREATER THAN LOW-VALUES
 10489         MOVE CERTGRPI           TO ACCT-GROUP.
 10490
 10491     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10492
 10493
 10494* EXEC CICS HANDLE CONDITION
 10495*         NOTFND  (1620-ACCT-NOTFND)
 10496*    END-EXEC.
 10497*    MOVE '"$I                   ! + #00009777' TO DFHEIV0
 10498     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10500     MOVE X'2B20233030303039373737' TO DFHEIV0(25:11)
 10501     CALL 'kxdfhei1' USING DFHEIV0
 10502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10503
 10504
 10505
 10506* EXEC CICS STARTBR
 10507*         DATASET   (ACCT-FILE-ID)
 10508*         RIDFLD    (ACCT-KEY)
 10509*    END-EXEC.
 10510     MOVE 0
 10511       TO DFHEIV11
 10512*    MOVE '&,         G          &   #00009781' TO DFHEIV0
 10513     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10514     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10515     MOVE X'2020233030303039373831' TO DFHEIV0(25:11)
 10516     CALL 'kxdfhei1' USING DFHEIV0,
 10517           ACCT-FILE-ID,
 10518           ACCT-KEY,
 10519           DFHEIV99,
 10520           DFHEIV11,
 10521           DFHEIV99
 10522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10523
 10524
 10525 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 192
* EL131.cbl
 10526
 10527
 10528* EXEC CICS READNEXT
 10529*         DATASET  (ACCT-FILE-ID)
 10530*         RIDFLD   (ACCT-KEY)
 10531*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10532*    END-EXEC.
 10533     MOVE 0
 10534       TO DFHEIV11
 10535*    MOVE '&.S                   )   #00009788' TO DFHEIV0
 10536     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10537     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10538     MOVE X'2020233030303039373838' TO DFHEIV0(25:11)
 10539     CALL 'kxdfhei1' USING DFHEIV0,
 10540           ACCT-FILE-ID,
 10541           DFHEIV20,
 10542           DFHEIV99,
 10543           ACCT-KEY,
 10544           DFHEIV99,
 10545           DFHEIV11,
 10546           DFHEIV99,
 10547           DFHEIV99
 10548     SET ADDRESS OF ACCOUNT-MASTER TO
 10549         DFHEIV20
 10550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10551
 10552
 10553     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10554         GO TO 1620-ACCT-NOTFND.
 10555
 10556     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10557        HOLD-EFF     LESS AM-EXPIRATION-DT
 10558         NEXT SENTENCE
 10559     ELSE
 10560         GO TO 1620-ACCT-LOOP.
 10561
 10562     set acct-found to true
 10563     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10564         GO TO 1620-ACCT-END-BROWSE.
 10565
 10566     IF LOANBALL GREATER THAN +0
 10567         IF AM-MAX-TOT-BEN NUMERIC  AND
 10568            AM-MAX-TOT-BEN GREATER THAN ZERO
 10569             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10570                 MOVE AL-UNBON     TO LOANBALA
 10571                 MOVE -1           TO LOANBALL
 10572                 MOVE 'X'          TO ERROR-SWITCH
 10573                 MOVE ER-7641      TO EMI-ERROR
 10574                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10575
 10576     IF ACVBENEL GREATER THAN +0
 10577         IF AM-MAX-MON-BEN NUMERIC  AND
 10578            AM-MAX-MON-BEN GREATER THAN ZERO
 10579             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10580                 MOVE AL-UNBON     TO ACVBENEA
 10581                 MOVE -1           TO ACVBENEL
 10582                 MOVE 'X'          TO ERROR-SWITCH
 10583                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 193
* EL131.cbl
 10584                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10585
 10586 1620-ACCT-END-BROWSE.
 10587
 10588
 10589* EXEC CICS ENDBR
 10590*         DATASET (ACCT-FILE-ID)
 10591*    END-EXEC.
 10592     MOVE 0
 10593       TO DFHEIV11
 10594*    MOVE '&2                    $   #00009829' TO DFHEIV0
 10595     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10596     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10597     MOVE X'2020233030303039383239' TO DFHEIV0(25:11)
 10598     CALL 'kxdfhei1' USING DFHEIV0,
 10599           ACCT-FILE-ID,
 10600           DFHEIV11,
 10601           DFHEIV99
 10602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10603
 10604
 10605     GO TO 1620-EXIT.
 10606
 10607 1620-ACCT-NOTFND.
 10608
 10609     MOVE -1                     TO MAINTL.
 10610     MOVE 'X'                    TO ERROR-SWITCH.
 10611     MOVE ER-0426                TO EMI-ERROR.
 10612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10613
 10614 1620-EXIT.
 10615     EXIT.
 10616
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 194
* EL131.cbl
 10618 2000-UPDATE-CLAIM.
 10619
 10620     MOVE SPACES                 TO ERROR-SWITCH.
 10621     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10622     MOVE PI-CARRIER             TO CARRIER-CODE.
 10623     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10624     MOVE PI-CERT-NO             TO CERT-NO.
 10625
 10626     IF DELETE-CLAIM
 10627         GO TO 3000-DELETE-CLAIM.
 10628
 10629     IF  NOT MODIFY-CAP
 10630         MOVE ER-0070            TO EMI-ERROR
 10631         MOVE 'X'                TO ERROR-SWITCH
 10632         MOVE -1                 TO MAINTL
 10633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10634         GO TO 2000-EXIT.
 10635
 10636     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10637     MOVE ZERO                   TO TRLR-SEQ-NO.
 10638
 10639
 10640* EXEC CICS READ UPDATE
 10641*         SET       (ADDRESS OF CLAIM-MASTER)
 10642*         DATASET   (CLMS-FILE-ID)
 10643*         RIDFLD    (MSTR-KEY)
 10644*    END-EXEC.
 10645*    MOVE '&"S        EU         (   #00009867' TO DFHEIV0
 10646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10647     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10648     MOVE X'2020233030303039383637' TO DFHEIV0(25:11)
 10649     CALL 'kxdfhei1' USING DFHEIV0,
 10650           CLMS-FILE-ID,
 10651           DFHEIV20,
 10652           DFHEIV99,
 10653           MSTR-KEY,
 10654           DFHEIV99,
 10655           DFHEIV99,
 10656           DFHEIV99
 10657     SET ADDRESS OF CLAIM-MASTER TO
 10658         DFHEIV20
 10659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10660
 10661
 10662     if (incl > zeros)
 10663        and (cl-no-of-pmts-made > 0)
 10664        and (hold-incur > low-values)
 10665        and (hold-incur not = cl-incurred-dt)
 10666        if hold-incur > cl-incurred-dt
 10667           move cl-incurred-dt   to dc-bin-date-1
 10668           move hold-incur       to dc-bin-date-2
 10669        else
 10670           move hold-incur       to dc-bin-date-1
 10671           move cl-incurred-dt   to dc-bin-date-2
 10672        end-if
 10673        move '1'                 to dc-option-code
 10674        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10675        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 195
* EL131.cbl
 10676           MOVE ER-1663             TO EMI-ERROR
 10677           PERFORM 9900-ERROR-FORMAT
 10678                                 THRU 9900-EXIT
 10679           MOVE -1                  TO MAINTL
 10680           GO TO 8110-SEND-DATA
 10681        end-if
 10682     end-if
 10683     IF (CL-PRIORITY-CD = '8')
 10684        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10685             AND 'AMWA' AND 'KMSB')
 10686        MOVE ER-8003             TO EMI-ERROR
 10687        PERFORM 9900-ERROR-FORMAT
 10688                                 THRU 9900-EXIT
 10689        MOVE -1                  TO MAINTL
 10690        GO TO 8110-SEND-DATA
 10691     END-IF
 10692
 10693     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10694         MOVE ER-0068            TO EMI-ERROR
 10695         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10696         GO TO 2000-EXIT.
 10697
 10698     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10699         MOVE ER-0068            TO EMI-ERROR
 10700         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10701         GO TO 2000-EXIT.
 10702
 10703     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10704         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10705
 10706     IF CL-PURGED-DT NOT = LOW-VALUES
 10707         MOVE ER-7691            TO EMI-ERROR
 10708         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10709         GO TO 2000-EXIT.
 10710
 10711     IF CERT-KEY-CHANGED
 10712         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10713
 10714     IF SCREEN-ERROR
 10715         MOVE ER-0068            TO EMI-ERROR
 10716         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10717         GO TO 2000-EXIT.
 10718
 10719     IF NINETY-TRLR-UPDATED
 10720         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10721
 10722     IF MSTR-KEY-CHANGED
 10723         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10724        ELSE
 10725         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10726
 10727     IF TRLR-UPDATE-REQUIRED
 10728         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10729
 10730 2000-CHECK-CERT.
 10731     IF NOT CERT-UPDATES
 10732         GO TO 2000-EXIT.
 10733
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 196
* EL131.cbl
 10734     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10735     MOVE PI-CARRIER             TO CERT-CARRIER.
 10736     MOVE PI-GROUPING            TO CERT-GROUP.
 10737     MOVE PI-STATE               TO CERT-STATE.
 10738     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10739     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10740     MOVE PI-CERT-NO             TO CERT-CERT.
 10741
 10742     IF CERT-ALT-KEY-CHANGED
 10743         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10744     ELSE
 10745         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10746
 10747 2000-EXIT.
 10748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 197
* EL131.cbl
 10750 2010-RELEASE-REC.
 10751
 10752* EXEC CICS UNLOCK
 10753*         DATASET  (CLMS-FILE-ID)
 10754*    END-EXEC
 10755*    MOVE '&*                    #   #00009962' TO DFHEIV0
 10756     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10757     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10758     MOVE X'2020233030303039393632' TO DFHEIV0(25:11)
 10759     CALL 'kxdfhei1' USING DFHEIV0,
 10760           CLMS-FILE-ID,
 10761           DFHEIV99
 10762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10763
 10764     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10765     MOVE 'X'                    TO ERROR-SWITCH.
 10766
 10767 2010-EXIT.
 10768     EXIT.
 10769
 10770 2020-NORMAL-UPDATE.
 10771     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10772
 10773     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10774
 10775     IF WS-OPEN-CLOSE-SW = 'Y'
 10776       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10777       IF PI-REC-FOUND-SW = 'Y'
 10778         IF CL-ACTIVITY-CODE = 09
 10779           NEXT SENTENCE
 10780         ELSE
 10781           IF WS-RESET-SW = 'Y'
 10782             IF CL-CLAIM-STATUS = 'C'
 10783               MOVE 07               TO  CL-ACTIVITY-CODE
 10784               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10785               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10786             ELSE
 10787               MOVE 08               TO  CL-ACTIVITY-CODE
 10788               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10789               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10790
 10791     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10792         MOVE 'Y'                TO CL-YESNOSW
 10793     END-IF.
 10794
 10795     if pi-company-id = 'DCC' OR 'VPP'
 10796        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10797        perform 2120-check-pdef  thru 2120-exit
 10798     end-if
 10799     if ((benperl <> zeros)
 10800        and (benperi numeric))
 10801                  or
 10802            (instypel <> zeros)
 10803        perform 2140-update-elcrtt thru 2140-exit
 10804     end-if
 10805
 10806* EXEC CICS HANDLE CONDITION
 10807*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 198
* EL131.cbl
 10808*    END-EXEC.
 10809*    MOVE '"$$                   ! , #00010007' TO DFHEIV0
 10810     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10812     MOVE X'2C20233030303130303037' TO DFHEIV0(25:11)
 10813     CALL 'kxdfhei1' USING DFHEIV0
 10814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10815
 10816
 10817
 10818* EXEC CICS REWRITE
 10819*         DATASET   (CLMS-FILE-ID)
 10820*         FROM      (CLAIM-MASTER)
 10821*    END-EXEC.
 10822     MOVE LENGTH OF
 10823      CLAIM-MASTER
 10824       TO DFHEIV11
 10825*    MOVE '&& L                  %   #00010011' TO DFHEIV0
 10826     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10827     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10828     MOVE X'2020233030303130303131' TO DFHEIV0(25:11)
 10829     CALL 'kxdfhei1' USING DFHEIV0,
 10830           CLMS-FILE-ID,
 10831           CLAIM-MASTER,
 10832           DFHEIV11,
 10833           DFHEIV99
 10834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10835
 10836
 10837 2020-EXIT.
 10838     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 199
* EL131.cbl
 10840 2030-KEY-UPDATE.
 10841     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10842
 10843
 10844* EXEC CICS DELETE
 10845*        DATASET  (CLMS-FILE-ID)
 10846*    END-EXEC.
 10847*    MOVE '&(                    &   #00010022' TO DFHEIV0
 10848     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10850     MOVE X'2020233030303130303232' TO DFHEIV0(25:11)
 10851     CALL 'kxdfhei1' USING DFHEIV0,
 10852           CLMS-FILE-ID,
 10853           DFHEIV99,
 10854           DFHEIV99,
 10855           DFHEIV99,
 10856           DFHEIV99
 10857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10858
 10859
 10860
 10861* EXEC CICS GETMAIN
 10862*         SET      (ADDRESS OF CLAIM-MASTER)
 10863*         LENGTH   (MSTR-LENGTH)
 10864*         INITIMG  (GETMAIN-SPACE)
 10865*    END-EXEC.
 10866*    MOVE ',"IL                  $   #00010026' TO DFHEIV0
 10867     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10868     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10869     MOVE X'2020233030303130303236' TO DFHEIV0(25:11)
 10870     CALL 'kxdfhei1' USING DFHEIV0,
 10871           DFHEIV20,
 10872           MSTR-LENGTH,
 10873           GETMAIN-SPACE
 10874     SET ADDRESS OF CLAIM-MASTER TO
 10875         DFHEIV20
 10876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10877
 10878
 10879     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10880
 10881     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10882
 10883     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10884
 10885     IF WS-OPEN-CLOSE-SW = 'Y'
 10886       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10887         IF PI-REC-FOUND-SW = 'Y'
 10888           IF CL-ACTIVITY-CODE = 09
 10889             NEXT SENTENCE
 10890           ELSE
 10891             IF WS-RESET-SW = 'Y'
 10892               IF CL-CLAIM-STATUS = 'C'
 10893                 MOVE 07             TO  CL-ACTIVITY-CODE
 10894                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10895                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10896               ELSE
 10897                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 200
* EL131.cbl
 10898                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10899                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10900
 10901
 10902* EXEC CICS HANDLE CONDITION
 10903*         DUPKEY    (2030-EXIT)
 10904*    END-EXEC.
 10905*    MOVE '"$$                   ! - #00010054' TO DFHEIV0
 10906     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10908     MOVE X'2D20233030303130303534' TO DFHEIV0(25:11)
 10909     CALL 'kxdfhei1' USING DFHEIV0
 10910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10911
 10912
 10913** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10914*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10915
 10916     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10917         MOVE 'Y'                TO CL-YESNOSW
 10918     END-IF.
 10919
 10920
 10921* EXEC CICS WRITE
 10922*         DATASET   (CLMS-FILE-ID)
 10923*         RIDFLD    (MSTR-KEY)
 10924*         FROM      (CLAIM-MASTER)
 10925*    END-EXEC.
 10926     MOVE LENGTH OF
 10927      CLAIM-MASTER
 10928       TO DFHEIV11
 10929*    MOVE '&$ L                  ''   #00010065' TO DFHEIV0
 10930     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10932     MOVE X'2020233030303130303635' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0,
 10934           CLMS-FILE-ID,
 10935           CLAIM-MASTER,
 10936           DFHEIV11,
 10937           MSTR-KEY,
 10938           DFHEIV99,
 10939           DFHEIV99
 10940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10941
 10942
 10943 2030-EXIT.
 10944     EXIT.
 10945
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 201
* EL131.cbl
 10947 2040-NORMAL-UPDATE.
 10948
 10949* EXEC CICS READ UPDATE
 10950*         DATASET  (CERT-FILE-ID)
 10951*         RIDFLD   (CERT-KEY)
 10952*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10953*    END-EXEC.
 10954*    MOVE '&"S        EU         (   #00010076' TO DFHEIV0
 10955     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10956     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10957     MOVE X'2020233030303130303736' TO DFHEIV0(25:11)
 10958     CALL 'kxdfhei1' USING DFHEIV0,
 10959           CERT-FILE-ID,
 10960           DFHEIV20,
 10961           DFHEIV99,
 10962           CERT-KEY,
 10963           DFHEIV99,
 10964           DFHEIV99,
 10965           DFHEIV99
 10966     SET ADDRESS OF CERTIFICATE-MASTER TO
 10967         DFHEIV20
 10968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10969
 10970
 10971     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10972
 10973
 10974* EXEC CICS HANDLE CONDITION
 10975*         DUPKEY   (2040-EXIT)
 10976*    END-EXEC.
 10977*    MOVE '"$$                   ! . #00010084' TO DFHEIV0
 10978     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10979     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10980     MOVE X'2E20233030303130303834' TO DFHEIV0(25:11)
 10981     CALL 'kxdfhei1' USING DFHEIV0
 10982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10983
 10984
 10985
 10986* EXEC CICS REWRITE
 10987*         DATASET  (CERT-FILE-ID)
 10988*         FROM     (CERTIFICATE-MASTER)
 10989*    END-EXEC.
 10990     MOVE LENGTH OF
 10991      CERTIFICATE-MASTER
 10992       TO DFHEIV11
 10993*    MOVE '&& L                  %   #00010088' TO DFHEIV0
 10994     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10995     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10996     MOVE X'2020233030303130303838' TO DFHEIV0(25:11)
 10997     CALL 'kxdfhei1' USING DFHEIV0,
 10998           CERT-FILE-ID,
 10999           CERTIFICATE-MASTER,
 11000           DFHEIV11,
 11001           DFHEIV99
 11002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11003
 11004
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 202
* EL131.cbl
 11005 2040-EXIT.
 11006     EXIT.
 11007
 11008 2050-KEY-UPDATE.
 11009
 11010* EXEC CICS READ UPDATE
 11011*         DATASET  (CERT-FILE-ID)
 11012*         RIDFLD   (CERT-KEY)
 11013*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11014*    END-EXEC.
 11015*    MOVE '&"S        EU         (   #00010097' TO DFHEIV0
 11016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11017     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11018     MOVE X'2020233030303130303937' TO DFHEIV0(25:11)
 11019     CALL 'kxdfhei1' USING DFHEIV0,
 11020           CERT-FILE-ID,
 11021           DFHEIV20,
 11022           DFHEIV99,
 11023           CERT-KEY,
 11024           DFHEIV99,
 11025           DFHEIV99,
 11026           DFHEIV99
 11027     SET ADDRESS OF CERTIFICATE-MASTER TO
 11028         DFHEIV20
 11029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11030
 11031
 11032     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 11033
 11034
 11035* EXEC CICS DELETE
 11036*         DATASET   (CERT-FILE-ID)
 11037*    END-EXEC.
 11038*    MOVE '&(                    &   #00010105' TO DFHEIV0
 11039     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11040     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11041     MOVE X'2020233030303130313035' TO DFHEIV0(25:11)
 11042     CALL 'kxdfhei1' USING DFHEIV0,
 11043           CERT-FILE-ID,
 11044           DFHEIV99,
 11045           DFHEIV99,
 11046           DFHEIV99,
 11047           DFHEIV99
 11048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11049
 11050
 11051
 11052* EXEC CICS GETMAIN
 11053*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11054*         LENGTH    (CERT-LENGTH)
 11055*         INITIMG   (GETMAIN-SPACE)
 11056*    END-EXEC.
 11057*    MOVE ',"IL                  $   #00010109' TO DFHEIV0
 11058     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11060     MOVE X'2020233030303130313039' TO DFHEIV0(25:11)
 11061     CALL 'kxdfhei1' USING DFHEIV0,
 11062           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 203
* EL131.cbl
 11063           CERT-LENGTH,
 11064           GETMAIN-SPACE
 11065     SET ADDRESS OF CERTIFICATE-MASTER TO
 11066         DFHEIV20
 11067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11068
 11069
 11070     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 11071
 11072     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11073
 11074
 11075* EXEC CICS HANDLE CONDITION
 11076*         DUPKEY (2050-EXIT)
 11077*    END-EXEC.
 11078*    MOVE '"$$                   ! / #00010119' TO DFHEIV0
 11079     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11081     MOVE X'2F20233030303130313139' TO DFHEIV0(25:11)
 11082     CALL 'kxdfhei1' USING DFHEIV0
 11083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11084
 11085
 11086
 11087* EXEC CICS WRITE
 11088*         DATASET  (CERT-FILE-ID)
 11089*         RIDFLD   (CERT-KEY)
 11090*         FROM     (CERTIFICATE-MASTER)
 11091*    END-EXEC.
 11092     MOVE LENGTH OF
 11093      CERTIFICATE-MASTER
 11094       TO DFHEIV11
 11095*    MOVE '&$ L                  ''   #00010123' TO DFHEIV0
 11096     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11097     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11098     MOVE X'2020233030303130313233' TO DFHEIV0(25:11)
 11099     CALL 'kxdfhei1' USING DFHEIV0,
 11100           CERT-FILE-ID,
 11101           CERTIFICATE-MASTER,
 11102           DFHEIV11,
 11103           CERT-KEY,
 11104           DFHEIV99,
 11105           DFHEIV99
 11106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11107
 11108
 11109 2050-EXIT.
 11110     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 204
* EL131.cbl
 11112 2060-CHANGE-CERT.
 11113     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11114     MOVE PI-CARRIER             TO CERT-CARRIER.
 11115     MOVE PI-GROUPING            TO CERT-GROUP.
 11116     MOVE PI-STATE               TO CERT-STATE.
 11117     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11118     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11119     MOVE PI-CERT-NO             TO CERT-CERT.
 11120     IF CERTEFFI GREATER THAN LOW-VALUES
 11121         MOVE HOLD-EFF           TO CERT-DATE.
 11122     IF CERTACTI GREATER THAN LOW-VALUES
 11123         MOVE CERTACTI           TO CERT-ACCOUNT.
 11124     IF CERTSTI GREATER THAN LOW-VALUES
 11125         MOVE CERTSTI            TO CERT-STATE.
 11126     IF CERTCARI GREATER THAN LOW-VALUES
 11127         MOVE CERTCARI           TO CERT-CARRIER.
 11128     IF CERTGRPI GREATER THAN LOW-VALUES
 11129         MOVE CERTGRPI           TO CERT-GROUP.
 11130     IF CERTI GREATER THAN LOW-VALUES
 11131         MOVE CERTI              TO CERT-CERT-PRIME.
 11132     IF SUFXI GREATER THAN LOW-VALUES
 11133         MOVE SUFXI              TO CERT-CERT-SUFX.
 11134
 11135
 11136* EXEC CICS HANDLE CONDITION
 11137*         NOTFND   (2060-CERT-NOTFND)
 11138*    END-EXEC.
 11139*    MOVE '"$I                   ! 0 #00010155' TO DFHEIV0
 11140     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11142     MOVE X'3020233030303130313535' TO DFHEIV0(25:11)
 11143     CALL 'kxdfhei1' USING DFHEIV0
 11144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11145
 11146
 11147
 11148* EXEC CICS READ UPDATE
 11149*         DATASET  (CERT-FILE-ID)
 11150*         RIDFLD   (CERT-KEY)
 11151*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11152*    END-EXEC.
 11153*    MOVE '&"S        EU         (   #00010159' TO DFHEIV0
 11154     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11155     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11156     MOVE X'2020233030303130313539' TO DFHEIV0(25:11)
 11157     CALL 'kxdfhei1' USING DFHEIV0,
 11158           CERT-FILE-ID,
 11159           DFHEIV20,
 11160           DFHEIV99,
 11161           CERT-KEY,
 11162           DFHEIV99,
 11163           DFHEIV99,
 11164           DFHEIV99
 11165     SET ADDRESS OF CERTIFICATE-MASTER TO
 11166         DFHEIV20
 11167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11168
 11169
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 205
* EL131.cbl
 11170     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11171
 11172     IF CM-CLAIM-INTERFACE-SW = SPACES
 11173        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11174
 11175
 11176* EXEC CICS HANDLE CONDITION
 11177*         DUPKEY   (2060-DUPKEY)
 11178*    END-EXEC.
 11179*    MOVE '"$$                   ! 1 #00010170' TO DFHEIV0
 11180     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11182     MOVE X'3120233030303130313730' TO DFHEIV0(25:11)
 11183     CALL 'kxdfhei1' USING DFHEIV0
 11184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11185
 11186
 11187
 11188* EXEC CICS REWRITE
 11189*         DATASET  (CERT-FILE-ID)
 11190*         FROM     (CERTIFICATE-MASTER)
 11191*    END-EXEC.
 11192     MOVE LENGTH OF
 11193      CERTIFICATE-MASTER
 11194       TO DFHEIV11
 11195*    MOVE '&& L                  %   #00010174' TO DFHEIV0
 11196     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11197     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11198     MOVE X'2020233030303130313734' TO DFHEIV0(25:11)
 11199     CALL 'kxdfhei1' USING DFHEIV0,
 11200           CERT-FILE-ID,
 11201           CERTIFICATE-MASTER,
 11202           DFHEIV11,
 11203           DFHEIV99
 11204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11205
 11206
 11207 2060-DUPKEY.
 11208
 11209     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11210
 11211 2060-CHANGE-TRLR-ACTQ.
 11212     IF SCREEN-ERROR
 11213         GO TO 2060-EXIT.
 11214
 11215     IF CERTI    GREATER LOW-VALUES OR
 11216        SUFXI    GREATER LOW-VALUES OR
 11217        CERTCARI GREATER LOW-VALUES
 11218         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11219         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11220
 11221     MOVE SPACES                 TO CERT-KEY-SWITCH
 11222                                    CERT-SWITCH
 11223                                    TRLR-SWITCH
 11224                                    NINETY-TRLR-SWITCH.
 11225     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11226     GO TO 2060-EXIT.
 11227
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 206
* EL131.cbl
 11228 2060-CERT-NOTFND.
 11229     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11230
 11231     IF WS-REC-FOUND-SW = 'N'
 11232         MOVE ER-0206            TO  EMI-ERROR
 11233         MOVE -1                 TO  MAINTL
 11234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11235
 11236* EXEC CICS UNLOCK
 11237*            DATASET   (CLMS-FILE-ID)
 11238*        END-EXEC
 11239*    MOVE '&*                    #   #00010207' TO DFHEIV0
 11240     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11241     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11242     MOVE X'2020233030303130323037' TO DFHEIV0(25:11)
 11243     CALL 'kxdfhei1' USING DFHEIV0,
 11244           CLMS-FILE-ID,
 11245           DFHEIV99
 11246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11247         GO TO 8110-SEND-DATA.
 11248
 11249     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11250
 11251     GO TO 2060-CHANGE-TRLR-ACTQ.
 11252
 11253 2060-EXIT.
 11254     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 207
* EL131.cbl
 11256 2070-CHECK-OLD.
 11257
 11258
 11259* EXEC CICS HANDLE CONDITION
 11260*        NOTFND   (2070-NOT-FOUND)
 11261*    END-EXEC.
 11262*    MOVE '"$I                   ! 2 #00010221' TO DFHEIV0
 11263     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11265     MOVE X'3220233030303130323231' TO DFHEIV0(25:11)
 11266     CALL 'kxdfhei1' USING DFHEIV0
 11267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11268
 11269
 11270     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11271     MOVE PI-CARRIER             TO CERT-CARRIER.
 11272     MOVE PI-GROUPING            TO CERT-GROUP.
 11273     MOVE PI-STATE               TO CERT-STATE.
 11274     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11275     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11276     MOVE PI-CERT-NO             TO CERT-CERT.
 11277
 11278
 11279* EXEC CICS READ UPDATE
 11280*         DATASET  (CERT-FILE-ID)
 11281*         RIDFLD   (CERT-KEY)
 11282*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11283*    END-EXEC.
 11284*    MOVE '&"S        EU         (   #00010233' TO DFHEIV0
 11285     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11286     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11287     MOVE X'2020233030303130323333' TO DFHEIV0(25:11)
 11288     CALL 'kxdfhei1' USING DFHEIV0,
 11289           CERT-FILE-ID,
 11290           DFHEIV20,
 11291           DFHEIV99,
 11292           CERT-KEY,
 11293           DFHEIV99,
 11294           DFHEIV99,
 11295           DFHEIV99
 11296     SET ADDRESS OF CERTIFICATE-MASTER TO
 11297         DFHEIV20
 11298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11299
 11300
 11301     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11302     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11303     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11304
 11305     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11306         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11307
 11308     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11309       AND
 11310        CERT-WAS-CREATED-FOR-CLAIM
 11311         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11312
 11313* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 208
* EL131.cbl
 11314*             DATASET   (CERT-FILE-ID)
 11315*        END-EXEC
 11316*    MOVE '&(                    &   #00010250' TO DFHEIV0
 11317     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11318     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11319     MOVE X'2020233030303130323530' TO DFHEIV0(25:11)
 11320     CALL 'kxdfhei1' USING DFHEIV0,
 11321           CERT-FILE-ID,
 11322           DFHEIV99,
 11323           DFHEIV99,
 11324           DFHEIV99,
 11325           DFHEIV99
 11326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11327         GO TO 2070-EXIT.
 11328
 11329     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11330         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11331
 11332
 11333* EXEC CICS HANDLE CONDITION
 11334*         DUPKEY   (2070-EXIT)
 11335*    END-EXEC.
 11336*    MOVE '"$$                   ! 3 #00010258' TO DFHEIV0
 11337     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11339     MOVE X'3320233030303130323538' TO DFHEIV0(25:11)
 11340     CALL 'kxdfhei1' USING DFHEIV0
 11341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11342
 11343
 11344
 11345* EXEC CICS REWRITE
 11346*         DATASET  (CERT-FILE-ID)
 11347*         FROM     (CERTIFICATE-MASTER)
 11348*    END-EXEC.
 11349     MOVE LENGTH OF
 11350      CERTIFICATE-MASTER
 11351       TO DFHEIV11
 11352*    MOVE '&& L                  %   #00010262' TO DFHEIV0
 11353     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11354     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11355     MOVE X'2020233030303130323632' TO DFHEIV0(25:11)
 11356     CALL 'kxdfhei1' USING DFHEIV0,
 11357           CERT-FILE-ID,
 11358           CERTIFICATE-MASTER,
 11359           DFHEIV11,
 11360           DFHEIV99
 11361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11362
 11363
 11364     GO TO 2070-EXIT.
 11365
 11366 2070-NOT-FOUND.
 11367     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11368
 11369 2070-EXIT.
 11370     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 209
* EL131.cbl
 11372 2080-CREATE-CERT.
 11373
 11374* EXEC CICS GETMAIN
 11375*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11376*         LENGTH    (CERT-LENGTH)
 11377*         INITIMG   (GETMAIN-SPACE)
 11378*    END-EXEC.
 11379*    MOVE ',"IL                  $   #00010276' TO DFHEIV0
 11380     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11381     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11382     MOVE X'2020233030303130323736' TO DFHEIV0(25:11)
 11383     CALL 'kxdfhei1' USING DFHEIV0,
 11384           DFHEIV20,
 11385           CERT-LENGTH,
 11386           GETMAIN-SPACE
 11387     SET ADDRESS OF CERTIFICATE-MASTER TO
 11388         DFHEIV20
 11389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11390
 11391
 11392     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11393
 11394     IF CERTEFFI GREATER THAN LOW-VALUES
 11395         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11396                                    DC-BIN-DATE-1
 11397         MOVE '6'                TO DC-OPTION-CODE
 11398         MOVE +1                 TO DC-ELAPSED-MONTHS
 11399         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11400         IF NO-CONVERSION-ERROR
 11401             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11402
 11403     IF CERTACTI GREATER THAN LOW-VALUES
 11404         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11405     IF CERTSTI GREATER THAN LOW-VALUES
 11406         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11407     IF CERTCARI GREATER THAN LOW-VALUES
 11408         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11409     IF CERTGRPI GREATER THAN LOW-VALUES
 11410         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11411     IF CERTI GREATER THAN LOW-VALUES
 11412         MOVE CERTI              TO CERT-CERT-PRIME
 11413                                    CM-CERT-PRIME
 11414         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11415
 11416     IF SUFXI GREATER THAN LOW-VALUES
 11417         MOVE SUFXI              TO CERT-CERT-SUFX
 11418                                    CM-CERT-SFX
 11419         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11420
 11421     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11422
 11423     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11424
 11425     MOVE SPACES                 TO CM-ENTRY-BATCH
 11426                                    CM-LF-EXIT-BATCH
 11427                                    CM-AH-EXIT-BATCH
 11428                                    CM-CREDIT-INTERFACE-SW-1
 11429                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 210
* EL131.cbl
 11430
 11431     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11432                               '9' OR 'D' OR 'V'
 11433         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11434
 11435     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11436                               '9' OR 'D' OR 'V'
 11437         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11438
 11439     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11440                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11441     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11442
 11443
 11444* EXEC CICS HANDLE CONDITION
 11445*         DUPKEY (2080-EXIT)
 11446*    END-EXEC.
 11447*    MOVE '"$$                   ! 4 #00010333' TO DFHEIV0
 11448     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11450     MOVE X'3420233030303130333333' TO DFHEIV0(25:11)
 11451     CALL 'kxdfhei1' USING DFHEIV0
 11452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11453
 11454
 11455
 11456* EXEC CICS WRITE
 11457*         DATASET  (CERT-FILE-ID)
 11458*         RIDFLD   (CERT-KEY)
 11459*         FROM     (CERTIFICATE-MASTER)
 11460*    END-EXEC.
 11461     MOVE LENGTH OF
 11462      CERTIFICATE-MASTER
 11463       TO DFHEIV11
 11464*    MOVE '&$ L                  ''   #00010337' TO DFHEIV0
 11465     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11466     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11467     MOVE X'2020233030303130333337' TO DFHEIV0(25:11)
 11468     CALL 'kxdfhei1' USING DFHEIV0,
 11469           CERT-FILE-ID,
 11470           CERTIFICATE-MASTER,
 11471           DFHEIV11,
 11472           CERT-KEY,
 11473           DFHEIV99,
 11474           DFHEIV99
 11475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11476
 11477
 11478 2080-EXIT.
 11479     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 211
* EL131.cbl
 11481 2100-MOVE-MSTR.
 11482     IF TYPEI GREATER THAN LOW-VALUES
 11483         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11484
 11485     IF STATUSI = LOW-VALUES
 11486         GO TO 2100-NO-STATUS-CHANGE.
 11487
 11488     IF STATUSI = 'OPEN' OR 'O'
 11489         IF CL-CLAIM-STATUS = 'O'
 11490             MOVE SPACES         TO TRLR-SWITCH
 11491                 GO TO 2100-NO-STATUS-CHANGE.
 11492
 11493     IF STATUSI = 'CLOSED' OR 'C'
 11494         IF CL-CLAIM-STATUS = 'C'
 11495             MOVE SPACES         TO TRLR-SWITCH
 11496                 GO TO 2100-NO-STATUS-CHANGE.
 11497
 11498     IF PI-COMPANY-ID = 'DMD'
 11499        IF STATUSI = 'OPEN' OR 'O'
 11500           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11501              MOVE ZERO       TO STATUSL
 11502              MOVE LOW-VALUES TO STATUSI
 11503              GO TO 2100-NO-STATUS-CHANGE.
 11504
 11505     IF PI-COMPANY-ID = 'DMD'
 11506         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11507
 11508     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11509
 11510 2100-NO-STATUS-CHANGE.
 11511
 11512     IF CCNOI GREATER THAN LOW-VALUES
 11513         MOVE CCNOI              TO CL-CCN.
 11514
 11515     IF PROCI GREATER THAN LOW-VALUES
 11516         MOVE PROCI              TO CL-PROCESSOR-ID.
 11517
 11518     if (accswi > low-values)
 11519        and (accswi = 'Y' OR 'N')
 11520        move accswi              to cl-accident-claim-sw
 11521     end-if
 11522     if benperi > low-values
 11523        and benperi numeric
 11524        move benperi             to cl-benefit-period
 11525     end-if
 11526     if instypei > low-values
 11527        move instypei            to cl-insured-type
 11528     end-if
 11529     IF SEXI GREATER THAN LOW-VALUES
 11530         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11531
 11532     IF BIRTHI GREATER THAN LOW-VALUES
 11533         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11534
 11535     IF SOCIALI GREATER THAN LOW-VALUES
 11536       AND
 11537        SOCIALI = SPACES
 11538         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 212
* EL131.cbl
 11539         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11540         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11541     ELSE
 11542         IF SOCIALI GREATER THAN LOW-VALUES
 11543             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11544
 11545     IF OCCI GREATER THAN LOW-VALUES
 11546         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11547
 11548     IF BENEL GREATER THAN ZERO
 11549         MOVE BENEI              TO CL-BENEFICIARY.
 11550
 11551     IF DIAGI GREATER THAN LOW-VALUES
 11552         MOVE DIAGI              TO WS-DIAGNOSIS.
 11553
 11554     IF ICD1I GREATER THAN LOW-VALUES
 11555         MOVE ICD1I              TO WS-ICD-CODE-1
 11556     END-IF.
 11557
 11558     IF ICD2I GREATER THAN LOW-VALUES
 11559         MOVE ICD2I              TO WS-ICD-CODE-2
 11560     END-IF.
 11561
 11562     IF PREMTYPI GREATER THAN LOW-VALUES
 11563         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11564
 11565*    IF CAUSEI GREATER THAN LOW-VALUES
 11566*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11567
 11568*    IF ENDI GREATER THAN LOW-VALUES
 11569*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11570
 11571     IF PDTHRUI GREATER THAN LOW-VALUES
 11572        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11573
 11574     IF PDAMTL GREATER THAN +0
 11575        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11576
 11577     IF NODAYSI GREATER THAN LOW-VALUES
 11578        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11579
 11580     IF NOPMTSI GREATER THAN LOW-VALUES
 11581        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11582
 11583     IF FORMTYPI GREATER THAN LOW-VALUES
 11584        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11585
 11586     IF INCI GREATER THAN LOW-VALUES
 11587        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11588
 11589     IF REPI GREATER THAN LOW-VALUES
 11590        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11591
 11592     IF ADDONDTI GREATER THAN LOW-VALUES
 11593        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11594
 11595     IF PRICDI GREATER THAN LOW-VALUES
 11596         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 213
* EL131.cbl
 11597
 11598     IF CRITPL  > ZEROS
 11599        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11600     END-IF
 11601
 11602     IF EXTENSL  > ZEROS
 11603        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11604     END-IF
 11605*    IF CRITPTL > ZEROS
 11606*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11607*    END-IF
 11608
 11609*    IF RTWMOSL > ZEROS
 11610*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11611*    END-IF
 11612     IF FILETOI GREATER THAN LOW-VALUES
 11613         MOVE FILETOI            TO CL-FILE-LOCATION.
 11614
 11615     IF SUPVI GREATER THAN LOW-VALUES
 11616         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11617
 11618     IF MLNAMEI GREATER THAN LOW-VALUES
 11619         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11620
 11621     IF MFNAMEI GREATER THAN LOW-VALUES
 11622         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11623
 11624     IF MMINITI GREATER THAN LOW-VALUES
 11625         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11626
 11627     IF CERTEFFI GREATER THAN LOW-VALUES
 11628         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11629
 11630     IF CERTACTI GREATER THAN LOW-VALUES
 11631         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11632
 11633     IF CERTSTI GREATER THAN LOW-VALUES
 11634         MOVE CERTSTI            TO CL-CERT-STATE.
 11635
 11636     IF CERTCARI GREATER THAN LOW-VALUES
 11637         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11638                                    CL-CARRIER.
 11639
 11640     IF CERTGRPI GREATER THAN LOW-VALUES
 11641         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11642
 11643     IF CERTI GREATER THAN LOW-VALUES
 11644         MOVE CERTI              TO CERT-NO-PRIME.
 11645
 11646     IF SUFXI GREATER THAN LOW-VALUES
 11647         MOVE SUFXI              TO CERT-NO-SUFX.
 11648
 11649     MOVE CERT-NO                TO CL-CERT-NO
 11650                                    CL-CERT-NO-A4.
 11651
 11652     IF PI-COMPANY-ID = 'FLA'
 11653          NEXT SENTENCE
 11654     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 214
* EL131.cbl
 11655         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11656         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11657         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11658         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11659
 11660     IF TRLR-UPDATE-REQUIRED
 11661        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11662        MOVE ZEROS              TO TRLR-SEQ-NO
 11663
 11664* EXEC CICS READ
 11665*            DATASET   (TRLR-FILE-ID)
 11666*            RIDFLD    (TRLR-KEY)
 11667*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11668*       END-EXEC
 11669*    MOVE '&"S        E          (   #00010528' TO DFHEIV0
 11670     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11672     MOVE X'2020233030303130353238' TO DFHEIV0(25:11)
 11673     CALL 'kxdfhei1' USING DFHEIV0,
 11674           TRLR-FILE-ID,
 11675           DFHEIV20,
 11676           DFHEIV99,
 11677           TRLR-KEY,
 11678           DFHEIV99,
 11679           DFHEIV99,
 11680           DFHEIV99
 11681     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11682         DFHEIV20
 11683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11684        IF AT-TRAILER-TYPE = '1'
 11685           MOVE +1 TO MISC-SUB
 11686           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11687           MISC-SUB GREATER THAN +6 OR
 11688           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11689           IF MISC-SUB GREATER THAN +1
 11690              SUBTRACT +1 FROM MISC-SUB
 11691              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11692                 GO TO 2100-BYPASS-LAST-UPDATE.
 11693
 11694     IF TRLR-UPDATE-REQUIRED AND
 11695        CLAIM-IS-OPEN
 11696         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11697     ELSE
 11698         IF TRLR-UPDATE-REQUIRED AND
 11699            CLAIM-IS-CLOSED
 11700             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11701             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11702
 11703 2100-BYPASS-LAST-UPDATE.
 11704     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11705     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11706
 11707     GO TO 2100-EXIT.
 11708
 11709 2100-BUMP-OPEN-CLOSE-HIST.
 11710     ADD +1                      TO MISC-SUB.
 11711
 11712 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 215
* EL131.cbl
 11713     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 216
* EL131.cbl
 11715 2120-check-pdef.
 11716     move +0                     to s1
 11717     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11718     move spaces                 to ws-dcc-error-line
 11719     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11720     IF ERPDEF-FOUND
 11721        perform 2130-check-trlr  thru 2130-exit
 11722        move +1                  to s1
 11723*       if cl-accident-claim-sw = ' '
 11724*          move er-1655             to ws-error-no (s1)
 11725*          add +1 to s1
 11726*       end-if
 11727        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11728        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11729        if (hold-incur > low-values)
 11730           and (incl > zeros)
 11731           and (hold-incur not = cl-incurred-dt)
 11732           move hold-incur       to dc-bin-date-2
 11733        end-if
 11734        MOVE '1'                 TO DC-OPTION-CODE
 11735        MOVE +0                  TO DC-ELAPSED-MONTHS
 11736                                    DC-ELAPSED-DAYS
 11737        PERFORM 9800-CONVERT-DATE
 11738                                 THRU 9800-EXIT
 11739        IF NO-CONVERSION-ERROR
 11740           MOVE DC-ELAPSED-MONTHS
 11741                                 TO WS-MONTHS-BETWEEN
 11742           IF DC-ELAPSED-DAYS > 1
 11743              ADD 1 TO WS-MONTHS-BETWEEN
 11744           END-IF
 11745        ELSE
 11746           display ' dte conv error ' dc-error-code
 11747           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11748        END-IF
 11749        IF (WS-EXCL-PERIOD = ZEROS)
 11750           OR (WS-MONTHS-BETWEEN = ZEROS)
 11751           CONTINUE
 11752        ELSE
 11753           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11754              MOVE ER-1651       TO ws-error-no (s1)
 11755              add +1             to s1
 11756           END-IF
 11757        END-IF
 11758        IF (WS-COV-ENDS = ZEROS)
 11759           OR (WS-MONTHS-BETWEEN = ZEROS)
 11760           CONTINUE
 11761        ELSE
 11762           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11763              MOVE -1            TO MAINTL
 11764              MOVE ER-1653       TO ws-error-no (s1)
 11765              add +1 to s1
 11766           END-IF
 11767        END-IF
 11768        IF (WS-ACC-PERIOD = ZEROS)
 11769           OR (WS-MONTHS-BETWEEN = ZEROS)
 11770           CONTINUE
 11771        ELSE
 11772           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 217
* EL131.cbl
 11773              and (accswi = spaces or low-values)
 11774*             and (cl-accident-claim-sw = ' ')
 11775              move er-1655       to ws-error-no (s1)
 11776              add +1             to s1
 11777           end-if
 11778           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11779*             if (cl-accident-claim-sw not = 'Y')
 11780              if (accswi not = 'Y')
 11781                 MOVE ER-1652    TO ws-error-no (s1)
 11782              else
 11783                 move er-1662    to ws-error-no (s1)
 11784              end-if
 11785              MOVE -1            TO MAINTL
 11786              add +1             to s1
 11787           END-IF
 11788        END-IF
 11789        if cl-claim-type  = 'I'
 11790           move er-1661          to ws-error-no (s1)
 11791           add +1                to s1
 11792        end-if
 11793        perform 2130-check-trlr  thru 2130-exit
 11794     END-IF
 11795
 11796     .
 11797 2120-exit.
 11798     exit.
 11799
 11800 2130-check-trlr.
 11801
 11802     evaluate true
 11803        when s1 = +0
 11804           move cl-control-primary
 11805                                 to trlr-key
 11806           MOVE +95              TO TRLR-SEQ-NO
 11807
 11808* EXEC CICS READ
 11809*             update
 11810*             DATASET  ('ELTRLR')
 11811*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11812*             RIDFLD   (TRLR-KEY)
 11813*             RESP     (WS-RESPONSE)
 11814*          END-EXEC
 11815     MOVE 'ELTRLR' TO DFHEIV1
 11816*    MOVE '&"S        EU         (  N#00010656' TO DFHEIV0
 11817     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11818     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11819     MOVE X'204E233030303130363536' TO DFHEIV0(25:11)
 11820     CALL 'kxdfhei1' USING DFHEIV0,
 11821           DFHEIV1,
 11822           DFHEIV20,
 11823           DFHEIV99,
 11824           TRLR-KEY,
 11825           DFHEIV99,
 11826           DFHEIV99,
 11827           DFHEIV99
 11828     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11829         DFHEIV20
 11830     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 218
* EL131.cbl
 11831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11832           if ws-resp-normal
 11833              move spaces        to at-info-line-1
 11834           end-if
 11835        when s1 = +1
 11836           if ws-resp-normal
 11837
 11838* exec cics rewrite
 11839*                dataset   ('ELTRLR')
 11840*                from      (activity-trailers)
 11841*             end-exec
 11842     MOVE LENGTH OF
 11843      activity-trailers
 11844       TO DFHEIV11
 11845     MOVE 'ELTRLR' TO DFHEIV1
 11846*    MOVE '&& L                  %   #00010668' TO DFHEIV0
 11847     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11848     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11849     MOVE X'2020233030303130363638' TO DFHEIV0(25:11)
 11850     CALL 'kxdfhei1' USING DFHEIV0,
 11851           DFHEIV1,
 11852           activity-trailers,
 11853           DFHEIV11,
 11854           DFHEIV99
 11855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11856           end-if
 11857        when s1 > +1
 11858           if ws-resp-normal
 11859              move ws-dcc-error-line
 11860                                 to at-info-line-1
 11861
 11862* exec cics rewrite
 11863*                dataset   ('ELTRLR')
 11864*                from      (activity-trailers)
 11865*             end-exec
 11866     MOVE LENGTH OF
 11867      activity-trailers
 11868       TO DFHEIV11
 11869     MOVE 'ELTRLR' TO DFHEIV1
 11870*    MOVE '&& L                  %   #00010677' TO DFHEIV0
 11871     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11872     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11873     MOVE X'2020233030303130363737' TO DFHEIV0(25:11)
 11874     CALL 'kxdfhei1' USING DFHEIV0,
 11875           DFHEIV1,
 11876           activity-trailers,
 11877           DFHEIV11,
 11878           DFHEIV99
 11879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11880           else
 11881
 11882* EXEC CICS GETMAIN
 11883*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11884*                LENGTH   (TRLR-LENGTH)
 11885*                INITIMG  (GETMAIN-SPACE)
 11886*             END-EXEC
 11887*    MOVE ',"IL                  $   #00010682' TO DFHEIV0
 11888     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 219
* EL131.cbl
 11889     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11890     MOVE X'2020233030303130363832' TO DFHEIV0(25:11)
 11891     CALL 'kxdfhei1' USING DFHEIV0,
 11892           DFHEIV20,
 11893           TRLR-LENGTH,
 11894           GETMAIN-SPACE
 11895     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11896         DFHEIV20
 11897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11898              move 'AT'          to at-record-id
 11899              move cl-control-primary
 11900                                 to at-control-primary
 11901              move +95           to at-sequence-no
 11902              move '6'           to at-trailer-type
 11903              move ws-dcc-error-line
 11904                                 to at-info-line-1
 11905              move 'E'           to at-info-trailer-type
 11906              move save-bin-date to at-recorded-dt
 11907                                    at-gen-info-last-maint-dt
 11908              move pi-processor-id
 11909                                 to at-recorded-by
 11910                                    at-gen-info-last-updated-by
 11911              move eibtime       to at-last-maint-hhmmss
 11912
 11913* exec cics write
 11914*                dataset   ('ELTRLR')
 11915*                from      (activity-trailers)
 11916*                ridfld    (trlr-key)
 11917*             end-exec
 11918     MOVE LENGTH OF
 11919      activity-trailers
 11920       TO DFHEIV11
 11921     MOVE 'ELTRLR' TO DFHEIV1
 11922*    MOVE '&$ L                  ''   #00010701' TO DFHEIV0
 11923     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11924     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11925     MOVE X'2020233030303130373031' TO DFHEIV0(25:11)
 11926     CALL 'kxdfhei1' USING DFHEIV0,
 11927           DFHEIV1,
 11928           activity-trailers,
 11929           DFHEIV11,
 11930           trlr-key,
 11931           DFHEIV99,
 11932           DFHEIV99
 11933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11934              perform varying s1 from +1 by +1 until
 11935                 ws-error-no (s1) = spaces
 11936                 move ws-error-no (s1)
 11937                                 to emi-error
 11938                 PERFORM 9900-ERROR-FORMAT
 11939                                 THRU 9900-EXIT
 11940              end-perform
 11941           end-if
 11942     end-evaluate
 11943
 11944     .
 11945 2130-exit.
 11946     exit.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 220
* EL131.cbl
 11947 2140-update-elcrtt.
 11948     move ' '                    to crtt-switch
 11949     MOVE CERT-KEY               TO ELCRTT-KEY
 11950     MOVE 'B'                    TO CTRLR-REC-TYPE
 11951
 11952* EXEC CICS READ
 11953*       UPDATE
 11954*       DATASET   ('ELCRTT')
 11955*       RIDFLD    (ELCRTT-KEY)
 11956*       INTO      (CERTIFICATE-TRAILERS)
 11957*       RESP      (WS-RESPONSE)
 11958*    END-EXEC
 11959     MOVE LENGTH OF
 11960      CERTIFICATE-TRAILERS
 11961       TO DFHEIV11
 11962     MOVE 'ELCRTT' TO DFHEIV1
 11963*    MOVE '&"IL       EU         (  N#00010723' TO DFHEIV0
 11964     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11965     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11966     MOVE X'204E233030303130373233' TO DFHEIV0(25:11)
 11967     CALL 'kxdfhei1' USING DFHEIV0,
 11968           DFHEIV1,
 11969           CERTIFICATE-TRAILERS,
 11970           DFHEIV11,
 11971           ELCRTT-KEY,
 11972           DFHEIV99,
 11973           DFHEIV99,
 11974           DFHEIV99
 11975     MOVE EIBRESP  TO WS-RESPONSE
 11976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11977     IF WS-RESP-NORMAL
 11978        perform varying s1 from +1 by +1 until
 11979           (s1 > +24)
 11980           or (cs-claim-no (s1) = cl-claim-no)
 11981        end-perform
 11982        if (s1 < +25)
 11983           if (benperl <> zeros)
 11984              and (cs-benefit-period (s1) not = benperi)
 11985              move benperi       to cs-benefit-period (s1)
 11986              set crtt-update    to true
 11987          end-if
 11988          if (instypel <> zeros)
 11989             and (instypei not = cs-insured-type (s1))
 11990             move instypei      to cs-insured-type (s1)
 11991             set crtt-update    to true
 11992          end-if
 11993          move cs-claim-type (s1) to ws-claim-type
 11994          move cs-benefit-period (s1) to ws-ben-per
 11995        end-if
 11996        if crtt-update
 11997           perform 2150-accum    thru 2150-exit
 11998
 11999* EXEC CICS REWRITE
 12000*             DATASET   ('ELCRTT')
 12001*             FROM      (CERTIFICATE-TRAILERS)
 12002*          END-EXEC
 12003     MOVE LENGTH OF
 12004      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 221
* EL131.cbl
 12005       TO DFHEIV11
 12006     MOVE 'ELCRTT' TO DFHEIV1
 12007*    MOVE '&& L                  %   #00010751' TO DFHEIV0
 12008     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12009     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12010     MOVE X'2020233030303130373531' TO DFHEIV0(25:11)
 12011     CALL 'kxdfhei1' USING DFHEIV0,
 12012           DFHEIV1,
 12013           CERTIFICATE-TRAILERS,
 12014           DFHEIV11,
 12015           DFHEIV99
 12016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12017        else
 12018
 12019* exec cics unlock
 12020*             dataset   ('ELCRTT')
 12021*          end-exec
 12022     MOVE 'ELCRTT' TO DFHEIV1
 12023*    MOVE '&*                    #   #00010756' TO DFHEIV0
 12024     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12025     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12026     MOVE X'2020233030303130373536' TO DFHEIV0(25:11)
 12027     CALL 'kxdfhei1' USING DFHEIV0,
 12028           DFHEIV1,
 12029           DFHEIV99
 12030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12031        end-if
 12032     end-if
 12033     .
 12034 2140-exit.
 12035     exit.
 12036 2150-accum.
 12037     if not erpdef-found
 12038        perform 3997-get-erpdef  thru 3997-exit
 12039     end-if
 12040     if (erpdef-found)
 12041        and (ws-max-moben not = zeros)
 12042        and (ws-max-moben < cm-ah-benefit-amt)
 12043        continue
 12044     else
 12045        move cm-ah-benefit-amt   to ws-max-moben
 12046     end-if
 12047     move cm-ah-orig-term        to ws-max-bens
 12048     if cl-critical-period not = zeros and spaces
 12049        move cl-critical-period  to ws-max-bens
 12050     end-if
 12051     move zeros to ws-tot-days-paid ws-tot-amt-paid
 12052     perform varying s2 from +1 by +1 until
 12053        (s2 > +24)
 12054        or (cs-claim-no (s2) = spaces)
 12055        if (cs-benefit-period (s2) = ws-ben-per)
 12056           and (cs-claim-type (s2) = ws-claim-type)
 12057           and (cs-insured-type (s2) = cl-insured-type)
 12058*          compute ws-tot-days-paid =
 12059*             ws-tot-days-paid + cs-days-paid (s2)
 12060           compute ws-tot-amt-paid =
 12061              ws-tot-amt-paid + cs-total-paid (s2)
 12062        end-if
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 222
* EL131.cbl
 12063     end-perform
 12064     if s2 < +25
 12065        compute ws-pd-bens rounded =
 12066           ws-tot-amt-paid / ws-max-moben
 12067        compute cs-remaining-bens (s1) =
 12068           ws-max-bens - ws-pd-bens
 12069        if cs-remaining-bens (s1) < zeros
 12070           move zeros            to cs-remaining-bens (s1)
 12071        end-if
 12072     end-if
 12073     .
 12074 2150-exit.
 12075     exit.
 12076 2200-MOVE-CERT.
 12077     IF CRTLNMEI GREATER THAN LOW-VALUES
 12078         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 12079
 12080     IF CRTFNMEI GREATER THAN LOW-VALUES
 12081         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 12082         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 12083
 12084     IF CRTINITI GREATER THAN LOW-VALUES
 12085         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 12086
 12087     IF CM-INSURED-INITIALS = SPACES
 12088         MOVE '**'               TO CM-INSURED-INITIALS.
 12089
 12090     IF ISSAGEI GREATER THAN LOW-VALUES
 12091         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 12092
 12093     IF JNTFNMEI GREATER THAN LOW-VALUES
 12094         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 12095
 12096     IF JNTLNMEI GREATER THAN LOW-VALUES
 12097         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 12098
 12099     IF JNTINITI GREATER THAN LOW-VALUES
 12100         MOVE JNTINITI           TO CM-JT-INITIAL.
 12101
 12102     IF JNTAGEI GREATER THAN LOW-VALUES
 12103         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 12104
 12105     IF ADDONDTI GREATER THAN LOW-VALUES
 12106        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 12107
 12108     IF LCVCDI GREATER THAN LOW-VALUES
 12109        IF LCVCDI = SPACES OR ZEROS
 12110           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 12111        ELSE
 12112           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 12113
 12114     IF LCVOTRMI GREATER THAN LOW-VALUES
 12115         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 12116
 12117     IF LCVRATEL GREATER THAN +0
 12118         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 12119
 12120     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 223
* EL131.cbl
 12121         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 12122
 12123     IF LCVFORMI GREATER THAN LOW-VALUES
 12124         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 12125
 12126     IF LCVCNDTI = LOW-VALUES
 12127        GO TO 2210-SET-STATUS.
 12128
 12129     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 12130        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 12131        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 12132        GO TO 2210-SET-STATUS.
 12133
 12134     IF CM-LF-CURRENT-STATUS = '7'
 12135        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 12136        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 12137        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12138                                    CM-LF-DEATH-DT
 12139        GO TO 2210-SET-STATUS.
 12140
 12141     IF CM-LF-CURRENT-STATUS = '8'
 12142        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12143        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12144                                    CM-LF-CANCEL-DT.
 12145
 12146 2210-SET-STATUS.
 12147
 12148     IF CM-LF-CURRENT-STATUS = SPACES
 12149         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12150
 12151     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12152         MOVE '6'                TO DC-OPTION-CODE
 12153         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12154         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12155         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12156         IF NO-CONVERSION-ERROR
 12157             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12158         ELSE
 12159             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12160     ELSE
 12161         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12162
 12163 2215-PROCESS-AH-SIDE.
 12164
 12165     IF ACVCDI GREATER THAN LOW-VALUES
 12166        IF ACVCDI = SPACES OR ZEROS
 12167           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12168        ELSE
 12169           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12170
 12171     IF ACVOTRMI GREATER THAN LOW-VALUES
 12172         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12173
 12174     IF ACVRATEL GREATER THAN +0
 12175         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12176
 12177     IF ACVBENEL GREATER THAN +0
 12178         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 224
* EL131.cbl
 12179                                    PI-PAYMENT-AMT.
 12180
 12181     IF ACVFORMI GREATER THAN LOW-VALUES
 12182         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12183
 12184     IF ACVCNDTI = LOW-VALUES
 12185        GO TO 2220-SET-STATUS.
 12186
 12187     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12188        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12189        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12190        GO TO 2220-SET-STATUS.
 12191
 12192     IF CM-AH-CURRENT-STATUS = '6'
 12193        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12194                                 TO CM-AH-CURRENT-STATUS
 12195        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12196        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12197                                    CM-AH-SETTLEMENT-DT
 12198        GO TO 2220-SET-STATUS.
 12199
 12200     IF CM-AH-CURRENT-STATUS = '8'
 12201        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12202        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12203                                    CM-AH-CANCEL-DT.
 12204
 12205 2220-SET-STATUS.
 12206     IF CM-AH-CURRENT-STATUS = SPACES
 12207         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12208
 12209     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12210         MOVE '6'                TO DC-OPTION-CODE
 12211         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12212         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12213         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12214         IF NO-CONVERSION-ERROR
 12215             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12216         ELSE
 12217             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12218     ELSE
 12219         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12220
 12221 2225-FINISH-CERT.
 12222     IF APRL GREATER THAN +0
 12223         MOVE HOLD-APR           TO CM-LOAN-APR.
 12224
 12225     IF PMTFREQI GREATER THAN LOW-VALUES
 12226         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12227
 12228     IF INDGRPI GREATER THAN LOW-VALUES
 12229         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12230
 12231*    IF LOANNOI GREATER THAN LOW-VALUES
 12232*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12233
 12234     IF LOANBALL GREATER THAN +0
 12235        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12236
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 225
* EL131.cbl
 12237     IF PREMTYPI GREATER THAN LOW-VALUES
 12238         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12239
 12240     IF REINCDI GREATER THAN LOW-VALUES
 12241         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12242                                    WS-REIN-1
 12243                                    WS-REIN-2
 12244                                    WS-REIN-3
 12245         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12246
 12247     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12248
 12249     MOVE ZEROS                  TO CM-LOAN-TERM
 12250                                    CM-LIFE-COMM-PCT
 12251                                    CM-AH-COMM-PCT.
 12252
 12253*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12254*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12255*         PI-NO-PMTS = ZEROS
 12256*          IF LOANBALL GREATER THAN +0          OR
 12257*             ACVBENEL GREATER THAN +0          OR
 12258*             APRL     GREATER THAN +0          OR
 12259*             LCVRATEL GREATER THAN +0          OR
 12260*             ACVRATEL GREATER THAN +0
 12261*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12262
 12263 2200-EXIT.
 12264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 226
* EL131.cbl
 12266 2300-UPDATE-TRLR.
 12267     MOVE ZERO                   TO TRLR-SEQ-NO.
 12268
 12269* EXEC CICS READ UPDATE
 12270*         DATASET  (TRLR-FILE-ID)
 12271*         RIDFLD   (TRLR-KEY)
 12272*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12273*    END-EXEC.
 12274*    MOVE '&"S        EU         (   #00010996' TO DFHEIV0
 12275     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12276     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12277     MOVE X'2020233030303130393936' TO DFHEIV0(25:11)
 12278     CALL 'kxdfhei1' USING DFHEIV0,
 12279           TRLR-FILE-ID,
 12280           DFHEIV20,
 12281           DFHEIV99,
 12282           TRLR-KEY,
 12283           DFHEIV99,
 12284           DFHEIV99,
 12285           DFHEIV99
 12286     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12287         DFHEIV20
 12288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12289
 12290
 12291     MOVE ZERO                   TO COUNT-2.
 12292
 12293     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12294         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12295
 12296     IF NOT UPDATE-MADE
 12297         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12298
 12299
 12300* EXEC CICS REWRITE
 12301*         DATASET  (TRLR-FILE-ID)
 12302*         FROM     (ACTIVITY-TRAILERS)
 12303*    END-EXEC.
 12304     MOVE LENGTH OF
 12305      ACTIVITY-TRAILERS
 12306       TO DFHEIV11
 12307*    MOVE '&& L                  %   #00011010' TO DFHEIV0
 12308     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12309     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12310     MOVE X'2020233030303131303130' TO DFHEIV0(25:11)
 12311     CALL 'kxdfhei1' USING DFHEIV0,
 12312           TRLR-FILE-ID,
 12313           ACTIVITY-TRAILERS,
 12314           DFHEIV11,
 12315           DFHEIV99
 12316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12317
 12318
 12319 2300-EXIT.
 12320     EXIT.
 12321
 12322 2310-INS-STATUS.
 12323     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 227
* EL131.cbl
 12324     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12325         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12326         MOVE 'Y'                TO TRLR-SWITCH.
 12327
 12328 2310-EXIT.
 12329     EXIT.
 12330
 12331 2320-SHIFT-STATUS.
 12332     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12333        MOVE 6                   TO COUNT-2
 12334        GO TO 2320-EXIT.
 12335
 12336     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12337     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12338     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12339     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12340     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12341     MOVE 6       TO COUNT-2.
 12342     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12343
 12344 2320-EXIT.
 12345     EXIT.
 12346
 12347 2330-ADD-UPDATE.
 12348
 12349     IF COUNT-2 GREATER THAN 1
 12350        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12351        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12352           GO TO 2330-EXIT.
 12353
 12354     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12355                                   AT-RESERVES-LAST-MAINT-DT
 12356
 12357     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12358     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12359     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12360     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12361
 12362 2330-EXIT.
 12363     EXIT.
 12364
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 228
* EL131.cbl
 12366 2400-UPDATE-TRLR.
 12367
 12368* EXEC CICS HANDLE CONDITION
 12369*         NOTFND    (2400-TRLR-NOTFND)
 12370*         ENDFILE   (2410-EXIT)
 12371*    END-EXEC.
 12372*    MOVE '"$I''                  ! 5 #00011063' TO DFHEIV0
 12373     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12375     MOVE X'3520233030303131303633' TO DFHEIV0(25:11)
 12376     CALL 'kxdfhei1' USING DFHEIV0
 12377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12378
 12379
 12380
 12381* EXEC CICS STARTBR
 12382*        DATASET (TRLR-FILE-ID)
 12383*        RIDFLD  (TRLR-KEY)
 12384*    END-EXEC.
 12385     MOVE 0
 12386       TO DFHEIV11
 12387*    MOVE '&,         G          &   #00011068' TO DFHEIV0
 12388     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12389     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12390     MOVE X'2020233030303131303638' TO DFHEIV0(25:11)
 12391     CALL 'kxdfhei1' USING DFHEIV0,
 12392           TRLR-FILE-ID,
 12393           TRLR-KEY,
 12394           DFHEIV99,
 12395           DFHEIV11,
 12396           DFHEIV99
 12397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12398
 12399
 12400
 12401* EXEC CICS GETMAIN
 12402*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12403*         LENGTH    (TRLR-LENGTH)
 12404*         INITIMG   (GETMAIN-SPACE)
 12405*    END-EXEC.
 12406*    MOVE ',"IL                  $   #00011073' TO DFHEIV0
 12407     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12409     MOVE X'2020233030303131303733' TO DFHEIV0(25:11)
 12410     CALL 'kxdfhei1' USING DFHEIV0,
 12411           DFHEIV20,
 12412           TRLR-LENGTH,
 12413           GETMAIN-SPACE
 12414     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12415         DFHEIV20
 12416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12417
 12418
 12419     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12420
 12421
 12422* EXEC CICS ENDBR
 12423*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 229
* EL131.cbl
 12424*    END-EXEC.
 12425     MOVE 0
 12426       TO DFHEIV11
 12427*    MOVE '&2                    $   #00011081' TO DFHEIV0
 12428     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12429     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12430     MOVE X'2020233030303131303831' TO DFHEIV0(25:11)
 12431     CALL 'kxdfhei1' USING DFHEIV0,
 12432           TRLR-FILE-ID,
 12433           DFHEIV11,
 12434           DFHEIV99
 12435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12436
 12437
 12438     GO TO 2400-EXIT.
 12439
 12440 2400-TRLR-NOTFND.
 12441     MOVE ER-0205                TO EMI-ERROR.
 12442     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12443     MOVE 'X'                    TO ERROR-SWITCH.
 12444
 12445 2400-EXIT.
 12446     EXIT.
 12447
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 230
* EL131.cbl
 12449 2410-CHANGE-TRLR.
 12450
 12451* EXEC CICS READNEXT
 12452*        DATASET (TRLR-FILE-ID)
 12453*        RIDFLD  (TRLR-KEY)
 12454*        INTO    (ACTIVITY-TRAILERS)
 12455*    END-EXEC.
 12456     MOVE LENGTH OF
 12457      ACTIVITY-TRAILERS
 12458       TO DFHEIV12
 12459     MOVE 0
 12460       TO DFHEIV11
 12461*    MOVE '&.IL                  )   #00011097' TO DFHEIV0
 12462     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12463     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12464     MOVE X'2020233030303131303937' TO DFHEIV0(25:11)
 12465     CALL 'kxdfhei1' USING DFHEIV0,
 12466           TRLR-FILE-ID,
 12467           ACTIVITY-TRAILERS,
 12468           DFHEIV12,
 12469           TRLR-KEY,
 12470           DFHEIV99,
 12471           DFHEIV11,
 12472           DFHEIV99,
 12473           DFHEIV99
 12474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12475
 12476
 12477     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12478        GO TO 2410-CHANGE-TRLR.
 12479
 12480     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12481                                    CHECK-KEY.
 12482
 12483     IF CHECK-KEY NOT = MSTR-KEY
 12484         GO TO 2410-EXIT.
 12485
 12486
 12487* EXEC CICS ENDBR
 12488*        DATASET (TRLR-FILE-ID)
 12489*    END-EXEC.
 12490     MOVE 0
 12491       TO DFHEIV11
 12492*    MOVE '&2                    $   #00011112' TO DFHEIV0
 12493     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12494     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12495     MOVE X'2020233030303131313132' TO DFHEIV0(25:11)
 12496     CALL 'kxdfhei1' USING DFHEIV0,
 12497           TRLR-FILE-ID,
 12498           DFHEIV11,
 12499           DFHEIV99
 12500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12501
 12502
 12503
 12504* EXEC CICS READ UPDATE
 12505*        DATASET (TRLR-FILE-ID)
 12506*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 231
* EL131.cbl
 12507*        INTO    (ACTIVITY-TRAILERS)
 12508*    END-EXEC.
 12509     MOVE LENGTH OF
 12510      ACTIVITY-TRAILERS
 12511       TO DFHEIV11
 12512*    MOVE '&"IL       EU         (   #00011116' TO DFHEIV0
 12513     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12514     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12515     MOVE X'2020233030303131313136' TO DFHEIV0(25:11)
 12516     CALL 'kxdfhei1' USING DFHEIV0,
 12517           TRLR-FILE-ID,
 12518           ACTIVITY-TRAILERS,
 12519           DFHEIV11,
 12520           TRLR-KEY,
 12521           DFHEIV99,
 12522           DFHEIV99,
 12523           DFHEIV99
 12524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12525
 12526
 12527
 12528* EXEC CICS DELETE
 12529*        DATASET (TRLR-FILE-ID)
 12530*    END-EXEC.
 12531*    MOVE '&(                    &   #00011122' TO DFHEIV0
 12532     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12533     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12534     MOVE X'2020233030303131313232' TO DFHEIV0(25:11)
 12535     CALL 'kxdfhei1' USING DFHEIV0,
 12536           TRLR-FILE-ID,
 12537           DFHEIV99,
 12538           DFHEIV99,
 12539           DFHEIV99,
 12540           DFHEIV99
 12541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12542
 12543
 12544     IF AT-SEQUENCE-NO = ZERO AND
 12545        TRLR-UPDATE-REQUIRED
 12546         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12547
 12548     IF CERTI GREATER THAN LOW-VALUES
 12549        MOVE CERTI               TO AT-CERT-PRIME.
 12550
 12551     IF SUFXI GREATER THAN LOW-VALUES
 12552        MOVE SUFXI               TO AT-CERT-SFX.
 12553
 12554     IF CERTCARI GREATER THAN LOW-VALUES
 12555        MOVE CERTCARI            TO AT-CARRIER.
 12556
 12557     IF PAYMENT-TR
 12558        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12559           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12560              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12561
 12562     IF CORRESPONDENCE-TR
 12563        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12564           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 232
* EL131.cbl
 12565
 12566
 12567* EXEC CICS WRITE
 12568*         DATASET  (TRLR-FILE-ID)
 12569*         RIDFLD   (AT-CONTROL-PRIMARY)
 12570*         FROM     (ACTIVITY-TRAILERS)
 12571*    END-EXEC.
 12572     MOVE LENGTH OF
 12573      ACTIVITY-TRAILERS
 12574       TO DFHEIV11
 12575*    MOVE '&$ L                  ''   #00011148' TO DFHEIV0
 12576     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12577     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12578     MOVE X'2020233030303131313438' TO DFHEIV0(25:11)
 12579     CALL 'kxdfhei1' USING DFHEIV0,
 12580           TRLR-FILE-ID,
 12581           ACTIVITY-TRAILERS,
 12582           DFHEIV11,
 12583           AT-CONTROL-PRIMARY,
 12584           DFHEIV99,
 12585           DFHEIV99
 12586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12587
 12588
 12589
 12590* EXEC CICS STARTBR
 12591*         DATASET  (TRLR-FILE-ID)
 12592*         RIDFLD   (TRLR-KEY)
 12593*    END-EXEC.
 12594     MOVE 0
 12595       TO DFHEIV11
 12596*    MOVE '&,         G          &   #00011154' TO DFHEIV0
 12597     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12598     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12599     MOVE X'2020233030303131313534' TO DFHEIV0(25:11)
 12600     CALL 'kxdfhei1' USING DFHEIV0,
 12601           TRLR-FILE-ID,
 12602           TRLR-KEY,
 12603           DFHEIV99,
 12604           DFHEIV11,
 12605           DFHEIV99
 12606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12607
 12608
 12609     GO TO 2410-CHANGE-TRLR.
 12610
 12611 2410-EXIT.
 12612     EXIT.
 12613
 12614 2420-UPDATE-TRLR.
 12615     MOVE ZERO TO COUNT-2.
 12616     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12617         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12618
 12619     IF NOT UPDATE-MADE
 12620         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12621
 12622 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 233
* EL131.cbl
 12623     EXIT.
 12624
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 234
* EL131.cbl
 12626 2425-UPDATE-NINETY-TRLR.
 12627
 12628     MOVE +90                    TO TRLR-SEQ-NO.
 12629
 12630
 12631* EXEC CICS HANDLE CONDITION
 12632*         NOTFND    (2425-NINETY-NOTFND)
 12633*         ENDFILE   (2425-NINETY-NOTFND)
 12634*    END-EXEC.
 12635*    MOVE '"$I''                  ! 6 #00011180' TO DFHEIV0
 12636     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12638     MOVE X'3620233030303131313830' TO DFHEIV0(25:11)
 12639     CALL 'kxdfhei1' USING DFHEIV0
 12640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12641
 12642
 12643
 12644* EXEC CICS READ UPDATE
 12645*        DATASET (TRLR-FILE-ID)
 12646*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12647*        RIDFLD  (TRLR-KEY)
 12648*    END-EXEC.
 12649*    MOVE '&"S        EU         (   #00011185' TO DFHEIV0
 12650     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12651     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12652     MOVE X'2020233030303131313835' TO DFHEIV0(25:11)
 12653     CALL 'kxdfhei1' USING DFHEIV0,
 12654           TRLR-FILE-ID,
 12655           DFHEIV20,
 12656           DFHEIV99,
 12657           TRLR-KEY,
 12658           DFHEIV99,
 12659           DFHEIV99,
 12660           DFHEIV99
 12661     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12662         DFHEIV20
 12663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12664
 12665     if (diagi > low-values)
 12666        and (diagi not = at-info-line-1)
 12667        and (cl-total-paid-amt > zeros)
 12668        move cl-cert-eff-dt      to dc-bin-date-1
 12669        move cl-paid-thru-dt     to dc-bin-date-2
 12670        move '1'                 to dc-option-code
 12671        perform 9800-convert-date
 12672                                 thru 9800-exit
 12673        if no-conversion-error
 12674           and dc-elapsed-months < +24
 12675           and (not emi-bypass-forcables)
 12676           move er-1581          to emi-error
 12677           perform 9900-error-format
 12678                                thru 9900-exit
 12679           move -1              to diagl
 12680           go to 8110-send-data
 12681        end-if
 12682     end-if
 12683     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 235
* EL131.cbl
 12684     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12685     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12686
 12687     IF DIAGI GREATER THAN LOW-VALUES
 12688         MOVE DIAGI             TO AT-INFO-LINE-1
 12689     END-IF.
 12690
 12691     IF ICD1I GREATER THAN LOW-VALUES
 12692         MOVE ICD1I             TO AT-ICD-CODE-1
 12693     END-IF.
 12694
 12695     IF ICD2I GREATER THAN LOW-VALUES
 12696         MOVE ICD2I             TO AT-ICD-CODE-2
 12697     END-IF.
 12698
 12699
 12700* EXEC CICS REWRITE
 12701*        DATASET (TRLR-FILE-ID)
 12702*        FROM    (ACTIVITY-TRAILERS)
 12703*    END-EXEC.
 12704     MOVE LENGTH OF
 12705      ACTIVITY-TRAILERS
 12706       TO DFHEIV11
 12707*    MOVE '&& L                  %   #00011224' TO DFHEIV0
 12708     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12709     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12710     MOVE X'2020233030303131323234' TO DFHEIV0(25:11)
 12711     CALL 'kxdfhei1' USING DFHEIV0,
 12712           TRLR-FILE-ID,
 12713           ACTIVITY-TRAILERS,
 12714           DFHEIV11,
 12715           DFHEIV99
 12716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12717
 12718
 12719     IF DIAGI GREATER THAN LOW-VALUES
 12720       AND DIAGI NOT = WS-DIAGNOSIS
 12721         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12722         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12723         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12724
 12725     IF ICD1I GREATER THAN LOW-VALUES
 12726       AND ICD1I NOT = WS-ICD-CODE-1
 12727         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12728         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12729         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12730     END-IF.
 12731
 12732     IF ICD2I GREATER THAN LOW-VALUES
 12733       AND ICD2I NOT = WS-ICD-CODE-2
 12734         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12735         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12736         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12737     END-IF.
 12738
 12739     GO TO 2425-EXIT.
 12740
 12741 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 236
* EL131.cbl
 12742
 12743
 12744* EXEC CICS GETMAIN
 12745*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12746*         LENGTH    (TRLR-LENGTH)
 12747*         INITIMG   (GETMAIN-SPACE)
 12748*    END-EXEC.
 12749*    MOVE ',"IL                  $   #00011253' TO DFHEIV0
 12750     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12751     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12752     MOVE X'2020233030303131323533' TO DFHEIV0(25:11)
 12753     CALL 'kxdfhei1' USING DFHEIV0,
 12754           DFHEIV20,
 12755           TRLR-LENGTH,
 12756           GETMAIN-SPACE
 12757     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12758         DFHEIV20
 12759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12760
 12761
 12762     MOVE +90                  TO TRLR-SEQ-NO.
 12763     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12764
 12765     MOVE 'AT'                 TO AT-RECORD-ID
 12766     MOVE '6'                  TO AT-TRAILER-TYPE
 12767     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12768                                  AT-GEN-INFO-LAST-MAINT-DT
 12769     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12770                                  AT-GEN-INFO-LAST-UPDATED-BY
 12771     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12772     MOVE DIAGI                TO AT-INFO-LINE-1.
 12773     MOVE ICD1I                TO AT-ICD-CODE-1.
 12774     MOVE ICD2I                TO AT-ICD-CODE-2.
 12775
 12776
 12777* EXEC CICS WRITE
 12778*        DATASET (TRLR-FILE-ID)
 12779*        FROM    (ACTIVITY-TRAILERS)
 12780*        RIDFLD  (TRLR-KEY)
 12781*    END-EXEC.
 12782     MOVE LENGTH OF
 12783      ACTIVITY-TRAILERS
 12784       TO DFHEIV11
 12785*    MOVE '&$ L                  ''   #00011273' TO DFHEIV0
 12786     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12787     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12788     MOVE X'2020233030303131323733' TO DFHEIV0(25:11)
 12789     CALL 'kxdfhei1' USING DFHEIV0,
 12790           TRLR-FILE-ID,
 12791           ACTIVITY-TRAILERS,
 12792           DFHEIV11,
 12793           TRLR-KEY,
 12794           DFHEIV99,
 12795           DFHEIV99
 12796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12797
 12798
 12799 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 237
* EL131.cbl
 12800     EXIT.
 12801
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 238
* EL131.cbl
 12803 2430-UPDATE-ACTQ.
 12804
 12805* EXEC CICS HANDLE CONDITION
 12806*         NOTFND    (2430-EXIT)
 12807*         ENDFILE   (2440-EXIT)
 12808*    END-EXEC.
 12809*    MOVE '"$I''                  ! 7 #00011284' TO DFHEIV0
 12810     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12812     MOVE X'3720233030303131323834' TO DFHEIV0(25:11)
 12813     CALL 'kxdfhei1' USING DFHEIV0
 12814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12815
 12816
 12817
 12818* EXEC CICS STARTBR
 12819*         DATASET  (ACTQ-FILE-ID)
 12820*         RIDFLD   (ACTQ-KEY)
 12821*    END-EXEC.
 12822     MOVE 0
 12823       TO DFHEIV11
 12824*    MOVE '&,         G          &   #00011289' TO DFHEIV0
 12825     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12826     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12827     MOVE X'2020233030303131323839' TO DFHEIV0(25:11)
 12828     CALL 'kxdfhei1' USING DFHEIV0,
 12829           ACTQ-FILE-ID,
 12830           ACTQ-KEY,
 12831           DFHEIV99,
 12832           DFHEIV11,
 12833           DFHEIV99
 12834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12835
 12836
 12837
 12838* EXEC CICS GETMAIN
 12839*         SET      (ADDRESS OF ACTIVITY-QUE)
 12840*         LENGTH   (ACTQ-LENGTH)
 12841*         INITIMG  (GETMAIN-SPACE)
 12842*    END-EXEC.
 12843*    MOVE ',"IL                  $   #00011294' TO DFHEIV0
 12844     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12846     MOVE X'2020233030303131323934' TO DFHEIV0(25:11)
 12847     CALL 'kxdfhei1' USING DFHEIV0,
 12848           DFHEIV20,
 12849           ACTQ-LENGTH,
 12850           GETMAIN-SPACE
 12851     SET ADDRESS OF ACTIVITY-QUE TO
 12852         DFHEIV20
 12853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12854
 12855
 12856     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12857
 12858 2430-EXIT.
 12859     EXIT.
 12860
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 239
* EL131.cbl
 12861 2440-CHANGE-ACTQ.
 12862
 12863
 12864* EXEC CICS READNEXT
 12865*         DATASET  (ACTQ-FILE-ID)
 12866*         RIDFLD   (ACTQ-KEY)
 12867*         INTO     (ACTIVITY-QUE)
 12868*    END-EXEC.
 12869     MOVE LENGTH OF
 12870      ACTIVITY-QUE
 12871       TO DFHEIV12
 12872     MOVE 0
 12873       TO DFHEIV11
 12874*    MOVE '&.IL                  )   #00011307' TO DFHEIV0
 12875     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12876     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12877     MOVE X'2020233030303131333037' TO DFHEIV0(25:11)
 12878     CALL 'kxdfhei1' USING DFHEIV0,
 12879           ACTQ-FILE-ID,
 12880           ACTIVITY-QUE,
 12881           DFHEIV12,
 12882           ACTQ-KEY,
 12883           DFHEIV99,
 12884           DFHEIV11,
 12885           DFHEIV99,
 12886           DFHEIV99
 12887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12888
 12889
 12890
 12891* EXEC CICS ENDBR
 12892*         DATASET (ACTQ-FILE-ID)
 12893*    END-EXEC.
 12894     MOVE 0
 12895       TO DFHEIV11
 12896*    MOVE '&2                    $   #00011313' TO DFHEIV0
 12897     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12898     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12899     MOVE X'2020233030303131333133' TO DFHEIV0(25:11)
 12900     CALL 'kxdfhei1' USING DFHEIV0,
 12901           ACTQ-FILE-ID,
 12902           DFHEIV11,
 12903           DFHEIV99
 12904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12905
 12906
 12907     IF ACTQ-KEY NOT = MSTR-KEY
 12908         GO TO 2440-EXIT.
 12909
 12910
 12911* EXEC CICS READ UPDATE
 12912*         DATASET  (ACTQ-FILE-ID)
 12913*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12914*         SET      (ADDRESS OF ACTIVITY-QUE)
 12915*    END-EXEC.
 12916*    MOVE '&"S        EU         (   #00011320' TO DFHEIV0
 12917     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12918     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 240
* EL131.cbl
 12919     MOVE X'2020233030303131333230' TO DFHEIV0(25:11)
 12920     CALL 'kxdfhei1' USING DFHEIV0,
 12921           ACTQ-FILE-ID,
 12922           DFHEIV20,
 12923           DFHEIV99,
 12924           AQ-CONTROL-PRIMARY,
 12925           DFHEIV99,
 12926           DFHEIV99,
 12927           DFHEIV99
 12928     SET ADDRESS OF ACTIVITY-QUE TO
 12929         DFHEIV20
 12930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12931
 12932
 12933     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12934
 12935
 12936* EXEC CICS DELETE
 12937*         DATASET (ACTQ-FILE-ID)
 12938*    END-EXEC.
 12939*    MOVE '&(                    &   #00011328' TO DFHEIV0
 12940     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12941     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12942     MOVE X'2020233030303131333238' TO DFHEIV0(25:11)
 12943     CALL 'kxdfhei1' USING DFHEIV0,
 12944           ACTQ-FILE-ID,
 12945           DFHEIV99,
 12946           DFHEIV99,
 12947           DFHEIV99,
 12948           DFHEIV99
 12949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12950
 12951
 12952     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12953     IF CERTI GREATER THAN LOW-VALUES
 12954        MOVE CERTI               TO AQ-CERT-PRIME.
 12955     IF SUFXI GREATER THAN LOW-VALUES
 12956        MOVE SUFXI               TO AQ-CERT-SFX.
 12957     IF CERTCARI GREATER THAN LOW-VALUES
 12958        MOVE CERTCARI            TO AQ-CARRIER.
 12959
 12960
 12961* EXEC CICS HANDLE CONDITION
 12962*         DUPREC   (2440-EXIT)
 12963*    END-EXEC.
 12964*    MOVE '"$%                   ! 8 #00011340' TO DFHEIV0
 12965     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12966     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12967     MOVE X'3820233030303131333430' TO DFHEIV0(25:11)
 12968     CALL 'kxdfhei1' USING DFHEIV0
 12969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12970
 12971
 12972
 12973* EXEC CICS WRITE
 12974*         DATASET  (ACTQ-FILE-ID)
 12975*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12976*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 241
* EL131.cbl
 12977*    END-EXEC.
 12978     MOVE LENGTH OF
 12979      ACTIVITY-QUE
 12980       TO DFHEIV11
 12981*    MOVE '&$ L                  ''   #00011344' TO DFHEIV0
 12982     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12983     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12984     MOVE X'2020233030303131333434' TO DFHEIV0(25:11)
 12985     CALL 'kxdfhei1' USING DFHEIV0,
 12986           ACTQ-FILE-ID,
 12987           ACTIVITY-QUE,
 12988           DFHEIV11,
 12989           AQ-CONTROL-PRIMARY,
 12990           DFHEIV99,
 12991           DFHEIV99
 12992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12993
 12994
 12995 2440-EXIT.
 12996     EXIT.
 12997
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 242
* EL131.cbl
 12999 2460-UPDATE-CHECKQ.
 13000
 13001* EXEC CICS HANDLE CONDITION
 13002*         NOTFND   (2460-EXIT)
 13003*    END-EXEC.
 13004*    MOVE '"$I                   ! 9 #00011355' TO DFHEIV0
 13005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13007     MOVE X'3920233030303131333535' TO DFHEIV0(25:11)
 13008     CALL 'kxdfhei1' USING DFHEIV0
 13009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13010
 13011
 13012     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 13013     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 13014     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 13015
 13016
 13017* EXEC CICS READ UPDATE
 13018*         DATASET   (CHKQ-FILE-ID)
 13019*         RIDFLD    (CHKQ-KEY)
 13020*         SET       (ADDRESS OF CHECK-QUE)
 13021*    END-EXEC.
 13022*    MOVE '&"S        EU         (   #00011363' TO DFHEIV0
 13023     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13024     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13025     MOVE X'2020233030303131333633' TO DFHEIV0(25:11)
 13026     CALL 'kxdfhei1' USING DFHEIV0,
 13027           CHKQ-FILE-ID,
 13028           DFHEIV20,
 13029           DFHEIV99,
 13030           CHKQ-KEY,
 13031           DFHEIV99,
 13032           DFHEIV99,
 13033           DFHEIV99
 13034     SET ADDRESS OF CHECK-QUE TO
 13035         DFHEIV20
 13036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13037
 13038
 13039     IF CERTI GREATER THAN LOW-VALUES
 13040        MOVE CERTI               TO CQ-CERT-PRIME.
 13041     IF SUFXI GREATER THAN LOW-VALUES
 13042        MOVE SUFXI               TO CQ-CERT-SFX.
 13043     IF CERTCARI GREATER THAN LOW-VALUES
 13044        MOVE CERTCARI            TO CQ-CARRIER.
 13045
 13046
 13047* EXEC CICS REWRITE
 13048*         DATASET  (CHKQ-FILE-ID)
 13049*         FROM     (CHECK-QUE)
 13050*    END-EXEC.
 13051     MOVE LENGTH OF
 13052      CHECK-QUE
 13053       TO DFHEIV11
 13054*    MOVE '&& L                  %   #00011376' TO DFHEIV0
 13055     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13056     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 243
* EL131.cbl
 13057     MOVE X'2020233030303131333736' TO DFHEIV0(25:11)
 13058     CALL 'kxdfhei1' USING DFHEIV0,
 13059           CHKQ-FILE-ID,
 13060           CHECK-QUE,
 13061           DFHEIV11,
 13062           DFHEIV99
 13063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13064
 13065
 13066 2460-EXIT.
 13067     EXIT.
 13068
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 244
* EL131.cbl
 13070 2475-UPDATE-LETTER.
 13071
 13072* EXEC CICS HANDLE CONDITION
 13073*         NOTFND   (2475-EXIT)
 13074*    END-EXEC.
 13075*    MOVE '"$I                   ! : #00011386' TO DFHEIV0
 13076     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13078     MOVE X'3A20233030303131333836' TO DFHEIV0(25:11)
 13079     CALL 'kxdfhei1' USING DFHEIV0
 13080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13081
 13082
 13083     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 13084     MOVE '1'                    TO ARCH-RECORD-TYPE.
 13085     MOVE ZEROS                  TO ARCH-SEQ-NO.
 13086     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 13087
 13088
 13089* EXEC CICS READ UPDATE
 13090*         DATASET   (ARCH-FILE-ID)
 13091*         RIDFLD    (ARCH-KEY)
 13092*         SET       (ADDRESS OF LETTER-ARCHIVE)
 13093*    END-EXEC.
 13094*    MOVE '&"S        EU         (   #00011395' TO DFHEIV0
 13095     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13097     MOVE X'2020233030303131333935' TO DFHEIV0(25:11)
 13098     CALL 'kxdfhei1' USING DFHEIV0,
 13099           ARCH-FILE-ID,
 13100           DFHEIV20,
 13101           DFHEIV99,
 13102           ARCH-KEY,
 13103           DFHEIV99,
 13104           DFHEIV99,
 13105           DFHEIV99
 13106     SET ADDRESS OF LETTER-ARCHIVE TO
 13107         DFHEIV20
 13108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13109
 13110
 13111* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 13112* TO THIS MASTER-KEY INFORMATION.
 13113
 13114     IF LA-CARRIER  = CARRIER-CODE AND
 13115        LA-CLAIM-NO = CLAIM-NO     AND
 13116        LA-CERT-NO  = CERT-NO
 13117        NEXT SENTENCE
 13118     ELSE
 13119        GO TO 2475-UNLOCK.
 13120
 13121     IF CERTI GREATER THAN LOW-VALUES
 13122        MOVE CERTI               TO LA-CERT-PRIME.
 13123     IF SUFXI GREATER THAN LOW-VALUES
 13124        MOVE SUFXI               TO LA-CERT-SFX.
 13125     IF CERTCARI GREATER THAN LOW-VALUES
 13126        MOVE CERTCARI            TO LA-CARRIER.
 13127
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 245
* EL131.cbl
 13128
 13129* EXEC CICS REWRITE
 13130*         DATASET  (ARCH-FILE-ID)
 13131*         FROM     (LETTER-ARCHIVE)
 13132*    END-EXEC.
 13133     MOVE LENGTH OF
 13134      LETTER-ARCHIVE
 13135       TO DFHEIV11
 13136*    MOVE '&& L                  %   #00011418' TO DFHEIV0
 13137     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13138     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13139     MOVE X'2020233030303131343138' TO DFHEIV0(25:11)
 13140     CALL 'kxdfhei1' USING DFHEIV0,
 13141           ARCH-FILE-ID,
 13142           LETTER-ARCHIVE,
 13143           DFHEIV11,
 13144           DFHEIV99
 13145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13146
 13147
 13148     GO TO 2475-EXIT.
 13149
 13150 2475-UNLOCK.
 13151
 13152* EXEC CICS UNLOCK
 13153*         DATASET  (ARCH-FILE-ID)
 13154*    END-EXEC.
 13155*    MOVE '&*                    #   #00011426' TO DFHEIV0
 13156     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13157     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13158     MOVE X'2020233030303131343236' TO DFHEIV0(25:11)
 13159     CALL 'kxdfhei1' USING DFHEIV0,
 13160           ARCH-FILE-ID,
 13161           DFHEIV99
 13162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13163
 13164
 13165 2475-EXIT.
 13166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 246
* EL131.cbl
 13168 2600-CREATE-MAINT-NOTE.
 13169     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13170     MOVE '1'                    TO CNTL-REC-TYPE.
 13171     MOVE SPACES                 TO CNTL-PROC-ID.
 13172     MOVE ZERO                   TO CNTL-SEQ-NO.
 13173
 13174
 13175* EXEC CICS READ
 13176*         SET        (ADDRESS OF CONTROL-FILE)
 13177*         DATASET    ('ELCNTL')
 13178*         RIDFLD     (CNTL-KEY)
 13179*    END-EXEC.
 13180     MOVE 'ELCNTL' TO DFHEIV1
 13181*    MOVE '&"S        E          (   #00011439' TO DFHEIV0
 13182     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13184     MOVE X'2020233030303131343339' TO DFHEIV0(25:11)
 13185     CALL 'kxdfhei1' USING DFHEIV0,
 13186           DFHEIV1,
 13187           DFHEIV20,
 13188           DFHEIV99,
 13189           CNTL-KEY,
 13190           DFHEIV99,
 13191           DFHEIV99,
 13192           DFHEIV99
 13193     SET ADDRESS OF CONTROL-FILE TO
 13194         DFHEIV20
 13195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13196
 13197
 13198     IF CO-NO-USE-AUDIT-CHANGES
 13199         GO TO 2600-EXIT.
 13200
 13201     IF PROCL GREATER ZERO
 13202     IF PROCI NOT = LOW-VALUES
 13203     IF PROCI NOT = CL-PROCESSOR-ID
 13204         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13205         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13206         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13207
 13208     IF SEXL GREATER ZERO
 13209     IF SEXI NOT = LOW-VALUES
 13210     IF SEXI NOT = CL-INSURED-SEX-CD
 13211         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13212         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13213         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13214
 13215     IF BIRTHL GREATER ZERO
 13216     IF HOLD-BIRTH NOT = LOW-VALUES
 13217     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13218         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13219         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13220         MOVE SPACES               TO DC-OPTION-CODE
 13221         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13222         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13223         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13224
 13225     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 247
* EL131.cbl
 13226     IF SOCIALI NOT = LOW-VALUES
 13227     IF SOCIALI NOT = CL-SOC-SEC-NO
 13228         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13229         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13230         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13231
 13232     IF OCCL GREATER ZERO
 13233     IF OCCI NOT = LOW-VALUES
 13234     IF OCCI NOT = CL-INSURED-OCC-CD
 13235         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13236         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13237         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13238
 13239     IF BENEL GREATER ZERO
 13240     IF BENEI NOT = LOW-VALUES
 13241     IF BENEI NOT = CL-BENEFICIARY
 13242         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13243         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13244         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13245
 13246     IF PREMTYPL GREATER ZERO
 13247     IF PREMTYPI NOT = LOW-VALUES
 13248     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13249         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13250         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13251         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13252
 13253*    IF CAUSEL GREATER ZERO
 13254*    IF CAUSEI NOT = LOW-VALUES
 13255*    IF CAUSEI NOT = CL-CAUSE-CD
 13256*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13257*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13258*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13259
 13260*    IF ENDL GREATER ZERO
 13261*    IF HOLD-END NOT = LOW-VALUES
 13262*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13263*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13264*        MOVE CL-EST-END-OF-DISAB-DT
 13265*                                  TO DC-BIN-DATE-1
 13266*        MOVE SPACES               TO DC-OPTION-CODE
 13267*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13268*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13269*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13270
 13271     IF PDTHRUL GREATER ZERO
 13272     IF HOLD-PDTHRU NOT = LOW-VALUES
 13273     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13274         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13275         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13276         MOVE SPACES               TO DC-OPTION-CODE
 13277         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13278         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13279         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13280
 13281     IF PDAMTL GREATER ZERO
 13282     IF HOLD-PDAMT NOT = ZEROS
 13283     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 248
* EL131.cbl
 13284         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13285         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13286         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13287         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13288
 13289     IF NODAYSL GREATER ZERO
 13290     IF HOLD-NODAYS NOT = ZEROS
 13291     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13292         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13293         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13294         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13295         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13296
 13297     IF NOPMTSL GREATER ZERO
 13298     IF HOLD-NOPMTS NOT = ZEROS
 13299     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13300         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13301         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13302         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13303         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13304
 13305     IF FORMTYPL GREATER ZERO
 13306     IF FORMTYPI NOT = LOW-VALUES
 13307     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13308         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13309         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13310         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13311
 13312     IF REPL GREATER ZERO
 13313     IF HOLD-REPORTED NOT = LOW-VALUES
 13314     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13315         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13316         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13317         MOVE SPACES               TO DC-OPTION-CODE
 13318         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13319         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13320         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13321
 13322     IF ADDONDTL GREATER ZERO
 13323     IF HOLD-ADDON NOT = LOW-VALUES
 13324     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13325         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13326         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13327         MOVE SPACES               TO DC-OPTION-CODE
 13328         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13329         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13330         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13331
 13332     IF PRICDL GREATER ZERO
 13333     IF PRICDI NOT = LOW-VALUES
 13334     IF PRICDI NOT = CL-PRIORITY-CD
 13335         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13336         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13337         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13338
 13339     IF FILETOL GREATER ZERO
 13340     IF FILETOI NOT = LOW-VALUES
 13341     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 249
* EL131.cbl
 13342         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13343         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13344         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13345
 13346     IF SUPVL GREATER ZERO
 13347     IF SUPVI NOT = LOW-VALUES
 13348     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13349         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13350         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13351         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13352*    IF (CRITPTL > ZERO)
 13353*       AND (CRITPTI NOT = LOW-VALUES)
 13354*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13355*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13356*       MOVE CL-CRIT-PER-RECURRENT
 13357*                                TO SPLIT-INFO-OLD
 13358*       PERFORM 2650-WRITE-MAINT-NOTE
 13359*                                THRU 2650-EXIT
 13360*    END-IF
 13361
 13362*    IF (RTWMOSL > ZERO)
 13363*       AND (RTWMOSI NOT = LOW-VALUES)
 13364*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13365*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13366*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13367*       PERFORM 2650-WRITE-MAINT-NOTE
 13368*                                THRU 2650-EXIT
 13369*    END-IF
 13370     IF MLNAMEL GREATER ZERO
 13371     IF MLNAMEI NOT = LOW-VALUES
 13372     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13373         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13374         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13375         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13376
 13377     IF MFNAMEL GREATER ZERO
 13378     IF MFNAMEI NOT = LOW-VALUES
 13379     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13380         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13381         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13382         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13383
 13384     IF MMINITL GREATER ZERO
 13385     IF MMINITI NOT = LOW-VALUES
 13386     IF MMINITI NOT = CL-INSURED-MID-INIT
 13387         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13388         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13389         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13390
 13391     IF CERTEFFL GREATER ZERO
 13392     IF HOLD-EFF NOT = LOW-VALUES
 13393     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13394         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13395         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13396         MOVE SPACES               TO DC-OPTION-CODE
 13397         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13398         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13399         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 250
* EL131.cbl
 13400
 13401     IF CERTACTL GREATER ZERO
 13402     IF CERTACTI NOT = LOW-VALUES
 13403     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13404         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13405         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13406         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13407
 13408     IF CERTSTL GREATER ZERO
 13409     IF CERTSTI NOT = LOW-VALUES
 13410     IF CERTSTI NOT = CL-CERT-STATE
 13411         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13412         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13413         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13414
 13415     IF CERTCARL GREATER ZERO
 13416     IF CERTCARI NOT = LOW-VALUES
 13417     IF CERTCARI NOT = CL-CERT-CARRIER
 13418         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13419         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13420         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13421
 13422     IF CERTGRPL GREATER ZERO
 13423     IF CERTGRPI NOT = LOW-VALUES
 13424     IF CERTGRPI NOT = CL-CERT-GROUPING
 13425         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13426         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13427         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13428
 13429     IF CERTL GREATER ZERO OR
 13430        SUFXL GREATER ZERO
 13431     IF (CERTI NOT = LOW-VALUES AND
 13432                     CL-CERT-PRIME)
 13433                OR
 13434        (SUFXI NOT = LOW-VALUES AND
 13435                     CL-CERT-SFX)
 13436         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13437         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13438         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13439     IF incl > zeros
 13440        IF (HOLD-INCUR NOT = LOW-VALUES)
 13441           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13442           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13443           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13444           MOVE SPACES           TO DC-OPTION-CODE
 13445           PERFORM 9800-CONVERT-DATE
 13446                                 THRU 9800-EXIT
 13447           MOVE DC-GREG-DATE-1-EDIT
 13448                                 TO SPLIT-INFO-OLD
 13449           PERFORM 2650-WRITE-MAINT-NOTE
 13450                                 THRU 2650-EXIT
 13451        END-IF
 13452     END-IF
 13453     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 13454       IF (REPL GREATER ZERO
 13455         AND HOLD-REPORTED NOT = LOW-VALUES
 13456         AND HOLD-REPORTED NOT = CL-REPORTED-DT)
 13457        OR (incl > zeros
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 251
* EL131.cbl
 13458          AND (HOLD-INCUR NOT = LOW-VALUES)
 13459             AND (HOLD-INCUR NOT = CL-INCURRED-DT))
 13460          PERFORM 2610-CHECK-2-YEAR-CONTESTABLE THRU 2610-EXIT
 13461       END-IF
 13462     END-IF
 13463     IF incl > zeros
 13464       AND PI-COMPANY-ID = 'CID'
 13465        IF (HOLD-INCUR NOT = LOW-VALUES)
 13466           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13467           IF TYPEI = PI-AH-OVERRIDE-L1
 13468              SET ELAPSED-BETWEEN-BIN TO TRUE
 13469              MOVE ZERO               TO DC-ELAPSED-MONTHS
 13470                                         DC-ELAPSED-DAYS
 13471
 13472              MOVE HOLD-INCUR  TO DC-BIN-DATE-1
 13473              MOVE SAVE-BIN-DATE TO DC-BIN-DATE-2
 13474              PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13475              IF DC-ODD-DAYS-OVER > ZERO
 13476                 ADD 1 TO DC-ELAPSED-MONTHS
 13477              END-IF
 13478
 13479              IF PI-STATE = 'HI'
 13480                AND DC-ELAPSED-MONTHS <= 18
 13481                 CONTINUE
 13482              ELSE
 13483                 IF DC-ELAPSED-MONTHS > 15
 13484                    MOVE ER-7572            TO EMI-ERROR
 13485                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13486                 END-IF
 13487              END-IF
 13488              PERFORM 2620-CHECK-TRLR THRU 2620-EXIT
 13489           END-IF
 13490        END-IF
 13491     END-IF
 13492     .
 13493 2600-EXIT.
 13494      EXIT.
 13495 2610-CHECK-2-YEAR-CONTESTABLE.
 13496     SET ELAPSED-BETWEEN-BIN TO TRUE
 13497     MOVE ZERO               TO DC-ELAPSED-MONTHS
 13498                                DC-ELAPSED-DAYS
 13499
 13500     MOVE HOLD-EFF TO DC-BIN-DATE-1.
 13501     IF HOLD-INCUR > SPACES
 13502        MOVE HOLD-INCUR TO DC-BIN-DATE-2
 13503     ELSE
 13504        MOVE CL-INCURRED-DT TO DC-BIN-DATE-2
 13505     END-IF
 13506     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13507     IF DC-ODD-DAYS-OVER > ZERO
 13508        ADD 1 TO DC-ELAPSED-MONTHS
 13509     END-IF
 13510
 13511     IF DC-ELAPSED-MONTHS <= 24
 13512        IF HOLD-REPORTED > SPACES
 13513           MOVE HOLD-REPORTED TO DC-BIN-DATE-2
 13514        ELSE
 13515           MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 252
* EL131.cbl
 13516        END-IF
 13517        MOVE ZERO           TO DC-ELAPSED-MONTHS
 13518                               DC-ELAPSED-DAYS
 13519        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13520        IF DC-ODD-DAYS-OVER > ZERO
 13521           ADD 1 TO DC-ELAPSED-MONTHS
 13522        END-IF
 13523        IF DC-ELAPSED-MONTHS > 24
 13524           MOVE ER-1679            TO EMI-ERROR
 13525           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13526        ELSE
 13527           MOVE 1                  TO EMI-ERROR
 13528        END-IF
 13529     END-IF.
 13530
 13531     PERFORM 2615-CHECK-TRLR THRU 2615-EXIT.
 13532
 13533 2610-EXIT.
 13534     EXIT.
 13535 2615-CHECK-TRLR.
 13536
 13537     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13538     MOVE +96              TO TRLR-SEQ-NO
 13539
 13540* EXEC CICS READ
 13541*       UPDATE
 13542*       DATASET  ('ELTRLR')
 13543*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13544*       RIDFLD   (TRLR-KEY)
 13545*       RESP     (WS-RESPONSE)
 13546*    END-EXEC
 13547     MOVE 'ELTRLR' TO DFHEIV1
 13548*    MOVE '&"S        EU         (  N#00011786' TO DFHEIV0
 13549     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13550     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13551     MOVE X'204E233030303131373836' TO DFHEIV0(25:11)
 13552     CALL 'kxdfhei1' USING DFHEIV0,
 13553           DFHEIV1,
 13554           DFHEIV20,
 13555           DFHEIV99,
 13556           TRLR-KEY,
 13557           DFHEIV99,
 13558           DFHEIV99,
 13559           DFHEIV99
 13560     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13561         DFHEIV20
 13562     MOVE EIBRESP  TO WS-RESPONSE
 13563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13564     IF WS-RESP-NORMAL
 13565        IF EMI-ERROR =  ER-1679
 13566           IF EMI-ERROR-NUMBER(1) = ER-1679
 13567              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13568           ELSE
 13569           IF EMI-ERROR-NUMBER(2) = ER-1679
 13570              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13571           ELSE
 13572           IF EMI-ERROR-NUMBER(3) = ER-1679
 13573              MOVE EMI-LINE3 TO AT-INFO-LINE-1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 253
* EL131.cbl
 13574           END-IF
 13575           END-IF
 13576           END-IF
 13577
 13578* EXEC CICS REWRITE
 13579*             DATASET   ('ELTRLR')
 13580*             FROM      (ACTIVITY-TRAILERS)
 13581*          END-EXEC
 13582     MOVE LENGTH OF
 13583      ACTIVITY-TRAILERS
 13584       TO DFHEIV11
 13585     MOVE 'ELTRLR' TO DFHEIV1
 13586*    MOVE '&& L                  %   #00011806' TO DFHEIV0
 13587     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13588     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13589     MOVE X'2020233030303131383036' TO DFHEIV0(25:11)
 13590     CALL 'kxdfhei1' USING DFHEIV0,
 13591           DFHEIV1,
 13592           ACTIVITY-TRAILERS,
 13593           DFHEIV11,
 13594           DFHEIV99
 13595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13596        ELSE
 13597           IF EMI-ERROR = 1
 13598              MOVE WS-CONTEST-NOTE TO AT-INFO-LINE-1
 13599              MOVE ZERO TO EMI-ERROR
 13600
 13601* EXEC CICS REWRITE
 13602*                DATASET   ('ELTRLR')
 13603*                FROM      (ACTIVITY-TRAILERS)
 13604*             END-EXEC
 13605     MOVE LENGTH OF
 13606      ACTIVITY-TRAILERS
 13607       TO DFHEIV11
 13608     MOVE 'ELTRLR' TO DFHEIV1
 13609*    MOVE '&& L                  %   #00011814' TO DFHEIV0
 13610     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13611     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13612     MOVE X'2020233030303131383134' TO DFHEIV0(25:11)
 13613     CALL 'kxdfhei1' USING DFHEIV0,
 13614           DFHEIV1,
 13615           ACTIVITY-TRAILERS,
 13616           DFHEIV11,
 13617           DFHEIV99
 13618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13619           ELSE
 13620
 13621* EXEC CICS DELETE
 13622*                DATASET   ('ELTRLR')
 13623*             END-EXEC
 13624     MOVE 'ELTRLR' TO DFHEIV1
 13625*    MOVE '&(                    &   #00011819' TO DFHEIV0
 13626     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13628     MOVE X'2020233030303131383139' TO DFHEIV0(25:11)
 13629     CALL 'kxdfhei1' USING DFHEIV0,
 13630           DFHEIV1,
 13631           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 254
* EL131.cbl
 13632           DFHEIV99,
 13633           DFHEIV99,
 13634           DFHEIV99
 13635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13636           END-IF
 13637        END-IF
 13638     ELSE
 13639     IF EMI-ERROR =  ER-1679
 13640
 13641* EXEC CICS GETMAIN
 13642*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13643*          LENGTH   (TRLR-LENGTH)
 13644*          INITIMG  (GETMAIN-SPACE)
 13645*       END-EXEC
 13646*    MOVE ',"IL                  $   #00011826' TO DFHEIV0
 13647     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13648     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13649     MOVE X'2020233030303131383236' TO DFHEIV0(25:11)
 13650     CALL 'kxdfhei1' USING DFHEIV0,
 13651           DFHEIV20,
 13652           TRLR-LENGTH,
 13653           GETMAIN-SPACE
 13654     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13655         DFHEIV20
 13656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13657        MOVE 'AT'          TO AT-RECORD-ID
 13658        MOVE CL-CONTROL-PRIMARY
 13659                           TO AT-CONTROL-PRIMARY
 13660        MOVE +96           TO AT-SEQUENCE-NO
 13661        MOVE '6'           TO AT-TRAILER-TYPE
 13662        MOVE SPACES             TO AT-GENERAL-INFO-TR
 13663        INITIALIZE AT-GENERAL-INFO-TR
 13664        IF EMI-ERROR-NUMBER(1) = ER-1679
 13665           MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13666        ELSE
 13667        IF EMI-ERROR-NUMBER(2) = ER-1679
 13668           MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13669        ELSE
 13670        IF EMI-ERROR-NUMBER(3) = ER-1679
 13671           MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13672        END-IF
 13673        END-IF
 13674        END-IF
 13675        MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13676        MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13677                              AT-GEN-INFO-LAST-MAINT-DT
 13678        MOVE PI-PROCESSOR-ID
 13679                           TO AT-RECORDED-BY
 13680                              AT-GEN-INFO-LAST-UPDATED-BY
 13681        MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13682
 13683* EXEC CICS WRITE
 13684*          DATASET   ('ELTRLR')
 13685*          FROM      (ACTIVITY-TRAILERS)
 13686*          RIDFLD    (TRLR-KEY)
 13687*       END-EXEC
 13688     MOVE LENGTH OF
 13689      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 255
* EL131.cbl
 13690       TO DFHEIV11
 13691     MOVE 'ELTRLR' TO DFHEIV1
 13692*    MOVE '&$ L                  ''   #00011856' TO DFHEIV0
 13693     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13695     MOVE X'2020233030303131383536' TO DFHEIV0(25:11)
 13696     CALL 'kxdfhei1' USING DFHEIV0,
 13697           DFHEIV1,
 13698           ACTIVITY-TRAILERS,
 13699           DFHEIV11,
 13700           TRLR-KEY,
 13701           DFHEIV99,
 13702           DFHEIV99
 13703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13704     END-IF
 13705     END-IF
 13706     .
 13707 2615-EXIT.
 13708     EXIT.
 13709
 13710 2620-CHECK-TRLR.
 13711
 13712     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13713     MOVE +97                  TO TRLR-SEQ-NO
 13714
 13715* EXEC CICS READ
 13716*       UPDATE
 13717*       DATASET  ('ELTRLR')
 13718*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13719*       RIDFLD   (TRLR-KEY)
 13720*       RESP     (WS-RESPONSE)
 13721*    END-EXEC
 13722     MOVE 'ELTRLR' TO DFHEIV1
 13723*    MOVE '&"S        EU         (  N#00011871' TO DFHEIV0
 13724     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13725     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13726     MOVE X'204E233030303131383731' TO DFHEIV0(25:11)
 13727     CALL 'kxdfhei1' USING DFHEIV0,
 13728           DFHEIV1,
 13729           DFHEIV20,
 13730           DFHEIV99,
 13731           TRLR-KEY,
 13732           DFHEIV99,
 13733           DFHEIV99,
 13734           DFHEIV99
 13735     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13736         DFHEIV20
 13737     MOVE EIBRESP  TO WS-RESPONSE
 13738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13739     IF WS-RESP-NORMAL
 13740        IF EMI-ERROR =  ER-7572
 13741           MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13742
 13743* EXEC CICS REWRITE
 13744*             DATASET   ('ELTRLR')
 13745*             FROM      (ACTIVITY-TRAILERS)
 13746*          END-EXEC
 13747     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 256
* EL131.cbl
 13748      ACTIVITY-TRAILERS
 13749       TO DFHEIV11
 13750     MOVE 'ELTRLR' TO DFHEIV1
 13751*    MOVE '&& L                  %   #00011881' TO DFHEIV0
 13752     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13753     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13754     MOVE X'2020233030303131383831' TO DFHEIV0(25:11)
 13755     CALL 'kxdfhei1' USING DFHEIV0,
 13756           DFHEIV1,
 13757           ACTIVITY-TRAILERS,
 13758           DFHEIV11,
 13759           DFHEIV99
 13760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13761        ELSE
 13762           MOVE WS-FILE-LIM-NOTE TO AT-INFO-LINE-1
 13763
 13764* EXEC CICS REWRITE
 13765*                DATASET   ('ELTRLR')
 13766*                FROM      (ACTIVITY-TRAILERS)
 13767*             END-EXEC
 13768     MOVE LENGTH OF
 13769      ACTIVITY-TRAILERS
 13770       TO DFHEIV11
 13771     MOVE 'ELTRLR' TO DFHEIV1
 13772*    MOVE '&& L                  %   #00011887' TO DFHEIV0
 13773     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13774     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13775     MOVE X'2020233030303131383837' TO DFHEIV0(25:11)
 13776     CALL 'kxdfhei1' USING DFHEIV0,
 13777           DFHEIV1,
 13778           ACTIVITY-TRAILERS,
 13779           DFHEIV11,
 13780           DFHEIV99
 13781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13782        END-IF
 13783     ELSE
 13784        IF EMI-ERROR =  ER-7572
 13785
 13786* EXEC CICS GETMAIN
 13787*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13788*             LENGTH   (TRLR-LENGTH)
 13789*             INITIMG  (GETMAIN-SPACE)
 13790*          END-EXEC
 13791*    MOVE ',"IL                  $   #00011894' TO DFHEIV0
 13792     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13793     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13794     MOVE X'2020233030303131383934' TO DFHEIV0(25:11)
 13795     CALL 'kxdfhei1' USING DFHEIV0,
 13796           DFHEIV20,
 13797           TRLR-LENGTH,
 13798           GETMAIN-SPACE
 13799     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13800         DFHEIV20
 13801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13802           MOVE 'AT'          TO AT-RECORD-ID
 13803           MOVE CL-CONTROL-PRIMARY
 13804                              TO AT-CONTROL-PRIMARY
 13805           MOVE +97           TO AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 257
* EL131.cbl
 13806           MOVE '6'           TO AT-TRAILER-TYPE
 13807           MOVE SPACES             TO AT-GENERAL-INFO-TR
 13808           INITIALIZE AT-GENERAL-INFO-TR
 13809           MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13810           MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13811           MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13812                                 AT-GEN-INFO-LAST-MAINT-DT
 13813           MOVE PI-PROCESSOR-ID
 13814                              TO AT-RECORDED-BY
 13815                                 AT-GEN-INFO-LAST-UPDATED-BY
 13816           MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13817
 13818* EXEC CICS WRITE
 13819*             DATASET   ('ELTRLR')
 13820*             FROM      (ACTIVITY-TRAILERS)
 13821*             RIDFLD    (TRLR-KEY)
 13822*          END-EXEC
 13823     MOVE LENGTH OF
 13824      ACTIVITY-TRAILERS
 13825       TO DFHEIV11
 13826     MOVE 'ELTRLR' TO DFHEIV1
 13827*    MOVE '&$ L                  ''   #00011914' TO DFHEIV0
 13828     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13830     MOVE X'2020233030303131393134' TO DFHEIV0(25:11)
 13831     CALL 'kxdfhei1' USING DFHEIV0,
 13832           DFHEIV1,
 13833           ACTIVITY-TRAILERS,
 13834           DFHEIV11,
 13835           TRLR-KEY,
 13836           DFHEIV99,
 13837           DFHEIV99
 13838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13839        END-IF
 13840     END-IF
 13841     .
 13842 2620-EXIT.
 13843     EXIT.
 13844
 13845 2650-WRITE-MAINT-NOTE.
 13846
 13847* EXEC CICS GETMAIN
 13848*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13849*         LENGTH   (TRLR-LENGTH)
 13850*         INITIMG  (GETMAIN-SPACE)
 13851*    END-EXEC.
 13852*    MOVE ',"IL                  $   #00011926' TO DFHEIV0
 13853     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13854     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13855     MOVE X'2020233030303131393236' TO DFHEIV0(25:11)
 13856     CALL 'kxdfhei1' USING DFHEIV0,
 13857           DFHEIV20,
 13858           TRLR-LENGTH,
 13859           GETMAIN-SPACE
 13860     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13861         DFHEIV20
 13862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13863
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 258
* EL131.cbl
 13864
 13865
 13866* EXEC CICS HANDLE CONDITION
 13867*         DUPREC   (2650-EXIT)
 13868*    END-EXEC.
 13869*    MOVE '"$%                   ! ; #00011932' TO DFHEIV0
 13870     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13872     MOVE X'3B20233030303131393332' TO DFHEIV0(25:11)
 13873     CALL 'kxdfhei1' USING DFHEIV0
 13874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13875
 13876
 13877     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13878
 13879     IF CERTL GREATER ZERO
 13880         MOVE CERTI          TO CL-CERT-PRIME.
 13881
 13882     IF SUFXL GREATER ZERO
 13883         MOVE SUFXI          TO CL-CERT-SFX.
 13884
 13885     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13886
 13887     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13888     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13889
 13890     MOVE 'AT'               TO AT-RECORD-ID.
 13891
 13892     MOVE '6'                TO AT-TRAILER-TYPE.
 13893     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13894                                AT-GEN-INFO-LAST-MAINT-DT.
 13895     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13896                                AT-GEN-INFO-LAST-UPDATED-BY.
 13897     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13898     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13899     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13900
 13901
 13902* EXEC CICS WRITE
 13903*         DATASET  (TRLR-FILE-ID)
 13904*         RIDFLD   (AT-CONTROL-PRIMARY)
 13905*         FROM     (ACTIVITY-TRAILERS)
 13906*    END-EXEC.
 13907     MOVE LENGTH OF
 13908      ACTIVITY-TRAILERS
 13909       TO DFHEIV11
 13910*    MOVE '&$ L                  ''   #00011960' TO DFHEIV0
 13911     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13912     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13913     MOVE X'2020233030303131393630' TO DFHEIV0(25:11)
 13914     CALL 'kxdfhei1' USING DFHEIV0,
 13915           TRLR-FILE-ID,
 13916           ACTIVITY-TRAILERS,
 13917           DFHEIV11,
 13918           AT-CONTROL-PRIMARY,
 13919           DFHEIV99,
 13920           DFHEIV99
 13921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 259
* EL131.cbl
 13922
 13923
 13924 2650-EXIT.
 13925      EXIT.
 13926
 13927 2800-CHECK-AUTO-PAY.
 13928
 13929     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13930     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13931     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13932     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13933     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13934
 13935
 13936* EXEC CICS HANDLE CONDITION
 13937*         NOTFND    (2800-EXIT)
 13938*         ENDFILE   (2800-EXIT)
 13939*    END-EXEC.
 13940*    MOVE '"$I''                  ! < #00011977' TO DFHEIV0
 13941     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13942     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13943     MOVE X'3C20233030303131393737' TO DFHEIV0(25:11)
 13944     CALL 'kxdfhei1' USING DFHEIV0
 13945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13946
 13947
 13948
 13949* EXEC CICS READ
 13950*        DATASET (TRLR-FILE-ID)
 13951*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13952*        RIDFLD  (TRLR-KEY)
 13953*    END-EXEC.
 13954*    MOVE '&"S        E          (   #00011982' TO DFHEIV0
 13955     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13957     MOVE X'2020233030303131393832' TO DFHEIV0(25:11)
 13958     CALL 'kxdfhei1' USING DFHEIV0,
 13959           TRLR-FILE-ID,
 13960           DFHEIV20,
 13961           DFHEIV99,
 13962           TRLR-KEY,
 13963           DFHEIV99,
 13964           DFHEIV99,
 13965           DFHEIV99
 13966     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13967         DFHEIV20
 13968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13969
 13970
 13971     IF BENEFICIARY-PAID-AUTO
 13972         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13973     END-IF.
 13974
 13975 2800-EXIT.
 13976      EXIT.
 13977
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 260
* EL131.cbl
 13979 3000-DELETE-CLAIM.
 13980     IF  NOT MODIFY-CAP
 13981         MOVE ER-0070            TO EMI-ERROR
 13982         MOVE -1                 TO MAINTL
 13983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13984         GO TO 8110-SEND-DATA.
 13985
 13986
 13987* EXEC CICS READ
 13988*         SET      (ADDRESS OF CLAIM-MASTER)
 13989*         DATASET  (CLMS-FILE-ID)
 13990*         RIDFLD   (MSTR-KEY)
 13991*    END-EXEC.
 13992*    MOVE '&"S        E          (   #00012003' TO DFHEIV0
 13993     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13995     MOVE X'2020233030303132303033' TO DFHEIV0(25:11)
 13996     CALL 'kxdfhei1' USING DFHEIV0,
 13997           CLMS-FILE-ID,
 13998           DFHEIV20,
 13999           DFHEIV99,
 14000           MSTR-KEY,
 14001           DFHEIV99,
 14002           DFHEIV99,
 14003           DFHEIV99
 14004     SET ADDRESS OF CLAIM-MASTER TO
 14005         DFHEIV20
 14006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14007
 14008
 14009     IF CL-1ST-TRL-AVAIL
 14010         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 14011     ELSE
 14012        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 14013        MOVE 0                   TO TRLR-SEQ-NO
 14014
 14015* EXEC CICS STARTBR
 14016*            DATASET (TRLR-FILE-ID)
 14017*            RIDFLD  (TRLR-KEY)
 14018*        END-EXEC
 14019     MOVE 0
 14020       TO DFHEIV11
 14021*    MOVE '&,         G          &   #00012014' TO DFHEIV0
 14022     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14023     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14024     MOVE X'2020233030303132303134' TO DFHEIV0(25:11)
 14025     CALL 'kxdfhei1' USING DFHEIV0,
 14026           TRLR-FILE-ID,
 14027           TRLR-KEY,
 14028           DFHEIV99,
 14029           DFHEIV11,
 14030           DFHEIV99
 14031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14032         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 14033
 14034* EXEC CICS ENDBR
 14035*            DATASET (TRLR-FILE-ID)
 14036*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 261
* EL131.cbl
 14037     MOVE 0
 14038       TO DFHEIV11
 14039*    MOVE '&2                    $   #00012019' TO DFHEIV0
 14040     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14041     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14042     MOVE X'2020233030303132303139' TO DFHEIV0(25:11)
 14043     CALL 'kxdfhei1' USING DFHEIV0,
 14044           TRLR-FILE-ID,
 14045           DFHEIV11,
 14046           DFHEIV99
 14047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14048        IF SCREEN-ERROR
 14049            MOVE ER-0208         TO EMI-ERROR
 14050            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14051            MOVE -1              TO MAINTL
 14052            GO TO 8110-SEND-DATA
 14053        ELSE
 14054            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 14055
 14056     IF SCREEN-ERROR
 14057         MOVE -1                 TO MAINTL
 14058         GO TO 8110-SEND-DATA.
 14059
 14060     MOVE -1                     TO ONE-OR-MIN1.
 14061     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 14062
 14063     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 14064         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 14065                                    WS-SAVE-CLAIM-KEY
 14066         MOVE +1                 TO ONE-OR-MIN1
 14067         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 14068
 14069     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 14070
 14071     MOVE LOW-VALUES             TO EL131AO.
 14072     MOVE ER-0000                TO EMI-ERROR.
 14073     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14074     MOVE 'X'                    TO PI-RETURN-CD-1.
 14075     MOVE -1                     TO MAINTL.
 14076     GO TO 8100-SEND-MAP.
 14077
 14078 3010-DEL-MSTR-TRLR.
 14079
 14080* EXEC CICS READ UPDATE
 14081*         SET       (ADDRESS OF CLAIM-MASTER)
 14082*         DATASET   (CLMS-FILE-ID)
 14083*         RIDFLD    (MSTR-KEY)
 14084*    END-EXEC.
 14085*    MOVE '&"S        EU         (   #00012053' TO DFHEIV0
 14086     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14087     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14088     MOVE X'2020233030303132303533' TO DFHEIV0(25:11)
 14089     CALL 'kxdfhei1' USING DFHEIV0,
 14090           CLMS-FILE-ID,
 14091           DFHEIV20,
 14092           DFHEIV99,
 14093           MSTR-KEY,
 14094           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 262
* EL131.cbl
 14095           DFHEIV99,
 14096           DFHEIV99
 14097     SET ADDRESS OF CLAIM-MASTER TO
 14098         DFHEIV20
 14099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14100
 14101
 14102     if (cl-priority-cd = '8')
 14103        and (pi-processor-id not = 'PEMA' and 'JMS '
 14104             AND 'AMWA')
 14105        MOVE ER-8003             TO EMI-ERROR
 14106        PERFORM 9900-ERROR-FORMAT
 14107                                 THRU 9900-EXIT
 14108        MOVE -1                  TO MAINTL
 14109        GO TO 8110-SEND-DATA
 14110     end-if
 14111
 14112     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 14113     MOVE ZERO                   TO TRLR-SEQ-NO.
 14114
 14115
 14116* EXEC CICS HANDLE CONDITION
 14117*         NOTFND    (3010-DEL-ACTQ)
 14118*         ENDFILE   (3040-EXIT)
 14119*    END-EXEC.
 14120*    MOVE '"$I''                  ! = #00012072' TO DFHEIV0
 14121     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14123     MOVE X'3D20233030303132303732' TO DFHEIV0(25:11)
 14124     CALL 'kxdfhei1' USING DFHEIV0
 14125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14126
 14127
 14128     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 14129
 14130 3010-DEL-ACTQ.
 14131
 14132
 14133* EXEC CICS HANDLE CONDITION
 14134*         NOTFND    (3010-NO-ACTIVITY)
 14135*         ENDFILE   (3050-EXIT)
 14136*    END-EXEC.
 14137*    MOVE '"$I''                  ! > #00012081' TO DFHEIV0
 14138     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14140     MOVE X'3E20233030303132303831' TO DFHEIV0(25:11)
 14141     CALL 'kxdfhei1' USING DFHEIV0
 14142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14143
 14144
 14145
 14146* EXEC CICS STARTBR
 14147*         DATASET  (ACTQ-FILE-ID)
 14148*         RIDFLD   (ACTQ-KEY)
 14149*    END-EXEC.
 14150     MOVE 0
 14151       TO DFHEIV11
 14152*    MOVE '&,         G          &   #00012086' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 263
* EL131.cbl
 14153     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14154     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14155     MOVE X'2020233030303132303836' TO DFHEIV0(25:11)
 14156     CALL 'kxdfhei1' USING DFHEIV0,
 14157           ACTQ-FILE-ID,
 14158           ACTQ-KEY,
 14159           DFHEIV99,
 14160           DFHEIV11,
 14161           DFHEIV99
 14162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14163
 14164
 14165
 14166* EXEC CICS GETMAIN
 14167*         SET      (ADDRESS OF ACTIVITY-QUE)
 14168*         LENGTH   (ACTQ-LENGTH)
 14169*         INITIMG  (GETMAIN-SPACE)
 14170*    END-EXEC.
 14171*    MOVE ',"IL                  $   #00012091' TO DFHEIV0
 14172     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14173     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14174     MOVE X'2020233030303132303931' TO DFHEIV0(25:11)
 14175     CALL 'kxdfhei1' USING DFHEIV0,
 14176           DFHEIV20,
 14177           ACTQ-LENGTH,
 14178           GETMAIN-SPACE
 14179     SET ADDRESS OF ACTIVITY-QUE TO
 14180         DFHEIV20
 14181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14182
 14183
 14184     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 14185
 14186
 14187* EXEC CICS ENDBR
 14188*         DATASET (ACTQ-FILE-ID)
 14189*    END-EXEC.
 14190     MOVE 0
 14191       TO DFHEIV11
 14192*    MOVE '&2                    $   #00012099' TO DFHEIV0
 14193     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14194     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14195     MOVE X'2020233030303132303939' TO DFHEIV0(25:11)
 14196     CALL 'kxdfhei1' USING DFHEIV0,
 14197           ACTQ-FILE-ID,
 14198           DFHEIV11,
 14199           DFHEIV99
 14200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14201
 14202
 14203 3010-NO-ACTIVITY.
 14204
 14205
 14206* EXEC CICS HANDLE CONDITION
 14207*        NOTFND   (3010-CERT-NOT-FOUND)
 14208*    END-EXEC.
 14209*    MOVE '"$I                   ! ? #00012105' TO DFHEIV0
 14210     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 264
* EL131.cbl
 14211     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14212     MOVE X'3F20233030303132313035' TO DFHEIV0(25:11)
 14213     CALL 'kxdfhei1' USING DFHEIV0
 14214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14215
 14216
 14217     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 14218     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 14219     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 14220     MOVE CL-CERT-STATE          TO CERT-STATE.
 14221     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 14222     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 14223     MOVE CL-CERT-NO             TO CERT-CERT.
 14224
 14225
 14226* EXEC CICS READ
 14227*        DATASET   (CERT-FILE-ID)
 14228*        RIDFLD    (CERT-KEY)
 14229*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14230*    END-EXEC.
 14231*    MOVE '&"S        E          (   #00012117' TO DFHEIV0
 14232     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14234     MOVE X'2020233030303132313137' TO DFHEIV0(25:11)
 14235     CALL 'kxdfhei1' USING DFHEIV0,
 14236           CERT-FILE-ID,
 14237           DFHEIV20,
 14238           DFHEIV99,
 14239           CERT-KEY,
 14240           DFHEIV99,
 14241           DFHEIV99,
 14242           DFHEIV99
 14243     SET ADDRESS OF CERTIFICATE-MASTER TO
 14244         DFHEIV20
 14245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14246
 14247
 14248     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 14249       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 14250         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 14251     ELSE
 14252         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 14253
 14254 3010-UPDATE-CERT-TRLR.
 14255
 14256     MOVE CERT-KEY               TO ELCRTT-KEY
 14257     MOVE 'B'                    TO CTRLR-REC-TYPE
 14258
 14259* EXEC CICS READ
 14260*       UPDATE
 14261*       DATASET   ('ELCRTT')
 14262*       RIDFLD    (ELCRTT-KEY)
 14263*       INTO      (CERTIFICATE-TRAILERS)
 14264*       RESP      (WS-RESPONSE)
 14265*    END-EXEC
 14266     MOVE LENGTH OF
 14267      CERTIFICATE-TRAILERS
 14268       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 265
* EL131.cbl
 14269     MOVE 'ELCRTT' TO DFHEIV1
 14270*    MOVE '&"IL       EU         (  N#00012133' TO DFHEIV0
 14271     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14272     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14273     MOVE X'204E233030303132313333' TO DFHEIV0(25:11)
 14274     CALL 'kxdfhei1' USING DFHEIV0,
 14275           DFHEIV1,
 14276           CERTIFICATE-TRAILERS,
 14277           DFHEIV11,
 14278           ELCRTT-KEY,
 14279           DFHEIV99,
 14280           DFHEIV99,
 14281           DFHEIV99
 14282     MOVE EIBRESP  TO WS-RESPONSE
 14283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14284     IF WS-RESP-NORMAL
 14285        perform varying s1 from +1 by +1 until
 14286           (s1 > +24)
 14287           or (cs-claim-no (s1) = cl-claim-no)
 14288        end-perform
 14289        if s1 < +25
 14290           move spaces           to cs-claim-no (s1)
 14291                                    cs-claim-type (s1)
 14292                                    cs-insured-type (s1)
 14293           move zeros            to cs-days-paid (s1)
 14294                                    cs-total-paid (s1)
 14295                                    cs-benefit-period (s1)
 14296           if s1 not = +24
 14297              compute s2 = s1 + +1
 14298              perform 3015-bump  thru 3015-exit
 14299           end-if
 14300
 14301* EXEC CICS REWRITE
 14302*             DATASET   ('ELCRTT')
 14303*             FROM      (CERTIFICATE-TRAILERS)
 14304*          END-EXEC
 14305     MOVE LENGTH OF
 14306      CERTIFICATE-TRAILERS
 14307       TO DFHEIV11
 14308     MOVE 'ELCRTT' TO DFHEIV1
 14309*    MOVE '&& L                  %   #00012156' TO DFHEIV0
 14310     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14311     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14312     MOVE X'2020233030303132313536' TO DFHEIV0(25:11)
 14313     CALL 'kxdfhei1' USING DFHEIV0,
 14314           DFHEIV1,
 14315           CERTIFICATE-TRAILERS,
 14316           DFHEIV11,
 14317           DFHEIV99
 14318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14319        end-if
 14320     end-if
 14321     .
 14322 3010-CERT-NOT-FOUND.
 14323
 14324
 14325* EXEC CICS DELETE
 14326*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 266
* EL131.cbl
 14327*    END-EXEC.
 14328*    MOVE '&(                    &   #00012165' TO DFHEIV0
 14329     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14330     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14331     MOVE X'2020233030303132313635' TO DFHEIV0(25:11)
 14332     CALL 'kxdfhei1' USING DFHEIV0,
 14333           CLMS-FILE-ID,
 14334           DFHEIV99,
 14335           DFHEIV99,
 14336           DFHEIV99,
 14337           DFHEIV99
 14338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14339
 14340
 14341 3010-EXIT.
 14342      EXIT.
 14343
 14344 3015-bump.
 14345     perform varying s2 from s2 by +1 until s2 > +24
 14346        move cs-mb-claim-data (s2)
 14347                                 to cs-mb-claim-data (s1)
 14348        move spaces              to cs-mb-claim-data (s2)
 14349        add +1 to s1
 14350     end-perform
 14351     .
 14352 3015-exit.
 14353     exit.
 14354 3020-UPDATE-CERT.
 14355
 14356* EXEC CICS READ UPDATE
 14357*         DATASET  (CERT-FILE-ID)
 14358*         RIDFLD   (CERT-KEY)
 14359*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14360*    END-EXEC.
 14361*    MOVE '&"S        EU         (   #00012183' TO DFHEIV0
 14362     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14363     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14364     MOVE X'2020233030303132313833' TO DFHEIV0(25:11)
 14365     CALL 'kxdfhei1' USING DFHEIV0,
 14366           CERT-FILE-ID,
 14367           DFHEIV20,
 14368           DFHEIV99,
 14369           CERT-KEY,
 14370           DFHEIV99,
 14371           DFHEIV99,
 14372           DFHEIV99
 14373     SET ADDRESS OF CERTIFICATE-MASTER TO
 14374         DFHEIV20
 14375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14376
 14377
 14378     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 14379
 14380
 14381* EXEC CICS HANDLE CONDITION
 14382*         DUPKEY   (3020-EXIT)
 14383*    END-EXEC.
 14384*    MOVE '"$$                   ! @ #00012191' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 267
* EL131.cbl
 14385     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 14386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14387     MOVE X'4020233030303132313931' TO DFHEIV0(25:11)
 14388     CALL 'kxdfhei1' USING DFHEIV0
 14389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14390
 14391
 14392
 14393* EXEC CICS REWRITE
 14394*         DATASET  (CERT-FILE-ID)
 14395*         FROM     (CERTIFICATE-MASTER)
 14396*    END-EXEC.
 14397     MOVE LENGTH OF
 14398      CERTIFICATE-MASTER
 14399       TO DFHEIV11
 14400*    MOVE '&& L                  %   #00012195' TO DFHEIV0
 14401     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14402     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14403     MOVE X'2020233030303132313935' TO DFHEIV0(25:11)
 14404     CALL 'kxdfhei1' USING DFHEIV0,
 14405           CERT-FILE-ID,
 14406           CERTIFICATE-MASTER,
 14407           DFHEIV11,
 14408           DFHEIV99
 14409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14410
 14411
 14412 3020-EXIT.
 14413     EXIT.
 14414
 14415 3030-DELETE-CERT.
 14416
 14417* EXEC CICS READ UPDATE
 14418*         DATASET  (CERT-FILE-ID)
 14419*         RIDFLD   (CERT-KEY)
 14420*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14421*    END-EXEC.
 14422*    MOVE '&"S        EU         (   #00012204' TO DFHEIV0
 14423     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14424     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14425     MOVE X'2020233030303132323034' TO DFHEIV0(25:11)
 14426     CALL 'kxdfhei1' USING DFHEIV0,
 14427           CERT-FILE-ID,
 14428           DFHEIV20,
 14429           DFHEIV99,
 14430           CERT-KEY,
 14431           DFHEIV99,
 14432           DFHEIV99,
 14433           DFHEIV99
 14434     SET ADDRESS OF CERTIFICATE-MASTER TO
 14435         DFHEIV20
 14436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14437
 14438
 14439
 14440* EXEC CICS DELETE
 14441*         DATASET   (CERT-FILE-ID)
 14442*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 268
* EL131.cbl
 14443*    MOVE '&(                    &   #00012210' TO DFHEIV0
 14444     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14446     MOVE X'2020233030303132323130' TO DFHEIV0(25:11)
 14447     CALL 'kxdfhei1' USING DFHEIV0,
 14448           CERT-FILE-ID,
 14449           DFHEIV99,
 14450           DFHEIV99,
 14451           DFHEIV99,
 14452           DFHEIV99
 14453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14454
 14455
 14456 3030-EXIT.
 14457     EXIT.
 14458
 14459 3040-DELETE-TRLR.
 14460
 14461* EXEC CICS READ
 14462*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14463*         DATASET  (TRLR-FILE-ID)
 14464*         RIDFLD   (TRLR-KEY)
 14465*         GTEQ
 14466*    END-EXEC.
 14467*    MOVE '&"S        G          (   #00012218' TO DFHEIV0
 14468     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14470     MOVE X'2020233030303132323138' TO DFHEIV0(25:11)
 14471     CALL 'kxdfhei1' USING DFHEIV0,
 14472           TRLR-FILE-ID,
 14473           DFHEIV20,
 14474           DFHEIV99,
 14475           TRLR-KEY,
 14476           DFHEIV99,
 14477           DFHEIV99,
 14478           DFHEIV99
 14479     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14480         DFHEIV20
 14481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14482
 14483
 14484     IF PI-COMPANY-CD = AT-COMPANY-CD
 14485        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 14486        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14487           GO TO 3040-EXIT
 14488        ELSE
 14489           NEXT SENTENCE
 14490     ELSE
 14491        GO TO 3040-EXIT.
 14492
 14493
 14494* EXEC CICS DELETE
 14495*         DATASET  (TRLR-FILE-ID)
 14496*         RIDFLD   (TRLR-KEY)
 14497*    END-EXEC.
 14498*    MOVE '&(  R                 &   #00012234' TO DFHEIV0
 14499     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14500     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 269
* EL131.cbl
 14501     MOVE X'2020233030303132323334' TO DFHEIV0(25:11)
 14502     CALL 'kxdfhei1' USING DFHEIV0,
 14503           TRLR-FILE-ID,
 14504           TRLR-KEY,
 14505           DFHEIV99,
 14506           DFHEIV99,
 14507           DFHEIV99
 14508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14509
 14510
 14511     GO TO 3040-DELETE-TRLR.
 14512
 14513 3040-EXIT.
 14514     EXIT.
 14515
 14516 3050-DELETE-ACTQ.
 14517
 14518* EXEC CICS READNEXT
 14519*         DATASET  (ACTQ-FILE-ID)
 14520*         RIDFLD   (ACTQ-KEY)
 14521*         INTO     (ACTIVITY-QUE)
 14522*    END-EXEC.
 14523     MOVE LENGTH OF
 14524      ACTIVITY-QUE
 14525       TO DFHEIV12
 14526     MOVE 0
 14527       TO DFHEIV11
 14528*    MOVE '&.IL                  )   #00012245' TO DFHEIV0
 14529     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14530     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14531     MOVE X'2020233030303132323435' TO DFHEIV0(25:11)
 14532     CALL 'kxdfhei1' USING DFHEIV0,
 14533           ACTQ-FILE-ID,
 14534           ACTIVITY-QUE,
 14535           DFHEIV12,
 14536           ACTQ-KEY,
 14537           DFHEIV99,
 14538           DFHEIV11,
 14539           DFHEIV99,
 14540           DFHEIV99
 14541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14542
 14543
 14544     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14545         GO TO 3050-EXIT.
 14546
 14547
 14548* EXEC CICS ENDBR
 14549*         DATASET  (ACTQ-FILE-ID)
 14550*    END-EXEC.
 14551     MOVE 0
 14552       TO DFHEIV11
 14553*    MOVE '&2                    $   #00012254' TO DFHEIV0
 14554     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14555     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14556     MOVE X'2020233030303132323534' TO DFHEIV0(25:11)
 14557     CALL 'kxdfhei1' USING DFHEIV0,
 14558           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 270
* EL131.cbl
 14559           DFHEIV11,
 14560           DFHEIV99
 14561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14562
 14563
 14564
 14565* EXEC CICS DELETE
 14566*         DATASET   (ACTQ-FILE-ID)
 14567*         RIDFLD    (ACTQ-KEY)
 14568*    END-EXEC.
 14569*    MOVE '&(  R                 &   #00012258' TO DFHEIV0
 14570     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14571     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14572     MOVE X'2020233030303132323538' TO DFHEIV0(25:11)
 14573     CALL 'kxdfhei1' USING DFHEIV0,
 14574           ACTQ-FILE-ID,
 14575           ACTQ-KEY,
 14576           DFHEIV99,
 14577           DFHEIV99,
 14578           DFHEIV99
 14579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14580
 14581
 14582
 14583* EXEC CICS STARTBR
 14584*         DATASET   (ACTQ-FILE-ID)
 14585*         RIDFLD    (ACTQ-KEY)
 14586*    END-EXEC.
 14587     MOVE 0
 14588       TO DFHEIV11
 14589*    MOVE '&,         G          &   #00012263' TO DFHEIV0
 14590     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14591     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14592     MOVE X'2020233030303132323633' TO DFHEIV0(25:11)
 14593     CALL 'kxdfhei1' USING DFHEIV0,
 14594           ACTQ-FILE-ID,
 14595           ACTQ-KEY,
 14596           DFHEIV99,
 14597           DFHEIV11,
 14598           DFHEIV99
 14599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14600
 14601
 14602     GO TO 3050-DELETE-ACTQ.
 14603
 14604 3050-EXIT.
 14605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 271
* EL131.cbl
 14607 3060-READ-TRLR.
 14608
 14609* EXEC CICS HANDLE CONDITION
 14610*         NOTFND    (3060-EXIT)
 14611*         ENDFILE   (3060-EXIT)
 14612*    END-EXEC.
 14613*    MOVE '"$I''                  ! A #00012274' TO DFHEIV0
 14614     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14616     MOVE X'4120233030303132323734' TO DFHEIV0(25:11)
 14617     CALL 'kxdfhei1' USING DFHEIV0
 14618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14619
 14620
 14621 3060-LOOP.
 14622
 14623* EXEC CICS READNEXT
 14624*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14625*         DATASET  (TRLR-FILE-ID)
 14626*         RIDFLD   (TRLR-KEY)
 14627*    END-EXEC.
 14628     MOVE 0
 14629       TO DFHEIV11
 14630*    MOVE '&.S                   )   #00012280' TO DFHEIV0
 14631     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14632     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14633     MOVE X'2020233030303132323830' TO DFHEIV0(25:11)
 14634     CALL 'kxdfhei1' USING DFHEIV0,
 14635           TRLR-FILE-ID,
 14636           DFHEIV20,
 14637           DFHEIV99,
 14638           TRLR-KEY,
 14639           DFHEIV99,
 14640           DFHEIV11,
 14641           DFHEIV99,
 14642           DFHEIV99
 14643     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14644         DFHEIV20
 14645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14646
 14647
 14648     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14649         GO TO 3060-EXIT.
 14650
 14651     IF FORM-CONTROL-TR
 14652         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14653             NEXT SENTENCE
 14654         ELSE
 14655             MOVE 'X'            TO ERROR-SWITCH
 14656             GO TO 3060-EXIT
 14657     ELSE
 14658         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14659            MOVE 'X'                 TO ERROR-SWITCH
 14660            GO TO 3060-EXIT.
 14661
 14662     GO TO 3060-LOOP.
 14663
 14664 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 272
* EL131.cbl
 14665     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 273
* EL131.cbl
 14667 3997-GET-ERPDEF.
 14668
 14669     move cl-company-cd          to cert-company-code
 14670     move cl-cert-key-data       to cert-key (2:21)
 14671     move cl-cert-no             to cert-cert
 14672
 14673
 14674* EXEC CICS READ
 14675*        DATASET   (CERT-FILE-ID)
 14676*        RIDFLD    (CERT-KEY)
 14677*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14678*        resp      (ws-response)
 14679*    END-EXEC
 14680*    MOVE '&"S        E          (  N#00012311' TO DFHEIV0
 14681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14683     MOVE X'204E233030303132333131' TO DFHEIV0(25:11)
 14684     CALL 'kxdfhei1' USING DFHEIV0,
 14685           CERT-FILE-ID,
 14686           DFHEIV20,
 14687           DFHEIV99,
 14688           CERT-KEY,
 14689           DFHEIV99,
 14690           DFHEIV99,
 14691           DFHEIV99
 14692     SET ADDRESS OF CERTIFICATE-MASTER TO
 14693         DFHEIV20
 14694     MOVE EIBRESP  TO ws-response
 14695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14696
 14697     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14698                                    WS-ERPDEF-SW
 14699     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14700                                    WS-CRIT-PER-RTW-MOS
 14701
 14702     if cm-clp-state = spaces or low-values or zeros
 14703        move cm-state            to cm-clp-state
 14704     end-if
 14705     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14706     MOVE CM-clp-state           TO ERPDEF-STATE
 14707     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14708     evaluate true
 14709        when (cl-claim-type = 'L' or 'P' OR 'O')
 14710           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14711             and 'CU')
 14712           move 'L'              to erpdef-ben-type
 14713           move cm-lf-benefit-cd to erpdef-ben-code
 14714        when (cl-claim-type not = 'L' and 'P' AND 'O')
 14715           and (cm-ah-benefit-cd not = '00' and '  ')
 14716           move 'A'              to erpdef-ben-type
 14717           move cm-ah-benefit-cd to erpdef-ben-code
 14718        when (cl-claim-type not = 'L' and 'P' AND 'O')
 14719           and (cm-ah-benefit-cd = '00' or '  ')
 14720           move 'L'              to erpdef-ben-type
 14721           move cm-lf-benefit-cd to erpdef-ben-code
 14722        when (cl-claim-type = 'L' or 'P' OR 'O')
 14723           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14724           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 274
* EL131.cbl
 14725           move cm-ah-benefit-cd to erpdef-ben-code
 14726        when other
 14727           move 'A'              to erpdef-ben-type
 14728           move cm-ah-benefit-cd to erpdef-ben-code
 14729     end-evaluate
 14730
 14731*    if (cl-claim-type = 'L' or 'P')
 14732*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14733*          and 'CU')
 14734*       move 'L'                 to erpdef-ben-type
 14735*       move cm-lf-benefit-cd    to erpdef-ben-code
 14736*    else
 14737*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14738*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14739*    end-if
 14740     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14741     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14742
 14743
 14744* EXEC CICS STARTBR
 14745*        DATASET  ('ERPDEF')
 14746*        RIDFLD   (ERPDEF-KEY)
 14747*        GTEQ
 14748*        RESP     (WS-RESPONSE)
 14749*    END-EXEC
 14750     MOVE 'ERPDEF' TO DFHEIV1
 14751     MOVE 0
 14752       TO DFHEIV11
 14753*    MOVE '&,         G          &  N#00012364' TO DFHEIV0
 14754     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14755     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14756     MOVE X'204E233030303132333634' TO DFHEIV0(25:11)
 14757     CALL 'kxdfhei1' USING DFHEIV0,
 14758           DFHEIV1,
 14759           ERPDEF-KEY,
 14760           DFHEIV99,
 14761           DFHEIV11,
 14762           DFHEIV99
 14763     MOVE EIBRESP  TO WS-RESPONSE
 14764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14765
 14766     IF WS-RESP-NORMAL
 14767
 14768* EXEC CICS READNEXT
 14769*          DATASET  ('ERPDEF')
 14770*          INTO     (PRODUCT-MASTER)
 14771*          RIDFLD   (ERPDEF-KEY)
 14772*          RESP     (WS-RESPONSE)
 14773*       END-EXEC
 14774     MOVE LENGTH OF
 14775      PRODUCT-MASTER
 14776       TO DFHEIV12
 14777     MOVE 'ERPDEF' TO DFHEIV1
 14778     MOVE 0
 14779       TO DFHEIV11
 14780*    MOVE '&.IL                  )  N#00012372' TO DFHEIV0
 14781     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14782     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 275
* EL131.cbl
 14783     MOVE X'204E233030303132333732' TO DFHEIV0(25:11)
 14784     CALL 'kxdfhei1' USING DFHEIV0,
 14785           DFHEIV1,
 14786           PRODUCT-MASTER,
 14787           DFHEIV12,
 14788           ERPDEF-KEY,
 14789           DFHEIV99,
 14790           DFHEIV11,
 14791           DFHEIV99,
 14792           DFHEIV99
 14793     MOVE EIBRESP  TO WS-RESPONSE
 14794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14795        IF WS-RESP-NORMAL
 14796           IF (ERPDEF-KEY-SAVE (1:16) =
 14797              PD-CONTROL-PRIMARY (1:16))
 14798              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14799              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14800                 (A1 > +8)
 14801                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14802              END-PERFORM
 14803              IF A1 < +9
 14804                 SET ERPDEF-FOUND TO TRUE
 14805                 MOVE PD-CRIT-PERIOD (A1)
 14806                              TO WS-CRITICAL-PERIOD
 14807                 MOVE PD-REC-CRIT-PERIOD (A1)
 14808                              TO WS-CRIT-PER-RECURRENT
 14809                 IF PD-RTW-MOS (A1) NUMERIC
 14810                    MOVE PD-RTW-MOS (A1)
 14811                              TO WS-CRIT-PER-RTW-MOS
 14812                 ELSE
 14813                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14814                 END-IF
 14815                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14816                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14817                                 TO WS-EXCL-PERIOD
 14818                 END-IF
 14819                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14820                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14821                                 TO WS-COV-ENDS
 14822                 END-IF
 14823                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14824                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14825                                 TO WS-ACC-PERIOD
 14826                 END-IF
 14827                 if pd-max-extension (a1) numeric
 14828                    move pd-max-extension (a1)
 14829                                 to ws-max-extension
 14830                 end-if
 14831                 if pd-max-amt (a1) numeric
 14832                    move pd-max-amt (a1)
 14833                                 to ws-max-moben
 14834                 end-if
 14835              END-IF
 14836           END-IF
 14837        END-IF
 14838     END-IF
 14839
 14840     .
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 276
* EL131.cbl
 14841 3997-EXIT.
 14842     EXIT.
 14843 4000-FORCE-ERRORS.
 14844     IF PI-RETURN-CD-1 = 'X'
 14845         MOVE ER-0311            TO EMI-ERROR
 14846         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14847         MOVE -1                 TO MAINTL
 14848         GO TO 8110-SEND-DATA.
 14849
 14850     IF NOT FORCE-CAP
 14851         MOVE ER-0416            TO EMI-ERROR
 14852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14853         MOVE -1                 TO MAINTL
 14854         GO TO 8110-SEND-DATA.
 14855
 14856     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14857     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14858     IF EMI-FATAL-CTR GREATER THAN ZERO
 14859         GO TO 4000-FATAL-ERRORS.
 14860
 14861     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14862
 14863     IF EMI-FATAL-CTR GREATER THAN ZERO
 14864         GO TO 4000-FATAL-ERRORS.
 14865
 14866     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14867
 14868     IF EMI-FATAL-CTR GREATER THAN ZERO
 14869         GO TO 4000-FATAL-ERRORS.
 14870
 14871     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14872     MOVE AL-UANOF               TO CERTA.
 14873     MOVE ER-0000 TO EMI-ERROR.
 14874     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14875
 14876 4000-FATAL-ERRORS.
 14877     MOVE -1                     TO MAINTL.
 14878     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 277
* EL131.cbl
 14880
 14881 4100-SAVE-CHANGES.
 14882     IF MAINTL > 0
 14883         MOVE MAINTI  TO WS-SAVE-MAINTI
 14884         MOVE MAINTL  TO WS-SAVE-MAINTL
 14885     END-IF
 14886     IF STATUSL > 0
 14887         MOVE STATUSI  TO WS-SAVE-STATUSI
 14888         MOVE STATUSL  TO WS-SAVE-STATUSL
 14889     END-IF
 14890     IF REPL > 0
 14891         MOVE REPI  TO WS-SAVE-REPI
 14892         MOVE REPL  TO WS-SAVE-REPL
 14893     END-IF
 14894*    IF CAUSEL > 0
 14895*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14896*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14897*    END-IF
 14898*    IF ENDL > 0
 14899*        MOVE ENDI  TO WS-SAVE-ENDI
 14900*        MOVE ENDL  TO WS-SAVE-ENDL
 14901*    END-IF
 14902     IF DIAGL > 0
 14903         MOVE DIAGI  TO WS-SAVE-DIAGI
 14904         MOVE DIAGL  TO WS-SAVE-DIAGL
 14905     END-IF
 14906     IF ICD1L > 0
 14907         MOVE ICD1I  TO WS-SAVE-ICD1I
 14908         MOVE ICD1L  TO WS-SAVE-ICD1L
 14909     END-IF
 14910     IF ICD2L > 0
 14911         MOVE ICD2I  TO WS-SAVE-ICD2I
 14912         MOVE ICD2L  TO WS-SAVE-ICD2L
 14913     END-IF
 14914     IF BENEL > 0
 14915         MOVE BENEI  TO WS-SAVE-BENEI
 14916         MOVE BENEL  TO WS-SAVE-BENEL
 14917     END-IF
 14918     IF BIRTHL > 0
 14919         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14920         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14921     END-IF
 14922     IF SOCIALL > 0
 14923         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14924         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14925     END-IF
 14926     IF SEXL > 0
 14927         MOVE SEXI  TO WS-SAVE-SEXI
 14928         MOVE SEXL  TO WS-SAVE-SEXL
 14929     END-IF
 14930     IF MLNAMEL > 0
 14931         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14932         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14933     END-IF
 14934     IF MFNAMEL > 0
 14935         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14936         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14937     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 278
* EL131.cbl
 14938     IF MMINITL > 0
 14939         MOVE MMINITI  TO WS-SAVE-MMINITI
 14940         MOVE MMINITL  TO WS-SAVE-MMINITL
 14941     END-IF
 14942*    IF LOANNOL > 0
 14943*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14944*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14945*    END-IF
 14946     IF LOANBALL > 0
 14947         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14948         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14949     END-IF
 14950     IF PROCL > 0
 14951         MOVE PROCI  TO WS-SAVE-PROCI
 14952         MOVE PROCL  TO WS-SAVE-PROCL
 14953     END-IF
 14954     IF SUPVL > 0
 14955         MOVE SUPVI  TO WS-SAVE-SUPVI
 14956         MOVE SUPVL  TO WS-SAVE-SUPVL
 14957     END-IF
 14958     IF PRICDL > 0
 14959         MOVE PRICDI  TO WS-SAVE-PRICDI
 14960         MOVE PRICDL  TO WS-SAVE-PRICDL
 14961     END-IF
 14962     IF FILETOL > 0
 14963         MOVE FILETOI  TO WS-SAVE-FILETOI
 14964         MOVE FILETOL  TO WS-SAVE-FILETOL
 14965     END-IF
 14966     IF PDTHRUL > 0
 14967         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14968         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14969     END-IF
 14970     IF PDAMTL > 0
 14971         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14972         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14973     END-IF
 14974     IF NODAYSL > 0
 14975         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14976         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14977     END-IF
 14978     IF NOPMTSL > 0
 14979         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14980         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14981     END-IF
 14982     IF FORMTYPL > 0
 14983         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14984         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14985     END-IF
 14986     IF OCCL > 0
 14987         MOVE OCCI  TO WS-SAVE-OCCI
 14988         MOVE OCCL  TO WS-SAVE-OCCL
 14989     END-IF.
 14990 4100-EXIT.
 14991      EXIT.
 14992
 14993 4200-LOAD-CHANGES.
 14994     IF WS-SAVE-MAINTL > 0
 14995         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 279
* EL131.cbl
 14996         MOVE WS-SAVE-MAINTL  TO MAINTL
 14997         MOVE AL-UANON        TO MAINTA
 14998     END-IF
 14999     IF WS-SAVE-STATUSL > 0
 15000         MOVE WS-SAVE-STATUSI  TO STATUSI
 15001         MOVE WS-SAVE-STATUSL  TO STATUSL
 15002         MOVE AL-UANON         TO STATUSA
 15003     END-IF
 15004     IF WS-SAVE-REPL > 0
 15005         MOVE WS-SAVE-REPI  TO REPI
 15006         MOVE WS-SAVE-REPL  TO REPL
 15007         MOVE AL-UANON      TO REPA
 15008     END-IF
 15009*    IF WS-SAVE-CAUSEL > 0
 15010*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 15011*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 15012*        MOVE AL-UANON        TO CAUSEA
 15013*    END-IF
 15014*    IF WS-SAVE-ENDL > 0
 15015*        MOVE WS-SAVE-ENDI  TO ENDI
 15016*        MOVE WS-SAVE-ENDL  TO ENDL
 15017*        MOVE AL-UANON      TO ENDA
 15018*    END-IF
 15019     IF WS-SAVE-DIAGL > 0
 15020         MOVE WS-SAVE-DIAGI  TO DIAGI
 15021         MOVE WS-SAVE-DIAGL  TO DIAGL
 15022         MOVE AL-UANON       TO DIAGA
 15023     END-IF
 15024     IF WS-SAVE-ICD1L > 0
 15025         MOVE WS-SAVE-ICD1I  TO ICD1I
 15026         MOVE WS-SAVE-ICD1L  TO ICD1L
 15027         MOVE AL-UANON       TO ICD1A
 15028     END-IF
 15029     IF WS-SAVE-ICD2L > 0
 15030         MOVE WS-SAVE-ICD2I  TO ICD2I
 15031         MOVE WS-SAVE-ICD2L  TO ICD2L
 15032         MOVE AL-UANON       TO ICD2A
 15033     END-IF
 15034     IF WS-SAVE-BENEL > 0
 15035         MOVE WS-SAVE-BENEI  TO BENEI
 15036         MOVE WS-SAVE-BENEL  TO BENEL
 15037         MOVE AL-UANON       TO BENEA
 15038     END-IF
 15039     IF WS-SAVE-BIRTHL > 0
 15040         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 15041         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 15042         MOVE AL-UANON        TO BIRTHA
 15043     END-IF
 15044     IF WS-SAVE-SOCIALL > 0
 15045         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 15046         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 15047         MOVE AL-UANON         TO SOCIALA
 15048     END-IF
 15049     IF WS-SAVE-SEXL > 0
 15050         MOVE WS-SAVE-SEXI  TO SEXI
 15051         MOVE WS-SAVE-SEXL  TO SEXL
 15052         MOVE AL-UANON      TO SEXA
 15053     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 280
* EL131.cbl
 15054     IF WS-SAVE-MLNAMEL > 0
 15055         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 15056         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 15057         MOVE AL-UANON         TO MLNAMEA
 15058     END-IF
 15059     IF WS-SAVE-MFNAMEL > 0
 15060         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 15061         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 15062         MOVE AL-UANON         TO MFNAMEA
 15063     END-IF
 15064     IF WS-SAVE-MMINITL > 0
 15065         MOVE WS-SAVE-MMINITI  TO MMINITI
 15066         MOVE WS-SAVE-MMINITL  TO MMINITL
 15067         MOVE AL-UANON         TO MMINITA
 15068     END-IF
 15069*    IF WS-SAVE-LOANNOL > 0
 15070*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 15071*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 15072*        MOVE AL-UANON         TO LOANNOA
 15073*    END-IF
 15074     IF WS-SAVE-LOANBALL > 0
 15075         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 15076         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 15077         MOVE AL-UANON          TO LOANBALA
 15078     END-IF
 15079     IF WS-SAVE-PROCL > 0
 15080         MOVE WS-SAVE-PROCI  TO PROCI
 15081         MOVE WS-SAVE-PROCL  TO PROCL
 15082         MOVE AL-UANON       TO PROCA
 15083     END-IF
 15084     IF WS-SAVE-SUPVL > 0
 15085         MOVE WS-SAVE-SUPVI  TO SUPVI
 15086         MOVE WS-SAVE-SUPVL  TO SUPVL
 15087         MOVE AL-UANON       TO SUPVA
 15088     END-IF
 15089     IF WS-SAVE-PRICDL > 0
 15090         MOVE WS-SAVE-PRICDI  TO PRICDI
 15091         MOVE WS-SAVE-PRICDL  TO PRICDL
 15092         MOVE AL-UANON        TO PRICDA
 15093     END-IF
 15094     IF WS-SAVE-FILETOL > 0
 15095         MOVE WS-SAVE-FILETOI  TO FILETOI
 15096         MOVE WS-SAVE-FILETOL  TO FILETOL
 15097         MOVE AL-UANON         TO FILETOA
 15098     END-IF
 15099     IF WS-SAVE-PDTHRUL > 0
 15100         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 15101         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 15102         MOVE AL-UANON         TO PDTHRUA
 15103     END-IF
 15104     IF WS-SAVE-PDAMTL > 0
 15105         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 15106         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 15107         MOVE AL-UANON        TO PDAMTA
 15108     END-IF
 15109     IF WS-SAVE-NODAYSL > 0
 15110         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 15111         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 281
* EL131.cbl
 15112         MOVE AL-UANON         TO NODAYSA
 15113     END-IF
 15114     IF WS-SAVE-NOPMTSL > 0
 15115         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 15116         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 15117         MOVE AL-UANON         TO NOPMTSA
 15118     END-IF
 15119     IF WS-SAVE-FORMTYPL > 0
 15120         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 15121         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 15122         MOVE AL-UANON          TO FORMTYPA
 15123     END-IF
 15124     IF WS-SAVE-OCCL > 0
 15125         MOVE WS-SAVE-OCCI  TO OCCI
 15126         MOVE WS-SAVE-OCCL  TO OCCL
 15127         MOVE AL-UANON      TO OCCA
 15128     END-IF.
 15129 4200-EXIT.
 15130      EXIT.
 15131
 15132 5000-BUILD-MAP.
 15133     IF PI-RETURN-CD-1 = SPACE
 15134         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 15135
 15136     MOVE SPACE                  TO PI-RETURN-CD-1.
 15137
 15138     MOVE LOW-VALUES             TO EL131AI.
 15139
 15140     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 15141     MOVE PI-CARRIER             TO CARRIER-CODE.
 15142     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 15143     MOVE PI-CERT-NO             TO CERT-NO.
 15144
 15145 5000-READ-CLAIM-MASTER.
 15146
 15147
 15148* EXEC CICS READ
 15149*         SET      (ADDRESS OF CLAIM-MASTER)
 15150*         DATASET  (CLMS-FILE-ID)
 15151*         RIDFLD   (MSTR-KEY)
 15152*    END-EXEC.
 15153*    MOVE '&"S        E          (   #00012730' TO DFHEIV0
 15154     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15156     MOVE X'2020233030303132373330' TO DFHEIV0(25:11)
 15157     CALL 'kxdfhei1' USING DFHEIV0,
 15158           CLMS-FILE-ID,
 15159           DFHEIV20,
 15160           DFHEIV99,
 15161           MSTR-KEY,
 15162           DFHEIV99,
 15163           DFHEIV99,
 15164           DFHEIV99
 15165     SET ADDRESS OF CLAIM-MASTER TO
 15166         DFHEIV20
 15167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15168
 15169
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 282
* EL131.cbl
 15170     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 15171
 15172 5000-READ-DIAGNOSIS-TRAILER.
 15173
 15174
 15175* EXEC CICS HANDLE CONDITION
 15176*         NOTFND (5000-TRLR-NOT-FOUND)
 15177*    END-EXEC.
 15178*    MOVE '"$I                   ! B #00012740' TO DFHEIV0
 15179     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15181     MOVE X'4220233030303132373430' TO DFHEIV0(25:11)
 15182     CALL 'kxdfhei1' USING DFHEIV0
 15183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15184
 15185
 15186     MOVE MSTR-KEY               TO TRLR-KEY.
 15187     MOVE NINETY                 TO TRLR-SEQ-NO.
 15188
 15189
 15190* EXEC CICS READ
 15191*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15192*         DATASET  (TRLR-FILE-ID)
 15193*         RIDFLD   (TRLR-KEY)
 15194*    END-EXEC.
 15195*    MOVE '&"S        E          (   #00012747' TO DFHEIV0
 15196     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15198     MOVE X'2020233030303132373437' TO DFHEIV0(25:11)
 15199     CALL 'kxdfhei1' USING DFHEIV0,
 15200           TRLR-FILE-ID,
 15201           DFHEIV20,
 15202           DFHEIV99,
 15203           TRLR-KEY,
 15204           DFHEIV99,
 15205           DFHEIV99,
 15206           DFHEIV99
 15207     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15208         DFHEIV20
 15209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15210
 15211
 15212     MOVE AT-INFO-LINE-1         TO DIAGO.
 15213     MOVE AT-ICD-CODE-1          TO ICD1O.
 15214     MOVE AT-ICD-CODE-2          TO ICD2O.
 15215
 15216 5000-READ-CERTIFICATE-MASTER.
 15217
 15218     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 15219     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 15220     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 15221     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 15222     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 15223     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 15224     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 15225
 15226
 15227* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 283
* EL131.cbl
 15228*         NOTFND (5000-CERT-NOT-FOUND)
 15229*    END-EXEC.
 15230*    MOVE '"$I                   ! C #00012767' TO DFHEIV0
 15231     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15233     MOVE X'4320233030303132373637' TO DFHEIV0(25:11)
 15234     CALL 'kxdfhei1' USING DFHEIV0
 15235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15236
 15237
 15238
 15239* EXEC CICS READ
 15240*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15241*         DATASET  (CERT-FILE-ID)
 15242*         RIDFLD   (CERT-KEY)
 15243*    END-EXEC.
 15244*    MOVE '&"S        E          (   #00012771' TO DFHEIV0
 15245     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15247     MOVE X'2020233030303132373731' TO DFHEIV0(25:11)
 15248     CALL 'kxdfhei1' USING DFHEIV0,
 15249           CERT-FILE-ID,
 15250           DFHEIV20,
 15251           DFHEIV99,
 15252           CERT-KEY,
 15253           DFHEIV99,
 15254           DFHEIV99,
 15255           DFHEIV99
 15256     SET ADDRESS OF CERTIFICATE-MASTER TO
 15257         DFHEIV20
 15258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15259
 15260
 15261     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 15262     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 15263     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 15264
 15265     GO TO 5000-EXIT.
 15266
 15267 5000-TRLR-NOT-FOUND.
 15268     MOVE ER-7687                TO EMI-ERROR.
 15269     MOVE -1                     TO DIAGL.
 15270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15271     GO TO 5000-EXIT.
 15272
 15273 5000-CERT-NOT-FOUND.
 15274     MOVE ER-0206                TO EMI-ERROR.
 15275     MOVE -1                     TO CERTL.
 15276     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15277
 15278 5000-EXIT.
 15279     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 284
* EL131.cbl
 15281 5010-RESET-PI-AREA.
 15282     IF CERTI GREATER THAN LOW-VALUES
 15283         MOVE CERTI              TO PI-CERT-PRIME.
 15284
 15285     IF SUFXI GREATER THAN LOW-VALUES
 15286         MOVE SUFXI              TO PI-CERT-SFX.
 15287
 15288     IF CERTEFFI GREATER THAN LOW-VALUES
 15289         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 15290
 15291     IF CERTACTI GREATER THAN LOW-VALUES
 15292         MOVE CERTACTI           TO PI-ACCOUNT.
 15293
 15294     IF CERTSTI GREATER THAN LOW-VALUES
 15295         MOVE CERTSTI            TO PI-STATE.
 15296
 15297     IF CERTCARI GREATER THAN LOW-VALUES
 15298         MOVE CERTCARI           TO PI-CARRIER.
 15299
 15300     IF CERTGRPI GREATER THAN LOW-VALUES
 15301         MOVE CERTGRPI           TO PI-GROUPING.
 15302
 15303 5010-EXIT.
 15304     EXIT.
 15305
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 285
* EL131.cbl
 15307 5020-MOVE-MSTR.
 15308
 15309     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 15310     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 15311     MOVE WS-CLAIM-SEQU          TO SEQUO.
 15312     MOVE AL-SABON               TO SEQUA.
 15313     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 15314     MOVE CL-CLAIM-TYPE          TO TYPEO
 15315                                    pi-claim-type
 15316
 15317     IF CL-TOTAL-PAID-AMT  = +0 AND
 15318        CL-LAST-PMT-AMT    = +0 AND
 15319        CL-NO-OF-PMTS-MADE = +0
 15320          MOVE AL-UANON          TO TYPEA.
 15321
 15322     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 15323     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 15324     MOVE CL-CERT-PRIME          TO CERTO.
 15325     MOVE CL-CERT-SFX            TO SUFXO.
 15326     MOVE CL-CERT-CARRIER        TO CARRO.
 15327
 15328     IF CL-CLAIM-STATUS = 'C'
 15329         MOVE 'CLOSED'           TO STATUSO
 15330     ELSE
 15331         MOVE 'OPEN  '           TO STATUSO.
 15332
 15333     move cl-accident-claim-sw   to accswo
 15334     if cl-benefit-period not numeric
 15335        move zeros               to cl-benefit-period
 15336     end-if
 15337     move cl-benefit-period      to benpero
 15338     move cl-insured-type        to instypeo
 15339     MOVE CL-PROCESSOR-ID        TO PROCO.
 15340
 15341     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 15342     MOVE CL-CCN                 TO CCNOO.
 15343
 15344     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 15345     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 15346     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 15347     MOVE CL-INSURED-SEX-CD      TO SEXO.
 15348
 15349     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 15350         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 15351         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15352         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15353         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 15354     ELSE
 15355         MOVE SPACES             TO BIRTHO.
 15356
 15357     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 15358        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 15359         NEXT SENTENCE
 15360       ELSE
 15361         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 15362
 15363     IF PI-COMPANY-ID = 'DMD'
 15364       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 286
* EL131.cbl
 15365          IF SOCIALO = SPACES OR LOW-VALUES
 15366            MOVE ER-0885         TO EMI-ERROR
 15367            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15368
 15369     MOVE CL-INSURED-OCC-CD      TO OCCO.
 15370*    MOVE CL-CAUSE-CD            TO CAUSEO.
 15371
 15372*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 15373*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 15374*        MOVE SPACES                 TO DC-OPTION-CODE
 15375*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15376*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 15377*    ELSE
 15378*        MOVE SPACES             TO ENDO.
 15379
 15380     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 15381        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15382        MOVE SPACES             TO DC-OPTION-CODE
 15383        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15384        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15385        IF PI-USES-PAID-TO
 15386           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15387           MOVE '6'                TO DC-OPTION-CODE
 15388           MOVE +1                 TO DC-ELAPSED-DAYS
 15389           MOVE +0                 TO DC-ELAPSED-MONTHS
 15390           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15391           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15392        ELSE
 15393           NEXT SENTENCE
 15394     ELSE
 15395        MOVE SPACES             TO PDTHRUO.
 15396
 15397     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 15398     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 15399     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 15400     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 15401
 15402     IF MODIFY-CAP
 15403        MOVE AL-UNNOF            TO PDAMTA
 15404                                    NODAYSA
 15405                                    NOPMTSA
 15406        MOVE AL-UANOF            TO PDTHRUA.
 15407     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 15408     MOVE '2'                    TO CNTL-REC-TYPE
 15409     MOVE +0                     TO CNTL-SEQ-NO
 15410     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 15411
 15412
 15413* EXEC CICS READ
 15414*         DATASET  (CNTL-FILE-ID)
 15415*         SET      (ADDRESS OF CONTROL-FILE)
 15416*         RIDFLD   (CNTL-KEY)
 15417*         RESP     (WS-RESPONSE)
 15418*    END-EXEC
 15419*    MOVE '&"S        E          (  N#00012928' TO DFHEIV0
 15420     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15421     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15422     MOVE X'204E233030303132393238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 287
* EL131.cbl
 15423     CALL 'kxdfhei1' USING DFHEIV0,
 15424           CNTL-FILE-ID,
 15425           DFHEIV20,
 15426           DFHEIV99,
 15427           CNTL-KEY,
 15428           DFHEIV99,
 15429           DFHEIV99,
 15430           DFHEIV99
 15431     SET ADDRESS OF CONTROL-FILE TO
 15432         DFHEIV20
 15433     MOVE EIBRESP  TO WS-RESPONSE
 15434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15435
 15436     IF WS-RESP-NORMAL
 15437        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 15438     end-if
 15439     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 15440         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15441         MOVE SPACES             TO DC-OPTION-CODE
 15442         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15443         MOVE DC-GREG-DATE-1-EDIT TO INCO
 15444     ELSE
 15445         MOVE SPACES             TO INCO.
 15446
 15447     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 15448        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 15449        MOVE AL-UANOF            TO INCA
 15450     end-if
 15451     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 15452
 15453     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 15454         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 15455         MOVE SPACES             TO DC-OPTION-CODE
 15456         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15457         MOVE DC-GREG-DATE-1-EDIT TO REPO
 15458     ELSE
 15459         MOVE SPACES             TO REPO.
 15460
 15461     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 15462         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 15463         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15464         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15465         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 15466     ELSE
 15467         MOVE SPACES             TO ESTO.
 15468
 15469     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 15470         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 15471         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15472         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15473         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 15474     ELSE
 15475         MOVE SPACES             TO MNTDTO.
 15476
 15477
 15478     IF CL-LAST-MAINT-TYPE = SPACE
 15479         MOVE 'SET-UP'           TO MNTTYPEO
 15480     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 288
* EL131.cbl
 15481     IF CL-LAST-MAINT-TYPE = '1'
 15482         MOVE 'PAYMNT'           TO MNTTYPEO
 15483     ELSE
 15484     IF CL-LAST-MAINT-TYPE = '2'
 15485         MOVE 'LETTER'           TO MNTTYPEO
 15486     ELSE
 15487     IF CL-LAST-MAINT-TYPE = '3'
 15488         MOVE 'UPDATE'           TO MNTTYPEO
 15489     ELSE
 15490     IF CL-LAST-MAINT-TYPE = '4'
 15491         MOVE 'RESTOR'           TO MNTTYPEO
 15492     ELSE
 15493     IF CL-LAST-MAINT-TYPE = '5'
 15494         MOVE 'INC DT'           TO MNTTYPEO
 15495     ELSE
 15496     IF CL-LAST-MAINT-TYPE = '6'
 15497         MOVE ' CONV'            TO MNTTYPEO
 15498     ELSE
 15499     IF CL-LAST-MAINT-TYPE = 'C'
 15500         MOVE 'CHGBEN'           TO MNTTYPEO
 15501     ELSE
 15502     IF CL-LAST-MAINT-TYPE = 'E'
 15503         MOVE 'ERRCOR'           TO MNTTYPEO
 15504     ELSE
 15505         MOVE SPACES             TO MNTTYPEO.
 15506
 15507     MOVE CL-BENEFICIARY         TO BENEO.
 15508     MOVE CL-FILE-LOCATION       TO FILETOO.
 15509     IF CL-CRITICAL-PERIOD NOT NUMERIC
 15510        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 15511     END-IF
 15512     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 15513     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 15514        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 15515     END-IF
 15516     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 15517*    MOVE CL-CRIT-PER-RECURRENT
 15518*                                TO CRITPTO
 15519*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 15520*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 15521*    END-IF
 15522*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 15523     MOVE CL-PRIORITY-CD         TO PRICDO.
 15524     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 15525     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15526     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15527     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 15528
 15529 5020-EXIT.
 15530     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 289
* EL131.cbl
 15532 5030-MOVE-CERT.
 15533
 15534     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15535         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15536         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15537         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15538         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15539       ELSE
 15540         MOVE SPACES             TO CERTEFFO
 15541         MOVE ZERO               TO HOLD-DATE.
 15542
 15543     MOVE CM-ACCOUNT             TO CERTACTO.
 15544     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15545     MOVE CM-GROUPING            TO CERTGRPO.
 15546     MOVE CM-CARRIER             TO CERTCARO.
 15547     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15548     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15549     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15550     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15551     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15552     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15553     MOVE CM-JT-INITIAL          TO JNTINITO.
 15554     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15555
 15556*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15557     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15558     MOVE '3'                    TO CNTL-REC-TYPE.
 15559     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15560     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15561     MOVE ZERO                   TO CNTL-SEQ-NO.
 15562
 15563
 15564* EXEC CICS READ
 15565*         SET        (ADDRESS OF CONTROL-FILE)
 15566*         DATASET    ('ELCNTL')
 15567*         RIDFLD     (CNTL-KEY)
 15568*         RESP       (WS-RESPONSE)
 15569*    END-EXEC.
 15570     MOVE 'ELCNTL' TO DFHEIV1
 15571*    MOVE '&"S        E          (  N#00013062' TO DFHEIV0
 15572     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15574     MOVE X'204E233030303133303632' TO DFHEIV0(25:11)
 15575     CALL 'kxdfhei1' USING DFHEIV0,
 15576           DFHEIV1,
 15577           DFHEIV20,
 15578           DFHEIV99,
 15579           CNTL-KEY,
 15580           DFHEIV99,
 15581           DFHEIV99,
 15582           DFHEIV99
 15583     SET ADDRESS OF CONTROL-FILE TO
 15584         DFHEIV20
 15585     MOVE EIBRESP  TO WS-RESPONSE
 15586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15587
 15588
 15589     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 290
* EL131.cbl
 15590        MOVE ZERO                TO CP-FREE-LOOK
 15591     ELSE
 15592        MOVE CF-ST-FREE-LOOK-PERIOD
 15593                                 TO CP-FREE-LOOK.
 15594
 15595     IF CM-LF-BENEFIT-CD = '00'
 15596        GO TO 5030-MOVE-CERT-AH.
 15597
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 291
* EL131.cbl
 15599     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15600     MOVE '5'                    TO DC-OPTION-CODE
 15601     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15602     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15603     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15604     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15605     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15606     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15607     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15608     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15609     MOVE '4'                    TO CP-REM-TERM-METHOD
 15610     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15611     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15612     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15613
 15614     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15615     IF CM-LF-PREMIUM-RATE NUMERIC
 15616         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15617     ELSE
 15618         MOVE ZEROS              TO LCVRATEO.
 15619
 15620     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15621         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15622
 15623     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15624
 15625     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15626
 15627     IF CM-LF-CURRENT-STATUS = '8'
 15628        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15629            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15630            MOVE ' '             TO DC-OPTION-CODE
 15631            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15632            IF NOT DATE-CONVERSION-ERROR
 15633                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15634
 15635     IF CM-LF-CURRENT-STATUS = '7'
 15636        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15637            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15638            MOVE ' '             TO DC-OPTION-CODE
 15639            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15640            IF NOT DATE-CONVERSION-ERROR
 15641                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15642
 15643     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15644         MOVE ' '                TO DC-OPTION-CODE
 15645         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15646         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15647         IF NOT DATE-CONVERSION-ERROR
 15648             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15649             MOVE HOLD-MONTH     TO WORK-MONTH
 15650             MOVE HOLD-YEAR      TO WORK-YEAR
 15651             MOVE WORK-DATE-MY   TO LCVEXITO.
 15652
 15653     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15654        IF CP-REMAINING-TERM-3 = ZEROS
 15655           MOVE 'EXPIRED'        TO LCVSTATO
 15656        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 292
* EL131.cbl
 15657           MOVE 'ACTIVE'         TO LCVSTATO.
 15658
 15659     IF CM-LF-CURRENT-STATUS = '2'
 15660        MOVE 'PEND   '           TO LCVSTATO.
 15661     IF CM-LF-CURRENT-STATUS = '3'
 15662        MOVE 'RESTORE'           TO LCVSTATO.
 15663     IF CM-LF-CURRENT-STATUS = '5'
 15664        MOVE 'REISSUE'           TO LCVSTATO.
 15665     IF CM-LF-CURRENT-STATUS = '6'
 15666        MOVE 'LMPBEN'            TO LCVSTATO.
 15667     IF CM-LF-CURRENT-STATUS = '7'
 15668        MOVE 'DEATH  '           TO LCVSTATO.
 15669     IF CM-LF-CURRENT-STATUS = '8'
 15670        MOVE 'CANCEL '           TO LCVSTATO.
 15671     IF CM-LF-CURRENT-STATUS = '9'
 15672        MOVE 'RE-ONLY'           TO LCVSTATO.
 15673     IF CM-LF-CURRENT-STATUS = 'V'
 15674        MOVE 'VOID   '           TO LCVSTATO.
 15675     IF CM-LF-CURRENT-STATUS = 'D'
 15676        MOVE 'DECLINE'           TO LCVSTATO.
 15677
 15678     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15679     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15680     MOVE '4'                    TO BEN-REC-TYPE.
 15681     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15682     MOVE ZERO                   TO BEN-SEQ-NO.
 15683
 15684
 15685* EXEC CICS READ GTEQ
 15686*         DATASET  (CNTL-FILE-ID)
 15687*         RIDFLD   (BENEFIT-KEY)
 15688*         SET      (ADDRESS OF CONTROL-FILE)
 15689*    END-EXEC.
 15690*    MOVE '&"S        G          (   #00013164' TO DFHEIV0
 15691     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15693     MOVE X'2020233030303133313634' TO DFHEIV0(25:11)
 15694     CALL 'kxdfhei1' USING DFHEIV0,
 15695           CNTL-FILE-ID,
 15696           DFHEIV20,
 15697           DFHEIV99,
 15698           BENEFIT-KEY,
 15699           DFHEIV99,
 15700           DFHEIV99,
 15701           DFHEIV99
 15702     SET ADDRESS OF CONTROL-FILE TO
 15703         DFHEIV20
 15704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15705
 15706
 15707     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15708        CF-RECORD-TYPE NOT = '4'
 15709         MOVE ER-0240            TO EMI-ERROR
 15710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15711         GO TO 5030-MOVE-CERT-FINISH.
 15712
 15713     MOVE ZERO                   TO COUNT-2.
 15714     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 293
* EL131.cbl
 15715
 15716     IF SCREEN-ERROR
 15717         MOVE ER-0282            TO EMI-ERROR
 15718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15719        ELSE
 15720         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15721
 15722 5030-MOVE-CERT-AH.
 15723
 15724     IF CM-LF-BENEFIT-CD = '00'
 15725         IF CM-AH-BENEFIT-CD = '00'
 15726             GO TO 5030-MOVE-CERT-FINISH.
 15727
 15728     IF CM-AH-BENEFIT-CD = '00'
 15729        MOVE SPACES             TO ACVKINDO
 15730        COMPUTE PI-PAYMENT-AMT =
 15731                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15732        GO TO 5030-MOVE-CERT-FINISH.
 15733
 15734     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15735     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15736     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15737     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15738     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15739     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15740     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15741     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15742
 15743**DMD **********************************************
 15744     IF PI-COMPANY-ID = 'DMD'
 15745         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15746                                   CM-PMT-EXTENSION-DAYS
 15747         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15748                                      CL-NO-OF-DAYS-PAID
 15749         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15750             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15751         MOVE WS-REM-MOS         TO ACVRTRMO
 15752                                    CP-REMAINING-TERM-3
 15753*        MOVE WS-REM-DAYS        TO DAYSPO
 15754         GO TO 5030-SKIP-RTRM.
 15755**DMD **********************************************
 15756
 15757     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15758     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15759     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15760     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15761
 15762 5030-SKIP-RTRM.
 15763     IF CM-AH-PREMIUM-RATE NUMERIC
 15764         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15765     ELSE
 15766         MOVE ZEROS              TO ACVRATEO.
 15767
 15768     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15769     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15770
 15771     IF CM-AH-CURRENT-STATUS = '8'
 15772        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 294
* EL131.cbl
 15773            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15774            MOVE ' '             TO DC-OPTION-CODE
 15775            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15776            IF NOT DATE-CONVERSION-ERROR
 15777                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15778
 15779     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15780        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15781            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15782            MOVE ' '             TO DC-OPTION-CODE
 15783            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15784            IF NOT DATE-CONVERSION-ERROR
 15785                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15786
 15787     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15788        IF CP-REMAINING-TERM-3 = ZEROS
 15789           MOVE 'EXPIRED'        TO ACVSTATO
 15790        ELSE
 15791           MOVE 'ACTIVE'         TO ACVSTATO.
 15792
 15793     IF CM-AH-CURRENT-STATUS = '2'
 15794        MOVE 'PEND   '           TO ACVSTATO.
 15795     IF CM-AH-CURRENT-STATUS = '3'
 15796        MOVE 'RESTORE'           TO ACVSTATO.
 15797     IF CM-AH-CURRENT-STATUS = '5'
 15798        MOVE 'REISSUE'           TO ACVSTATO.
 15799     IF CM-AH-CURRENT-STATUS = '6'
 15800        MOVE 'LMP DIS'           TO ACVSTATO.
 15801     IF CM-AH-CURRENT-STATUS = '7'
 15802        MOVE 'DEATH  '           TO ACVSTATO.
 15803     IF CM-AH-CURRENT-STATUS = '8'
 15804        MOVE 'CANCEL '           TO ACVSTATO.
 15805     IF CM-AH-CURRENT-STATUS = '9'
 15806        MOVE 'RE-ONLY'           TO ACVSTATO.
 15807     IF CM-AH-CURRENT-STATUS = 'V'
 15808        MOVE 'VOID   '           TO ACVSTATO.
 15809     IF CM-AH-CURRENT-STATUS = '9'
 15810        MOVE 'DECLINE'           TO ACVSTATO.
 15811
 15812     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15813         MOVE ' '                TO DC-OPTION-CODE
 15814         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15815         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15816         IF NOT DATE-CONVERSION-ERROR
 15817             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15818             MOVE HOLD-MONTH     TO WORK-MONTH
 15819             MOVE HOLD-YEAR      TO WORK-YEAR
 15820             MOVE WORK-DATE-MY   TO ACVEXITO.
 15821
 15822     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15823
 15824     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15825     MOVE '5'                    TO BEN-REC-TYPE.
 15826     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15827     MOVE ZERO                   TO BEN-SEQ-NO.
 15828
 15829
 15830* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 295
* EL131.cbl
 15831*         DATASET  (CNTL-FILE-ID)
 15832*         RIDFLD   (BENEFIT-KEY)
 15833*         SET      (ADDRESS OF CONTROL-FILE)
 15834*    END-EXEC.
 15835*    MOVE '&"S        G          (   #00013292' TO DFHEIV0
 15836     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15837     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15838     MOVE X'2020233030303133323932' TO DFHEIV0(25:11)
 15839     CALL 'kxdfhei1' USING DFHEIV0,
 15840           CNTL-FILE-ID,
 15841           DFHEIV20,
 15842           DFHEIV99,
 15843           BENEFIT-KEY,
 15844           DFHEIV99,
 15845           DFHEIV99,
 15846           DFHEIV99
 15847     SET ADDRESS OF CONTROL-FILE TO
 15848         DFHEIV20
 15849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15850
 15851
 15852     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15853        CF-RECORD-TYPE NOT = '5'
 15854         MOVE ER-0250            TO EMI-ERROR
 15855         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15856         GO TO 5030-MOVE-CERT-FINISH.
 15857
 15858     MOVE ZERO                   TO COUNT-2.
 15859     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15860
 15861     IF SCREEN-ERROR
 15862         MOVE ER-0283            TO EMI-ERROR
 15863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15864       ELSE
 15865         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15866
 15867 5030-MOVE-CERT-FINISH.
 15868
 15869     MOVE CM-LOAN-APR            TO APRO.
 15870     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15871     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15872     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15873*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15874     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15875     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15876
 15877     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15878         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15879         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15880         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15881         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15882     ELSE
 15883         MOVE SPACES               TO ADDONDTO.
 15884
 15885     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15886
 15887 5030-EXIT.
 15888     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 296
* EL131.cbl
 15890 5040-FIND-BENEFIT.
 15891     ADD 1                       TO COUNT-2.
 15892     IF COUNT-2 GREATER THAN 8
 15893         GO TO 5050-BENEFIT-NOTFND.
 15894
 15895     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15896         GO TO 5060-EXIT.
 15897
 15898     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15899         GO TO 5050-BENEFIT-NOTFND.
 15900
 15901     GO TO 5040-FIND-BENEFIT.
 15902
 15903 5050-BENEFIT-NOTFND.
 15904     MOVE 'X'                    TO ERROR-SWITCH.
 15905
 15906 5060-EXIT.
 15907     EXIT.
 15908 5100-LOAD-CORR-TRLR.
 15909     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15910     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15911     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15912     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15913     MOVE 1000               TO TRLR-SEQ-NO.
 15914
 15915
 15916* EXEC CICS HANDLE CONDITION
 15917*         NOTFND    (1052-DONE)
 15918*         ENDFILE   (1052-DONE)
 15919*    END-EXEC.
 15920*    MOVE '"$I''                  ! D #00013361' TO DFHEIV0
 15921     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15923     MOVE X'4420233030303133333631' TO DFHEIV0(25:11)
 15924     CALL 'kxdfhei1' USING DFHEIV0
 15925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15926
 15927
 15928
 15929* EXEC CICS STARTBR
 15930*        DATASET (TRLR-FILE-ID)
 15931*        RIDFLD  (TRLR-KEY)
 15932*    END-EXEC
 15933     MOVE 0
 15934       TO DFHEIV11
 15935*    MOVE '&,         G          &   #00013366' TO DFHEIV0
 15936     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15937     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15938     MOVE X'2020233030303133333636' TO DFHEIV0(25:11)
 15939     CALL 'kxdfhei1' USING DFHEIV0,
 15940           TRLR-FILE-ID,
 15941           TRLR-KEY,
 15942           DFHEIV99,
 15943           DFHEIV11,
 15944           DFHEIV99
 15945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15946
 15947
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 297
* EL131.cbl
 15948     MOVE SPACES TO WS-TRLR-FILE-EOF
 15949                    WS-AUTH-RCVD
 15950     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15951       UNTIL  TRLR-FILE-EOF
 15952         OR WS-AUTH-RCVD > SPACES.
 15953
 15954
 15955* EXEC CICS ENDBR
 15956*        DATASET (TRLR-FILE-ID)
 15957*    END-EXEC.
 15958     MOVE 0
 15959       TO DFHEIV11
 15960*    MOVE '&2                    $   #00013378' TO DFHEIV0
 15961     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15962     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15963     MOVE X'2020233030303133333738' TO DFHEIV0(25:11)
 15964     CALL 'kxdfhei1' USING DFHEIV0,
 15965           TRLR-FILE-ID,
 15966           DFHEIV11,
 15967           DFHEIV99
 15968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15969
 15970
 15971     IF AUTH-RCVD
 15972        MOVE 'Y' TO AUTHRCVO
 15973     ELSE
 15974        MOVE 'N' TO AUTHRCVO
 15975     END-IF.
 15976
 15977
 15978 5100-EXIT.
 15979     EXIT.
 15980
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 298
* EL131.cbl
 15982 6000-CALCULATE-CERT-TERM.
 15983
 15984     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15985         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15986     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15987         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15988     IF CM-LOAN-APR NOT NUMERIC
 15989         MOVE ZEROS              TO CM-LOAN-APR.
 15990
 15991*    IF WS-CALC-METHOD  = 'G'
 15992         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15993*     ELSE
 15994*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15995
 15996     IF N GREATER 120
 15997         MOVE 120                TO N.
 15998
 15999     MOVE '6'                    TO DC-OPTION-CODE.
 16000     MOVE N                      TO DC-ELAPSED-MONTHS.
 16001     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 16002     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 16003
 16004     IF CM-LF-BENEFIT-CD NOT = ZERO
 16005         MOVE N                  TO CM-LF-ORIG-TERM
 16006         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 16007         IF NO-CONVERSION-ERROR
 16008             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 16009
 16010     IF CM-AH-BENEFIT-CD NOT = ZERO
 16011         MOVE N                  TO CM-AH-ORIG-TERM
 16012         IF NO-CONVERSION-ERROR
 16013             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 16014
 16015 6000-EXIT.
 16016      EXIT.
 16017
 16018 6100-CALC-GROSS-TERM.
 16019     MOVE CM-LOAN-BALANCE         TO L.
 16020     MOVE PI-PAYMENT-AMT          TO M.
 16021
 16022     COMPUTE N = L / M.
 16023     IF N LESS 1
 16024         MOVE 1  TO N.
 16025
 16026     IF CM-LF-BENEFIT-CD NOT = ZERO
 16027         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 16028     ELSE
 16029         MOVE ZEROS               TO WS-LF-RATE.
 16030
 16031     IF CM-AH-BENEFIT-CD NOT = ZERO
 16032         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 16033     ELSE
 16034         MOVE ZEROS               TO WS-AH-RATE.
 16035
 16036     COMPUTE I = CM-LOAN-APR / +1200.
 16037
 16038 6105-LOOP.
 16039     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 299
* EL131.cbl
 16040         GO TO 6200-EXIT.
 16041     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 16042     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 16043         ADD 1 TO N
 16044         GO TO 6105-LOOP.
 16045
 16046 6200-EXIT.
 16047      EXIT.
 16048
 16049 6210-CALC-LEFT-RIGHTONE.
 16050      MOVE L         TO LEFT-TOT-1.
 16051      SUBTRACT 1 FROM N.
 16052      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16053      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 16054      ADD 1 TO N.
 16055 6211-CALC-TERM1.
 16056      MOVE N         TO TERM1.
 16057      MULTIPLY M BY TERM1.
 16058 6212-LOOP.
 16059      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 16060      ADD 1 TO A-N.
 16061      MULTIPLY A-N BY TERM1.
 16062      SUBTRACT 1 FROM A-N.
 16063      ADD TERM1 TO LEFT-TOT-1.
 16064 6213-CALC-TERM2.
 16065      MOVE M         TO TERM2.
 16066      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 16067      MULTIPLY IA-N BY TERM2.
 16068      SUBTRACT TERM2 FROM LEFT-TOT-1.
 16069 6215-CALC-RIGHTONE.
 16070      MOVE M         TO RIGHT-TOT-1.
 16071      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16072      MULTIPLY A-N BY RIGHT-TOT-1.
 16073 6220-EXIT.
 16074      EXIT.
 16075
 16076 6300-CALC-A-N.
 16077     IF N LESS 1
 16078         MOVE 0     TO A-N
 16079         GO TO 6300-EXIT.
 16080     IF I = 0
 16081         MOVE .00001 TO I.
 16082     ADD 1 TO I.
 16083     DIVIDE I INTO 1 GIVING V.
 16084     SUBTRACT 1 FROM I.
 16085     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16086     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 16087     DIVIDE I INTO TERM3 GIVING A-N.
 16088 6300-EXIT.
 16089      EXIT.
 16090
 16091 6350-CALC-IA-N.
 16092     IF N LESS 1
 16093         MOVE 0      TO IA-N
 16094         GO TO 6400-EXIT.
 16095     ADD 1 TO N.
 16096     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16097     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 300
* EL131.cbl
 16098     MULTIPLY N BY V-EX-N GIVING TERM3.
 16099     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 16100     SUBTRACT V FROM 1 GIVING TERM4.
 16101     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 16102 6400-EXIT.
 16103      EXIT.
 16104
 16105 6450-CALC-V-EX-N.
 16106     IF N LESS 1
 16107         MOVE 1    TO V-EX-N
 16108         GO TO 6490-EXIT.
 16109     MOVE N        TO NV-STORE.
 16110     IF V-EX-ONETIME = 1  OR
 16111        V NOT = V-EXPONENT (1)
 16112          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 16113 6460-LOOP.
 16114     IF N GREATER 248
 16115         MOVE 248 TO N.
 16116     IF N = 1
 16117         MOVE V               TO V-EX-N
 16118      ELSE
 16119         MOVE V-EXPONENT (N)  TO V-EX-N.
 16120     GO TO 6490-EXIT.
 16121
 16122 6470-BUILD-V-EX-TABLE.
 16123     MOVE 2      TO N.
 16124     MOVE V      TO V-EXPONENT (1)
 16125                    V-EX-N.
 16126 6471-LOOP.
 16127     MULTIPLY V BY V-EX-N.
 16128     MOVE V-EX-N   TO V-EXPONENT (N).
 16129     ADD 1 TO N.
 16130     IF N LESS 248
 16131         GO TO 6471-LOOP.
 16132     MOVE NV-STORE     TO N.
 16133     MOVE 0            TO V-EX-ONETIME.
 16134 6480-EXIT.
 16135      EXIT.
 16136
 16137 6490-EXIT.
 16138      EXIT.
 16139
 16140 6500-CALC-NET-TERM.
 16141     MOVE CM-LOAN-BALANCE         TO L.
 16142     MOVE PI-PAYMENT-AMT          TO M.
 16143
 16144     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 16145     IF WS-REMAIN GREATER ZERO
 16146         ADD 1 TO N.
 16147     IF N = 0
 16148         MOVE 1 TO N.
 16149
 16150 6700-EXIT.
 16151      EXIT.
 16152
 16153 6999-CALC-TERM-EXIT.
 16154     EXIT.
 16155
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 301
* EL131.cbl
 16157 7000-RESET-ATTRIBUTE.
 16158
 16159     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 16160                                    CERTSTA   CERTCARA
 16161                                    CERTGRPA.
 16162     MOVE -1                     TO CERTCARL.
 16163
 16164 7000-EXIT.
 16165     EXIT.
 16166
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 302
* EL131.cbl
 16168 7600-BROWSE-CLAIM.
 16169
 16170
 16171* EXEC CICS READ
 16172*        DATASET(CLMS-FILE-ID)
 16173*        SET    (ADDRESS OF CLAIM-MASTER)
 16174*        RIDFLD (MSTR-KEY)
 16175*        GENERIC
 16176*        EQUAL
 16177*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16178*    END-EXEC.
 16179*    MOVE '&"S  KG    E          (   #00013581' TO DFHEIV0
 16180     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16181     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16182     MOVE X'2020233030303133353831' TO DFHEIV0(25:11)
 16183     CALL 'kxdfhei1' USING DFHEIV0,
 16184           CLMS-FILE-ID,
 16185           DFHEIV20,
 16186           DFHEIV99,
 16187           MSTR-KEY,
 16188           ELMSTR-GENERIC-LENGTH,
 16189           DFHEIV99,
 16190           DFHEIV99
 16191     SET ADDRESS OF CLAIM-MASTER TO
 16192         DFHEIV20
 16193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16194
 16195
 16196     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 16197
 16198     if cl-assoc-cert-total = 0
 16199        move 1 to cl-assoc-cert-total
 16200     end-if
 16201     IF CL-ASSOC-CERT-SEQU = 0
 16202        MOVE 1 TO CL-ASSOC-CERT-SEQU
 16203     END-IF
 16204
 16205     IF CL-ASSOC-CERT-TOTAL = 1
 16206         MOVE AL-SADOF           TO BCERT1A
 16207                                    BSUFX1A
 16208                                    BCERT2A
 16209                                    BSUFX2A
 16210                                    BCERT3A
 16211                                    BSUFX3A
 16212                                    BCERT4A
 16213                                    BSUFX4A
 16214                                    BCERT5A
 16215                                    BSUFX5A
 16216                                    PCERTNOA
 16217                                    PSUFXA
 16218                                    LABEL1A
 16219                                    LABEL2A
 16220         GO TO 7699-EXIT.
 16221
 16222 7610-BROWSE-CLAIM-LOOP.
 16223
 16224     MOVE LOW-VALUES             TO BCERT1O
 16225                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 303
* EL131.cbl
 16226                                    BCERT2O
 16227                                    BSUFX2O
 16228                                    BCERT3O
 16229                                    BSUFX3O
 16230                                    BCERT4O
 16231                                    BSUFX4O
 16232                                    BCERT5O
 16233                                    BSUFX5O.
 16234
 16235
 16236* EXEC CICS HANDLE CONDITION
 16237*        ENDFILE  (7630-END-BROWSE)
 16238*    END-EXEC.
 16239*    MOVE '"$''                   ! E #00013629' TO DFHEIV0
 16240     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16242     MOVE X'4520233030303133363239' TO DFHEIV0(25:11)
 16243     CALL 'kxdfhei1' USING DFHEIV0
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16245
 16246
 16247
 16248* EXEC CICS STARTBR
 16249*        DATASET    (CLMS-FILE-ID)
 16250*        RIDFLD     (MSTR-KEY)
 16251*    END-EXEC.
 16252     MOVE 0
 16253       TO DFHEIV11
 16254*    MOVE '&,         G          &   #00013633' TO DFHEIV0
 16255     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16256     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16257     MOVE X'2020233030303133363333' TO DFHEIV0(25:11)
 16258     CALL 'kxdfhei1' USING DFHEIV0,
 16259           CLMS-FILE-ID,
 16260           MSTR-KEY,
 16261           DFHEIV99,
 16262           DFHEIV11,
 16263           DFHEIV99
 16264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16265
 16266
 16267     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 16268
 16269 7620-READ-CLAIM-LOOP.
 16270
 16271
 16272* EXEC CICS READNEXT
 16273*        DATASET   (CLMS-FILE-ID)
 16274*        SET       (ADDRESS OF CLAIM-MASTER)
 16275*        RIDFLD    (MSTR-KEY)
 16276*    END-EXEC.
 16277     MOVE 0
 16278       TO DFHEIV11
 16279*    MOVE '&.S                   )   #00013642' TO DFHEIV0
 16280     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16281     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16282     MOVE X'2020233030303133363432' TO DFHEIV0(25:11)
 16283     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 304
* EL131.cbl
 16284           CLMS-FILE-ID,
 16285           DFHEIV20,
 16286           DFHEIV99,
 16287           MSTR-KEY,
 16288           DFHEIV99,
 16289           DFHEIV11,
 16290           DFHEIV99,
 16291           DFHEIV99
 16292     SET ADDRESS OF CLAIM-MASTER TO
 16293         DFHEIV20
 16294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16295
 16296
 16297     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 16298        CL-CARRIER     NOT = CARRI           OR
 16299        CL-CLAIM-NO    NOT = CLAIMI
 16300        GO TO 7630-END-BROWSE.
 16301
 16302     IF WS-ASSOCIATED-CERTS = 1
 16303         MOVE CL-CERT-PRIME      TO BCERT1O
 16304         MOVE CL-CERT-SFX        TO BSUFX1O.
 16305
 16306     IF WS-ASSOCIATED-CERTS = 2
 16307         MOVE CL-CERT-PRIME      TO BCERT2O
 16308         MOVE CL-CERT-SFX        TO BSUFX2O.
 16309
 16310     IF WS-ASSOCIATED-CERTS = 3
 16311         MOVE CL-CERT-PRIME      TO BCERT3O
 16312         MOVE CL-CERT-SFX        TO BSUFX3O.
 16313
 16314     IF WS-ASSOCIATED-CERTS = 4
 16315         MOVE CL-CERT-PRIME      TO BCERT4O
 16316         MOVE CL-CERT-SFX        TO BSUFX4O.
 16317
 16318     IF WS-ASSOCIATED-CERTS = 5
 16319         MOVE CL-CERT-PRIME      TO BCERT5O
 16320         MOVE CL-CERT-SFX        TO BSUFX5O
 16321     ELSE
 16322         ADD +1                  TO WS-ASSOCIATED-CERTS
 16323         GO TO 7620-READ-CLAIM-LOOP.
 16324
 16325 7630-END-BROWSE.
 16326
 16327
 16328* EXEC CICS ENDBR
 16329*        DATASET   (CLMS-FILE-ID)
 16330*    END-EXEC.
 16331     MOVE 0
 16332       TO DFHEIV11
 16333*    MOVE '&2                    $   #00013678' TO DFHEIV0
 16334     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16335     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16336     MOVE X'2020233030303133363738' TO DFHEIV0(25:11)
 16337     CALL 'kxdfhei1' USING DFHEIV0,
 16338           CLMS-FILE-ID,
 16339           DFHEIV11,
 16340           DFHEIV99
 16341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 305
* EL131.cbl
 16342
 16343
 16344 7640-HIGHLIGHT-CERT-DISPLAYED.
 16345
 16346     MOVE AL-SANON               TO BCERT1A
 16347                                    BSUFX1A
 16348                                    BCERT2A
 16349                                    BSUFX2A
 16350                                    BCERT3A
 16351                                    BSUFX3A
 16352                                    BCERT4A
 16353                                    BSUFX4A
 16354                                    BCERT5A
 16355                                    BSUFX5A.
 16356
 16357     IF BCERT1O = CERTI AND
 16358        BSUFX1O = SUFXI
 16359            MOVE AL-SABON        TO BCERT1A
 16360                                    BSUFX1A.
 16361
 16362     IF BCERT2O = CERTI AND
 16363        BSUFX2O = SUFXI
 16364            MOVE AL-SABON        TO BCERT2A
 16365                                    BSUFX2A.
 16366
 16367     IF BCERT3O = CERTI AND
 16368        BSUFX3O = SUFXI
 16369            MOVE AL-SABON        TO BCERT3A
 16370                                    BSUFX3A.
 16371
 16372     IF BCERT4O = CERTI AND
 16373        BSUFX4O = SUFXI
 16374            MOVE AL-SABON        TO BCERT4A
 16375                                    BSUFX4A.
 16376
 16377     IF BCERT5O = CERTI AND
 16378        BSUFX5O = SUFXI
 16379            MOVE AL-SABON        TO BCERT5A
 16380                                    BSUFX5A.
 16381
 16382 7699-EXIT.
 16383     EXIT.
 16384
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 306
* EL131.cbl
 16386 7700-CHECK-SEQUENCE.
 16387
 16388
 16389* EXEC CICS HANDLE CONDITION
 16390*        ENDFILE  (7799-EXIT)
 16391*        NOTFND   (7799-EXIT)
 16392*    END-EXEC.
 16393*    MOVE '"$''I                  ! F #00013726' TO DFHEIV0
 16394     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16396     MOVE X'4620233030303133373236' TO DFHEIV0(25:11)
 16397     CALL 'kxdfhei1' USING DFHEIV0
 16398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16399
 16400
 16401
 16402* EXEC CICS READ
 16403*        DATASET(CLMS-FILE-ID)
 16404*        SET    (ADDRESS OF CLAIM-MASTER)
 16405*        RIDFLD (MSTR-KEY)
 16406*        GENERIC
 16407*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16408*    END-EXEC.
 16409*    MOVE '&"S  KG    E          (   #00013731' TO DFHEIV0
 16410     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16412     MOVE X'2020233030303133373331' TO DFHEIV0(25:11)
 16413     CALL 'kxdfhei1' USING DFHEIV0,
 16414           CLMS-FILE-ID,
 16415           DFHEIV20,
 16416           DFHEIV99,
 16417           MSTR-KEY,
 16418           ELMSTR-GENERIC-LENGTH,
 16419           DFHEIV99,
 16420           DFHEIV99
 16421     SET ADDRESS OF CLAIM-MASTER TO
 16422         DFHEIV20
 16423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16424
 16425
 16426     COMPUTE WS-ASSOC-CERT-TOTAL =
 16427             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 16428
 16429     GO TO 7799-EXIT.
 16430
 16431 7710-RESEQUENCE-CLAIMS.
 16432
 16433
 16434* EXEC CICS HANDLE CONDITION
 16435*        ENDFILE  (7799-EXIT)
 16436*    END-EXEC.
 16437*    MOVE '"$''                   ! G #00013746' TO DFHEIV0
 16438     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16440     MOVE X'4720233030303133373436' TO DFHEIV0(25:11)
 16441     CALL 'kxdfhei1' USING DFHEIV0
 16442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16443
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 307
* EL131.cbl
 16444
 16445
 16446* EXEC CICS STARTBR
 16447*        DATASET(CLMS-FILE-ID)
 16448*        RIDFLD (MSTR-KEY)
 16449*    END-EXEC.
 16450     MOVE 0
 16451       TO DFHEIV11
 16452*    MOVE '&,         G          &   #00013750' TO DFHEIV0
 16453     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16454     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16455     MOVE X'2020233030303133373530' TO DFHEIV0(25:11)
 16456     CALL 'kxdfhei1' USING DFHEIV0,
 16457           CLMS-FILE-ID,
 16458           MSTR-KEY,
 16459           DFHEIV99,
 16460           DFHEIV11,
 16461           DFHEIV99
 16462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16463
 16464
 16465     COMPUTE WS-ASSOC-CERT-SEQU =
 16466             WS-ASSOC-CERT-SEQU + 1.
 16467
 16468     COMPUTE WS-READNEXT-SWITCH =
 16469             WS-READNEXT-SWITCH + 1.
 16470
 16471 7720-READ-CLAIM-LOOP.
 16472
 16473
 16474* EXEC CICS READNEXT
 16475*        DATASET(CLMS-FILE-ID)
 16476*        SET    (ADDRESS OF CLAIM-MASTER)
 16477*        RIDFLD (MSTR-KEY)
 16478*    END-EXEC.
 16479     MOVE 0
 16480       TO DFHEIV11
 16481*    MOVE '&.S                   )   #00013763' TO DFHEIV0
 16482     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16483     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16484     MOVE X'2020233030303133373633' TO DFHEIV0(25:11)
 16485     CALL 'kxdfhei1' USING DFHEIV0,
 16486           CLMS-FILE-ID,
 16487           DFHEIV20,
 16488           DFHEIV99,
 16489           MSTR-KEY,
 16490           DFHEIV99,
 16491           DFHEIV11,
 16492           DFHEIV99,
 16493           DFHEIV99
 16494     SET ADDRESS OF CLAIM-MASTER TO
 16495         DFHEIV20
 16496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16497
 16498
 16499     IF WS-READNEXT-SWITCH = 1
 16500         ADD 1                   TO WS-READNEXT-SWITCH
 16501         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 308
* EL131.cbl
 16502
 16503 7730-END-BROWSE.
 16504
 16505
 16506* EXEC CICS ENDBR
 16507*        DATASET(CLMS-FILE-ID)
 16508*    END-EXEC.
 16509     MOVE 0
 16510       TO DFHEIV11
 16511*    MOVE '&2                    $   #00013775' TO DFHEIV0
 16512     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16514     MOVE X'2020233030303133373735' TO DFHEIV0(25:11)
 16515     CALL 'kxdfhei1' USING DFHEIV0,
 16516           CLMS-FILE-ID,
 16517           DFHEIV11,
 16518           DFHEIV99
 16519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16520
 16521
 16522 7740-READ-CLAIM-UPDATE.
 16523
 16524     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 16525        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 16526        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 16527        GO TO 7799-EXIT
 16528     ELSE
 16529        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16530
 16531
 16532* EXEC CICS READ
 16533*        DATASET(CLMS-FILE-ID)
 16534*        SET    (ADDRESS OF CLAIM-MASTER)
 16535*        RIDFLD (MSTR-KEY)
 16536*        UPDATE
 16537*    END-EXEC.
 16538*    MOVE '&"S        EU         (   #00013788' TO DFHEIV0
 16539     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16540     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16541     MOVE X'2020233030303133373838' TO DFHEIV0(25:11)
 16542     CALL 'kxdfhei1' USING DFHEIV0,
 16543           CLMS-FILE-ID,
 16544           DFHEIV20,
 16545           DFHEIV99,
 16546           MSTR-KEY,
 16547           DFHEIV99,
 16548           DFHEIV99,
 16549           DFHEIV99
 16550     SET ADDRESS OF CLAIM-MASTER TO
 16551         DFHEIV20
 16552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16553
 16554
 16555     if (cl-priority-cd = '8')
 16556        and (pi-processor-id not = 'PEMA' and 'JMS '
 16557             AND 'AMWA')
 16558        MOVE ER-8003             TO EMI-ERROR
 16559        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 309
* EL131.cbl
 16560                                 THRU 9900-EXIT
 16561        MOVE -1                  TO MAINTL
 16562        GO TO 8110-SEND-DATA
 16563     end-if
 16564
 16565     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16566         MOVE 'Y'                TO CL-YESNOSW
 16567     END-IF.
 16568
 16569     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16570     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16571
 16572
 16573* EXEC CICS REWRITE
 16574*         DATASET(CLMS-FILE-ID)
 16575*         FROM   (CLAIM-MASTER)
 16576*    END-EXEC.
 16577     MOVE LENGTH OF
 16578      CLAIM-MASTER
 16579       TO DFHEIV11
 16580*    MOVE '&& L                  %   #00013812' TO DFHEIV0
 16581     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16582     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16583     MOVE X'2020233030303133383132' TO DFHEIV0(25:11)
 16584     CALL 'kxdfhei1' USING DFHEIV0,
 16585           CLMS-FILE-ID,
 16586           CLAIM-MASTER,
 16587           DFHEIV11,
 16588           DFHEIV99
 16589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16590
 16591
 16592     GO TO 7710-RESEQUENCE-CLAIMS.
 16593
 16594 7799-EXIT.
 16595     EXIT.
 16596
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 310
* EL131.cbl
 16598 7800-CHECK-AUTO-ACTIVITY.
 16599
 16600
 16601* EXEC CICS HANDLE CONDITION
 16602*        NOTFND   (7800-NOT-FOUND)
 16603*    END-EXEC.
 16604*    MOVE '"$I                   ! H #00013825' TO DFHEIV0
 16605     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16607     MOVE X'4820233030303133383235' TO DFHEIV0(25:11)
 16608     CALL 'kxdfhei1' USING DFHEIV0
 16609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16610
 16611
 16612     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16613     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16614     MOVE SPACES                     TO  CNTL-PROC-ID.
 16615     MOVE +0                         TO  CNTL-SEQ-NO.
 16616
 16617
 16618* EXEC CICS READ
 16619*        DATASET   (CNTL-FILE-ID)
 16620*        RIDFLD    (CNTL-KEY)
 16621*        SET       (ADDRESS OF CONTROL-FILE)
 16622*    END-EXEC.
 16623*    MOVE '&"S        E          (   #00013834' TO DFHEIV0
 16624     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16626     MOVE X'2020233030303133383334' TO DFHEIV0(25:11)
 16627     CALL 'kxdfhei1' USING DFHEIV0,
 16628           CNTL-FILE-ID,
 16629           DFHEIV20,
 16630           DFHEIV99,
 16631           CNTL-KEY,
 16632           DFHEIV99,
 16633           DFHEIV99,
 16634           DFHEIV99
 16635     SET ADDRESS OF CONTROL-FILE TO
 16636         DFHEIV20
 16637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16638
 16639
 16640     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16641         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16642
 16643     IF CL-ACTIVITY-CODE NOT = ZEROS
 16644         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16645         IF MISC-SUB IS GREATER THAN +9
 16646             SUBTRACT +9 FROM MISC-SUB
 16647             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16648         ELSE
 16649             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16650     ELSE
 16651         MOVE 'Y'                              TO  WS-RESET-SW.
 16652
 16653     IF STATUSI = 'C' OR 'CLOSED'
 16654         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16655             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 311
* EL131.cbl
 16656                                         PI-LETTER-SW
 16657             GO TO 7800-EXIT.
 16658
 16659     IF STATUSI = 'C' OR 'CLOSED'
 16660         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16661             MOVE 'N'                TO  PI-LETTER-SW
 16662         ELSE
 16663             MOVE 'Y'                TO  PI-LETTER-SW.
 16664
 16665     IF STATUSI = 'O' OR 'OPEN'
 16666         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16667             MOVE 'N'                TO  PI-REC-FOUND-SW
 16668                                         PI-LETTER-SW
 16669             GO TO 7800-EXIT.
 16670
 16671     IF STATUSI = 'O' OR 'OPEN'
 16672         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16673             MOVE 'N'                TO  PI-LETTER-SW
 16674         ELSE
 16675             MOVE 'Y'                TO  PI-LETTER-SW.
 16676
 16677     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16678     GO TO 7800-EXIT.
 16679
 16680 7800-NOT-FOUND.
 16681
 16682     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16683                                         PI-LETTER-SW.
 16684
 16685 7800-EXIT.
 16686     EXIT.
 16687
 16688 7850-AUTO-LETTER-WRITER.
 16689
 16690     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16691     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16692
 16693     IF STATUSI = 'C' OR 'CLOSED'
 16694         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16695     ELSE
 16696         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16697
 16698     IF STATUSI = 'C' OR 'CLOSED'
 16699         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16700             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16701             MOVE '6'                TO  DC-OPTION-CODE
 16702             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16703             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16704             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16705             IF NO-CONVERSION-ERROR
 16706                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16707             ELSE
 16708                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16709
 16710     IF STATUSI = 'C' OR 'CLOSED'
 16711         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16712             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16713             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 312
* EL131.cbl
 16714             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16715             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16716             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16717             IF NO-CONVERSION-ERROR
 16718                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16719             ELSE
 16720                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16721
 16722     IF STATUSI = 'O' OR 'OPEN'
 16723         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16724             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16725             MOVE '6'                TO  DC-OPTION-CODE
 16726             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16727             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16728             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16729             IF NO-CONVERSION-ERROR
 16730                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16731             ELSE
 16732                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16733
 16734     IF STATUSI = 'O' OR 'OPEN'
 16735         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16736             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16737             MOVE '6'                TO  DC-OPTION-CODE
 16738             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16739             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16740             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16741             IF NO-CONVERSION-ERROR
 16742                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16743             ELSE
 16744                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16745
 16746
 16747* EXEC CICS LINK
 16748*        PROGRAM    (LINK-1523)
 16749*        COMMAREA   (W-1523-LINKDATA)
 16750*        LENGTH     (W-1523-COMM-LENGTH)
 16751*    END-EXEC.
 16752*    MOVE '."C                   (   #00013946' TO DFHEIV0
 16753     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16755     MOVE X'2020233030303133393436' TO DFHEIV0(25:11)
 16756     CALL 'kxdfhei1' USING DFHEIV0,
 16757           LINK-1523,
 16758           W-1523-LINKDATA,
 16759           W-1523-COMM-LENGTH,
 16760           DFHEIV99,
 16761           DFHEIV99,
 16762           DFHEIV99,
 16763           DFHEIV99
 16764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16765
 16766
 16767     IF W-1523-ERROR-CODE = ZEROS
 16768         GO TO 7850-EXIT.
 16769
 16770     IF W-1523-FATAL-ERROR
 16771         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 313
* EL131.cbl
 16772         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16773
 16774     IF W-1523-ERROR-CODE = 0191
 16775         MOVE ER-0803                TO  EMI-ERROR
 16776         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16777
 16778 7850-EXIT.
 16779     EXIT.
 16780
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 314
* EL131.cbl
 16782 8000-CREATE-DMO-REC.
 16783     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16784     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16785     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16786
 16787
 16788* EXEC CICS HANDLE CONDITION
 16789*         NOTFND   (8000-NOTE-NOT-FOUND)
 16790*    END-EXEC.
 16791*    MOVE '"$I                   ! I #00013972' TO DFHEIV0
 16792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16794     MOVE X'4920233030303133393732' TO DFHEIV0(25:11)
 16795     CALL 'kxdfhei1' USING DFHEIV0
 16796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16797
 16798
 16799
 16800* EXEC CICS READ
 16801*         DATASET(NOTE-FILE-ID)
 16802*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16803*         RIDFLD (NOTE-KEY)
 16804*    END-EXEC.
 16805*    MOVE '&"S        E          (   #00013976' TO DFHEIV0
 16806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16808     MOVE X'2020233030303133393736' TO DFHEIV0(25:11)
 16809     CALL 'kxdfhei1' USING DFHEIV0,
 16810           NOTE-FILE-ID,
 16811           DFHEIV20,
 16812           DFHEIV99,
 16813           NOTE-KEY,
 16814           DFHEIV99,
 16815           DFHEIV99,
 16816           DFHEIV99
 16817     SET ADDRESS OF CERTIFICATE-NOTE TO
 16818         DFHEIV20
 16819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16820
 16821
 16822     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16823     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16824     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16825
 16826     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16827         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16828     ELSE
 16829         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16830
 16831     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16832     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16833
 16834
 16835* EXEC CICS LINK
 16836*        PROGRAM    ('DLO006')
 16837*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16838*        LENGTH     (WS-DCT-LENGTH)
 16839*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 315
* EL131.cbl
 16840     MOVE 'DLO006' TO DFHEIV1
 16841*    MOVE '."C                   (   #00013994' TO DFHEIV0
 16842     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16844     MOVE X'2020233030303133393934' TO DFHEIV0(25:11)
 16845     CALL 'kxdfhei1' USING DFHEIV0,
 16846           DFHEIV1,
 16847           DCT-COMMUNICATION-AREA,
 16848           WS-DCT-LENGTH,
 16849           DFHEIV99,
 16850           DFHEIV99,
 16851           DFHEIV99,
 16852           DFHEIV99
 16853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16854
 16855
 16856     IF  DCT-RETURN-CODE = 'OK'
 16857         GO TO 8000-CONT.
 16858
 16859     IF DCT-RETURN-CODE = '01' OR '02'
 16860         GO TO 8000-EXIT.
 16861
 16862     IF DCT-RETURN-CODE = '03'
 16863         MOVE ER-0951            TO EMI-ERROR
 16864         MOVE -1                 TO MAINTL
 16865         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16866         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16867         GO TO 8110-SEND-DATA.
 16868
 16869     IF DCT-RETURN-CODE = '04'
 16870         MOVE ER-0946            TO EMI-ERROR
 16871         MOVE -1                 TO MAINTL
 16872         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16873         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16874         GO TO 8110-SEND-DATA.
 16875
 16876     IF DCT-RETURN-CODE = '05'
 16877         MOVE ER-0947            TO EMI-ERROR
 16878         MOVE -1                 TO MAINTL
 16879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16880         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16881         GO TO 8110-SEND-DATA.
 16882
 16883     IF DCT-RETURN-CODE = '06'
 16884         MOVE ER-0921            TO EMI-ERROR
 16885         MOVE -1                 TO MAINTL
 16886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16887         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16888         GO TO 8110-SEND-DATA.
 16889
 16890     IF DCT-RETURN-CODE = '07'
 16891         MOVE ER-0919            TO EMI-ERROR
 16892         MOVE -1                 TO MAINTL
 16893         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16894         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16895         GO TO 8110-SEND-DATA.
 16896
 16897     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 316
* EL131.cbl
 16898         MOVE ER-0948            TO EMI-ERROR
 16899         MOVE -1                 TO MAINTL
 16900         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16901         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16902         GO TO 8110-SEND-DATA.
 16903
 16904     IF DCT-RETURN-CODE = 'N1'
 16905         MOVE ER-0950            TO EMI-ERROR
 16906         MOVE -1                 TO MAINTL
 16907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16908         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16909         GO TO 8110-SEND-DATA.
 16910
 16911     IF DCT-RETURN-CODE = 'E1'
 16912         MOVE ER-0974            TO EMI-ERROR
 16913         MOVE -1                 TO MAINTL
 16914         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16915         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16916         GO TO 8110-SEND-DATA.
 16917
 16918     IF DCT-RETURN-CODE = 'E2'
 16919         MOVE ER-0975            TO EMI-ERROR
 16920         MOVE -1                 TO MAINTL
 16921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16922         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16923         GO TO 8110-SEND-DATA.
 16924
 16925     IF DCT-RETURN-CODE NOT = 'OK'
 16926         MOVE ER-0949            TO EMI-ERROR
 16927         MOVE -1                 TO MAINTL
 16928         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16929         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16930         GO TO 8110-SEND-DATA.
 16931
 16932 8000-CONT.
 16933
 16934     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16935     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16936     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16937     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16938     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16939     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16940     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16941     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16942
 16943     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16944     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16945     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16946     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16947     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16948
 16949     IF STATUSI = 'OPEN' OR 'O'
 16950         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16951      ELSE
 16952         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16953
 16954     IF STATUSI = 'OPEN' OR 'O'
 16955        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 317
* EL131.cbl
 16956         MOVE '1'                TO DM-CLAIM-STATUS
 16957      ELSE
 16958         MOVE '2'                TO DM-CLAIM-STATUS.
 16959
 16960     IF STATUSI = 'CLOSED' OR 'C'
 16961        IF NOT FINAL-PAID
 16962         MOVE '3'                TO DM-CLAIM-STATUS
 16963      ELSE
 16964         MOVE '4'                TO DM-CLAIM-STATUS.
 16965
 16966     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16967
 16968
 16969* EXEC CICS LINK
 16970*        PROGRAM    ('DLO025')
 16971*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16972*        LENGTH     (WS-DMO-LENGTH)
 16973*    END-EXEC.
 16974     MOVE 'DLO025' TO DFHEIV1
 16975*    MOVE '."C                   (   #00014112' TO DFHEIV0
 16976     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16978     MOVE X'2020233030303134313132' TO DFHEIV0(25:11)
 16979     CALL 'kxdfhei1' USING DFHEIV0,
 16980           DFHEIV1,
 16981           DMO-COMMUNICATION-AREA,
 16982           WS-DMO-LENGTH,
 16983           DFHEIV99,
 16984           DFHEIV99,
 16985           DFHEIV99,
 16986           DFHEIV99
 16987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16988
 16989
 16990     IF  DM-RETURN-CODE = 'OK'
 16991         GO TO 8000-EXIT.
 16992
 16993     IF DM-RETURN-CODE = '01'
 16994         MOVE ER-8051            TO EMI-ERROR
 16995         MOVE -1                 TO MAINTL
 16996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16997         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16998         GO TO 8110-SEND-DATA.
 16999
 17000     IF DM-RETURN-CODE = '02'
 17001         MOVE ER-8052            TO EMI-ERROR
 17002         MOVE -1                 TO MAINTL
 17003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17004         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17005         GO TO 8110-SEND-DATA.
 17006
 17007     IF DM-RETURN-CODE = '03'
 17008         MOVE ER-8053            TO EMI-ERROR
 17009         MOVE -1                 TO MAINTL
 17010         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17011         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17012         GO TO 8110-SEND-DATA.
 17013
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 318
* EL131.cbl
 17014     IF DM-RETURN-CODE = '04'
 17015         MOVE ER-8054            TO EMI-ERROR
 17016         MOVE -1                 TO MAINTL
 17017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17018         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17019         GO TO 8110-SEND-DATA.
 17020
 17021     IF DM-RETURN-CODE = '05'
 17022         MOVE ER-8055            TO EMI-ERROR
 17023         MOVE -1                 TO MAINTL
 17024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17025         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17026         GO TO 8110-SEND-DATA.
 17027
 17028     IF DM-RETURN-CODE = '06'
 17029         MOVE ER-8056            TO EMI-ERROR
 17030         MOVE -1                 TO MAINTL
 17031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17032         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17033         GO TO 8110-SEND-DATA.
 17034
 17035     IF DM-RETURN-CODE = '07'
 17036         MOVE ER-8057            TO EMI-ERROR
 17037         MOVE -1                 TO MAINTL
 17038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17039         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17040         GO TO 8110-SEND-DATA.
 17041
 17042     IF DM-RETURN-CODE = '08'
 17043         MOVE ER-8058            TO EMI-ERROR
 17044         MOVE -1                 TO MAINTL
 17045         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17046         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17047         GO TO 8110-SEND-DATA.
 17048
 17049     IF DM-RETURN-CODE = '09'
 17050         MOVE ER-8059            TO EMI-ERROR
 17051         MOVE -1                 TO MAINTL
 17052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17053         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17054         GO TO 8110-SEND-DATA.
 17055
 17056     IF DM-RETURN-CODE = '10'
 17057         MOVE ER-8060            TO EMI-ERROR
 17058         MOVE -1                 TO MAINTL
 17059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17060         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17061         GO TO 8110-SEND-DATA.
 17062
 17063     IF DM-RETURN-CODE = '11'
 17064         MOVE ER-8061            TO EMI-ERROR
 17065         MOVE -1                 TO MAINTL
 17066         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17067         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17068         GO TO 8110-SEND-DATA.
 17069
 17070     IF DM-RETURN-CODE = '12'
 17071         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 319
* EL131.cbl
 17072         MOVE -1                 TO MAINTL
 17073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17074         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17075         GO TO 8110-SEND-DATA.
 17076
 17077     IF DM-RETURN-CODE = '13'
 17078         MOVE ER-8063            TO EMI-ERROR
 17079         MOVE -1                 TO MAINTL
 17080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17081         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17082         GO TO 8110-SEND-DATA.
 17083
 17084     IF DM-RETURN-CODE = '14'
 17085         MOVE ER-8064            TO EMI-ERROR
 17086         MOVE -1                 TO MAINTL
 17087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17088         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17089         GO TO 8110-SEND-DATA.
 17090
 17091     IF DM-RETURN-CODE = '15'
 17092         MOVE ER-8065            TO EMI-ERROR
 17093         MOVE -1                 TO MAINTL
 17094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17095         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17096         GO TO 8110-SEND-DATA.
 17097
 17098     IF DM-RETURN-CODE = '16'
 17099         MOVE ER-8154            TO EMI-ERROR
 17100         MOVE -1                 TO MAINTL
 17101         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17102         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17103         GO TO 8110-SEND-DATA.
 17104
 17105     IF DM-RETURN-CODE = '17'
 17106         MOVE ER-8155            TO EMI-ERROR
 17107         MOVE -1                 TO MAINTL
 17108         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17109         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17110         GO TO 8110-SEND-DATA.
 17111
 17112     IF DM-RETURN-CODE = 'N1'
 17113         MOVE ER-8152            TO EMI-ERROR
 17114         MOVE -1                 TO MAINTL
 17115         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17116         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17117         GO TO 8110-SEND-DATA.
 17118
 17119     IF DM-RETURN-CODE = 'E1'
 17120         MOVE ER-8153            TO EMI-ERROR
 17121         MOVE -1                 TO MAINTL
 17122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17123         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17124         GO TO 8110-SEND-DATA.
 17125
 17126     MOVE ER-8066                TO EMI-ERROR.
 17127     MOVE -1                     TO MAINTL.
 17128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17129     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 320
* EL131.cbl
 17130     GO TO 8110-SEND-DATA.
 17131
 17132 8000-NOTE-NOT-FOUND.
 17133
 17134* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17135*    MOVE '6"R                   !   #00014261' TO DFHEIV0
 17136     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17137     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17138     MOVE X'2020233030303134323631' TO DFHEIV0(25:11)
 17139     CALL 'kxdfhei1' USING DFHEIV0
 17140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17141
 17142     MOVE ER-0954                TO EMI-ERROR.
 17143     MOVE -1                     TO MAINTL.
 17144     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17145     GO TO 8110-SEND-DATA.
 17146
 17147 8000-EXIT.
 17148     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 321
* EL131.cbl
 17150 8050-FORMAT-LAST-NAME-1ST.
 17151*****************************************************************
 17152*             M O V E   N A M E   R O U T I N E                 *
 17153*                                                               *
 17154*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 17155*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 17156*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 17157*                                                               *
 17158*                  FIELD               VALUE                    *
 17159*                  -----               -----                    *
 17160*           W-NAME-LAST    (CL15)      SMITH                    *
 17161*           W-NAME-FIRST   (CL15)      JOHN                     *
 17162*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 17163*                                                               *
 17164*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 17165*                SMITH, JOHN ALLEN                              *
 17166*                     OR                                        *
 17167*                SMITH, JOHN A.                                 *
 17168*                                                               *
 17169*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 17170*     COPYBOOK, ELCNWA.                                         *
 17171*****************************************************************.
 17172
 17173     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 17174     MOVE ZERO                   TO WS-NAME-SW.
 17175     SET NWA-INDEX               TO +1.
 17176
 17177     IF W-NAME-LAST   = SPACES  AND
 17178        W-NAME-MIDDLE = SPACES
 17179          MOVE +1                TO WS-NAME-SW.
 17180
 17181     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 17182     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17183
 17184     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 17185     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17186
 17187     SET NWA-INDEX UP BY +1.
 17188
 17189     IF W-NAME-MIDDLE NOT = SPACES
 17190         IF W-NAME-MIDDLE-2 = SPACES
 17191             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 17192             SET NWA-INDEX UP BY +1
 17193             MOVE '.'            TO WS-NW (NWA-INDEX)
 17194             SET NWA-INDEX UP BY +2
 17195         ELSE
 17196             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 17197             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17198
 17199 8050-EXIT.
 17200     EXIT.
 17201
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 322
* EL131.cbl
 17203 8060-MOVE-NAME.
 17204     IF WS-NAME-SW GREATER THAN +1
 17205         GO TO 8060-EXIT.
 17206
 17207     IF WS-NAME-WORK2 = SPACES
 17208         GO TO 8060-EXIT.
 17209
 17210     SET NWA-INDEX2            TO +1.
 17211     SET NWA-INDEX3            TO +2.
 17212
 17213 8060-MOVE-NAME-CYCLE.
 17214     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 17215
 17216     IF NWA-INDEX LESS THAN +30
 17217         SET NWA-INDEX UP BY +1
 17218     ELSE
 17219         ADD +2 TO  WS-NAME-SW
 17220         GO TO 8060-EXIT.
 17221
 17222     IF NWA-INDEX2 LESS THAN +20
 17223         SET NWA-INDEX3 UP BY +1
 17224         SET NWA-INDEX2 UP BY +1.
 17225
 17226     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 17227        WS-NW2 (NWA-INDEX3) = SPACES
 17228         IF WS-NAME-SW = ZERO
 17229             MOVE ','            TO WS-NW (NWA-INDEX)
 17230             SET NWA-INDEX UP BY +2
 17231             MOVE +1             TO WS-NAME-SW
 17232             GO TO 8060-EXIT
 17233         ELSE
 17234             GO TO 8060-EXIT.
 17235
 17236     GO TO 8060-MOVE-NAME-CYCLE.
 17237
 17238 8060-EXIT.
 17239     EXIT.
 17240
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 323
* EL131.cbl
 17242
 17243 8070-UNLOCK-CLAIM-MSTR.
 17244
 17245* EXEC CICS UNLOCK
 17246*        DATASET   (CLMS-FILE-ID)
 17247*    END-EXEC.
 17248*    MOVE '&*                    #   #00014364' TO DFHEIV0
 17249     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 17250     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17251     MOVE X'2020233030303134333634' TO DFHEIV0(25:11)
 17252     CALL 'kxdfhei1' USING DFHEIV0,
 17253           CLMS-FILE-ID,
 17254           DFHEIV99
 17255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17256
 17257
 17258 8070-EXIT.
 17259      EXIT.
 17260
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 324
* EL131.cbl
 17262 8100-SEND-MAP.
 17263     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 17264
 17265     move al-uanon               to accswa
 17266     IF NOT PI-NO-CARRIER-SECURITY
 17267        MOVE AL-SANOF            TO CERTCARA.
 17268     IF NOT PI-NO-ACCOUNT-SECURITY
 17269        MOVE AL-SANOF            TO CERTACTA.
 17270
 17271     IF PI-PROCESSOR-ID = 'LGXX'
 17272        MOVE AL-UANON            TO CCNOA.
 17273
 17274     IF PI-COMPANY-ID = 'DMD'
 17275        NEXT SENTENCE
 17276     ELSE
 17277        MOVE AL-SADOF            TO PFKEY6A.
 17278     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 17279        MOVE AL-SANOF TO EXTENSA
 17280     END-IF
 17281
 17282     IF PI-USES-PAID-TO
 17283        MOVE 'PAID TO  :' TO PTHRHDGO.
 17284
 17285
 17286* EXEC CICS SEND
 17287*         MAP     ('EL131A')
 17288*         MAPSET  ('EL131S')
 17289*         ERASE
 17290*         FREEKB
 17291*         CURSOR
 17292*    END-EXEC.
 17293     MOVE 'EL131A' TO DFHEIV1
 17294     MOVE -1
 17295       TO DFHEIV11
 17296     MOVE 'EL131S' TO DFHEIV2
 17297*    MOVE '8$     CT  E F  H     ,   #00014395' TO DFHEIV0
 17298     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17299     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17300     MOVE X'2020233030303134333935' TO DFHEIV0(25:11)
 17301     CALL 'kxdfhei1' USING DFHEIV0,
 17302           DFHEIV1,
 17303           EL131AO,
 17304           DFHEIV99,
 17305           DFHEIV2,
 17306           DFHEIV99,
 17307           DFHEIV99,
 17308           DFHEIV99,
 17309           DFHEIV11,
 17310           DFHEIV99,
 17311           DFHEIV99,
 17312           DFHEIV99
 17313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17314
 17315
 17316     GO TO 9000-RETURN-TRANS.
 17317
 17318 8110-SEND-DATA.
 17319     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 325
* EL131.cbl
 17320
 17321     IF PI-USES-PAID-TO
 17322        MOVE 'PAID TO  :' TO PTHRHDGO.
 17323
 17324     IF PI-PROCESSOR-ID = 'LGXX'
 17325        MOVE AL-UANON            TO CCNOA.
 17326
 17327     IF PI-COMPANY-ID = 'DMD'
 17328        NEXT SENTENCE
 17329     ELSE
 17330        MOVE AL-SADOF            TO PFKEY6A.
 17331
 17332
 17333* EXEC CICS SEND
 17334*         MAP      ('EL131A')
 17335*         MAPSET   ('EL131S')
 17336*         DATAONLY
 17337*         FREEKB
 17338*         CURSOR
 17339*    END-EXEC.
 17340     MOVE 'EL131A' TO DFHEIV1
 17341     MOVE -1
 17342       TO DFHEIV11
 17343     MOVE 'EL131S' TO DFHEIV2
 17344*    MOVE '8$D    CT    F  H     ,   #00014419' TO DFHEIV0
 17345     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17346     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17347     MOVE X'2020233030303134343139' TO DFHEIV0(25:11)
 17348     CALL 'kxdfhei1' USING DFHEIV0,
 17349           DFHEIV1,
 17350           EL131AO,
 17351           DFHEIV99,
 17352           DFHEIV2,
 17353           DFHEIV99,
 17354           DFHEIV99,
 17355           DFHEIV99,
 17356           DFHEIV11,
 17357           DFHEIV99,
 17358           DFHEIV99,
 17359           DFHEIV99
 17360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17361
 17362
 17363     GO TO 9000-RETURN-TRANS.
 17364
 17365 8120-FORMAT-TIME-DATE.
 17366     perform 8140-check-for-prev-errors
 17367                                 thru 8140-exit
 17368     IF SKIP-ATTRIBUTE = 'Y'
 17369        MOVE SPACES              TO SKIP-ATTRIBUTE
 17370        MOVE ER-0598             TO EMI-ERROR
 17371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17372        GO TO 8125-SKIP-ATTRIBUTE.
 17373
 17374*     IF PI-COMPANY-ID = 'DMD'
 17375      IF PI-PROCESSOR-ID <> 'EMER'
 17376         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 17377                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 326
* EL131.cbl
 17378
 17379     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 17380                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 17381                                    JNTINITA  JNTAGEA   APRA
 17382                                    LCVCDA    LCVOTRMA  LCVRTRMA
 17383                                    LCVBENEA  LCVFORMA  LCVCNDTA
 17384                                    LCVEXITA  LCVSTATA  LCVKINDA
 17385                                    ACVCDA    ACVOTRMA  ACVRTRMA
 17386                                    ACVBENEA  ACVFORMA  ACVCNDTA
 17387                                    ACVEXITA  ACVSTATA  ACVKINDA
 17388                                    PMTFREQA  INDGRPA   PREMTYPA
 17389                                    REINCDA   LCVRATEA  ACVRATEA
 17390                                    ADDONDTA.
 17391
 17392*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 17393*       IF PI-COMPANY-ID = 'DMD'
 17394*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 17395*                                   SUFXA
 17396*                                   PDAMTA    NODAYSA   NOPMTSA
 17397*                                   INCA      OCCA
 17398*          IF NOT SYSTEM-MODIFY-CAP
 17399*              MOVE AL-SANOF         TO PDTHRUA.
 17400
 17401     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 17402         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 17403
 17404 8125-SKIP-ATTRIBUTE.
 17405
 17406     MOVE SAVE-DATE              TO DATEO.
 17407
 17408* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 17409*    END-EXEC
 17410*    MOVE '0"A                   "   #00014471' TO DFHEIV0
 17411     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 17412     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 17413     MOVE X'2020233030303134343731' TO DFHEIV0(25:11)
 17414     CALL 'kxdfhei1' USING DFHEIV0,
 17415           LCP-CICS-TIME
 17416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17417
 17418* EXEC CICS FORMATTIME
 17419*              ABSTIME(LCP-CICS-TIME)
 17420*              TIME(LCP-TIME-OF-DAY-XX)
 17421*    END-EXEC
 17422*    MOVE 'j$(     (             #   #00014473' TO DFHEIV0
 17423     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 17424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17425     MOVE X'2020233030303134343733' TO DFHEIV0(25:11)
 17426     CALL 'kxdfhei1' USING DFHEIV0,
 17427           LCP-CICS-TIME,
 17428           LCP-TIME-OF-DAY-XX
 17429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17430     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 17431     MOVE UN-HOURS               TO FOR-HOURS.
 17432     MOVE UN-MINUTES             TO FOR-MINUTES.
 17433     MOVE TIME-OUT               TO TIMEO.
 17434     MOVE PI-COMPANY-ID          TO COMPO.
 17435     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 327
* EL131.cbl
 17436     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 17437     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17438     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 17439     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 17440
 17441 8130-EXIT.
 17442     EXIT.
 17443
 17444 8140-check-for-prev-errors.
 17445
 17446     MOVE PI-COMPANY-CD          TO trlr-company-cd
 17447     MOVE PI-CARRIER             TO trlr-carrier
 17448     MOVE PI-CLAIM-NO            TO trlr-claim-no
 17449     MOVE PI-CERT-NO             TO trlr-cert-no
 17450     MOVE +95                    TO TRLR-SEQ-NO
 17451
 17452
 17453* EXEC CICS READ
 17454*       DATASET  ('ELTRLR')
 17455*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17456*       RIDFLD   (TRLR-KEY)
 17457*       RESP     (WS-RESPONSE)
 17458*    END-EXEC
 17459     MOVE 'ELTRLR' TO DFHEIV1
 17460*    MOVE '&"S        E          (  N#00014499' TO DFHEIV0
 17461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17462     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17463     MOVE X'204E233030303134343939' TO DFHEIV0(25:11)
 17464     CALL 'kxdfhei1' USING DFHEIV0,
 17465           DFHEIV1,
 17466           DFHEIV20,
 17467           DFHEIV99,
 17468           TRLR-KEY,
 17469           DFHEIV99,
 17470           DFHEIV99,
 17471           DFHEIV99
 17472     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17473         DFHEIV20
 17474     MOVE EIBRESP  TO WS-RESPONSE
 17475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17476
 17477     if ws-resp-normal
 17478        perform varying s1 from +1 by +1 until
 17479           at-note-error-no (s1) = spaces
 17480           if at-note-error-no (s1) = '1652'
 17481              continue
 17482           else
 17483              move at-note-error-no (s1)
 17484                                 to emi-error
 17485              move -1 to maintl
 17486              if at-note-error-no (s1) = '1653'
 17487                 evaluate true
 17488                    when pi-claim-type = 'L'
 17489                       move '  LF  '
 17490                        to emi-claim-type
 17491                    when pi-claim-type = 'I'
 17492                       move '  IU  '
 17493                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 328
* EL131.cbl
 17494                    WHEN PI-CLAIM-TYPE = 'F'
 17495                       MOVE '  FL  '
 17496                        TO EMI-CLAIM-TYPE
 17497                    WHEN PI-CLAIM-TYPE = 'O'
 17498                       MOVE '  OT  '
 17499                        TO EMI-CLAIM-TYPE
 17500                    when other
 17501                       move '  AH  '
 17502                        to emi-claim-type
 17503                 end-evaluate
 17504              end-if
 17505              PERFORM 9900-ERROR-FORMAT
 17506                                 THRU 9900-EXIT
 17507           end-if
 17508*          if at-note-error-no (s1) = '1653'
 17509*             perform varying emi-sub from 1 by 1 until
 17510*                emi-sub > 3
 17511*                if emi-error-number (emi-sub) = '1653'
 17512*                   evaluate true
 17513*                      when pi-claim-type = 'L'
 17514*                         move '  LF  '
 17515*                          to emi-claim-type
 17516*                      when pi-claim-type = 'I'
 17517*                         move '  IU  '
 17518*                          to emi-claim-type
 17519*                      when other
 17520*                         move '  AH  '
 17521*                          to emi-claim-type
 17522*                   end-evaluate
 17523*                end-if
 17524*             end-perform
 17525*          end-if
 17526        end-perform
 17527     else
 17528        display ' resp not normal ' ws-response ' '
 17529        trlr-key (2:19)
 17530     end-if
 17531
 17532     .
 17533 8140-exit.
 17534     exit.
 17535 8150-ENTERED-CLAIM-NOTFOUND.
 17536
 17537     MOVE ER-0204                TO EMI-ERROR.
 17538     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17539     MOVE -1                     TO MAINTL.
 17540     GO TO 8100-SEND-MAP.
 17541
 17542 8200-RETURN-PRIOR.
 17543     MOVE SPACE                  TO PI-RETURN-CD-1.
 17544     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17545     GO TO 9200-XCTL.
 17546
 17547 8300-GET-HELP.
 17548     MOVE XCTL-EL010             TO CALL-PGM.
 17549     GO TO 9200-XCTL.
 17550
 17551 8400-RETURN-MASTER.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 329
* EL131.cbl
 17552     MOVE SPACE                  TO PI-RETURN-CD-1.
 17553     MOVE XCTL-EL126             TO CALL-PGM.
 17554     GO TO 9200-XCTL.
 17555
 17556 8500-TRLR-MNT.
 17557     IF PI-RETURN-CD-1 = 'X'
 17558         MOVE ER-0311            TO EMI-ERROR
 17559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17560         MOVE -1                 TO MAINTL
 17561         GO TO 8110-SEND-DATA.
 17562
 17563
 17564* EXEC CICS WRITEQ TS
 17565*         QUEUE     (PI-KEY)
 17566*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17567*         LENGTH    (PI-COMM-LENGTH)
 17568*    END-EXEC.
 17569*    MOVE '*"     L              ''   #00014592' TO DFHEIV0
 17570     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17572     MOVE X'2020233030303134353932' TO DFHEIV0(25:11)
 17573     CALL 'kxdfhei1' USING DFHEIV0,
 17574           PI-KEY,
 17575           PROGRAM-INTERFACE-BLOCK,
 17576           PI-COMM-LENGTH,
 17577           DFHEIV99,
 17578           DFHEIV99,
 17579           DFHEIV99
 17580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17581
 17582
 17583     MOVE XCTL-EL142             TO CALL-PGM.
 17584     GO TO 9200-XCTL.
 17585
 17586 8600-ADDR-MNT.
 17587     IF PI-RETURN-CD-1 = 'X'
 17588         MOVE ER-0311            TO EMI-ERROR
 17589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17590         MOVE -1                 TO MAINTL
 17591         GO TO 8110-SEND-DATA.
 17592
 17593
 17594* EXEC CICS WRITEQ TS
 17595*         QUEUE     (PI-KEY)
 17596*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17597*         LENGTH    (PI-COMM-LENGTH)
 17598*    END-EXEC.
 17599*    MOVE '*"     L              ''   #00014608' TO DFHEIV0
 17600     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17601     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17602     MOVE X'2020233030303134363038' TO DFHEIV0(25:11)
 17603     CALL 'kxdfhei1' USING DFHEIV0,
 17604           PI-KEY,
 17605           PROGRAM-INTERFACE-BLOCK,
 17606           PI-COMM-LENGTH,
 17607           DFHEIV99,
 17608           DFHEIV99,
 17609           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 330
* EL131.cbl
 17610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17611
 17612
 17613     MOVE XCTL-EL141             TO CALL-PGM.
 17614     GO TO 9200-XCTL.
 17615
 17616 8700-CERT-MNT.
 17617     IF PI-RETURN-CD-1 = 'X'
 17618         MOVE ER-7690            TO EMI-ERROR
 17619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17620         MOVE -1                 TO MAINTL
 17621         GO TO 8110-SEND-DATA.
 17622
 17623
 17624* EXEC CICS WRITEQ TS
 17625*         QUEUE     (PI-KEY)
 17626*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17627*         LENGTH    (PI-COMM-LENGTH)
 17628*    END-EXEC.
 17629*    MOVE '*"     L              ''   #00014624' TO DFHEIV0
 17630     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17632     MOVE X'2020233030303134363234' TO DFHEIV0(25:11)
 17633     CALL 'kxdfhei1' USING DFHEIV0,
 17634           PI-KEY,
 17635           PROGRAM-INTERFACE-BLOCK,
 17636           PI-COMM-LENGTH,
 17637           DFHEIV99,
 17638           DFHEIV99,
 17639           DFHEIV99
 17640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17641
 17642
 17643     MOVE XCTL-EL1273            TO CALL-PGM.
 17644     GO TO 9200-XCTL.
 17645
 17646 8725-BENEFICIARY-MNT.
 17647     IF PI-RETURN-CD-1 = 'X'
 17648         MOVE ER-0311            TO EMI-ERROR
 17649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17650         MOVE -1                 TO MAINTL
 17651         GO TO 8110-SEND-DATA.
 17652
 17653
 17654* EXEC CICS WRITEQ TS
 17655*         QUEUE     (PI-KEY)
 17656*         FROM      (EL131AI)
 17657*         LENGTH    (MAP-LENGTH)
 17658*    END-EXEC.
 17659*    MOVE '*"     L              ''   #00014640' TO DFHEIV0
 17660     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17661     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17662     MOVE X'2020233030303134363430' TO DFHEIV0(25:11)
 17663     CALL 'kxdfhei1' USING DFHEIV0,
 17664           PI-KEY,
 17665           EL131AI,
 17666           MAP-LENGTH,
 17667           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 331
* EL131.cbl
 17668           DFHEIV99,
 17669           DFHEIV99
 17670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17671
 17672
 17673
 17674* EXEC CICS WRITEQ TS
 17675*         QUEUE     (PI-KEY)
 17676*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17677*         LENGTH    (PI-COMM-LENGTH)
 17678*    END-EXEC.
 17679*    MOVE '*"     L              ''   #00014646' TO DFHEIV0
 17680     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17681     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17682     MOVE X'2020233030303134363436' TO DFHEIV0(25:11)
 17683     CALL 'kxdfhei1' USING DFHEIV0,
 17684           PI-KEY,
 17685           PROGRAM-INTERFACE-BLOCK,
 17686           PI-COMM-LENGTH,
 17687           DFHEIV99,
 17688           DFHEIV99,
 17689           DFHEIV99
 17690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17691
 17692
 17693     MOVE XCTL-EL114             TO CALL-PGM.
 17694     GO TO 9200-XCTL.
 17695
 17696 8750-DMD-CLM-FIX.
 17697
 17698* EXEC CICS WRITEQ TS
 17699*         QUEUE     (PI-KEY)
 17700*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17701*         LENGTH    (PI-COMM-LENGTH)
 17702*    END-EXEC.
 17703*    MOVE '*"     L              ''   #00014656' TO DFHEIV0
 17704     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17706     MOVE X'2020233030303134363536' TO DFHEIV0(25:11)
 17707     CALL 'kxdfhei1' USING DFHEIV0,
 17708           PI-KEY,
 17709           PROGRAM-INTERFACE-BLOCK,
 17710           PI-COMM-LENGTH,
 17711           DFHEIV99,
 17712           DFHEIV99,
 17713           DFHEIV99
 17714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17715
 17716
 17717     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17718     GO TO 9200-XCTL.
 17719
 17720 8800-UNAUTHORIZED-ACCESS.
 17721     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17722     GO TO 8990-SEND-TEXT.
 17723
 17724 8810-PF23-ENTERED.
 17725     MOVE EIBAID                 TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 332
* EL131.cbl
 17726     MOVE XCTL-EL005             TO CALL-PGM.
 17727     GO TO 9200-XCTL.
 17728
 17729 8820-XCTL-ERROR.
 17730
 17731* EXEC CICS HANDLE CONDITION
 17732*        PGMIDERR (8990-SEND-TEXT)
 17733*    END-EXEC.
 17734*    MOVE '"$L                   ! J #00014675' TO DFHEIV0
 17735     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17736     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17737     MOVE X'4A20233030303134363735' TO DFHEIV0(25:11)
 17738     CALL 'kxdfhei1' USING DFHEIV0
 17739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17740
 17741
 17742     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17743     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17744     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17745     MOVE XCTL-EL005            TO CALL-PGM.
 17746     GO TO 9200-XCTL.
 17747
 17748 8990-SEND-TEXT.
 17749
 17750* EXEC CICS SEND TEXT
 17751*         FROM      (LOGOFF-TEXT)
 17752*         LENGTH    (LOGOFF-LENGTH)
 17753*         ERASE
 17754*         FREEKB
 17755*    END-EXEC.
 17756*    MOVE '8&      T  E F  H   F -   #00014686' TO DFHEIV0
 17757     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17758     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17759     MOVE X'2020233030303134363836' TO DFHEIV0(25:11)
 17760     CALL 'kxdfhei1' USING DFHEIV0,
 17761           LOGOFF-TEXT,
 17762           LOGOFF-LENGTH,
 17763           DFHEIV99,
 17764           DFHEIV99,
 17765           DFHEIV99,
 17766           DFHEIV99,
 17767           DFHEIV99,
 17768           DFHEIV99,
 17769           DFHEIV99,
 17770           DFHEIV99,
 17771           DFHEIV99,
 17772           DFHEIV99
 17773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17774
 17775
 17776     GO TO 9100-RETURN-CICS.
 17777
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 333
* EL131.cbl
 17779 9000-RETURN-TRANS.
 17780
 17781* EXEC CICS RETURN
 17782*         TRANSID   (TRANS-ID)
 17783*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17784*         LENGTH    (PI-COMM-LENGTH)
 17785*    END-EXEC.
 17786*    MOVE '.(CT                  ''   #00014697' TO DFHEIV0
 17787     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17788     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17789     MOVE X'2020233030303134363937' TO DFHEIV0(25:11)
 17790     CALL 'kxdfhei1' USING DFHEIV0,
 17791           TRANS-ID,
 17792           PROGRAM-INTERFACE-BLOCK,
 17793           PI-COMM-LENGTH,
 17794           DFHEIV99,
 17795           DFHEIV99,
 17796           DFHEIV99
 17797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17798
 17799
 17800
 17801* GOBACK.
 17802     MOVE '9%                    "   ' TO DFHEIV0
 17803     MOVE 'EL131' TO DFHEIV1
 17804     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17805     GOBACK.
 17806
 17807 9100-RETURN-CICS.
 17808
 17809* EXEC CICS RETURN
 17810*    END-EXEC.
 17811*    MOVE '.(                    ''   #00014706' TO DFHEIV0
 17812     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17813     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17814     MOVE X'2020233030303134373036' TO DFHEIV0(25:11)
 17815     CALL 'kxdfhei1' USING DFHEIV0,
 17816           DFHEIV99,
 17817           DFHEIV99,
 17818           DFHEIV99,
 17819           DFHEIV99,
 17820           DFHEIV99,
 17821           DFHEIV99
 17822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17823
 17824
 17825
 17826* GOBACK.
 17827     MOVE '9%                    "   ' TO DFHEIV0
 17828     MOVE 'EL131' TO DFHEIV1
 17829     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17830     GOBACK.
 17831
 17832 9200-XCTL.
 17833
 17834* EXEC CICS XCTL
 17835*         PROGRAM    (CALL-PGM)
 17836*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 334
* EL131.cbl
 17837*         LENGTH     (PI-COMM-LENGTH)
 17838*    END-EXEC.
 17839*    MOVE '.$C                   %   #00014712' TO DFHEIV0
 17840     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17841     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17842     MOVE X'2020233030303134373132' TO DFHEIV0(25:11)
 17843     CALL 'kxdfhei1' USING DFHEIV0,
 17844           CALL-PGM,
 17845           PROGRAM-INTERFACE-BLOCK,
 17846           PI-COMM-LENGTH,
 17847           DFHEIV99
 17848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17849
 17850
 17851 9700-LINK-RTRM-FILE-ID.
 17852
 17853* EXEC CICS LINK
 17854*        PROGRAM  (RTRM-FILE-ID)
 17855*        COMMAREA (CALCULATION-PASS-AREA)
 17856*        LENGTH   (CP-COMM-LENGTH)
 17857*    END-EXEC.
 17858*    MOVE '."C                   (   #00014719' TO DFHEIV0
 17859     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17861     MOVE X'2020233030303134373139' TO DFHEIV0(25:11)
 17862     CALL 'kxdfhei1' USING DFHEIV0,
 17863           RTRM-FILE-ID,
 17864           CALCULATION-PASS-AREA,
 17865           CP-COMM-LENGTH,
 17866           DFHEIV99,
 17867           DFHEIV99,
 17868           DFHEIV99,
 17869           DFHEIV99
 17870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17871
 17872
 17873 9700-EXIT.
 17874      EXIT.
 17875
 17876 9800-CONVERT-DATE.
 17877     MOVE SPACES TO DC-ERROR-CODE.
 17878
 17879* EXEC CICS LINK
 17880*         PROGRAM    (DATE-CONV)
 17881*         COMMAREA   (DATE-CONVERSION-DATA)
 17882*         LENGTH     (DC-COMM-LENGTH)
 17883*    END-EXEC.
 17884*    MOVE '."C                   (   #00014730' TO DFHEIV0
 17885     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17886     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17887     MOVE X'2020233030303134373330' TO DFHEIV0(25:11)
 17888     CALL 'kxdfhei1' USING DFHEIV0,
 17889           DATE-CONV,
 17890           DATE-CONVERSION-DATA,
 17891           DC-COMM-LENGTH,
 17892           DFHEIV99,
 17893           DFHEIV99,
 17894           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 335
* EL131.cbl
 17895           DFHEIV99
 17896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17897
 17898
 17899 9800-EXIT.
 17900     EXIT.
 17901
 17902 9900-ERROR-FORMAT.
 17903
 17904* EXEC CICS LINK
 17905*         PROGRAM    (XCTL-EL001)
 17906*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17907*         LENGTH     (EMI-COMM-LENGTH)
 17908*    END-EXEC.
 17909*    MOVE '."C                   (   #00014740' TO DFHEIV0
 17910     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17912     MOVE X'2020233030303134373430' TO DFHEIV0(25:11)
 17913     CALL 'kxdfhei1' USING DFHEIV0,
 17914           XCTL-EL001,
 17915           ERROR-MESSAGE-INTERFACE-BLOCK,
 17916           EMI-COMM-LENGTH,
 17917           DFHEIV99,
 17918           DFHEIV99,
 17919           DFHEIV99,
 17920           DFHEIV99
 17921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17922
 17923
 17924 9900-EXIT.
 17925     EXIT.
 17926
 17927 9990-ABEND.
 17928     MOVE DFHEIBLK               TO EMI-LINE1.
 17929
 17930* EXEC CICS LINK
 17931*         PROGRAM   (XCTL-EL004)
 17932*         COMMAREA  (EMI-LINE1)
 17933*         LENGTH    (72)
 17934*     END-EXEC.
 17935     MOVE 72
 17936       TO DFHEIV11
 17937*    MOVE '."C                   (   #00014751' TO DFHEIV0
 17938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17940     MOVE X'2020233030303134373531' TO DFHEIV0(25:11)
 17941     CALL 'kxdfhei1' USING DFHEIV0,
 17942           XCTL-EL004,
 17943           EMI-LINE1,
 17944           DFHEIV11,
 17945           DFHEIV99,
 17946           DFHEIV99,
 17947           DFHEIV99,
 17948           DFHEIV99
 17949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17950
 17951
 17952     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 336
* EL131.cbl
 17953
 17954     GO TO 8110-SEND-DATA.
 17955
 17956 9995-SECURITY-VIOLATION.
 17957*           COPY ELCSCTP.
 17958******************************************************************
 17959*                                                                *
 17960*                            ELCSCTP                             *
 17961*                            VMOD=2.001                          *
 17962*                                                                *
 17963*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17964******************************************************************
 17965
 17966
 17967     MOVE EIBDATE          TO SM-JUL-DATE.
 17968     MOVE EIBTRMID         TO SM-TERMID.
 17969     MOVE THIS-PGM         TO SM-PGM.
 17970     MOVE EIBTIME          TO TIME-IN.
 17971     MOVE TIME-OUT         TO SM-TIME.
 17972     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17973
 17974
 17975* EXEC CICS LINK
 17976*         PROGRAM  ('EL003')
 17977*         COMMAREA (SECURITY-MESSAGE)
 17978*         LENGTH   (80)
 17979*    END-EXEC.
 17980     MOVE 'EL003' TO DFHEIV1
 17981     MOVE 80
 17982       TO DFHEIV11
 17983*    MOVE '."C                   (   #00014779' TO DFHEIV0
 17984     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17986     MOVE X'2020233030303134373739' TO DFHEIV0(25:11)
 17987     CALL 'kxdfhei1' USING DFHEIV0,
 17988           DFHEIV1,
 17989           SECURITY-MESSAGE,
 17990           DFHEIV11,
 17991           DFHEIV99,
 17992           DFHEIV99,
 17993           DFHEIV99,
 17994           DFHEIV99
 17995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17996
 17997
 17998******************************************************************
 17999
 18000
 18001
 18002 9999-DFHBACK SECTION.
 18003     MOVE '9%                    "   ' TO DFHEIV0
 18004     MOVE 'EL131' TO DFHEIV1
 18005     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18006     GOBACK.
 18007 9999-DFHEXIT.
 18008     IF DFHEIGDJ EQUAL 0001
 18009         NEXT SENTENCE
 18010     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 337
* EL131.cbl
 18011         GO TO 8820-XCTL-ERROR,
 18012               8150-ENTERED-CLAIM-NOTFOUND,
 18013               9990-ABEND
 18014         DEPENDING ON DFHEIGDI
 18015     ELSE IF DFHEIGDJ EQUAL 3
 18016         GO TO 0130-TS-ERROR,
 18017               0130-TS-ERROR
 18018         DEPENDING ON DFHEIGDI
 18019     ELSE IF DFHEIGDJ EQUAL 4
 18020         GO TO 0600-CONTINUE-NAME-UPDATE
 18021         DEPENDING ON DFHEIGDI
 18022     ELSE IF DFHEIGDJ EQUAL 5
 18023         GO TO 1004-BENE-NOT-FOUND
 18024         DEPENDING ON DFHEIGDI
 18025     ELSE IF DFHEIGDJ EQUAL 6
 18026         GO TO 1052-DONE,
 18027               1052-DONE
 18028         DEPENDING ON DFHEIGDI
 18029     ELSE IF DFHEIGDJ EQUAL 7
 18030         GO TO 1120-CNTL-NOTFND
 18031         DEPENDING ON DFHEIGDI
 18032     ELSE IF DFHEIGDJ EQUAL 8
 18033         GO TO 1150-NOTOPEN-ERROR,
 18034               1150-EXIT
 18035         DEPENDING ON DFHEIGDI
 18036     ELSE IF DFHEIGDJ EQUAL 9
 18037         GO TO 1490-STATE-NOTFND
 18038         DEPENDING ON DFHEIGDI
 18039     ELSE IF DFHEIGDJ EQUAL 10
 18040         GO TO 1500-CARR-NOTFND
 18041         DEPENDING ON DFHEIGDI
 18042     ELSE IF DFHEIGDJ EQUAL 11
 18043         GO TO 1620-ACCT-NOTFND
 18044         DEPENDING ON DFHEIGDI
 18045     ELSE IF DFHEIGDJ EQUAL 12
 18046         GO TO 2020-EXIT
 18047         DEPENDING ON DFHEIGDI
 18048     ELSE IF DFHEIGDJ EQUAL 13
 18049         GO TO 2030-EXIT
 18050         DEPENDING ON DFHEIGDI
 18051     ELSE IF DFHEIGDJ EQUAL 14
 18052         GO TO 2040-EXIT
 18053         DEPENDING ON DFHEIGDI
 18054     ELSE IF DFHEIGDJ EQUAL 15
 18055         GO TO 2050-EXIT
 18056         DEPENDING ON DFHEIGDI
 18057     ELSE IF DFHEIGDJ EQUAL 16
 18058         GO TO 2060-CERT-NOTFND
 18059         DEPENDING ON DFHEIGDI
 18060     ELSE IF DFHEIGDJ EQUAL 17
 18061         GO TO 2060-DUPKEY
 18062         DEPENDING ON DFHEIGDI
 18063     ELSE IF DFHEIGDJ EQUAL 18
 18064         GO TO 2070-NOT-FOUND
 18065         DEPENDING ON DFHEIGDI
 18066     ELSE IF DFHEIGDJ EQUAL 19
 18067         GO TO 2070-EXIT
 18068         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 338
* EL131.cbl
 18069     ELSE IF DFHEIGDJ EQUAL 20
 18070         GO TO 2080-EXIT
 18071         DEPENDING ON DFHEIGDI
 18072     ELSE IF DFHEIGDJ EQUAL 21
 18073         GO TO 2400-TRLR-NOTFND,
 18074               2410-EXIT
 18075         DEPENDING ON DFHEIGDI
 18076     ELSE IF DFHEIGDJ EQUAL 22
 18077         GO TO 2425-NINETY-NOTFND,
 18078               2425-NINETY-NOTFND
 18079         DEPENDING ON DFHEIGDI
 18080     ELSE IF DFHEIGDJ EQUAL 23
 18081         GO TO 2430-EXIT,
 18082               2440-EXIT
 18083         DEPENDING ON DFHEIGDI
 18084     ELSE IF DFHEIGDJ EQUAL 24
 18085         GO TO 2440-EXIT
 18086         DEPENDING ON DFHEIGDI
 18087     ELSE IF DFHEIGDJ EQUAL 25
 18088         GO TO 2460-EXIT
 18089         DEPENDING ON DFHEIGDI
 18090     ELSE IF DFHEIGDJ EQUAL 26
 18091         GO TO 2475-EXIT
 18092         DEPENDING ON DFHEIGDI
 18093     ELSE IF DFHEIGDJ EQUAL 27
 18094         GO TO 2650-EXIT
 18095         DEPENDING ON DFHEIGDI
 18096     ELSE IF DFHEIGDJ EQUAL 28
 18097         GO TO 2800-EXIT,
 18098               2800-EXIT
 18099         DEPENDING ON DFHEIGDI
 18100     ELSE IF DFHEIGDJ EQUAL 29
 18101         GO TO 3010-DEL-ACTQ,
 18102               3040-EXIT
 18103         DEPENDING ON DFHEIGDI
 18104     ELSE IF DFHEIGDJ EQUAL 30
 18105         GO TO 3010-NO-ACTIVITY,
 18106               3050-EXIT
 18107         DEPENDING ON DFHEIGDI
 18108     ELSE IF DFHEIGDJ EQUAL 31
 18109         GO TO 3010-CERT-NOT-FOUND
 18110         DEPENDING ON DFHEIGDI
 18111     ELSE IF DFHEIGDJ EQUAL 32
 18112         GO TO 3020-EXIT
 18113         DEPENDING ON DFHEIGDI
 18114     ELSE IF DFHEIGDJ EQUAL 33
 18115         GO TO 3060-EXIT,
 18116               3060-EXIT
 18117         DEPENDING ON DFHEIGDI
 18118     ELSE IF DFHEIGDJ EQUAL 34
 18119         GO TO 5000-TRLR-NOT-FOUND
 18120         DEPENDING ON DFHEIGDI
 18121     ELSE IF DFHEIGDJ EQUAL 35
 18122         GO TO 5000-CERT-NOT-FOUND
 18123         DEPENDING ON DFHEIGDI
 18124     ELSE IF DFHEIGDJ EQUAL 36
 18125         GO TO 1052-DONE,
 18126               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:13 Page 339
* EL131.cbl
 18127         DEPENDING ON DFHEIGDI
 18128     ELSE IF DFHEIGDJ EQUAL 37
 18129         GO TO 7630-END-BROWSE
 18130         DEPENDING ON DFHEIGDI
 18131     ELSE IF DFHEIGDJ EQUAL 38
 18132         GO TO 7799-EXIT,
 18133               7799-EXIT
 18134         DEPENDING ON DFHEIGDI
 18135     ELSE IF DFHEIGDJ EQUAL 39
 18136         GO TO 7799-EXIT
 18137         DEPENDING ON DFHEIGDI
 18138     ELSE IF DFHEIGDJ EQUAL 40
 18139         GO TO 7800-NOT-FOUND
 18140         DEPENDING ON DFHEIGDI
 18141     ELSE IF DFHEIGDJ EQUAL 41
 18142         GO TO 8000-NOTE-NOT-FOUND
 18143         DEPENDING ON DFHEIGDI
 18144     ELSE IF DFHEIGDJ EQUAL 42
 18145         GO TO 8990-SEND-TEXT
 18146         DEPENDING ON DFHEIGDI.
 18147     MOVE '9%                    "   ' TO DFHEIV0
 18148     MOVE 'EL131' TO DFHEIV1
 18149     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18150     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14268     Code:       64134
