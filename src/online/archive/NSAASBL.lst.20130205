* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   1
* NSAASBL.cbl
* Options: int("NSAASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSAASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSAASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSAASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSAASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSAASLTR.cl2
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   2
* NSAASBL.cbl
    14* 071111    2011022800001  PEMA  NEW PROGRAM
    15* 102212    2012101700002  AJRA  EXPAND PASSED AREA
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 DATA DIVISION.
    19 working-storage section.
    20 01  DFH-START PIC X(04).
    21 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    22 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    23 77  S1                          PIC S999 COMP-3 VALUE +0.
    24 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    25 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    26 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    27 01 response-code         pic s9(8) comp.
    28 01 display-response      pic 9(8).
    29 01 bl-index              pic 9(8) comp.
    30 01 max-last-name         pic x(18).
    31 01 first-initial         pic x.
    32 01 name-in-range-flag    pic 9.
    33 01 max-entries           pic s9(8) comp value 100.
    34 01 lower-case    pic x(26) value
    35            "abcdefghijklmnopqrstuvwxyz".
    36 01 upper-case    pic x(26) value
    37            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    38 01  MISC.
    39     12  WS-RESPONSE             PIC S9(8)   COMP.
    40         88  RESP-NORMAL                  VALUE +00.
    41         88  RESP-NOTFND                  VALUE +13.
    42         88  RESP-DUPREC                  VALUE +14.
    43         88  RESP-DUPKEY                  VALUE +15.
    44         88  RESP-NOTOPEN                 VALUE +19.
    45         88  RESP-ENDFILE                 VALUE +20.
    46*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
    47*                         COPY ELCZREC.
    48******************************************************************
    49*                                                                *
    50*                                                                *
    51*                            ELCZREC.                            *
    52*                                                                *
    53*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
    54*                                                                *
    55******************************************************************
    56*-----------------------------------------------------------------
    57*                   C H A N G E   L O G
    58*
    59* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    60*-----------------------------------------------------------------
    61*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    62* EFFECTIVE    NUMBER
    63*-----------------------------------------------------------------
    64* 122011    2011022800001  AJRA  NEW FILE
    65* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    66*-----------------------------------------------------------------
    67 01  W-Z-CONTROL-DATA.
    68     05  W-NUMBER-OF-COPIES      PIC  9.
    69     05  FILLER                  PIC  X.
    70     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
    71     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   3
* NSAASBL.cbl
    72     05  W-DAYS-TO-RESEND        PIC  999.
    73     05  FILLER                  PIC  X.
    74     05  W-FORM-TO-RESEND        PIC  X(4).
    75     05  FILLER                  PIC  X.
    76     05  W-PROMPT-LETTER         PIC  X.
    77     05  FILLER                  PIC  X.
    78     05  W-ENCLOSURE-CD          PIC  XXX.
    79     05  FILLER                  PIC  X.
    80     05  W-AUTO-CLOSE-IND        PIC  X.
    81     05  FILLER                  PIC  X.
    82     05  W-LETTER-TO-BENE        PIC  X.
    83     05  FILLER                  PIC  X.
    84     05  W-LETTER-TO-ACCT        PIC  X.
    85     05  FILLER                  PIC  X.
    86     05  W-LETTER-TYPE           PIC  X.
    87     05  FILLER                  PIC  X.
    88     05  W-PRINT-CERTIFICATE     PIC  X.
    89     05  FILLER                  PIC  X.
    90     05  W-REFUND-REQUIRED       PIC  X.
    91     05  FILLER                  PIC  X.
    92     05  W-ONBASE-CODE           PIC  XX.
    93     05  FILLER                  PIC  X.
    94     05  W-ACCT-SUMM             PIC  X.
    95     05  FILLER                  PIC  X.
    96     05  W-CSO-SUMM              PIC  X.
    97     05  FILLER                  PIC  X(31).
    98 01  WS-ERARCH-KEY.
    99     05  WS-ERARCH-COMPANY-CD    PIC X.
   100     05  WS-ERARCH-ARCH-NO       PIC S9(8) BINARY.
   101 01  WS-ERENDT2-KEY.
   102     05  WS-ERENDT-COMPANY-CD    PIC X.
   103     05  WS-ERENDT-ARCH-NO       PIC 9(8) BINARY.
   104 01  WS-NSASEXTR-KEY.
   105     05  WS-EXTR-COMPANY-CD    PIC X.
   106     05  WS-EXTR-ARCH-NO       PIC 9(8) BINARY.
   107     05  WS-EXTR-SEQ-NO        PIC 9(4) BINARY.
   108 01  WS-ELLETR-KEY.
   109     05  WS-ELLETR-COMPANY-CD    PIC X.
   110     05  WS-ELLETR-LETTER-ID     PIC X(12).
   111     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   112 01 srch-commarea.
   113*                                copy ELCADLTRSPI.
   114******************************************************************
   115*                   C H A N G E   L O G
   116*
   117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   118*-----------------------------------------------------------------
   119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   120* EFFECTIVE    NUMBER
   121*-----------------------------------------------------------------
   122* 060611    2011022800001  PEMA  NEW COPYBOOK
   123* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   124* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   125******************************************************************
   126****************************************
   127*  commarea for NaperSoft On Demand Admin services letters
   128*  (business logic input & output)
   129****************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   4
* NSAASBL.cbl
   130     03  BL-INPUT.
   131         05  BL-DATA-SRCE        PIC X.
   132         05  BL-LETTER-ID        PIC XXXX.
   133         05  BL-CARRIER          PIC X.
   134         05  BL-GROUP            PIC X(6).
   135         05  BL-STATE            PIC XX.
   136         05  BL-ACCOUNT          PIC X(10).
   137         05  BL-EFF-DT           PIC X(10).
   138         05  BL-CERT-NO          PIC X(11).
   139         05  BL-BATCH-NO         PIC X(6).
   140         05  BL-BATCH-SEQ        PIC 9(8).
   141         05  BL-RESP-NO          PIC X(10).
   142         05  BL-NO-OF-COPIES     PIC 99.
   143         05  BL-PROC-ID          PIC XXXX.
   144         05  BL-COMP-ID          PIC XXX.
   145         05  BL-PRINT-NOW-SW     PIC X.
   146         05  BL-ENC-CD           PIC XXX.
   147         05  BL-RESEND-DT        PIC X(10).
   148         05  BL-FOLLOW-UP-DT     PIC X(10).
   149         05  BL-ARCHIVE-NO       PIC 9(8).
   150         05  BL-FUNC             PIC X(8).
   151         05  BL-COMMENTS         PIC X(100).
   152         05  FILLER REDEFINES BL-COMMENTS.
   153             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   154             10  BL-LETTER-TO-ACCT PIC X.
   155             10  BL-LETTER-TO-BENE PIC X.
   156             10  BL-WRITE-ERARCH   PIC X.
   157                 88  ERARCH-QWS      VALUE 'Q'.
   158                 88  ERARCH-BATCH    VALUE 'B'.
   159                 88  ERARCH-TEMP     VALUE 'T'.
   160             10  BL-PROCESS-TYPE PIC X(07).
   161             10  BL-CERT-FORM-ID PIC X(05).
   162             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   163             10  BL-SOURCE-SCREEN PIC X(8).
   164             10  FILLER          PIC X(25).
   165     03  BL-OUTPUT.
   166         05  BL-STATUS                   PIC X.
   167             88  BL-OK                      VALUE "P".
   168             88  BL-FAIL                  VALUE "F".
   169         05  BL-MESSAGE          PIC X(50).
   170     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   171     03  FILLER                  PIC X(31).
   172*                                COPY ELCDATE.
   173******************************************************************
   174*                                                                *
   175*                                                                *
   176*                            ELCDATE.                            *
   177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   178*                            VMOD=2.003
   179*                                                                *
   180*                                                                *
   181*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   182*                 LENGTH = 200                                   *
   183******************************************************************
   184
   185 01  DATE-CONVERSION-DATA.
   186     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   187     12  DC-OPTION-CODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   5
* NSAASBL.cbl
   188         88  BIN-TO-GREG                VALUE ' '.
   189         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   190         88  EDIT-GREG-TO-BIN           VALUE '2'.
   191         88  YMD-GREG-TO-BIN            VALUE '3'.
   192         88  MDY-GREG-TO-BIN            VALUE '4'.
   193         88  JULIAN-TO-BIN              VALUE '5'.
   194         88  BIN-PLUS-ELAPSED           VALUE '6'.
   195         88  FIND-CENTURY               VALUE '7'.
   196         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   197         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   198         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   199         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   200         88  JULIAN-TO-BIN-3            VALUE 'C'.
   201         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   202         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   203         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   204         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   205         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   206         88  CHECK-LEAP-YEAR            VALUE 'H'.
   207         88  BIN-3-TO-GREG              VALUE 'I'.
   208         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   209         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   210         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   211         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   212         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   213         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   214         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   215         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   216         88  THREE-CHARACTER-BIN
   217                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   218         88  GREGORIAN-TO-BIN
   219                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   220         88  BIN-TO-GREGORIAN
   221                  VALUES ' ' '1' 'I' '8' 'G'.
   222         88  JULIAN-TO-BINARY
   223                  VALUES '5' 'C' 'E' 'F'.
   224     12  DC-ERROR-CODE                 PIC X.
   225         88  NO-CONVERSION-ERROR        VALUE ' '.
   226         88  DATE-CONVERSION-ERROR
   227                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   228         88  DATE-IS-ZERO               VALUE '1'.
   229         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   230         88  DATE-IS-INVALID            VALUE '3'.
   231         88  DATE1-GREATER-DATE2        VALUE '4'.
   232         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   233         88  DATE-INVALID-OPTION        VALUE '9'.
   234         88  INVALID-CENTURY            VALUE 'A'.
   235         88  ONLY-CENTURY               VALUE 'B'.
   236         88  ONLY-LEAP-YEAR             VALUE 'C'.
   237         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   238     12  DC-END-OF-MONTH               PIC X.
   239         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   240     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   241         88  USE-NORMAL-PROCESS         VALUE ' '.
   242         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   243         88  ADJUST-UP-100-YRS          VALUE '2'.
   244     12  FILLER                        PIC X.
   245     12  DC-CONVERSION-DATES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   6
* NSAASBL.cbl
   246         16  DC-BIN-DATE-1             PIC XX.
   247         16  DC-BIN-DATE-2             PIC XX.
   248         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   249         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   250                       DC-GREG-DATE-1-EDIT.
   251             20  DC-EDIT1-MONTH        PIC 99.
   252             20  SLASH1-1              PIC X.
   253             20  DC-EDIT1-DAY          PIC 99.
   254             20  SLASH1-2              PIC X.
   255             20  DC-EDIT1-YEAR         PIC 99.
   256         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   257         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   258                     DC-GREG-DATE-2-EDIT.
   259             20  DC-EDIT2-MONTH        PIC 99.
   260             20  SLASH2-1              PIC X.
   261             20  DC-EDIT2-DAY          PIC 99.
   262             20  SLASH2-2              PIC X.
   263             20  DC-EDIT2-YEAR         PIC 99.
   264         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   265         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   266                     DC-GREG-DATE-1-YMD.
   267             20  DC-YMD-YEAR           PIC 99.
   268             20  DC-YMD-MONTH          PIC 99.
   269             20  DC-YMD-DAY            PIC 99.
   270         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   271         16  DC-GREG-DATE-1-MDY-R REDEFINES
   272                      DC-GREG-DATE-1-MDY.
   273             20  DC-MDY-MONTH          PIC 99.
   274             20  DC-MDY-DAY            PIC 99.
   275             20  DC-MDY-YEAR           PIC 99.
   276         16  DC-GREG-DATE-1-ALPHA.
   277             20  DC-ALPHA-MONTH        PIC X(10).
   278             20  DC-ALPHA-DAY          PIC 99.
   279             20  FILLER                PIC XX.
   280             20  DC-ALPHA-CENTURY.
   281                 24 DC-ALPHA-CEN-N     PIC 99.
   282             20  DC-ALPHA-YEAR         PIC 99.
   283         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   284         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   285         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   286         16  DC-JULIAN-DATE            PIC 9(05).
   287         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   288                                       PIC 9(05).
   289         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   290             20  DC-JULIAN-YEAR        PIC 99.
   291             20  DC-JULIAN-DAYS        PIC 999.
   292         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   293         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   294         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   295     12  DATE-CONVERSION-VARIBLES.
   296         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   297         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   298             20  FILLER                PIC 9(3).
   299             20  HOLD-CEN-1-CCYY.
   300                 24  HOLD-CEN-1-CC     PIC 99.
   301                 24  HOLD-CEN-1-YY     PIC 99.
   302             20  HOLD-CEN-1-MO         PIC 99.
   303             20  HOLD-CEN-1-DA         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   7
* NSAASBL.cbl
   304         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   305             20  HOLD-CEN-1-R-MO       PIC 99.
   306             20  HOLD-CEN-1-R-DA       PIC 99.
   307             20  HOLD-CEN-1-R-CCYY.
   308                 24  HOLD-CEN-1-R-CC   PIC 99.
   309                 24  HOLD-CEN-1-R-YY   PIC 99.
   310             20  FILLER                PIC 9(3).
   311         16  HOLD-CENTURY-1-X.
   312             20  FILLER                PIC X(3)  VALUE SPACES.
   313             20  HOLD-CEN-1-X-CCYY.
   314                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   315                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   316             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   317             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   318         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   319             20  HOLD-CEN-1-R-X-MO     PIC XX.
   320             20  HOLD-CEN-1-R-X-DA     PIC XX.
   321             20  HOLD-CEN-1-R-X-CCYY.
   322                 24  HOLD-CEN-1-R-X-CC PIC XX.
   323                 24  HOLD-CEN-1-R-X-YY PIC XX.
   324             20  FILLER                PIC XXX.
   325         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   326         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   327         16  DC-JULIAN-DATE-1          PIC 9(07).
   328         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   329             20  DC-JULIAN-1-CCYY.
   330                 24  DC-JULIAN-1-CC    PIC 99.
   331                 24  DC-JULIAN-1-YR    PIC 99.
   332             20  DC-JULIAN-DA-1        PIC 999.
   333         16  DC-JULIAN-DATE-2          PIC 9(07).
   334         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   335             20  DC-JULIAN-2-CCYY.
   336                 24  DC-JULIAN-2-CC    PIC 99.
   337                 24  DC-JULIAN-2-YR    PIC 99.
   338             20  DC-JULIAN-DA-2        PIC 999.
   339         16  DC-GREG-DATE-A-EDIT.
   340             20  DC-EDITA-MONTH        PIC 99.
   341             20  SLASHA-1              PIC X VALUE '/'.
   342             20  DC-EDITA-DAY          PIC 99.
   343             20  SLASHA-2              PIC X VALUE '/'.
   344             20  DC-EDITA-CCYY.
   345                 24  DC-EDITA-CENT     PIC 99.
   346                 24  DC-EDITA-YEAR     PIC 99.
   347         16  DC-GREG-DATE-B-EDIT.
   348             20  DC-EDITB-MONTH        PIC 99.
   349             20  SLASHB-1              PIC X VALUE '/'.
   350             20  DC-EDITB-DAY          PIC 99.
   351             20  SLASHB-2              PIC X VALUE '/'.
   352             20  DC-EDITB-CCYY.
   353                 24  DC-EDITB-CENT     PIC 99.
   354                 24  DC-EDITB-YEAR     PIC 99.
   355         16  DC-GREG-DATE-CYMD         PIC 9(08).
   356         16  DC-GREG-DATE-CYMD-R REDEFINES
   357                              DC-GREG-DATE-CYMD.
   358             20  DC-CYMD-CEN           PIC 99.
   359             20  DC-CYMD-YEAR          PIC 99.
   360             20  DC-CYMD-MONTH         PIC 99.
   361             20  DC-CYMD-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   8
* NSAASBL.cbl
   362         16  DC-GREG-DATE-MDCY         PIC 9(08).
   363         16  DC-GREG-DATE-MDCY-R REDEFINES
   364                              DC-GREG-DATE-MDCY.
   365             20  DC-MDCY-MONTH         PIC 99.
   366             20  DC-MDCY-DAY           PIC 99.
   367             20  DC-MDCY-CEN           PIC 99.
   368             20  DC-MDCY-YEAR          PIC 99.
   369    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   370        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   371    12  DC-EL310-DATE                  PIC X(21).
   372    12  FILLER                         PIC X(28).
   373*                                COPY ERCARCH.
   374******************************************************************
   375*                                                                *
   376*                            ERCARCH.                            *
   377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   378*                            VMOD=2.002                          *
   379*                                                                *
   380*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
   381*                                                                *
   382*   FILE TYPE = VSAM,KSDS                                        *
   383*   RECORD SIZE = 250  RECFORM = FIXED                           *
   384*                                                                *
   385*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
   386*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
   387*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
   388*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
   389*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
   390*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
   391*                                                                *
   392*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   393******************************************************************
   394*                   C H A N G E   L O G
   395*
   396* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   397*-----------------------------------------------------------------
   398*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   399* EFFECTIVE    NUMBER
   400*-----------------------------------------------------------------
   401* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   402* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
   403* 110612    2012101700002  AJRA  ADD NEW FIELDS
   404******************************************************************
   405 01  LETTER-ARCHIVE.
   406     12  LA-RECORD-ID                PIC  X(02).
   407         88  LA-VALID-ID                VALUE 'LA'.
   408
   409     12  LA-CONTROL-PRIMARY.
   410         16  LA-COMPANY-CD           PIC  X(01).
   411         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
   412
   413     12  LA-CONTROL-BY-CERT-RESP.
   414         16  LA-COMPANY-CD-A2        PIC  X(01).
   415         16  LA-CERT-NO-A2.
   416             20  LA-CERT-PRIME-A2    PIC  X(10).
   417             20  LA-CERT-SUFFIX-A2   PIC  X(01).
   418         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
   419             20  LA-RESP-PERSON-A2   PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page   9
* NSAASBL.cbl
   420             20  LA-TYPE-A2          PIC  X(01).
   421         16  LA-CARRIER-A2           PIC  X(01).
   422         16  LA-GROUPING-A2          PIC  X(06).
   423         16  LA-STATE-A2             PIC  X(02).
   424         16  LA-ACCOUNT-A2           PIC  X(10).
   425         16  LA-EFFECT-DATE-A2       PIC  X(02).
   426         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
   427
   428     12  LA-CONTROL-BY-FORM.
   429         16  LA-COMPANY-CD-A3        PIC  X(01).
   430         16  LA-FORM-A3              PIC  X(04).
   431         16  LA-CARRIER-A3           PIC  X(01).
   432         16  LA-GROUPING-A3          PIC  X(06).
   433         16  LA-STATE-A3             PIC  X(02).
   434         16  LA-ACCOUNT-A3           PIC  X(10).
   435         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
   436
   437     12  LA-CONTROL-BY-PROCESSOR.
   438         16  LA-COMPANY-CD-A4        PIC  X(01).
   439         16  LA-PROCESSOR-CD         PIC  X(04).
   440         16  LA-CARRIER-A4           PIC  X(01).
   441         16  LA-GROUPING-A4          PIC  X(06).
   442         16  LA-STATE-A4             PIC  X(02).
   443         16  LA-ACCOUNT-A4           PIC  X(10).
   444         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
   445
   446     12  LA-CONTROL-BY-KEY-FIELDS.
   447         16  LA-COMPANY-CD-A5        PIC  X(01).
   448         16  LA-CARRIER-A5           PIC  X(01).
   449         16  LA-GROUPING-A5          PIC  X(06).
   450         16  LA-STATE-A5             PIC  X(02).
   451         16  LA-ACCOUNT-A5           PIC  X(10).
   452         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
   453
   454     12  LA-CONTROL-BY-GROUP-CODE.
   455         16  LA-COMPANY-CD-A6        PIC  X(01).
   456         16  LA-ENTRY-A6.
   457             20  LA-FILLER           PIC  X(02).
   458             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
   459         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
   460
   461     12  FILLER                      PIC  X(09).
   462
   463     12  LA-HEADER-RECORD.
   464         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
   465         16  LA-CREATION-DATE        PIC  X(02).
   466         16  LA-FOLLOW-UP-DATE       PIC  X(02).
   467         16  LA-FINAL-ACT-DATE       REDEFINES
   468               LA-FOLLOW-UP-DATE     PIC  X(02).
   469         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
   470         16  LA-NO-OF-COPIES         PIC S9(01).
   471         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
   472         16  LA-REPLY-DATE           PIC  X(02).
   473         16  LA-RESEND-DATES.
   474             20  LA-RESEND-DATE      PIC  X(02).
   475             20  LA-SENT-DATE        PIC  X(02).
   476             20  FILLER              PIC  X(08).
   477         16  LA-SOURCE-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  10
* NSAASBL.cbl
   478             20  LA-DATA-SOURCE      PIC  X(01).
   479             20  LA-ADDR-SOURCE      PIC  X(01).
   480         16  LA-STATUS               PIC  X(01).
   481             88  LA-STATUS-ACTIVE         VALUE 'A'.
   482             88  LA-STATUS-COMPLETED      VALUE 'C'.
   483             88  LA-STATUS-ON-HOLD        VALUE 'H'.
   484             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
   485             88  LA-STATUS-PURGED         VALUE 'P'.
   486             88  LA-STATUS-VOIDED         VALUE 'V'.
   487         16  LA-LAST-RESENT-PRINT-DATE
   488                                     PIC  X(02).
   489         16  LA-PRINT-RESTRICTION    PIC  X(01).
   490             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
   491                                          VALUE 'C'.
   492             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
   493                                          VALUE 'F'.
   494             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
   495                                          VALUE 'P'.
   496         16  LA-PURGED-DATE          PIC  X(02).
   497         16  LA-VOIDED-DATE          PIC  X(02).
   498         16  LA-RESEND-LETR          PIC  X(4).
   499         16  FILLER                  PIC  X(08).
   500*        16  LA-RESEND-LETR-2        PIC  X(4).
   501*        16  LA-RESEND-LETR-3        PIC  X(4).
   502*        16  FILLER                  PIC  X(59).
   503         16  LA-ARCHIVE-STATUS       PIC  X.
   504             88  LA-TEMP                VALUE 'T'.
   505             88  LA-QWS                 VALUE 'Q'.
   506             88  LA-BATCH               VALUE 'B'.
   507         16  LA-FINAL-ACT-IND        PIC  X(1).
   508         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   509         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
   510         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
   511                                     PIC X(4).
   512         16  FILLER                  PIC  X(42).
   513*        16  FILLER                  PIC  X(71).
   514         16  LA-LAST-MAINT-DATE      PIC  X(2).
   515         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   516         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   517                                     PIC  X(4).
   518         16  LA-LAST-UPDATED-BY      PIC  X(4).
   519
   520******************************************************************
   521*                                COPY ERCENDT.
   522******************************************************************
   523*                                                                *
   524*                                                                *
   525*                            ERCENDT.                            *
   526*                            VMOD=2.001                          *
   527*                                                                *
   528*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
   529*                                                                *
   530*   FILE TYPE = VSAM,KSDS                                        *
   531*   RECORD SIZE = 579  RECFORM = FIXED                           *
   532*                                                                *
   533*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
   534*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
   535*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  11
* NSAASBL.cbl
   536*   LOG = NO                                                     *
   537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   538******************************************************************
   539*-----------------------------------------------------------------
   540*                   C H A N G E   L O G
   541*
   542* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   543*-----------------------------------------------------------------
   544*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   545* EFFECTIVE    NUMBER
   546*-----------------------------------------------------------------
   547* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
   548*                                WITH OPEN CLAIMS
   549* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
   550* 110612    2012101700002  AJRA  ADD NEW FIELDS
   551*-----------------------------------------------------------------
   552 01  ENDORSEMENT-RECORD.
   553     12  EN-RECORD-ID                PIC XX.
   554         88  VALID-EN-ID                VALUE 'EN'.
   555     12  EN-CONTROL-PRIMARY.
   556         16  EN-COMPANY-CD           PIC X.
   557         16  EN-CARRIER              PIC X.
   558         16  EN-GROUPING             PIC X(6).
   559         16  EN-STATE                PIC XX.
   560         16  EN-ACCOUNT              PIC X(10).
   561         16  EN-CERT-EFF-DT          PIC XX.
   562         16  EN-CERT-NO.
   563             20  EN-CERT-PRIME       PIC X(10).
   564             20  EN-CERT-SFX         PIC X.
   565         16  EN-REC-TYPE             PIC X.
   566             88  EN-ISSUE               VALUE 'I'.
   567             88  EN-CANCELLATION        VALUE 'C'.
   568         16  EN-SEQ-NO               PIC 9(04) BINARY.
   569     12  EN-CONTROL-BY-ARCH-NO.
   570         16  EN-COMPANY-CD-A1              PIC X.
   571         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
   572     12  EN-LAST-MAINT-DT            PIC XX.
   573     12  EN-LAST-MAINT-BY            PIC X(4).
   574     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
   575     12  EN-ENDORSEMENT-RECORD       PIC X(329).
   576     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
   577         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
   578         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
   579         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
   580         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
   581         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
   582         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
   583         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
   584         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
   585         16  EN-LF-ORIG-BENCD        PIC XX.
   586         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
   587         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
   588         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
   589         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   590         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   591         16  EN-LF-ORIG-EXP-DT       PIC XX.
   592*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
   593         16  EN-ORIG-CRED-BENE       PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  12
* NSAASBL.cbl
   594         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
   595         16  FILLER                  PIC X.
   596         16  EN-AH-ORIG-BENCD        PIC XX.
   597         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
   598         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
   599         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
   600         16  EN-AH-ORIG-EXP-DT       PIC XX.
   601*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
   602*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
   603         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
   604         16  F                       PIC X(09).
   605         16  EN-AH-ORIG-CP           PIC 99.
   606         16  EN-INS-NEW-LAST-NAME    PIC X(15).
   607         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
   608         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
   609         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
   610         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
   611         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
   612         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
   613         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
   614         16  EN-LF-NEW-BENCD         PIC XX.
   615         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
   616         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
   617         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
   618         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
   619         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
   620         16  EN-LF-NEW-EXP-DT        PIC XX.
   621         16  EN-NEW-CRED-BENE        PIC X(25).
   622         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
   623         16  FILLER                  PIC X.
   624         16  EN-AH-NEW-BENCD         PIC XX.
   625         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
   626         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
   627         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
   628         16  EN-AH-NEW-EXP-DT        PIC XX.
   629*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
   630*        16  EN-AH-NEW-WAIT-PER      PIC 99.
   631*        16  F                       PIC X(12).
   632         16  EN-AH-NEW-CP            PIC 99.
   633         16  EN-SIG-SW               PIC X.
   634         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
   635         16  FILLER                  PIC X(37).
   636     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
   637         16  EN-LF-ORIG-REF-DT       PIC XX.
   638         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
   639         16  EN-AH-ORIG-REF-DT       PIC XX.
   640         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
   641         16  EN-LF-NEW-REF-DT        PIC XX.
   642         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
   643         16  EN-AH-NEW-REF-DT        PIC XX.
   644         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
   645         16  EN-FLAG-CERT            PIC X.
   646         16  EN-INS-LAST-NAME        PIC X(15).
   647         16  EN-INS-FIRST-NAME       PIC X(10).
   648         16  EN-INS-MIDDLE-INIT      PIC X.
   649         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
   650         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
   651         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  13
* NSAASBL.cbl
   652         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
   653         16  FILLER                  PIC X(262).
   654     12  EN-MONEY-SW             PIC X.
   655     12  EN-HEALTH-APP           PIC X.
   656     12  EN-VOUCHER-SW           PIC X.
   657     12  EN-PAYEE                PIC X(14).
   658     12  EN-INPUT-DT             PIC XX.
   659     12  EN-PROCESS-DT           PIC XX.
   660     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
   661     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
   662     12  EN-REASON-CODES.
   663         16  F OCCURS 12.
   664             20  EN-REASON-CODE  PIC X(4).
   665     12  EN-TEMPLATE-USED        PIC X(8).
   666     12  EN-DOCU-TYPE            PIC X.
   667         88  EN-VERI-DOCU          VALUE 'V'.
   668         88  EN-GCE-DOCU           VALUE 'G'.
   669         88  EN-CANC-DOCU          VALUE 'C'.
   670     12  EN-COMMENTS1            PIC X(13).
   671     12  EN-COMMENTS2            PIC X(70).
   672     12  EN-COMM-CHGBK           PIC X.
   673         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
   674         88  EN-CHG-ACCT           VALUE 'Y'.
   675     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
   676     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
   677     12  EN-BATCH-NUMBER         PIC X(6).
   678     12  EN-ACCT-SUMM            PIC X.
   679     12  EN-CSO-SUMM             PIC X.
   680     12  FILLER                  PIC X(13).
   681******************************************************************
   682*                                COPY NSCASEXTR.
   683******************************************************************
   684*                                                                *
   685*                                                                *
   686*                            NSCASEXTR.                          *
   687*                            VMOD=2.001                          *
   688*                                                                *
   689*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   690*                                                                *
   691*   FILE TYPE = VSAM,KSDS                                        *
   692*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   693*                                                                *
   694*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   695*                                                                *
   696*   LOG = NO                                                     *
   697*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   698******************************************************************
   699*-----------------------------------------------------------------
   700*                   C H A N G E   L O G
   701*
   702* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   703*-----------------------------------------------------------------
   704*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   705* EFFECTIVE    NUMBER
   706*-----------------------------------------------------------------
   707* 072211    2011022800001  PEMA  NEW FILE
   708*-----------------------------------------------------------------
   709 01 NSAS-EXTRACT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  14
* NSAASBL.cbl
   710    05  NSAS-CONTROL-PRIMARY.
   711        10  NSAS-COMPANY-CD      PIC X.
   712        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   713        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   714    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   715    05  FILLER                   PIC X(143).
   716****************************************************************
   717*
   718* Copyright (c) 2007 by Clerity Solutions, Inc.
   719* All rights reserved.
   720*
   721****************************************************************
   722 01  DFHEIV.
   723   02  DFHEIV0               PIC X(35).
   724   02  DFHEIV1               PIC X(08).
   725   02  DFHEIV2               PIC X(08).
   726   02  DFHEIV3               PIC X(08).
   727   02  DFHEIV4               PIC X(06).
   728   02  DFHEIV5               PIC X(04).
   729   02  DFHEIV6               PIC X(04).
   730   02  DFHEIV7               PIC X(02).
   731   02  DFHEIV8               PIC X(02).
   732   02  DFHEIV9               PIC X(01).
   733   02  DFHEIV10              PIC S9(7) COMP-3.
   734   02  DFHEIV11              PIC S9(4) COMP SYNC.
   735   02  DFHEIV12              PIC S9(4) COMP SYNC.
   736   02  DFHEIV13              PIC S9(4) COMP SYNC.
   737   02  DFHEIV14              PIC S9(4) COMP SYNC.
   738   02  DFHEIV15              PIC S9(4) COMP SYNC.
   739   02  DFHEIV16              PIC S9(9) COMP SYNC.
   740   02  DFHEIV17              PIC X(04).
   741   02  DFHEIV18              PIC X(04).
   742   02  DFHEIV19              PIC X(04).
   743   02  DFHEIV20              USAGE IS POINTER.
   744   02  DFHEIV21              USAGE IS POINTER.
   745   02  DFHEIV22              USAGE IS POINTER.
   746   02  DFHEIV23              USAGE IS POINTER.
   747   02  DFHEIV24              USAGE IS POINTER.
   748   02  DFHEIV25              PIC S9(9) COMP SYNC.
   749   02  DFHEIV26              PIC S9(9) COMP SYNC.
   750   02  DFHEIV27              PIC S9(9) COMP SYNC.
   751   02  DFHEIV28              PIC S9(9) COMP SYNC.
   752   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   753   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   754   02  FILLER                PIC X(02).
   755   02  DFHEIV99              PIC X(08) VALUE SPACE.
   756   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   757   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   758   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   759   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   760 LINKAGE  SECTION.
   761*****************************************************************
   762*                                                               *
   763* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   764* All rights reserved.                                          *
   765*                                                               *
   766*****************************************************************
   767 01  dfheiblk.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  15
* NSAASBL.cbl
   768     02  eibtime          pic s9(7) comp-3.
   769     02  eibdate          pic s9(7) comp-3.
   770     02  eibtrnid         pic x(4).
   771     02  eibtaskn         pic s9(7) comp-3.
   772     02  eibtrmid         pic x(4).
   773     02  dfheigdi         pic s9(4) comp.
   774     02  eibcposn         pic s9(4) comp.
   775     02  eibcalen         pic s9(4) comp.
   776     02  eibaid           pic x(1).
   777     02  eibfiller1       pic x(1).
   778     02  eibfn            pic x(2).
   779     02  eibfiller2       pic x(2).
   780     02  eibrcode         pic x(6).
   781     02  eibfiller3       pic x(2).
   782     02  eibds            pic x(8).
   783     02  eibreqid         pic x(8).
   784     02  eibrsrce         pic x(8).
   785     02  eibsync          pic x(1).
   786     02  eibfree          pic x(1).
   787     02  eibrecv          pic x(1).
   788     02  eibsend          pic x(1).
   789     02  eibatt           pic x(1).
   790     02  eibeoc           pic x(1).
   791     02  eibfmh           pic x(1).
   792     02  eibcompl         pic x(1).
   793     02  eibsig           pic x(1).
   794     02  eibconf          pic x(1).
   795     02  eiberr           pic x(1).
   796     02  eibrldbk         pic x(1).
   797     02  eiberrcd         pic x(4).
   798     02  eibsynrb         pic x(1).
   799     02  eibnodat         pic x(1).
   800     02  eibfiller5       pic x(2).
   801     02  eibresp          pic 9(09) comp.
   802     02  eibresp2         pic 9(09) comp.
   803     02  dfheigdj         pic s9(4) comp.
   804     02  dfheigdk         pic s9(4) comp.
   805 01 dfhcommarea                  pic x(218).
   806 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   807 0000-DFHEXIT SECTION.
   808     MOVE '9#                    $   ' TO DFHEIV0.
   809     MOVE 'NSAASBL' TO DFHEIV1.
   810     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   811     display ' entering nsaasbl '
   812     MOVE EIBDATE                TO DC-JULIAN-YYDDD
   813     MOVE '5'                    TO DC-OPTION-CODE
   814     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
   815     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
   816     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
   817     MOVE DFHCOMMAREA            TO BL-INPUT
   818*****************************************************
   819* Using the information passed to this program,
   820* it will update the erarch record with a "Q"
   821* in the status field
   822*****************************************************
   823*    DISPLAY ' BL INPUT ' BL-INPUT
   824     IF BL-COMP-ID = 'DCC'
   825        MOVE X'05'               TO WS-ERARCH-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  16
* NSAASBL.cbl
   826     ELSE
   827        IF BL-COMP-ID = 'AHL'
   828           MOVE X'06'               TO WS-ERARCH-COMPANY-CD
   829        ELSE
   830           MOVE X'04'               TO WS-ERARCH-COMPANY-CD
   831        END-IF
   832     END-IF
   833     MOVE WS-ERARCH-COMPANY-CD   TO WS-ERENDT-COMPANY-CD
   834                                    WS-EXTR-COMPANY-CD
   835     MOVE BL-ARCHIVE-NO          TO WS-ERARCH-ARCH-NO
   836                                    WS-ERENDT-ARCH-NO
   837                                    WS-EXTR-ARCH-NO
   838     SET BL-FAIL TO TRUE
   839
   840* EXEC CICS READ
   841*         DATASET    ('ERARCH')
   842*         INTO       (LETTER-ARCHIVE)
   843*         RIDFLD     (WS-ERARCH-KEY)
   844*         UPDATE
   845*         RESP       (WS-RESPONSE)
   846*    END-EXEC
   847     MOVE LENGTH OF
   848      LETTER-ARCHIVE
   849       TO DFHEIV11
   850     MOVE 'ERARCH' TO DFHEIV1
   851*    MOVE '&"IL       EU         (  N#00000835' TO DFHEIV0
   852     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
   853     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
   854     MOVE X'204E233030303030383335' TO DFHEIV0(25:11)
   855     CALL 'kxdfhei1' USING DFHEIV0,
   856           DFHEIV1,
   857           LETTER-ARCHIVE,
   858           DFHEIV11,
   859           WS-ERARCH-KEY,
   860           DFHEIV99,
   861           DFHEIV99,
   862           DFHEIV99
   863     MOVE EIBRESP  TO WS-RESPONSE
   864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   865     IF RESP-NORMAL
   866        SET BL-OK TO TRUE
   867        IF (BL-PRINT-NOW-SW = 'P')
   868           or (bl-process-type = 'cancel')
   869           PERFORM 0050-DELETE-RECORDS
   870                                 THRU 0050-EXIT
   871        ELSE
   872           IF BL-PROCESS-TYPE = 'process'
   873              MOVE 'Q'           TO LA-ARCHIVE-STATUS
   874              IF BL-PRINT-NOW-SW = 'Y'
   875                 MOVE SAVE-BIN-DATE TO LA-INITIAL-PRINT-DATE
   876                 IF (LA-RESEND-DATE EQUAL LOW-VALUES OR SPACES)
   877                  AND (LA-FOLLOW-UP-DATE EQUAL
   878                                 LOW-VALUES OR SPACES)
   879                    MOVE 'C'             TO LA-STATUS
   880                 END-IF
   881              END-IF
   882           ELSE
   883              MOVE 'T'           TO LA-ARCHIVE-STATUS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  17
* NSAASBL.cbl
   884           END-IF
   885        END-IF
   886
   887* EXEC CICS REWRITE
   888*          FROM      (LETTER-ARCHIVE)
   889*          DATASET   ('ERARCH')
   890*          RESP       (WS-RESPONSE)
   891*       END-EXEC
   892     MOVE LENGTH OF
   893      LETTER-ARCHIVE
   894       TO DFHEIV11
   895     MOVE 'ERARCH' TO DFHEIV1
   896*    MOVE '&& L                  %  N#00000863' TO DFHEIV0
   897     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
   898     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
   899     MOVE X'204E233030303030383633' TO DFHEIV0(25:11)
   900     CALL 'kxdfhei1' USING DFHEIV0,
   901           DFHEIV1,
   902           LETTER-ARCHIVE,
   903           DFHEIV11,
   904           DFHEIV99
   905     MOVE EIBRESP  TO WS-RESPONSE
   906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   907     ELSE
   908        MOVE ' BAD READ UPDATE ON ERARCH '
   909                                 TO BL-MESSAGE
   910        display ' bad read on erarch ' ws-response
   911          ' ' bl-archive-no
   912     END-IF
   913     MOVE BL-INPUT               TO DFHCOMMAREA
   914
   915* exec cics return end-exec.
   916*    MOVE '.(                    ''   #00000875' TO DFHEIV0
   917     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   918     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   919     MOVE X'2020233030303030383735' TO DFHEIV0(25:11)
   920     CALL 'kxdfhei1' USING DFHEIV0,
   921           DFHEIV99,
   922           DFHEIV99,
   923           DFHEIV99,
   924           DFHEIV99,
   925           DFHEIV99,
   926           DFHEIV99
   927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   928
   929 0050-DELETE-RECORDS.
   930     DISPLAY ' ABOUT TO DELETE RECS ' BL-ARCHIVE-NO ' ' BL-FUNC
   931     IF BL-FUNC = 'ClmResc' or 'ClmRefo'
   932        display ' bypass delete ' bl-func
   933        go to 0050-exit
   934     end-if
   935
   936* EXEC CICS DELETE
   937*       DATASET    ('ERARCH')
   938*       RESP       (WS-RESPONSE)
   939*    END-EXEC
   940     MOVE 'ERARCH' TO DFHEIV1
   941*    MOVE '&(                    &  N#00000882' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  18
* NSAASBL.cbl
   942     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
   943     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   944     MOVE X'204E233030303030383832' TO DFHEIV0(25:11)
   945     CALL 'kxdfhei1' USING DFHEIV0,
   946           DFHEIV1,
   947           DFHEIV99,
   948           DFHEIV99,
   949           DFHEIV99,
   950           DFHEIV99
   951     MOVE EIBRESP  TO WS-RESPONSE
   952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   953     IF NOT RESP-NORMAL
   954        DISPLAY ' BAD DELETE ERARCH ' WS-RESPONSE
   955        GO TO 0050-EXIT
   956     END-IF
   957
   958* EXEC CICS READ
   959*         DATASET    ('ERENDT2')
   960*         INTO       (ENDORSEMENT-RECORD)
   961*         RIDFLD     (WS-ERENDT2-KEY)
   962*         UPDATE
   963*         RESP       (WS-RESPONSE)
   964*    END-EXEC
   965     MOVE LENGTH OF
   966      ENDORSEMENT-RECORD
   967       TO DFHEIV11
   968     MOVE 'ERENDT2' TO DFHEIV1
   969*    MOVE '&"IL       EU         (  N#00000890' TO DFHEIV0
   970     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
   971     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
   972     MOVE X'204E233030303030383930' TO DFHEIV0(25:11)
   973     CALL 'kxdfhei1' USING DFHEIV0,
   974           DFHEIV1,
   975           ENDORSEMENT-RECORD,
   976           DFHEIV11,
   977           WS-ERENDT2-KEY,
   978           DFHEIV99,
   979           DFHEIV99,
   980           DFHEIV99
   981     MOVE EIBRESP  TO WS-RESPONSE
   982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   983     IF NOT RESP-NORMAL
   984        DISPLAY ' BAD READ ON ERENDT2 ' WS-RESPONSE
   985     ELSE
   986
   987* EXEC CICS DELETE
   988*          DATASET    ('ERENDT2')
   989*          RESP       (WS-RESPONSE)
   990*       END-EXEC
   991     MOVE 'ERENDT2' TO DFHEIV1
   992*    MOVE '&(                    &  N#00000900' TO DFHEIV0
   993     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
   994     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   995     MOVE X'204E233030303030393030' TO DFHEIV0(25:11)
   996     CALL 'kxdfhei1' USING DFHEIV0,
   997           DFHEIV1,
   998           DFHEIV99,
   999           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  19
* NSAASBL.cbl
  1000           DFHEIV99,
  1001           DFHEIV99
  1002     MOVE EIBRESP  TO WS-RESPONSE
  1003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1004        IF NOT RESP-NORMAL
  1005           DISPLAY ' BAD DELETE ON ERENDT2 ' WS-RESPONSE
  1006        END-IF
  1007     END-IF
  1008     MOVE 0                      TO WS-EXTR-SEQ-NO
  1009
  1010* EXEC CICS READ
  1011*         DATASET    ('NSASEXTR')
  1012*         INTO       (NSAS-EXTRACT-RECORD)
  1013*         RIDFLD     (WS-NSASEXTR-KEY)
  1014*         UPDATE
  1015*         RESP       (WS-RESPONSE)
  1016*    END-EXEC
  1017     MOVE LENGTH OF
  1018      NSAS-EXTRACT-RECORD
  1019       TO DFHEIV11
  1020     MOVE 'NSASEXTR' TO DFHEIV1
  1021*    MOVE '&"IL       EU         (  N#00000909' TO DFHEIV0
  1022     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1023     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1024     MOVE X'204E233030303030393039' TO DFHEIV0(25:11)
  1025     CALL 'kxdfhei1' USING DFHEIV0,
  1026           DFHEIV1,
  1027           NSAS-EXTRACT-RECORD,
  1028           DFHEIV11,
  1029           WS-NSASEXTR-KEY,
  1030           DFHEIV99,
  1031           DFHEIV99,
  1032           DFHEIV99
  1033     MOVE EIBRESP  TO WS-RESPONSE
  1034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1035     IF NOT RESP-NORMAL
  1036        DISPLAY ' BAD READ ON 0 NSASEXTR ' WS-RESPONSE
  1037        GO TO 0050-EXIT
  1038     ELSE
  1039
  1040* EXEC CICS DELETE
  1041*          DATASET    ('NSASEXTR')
  1042*          RESP       (WS-RESPONSE)
  1043*       END-EXEC
  1044     MOVE 'NSASEXTR' TO DFHEIV1
  1045*    MOVE '&(                    &  N#00000920' TO DFHEIV0
  1046     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1047     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1048     MOVE X'204E233030303030393230' TO DFHEIV0(25:11)
  1049     CALL 'kxdfhei1' USING DFHEIV0,
  1050           DFHEIV1,
  1051           DFHEIV99,
  1052           DFHEIV99,
  1053           DFHEIV99,
  1054           DFHEIV99
  1055     MOVE EIBRESP  TO WS-RESPONSE
  1056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1057        IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  20
* NSAASBL.cbl
  1058           DISPLAY ' BAD DELETE ON 0 NSASEXTR ' WS-RESPONSE
  1059           GO TO 0050-EXIT
  1060        END-IF
  1061     END-IF
  1062     MOVE 1                      TO WS-EXTR-SEQ-NO
  1063
  1064* EXEC CICS READ
  1065*         DATASET    ('NSASEXTR')
  1066*         INTO       (NSAS-EXTRACT-RECORD)
  1067*         RIDFLD     (WS-NSASEXTR-KEY)
  1068*         UPDATE
  1069*         RESP       (WS-RESPONSE)
  1070*    END-EXEC
  1071     MOVE LENGTH OF
  1072      NSAS-EXTRACT-RECORD
  1073       TO DFHEIV11
  1074     MOVE 'NSASEXTR' TO DFHEIV1
  1075*    MOVE '&"IL       EU         (  N#00000930' TO DFHEIV0
  1076     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1077     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1078     MOVE X'204E233030303030393330' TO DFHEIV0(25:11)
  1079     CALL 'kxdfhei1' USING DFHEIV0,
  1080           DFHEIV1,
  1081           NSAS-EXTRACT-RECORD,
  1082           DFHEIV11,
  1083           WS-NSASEXTR-KEY,
  1084           DFHEIV99,
  1085           DFHEIV99,
  1086           DFHEIV99
  1087     MOVE EIBRESP  TO WS-RESPONSE
  1088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1089     IF NOT RESP-NORMAL
  1090        DISPLAY ' BAD READ ON 1 NSASEXTR ' WS-RESPONSE
  1091     ELSE
  1092
  1093* EXEC CICS DELETE
  1094*          DATASET    ('NSASEXTR')
  1095*          RESP       (WS-RESPONSE)
  1096*       END-EXEC
  1097     MOVE 'NSASEXTR' TO DFHEIV1
  1098*    MOVE '&(                    &  N#00000940' TO DFHEIV0
  1099     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1100     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1101     MOVE X'204E233030303030393430' TO DFHEIV0(25:11)
  1102     CALL 'kxdfhei1' USING DFHEIV0,
  1103           DFHEIV1,
  1104           DFHEIV99,
  1105           DFHEIV99,
  1106           DFHEIV99,
  1107           DFHEIV99
  1108     MOVE EIBRESP  TO WS-RESPONSE
  1109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1110        IF NOT RESP-NORMAL
  1111           DISPLAY ' BAD DELETE ON 1 NSASEXTR ' WS-RESPONSE
  1112        END-IF
  1113     END-IF
  1114     MOVE 2                      TO WS-EXTR-SEQ-NO
  1115
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  21
* NSAASBL.cbl
  1116* EXEC CICS READ
  1117*         DATASET    ('NSASEXTR')
  1118*         INTO       (NSAS-EXTRACT-RECORD)
  1119*         RIDFLD     (WS-NSASEXTR-KEY)
  1120*         UPDATE
  1121*         RESP       (WS-RESPONSE)
  1122*    END-EXEC
  1123     MOVE LENGTH OF
  1124      NSAS-EXTRACT-RECORD
  1125       TO DFHEIV11
  1126     MOVE 'NSASEXTR' TO DFHEIV1
  1127*    MOVE '&"IL       EU         (  N#00000949' TO DFHEIV0
  1128     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1129     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1130     MOVE X'204E233030303030393439' TO DFHEIV0(25:11)
  1131     CALL 'kxdfhei1' USING DFHEIV0,
  1132           DFHEIV1,
  1133           NSAS-EXTRACT-RECORD,
  1134           DFHEIV11,
  1135           WS-NSASEXTR-KEY,
  1136           DFHEIV99,
  1137           DFHEIV99,
  1138           DFHEIV99
  1139     MOVE EIBRESP  TO WS-RESPONSE
  1140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1141     IF NOT RESP-NORMAL
  1142        DISPLAY ' BAD READ ON 2 NSASEXTR ' WS-RESPONSE
  1143     ELSE
  1144
  1145* EXEC CICS DELETE
  1146*          DATASET    ('NSASEXTR')
  1147*          RESP       (WS-RESPONSE)
  1148*       END-EXEC
  1149     MOVE 'NSASEXTR' TO DFHEIV1
  1150*    MOVE '&(                    &  N#00000959' TO DFHEIV0
  1151     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1152     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1153     MOVE X'204E233030303030393539' TO DFHEIV0(25:11)
  1154     CALL 'kxdfhei1' USING DFHEIV0,
  1155           DFHEIV1,
  1156           DFHEIV99,
  1157           DFHEIV99,
  1158           DFHEIV99,
  1159           DFHEIV99
  1160     MOVE EIBRESP  TO WS-RESPONSE
  1161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1162        IF NOT RESP-NORMAL
  1163           DISPLAY ' BAD DELETE ON 2 NSASEXTR ' WS-RESPONSE
  1164        END-IF
  1165     END-IF
  1166     .
  1167 0050-EXIT.
  1168     EXIT.
  1169 9700-DATE-LINK.
  1170
  1171* EXEC CICS LINK
  1172*        PROGRAM   ('ELDATCV')
  1173*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:06 Page  22
* NSAASBL.cbl
  1174*        LENGTH    (DC-COMM-LENGTH)
  1175*    END-EXEC.
  1176     MOVE 'ELDATCV' TO DFHEIV1
  1177*    MOVE '."C                   (   #00000971' TO DFHEIV0
  1178     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1180     MOVE X'2020233030303030393731' TO DFHEIV0(25:11)
  1181     CALL 'kxdfhei1' USING DFHEIV0,
  1182           DFHEIV1,
  1183           DATE-CONVERSION-DATA,
  1184           DC-COMM-LENGTH,
  1185           DFHEIV99,
  1186           DFHEIV99,
  1187           DFHEIV99,
  1188           DFHEIV99
  1189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1190
  1191 9700-EXIT.
  1192      EXIT.
  1193
  1194 9999-DFHBACK SECTION.
  1195     MOVE '9%                    "   ' TO DFHEIV0
  1196     MOVE 'NSAASBL' TO DFHEIV1
  1197     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1198     GOBACK.
  1199 9999-DFHEXIT.
  1200     IF DFHEIGDJ EQUAL 0001
  1201         NEXT SENTENCE.
  1202     MOVE '9%                    "   ' TO DFHEIV0
  1203     MOVE 'NSAASBL' TO DFHEIV1
  1204     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1205     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13296     Code:        3235
