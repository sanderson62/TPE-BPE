* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
    68* 082218  CR2018051400001  TANA  Hold and Pay
    69* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    70******************************************************************
    71
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   3
* EL156.cbl
    73 ENVIRONMENT DIVISION.
    74
    75 DATA DIVISION.
    76
    77 WORKING-STORAGE SECTION.
    78 01  DFH-START PIC X(04).
    79
    80 77  FILLER  PIC X(32)  VALUE '********************************'.
    81 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    82 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    83 77  WS-SSN  PIC X(9) VALUE ZEROS.
    84 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    85 77  C0                          PIC S999 COMP-3 VALUE +0.
    86 77  C1                          PIC S999 COMP-3 VALUE +0.
    87 77  C2                          PIC S999 COMP-3 VALUE +0.
    88 77  C3                          PIC S999 COMP-3 VALUE +0.
    89 77  s1                          PIC S999 COMP-3 VALUE +0.
    90 77  s2                          pic s999 comp-3 value +0.
    91 77  P1                          PIC S999 COMP-3 VALUE +0.
    92 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    93 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    94 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    95 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    96 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    97 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    98 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    99 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   100 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
   101 77  ws-max-bens                 pic s999 comp-3 value +0.
   102 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   103 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   104 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   105 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   106 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   107 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   108
   109*    COPY ELCSCTM.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCTM                             *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   117*                                                                *
   118******************************************************************
   119 01  SECURITY-MESSAGE.
   120     12  FILLER                          PIC X(30)
   121            VALUE '** LOGIC SECURITY VIOLATION -'.
   122     12  SM-READ                         PIC X(6).
   123     12  FILLER                          PIC X(5)
   124            VALUE ' PGM='.
   125     12  SM-PGM                          PIC X(6).
   126     12  FILLER                          PIC X(5)
   127            VALUE ' OPR='.
   128     12  SM-PROCESSOR-ID                 PIC X(4).
   129     12  FILLER                          PIC X(6)
   130            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   4
* EL156.cbl
   131     12  SM-TERMID                       PIC X(4).
   132     12  FILLER                          PIC XX   VALUE SPACE.
   133     12  SM-JUL-DATE                     PIC 9(5).
   134     12  FILLER                          PIC X    VALUE SPACE.
   135     12  SM-TIME                         PIC 99.99.
   136
   137
   138*    COPY ELCSCRTY.
   139******************************************************************
   140*                                                                *
   141*                                                                *
   142*                            ELCSCRTY                            *
   143*                            VMOD=2.001                          *
   144*                                                                *
   145*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   146*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   147*        SAVED IN PI-SECURITY-ADDRESS.                           *
   148*                                                                *
   149******************************************************************
   150 01  SECURITY-CONTROL.
   151     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   152     12  FILLER                       PIC XX    VALUE 'SC'.
   153     12  SC-CREDIT-CODES.
   154         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   155             20  SC-CREDIT-DISPLAY    PIC X.
   156             20  SC-CREDIT-UPDATE     PIC X.
   157     12  SC-CLAIMS-CODES.
   158         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   159             20  SC-CLAIMS-DISPLAY    PIC X.
   160             20  SC-CLAIMS-UPDATE     PIC X.
   161
   162 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   163 01  WS-DATE-AREA.
   164     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   165     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   166     12  SAVE-DATE-CCYYMMDD.
   167         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   168         16  SAVE-DATE-YMD.
   169             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   170             20  FILLER              PIC X(04)   VALUE SPACES.
   171
   172 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   173 01  STANDARD-AREAS.
   174     12  WS-RESPONSE         PIC S9(8)   COMP.
   175         88  WS-RESP-NORMAL              VALUE +00.
   176         88  WS-RESP-ERROR               VALUE +01.
   177         88  WS-RESP-NOTFND              VALUE +13.
   178         88  WS-RESP-DUPREC              VALUE +14.
   179         88  WS-RESP-ENDFILE             VALUE +20.
   180     12  PMT-HEAD-A.
   181         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   182         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   183         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   184-        '     RESERVES  TYPE    AMOUNT'.
   185     12  PMT-HEAD-B.
   186         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   187         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   188         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   5
* EL156.cbl
   189     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   190     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   191     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   192     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   193     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   194     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   195     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   196     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   197     12  PGM-NAME            PIC X(8).
   198     12  TIME-IN             PIC S9(7).
   199     12  TIME-OUT-R  REDEFINES TIME-IN.
   200         16  FILLER          PIC X.
   201         16  TIME-OUT        PIC 99V99.
   202         16  FILLER          PIC XX.
   203     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   204     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   205     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   206     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   207     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   208     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   209     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   210     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   211     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   212     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   213     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   214     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   215     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   216     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   217     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   218     12  WS-BLANK            PIC X       VALUE ' '.
   219
   220 01  MISC-WORK-AREAS.
   221     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   222     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   223     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   224     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   225     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   226     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   227     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   228     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   229     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   230     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   231     12  W-CALLED-NAME           PIC X(08).
   232     12  W-EOB-CODES.
   233         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   234             20  W-EOB-CODE      PIC XXX.
   235             20  W-EOB-FILLER    PIC X.
   236     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   237     12  W-NAME-LAST             PIC X(15).
   238     12  W-NAME-FIRST            PIC X(15).
   239     12  W-NAME-MIDDLE.
   240         16  FILLER              PIC X.
   241         16  W-NAME-MIDDLE-2     PIC X.
   242         16  FILLER              PIC X(13).
   243     12  W-DMD-CHECK-NO.
   244         16  W-DMD-CHECK-NO-1    PIC X(4).
   245         16  W-DMD-CHECK-NO-2    PIC X.
   246         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   6
* EL156.cbl
   247
   248     12  WS-COMPUTE-FROM-DT  PIC XX.
   249     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   250     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   251     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   252     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   253     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   254     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   255         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   256         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   257     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   258         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   259     12  WS-UPDATE-SW        PIC X VALUE ' '.
   260     12  WS-GROUPING.
   261         16  WS-GROUP-1      PIC X VALUE SPACES.
   262         16  FILLER          PIC X(05) VALUE SPACES.
   263     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   264     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   265     12  WS-WORK-STATE-ACCT.
   266         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   267         16  FILLER          PIC X       VALUE '/'.
   268         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   269     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   270     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   271     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   272     12  QID.
   273         16  QID-TERM        PIC X(4)    VALUE SPACES.
   274         16  FILLER          PIC X(4)    VALUE '156A'.
   275     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   276     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   277     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   278     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   279     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   280     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   281     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   282     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   283     12  WS-STATUS           PIC X       VALUE SPACES.
   284     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   285     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   286     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   287     12  ws-extended-exp-dt  pic xx      value low-values.
   288     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   289     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   290     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   291     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   292     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   293     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   294     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   295     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   296     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   297     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   298     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   299     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   300     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   301     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   302     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   303     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   304     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   7
* EL156.cbl
   305     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   306     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   307     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   308     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   309     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   310     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   311     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   312     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   313     12  WORK-DATE-FROM.
   314         16  WDF-MONTH       PIC 99        VALUE ZERO.
   315         16  WDF-DAY         PIC 99        VALUE ZERO.
   316         16  WDF-YEAR        PIC 99        VALUE ZERO.
   317     12  WORK-DATE-THRU.
   318         16  WDT-MONTH       PIC 99        VALUE ZERO.
   319         16  WDT-DAY         PIC 99        VALUE ZERO.
   320         16  WDT-YEAR        PIC 99        VALUE ZERO.
   321     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   322     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   323     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   324     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   325     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   326     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   327     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   328     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   329     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   330     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   331     12  WS-PY-WK REDEFINES WS-PY-WORK.
   332         16  WS-PY-NUM       PIC S9(7)V99.
   333         16  WS-PY-SIGN      PIC X.
   334     12  WS-DY-WORK          PIC S9(5).
   335     12  WS-DY-WK REDEFINES WS-DY-WORK.
   336         16  WS-DY-NUM       PIC S9(4).
   337         16  WS-DY-SIGN      PIC X.
   338     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   339         88  COMP-REC-FOUND              VALUE 'Y'.
   340     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   341         88  BENEFIT-FOUND       VALUE 'Y'.
   342         88  NO-BENEFIT-FOUND    VALUE 'N'.
   343     12  WS-TERMS.
   344         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   345         16  FILLER          PIC X       VALUE '/'.
   346         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   347         16  WST-REM-DAYS-GRP.
   348             20  WST-SLASH   PIC X       VALUE '/'.
   349             20  WST-REM-DAYS
   350                             PIC --9.
   351     12  WS-ACCESS.
   352         16  FILLER          PIC XX      VALUE SPACES.
   353         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   354     12  WS-STATE-ACCESS.
   355         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   356         16  FILLER          PIC XX      VALUE SPACES.
   357     12  WS-CARR-ACCESS.
   358         16  FILLER          PIC X(3)    VALUE SPACES.
   359         16  WS-CARR         PIC X       VALUE SPACES.
   360     12  DATE-WORK.
   361         16  FILLER          PIC XX      VALUE SPACES.
   362         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   8
* EL156.cbl
   363     12  WS-SAVE-INPUT.
   364         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   365         16  WS-PAYEE        PIC XX      VALUE SPACE.
   366         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   367         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   368         16  WS-OFFLINE      PIC X       VALUE SPACE.
   369         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   370         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   371         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   372         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   373         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   374         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   375         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   376         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   377         16  WS-ETYPE        PIC X       VALUE SPACE.
   378         16  WS-CASH         PIC X       VALUE SPACE.
   379         16  WS-GROUPED      PIC X       VALUE SPACE.
   380         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   381         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   382         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   383         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   384         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   385         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   386         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   387         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   388         16  ws-int-to-rem-borr pic x value spaces.
   389     12  LAST-ERROR-LINE.
   390         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   391         16  FILLER              PIC X(30)
   392             VALUE ' FATAL ERRORS ENCOUNTERED'.
   393         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   394         16  FILLER              PIC X(28)
   395             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   396     12  WS-CHECK-AREA.
   397         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   398         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   399     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   400     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   401         16  FILLER              PIC XX.
   402         16  WS-A-CHECK-NUM-5    PIC 9(5).
   403     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   404         16  FILLER              PIC X.
   405         16  WS-A-CHECK-NUM-6    PIC 9(6).
   406     12  OPTION-1-SAVE-AREA.
   407         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   408         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   409     12  WS-WORK-ZIP.
   410         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   411         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   412     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   413                                 PIC 9(9).
   414     12  WS-FLI-PMTNOTE.
   415         16  WS-PMTOPTION        PIC XX.
   416         16  WS-DOCNAME          PIC X(28).
   417         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   418             20  WS-AMOUNT       PIC X(8).
   419             20  FILLER          PIC X(20).
   420         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page   9
* EL156.cbl
   421             20  WS-NUM-AMT      PIC 9(6)V99.
   422             20  FILLER          PIC X(20).
   423
   424     12  WS-HAN-PMTNOTE.
   425         16  WS-HAN-PMT-CODE     PIC X.
   426         16  WS-HAN-PMT-NOTE     PIC X(39).
   427
   428     12  WS-NCL-PMT-OPTION       PIC XX.
   429         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   430
   431     12  WS-CLAIM-SEQUENCE.
   432         16  FILLER              PIC X VALUE '('.
   433         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   434         16  FILLER              PIC X(04) VALUE ' OF '.
   435         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   436         16  FILLER              PIC X VALUE ')'.
   437
   438     12  WS-REFUND-AMT           PIC Z(7).99.
   439     12  WS-CALC-INT             PIC S9(7)V99.
   440     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   441
   442     12  SUB                     PIC 99 VALUE ZEROS.
   443
   444     12  WS-BOANOTE1.
   445         16  WS-BOANOTE1-DESC    PIC X(11).
   446         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   447         16  FILLER              PIC X(17).
   448     12  WS-BOANOTE2.
   449         16  WS-BOANOTE2-DESC    PIC X(11).
   450         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   451         16  FILLER              PIC X(17).
   452
   453     12  WS-NCLNOTE1.
   454         16  WS-NCLNOTE1-DESC    PIC X(11).
   455         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   456         16  FILLER              PIC X(17).
   457     12  WS-NCLNOTE2.
   458         16  WS-NCLNOTE2-DESC    PIC X(11).
   459         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   460         16  FILLER              PIC X(17).
   461
   462     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   463     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   464     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   465     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   466     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   467     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   468     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   469     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   470     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   471     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   472
   473     12  WS-AIG-WORK-AREAS.
   474         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   475             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   476         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   477             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   478         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  10
* EL156.cbl
   479             20  WS-FROM-MO      PIC 99.
   480             20  WS-FROM-DA      PIC 99.
   481             20  WS-FROM-YR      PIC 99.
   482         16  WS-TEMP-DATE-MDY.
   483             20  WS-TEMP-MO      PIC 99.
   484             20  WS-TEMP-DA      PIC 99.
   485             20  WS-TEMP-YR      PIC 99.
   486         16  WS-BIN-FROM-DT      PIC XX.
   487         16  WS-TEMP-INC-MDY.
   488             20  WS-TEMP-INC-MO  PIC 99.
   489             20  WS-TEMP-INC-DA  PIC 99.
   490             20  WS-TEMP-INC-YR  PIC 99.
   491         16  WS-PMT-DUE-MDY.
   492             20  WS-PMT-DUE-MO   PIC 99.
   493             20  WS-PMT-DUE-DA   PIC 99.
   494             20  WS-PMT-DUE-YR   PIC 99.
   495         16  WS-PMT-DUE-DT       PIC XX.
   496         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   497         16  WS-RETRO-ELIM-DT    PIC XX.
   498         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   499             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   500         16  WS-SAVE-DUE-DA      PIC 99.
   501         16  WS-CDAYS            PIC S9(05).
   502         16  WS-DAYS-OFF         PIC S9(05).
   503         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   504             88  ELIM-SATISFIED            VALUE 'Y'.
   505         16  WS-AIG-CHECKNO.
   506             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   507             20  WS-A-CHECKNO-3-7.
   508                 24  FILLER              PIC X(3)    VALUE SPACES.
   509                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   510                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   511         16  WS-AIG-GROUPING.
   512             20  WS-A-BENE               PIC XXX.
   513             20  FILLER                  PIC XXX.
   514         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   515             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   516             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   517         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   518                 VALUE 'UNEMPLOYMENT PAYMENT'.
   519         16  WS-CHK-THRU-DT              PIC XX.
   520         16  WS-HOLD-BIN-DATE-1          PIC XX.
   521
   522 01  MISC-CSO-AREA.
   523     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   524     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   525     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   526         88  APPROVAL-NEEDED                        VALUE 'Y'.
   527     12  WS-APPROV-NOTE                  PIC X(43)
   528         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   529     12  WS-3550-APPROV-NOTE             PIC X(43)
   530         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   531     12  WS-REAUDIT-NOTE                 PIC X(43)
   532         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   533     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   534     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   535     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   536     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  11
* EL156.cbl
   537     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   538     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   539     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   540         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   541     12  WS-PAYEE-CITY-STATE     PIC X(30).
   542     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   543         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   544     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   545     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   546     12  WS-WORK-NAME            PIC X(30).
   547     12  FILLER  REDEFINES WS-WORK-NAME.
   548         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   549     12  WS-INSURED-NAME         PIC X(30).
   550     12  FILLER  REDEFINES WS-INSURED-NAME.
   551         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   552     12  WS-PAYEE-NAME           PIC X(30).
   553     12  FILLER  REDEFINES WS-PAYEE-NAME.
   554         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   555     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   556         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   557         88  HOLD-UNTIL-PMT            VALUE 'P'.
   558     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   559
   560 01  ERROR-MESSAGES.
   561     12  ER-0000                 PIC X(4)  VALUE '0000'.
   562     12  ER-0004                 PIC X(4)  VALUE '0004'.
   563     12  ER-0008                 PIC X(4)  VALUE '0008'.
   564     12  ER-0019                 PIC X(4)  VALUE '0019'.
   565     12  ER-0029                 PIC X(4)  VALUE '0029'.
   566     12  ER-0042                 PIC X(4)  VALUE '0042'.
   567     12  ER-0070                 PIC X(4)  VALUE '0070'.
   568     12  ER-0130                 PIC X(4)  VALUE '0130'.
   569     12  ER-0149                 PIC X(4)  VALUE '0149'.
   570     12  ER-0154                 PIC X(4)  VALUE '0154'.
   571     12  ER-0168                 PIC X(4)  VALUE '0168'.
   572     12  ER-0169                 PIC X(4)  VALUE '0169'.
   573     12  ER-0172                 PIC X(4)  VALUE '0174'.
   574     12  ER-0198                 PIC X(4)  VALUE '0198'.
   575     12  ER-0204                 PIC X(4)  VALUE '0204'.
   576     12  ER-0206                 PIC X(4)  VALUE '0206'.
   577     12  ER-0252                 PIC X(4)  VALUE '0252'.
   578     12  ER-0254                 PIC X(4)  VALUE '0254'.
   579     12  ER-0282                 PIC X(4)  VALUE '0282'.
   580     12  ER-0283                 PIC X(4)  VALUE '0283'.
   581     12  ER-0294                 PIC X(4)  VALUE '0294'.
   582     12  ER-0338                 PIC X(4)  VALUE '0338'.
   583     12  ER-0419                 PIC X(4)  VALUE '0419'.
   584     12  ER-0420                 PIC X(4)  VALUE '0420'.
   585     12  ER-0421                 PIC X(4)  VALUE '0421'.
   586     12  ER-0422                 PIC X(4)  VALUE '0422'.
   587     12  ER-0433                 PIC X(4)  VALUE '0433'.
   588     12  ER-0436                 PIC X(4)  VALUE '0436'.
   589     12  ER-0437                 PIC X(4)  VALUE '0437'.
   590     12  ER-0438                 PIC X(4)  VALUE '0438'.
   591     12  ER-0439                 PIC X(4)  VALUE '0439'.
   592     12  ER-0440                 PIC X(4)  VALUE '0440'.
   593     12  ER-0441                 PIC X(4)  VALUE '0441'.
   594     12  ER-0442                 PIC X(4)  VALUE '0442'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  12
* EL156.cbl
   595     12  ER-0443                 PIC X(4)  VALUE '0443'.
   596     12  ER-0444                 PIC X(4)  VALUE '0444'.
   597     12  ER-0445                 PIC X(4)  VALUE '0445'.
   598     12  ER-0446                 PIC X(4)  VALUE '0446'.
   599     12  ER-0447                 PIC X(4)  VALUE '0447'.
   600     12  ER-0448                 PIC X(4)  VALUE '0448'.
   601     12  ER-0449                 PIC X(4)  VALUE '0449'.
   602     12  ER-0452                 PIC X(4)  VALUE '0452'.
   603     12  ER-0458                 PIC X(4)  VALUE '0458'.
   604     12  ER-0459                 PIC X(4)  VALUE '0459'.
   605     12  ER-0460                 PIC X(4)  VALUE '0460'.
   606     12  ER-0461                 PIC X(4)  VALUE '0461'.
   607     12  ER-0462                 PIC X(4)  VALUE '0462'.
   608     12  ER-0463                 PIC X(4)  VALUE '0463'.
   609     12  ER-0464                 PIC X(4)  VALUE '0464'.
   610     12  ER-0465                 PIC X(4)  VALUE '0465'.
   611     12  ER-0466                 PIC X(4)  VALUE '0466'.
   612     12  ER-0467                 PIC X(4)  VALUE '0467'.
   613     12  ER-0468                 PIC X(4)  VALUE '0468'.
   614     12  ER-0469                 PIC X(4)  VALUE '0469'.
   615     12  ER-0473                 PIC X(4)  VALUE '0473'.
   616     12  ER-0474                 PIC X(4)  VALUE '0474'.
   617     12  ER-0475                 PIC X(4)  VALUE '0475'.
   618     12  ER-0476                 PIC X(4)  VALUE '0476'.
   619     12  ER-0477                 PIC X(4)  VALUE '0477'.
   620     12  ER-0478                 PIC X(4)  VALUE '0478'.
   621     12  ER-0479                 PIC X(4)  VALUE '0479'.
   622     12  ER-0481                 PIC X(4)  VALUE '0481'.
   623     12  ER-0491                 PIC X(4)  VALUE '0491'.
   624     12  ER-0492                 PIC X(4)  VALUE '0492'.
   625     12  ER-0493                 PIC X(4)  VALUE '0493'.
   626     12  ER-0494                 PIC X(4)  VALUE '0494'.
   627     12  ER-0495                 PIC X(4)  VALUE '0495'.
   628     12  ER-0499                 PIC X(4)  VALUE '0499'.
   629     12  ER-0500                 PIC X(4)  VALUE '0500'.
   630     12  ER-0501                 PIC X(4)  VALUE '0501'.
   631     12  ER-0502                 PIC X(4)  VALUE '0502'.
   632     12  ER-0508                 PIC X(4)  VALUE '0508'.
   633     12  ER-0513                 PIC X(4)  VALUE '0513'.
   634     12  ER-0518                 PIC X(4)  VALUE '0518'.
   635     12  ER-0524                 PIC X(4)  VALUE '0524'.
   636     12  ER-0525                 PIC X(4)  VALUE '0525'.
   637     12  ER-0526                 PIC X(4)  VALUE '0526'.
   638     12  ER-0530                 PIC X(4)  VALUE '0530'.
   639     12  ER-0540                 PIC X(4)  VALUE '0540'.
   640     12  ER-0541                 PIC X(4)  VALUE '0541'.
   641     12  ER-0542                 PIC X(4)  VALUE '0542'.
   642     12  ER-0543                 PIC X(4)  VALUE '0543'.
   643     12  ER-0545                 PIC X(4)  VALUE '0545'.
   644     12  ER-0552                 PIC X(4)  VALUE '0552'.
   645     12  ER-0555                 PIC X(4)  VALUE '0555'.
   646     12  ER-0556                 PIC X(4)  VALUE '0556'.
   647     12  ER-0557                 PIC X(4)  VALUE '0557'.
   648     12  ER-0572                 PIC X(4)  VALUE '0572'.
   649     12  ER-0573                 PIC X(4)  VALUE '0573'.
   650     12  ER-0594                 PIC X(4)  VALUE '0594'.
   651     12  ER-0616                 PIC X(4)  VALUE '0616'.
   652     12  ER-0617                 PIC X(4)  VALUE '0617'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  13
* EL156.cbl
   653     12  ER-0618                 PIC X(4)  VALUE '0618'.
   654     12  ER-0657                 PIC X(4)  VALUE '0657'.
   655     12  ER-0658                 PIC X(4)  VALUE '0658'.
   656     12  ER-0699                 PIC X(4)  VALUE '0699'.
   657     12  ER-0730                 PIC X(4)  VALUE '0730'.
   658     12  ER-0737                 PIC X(4)  VALUE '0737'.
   659     12  ER-0760                 PIC X(4)  VALUE '0760'.
   660     12  ER-0768                 PIC X(4)  VALUE '0768'.
   661     12  ER-0769                 PIC X(4)  VALUE '0769'.
   662     12  ER-0770                 PIC X(4)  VALUE '0770'.
   663     12  ER-0802                 PIC X(4)  VALUE '0802'.
   664     12  ER-0803                 PIC X(4)  VALUE '0803'.
   665     12  ER-0819                 PIC X(4)  VALUE '0819'.
   666     12  ER-0834                 PIC X(4)  VALUE '0834'.
   667     12  ER-0836                 PIC X(4)  VALUE '0836'.
   668     12  ER-0844                 PIC X(4)  VALUE '0844'.
   669     12  ER-0845                 PIC X(4)  VALUE '0845'.
   670     12  ER-0846                 PIC X(4)  VALUE '0846'.
   671     12  ER-0849                 PIC X(4)  VALUE '0849'.
   672     12  ER-0851                 PIC X(4)  VALUE '0851'.
   673     12  ER-0872                 PIC X(4)  VALUE '0872'.
   674     12  ER-0873                 PIC X(4)  VALUE '0873'.
   675     12  ER-0874                 PIC X(4)  VALUE '0874'.
   676     12  ER-0879                 PIC X(4)  VALUE '0879'.
   677     12  ER-0919                 PIC X(4)  VALUE '0919'.
   678     12  ER-0921                 PIC X(4)  VALUE '0921'.
   679     12  ER-0923                 PIC X(4)  VALUE '0923'.
   680     12  ER-0925                 PIC X(4)  VALUE '0925'.
   681     12  ER-0944                 PIC X(4)  VALUE '0944'.
   682     12  ER-0945                 PIC X(4)  VALUE '0945'.
   683     12  ER-0946                 PIC X(4)  VALUE '0946'.
   684     12  ER-0947                 PIC X(4)  VALUE '0947'.
   685     12  ER-0948                 PIC X(4)  VALUE '0948'.
   686     12  ER-0949                 PIC X(4)  VALUE '0949'.
   687     12  ER-0950                 PIC X(4)  VALUE '0950'.
   688     12  ER-0951                 PIC X(4)  VALUE '0951'.
   689     12  ER-0954                 PIC X(4)  VALUE '0954'.
   690     12  ER-0956                 PIC X(4)  VALUE '0956'.
   691     12  ER-0967                 PIC X(4)  VALUE '0967'.
   692     12  ER-0968                 PIC X(4)  VALUE '0968'.
   693     12  ER-0974                 PIC X(4)  VALUE '0974'.
   694     12  ER-0975                 PIC X(4)  VALUE '0975'.
   695     12  ER-1561                 PIC X(4)  VALUE '1561'.
   696     12  ER-1566                 PIC X(4)  VALUE '1566'.
   697     12  ER-1567                 PIC X(4)  VALUE '1567'.
   698     12  ER-1569                 PIC X(4)  VALUE '1569'.
   699     12  er-1582                 pic x(4)  value '1582'.
   700     12  er-1657                 pic x(4)  value '1657'.
   701     12  er-1658                 pic x(4)  value '1658'.
   702     12  er-1667                 pic x(4)  value '1667'.
   703     12  er-1670                 pic x(4)  value '1670'.
   704     12  er-1671                 pic x(4)  value '1671'.
   705     12  er-1672                 pic x(4)  value '1672'.
   706     12  er-1673                 pic x(4)  value '1673'.
   707     12  er-1674                 pic x(4)  value '1674'.
   708     12  er-1677                 pic x(4)  value '1677'.
   709     12  ER-1775                 PIC X(4)  VALUE '1775'.
   710     12  ER-1880                 PIC X(4)  VALUE '1880'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  14
* EL156.cbl
   711     12  ER-1930                 PIC X(4)  VALUE '1930'.
   712     12  ER-2044                 PIC X(4)  VALUE '2044'.
   713     12  ER-3140                 PIC X(4)  VALUE '3140'.
   714     12  ER-3141                 PIC X(4)  VALUE '3141'.
   715     12  ER-3255                 PIC X(4)  VALUE '3255'.
   716     12  ER-3272                 PIC X(4)  VALUE '3272'.
   717     12  ER-3516                 PIC X(4)  VALUE '3516'.
   718     12  ER-3527                 PIC X(4)  VALUE '3527'.
   719     12  ER-3528                 PIC X(4)  VALUE '3528'.
   720     12  ER-3529                 PIC X(4)  VALUE '3529'.
   721     12  ER-3530                 PIC X(4)  VALUE '3530'.
   722     12  ER-3531                 PIC X(4)  VALUE '3531'.
   723     12  ER-3532                 PIC X(4)  VALUE '3532'.
   724     12  ER-3533                 PIC X(4)  VALUE '3533'.
   725     12  ER-3534                 PIC X(4)  VALUE '3534'.
   726     12  ER-3535                 PIC X(4)  VALUE '3535'.
   727     12  ER-3536                 PIC X(4)  VALUE '3536'.
   728     12  ER-3537                 PIC X(4)  VALUE '3537'.
   729     12  ER-3538                 PIC X(4)  VALUE '3538'.
   730     12  ER-3539                 PIC X(4)  VALUE '3539'.
   731     12  ER-3540                 PIC X(4)  VALUE '3540'.
   732     12  ER-3541                 PIC X(4)  VALUE '3541'.
   733     12  ER-3542                 PIC X(4)  VALUE '3542'.
   734     12  ER-3543                 PIC X(4)  VALUE '3543'.
   735     12  ER-3546                 PIC X(4)  VALUE '3546'.
   736     12  ER-3549                 PIC X(4)  VALUE '3549'.
   737     12  ER-3818                 PIC X(4)  VALUE '3818'.
   738     12  ER-7540                 PIC X(4)  VALUE '7540'.
   739     12  ER-7576                 PIC X(4)  VALUE '7576'.
   740     12  ER-7579                 PIC X(4)  VALUE '7579'.
   741     12  ER-7580                 PIC X(4)  VALUE '7580'.
   742     12  ER-7583                 PIC X(4)  VALUE '7583'.
   743     12  ER-7585                 PIC X(4)  VALUE '7585'.
   744     12  ER-7830                 PIC X(4)  VALUE '7830'.
   745     12  ER-7831                 PIC X(4)  VALUE '7831'.
   746     12  ER-7832                 PIC X(4)  VALUE '7832'.
   747     12  ER-7833                 PIC X(4)  VALUE '7833'.
   748     12  ER-7834                 PIC X(4)  VALUE '7834'.
   749     12  ER-7835                 PIC X(4)  VALUE '7835'.
   750     12  ER-7836                 PIC X(4)  VALUE '7836'.
   751     12  ER-7837                 PIC X(4)  VALUE '7837'.
   752     12  ER-7838                 PIC X(4)  VALUE '7838'.
   753     12  ER-7841                 PIC X(4)  VALUE '7841'.
   754     12  ER-7844                 PIC X(4)  VALUE '7844'.
   755     12  ER-7845                 PIC X(4)  VALUE '7845'.
   756     12  ER-8000                 PIC X(4)  VALUE '8000'.
   757     12  ER-8051                 PIC X(4)  VALUE '8051'.
   758     12  ER-8052                 PIC X(4)  VALUE '8052'.
   759     12  ER-8053                 PIC X(4)  VALUE '8053'.
   760     12  ER-8054                 PIC X(4)  VALUE '8054'.
   761     12  ER-8055                 PIC X(4)  VALUE '8055'.
   762     12  ER-8056                 PIC X(4)  VALUE '8056'.
   763     12  ER-8057                 PIC X(4)  VALUE '8057'.
   764     12  ER-8058                 PIC X(4)  VALUE '8058'.
   765     12  ER-8059                 PIC X(4)  VALUE '8059'.
   766     12  ER-8060                 PIC X(4)  VALUE '8060'.
   767     12  ER-8061                 PIC X(4)  VALUE '8061'.
   768     12  ER-8062                 PIC X(4)  VALUE '8062'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  15
* EL156.cbl
   769     12  ER-8063                 PIC X(4)  VALUE '8063'.
   770     12  ER-8064                 PIC X(4)  VALUE '8064'.
   771     12  ER-8065                 PIC X(4)  VALUE '8065'.
   772     12  ER-8066                 PIC X(4)  VALUE '8066'.
   773     12  ER-8146                 PIC X(4)  VALUE '8146'.
   774     12  ER-8147                 PIC X(4)  VALUE '8147'.
   775     12  ER-8152                 PIC X(4)  VALUE '8152'.
   776     12  ER-8153                 PIC X(4)  VALUE '8153'.
   777     12  ER-8154                 PIC X(4)  VALUE '8154'.
   778     12  ER-8155                 PIC X(4)  VALUE '8155'.
   779     12  ER-8310                 PIC X(4)  VALUE '8310'.
   780     12  ER-8311                 PIC X(4)  VALUE '8311'.
   781     12  ER-8312                 PIC X(4)  VALUE '8312'.
   782     12  ER-8313                 PIC X(4)  VALUE '8313'.
   783     12  ER-8314                 PIC X(4)  VALUE '8314'.
   784     12  ER-8315                 PIC X(4)  VALUE '8315'.
   785     12  ER-8316                 PIC X(4)  VALUE '8316'.
   786     12  ER-8317                 PIC X(4)  VALUE '8317'.
   787
   788 01  CSO-WORK-FIELDS.
   789     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   790       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   791
   792     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   793     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   794         88  CERT-NOTE-ADDED           VALUE 'Y'.
   795     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   796         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   797     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   798
   799     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   800
   801 01  SC-NP6-CERT-NOTE.
   802     12  FILLER                  PIC X(12)
   803               VALUE 'REM BENEFIT '.
   804     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   805     12  SC-NP6-COMM             PIC X(8)
   806               VALUE ' + 6 MO '.
   807     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   808     12  FILLER                  PIC X(12)
   809               VALUE ' = AMT PAID '.
   810     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   811
   812 01  SC-NP6-ORIG-NOTE.
   813     12  FILLER                  PIC X(63)  VALUE
   814         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   815 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   816     88  PDEF-FOUND                   VALUE 'Y'.
   817 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   818     88  ACCT-FOUND                   VALUE 'Y'.
   819 01  CTBL-KEY-SAVE               PIC X(5).
   820 01  CTBL-KEY.
   821     05  CTBL-COMPANY-CD         PIC X.
   822     05  CTBL-TABLE              PIC XXX.
   823     05  CTBL-BEN-TYPE           PIC X.
   824     05  CTBL-BEN-CODE           PIC XX.
   825 01  ERPDEF-KEY-SAVE             PIC X(18).
   826 01  ERPDEF-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  16
* EL156.cbl
   827     12  ERPDEF-COMPANY-CD       PIC X.
   828     12  ERPDEF-STATE            PIC XX.
   829     12  ERPDEF-PROD-CD          PIC XXX.
   830     12  F                       PIC X(7).
   831     12  ERPDEF-BEN-TYPE         PIC X.
   832     12  ERPDEF-BEN-CODE         PIC XX.
   833     12  ERPDEF-EXP-DT           PIC XX.
   834 01  ELCRTT-KEY.
   835     05  CTRLR-COMP-CD       PIC X.
   836     05  CTRLR-CARRIER       PIC X.
   837     05  CTRLR-GROUPING      PIC X(6).
   838     05  CTRLR-STATE         PIC X(2).
   839     05  CTRLR-ACCOUNT       PIC X(10).
   840     05  CTRLR-EFF-DT        PIC XX.
   841     05  CTRLR-CERT-NO       PIC X(11).
   842     05  CTRLR-REC-TYPE      PIC X.
   843 01  ACCESS-KEYS.
   844     12  ELARCH-KEY.
   845         16  ARCH-CO             PIC X.
   846         16  ARCH-NUMBER         PIC S9(08) COMP.
   847         16  ARCH-REC-TYPE       PIC X.
   848         16  ARCH-SEQ            PIC S9(04) COMP.
   849     12  ELMSTR-KEY.
   850         16  MSTR-COMP-CD        PIC X.
   851         16  MSTR-CARRIER        PIC X.
   852         16  MSTR-CLAIM-NO       PIC X(7).
   853         16  MSTR-CERT-NO        PIC X(11).
   854     12  ELCNTL-KEY.
   855         16  CNTL-COMP-ID        PIC X(3).
   856         16  CNTL-REC-TYPE       PIC X.
   857         16  CNTL-ACCESS         PIC X(4).
   858         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   859     12  ELCERT-KEY.
   860         16  CERT-COMP-CD        PIC X.
   861         16  CERT-CARRIER        PIC X.
   862         16  CERT-GROUPING       PIC X(6).
   863         16  CERT-STATE          PIC XX.
   864         16  CERT-ACCOUNT        PIC X(10).
   865         16  CERT-EFF-DT         PIC XX.
   866         16  CERT-CERT-NO        PIC X(11).
   867     12  ELTRLR-KEY.
   868         16  TRLR-COMP-CD        PIC X.
   869         16  TRLR-CARRIER        PIC X.
   870         16  TRLR-CLAIM-NO       PIC X(7).
   871         16  TRLR-CERT-NO        PIC X(11).
   872         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   873     12  ELACTQ-KEY.
   874         16  ACTQ-COMP-CD        PIC X.
   875         16  ACTQ-CARRIER        PIC X.
   876         16  ACTQ-CLAIM-NO       PIC X(7).
   877         16  ACTQ-CERT-NO        PIC X(11).
   878     12  W-NOTE-KEY.
   879         16  W-NOTE-COMP-CD      PIC X.
   880         16  W-NOTE-CERT-KEY.
   881             20  W-NOTE-CARRIER  PIC X.
   882             20  W-NOTE-GROUPING PIC X(6).
   883             20  W-NOTE-STATE    PIC XX.
   884             20  W-NOTE-ACCOUNT  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  17
* EL156.cbl
   885             20  W-NOTE-EFF-DT   PIC XX.
   886             20  W-NOTE-CERT-NO  PIC X(11).
   887     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   888     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   889     12  ERACCT-KEY.
   890         16  ERACCT-PARTIAL-KEY.
   891             20  ACCT-COMP-CD    PIC X.
   892             20  ACCT-CARRIER    PIC X.
   893             20  ACCT-GROUPING   PIC X(6).
   894             20  ACCT-STATE      PIC XX.
   895             20  ACCT-ACCOUNT    PIC X(10).
   896         16  ACCT-EXP-DT         PIC XX.
   897         16  FILLER              PIC X(4) VALUE SPACES.
   898     12  ELCHKQ-KEY.
   899         16  CHKQ-COMP-CD        PIC X.
   900         16  CHKQ-CONTROL        PIC S9(8) COMP.
   901         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   902     12  ELBENE-KEY.
   903         16  BENE-COMP-CD         PIC X.
   904         16  BENE-RECORD-TYPE     PIC X.
   905         16  BENE-NUMBER          PIC X(10).
   906     12  ERCOMP-KEY.
   907         16  COMP-COMP-CD        PIC X.
   908         16  COMP-CARRIER        PIC X.
   909         16  COMP-GROUP          PIC X(06).
   910         16  COMP-FIN-RESP       PIC X(10).
   911         16  COMP-ACCOUNT        PIC X(10).
   912         16  COMP-TYPE           PIC X.
   913
   914     12  DLO035-KEY.
   915         16  DL35-PROCESS-TYPE   PIC X.
   916         16  DL35-CREDIT-CARD    PIC X(20).
   917         16  DL35-BEN-TYPE       PIC XX.
   918         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   919         16  DL35-RETURN-CODE    PIC XX.
   920
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  18
* EL156.cbl
   922*    COPY ELCDATE.
   923******************************************************************
   924*                                                                *
   925*                                                                *
   926*                            ELCDATE.                            *
   927*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   928*                            VMOD=2.003
   929*                                                                *
   930*                                                                *
   931*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   932*                 LENGTH = 200                                   *
   933******************************************************************
   934
   935 01  DATE-CONVERSION-DATA.
   936     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   937     12  DC-OPTION-CODE                PIC X.
   938         88  BIN-TO-GREG                VALUE ' '.
   939         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   940         88  EDIT-GREG-TO-BIN           VALUE '2'.
   941         88  YMD-GREG-TO-BIN            VALUE '3'.
   942         88  MDY-GREG-TO-BIN            VALUE '4'.
   943         88  JULIAN-TO-BIN              VALUE '5'.
   944         88  BIN-PLUS-ELAPSED           VALUE '6'.
   945         88  FIND-CENTURY               VALUE '7'.
   946         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   947         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   948         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   949         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   950         88  JULIAN-TO-BIN-3            VALUE 'C'.
   951         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   952         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   953         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   954         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   955         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   956         88  CHECK-LEAP-YEAR            VALUE 'H'.
   957         88  BIN-3-TO-GREG              VALUE 'I'.
   958         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   959         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   960         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   961         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   962         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   963         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   964         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   965         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   966         88  THREE-CHARACTER-BIN
   967                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   968         88  GREGORIAN-TO-BIN
   969                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   970         88  BIN-TO-GREGORIAN
   971                  VALUES ' ' '1' 'I' '8' 'G'.
   972         88  JULIAN-TO-BINARY
   973                  VALUES '5' 'C' 'E' 'F'.
   974     12  DC-ERROR-CODE                 PIC X.
   975         88  NO-CONVERSION-ERROR        VALUE ' '.
   976         88  DATE-CONVERSION-ERROR
   977                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   978         88  DATE-IS-ZERO               VALUE '1'.
   979         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  19
* EL156.cbl
   980         88  DATE-IS-INVALID            VALUE '3'.
   981         88  DATE1-GREATER-DATE2        VALUE '4'.
   982         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   983         88  DATE-INVALID-OPTION        VALUE '9'.
   984         88  INVALID-CENTURY            VALUE 'A'.
   985         88  ONLY-CENTURY               VALUE 'B'.
   986         88  ONLY-LEAP-YEAR             VALUE 'C'.
   987         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   988     12  DC-END-OF-MONTH               PIC X.
   989         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   990     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   991         88  USE-NORMAL-PROCESS         VALUE ' '.
   992         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   993         88  ADJUST-UP-100-YRS          VALUE '2'.
   994     12  FILLER                        PIC X.
   995     12  DC-CONVERSION-DATES.
   996         16  DC-BIN-DATE-1             PIC XX.
   997         16  DC-BIN-DATE-2             PIC XX.
   998         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   999         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1000                       DC-GREG-DATE-1-EDIT.
  1001             20  DC-EDIT1-MONTH        PIC 99.
  1002             20  SLASH1-1              PIC X.
  1003             20  DC-EDIT1-DAY          PIC 99.
  1004             20  SLASH1-2              PIC X.
  1005             20  DC-EDIT1-YEAR         PIC 99.
  1006         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1007         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1008                     DC-GREG-DATE-2-EDIT.
  1009             20  DC-EDIT2-MONTH        PIC 99.
  1010             20  SLASH2-1              PIC X.
  1011             20  DC-EDIT2-DAY          PIC 99.
  1012             20  SLASH2-2              PIC X.
  1013             20  DC-EDIT2-YEAR         PIC 99.
  1014         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1015         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1016                     DC-GREG-DATE-1-YMD.
  1017             20  DC-YMD-YEAR           PIC 99.
  1018             20  DC-YMD-MONTH          PIC 99.
  1019             20  DC-YMD-DAY            PIC 99.
  1020         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1021         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1022                      DC-GREG-DATE-1-MDY.
  1023             20  DC-MDY-MONTH          PIC 99.
  1024             20  DC-MDY-DAY            PIC 99.
  1025             20  DC-MDY-YEAR           PIC 99.
  1026         16  DC-GREG-DATE-1-ALPHA.
  1027             20  DC-ALPHA-MONTH        PIC X(10).
  1028             20  DC-ALPHA-DAY          PIC 99.
  1029             20  FILLER                PIC XX.
  1030             20  DC-ALPHA-CENTURY.
  1031                 24 DC-ALPHA-CEN-N     PIC 99.
  1032             20  DC-ALPHA-YEAR         PIC 99.
  1033         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1034         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1035         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1036         16  DC-JULIAN-DATE            PIC 9(05).
  1037         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  20
* EL156.cbl
  1038                                       PIC 9(05).
  1039         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1040             20  DC-JULIAN-YEAR        PIC 99.
  1041             20  DC-JULIAN-DAYS        PIC 999.
  1042         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1043         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1044         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1045     12  DATE-CONVERSION-VARIBLES.
  1046         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1047         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1048             20  FILLER                PIC 9(3).
  1049             20  HOLD-CEN-1-CCYY.
  1050                 24  HOLD-CEN-1-CC     PIC 99.
  1051                 24  HOLD-CEN-1-YY     PIC 99.
  1052             20  HOLD-CEN-1-MO         PIC 99.
  1053             20  HOLD-CEN-1-DA         PIC 99.
  1054         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1055             20  HOLD-CEN-1-R-MO       PIC 99.
  1056             20  HOLD-CEN-1-R-DA       PIC 99.
  1057             20  HOLD-CEN-1-R-CCYY.
  1058                 24  HOLD-CEN-1-R-CC   PIC 99.
  1059                 24  HOLD-CEN-1-R-YY   PIC 99.
  1060             20  FILLER                PIC 9(3).
  1061         16  HOLD-CENTURY-1-X.
  1062             20  FILLER                PIC X(3)  VALUE SPACES.
  1063             20  HOLD-CEN-1-X-CCYY.
  1064                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1065                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1066             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1067             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1068         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1069             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1070             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1071             20  HOLD-CEN-1-R-X-CCYY.
  1072                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1073                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1074             20  FILLER                PIC XXX.
  1075         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1076         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1077         16  DC-JULIAN-DATE-1          PIC 9(07).
  1078         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1079             20  DC-JULIAN-1-CCYY.
  1080                 24  DC-JULIAN-1-CC    PIC 99.
  1081                 24  DC-JULIAN-1-YR    PIC 99.
  1082             20  DC-JULIAN-DA-1        PIC 999.
  1083         16  DC-JULIAN-DATE-2          PIC 9(07).
  1084         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1085             20  DC-JULIAN-2-CCYY.
  1086                 24  DC-JULIAN-2-CC    PIC 99.
  1087                 24  DC-JULIAN-2-YR    PIC 99.
  1088             20  DC-JULIAN-DA-2        PIC 999.
  1089         16  DC-GREG-DATE-A-EDIT.
  1090             20  DC-EDITA-MONTH        PIC 99.
  1091             20  SLASHA-1              PIC X VALUE '/'.
  1092             20  DC-EDITA-DAY          PIC 99.
  1093             20  SLASHA-2              PIC X VALUE '/'.
  1094             20  DC-EDITA-CCYY.
  1095                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  21
* EL156.cbl
  1096                 24  DC-EDITA-YEAR     PIC 99.
  1097         16  DC-GREG-DATE-B-EDIT.
  1098             20  DC-EDITB-MONTH        PIC 99.
  1099             20  SLASHB-1              PIC X VALUE '/'.
  1100             20  DC-EDITB-DAY          PIC 99.
  1101             20  SLASHB-2              PIC X VALUE '/'.
  1102             20  DC-EDITB-CCYY.
  1103                 24  DC-EDITB-CENT     PIC 99.
  1104                 24  DC-EDITB-YEAR     PIC 99.
  1105         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1106         16  DC-GREG-DATE-CYMD-R REDEFINES
  1107                              DC-GREG-DATE-CYMD.
  1108             20  DC-CYMD-CEN           PIC 99.
  1109             20  DC-CYMD-YEAR          PIC 99.
  1110             20  DC-CYMD-MONTH         PIC 99.
  1111             20  DC-CYMD-DAY           PIC 99.
  1112         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1113         16  DC-GREG-DATE-MDCY-R REDEFINES
  1114                              DC-GREG-DATE-MDCY.
  1115             20  DC-MDCY-MONTH         PIC 99.
  1116             20  DC-MDCY-DAY           PIC 99.
  1117             20  DC-MDCY-CEN           PIC 99.
  1118             20  DC-MDCY-YEAR          PIC 99.
  1119    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1120        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1121    12  DC-EL310-DATE                  PIC X(21).
  1122    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  22
* EL156.cbl
  1124*    COPY ELCLOGOF.
  1125******************************************************************
  1126*                                                                *
  1127*                                                                *
  1128*                            ELCLOGOF.                           *
  1129*                            VMOD=2.001                          *
  1130*                                                                *
  1131*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1132*                                                                *
  1133******************************************************************
  1134 01  CLASIC-LOGOFF.
  1135     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1136     12  LOGOFF-TEXT.
  1137         16  FILLER          PIC X(5)    VALUE SPACES.
  1138         16  LOGOFF-MSG.
  1139             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1140             20  FILLER      PIC X       VALUE SPACES.
  1141             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1142         16  FILLER          PIC X(80)
  1143           VALUE '* YOU ARE NOW LOGGED OFF'.
  1144         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1145         16  FILLER          PIC X       VALUE QUOTE.
  1146         16  LOGOFF-SYS-MSG  PIC X(17)
  1147           VALUE 'S CLAS-IC SYSTEM '.
  1148     12  TEXT-MESSAGES.
  1149         16  UNACCESS-MSG    PIC X(29)
  1150             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1151         16  PGMIDERR-MSG    PIC X(17)
  1152             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  23
* EL156.cbl
  1154*    COPY ELCCALC.
  1155******************************************************************
  1156*                                                                *
  1157*                           ELCCALC.                            *
  1158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1159*                            VMOD=2.025                          *
  1160*                                                                *
  1161*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1162*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1163*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1164*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1165*                                                                *
  1166*  PASSED TO ELRTRM                                              *
  1167*  -----------------                                             *
  1168*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1169*  ORIGINAL TERM                                                 *
  1170*  BEGINNING DATE                                                *
  1171*  ENDING DATE                                                   *
  1172*  COMPANY I.D.                                                  *
  1173*  ACCOUNT MASTER USER FIELD                                     *
  1174*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1175*  FREE LOOK DAYS                                                *
  1176*                                                                *
  1177*  RETURNED FROM ELRTRM                                          *
  1178*  ---------------------                                         *
  1179*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1180*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1181*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1182*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1183*----------------------------------------------------------------*
  1184*  PASSED TO ELRAMT                                              *
  1185*  ----------------                                              *
  1186*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1187*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1188*  ORIGINAL AMOUNT                                               *
  1189*  ALTERNATE BENEFIT (BALLON)                                    *
  1190*  A.P.R. - NET PAY ONLY                                         *
  1191*  METHOD
  1192*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1193*  COMPANY I.D.                                                  *
  1194*  BENEFIT TYPE                                                  *
  1195*                                                                *
  1196*  RETURNED FROM ELRAMT                                          *
  1197*  --------------------                                          *
  1198*  REMAINING AMOUNT 1 - CURRENT                                  *
  1199*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1200*  REMAINING AMOUNT FACTOR
  1201*----------------------------------------------------------------*
  1202*  PASSED TO ELRESV                                              *
  1203*  -----------------                                             *
  1204*  CERTIFICATE EFFECTIVE DATE                                    *
  1205*  VALUATION DATE                                                *
  1206*  PAID THRU DATE                                                *
  1207*  BENEFIT                                                       *
  1208*  INCURRED DATE                                                 *
  1209*  REPORTED DATE                                                 *
  1210*  ISSUE AGE                                                     *
  1211*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  24
* EL156.cbl
  1212*  CDT PERCENT                                                   *
  1213*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1214* *CLAIM TYPE (LIFE, A/H)                                        *
  1215* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1216* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1217*                                                                *
  1218*  RETURNED FROM ELRESV                                          *
  1219*  --------------------                                          *
  1220*  CDT TABLE USED                                                *
  1221*  CDT FACTOR USED                                               *
  1222*  PAY TO CURRENT RESERVE                                        *
  1223*  I.B.N.R. - A/H ONLY                                           *
  1224*  FUTURE (ACCRUED) AH ONLY                                      *
  1225*----------------------------------------------------------------*
  1226*  PASSED TO ELRATE                                              *
  1227*  ----------------                                              *
  1228*  CERT ISSUE DATE                                               *
  1229*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1230*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1231*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1232*  STATE CODE (CLIENT DEFINED)                                   *
  1233*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1234*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1235*  DEVIATION CODE                                                *
  1236*  ISSUE AGE                                                     *
  1237*  ORIGINAL BENEFIT AMOUNT                                       *
  1238*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1239*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1240*  BENEFIT KIND (LIFE OR A/H)                                    *
  1241*  A.P.R.                                                        *
  1242*  METHOD
  1243*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1244*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1245*  COMPANY I.D. (3 CHARACTER)                                    *
  1246*  BENEFIT CODE                                                  *
  1247*  BENEFIT OVERRIDE CODE                                         *
  1248*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1249*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1250*  JOINT INDICATOR (CSL ONLY)                                    *
  1251*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1252*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1253*                                                                *
  1254*  RETURNED FROM ELRATE                                          *
  1255*  --------------------                                          *
  1256*  CALCULATED PREMIUM                                            *
  1257*  PREMIUM RATE                                                  *
  1258*  MORTALITY CODE                                                *
  1259*  MAX ATTAINED AGE                                              *
  1260*  MAX AGE                                                       *
  1261*  MAX TERM                                                      *
  1262*  MAX MONTHLY BENEFIT                                           *
  1263*  MAX TOTAL BENIFIT                                             *
  1264*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1265*----------------------------------------------------------------*
  1266*  PASSED TO ELRFND                                              *
  1267*  ----------------                                              *
  1268*  CERT ISSUE DATE                                               *
  1269*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  25
* EL156.cbl
  1270*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1271*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1272*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1273*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1274*  STATE CODE (CLIENT DEFINED)                                   *
  1275*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1276*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1277*  DEVIATION CODE                                                *
  1278*  ISSUE AGE                                                     *
  1279*  ORIGINAL BENEFIT AMOUNT                                       *
  1280*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1281*  PROCESS TYPE (CANCEL)                                         *
  1282*  BENEFIT KIND (LIFE OR A/H)                                    *
  1283*  A.P.R.                                                        *
  1284*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1285*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1286*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1287*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1288*  COMPANY I.D. (3 CHARACTER)                                    *
  1289*  BENEFIT CODE                                                  *
  1290*  BENEFIT OVERRIDE CODE                                         *
  1291*                                                                *
  1292*  RETURNED FROM ELRFND                                          *
  1293*  --------------------                                          *
  1294*  CALCULATED REFUND                                             *
  1295*----------------------------------------------------------------*
  1296*  PASSED TO ELEARN                                              *
  1297*  ----------------                                              *
  1298*  CERT ISSUE DATE                                               *
  1299*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1300*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1301*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1302*  STATE CODE (CLIENT DEFINED)                                   *
  1303*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1304*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1305*  DEVIATION CODE                                                *
  1306*  ISSUE AGE                                                     *
  1307*  ORIGINAL BENEFIT AMOUNT                                       *
  1308*  BENEFIT KIND (LIFE OR A/H)                                    *
  1309*  A.P.R.                                                        *
  1310*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1311*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1312*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1313*  COMPANY I.D. (3 CHARACTER)                                    *
  1314*  BENEFIT CODE                                                  *
  1315*  BENEFIT OVERRIDE CODE                                         *
  1316*                                                                *
  1317*  RETURNED FROM ELEARN                                          *
  1318*  --------------------                                          *
  1319*  INDICATED  EARNINGS                                           *
  1320*----------------------------------------------------------------*
  1321*                 LENGTH = 450                                   *
  1322*                                                                *
  1323******************************************************************
  1324******************************************************************
  1325*                   C H A N G E   L O G
  1326*
  1327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  26
* EL156.cbl
  1328*-----------------------------------------------------------------
  1329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1330* EFFECTIVE    NUMBER
  1331*-----------------------------------------------------------------
  1332* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1333* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1334* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1335* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1336* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1337* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1338* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1339* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1340* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1341* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1342* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1343******************************************************************
  1344
  1345 01  CALCULATION-PASS-AREA.
  1346     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1347                                     COMP.
  1348
  1349     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1350       88  NO-CP-ERROR                             VALUE ZERO.
  1351       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1352                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1353       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1354       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1355       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1356       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1357       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1358       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1359       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1360       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1361       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1362       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1363       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1364       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1365       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1366       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1367       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1368       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1369       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1370
  1371     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1372       88  NO-CP-ERROR-2                           VALUE ZERO.
  1373***********************  INPUT AREAS ****************************
  1374
  1375     12  CP-CALCULATION-AREA.
  1376         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1377         16  CP-CERT-EFF-DT        PIC XX.
  1378         16  CP-VALUATION-DT       PIC XX.
  1379         16  CP-PAID-THRU-DT       PIC XX.
  1380         16  CP-BENEFIT-TYPE       PIC X.
  1381           88  CP-AH                               VALUE 'A' 'D'
  1382                                                   'I' 'U'.
  1383           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1384           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1385         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  27
* EL156.cbl
  1386         16  CP-REPORTED-DT        PIC XX.
  1387         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1388         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1389         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1390                                     COMP-3.
  1391         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1392                                     COMP-3.
  1393         16  CP-CDT-METHOD         PIC X.
  1394           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1395           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1396           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1397         16  CP-CLAIM-TYPE         PIC X.
  1398           88  CP-AH-CLAIM                         VALUE 'A'.
  1399           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1400         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1401                                     COMP-3.
  1402         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1403                                     COMP-3.
  1404         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1405                                     COMP-3.
  1406         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1407                                     COMP-3.
  1408         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1409                                     COMP-3.
  1410         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1411                                     COMP-3.
  1412         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1413                                     COMP-3.
  1414         16  CP-REM-TERM-METHOD    PIC X.
  1415           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1416           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1417           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1418           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1419           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1420           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1421           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1422         16  CP-EARNING-METHOD     PIC X.
  1423           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1424           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1425           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1426           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1427           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1428           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1429           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1430           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1431           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1432           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1433           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1434           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1435           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1436           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1437         16  CP-PROCESS-TYPE       PIC X.
  1438           88  CP-CLAIM                            VALUE '1'.
  1439           88  CP-CANCEL                           VALUE '2'.
  1440           88  CP-ISSUE                            VALUE '3'.
  1441         16  CP-SPECIAL-CALC-CD    PIC X.
  1442           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1443           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  28
* EL156.cbl
  1444           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1445           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1446           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1447           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1448           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1449           88  CP-FARM-PLAN                    VALUE 'F'.
  1450           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1451           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1452           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1453           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1454           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1455           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1456           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1457           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1458           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1459           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1460                                                     'W' 'X'.
  1461           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1462           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1463           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1464           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1465           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1466           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1467           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1468           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1469           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1470           88  CP-CSL-METH-1                   VALUE '5'.
  1471           88  CP-CSL-METH-2                   VALUE '6'.
  1472           88  CP-CSL-METH-3                   VALUE '7'.
  1473           88  CP-CSL-METH-4                   VALUE '8'.
  1474
  1475         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1476                                     COMP-3.
  1477         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1478         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1479         16  CP-STATE              PIC XX          VALUE SPACE.
  1480         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1481         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1482           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1483               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1484         16  CP-R78-OPTION         PIC X.
  1485           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1486           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1487
  1488         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1489         16  CP-IBNR-RESERVE-SW    PIC X.
  1490         16  CP-CLAIM-STATUS       PIC X.
  1491         16  CP-RATE-FILE          PIC X.
  1492         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1493                                     COMP-3.
  1494
  1495         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1496         16  CP-AH-OVERRIDE-CODE   PIC X.
  1497
  1498         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1499                                     COMP-3.
  1500         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1501                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  29
* EL156.cbl
  1502         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1503                                     COMP-3.
  1504         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1505                                     COMP-3.
  1506         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1507                                     COMP-3.
  1508         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1509                                  PIC S9(7)V99 COMP-3.
  1510
  1511         16  CP-PAID-FROM-DATE     PIC X(02).
  1512         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1513         16  CP-EXT-DAYS-CALC      PIC X.
  1514           88  CP-EXT-NO-CHG                   VALUE ' '.
  1515           88  CP-EXT-CHG-LF                   VALUE '1'.
  1516           88  CP-EXT-CHG-AH                   VALUE '2'.
  1517           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1518         16  CP-DOMICILE-STATE     PIC XX.
  1519         16  CP-CARRIER            PIC X.
  1520         16  CP-REIN-FLAG          PIC X.
  1521         16  CP-REM-TRM-CALC-OPTION PIC X.
  1522           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1523                      '2' '3' '4' '5'.
  1524           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1525           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1526           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1527           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1528           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1529           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1530           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1531           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1532         16  CP-SIG-SWITCH         PIC X.
  1533         16  CP-RATING-METHOD      PIC X.
  1534           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1535           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1536           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1537           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1538           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1539           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1540           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1541           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1542           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1543         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1544                                     COMP-3.
  1545         16  CP-BEN-CATEGORY       PIC X.
  1546         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1547         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1548                                   PIC S99V9(5) COMP-3.
  1549         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1550         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1551                                   PIC S99V9(5) COMP-3.
  1552         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1553         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1554         16  CP-EXPIRE-DT          PIC XX.
  1555         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1556         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1557         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1558         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1559         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  30
* EL156.cbl
  1560             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1561             88  CP-CALC-CLP              VALUE 'C'.
  1562         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1563         16  CP-CANCEL-REASON      PIC X.
  1564         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1565         16  CP-PMT-MODE           PIC X.
  1566         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1567         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1568         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1569         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1570         16  FILLER                PIC X.
  1571
  1572***************    OUTPUT FROM ELRESV   ************************
  1573
  1574         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1575
  1576         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1577                                     COMP-3.
  1578         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1579                                     COMP-3.
  1580         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1581                                     COMP-3.
  1582         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1583                                     COMP-3.
  1584         16  FILLER                PIC X(09).
  1585***************    OUTPUT FROM ELRTRM   *************************
  1586
  1587         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1588                                     COMP-3.
  1589         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1590                                     COMP-3.
  1591         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1592                                     COMP-3.
  1593         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1594                                     COMP-3.
  1595         16  FILLER                PIC X(12).
  1596
  1597***************    OUTPUT FROM ELRAMT   *************************
  1598
  1599         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1600                                     COMP-3.
  1601         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  FILLER                PIC X(12).
  1604
  1605***************    OUTPUT FROM ELRATE   *************************
  1606
  1607         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1608                                     COMP-3.
  1609         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1610                                     COMP-3.
  1611         16  CP-MORTALITY-CODE     PIC X(4).
  1612         16  CP-RATE-EDIT-FLAG     PIC X.
  1613             88  CP-RATES-NEED-APR                  VALUE '1'.
  1614         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1615                                     COMP-3.
  1616         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1617         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  31
* EL156.cbl
  1618         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1619                                   PIC S9(7)V99 COMP-3.
  1620         16  FILLER                PIC X(07).
  1621
  1622***************    OUTPUT FROM ELRFND   *************************
  1623
  1624         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1625                                     COMP-3.
  1626         16  CP-REFUND-TYPE-USED   PIC X.
  1627           88  CP-R-AS-R78                         VALUE '1'.
  1628           88  CP-R-AS-PRORATA                     VALUE '2'.
  1629           88  CP-R-AS-CALIF                       VALUE '3'.
  1630           88  CP-R-AS-TEXAS                       VALUE '4'.
  1631           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1632           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1633           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1634           88  CP-R-AS-MEAN                        VALUE '8'.
  1635           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1636           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1637           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1638           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1639           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1640           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1641         16  FILLER                PIC X(12).
  1642
  1643***************    OUTPUT FROM ELEARN   *************************
  1644
  1645         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1646                                     COMP-3.
  1647         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1648                                     COMP-3.
  1649         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1650                                     COMP-3.
  1651         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1652                                     COMP-3.
  1653         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1654                                     COMP-3.
  1655         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1656                                     COMP-3.
  1657         16  CP-EARNING-TYPE-USED  PIC X.
  1658           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1659           88  CP-E-AS-R78                         VALUE '1'.
  1660           88  CP-E-AS-PRORATA                     VALUE '2'.
  1661           88  CP-E-AS-TEXAS                       VALUE '4'.
  1662           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1663           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1664           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1665           88  CP-E-AS-MEAN                        VALUE '8'.
  1666           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1667         16  FILLER                PIC X(12).
  1668
  1669***************    OUTPUT FROM ELPMNT   *************************
  1670
  1671         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1672                                     COMP-3.
  1673         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1674                                     COMP-3.
  1675         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  32
* EL156.cbl
  1676
  1677***************   MISC WORK AREAS    *****************************
  1678         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1679                                     COMP-3.
  1680         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1681                                     COMP-3.
  1682         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1683                                     COMP-3.
  1684         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1685                                     COMP-3.
  1686         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1687                                     COMP-3.
  1688         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1689                                     COMP-3.
  1690         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1691             88  OPEN-RATE-FILE                   VALUE 'O'.
  1692             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1693             88  IO-ERROR                         VALUE 'E'.
  1694
  1695         16  CP-FIRST-PAY-DATE     PIC XX.
  1696
  1697         16  CP-JOINT-INDICATOR    PIC X.
  1698
  1699         16  CP-RESERVE-REMAINING-TERM
  1700                                   PIC S9(4)V9    VALUE ZERO
  1701                                     COMP-3.
  1702
  1703         16  CP-INSURED-BIRTH-DT   PIC XX.
  1704
  1705         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1706                                     COMP-3.
  1707
  1708         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1709                                     COMP-3.
  1710
  1711         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1712                                     COMP-3.
  1713
  1714         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1715                                     COMP-3.
  1716
  1717         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1718                                     COMP-3.
  1719
  1720         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1721                                     COMP-3.
  1722
  1723         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1724                                     COMP-3.
  1725
  1726         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1727             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1728
  1729         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1730                                     COMP-3.
  1731         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1732                                     COMP-3.
  1733         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  33
* EL156.cbl
  1734         16  cp-extra-periods      pic 9 value zeros.
  1735         16  cp-net-only-state     pic x value spaces.
  1736         16  FILLER                PIC X(13).
  1737******************************************************************
  1738*    COPY ELCICALC.
  1739******************************************************************
  1740*                                                                *
  1741*                           ELCCICALC.                           *
  1742*                            VMOD=2.001                          *
  1743*                                                                *
  1744*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1745*                 CALCULATION MODULE                             *
  1746*                                                                *
  1747*  PASSED TO ELCLMI                                              *
  1748*  -----------------                                             *
  1749*  STATE                                                         *
  1750*  PRODUCT                                                       *
  1751*  COVERAGE                                                      *
  1752*  EFFECTIVE DATE                                                *
  1753*  INCURRED DATE                                                 *
  1754*  ESTABLISHED DATE                                              *
  1755*  LAST PAID DATE                                                *
  1756*  REPORTED DATE                                                 *
  1757*  CLAIM PAYMENT AMOUNT                                          *
  1758*                                                                *
  1759*  RETURNED FROM ELRTRM                                          *
  1760*  ---------------------                                         *
  1761*  RETURN CODE                                                   *
  1762*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1763*  CLAIM INTEREST AMOUNT                                         *
  1764*----------------------------------------------------------------*
  1765*----------------------------------------------------------------*
  1766*                 LENGTH = 100                                   *
  1767*                                                                *
  1768******************************************************************
  1769******************************************************************
  1770*                   C H A N G E   L O G
  1771*
  1772* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1773*-----------------------------------------------------------------
  1774*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1775* EFFECTIVE    NUMBER
  1776*-----------------------------------------------------------------
  1777* 120905    2004040700004  PEMA  NEW COPYBOOK
  1778* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1779******************************************************************
  1780
  1781 01  CLAIM-INT-PASS-AREA.
  1782     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1783                                     COMP.
  1784
  1785     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1786       88  NO-CI-ERROR                             VALUE ZERO.
  1787       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1788       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1789       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1790       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1791       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  34
* EL156.cbl
  1792       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1793       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1794       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1795       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1796***********************  INPUT AREAS ****************************
  1797
  1798     12  CP-CALCULATION-AREA.
  1799         16  CP-COMPANY-CD         PIC X.
  1800         16  CP-STATE              PIC XX.
  1801         16  CP-PRODUCT            PIC XX.
  1802         16  CP-COVERAGE           PIC XX.
  1803         16  CP-INC-DT             PIC XX.
  1804         16  CP-EST-DT             PIC XX.
  1805         16  CP-LSTPD-DT           PIC XX.
  1806         16  CP-RPT-DT             PIC XX.
  1807         16  CP-PRF-DT             PIC XX.
  1808         16  CP-EFF-DT             PIC XX.
  1809         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1810         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1811         16  FILLER                PIC X(37).
  1812
  1813***************    OUTPUT FROM ELCLMI   ************************
  1814
  1815         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1816
  1817         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1818         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1819         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1820         16  FILLER                PIC X(19).
  1821******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  35
* EL156.cbl
  1823*    COPY ELCATTR.
  1824******************************************************************
  1825*                                                                *
  1826*                            ELCATTR.                            *
  1827*                            VMOD=2.001                          *
  1828*                                                                *
  1829*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1830*                                                                *
  1831*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1832*                                                                *
  1833*                   POS 1   P=PROTECTED                          *
  1834*                           U=UNPROTECTED                        *
  1835*                           S=ASKIP                              *
  1836*                   POS 2   A=ALPHA/NUMERIC                      *
  1837*                           N=NUMERIC                            *
  1838*                   POS 3   N=NORMAL                             *
  1839*                           B=BRIGHT                             *
  1840*                           D=DARK                               *
  1841*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1842*                           OF=MODIFIED DATA TAG OFF             *
  1843*                                                                *
  1844*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1845******************************************************************
  1846 01  ATTRIBUTE-LIST.
  1847     12  AL-PABOF            PIC X       VALUE 'Y'.
  1848     12  AL-PABON            PIC X       VALUE 'Z'.
  1849     12  AL-PADOF            PIC X       VALUE '%'.
  1850     12  AL-PADON            PIC X       VALUE '_'.
  1851     12  AL-PANOF            PIC X       VALUE '-'.
  1852     12  AL-PANON            PIC X       VALUE '/'.
  1853     12  AL-SABOF            PIC X       VALUE '8'.
  1854     12  AL-SABON            PIC X       VALUE '9'.
  1855     12  AL-SADOF            PIC X       VALUE '@'.
  1856     12  AL-SADON            PIC X       VALUE QUOTE.
  1857     12  AL-SANOF            PIC X       VALUE '0'.
  1858     12  AL-SANON            PIC X       VALUE '1'.
  1859     12  AL-UABOF            PIC X       VALUE 'H'.
  1860     12  AL-UABON            PIC X       VALUE 'I'.
  1861     12  AL-UADOF            PIC X       VALUE '<'.
  1862     12  AL-UADON            PIC X       VALUE '('.
  1863     12  AL-UANOF            PIC X       VALUE ' '.
  1864     12  AL-UANON            PIC X       VALUE 'A'.
  1865     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1866     12  AL-UNBON            PIC X       VALUE 'R'.
  1867     12  AL-UNDOF            PIC X       VALUE '*'.
  1868     12  AL-UNDON            PIC X       VALUE ')'.
  1869     12  AL-UNNOF            PIC X       VALUE '&'.
  1870     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  36
* EL156.cbl
  1872*    COPY ELCEMIB.
  1873******************************************************************
  1874*                                                                *
  1875*                                                                *
  1876*                            ELCEMIB.                            *
  1877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1878*                            VMOD=2.005                          *
  1879*                                                                *
  1880*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1881*                                                                *
  1882******************************************************************
  1883 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1884     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1885     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1886     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1887     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1888     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1889     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1890     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1891     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1892     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1893         88  EMI-NO-ERRORS                    VALUE '1'.
  1894         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1895         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1896     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1897         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1898     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1899         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1900         88  EMI-AREA1-FULL                   VALUE '2'.
  1901     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1902         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1903         88  EMI-AREA2-FULL                   VALUE '2'.
  1904     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1905         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1906         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1907         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1908         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1909         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1910     12  EMI-ERROR-LINES.
  1911         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1912         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1913         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1914         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1915             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1916                 24  EMI-ERR-NUM         PIC X(4).
  1917                 24  EMI-FILLER          PIC X.
  1918                 24  EMI-SEV             PIC X.
  1919                 24  FILLER              PIC X.
  1920             20  FILLER                  PIC X(02).
  1921     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1922         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1923             20  EMI-ERROR-NUMBER    PIC X(4).
  1924             20  EMI-FILL            PIC X.
  1925             20  EMI-SEVERITY        PIC X.
  1926             20  FILLER              PIC X.
  1927             20  EMI-ERROR-TEXT.
  1928                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1929                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  37
* EL156.cbl
  1930     12  EMI-SEVERITY-SAVE           PIC X.
  1931         88  EMI-NOTE                    VALUE 'N'.
  1932         88  EMI-WARNING                 VALUE 'W'.
  1933         88  EMI-FORCABLE                VALUE 'F'.
  1934         88  EMI-FATAL                   VALUE 'X'.
  1935     12  EMI-MESSAGE-FLAG            PIC X.
  1936         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1937         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1938     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1939     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1940         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1941         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1942         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1943     12  emi-claim-no                pic x(7).
  1944     12  emi-claim-type              pic x(6).
  1945     12  FILLER                      PIC X(124)  VALUE SPACES.
  1946     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1947     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1948     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1949     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  38
* EL156.cbl
  1951*    COPY ELCLNKLT.
  1952******************************************************************
  1953*                                                                *
  1954*                                                                *
  1955*                           ELCLNKLT                             *
  1956*                            VMOD=2.003                          *
  1957*                                                                *
  1958*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1959*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1960*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1961*                                                                *
  1962*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1963*   COMPLETING THE REQUIRED FIELDS.                              *
  1964*                                                                *
  1965*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1966*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1967*                              9999 INDICATES AN UNKNOWN ABEND   *
  1968*                                   WAS DETECTED.                *
  1969*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1970*                              CODES FOUND IN THE ERROR FILE.    *
  1971******************************************************************
  1972 01  W-1523-LINKDATA.
  1973     12  W-1523-COMMON-PI-DATA.
  1974         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1975         16  FILLER              PIC  X(67).
  1976         16  W-1523-COMPANY-CD   PIC  X(01).
  1977         16  FILLER              PIC  X(10).
  1978         16  W-1523-CONTROL-IN-PROGRESS.
  1979             20  W-1523-CARRIER  PIC  X(01).
  1980             20  W-1523-GROUPING PIC  X(06).
  1981             20  W-1523-STATE    PIC  X(02).
  1982             20  W-1523-ACCOUNT  PIC  X(10).
  1983             20  W-1523-CLAIM-CERT-GRP.
  1984                 24  W-1523-CLAIM-NO
  1985                                 PIC  X(07).
  1986                 24  W-1523-CERT-NO.
  1987                     28  W-1523-CERT-PRIME
  1988                                 PIC  X(10).
  1989                     28  W-1523-CERT-SFX
  1990                                 PIC  X(01).
  1991                 24  W-1523-CERT-EFF-DT
  1992                                 PIC  X(02).
  1993         16  FILLER              PIC X(265).
  1994
  1995     12  W-1523-WORK-AREA.
  1996         16  W-1523-FORM-NUMBER  PIC  X(04).
  1997         16  W-1523-NUMBER-COPIES
  1998                                 PIC  9(01).
  1999         16  W-1523-ADDR-TYPE    PIC  X(02).
  2000         16  W-1523-FOLLOW-UP-DATE
  2001                                 PIC  X(02).
  2002         16  W-1523-RESEND-DATE  PIC  X(02).
  2003         16  W-1523-ERROR-CODE   PIC  9(04).
  2004             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2005             88  W-1523-FATAL-ERROR
  2006                                    VALUES  0006 0013 0042
  2007                                            0154 0168 0169
  2008                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  39
* EL156.cbl
  2009                                            0179 0186 0281
  2010                                            0332 2055 3697
  2011                                            3698 3699 3770
  2012                                            3771 3772 7675
  2013                                            9106 9808 9883
  2014                                            9887.
  2015             88  W-1523-STOP-ERRORS
  2016                                    VALUES  0013 0042 0154
  2017                                            0168 0169 0172
  2018                                            0281 0332 2055
  2019                                            3698 3699 7675
  2020                                            9106 9808 9883
  2021                                            9999.
  2022         16  W-1523-REASON       PIC  X(70).
  2023         16  W-1523-ARCHIVE-NUMBER
  2024                                 PIC  9(08).
  2025     12  W-1523-POINTER-AREA.
  2026         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2027         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2028         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2029         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2030         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  40
* EL156.cbl
  2032*    COPY ELCNWA.
  2033*****************************************************************
  2034*                                                               *
  2035*                                                               *
  2036*                            ELCNWA.                            *
  2037*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2038*                            VMOD=2.003                         *
  2039*                                                               *
  2040*            M O V E   N A M E   W O R K   A R E A.             *
  2041*                                                               *
  2042*****************************************************************.
  2043
  2044 01  WS-NAME-WORK-AREA.
  2045     05  WS-INSURED-LAST-NAME        PIC X(15).
  2046     05  WS-INSURED-1ST-NAME         PIC X(12).
  2047     05  WS-INSURED-MID-INIT         PIC X.
  2048
  2049     05  WS-NAME-WORK.
  2050         10  WS-NW                   PIC X
  2051             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2052
  2053     05  WS-NAME-WORK2.
  2054         10  WS-NW2                  PIC X
  2055             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2056                                        NWA-INDEX0.
  2057
  2058     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2059                                     COMP-3.
  2060
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  41
* EL156.cbl
  2062*    COPY ELCDMO.
  2063******************************************************************
  2064*                                                                *
  2065*                                                                *
  2066*                            ELCDMO.                             *
  2067*                            VMOD=2.004                          *
  2068*                                                                *
  2069*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2070*        COMMUNICATION AREA                                      *
  2071*   FILE TYPE = NA                                               *
  2072*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2073*                                                                *
  2074******************************************************************
  2075 01  DMO-COMMUNICATION-AREA.
  2076     12  DM-RECORD-TYPE                  PIC  X(02).
  2077             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2078             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2079             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2080     12  DM-DIST-CODE                    PIC  X(04).
  2081     12  DM-MAIL-CODE                    PIC  X(05).
  2082     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2083     12  DM-INSURED-NAME                 PIC  X(30).
  2084     12  DM-CLAIM-NO                     PIC  X(07).
  2085     12  DM-CLAIM-TYPE                   PIC  X.
  2086
  2087     12  DM-STATUS-DATA-AREA.
  2088         16  DM-CLAIM-STATUS             PIC  X.
  2089             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2090             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2091             88  DM-CLOSED                        VALUE '3'.
  2092             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2093             88  DM-DEFAULT                       VALUE '9'.
  2094         16  DM-STATUS-DATE              PIC  X(08).
  2095******YYYYMMDD
  2096         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2097             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2098             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2099             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2100             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2101             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2102             88  DM-RE-OPENED                     VALUE 'R'.
  2103             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2104             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2105             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2106         16  DM-STAT-CARRIER             PIC X.
  2107
  2108     12  DM-DRAFT-DATA-AREA.
  2109         16  DM-PAYMENT-TYPE             PIC  X.
  2110             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2111         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2112         16  DM-PAYMENT-DATE             PIC  X(08).
  2113******YYYYMMDD
  2114         16  DM-CERT-NO                  PIC  X(11).
  2115         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2116         16  DM-CARRIER                  PIC  X.
  2117
  2118     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  42
* EL156.cbl
  2120*    COPY ELCDMDCD.
  2121******************************************************************
  2122*                                                                *
  2123*                                                                *
  2124*                            ELCDMDCD.                           *
  2125*                            VMOD=2.001                          *
  2126*                                                                *
  2127*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2128*       COMMUNICATIONS AREA                                      *
  2129*                                                                *
  2130******************************************************************
  2131 01  CD-COMMUNICATION-AREA.
  2132     12  CD-SYSTEM-ID            PIC  X(02).
  2133         88 CD-CLAIMS                      VALUE 'CL'.
  2134         88 CD-CREDIT                      VALUE 'CR'.
  2135     12  CD-RECORD-TYPE          PIC  X(02).
  2136         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2137         88 CD-EOB-CODE                    VALUE 'EO'.
  2138         88 CD-ICD9-CODE                   VALUE 'I9'.
  2139         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2140         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2141         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2142         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2143         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2144     12  CD-RECORD-KEY           PIC  X(06).
  2145         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2146     12  CD-RETURN-CODE          PIC  X(02).
  2147     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2148     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2149     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2150     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  43
* EL156.cbl
  2152*    COPY ELCDCTB.
  2153******************************************************************
  2154*                                                                *
  2155*                                                                *
  2156*                            ELCDCTB.                            *
  2157*                            VMOD=2.002                          *
  2158*                                                                *
  2159*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2160*       COMMUNICATIONS AREA                                      *
  2161*                                                                *
  2162******************************************************************
  2163 01  DCT-COMMUNICATION-AREA.
  2164     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2165     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2166     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2167     12  DCT-PRODUCT-CODE         PIC  X(02).
  2168     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2169     12  DCT-RETURN-CODE          PIC  X(02).
  2170     12  DCT-MAIL-CODE            PIC  X(05).
  2171     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2172     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  44
* EL156.cbl
  2174 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2175 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2176 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2177 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  45
* EL156.cbl
  2179*    COPY ELCINTF.
  2180******************************************************************
  2181*                                                                *
  2182*                                                                *
  2183*                            ELCINTF.                            *
  2184*                            VMOD=2.017                          *
  2185*                                                                *
  2186*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2187*                                                                *
  2188*       LENGTH = 1024                                            *
  2189*                                                                *
  2190******************************************************************
  2191*                   C H A N G E   L O G
  2192*
  2193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2194*-----------------------------------------------------------------
  2195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2196* EFFECTIVE    NUMBER
  2197*-----------------------------------------------------------------
  2198* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2199******************************************************************
  2200 01  PROGRAM-INTERFACE-BLOCK.
  2201     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2202     12  PI-CALLING-PROGRAM              PIC X(8).
  2203     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2204     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2205     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2206     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2207     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2208     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2209     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2210     12  PI-COMPANY-ID                   PIC XXX.
  2211     12  PI-COMPANY-CD                   PIC X.
  2212
  2213     12  PI-COMPANY-PASSWORD             PIC X(8).
  2214
  2215     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2216
  2217     12  PI-CONTROL-IN-PROGRESS.
  2218         16  PI-CARRIER                  PIC X.
  2219         16  PI-GROUPING                 PIC X(6).
  2220         16  PI-STATE                    PIC XX.
  2221         16  PI-ACCOUNT                  PIC X(10).
  2222         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2223                                         PIC X(10).
  2224         16  PI-CLAIM-CERT-GRP.
  2225             20  PI-CLAIM-NO             PIC X(7).
  2226             20  PI-CERT-NO.
  2227                 25  PI-CERT-PRIME       PIC X(10).
  2228                 25  PI-CERT-SFX         PIC X.
  2229             20  PI-CERT-EFF-DT          PIC XX.
  2230         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2231             20  PI-PLAN-CODE            PIC X(2).
  2232             20  PI-REVISION-NUMBER      PIC X(3).
  2233             20  PI-PLAN-EFF-DT          PIC X(2).
  2234             20  PI-PLAN-EXP-DT          PIC X(2).
  2235             20  FILLER                  PIC X(11).
  2236         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  46
* EL156.cbl
  2237             20  PI-OE-REFERENCE-1.
  2238                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2239                 25  PI-OE-REF-1-SUFF    PIC XX.
  2240
  2241     12  PI-SESSION-IN-PROGRESS          PIC X.
  2242         88  CLAIM-SESSION                   VALUE '1'.
  2243         88  CREDIT-SESSION                  VALUE '2'.
  2244         88  WARRANTY-SESSION                VALUE '3'.
  2245         88  MORTGAGE-SESSION                VALUE '4'.
  2246         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2247
  2248
  2249*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2250
  2251     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2252     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2253
  2254     12  PI-CREDIT-USER                  PIC X.
  2255         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2256         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2257
  2258     12  PI-CLAIM-USER                   PIC X.
  2259         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2260         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2261
  2262     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2263         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2264         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2265         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2266         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2267         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2268
  2269     12  PI-PROCESSOR-ID                 PIC X(4).
  2270
  2271     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2272
  2273     12  PI-MEMBER-CAPTION               PIC X(10).
  2274
  2275     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2276         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2277
  2278     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2279     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2280     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2281     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2282
  2283     12  PI-AH-OVERRIDE-L1               PIC X.
  2284     12  PI-AH-OVERRIDE-L2               PIC XX.
  2285     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2286     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2287
  2288     12  PI-NEW-SYSTEM                   PIC X(2).
  2289
  2290     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2291     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2292         88  PI-USES-PAID-TO                 VALUE '1'.
  2293     12  PI-CRDTCRD-SYSTEM.
  2294         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  47
* EL156.cbl
  2295             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2296             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2297         16  PI-CC-MONTH-END-DT          PIC XX.
  2298     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2299
  2300     12  PI-OE-REFERENCE-2.
  2301         16  PI-OE-REF-2-PRIME           PIC X(10).
  2302         16  PI-OE-REF-2-SUFF            PIC X.
  2303
  2304     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2305
  2306     12  PI-LANGUAGE-TYPE                PIC X.
  2307             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2308             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2309             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2310
  2311     12  PI-POLICY-LINKAGE-IND           PIC X.
  2312         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2313         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2314                                                   LOW-VALUES.
  2315
  2316     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2317     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2318         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2319         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2320
  2321     12  PI-PROCESSOR-CSR-IND            PIC X.
  2322         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2323         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2324
  2325     12  FILLER                          PIC X(3).
  2326
  2327     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2328
  2329     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2330         PI-SYSTEM-LEVEL.
  2331
  2332         16  PI-ENTRY-CODES.
  2333             20  PI-ENTRY-CD-1           PIC X.
  2334             20  PI-ENTRY-CD-2           PIC X.
  2335
  2336         16  PI-RETURN-CODES.
  2337             20  PI-RETURN-CD-1          PIC X.
  2338             20  PI-RETURN-CD-2          PIC X.
  2339
  2340         16  PI-UPDATE-STATUS-SAVE.
  2341             20  PI-UPDATE-BY            PIC X(4).
  2342             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2343
  2344         16  PI-LOWER-CASE-LETTERS       PIC X.
  2345             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2346
  2347*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2348*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2349*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2350
  2351         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2352             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  48
* EL156.cbl
  2353             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2354             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2355             88  ACCNT-CNTL                  VALUE '3'.
  2356             88  CARR-ACCNT-CNTL             VALUE '4'.
  2357
  2358         16  PI-PROCESSOR-CAP-LIST.
  2359             20  PI-SYSTEM-CONTROLS.
  2360                24 PI-SYSTEM-DISPLAY     PIC X.
  2361                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2362                24 PI-SYSTEM-MODIFY      PIC X.
  2363                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2364             20  FILLER                  PIC XX.
  2365             20  PI-DISPLAY-CAP          PIC X.
  2366                 88  DISPLAY-CAP             VALUE 'Y'.
  2367             20  PI-MODIFY-CAP           PIC X.
  2368                 88  MODIFY-CAP              VALUE 'Y'.
  2369             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2370                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2371             20  PI-FORCE-CAP            PIC X.
  2372                 88  FORCE-CAP               VALUE 'Y'.
  2373
  2374         16  PI-PROGRAM-CONTROLS.
  2375             20  PI-PGM-PRINT-OPT        PIC X.
  2376             20  PI-PGM-FORMAT-OPT       PIC X.
  2377             20  PI-PGM-PROCESS-OPT      PIC X.
  2378             20  PI-PGM-TOTALS-OPT       PIC X.
  2379
  2380         16  PI-HELP-INTERFACE.
  2381             20  PI-LAST-ERROR-NO        PIC X(4).
  2382             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2383
  2384         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2385             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2386
  2387         16  PI-CR-CONTROL-IN-PROGRESS.
  2388             20  PI-CR-CARRIER           PIC X.
  2389             20  PI-CR-GROUPING          PIC X(6).
  2390             20  PI-CR-STATE             PIC XX.
  2391             20  PI-CR-ACCOUNT           PIC X(10).
  2392             20  PI-CR-FIN-RESP          PIC X(10).
  2393             20  PI-CR-TYPE              PIC X.
  2394
  2395         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2396
  2397         16  PI-CR-MONTH-END-DT          PIC XX.
  2398
  2399         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2400             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2401             88  PI-ZERO-CARRIER             VALUE '1'.
  2402             88  PI-ZERO-GROUPING            VALUE '2'.
  2403             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2404
  2405         16  PI-CARRIER-SECURITY         PIC X.
  2406             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2407
  2408         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2409             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2410             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  49
* EL156.cbl
  2411
  2412         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2413             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2414                                         INDEXED BY PI-ACCESS-NDX
  2415                                         PIC X.
  2416
  2417         16  PI-GA-BILLING-CONTROL       PIC X.
  2418             88  PI-GA-BILLING               VALUE '1'.
  2419
  2420         16  PI-MAIL-PROCESSING          PIC X.
  2421             88  PI-MAIL-YES                 VALUE 'Y'.
  2422
  2423         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2424
  2425         16  PI-AR-SYSTEM.
  2426             20  PI-AR-PROCESSING-CNTL   PIC X.
  2427                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2428             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2429             20  PI-AR-MONTH-END-DT      PIC XX.
  2430
  2431         16  PI-MP-SYSTEM.
  2432             20  PI-MORTGAGE-USER            PIC X.
  2433                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2434                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2435             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2436                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2437                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2438                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2439                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2440                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2441             20  PI-MP-MONTH-END-DT          PIC XX.
  2442             20  PI-MP-REFERENCE-NO.
  2443                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2444                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2445
  2446         16  PI-LABEL-CONTROL            PIC X(01).
  2447             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2448             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2449
  2450         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2451             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2452
  2453         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2454             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2455             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2456
  2457         16  FILLER                      PIC X(14).
  2458
  2459     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2460******************************************************************
  2461     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2462         16  PI-SAVE-FORM        PIC X(12).
  2463         16  PI-ACCT-KEY         PIC X(26).
  2464         16  PI-PAYEE-NAME       PIC X(30).
  2465         16  PI-DAILY-RATE       PIC S9(3)V99.
  2466         16  PI-MONTH-END-SAVE   PIC XX.
  2467         16  PI-BENEFIT-SAVE.
  2468             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  50
* EL156.cbl
  2469             20  PI-BEN-TYPE     PIC X.
  2470         16  PI-MANUAL-SW        PIC 9.
  2471         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2472         16  PI-PASS-SW          PIC X.
  2473         16  PI-PFKEY-USED       PIC X.
  2474         16  PI-CK-ASSIGN        PIC X.
  2475         16  PI-FATAL-COUNT      PIC 99.
  2476         16  PI-FORCE-COUNT      PIC 99.
  2477         16  PI-SAVE-INPUT.
  2478             20  PI-PMTTYPE      PIC X.
  2479             20  PI-PAYEE.
  2480                 24  PI-PAYEE-TYPE PIC X.
  2481                 24  PI-PAYEE-SEQ  PIC X.
  2482                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2483                   PI-PAYEE-SEQ    PIC S9.
  2484             20  PI-PMTNOTE1     PIC X(60).
  2485             20  PI-PMTNOTE2     PIC X(60).
  2486             20  PI-OFFLINE      PIC X.
  2487             20  PI-ECHECKNO     PIC X(7).
  2488             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2489                 28  PI-ECHECKNO-N     PIC X.
  2490                 28  PI-ECHECKNO-6     PIC X(6).
  2491             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2492                 24  PI-ECHECKNO-CR    PIC XX.
  2493                 24  PI-ECHECKNO-5     PIC X(5).
  2494             20  PI-HOLDTIL      PIC 9(6).
  2495             20  PI-EPYFROM      PIC 9(6).
  2496             20  PI-EPYTHRU      PIC 9(6).
  2497             20  PI-EDAYS        PIC S9(5).
  2498             20  PI-EPYAMT       PIC S9(7)V99.
  2499             20  PI-ERESV        PIC S9(7)V99.
  2500             20  PI-EEXPENS      PIC 9(6)V99.
  2501             20  PI-ETYPE        PIC X.
  2502             20  PI-CASH         PIC X.
  2503             20  PI-GROUPED      PIC X.
  2504             20  PI-INT-RATE     PIC S99V9(5).
  2505             20  PI-AIGFROM      PIC 9(6).
  2506             20  PI-LOAN-NO      PIC X(20).
  2507             20  PI-PROOF-DATE   PIC 9(6).
  2508             20  PI-PRINT-EOB-YN PIC X.
  2509             20  PI-PRINT-CLM-FRM-YN PIC X.
  2510             20  PI-PRINT-SURVEY-YN PIC X.
  2511             20  PI-SPECIAL-RELEASE-YN PIC X.
  2512             20  pi-int-to-rem-borr pic x.
  2513         16  PI-SAVE-COMPUTED.
  2514             20  PI-CCHECKNO     PIC X(7).
  2515             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2516                 28  PI-CCHECKNO-N     PIC X.
  2517                 28  PI-CCHECKNO-6     PIC X(6).
  2518             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2519                 24  PI-CCHECKNO-CR    PIC XX.
  2520                 24  PI-CCHECKNO-5     PIC X(5).
  2521             20  PI-CPYFROM      PIC XX.
  2522             20  PI-CPYTHRU      PIC XX.
  2523             20  PI-CDAYS        PIC S9(5).
  2524             20  PI-CPYAMT       PIC S9(7)V99.
  2525             20  PI-CRESV        PIC 9(6)V99.
  2526             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  51
* EL156.cbl
  2527             20  PI-PMT-APPR-SW  PIC X.
  2528                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2529                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2530                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2531         16  PI-PREV-CLMNO       PIC X(7).
  2532         16  PI-LF-COVERAGE-TYPE PIC X.
  2533         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2534         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2535         16  PI-PROVISIONAL-IND  PIC X.
  2536             88 PI-PROV-PMT      VALUE 'P'.
  2537         16  PI-PREV-TRLR-KEY    PIC X(22).
  2538         16  PI-SPLIT-PMT-SW     PIC X.
  2539         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2540         16  PI-ACTIVITY-CODE    PIC 99.
  2541         16  PI-RESET-SW         PIC X.
  2542         16  PI-SPECIAL-BEN-SW   PIC X.
  2543             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2544         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2545         16  PI-EXP-DT           PIC XX.
  2546         16  PI-LOAN-DUE-DAY     PIC 99.
  2547         16  PI-3RD-PARTY-SW     PIC X.
  2548         16  PI-LOAN-UPDATE-SW   PIC X.
  2549
  2550         16  PI-DMD-DATA.
  2551             20  PI-SV-CERT-KEY       PIC X(21).
  2552             20  PI-SV-CERT-NO        PIC X(11).
  2553             20  PI-SV-BEN            PIC X(10).
  2554             20  PI-SV-CCN            PIC X(16).
  2555             20  PI-INTEREST-PAID-IND PIC X.
  2556                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2557             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2558             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2559             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2560             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2561         16  PI-AT-EOB-CODES.
  2562             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2563         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2564         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2565         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2566         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2567         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2568         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2569         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2570         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2571         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2572         16  PI-LF-BENEFIT-CD         PIC X(2).
  2573         16  PI-EOB-CODES-EXIST PIC X.
  2574         16  PI-SET-NOTE2-MDT   PIC X.
  2575         16  PI-VFY-2ND-BENE          PIC X.
  2576         16  PI-CLM-TYPE              PIC X.
  2577         16  PI-APPROVAL-LEVEL        PIC X.
  2578         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2579         16  PI-REAUDIT-NEEDED        PIC X.
  2580         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2581         16  PI-AH-BENEFIT-CD         PIC XX.
  2582         16  pi-ah-term               pic s999 comp-3.
  2583         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2584         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  52
* EL156.cbl
  2585         16  pi-max-ext-used          pic x.
  2586         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2587         16  PI-JOINT-COV-IND         PIC X.
  2588             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2589             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2590         16  PI-JOINT-INSURED-IND     PIC X.
  2591             88  PI-JOINT-INSURED        VALUE 'Y'.
  2592             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2593         16  pi-int-payees-name       pic x(30).
  2594         16  PI-RB-JOINT-COV-IND      PIC X.
  2595             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2596             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2597         16  pi-ach-payment           pic x.
  2598*00781          16  FILLER                   PIC X(176).
  2599*052506         16  FILLER                   PIC X(161).
  2600*031808         16  FILLER                   PIC X(154).
  2601*091808         16  FILLER                   PIC X(152).
  2602*041710         16  FILLER                   PIC X(94).
  2603         16  FILLER                   PIC X(34).
  2604
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  53
* EL156.cbl
  2606*    COPY ELCJPFX.
  2607******************************************************************
  2608*                                                                *
  2609*                                                                *
  2610*                            ELCJPFX.                            *
  2611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2612*                            VMOD=2.002                          *
  2613*                                                                *
  2614*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2615*                                                                *
  2616*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2617*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2618*        ELCNTL - CONTROL FILE                                   *
  2619*        ELMSTR - CLAIM MASTERS                                  *
  2620*        ELTRLR - ACTIVITY TRAILERS                              *
  2621*        ELCHKQ - CHECK QUE                                      *
  2622******************************************************************
  2623 01  JOURNAL-RECORD.
  2624     12  jp-date                     pic s9(5) comp-3.
  2625     12  jp-time                     pic s9(7) comp-3.
  2626     12  JP-USER-ID                  PIC X(4).
  2627     12  JP-FILE-ID                  PIC X(8).
  2628     12  JP-PROGRAM-ID               PIC X(8).
  2629     12  JP-RECORD-TYPE              PIC X.
  2630         88 JP-ADD              VALUE 'A'.
  2631         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2632         88 JP-AFTER-CHANGE     VALUE 'C'.
  2633         88 JP-DELETE           VALUE 'D'.
  2634         88 JP-GENERIC-DELETE   VALUE 'G'.
  2635         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2636         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2637     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2638     12  JP-RECORD-AREA
  2639
  2640
  2641                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  54
* EL156.cbl
  2643*    COPY ELCAID.
  2644******************************************************************
  2645*                                                                *
  2646*                            ELCAID.                             *
  2647*                            VMOD=2.001                          *
  2648*                                                                *
  2649*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2650*                                                                *
  2651*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2652*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2653******************************************************************
  2654
  2655 01  DFHAID.
  2656   02  DFHNULL   PIC  X  VALUE  ' '.
  2657   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2658   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2659   02  DFHPEN    PIC  X  VALUE  '='.
  2660   02  DFHOPID   PIC  X  VALUE  'W'.
  2661   02  DFHPA1    PIC  X  VALUE  '%'.
  2662   02  DFHPA2    PIC  X  VALUE  '>'.
  2663   02  DFHPA3    PIC  X  VALUE  ','.
  2664   02  DFHPF1    PIC  X  VALUE  '1'.
  2665   02  DFHPF2    PIC  X  VALUE  '2'.
  2666   02  DFHPF3    PIC  X  VALUE  '3'.
  2667   02  DFHPF4    PIC  X  VALUE  '4'.
  2668   02  DFHPF5    PIC  X  VALUE  '5'.
  2669   02  DFHPF6    PIC  X  VALUE  '6'.
  2670   02  DFHPF7    PIC  X  VALUE  '7'.
  2671   02  DFHPF8    PIC  X  VALUE  '8'.
  2672   02  DFHPF9    PIC  X  VALUE  '9'.
  2673   02  DFHPF10   PIC  X  VALUE  ':'.
  2674   02  DFHPF11   PIC  X  VALUE  '#'.
  2675   02  DFHPF12   PIC  X  VALUE  '@'.
  2676   02  DFHPF13   PIC  X  VALUE  'A'.
  2677   02  DFHPF14   PIC  X  VALUE  'B'.
  2678   02  DFHPF15   PIC  X  VALUE  'C'.
  2679   02  DFHPF16   PIC  X  VALUE  'D'.
  2680   02  DFHPF17   PIC  X  VALUE  'E'.
  2681   02  DFHPF18   PIC  X  VALUE  'F'.
  2682   02  DFHPF19   PIC  X  VALUE  'G'.
  2683   02  DFHPF20   PIC  X  VALUE  'H'.
  2684   02  DFHPF21   PIC  X  VALUE  'I'.
  2685*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2686   02  DFHPF22   PIC  X  VALUE  '['.
  2687   02  DFHPF23   PIC  X  VALUE  '.'.
  2688   02  DFHPF24   PIC  X  VALUE  '<'.
  2689   02  DFHMSRE   PIC  X  VALUE  'X'.
  2690   02  DFHSTRF   PIC  X  VALUE  'h'.
  2691   02  DFHTRIG   PIC  X  VALUE  '"'.
  2692 01  FILLER    REDEFINES DFHAID.
  2693     12  FILLER              PIC X(8).
  2694     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  55
* EL156.cbl
  2696*    COPY EL156S.
  2697 01  EL156AI.
  2698     05  FILLER            PIC  X(0012).
  2699*    -------------------------------
  2700     05  RUNDTEAL PIC S9(0004) COMP.
  2701     05  RUNDTEAF PIC  X(0001).
  2702     05  FILLER REDEFINES RUNDTEAF.
  2703         10  RUNDTEAA PIC  X(0001).
  2704     05  RUNDTEAI PIC  X(0008).
  2705*    -------------------------------
  2706     05  RUNTIMAL PIC S9(0004) COMP.
  2707     05  RUNTIMAF PIC  X(0001).
  2708     05  FILLER REDEFINES RUNTIMAF.
  2709         10  RUNTIMAA PIC  X(0001).
  2710     05  RUNTIMAI PIC  X(0005).
  2711*    -------------------------------
  2712     05  SEQUL PIC S9(0004) COMP.
  2713     05  SEQUF PIC  X(0001).
  2714     05  FILLER REDEFINES SEQUF.
  2715         10  SEQUA PIC  X(0001).
  2716     05  SEQUI PIC  X(0010).
  2717*    -------------------------------
  2718     05  CLMNOL PIC S9(0004) COMP.
  2719     05  CLMNOF PIC  X(0001).
  2720     05  FILLER REDEFINES CLMNOF.
  2721         10  CLMNOA PIC  X(0001).
  2722     05  CLMNOI PIC  X(0007).
  2723*    -------------------------------
  2724     05  CARRL PIC S9(0004) COMP.
  2725     05  CARRF PIC  X(0001).
  2726     05  FILLER REDEFINES CARRF.
  2727         10  CARRA PIC  X(0001).
  2728     05  CARRI PIC  X(0001).
  2729*    -------------------------------
  2730     05  CERTNOL PIC S9(0004) COMP.
  2731     05  CERTNOF PIC  X(0001).
  2732     05  FILLER REDEFINES CERTNOF.
  2733         10  CERTNOA PIC  X(0001).
  2734     05  CERTNOI PIC  X(0010).
  2735*    -------------------------------
  2736     05  SUFXL PIC S9(0004) COMP.
  2737     05  SUFXF PIC  X(0001).
  2738     05  FILLER REDEFINES SUFXF.
  2739         10  SUFXA PIC  X(0001).
  2740     05  SUFXI PIC  X(0001).
  2741*    -------------------------------
  2742     05  CLMTYPL PIC S9(0004) COMP.
  2743     05  CLMTYPF PIC  X(0001).
  2744     05  FILLER REDEFINES CLMTYPF.
  2745         10  CLMTYPA PIC  X(0001).
  2746     05  CLMTYPI PIC  X(0006).
  2747*    -------------------------------
  2748     05  CLMSTATL PIC S9(0004) COMP.
  2749     05  CLMSTATF PIC  X(0001).
  2750     05  FILLER REDEFINES CLMSTATF.
  2751         10  CLMSTATA PIC  X(0001).
  2752     05  CLMSTATI PIC  X(0006).
  2753*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  56
* EL156.cbl
  2754     05  LSTNMEL PIC S9(0004) COMP.
  2755     05  LSTNMEF PIC  X(0001).
  2756     05  FILLER REDEFINES LSTNMEF.
  2757         10  LSTNMEA PIC  X(0001).
  2758     05  LSTNMEI PIC  X(0015).
  2759*    -------------------------------
  2760     05  FSTNMEL PIC S9(0004) COMP.
  2761     05  FSTNMEF PIC  X(0001).
  2762     05  FILLER REDEFINES FSTNMEF.
  2763         10  FSTNMEA PIC  X(0001).
  2764     05  FSTNMEI PIC  X(0012).
  2765*    -------------------------------
  2766     05  MINITL PIC S9(0004) COMP.
  2767     05  MINITF PIC  X(0001).
  2768     05  FILLER REDEFINES MINITF.
  2769         10  MINITA PIC  X(0001).
  2770     05  MINITI PIC  X(0001).
  2771*    -------------------------------
  2772     05  PRIMHDGL PIC S9(0004) COMP.
  2773     05  PRIMHDGF PIC  X(0001).
  2774     05  FILLER REDEFINES PRIMHDGF.
  2775         10  PRIMHDGA PIC  X(0001).
  2776     05  PRIMHDGI PIC  X(0012).
  2777*    -------------------------------
  2778     05  PCERTNOL PIC S9(0004) COMP.
  2779     05  PCERTNOF PIC  X(0001).
  2780     05  FILLER REDEFINES PCERTNOF.
  2781         10  PCERTNOA PIC  X(0001).
  2782     05  PCERTNOI PIC  X(0010).
  2783*    -------------------------------
  2784     05  PSUFXL PIC S9(0004) COMP.
  2785     05  PSUFXF PIC  X(0001).
  2786     05  FILLER REDEFINES PSUFXF.
  2787         10  PSUFXA PIC  X(0001).
  2788     05  PSUFXI PIC  X(0001).
  2789*    -------------------------------
  2790     05  STATUSL PIC S9(0004) COMP.
  2791     05  STATUSF PIC  X(0001).
  2792     05  FILLER REDEFINES STATUSF.
  2793         10  STATUSA PIC  X(0001).
  2794     05  STATUSI PIC  X(0010).
  2795*    -------------------------------
  2796     05  LOANHL PIC S9(0004) COMP.
  2797     05  LOANHF PIC  X(0001).
  2798     05  FILLER REDEFINES LOANHF.
  2799         10  LOANHA PIC  X(0001).
  2800     05  LOANHI PIC  X(0014).
  2801*    -------------------------------
  2802     05  LOANNOL PIC S9(0004) COMP.
  2803     05  LOANNOF PIC  X(0001).
  2804     05  FILLER REDEFINES LOANNOF.
  2805         10  LOANNOA PIC  X(0001).
  2806     05  LOANNOI PIC  X(0025).
  2807*    -------------------------------
  2808     05  DUEDAYHL PIC S9(0004) COMP.
  2809     05  DUEDAYHF PIC  X(0001).
  2810     05  FILLER REDEFINES DUEDAYHF.
  2811         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  57
* EL156.cbl
  2812     05  DUEDAYHI PIC  X(0008).
  2813*    -------------------------------
  2814     05  DUEDAYL PIC S9(0004) COMP.
  2815     05  DUEDAYF PIC  X(0001).
  2816     05  FILLER REDEFINES DUEDAYF.
  2817         10  DUEDAYA PIC  X(0001).
  2818     05  DUEDAYI PIC  X(0002).
  2819*    -------------------------------
  2820     05  ZINTHL PIC S9(0004) COMP.
  2821     05  ZINTHF PIC  X(0001).
  2822     05  FILLER REDEFINES ZINTHF.
  2823         10  ZINTHA PIC  X(0001).
  2824     05  ZINTHI PIC  X(0009).
  2825*    -------------------------------
  2826     05  ZINTL PIC S9(0004) COMP.
  2827     05  ZINTF PIC  X(0001).
  2828     05  FILLER REDEFINES ZINTF.
  2829         10  ZINTA PIC  X(0001).
  2830     05  ZINTI PIC  99V99999.
  2831*    -------------------------------
  2832     05  PTHRHDGL PIC S9(0004) COMP.
  2833     05  PTHRHDGF PIC  X(0001).
  2834     05  FILLER REDEFINES PTHRHDGF.
  2835         10  PTHRHDGA PIC  X(0001).
  2836     05  PTHRHDGI PIC  X(0014).
  2837*    -------------------------------
  2838     05  PDTHRUL PIC S9(0004) COMP.
  2839     05  PDTHRUF PIC  X(0001).
  2840     05  FILLER REDEFINES PDTHRUF.
  2841         10  PDTHRUA PIC  X(0001).
  2842     05  PDTHRUI PIC  X(0008).
  2843*    -------------------------------
  2844     05  TOTPAIDL PIC S9(0004) COMP.
  2845     05  TOTPAIDF PIC  X(0001).
  2846     05  FILLER REDEFINES TOTPAIDF.
  2847         10  TOTPAIDA PIC  X(0001).
  2848     05  TOTPAIDI PIC  X(0010).
  2849*    -------------------------------
  2850     05  COVERL PIC S9(0004) COMP.
  2851     05  COVERF PIC  X(0001).
  2852     05  FILLER REDEFINES COVERF.
  2853         10  COVERA PIC  X(0001).
  2854     05  COVERI PIC  X(0010).
  2855*    -------------------------------
  2856     05  INCURL PIC S9(0004) COMP.
  2857     05  INCURF PIC  X(0001).
  2858     05  FILLER REDEFINES INCURF.
  2859         10  INCURA PIC  X(0001).
  2860     05  INCURI PIC  X(0008).
  2861*    -------------------------------
  2862     05  LSTDTEL PIC S9(0004) COMP.
  2863     05  LSTDTEF PIC  X(0001).
  2864     05  FILLER REDEFINES LSTDTEF.
  2865         10  LSTDTEA PIC  X(0001).
  2866     05  LSTDTEI PIC  X(0008).
  2867*    -------------------------------
  2868     05  CRTSTATL PIC S9(0004) COMP.
  2869     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  58
* EL156.cbl
  2870     05  FILLER REDEFINES CRTSTATF.
  2871         10  CRTSTATA PIC  X(0001).
  2872     05  CRTSTATI PIC  X(0010).
  2873*    -------------------------------
  2874     05  EFFECTL PIC S9(0004) COMP.
  2875     05  EFFECTF PIC  X(0001).
  2876     05  FILLER REDEFINES EFFECTF.
  2877         10  EFFECTA PIC  X(0001).
  2878     05  EFFECTI PIC  X(0008).
  2879*    -------------------------------
  2880     05  TERMSL PIC S9(0004) COMP.
  2881     05  TERMSF PIC  X(0001).
  2882     05  FILLER REDEFINES TERMSF.
  2883         10  TERMSA PIC  X(0001).
  2884     05  TERMSI PIC  X(0011).
  2885*    -------------------------------
  2886     05  STACCTL PIC S9(0004) COMP.
  2887     05  STACCTF PIC  X(0001).
  2888     05  FILLER REDEFINES STACCTF.
  2889         10  STACCTA PIC  X(0001).
  2890     05  STACCTI PIC  X(0013).
  2891*    -------------------------------
  2892     05  EXPDTEHL PIC S9(0004) COMP.
  2893     05  EXPDTEHF PIC  X(0001).
  2894     05  FILLER REDEFINES EXPDTEHF.
  2895         10  EXPDTEHA PIC  X(0001).
  2896     05  EXPDTEHI PIC  X(0014).
  2897*    -------------------------------
  2898     05  EXPDTEL PIC S9(0004) COMP.
  2899     05  EXPDTEF PIC  X(0001).
  2900     05  FILLER REDEFINES EXPDTEF.
  2901         10  EXPDTEA PIC  X(0001).
  2902     05  EXPDTEI PIC  X(0008).
  2903*    -------------------------------
  2904     05  BENECAPL PIC S9(0004) COMP.
  2905     05  BENECAPF PIC  X(0001).
  2906     05  FILLER REDEFINES BENECAPF.
  2907         10  BENECAPA PIC  X(0001).
  2908     05  BENECAPI PIC  X(0013).
  2909*    -------------------------------
  2910     05  BENEL PIC S9(0004) COMP.
  2911     05  BENEF PIC  X(0001).
  2912     05  FILLER REDEFINES BENEF.
  2913         10  BENEA PIC  X(0001).
  2914     05  BENEI PIC  X(0009).
  2915*    -------------------------------
  2916     05  FORMTYPL PIC S9(0004) COMP.
  2917     05  FORMTYPF PIC  X(0001).
  2918     05  FILLER REDEFINES FORMTYPF.
  2919         10  FORMTYPA PIC  X(0001).
  2920     05  FORMTYPI PIC  X(0001).
  2921*    -------------------------------
  2922     05  PMTTYPEL PIC S9(0004) COMP.
  2923     05  PMTTYPEF PIC  X(0001).
  2924     05  FILLER REDEFINES PMTTYPEF.
  2925         10  PMTTYPEA PIC  X(0001).
  2926     05  PMTTYPEI PIC  X(0001).
  2927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  59
* EL156.cbl
  2928     05  PAYEEL PIC S9(0004) COMP.
  2929     05  PAYEEF PIC  X(0001).
  2930     05  FILLER REDEFINES PAYEEF.
  2931         10  PAYEEA PIC  X(0001).
  2932     05  PAYEEI PIC  X(0002).
  2933*    -------------------------------
  2934     05  CHECKNOL PIC S9(0004) COMP.
  2935     05  CHECKNOF PIC  X(0001).
  2936     05  FILLER REDEFINES CHECKNOF.
  2937         10  CHECKNOA PIC  X(0001).
  2938     05  CHECKNOI PIC  X(0007).
  2939*    -------------------------------
  2940     05  OFFLINEL PIC S9(0004) COMP.
  2941     05  OFFLINEF PIC  X(0001).
  2942     05  FILLER REDEFINES OFFLINEF.
  2943         10  OFFLINEA PIC  X(0001).
  2944     05  OFFLINEI PIC  X(0001).
  2945*    -------------------------------
  2946     05  HOLDTILL PIC S9(0004) COMP.
  2947     05  HOLDTILF PIC  X(0001).
  2948     05  FILLER REDEFINES HOLDTILF.
  2949         10  HOLDTILA PIC  X(0001).
  2950     05  HOLDTILI PIC  X(0008).
  2951*    -------------------------------
  2952     05  NOTE1L PIC S9(0004) COMP.
  2953     05  NOTE1F PIC  X(0001).
  2954     05  FILLER REDEFINES NOTE1F.
  2955         10  NOTE1A PIC  X(0001).
  2956     05  NOTE1I PIC  X(0060).
  2957*    -------------------------------
  2958     05  ITRB1L PIC S9(0004) COMP.
  2959     05  ITRB1F PIC  X(0001).
  2960     05  FILLER REDEFINES ITRB1F.
  2961         10  ITRB1A PIC  X(0001).
  2962     05  ITRB1I PIC  X(0008).
  2963*    -------------------------------
  2964     05  NOTE2L PIC S9(0004) COMP.
  2965     05  NOTE2F PIC  X(0001).
  2966     05  FILLER REDEFINES NOTE2F.
  2967         10  NOTE2A PIC  X(0001).
  2968     05  NOTE2I PIC  X(0060).
  2969*    -------------------------------
  2970     05  ITRB2L PIC S9(0004) COMP.
  2971     05  ITRB2F PIC  X(0001).
  2972     05  FILLER REDEFINES ITRB2F.
  2973         10  ITRB2A PIC  X(0001).
  2974     05  ITRB2I PIC  X(0010).
  2975*    -------------------------------
  2976     05  EOBYNL PIC S9(0004) COMP.
  2977     05  EOBYNF PIC  X(0001).
  2978     05  FILLER REDEFINES EOBYNF.
  2979         10  EOBYNA PIC  X(0001).
  2980     05  EOBYNI PIC  X(0001).
  2981*    -------------------------------
  2982     05  CLMFMYNL PIC S9(0004) COMP.
  2983     05  CLMFMYNF PIC  X(0001).
  2984     05  FILLER REDEFINES CLMFMYNF.
  2985         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  60
* EL156.cbl
  2986     05  CLMFMYNI PIC  X(0001).
  2987*    -------------------------------
  2988     05  SURVYYNL PIC S9(0004) COMP.
  2989     05  SURVYYNF PIC  X(0001).
  2990     05  FILLER REDEFINES SURVYYNF.
  2991         10  SURVYYNA PIC  X(0001).
  2992     05  SURVYYNI PIC  X(0001).
  2993*    -------------------------------
  2994     05  SPRELYNL PIC S9(0004) COMP.
  2995     05  SPRELYNF PIC  X(0001).
  2996     05  FILLER REDEFINES SPRELYNF.
  2997         10  SPRELYNA PIC  X(0001).
  2998     05  SPRELYNI PIC  X(0001).
  2999*    -------------------------------
  3000     05  PINTHL PIC S9(0004) COMP.
  3001     05  PINTHF PIC  X(0001).
  3002     05  FILLER REDEFINES PINTHF.
  3003         10  PINTHA PIC  X(0001).
  3004     05  PINTHI PIC  X(0004).
  3005*    -------------------------------
  3006     05  PINTL PIC S9(0004) COMP.
  3007     05  PINTF PIC  X(0001).
  3008     05  FILLER REDEFINES PINTF.
  3009         10  PINTA PIC  X(0001).
  3010     05  PINTI PIC  X(0008).
  3011*    -------------------------------
  3012     05  ITRBYNL PIC S9(0004) COMP.
  3013     05  ITRBYNF PIC  X(0001).
  3014     05  FILLER REDEFINES ITRBYNF.
  3015         10  ITRBYNA PIC  X(0001).
  3016     05  ITRBYNI PIC  X(0001).
  3017*    -------------------------------
  3018     05  PROOFDTL PIC S9(0004) COMP.
  3019     05  PROOFDTF PIC  X(0001).
  3020     05  FILLER REDEFINES PROOFDTF.
  3021         10  PROOFDTA PIC  X(0001).
  3022     05  PROOFDTI PIC  X(0008).
  3023*    -------------------------------
  3024     05  AIGFRMHL PIC S9(0004) COMP.
  3025     05  AIGFRMHF PIC  X(0001).
  3026     05  FILLER REDEFINES AIGFRMHF.
  3027         10  AIGFRMHA PIC  X(0001).
  3028     05  AIGFRMHI PIC  X(0012).
  3029*    -------------------------------
  3030     05  AIGFROML PIC S9(0004) COMP.
  3031     05  AIGFROMF PIC  X(0001).
  3032     05  FILLER REDEFINES AIGFROMF.
  3033         10  AIGFROMA PIC  X(0001).
  3034     05  AIGFROMI PIC  X(0008).
  3035*    -------------------------------
  3036     05  PMTHDGAL PIC S9(0004) COMP.
  3037     05  PMTHDGAF PIC  X(0001).
  3038     05  FILLER REDEFINES PMTHDGAF.
  3039         10  PMTHDGAA PIC  X(0001).
  3040     05  PMTHDGAI PIC  X(0066).
  3041*    -------------------------------
  3042     05  EPYFROML PIC S9(0004) COMP.
  3043     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  61
* EL156.cbl
  3044     05  FILLER REDEFINES EPYFROMF.
  3045         10  EPYFROMA PIC  X(0001).
  3046     05  EPYFROMI PIC  X(0008).
  3047*    -------------------------------
  3048     05  EPYTHRUL PIC S9(0004) COMP.
  3049     05  EPYTHRUF PIC  X(0001).
  3050     05  FILLER REDEFINES EPYTHRUF.
  3051         10  EPYTHRUA PIC  X(0001).
  3052     05  EPYTHRUI PIC  X(0008).
  3053*    -------------------------------
  3054     05  EDAYSL PIC S9(0004) COMP.
  3055     05  EDAYSF PIC  X(0001).
  3056     05  FILLER REDEFINES EDAYSF.
  3057         10  EDAYSA PIC  X(0001).
  3058     05  EDAYSI PIC  S9(6).
  3059*    -------------------------------
  3060     05  EPYAMTL PIC S9(0004) COMP.
  3061     05  EPYAMTF PIC  X(0001).
  3062     05  FILLER REDEFINES EPYAMTF.
  3063         10  EPYAMTA PIC  X(0001).
  3064     05  EPYAMTI PIC  S9(8)V99.
  3065*    -------------------------------
  3066     05  ERESVL PIC S9(0004) COMP.
  3067     05  ERESVF PIC  X(0001).
  3068     05  FILLER REDEFINES ERESVF.
  3069         10  ERESVA PIC  X(0001).
  3070     05  ERESVI PIC  S9(7)V99.
  3071*    -------------------------------
  3072     05  ETYPEL PIC S9(0004) COMP.
  3073     05  ETYPEF PIC  X(0001).
  3074     05  FILLER REDEFINES ETYPEF.
  3075         10  ETYPEA PIC  X(0001).
  3076     05  ETYPEI PIC  X(0001).
  3077*    -------------------------------
  3078     05  EEXPENSL PIC S9(0004) COMP.
  3079     05  EEXPENSF PIC  X(0001).
  3080     05  FILLER REDEFINES EEXPENSF.
  3081         10  EEXPENSA PIC  X(0001).
  3082     05  EEXPENSI PIC  9(6)V99.
  3083*    -------------------------------
  3084     05  CPYFROML PIC S9(0004) COMP.
  3085     05  CPYFROMF PIC  X(0001).
  3086     05  FILLER REDEFINES CPYFROMF.
  3087         10  CPYFROMA PIC  X(0001).
  3088     05  CPYFROMI PIC  X(0008).
  3089*    -------------------------------
  3090     05  CPYTHRUL PIC S9(0004) COMP.
  3091     05  CPYTHRUF PIC  X(0001).
  3092     05  FILLER REDEFINES CPYTHRUF.
  3093         10  CPYTHRUA PIC  X(0001).
  3094     05  CPYTHRUI PIC  X(0008).
  3095*    -------------------------------
  3096     05  CDAYSL PIC S9(0004) COMP.
  3097     05  CDAYSF PIC  X(0001).
  3098     05  FILLER REDEFINES CDAYSF.
  3099         10  CDAYSA PIC  X(0001).
  3100     05  CDAYSI PIC  9(6).
  3101*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  62
* EL156.cbl
  3102     05  CPYAMTL PIC S9(0004) COMP.
  3103     05  CPYAMTF PIC  X(0001).
  3104     05  FILLER REDEFINES CPYAMTF.
  3105         10  CPYAMTA PIC  X(0001).
  3106     05  CPYAMTI PIC  S9(8)V99.
  3107*    -------------------------------
  3108     05  CRESVL PIC S9(0004) COMP.
  3109     05  CRESVF PIC  X(0001).
  3110     05  FILLER REDEFINES CRESVF.
  3111         10  CRESVA PIC  X(0001).
  3112     05  CRESVI PIC  9(6)V99.
  3113*    -------------------------------
  3114     05  CEXPENSL PIC S9(0004) COMP.
  3115     05  CEXPENSF PIC  X(0001).
  3116     05  FILLER REDEFINES CEXPENSF.
  3117         10  CEXPENSA PIC  X(0001).
  3118     05  CEXPENSI PIC  9(6)V99.
  3119*    -------------------------------
  3120     05  ERRMSG0L PIC S9(0004) COMP.
  3121     05  ERRMSG0F PIC  X(0001).
  3122     05  FILLER REDEFINES ERRMSG0F.
  3123         10  ERRMSG0A PIC  X(0001).
  3124     05  ERRMSG0I PIC  X(0072).
  3125*    -------------------------------
  3126     05  ERRMSG1L PIC S9(0004) COMP.
  3127     05  ERRMSG1F PIC  X(0001).
  3128     05  FILLER REDEFINES ERRMSG1F.
  3129         10  ERRMSG1A PIC  X(0001).
  3130     05  ERRMSG1I PIC  X(0072).
  3131*    -------------------------------
  3132     05  ERRMSG2L PIC S9(0004) COMP.
  3133     05  ERRMSG2F PIC  X(0001).
  3134     05  FILLER REDEFINES ERRMSG2F.
  3135         10  ERRMSG2A PIC  X(0001).
  3136     05  ERRMSG2I PIC  X(0072).
  3137*    -------------------------------
  3138     05  ENTERPFL PIC S9(0004) COMP.
  3139     05  ENTERPFF PIC  X(0001).
  3140     05  FILLER REDEFINES ENTERPFF.
  3141         10  ENTERPFA PIC  X(0001).
  3142     05  ENTERPFI PIC  99.
  3143*    -------------------------------
  3144     05  PF6TITL PIC S9(0004) COMP.
  3145     05  PF6TITF PIC  X(0001).
  3146     05  FILLER REDEFINES PF6TITF.
  3147         10  PF6TITA PIC  X(0001).
  3148     05  PF6TITI PIC  X(0016).
  3149 01  EL156AO REDEFINES EL156AI.
  3150     05  FILLER            PIC  X(0012).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  RUNDTEAO PIC  X(0008).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  RUNTIMAO PIC  99.99.
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  63
* EL156.cbl
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  CLMNOO PIC  X(0007).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  CARRO PIC  X(0001).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  CERTNOO PIC  X(0010).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  SUFXO PIC  X(0001).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  CLMTYPO PIC  X(0006).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  CLMSTATO PIC  X(0006).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  LSTNMEO PIC  X(0015).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  FSTNMEO PIC  X(0012).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  MINITO PIC  X(0001).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  PRIMHDGO PIC  X(0012).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  PCERTNOO PIC  X(0010).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  PSUFXO PIC  X(0001).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  STATUSO PIC  X(0010).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  LOANHO PIC  X(0014).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  LOANNOO PIC  X(0025).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  DUEDAYHO PIC  X(0008).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  DUEDAYO PIC  X(0002).
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  ZINTHO PIC  X(0009).
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  ZINTO PIC  9.99999.
  3217*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  64
* EL156.cbl
  3218     05  FILLER            PIC  X(0003).
  3219     05  PTHRHDGO PIC  X(0014).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  PDTHRUO PIC  X(0008).
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  TOTPAIDO PIC  Z(6).99-.
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  COVERO PIC  X(0010).
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  INCURO PIC  X(0008).
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  LSTDTEO PIC  X(0008).
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  CRTSTATO PIC  X(0010).
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  EFFECTO PIC  X(0008).
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  TERMSO PIC  X(0011).
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  STACCTO PIC  X(0013).
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  EXPDTEHO PIC  X(0014).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  EXPDTEO PIC  X(0008).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  BENECAPO PIC  X(0013).
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  BENEO PIC  Z(6).99.
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  FORMTYPO PIC  X(0001).
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  PMTTYPEO PIC  X(0001).
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  PAYEEO PIC  X(0002).
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  CHECKNOO PIC  X(0007).
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  OFFLINEO PIC  X(0001).
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  65
* EL156.cbl
  3276     05  HOLDTILO PIC  99B99B99.
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  NOTE1O PIC  X(0060).
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  ITRB1O PIC  X(0008).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  NOTE2O PIC  X(0060).
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  ITRB2O PIC  X(0010).
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
  3291     05  EOBYNO PIC  X(0001).
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  CLMFMYNO PIC  X(0001).
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  SURVYYNO PIC  X(0001).
  3298*    -------------------------------
  3299     05  FILLER            PIC  X(0003).
  3300     05  SPRELYNO PIC  X(0001).
  3301*    -------------------------------
  3302     05  FILLER            PIC  X(0003).
  3303     05  PINTHO PIC  X(0004).
  3304*    -------------------------------
  3305     05  FILLER            PIC  X(0003).
  3306     05  PINTO PIC  Z,ZZ9.99.
  3307*    -------------------------------
  3308     05  FILLER            PIC  X(0003).
  3309     05  ITRBYNO PIC  X(0001).
  3310*    -------------------------------
  3311     05  FILLER            PIC  X(0003).
  3312     05  PROOFDTO PIC  99B99B99.
  3313*    -------------------------------
  3314     05  FILLER            PIC  X(0003).
  3315     05  AIGFRMHO PIC  X(0012).
  3316*    -------------------------------
  3317     05  FILLER            PIC  X(0003).
  3318     05  AIGFROMO PIC  99B99B99.
  3319*    -------------------------------
  3320     05  FILLER            PIC  X(0003).
  3321     05  PMTHDGAO PIC  X(0066).
  3322*    -------------------------------
  3323     05  FILLER            PIC  X(0003).
  3324     05  EPYFROMO PIC  99B99B99.
  3325*    -------------------------------
  3326     05  FILLER            PIC  X(0003).
  3327     05  EPYTHRUO PIC  99B99B99.
  3328*    -------------------------------
  3329     05  FILLER            PIC  X(0003).
  3330     05  EDAYSO PIC  Z(4)9-.
  3331*    -------------------------------
  3332     05  FILLER            PIC  X(0003).
  3333     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  66
* EL156.cbl
  3334*    -------------------------------
  3335     05  FILLER            PIC  X(0003).
  3336     05  ERESVO PIC  Z(5).99-.
  3337*    -------------------------------
  3338     05  FILLER            PIC  X(0003).
  3339     05  ETYPEO PIC  X(0001).
  3340*    -------------------------------
  3341     05  FILLER            PIC  X(0003).
  3342     05  EEXPENSO PIC  Z(5).99.
  3343*    -------------------------------
  3344     05  FILLER            PIC  X(0003).
  3345     05  CPYFROMO PIC  99B99B99.
  3346*    -------------------------------
  3347     05  FILLER            PIC  X(0003).
  3348     05  CPYTHRUO PIC  99B99B99.
  3349*    -------------------------------
  3350     05  FILLER            PIC  X(0003).
  3351     05  CDAYSO PIC  Z(4)9-.
  3352*    -------------------------------
  3353     05  FILLER            PIC  X(0003).
  3354     05  CPYAMTO PIC  Z(6).99-.
  3355*    -------------------------------
  3356     05  FILLER            PIC  X(0003).
  3357     05  CRESVO PIC  Z(5).99.
  3358*    -------------------------------
  3359     05  FILLER            PIC  X(0003).
  3360     05  CEXPENSO PIC  Z(5).99.
  3361*    -------------------------------
  3362     05  FILLER            PIC  X(0003).
  3363     05  ERRMSG0O PIC  X(0072).
  3364*    -------------------------------
  3365     05  FILLER            PIC  X(0003).
  3366     05  ERRMSG1O PIC  X(0072).
  3367*    -------------------------------
  3368     05  FILLER            PIC  X(0003).
  3369     05  ERRMSG2O PIC  X(0072).
  3370*    -------------------------------
  3371     05  FILLER            PIC  X(0003).
  3372     05  ENTERPFO PIC  X(0002).
  3373*    -------------------------------
  3374     05  FILLER            PIC  X(0003).
  3375     05  PF6TITO PIC  X(0016).
  3376*    -------------------------------
  3377 01  EL156BI REDEFINES EL156AI.
  3378     05  FILLER            PIC  X(0012).
  3379*    -------------------------------
  3380     05  RUNDTEBL PIC S9(0004) COMP.
  3381     05  RUNDTEBF PIC  X(0001).
  3382     05  FILLER REDEFINES RUNDTEBF.
  3383         10  RUNDTEBA PIC  X(0001).
  3384     05  RUNDTEBI PIC  X(0008).
  3385*    -------------------------------
  3386     05  RUNTIMBL PIC S9(0004) COMP.
  3387     05  RUNTIMBF PIC  X(0001).
  3388     05  FILLER REDEFINES RUNTIMBF.
  3389         10  RUNTIMBA PIC  X(0001).
  3390     05  RUNTIMBI PIC  X(0005).
  3391*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  67
* EL156.cbl
  3392     05  PAYDTBL PIC S9(0004) COMP.
  3393     05  PAYDTBF PIC  X(0001).
  3394     05  FILLER REDEFINES PAYDTBF.
  3395         10  PAYDTBA PIC  X(0001).
  3396     05  PAYDTBI PIC  X(0008).
  3397*    -------------------------------
  3398     05  PAYTYPBL PIC S9(0004) COMP.
  3399     05  PAYTYPBF PIC  X(0001).
  3400     05  FILLER REDEFINES PAYTYPBF.
  3401         10  PAYTYPBA PIC  X(0001).
  3402     05  PAYTYPBI PIC  X(0015).
  3403*    -------------------------------
  3404     05  PAYAMTBL PIC S9(0004) COMP.
  3405     05  PAYAMTBF PIC  X(0001).
  3406     05  FILLER REDEFINES PAYAMTBF.
  3407         10  PAYAMTBA PIC  X(0001).
  3408     05  PAYAMTBI PIC  X(0011).
  3409*    -------------------------------
  3410     05  LOANHBL PIC S9(0004) COMP.
  3411     05  LOANHBF PIC  X(0001).
  3412     05  FILLER REDEFINES LOANHBF.
  3413         10  LOANHBA PIC  X(0001).
  3414     05  LOANHBI PIC  X(0012).
  3415*    -------------------------------
  3416     05  LOANNBL PIC S9(0004) COMP.
  3417     05  LOANNBF PIC  X(0001).
  3418     05  FILLER REDEFINES LOANNBF.
  3419         10  LOANNBA PIC  X(0001).
  3420     05  LOANNBI PIC  X(0025).
  3421*    -------------------------------
  3422     05  CKNUMHDL PIC S9(0004) COMP.
  3423     05  CKNUMHDF PIC  X(0001).
  3424     05  FILLER REDEFINES CKNUMHDF.
  3425         10  CKNUMHDA PIC  X(0001).
  3426     05  CKNUMHDI PIC  X(0012).
  3427*    -------------------------------
  3428     05  CKNUMBL PIC S9(0004) COMP.
  3429     05  CKNUMBF PIC  X(0001).
  3430     05  FILLER REDEFINES CKNUMBF.
  3431         10  CKNUMBA PIC  X(0001).
  3432     05  CKNUMBI PIC  X(0007).
  3433*    -------------------------------
  3434     05  AGTHDGL PIC S9(0004) COMP.
  3435     05  AGTHDGF PIC  X(0001).
  3436     05  FILLER REDEFINES AGTHDGF.
  3437         10  AGTHDGA PIC  X(0001).
  3438     05  AGTHDGI PIC  X(0016).
  3439*    -------------------------------
  3440     05  NAMEBL PIC S9(0004) COMP.
  3441     05  NAMEBF PIC  X(0001).
  3442     05  FILLER REDEFINES NAMEBF.
  3443         10  NAMEBA PIC  X(0001).
  3444     05  NAMEBI PIC  X(0030).
  3445*    -------------------------------
  3446     05  NAMEB2L PIC S9(0004) COMP.
  3447     05  NAMEB2F PIC  X(0001).
  3448     05  FILLER REDEFINES NAMEB2F.
  3449         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  68
* EL156.cbl
  3450     05  NAMEB2I PIC  X(0030).
  3451*    -------------------------------
  3452     05  ADDR1BL PIC S9(0004) COMP.
  3453     05  ADDR1BF PIC  X(0001).
  3454     05  FILLER REDEFINES ADDR1BF.
  3455         10  ADDR1BA PIC  X(0001).
  3456     05  ADDR1BI PIC  X(0030).
  3457*    -------------------------------
  3458     05  ADDR1B2L PIC S9(0004) COMP.
  3459     05  ADDR1B2F PIC  X(0001).
  3460     05  FILLER REDEFINES ADDR1B2F.
  3461         10  ADDR1B2A PIC  X(0001).
  3462     05  ADDR1B2I PIC  X(0030).
  3463*    -------------------------------
  3464     05  ADDR2BL PIC S9(0004) COMP.
  3465     05  ADDR2BF PIC  X(0001).
  3466     05  FILLER REDEFINES ADDR2BF.
  3467         10  ADDR2BA PIC  X(0001).
  3468     05  ADDR2BI PIC  X(0030).
  3469*    -------------------------------
  3470     05  ADDR2B2L PIC S9(0004) COMP.
  3471     05  ADDR2B2F PIC  X(0001).
  3472     05  FILLER REDEFINES ADDR2B2F.
  3473         10  ADDR2B2A PIC  X(0001).
  3474     05  ADDR2B2I PIC  X(0030).
  3475*    -------------------------------
  3476     05  CITYSTBL PIC S9(0004) COMP.
  3477     05  CITYSTBF PIC  X(0001).
  3478     05  FILLER REDEFINES CITYSTBF.
  3479         10  CITYSTBA PIC  X(0001).
  3480     05  CITYSTBI PIC  X(0030).
  3481*    -------------------------------
  3482     05  CITYST2L PIC S9(0004) COMP.
  3483     05  CITYST2F PIC  X(0001).
  3484     05  FILLER REDEFINES CITYST2F.
  3485         10  CITYST2A PIC  X(0001).
  3486     05  CITYST2I PIC  X(0030).
  3487*    -------------------------------
  3488     05  ZIPBL PIC S9(0004) COMP.
  3489     05  ZIPBF PIC  X(0001).
  3490     05  FILLER REDEFINES ZIPBF.
  3491         10  ZIPBA PIC  X(0001).
  3492     05  ZIPBI PIC  X(0009).
  3493*    -------------------------------
  3494     05  ZIPB2L PIC S9(0004) COMP.
  3495     05  ZIPB2F PIC  X(0001).
  3496     05  FILLER REDEFINES ZIPB2F.
  3497         10  ZIPB2A PIC  X(0001).
  3498     05  ZIPB2I PIC  X(0009).
  3499*    -------------------------------
  3500     05  INTHDBL PIC S9(0004) COMP.
  3501     05  INTHDBF PIC  X(0001).
  3502     05  FILLER REDEFINES INTHDBF.
  3503         10  INTHDBA PIC  X(0001).
  3504     05  INTHDBI PIC  X(0012).
  3505*    -------------------------------
  3506     05  INTAMTBL PIC S9(0004) COMP.
  3507     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  69
* EL156.cbl
  3508     05  FILLER REDEFINES INTAMTBF.
  3509         10  INTAMTBA PIC  X(0001).
  3510     05  INTAMTBI PIC  X(0011).
  3511*    -------------------------------
  3512     05  PMTHDGBL PIC S9(0004) COMP.
  3513     05  PMTHDGBF PIC  X(0001).
  3514     05  FILLER REDEFINES PMTHDGBF.
  3515         10  PMTHDGBA PIC  X(0001).
  3516     05  PMTHDGBI PIC  X(0034).
  3517*    -------------------------------
  3518     05  CLMNOBL PIC S9(0004) COMP.
  3519     05  CLMNOBF PIC  X(0001).
  3520     05  FILLER REDEFINES CLMNOBF.
  3521         10  CLMNOBA PIC  X(0001).
  3522     05  CLMNOBI PIC  X(0007).
  3523*    -------------------------------
  3524     05  CARRBL PIC S9(0004) COMP.
  3525     05  CARRBF PIC  X(0001).
  3526     05  FILLER REDEFINES CARRBF.
  3527         10  CARRBA PIC  X(0001).
  3528     05  CARRBI PIC  X(0001).
  3529*    -------------------------------
  3530     05  CERTNOBL PIC S9(0004) COMP.
  3531     05  CERTNOBF PIC  X(0001).
  3532     05  FILLER REDEFINES CERTNOBF.
  3533         10  CERTNOBA PIC  X(0001).
  3534     05  CERTNOBI PIC  X(0010).
  3535*    -------------------------------
  3536     05  SUFXBL PIC S9(0004) COMP.
  3537     05  SUFXBF PIC  X(0001).
  3538     05  FILLER REDEFINES SUFXBF.
  3539         10  SUFXBA PIC  X(0001).
  3540     05  SUFXBI PIC  X(0001).
  3541*    -------------------------------
  3542     05  CLMTYPBL PIC S9(0004) COMP.
  3543     05  CLMTYPBF PIC  X(0001).
  3544     05  FILLER REDEFINES CLMTYPBF.
  3545         10  CLMTYPBA PIC  X(0001).
  3546     05  CLMTYPBI PIC  X(0006).
  3547*    -------------------------------
  3548     05  INCURBL PIC S9(0004) COMP.
  3549     05  INCURBF PIC  X(0001).
  3550     05  FILLER REDEFINES INCURBF.
  3551         10  INCURBA PIC  X(0001).
  3552     05  INCURBI PIC  X(0008).
  3553*    -------------------------------
  3554     05  PYFROMBL PIC S9(0004) COMP.
  3555     05  PYFROMBF PIC  X(0001).
  3556     05  FILLER REDEFINES PYFROMBF.
  3557         10  PYFROMBA PIC  X(0001).
  3558     05  PYFROMBI PIC  X(0008).
  3559*    -------------------------------
  3560     05  PYTHRUBL PIC S9(0004) COMP.
  3561     05  PYTHRUBF PIC  X(0001).
  3562     05  FILLER REDEFINES PYTHRUBF.
  3563         10  PYTHRUBA PIC  X(0001).
  3564     05  PYTHRUBI PIC  X(0008).
  3565*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  70
* EL156.cbl
  3566     05  DAYSBL PIC S9(0004) COMP.
  3567     05  DAYSBF PIC  X(0001).
  3568     05  FILLER REDEFINES DAYSBF.
  3569         10  DAYSBA PIC  X(0001).
  3570     05  DAYSBI PIC  X(0005).
  3571*    -------------------------------
  3572     05  BYBL PIC S9(0004) COMP.
  3573     05  BYBF PIC  X(0001).
  3574     05  FILLER REDEFINES BYBF.
  3575         10  BYBA PIC  X(0001).
  3576     05  BYBI PIC  X(0004).
  3577*    -------------------------------
  3578     05  PROOFDBL PIC S9(0004) COMP.
  3579     05  PROOFDBF PIC  X(0001).
  3580     05  FILLER REDEFINES PROOFDBF.
  3581         10  PROOFDBA PIC  X(0001).
  3582     05  PROOFDBI PIC  X(0008).
  3583*    -------------------------------
  3584     05  ACCTBL PIC S9(0004) COMP.
  3585     05  ACCTBF PIC  X(0001).
  3586     05  FILLER REDEFINES ACCTBF.
  3587         10  ACCTBA PIC  X(0001).
  3588     05  ACCTBI PIC  X(0010).
  3589*    -------------------------------
  3590     05  STATEBL PIC S9(0004) COMP.
  3591     05  STATEBF PIC  X(0001).
  3592     05  FILLER REDEFINES STATEBF.
  3593         10  STATEBA PIC  X(0001).
  3594     05  STATEBI PIC  X(0002).
  3595*    -------------------------------
  3596     05  GROUPBL PIC S9(0004) COMP.
  3597     05  GROUPBF PIC  X(0001).
  3598     05  FILLER REDEFINES GROUPBF.
  3599         10  GROUPBA PIC  X(0001).
  3600     05  GROUPBI PIC  X(0006).
  3601*    -------------------------------
  3602     05  ACARRBL PIC S9(0004) COMP.
  3603     05  ACARRBF PIC  X(0001).
  3604     05  FILLER REDEFINES ACARRBF.
  3605         10  ACARRBA PIC  X(0001).
  3606     05  ACARRBI PIC  X(0001).
  3607*    -------------------------------
  3608     05  ACCTNMBL PIC S9(0004) COMP.
  3609     05  ACCTNMBF PIC  X(0001).
  3610     05  FILLER REDEFINES ACCTNMBF.
  3611         10  ACCTNMBA PIC  X(0001).
  3612     05  ACCTNMBI PIC  X(0030).
  3613*    -------------------------------
  3614     05  UNDISBL PIC S9(0004) COMP.
  3615     05  UNDISBF PIC  X(0001).
  3616     05  FILLER REDEFINES UNDISBF.
  3617         10  UNDISBA PIC  X(0001).
  3618     05  UNDISBI PIC  X(0010).
  3619*    -------------------------------
  3620     05  RATEBL PIC S9(0004) COMP.
  3621     05  RATEBF PIC  X(0001).
  3622     05  FILLER REDEFINES RATEBF.
  3623         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  71
* EL156.cbl
  3624     05  RATEBI PIC  X(0006).
  3625*    -------------------------------
  3626     05  ERMSG1BL PIC S9(0004) COMP.
  3627     05  ERMSG1BF PIC  X(0001).
  3628     05  FILLER REDEFINES ERMSG1BF.
  3629         10  ERMSG1BA PIC  X(0001).
  3630     05  ERMSG1BI PIC  X(0072).
  3631*    -------------------------------
  3632     05  ENTPFBL PIC S9(0004) COMP.
  3633     05  ENTPFBF PIC  X(0001).
  3634     05  FILLER REDEFINES ENTPFBF.
  3635         10  ENTPFBA PIC  X(0001).
  3636     05  ENTPFBI PIC  99.
  3637 01  EL156BO REDEFINES EL156AI.
  3638     05  FILLER            PIC  X(0012).
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  RUNDTEBO PIC  X(0008).
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  RUNTIMBO PIC  99.99.
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  PAYDTBO PIC  99B99B99.
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  PAYTYPBO PIC  X(0015).
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  LOANHBO PIC  X(0012).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  LOANNBO PIC  X(0025).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  CKNUMHDO PIC  X(0012).
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  CKNUMBO PIC  X(0007).
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  AGTHDGO PIC  X(0016).
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
  3671     05  NAMEBO PIC  X(0030).
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  NAMEB2O PIC  X(0030).
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
  3677     05  ADDR1BO PIC  X(0030).
  3678*    -------------------------------
  3679     05  FILLER            PIC  X(0003).
  3680     05  ADDR1B2O PIC  X(0030).
  3681*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  72
* EL156.cbl
  3682     05  FILLER            PIC  X(0003).
  3683     05  ADDR2BO PIC  X(0030).
  3684*    -------------------------------
  3685     05  FILLER            PIC  X(0003).
  3686     05  ADDR2B2O PIC  X(0030).
  3687*    -------------------------------
  3688     05  FILLER            PIC  X(0003).
  3689     05  CITYSTBO PIC  X(0030).
  3690*    -------------------------------
  3691     05  FILLER            PIC  X(0003).
  3692     05  CITYST2O PIC  X(0030).
  3693*    -------------------------------
  3694     05  FILLER            PIC  X(0003).
  3695     05  ZIPBO PIC  ZZZZ99999.
  3696*    -------------------------------
  3697     05  FILLER            PIC  X(0003).
  3698     05  ZIPB2O PIC  ZZZZZZZZZ.
  3699*    -------------------------------
  3700     05  FILLER            PIC  X(0003).
  3701     05  INTHDBO PIC  X(0012).
  3702*    -------------------------------
  3703     05  FILLER            PIC  X(0003).
  3704     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3705*    -------------------------------
  3706     05  FILLER            PIC  X(0003).
  3707     05  PMTHDGBO PIC  X(0034).
  3708*    -------------------------------
  3709     05  FILLER            PIC  X(0003).
  3710     05  CLMNOBO PIC  X(0007).
  3711*    -------------------------------
  3712     05  FILLER            PIC  X(0003).
  3713     05  CARRBO PIC  X(0001).
  3714*    -------------------------------
  3715     05  FILLER            PIC  X(0003).
  3716     05  CERTNOBO PIC  X(0010).
  3717*    -------------------------------
  3718     05  FILLER            PIC  X(0003).
  3719     05  SUFXBO PIC  X(0001).
  3720*    -------------------------------
  3721     05  FILLER            PIC  X(0003).
  3722     05  CLMTYPBO PIC  X(0006).
  3723*    -------------------------------
  3724     05  FILLER            PIC  X(0003).
  3725     05  INCURBO PIC  X(0008).
  3726*    -------------------------------
  3727     05  FILLER            PIC  X(0003).
  3728     05  PYFROMBO PIC  99B99B99.
  3729*    -------------------------------
  3730     05  FILLER            PIC  X(0003).
  3731     05  PYTHRUBO PIC  99B99B99.
  3732*    -------------------------------
  3733     05  FILLER            PIC  X(0003).
  3734     05  DAYSBO PIC  X(0005).
  3735*    -------------------------------
  3736     05  FILLER            PIC  X(0003).
  3737     05  BYBO PIC  X(0004).
  3738*    -------------------------------
  3739     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  73
* EL156.cbl
  3740     05  PROOFDBO PIC  99B99B99.
  3741*    -------------------------------
  3742     05  FILLER            PIC  X(0003).
  3743     05  ACCTBO PIC  X(0010).
  3744*    -------------------------------
  3745     05  FILLER            PIC  X(0003).
  3746     05  STATEBO PIC  X(0002).
  3747*    -------------------------------
  3748     05  FILLER            PIC  X(0003).
  3749     05  GROUPBO PIC  X(0006).
  3750*    -------------------------------
  3751     05  FILLER            PIC  X(0003).
  3752     05  ACARRBO PIC  X(0001).
  3753*    -------------------------------
  3754     05  FILLER            PIC  X(0003).
  3755     05  ACCTNMBO PIC  X(0030).
  3756*    -------------------------------
  3757     05  FILLER            PIC  X(0003).
  3758     05  UNDISBO PIC  ZZZ,Z99.99.
  3759*    -------------------------------
  3760     05  FILLER            PIC  X(0003).
  3761     05  RATEBO PIC  ZZZ.99.
  3762*    -------------------------------
  3763     05  FILLER            PIC  X(0003).
  3764     05  ERMSG1BO PIC  X(0072).
  3765*    -------------------------------
  3766     05  FILLER            PIC  X(0003).
  3767     05  ENTPFBO PIC  X(0002).
  3768*    -------------------------------
  3769****************************************************************
  3770*
  3771* Copyright (c) 2007-2013 Dell Inc.
  3772* All rights reserved.
  3773*
  3774****************************************************************
  3775 01  DFHEIV.
  3776   02  DFHEIV0               PIC X(35).
  3777   02  DFHEIV1               PIC X(08).
  3778   02  DFHEIV2               PIC X(08).
  3779   02  DFHEIV3               PIC X(08).
  3780   02  DFHEIV4               PIC X(06).
  3781   02  DFHEIV5               PIC X(04).
  3782   02  DFHEIV6               PIC X(04).
  3783   02  DFHEIV7               PIC X(02).
  3784   02  DFHEIV8               PIC X(02).
  3785   02  DFHEIV9               PIC X(01).
  3786   02  DFHEIV10              PIC S9(7) COMP-3.
  3787   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3788   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3789   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3790   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3791   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3792   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3793   02  DFHEIV17              PIC X(04).
  3794   02  DFHEIV18              PIC X(04).
  3795   02  DFHEIV19              PIC X(04).
  3796   02  DFHEIV20              USAGE IS POINTER.
  3797   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  74
* EL156.cbl
  3798   02  DFHEIV22              USAGE IS POINTER.
  3799   02  DFHEIV23              USAGE IS POINTER.
  3800   02  DFHEIV24              USAGE IS POINTER.
  3801   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3802   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3803   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3804   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3805   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3806   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3807   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3808   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3809   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3810   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3811   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3812   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3813   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3814   02  FILLER                PIC X(02).
  3815   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3816   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3817   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3818   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3819   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3820   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3821   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3822 LINKAGE  SECTION.
  3823*****************************************************************
  3824*                                                               *
  3825* Copyright (c) 2007-2013 Dell Inc.                             *
  3826* All rights reserved.                                          *
  3827*                                                               *
  3828*****************************************************************
  3829 01  dfheiblk.
  3830     02  eibtime          pic s9(7) comp-3.
  3831     02  eibdate          pic s9(7) comp-3.
  3832     02  eibtrnid         pic x(4).
  3833     02  eibtaskn         pic s9(7) comp-3.
  3834     02  eibtrmid         pic x(4).
  3835     02  dfheigdi         pic s9(4) comp.
  3836     02  eibcposn         pic s9(4) comp.
  3837     02  eibcalen         pic s9(4) comp.
  3838     02  eibaid           pic x(1).
  3839     02  eibfiller1       pic x(1).
  3840     02  eibfn            pic x(2).
  3841     02  eibfiller2       pic x(2).
  3842     02  eibrcode         pic x(6).
  3843     02  eibfiller3       pic x(2).
  3844     02  eibds            pic x(8).
  3845     02  eibreqid         pic x(8).
  3846     02  eibrsrce         pic x(8).
  3847     02  eibsync          pic x(1).
  3848     02  eibfree          pic x(1).
  3849     02  eibrecv          pic x(1).
  3850     02  eibsend          pic x(1).
  3851     02  eibatt           pic x(1).
  3852     02  eibeoc           pic x(1).
  3853     02  eibfmh           pic x(1).
  3854     02  eibcompl         pic x(1).
  3855     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  75
* EL156.cbl
  3856     02  eibconf          pic x(1).
  3857     02  eiberr           pic x(1).
  3858     02  eibrldbk         pic x(1).
  3859     02  eiberrcd         pic x(4).
  3860     02  eibsynrb         pic x(1).
  3861     02  eibnodat         pic x(1).
  3862     02  eibfiller5       pic x(2).
  3863     02  eibresp          pic s9(8) comp.
  3864     02  eibresp2         pic s9(8) comp.
  3865     02  dfheigdj         pic s9(4) comp.
  3866     02  dfheigdk         pic s9(4) comp.
  3867 01  DFHCOMMAREA             PIC X(1024).
  3868
  3869*    COPY ELCMSTR.
  3870******************************************************************
  3871*                                                                *
  3872*                            ELCMSTR.                            *
  3873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3874*                            VMOD=2.012                          *
  3875*                                                                *
  3876*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3877*                                                                *
  3878*   FILE TYPE = VSAM,KSDS                                        *
  3879*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3880*                                                                *
  3881*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3882*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3883*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3884*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3885*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3886*                                                 RKP=75,LEN=21  *
  3887*                                                                *
  3888*   **** NOTE ****                                               *
  3889*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3890*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3891*                                                                *
  3892*   LOG = YES                                                    *
  3893*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3894******************************************************************
  3895*                   C H A N G E   L O G
  3896*
  3897* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3898*-----------------------------------------------------------------
  3899*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3900* EFFECTIVE    NUMBER
  3901*-----------------------------------------------------------------
  3902* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3903* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3904* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3905* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3906* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3907* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3908* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3909******************************************************************
  3910 01  CLAIM-MASTER.
  3911     12  CL-RECORD-ID                PIC XX.
  3912         88  VALID-CL-ID         VALUE 'CL'.
  3913
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  76
* EL156.cbl
  3914     12  CL-CONTROL-PRIMARY.
  3915         16  CL-COMPANY-CD           PIC X.
  3916         16  CL-CARRIER              PIC X.
  3917         16  CL-CLAIM-NO             PIC X(7).
  3918         16  CL-CERT-NO.
  3919             20  CL-CERT-PRIME       PIC X(10).
  3920             20  CL-CERT-SFX         PIC X.
  3921
  3922     12  CL-CONTROL-BY-NAME.
  3923         16  CL-COMPANY-CD-A1        PIC X.
  3924         16  CL-INSURED-LAST-NAME    PIC X(15).
  3925         16  CL-INSURED-NAME.
  3926             20  CL-INSURED-1ST-NAME PIC X(12).
  3927             20  CL-INSURED-MID-INIT PIC X.
  3928
  3929     12  CL-CONTROL-BY-SSN.
  3930         16  CL-COMPANY-CD-A2        PIC X.
  3931         16  CL-SOC-SEC-NO.
  3932             20  CL-SSN-STATE        PIC XX.
  3933             20  CL-SSN-ACCOUNT      PIC X(6).
  3934             20  CL-SSN-LN3          PIC X(3).
  3935
  3936     12  CL-CONTROL-BY-CERT-NO.
  3937         16  CL-COMPANY-CD-A4        PIC X.
  3938         16  CL-CERT-NO-A4.
  3939             20  CL-CERT-A4-PRIME    PIC X(10).
  3940             20  CL-CERT-A4-SFX      PIC X.
  3941
  3942     12  CL-CONTROL-BY-CCN.
  3943         16  CL-COMPANY-CD-A5        PIC X.
  3944         16  CL-CCN-A5.
  3945             20  CL-CCN.
  3946                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3947                 24  CL-CCN-PRIME-A5 PIC X(12).
  3948             20  CL-CCN-FILLER-A5    PIC X(4).
  3949
  3950     12  CL-INSURED-PROFILE-DATA.
  3951         16  CL-INSURED-BIRTH-DT     PIC XX.
  3952         16  CL-INSURED-SEX-CD       PIC X.
  3953             88  INSURED-IS-MALE        VALUE 'M'.
  3954             88  INSURED-IS-FEMALE      VALUE 'F'.
  3955             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3956         16  CL-INSURED-OCC-CD       PIC X(6).
  3957         16  FILLER                  PIC X(5).
  3958
  3959     12  CL-PROCESSING-INFO.
  3960         16  CL-PROCESSOR-ID         PIC X(4).
  3961         16  CL-CLAIM-STATUS         PIC X.
  3962             88  CLAIM-IS-OPEN          VALUE 'O'.
  3963             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3964         16  CL-CLAIM-TYPE           PIC X.
  3965*            88  AH-CLAIM               VALUE 'A'.
  3966*            88  LIFE-CLAIM             VALUE 'L'.
  3967*            88  PROPERTY-CLAIM         VALUE 'P'.
  3968*            88  IUI-CLAIM              VALUE 'I'.
  3969*            88  GAP-CLAIM              VALUE 'G'.
  3970*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3971*            88  OTHER-CLAIM            VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  77
* EL156.cbl
  3972         16  CL-CLAIM-PREM-TYPE      PIC X.
  3973             88  SINGLE-PREMIUM         VALUE '1'.
  3974             88  O-B-COVERAGE           VALUE '2'.
  3975             88  OPEN-END-COVERAGE      VALUE '3'.
  3976         16  CL-INCURRED-DT          PIC XX.
  3977         16  CL-REPORTED-DT          PIC XX.
  3978         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3979         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3980         16  CL-LAST-PMT-DT          PIC XX.
  3981         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3982         16  CL-PAID-THRU-DT         PIC XX.
  3983         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3984         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3985         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3986         16  CL-PMT-CALC-METHOD      PIC X.
  3987             88  CL-360-DAY-YR          VALUE '1'.
  3988             88  CL-365-DAY-YR          VALUE '2'.
  3989             88  CL-FULL-MONTHS         VALUE '3'.
  3990         16  CL-CAUSE-CD             PIC X(6).
  3991
  3992         16  CL-PRIME-CERT-NO.
  3993             20  CL-PRIME-CERT-PRIME PIC X(10).
  3994             20  CL-PRIME-CERT-SFX   PIC X.
  3995
  3996         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3997             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3998             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3999
  4000         16  CL-MICROFILM-NO         PIC X(10).
  4001         16  FILLER REDEFINES CL-MICROFILM-NO.
  4002             20  CL-BENEFIT-PERIOD   PIC 99.
  4003             20  FILLER              PIC X(8).
  4004         16  CL-PROG-FORM-TYPE       PIC X.
  4005         16  CL-LAST-ADD-ON-DT       PIC XX.
  4006
  4007         16  CL-LAST-REOPEN-DT       PIC XX.
  4008         16  CL-LAST-CLOSE-DT        PIC XX.
  4009         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4010             88  FINAL-PAID             VALUE '1'.
  4011             88  CLAIM-DENIED           VALUE '2'.
  4012             88  AUTO-CLOSE             VALUE '3'.
  4013             88  MANUAL-CLOSE           VALUE '4'.
  4014             88  BENEFITS-CHANGED       VALUE 'C'.
  4015             88  SETUP-ERRORS           VALUE 'E'.
  4016         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4017         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4018         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4019             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4020         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4021         16  FILLER                  PIC X.
  4022
  4023     12  CL-CERTIFICATE-DATA.
  4024         16  CL-CERT-ORIGIN          PIC X.
  4025             88  CERT-WAS-ONLINE        VALUE '1'.
  4026             88  CERT-WAS-CREATED       VALUE '2'.
  4027             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4028         16  CL-CERT-KEY-DATA.
  4029             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  78
* EL156.cbl
  4030             20  CL-CERT-GROUPING    PIC X(6).
  4031             20  CL-CERT-STATE       PIC XX.
  4032             20  CL-CERT-ACCOUNT.
  4033                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4034                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4035             20  CL-CERT-EFF-DT      PIC XX.
  4036
  4037     12  CL-STATUS-CONTROLS.
  4038         16  CL-PRIORITY-CD          PIC X.
  4039             88  CONFIDENTIAL-DATA      VALUE '8'.
  4040             88  HIGHEST-PRIORITY       VALUE '9'.
  4041         16  CL-SUPV-ATTN-CD         PIC X.
  4042             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4043             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4044         16  CL-PURGED-DT            PIC XX.
  4045         16  CL-RESTORED-DT          PIC XX.
  4046         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4047         16  CL-NEXT-RESEND-DT       PIC XX.
  4048         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4049         16  CL-CRITICAL-PERIOD      PIC 99.
  4050*        16  FILLER                  PIC XX.
  4051         16  CL-LAST-MAINT-DT        PIC XX.
  4052         16  CL-LAST-MAINT-USER      PIC X(4).
  4053         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4054         16  CL-LAST-MAINT-TYPE      PIC X.
  4055             88  CLAIM-SET-UP           VALUE ' '.
  4056             88  PAYMENT-MADE           VALUE '1'.
  4057             88  LETTER-SENT            VALUE '2'.
  4058             88  MASTER-WAS-ALTERED     VALUE '3'.
  4059             88  MASTER-WAS-RESTORED    VALUE '4'.
  4060             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4061             88  FILE-CONVERTED         VALUE '6'.
  4062             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4063             88  ERROR-CORRECTION       VALUE 'E'.
  4064         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4065         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4066         16  CL-BENEFICIARY          PIC X(10).
  4067         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4068         16  CL-DENIAL-TYPE          PIC X.
  4069             88  CL-TYPE-DENIAL          VALUE '1'.
  4070             88  CL-TYPE-RESCISSION      VALUE '2'.
  4071             88  CL-TYPE-REFORMATION     VALUE '3'.
  4072             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4073             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4074         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4075         16  filler                  pic x(3).
  4076*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4077*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4078*        16  CL-RTW-DT               PIC XX.
  4079
  4080     12  CL-TRAILER-CONTROLS.
  4081         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4082             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4083             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4084             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4085         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4086         16  FILLER                  PIC XX.
  4087         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  79
* EL156.cbl
  4088         16  CL-ADDRESS-TRAILER-CNT.
  4089             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4090                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4091             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4092                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4093             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4094                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4095             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4096                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4097             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4098                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4099             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4100                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4101             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4102                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4103
  4104     12  CL-CV-REFERENCE-NO.
  4105         16  CL-CV-REFNO-PRIME       PIC X(18).
  4106         16  CL-CV-REFNO-SFX         PIC XX.
  4107
  4108     12  CL-FILE-LOCATION            PIC X(4).
  4109
  4110     12  CL-PROCESS-ERRORS.
  4111         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4112             88  NO-FATAL-ERRORS        VALUE ZERO.
  4113         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4114             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4115
  4116     12  CL-PRODUCT-CD               PIC X.
  4117
  4118     12  CL-CURRENT-KEY-DATA.
  4119         16  CL-CURRENT-CARRIER      PIC X.
  4120         16  CL-CURRENT-GROUPING     PIC X(6).
  4121         16  CL-CURRENT-STATE        PIC XX.
  4122         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4123
  4124     12  CL-ASSOCIATES               PIC X.
  4125         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4126         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4127         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4128         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4129
  4130     12  CL-ACTIVITY-CODE            PIC 99.
  4131     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4132     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4133
  4134     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4135     12  CL-LAG-REPORT-CODE          PIC 9.
  4136     12  CL-LOAN-TYPE                PIC XX.
  4137     12  CL-LEGAL-STATE              PIC XX.
  4138
  4139     12  CL-YESNOSW                  PIC X.
  4140     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4141         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4142         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4143         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4144     12  cl-insured-type             pic x.
  4145         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  80
* EL156.cbl
  4146         88  cl-claim-on-co-borrower     value 'C'.
  4147     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  81
* EL156.cbl
  4149*    COPY ELCCNTL.
  4150******************************************************************
  4151*                                                                *
  4152*                                                                *
  4153*                            ELCCNTL.                            *
  4154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4155*                            VMOD=2.059                          *
  4156*                                                                *
  4157*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4158*                                                                *
  4159*   FILE TYPE = VSAM,KSDS                                        *
  4160*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4161*                                                                *
  4162*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4163*       ALTERNATE INDEX = NONE                                   *
  4164*                                                                *
  4165*   LOG = YES                                                    *
  4166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4167******************************************************************
  4168*                   C H A N G E   L O G
  4169*
  4170* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4171*-----------------------------------------------------------------
  4172*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4173* EFFECTIVE    NUMBER
  4174*-----------------------------------------------------------------
  4175* 082503                   PEMA  ADD BENEFIT GROUP
  4176* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4177* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4178* 092705    2005050300006  PEMA  ADD SPP LEASES
  4179* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4180* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4181* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4182* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4183* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4184* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4185* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4186* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4187* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4188* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4189* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4190******************************************************************
  4191*
  4192 01  CONTROL-FILE.
  4193     12  CF-RECORD-ID                       PIC XX.
  4194         88  VALID-CF-ID                        VALUE 'CF'.
  4195
  4196     12  CF-CONTROL-PRIMARY.
  4197         16  CF-COMPANY-ID                  PIC XXX.
  4198         16  CF-RECORD-TYPE                 PIC X.
  4199             88  CF-COMPANY-MASTER              VALUE '1'.
  4200             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4201             88  CF-STATE-MASTER                VALUE '3'.
  4202             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4203             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4204             88  CF-CARRIER-MASTER              VALUE '6'.
  4205             88  CF-MORTALITY-MASTER            VALUE '7'.
  4206             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  82
* EL156.cbl
  4207             88  CF-TERMINAL-MASTER             VALUE '9'.
  4208             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4209             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4210             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4211             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4212             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4213             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4214             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4215             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4216             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4217         16  CF-ACCESS-CD-GENL              PIC X(4).
  4218         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4219             20  CF-PROCESSOR               PIC X(4).
  4220         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4221             20  CF-STATE-CODE              PIC XX.
  4222             20  FILLER                     PIC XX.
  4223         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4224             20  FILLER                     PIC XX.
  4225             20  CF-HI-BEN-IN-REC           PIC XX.
  4226         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4227             20  FILLER                     PIC XXX.
  4228             20  CF-CARRIER-CNTL            PIC X.
  4229         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4230             20  FILLER                     PIC XX.
  4231             20  CF-HI-TYPE-IN-REC          PIC 99.
  4232         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4233             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4234                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4235             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4236             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4237         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4238             20  FILLER                     PIC X.
  4239             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4240         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4241             20  FILLER                     PIC XX.
  4242             20  CF-MORTGAGE-PLAN           PIC XX.
  4243         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4244
  4245     12  CF-LAST-MAINT-DT                   PIC XX.
  4246     12  CF-LAST-MAINT-BY                   PIC X(4).
  4247     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4248
  4249     12  CF-RECORD-BODY                     PIC X(728).
  4250
  4251
  4252****************************************************************
  4253*             COMPANY MASTER RECORD                            *
  4254****************************************************************
  4255
  4256     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4257         16  CF-COMPANY-ADDRESS.
  4258             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4259             20  CF-CL-IN-CARE-OF           PIC X(30).
  4260             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4261             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4262             20  CF-CL-CITY-STATE           PIC X(30).
  4263             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4264             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  83
* EL156.cbl
  4265         16  CF-COMPANY-CD                  PIC X.
  4266         16  CF-COMPANY-PASSWORD            PIC X(8).
  4267         16  CF-SECURITY-OPTION             PIC X.
  4268             88  ALL-SECURITY                   VALUE '1'.
  4269             88  COMPANY-VERIFY                 VALUE '2'.
  4270             88  PROCESSOR-VERIFY               VALUE '3'.
  4271             88  NO-SECURITY                    VALUE '4'.
  4272             88  ALL-BUT-TERM                   VALUE '5'.
  4273         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4274             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4275         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4276             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4277         16  CF-INFORCE-LOCATION            PIC X.
  4278             88  CERTS-ARE-ONLINE               VALUE '1'.
  4279             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4280             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4281         16  CF-LOWER-CASE-LETTERS          PIC X.
  4282         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4283             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4284             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4285             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4286             88  CF-ACCNT-CNTL                  VALUE '3'.
  4287             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4288
  4289         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4290         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4291
  4292         16  CF-LGX-CREDIT-USER             PIC X.
  4293             88  CO-IS-NOT-USER                 VALUE 'N'.
  4294             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4295
  4296         16 CF-CREDIT-CALC-CODES.
  4297             20  CF-CR-REM-TERM-CALC PIC X.
  4298               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4299               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4300               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4301               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4302               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4303               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4304               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4305             20  CF-CR-R78-METHOD           PIC X.
  4306               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4307               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4308
  4309         16  CF-CLAIM-CONTROL-COUNTS.
  4310             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4311                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4312
  4313             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4314                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4315
  4316             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4317                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4318
  4319             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4320                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4321
  4322         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  84
* EL156.cbl
  4323
  4324         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4325             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4326             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4327             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4328             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4329                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4330                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4331             20  CF-CO-PREM-REJECT-SW       PIC X.
  4332                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4333                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4334             20  CF-CO-REF-REJECT-SW        PIC X.
  4335                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4336                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4337
  4338         16  CF-CO-REPORTING-DT             PIC XX.
  4339         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4340         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4341           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4342           88  CF-CO-MONTH-END                  VALUE '1'.
  4343
  4344         16  CF-LGX-CLAIM-USER              PIC X.
  4345             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4346             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4347
  4348         16  CF-CREDIT-EDIT-CONTROLS.
  4349             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4350             20  CF-MIN-AGE                 PIC 99.
  4351             20  CF-DEFAULT-AGE             PIC 99.
  4352             20  CF-MIN-TERM                PIC S999      COMP-3.
  4353             20  CF-MAX-TERM                PIC S999      COMP-3.
  4354             20  CF-DEFAULT-SEX             PIC X.
  4355             20  CF-JOINT-AGE-INPUT         PIC X.
  4356                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4357             20  CF-BIRTH-DATE-INPUT        PIC X.
  4358                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4359             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4360                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4361                 88  CF-ZERO-CARRIER            VALUE '1'.
  4362                 88  CF-ZERO-GROUPING           VALUE '2'.
  4363                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4364             20  CF-EDIT-SW                 PIC X.
  4365                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4366             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4367             20  CF-CR-PR-METHOD            PIC X.
  4368               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4369               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4370             20  FILLER                     PIC X.
  4371
  4372         16  CF-CREDIT-MISC-CONTROLS.
  4373             20  CF-REIN-TABLE-SW           PIC X.
  4374                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4375             20  CF-COMP-TABLE-SW           PIC X.
  4376                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4377             20  CF-EXPERIENCE-RETENTION-AGE
  4378                                            PIC S9        COMP-3.
  4379             20  CF-CONVERSION-DT           PIC XX.
  4380             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  85
* EL156.cbl
  4381             20  CF-RUN-FREQUENCY-SW        PIC X.
  4382                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4383                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4384
  4385             20  CF-CR-CHECK-NO-CONTROL.
  4386                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4387                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4388                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4389                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4390                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4391                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4392
  4393                 24  CF-CR-CHECK-COUNT       REDEFINES
  4394                     CF-CR-CHECK-COUNTER      PIC X(4).
  4395
  4396                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4397                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4398
  4399                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4400                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4401                 24  CF-MAIL-PROCESSING       PIC X.
  4402                     88  MAIL-PROCESSING          VALUE 'Y'.
  4403
  4404         16  CF-MISC-SYSTEM-CONTROL.
  4405             20  CF-SYSTEM-C                 PIC X.
  4406                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4407             20  CF-SYSTEM-D                 PIC X.
  4408                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4409             20  CF-SOC-SEC-NO-SW            PIC X.
  4410                 88  SOC-SEC-NO-USED             VALUE '1'.
  4411             20  CF-MEMBER-NO-SW             PIC X.
  4412                 88  MEMBER-NO-USED              VALUE '1'.
  4413             20  CF-TAX-ID-NUMBER            PIC X(11).
  4414             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4415             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4416                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4417                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4418                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4419                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4420             20  CF-SYSTEM-E                 PIC X.
  4421                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4422
  4423         16  CF-LGX-LIFE-USER               PIC X.
  4424             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4425             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4426
  4427         16  CF-CR-MONTH-END-DT             PIC XX.
  4428
  4429         16  CF-FILE-MAINT-DATES.
  4430             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4431                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4432             20  CF-LAST-BATCH       REDEFINES
  4433                 CF-LAST-BATCH-NO               PIC X(4).
  4434             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4435             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4436             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4437             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4438             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  86
* EL156.cbl
  4439             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4440             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4441             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4442             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4443             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4444
  4445         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4446         16  FILLER                         PIC X.
  4447
  4448         16  CF-ALT-MORT-CODE               PIC X(4).
  4449         16  CF-MEMBER-CAPTION              PIC X(10).
  4450
  4451         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4452             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4453             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4454             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4455             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4456             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4457
  4458         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4459
  4460         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4461         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4462         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4463         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4464
  4465         16  CF-AH-OVERRIDE-L1              PIC X.
  4466         16  CF-AH-OVERRIDE-L2              PIC XX.
  4467         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4468         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4469
  4470         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4471         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4472
  4473         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4474         16  CF-AR-LAST-EL860-DT            PIC XX.
  4475         16  CF-MP-MONTH-END-DT             PIC XX.
  4476
  4477         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4478         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4479             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4480
  4481         16  CF-AR-MONTH-END-DT             PIC XX.
  4482
  4483         16  CF-CRDTCRD-USER                PIC X.
  4484             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4485             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4486
  4487         16  CF-CC-MONTH-END-DT             PIC XX.
  4488
  4489         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4490
  4491         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4492             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4493             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4494             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4495         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4496         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  87
* EL156.cbl
  4497         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4498         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4499             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4500             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4501         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4502         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4503         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4504             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4505         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4506
  4507         16  CF-CL-ZIP-CODE.
  4508             20  CF-CL-ZIP-PRIME.
  4509                 24  CF-CL-ZIP-1ST          PIC X.
  4510                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4511                 24  FILLER                 PIC X(4).
  4512             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4513         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4514             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4515             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4516             20  FILLER                     PIC XXX.
  4517
  4518         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4519         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4520         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4521         16  CF-CO-OPTION-START-DATE        PIC XX.
  4522         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4523           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4524                                                      '3' '4'.
  4525           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4526           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4527           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4528           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4529           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4530           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4531
  4532         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4533
  4534         16  CF-PAYMENT-APPROVAL-LEVELS.
  4535             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4536             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4537             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4538             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4539             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4540             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4541
  4542         16  CF-END-USER-REPORTING-USER     PIC X.
  4543             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4544             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4545
  4546         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4547             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4548             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4549
  4550         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4551
  4552         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4553         16  FILLER                         PIC X.
  4554
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  88
* EL156.cbl
  4555         16  CF-CREDIT-ARCHIVE-CNTL.
  4556             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4557             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4558             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4559
  4560         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4561
  4562         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4563             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4564             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4565
  4566         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4567             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4568             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4569
  4570         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4571
  4572         16  CF-CO-ACH-ID-CODE              PIC  X.
  4573             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4574             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4575             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4576         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4577         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4578         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4579         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4580         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4581         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4582         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4583         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4584         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4585                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4586         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4587                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4588
  4589         16  CF-CO-OVER-SHORT.
  4590             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4591             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4592
  4593*         16  FILLER                         PIC X(102).
  4594         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4595             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4596             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4597
  4598         16  CF-AH-APPROVAL-DAYS.
  4599             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4600             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4601             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4602             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4603
  4604         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4605
  4606         16  CF-APPROV-LEV-5.
  4607             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4608             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4609             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4610
  4611         16  FILLER                         PIC X(68).
  4612****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  89
* EL156.cbl
  4613*             PROCESSOR/USER RECORD                            *
  4614****************************************************************
  4615
  4616     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4617         16  CF-PROCESSOR-NAME              PIC X(30).
  4618         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4619         16  CF-PROCESSOR-TITLE             PIC X(26).
  4620         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4621                 88  MESSAGE-YES                VALUE 'Y'.
  4622                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4623
  4624*****************************************************
  4625****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4626****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4627****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4628****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4629*****************************************************
  4630
  4631         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4632             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4633             20  CF-APPLICATION-FORCE       PIC X.
  4634             20  CF-INDIVIDUAL-APP.
  4635                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4636                     28  CF-BROWSE-APP      PIC X.
  4637                     28  CF-UPDATE-APP      PIC X.
  4638
  4639         16  CF-CURRENT-TERM-ON             PIC X(4).
  4640         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4641             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4642             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4643             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4644             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4645             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4646             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4647             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4648         16  CF-PROCESSOR-CARRIER           PIC X.
  4649             88  NO-CARRIER-SECURITY            VALUE ' '.
  4650         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4651             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4652         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4653             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4654         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4655             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4656
  4657         16  CF-PROC-SYS-ACCESS-SW.
  4658             20  CF-PROC-CREDIT-CLAIMS-SW.
  4659                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4660                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4661                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4662                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4663             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4664                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4665                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4666             20  CF-PROC-LIFE-GNRLDGR-SW.
  4667                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4668                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4669                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4670                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  90
* EL156.cbl
  4671             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4672                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4673                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4674         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4675             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4676             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4677         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4678
  4679         16  CF-APPROVAL-LEVEL                  PIC X.
  4680             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4681             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4682             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4683             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4684             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4685
  4686         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4687
  4688         16  CF-LANGUAGE-TYPE                   PIC X.
  4689             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4690             88  CF-LANG-IS-FR                      VALUE 'F'.
  4691
  4692         16  CF-CSR-IND                         PIC X.
  4693         16  FILLER                             PIC X(239).
  4694
  4695****************************************************************
  4696*             PROCESSOR/REMINDERS RECORD                       *
  4697****************************************************************
  4698
  4699     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4700         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4701             20  CF-START-REMIND-DT         PIC XX.
  4702             20  CF-END-REMIND-DT           PIC XX.
  4703             20  CF-REMINDER-TEXT           PIC X(50).
  4704         16  FILLER                         PIC X(296).
  4705
  4706
  4707****************************************************************
  4708*             STATE MASTER RECORD                              *
  4709****************************************************************
  4710
  4711     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4712         16  CF-STATE-ABBREVIATION          PIC XX.
  4713         16  CF-STATE-NAME                  PIC X(25).
  4714         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4715         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4716             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4717             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4718             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4719             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4720                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4721                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4722             20  CF-ST-PREM-REJECT-SW       PIC X.
  4723                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4724                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4725             20  CF-ST-REF-REJECT-SW        PIC X.
  4726                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4727                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4728         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  91
* EL156.cbl
  4729         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4730         16  CF-ST-REFUND-RULES.
  4731             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4732             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4733             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4734         16  CF-ST-FST-PMT-EXTENSION.
  4735             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4736             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4737                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4738                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4739                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4740                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4741         16  CF-ST-STATE-CALL.
  4742             20  CF-ST-CALL-UNEARNED        PIC X.
  4743             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4744             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4745         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4746             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4747             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4748         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4749         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4750         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4751         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4752         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4753         16  FILLER                         PIC X.
  4754         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4755             20  CF-ST-BENEFIT-CD           PIC XX.
  4756             20  CF-ST-BENEFIT-KIND         PIC X.
  4757                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4758                 88  CF-ST-AH-KIND              VALUE 'A'.
  4759             20  CF-ST-REM-TERM-CALC        PIC X.
  4760                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4761                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4762                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4763                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4764                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4765                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4766                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4767                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4768
  4769             20  CF-ST-REFUND-CALC          PIC X.
  4770                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4771                 88  ST-REFD-BY-R78             VALUE '1'.
  4772                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4773                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4774                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4775                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4776                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4777                 88  ST-REFD-UTAH               VALUE '7'.
  4778                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4779                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4780                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4781
  4782             20  CF-ST-EARNING-CALC         PIC X.
  4783                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4784                 88  ST-EARN-BY-R78             VALUE '1'.
  4785                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4786                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  92
* EL156.cbl
  4787                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4788                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4789                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4790                 88  ST-EARN-MEAN               VALUE '8'.
  4791                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4792
  4793             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4794                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4795                 88  ST-OVRD-BY-R78             VALUE '1'.
  4796                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4797                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4798                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4799                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4800                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4801                 88  ST-OVRD-MEAN               VALUE '8'.
  4802                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4803             20  cf-st-extra-periods        pic 9.
  4804*            20  FILLER                     PIC X.
  4805
  4806         16  CF-ST-COMMISSION-CAPS.
  4807             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4808             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4809             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4810             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4811         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4812                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4813                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4814                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4815
  4816         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4817
  4818         16  CF-ST-STATUTORY-INTEREST.
  4819             20  CF-ST-STAT-DATE-FROM       PIC X.
  4820                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4821                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4822             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4823             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4824             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4825             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4826             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4827
  4828         16  CF-ST-OVER-SHORT.
  4829             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4830             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4831
  4832         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4833
  4834         16  CF-ST-RT-CALC                  PIC X.
  4835
  4836         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4837         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4838         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4839         16  CF-ST-RF-LR-CALC               PIC X.
  4840         16  CF-ST-RF-LL-CALC               PIC X.
  4841         16  CF-ST-RF-LN-CALC               PIC X.
  4842         16  CF-ST-RF-AH-CALC               PIC X.
  4843         16  CF-ST-RF-CP-CALC               PIC X.
  4844*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  93
* EL156.cbl
  4845*CIDMOD         16  FILLER                         PIC X(192).
  4846         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4847             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4848         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4849         16  CF-ST-VFY-2ND-BENE             PIC X.
  4850         16  CF-ST-CAUSAL-STATE             PIC X.
  4851         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4852         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4853         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4854             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4855         16  CF-ST-NET-ONLY-STATE           PIC X.
  4856             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4857         16  cf-commission-cap-required     pic x.
  4858         16  CF-ST-GA-COMMISSION-CAPS.
  4859             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4860             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4861             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4862             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4863         16  CF-ST-TOT-COMMISSION-CAPS.
  4864             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4865             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4866             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4867             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4868         16  FILLER                         PIC X(156).
  4869
  4870****************************************************************
  4871*             BENEFIT MASTER RECORD                            *
  4872****************************************************************
  4873
  4874     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4875         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4876             20  CF-BENEFIT-CODE            PIC XX.
  4877             20  CF-BENEFIT-NUMERIC  REDEFINES
  4878                 CF-BENEFIT-CODE            PIC XX.
  4879             20  CF-BENEFIT-ALPHA           PIC XXX.
  4880             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4881             20  CF-BENEFIT-COMMENT         PIC X(10).
  4882
  4883             20  CF-LF-COVERAGE-TYPE        PIC X.
  4884                 88  CF-REDUCING                VALUE 'R'.
  4885                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4886
  4887             20  CF-SPECIAL-CALC-CD         PIC X.
  4888                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4889                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4890                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4891                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4892                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4893                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4894                 88  CF-FARM-PLAN               VALUE 'F'.
  4895                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4896                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4897                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4898                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4899                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4900                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4901                 88  CF-PRUDENTIAL              VALUE 'P'.
  4902                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  94
* EL156.cbl
  4903                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4904                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4905                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4906                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4907                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4908
  4909             20  CF-JOINT-INDICATOR         PIC X.
  4910                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4911
  4912*            20  FILLER                     PIC X(12).
  4913             20  cf-maximum-benefits        pic s999 comp-3.
  4914             20  FILLER                     PIC X(09).
  4915             20  CF-BENEFIT-CATEGORY        PIC X.
  4916             20  CF-LOAN-TYPE               PIC X(8).
  4917
  4918             20  CF-CO-REM-TERM-CALC        PIC X.
  4919                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4920                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4921                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4922                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4923                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4924
  4925             20  CF-CO-EARNINGS-CALC        PIC X.
  4926                 88  CO-EARN-BY-R78             VALUE '1'.
  4927                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4928                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4929                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4930                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4931                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4932                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4933                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4934
  4935             20  CF-CO-REFUND-CALC          PIC X.
  4936                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4937                 88  CO-REFD-BY-R78             VALUE '1'.
  4938                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4939                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4940                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4941                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4942                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4943                 88  CO-REFD-MEAN               VALUE '8'.
  4944                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4945                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4946                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4947
  4948             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4949                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4950                 88  CO-OVRD-BY-R78             VALUE '1'.
  4951                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4952                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4953                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4954                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4955                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4956                 88  CO-OVRD-MEAN               VALUE '8'.
  4957                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4958
  4959             20  CF-CO-BEN-I-G-CD           PIC X.
  4960                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  95
* EL156.cbl
  4961                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4962                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4963
  4964         16  FILLER                         PIC X(304).
  4965
  4966
  4967****************************************************************
  4968*             CARRIER MASTER RECORD                            *
  4969****************************************************************
  4970
  4971     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4972         16  CF-ADDRESS-DATA.
  4973             20  CF-MAIL-TO-NAME            PIC X(30).
  4974             20  CF-IN-CARE-OF              PIC X(30).
  4975             20  CF-ADDRESS-LINE-1          PIC X(30).
  4976             20  CF-ADDRESS-LINE-2          PIC X(30).
  4977             20  CF-CITY-STATE              PIC X(30).
  4978             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4979             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4980
  4981         16  CF-CLAIM-NO-CONTROL.
  4982             20  CF-CLAIM-NO-METHOD         PIC X.
  4983                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4984                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4985                 88  CLAIM-NO-SEQ               VALUE '3'.
  4986                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4987             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4988                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4989                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4990                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4991
  4992         16  CF-CHECK-NO-CONTROL.
  4993             20  CF-CHECK-NO-METHOD         PIC X.
  4994                 88  CHECK-NO-MANUAL            VALUE '1'.
  4995                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4996                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4997                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4998             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4999                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5000
  5001         16  CF-DOMICILE-STATE              PIC XX.
  5002
  5003         16  CF-EXPENSE-CONTROLS.
  5004             20  CF-EXPENSE-METHOD          PIC X.
  5005                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5006                 88  DOLLARS-PER-PMT            VALUE '2'.
  5007                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5008                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5009             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5010             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5011
  5012         16  CF-CORRESPONDENCE-CONTROL.
  5013             20  CF-LETTER-RESEND-OPT       PIC X.
  5014                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5015                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5016             20  FILLER                     PIC X(4).
  5017
  5018         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  96
* EL156.cbl
  5019             20  CF-MANUAL-SW               PIC X.
  5020                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5021             20  CF-FUTURE-SW               PIC X.
  5022                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5023             20  CF-PTC-SW                  PIC X.
  5024                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5025             20  CF-IBNR-SW                 PIC X.
  5026                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5027             20  CF-PTC-LF-SW               PIC X.
  5028                 88  CF-LF-PTC-USED             VALUE '1'.
  5029             20  CF-CDT-ACCESS-METHOD       PIC X.
  5030                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5031                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5032                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5033             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5034
  5035         16  CF-CLAIM-CALC-METHOD           PIC X.
  5036             88  360-PLUS-MONTHS                VALUE '1'.
  5037             88  365-PLUS-MONTHS                VALUE '2'.
  5038             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5039             88  360-DAILY                      VALUE '4'.
  5040             88  365-DAILY                      VALUE '5'.
  5041
  5042         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5043         16  FILLER                         PIC X(11).
  5044
  5045         16  CF-LIMIT-AMOUNTS.
  5046             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5047             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5048             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5049             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5050             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5051             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5052             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5053             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5054             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5055             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5056
  5057         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5058         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5059         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5060
  5061         16  CF-ZIP-CODE.
  5062             20  CF-ZIP-PRIME.
  5063                 24  CF-ZIP-1ST             PIC X.
  5064                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5065                 24  FILLER                 PIC X(4).
  5066             20  CF-ZIP-PLUS4               PIC X(4).
  5067         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5068             20  CF-CAN-POSTAL-1            PIC XXX.
  5069             20  CF-CAN-POSTAL-2            PIC XXX.
  5070             20  FILLER                     PIC XXX.
  5071
  5072         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5073         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5074         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5075
  5076         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  97
* EL156.cbl
  5077             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5078             88  CF-NO-RATING                   VALUE 'N'.
  5079
  5080         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5081
  5082         16  CF-CARRIER-OVER-SHORT.
  5083             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5084             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5085
  5086         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5087         16  CF-SECPAY-SWITCH               PIC X.
  5088             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5089             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5090         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5091         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5092         16  FILLER                         PIC X(444).
  5093*        16  FILLER                         PIC X(452).
  5094
  5095
  5096****************************************************************
  5097*             MORTALITY MASTER RECORD                          *
  5098****************************************************************
  5099
  5100     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5101         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5102                                INDEXED BY CF-MORT-NDX.
  5103             20  CF-MORT-TABLE              PIC X(5).
  5104             20  CF-MORT-TABLE-TYPE         PIC X.
  5105                 88  CF-MORT-JOINT              VALUE 'J'.
  5106                 88  CF-MORT-SINGLE             VALUE 'S'.
  5107                 88  CF-MORT-COMBINED           VALUE 'C'.
  5108                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5109                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5110             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5111             20  CF-MORT-AGE-METHOD         PIC XX.
  5112                 88  CF-AGE-LAST                VALUE 'AL'.
  5113                 88  CF-AGE-NEAR                VALUE 'AN'.
  5114             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5115             20  CF-MORT-ADJUSTMENT-DIRECTION
  5116                                            PIC X.
  5117                 88  CF-MINUS                   VALUE '-'.
  5118                 88  CF-PLUS                    VALUE '+'.
  5119             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5120             20  CF-MORT-JOINT-CODE         PIC X.
  5121                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5122             20  CF-MORT-PC-Q               PIC X.
  5123                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5124             20  CF-MORT-TABLE-CODE         PIC X(4).
  5125             20  CF-MORT-COMMENTS           PIC X(15).
  5126             20  FILLER                     PIC X(14).
  5127
  5128         16  FILLER                         PIC X(251).
  5129
  5130
  5131****************************************************************
  5132*             BUSSINESS TYPE MASTER RECORD                     *
  5133****************************************************************
  5134
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  98
* EL156.cbl
  5135     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5136* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5137* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5138* AND RECORD 05 IS TYPES 81-99
  5139         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5140             20  CF-BUSINESS-TITLE          PIC  X(19).
  5141             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5142                                            PIC S9V9(4) COMP-3.
  5143             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5144             20  FILLER                     PIC  X.
  5145         16  FILLER                         PIC  X(248).
  5146
  5147
  5148****************************************************************
  5149*             TERMINAL MASTER RECORD                           *
  5150****************************************************************
  5151
  5152     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5153
  5154         16  CF-COMPANY-TERMINALS.
  5155             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5156                                  PIC X(4).
  5157         16  FILLER               PIC X(248).
  5158
  5159
  5160****************************************************************
  5161*             LIFE EDIT MASTER RECORD                          *
  5162****************************************************************
  5163
  5164     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5165         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5166             20  CF-LIFE-CODE-IN            PIC XX.
  5167             20  CF-LIFE-CODE-OUT           PIC XX.
  5168         16  FILLER                         PIC X(248).
  5169
  5170
  5171****************************************************************
  5172*             AH EDIT MASTER RECORD                            *
  5173****************************************************************
  5174
  5175     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5176         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5177             20  CF-AH-CODE-IN              PIC XXX.
  5178             20  CF-AH-CODE-OUT             PIC XX.
  5179         16  FILLER                         PIC X(248).
  5180
  5181
  5182****************************************************************
  5183*             CREDIBILITY TABLES                               *
  5184****************************************************************
  5185
  5186     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5187         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5188                             INDEXED BY CF-CRDB-NDX.
  5189             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5190             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5191             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5192         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page  99
* EL156.cbl
  5193
  5194
  5195****************************************************************
  5196*             REPORT CUSTOMIZATION RECORD                      *
  5197****************************************************************
  5198
  5199     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5200         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5201             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5202             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5203             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5204**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5205****       A T-TRANSFER.                                   ****
  5206             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5207
  5208         16  FILLER                         PIC XX.
  5209
  5210         16  CF-CARRIER-CNTL-OPT.
  5211             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5212                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5213                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5214             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5215                                            PIC X.
  5216         16  CF-GROUP-CNTL-OPT.
  5217             20  CF-GROUP-OPT-SEQ           PIC 9.
  5218                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5219                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5220             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5221                                            PIC X(6).
  5222         16  CF-STATE-CNTL-OPT.
  5223             20  CF-STATE-OPT-SEQ           PIC 9.
  5224                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5225                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5226             20  CF-STATE-SELECT OCCURS 3 TIMES
  5227                                            PIC XX.
  5228         16  CF-ACCOUNT-CNTL-OPT.
  5229             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5230                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5231                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5232             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5233                                            PIC X(10).
  5234         16  CF-BUS-TYP-CNTL-OPT.
  5235             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5236                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5237                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5238             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5239                                            PIC XX.
  5240         16  CF-LF-TYP-CNTL-OPT.
  5241             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5242                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5243                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5244             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5245                                            PIC XX.
  5246         16  CF-AH-TYP-CNTL-OPT.
  5247             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5248                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5249                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5250             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 100
* EL156.cbl
  5251                                            PIC XX.
  5252         16  CF-REPTCD1-CNTL-OPT.
  5253             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5254                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5255                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5256             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5257                                            PIC X(10).
  5258         16  CF-REPTCD2-CNTL-OPT.
  5259             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5260                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5261                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5262             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5263                                            PIC X(10).
  5264         16  CF-USER1-CNTL-OPT.
  5265             20  CF-USER1-OPT-SEQ           PIC 9.
  5266                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5267                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5268             20  CF-USER1-SELECT OCCURS 3 TIMES
  5269                                            PIC X(10).
  5270         16  CF-USER2-CNTL-OPT.
  5271             20  CF-USER2-OPT-SEQ           PIC 9.
  5272                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5273                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5274             20  CF-USER2-SELECT OCCURS 3 TIMES
  5275                                            PIC X(10).
  5276         16  CF-USER3-CNTL-OPT.
  5277             20  CF-USER3-OPT-SEQ           PIC 9.
  5278                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5279                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5280             20  CF-USER3-SELECT OCCURS 3 TIMES
  5281                                            PIC X(10).
  5282         16  CF-USER4-CNTL-OPT.
  5283             20  CF-USER4-OPT-SEQ           PIC 9.
  5284                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5285                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5286             20  CF-USER4-SELECT OCCURS 3 TIMES
  5287                                            PIC X(10).
  5288         16  CF-USER5-CNTL-OPT.
  5289             20  CF-USER5-OPT-SEQ           PIC 9.
  5290                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5291                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5292             20  CF-USER5-SELECT OCCURS 3 TIMES
  5293                                            PIC X(10).
  5294         16  CF-REINS-CNTL-OPT.
  5295             20  CF-REINS-OPT-SEQ           PIC 9.
  5296                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5297                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5298             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5299                 24  CF-REINS-PRIME         PIC XXX.
  5300                 24  CF-REINS-SUB           PIC XXX.
  5301
  5302         16  CF-AGENT-CNTL-OPT.
  5303             20  CF-AGENT-OPT-SEQ           PIC 9.
  5304                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5305                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5306             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5307                                            PIC X(10).
  5308
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 101
* EL156.cbl
  5309         16  FILLER                         PIC X(43).
  5310
  5311         16  CF-LOSS-RATIO-SELECT.
  5312             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5313             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5314         16  CF-ENTRY-DATE-SELECT.
  5315             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5316             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5317         16  CF-EFFECTIVE-DATE-SELECT.
  5318             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5319             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5320
  5321         16  CF-EXCEPTION-LIST-IND          PIC X.
  5322             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5323
  5324         16  FILLER                         PIC X(318).
  5325
  5326****************************************************************
  5327*                  EXCEPTION REPORTING RECORD                  *
  5328****************************************************************
  5329
  5330     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5331         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5332             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5333
  5334         16  CF-COMBINED-LIFE-AH-OPT.
  5335             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5336             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5337             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5338             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5339
  5340         16  CF-LIFE-OPT.
  5341             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5342             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5343             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5344             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5345             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5346             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5347             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5348             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5349             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5350             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5351
  5352         16  CF-AH-OPT.
  5353             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5354             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5355             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5356             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5357             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5358             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5359             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5360             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5361             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5362             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5363
  5364         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5365             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5366             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 102
* EL156.cbl
  5367             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5368
  5369         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5370
  5371         16  FILLER                         PIC X(673).
  5372
  5373
  5374****************************************************************
  5375*             MORTGAGE SYSTEM PLAN RECORD                      *
  5376****************************************************************
  5377
  5378     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5379         16  CF-PLAN-TYPE                   PIC X.
  5380             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5381             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5382             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5383         16  CF-PLAN-ABBREV                 PIC XXX.
  5384         16  CF-PLAN-DESCRIPT               PIC X(10).
  5385         16  CF-PLAN-NOTES                  PIC X(20).
  5386         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5387         16  CF-PLAN-UNDERWRITING.
  5388             20  CF-PLAN-TERM-DATA.
  5389                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5390                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5391             20  CF-PLAN-AGE-DATA.
  5392                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5393                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5394                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5395             20  CF-PLAN-BENEFIT-DATA.
  5396                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5397                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5398                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5399                                            PIC S9(7)V99  COMP-3.
  5400         16  CF-PLAN-POLICY-FORMS.
  5401             20  CF-POLICY-FORM             PIC X(12).
  5402             20  CF-MASTER-APPLICATION      PIC X(12).
  5403             20  CF-MASTER-POLICY           PIC X(12).
  5404         16  CF-PLAN-RATING.
  5405             20  CF-RATE-CODE               PIC X(5).
  5406             20  CF-SEX-RATING              PIC X.
  5407                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5408                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5409             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5410             20  CF-SUB-STD-TYPE            PIC X.
  5411                 88  CF-PCT-OF-PREM            VALUE '1'.
  5412                 88  CF-PCT-OF-BENE            VALUE '2'.
  5413         16  CF-PLAN-PREM-TOLERANCES.
  5414             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5415             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5416         16  CF-PLAN-PYMT-TOLERANCES.
  5417             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5418             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5419         16  CF-PLAN-MISC-DATA.
  5420             20  FILLER                     PIC X.
  5421             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5422             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5423         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5424         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 103
* EL156.cbl
  5425             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5426                                                     '1'.
  5427             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5428                                                     '2'.
  5429         16  CF-MIB-SEARCH-SW               PIC X.
  5430             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5431             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5432             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5433             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5434         16  CF-ALPHA-SEARCH-SW             PIC X.
  5435             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5436             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5437             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5438             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5439             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5440             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5441             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5442             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5443             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5444             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5445                                                     'A' 'B' 'C'
  5446                                                     'X' 'Y' 'Z'.
  5447         16  CF-EFF-DT-RULE-SW              PIC X.
  5448             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5449             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5450             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5451             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5452             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5453         16  FILLER                         PIC X(4).
  5454         16  CF-HEALTH-QUESTIONS            PIC X.
  5455             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5456         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5457         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5458         16  CF-PLAN-SNGL-JNT               PIC X.
  5459             88  CF-COMBINED-PLAN              VALUE 'C'.
  5460             88  CF-JNT-PLAN                   VALUE 'J'.
  5461             88  CF-SNGL-PLAN                  VALUE 'S'.
  5462         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5463         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5464         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5465         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5466         16  CF-RERATE-CNTL                 PIC  X.
  5467             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5468             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5469             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5470             88  CF-AUTO-RECALC                 VALUE '4'.
  5471         16  CF-BENEFIT-TYPE                PIC  X.
  5472             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5473             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5474         16  CF-POLICY-FEE                  PIC S999V99
  5475                                                    COMP-3.
  5476         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5477         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5478         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5479         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5480         16  FILLER                         PIC  X(32).
  5481         16  CF-TERMINATION-FORM            PIC  X(04).
  5482         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 104
* EL156.cbl
  5483         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5484                                                       COMP-3.
  5485         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5486         16  CF-ISSUE-LETTER                PIC  X(4).
  5487         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5488         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5489             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5490             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5491         16  CF-MP-REFUND-CALC              PIC X.
  5492             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5493             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5494             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5495             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5496             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5497             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5498             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5499             88  CF-MP-REFD-MEAN                VALUE '8'.
  5500         16  CF-ALT-RATE-CODE               PIC  X(5).
  5501
  5502
  5503         16  FILLER                         PIC X(498).
  5504****************************************************************
  5505*             MORTGAGE COMPANY MASTER RECORD                   *
  5506****************************************************************
  5507
  5508     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5509         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5510         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5511             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5512             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5513             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5514             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5515             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5516
  5517         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5518         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5519         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5520         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5521         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5522
  5523         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5524             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5525         16  CF-MP-RECON-USE-IND            PIC X(1).
  5526             88  CF-MP-USE-RECON             VALUE 'Y'.
  5527         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5528             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5529         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5530             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5531             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5532         16  FILLER                         PIC X(1).
  5533         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5534             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5535         16  CF-MORTG-MIB-VERSION           PIC X.
  5536             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5537             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5538             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5539         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5540             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 105
* EL156.cbl
  5541                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5542             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5543                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5544             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5545                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5546             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5547                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5548             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5549                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5550             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5551                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5552         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5553         16  FILLER                         PIC X(7).
  5554         16  CF-MORTG-DESTINATION-SYMBOL.
  5555             20  CF-MORTG-MIB-COMM          PIC X(5).
  5556             20  CF-MORTG-MIB-TERM          PIC X(5).
  5557         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5558             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5559         16  FILLER                         PIC X(03).
  5560         16  CF-MP-CHECK-NO-CONTROL.
  5561             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5562                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5563                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5564                                                ' ' LOW-VALUES.
  5565                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5566                                               VALUE '3'.
  5567         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5568         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5569         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5570             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5571                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5572             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5573                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5574             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5575                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5576             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5577                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5578             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5579                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5580             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5581                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5582         16  CF-MORTG-BILLING-AREA.
  5583             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5584                                            PIC X.
  5585         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5586         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5587         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5588         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5589             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5590             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5591         16  FILLER                         PIC X.
  5592         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5593             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5594             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5595         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5596         16  FILLER                         PIC X(8).
  5597         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5598         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 106
* EL156.cbl
  5599         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5600         16  CF-ACH-COMPANY-ID.
  5601             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5602                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5603                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5604                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5605             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5606         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5607             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5608         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5609             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5610             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5611         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5612         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5613         16  FILLER                         PIC X(536).
  5614
  5615****************************************************************
  5616*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5617****************************************************************
  5618
  5619     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5620         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5621             20  CF-FEMALE-HEIGHT.
  5622                 24  CF-FEMALE-FT           PIC 99.
  5623                 24  CF-FEMALE-IN           PIC 99.
  5624             20  CF-FEMALE-MIN-WT           PIC 999.
  5625             20  CF-FEMALE-MAX-WT           PIC 999.
  5626         16  FILLER                         PIC X(428).
  5627
  5628     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5629         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5630             20  CF-MALE-HEIGHT.
  5631                 24  CF-MALE-FT             PIC 99.
  5632                 24  CF-MALE-IN             PIC 99.
  5633             20  CF-MALE-MIN-WT             PIC 999.
  5634             20  CF-MALE-MAX-WT             PIC 999.
  5635         16  FILLER                         PIC X(428).
  5636******************************************************************
  5637*             AUTOMATIC ACTIVITY RECORD                          *
  5638******************************************************************
  5639     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5640         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5641             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5642             20  CF-SYS-LETTER-ID           PIC X(04).
  5643             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5644             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5645             20  CF-SYS-RESET-SW            PIC X(01).
  5646             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5647             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5648
  5649         16  FILLER                         PIC X(50).
  5650
  5651         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5652             20  CF-USER-ACTIVE-SW          PIC X(01).
  5653             20  CF-USER-LETTER-ID          PIC X(04).
  5654             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5655             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5656             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 107
* EL156.cbl
  5657             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5658             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5659             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5660
  5661         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 108
* EL156.cbl
  5663*    COPY ELCCERT.
  5664******************************************************************
  5665*                                                                *
  5666*                            ELCCERT.                            *
  5667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5668*                            VMOD=2.013                          *
  5669*                                                                *
  5670*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5671*                                                                *
  5672*   FILE TYPE = VSAM,KSDS                                        *
  5673*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5674*                                                                *
  5675*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5676*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5677*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5678*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5679*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5680*                                                                *
  5681*   LOG = YES                                                    *
  5682*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5683******************************************************************
  5684*                   C H A N G E   L O G
  5685*
  5686* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5687*-----------------------------------------------------------------
  5688*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5689* EFFECTIVE    NUMBER
  5690*-----------------------------------------------------------------
  5691* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5692* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5693* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5694* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5695* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5696* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5697* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5698* 032612  CR2011110200001  PEMA  AHL CHANGES
  5699* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5700* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5701* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5702******************************************************************
  5703
  5704 01  CERTIFICATE-MASTER.
  5705     12  CM-RECORD-ID                      PIC XX.
  5706         88  VALID-CM-ID                      VALUE 'CM'.
  5707
  5708     12  CM-CONTROL-PRIMARY.
  5709         16  CM-COMPANY-CD                 PIC X.
  5710         16  CM-CARRIER                    PIC X.
  5711         16  CM-GROUPING.
  5712             20  CM-GROUPING-PREFIX        PIC X(3).
  5713             20  CM-GROUPING-PRIME         PIC X(3).
  5714         16  CM-STATE                      PIC XX.
  5715         16  CM-ACCOUNT.
  5716             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5717             20  CM-ACCOUNT-PRIME          PIC X(6).
  5718         16  CM-CERT-EFF-DT                PIC XX.
  5719         16  CM-CERT-NO.
  5720             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 109
* EL156.cbl
  5721             20  CM-CERT-SFX               PIC X.
  5722
  5723     12  CM-CONTROL-BY-NAME.
  5724         16  CM-COMPANY-CD-A1              PIC X.
  5725         16  CM-INSURED-LAST-NAME          PIC X(15).
  5726         16  CM-INSURED-INITIALS.
  5727             20  CM-INSURED-INITIAL1       PIC X.
  5728             20  CM-INSURED-INITIAL2       PIC X.
  5729
  5730     12  CM-CONTROL-BY-SSN.
  5731         16  CM-COMPANY-CD-A2              PIC X.
  5732         16  CM-SOC-SEC-NO.
  5733             20  CM-SSN-STATE              PIC XX.
  5734             20  CM-SSN-ACCOUNT            PIC X(6).
  5735             20  CM-SSN-LN3.
  5736                 25  CM-INSURED-INITIALS-A2.
  5737                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5738                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5739                 25 CM-PART-LAST-NAME-A2         PIC X.
  5740
  5741     12  CM-CONTROL-BY-CERT-NO.
  5742         16  CM-COMPANY-CD-A4              PIC X.
  5743         16  CM-CERT-NO-A4                 PIC X(11).
  5744
  5745     12  CM-CONTROL-BY-MEMB.
  5746         16  CM-COMPANY-CD-A5              PIC X.
  5747         16  CM-MEMBER-NO.
  5748             20  CM-MEMB-STATE             PIC XX.
  5749             20  CM-MEMB-ACCOUNT           PIC X(6).
  5750             20  CM-MEMB-LN4.
  5751                 25  CM-INSURED-INITIALS-A5.
  5752                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5753                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5754                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5755
  5756     12  CM-INSURED-PROFILE-DATA.
  5757         16  CM-INSURED-FIRST-NAME.
  5758             20  CM-INSURED-1ST-INIT       PIC X.
  5759             20  FILLER                    PIC X(9).
  5760         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5761         16  CM-INSURED-SEX                PIC X.
  5762             88  CM-SEX-MALE                  VALUE 'M'.
  5763             88  CM-SEX-FEMAL                 VALUE 'F'.
  5764         16  CM-INSURED-JOINT-AGE          PIC 99.
  5765         16  CM-JOINT-INSURED-NAME.
  5766             20  CM-JT-LAST-NAME           PIC X(15).
  5767             20  CM-JT-FIRST-NAME.
  5768                 24  CM-JT-1ST-INIT        PIC X.
  5769                 24  FILLER                PIC X(9).
  5770             20  CM-JT-INITIAL             PIC X.
  5771
  5772     12  CM-LIFE-DATA.
  5773         16  CM-LF-BENEFIT-CD              PIC XX.
  5774         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5775         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5776         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5777         16  CM-LF-DEV-CODE                PIC XXX.
  5778         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 110
* EL156.cbl
  5779         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5780         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5781         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5782         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5783         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5784         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5785         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5786         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5787         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5788         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5789         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5790         16  cm-temp-epiq                  pic xx.
  5791             88  EPIQ-CLASS                  value 'EQ'.
  5792*        16  FILLER                        PIC XX.
  5793
  5794     12  CM-AH-DATA.
  5795         16  CM-AH-BENEFIT-CD              PIC XX.
  5796         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5797         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5798         16  CM-AH-DEV-CODE                PIC XXX.
  5799         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5800         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5801         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5802         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5803         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5804         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5805         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5806         16  CM-AH-PAID-THRU-DT            PIC XX.
  5807             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5808         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5809         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5810         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5811         16  FILLER                        PIC X.
  5812
  5813     12  CM-LOAN-INFORMATION.
  5814         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5815         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5816                                           PIC S9(5)V99  COMP-3.
  5817         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5818         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5819         16  CM-PAY-FREQUENCY              PIC S99.
  5820         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5821         16  CM-RATE-CLASS                 PIC XX.
  5822         16  CM-BENEFICIARY                PIC X(25).
  5823         16  CM-POLICY-FORM-NO             PIC X(12).
  5824         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5825         16  CM-LAST-ADD-ON-DT             PIC XX.
  5826         16  CM-DEDUCTIBLE-AMOUNTS.
  5827             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5828             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5829         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5830             20  CM-RESIDENT-STATE         PIC XX.
  5831             20  CM-RATE-CODE              PIC X(4).
  5832             20  FILLER                    PIC XX.
  5833         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5834             20  CM-LOAN-OFFICER           PIC X(5).
  5835             20  FILLER                    PIC XXX.
  5836         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 111
* EL156.cbl
  5837         16  CM-UNDERWRITING-CODE          PIC X.
  5838             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5839         16  CM-POST-CARD-IND              PIC X.
  5840         16  CM-REF-INTERFACE-SW           PIC X.
  5841         16  CM-PREMIUM-TYPE               PIC X.
  5842             88  CM-SING-PRM                  VALUE '1'.
  5843             88  CM-O-B-COVERAGE              VALUE '2'.
  5844             88  CM-OPEN-END                  VALUE '3'.
  5845         16  CM-IND-GRP-TYPE               PIC X.
  5846             88  CM-INDIVIDUAL                VALUE 'I'.
  5847             88  CM-GROUP                     VALUE 'G'.
  5848         16  CM-SKIP-CODE                  PIC X.
  5849             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5850             88  SKIP-JULY                    VALUE '1'.
  5851             88  SKIP-AUGUST                  VALUE '2'.
  5852             88  SKIP-SEPTEMBER               VALUE '3'.
  5853             88  SKIP-JULY-AUG                VALUE '4'.
  5854             88  SKIP-AUG-SEPT                VALUE '5'.
  5855             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5856             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5857             88  SKIP-JUNE                    VALUE '8'.
  5858             88  SKIP-JUNE-JULY               VALUE '9'.
  5859             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5860             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5861         16  CM-PAYMENT-MODE               PIC X.
  5862             88  PAY-MONTHLY                  VALUE SPACE.
  5863             88  PAY-WEEKLY                   VALUE '1'.
  5864             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5865             88  PAY-BI-WEEKLY                VALUE '3'.
  5866             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5867         16  CM-LOAN-NUMBER                PIC X(8).
  5868         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5869         16  CM-OLD-LOF                    PIC XXX.
  5870*        16  CM-LOAN-OFFICER               PIC XXX.
  5871         16  CM-REIN-TABLE                 PIC XXX.
  5872         16  CM-SPECIAL-REIN-CODE          PIC X.
  5873         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5874         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5875         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5876
  5877     12  CM-STATUS-DATA.
  5878         16  CM-ENTRY-STATUS               PIC X.
  5879         16  CM-ENTRY-DT                   PIC XX.
  5880
  5881         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5882         16  CM-LF-CANCEL-DT               PIC XX.
  5883         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5884
  5885         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5886         16  CM-LF-DEATH-DT                PIC XX.
  5887         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5888
  5889         16  CM-LF-CURRENT-STATUS          PIC X.
  5890             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5891                                                'M' '4' '5' '9'.
  5892             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5893             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5894             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 112
* EL156.cbl
  5895             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5896             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5897             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5898             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5899             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5900             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5901             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5902             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5903             88  CM-LF-DECLINED               VALUE 'D'.
  5904             88  CM-LF-VOIDED                 VALUE 'V'.
  5905
  5906         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5907         16  CM-AH-CANCEL-DT               PIC XX.
  5908         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5909
  5910         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5911         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5912         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5913
  5914         16  CM-AH-CURRENT-STATUS          PIC X.
  5915             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5916                                                'M' '4' '5' '9'.
  5917             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5918             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5919             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5920             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5921             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5922             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5923             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5924             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5925             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5926             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5927             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5928             88  CM-AH-DECLINED               VALUE 'D'.
  5929             88  CM-AH-VOIDED                 VALUE 'V'.
  5930
  5931         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5932             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5933             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5934             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5935         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5936
  5937         16  CM-ENTRY-BATCH                PIC X(6).
  5938         16  CM-LF-EXIT-BATCH              PIC X(6).
  5939         16  CM-AH-EXIT-BATCH              PIC X(6).
  5940         16  CM-LAST-MONTH-END             PIC XX.
  5941
  5942     12  CM-NOTE-SW                        PIC X.
  5943         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5944         88  CERT-NOTES-PRESENT               VALUE '1'.
  5945         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5946         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5947         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5948         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5949         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5950         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5951     12  CM-COMP-EXCP-SW                   PIC X.
  5952         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 113
* EL156.cbl
  5953         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5954     12  CM-INSURED-ADDRESS-SW             PIC X.
  5955         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5956         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5957
  5958*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5959     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5960     12  FILLER                            PIC X.
  5961
  5962*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5963     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5964     12  FILLER                            PIC X.
  5965*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5966     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5967
  5968     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5969         88  CERT-ADDED-BATCH                 VALUE ' '.
  5970         88  CERT-ADDED-ONLINE                VALUE '1'.
  5971         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5972         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5973         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5974     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5975         88  CERT-AS-LOADED                   VALUE ' '.
  5976         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5977         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5978         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5979         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5980         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5981         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5982         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5983
  5984     12  CM-ACCOUNT-COMM-PCTS.
  5985         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5986         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5987
  5988     12  CM-USER-FIELD                     PIC X.
  5989     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5990     12  CM-CLP-STATE                      PIC XX.
  5991     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5992     12  CM-USER-RESERVED                  PIC XXX.
  5993     12  FILLER REDEFINES CM-USER-RESERVED.
  5994         16  CM-AH-CLASS-CD                PIC XX.
  5995         16  F                             PIC X.
  5996******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 114
* EL156.cbl
  5998*    COPY ELCTRLR.
  5999******************************************************************
  6000*                                                                *
  6001*                            ELCTRLR.                            *
  6002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6003*                            VMOD=2.014                          *
  6004*                                                                *
  6005*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  6006*                                                                *
  6007*   FILE TYPE = VSAM,KSDS                                        *
  6008*   RECORD SIZE = 200    RECFORM = FIXED                         *
  6009*                                                                *
  6010*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6011*       ALTERNATE INDEX = NONE                                   *
  6012*                                                                *
  6013*   LOG = YES                                                    *
  6014*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6015******************************************************************
  6016*                   C H A N G E   L O G
  6017*
  6018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6019*-----------------------------------------------------------------
  6020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6021* EFFECTIVE    NUMBER
  6022*-----------------------------------------------------------------
  6023* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6024* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6025* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6026* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6027* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6028* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6029* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6030* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6031* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6032* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6033* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6034* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6035* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6036* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6037* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6038* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6039* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6040* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6041* 040814    2014030500002  AJRA  ADD ICD CODES
  6042* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6043* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6044* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6045* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  6046******************************************************************
  6047 01  ACTIVITY-TRAILERS.
  6048     12  AT-RECORD-ID                    PIC XX.
  6049         88  VALID-AT-ID                       VALUE 'AT'.
  6050
  6051     12  AT-CONTROL-PRIMARY.
  6052         16  AT-COMPANY-CD               PIC X.
  6053         16  AT-CARRIER                  PIC X.
  6054         16  AT-CLAIM-NO                 PIC X(7).
  6055         16  AT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 115
* EL156.cbl
  6056             20  AT-CERT-PRIME           PIC X(10).
  6057             20  AT-CERT-SFX             PIC X.
  6058         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6059             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6060             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6061             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6062             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6063             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6064             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6065             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6066             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6067             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6068             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6069             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6070             88  AT-BENEFICIARY-TRL           VALUE +91.
  6071             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6072             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6073             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6074             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6075
  6076     12  AT-TRAILER-TYPE                 PIC X.
  6077         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6078         88  PAYMENT-TR                       VALUE '2'.
  6079         88  AUTO-PAY-TR                      VALUE '3'.
  6080         88  CORRESPONDENCE-TR                VALUE '4'.
  6081         88  ADDRESS-TR                       VALUE '5'.
  6082         88  GENERAL-INFO-TR                  VALUE '6'.
  6083         88  AUTO-PROMPT-TR                   VALUE '7'.
  6084         88  DENIAL-TR                        VALUE '8'.
  6085         88  INCURRED-CHG-TR                  VALUE '9'.
  6086         88  FORM-CONTROL-TR                  VALUE 'A'.
  6087
  6088     12  AT-RECORDED-DT                  PIC XX.
  6089     12  AT-RECORDED-BY                  PIC X(4).
  6090     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6091
  6092     12  AT-TRAILER-BODY                 PIC X(165).
  6093
  6094     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6095         16  AT-RESERVE-CONTROLS.
  6096             20  AT-MANUAL-SW            PIC X.
  6097                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6098             20  AT-FUTURE-SW            PIC X.
  6099                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6100             20  AT-PTC-SW               PIC X.
  6101                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6102             20  AT-IBNR-SW              PIC X.
  6103                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6104             20  AT-PTC-LF-SW            PIC X.
  6105                 88  AT-LF-PTC-USED          VALUE '1'.
  6106             20  AT-CDT-ACCESS-METHOD    PIC X.
  6107                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6108                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6109                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6110             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6111         16  AT-LAST-COMPUTED-DT         PIC XX.
  6112         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6113         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 116
* EL156.cbl
  6114         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6115         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6116         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6117         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6118         16  AT-EXPENSE-CONTROLS.
  6119             20  AT-EXPENSE-METHOD       PIC X.
  6120                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6121                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6122                 88  PERCENT-OF-PMT           VALUE '3'.
  6123                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6124             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6125             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6126         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6127         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6128
  6129         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6130         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6131
  6132*        16  FILLER                      PIC X(53).
  6133         16  FILLER                      PIC X(47).
  6134
  6135         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6136         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6137
  6138         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6139             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6140             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6141*                    C = CLOSED
  6142*                    O = OPEN
  6143             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6144*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6145
  6146     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6147         16  AT-PAYMENT-TYPE             PIC X.
  6148             88  PARTIAL-PAYMENT                VALUE '1'.
  6149             88  FINAL-PAYMENT                  VALUE '2'.
  6150             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6151             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6152             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6153             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6154             88  VOIDED-PAYMENT                 VALUE '9'.
  6155             88  TRANSFER                       VALUE 'T'.
  6156             88  LIFE-INTEREST                  VALUE 'I'.
  6157
  6158         16  AT-CLAIM-TYPE               PIC X.
  6159             88  PAID-FOR-AH                    VALUE 'A'.
  6160             88  PAID-FOR-LIFE                  VALUE 'L'.
  6161             88  PAID-FOR-IUI                   VALUE 'I'.
  6162             88  PAID-FOR-GAP                   VALUE 'G'.
  6163             88  PAID-FOR-FAM                   VALUE 'F'.
  6164             88  PAID-FOR-OTH                   VALUE 'O'.
  6165         16  AT-CLAIM-PREM-TYPE          PIC X.
  6166             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6167             88  AT-O-B-COVERAGE                VALUE '2'.
  6168             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6169         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6170         16  AT-CHECK-NO                 PIC X(7).
  6171         16  AT-PAID-FROM-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 117
* EL156.cbl
  6172         16  AT-PAID-THRU-DT             PIC XX.
  6173         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6174         16  AT-ACH-PAYMENT              PIC X.
  6175*        16  FILLER                      PIC X.
  6176         16  AT-PAYEES-NAME              PIC X(30).
  6177         16  AT-PAYMENT-ORIGIN           PIC X.
  6178             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6179             88  ONLINE-AUTO-PMT                VALUE '2'.
  6180             88  OFFLINE-PMT                    VALUE '3'.
  6181         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6182         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6183         16  AT-VOID-DATA.
  6184             20  AT-VOID-DT              PIC XX.
  6185*00144       20  AT-VOID-REASON          PIC X(30).
  6186             20  AT-VOID-REASON          PIC X(26).
  6187         16  AT-PMT-APPROVED-BY          PIC X(04).
  6188         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6189         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6190         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6191                                         PIC S99V9(5)  COMP-3.
  6192         16  AT-CREDIT-INTERFACE.
  6193             20  AT-PMT-SELECT-DT        PIC XX.
  6194                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6195             20  AT-PMT-ACCEPT-DT        PIC XX.
  6196                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6197             20  AT-VOID-SELECT-DT       PIC XX.
  6198                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6199             20  AT-VOID-ACCEPT-DT       PIC XX.
  6200                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6201
  6202         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6203                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6204                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6205         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6206
  6207         16  AT-FORCE-CONTROL            PIC X.
  6208             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6209         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6210         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6211         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6212         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6213         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6214         16  AT-BENEFIT-TYPE             PIC X.
  6215
  6216         16  AT-EXPENSE-TYPE             PIC X.
  6217         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6218
  6219         16  AT-PAYEE-TYPE-CD.
  6220             20  AT-PAYEE-TYPE           PIC X.
  6221                 88  INSURED-PAID           VALUE 'I'.
  6222                 88  BENEFICIARY-PAID       VALUE 'B'.
  6223                 88  ACCOUNT-PAID           VALUE 'A'.
  6224                 88  OTHER-1-PAID           VALUE 'O'.
  6225                 88  OTHER-2-PAID           VALUE 'Q'.
  6226                 88  DOCTOR-PAID            VALUE 'P'.
  6227                 88  EMPLOYER-PAID          VALUE 'E'.
  6228             20  AT-PAYEE-SEQ            PIC X.
  6229
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 118
* EL156.cbl
  6230         16  AT-CASH-PAYMENT             PIC X.
  6231         16  AT-GROUPED-PAYMENT          PIC X.
  6232         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6233         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6234         16  AT-APPROVED-LEVEL           PIC X.
  6235         16  AT-VOID-TYPE                PIC X.
  6236             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6237             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6238         16  AT-AIG-UNEMP-IND            PIC X.
  6239             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6240         16  AT-ASSOCIATES               PIC X.
  6241             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6242             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6243
  6244         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6245         16  AT-CV-PMT-CODE              PIC X.
  6246             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6247             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6248             88  FULL-ADD-PAYMENT           VALUE '3'.
  6249             88  HALF-ADD-PAYMENT           VALUE '4'.
  6250             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6251             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6252             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6253             88  ADDL-PAYMENT               VALUE '8'.
  6254
  6255         16  AT-EOB-CODE1                PIC XXX.
  6256         16  AT-EOB-CODE2                PIC XXX.
  6257         16  AT-EOB-CODE3                PIC XXX.
  6258         16  FILLER REDEFINES AT-EOB-CODE3.
  6259             20  AT-PRINT-CLM-FORM       PIC X.
  6260             20  AT-PRINT-SURVEY         PIC X.
  6261             20  AT-SPECIAL-RELEASE      PIC X.
  6262         16  AT-EOB-CODE4                PIC XXX.
  6263         16  FILLER REDEFINES AT-EOB-CODE4.
  6264             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6265             20  FILLER                  PIC X.
  6266         16  AT-EOB-CODE5                PIC XXX.
  6267         16  FILLER REDEFINES AT-EOB-CODE5.
  6268             20  AT-PMT-PROOF-DT         PIC XX.
  6269             20  FILLER                  PIC X.
  6270
  6271         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6272             88  AT-PRINT-EOB            VALUE 'Y'.
  6273
  6274         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6275         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6276
  6277     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6278         16  AT-SCHEDULE-START-DT        PIC XX.
  6279         16  AT-SCHEDULE-END-DT          PIC XX.
  6280         16  AT-TERMINATED-DT            PIC XX.
  6281         16  AT-LAST-PMT-TYPE            PIC X.
  6282             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6283             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6284         16  AT-FIRST-PMT-DATA.
  6285             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6286             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6287             20  AT-1ST-PAY-THRU-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 119
* EL156.cbl
  6288         16  AT-REGULAR-PMT-DATA.
  6289             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6290             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6291             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6292         16  AT-AUTO-PAYEE-CD.
  6293             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6294                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6295                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6296                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6297                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6298                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6299             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6300         16  AT-AUTO-PAY-DAY             PIC 99.
  6301         16  AT-AUTO-CASH                PIC X.
  6302             88  AT-CASH                      VALUE 'Y'.
  6303             88  AT-NON-CASH                  VALUE 'N'.
  6304*        16  FILLER                      PIC X(129).
  6305         16  AT-AUTO-END-LETTER          PIC X(4).
  6306         16  FILLER                      PIC X(125).
  6307
  6308         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6309         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6310
  6311     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6312         16  AT-LETTER-SENT-DT           PIC XX.
  6313         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6314         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6315         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6316         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6317         16  AT-LETTER-ORIGIN            PIC X.
  6318             88  ONLINE-CREATION              VALUE '1' '3'.
  6319             88  OFFLINE-CREATION             VALUE '2' '4'.
  6320             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6321             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6322         16  AT-STD-LETTER-FORM          PIC X(4).
  6323         16  AT-REASON-TEXT              PIC X(70).
  6324         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6325         16  AT-ADDRESEE-TYPE            PIC X.
  6326              88  INSURED-ADDRESEE            VALUE 'I'.
  6327              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6328              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6329              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6330              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6331              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6332              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6333         16  AT-ADDRESSEE-NAME           PIC X(30).
  6334         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6335         16  AT-RESEND-PRINT-DATE        PIC XX.
  6336         16  AT-CORR-SOL-UNSOL           PIC X.
  6337         16  AT-LETTER-PURGED-DT         PIC XX.
  6338*
  6339*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6340*
  6341         16  AT-CSO-REDEFINITION.
  6342             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6343             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6344             20  AT-LETTER-TO-BENE       PIC X(1).
  6345             20  AT-STOP-LETTER-DT       PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 120
* EL156.cbl
  6346             20  AT-AUTH-RCVD            PIC X(1).
  6347             20  FILLER                  PIC X(18).
  6348*             20  FILLER                  PIC X(27).
  6349             20  AT-CSO-LETTER-STATUS    PIC X.
  6350                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6351                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6352                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6353             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6354             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6355*
  6356*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6357*
  6358*        16  FILLER                      PIC X(26).
  6359*
  6360*        16  AT-DMD-BSR-CODE             PIC X.
  6361*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6362*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6363*
  6364*        16  AT-DMD-LETTER-STATUS        PIC X.
  6365*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6366*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6367*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6368*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6369*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6370
  6371         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6372         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6373
  6374     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6375         16  AT-ADDRESS-TYPE             PIC X.
  6376             88  INSURED-ADDRESS               VALUE 'I'.
  6377             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6378             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6379             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6380             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6381             88  OTHER-ADDRESS-1               VALUE 'O'.
  6382             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6383         16  AT-MAIL-TO-NAME             PIC X(30).
  6384         16  AT-ADDRESS-LINE-1           PIC X(30).
  6385         16  AT-ADDRESS-LINE-2           PIC X(30).
  6386         16  AT-CITY-STATE.
  6387             20  AT-CITY                 PIC X(28).
  6388             20  AT-STATE                PIC XX.
  6389         16  AT-ZIP.
  6390             20  AT-ZIP-CODE.
  6391                 24  AT-ZIP-1ST          PIC X.
  6392                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6393                 24  FILLER              PIC X(4).
  6394             20  AT-ZIP-PLUS4            PIC X(4).
  6395         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6396             20  AT-CAN-POSTAL-1         PIC XXX.
  6397             20  AT-CAN-POSTAL-2         PIC XXX.
  6398             20  FILLER                  PIC XXX.
  6399         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6400*         16  FILLER                      PIC X(23).
  6401         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6402         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6403         16  FILLER                      PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 121
* EL156.cbl
  6404         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6405         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6406
  6407     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6408         16  AT-INFO-LINE-1              PIC X(60).
  6409         16  FILLER REDEFINES AT-INFO-LINE-1.
  6410             20  AT-NOTE-ERROR-NO OCCURS 15
  6411                                         PIC X(4).
  6412         16  AT-INFO-LINE-2              PIC X(60).
  6413         16  FILLER REDEFINES AT-INFO-LINE-2.
  6414             20  AT-ICD-CODE-1           PIC X(8).
  6415             20  AT-ICD-CODE-2           PIC X(8).
  6416             20  FILLER                  PIC X(44).
  6417         16  AT-INFO-TRAILER-TYPE        PIC X.
  6418             88  AT-ERRORS-NOTE          VALUE 'E'.
  6419             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6420             88  AT-CALL-NOTE            VALUE 'C'.
  6421             88  AT-MAINT-NOTE           VALUE 'M'.
  6422             88  AT-CERT-CHANGE          VALUE 'X'.
  6423             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6424             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6425             88  AT-CERT-CANCELLED       VALUE 'T'.
  6426         16  AT-CALL-TYPE                PIC X.
  6427             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6428             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6429         16  AT-NOTE-CONTINUATION        PIC X.
  6430             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6431         16  AT-EOB-CODES-EXIST          PIC X.
  6432             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6433         16  FILLER                      PIC X(35).
  6434         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6435         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6436
  6437     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6438         16  AT-PROMPT-LINE-1            PIC X(60).
  6439         16  AT-PROMPT-LINE-2            PIC X(60).
  6440         16  AT-PROMPT-START-DT          PIC XX.
  6441         16  AT-PROMPT-END-DT            PIC XX.
  6442         16  FILLER                      PIC X(35).
  6443         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6444         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6445
  6446     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6447         16  AT-DENIAL-INFO-1            PIC X(60).
  6448         16  AT-DENIAL-INFO-2            PIC X(60).
  6449         16  AT-DENIAL-DT                PIC XX.
  6450         16  AT-RETRACTION-DT            PIC XX.
  6451         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6452*         16  FILLER                      PIC X(31).
  6453         16  AT-DENIAL-PROOF-DT          PIC XX.
  6454         16  FILLER                      PIC X(29).
  6455         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6456         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6457
  6458     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6459         16  AT-OLD-INCURRED-DT          PIC XX.
  6460         16  AT-OLD-REPORTED-DT          PIC XX.
  6461         16  AT-OLD-ESTABLISHED-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 122
* EL156.cbl
  6462         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6463         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6464         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6465         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6466         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6467         16  FILLER                      PIC X(26).
  6468         16  AT-OLD-DIAG-CODE            PIC X(6).
  6469         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6470         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6471         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6472         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6473         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6474         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6475         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6476         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6477         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6478         16  FILLER                      PIC X(9).
  6479         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6480
  6481     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6482         16  AT-FORM-SEND-ON-DT          PIC XX.
  6483         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6484         16  AT-FORM-RE-SEND-DT          PIC XX.
  6485         16  AT-FORM-ANSWERED-DT         PIC XX.
  6486         16  AT-FORM-PRINTED-DT          PIC XX.
  6487         16  AT-FORM-REPRINT-DT          PIC XX.
  6488         16  AT-FORM-TYPE                PIC X.
  6489             88  INITIAL-FORM                  VALUE '1'.
  6490             88  PROGRESS-FORM                 VALUE '2'.
  6491         16  AT-INSTRUCT-LN-1            PIC X(28).
  6492         16  AT-INSTRUCT-LN-2            PIC X(28).
  6493         16  AT-INSTRUCT-LN-3            PIC X(28).
  6494         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6495         16  AT-FORM-ADDRESS             PIC X.
  6496             88  FORM-TO-INSURED              VALUE 'I'.
  6497             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6498             88  FORM-TO-OTHER-1              VALUE 'O'.
  6499             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6500         16  AT-RELATED-1.
  6501             20 AT-REL-CARR-1            PIC X.
  6502             20 AT-REL-CLAIM-1           PIC X(7).
  6503             20 AT-REL-CERT-1            PIC X(11).
  6504         16  AT-RELATED-2.
  6505             20 AT-REL-CARR-2            PIC X.
  6506             20 AT-REL-CLAIM-2           PIC X(7).
  6507             20 AT-REL-CERT-2            PIC X(11).
  6508         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6509         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6510         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6511         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6512         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6513         16  AT-STOP-FORM-DT             PIC X(2).
  6514
  6515         16  FILLER                      PIC X(09).
  6516         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6517         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6518******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 123
* EL156.cbl
  6520*    COPY ELCACTQ.
  6521******************************************************************
  6522*                                                                *
  6523*                            ELCACTQ.                            *
  6524*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6525*                            VMOD=2.004                          *
  6526*                                                                *
  6527*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6528*                                                                *
  6529*   FILE TYPE = VSAM,KSDS                                        *
  6530*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6531*                                                                *
  6532*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6533*       ALTERNATE INDEX = NONE                                   *
  6534*                                                                *
  6535*   LOG = YES                                                    *
  6536*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6537*                                                                *
  6538*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6539******************************************************************
  6540
  6541 01  ACTIVITY-QUE.
  6542     12  AQ-RECORD-ID                PIC XX.
  6543         88  VALID-AQ-ID                VALUE 'AQ'.
  6544
  6545     12  AQ-CONTROL-PRIMARY.
  6546         16  AQ-COMPANY-CD           PIC X.
  6547         16  AQ-CARRIER              PIC X.
  6548         16  AQ-CLAIM-NO             PIC X(7).
  6549         16  AQ-CERT-NO.
  6550             20  AQ-CERT-PRIME       PIC X(10).
  6551             20  AQ-CERT-SFX         PIC X.
  6552
  6553     12  AQ-PENDING-ACTIVITY-FLAGS.
  6554         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6555         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6556             88  PENDING-PAYMENTS       VALUE '1'.
  6557         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6558             88  PENDING-FULL-PRINT     VALUE '1'.
  6559             88  PENDING-PART-PRINT     VALUE '2'.
  6560         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6561             88  PENDING-LETTERS        VALUE '1'.
  6562         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6563             88  PENDING-RESTORE        VALUE 'C'.
  6564             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6565
  6566     12  FILLER                      PIC X(20).
  6567
  6568     12  AQ-RESEND-DATE              PIC XX.
  6569     12  AQ-FOLLOWUP-DATE            PIC XX.
  6570     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6571     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6572     12  AQ-AUTO-LETTER              PIC X(4).
  6573     12  FILLER                      PIC XX.
  6574     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6575*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 124
* EL156.cbl
  6577*    COPY ERCACCT.
  6578******************************************************************
  6579*                                                                *
  6580*                                                                *
  6581*                            ERCACCT                             *
  6582*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6583*                            VMOD=2.031                          *
  6584*                                                                *
  6585*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6586*                                                                *
  6587*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6588*   VSAM ACCOUNT MASTER FILES.                                   *
  6589*                                                                *
  6590*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6591*                                                                *
  6592*   FILE TYPE = VSAM,KSDS                                        *
  6593*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6594*                                                                *
  6595*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6596*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6597*                                                                *
  6598*   LOG = NO                                                     *
  6599*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6600*                                                                *
  6601*                                                                *
  6602******************************************************************
  6603*                   C H A N G E   L O G
  6604*
  6605* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6606*-----------------------------------------------------------------
  6607*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6608* EFFECTIVE    NUMBER
  6609*-----------------------------------------------------------------
  6610* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6611* 092705    2005050300006  PEMA  ADD SPP LEASES
  6612* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6613* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6614* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6615* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6616* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6617* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6618******************************************************************
  6619
  6620 01  ACCOUNT-MASTER.
  6621     12  AM-RECORD-ID                      PIC XX.
  6622         88  VALID-AM-ID                      VALUE 'AM'.
  6623
  6624     12  AM-CONTROL-PRIMARY.
  6625         16  AM-COMPANY-CD                 PIC X.
  6626         16  AM-MSTR-CNTRL.
  6627             20  AM-CONTROL-A.
  6628                 24  AM-CARRIER            PIC X.
  6629                 24  AM-GROUPING.
  6630                     28 AM-GROUPING-PREFIX PIC XXX.
  6631                     28 AM-GROUPING-PRIME  PIC XXX.
  6632                 24  AM-STATE              PIC XX.
  6633                 24  AM-ACCOUNT.
  6634                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 125
* EL156.cbl
  6635                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6636             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6637                                           PIC X(19).
  6638             20  AM-CNTRL-B.
  6639                 24  AM-EXPIRATION-DT      PIC XX.
  6640                 24  FILLER                PIC X(4).
  6641             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6642                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6643
  6644     12  AM-CONTROL-BY-VAR-GRP.
  6645         16  AM-COMPANY-CD-A1              PIC X.
  6646         16  AM-VG-CARRIER                 PIC X.
  6647         16  AM-VG-GROUPING                PIC X(6).
  6648         16  AM-VG-STATE                   PIC XX.
  6649         16  AM-VG-ACCOUNT                 PIC X(10).
  6650         16  AM-VG-DATE.
  6651             20  AM-VG-EXPIRATION-DT       PIC XX.
  6652             20  FILLER                    PIC X(4).
  6653         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6654                                           PIC 9(11)      COMP-3.
  6655     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6656         16  FILLER                        PIC X(10).
  6657         16  AM-VG-KEY3.
  6658             20  AM-VG3-ACCOUNT            PIC X(10).
  6659             20  AM-VG3-EXP-DT             PIC XX.
  6660         16  FILLER                        PIC X(4).
  6661     12  AM-MAINT-INFORMATION.
  6662         16  AM-LAST-MAINT-DT              PIC XX.
  6663         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6664         16  AM-LAST-MAINT-USER            PIC X(4).
  6665         16  FILLER                        PIC XX.
  6666
  6667     12  AM-EFFECTIVE-DT                   PIC XX.
  6668     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6669
  6670     12  AM-PREV-DATES  COMP-3.
  6671         16  AM-PREV-EXP-DT                PIC 9(11).
  6672         16  AM-PREV-EFF-DT                PIC 9(11).
  6673
  6674     12  AM-REPORT-CODE-1                  PIC X(10).
  6675     12  AM-REPORT-CODE-2                  PIC X(10).
  6676
  6677     12  AM-CITY-CODE                      PIC X(4).
  6678     12  AM-COUNTY-PARISH                  PIC X(6).
  6679
  6680     12  AM-NAME                           PIC X(30).
  6681     12  AM-PERSON                         PIC X(30).
  6682     12  AM-ADDRS                          PIC X(30).
  6683     12  AM-CITY.
  6684         16  AM-ADDR-CITY                  PIC X(28).
  6685         16  AM-ADDR-STATE                 PIC XX.
  6686     12  AM-ZIP.
  6687         16  AM-ZIP-PRIME.
  6688             20  AM-ZIP-PRI-1ST            PIC X.
  6689                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6690             20  FILLER                    PIC X(4).
  6691         16  AM-ZIP-PLUS4                  PIC X(4).
  6692     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 126
* EL156.cbl
  6693         16  AM-CAN-POSTAL-1               PIC XXX.
  6694         16  AM-CAN-POSTAL-2               PIC XXX.
  6695         16  FILLER                        PIC XXX.
  6696     12  AM-TEL-NO.
  6697         16  AM-AREA-CODE                  PIC 999.
  6698         16  AM-TEL-PRE                    PIC 999.
  6699         16  AM-TEL-NBR                    PIC 9(4).
  6700     12  AM-TEL-LOC                        PIC X.
  6701         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6702         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6703
  6704     12  AM-COMM-STRUCTURE.
  6705         16  AM-DEFN-1.
  6706             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6707                 24  AM-AGT.
  6708                     28  AM-AGT-PREFIX     PIC X(4).
  6709                     28  AM-AGT-PRIME      PIC X(6).
  6710                 24  AM-COM-TYP            PIC X.
  6711                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6712                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6713                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6714                 24  AM-RECALC-LV-INDIC    PIC X.
  6715                 24  AM-RETRO-LV-INDIC     PIC X.
  6716                 24  AM-GL-CODES           PIC X.
  6717                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6718                 24  FILLER                PIC X(01).
  6719         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6720             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6721                 24  FILLER                PIC X(11).
  6722                 24  AM-L-COMA             PIC XXX.
  6723                 24  AM-J-COMA             PIC XXX.
  6724                 24  AM-A-COMA             PIC XXX.
  6725                 24  FILLER                PIC X(6).
  6726
  6727     12  AM-COMM-CHANGE-STATUS             PIC X.
  6728         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6729
  6730     12  AM-CSR-CODE                       PIC X(4).
  6731
  6732     12  AM-BILLING-STATUS                 PIC X.
  6733         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6734         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6735     12  AM-AUTO-REFUND-SW                 PIC X.
  6736         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6737         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6738     12  AM-GPCD                           PIC 99.
  6739     12  AM-IG                             PIC X.
  6740         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6741         88  AM-HAS-GROUP                     VALUE '2'.
  6742     12  AM-STATUS                         PIC X.
  6743         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6744         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6745         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6746         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6747         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6748         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6749         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6750         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 127
* EL156.cbl
  6751         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6752         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6753     12  AM-REMIT-TO                       PIC 99.
  6754     12  AM-ID-NO                          PIC X(11).
  6755
  6756     12  AM-CAL-TABLE                      PIC XX.
  6757     12  AM-LF-DEVIATION                   PIC XXX.
  6758     12  AM-AH-DEVIATION                   PIC XXX.
  6759     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6760     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6761     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6762     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6763     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6764     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6765
  6766     12  AM-USER-FIELDS.
  6767         16  AM-FLD-1                      PIC XX.
  6768         16  AM-FLD-2                      PIC XX.
  6769         16  AM-FLD-3                      PIC XX.
  6770         16  AM-FLD-4                      PIC XX.
  6771         16  AM-FLD-5                      PIC XX.
  6772
  6773     12  AM-1ST-PROD-DATE.
  6774         16  AM-1ST-PROD-YR                PIC XX.
  6775         16  AM-1ST-PROD-MO                PIC XX.
  6776         16  AM-1ST-PROD-DA                PIC XX.
  6777     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6778     12  AM-CERTS-PURGED-DATE.
  6779         16  AM-PUR-YR                     PIC XX.
  6780         16  AM-PUR-MO                     PIC XX.
  6781         16  AM-PUR-DA                     PIC XX.
  6782     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6783     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6784     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6785     12  AM-INACTIVE-DATE.
  6786         16  AM-INA-MO                     PIC 99.
  6787         16  AM-INA-DA                     PIC 99.
  6788         16  AM-INA-YR                     PIC 99.
  6789     12  AM-AR-HI-CERT-DATE                PIC XX.
  6790
  6791     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6792     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6793
  6794     12  AM-OB-PAYMENT-MODE                PIC X.
  6795         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6796         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6797         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6798         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6799
  6800     12  AM-AH-ONLY-INDICATOR              PIC X.
  6801         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6802         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6803
  6804     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6805
  6806     12  AM-OVER-SHORT.
  6807         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6808         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 128
* EL156.cbl
  6809
  6810     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6811     12  AM-DCC-CLP-STATE                  PIC XX.
  6812
  6813     12  AM-RECALC-COMM                    PIC X.
  6814     12  AM-RECALC-REIN                    PIC X.
  6815
  6816     12  AM-REI-TABLE                      PIC XXX.
  6817     12  AM-REI-ET-LF                      PIC X.
  6818     12  AM-REI-ET-AH                      PIC X.
  6819     12  AM-REI-PE-LF                      PIC X.
  6820     12  AM-REI-PE-AH                      PIC X.
  6821     12  AM-REI-PRT-ST                     PIC X.
  6822     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6823     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6824     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6825     12  AM-REI-GROUP-A                    PIC X(6).
  6826     12  AM-REI-MORT                       PIC X(4).
  6827     12  AM-REI-PRT-OW                     PIC X.
  6828     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6829     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6830     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6831     12  AM-REI-GROUP-B                    PIC X(6).
  6832
  6833     12  AM-TRUST-TYPE                     PIC X(2).
  6834
  6835     12  AM-EMPLOYER-STMT-USED             PIC X.
  6836     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6837
  6838     12  AM-STD-AH-TYPE                    PIC XX.
  6839     12  AM-EARN-METHODS.
  6840         16  AM-EARN-METHOD-R              PIC X.
  6841             88 AM-REF-RL-R78                 VALUE 'R'.
  6842             88 AM-REF-RL-PR                  VALUE 'P'.
  6843             88 AM-REF-RL-MEAN                VALUE 'M'.
  6844             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6845         16  AM-EARN-METHOD-L              PIC X.
  6846             88 AM-REF-LL-R78                 VALUE 'R'.
  6847             88 AM-REF-LL-PR                  VALUE 'P'.
  6848             88 AM-REF-LL-MEAN                VALUE 'M'.
  6849             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6850         16  AM-EARN-METHOD-A              PIC X.
  6851             88 AM-REF-AH-R78                 VALUE 'R'.
  6852             88 AM-REF-AH-PR                  VALUE 'P'.
  6853             88 AM-REF-AH-MEAN                VALUE 'M'.
  6854             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6855             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6856             88 AM-REF-AH-NET                 VALUE 'N'.
  6857
  6858     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6859     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6860     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6861
  6862     12  AM-RET-Y-N                        PIC X.
  6863     12  AM-RET-P-E                        PIC X.
  6864     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6865     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6866     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 129
* EL156.cbl
  6867     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6868         16  AM-POOL-PRIME                 PIC XXX.
  6869         16  AM-POOL-SUB                   PIC XXX.
  6870     12  AM-RETRO-EARNINGS.
  6871         16  AM-RET-EARN-R                 PIC X.
  6872         16  AM-RET-EARN-L                 PIC X.
  6873         16  AM-RET-EARN-A                 PIC X.
  6874     12  AM-RET-ST-TAX-USE                 PIC X.
  6875         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6876         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6877     12  AM-RETRO-BEG-EARNINGS.
  6878         16  AM-RET-BEG-EARN-R             PIC X.
  6879         16  AM-RET-BEG-EARN-L             PIC X.
  6880         16  AM-RET-BEG-EARN-A             PIC X.
  6881     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6882     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6883
  6884     12  AM-USER-SELECT-OPTIONS.
  6885         16  AM-USER-SELECT-1              PIC X(10).
  6886         16  AM-USER-SELECT-2              PIC X(10).
  6887         16  AM-USER-SELECT-3              PIC X(10).
  6888         16  AM-USER-SELECT-4              PIC X(10).
  6889         16  AM-USER-SELECT-5              PIC X(10).
  6890
  6891     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6892
  6893     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6894
  6895     12  AM-RPT045A-SWITCH                 PIC X.
  6896         88  RPT045A-OFF                   VALUE 'N'.
  6897
  6898     12  AM-INSURANCE-LIMITS.
  6899         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6900         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6901
  6902     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6903         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6904
  6905     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6906         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6907         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6908
  6909     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6910
  6911     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6912     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6913     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6914     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6915     12  AM-DCC-UEF-STATE                  PIC XX.
  6916     12  FILLER                            PIC XXX.
  6917     12  AM-REPORT-CODE-3                  PIC X(10).
  6918*    12  FILLER                            PIC X(22).
  6919
  6920     12  AM-RESERVE-DATE.
  6921         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6922         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6923         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6924
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 130
* EL156.cbl
  6925     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6926     12  AM-NOTIFICATION-TYPES.
  6927         16  AM-NOTIF-OF-LETTERS           PIC X.
  6928         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6929         16  AM-NOTIF-OF-REPORTS           PIC X.
  6930         16  AM-NOTIF-OF-STATUS            PIC X.
  6931
  6932     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6933         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6934         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6935         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6936         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6937
  6938     12  AM-BENEFIT-CONTROLS.
  6939         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6940             20  AM-BENEFIT-CODE           PIC XX.
  6941             20  AM-BENEFIT-TYPE           PIC X.
  6942             20  AM-BENEFIT-REVISION       PIC XXX.
  6943             20  AM-BENEFIT-REM-TERM       PIC X.
  6944             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6945             20  FILLER                    PIC XX.
  6946         16  FILLER                        PIC X(80).
  6947
  6948     12  AM-TRANSFER-DATA.
  6949         16  AM-TRANSFERRED-FROM.
  6950             20  AM-TRNFROM-CARRIER        PIC X.
  6951             20  AM-TRNFROM-GROUPING.
  6952                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6953                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6954             20  AM-TRNFROM-STATE          PIC XX.
  6955             20  AM-TRNFROM-ACCOUNT.
  6956                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6957                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6958             20  AM-TRNFROM-DTE            PIC XX.
  6959         16  AM-TRANSFERRED-TO.
  6960             20  AM-TRNTO-CARRIER          PIC X.
  6961             20  AM-TRNTO-GROUPING.
  6962                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6963                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6964             20  AM-TRNTO-STATE            PIC XX.
  6965             20  AM-TRNTO-ACCOUNT.
  6966                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6967                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6968             20  AM-TRNTO-DTE              PIC XX.
  6969         16  FILLER                        PIC X(10).
  6970
  6971     12  AM-SAVED-REMIT-TO                 PIC 99.
  6972
  6973     12  AM-COMM-STRUCTURE-SAVED.
  6974         16  AM-DEFN-1-SAVED.
  6975             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6976                 24  AM-AGT-SV             PIC X(10).
  6977                 24  AM-COM-TYP-SV         PIC X.
  6978                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6979                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6980                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6981                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6982                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 131
* EL156.cbl
  6983                 24  AM-GL-CODES-SV        PIC X.
  6984                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6985                 24  FILLER                PIC X.
  6986         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6987             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6988                 24  FILLER                PIC X(11).
  6989                 24  AM-L-COMA-SV          PIC XXX.
  6990                 24  AM-J-COMA-SV          PIC XXX.
  6991                 24  AM-A-COMA-SV          PIC XXX.
  6992                 24  FILLER                PIC X(6).
  6993
  6994     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6995         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6996            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6997            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6998            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6999
  7000     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7001     12  FILLER                            PIC X(120).
  7002
  7003     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7004         16  AM-CONTROL-NAME               PIC X(30).
  7005         16  AM-EXECUTIVE-ONE.
  7006             20  AM-EXEC1-NAME             PIC X(15).
  7007             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7008                                                          COMP-3.
  7009             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7010                                                          COMP-3.
  7011         16  AM-EXECUTIVE-TWO.
  7012             20  AM-EXEC2-NAME             PIC X(15).
  7013             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7014                                                          COMP-3.
  7015             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7016                                                          COMP-3.
  7017
  7018     12  AM-RETRO-ADDITIONAL-DATA.
  7019         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7020         16  AM-RETRO-PREM-P-E             PIC X.
  7021         16  AM-RETRO-CLMS-P-I             PIC X.
  7022         16  AM-RETRO-RET-BRACKET-LF.
  7023             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7024                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7025                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7026             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7027                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7028                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7029             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7030                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7031                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7032         16  AM-RETRO-RET-BRACKET-AH.
  7033             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7034                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7035                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7036                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7037             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7038                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7039                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7040             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 132
* EL156.cbl
  7041                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7042                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7043
  7044     12  AM-COMMENTS.
  7045         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7046
  7047     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7048         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7049         16  AM-FLI-BILLING-CODE           PIC X.
  7050         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7051         16  AM-FLI-UNITED-IDENT           PIC X.
  7052         16  AM-FLI-INTEREST-LOST-DATA.
  7053             20  AM-FLI-BANK-NO            PIC X(5).
  7054             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7055             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7056             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7057         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7058             20  AM-FLI-AGT                PIC X(9).
  7059             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7060             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7061         16  FILLER                        PIC X(102).
  7062
  7063     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7064         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7065             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7066             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7067             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7068             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7069             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7070         16  FILLER                          PIC X(10).
  7071******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 133
* EL156.cbl
  7073*    COPY ELCCHKQ.
  7074******************************************************************
  7075*                                                                *
  7076*                                                                *
  7077*                            ELCCHKQ.                            *
  7078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7079*                            VMOD=2.007                          *
  7080*                                                                *
  7081*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7082*                                                                *
  7083*   FILE TYPE = VSAM,KSDS                                        *
  7084*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7085*                                                                *
  7086*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7087*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7088*                                                                *
  7089*   LOG = YES                                                    *
  7090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7091******************************************************************
  7092 01  CHECK-QUE.
  7093     12  CQ-RECORD-ID                PIC XX.
  7094         88  VALID-CQ-ID         VALUE 'CQ'.
  7095
  7096     12  CQ-CONTROL-PRIMARY.
  7097         16  CQ-COMPANY-CD           PIC X.
  7098         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7099         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7100
  7101     12  CQ-CONTROL-BY-PAYEE.
  7102         16  CQ-CONTROL-BY-NUMBER.
  7103             20  CQ-COMPANY-CD-A1     PIC X.
  7104             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7105         16  CQ-PAYEE-CARRIER        PIC X.
  7106         16  CQ-PAYEE-GROUPING       PIC X(6).
  7107         16  CQ-PAYEE-STATE          PIC XX.
  7108         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7109         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7110
  7111     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7112         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7113         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7114         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7115         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7116         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7117         16  FILLER                  PIC X(3).
  7118
  7119     12  CQ-ENTRY-TYPE               PIC X.
  7120             88  CHECK-ON-QUE           VALUE 'Q'.
  7121             88  ALIGNMENT-CHECK        VALUE 'A'.
  7122             88  SPOILED-CHECK          VALUE 'S'.
  7123             88  PAYMENT-ABORTED        VALUE 'X'.
  7124
  7125     12  CQ-CLAIM-MAST-CNTL.
  7126         16  CQ-CARRIER              PIC X.
  7127         16  CQ-CLAIM-NO             PIC X(7).
  7128         16  CQ-CERT-NO.
  7129             20  CQ-CERT-PRIME       PIC X(10).
  7130             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 134
* EL156.cbl
  7131         16  CQ-CLAIM-TYPE           PIC X.
  7132             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7133             88  CQ-AH-CLAIM            VALUE 'A'.
  7134         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7135             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7136             88  CQ-O-B-COVERAGE        VALUE '2'.
  7137             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7138
  7139     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7140     12  CQ-CHECK-NUMBER             PIC X(7).
  7141     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7142     12  CQ-PAYMENT-TYPE             PIC X.
  7143             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7144             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7145             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7146             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7147             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7148             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7149             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7150             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7151     12  CQ-VOID-INDICATOR           PIC X.
  7152             88  CHECK-IS-STOPPED          VALUE 'S'.
  7153             88  CHECK-IS-VOID             VALUE 'V'.
  7154     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7155     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7156     12  CQ-CHECK-BY-USER            PIC X(4).
  7157     12  CQ-PRE-NUMBERING-SW         PIC X.
  7158       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7159       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7160
  7161     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7162     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7163     12  CQ-LEDGER-FLAG              PIC X(01).
  7164     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7165     12  CQ-LAST-UPDATED-DT          PIC XX.
  7166     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7167     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7168
  7169     12  FILLER                      PIC X(04).
  7170
  7171******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 135
* EL156.cbl
  7173*    COPY ELCBENE.
  7174******************************************************************
  7175*                                                                *
  7176*                            ELCBENE.                            *
  7177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7178*                            VMOD=2.006                          *
  7179*                                                                *
  7180*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7181*                                                                *
  7182*   FILE TYPE = VSAM,KSDS                                        *
  7183*   RECORD SIZE = 500   RECFORM = FIX                            *
  7184*                                                                *
  7185*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7186*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7187*                                                                *
  7188*   LOG = YES                                                    *
  7189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7190*                                                                *
  7191*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7192******************************************************************
  7193*                   C H A N G E   L O G
  7194*
  7195* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7196*-----------------------------------------------------------------
  7197*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7198* EFFECTIVE    NUMBER
  7199*-----------------------------------------------------------------
  7200* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7201* 082317  CR2017082100003  PEMA  Add sub type
  7202******************************************************************
  7203
  7204 01  BENEFICIARY-MASTER.
  7205     12  BE-RECORD-ID                PIC XX.
  7206         88  VALID-BE-ID                VALUE 'BE'.
  7207
  7208     12  BE-CONTROL-PRIMARY.
  7209         16  BE-COMPANY-CD           PIC X.
  7210         16  BE-RECORD-TYPE          PIC X.
  7211             88  BENEFICIARY-RECORD  VALUE 'B'.
  7212             88  ADJUSTOR-RECORD     VALUE 'A'.
  7213         16  BE-BENEFICIARY          PIC X(10).
  7214     12  BE-CONTROL-BY-NAME.
  7215         16  BE-COMPANY-CD-A1        PIC X.
  7216         16  BE-RECORD-TYPE-A1       PIC X.
  7217         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7218         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7219
  7220     12  BE-LAST-MAINT-DT            PIC XX.
  7221     12  BE-LAST-MAINT-BY            PIC X(4).
  7222     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7223
  7224     12  BE-ADDRESS-DATA.
  7225         16  BE-MAIL-TO-NAME         PIC X(30).
  7226         16  BE-ADDRESS-LINE-1       PIC X(30).
  7227         16  BE-ADDRESS-LINE-2       PIC X(30).
  7228         16  BE-ADDRESS-LINE-3       PIC X(30).
  7229         16  BE-CITY-STATE.
  7230             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 136
* EL156.cbl
  7231             20  BE-STATE            PIC XX.
  7232         16  BE-ZIP-CODE.
  7233             20  BE-ZIP-PRIME.
  7234                 24  BE-ZIP-1ST      PIC X.
  7235                     88  BE-CANADIAN-POST-CODE
  7236                                         VALUE 'A' THRU 'Z'.
  7237                 24  FILLER          PIC X(4).
  7238             20  BE-ZIP-PLUS4        PIC X(4).
  7239         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7240             20  BE-CAN-POSTAL-1     PIC XXX.
  7241             20  BE-CAN-POSTAL-2     PIC XXX.
  7242             20  FILLER              PIC XXX.
  7243         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7244         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7245
  7246******************************************************************
  7247*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7248*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7249******************************************************************
  7250     12  BE-CARRIER                  PIC X.
  7251
  7252     12  BE-ADDRESS-DATA2.
  7253         16  BE-MAIL-TO-NAME2        PIC X(30).
  7254         16  BE-ADDRESS-LINE-12      PIC X(30).
  7255         16  BE-ADDRESS-LINE-22      PIC X(30).
  7256         16  BE-ADDRESS-LINE-32      PIC X(30).
  7257         16  BE-CITY-STATE2.
  7258             20  BE-CITY2            PIC X(28).
  7259             20  BE-STATE2           PIC XX.
  7260         16  BE-ZIP-CODE2.
  7261             20  BE-ZIP-PRIME2.
  7262                 24  BE-ZIP-1ST2     PIC X.
  7263                     88  BE-CANADIAN-POST-CODE2
  7264                                         VALUE 'A' THRU 'Z'.
  7265                 24  FILLER          PIC X(4).
  7266             20  BE-ZIP-PLUS42       PIC X(4).
  7267         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7268             20  BE-CAN-POSTAL-12    PIC XXX.
  7269             20  BE-CAN-POSTAL-22    PIC XXX.
  7270             20  FILLER              PIC XXX.
  7271         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7272         16  BE-ACH-DATA.
  7273             20  BE-ACH-YES-OR-NO    PIC X.
  7274                 88  BE-ON-ACH       VALUE 'Y'.
  7275                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7276             20  BE-ACH-ABA-ROUTING-NUMBER
  7277                                     PIC X(15).
  7278             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7279                                     PIC X(20).
  7280             20  BE-ACH-SUB-TYPE     PIC XX.
  7281             20  FILLER              PIC X(23).
  7282         16  BE-BILLING-STMT-DATA.
  7283*            20  BE-BSR              PIC X.
  7284*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7285*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7286*            20  BE-BSR-FROM         PIC X(30).
  7287*            20  BE-BSR-DEPT         PIC X(30).
  7288             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 137
* EL156.cbl
  7289             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7290             20  BE-OUTPUT-TYPE      PIC X.
  7291                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7292                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7293
  7294     12  FILLER                      PIC X(28).
  7295******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 138
* EL156.cbl
  7297*    COPY ELCARCH.
  7298******************************************************************
  7299*                                                                *
  7300*                            ELCARCH.                            *
  7301*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7302*                            VMOD=2.007                          *
  7303*                                                                *
  7304*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7305*                                                                *
  7306*   FILE TYPE = VSAM,KSDS                                        *
  7307*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7308*                                                                *
  7309*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7310*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7311*                                                                *
  7312*   LOG = NO                                                     *
  7313*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7314*                                                                *
  7315*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7316******************************************************************
  7317 01  LETTER-ARCHIVE.
  7318     12  LA-RECORD-ID                PIC XX.
  7319         88  VALID-LA-ID                VALUE 'LA'.
  7320
  7321     12  LA-CONTROL-PRIMARY.
  7322         16  LA-COMPANY-CD           PIC X.
  7323         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7324         16  LA-RECORD-TYPE          PIC X.
  7325             88  LA-HEADER-DATA         VALUE '1'.
  7326             88  LA-ADDRESS-DATA        VALUE '2'.
  7327             88  LA-TEXT-DATA           VALUE '3'.
  7328             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7329         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7330
  7331     12  LA-CONTROL-BY-TYPE.
  7332         16  LA-COMPANY-CD-A1        PIC X.
  7333         16  LA-RECORD-TYPE-A1       PIC X.
  7334         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7335         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7336
  7337     12  LA-TEXT-RECORD.
  7338         16  LA-SKIP-CONTROL         PIC XX.
  7339             88  NO-LINES-SKIPPED       VALUE SPACES.
  7340             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7341         16  LA-TEXT-LINE            PIC X(70).
  7342
  7343     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7344         16  FILLER                  PIC XX.
  7345         16  LA-ADDRESS-LINE         PIC X(30).
  7346         16  FILLER                  PIC X(40).
  7347
  7348     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7349         16  FILLER                  PIC XX.
  7350         16  LA-CARRIER              PIC X.
  7351         16  LA-CLAIM-NO             PIC X(7).
  7352         16  LA-CERT-NO.
  7353             20  LA-CERT-PRIME       PIC X(10).
  7354             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 139
* EL156.cbl
  7355         16  LA-NO-OF-COPIES         PIC S9.
  7356         16  LA-RESEND-DATE          PIC XX.
  7357         16  LA-PROCESSOR-CD         PIC X(4).
  7358         16  LA-CREATION-DT          PIC XX.
  7359         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7360         16  LA-RESEND-PRINT-DATE    PIC XX.
  7361         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7362         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7363*
  7364* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7365*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7366*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7367*   I        20  LA-DMD-RES-ST           PIC XX.
  7368*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7369*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7370*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7371*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7372*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7373*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7374*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7375*   I        20  LA-DMD-UND-CODE         PIC XX.
  7376*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7377*   V    16  FILLER                  PIC X(15).
  7378* -----
  7379*
  7380* REINSERTED  CSO  MODS
  7381*
  7382         16  FILLER.
  7383             20  FILLER                  PIC X(29).
  7384             20  LA-CSO-LETTER-STATUS    PIC X.
  7385                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7386                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7387                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7388             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7389             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7390*
  7391
  7392     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7393         16  FILLER                  PIC XX.
  7394         16  LA4-CARRIER             PIC X.
  7395         16  LA4-CLAIM-NO            PIC X(7).
  7396         16  LA4-CERT-NO.
  7397             20  LA4-CERT-PRIME      PIC X(10).
  7398             20  LA4-CERT-SFX        PIC X.
  7399         16  LA4-NO-OF-COPIES        PIC S9.
  7400         16  LA4-RESEND-DATE         PIC XX.
  7401         16  LA4-PROCESSOR-CD        PIC X(4).
  7402         16  LA4-CREATION-DT         PIC XX.
  7403         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7404         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7405         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7406         16  LA4-FORM-TYPE           PIC X.
  7407             88  LA4-INITIAL-FORM    VALUE '1'.
  7408             88  LA4-PROGRESS-FORM   VALUE '2'.
  7409         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7410         16  LA4-STATE               PIC X(02).
  7411         16  FILLER                  PIC X(31).
  7412******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 140
* EL156.cbl
  7414*    COPY ELCDAR.
  7415******************************************************************
  7416*                                                                *
  7417*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7418*   FILE TYPE = VSAM,KSDS                                        *
  7419*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7420*   BASE CLUSTER = DLYACTV                                       *
  7421*   LOG = YES                                                    *
  7422*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7423*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7424*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7425*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7426*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7427*               BY PROGRAM "LGINFCE".                            *
  7428*                                                                *
  7429******************************************************************
  7430 01  DAILY-ACTIVITY-RECORD.
  7431     05  DA-KEY.
  7432         10  DA-COMP-CD          PIC X.
  7433         10  DA-CARRIER          PIC X.
  7434         10  DA-CLAIM-NO         PIC X(7).
  7435         10  DA-CERT-NO.
  7436             15  DA-CERT-PRIME   PIC X(10).
  7437             15  DA-CERT-SFX     PIC X.
  7438     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7439     05  DA-RECORD-TYPE          PIC X.
  7440     05  FILLER                  PIC X(2).
  7441******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 141
* EL156.cbl
  7443*    COPY ERCCOMP.
  7444******************************************************************
  7445*                                                                *
  7446*                                                                *
  7447*                            ERCCOMP                             *
  7448*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7449*                            VMOD=2.019                          *
  7450*                                                                *
  7451*   ONLINE CREDIT SYSTEM                                         *
  7452*                                                                *
  7453*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7454*                                                                *
  7455*   FILE TYPE = VSAM,KSDS                                        *
  7456*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7457*                                                                *
  7458*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7459*       ALTERNATE PATH = NONE                                    *
  7460*                                                                *
  7461*   LOG = NO                                                     *
  7462*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7463*                                                                *
  7464******************************************************************
  7465*                   C H A N G E   L O G
  7466*
  7467* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7468*-----------------------------------------------------------------
  7469*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7470* EFFECTIVE    NUMBER
  7471*-----------------------------------------------------------------
  7472* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7473* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7474* 092205    2005050300006  PEMA  ADD LEASE FEE
  7475* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7476* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7477* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7478* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7479* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7480* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7481******************************************************************
  7482
  7483 01  COMPENSATION-MASTER.
  7484     12  CO-RECORD-ID                          PIC XX.
  7485         88  VALID-CO-ID                          VALUE 'CO'.
  7486
  7487     12  CO-CONTROL-PRIMARY.
  7488         16  CO-COMPANY-CD                     PIC X.
  7489         16  CO-CONTROL.
  7490             20  CO-CTL-1.
  7491                 24  CO-CARR-GROUP.
  7492                     28  CO-CARRIER            PIC X.
  7493                     28  CO-GROUPING.
  7494                         32  CO-GROUP-PREFIX   PIC XXX.
  7495                         32  CO-GROUP-PRIME    PIC XXX.
  7496                 24  CO-RESP-NO.
  7497                     28  CO-RESP-PREFIX        PIC X(4).
  7498                     28  CO-RESP-PRIME         PIC X(6).
  7499             20  CO-CTL-2.
  7500                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 142
* EL156.cbl
  7501                     28  CO-ACCT-PREFIX        PIC X(4).
  7502                     28  CO-ACCT-PRIME         PIC X(6).
  7503         16  CO-TYPE                           PIC X.
  7504             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7505             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7506             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7507
  7508     12  CO-MAINT-INFORMATION.
  7509         16  CO-LAST-MAINT-DT                  PIC XX.
  7510         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7511         16  CO-LAST-MAINT-USER                PIC X(4).
  7512     12  FILLER                                PIC XX.
  7513     12  CO-STMT-TYPE                          PIC XXX.
  7514     12  CO-COMP-TYPE                          PIC X.
  7515         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7516     12  CO-STMT-OWNER                         PIC X(4).
  7517     12  CO-BALANCE-CONTROL                    PIC X.
  7518         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7519         88  CO-NO-BALANCE                        VALUE 'N'.
  7520
  7521     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7522         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7523         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7524         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7525
  7526     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7527         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7528         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7529
  7530     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7531     12  CO-GA-DIRECT-DEP                      PIC X.
  7532     12  CO-FUTURE-SPACE                       PIC X.
  7533         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7534
  7535     12  CO-ACCT-NAME                          PIC X(30).
  7536     12  CO-MAIL-NAME                          PIC X(30).
  7537     12  CO-ADDR-1                             PIC X(30).
  7538     12  CO-ADDR-2                             PIC X(30).
  7539     12  CO-ADDR-3.
  7540         16  CO-ADDR-CITY                      PIC X(27).
  7541         16  CO-ADDR-STATE                     PIC XX.
  7542     12  CO-CSO-1099                           PIC X.
  7543     12  CO-ZIP.
  7544         16  CO-ZIP-PRIME.
  7545             20  CO-ZIP-PRI-1ST                PIC X.
  7546                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7547             20  FILLER                        PIC X(4).
  7548         16  CO-ZIP-PLUS4                      PIC X(4).
  7549     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7550         16  CO-CAN-POSTAL-1                   PIC XXX.
  7551         16  CO-CAN-POSTAL-2                   PIC XXX.
  7552         16  FILLER                            PIC XXX.
  7553     12  CO-SOC-SEC                            PIC X(13).
  7554     12  CO-TELEPHONE.
  7555         16  CO-AREA-CODE                      PIC XXX.
  7556         16  CO-PREFIX                         PIC XXX.
  7557         16  CO-PHONE                          PIC X(4).
  7558
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 143
* EL156.cbl
  7559     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7560
  7561     12  CO-AR-BAL-LEVEL                       PIC X.
  7562         88  CO-AR-REF-LVL                        VALUE '1'.
  7563         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7564         88  CO-AR-BILL-LVL                       VALUE '2'.
  7565         88  CO-AR-AGT-LVL                        VALUE '3'.
  7566         88  CO-AR-FR-LVL                         VALUE '4'.
  7567
  7568     12  CO-AR-NORMAL-PRINT                    PIC X.
  7569         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7570         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7571
  7572     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7573
  7574     12  CO-AR-REPORTING                       PIC X.
  7575         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7576         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7577
  7578     12  CO-AR-PULL-CHECK                      PIC X.
  7579         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7580         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7581
  7582     12  CO-AR-BALANCE-PRINT                   PIC X.
  7583         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7584
  7585     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7586         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7587         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7588         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7589
  7590     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7591
  7592     12  CO-USER-CODE                          PIC X.
  7593     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7594
  7595******************************************************************
  7596*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7597*    THE LAST MONTH END RUN.
  7598******************************************************************
  7599
  7600     12  CO-LAST-ACTIVITY-DATE.
  7601         16  CO-ACT-YEAR                       PIC 99.
  7602         16  CO-ACT-MONTH                      PIC 99.
  7603         16  CO-ACT-DAY                        PIC 99.
  7604
  7605     12  CO-LAST-STMT-DT.
  7606         16  CO-LAST-STMT-YEAR                 PIC 99.
  7607         16  CO-LAST-STMT-MONTH                PIC 99.
  7608         16  CO-LAST-STMT-DAY                  PIC 99.
  7609
  7610     12  CO-MO-END-TOTALS.
  7611         16  CO-MONTHLY-TOTALS.
  7612             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7613             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7614             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7615             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7616             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 144
* EL156.cbl
  7617
  7618         16  CO-AGING-TOTALS.
  7619             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7620             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7621             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7622             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7623
  7624         16  CO-YTD-TOTALS.
  7625             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7626             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7627
  7628         16  CO-OVER-UNDER-TOTALS.
  7629             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7630             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7631
  7632     12  CO-MISCELLANEOUS-TOTALS.
  7633         16  CO-FICA-TOTALS.
  7634             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7635             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7636
  7637         16  CO-CLAIM-TOTALS.
  7638             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7639             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7640
  7641******************************************************************
  7642*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7643*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7644******************************************************************
  7645
  7646     12  CO-CURRENT-TOTALS.
  7647         16  CO-CURRENT-LAST-STMT-DT.
  7648             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7649             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7650             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7651
  7652         16  CO-CURRENT-MONTHLY-TOTALS.
  7653             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7654             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7655             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7656             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7657             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7658
  7659         16  CO-CURRENT-AGING-TOTALS.
  7660             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7661             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7662             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7663             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7664
  7665         16  CO-CURRENT-YTD-TOTALS.
  7666             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7667             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7668
  7669     12  CO-PAID-COMM-TOTALS.
  7670         16  CO-YTD-PAID-COMMS.
  7671             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7672             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7673
  7674     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 145
* EL156.cbl
  7675         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7676         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7677
  7678     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7679         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7680         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7681         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7682         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7683         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7684         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7685         88  CO-FINAL-LETTER                  VALUE 'F'.
  7686         88  CO-RECONCILING                   VALUE 'R'.
  7687         88  CO-PHONE-CALL                    VALUE 'P'.
  7688         88  CO-LEGAL                         VALUE 'L'.
  7689         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7690         88  CO-WRITE-OFF                     VALUE 'W'.
  7691         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7692
  7693     12  CO-CSR-CODE                       PIC X(4).
  7694
  7695     12  CO-GA-STATUS-INFO.
  7696         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7697         16  CO-GA-TERMINATION-DT          PIC XX.
  7698         16  CO-GA-STATUS-CODE             PIC X.
  7699             88  CO-GA-ACTIVE                 VALUE 'A'.
  7700             88  CO-GA-INACTIVE               VALUE 'I'.
  7701             88  CO-GA-PENDING                VALUE 'P'.
  7702         16  CO-GA-COMMENTS.
  7703             20  CO-GA-COMMENT-1           PIC X(40).
  7704             20  CO-GA-COMMENT-2           PIC X(40).
  7705             20  CO-GA-COMMENT-3           PIC X(40).
  7706             20  CO-GA-COMMENT-4           PIC X(40).
  7707
  7708     12  CO-RPTCD2                         PIC X(10).
  7709     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7710         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7711         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7712
  7713     12  CO-TYPE-AGENT                     PIC X(01).
  7714         88  CO-CORPORATION                   VALUE 'C'.
  7715         88  CO-PARTNERSHIP                   VALUE 'P'.
  7716         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7717         88  CO-TRUST                         VALUE 'T'.
  7718         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7719
  7720     12  CO-FAXNO.
  7721         16  CO-FAX-AREA-CODE                  PIC XXX.
  7722         16  CO-FAX-PREFIX                     PIC XXX.
  7723         16  CO-FAX-PHONE                      PIC X(4).
  7724
  7725     12  CO-BANK-INFORMATION.
  7726         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7727         16  CO-BANK-TRANSIT-NON REDEFINES
  7728             CO-BANK-TRANSIT-NO                PIC 9(8).
  7729
  7730         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7731     12  CO-MISC-DEDUCT-INFO REDEFINES
  7732                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 146
* EL156.cbl
  7733         16  CO-MD-GL-ACCT                     PIC X(10).
  7734         16  CO-MD-DIV                         PIC XX.
  7735         16  CO-MD-CENTER                      PIC X(4).
  7736         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7737         16  CO-CREATE-AP-CHECK                PIC X.
  7738         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7739         16  FILLER                            PIC XXX.
  7740     12  CO-ACH-STATUS                         PIC X.
  7741         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7742         88  CO-ACH-PENDING                        VALUE 'P'.
  7743
  7744     12  CO-BILL-SW                            PIC X.
  7745     12  CO-CONTROL-NAME                       PIC X(30).
  7746     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7747     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7748     12  CO-CLP-STATE                          PIC XX.
  7749     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7750     12  CO-SPP-REFUND-EDIT                    PIC X.
  7751
  7752******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 147
* EL156.cbl
  7754*    COPY ERCDMDNT.
  7755******************************************************************
  7756*                                                                *
  7757*                            ERCDMDNT                            *
  7758*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7759*                            VMOD=2.005                          *
  7760*                                                                *
  7761*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7762*                                                                *
  7763*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7764*                                                                *
  7765*        FILE TYPE= VSAM,KSDS                                    *
  7766*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7767*                                                                *
  7768*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7769*                                                                *
  7770*        LOG = YES                                               *
  7771*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7772*                                                                *
  7773******************************************************************
  7774
  7775 01  CERTIFICATE-NOTE.
  7776     12  CN-RECORD-ID                     PIC  XX.
  7777         88  VALID-CN-ID                      VALUE 'CN'.
  7778
  7779     12  CN-CONTROL-PRIMARY.
  7780         16  CN-COMPANY-CD                PIC X.
  7781         16  CN-CERT-KEY.
  7782             20  CN-CARRIER               PIC X.
  7783             20  CN-GROUPING.
  7784                 24  CN-GROUPING-PREFIX   PIC XXX.
  7785                 24  CN-GROUPING-PRIME    PIC XXX.
  7786             20  CN-STATE                 PIC XX.
  7787             20  CN-ACCOUNT.
  7788                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7789                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7790             20  CN-CERT-EFF-DT           PIC XX.
  7791             20  CN-CERT-NO.
  7792                 24  CN-CERT-PRIME        PIC X(10).
  7793                 24  CN-CERT-SFX          PIC X.
  7794
  7795     12  CN-BILLING-START-LINE-NO         PIC 99.
  7796     12  CN-BILLING-END-LINE-NO           PIC 99.
  7797
  7798     12  CN-LINES.
  7799         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7800
  7801     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7802         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7803         16  CN-CSI-GENERAL-DATA-AREA.
  7804             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7805
  7806         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7807             CN-CSI-GENERAL-DATA-AREA.
  7808             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7809             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7810             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7811             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 148
* EL156.cbl
  7812             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7813             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7814             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7815             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7816             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7817             20  FILLER                       PIC XX.
  7818             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7819             20  FILLER                       PIC X(38).
  7820
  7821         16  CN-CSI-PRODUCT-DATA-AREA.
  7822             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7823
  7824         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7825             CN-CSI-PRODUCT-DATA-AREA.
  7826             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7827             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7828             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7829             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7830             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7831             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7832             20  FILLER                   PIC XX.
  7833             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7834             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7835             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7836             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7837             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7838             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7839             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7840             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7841             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7842             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7843             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7844             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7845             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7846             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7847             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7848             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7849             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7850             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7851             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7852             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7853             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7854             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7855             20  FILLER                   PIC X(25).
  7856
  7857         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7858             CN-CSI-CREDIT-CARD-DATA.
  7859             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7860             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7861             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7862             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7863             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7864             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7865             20  FILLER                   PIC XX.
  7866             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7867             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7868             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7869             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 149
* EL156.cbl
  7870             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7871             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7872             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7873             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7874             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7875             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7876             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7877             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7878             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7879             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7880             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7881             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7882             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7883             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7884             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7885             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7886             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7887             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7888             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7889             20  FILLER                   PIC X(17).
  7890
  7891         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7892             CN-CSI-FAMILY-LEAVE-DATA.
  7893             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7894             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7895             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7896             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7897             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7898             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7899             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7900             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7901             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7902             20  CN-CSI-SL-INT-ON-PROCEEDS
  7903                                          PIC S9(5)V99  COMP-3.
  7904             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7905             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7906             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7907             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7908             20  CN-CSI-SL-POLICY-BENEFITS
  7909                                          PIC S9(5)V99  COMP-3.
  7910             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7911             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7912             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7913             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7914             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7915             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7916             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7917             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7918             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7919             20  CN-CSI-SL-STATE-NOT      PIC X.
  7920             20  FILLER                   PIC XX.
  7921
  7922         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7923             CN-CSI-SENIOR-LIFE-DATA.
  7924             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7925             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7926             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7927                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 150
* EL156.cbl
  7928             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7929             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7930             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7931             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7932             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7933             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7934             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7935             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7936             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7937             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7938             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7939             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7940             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7941             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7942             20  CN-CSI-PP-REPAIR         PIC X.
  7943             20  CN-CSI-PP-REPLACE        PIC X.
  7944             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7945             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7946             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7947             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7948             20  FILLER                   PIC X(5).
  7949
  7950         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7951             CN-CSI-PURCH-PROP-DATA.
  7952             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7953             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7954             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7955             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7956             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7957             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7958             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7959             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7960             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7961             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7962             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7963             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7964             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7965             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7966             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7967             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7968             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7969             20  CN-CSI-EW-REPLACE        PIC X.
  7970             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7971             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7972             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7973             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7974             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7975             20  FILLER                   PIC X(4).
  7976
  7977     12  CN-LAST-MAINT-DT                 PIC XX.
  7978     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7979     12  CN-LAST-MAINT-USER               PIC X(4).
  7980     12  FILLER                           PIC X(6).
  7981
  7982******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 151
* EL156.cbl
  7984*    COPY ERCCNOT.
  7985******************************************************************
  7986*                                                                *
  7987*                            ERCCNOT                             *
  7988*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7989*                            VMOD=2.003                          *
  7990*                                                                *
  7991*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7992*                                                                *
  7993*        FILE TYPE= VSAM,KSDS                                    *
  7994*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7995*                                                                *
  7996*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7997*                                                                *
  7998*        LOG = YES                                               *
  7999*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8000*                                                                *
  8001******************************************************************
  8002*                   C H A N G E   L O G
  8003*
  8004* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8005*-----------------------------------------------------------------
  8006*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8007* EFFECTIVE    NUMBER
  8008*-----------------------------------------------------------------
  8009* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  8010******************************************************************
  8011
  8012 01  CERT-NOTE-FILE.
  8013     12  CZ-RECORD-ID                PIC  XX.
  8014         88  VALID-CZ-ID                  VALUE 'CZ'.
  8015
  8016     12  CZ-CONTROL-PRIMARY.
  8017         16  CZ-COMPANY-CD           PIC X.
  8018         16  CZ-CARRIER              PIC X.
  8019         16  CZ-GROUPING.
  8020             20 CZ-GROUPING-PREFIX   PIC XXX.
  8021             20 CZ-GROUPING-PRIME    PIC XXX.
  8022         16  CZ-STATE                PIC XX.
  8023         16  CZ-ACCOUNT.
  8024             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8025             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8026         16  CZ-CERT-EFF-DT          PIC XX.
  8027         16  CZ-CERT-NO.
  8028             20  CZ-CERT-PRIME       PIC X(10).
  8029             20  CZ-CERT-SFX         PIC X.
  8030         16  CZ-RECORD-TYPE          PIC X.
  8031             88  CERT-NOTE           VALUE '1'.
  8032             88  CLAIM-CERT-NOTE     VALUE '2'.
  8033         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8034
  8035     12  CZ-LAST-MAINT-DT            PIC XX.
  8036     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8037     12  CZ-LAST-MAINT-USER          PIC X(4).
  8038
  8039     12  CZ-NOTE-INFORMATION.
  8040         16  CZ-NOTE                 PIC X(63).
  8041         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 152
* EL156.cbl
  8042******************************************************************
  8043*                            COPY ERCPDEF.
  8044******************************************************************
  8045*                                                                *
  8046*                                                                *
  8047*                            ERCPDEF.                            *
  8048*                                                                *
  8049*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8050*                                                                *
  8051*    FILE TYPE = VSAM,KSDS                                       *
  8052*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8053*                                                                *
  8054*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8055*                                                                *
  8056*    LOG = YES                                                   *
  8057*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8058******************************************************************
  8059*                   C H A N G E   L O G
  8060*
  8061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8062*-----------------------------------------------------------------
  8063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8064* EFFECTIVE    NUMBER
  8065*-----------------------------------------------------------------
  8066* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8067* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8068* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8069* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8070******************************************************************
  8071 01  PRODUCT-MASTER.
  8072    12  PD-RECORD-ID                 PIC X(02).
  8073        88  VALID-PD-ID                  VALUE 'PD'.
  8074    12  PD-CONTROL-PRIMARY.
  8075        16  PD-COMPANY-CD            PIC X.
  8076        16  PD-STATE                 PIC XX.
  8077        16  PD-PRODUCT-CD            PIC XXX.
  8078        16  PD-FILLER                PIC X(7).
  8079        16  PD-BEN-TYPE              PIC X.
  8080        16  PD-BEN-CODE              PIC XX.
  8081        16  PD-PROD-EXP-DT           PIC XX.
  8082    12  FILLER                       PIC X(50).
  8083    12  PD-PRODUCT-DATA OCCURS 8.
  8084        16  PD-PROD-CODE             PIC X.
  8085            88  PD-PROD-LIFE           VALUE 'L'.
  8086            88  PD-PROD-PROP           VALUE 'P'.
  8087            88  PD-PROD-AH             VALUE 'A'.
  8088            88  PD-PROD-IU             VALUE 'I'.
  8089            88  PD-PROD-GAP            VALUE 'G'.
  8090            88  PD-PROD-FAML           VALUE 'F'.
  8091            88  PD-PROD-OTH            VALUE 'O'.
  8092        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8093        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8094        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8095        16  PD-MAX-TERM              PIC S999        COMP-3.
  8096        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8097        16  FILLER                   PIC X.
  8098        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8099        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 153
* EL156.cbl
  8100        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8101        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  8102        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8103        16  PD-REC-CRIT-PERIOD       PIC 99.
  8104        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8105            20  PD-RECURRING-YN      PIC X.
  8106            20  FILLER               PIC X.
  8107        16  PD-RTW-MOS               PIC 99.
  8108        16  PD-MAX-EXTENSION         PIC 99.
  8109        16  pd-ben-pct               pic sv999 comp-3.
  8110*       16  FILLER                   PIC XX.
  8111    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8112    12  PD-TERM-LIMITS OCCURS 15.
  8113        16  PD-LOW-TERM              PIC S999        COMP-3.
  8114        16  PD-HI-TERM               PIC S999        COMP-3.
  8115*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8116    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8117        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8118        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8119    12  PD-EARN-FACTORS.
  8120        16  FILLER OCCURS 15.
  8121            20  FILLER OCCURS 15.
  8122                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8123    12  PD-PRODUCT-DESC              PIC X(80).
  8124    12  PD-TRUNCATED                 PIC X.
  8125    12  FILLER                       PIC X(59).
  8126    12  PD-MAINT-INFORMATION.
  8127        16  PD-LAST-MAINT-DT         PIC X(02).
  8128        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8129        16  PD-LAST-MAINT-BY         PIC X(04).
  8130*                            COPY ELCCRTT.
  8131******************************************************************
  8132*                                                                *
  8133*                            ELCCRTT.                            *
  8134*                                                                *
  8135*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8136*                                                                *
  8137*   FILE TYPE = VSAM,KSDS                                        *
  8138*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8139*                                                                *
  8140*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8141*                                                                *
  8142*   LOG = YES                                                    *
  8143*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8144******************************************************************
  8145*                   C H A N G E   L O G
  8146*
  8147* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8148*-----------------------------------------------------------------
  8149*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8150* EFFECTIVE    NUMBER
  8151*-----------------------------------------------------------------
  8152* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8153* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8154* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8155* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8156* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8157* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 154
* EL156.cbl
  8158* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8159* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8160* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8161* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8162* 091318  CR2018073000001  PEMA  ADD Refund methods
  8163* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8164******************************************************************
  8165
  8166 01  CERTIFICATE-TRAILERS.
  8167     12  CS-RECORD-ID                      PIC XX.
  8168         88  VALID-CS-ID                      VALUE 'CS'.
  8169
  8170     12  CS-CONTROL-PRIMARY.
  8171         16  CS-COMPANY-CD                 PIC X.
  8172         16  CS-CARRIER                    PIC X.
  8173         16  CS-GROUPING                   PIC X(6).
  8174         16  CS-STATE                      PIC XX.
  8175         16  CS-ACCOUNT                    PIC X(10).
  8176         16  CS-CERT-EFF-DT                PIC XX.
  8177         16  CS-CERT-NO.
  8178             20  CS-CERT-PRIME             PIC X(10).
  8179             20  CS-CERT-SFX               PIC X.
  8180         16  CS-TRAILER-TYPE               PIC X.
  8181             88  COMM-TRLR           VALUE 'A'.
  8182             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8183             88  CERT-DATA-TRLR      VALUE 'C'.
  8184
  8185     12  CS-DATA-AREA                      PIC X(516).
  8186
  8187     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8188         16  CS-BANK-COMMISSION-AREA.
  8189             20  CS-BANK-COMMS       OCCURS 10.
  8190                 24  CS-AGT                PIC X(10).
  8191                 24  CS-COM-TYP            PIC X.
  8192                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8193                 24  CS-RECALC-LV-INDIC    PIC X.
  8194                 24  FILLER                PIC X(10).
  8195         16  FILLER                        PIC X(256).
  8196
  8197     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8198****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8199         16  CS-MB-CLAIM-DATA OCCURS 24.
  8200             20  CS-CLAIM-NO               PIC X(7).
  8201             20  CS-CLAIM-TYPE             PIC X.
  8202                 88  CS-AH-CLM               VALUE 'A'.
  8203                 88  CS-IU-CLM               VALUE 'I'.
  8204                 88  CS-GP-CLM               VALUE 'G'.
  8205                 88  CS-LF-CLM               VALUE 'L'.
  8206                 88  CS-PR-CLM               VALUE 'P'.
  8207                 88  CS-FL-CLM               VALUE 'F'.
  8208                 88  CS-OT-CLM               VALUE 'O'.
  8209             20  CS-INSURED-TYPE           PIC X.
  8210                 88  CS-PRIM-INSURED          VALUE 'P'.
  8211                 88  CS-CO-BORROWER           VALUE 'C'.
  8212             20  CS-BENEFIT-PERIOD         PIC 99.
  8213             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8214             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8215             20  CS-REMAINING-BENS         PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 155
* EL156.cbl
  8216         16  FILLER                        PIC X(12).
  8217     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8218         16  CS-VIN-NUMBER                 PIC X(17).
  8219         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8220         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8221         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8222         16  cs-agent-name.
  8223             20  cs-agent-fname            pic x(20).
  8224             20  cs-agent-mi               pic x.
  8225             20  cs-agent-lname            pic x(25).
  8226         16  cs-license-no                 pic x(15).
  8227         16  cs-npn-number                 pic x(10).
  8228         16  cs-agent-edit-status          pic x.
  8229             88  cs-ae-refer-to-manager      value 'M'.
  8230             88  cs-ae-cover-sheet           value 'C'.
  8231             88  cs-ae-sig-form              value 'S'.
  8232             88  cs-ae-verified              value 'V'.
  8233             88  cs-unidentified-signature   value 'U'.
  8234             88  cs-cert-returned            value 'R'.
  8235             88  cs-accept-no-commission     value 'N'.
  8236         16  cs-year                       pic 9999.
  8237         16  cs-make                       pic x(20).
  8238         16  cs-model                      pic x(20).
  8239         16  cs-future                     pic x(20).
  8240         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8241         16  cs-claim-verification-status  pic x.
  8242             88  cs-clm-ver-eligible         value 'A'.
  8243             88  cs-clm-ver-partial-elig     value 'B'.
  8244             88  cs-clm-ver-not-eligible     value 'C'.
  8245             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8246             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8247             88  cs-clm-ver-ND-CERT          value 'F'.
  8248             88  cs-clm-ver-spec-other       value 'G'.
  8249             88  cs-clam-ver-pratial-corrected
  8250                                             value 'H'.
  8251             88  cs-clm-ver-no-matches       value 'I'.
  8252             88  cs-clm-ver-not-elig-corrected
  8253                                             value 'J'.
  8254             88  cs-clm-ver-needs-review     value 'R'.
  8255             88  cs-clm-ver-sent-to-claims   value 'W'.
  8256         16  CS-LF-REFUND-METHOD           PIC X.
  8257         16  CS-AH-REFUND-METHOD           PIC X.
  8258         16  FILLER                        PIC X(353). *> was 420
  8259*        16  FILLER                        PIC X(496).
  8260 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8261                          CONTROL-FILE CERTIFICATE-MASTER
  8262                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8263                          ACCOUNT-MASTER CHECK-QUE
  8264                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8265                          DAILY-ACTIVITY-RECORD
  8266                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8267                          CERT-NOTE-FILE PRODUCT-MASTER
  8268                          CERTIFICATE-TRAILERS.
  8269 0000-DFHEXIT SECTION.
  8270     MOVE '9#                    $   ' TO DFHEIV0.
  8271     MOVE 'EL156' TO DFHEIV1.
  8272     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8273
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 156
* EL156.cbl
  8274     IF EIBCALEN = 0
  8275         GO TO 8800-UNAUTHORIZED-ACCESS.
  8276
  8277     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8278     MOVE EIBTRMID               TO QID-TERM.
  8279     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8280     MOVE '2'                    TO EMI-SWITCH2.
  8281     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8282     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8283
  8284     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8285     MOVE '5'                    TO DC-OPTION-CODE.
  8286     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8287     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8288                                    SAVE-BIN-DATE.
  8289     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8290     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8291
  8292     IF SAVE-DATE-YY > 70
  8293         MOVE 19                 TO SAVE-DATE-CC
  8294     ELSE
  8295         MOVE 20                 TO SAVE-DATE-CC.
  8296
  8297     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8298         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8299     END-IF.
  8300
  8301     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8302        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8303     ELSE
  8304        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8305     END-IF
  8306
  8307     IF PI-PRINT-CLM-FRM-YN = 'N'
  8308         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8309     ELSE
  8310         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8311     END-IF
  8312
  8313     IF PI-PRINT-SURVEY-YN = 'N'
  8314         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8315     ELSE
  8316         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8317     END-IF
  8318
  8319     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8320         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8321     ELSE
  8322         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8323     END-IF
  8324
  8325* EXEC CICS HANDLE CONDITION
  8326*        NOTOPEN   (9990-ABEND)
  8327*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8328*        MAPFAIL   (0400-FIRST-TIME)
  8329*        DUPREC    (6180-DUPREC)
  8330*        ERROR     (9990-ABEND)
  8331*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 157
* EL156.cbl
  8332*    MOVE '"$JL?%.               ! " #00008320' TO DFHEIV0
  8333     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8335     MOVE X'2220233030303038333230' TO DFHEIV0(25:11)
  8336     CALL 'kxdfhei1' USING DFHEIV0
  8337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8338
  8339
  8340     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8341         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8342
  8343     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8344         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8345             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8346             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8347             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8348             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8349             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8350             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8351             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8352             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8353             MOVE LOW-VALUES           TO EL156AI
  8354             MOVE 'Y'                  TO FIRST-ENTRY
  8355         ELSE
  8356             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8357             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8358             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8359             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8360             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8361             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8362             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8363             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8364
  8365     IF RETURNED-FROM NOT = SPACES
  8366        IF (RETURNED-FROM = 'EL614')
  8367           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8368           IF WS-SAVED-EOB-CODES NOT = SPACES
  8369              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8370           ELSE
  8371              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8372           END-IF
  8373        END-IF
  8374         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8375            MOVE 'Y'             TO FIRST-ENTRY
  8376            IF RETURNED-FROM = 'EL614'
  8377               AND (PI-PASS-SW NOT = 'C')
  8378               IF WS-SAVED-EOB-CODES NOT = SPACES
  8379                  MOVE WS-SAVED-EOB-CODES
  8380                                 TO PI-PMTNOTE2
  8381                                    WS-PMTNOTE2
  8382                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8383               ELSE
  8384                  MOVE SPACES    TO PI-PMTNOTE2
  8385                                    WS-PMTNOTE2
  8386                                    PI-EOB-CODES-EXIST
  8387               END-IF
  8388            END-IF
  8389            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 158
* EL156.cbl
  8390            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8391            IF RETURNED-FROM = 'EL614'
  8392               GO TO 1000-EDIT-DATA
  8393            END-IF
  8394            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8395               (PAYEEI   = LOW-VALUES OR SPACES)
  8396               GO TO 8100-SEND-INITIAL-MAP
  8397            ELSE
  8398               GO TO 1000-EDIT-DATA.
  8399
  8400     IF EIBTRNID NOT = TRANS-ID
  8401         GO TO 0400-FIRST-TIME.
  8402
  8403     IF EIBAID = DFHCLEAR
  8404        IF PI-PASS-SW = 'C'
  8405           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8406           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8407           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8408           MOVE 'Y'            TO RETURNED-FROM-B
  8409           GO TO 1000-EDIT-DATA
  8410        ELSE
  8411           GO TO 9400-CLEAR.
  8412
  8413     IF PI-PASS-SW = 'C'
  8414         MOVE MAP-NAMEB          TO MAP-NAME
  8415         IF EIBAID = DFHPF1 OR DFHPF13
  8416             GO TO 5000-UPDATE
  8417           ELSE
  8418             IF EIBAID NOT = DFHENTER
  8419                 MOVE LOW-VALUES TO EL156BI
  8420                 MOVE MAP-NAMEB  TO MAP-NAME
  8421                 MOVE ER-0029    TO EMI-ERROR
  8422                 MOVE -1         TO  ENTPFBL
  8423                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8424                 GO TO 8200-SEND-DATAONLY.
  8425
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 159
* EL156.cbl
  8427 0200-RECEIVE.
  8428     MOVE LOW-VALUES             TO EL156AI.
  8429     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8430         MOVE ER-0008            TO EMI-ERROR
  8431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8432         IF PI-PASS-SW = 'C'
  8433             MOVE -1             TO ENTPFBL
  8434             GO TO 8200-SEND-DATAONLY
  8435         ELSE
  8436             MOVE -1             TO PMTTYPEL
  8437             GO TO 8200-SEND-DATAONLY.
  8438
  8439     IF PI-COMPANY-ID = 'DMD'
  8440         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8441
  8442     IF PI-PASS-SW = 'C'
  8443         MOVE MAP-NAMEB          TO MAP-NAME.
  8444
  8445
  8446* EXEC CICS RECEIVE
  8447*        MAP   (MAP-NAME)
  8448*        MAPSET(MAPSET-NAME)
  8449*        ASIS
  8450*        INTO  (EL156AI)
  8451*    END-EXEC.
  8452     MOVE LENGTH OF
  8453      EL156AI
  8454       TO DFHEIV11
  8455*    MOVE '8"TAI  L              ''   #00008433' TO DFHEIV0
  8456     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8457     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8458     MOVE X'2020233030303038343333' TO DFHEIV0(25:11)
  8459     CALL 'kxdfhei1' USING DFHEIV0,
  8460           MAP-NAME,
  8461           EL156AI,
  8462           DFHEIV11,
  8463           MAPSET-NAME,
  8464           DFHEIV99,
  8465           DFHEIV99
  8466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8467
  8468
  8469     IF PI-PASS-SW NOT = 'C'
  8470         GO TO 0250-MAPA.
  8471
  8472     IF ENTPFBL NOT > ZERO
  8473         MOVE MAP-NAMEB          TO MAP-NAME
  8474         MOVE ER-0029            TO EMI-ERROR
  8475         MOVE -1                 TO  ENTPFBL
  8476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8477         GO TO 8200-SEND-DATAONLY.
  8478
  8479     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8480         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8481       ELSE
  8482         MOVE MAP-NAMEB           TO MAP-NAME
  8483         MOVE ER-0029             TO EMI-ERROR
  8484         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 160
* EL156.cbl
  8485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8486         GO TO 8200-SEND-DATAONLY.
  8487
  8488     IF EIBAID = DFHPF1 OR DFHPF13
  8489         IF MODIFY-CAP
  8490            GO TO 5000-UPDATE
  8491          ELSE
  8492            MOVE 'UPDATE'           TO SM-READ
  8493            PERFORM 9995-SECURITY-VIOLATION
  8494            MOVE MAP-NAMEB          TO MAP-NAME
  8495            MOVE ER-0070            TO EMI-ERROR
  8496            MOVE -1                 TO  ENTPFBL
  8497            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8498            GO TO 8200-SEND-DATAONLY.
  8499
  8500 0250-MAPA.
  8501     IF ENTERPFL = 0
  8502         GO TO 0300-CHECK-PFKEYS.
  8503
  8504     IF EIBAID NOT = DFHENTER
  8505         MOVE ER-0004            TO EMI-ERROR
  8506         GO TO 0320-INPUT-ERROR.
  8507
  8508     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8509         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8510     ELSE
  8511         MOVE ER-0029            TO EMI-ERROR
  8512         GO TO 0320-INPUT-ERROR.
  8513
  8514 0300-CHECK-PFKEYS.
  8515     IF EIBAID = DFHPF7 OR DFHPF8
  8516         GO TO 8820-PF7-8.
  8517
  8518     IF EIBAID = DFHPF23
  8519         GO TO 8810-PF23.
  8520
  8521     IF EIBAID = DFHPF24
  8522         GO TO 9200-RETURN-MAIN-MENU.
  8523
  8524     IF EIBAID = DFHPF12
  8525         GO TO 9500-PF12.
  8526
  8527     IF EIBAID = DFHPF1
  8528        IF PI-PASS-SW = 'A' OR 'B'
  8529          GO TO 0330-BROWSE-FORWARD.
  8530
  8531     IF EIBAID = DFHPF2
  8532        IF PI-PASS-SW = 'A' OR 'B'
  8533          GO TO 0350-BROWSE-BACKWARD.
  8534
  8535     IF EIBAID = DFHPF6
  8536        IF PI-EOB-CODES-EXIST = 'Y'
  8537           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8538        ELSE
  8539           MOVE SPACES              TO WS-PMTNOTE2
  8540        END-IF
  8541         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8542         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 161
* EL156.cbl
  8543            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8544         END-IF
  8545         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8546         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8547             MOVE 'EL614'        TO PGM-NAME
  8548             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8549             GO TO 9300-XCTL
  8550         ELSE
  8551             MOVE XCTL-157       TO PGM-NAME
  8552             GO TO 9300-XCTL.
  8553
  8554     IF EIBAID = DFHPF9
  8555        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8556        MOVE XCTL-141            TO PGM-NAME
  8557        GO TO 9300-XCTL.
  8558
  8559     IF EIBAID = DFHPF10
  8560        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8561        MOVE XCTL-155            TO PGM-NAME
  8562        GO TO 9300-XCTL.
  8563
  8564     MOVE SPACES                 TO ERRMSG0O
  8565                                    ERRMSG1O
  8566                                    ERRMSG2O.
  8567
  8568     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8569         IF PI-PASS-SW NOT = 'B'
  8570             MOVE ER-0422        TO EMI-ERROR
  8571             GO TO 0320-INPUT-ERROR
  8572           ELSE
  8573             GO TO 0700-TEST-FOR-CHANGES.
  8574
  8575     IF EIBAID = DFHPF11
  8576        IF PI-PASS-SW = 'C'
  8577           MOVE ER-0029          TO EMI-ERROR
  8578           GO TO 0320-INPUT-ERROR.
  8579
  8580     IF EIBAID = DFHENTER OR DFHPF11
  8581        NEXT SENTENCE
  8582     ELSE
  8583        MOVE ER-0029             TO EMI-ERROR
  8584        GO TO 0320-INPUT-ERROR.
  8585
  8586     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8587
  8588     if pi-epyfrom not = zeros
  8589        if pi-epyfrom not = ws-epyfrom
  8590           move zeros        to ws-edays
  8591        end-if
  8592     end-if
  8593
  8594     if pi-epythru not = zeros
  8595        if pi-epythru not = ws-epythru
  8596           move zeros        to ws-edays
  8597        end-if
  8598     end-if
  8599
  8600     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 162
* EL156.cbl
  8601         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8602         GO TO 1000-EDIT-DATA
  8603     ELSE
  8604         IF PI-FATAL-COUNT NOT = 0 OR
  8605            PI-FORCE-COUNT NOT = 0
  8606             GO TO 1000-EDIT-DATA
  8607         ELSE
  8608             GO TO 2000-EDIT-DONE.
  8609
  8610 0320-INPUT-ERROR.
  8611     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8612
  8613     IF ENTERPFL = 0
  8614         MOVE -1                 TO PMTTYPEL
  8615     ELSE
  8616         MOVE AL-UNBON           TO ENTERPFA
  8617         MOVE -1                 TO ENTERPFL.
  8618
  8619     GO TO 8200-SEND-DATAONLY.
  8620
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 163
* EL156.cbl
  8622 0330-BROWSE-FORWARD.
  8623
  8624     MOVE CLMNOI            TO PI-CLAIM-NO.
  8625     MOVE CARRI             TO PI-CARRIER.
  8626     MOVE CERTNOI           TO PI-CERT-PRIME.
  8627     MOVE SUFXI             TO PI-CERT-SFX.
  8628
  8629     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8630     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8631     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8632     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8633
  8634     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8635
  8636
  8637* EXEC CICS HANDLE CONDITION
  8638*         NOTFND   (0380-CLAIM-END-FILE)
  8639*         ENDFILE  (0380-CLAIM-END-FILE)
  8640*    END-EXEC.
  8641*    MOVE '"$I''                  ! # #00008607' TO DFHEIV0
  8642     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8644     MOVE X'2320233030303038363037' TO DFHEIV0(25:11)
  8645     CALL 'kxdfhei1' USING DFHEIV0
  8646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8647
  8648
  8649
  8650* EXEC CICS STARTBR
  8651*         DATASET    ('ELMSTR')
  8652*         RIDFLD     (ELMSTR-KEY)
  8653*         GTEQ
  8654*    END-EXEC.
  8655     MOVE 'ELMSTR' TO DFHEIV1
  8656     MOVE 0
  8657       TO DFHEIV11
  8658*    MOVE '&,         G          &   #00008612' TO DFHEIV0
  8659     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8660     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8661     MOVE X'2020233030303038363132' TO DFHEIV0(25:11)
  8662     CALL 'kxdfhei1' USING DFHEIV0,
  8663           DFHEIV1,
  8664           ELMSTR-KEY,
  8665           DFHEIV99,
  8666           DFHEIV11,
  8667           DFHEIV99
  8668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8669
  8670
  8671     MOVE 'Y' TO WS-BROWSE-START-SW.
  8672
  8673 0335-READNEXT.
  8674
  8675
  8676* EXEC CICS READNEXT
  8677*         DATASET    ('ELMSTR')
  8678*         RIDFLD     (ELMSTR-KEY)
  8679*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 164
* EL156.cbl
  8680*    END-EXEC.
  8681     MOVE 'ELMSTR' TO DFHEIV1
  8682     MOVE 0
  8683       TO DFHEIV11
  8684*    MOVE '&.S                   )   #00008622' TO DFHEIV0
  8685     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8686     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8687     MOVE X'2020233030303038363232' TO DFHEIV0(25:11)
  8688     CALL 'kxdfhei1' USING DFHEIV0,
  8689           DFHEIV1,
  8690           DFHEIV20,
  8691           DFHEIV99,
  8692           ELMSTR-KEY,
  8693           DFHEIV99,
  8694           DFHEIV11,
  8695           DFHEIV99,
  8696           DFHEIV99
  8697     SET ADDRESS OF CLAIM-MASTER TO
  8698         DFHEIV20
  8699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8700
  8701
  8702     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8703        GO TO 0380-CLAIM-END-FILE.
  8704
  8705     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8706        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8707        GO TO 0335-READNEXT.
  8708
  8709     IF PI-COMPANY-ID = 'CRI'
  8710         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8711            GO TO 0380-CLAIM-END-FILE.
  8712
  8713     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8714         GO TO 0335-READNEXT.
  8715
  8716     IF PI-CARRIER-SECURITY > SPACES
  8717         IF CL-CARRIER = PI-CARRIER-SECURITY
  8718             NEXT SENTENCE
  8719         ELSE
  8720             GO TO 0335-READNEXT.
  8721
  8722     IF PI-ACCOUNT-SECURITY > SPACES
  8723         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8724             NEXT SENTENCE
  8725         ELSE
  8726             GO TO 0335-READNEXT.
  8727
  8728     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8729     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8730     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8731
  8732     GO TO 0400-FIRST-TIME.
  8733
  8734 0350-BROWSE-BACKWARD.
  8735
  8736     MOVE CLMNOI            TO PI-CLAIM-NO
  8737                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 165
* EL156.cbl
  8738     MOVE CARRI             TO PI-CARRIER.
  8739     MOVE CERTNOI           TO PI-CERT-PRIME.
  8740     MOVE SUFXI             TO PI-CERT-SFX.
  8741
  8742     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8743
  8744     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8745     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8746     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8747
  8748
  8749* EXEC CICS HANDLE CONDITION
  8750*         NOTFND   (0380-CLAIM-END-FILE)
  8751*         ENDFILE  (0380-CLAIM-END-FILE)
  8752*    END-EXEC.
  8753*    MOVE '"$I''                  ! $ #00008674' TO DFHEIV0
  8754     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8756     MOVE X'2420233030303038363734' TO DFHEIV0(25:11)
  8757     CALL 'kxdfhei1' USING DFHEIV0
  8758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8759
  8760
  8761
  8762* EXEC CICS STARTBR
  8763*         DATASET    ('ELMSTR')
  8764*         RIDFLD     (ELMSTR-KEY)
  8765*         GTEQ
  8766*    END-EXEC.
  8767     MOVE 'ELMSTR' TO DFHEIV1
  8768     MOVE 0
  8769       TO DFHEIV11
  8770*    MOVE '&,         G          &   #00008679' TO DFHEIV0
  8771     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8772     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8773     MOVE X'2020233030303038363739' TO DFHEIV0(25:11)
  8774     CALL 'kxdfhei1' USING DFHEIV0,
  8775           DFHEIV1,
  8776           ELMSTR-KEY,
  8777           DFHEIV99,
  8778           DFHEIV11,
  8779           DFHEIV99
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8781
  8782
  8783     MOVE 'Y' TO WS-BROWSE-START-SW.
  8784
  8785
  8786* EXEC CICS READNEXT
  8787*         DATASET    ('ELMSTR')
  8788*         RIDFLD     (ELMSTR-KEY)
  8789*         SET        (ADDRESS OF CLAIM-MASTER)
  8790*    END-EXEC.
  8791     MOVE 'ELMSTR' TO DFHEIV1
  8792     MOVE 0
  8793       TO DFHEIV11
  8794*    MOVE '&.S                   )   #00008687' TO DFHEIV0
  8795     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 166
* EL156.cbl
  8796     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8797     MOVE X'2020233030303038363837' TO DFHEIV0(25:11)
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           DFHEIV1,
  8800           DFHEIV20,
  8801           DFHEIV99,
  8802           ELMSTR-KEY,
  8803           DFHEIV99,
  8804           DFHEIV11,
  8805           DFHEIV99,
  8806           DFHEIV99
  8807     SET ADDRESS OF CLAIM-MASTER TO
  8808         DFHEIV20
  8809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8810
  8811
  8812
  8813* EXEC CICS READPREV
  8814*         DATASET    ('ELMSTR')
  8815*         RIDFLD     (ELMSTR-KEY)
  8816*         SET        (ADDRESS OF CLAIM-MASTER)
  8817*    END-EXEC.
  8818     MOVE 'ELMSTR' TO DFHEIV1
  8819     MOVE 0
  8820       TO DFHEIV11
  8821*    MOVE '&0S                   )   #00008693' TO DFHEIV0
  8822     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8823     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8824     MOVE X'2020233030303038363933' TO DFHEIV0(25:11)
  8825     CALL 'kxdfhei1' USING DFHEIV0,
  8826           DFHEIV1,
  8827           DFHEIV20,
  8828           DFHEIV99,
  8829           ELMSTR-KEY,
  8830           DFHEIV99,
  8831           DFHEIV11,
  8832           DFHEIV99,
  8833           DFHEIV99
  8834     SET ADDRESS OF CLAIM-MASTER TO
  8835         DFHEIV20
  8836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8837
  8838
  8839 0360-BROWSE-BACKWARD.
  8840
  8841
  8842* EXEC CICS READPREV
  8843*         DATASET    ('ELMSTR')
  8844*         RIDFLD     (ELMSTR-KEY)
  8845*         SET        (ADDRESS OF CLAIM-MASTER)
  8846*    END-EXEC.
  8847     MOVE 'ELMSTR' TO DFHEIV1
  8848     MOVE 0
  8849       TO DFHEIV11
  8850*    MOVE '&0S                   )   #00008701' TO DFHEIV0
  8851     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8852     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8853     MOVE X'2020233030303038373031' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 167
* EL156.cbl
  8854     CALL 'kxdfhei1' USING DFHEIV0,
  8855           DFHEIV1,
  8856           DFHEIV20,
  8857           DFHEIV99,
  8858           ELMSTR-KEY,
  8859           DFHEIV99,
  8860           DFHEIV11,
  8861           DFHEIV99,
  8862           DFHEIV99
  8863     SET ADDRESS OF CLAIM-MASTER TO
  8864         DFHEIV20
  8865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8866
  8867
  8868     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8869        GO TO 0380-CLAIM-END-FILE.
  8870
  8871     IF PI-COMPANY-ID = 'CRI'
  8872         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8873            GO TO 0380-CLAIM-END-FILE.
  8874
  8875     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8876         GO TO 0360-BROWSE-BACKWARD.
  8877
  8878     IF PI-CARRIER-SECURITY > SPACES
  8879         IF CL-CARRIER = PI-CARRIER-SECURITY
  8880             NEXT SENTENCE
  8881         ELSE
  8882             GO TO 0360-BROWSE-BACKWARD.
  8883
  8884     IF PI-ACCOUNT-SECURITY > SPACES
  8885         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8886             NEXT SENTENCE
  8887         ELSE
  8888             GO TO 0360-BROWSE-BACKWARD.
  8889
  8890     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8891     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8892     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8893
  8894     GO TO 0400-FIRST-TIME.
  8895
  8896 0380-CLAIM-END-FILE.
  8897
  8898     MOVE ER-0130     TO EMI-ERROR.
  8899     MOVE -1          TO CLMNOL.
  8900     MOVE AL-UABON    TO CARRA
  8901                         CLMNOA
  8902                         CERTNOA
  8903                         SUFXA.
  8904
  8905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8906
  8907     GO TO 8200-SEND-DATAONLY.
  8908
  8909 0400-FIRST-TIME.
  8910
  8911     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 168
* EL156.cbl
  8912        MOVE 'N'         TO WS-BROWSE-START-SW
  8913
  8914* EXEC CICS ENDBR
  8915*            DATASET    ('ELMSTR')
  8916*       END-EXEC.
  8917     MOVE 'ELMSTR' TO DFHEIV1
  8918     MOVE 0
  8919       TO DFHEIV11
  8920*    MOVE '&2                    $   #00008752' TO DFHEIV0
  8921     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8922     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8923     MOVE X'2020233030303038373532' TO DFHEIV0(25:11)
  8924     CALL 'kxdfhei1' USING DFHEIV0,
  8925           DFHEIV1,
  8926           DFHEIV11,
  8927           DFHEIV99
  8928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8929
  8930
  8931     IF PI-PROCESSOR-ID = 'LGXX'
  8932         NEXT SENTENCE
  8933     ELSE
  8934
  8935* EXEC CICS READQ TS
  8936*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8937*            INTO    (SECURITY-CONTROL)
  8938*            LENGTH  (SC-COMM-LENGTH)
  8939*            ITEM    (SC-ITEM)
  8940*        END-EXEC
  8941*    MOVE '*$II   L              ''   #00008759' TO DFHEIV0
  8942     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8943     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8944     MOVE X'2020233030303038373539' TO DFHEIV0(25:11)
  8945     CALL 'kxdfhei1' USING DFHEIV0,
  8946           PI-SECURITY-TEMP-STORE-ID,
  8947           SECURITY-CONTROL,
  8948           SC-COMM-LENGTH,
  8949           SC-ITEM,
  8950           DFHEIV99,
  8951           DFHEIV99
  8952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8953         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8954         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8955
  8956     MOVE LOW-VALUES             TO EL156AI.
  8957     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8958     MOVE 'Y'                    TO FIRST-ENTRY.
  8959     GO TO 7000-SHOW-CLAIM.
  8960
  8961 0500-CREATE-TEMP-STORAGE.
  8962     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8963
  8964
  8965* EXEC CICS WRITEQ TS
  8966*        QUEUE (QID)
  8967*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8968*        LENGTH(PI-COMM-LENGTH)
  8969*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 169
* EL156.cbl
  8970*    MOVE '*"     L              ''   #00008776' TO DFHEIV0
  8971     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8973     MOVE X'2020233030303038373736' TO DFHEIV0(25:11)
  8974     CALL 'kxdfhei1' USING DFHEIV0,
  8975           QID,
  8976           PROGRAM-INTERFACE-BLOCK,
  8977           PI-COMM-LENGTH,
  8978           DFHEIV99,
  8979           DFHEIV99,
  8980           DFHEIV99
  8981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8982
  8983
  8984
  8985* EXEC CICS WRITEQ TS
  8986*        QUEUE (QID)
  8987*        FROM  (EL156AI)
  8988*        LENGTH(MAP-LENGTH)
  8989*    END-EXEC.
  8990*    MOVE '*"     L              ''   #00008782' TO DFHEIV0
  8991     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8992     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8993     MOVE X'2020233030303038373832' TO DFHEIV0(25:11)
  8994     CALL 'kxdfhei1' USING DFHEIV0,
  8995           QID,
  8996           EL156AI,
  8997           MAP-LENGTH,
  8998           DFHEIV99,
  8999           DFHEIV99,
  9000           DFHEIV99
  9001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9002
  9003
  9004 0599-EXIT.
  9005      EXIT.
  9006
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 170
* EL156.cbl
  9008 0600-RECOVER-TEMP-STORAGE.
  9009
  9010* EXEC CICS READQ TS
  9011*        QUEUE (QID)
  9012*        INTO  (PROGRAM-INTERFACE-BLOCK)
  9013*        LENGTH(PI-COMM-LENGTH)
  9014*    END-EXEC.
  9015*    MOVE '*$I    L              ''   #00008793' TO DFHEIV0
  9016     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9018     MOVE X'2020233030303038373933' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0,
  9020           QID,
  9021           PROGRAM-INTERFACE-BLOCK,
  9022           PI-COMM-LENGTH,
  9023           DFHEIV99,
  9024           DFHEIV99,
  9025           DFHEIV99
  9026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9027
  9028
  9029
  9030* EXEC CICS READQ TS
  9031*        QUEUE (QID)
  9032*        INTO  (EL156AI)
  9033*        LENGTH(MAP-LENGTH)
  9034*    END-EXEC.
  9035*    MOVE '*$I    L              ''   #00008799' TO DFHEIV0
  9036     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9037     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9038     MOVE X'2020233030303038373939' TO DFHEIV0(25:11)
  9039     CALL 'kxdfhei1' USING DFHEIV0,
  9040           QID,
  9041           EL156AI,
  9042           MAP-LENGTH,
  9043           DFHEIV99,
  9044           DFHEIV99,
  9045           DFHEIV99
  9046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9047
  9048
  9049     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9050
  9051     IF PMTTYPEI NOT = LOW-VALUES
  9052         MOVE AL-UANON           TO PMTTYPEA.
  9053
  9054     IF PAYEEI NOT = LOW-VALUES
  9055         MOVE AL-UANON           TO PAYEEA.
  9056
  9057     IF NOTE1I NOT = LOW-VALUES
  9058         MOVE AL-UANON           TO NOTE1A.
  9059
  9060     IF (RETURNED-FROM = 'EL614')
  9061        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9062     END-IF
  9063*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9064*       AND (PI-EOB-CODES-EXIST = 'Y')
  9065*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 171
* EL156.cbl
  9066*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9067     IF PI-SET-NOTE2-MDT = 'Y'
  9068         MOVE AL-SANON           TO NOTE2A
  9069     END-IF
  9070
  9071     IF OFFLINEI NOT = LOW-VALUES
  9072         MOVE AL-UANON           TO OFFLINEA.
  9073
  9074*    IF GROUPEDI NOT = LOW-VALUES
  9075*        MOVE AL-UANON           TO GROUPEDA.
  9076
  9077*    IF CASHI NOT = LOW-VALUES
  9078*        MOVE AL-UANON           TO CASHA.
  9079
  9080     IF CHECKNOI NOT = LOW-VALUES
  9081         MOVE AL-UANON           TO CHECKNOA.
  9082
  9083     IF HOLDTILI NOT = LOW-VALUES
  9084         MOVE AL-UANON           TO HOLDTILA.
  9085
  9086     IF EPYFROMI NOT = LOW-VALUES
  9087         MOVE AL-UANON           TO EPYFROMA.
  9088
  9089     IF AIGFROMI NOT = LOW-VALUES
  9090         MOVE AL-UANON           TO AIGFROMA.
  9091
  9092     IF EPYTHRUI NOT = LOW-VALUES
  9093         MOVE AL-UANON           TO EPYTHRUA.
  9094
  9095     IF EDAYSI NOT = LOW-VALUES
  9096         MOVE AL-UNNON           TO EDAYSA.
  9097
  9098     IF EPYAMTL NOT = +0
  9099         MOVE AL-UNNON           TO EPYAMTA.
  9100
  9101     IF ERESVL NOT = +0
  9102         MOVE AL-UNNON           TO ERESVA.
  9103
  9104     IF EEXPENSL NOT = +0
  9105         MOVE AL-UNNON           TO EEXPENSA.
  9106
  9107     IF ETYPEI NOT = LOW-VALUES
  9108         MOVE AL-UNNON           TO ETYPEA.
  9109
  9110     IF PROOFDTI NOT = 0
  9111         MOVE AL-UNNON           TO PROOFDTA.
  9112
  9113     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9114        MOVE AL-UANON            TO EOBYNA
  9115     END-IF
  9116     IF CLMFMYNI = 'Y' OR 'N'
  9117        MOVE AL-UANON            TO CLMFMYNA
  9118     END-IF
  9119
  9120     IF SURVYYNI = 'Y' OR 'N'
  9121        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9122           MOVE AL-UANON         TO SURVYYNA
  9123        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 172
* EL156.cbl
  9124     END-IF
  9125
  9126     IF SPRELYNI = 'Y' OR 'N'
  9127        MOVE AL-UANON            TO SPRELYNA
  9128     END-IF
  9129
  9130     .
  9131 0699-EXIT.
  9132      EXIT.
  9133
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 173
* EL156.cbl
  9135 0700-TEST-FOR-CHANGES.
  9136     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9137         MOVE ER-0433            TO EMI-ERROR
  9138         GO TO 0750-FUNCTION-ERROR.
  9139
  9140     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9141
  9142     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9143         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9144         MOVE 'A'                TO PI-PASS-SW
  9145         GO TO 1000-EDIT-DATA.
  9146
  9147     IF PI-FATAL-COUNT NOT = 0
  9148         MOVE ER-0499            TO EMI-ERROR
  9149         GO TO 0750-FUNCTION-ERROR.
  9150
  9151     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9152         MOVE ER-0500            TO EMI-ERROR
  9153         GO TO 0750-FUNCTION-ERROR.
  9154
  9155     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9156        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9157           MOVE ER-0542          TO EMI-ERROR
  9158           MOVE -1               TO EPYAMTL
  9159           GO TO 0750-FUNCTION-ERROR.
  9160
  9161     IF PI-OFFLINE = 'Y'  OR
  9162        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9163        MOVE EIBAID              TO PI-PFKEY-USED
  9164        GO TO 5000-UPDATE.
  9165
  9166     GO TO 6000-BUILD-SCREEN-B.
  9167
  9168 0750-FUNCTION-ERROR.
  9169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9170
  9171     IF ENTERPFL > 0
  9172         MOVE -1                 TO ENTERPFL
  9173         MOVE AL-UNBON           TO ENTERPFA
  9174         GO TO 8200-SEND-DATAONLY
  9175     ELSE
  9176         MOVE -1                 TO ENTERPFL
  9177         MOVE AL-UNNOF           TO ENTERPFA
  9178         GO TO 8200-SEND-DATAONLY.
  9179
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 174
* EL156.cbl
  9181 0800-DELETE-TS.
  9182
  9183* EXEC CICS HANDLE CONDITION
  9184*        QIDERR(0800-EXIT)
  9185*    END-EXEC.
  9186*    MOVE '"$N                   ! % #00008938' TO DFHEIV0
  9187     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9189     MOVE X'2520233030303038393338' TO DFHEIV0(25:11)
  9190     CALL 'kxdfhei1' USING DFHEIV0
  9191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9192
  9193
  9194
  9195* EXEC CICS DELETEQ TS
  9196*        QUEUE(QID)
  9197*    END-EXEC.
  9198*    MOVE '*&                    #   #00008942' TO DFHEIV0
  9199     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9200     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9201     MOVE X'2020233030303038393432' TO DFHEIV0(25:11)
  9202     CALL 'kxdfhei1' USING DFHEIV0,
  9203           QID,
  9204           DFHEIV99
  9205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9206
  9207
  9208 0800-EXIT.
  9209      EXIT.
  9210 0900-GET-DDF-LIMITS.
  9211
  9212     if cm-clp-state = zeros or spaces or low-values
  9213        move cm-state            to cm-clp-state
  9214     end-if
  9215     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9216     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9217     MOVE cm-clp-state           TO ERPDEF-STATE
  9218     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9219     evaluate true
  9220        when (cl-claim-type = 'L' or 'P')
  9221           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9222             and 'CU')
  9223           move 'L'              to erpdef-ben-type
  9224           move pi-lf-benefit-cd to erpdef-ben-code
  9225        when (cl-claim-type not = 'L' and 'P')
  9226           and (pi-ah-benefit-cd not = '00' and '  ')
  9227           move 'A'              to erpdef-ben-type
  9228           move pi-ah-benefit-cd to erpdef-ben-code
  9229        when (cl-claim-type not = 'L' and 'P')
  9230           and (pi-ah-benefit-cd = '00' or '  ')
  9231           move 'L'              to erpdef-ben-type
  9232           move pi-lf-benefit-cd to erpdef-ben-code
  9233        when (cl-claim-type = 'L' or 'P')
  9234           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9235           move 'A'              to erpdef-ben-type
  9236           move pi-ah-benefit-cd to erpdef-ben-code
  9237        when other
  9238           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 175
* EL156.cbl
  9239           move pi-ah-benefit-cd to erpdef-ben-code
  9240     end-evaluate
  9241*    if (cl-claim-type = 'L' or 'P')
  9242*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9243*          and 'CU')
  9244*       move 'L'                 to erpdef-ben-type
  9245*       move pi-lf-benefit-cd    to erpdef-ben-code
  9246*    else
  9247*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9248*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9249*    end-if
  9250     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9251
  9252     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9253
  9254
  9255* EXEC CICS STARTBR
  9256*        DATASET  ('ERPDEF')
  9257*        RIDFLD   (ERPDEF-KEY)
  9258*        GTEQ
  9259*        RESP     (WS-RESPONSE)
  9260*    END-EXEC
  9261     MOVE 'ERPDEF' TO DFHEIV1
  9262     MOVE 0
  9263       TO DFHEIV11
  9264*    MOVE '&,         G          &  N#00008992' TO DFHEIV0
  9265     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9266     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9267     MOVE X'204E233030303038393932' TO DFHEIV0(25:11)
  9268     CALL 'kxdfhei1' USING DFHEIV0,
  9269           DFHEIV1,
  9270           ERPDEF-KEY,
  9271           DFHEIV99,
  9272           DFHEIV11,
  9273           DFHEIV99
  9274     MOVE EIBRESP  TO WS-RESPONSE
  9275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9276
  9277     IF NOT WS-RESP-NORMAL
  9278        GO TO 0900-EXIT
  9279     END-IF
  9280
  9281     .
  9282 0900-READNEXT.
  9283
  9284
  9285* EXEC CICS READNEXT
  9286*       DATASET  ('ERPDEF')
  9287*       SET      (ADDRESS OF PRODUCT-MASTER)
  9288*       RIDFLD   (ERPDEF-KEY)
  9289*       RESP     (WS-RESPONSE)
  9290*    END-EXEC
  9291     MOVE 'ERPDEF' TO DFHEIV1
  9292     MOVE 0
  9293       TO DFHEIV11
  9294*    MOVE '&.S                   )  N#00009006' TO DFHEIV0
  9295     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9296     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 176
* EL156.cbl
  9297     MOVE X'204E233030303039303036' TO DFHEIV0(25:11)
  9298     CALL 'kxdfhei1' USING DFHEIV0,
  9299           DFHEIV1,
  9300           DFHEIV20,
  9301           DFHEIV99,
  9302           ERPDEF-KEY,
  9303           DFHEIV99,
  9304           DFHEIV11,
  9305           DFHEIV99,
  9306           DFHEIV99
  9307     SET ADDRESS OF PRODUCT-MASTER TO
  9308         DFHEIV20
  9309     MOVE EIBRESP  TO WS-RESPONSE
  9310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9311
  9312     IF NOT WS-RESP-NORMAL
  9313        GO TO 0900-ENDBR
  9314     END-IF
  9315
  9316     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9317        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9318           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9319        ELSE
  9320           GO TO 0900-READNEXT
  9321        END-IF
  9322     ELSE
  9323        GO TO 0900-ENDBR
  9324     END-IF
  9325
  9326     IF CM-LOAN-TERM = ZEROS
  9327        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9328     END-IF
  9329
  9330     .
  9331 0900-ENDBR.
  9332
  9333
  9334* EXEC CICS ENDBR
  9335*       DATASET  ('ERPDEF')
  9336*    END-EXEC
  9337     MOVE 'ERPDEF' TO DFHEIV1
  9338     MOVE 0
  9339       TO DFHEIV11
  9340*    MOVE '&2                    $   #00009034' TO DFHEIV0
  9341     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9342     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9343     MOVE X'2020233030303039303334' TO DFHEIV0(25:11)
  9344     CALL 'kxdfhei1' USING DFHEIV0,
  9345           DFHEIV1,
  9346           DFHEIV11,
  9347           DFHEIV99
  9348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9349
  9350     .
  9351 0900-EXIT.
  9352     EXIT.
  9353 1000-EDIT-DATA.
  9354
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 177
* EL156.cbl
  9355     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9356         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9357         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9358
  9359     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9360
  9361     IF NOT MODIFY-CAP
  9362         MOVE ER-0070            TO EMI-ERROR
  9363         MOVE -1                 TO PMTTYPEL
  9364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9365         GO TO 2000-EDIT-DONE.
  9366
  9367     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9368                         '5' AND '6'
  9369         MOVE ER-0420            TO EMI-ERROR
  9370         MOVE -1                 TO PMTTYPEL
  9371         MOVE AL-UABON           TO PMTTYPEA
  9372         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9373     ELSE
  9374         MOVE AL-UANON           TO PMTTYPEA.
  9375
  9376*    IF PI-OFFLINE = 'Y'
  9377*       IF PI-GROUPED = 'Y'
  9378*          MOVE ER-1880         TO EMI-ERROR
  9379*          MOVE -1              TO GROUPEDL
  9380*          MOVE AL-UABON        TO GROUPEDA
  9381*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9382*
  9383*    IF GROUPEDL > +0
  9384*       IF PI-GROUPED = 'Y' OR 'N'
  9385*          MOVE AL-UANON TO GROUPEDA
  9386*       ELSE
  9387*          MOVE ER-3140            TO EMI-ERROR
  9388*          MOVE -1                 TO GROUPEDL
  9389*          MOVE AL-UABON           TO GROUPEDA
  9390*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9391*
  9392*    IF CASHL > +0
  9393*       IF PI-CASH = 'Y' OR 'N'
  9394*          MOVE AL-UANON           TO CASHA
  9395*       ELSE
  9396*          MOVE ER-3141            TO EMI-ERROR
  9397*          MOVE -1                 TO CASHL
  9398*          MOVE AL-UABON           TO CASHA
  9399*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9400
  9401     IF LOANNOL > +0
  9402         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9403
  9404 1000-EDIT-PAYEE.
  9405
  9406     IF PI-PAYEE-SEQ NOT NUMERIC
  9407         MOVE ER-0294            TO  EMI-ERROR
  9408         MOVE -1                 TO  PAYEEL
  9409         MOVE AL-UABON           TO  PAYEEA
  9410         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9411         GO TO 1000-CONT-EDIT.
  9412
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 178
* EL156.cbl
  9413     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9414                         'E' OR 'O' OR 'Q'
  9415         NEXT SENTENCE
  9416     ELSE
  9417         MOVE ER-0294            TO  EMI-ERROR
  9418         MOVE -1                 TO  PAYEEL
  9419         MOVE AL-UABON           TO  PAYEEA
  9420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9421         GO TO 1000-CONT-EDIT.
  9422
  9423     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9424        (PI-PAYEE-SEQ NOT < '1' AND
  9425         PI-PAYEE-SEQ NOT > '9'))
  9426      OR
  9427        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9428         (PI-PAYEE-SEQ NOT > '9'))
  9429         MOVE AL-UANON            TO PAYEEA
  9430     ELSE
  9431         MOVE ER-0294            TO EMI-ERROR
  9432         MOVE -1                 TO PAYEEL
  9433         MOVE AL-UABON           TO PAYEEA
  9434         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9435
  9436     IF PI-COMPANY-ID = 'DMD'
  9437         IF PI-PAYEE-TYPE = 'B' AND
  9438            PI-PAYEE-SEQ NOT = '0'
  9439               MOVE ER-7841            TO EMI-ERROR
  9440               MOVE -1                 TO PAYEEL
  9441               MOVE AL-UABON           TO PAYEEA
  9442               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9443
  9444     IF PI-COMPANY-ID = 'JHL'
  9445         IF PI-PAYEE = 'B0'
  9446             NEXT SENTENCE
  9447           ELSE
  9448
  9449* EXEC CICS HANDLE CONDITION
  9450*            ENDFILE(1950-NOT-FOUND)
  9451*            NOTFND (1950-NOT-FOUND)
  9452*        END-EXEC
  9453*    MOVE '"$''I                  ! & #00009136' TO DFHEIV0
  9454     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9456     MOVE X'2620233030303039313336' TO DFHEIV0(25:11)
  9457     CALL 'kxdfhei1' USING DFHEIV0
  9458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9459         MOVE 'N'                    TO FOUND-TOL-SW
  9460         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9461         MOVE '2'                    TO CNTL-REC-TYPE
  9462         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9463         MOVE +0                     TO CNTL-SEQ-NO
  9464         MOVE 'PROC'                 TO FILE-SWITCH
  9465         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9466         IF PI-PAYEE = 'I1' AND
  9467            APPROVAL-LEVEL-2
  9468             NEXT SENTENCE
  9469           ELSE
  9470         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 179
* EL156.cbl
  9471             MOVE ER-3546        TO EMI-ERROR
  9472             MOVE -1             TO PAYEEL
  9473             MOVE AL-UABON       TO PAYEEA
  9474             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9475
  9476     IF PI-PAYEE-TYPE = 'E'
  9477        IF PI-PMTTYPE = '5' OR '6'
  9478            NEXT SENTENCE
  9479        ELSE
  9480            MOVE ER-3539            TO EMI-ERROR
  9481            MOVE -1                 TO PAYEEL
  9482            MOVE AL-UABON           TO PAYEEA
  9483            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9484
  9485 1000-CONT-EDIT.
  9486
  9487     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9488        IF PI-EPYAMT NOT NEGATIVE
  9489            MOVE ER-0421         TO EMI-ERROR
  9490            MOVE -1              TO OFFLINEL
  9491            MOVE AL-UABON        TO OFFLINEA
  9492            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9493        ELSE
  9494            MOVE AL-UANON        TO OFFLINEA.
  9495
  9496     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9497        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9498           CONTINUE
  9499        ELSE
  9500           IF PI-PRINT-EOB-YN = 'S' AND
  9501              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
  9502                CONTINUE
  9503           ELSE
  9504              MOVE ER-1561       TO EMI-ERROR
  9505              MOVE -1            TO EOBYNL
  9506              MOVE AL-UABON      TO EOBYNA
  9507              PERFORM 9900-ERROR-FORMAT
  9508                                 THRU 9900-EXIT
  9509           END-IF
  9510        END-IF
  9511
  9512        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9513            MOVE ER-1566        TO EMI-ERROR
  9514            MOVE -1             TO CLMFMYNL
  9515            MOVE AL-UABON       TO CLMFMYNA
  9516            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9517        END-IF
  9518
  9519        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9520            MOVE ER-1567        TO EMI-ERROR
  9521            MOVE -1             TO SURVYYNL
  9522            MOVE AL-UABON       TO SURVYYNA
  9523            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9524        END-IF
  9525
  9526        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9527            MOVE ER-1569        TO EMI-ERROR
  9528            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 180
* EL156.cbl
  9529            MOVE AL-UABON       TO SPRELYNA
  9530            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9531        END-IF
  9532
  9533     END-IF
  9534     IF PI-EPYAMT IS NEGATIVE
  9535         IF PI-OFFLINE NOT = 'Y'
  9536             MOVE ER-0836        TO  EMI-ERROR
  9537             MOVE -1             TO  OFFLINEL
  9538             MOVE AL-UABON       TO  OFFLINEA
  9539             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9540
  9541     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9542        MOVE ER-0872             TO EMI-ERROR
  9543        MOVE -1                  TO PROOFDTL
  9544        MOVE AL-UABON            TO PROOFDTA
  9545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9546     ELSE
  9547        MOVE '4'                TO DC-OPTION-CODE
  9548        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9549        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9550        IF DATE-CONVERSION-ERROR
  9551            MOVE ER-0873        TO EMI-ERROR
  9552            MOVE -1                  TO PROOFDTL
  9553            MOVE AL-UABON            TO PROOFDTA
  9554            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9555        ELSE
  9556            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9557            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9558                MOVE ER-0873    TO EMI-ERROR
  9559                MOVE -1                  TO PROOFDTL
  9560                MOVE AL-UABON            TO PROOFDTA
  9561                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9562            END-IF
  9563        END-IF
  9564     END-IF.
  9565
  9566     IF PI-COMPANY-ID = 'DMD'
  9567        IF NOTE1L NOT = ZEROS
  9568            MOVE ER-7844        TO  EMI-ERROR
  9569            MOVE -1             TO  NOTE1L
  9570            MOVE AL-UABON       TO  NOTE1A
  9571            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9572
  9573     IF PI-COMPANY-ID = 'DMD'
  9574        IF NOTE2L NOT = ZEROS
  9575          GO TO 1004-DMD-EOB-CHECKS.
  9576
  9577     IF NOTE1L NOT > +0
  9578         GO TO 1005-CHECK-ERRORS.
  9579
  9580     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9581         GO TO 1005-CHECK-ERRORS.
  9582
  9583     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9584         GO TO 1003-HAN-PMT-NOTES.
  9585
  9586     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 181
* EL156.cbl
  9587
  9588     IF WS-PMTOPTION NUMERIC
  9589        IF WS-PMTOPTION > '00' AND < '17'
  9590           NEXT SENTENCE
  9591        ELSE
  9592           MOVE ER-0618          TO EMI-ERROR
  9593           MOVE -1               TO NOTE1L
  9594           MOVE AL-UABON         TO NOTE1A
  9595           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9596     ELSE
  9597        GO TO 1005-CHECK-ERRORS.
  9598
  9599     IF WS-PMTOPTION = '05' AND
  9600        WS-DOCNAME = SPACES
  9601          MOVE ER-0616             TO EMI-ERROR
  9602          MOVE -1                  TO NOTE1L
  9603          MOVE AL-UABON            TO NOTE1A
  9604          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9605
  9606     IF WS-PMTOPTION = '15' OR '16'
  9607
  9608* EXEC CICS BIF DEEDIT
  9609*            FIELD (WS-AMOUNT)
  9610*            LENGTH(08)
  9611*        END-EXEC
  9612     MOVE 08
  9613       TO DFHEIV11
  9614*    MOVE '@"L                   #   #00009288' TO DFHEIV0
  9615     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9616     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9617     MOVE X'2020233030303039323838' TO DFHEIV0(25:11)
  9618     CALL 'kxdfhei1' USING DFHEIV0,
  9619           WS-AMOUNT,
  9620           DFHEIV11
  9621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9622        IF (WS-NUM-AMT = ZEROS) OR
  9623           (WS-AMOUNT NOT NUMERIC)
  9624           MOVE ER-0617          TO EMI-ERROR
  9625           MOVE -1               TO NOTE1L
  9626           MOVE AL-UABON         TO NOTE1A
  9627           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9628
  9629     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9630
  9631     GO TO 1005-CHECK-ERRORS.
  9632
  9633 1003-HAN-PMT-NOTES.
  9634
  9635     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9636
  9637     IF WS-HAN-PMT-CODE = SPACE
  9638         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9639     ELSE
  9640     IF WS-HAN-PMT-CODE = 'A'
  9641         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9642                                 TO WS-HAN-PMT-NOTE
  9643     ELSE
  9644     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 182
* EL156.cbl
  9645         MOVE ':FINAL PAYMENT / DECEASED'
  9646                                 TO WS-HAN-PMT-NOTE
  9647     ELSE
  9648     IF WS-HAN-PMT-CODE = 'C'
  9649         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9650                                 TO WS-HAN-PMT-NOTE
  9651     ELSE
  9652     IF WS-HAN-PMT-CODE = 'D'
  9653         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9654                                 TO WS-HAN-PMT-NOTE
  9655     ELSE
  9656     IF WS-HAN-PMT-CODE = 'E'
  9657         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9658                                 TO WS-HAN-PMT-NOTE
  9659     ELSE
  9660     IF WS-HAN-PMT-CODE = 'F'
  9661         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9662                                 TO WS-HAN-PMT-NOTE
  9663     ELSE
  9664     IF WS-HAN-PMT-CODE = 'P'
  9665         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9666
  9667     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9668     GO TO 1005-CHECK-ERRORS.
  9669
  9670 1004-DMD-EOB-CHECKS.
  9671
  9672     INITIALIZE PI-AT-EOB-CODES.
  9673
  9674     IF NOTE2I (20:21) > SPACES
  9675         MOVE ER-7845          TO EMI-ERROR
  9676         MOVE -1               TO NOTE2L
  9677         MOVE AL-UABON         TO NOTE2A
  9678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9679         GO TO 1005-CHECK-ERRORS
  9680      ELSE
  9681         MOVE NOTE2I             TO W-EOB-CODES.
  9682
  9683     MOVE +1                     TO W-EOB-NDX.
  9684
  9685 1004-CHECK-EACH-EOB.
  9686
  9687     IF W-EOB-NDX > +5
  9688             OR
  9689        W-EOB-CODE (W-EOB-NDX) = SPACES
  9690         GO TO 1004-CHECK-DUP-EOB.
  9691
  9692     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9693         MOVE ER-0956            TO EMI-ERROR
  9694         MOVE -1                 TO NOTE2L
  9695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9696         GO TO 1005-CHECK-ERRORS.
  9697
  9698     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9699     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9700     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9701     MOVE 'DLO023'               TO PGM-NAME.
  9702
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 183
* EL156.cbl
  9703
  9704* EXEC CICS LINK
  9705*        PROGRAM    (PGM-NAME)
  9706*        COMMAREA   (CD-COMMUNICATION-AREA)
  9707*        LENGTH     (CD-RCRD-LENGTH)
  9708*    END-EXEC.
  9709*    MOVE '."C                   (   #00009373' TO DFHEIV0
  9710     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9712     MOVE X'2020233030303039333733' TO DFHEIV0(25:11)
  9713     CALL 'kxdfhei1' USING DFHEIV0,
  9714           PGM-NAME,
  9715           CD-COMMUNICATION-AREA,
  9716           CD-RCRD-LENGTH,
  9717           DFHEIV99,
  9718           DFHEIV99,
  9719           DFHEIV99,
  9720           DFHEIV99
  9721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9722
  9723
  9724     IF CD-RETURN-CODE = 'OK'
  9725         GO TO 1004-CONT.
  9726
  9727     MOVE -1                     TO NOTE2L.
  9728
  9729     IF CD-RETURN-CODE = '01'
  9730         MOVE ER-8310            TO EMI-ERROR
  9731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9732         GO TO 1005-CHECK-ERRORS.
  9733
  9734     IF CD-RETURN-CODE = '02'
  9735         MOVE ER-8311            TO EMI-ERROR
  9736         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9737         GO TO 1005-CHECK-ERRORS.
  9738
  9739     IF CD-RETURN-CODE = '03'
  9740         MOVE ER-8312            TO EMI-ERROR
  9741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9742         GO TO 1005-CHECK-ERRORS.
  9743
  9744     IF CD-RETURN-CODE = '04'
  9745         MOVE ER-8313            TO EMI-ERROR
  9746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9747         GO TO 1005-CHECK-ERRORS.
  9748
  9749     IF CD-RETURN-CODE = '05'
  9750         MOVE ER-8314            TO EMI-ERROR
  9751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9752         GO TO 1005-CHECK-ERRORS.
  9753
  9754     IF CD-RETURN-CODE = '06'
  9755         MOVE ER-8315            TO EMI-ERROR
  9756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9757         GO TO 1005-CHECK-ERRORS.
  9758
  9759     IF CD-RETURN-CODE = 'E1'
  9760         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 184
* EL156.cbl
  9761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9762         GO TO 1005-CHECK-ERRORS.
  9763
  9764     IF CD-RETURN-CODE = 'N1'
  9765         MOVE ER-8317            TO EMI-ERROR
  9766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9767         GO TO 1005-CHECK-ERRORS.
  9768
  9769 1004-CONT.
  9770     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9771
  9772     ADD +1 TO W-EOB-NDX.
  9773     GO TO 1004-CHECK-EACH-EOB.
  9774
  9775 1004-CHECK-DUP-EOB.
  9776     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9777         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9778                               PI-AT-EOB-CODE (3) OR
  9779                               PI-AT-EOB-CODE (4) OR
  9780                               PI-AT-EOB-CODE (5)))
  9781                  OR
  9782        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9783         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9784                               PI-AT-EOB-CODE (4) OR
  9785                               PI-AT-EOB-CODE (5)))
  9786                  OR
  9787        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9788         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9789                               PI-AT-EOB-CODE (5)))
  9790                  OR
  9791        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9792         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9793            MOVE ER-8000            TO EMI-ERROR
  9794            MOVE AL-UABON           TO NOTE2A
  9795            MOVE -1                 TO NOTE2L
  9796            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9797            GO TO 1005-CHECK-ERRORS.
  9798
  9799 1005-CHECK-ERRORS.
  9800*    IF PI-COMPANY-ID NOT = 'DMD'
  9801        GO TO 1006-CHECK-ERRORS.
  9802
  9803*********  DMD CODE START ******************
  9804*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9805*       GO TO 1006-CHECK-ERRORS.
  9806*
  9807*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9808*
  9809*    COMPUTE W-PAYMENT-TOTAL
  9810*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9811*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9812*               AND
  9813*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9814*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9815*          MOVE ER-0967    TO EMI-ERROR
  9816*          MOVE -1         TO PMTTYPEL
  9817*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9818*
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 185
* EL156.cbl
  9819*    GO TO 1006-CHECK-ERRORS.
  9820*********  DMD CODE END ******************
  9821
  9822 1006-CHECK-ERRORS.
  9823     if emi-forcable-ctr = zeros
  9824        and emi-fatal-ctr = zeros
  9825        continue
  9826     else
  9827        IF NOT EMI-NO-ERRORS
  9828           GO TO 2000-EDIT-DONE
  9829        end-if
  9830     end-if
  9831
  9832* EXEC CICS HANDLE CONDITION
  9833*        NOTFND(1950-NOT-FOUND)
  9834*    END-EXEC.
  9835*    MOVE '"$I                   ! '' #00009486' TO DFHEIV0
  9836     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9838     MOVE X'2720233030303039343836' TO DFHEIV0(25:11)
  9839     CALL 'kxdfhei1' USING DFHEIV0
  9840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9841
  9842
  9843     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9844     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9845     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9846     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9847     MOVE 'MSTR'                 TO FILE-SWITCH.
  9848
  9849     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9850
  9851     IF PI-COMPANY-ID = 'DMD'
  9852         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9853
  9854     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9855        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9856           MOVE ER-0873    TO EMI-ERROR
  9857           MOVE -1                  TO PROOFDTL
  9858           MOVE AL-UABON            TO PROOFDTA
  9859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9860        END-IF
  9861     END-IF
  9862     if cl-benefit-period = zeros
  9863        move er-1667             to emi-error
  9864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9865     end-if
  9866     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9867     MOVE +95                    TO TRLR-SEQ-NO
  9868
  9869* EXEC CICS READ
  9870*       DATASET  ('ELTRLR')
  9871*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9872*       RIDFLD   (ELTRLR-KEY)
  9873*       RESP     (WS-RESPONSE)
  9874*    END-EXEC
  9875     MOVE 'ELTRLR' TO DFHEIV1
  9876*    MOVE '&"S        E          (  N#00009515' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 186
* EL156.cbl
  9877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9879     MOVE X'204E233030303039353135' TO DFHEIV0(25:11)
  9880     CALL 'kxdfhei1' USING DFHEIV0,
  9881           DFHEIV1,
  9882           DFHEIV20,
  9883           DFHEIV99,
  9884           ELTRLR-KEY,
  9885           DFHEIV99,
  9886           DFHEIV99,
  9887           DFHEIV99
  9888     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9889         DFHEIV20
  9890     MOVE EIBRESP  TO WS-RESPONSE
  9891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9892
  9893     if ws-resp-normal
  9894        perform varying s1 from +1 by +1 until
  9895           at-note-error-no (s1) = spaces
  9896           if at-note-error-no (s1) = '1662'
  9897              continue
  9898           else
  9899              move at-note-error-no (s1)
  9900                                 to emi-error
  9901              if at-note-error-no (s1) = '1653'
  9902                 evaluate true
  9903                    when cl-claim-type = 'L'
  9904                       move '  LF  '
  9905                                 to emi-claim-type
  9906                    when cl-claim-type = 'I'
  9907                       move '  IU  '
  9908                                 to emi-claim-type
  9909                    when cl-claim-type = 'A'
  9910                       move '  AH  '
  9911                                 to emi-claim-type
  9912                    when cl-claim-type = 'O'
  9913                       move '  OT  '
  9914                                 to emi-claim-type
  9915                    when other
  9916                       move ' FMLA '
  9917                                 to emi-claim-type
  9918                 end-evaluate
  9919              end-if
  9920              PERFORM 9900-ERROR-FORMAT
  9921                                 THRU 9900-EXIT
  9922           end-if
  9923        end-perform
  9924     end-if
  9925     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9926         IF PI-PMTTYPE = '5' OR '6'
  9927             NEXT SENTENCE
  9928         ELSE
  9929             MOVE ER-0555             TO EMI-ERROR
  9930             MOVE -1                  TO PMTTYPEL
  9931             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9932
  9933     IF CL-LAST-CLOSE-REASON = '2'
  9934         IF CL-CLAIM-STATUS = 'C'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 187
* EL156.cbl
  9935             MOVE ER-0760        TO  EMI-ERROR
  9936             MOVE -1             TO  PMTTYPEL
  9937             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9938
  9939     IF PI-ACTIVITY-CODE = 9
  9940         MOVE ER-3538            TO  EMI-ERROR
  9941         MOVE -1                 TO  PMTTYPEL
  9942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9943
  9944     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9945         GO TO 1008-READ-CERT.
  9946**********************AIG LOGIC STARTS *********************
  9947     IF CL-CERT-PRIME = 'INCOMPLETE'
  9948         MOVE ER-3540            TO  EMI-ERROR
  9949         MOVE -1                 TO  PMTTYPEL
  9950         MOVE AL-UABON           TO  PMTTYPEA
  9951         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9952         GO TO 2000-EDIT-DONE.
  9953
  9954     IF PI-PMTTYPE = '4'
  9955         IF PI-EPYAMT IS NEGATIVE
  9956             IF PI-ECHECKNO-CR = 'CR'
  9957                 NEXT SENTENCE
  9958             ELSE
  9959                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9960
  9961     IF PI-PMTTYPE = '4'
  9962         IF PI-ECHECKNO-CR = 'CR'
  9963             IF PI-EPYAMT IS NEGATIVE
  9964                 NEXT SENTENCE
  9965             ELSE
  9966                 MOVE ER-0834    TO  EMI-ERROR
  9967                 MOVE -1         TO  EPYAMTL
  9968                 MOVE AL-UNBON   TO  EPYAMTA
  9969                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9970
  9971     IF PI-PMTTYPE = '4'
  9972         IF PI-EPYAMT IS NEGATIVE
  9973             IF PI-OFFLINE = 'Y'
  9974                 NEXT SENTENCE
  9975             ELSE
  9976                 MOVE 'Y'        TO  PI-OFFLINE
  9977                                     WS-OFFLINE
  9978                                     OFFLINEO
  9979                 MOVE AL-UANON   TO  OFFLINEA.
  9980
  9981*    IF PI-PMTTYPE = '4'
  9982*        IF PI-EPYAMT IS NEGATIVE
  9983*            IF PI-CASH = 'Y'
  9984*                NEXT SENTENCE
  9985*            ELSE
  9986*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9987*                MOVE AL-UANON   TO  CASHA
  9988*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9989*
  9990*    IF PI-CASH NOT = 'Y' AND 'N'
  9991*         IF PI-OFFLINE = 'Y'  AND
  9992*            PI-ECHECKNO-CR = 'CR'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 188
* EL156.cbl
  9993*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9994*              MOVE AL-UANON     TO  CASHA
  9995*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9996*
  9997*    IF PI-CASH NOT = 'Y' AND 'N'
  9998*        IF PI-PMTTYPE = '5' OR '6'
  9999*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
 10000*            MOVE AL-UANON       TO  CASHA
 10001*            GO TO 1007-DEFAULT-AIG-CHECKNO.
 10002*
 10003*    IF PI-CASH NOT = 'Y' AND 'N'
 10004*       IF CL-ASSOCIATES = 'N' OR 'A'
 10005*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
 10006*           MOVE AL-UANON        TO  CASHA
 10007*       ELSE
 10008*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
 10009*           MOVE AL-UANON        TO  CASHA.
 10010*
 10011*    IF PI-PMTTYPE = '5' OR '6'
 10012*        IF PI-CASH = 'N'
 10013*            MOVE ER-0819        TO  EMI-ERROR
 10014*            MOVE AL-UANON       TO  CASHA
 10015*            MOVE -1             TO  CASHL
 10016*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10017*
 10018*    IF CL-ASSOCIATES = 'N' OR 'A'
 10019*       IF CASHI = 'N'
 10020*        MOVE ER-3537            TO  EMI-ERROR
 10021*        MOVE AL-UANON           TO  CASHA
 10022*        MOVE -1                 TO  CASHL
 10023*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10024
 10025 1007-DEFAULT-AIG-CHECKNO.
 10026
 10027     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
 10028         MOVE ER-3532            TO  EMI-ERROR
 10029         MOVE -1                 TO  PMTTYPEL
 10030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10031**********************AIG LOGIC ENDS ***********************
 10032
 10033 1008-READ-CERT.
 10034
 10035     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 10036     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 10037     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10038     MOVE CL-CERT-STATE          TO CERT-STATE.
 10039     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10040     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10041     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10042     MOVE 'CERT'                 TO FILE-SWITCH.
 10043
 10044     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10045
 10046     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10047        MOVE CM-LF-LOAN-EXPIRE-DT
 10048                                 TO WS-EXP-DT PI-EXP-DT
 10049                                    ws-extended-exp-dt
 10050     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 189
* EL156.cbl
 10051        MOVE CM-AH-LOAN-EXPIRE-DT
 10052                                 TO WS-EXP-DT PI-EXP-DT
 10053                                    ws-extended-exp-dt
 10054     end-if
 10055     MOVE '6'           TO DC-OPTION-CODE
 10056     if pi-dcc-product-code not = spaces
 10057        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10058        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10059        PERFORM 0900-GET-DDF-limits
 10060                                 THRU 0900-EXIT
 10061        IF PDEF-FOUND
 10062         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10063           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10064              (P1 > +8)
 10065              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10066           END-PERFORM
 10067           IF P1 < +9
 10068              MOVE '6'           TO DC-OPTION-CODE
 10069              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10070              IF CL-NO-OF-EXTENSIONS NUMERIC
 10071               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10072                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10073                                             PI-MAX-EXT
 10074              ELSE
 10075                 MOVE PD-MAX-EXTENSION (P1)
 10076                                 TO DC-ELAPSED-MONTHS
 10077              END-IF
 10078              PERFORM 9700-LINK-DATE-CONVERT
 10079                                 THRU 9700-EXIT
 10080              if no-conversion-error
 10081                 move dc-bin-date-2 to ws-extended-exp-dt
 10082              end-if
 10083           else
 10084              move er-1674       to emi-error
 10085              PERFORM 9900-ERROR-FORMAT
 10086                                 THRU 9900-EXIT
 10087           end-if
 10088        ELSE
 10089           IF CL-NO-OF-EXTENSIONS NUMERIC
 10090              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10091                                          PI-MAX-EXT
 10092           ELSE
 10093              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10094           END-IF
 10095           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10096           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10097           if no-conversion-error
 10098              move dc-bin-date-2 to ws-extended-exp-dt
 10099           end-if
 10100        end-if
 10101     ELSE
 10102        IF CL-NO-OF-EXTENSIONS NUMERIC
 10103           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10104                                       PI-MAX-EXT
 10105        ELSE
 10106           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10107        END-IF
 10108        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 190
* EL156.cbl
 10109        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10110        if no-conversion-error
 10111           move dc-bin-date-2 to ws-extended-exp-dt
 10112        end-if
 10113     end-if
 10114*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10115*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10116
 10117     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10118         MOVE ER-0458            TO EMI-ERROR
 10119         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10120
 10121     IF (CL-INCURRED-DT > WS-EXP-DT)
 10122        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10123        MOVE ER-1677             TO EMI-ERROR
 10124        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10125     END-IF
 10126     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10127     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10128         MOVE ER-0459            TO EMI-ERROR
 10129         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10130
 10131     IF CL-REPORTED-DT = LOW-VALUES
 10132        MOVE ER-0530             TO EMI-ERROR
 10133        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10134
 10135     IF PI-COMPANY-ID = 'NCL'
 10136        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10137            MOVE ER-0770            TO EMI-ERROR
 10138            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10139
 10140     IF PI-COMPANY-ID = 'NCL'
 10141        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10142            MOVE ER-0737            TO EMI-ERROR
 10143            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10144
 10145     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10146         MOVE ER-0768            TO  EMI-ERROR
 10147         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10148
 10149     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10150         MOVE ER-0769            TO  EMI-ERROR
 10151         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10152
 10153     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10154         GO TO 1020-DO-LIFE-EDITS
 10155     ELSE
 10156         GO TO 1030-DO-AH-EDITS.
 10157
 10158 1010-GENERAL-ERROR.
 10159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10160
 10161     IF EMI-MESSAGE-FORMATTED
 10162         MOVE -1                 TO PMTTYPEL.
 10163
 10164 1010-EXIT.
 10165     EXIT.
 10166
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 191
* EL156.cbl
 10168 1020-DO-LIFE-EDITS.
 10169     IF CM-LF-BENEFIT-CD = '00'
 10170         IF PI-PMTTYPE = '5' OR '6'
 10171             MOVE ER-0658        TO EMI-ERROR
 10172             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10173         ELSE
 10174            if (pi-company-id = 'DCC' or 'VPP')
 10175               and (pi-dcc-product-code not = spaces)
 10176               continue
 10177            else
 10178               MOVE ER-1775      TO EMI-ERROR
 10179               PERFORM 1040-PMTTYPE-ERROR
 10180                                 THRU 1040-EXIT
 10181            end-if
 10182         end-if
 10183     end-if
 10184
 10185     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10186     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10187         MOVE ER-0460            TO EMI-ERROR
 10188         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10189
 10190     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10191     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10192     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10193     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10194     MOVE '4'                    TO  CNTL-REC-TYPE.
 10195     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10196     MOVE 'BENE'                 TO  FILE-SWITCH.
 10197     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10198     IF NO-BENEFIT-FOUND
 10199         GO TO 1950-NOT-FOUND.
 10200
 10201     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10202
 10203     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10204       AND NOT CM-LF-LUMP-SUM-DISAB
 10205         IF PI-PMTTYPE = '4'
 10206             IF (PI-LIFE-OVERRIDE-L1 = 'P' OR
 10207                PI-LF-COVERAGE-TYPE = 'P')
 10208               AND NOT CM-LF-LUMP-SUM-DISAB
 10209                 NEXT SENTENCE
 10210             ELSE
 10211                 MOVE ER-0461        TO EMI-ERROR
 10212                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10213         ELSE
 10214            NEXT SENTENCE
 10215     ELSE
 10216         IF PI-PMTTYPE = '2'
 10217            IF NOT CM-O-B-COVERAGE
 10218              AND CM-LF-CURRENT-STATUS = '7'
 10219                MOVE ER-0462     TO EMI-ERROR
 10220                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10221
 10222     IF PI-PMTTYPE = '2'
 10223         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10224            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10225             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 192
* EL156.cbl
 10226             MOVE ER-0730            TO  EMI-ERROR
 10227             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10228             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10229
 10230     IF PI-PMTTYPE = '2'
 10231         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10232            PI-LF-COVERAGE-TYPE = 'P'
 10233             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10234                 MOVE ER-0462    TO  EMI-ERROR
 10235                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10236
 10237     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10238       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10239         MOVE ER-0466            TO EMI-ERROR
 10240         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10241
 10242     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10243         IF PI-PMTTYPE = '3'
 10244             MOVE 0436           TO EMI-ERROR
 10245             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10246             GO TO 1045-EDIT-PAYEE-ADDR
 10247         ELSE
 10248             GO TO 1045-EDIT-PAYEE-ADDR.
 10249
 10250     IF CL-CLAIM-TYPE = 'O'
 10251         IF PI-PMTTYPE = '1' OR '2'
 10252             MOVE ER-1930          TO EMI-ERROR
 10253             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10254         END-IF
 10255     ELSE
 10256     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10257        PI-LF-COVERAGE-TYPE = 'P'
 10258         IF PI-PMTTYPE = '3'
 10259             MOVE ER-0436          TO  EMI-ERROR
 10260             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10261         ELSE
 10262             NEXT SENTENCE
 10263     ELSE
 10264         IF PI-PMTTYPE = '1' OR '3'
 10265             MOVE ER-0436            TO EMI-ERROR
 10266             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10267*
 10268     IF PI-COMPANY-ID = 'CID' AND
 10269        CL-CERT-STATE = 'SC'  AND
 10270        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10271           MOVE ER-0879    TO  EMI-ERROR
 10272           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10273           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10274     END-IF.
 10275     IF PI-COMPANY-ID = 'AHL'
 10276        evaluate true
 10277           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10278              MOVE ER-0879       TO  EMI-ERROR
 10279              PERFORM 1040-PMTTYPE-ERROR
 10280                                 THRU 1040-EXIT
 10281              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10282           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10283                 '6D' OR '6H' OR '6R'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 193
* EL156.cbl
 10284              MOVE ER-0879       TO  EMI-ERROR
 10285              PERFORM 1040-PMTTYPE-ERROR
 10286                                 THRU 1040-EXIT
 10287              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10288           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10289              MOVE ER-0879       TO  EMI-ERROR
 10290              PERFORM 1040-PMTTYPE-ERROR
 10291                                 THRU 1040-EXIT
 10292              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10293        end-evaluate
 10294     END-IF
 10295     GO TO 1045-EDIT-PAYEE-ADDR.
 10296
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 194
* EL156.cbl
 10298 1030-DO-AH-EDITS.
 10299     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10300     IF CM-AH-BENEFIT-CD = '00'
 10301         IF PI-PMTTYPE = '5' OR '6'
 10302             MOVE ER-0658        TO EMI-ERROR
 10303             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10304         ELSE
 10305             MOVE ER-1775        TO EMI-ERROR
 10306             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10307
 10308     IF CL-TOTAL-PAID-AMT = ZEROS
 10309         IF PI-PMTTYPE = '4'
 10310             MOVE ER-0438        TO EMI-ERROR
 10311             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10312
 10313     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10314         IF PI-PMTTYPE = '3'
 10315             MOVE ER-0463        TO EMI-ERROR
 10316             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10317         ELSE
 10318             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10319              AND CM-LF-CURRENT-STATUS = '7'
 10320                 MOVE ER-0465    TO EMI-ERROR
 10321                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10322
 10323     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10324         IF PI-PMTTYPE = '3'
 10325             MOVE ER-0464        TO EMI-ERROR
 10326             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10327         ELSE
 10328             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10329                 MOVE ER-0469    TO EMI-ERROR
 10330                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10331
 10332     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10333         IF PI-PMTTYPE = '3'
 10334             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10335                 MOVE ER-0467    TO EMI-ERROR
 10336                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10337             ELSE
 10338                 NEXT SENTENCE
 10339         ELSE
 10340             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10341                 MOVE ER-0468    TO EMI-ERROR
 10342                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10343
 10344     GO TO 1045-EDIT-PAYEE-ADDR.
 10345
 10346 1040-PMTTYPE-ERROR.
 10347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10348
 10349     IF EMI-MESSAGE-FORMATTED
 10350         MOVE -1                 TO PMTTYPEL
 10351         MOVE AL-UABON           TO PMTTYPEA.
 10352
 10353 1040-EXIT.
 10354     EXIT.
 10355
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 195
* EL156.cbl
 10357 1045-EDIT-PAYEE-ADDR.
 10358
 10359     IF PI-OFFLINE = 'N' AND
 10360        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10361           < PI-PAYEE-SEQ-NUM)
 10362        OR
 10363         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10364         (PI-PAYEE-TYPE = 'B')                 AND
 10365         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10366        OR
 10367         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10368           < PI-PAYEE-SEQ-NUM)
 10369        OR
 10370         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10371           < PI-PAYEE-SEQ-NUM)
 10372        OR
 10373         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10374           < PI-PAYEE-SEQ-NUM)
 10375        OR
 10376         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10377           < PI-PAYEE-SEQ-NUM)
 10378        OR
 10379         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10380           < PI-PAYEE-SEQ-NUM))
 10381             MOVE ER-0437        TO EMI-ERROR
 10382             MOVE -1             TO PAYEEL
 10383             MOVE AL-UABON       TO PAYEEA
 10384             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10385
 10386     IF PI-OFFLINE    = 'N' AND
 10387        PI-PAYEE-TYPE = 'B' AND
 10388        PI-PAYEE-SEQ  = '0'
 10389         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10390         IF BENE-FOUND-SW = 'N'
 10391             MOVE ER-0437        TO EMI-ERROR
 10392             MOVE -1             TO PAYEEL
 10393             MOVE AL-UABON       TO PAYEEA
 10394             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10395
 10396     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10397        IF PI-OFFLINE    = 'N'  AND
 10398           PI-PAYEE-TYPE = 'B'  AND
 10399           PI-PAYEE-SEQ  = '9'
 10400             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10401             IF BENE-FOUND-SW = 'N'
 10402                MOVE ER-0437        TO EMI-ERROR
 10403                MOVE -1             TO PAYEEL
 10404                MOVE AL-UABON       TO PAYEEA
 10405                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10406
 10407*    IF PI-COMPANY-ID = 'CRI'
 10408*        IF CL-CLAIM-TYPE = 'L'
 10409*            MOVE 'N'                TO  WS-GROUPED
 10410*                                        PI-GROUPED
 10411*                                        GROUPEDI
 10412*            MOVE AL-UANON           TO  GROUPEDA
 10413*            GO TO 1050-EDIT-CHECK-NO
 10414*        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 196
* EL156.cbl
 10415*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10416*            IF WS-GROUP-1 = 'C'
 10417*                NEXT SENTENCE
 10418*            ELSE
 10419*                MOVE 'N'            TO  WS-GROUPED
 10420*                                        PI-GROUPED
 10421*                                        GROUPEDI
 10422*                MOVE AL-UANON       TO  GROUPEDA
 10423*                GO TO 1050-EDIT-CHECK-NO.
 10424
 10425*     IF PI-GROUPED = 'Y'
 10426*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10427*           NEXT SENTENCE
 10428*        ELSE
 10429*           MOVE ER-0437        TO EMI-ERROR
 10430*           MOVE -1             TO PAYEEL
 10431**02180            MOVE AL-UABON       TO PAYEEA
 10432*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10433*
 10434*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10435*        (PI-GROUPED    = ' ')
 10436*        NEXT SENTENCE
 10437*     ELSE
 10438*
 10439     GO TO 1050-EDIT-CHECK-NO.
 10440*     IF PI-COMPANY-ID = 'CRI'
 10441*        MOVE 'N'           TO GROUPEDI
 10442*                              PI-GROUPED
 10443*                              WS-GROUPED
 10444*        MOVE AL-UANON      TO GROUPEDA.
 10445*
 10446*     IF PI-COMPANY-ID = 'CRI'
 10447*        IF PI-PAYEE-TYPE = 'B'
 10448*           IF BENE-FOUND-SW = 'Y'
 10449*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10450*                 MOVE 'Y'           TO GROUPEDI
 10451*                                       PI-GROUPED
 10452*                                       WS-GROUPED
 10453*                 MOVE AL-UANON      TO GROUPEDA
 10454*              ELSE
 10455*                 NEXT SENTENCE
 10456*           ELSE
 10457*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10458*              IF BENE-FOUND-SW = 'Y'
 10459*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10460*                    MOVE 'Y'      TO GROUPEDI
 10461*                                     PI-GROUPED
 10462*                                     WS-GROUPED
 10463*                    MOVE AL-UANON TO GROUPEDA.
 10464*
 10465
 10466     IF PI-COMPANY-ID NOT = 'CRI'
 10467        GO TO 1050-EDIT-CHECK-NO.
 10468
 10469*************** CRI CODE START ******************
 10470     IF PI-PAYEE-TYPE NOT = 'A'
 10471        GO TO 1050-EDIT-CHECK-NO.
 10472
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 197
* EL156.cbl
 10473     MOVE LOW-VALUES             TO ERACCT-KEY.
 10474     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10475     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10476     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10477     MOVE PI-STATE               TO ACCT-STATE.
 10478     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10479     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10480     MOVE 'ACCT'                 TO FILE-SWITCH.
 10481
 10482     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10483     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10484
 10485
 10486* EXEC CICS HANDLE CONDITION
 10487*         NOTFND   (1950-NOT-FOUND)
 10488*         ENDFILE  (1950-NOT-FOUND)
 10489*    END-EXEC.
 10490*    MOVE '"$I''                  ! ( #00010114' TO DFHEIV0
 10491     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10493     MOVE X'2820233030303130313134' TO DFHEIV0(25:11)
 10494     CALL 'kxdfhei1' USING DFHEIV0
 10495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10496
 10497
 10498
 10499* EXEC CICS STARTBR
 10500*         DATASET   ('ERACCT')
 10501*         RIDFLD    (ERACCT-KEY)
 10502*         GTEQ
 10503*    END-EXEC.
 10504     MOVE 'ERACCT' TO DFHEIV1
 10505     MOVE 0
 10506       TO DFHEIV11
 10507*    MOVE '&,         G          &   #00010119' TO DFHEIV0
 10508     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10509     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10510     MOVE X'2020233030303130313139' TO DFHEIV0(25:11)
 10511     CALL 'kxdfhei1' USING DFHEIV0,
 10512           DFHEIV1,
 10513           ERACCT-KEY,
 10514           DFHEIV99,
 10515           DFHEIV11,
 10516           DFHEIV99
 10517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10518
 10519
 10520 1046-READNEXT-ERACCT.
 10521
 10522
 10523* EXEC CICS READNEXT
 10524*         DATASET   ('ERACCT')
 10525*         RIDFLD    (ERACCT-KEY)
 10526*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10527*    END-EXEC.
 10528     MOVE 'ERACCT' TO DFHEIV1
 10529     MOVE 0
 10530       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 198
* EL156.cbl
 10531*    MOVE '&.S                   )   #00010127' TO DFHEIV0
 10532     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10533     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10534     MOVE X'2020233030303130313237' TO DFHEIV0(25:11)
 10535     CALL 'kxdfhei1' USING DFHEIV0,
 10536           DFHEIV1,
 10537           DFHEIV20,
 10538           DFHEIV99,
 10539           ERACCT-KEY,
 10540           DFHEIV99,
 10541           DFHEIV11,
 10542           DFHEIV99,
 10543           DFHEIV99
 10544     SET ADDRESS OF ACCOUNT-MASTER TO
 10545         DFHEIV20
 10546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10547
 10548
 10549     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10550        IF WS-ERACCT-HOLD-RECORD = SPACES
 10551           GO TO 1950-NOT-FOUND
 10552        ELSE
 10553           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10554           GO TO 1048-CONTINUE.
 10555
 10556     IF ACCT-EXP-DT = HIGH-VALUES
 10557        NEXT SENTENCE
 10558     ELSE
 10559        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10560        GO TO 1046-READNEXT-ERACCT.
 10561
 10562 1048-CONTINUE.
 10563
 10564*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10565*       MOVE 'Y'                 TO GROUPEDI
 10566*                                   PI-GROUPED
 10567*                                   WS-GROUPED
 10568*       MOVE AL-UANON            TO GROUPEDA.
 10569*************** CRI CODE END ******************
 10570
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 199
* EL156.cbl
 10572 1050-EDIT-CHECK-NO.
 10573
 10574     IF PI-OFFLINE = 'Y'
 10575         IF PI-ECHECKNO = SPACES
 10576              MOVE ER-0439        TO EMI-ERROR
 10577              GO TO 1090-CHECK-NO-ERROR
 10578           ELSE
 10579*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10580*           IF PI-ECHECKNO-N = 'N' AND
 10581*              PI-CASH       = 'Y'
 10582*                MOVE ER-3535        TO EMI-ERROR
 10583*                GO TO 1090-CHECK-NO-ERROR
 10584*             ELSE
 10585*                MOVE AL-UANON    TO CHECKNOA
 10586*                GO TO 1100-EDIT-HOLDTIL
 10587*         ELSE
 10588            MOVE AL-UANON    TO CHECKNOA
 10589            GO TO 1100-EDIT-HOLDTIL.
 10590
 10591     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10592     MOVE '6'                    TO CNTL-REC-TYPE.
 10593
 10594     IF CONTROL-IS-ACTUAL-CARRIER
 10595         MOVE PI-CARRIER         TO WS-CARR
 10596     ELSE
 10597         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10598
 10599     IF PI-COMPANY-ID = 'FIA'
 10600         MOVE PI-CARRIER         TO WS-CARR.
 10601
 10602     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10603     MOVE 0                      TO CNTL-SEQ-NO.
 10604     MOVE 'CARR'                 TO FILE-SWITCH.
 10605
 10606     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10607
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 200
* EL156.cbl
 10609     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10610         GO TO 1051-EDIT-CHECKNO-CONT.
 10611
 10612**********************AIG LOGIC STARTS**********************
 10613     IF PI-ECHECKNO = SPACES
 10614         IF CHECK-NO-MANUAL
 10615             MOVE ER-0441        TO EMI-ERROR
 10616             GO TO 1090-CHECK-NO-ERROR
 10617         ELSE
 10618             MOVE AL-UANOF       TO CHECKNOA
 10619             GO TO 1100-EDIT-HOLDTIL.
 10620
 10621     IF PI-ECHECKNO NOT = SPACES
 10622         IF CHECK-NO-MANUAL
 10623             MOVE AL-UANON       TO CHECKNOA
 10624             GO TO 1100-EDIT-HOLDTIL.
 10625
 10626     IF PI-ECHECKNO-CR = 'CR'
 10627        IF PI-OFFLINE = 'Y'
 10628            MOVE AL-UANON       TO CHECKNOA
 10629            GO TO 1100-EDIT-HOLDTIL
 10630        ELSE
 10631            MOVE ER-3534        TO EMI-ERROR
 10632            GO TO 1090-CHECK-NO-ERROR.
 10633
 10634     IF PI-ECHECKNO-N = 'N'
 10635        IF PI-CASH = 'N'
 10636            MOVE AL-UANON       TO CHECKNOA
 10637            GO TO 1100-EDIT-HOLDTIL
 10638        ELSE
 10639            MOVE ER-3535          TO EMI-ERROR
 10640            GO TO 1090-CHECK-NO-ERROR.
 10641
 10642     MOVE ER-0442        TO EMI-ERROR
 10643     GO TO 1090-CHECK-NO-ERROR.
 10644**********************AIG LOGIC ENDS************************
 10645
 10646 1051-EDIT-CHECKNO-CONT.
 10647
 10648     IF PI-COMPANY-ID = 'DMD'
 10649        IF PI-ECHECKNO NOT = SPACES
 10650           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10651              MOVE ER-0442        TO EMI-ERROR
 10652              GO TO 1090-CHECK-NO-ERROR
 10653            ELSE
 10654              GO TO 1100-EDIT-HOLDTIL
 10655          ELSE
 10656           GO TO 1100-EDIT-HOLDTIL.
 10657
 10658     IF PI-ECHECKNO = SPACES
 10659         IF CHECK-NO-MANUAL
 10660             MOVE ER-0441        TO EMI-ERROR
 10661             GO TO 1090-CHECK-NO-ERROR
 10662         ELSE
 10663             MOVE AL-UANOF       TO CHECKNOA
 10664             GO TO 1100-EDIT-HOLDTIL
 10665     ELSE
 10666         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 201
* EL156.cbl
 10667             MOVE AL-UANON       TO CHECKNOA
 10668             GO TO 1100-EDIT-HOLDTIL
 10669         ELSE
 10670             MOVE ER-0442        TO EMI-ERROR
 10671             GO TO 1090-CHECK-NO-ERROR.
 10672
 10673 1090-CHECK-NO-ERROR.
 10674     MOVE -1                     TO CHECKNOL.
 10675     MOVE AL-UABON               TO CHECKNOA.
 10676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10677
 10678     GO TO 2000-EDIT-DONE.
 10679
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 202
* EL156.cbl
 10681 1100-EDIT-HOLDTIL.
 10682     MOVE AL-UANON               TO HOLDTILA.
 10683
 10684     IF PI-HOLDTIL = ZEROS
 10685        IF PI-OFFLINE = 'Y'
 10686           MOVE ER-0572          TO EMI-ERROR
 10687           GO TO 1105-HOLDTIL-ERROR
 10688        ELSE
 10689           GO TO 1110-EDIT-PAID-FROM.
 10690
 10691     MOVE '4'                    TO DC-OPTION-CODE.
 10692     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10693     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10694
 10695     IF DATE-CONVERSION-ERROR
 10696         MOVE ER-0446            TO EMI-ERROR
 10697         GO TO 1105-HOLDTIL-ERROR
 10698     END-IF
 10699     IF PI-OFFLINE = 'Y'
 10700        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10701           MOVE ER-0446            TO EMI-ERROR
 10702           GO TO 1105-HOLDTIL-ERROR
 10703        END-IF
 10704     END-IF
 10705
 10706     IF PI-OFFLINE = 'Y'
 10707        GO TO 1110-EDIT-PAID-FROM.
 10708
 10709     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10710     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10711     MOVE '1'                    TO DC-OPTION-CODE.
 10712     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10713
 10714*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10715     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10716         MOVE ER-0447            TO EMI-ERROR
 10717         GO TO 1105-HOLDTIL-ERROR.
 10718
 10719     GO TO 1110-EDIT-PAID-FROM.
 10720
 10721 1105-HOLDTIL-ERROR.
 10722     MOVE -1                     TO HOLDTILL.
 10723     MOVE AL-UNBON               TO HOLDTILA.
 10724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10725
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 203
* EL156.cbl
 10727 1110-EDIT-PAID-FROM.
 10728     MOVE AL-UANON               TO EPYFROMA.
 10729
 10730     IF PI-EPYFROM = ZEROS
 10731         GO TO 1120-CALCULATE-PAID-FROM.
 10732
 10733     IF PI-PMTTYPE = '5' OR '6'
 10734         MOVE ER-0448            TO EMI-ERROR
 10735         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10736         MOVE AL-UNBON           TO EPYFROMA
 10737         MOVE -1                 TO EPYFROML
 10738         GO TO 1150-EDIT-PAID-THRU.
 10739
 10740     MOVE '4'                    TO DC-OPTION-CODE.
 10741     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10742     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10743
 10744     IF DATE-CONVERSION-ERROR
 10745         MOVE ER-0449            TO EMI-ERROR
 10746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10747         MOVE AL-UNBON           TO EPYFROMA
 10748         MOVE -1                 TO EPYFROML
 10749     ELSE
 10750         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10751
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 204
* EL156.cbl
 10753 1120-CALCULATE-PAID-FROM.
 10754     IF PI-PMTTYPE = '5' OR '6'
 10755         GO TO 1150-EDIT-PAID-THRU.
 10756
 10757*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10758*       IF PI-PMTTYPE = '4'
 10759*         GO TO 1150-EDIT-PAID-THRU.
 10760
 10761     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10762         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10763         MOVE ' '                TO DC-OPTION-CODE
 10764         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10765         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10766         GO TO 1145-TEST-PAID-FROM.
 10767
 10768     IF PI-PMTTYPE = '4'
 10769        GO TO 1150-EDIT-PAID-THRU.
 10770
 10771     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10772     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10773     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10774     MOVE '5'                    TO CNTL-REC-TYPE.
 10775     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10776     MOVE 'BENE'                 TO FILE-SWITCH.
 10777
 10778     IF WS-BEN-CD = ZEROS
 10779         GO TO 1950-NOT-FOUND.
 10780
 10781     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10782
 10783     IF NO-BENEFIT-FOUND
 10784         GO TO 1950-NOT-FOUND.
 10785
 10786     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10787     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10788
 10789     IF PI-BEN-DAYS NOT NUMERIC
 10790        MOVE ZEROS               TO PI-BEN-DAYS.
 10791
 10792     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10793
 10794     SET HOLD-UNTIL-CHK TO TRUE
 10795     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10796     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10797     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10798     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10799         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10800         MOVE '6'                 TO DC-OPTION-CODE
 10801         MOVE +0                  TO DC-ELAPSED-MONTHS
 10802         MOVE +1                  TO DC-ELAPSED-DAYS
 10803         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10804         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10805         GO TO 1145-TEST-PAID-FROM.
 10806
 10807     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10808        (CL-TOTAL-PAID-AMT > ZEROS)
 10809         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10810         MOVE '6'                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 205
* EL156.cbl
 10811         MOVE +0                  TO DC-ELAPSED-MONTHS
 10812         MOVE +1                  TO DC-ELAPSED-DAYS
 10813         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10814         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10815         GO TO 1145-TEST-PAID-FROM.
 10816
 10817******************************************************************
 10818****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10819****** SPECIAL ENTERED DATE.
 10820******************************************************************
 10821
 10822     IF PI-AIGFROM = ZEROS
 10823         GO TO 1130-CONTINUE-PAID-FROM.
 10824
 10825     MOVE AL-UANON TO AIGFROMA.
 10826
 10827     MOVE '4'                    TO DC-OPTION-CODE.
 10828     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10829     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10830
 10831     IF DATE-CONVERSION-ERROR
 10832         MOVE ER-0449            TO EMI-ERROR
 10833         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10834         MOVE AL-UNBON           TO AIGFROMA
 10835         MOVE -1                 TO AIGFROML
 10836         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10837     ELSE
 10838         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10839         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10840
 10841     GO TO 1140-CONTINUE-PAID-FROM.
 10842
 10843 1130-CONTINUE-PAID-FROM.
 10844
 10845     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10846        (CL-TOTAL-PAID-AMT = ZEROS)
 10847           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10848
 10849 1140-CONTINUE-PAID-FROM.
 10850
 10851     IF PI-BEN-TYPE = 'R'
 10852         IF PI-BEN-DAYS = ZEROS
 10853             NEXT SENTENCE
 10854         ELSE
 10855         IF PI-COMPANY-ID NOT = 'DMD'
 10856             SUBTRACT 1 FROM PI-BEN-DAYS.
 10857
 10858     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10859
 10860     IF PI-COMPANY-ID = 'DMD'
 10861         MOVE -1                 TO DC-ELAPSED-DAYS
 10862         MOVE +0                 TO DC-ELAPSED-MONTHS
 10863         MOVE '6'                TO DC-OPTION-CODE
 10864         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10865         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10866         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10867                               REMAINDER DC-ELAPSED-DAYS
 10868      ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 206
* EL156.cbl
 10869         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10870         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10871
 10872     MOVE '6'                    TO DC-OPTION-CODE.
 10873     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10874     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10875
 10876     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10877
 10878     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10879         MOVE ER-0541            TO EMI-ERROR
 10880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10881         MOVE -1                 TO EPYFROML
 10882         MOVE AL-UNBON           TO EPYFROMA.
 10883
 10884     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10885        (PI-BENEFIT-SAVE = '60E')
 10886        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10887           (CL-TOTAL-PAID-AMT = ZEROS)
 10888             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10889             MOVE 30                  TO DC-ELAPSED-DAYS
 10890             MOVE +0                  TO DC-ELAPSED-MONTHS
 10891             MOVE '6'                 TO DC-OPTION-CODE
 10892             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10893
 10894     IF PI-BEN-TYPE = 'R'
 10895         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10896     ELSE
 10897         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10898         IF WS-SV-EPYFROM = LOW-VALUES
 10899            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10900
 10901     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10902         IF WS-USE-AIG-PAYFROM   OR
 10903            WS-AIG-RECALC-PAYFROM
 10904              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10905                                      DC-BIN-DATE-1
 10906              MOVE ' '            TO  DC-OPTION-CODE
 10907              MOVE +0             TO  DC-ELAPSED-MONTHS
 10908                                      DC-ELAPSED-DAYS
 10909              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10910              IF NO-CONVERSION-ERROR
 10911                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10912
 10913     IF PI-CPYFROM < CL-INCURRED-DT
 10914        MOVE -1                  TO EPYFROML
 10915        MOVE ER-3542             TO EMI-ERROR
 10916        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10917
 10918     IF CM-ENTRY-DT < CL-INCURRED-DT
 10919        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10920        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10921        MOVE +0                     TO DC-ELAPSED-DAYS
 10922        MOVE +0                     TO DC-ELAPSED-MONTHS
 10923        MOVE '1'                    TO DC-OPTION-CODE
 10924        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10925        ELSE
 10926        MOVE ZEROS TO DC-ELAPSED-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 207
* EL156.cbl
 10927
 10928     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10929         NEXT SENTENCE
 10930     ELSE
 10931         IF DC-ELAPSED-MONTHS < 2
 10932             MOVE ER-3255        TO EMI-ERROR
 10933             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10934
 10935 1145-TEST-PAID-FROM.
 10936     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10937         GO TO 1150-EDIT-PAID-THRU.
 10938
 10939     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10940         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10941         MOVE ' '                TO DC-OPTION-CODE
 10942         MOVE +0                 TO DC-ELAPSED-MONTHS
 10943                                    DC-ELAPSED-DAYS
 10944         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10945         IF NO-CONVERSION-ERROR
 10946             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10947         ELSE
 10948             MOVE SPACES             TO EMI-DATE-FIELD.
 10949
 10950     IF PI-HOLDTIL NOT = ZEROS
 10951        CONTINUE
 10952     ELSE
 10953     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10954         IF CL-TOTAL-PAID-AMT = ZEROS
 10955             MOVE ER-3543            TO EMI-ERROR
 10956             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10957             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10958             IF EMI-MESSAGE-FORMATTED
 10959                MOVE -1             TO EPYFROML
 10960                MOVE AL-UNBON       TO EPYFROMA
 10961             ELSE
 10962                NEXT SENTENCE
 10963         ELSE
 10964             MOVE ER-0452            TO EMI-ERROR
 10965             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10966             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10967             IF EMI-MESSAGE-FORMATTED
 10968                MOVE -1             TO EPYFROML
 10969                MOVE AL-UNBON       TO EPYFROMA.
 10970
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 208
* EL156.cbl
 10972 1150-EDIT-PAID-THRU.
 10973
 10974     MOVE AL-UANON               TO EPYTHRUA.
 10975
 10976     IF PI-EPYTHRU = ZEROS
 10977*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10978         IF PI-PMTTYPE = '5' OR '6'
 10979           OR (CL-CLAIM-TYPE NOT = 'L' AND 'O'
 10980             AND PI-PMTTYPE = '4')
 10981             GO TO 1200-EDIT-FIND-TOLERANCES
 10982         ELSE
 10983            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 10984               (PI-PMTTYPE = '2' AND
 10985                 CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 10986               GO TO 1152-CHECK-TYPE
 10987            ELSE
 10988               MOVE ER-0473      TO EMI-ERROR
 10989               GO TO 1170-PAID-THRU-FATAL-ERROR
 10990     ELSE
 10991         IF PI-PMTTYPE = '5' OR '6'
 10992             MOVE ER-0474        TO EMI-ERROR
 10993             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10994
 10995     MOVE '4'                    TO DC-OPTION-CODE.
 10996     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10997     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10998
 10999     IF DATE-CONVERSION-ERROR
 11000         MOVE ER-0475            TO EMI-ERROR
 11001         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11002
 11003     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 11004
 11005     IF PI-COMPANY-ID = 'DMD'
 11006         IF PI-PMTTYPE NOT = '2'
 11007                 AND
 11008            WS-EXP-DT > WS-SV-EPYTHRU
 11009             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 11010             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 11011             MOVE '1'              TO DC-OPTION-CODE
 11012             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11013             IF DATE-CONVERSION-ERROR
 11014                 MOVE ER-0944      TO EMI-ERROR
 11015                 GO TO 1170-PAID-THRU-FATAL-ERROR
 11016             ELSE
 11017                 IF DC-ELAPSED-MONTHS = ZEROS AND
 11018                    DC-ELAPSED-DAYS   = 1
 11019                     MOVE ER-0945  TO EMI-ERROR
 11020                     MOVE -1       TO EPYTHRUL
 11021                     MOVE AL-UABON TO EPYTHRUA
 11022                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11023
 11024     IF PI-PMTTYPE = '4'
 11025         NEXT SENTENCE
 11026     ELSE
 11027         IF WS-SV-EPYTHRU = WS-EXP-DT
 11028             IF PI-PMTTYPE NOT = '2' AND '3'
 11029                 MOVE ER-3541    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 209
* EL156.cbl
 11030                 MOVE -1         TO PMTTYPEL
 11031                 MOVE AL-UABON   TO PMTTYPEA
 11032                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11033
 11034     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 11035         MOVE ER-0501            TO EMI-ERROR
 11036         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11037
 11038     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 11039        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 11040*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11041*              MOVE ER-0540         TO EMI-ERROR
 11042*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11043*              MOVE -1              TO EPYTHRUL
 11044*              MOVE AL-UNBON        TO EPYTHRUA
 11045*          ELSE
 11046*          IF PI-COMPANY-ID = 'DMD'
 11047*              MOVE ER-7540         TO EMI-ERROR
 11048*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11049*              MOVE -1              TO EPYTHRUL
 11050*              MOVE AL-UNBON        TO EPYTHRUA
 11051*          ELSE
 11052               IF PI-PMTTYPE NOT = '2' AND '3'
 11053                  IF PI-COMPANY-ID = '???'
 11054                      MOVE ER-7540  TO EMI-ERROR
 11055                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11056                      MOVE -1       TO EPYTHRUL
 11057                      MOVE AL-UNBON TO EPYTHRUA
 11058                  ELSE
 11059                      MOVE ER-0540  TO EMI-ERROR
 11060                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11061                      MOVE -1       TO EPYTHRUL
 11062                      MOVE AL-UNBON TO EPYTHRUA.
 11063
 11064     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11065            OR
 11066        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11067         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11068            OR
 11069        (PI-CPYFROM NOT = LOW-VALUES AND
 11070         PI-CPYFROM < CL-PAID-THRU-DT)
 11071        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11072
 11073 1152-CHECK-TYPE.
 11074     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11075        OR (PI-PMTTYPE = '5' OR '6')
 11076         GO TO 1160-EDIT-PAID-THRU-AH.
 11077
 11078 1155-EDIT-PAID-THRU-LIFE.
 11079     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11080     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11081     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11082     MOVE '4'                    TO CNTL-REC-TYPE.
 11083     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11084     MOVE 'BENE'                 TO FILE-SWITCH.
 11085
 11086     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11087
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 210
* EL156.cbl
 11088     IF NO-BENEFIT-FOUND
 11089         GO TO 1950-NOT-FOUND.
 11090
 11091     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11092
 11093     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11094
 11095     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11096        PI-LF-COVERAGE-TYPE = 'P'
 11097         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11098         GO TO 1200-EDIT-FIND-TOLERANCES.
 11099
 11100     IF PI-EPYTHRU = ZEROS
 11101        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11102
 11103     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11104         MOVE ER-0476            TO EMI-ERROR
 11105         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11106
 11107     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11108*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11109     move cl-critical-period    to dc-elapsed-months
 11110     MOVE +0                    TO DC-ELAPSED-DAYS.
 11111     MOVE '6'                   TO DC-OPTION-CODE.
 11112     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11113
 11114     IF (NO-CONVERSION-ERROR AND
 11115         WS-SPECIAL-CALC-CD = 'C')
 11116        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11117            MOVE ER-0657 TO EMI-ERROR
 11118            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11119
 11120     IF PI-COMPANY-ID = 'NCL'
 11121         IF WS-SPECIAL-CALC-CD = 'C' AND
 11122            cl-critical-period = zeros
 11123*           CM-LF-CRITICAL-PERIOD = +0
 11124             MOVE ER-0844       TO EMI-ERROR
 11125             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11126
 11127     GO TO 1200-EDIT-FIND-TOLERANCES.
 11128
 11129 1160-EDIT-PAID-THRU-AH.
 11130     IF PI-EPYTHRU = ZEROS
 11131        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11132                                    WS-SV-EPYTHRU
 11133     ELSE
 11134        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11135
 11136     IF WS-SV-EPYTHRU < PI-CPYFROM
 11137         MOVE ER-0508            TO EMI-ERROR
 11138         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11139
 11140     perform 7975-read-acct      thru 7975-exit
 11141     move zeros                  to pi-max-ext
 11142     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11143        PERFORM 0900-GET-DDF-LIMITS
 11144                                 THRU 0900-EXIT
 11145        IF PDEF-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 211
* EL156.cbl
 11146           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11147              (P1 > +8)
 11148              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11149           END-PERFORM
 11150           IF P1 < +9
 11151              MOVE PD-MAX-extension (P1)
 11152                                 TO pi-max-ext
 11153           else
 11154              move er-1674       to emi-error
 11155              PERFORM 9900-ERROR-FORMAT
 11156                                 THRU 9900-EXIT
 11157           END-IF
 11158        else
 11159           move er-1672          to emi-error
 11160           PERFORM 9900-ERROR-FORMAT
 11161                                 THRU 9900-EXIT
 11162        END-IF
 11163     end-if
 11164     move spaces                 to pi-max-ext-used
 11165     IF PI-PMTTYPE = '3'
 11166        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11167        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11168           MOVE ER-0477          TO EMI-ERROR
 11169           PERFORM 1165-PAID-THRU-ERROR
 11170                                 THRU 1165-EXIT
 11171        ELSE
 11172           continue
 11173        end-if
 11174     ELSE
 11175        IF WS-SV-EPYTHRU > WS-EXP-DT
 11176         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11177           move ws-exp-dt        to dc-bin-date-1
 11178           move ws-sv-epythru    to dc-bin-date-2
 11179           MOVE '1'              TO DC-OPTION-CODE
 11180           MOVE +0               TO DC-ELAPSED-DAYS
 11181                                    DC-ELAPSED-MONTHS
 11182           PERFORM 9700-LINK-DATE-CONVERT
 11183                                 THRU 9700-EXIT
 11184           if no-conversion-error
 11185              if dc-elapsed-days > zeros
 11186                 add +1 to dc-elapsed-months
 11187              end-if
 11188              if dc-elapsed-months > pi-max-ext
 11189                 MOVE ER-0557    TO EMI-ERROR
 11190                 PERFORM 1165-PAID-THRU-ERROR
 11191                                 THRU 1165-EXIT
 11192              else
 11193                 move 'Y'        to pi-max-ext-used
 11194                 move er-1670    to emi-error
 11195                 perform 9900-error-format
 11196                                 thru 9900-exit
 11197              end-if
 11198           end-if
 11199         ELSE
 11200            MOVE ER-0557    TO EMI-ERROR
 11201            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11202         END-IF
 11203        end-if
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 212
* EL156.cbl
 11204     end-if
 11205
 11206     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11207         PI-PMTTYPE NOT = '3'
 11208         MOVE ER-0541        TO EMI-ERROR
 11209         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11210
 11211     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11212        (PI-PMTTYPE NOT = '3')
 11213         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11214             MOVE ER-0478        TO EMI-ERROR
 11215             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11216
 11217     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11218        (PI-PMTTYPE NOT = '4')
 11219         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11220             MOVE ER-0479        TO EMI-ERROR
 11221             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11222
 11223     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11224         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11225             MOVE ER-0545        TO EMI-ERROR
 11226             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11227
 11228     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11229         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11230             MOVE ER-0481        TO EMI-ERROR
 11231             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11232
 11233*    IF PI-COMPANY-ID = 'NCL'
 11234*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11235*           CM-AH-CRITICAL-PERIOD = +0
 11236*            MOVE ER-0844        TO  EMI-ERROR
 11237*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11238
 11239*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11240     if (cl-critical-period = zeros)
 11241        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11242          GO TO 1200-EDIT-FIND-TOLERANCES.
 11243
 11244     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11245     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11246     MOVE '1'        TO DC-OPTION-CODE.
 11247     MOVE +0         TO DC-ELAPSED-DAYS
 11248                        DC-ELAPSED-MONTHS.
 11249     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11250
 11251*    IF NO-CONVERSION-ERROR
 11252*       COMPUTE ws-benefits-paid =
 11253*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11254*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11255*           MOVE ER-0657 TO EMI-ERROR
 11256*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11257
 11258     GO TO 1200-EDIT-FIND-TOLERANCES.
 11259
 11260 1165-PAID-THRU-ERROR.
 11261     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 213
* EL156.cbl
 11262
 11263     IF EMI-MESSAGE-FORMATTED
 11264         MOVE -1                 TO EPYTHRUL
 11265         MOVE AL-UNBON           TO EPYTHRUA.
 11266
 11267 1165-EXIT.
 11268     EXIT.
 11269
 11270 1166-CHECK-ALL-TRLRS.
 11271
 11272     IF PI-PMTTYPE = '4'
 11273        GO TO 1166-TRLR-EXIT.
 11274
 11275     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11276
 11277     IF HOLD-UNTIL-CHK
 11278        CONTINUE
 11279     ELSE
 11280     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11281        WS-SV-EPYFROM = LOW-VALUES
 11282          GO TO 1166-END-CHECK.
 11283
 11284
 11285* EXEC CICS HANDLE CONDITION
 11286*        ENDFILE   (1166-END-CHECK)
 11287*        NOTFND    (1166-END-CHECK)
 11288*    END-EXEC.
 11289*    MOVE '"$''I                  ! ) #00010868' TO DFHEIV0
 11290     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11292     MOVE X'2920233030303130383638' TO DFHEIV0(25:11)
 11293     CALL 'kxdfhei1' USING DFHEIV0
 11294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11295
 11296
 11297     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11298     MOVE +100                   TO TRLR-SEQ-NO.
 11299
 11300
 11301* EXEC CICS STARTBR
 11302*         DATASET    ('ELTRLR')
 11303*         RIDFLD     (ELTRLR-KEY)
 11304*         GTEQ
 11305*    END-EXEC.
 11306     MOVE 'ELTRLR' TO DFHEIV1
 11307     MOVE 0
 11308       TO DFHEIV11
 11309*    MOVE '&,         G          &   #00010876' TO DFHEIV0
 11310     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11311     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11312     MOVE X'2020233030303130383736' TO DFHEIV0(25:11)
 11313     CALL 'kxdfhei1' USING DFHEIV0,
 11314           DFHEIV1,
 11315           ELTRLR-KEY,
 11316           DFHEIV99,
 11317           DFHEIV11,
 11318           DFHEIV99
 11319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 214
* EL156.cbl
 11320
 11321
 11322     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11323
 11324 1166-READ-TRLR-NEXT.
 11325
 11326
 11327* EXEC CICS READNEXT
 11328*         DATASET    ('ELTRLR')
 11329*         RIDFLD     (ELTRLR-KEY)
 11330*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11331*    END-EXEC.
 11332     MOVE 'ELTRLR' TO DFHEIV1
 11333     MOVE 0
 11334       TO DFHEIV11
 11335*    MOVE '&.S                   )   #00010886' TO DFHEIV0
 11336     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11337     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11338     MOVE X'2020233030303130383836' TO DFHEIV0(25:11)
 11339     CALL 'kxdfhei1' USING DFHEIV0,
 11340           DFHEIV1,
 11341           DFHEIV20,
 11342           DFHEIV99,
 11343           ELTRLR-KEY,
 11344           DFHEIV99,
 11345           DFHEIV11,
 11346           DFHEIV99,
 11347           DFHEIV99
 11348     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11349         DFHEIV20
 11350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11351
 11352
 11353     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11354        TRLR-CARRIER  = MSTR-CARRIER  AND
 11355        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11356        TRLR-CERT-NO  = MSTR-CERT-NO
 11357          NEXT SENTENCE
 11358      ELSE
 11359          GO TO 1166-END-CHECK.
 11360
 11361* **  BYPASS ALL NON-PAYMENT TRAILERS
 11362
 11363     IF AT-TRAILER-TYPE = '2'
 11364        NEXT SENTENCE
 11365     ELSE
 11366        GO TO 1166-READ-TRLR-NEXT.
 11367
 11368* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11369
 11370     IF AT-PAYMENT-TYPE = '1' OR '2'
 11371        NEXT SENTENCE
 11372     ELSE
 11373        GO TO 1166-READ-TRLR-NEXT.
 11374
 11375* **  BYPASS ALL VOID PAYMENTS
 11376
 11377     IF AT-VOID-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 215
* EL156.cbl
 11378        GO TO 1166-READ-TRLR-NEXT.
 11379
 11380     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11381        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11382          GO TO 1166-READ-TRLR-NEXT.
 11383     IF HOLD-UNTIL-CHK
 11384        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11385          AND AT-TO-BE-WRITTEN-DT > ZERO
 11386           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11387        END-IF
 11388     END-IF
 11389
 11390     IF HOLD-UNTIL-CHK
 11391        CONTINUE
 11392     ELSE
 11393     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11394         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11395            OR
 11396        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11397         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11398        NEXT SENTENCE
 11399     ELSE
 11400         IF CL-TOTAL-PAID-AMT > ZEROS
 11401             MOVE ER-0502            TO EMI-ERROR
 11402             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11403             MOVE -1                 TO EPYTHRUL
 11404             MOVE AL-UNBON           TO EPYTHRUA.
 11405
 11406     GO TO 1166-READ-TRLR-NEXT.
 11407
 11408 1166-END-CHECK.
 11409
 11410     IF WS-BROWSE-TRLR-SW = 'Y'
 11411
 11412* EXEC CICS ENDBR
 11413*            DATASET   ('ELTRLR')
 11414*       END-EXEC.
 11415     MOVE 'ELTRLR' TO DFHEIV1
 11416     MOVE 0
 11417       TO DFHEIV11
 11418*    MOVE '&2                    $   #00010950' TO DFHEIV0
 11419     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11420     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11421     MOVE X'2020233030303130393530' TO DFHEIV0(25:11)
 11422     CALL 'kxdfhei1' USING DFHEIV0,
 11423           DFHEIV1,
 11424           DFHEIV11,
 11425           DFHEIV99
 11426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11427
 11428
 11429     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11430
 11431 1166-TRLR-EXIT.
 11432     EXIT.
 11433
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 216
* EL156.cbl
 11435 1170-PAID-THRU-FATAL-ERROR.
 11436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11437
 11438     MOVE -1                     TO EPYTHRUL.
 11439     MOVE AL-UNBON               TO EPYTHRUA.
 11440
 11441 1200-EDIT-FIND-TOLERANCES.
 11442
 11443* EXEC CICS HANDLE CONDITION
 11444*        ENDFILE(1950-NOT-FOUND)
 11445*        NOTFND (1950-NOT-FOUND)
 11446*    END-EXEC.
 11447*    MOVE '"$''I                  ! * #00010967' TO DFHEIV0
 11448     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11450     MOVE X'2A20233030303130393637' TO DFHEIV0(25:11)
 11451     CALL 'kxdfhei1' USING DFHEIV0
 11452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11453
 11454
 11455     IF PI-PROCESSOR-ID = 'LGXX'
 11456        GO TO 1240-FIND-ACCT-TOLERANCES.
 11457
 11458     MOVE 'N'                    TO FOUND-TOL-SW.
 11459     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11460     MOVE '2'                    TO CNTL-REC-TYPE.
 11461     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11462     MOVE +0                     TO CNTL-SEQ-NO.
 11463     MOVE 'PROC'                 TO FILE-SWITCH.
 11464
 11465     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11466
 11467     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11468     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11469                                    PI-MAX-PMT-TOL.
 11470     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11471
 11472     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11473         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11474
 11475     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11476     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11477                                    PI-MAX-LF-PMT-TOL.
 11478
 11479     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11480         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11481
 11482     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11483                                    PI-MAX-EXP-PMT.
 11484
 11485 1240-FIND-ACCT-TOLERANCES.
 11486
 11487     IF WS-PMT-TOL NOT = +0
 11488         MOVE 'Y'                TO FOUND-TOL-SW.
 11489
 11490     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11491         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11492         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 217
* EL156.cbl
 11493         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11494         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11495         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11496         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11497     ELSE
 11498         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11499         MOVE PI-CARRIER             TO ACCT-CARRIER
 11500         MOVE PI-GROUPING            TO ACCT-GROUPING
 11501         MOVE PI-STATE               TO ACCT-STATE
 11502         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11503         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11504
 11505     MOVE 'ACCT'                 TO FILE-SWITCH.
 11506
 11507     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11508     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11509
 11510
 11511* EXEC CICS HANDLE CONDITION
 11512*         NOTFND   (1950-NOT-FOUND)
 11513*         ENDFILE  (1950-NOT-FOUND)
 11514*    END-EXEC.
 11515*    MOVE '"$I''                  ! + #00011027' TO DFHEIV0
 11516     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11518     MOVE X'2B20233030303131303237' TO DFHEIV0(25:11)
 11519     CALL 'kxdfhei1' USING DFHEIV0
 11520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11521
 11522
 11523
 11524* EXEC CICS STARTBR
 11525*        DATASET('ERACCT')
 11526*        RIDFLD (ERACCT-KEY)
 11527*        GTEQ
 11528*    END-EXEC.
 11529     MOVE 'ERACCT' TO DFHEIV1
 11530     MOVE 0
 11531       TO DFHEIV11
 11532*    MOVE '&,         G          &   #00011032' TO DFHEIV0
 11533     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11534     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11535     MOVE X'2020233030303131303332' TO DFHEIV0(25:11)
 11536     CALL 'kxdfhei1' USING DFHEIV0,
 11537           DFHEIV1,
 11538           ERACCT-KEY,
 11539           DFHEIV99,
 11540           DFHEIV11,
 11541           DFHEIV99
 11542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11543
 11544
 11545 1245-FIND-ACCT-TOLERANCES-LOOP.
 11546
 11547
 11548* EXEC CICS READNEXT
 11549*        DATASET('ERACCT')
 11550*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 218
* EL156.cbl
 11551*        RIDFLD (ERACCT-KEY)
 11552*    END-EXEC.
 11553     MOVE 'ERACCT' TO DFHEIV1
 11554     MOVE 0
 11555       TO DFHEIV11
 11556*    MOVE '&.S                   )   #00011040' TO DFHEIV0
 11557     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11558     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11559     MOVE X'2020233030303131303430' TO DFHEIV0(25:11)
 11560     CALL 'kxdfhei1' USING DFHEIV0,
 11561           DFHEIV1,
 11562           DFHEIV20,
 11563           DFHEIV99,
 11564           ERACCT-KEY,
 11565           DFHEIV99,
 11566           DFHEIV11,
 11567           DFHEIV99,
 11568           DFHEIV99
 11569     SET ADDRESS OF ACCOUNT-MASTER TO
 11570         DFHEIV20
 11571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11572
 11573
 11574     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11575        IF WS-ERACCT-HOLD-RECORD = SPACES
 11576           GO TO 1950-NOT-FOUND
 11577        ELSE
 11578           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11579           GO TO 1250-CONTINUE.
 11580
 11581     IF ACCT-EXP-DT = HIGH-VALUES
 11582        NEXT SENTENCE
 11583     ELSE
 11584        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11585        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11586
 11587 1250-CONTINUE.
 11588
 11589     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11590
 11591     IF FOUND-TOL-SW = 'N'
 11592         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11593
 11594********* 1260-FIND-STATE-TOLERANCES.
 11595
 11596     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11597     MOVE PI-STATE               TO WS-ST-ACCESS.
 11598     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11599     MOVE '3'                    TO CNTL-REC-TYPE.
 11600     MOVE +0                     TO CNTL-SEQ-NO.
 11601     MOVE 'STAT'                 TO FILE-SWITCH.
 11602
 11603     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11604
 11605     IF WS-PMT-TOL = +0
 11606         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11607
 11608     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 219
* EL156.cbl
 11609     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11610     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11611     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11612     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11613
 11614****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11615****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11616     IF PI-PAYEE-TYPE <> 'B'
 11617           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11618     END-IF.
 11619
 11620     IF PI-PMTTYPE      = '2'  AND
 11621        PI-SPLIT-PMT-SW = 'Y'  AND
 11622        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 11623          MOVE ER-3530                TO EMI-ERROR
 11624          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11625
 11626********* 1280-FIND-BENEFIT-TOLERANCES.
 11627
 11628     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11629        OR (PI-PMTTYPE = '5' OR '6')
 11630         GO TO 1300-FIND-CARR-TOLERANCES.
 11631
 11632     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11633     MOVE '4'                    TO CNTL-REC-TYPE.
 11634     MOVE +0                     TO CNTL-SEQ-NO.
 11635     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11636     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11637     MOVE 'BENE'                 TO FILE-SWITCH.
 11638
 11639     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11640
 11641     IF NO-BENEFIT-FOUND
 11642         GO TO 1950-NOT-FOUND.
 11643
 11644     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11645     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11646     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11647
 11648
 11649* EXEC CICS HANDLE CONDITION
 11650*        NOTFND(1950-NOT-FOUND)
 11651*    END-EXEC.
 11652*    MOVE '"$I                   ! , #00011120' TO DFHEIV0
 11653     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11655     MOVE X'2C20233030303131313230' TO DFHEIV0(25:11)
 11656     CALL 'kxdfhei1' USING DFHEIV0
 11657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11658
 11659
 11660 1300-FIND-CARR-TOLERANCES.
 11661     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11662     MOVE '6'                    TO CNTL-REC-TYPE.
 11663
 11664     IF CONTROL-IS-ACTUAL-CARRIER
 11665         MOVE PI-CARRIER               TO WS-CARR
 11666     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 220
* EL156.cbl
 11667         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11668
 11669     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11670     MOVE +0                     TO CNTL-SEQ-NO.
 11671     MOVE 'CARR'                 TO FILE-SWITCH.
 11672
 11673     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11674
 11675     IF WS-DAYS-TOL = +0
 11676         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11677
 11678     IF WS-PMT-TOL = +0
 11679         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11680
 11681     IF WS-MAX-DAYS-TOL = +0
 11682         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11683
 11684     IF WS-MAX-PMT-TOL = +0
 11685         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11686                                    PI-MAX-PMT-TOL.
 11687
 11688     IF WS-MAX-LF-PMT-TOL = +0
 11689        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11690                                    PI-MAX-LF-PMT-TOL.
 11691
 11692     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11693
 11694********* 1320-FIND-COMP-TOLERANCES.
 11695
 11696     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11697     MOVE '1'                    TO CNTL-REC-TYPE.
 11698     MOVE SPACES                 TO CNTL-ACCESS.
 11699     MOVE +0                     TO CNTL-SEQ-NO.
 11700     MOVE 'COMP'                 TO FILE-SWITCH.
 11701
 11702     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11703
 11704     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11705     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11706
 11707     IF WS-PMT-TOL NOT = +0
 11708        IF WS-TOL-SEVERITY NOT = ' '
 11709         GO TO 1360-EDIT-DAYS.
 11710
 11711     IF WS-PMT-TOL = +0
 11712         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11713
 11714     IF WS-TOL-SEVERITY = ' '
 11715         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11716
 11717 1360-EDIT-DAYS.
 11718     IF PI-PMTTYPE NOT = '4'
 11719        IF PI-EDAYS NEGATIVE OR
 11720           PI-EPYAMT NEGATIVE
 11721          MOVE ER-0513             TO EMI-ERROR
 11722          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11723          MOVE -1                  TO PMTTYPEL.
 11724
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 221
* EL156.cbl
 11725     IF PI-PMTTYPE = '5' OR '6'
 11726        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11727
 11728     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11729        IF PI-PMTTYPE = '4'
 11730          MOVE PI-EDAYS          TO PI-CDAYS.
 11731
 11732     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 11733         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11734
 11735     IF PI-PMTTYPE = '4'
 11736        MOVE PI-EDAYS            TO PI-CDAYS
 11737        GO TO 1400-EDIT-PAYMENT.
 11738
 11739     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11740        GO TO 1500-EDIT-EXPENSES.
 11741
 11742*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11743*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11744*          CM-AH-BENEFIT-CD = '23'              AND
 11745*          CL-CERT-STATE    = '04'              AND
 11746*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11747*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11748*            GO TO 1362-CHECK-MAX-DAYS.
 11749
 11750     IF PI-EDAYS = ZEROS
 11751*        IF PI-COMPANY-ID = 'DMD'
 11752*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11753*            MOVE -1             TO DC-ELAPSED-DAYS
 11754*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11755*            MOVE '6'            TO DC-OPTION-CODE
 11756*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11757*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11758*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11759*            MOVE '1'            TO DC-OPTION-CODE
 11760*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11761*            IF NO-CONVERSION-ERROR
 11762*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11763*                                 + DC-ODD-DAYS-OVER
 11764*               MOVE 6           TO EDAYSL
 11765*               MOVE AL-UNNON    TO EDAYSA
 11766*            ELSE
 11767*                NEXT SENTENCE
 11768*       ELSE
 11769            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11770            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11771            MOVE '1'             TO DC-OPTION-CODE
 11772            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11773            IF NO-CONVERSION-ERROR
 11774                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11775                ADD 1                 TO PI-EDAYS
 11776                MOVE AL-UNNON         TO EDAYSA.
 11777
 11778*    IF PI-COMPANY-ID = 'DMD'
 11779*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11780*        MOVE -1                 TO DC-ELAPSED-DAYS
 11781*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11782*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 222
* EL156.cbl
 11783*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11784*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11785*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11786*        MOVE '1'                TO DC-OPTION-CODE
 11787*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11788*    ELSE
 11789         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11790         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11791         MOVE '1'                TO DC-OPTION-CODE.
 11792         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11793
 11794     IF NO-CONVERSION-ERROR
 11795        IF PI-COMPANY-ID = 'DMD'
 11796            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11797                             + DC-ODD-DAYS-OVER
 11798        ELSE
 11799            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11800            ADD 1                TO PI-CDAYS.
 11801
 11802     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11803        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11804        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11805
 11806     IF PI-EDAYS NOT NUMERIC
 11807         MOVE ER-0491            TO EMI-ERROR
 11808         GO TO 1370-DAYS-ERROR.
 11809
 11810     IF CL-NO-OF-PMTS-MADE = 0
 11811        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11812        AND CL-CERT-STATE = 'MI'
 11813        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11814            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11815     END-IF.
 11816
 11817 1362-CHECK-MAX-DAYS.
 11818
 11819     IF WS-MAX-DAYS-TOL = +999
 11820         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11821
 11822     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11823         IF PI-EDAYS = ZEROS
 11824             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11825         ELSE
 11826             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11827
 11828     IF WS-MAX-DAYS-TOL NOT = ZERO
 11829        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11830           PI-CDAYS > WS-MAX-DAYS-TOL
 11831             MOVE ER-0492          TO EMI-ERROR
 11832             GO TO 1370-DAYS-ERROR.
 11833
 11834 1365-SKIP-MAX-DAYS-EDIT.
 11835     IF PI-EDAYS = ZEROS
 11836        GO TO 1400-EDIT-PAYMENT.
 11837
 11838     IF WS-DAYS-TOL NOT = ZERO
 11839        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11840           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 223
* EL156.cbl
 11841                MOVE ER-0493     TO EMI-ERROR
 11842                GO TO 1370-DAYS-ERROR.
 11843
 11844     GO TO 1400-EDIT-PAYMENT.
 11845
 11846 1370-DAYS-ERROR.
 11847     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11848
 11849     IF EMI-MESSAGE-FORMATTED
 11850         MOVE -1                 TO EDAYSL
 11851         MOVE AL-UABON           TO EDAYSA.
 11852
 11853     GO TO 1400-EDIT-PAYMENT.
 11854
 11855 1380-EDIT-EXPENSE-PMT-AMT.
 11856     IF PI-PMTTYPE = '5' OR '6'
 11857         NEXT SENTENCE
 11858     ELSE
 11859         GO TO 1400-EDIT-PAYMENT.
 11860
 11861     IF WS-MAX-EXP-PMT NOT = ZEROS
 11862        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11863            MOVE ER-3529            TO EMI-ERROR
 11864            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11865
 11866     GO TO 1500-EDIT-EXPENSES.
 11867
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 224
* EL156.cbl
 11869
 11870 1390-CHECK-PAYMENT-DAYS.
 11871
 11872     IF PI-EDAYS = 0
 11873         MOVE PI-CDAYS TO WS-PD-DAYS
 11874     ELSE
 11875         MOVE PI-EDAYS TO WS-PD-DAYS
 11876     END-IF.
 11877
 11878     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11879         IF WS-PD-DAYS = 14
 11880            GO TO 1390-EXIT
 11881         END-IF
 11882     END-IF.
 11883
 11884     IF PI-COMPANY-ID = 'AHL'  AND
 11885        CM-AH-BENEFIT-CD = '1K'
 11886         IF WS-PD-DAYS = 14
 11887            GO TO 1390-EXIT
 11888         END-IF
 11889     END-IF.
 11890
 11891     IF WS-PD-DAYS < 30
 11892         MOVE ER-3549              TO EMI-ERROR
 11893         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11894     END-IF.
 11895
 11896 1390-EXIT.
 11897      EXIT.
 11898
 11899 1400-EDIT-PAYMENT.
 11900*    IF PI-COMPANY-ID = 'DMD'
 11901*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11902*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11903
 11904     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 11905        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11906        MOVE PI-CARRIER          TO ACCT-CARRIER
 11907        MOVE PI-GROUPING         TO ACCT-GROUPING
 11908        MOVE PI-STATE            TO ACCT-STATE
 11909        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11910        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11911        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11912        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11913
 11914
 11915* EXEC CICS READ
 11916*          DATASET ('ERACCT')
 11917*          RIDFLD  (ERACCT-KEY)
 11918*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11919*          GTEQ
 11920*          resp    (WS-RESPONSE)
 11921*       END-EXEC
 11922     MOVE 'ERACCT' TO DFHEIV1
 11923*    MOVE '&"S        G          (  N#00011378' TO DFHEIV0
 11924     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11926     MOVE X'204E233030303131333738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 225
* EL156.cbl
 11927     CALL 'kxdfhei1' USING DFHEIV0,
 11928           DFHEIV1,
 11929           DFHEIV20,
 11930           DFHEIV99,
 11931           ERACCT-KEY,
 11932           DFHEIV99,
 11933           DFHEIV99,
 11934           DFHEIV99
 11935     SET ADDRESS OF ACCOUNT-MASTER TO
 11936         DFHEIV20
 11937     MOVE EIBRESP  TO WS-RESPONSE
 11938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11939        IF WS-RESP-NORMAL
 11940           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11941           and pi-cert-eff-dt < am-expiration-dt
 11942           and pi-cert-eff-dt >= am-effective-dt
 11943           move am-dcc-product-code to pi-dcc-product-code
 11944        else
 11945           move spaces           to pi-dcc-product-code
 11946        end-if
 11947        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11948           PERFORM 0900-GET-DDF-LIMITS
 11949                                 THRU 0900-EXIT
 11950           IF PDEF-FOUND
 11951              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11952                 (P1 > +8)
 11953                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11954              END-PERFORM
 11955              IF P1 < +9
 11956                 if pd-ben-pct (p1) not numeric
 11957                    move zeros   to pd-ben-pct (p1)
 11958                 end-if
 11959                 if pd-ben-pct (p1) = zeros
 11960                    move +1      to ws-work-ben-pct
 11961                 else
 11962                    move pd-ben-pct (p1)
 11963                                 to ws-work-ben-pct
 11964                 end-if
 11965                 compute cm-ah-benefit-amt =
 11966                    cm-ah-benefit-amt * ws-work-ben-pct
 11967                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11968                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11969                 end-if
 11970              else
 11971                 move er-1674    to emi-error
 11972                 PERFORM 9900-ERROR-FORMAT
 11973                                 THRU 9900-EXIT
 11974              END-IF
 11975           else
 11976              move er-1672       to emi-error
 11977              PERFORM 9900-ERROR-FORMAT
 11978                                 THRU 9900-EXIT
 11979           END-IF
 11980        end-if
 11981     END-IF
 11982     IF PI-PMTTYPE NOT = '4'
 11983        GO TO 1405-CALC-PAYMENT.
 11984     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 226
* EL156.cbl
 11985         MOVE PI-EPYAMT           TO PI-CPYAMT
 11986         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11987         GO TO 1430-CHECK-AH-TOLERANCE.
 11988
 11989*    IF PI-COMPANY-ID = 'FIA'
 11990*       IF CERT-ACCOUNT = '0000011043'
 11991*        COMPUTE PI-DAILY-RATE ROUNDED =
 11992*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11993*        COMPUTE PI-CPYAMT ROUNDED =
 11994*                          PI-DAILY-RATE * PI-EDAYS
 11995*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11996*        GO TO 1430-CHECK-AH-TOLERANCE.
 11997
 11998     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11999         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12000         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 12001         GO TO 1420-CHECK-AIG-BENEFIT.
 12002
 12003     IF WS-CALC-METHOD = '2' OR  '5'
 12004         COMPUTE PI-DAILY-RATE ROUNDED =
 12005                        (CM-AH-BENEFIT-AMT * 12) / 365
 12006         COMPUTE PI-CPYAMT ROUNDED =
 12007                           PI-DAILY-RATE * PI-EDAYS
 12008        GO TO 1420-CHECK-AIG-BENEFIT.
 12009
 12010     IF WS-CALC-METHOD = '3'
 12011         COMPUTE PI-DAILY-RATE =
 12012                         (CM-AH-BENEFIT-AMT * 12) / 365
 12013         COMPUTE PI-CPYAMT ROUNDED =
 12014                           PI-DAILY-RATE * PI-EDAYS
 12015        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 227
* EL156.cbl
 12017*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 12018
 12019****************************************************************
 12020****************************************************************
 12021*                  CALCULATED FROM      PAYMENT      PAYMENT
 12022*   DATES           DATE ROUTINE        OPT  1       OPT  6
 12023* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 12024*1-01-83  1-15-83    0    15     15        15           15
 12025*1-01-83  1-30-83    0    30     30        30           30
 12026*1-01-83  1-31-83    1     0     31        30           30
 12027*1-01-83  2-01-83    1     1     32        31           31
 12028*1-01-83  2-15-83    1    15     46        45           45
 12029*1-01-83  2-28-83    2     0     59        60           60
 12030*1-01-83  3-01-83    2     1     60        61           61
 12031*1-01-83  3-31-83    3     0     90        90           90
 12032*1-15-83  1-31-83    0    17     17        17           16
 12033*1-15-83  2-01-83    0    18     18        18           17
 12034*1-15-83  2-28-83    1    14     45        44           46
 12035*1-21-83  3-09-83    1    20     48        50           49
 12036*2-05-83  3-06-83    1     2     30        32           32
 12037*2-05-83  3-23-83    1    19     47        49           49
 12038*2-15-83  2-28-83    0    14     14        14           16
 12039*2-15-83  3-01-83    0    15     15        15           17
 12040*2-21-83  3-19-83    0    27     27        27           29
 12041*2-21-83  3-20-83    1     0     28        30           30
 12042*2-21-83  4-10-83    1    18     49        30           50
 12043*2-21-83  5-19-83    2    27     88        87           89
 12044*2-21-83  5-22-83    3     2     91        92           92
 12045*3-21-83  5-19-83    1    30     60        60           59
 12046****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 228
* EL156.cbl
 12048 1405-CALC-PAYMENT.
 12049     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12050     MOVE ' '                    TO DC-OPTION-CODE.
 12051     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12052     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12053     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12054
 12055     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12056     MOVE ' '                    TO DC-OPTION-CODE.
 12057     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12058     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12059     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12060
 12061     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12062     MOVE -1                     TO DC-ELAPSED-DAYS.
 12063     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12064     MOVE '6'                    TO DC-OPTION-CODE.
 12065     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12066     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12067
 12068     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12069     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12070     MOVE '1'                    TO DC-OPTION-CODE.
 12071     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12072
 12073     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12074     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12075     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12076
 12077******************************************************************
 12078*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12079*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12080*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12081******************************************************************
 12082
 12083     IF WS-CALC-METHOD = '1'           AND
 12084        DC-ELAPSED-MONTHS > ZERO AND
 12085        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12086        WDF-DAY > WDT-DAY
 12087          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12088          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12089          MOVE -1                  TO DC-ELAPSED-MONTHS
 12090          MOVE '6'                 TO DC-OPTION-CODE
 12091          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12092          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12093          COMPUTE WS-SAVE-ODD-DAYS =
 12094          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12095          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12096
 12097     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12098     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12099     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12100
 12101     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12102     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12103
 12104*    IF PI-COMPANY-ID = 'FIA'
 12105*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 229
* EL156.cbl
 12106*        COMPUTE PI-DAILY-RATE ROUNDED =
 12107*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12108*        COMPUTE PI-CPYAMT ROUNDED =
 12109*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12110*        GO TO 1420-CHECK-AIG-BENEFIT.
 12111
 12112*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12113*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12114*          CM-AH-BENEFIT-CD = '23'               AND
 12115*          CL-CERT-STATE    = '04'               AND
 12116*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12117*            COMPUTE WS-DAILY-RATE ROUNDED =
 12118*                               CM-AH-BENEFIT-AMT / 30
 12119*            COMPUTE PI-CPYAMT ROUNDED =
 12120*                               (WS-DAILY-RATE * PI-CDAYS)
 12121*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12122*            GO TO 1420-CHECK-AIG-BENEFIT.
 12123
 12124     IF WS-CALC-METHOD = '1'
 12125         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12126         COMPUTE PI-CPYAMT ROUNDED =
 12127             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12128             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12129         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12130         GO TO 1420-CHECK-AIG-BENEFIT.
 12131
 12132     IF WS-CALC-METHOD = '2'
 12133         COMPUTE PI-DAILY-RATE ROUNDED =
 12134                          (CM-AH-BENEFIT-AMT * 12) / 365
 12135         COMPUTE PI-CPYAMT ROUNDED =
 12136             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12137             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12138         GO TO 1420-CHECK-AIG-BENEFIT.
 12139
 12140     IF WS-CALC-METHOD = '4'
 12141         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12142         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12143         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12144         COMPUTE PI-CPYAMT ROUNDED =
 12145                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12146         GO TO 1420-CHECK-AIG-BENEFIT.
 12147
 12148     IF WS-CALC-METHOD = '5'
 12149         COMPUTE PI-DAILY-RATE ROUNDED =
 12150                            (CM-AH-BENEFIT-AMT * 12) / 365
 12151         COMPUTE PI-CPYAMT ROUNDED =
 12152                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12153         GO TO 1420-CHECK-AIG-BENEFIT.
 12154
 12155     IF WS-CALC-METHOD NOT = '3'
 12156        GO TO 1410-CHECK-PAYMENT.
 12157
 12158******   CALCULATION METHOD  3  ROUTINE
 12159     COMPUTE PI-DAILY-RATE =
 12160                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12161
 12162******CHECK TO SEE IF WITHIN SAME MONTH
 12163     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 230
* EL156.cbl
 12164        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12165                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12166         GO TO 1420-CHECK-AIG-BENEFIT.
 12167
 12168******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12169     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12170             SAVE-ODD-DAYS-OVER = ZEROS
 12171      COMPUTE PI-CPYAMT  ROUNDED =
 12172                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12173      GO TO 1420-CHECK-AIG-BENEFIT.
 12174
 12175******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12176******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12177     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12178        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12179        IF WDF-MONTH > 12
 12180           ADD 1                 TO WDF-YEAR
 12181           SUBTRACT 12         FROM WDF-MONTH.
 12182
 12183******CONVERT THE NEW FROM MONTH TO BINARY
 12184     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12185        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12186        MOVE '4'              TO DC-OPTION-CODE
 12187        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12188        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12189
 12190     IF WDF-MONTH = WDT-MONTH AND
 12191        WDF-YEAR  = WDT-YEAR
 12192          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12193                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12194                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12195        ELSE
 12196          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12197          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12198          COMPUTE PI-CPYAMT ROUNDED =
 12199       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12200       +
 12201       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12202       +
 12203       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12204
 12205     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 231
* EL156.cbl
 12207 1410-CHECK-PAYMENT.
 12208******PAYMENT OPTION 6
 12209******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12210     IF SAVE-ELAPSED-MONTHS > ZERO
 12211        IF SAVE-ODD-DAYS-OVER = ZEROS
 12212           GO TO 1412-CHECK-TO-DAY
 12213        ELSE
 12214           IF WDF-DAY > WDT-DAY
 12215              IF WDF-MONTH = 02
 12216                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12217                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12218                  GO TO 1412-CHECK-TO-DAY
 12219              ELSE
 12220                  IF FROM-DAYS-IN-MONTH = 31
 12221                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12222                     GO TO 1412-CHECK-TO-DAY
 12223                  ELSE
 12224                     GO TO 1412-CHECK-TO-DAY
 12225           ELSE
 12226               GO TO 1412-CHECK-TO-DAY.
 12227
 12228     IF WDF-MONTH NOT = WDT-MONTH
 12229        IF WDF-MONTH = 02
 12230           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12231           IF WDF-DAY = 29
 12232              ADD 1              TO SAVE-ODD-DAYS-OVER
 12233           ELSE
 12234              ADD 2              TO SAVE-ODD-DAYS-OVER
 12235        ELSE
 12236           IF FROM-DAYS-IN-MONTH = 31
 12237              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12238
 12239 1412-CHECK-TO-DAY.
 12240        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12241           IF WDT-DAY = 28
 12242              ADD 2              TO SAVE-ODD-DAYS-OVER
 12243           ELSE
 12244              IF WDT-DAY = 29
 12245                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12246              ELSE
 12247                 NEXT SENTENCE
 12248        ELSE
 12249           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12250              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12251
 12252     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12253     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12254     COMPUTE PI-CPYAMT ROUNDED =
 12255         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12256         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12257
 12258     GO TO 1420-CHECK-AIG-BENEFIT.
 12259
 12260 1415-CHECK-LEAP-YEAR.
 12261     IF FROM-DAYS-IN-MONTH = 29
 12262        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12263
 12264 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 232
* EL156.cbl
 12265     EXIT.
 12266
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 233
* EL156.cbl
 12268 1420-CHECK-AIG-BENEFIT.
 12269
 12270     IF WS-SPECIAL-CALC-CD = 'Q'
 12271         GO TO 1425-CHECK-WHOLE-MONTH.
 12272
 12273*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12274*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12275*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12276*       (PI-PMTTYPE = '1' OR '2')
 12277*        NEXT SENTENCE
 12278*    ELSE
 12279         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12280         GO TO 1430-CHECK-AH-TOLERANCE.
 12281
 12282******************AIG LOGIC STARTS**********************
 12283*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12284*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12285*    MOVE ER-3533      TO EMI-ERROR.
 12286*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12287*    GO TO 1430-CHECK-AH-TOLERANCE.
 12288******************AIG LOGIC ENDS************************
 12289
 12290 1425-CHECK-WHOLE-MONTH.
 12291******************************************************************
 12292****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12293****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12294****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12295****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12296****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12297****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12298****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12299****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12300****          PAID * MONTHLY BENEFIT.                         ****
 12301******************************************************************
 12302
 12303     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12304
 12305     IF CL-NO-OF-PMTS-MADE > +0
 12306         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12307
 12308     IF PI-CDAYS < WS-BEN-DAYS
 12309         GO TO 1430-CHECK-AH-TOLERANCE.
 12310
 12311     IF PI-CDAYS = WS-BEN-DAYS
 12312         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12313         GO TO 1430-CHECK-AH-TOLERANCE.
 12314
 12315*    IF PI-COMPANY-ID = 'ACM'
 12316*       NEXT SENTENCE
 12317*    ELSE
 12318        GO TO 1425-NOT-ACM-W15C.
 12319
 12320*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12321*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12322*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12323*    MOVE '6'                    TO  DC-OPTION-CODE.
 12324*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12325*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 234
* EL156.cbl
 12326*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12327*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12328*       MOVE '1'                 TO  DC-OPTION-CODE
 12329*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12330*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12331*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12332*       IF NO-CONVERSION-ERROR
 12333*          IF (DC-ELAPSED-MONTHS > +0) OR
 12334*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12335*             NEXT SENTENCE
 12336*          ELSE
 12337*             MOVE +0            TO  PI-CPYAMT
 12338*             MOVE ER-0846       TO  EMI-ERROR
 12339*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12340*             GO TO 1430-CHECK-AH-TOLERANCE
 12341*       ELSE
 12342*           MOVE ER-0846         TO  EMI-ERROR
 12343*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12344*           GO TO 1430-CHECK-AH-TOLERANCE.
 12345*
 12346*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12347*       ADD +1 TO DC-ELAPSED-MONTHS.
 12348*
 12349*    COMPUTE PI-CPYAMT ROUNDED =
 12350*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12351*
 12352*    GO TO 1430-CHECK-AH-TOLERANCE.
 12353
 12354 1425-NOT-ACM-W15C.
 12355
 12356     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12357     MOVE '6'                        TO  DC-OPTION-CODE.
 12358     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12359     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12360
 12361     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12362     IF NO-CONVERSION-ERROR
 12363         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12364     ELSE
 12365         MOVE ER-0846                TO  EMI-ERROR
 12366         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12367         GO TO 1430-CHECK-AH-TOLERANCE.
 12368
 12369     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12370     MOVE '1'                        TO  DC-OPTION-CODE.
 12371     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12372     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12373     IF NO-CONVERSION-ERROR
 12374         IF DC-ODD-DAYS-OVER = +0
 12375             NEXT SENTENCE
 12376         ELSE
 12377             MOVE ER-0846            TO  EMI-ERROR
 12378             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12379             GO TO 1430-CHECK-AH-TOLERANCE
 12380     ELSE
 12381         MOVE ER-0846                TO  EMI-ERROR
 12382         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12383         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 235
* EL156.cbl
 12384
 12385     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12386         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12387
 12388     GO TO 1430-CHECK-AH-TOLERANCE.
 12389
 12390 1425-CONT-WHOLE-MONTH-PMTS.
 12391******************************************************************
 12392****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12393****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12394****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12395******************************************************************
 12396
 12397     IF PI-COMPANY-ID = 'ACM'
 12398        NEXT SENTENCE
 12399     ELSE
 12400        IF DC-ODD-DAYS-OVER = +0
 12401            NEXT SENTENCE
 12402        ELSE
 12403            MOVE ER-0845            TO  EMI-ERROR
 12404            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12405            GO TO 1430-CHECK-AH-TOLERANCE.
 12406
 12407     COMPUTE PI-CPYAMT ROUNDED =
 12408                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12409
 12410 1430-CHECK-AH-TOLERANCE.
 12411     IF PI-PMT-APPR-SW = 'G'
 12412         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12413
 12414*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12415*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12416*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12417*
 12418*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12419*      IF WDF-MONTH = 02
 12420*        IF SAVE-ELAPSED-MONTHS = 0
 12421*          NEXT SENTENCE
 12422*        ELSE
 12423*          IF SAVE-ODD-DAYS-OVER > 0
 12424*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12425*            COMPUTE WS-PMT-MOS ROUNDED =
 12426*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12427*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12428*                                     WS-PMT-MOS
 12429*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12430*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12431*          ELSE
 12432*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12433*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12434*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12435*                                     WS-PMT-MOS.
 12436
 12437     IF WS-MAX-PMT-TOL NOT = ZERO
 12438        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12439           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12440            MOVE ER-0494         TO  EMI-ERROR
 12441            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 236
* EL156.cbl
 12442            GO TO 1500-EDIT-EXPENSES.
 12443
 12444 1430-CONT-CHECK-AH-TOLERANCE.
 12445
 12446     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12447        GO TO 1500-EDIT-EXPENSES.
 12448
 12449     IF CM-O-B-COVERAGE
 12450        GO TO 1500-EDIT-EXPENSES.
 12451
 12452     IF PI-COMPANY-ID = 'NCL'
 12453       IF FOUND-TOL-SW = 'Y'
 12454         IF WS-PMT-TOL NOT = ZERO
 12455           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12456              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12457                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12458                  IF WS-NCL-PMT-OPTION = SPACES
 12459                      MOVE ER-0699 TO EMI-ERROR
 12460                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12461                  ELSE
 12462                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12463                      NEXT SENTENCE
 12464                  ELSE
 12465                  IF NOT WS-VALID-NCL-OPTION
 12466                      MOVE ER-0699 TO EMI-ERROR
 12467                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12468
 12469     IF WS-PMT-TOL NOT = ZERO
 12470        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12471           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12472           MOVE ER-0495          TO EMI-ERROR
 12473           PERFORM 1490-PAYMENT-ERROR
 12474                                 THRU 1490-EXIT
 12475        end-if
 12476     end-if
 12477
 12478     GO TO 1500-EDIT-EXPENSES.
 12479
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 237
* EL156.cbl
 12481 1440-COMPUTE-LIFE-REMAINING.
 12482
 12483     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12484        IF PI-PMTTYPE = '4'
 12485          MOVE PI-EPYAMT TO PI-CPYAMT
 12486          GO TO 1460-TEST-TYPE.
 12487
 12488     IF WS-LF-COVERAGE-TYPE = 'L'
 12489        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12490                          - CL-TOTAL-PAID-AMT
 12491        GO TO 1450-CHECK-MAX.
 12492
 12493     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12494        PI-LF-COVERAGE-TYPE = 'P'
 12495          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12496                              CM-LF-ITD-DEATH-AMT
 12497          GO TO 1450-CHECK-MAX.
 12498
 12499     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12500     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12501     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12502     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12503     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12504     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12505     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12506     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12507     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12508
 12509     PERFORM 9800-LINK-REM-TERM.
 12510
 12511     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12512     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12513     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12514     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12515     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12516     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12517     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12518     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12519     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12520     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12521     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12522     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12523     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12524     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12525     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12526     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12527     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12528        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12529        MOVE PI-CARRIER          TO ACCT-CARRIER
 12530        MOVE PI-GROUPING         TO ACCT-GROUPING
 12531        MOVE PI-STATE            TO ACCT-STATE
 12532        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12533        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12534        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12535        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12536
 12537
 12538* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 238
* EL156.cbl
 12539*          DATASET ('ERACCT')
 12540*          RIDFLD  (ERACCT-KEY)
 12541*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12542*          GTEQ
 12543*          resp    (WS-RESPONSE)
 12544*       END-EXEC
 12545     MOVE 'ERACCT' TO DFHEIV1
 12546*    MOVE '&"S        G          (  N#00011983' TO DFHEIV0
 12547     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12548     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12549     MOVE X'204E233030303131393833' TO DFHEIV0(25:11)
 12550     CALL 'kxdfhei1' USING DFHEIV0,
 12551           DFHEIV1,
 12552           DFHEIV20,
 12553           DFHEIV99,
 12554           ERACCT-KEY,
 12555           DFHEIV99,
 12556           DFHEIV99,
 12557           DFHEIV99
 12558     SET ADDRESS OF ACCOUNT-MASTER TO
 12559         DFHEIV20
 12560     MOVE EIBRESP  TO WS-RESPONSE
 12561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12562        IF WS-RESP-NORMAL
 12563           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12564           and (pi-cert-eff-dt < am-expiration-dt)
 12565           and (pi-cert-eff-dt >= am-effective-dt)
 12566           move am-dcc-product-code to pi-dcc-product-code
 12567        else
 12568           move spaces           to pi-dcc-product-code
 12569        end-if
 12570        if pi-dcc-product-code not = spaces
 12571           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12572           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12573           PERFORM 0900-GET-DDF-limits
 12574                                 THRU 0900-EXIT
 12575           IF PDEF-FOUND
 12576              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12577                 (P1 > +8)
 12578                 OR (PD-PROD-CODE (P1) = 'L')
 12579              END-PERFORM
 12580              IF P1 < +9
 12581                 MOVE PD-MAX-AMT (P1)
 12582                                 TO CP-R-MAX-TOT-BEN
 12583              else
 12584                 move er-1674    to emi-error
 12585                 PERFORM 9900-ERROR-FORMAT
 12586                                 THRU 9900-EXIT
 12587              END-IF
 12588           else
 12589              move er-1672       to emi-error
 12590              PERFORM 9900-ERROR-FORMAT
 12591                                 THRU 9900-EXIT
 12592           END-IF
 12593        end-if
 12594     END-IF
 12595
 12596* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 239
* EL156.cbl
 12597*       PROGRAM  (LINK-REMAMT)
 12598*       COMMAREA (CALCULATION-PASS-AREA)
 12599*       LENGTH   (CP-COMM-LENGTH)
 12600*    END-EXEC.
 12601*    MOVE '."C                   (   #00012023' TO DFHEIV0
 12602     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12603     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12604     MOVE X'2020233030303132303233' TO DFHEIV0(25:11)
 12605     CALL 'kxdfhei1' USING DFHEIV0,
 12606           LINK-REMAMT,
 12607           CALCULATION-PASS-AREA,
 12608           CP-COMM-LENGTH,
 12609           DFHEIV99,
 12610           DFHEIV99,
 12611           DFHEIV99,
 12612           DFHEIV99
 12613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12614
 12615
 12616     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12617
 12618     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12619     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12620
 12621     IF PI-COMPANY-ID = 'BOA' AND
 12622        PI-PMTTYPE    = '2'   AND
 12623        PI-OFFLINE    = 'N'
 12624           GO TO 1441-COMPUTE-BOA-INTEREST.
 12625
 12626     IF PI-COMPANY-ID = 'NCL' AND
 12627        PI-PMTTYPE    = '2'   AND
 12628        PI-OFFLINE    = 'N'
 12629          GO TO 1442-COMPUTE-NCL-INTEREST
 12630       ELSE
 12631          GO TO 1445-CONTINUE.
 12632
 12633 1441-COMPUTE-BOA-INTEREST.
 12634     MOVE +0             TO WS-CALC-INT.
 12635
 12636     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12637     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12638     MOVE +0             TO DC-ELAPSED-MONTHS
 12639                            DC-ELAPSED-DAYS.
 12640     MOVE '1'            TO DC-OPTION-CODE.
 12641     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12642     IF NO-CONVERSION-ERROR
 12643         NEXT SENTENCE
 12644     ELSE
 12645         GO TO 1445-CONTINUE.
 12646
 12647     IF (PI-INT-RATE NOT > ZEROS)  AND
 12648        (DC-ELAPSED-DAYS > +30)
 12649         MOVE ER-3531            TO EMI-ERROR
 12650         MOVE -1                 TO PINTL
 12651         MOVE AL-UNBON           TO PINTA
 12652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12653
 12654     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 240
* EL156.cbl
 12655         GO TO 1445-CONTINUE.
 12656
 12657     IF (PI-INT-RATE NOT > ZEROS)  OR
 12658        (DC-ELAPSED-DAYS NOT > +30)
 12659         MOVE PI-EPYAMT TO PI-CPYAMT
 12660         GO TO 1441-FORMAT-NOTE.
 12661
 12662     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12663                                 *  PI-INT-RATE
 12664                                 *  DC-ELAPSED-DAYS
 12665                                 /  365
 12666                                 /  100.
 12667
 12668     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12669
 12670 1441-FORMAT-NOTE.
 12671
 12672     MOVE SPACES        TO WS-BOANOTE1.
 12673     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12674     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12675     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12676     MOVE AL-UANON      TO NOTE1A.
 12677
 12678     IF WS-CALC-INT > ZEROS
 12679         MOVE SPACES        TO WS-BOANOTE2
 12680         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12681         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12682         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12683         MOVE AL-UANON      TO NOTE2A.
 12684
 12685     GO TO 1445-CONTINUE.
 12686
 12687 1442-COMPUTE-NCL-INTEREST.
 12688     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12689     MOVE PI-STATE               TO WS-ST-ACCESS.
 12690     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12691     MOVE '3'                    TO CNTL-REC-TYPE.
 12692     MOVE +0                     TO CNTL-SEQ-NO.
 12693     MOVE 'STAT'                 TO FILE-SWITCH.
 12694
 12695     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12696
 12697     MOVE +0                 TO WS-CALC-INT.
 12698
 12699     IF ST-STAT-FROM-INCURRED
 12700         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12701       ELSE
 12702     IF ST-STAT-FROM-REPORTED
 12703         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12704       ELSE
 12705         GO TO 1445-CONTINUE.
 12706
 12707     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12708     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12709     MOVE +0                 TO DC-ELAPSED-MONTHS
 12710                                DC-ELAPSED-DAYS.
 12711     MOVE '1'                TO DC-OPTION-CODE.
 12712     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 241
* EL156.cbl
 12713     IF NO-CONVERSION-ERROR
 12714         NEXT SENTENCE
 12715     ELSE
 12716         GO TO 1445-CONTINUE.
 12717
 12718     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12719        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12720         GO TO 1445-CONTINUE.
 12721
 12722     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12723                                 *  CF-ST-STAT-INTEREST.
 12724
 12725     MOVE SPACES              TO WS-NCLNOTE1.
 12726     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12727     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12728     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12729                                 PI-PMTNOTE1
 12730                                 NOTE1I.
 12731     MOVE AL-UANON            TO NOTE1A.
 12732
 12733     IF WS-CALC-INT > ZEROS
 12734         MOVE SPACES          TO WS-NCLNOTE2
 12735         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12736         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12737         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12738                                 PI-PMTNOTE2
 12739                                 NOTE2I
 12740         MOVE AL-UANON        TO NOTE2A.
 12741
 12742     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12743
 12744 1445-CONTINUE.
 12745
 12746     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12747        GO TO 1460-TEST-TYPE.
 12748
 12749     IF CM-O-B-COVERAGE
 12750        GO TO 1460-TEST-TYPE.
 12751
 12752     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12753         GO TO 1450-CHECK-MAX.
 12754
 12755     if (pi-company-id = 'DCC' or 'VPP')
 12756        and (pdef-found)
 12757        if pi-epyamt > pd-max-amt (p1)
 12758           move er-1657          to emi-error
 12759           perform 1490-payment-error
 12760                                 thru 1490-exit
 12761           go to 1460-test-type
 12762        end-if
 12763     else
 12764        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12765           > PI-EPYAMT)
 12766                         OR
 12767           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12768           < PI-EPYAMT)
 12769           MOVE ER-0594          TO EMI-ERROR
 12770           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 242
* EL156.cbl
 12771                                 THRU 1490-EXIT
 12772           GO TO 1460-TEST-TYPE
 12773        end-if
 12774     end-if
 12775     .
 12776 1450-CHECK-MAX.
 12777
 12778     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12779        PI-LF-COVERAGE-TYPE = 'P'
 12780         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12781                                   CM-LF-ITD-DEATH-AMT
 12782     ELSE
 12783         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12784                                   CL-TOTAL-PAID-AMT.
 12785
 12786     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12787          MOVE ER-0543           TO EMI-ERROR
 12788          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12789
 12790 1460-TEST-TYPE.
 12791
 12792     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12793        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 12794           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12795                                   CM-LF-ALT-BENEFIT-AMT -
 12796                                   CL-TOTAL-PAID-AMT
 12797           IF PI-EPYAMT > WS-LF-BEN-AMT
 12798               MOVE ER-0543      TO EMI-ERROR
 12799               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12800           END-IF
 12801        END-IF
 12802     END-IF
 12803
 12804     IF PI-PMT-APPR-SW = 'G'
 12805       NEXT SENTENCE
 12806     ELSE
 12807       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12808         IF PI-EPYAMT = ZERO
 12809             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12810                 MOVE ER-0494    TO  EMI-ERROR
 12811                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12812                 GO TO 1500-EDIT-EXPENSES
 12813             ELSE
 12814                 NEXT SENTENCE
 12815         ELSE
 12816             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12817                 MOVE ER-0494    TO  EMI-ERROR
 12818                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12819                 GO TO 1500-EDIT-EXPENSES.
 12820
 12821     IF PI-PMTTYPE NOT = '2' OR
 12822        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12823         GO TO 1500-EDIT-EXPENSES.
 12824
 12825     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12826     MOVE ER-0526                TO EMI-ERROR.
 12827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12828
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 243
* EL156.cbl
 12829     IF EMI-ERROR-NUMBER (1) = '0526'
 12830        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12831
 12832     IF EMI-ERROR-NUMBER (2) = '0526'
 12833        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12834
 12835     GO TO 1500-EDIT-EXPENSES.
 12836
 12837 1490-PAYMENT-ERROR.
 12838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12839
 12840     IF EMI-MESSAGE-FORMATTED
 12841         MOVE -1                 TO EPYAMTL
 12842         MOVE AL-UNBON           TO EPYAMTA.
 12843
 12844 1490-EXIT.
 12845      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 244
* EL156.cbl
 12847 1500-EDIT-EXPENSES.
 12848     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12849         GO TO 1500-SKIP-ERROR-0556.
 12850
 12851 1500-CONTINUE-ON.
 12852
 12853     IF CM-O-B-COVERAGE
 12854        MOVE ER-0556             TO EMI-ERROR
 12855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12856
 12857 1500-SKIP-ERROR-0556.
 12858     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12859        IF PI-EEXPENS NOT = ZEROS
 12860           MOVE ER-0524          TO EMI-ERROR
 12861           GO TO 1590-EXPENSE-ERROR
 12862        ELSE
 12863           GO TO 1600-EDIT-RESERVES.
 12864
 12865     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12866     MOVE '6'                    TO CNTL-REC-TYPE.
 12867
 12868     IF CONTROL-IS-ACTUAL-CARRIER
 12869         MOVE PI-CARRIER         TO WS-CARR
 12870     ELSE
 12871         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12872
 12873     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12874     MOVE +0                     TO CNTL-SEQ-NO.
 12875     MOVE 'CARR'                 TO FILE-SWITCH.
 12876
 12877     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12878
 12879     IF EXPENSE-CALC-MANUAL
 12880        GO TO 1600-EDIT-RESERVES.
 12881
 12882     IF DOLLARS-PER-PMT
 12883        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12884        GO TO 1600-EDIT-RESERVES.
 12885
 12886     IF DOLLARS-PER-MONTH AND
 12887        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12888       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12889       GO TO 1600-EDIT-RESERVES.
 12890
 12891     IF PERCENT-OF-PAYMENT
 12892        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12893
 12894     GO TO 1600-EDIT-RESERVES.
 12895
 12896 1590-EXPENSE-ERROR.
 12897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12898
 12899     IF EMI-MESSAGE-FORMATTED
 12900        MOVE -1                  TO EEXPENSL
 12901        MOVE AL-UNBON            TO EEXPENSA.
 12902
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 245
* EL156.cbl
 12904 1600-EDIT-RESERVES.
 12905     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12906        IF PI-ERESV = ZEROS
 12907           GO TO 1700-EDIT-EXPENSE-TYPE
 12908        ELSE
 12909           MOVE ER-0525          TO EMI-ERROR
 12910           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12911           GO TO 1700-EDIT-EXPENSE-TYPE.
 12912
 12913     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12914     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12915     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12916
 12917     IF NOT AT-MANUAL-RESERVES-USED
 12918        IF PI-ERESV NOT = ZEROS
 12919           MOVE ER-0518          TO EMI-ERROR
 12920           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12921
 12922     IF AT-MANUAL-RESERVES-USED
 12923        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12924        GO TO 1700-EDIT-EXPENSE-TYPE.
 12925
 12926     IF AT-FUTURE-RESERVES-USED
 12927        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12928
 12929     IF AT-FUTURE-RESERVES-USED
 12930        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12931
 12932     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12933        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12934
 12935     IF AT-IBNR-RESERVES-USED
 12936        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12937
 12938     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12939     GO TO 1700-EDIT-EXPENSE-TYPE.
 12940
 12941 1690-RESERVE-ERROR.
 12942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12943
 12944     IF EMI-MESSAGE-FORMATTED
 12945        MOVE AL-UNBON            TO ERESVA
 12946        MOVE -1                  TO ERESVL.
 12947
 12948 1690-EXIT.
 12949      EXIT.
 12950
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 246
* EL156.cbl
 12952 1700-EDIT-EXPENSE-TYPE.
 12953     IF PI-PMTTYPE NOT = '5' AND '6'
 12954        GO TO 2000-EDIT-DONE.
 12955
 12956     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12957                   '6' OR '7' OR '8' OR '9'
 12958        GO TO 2000-EDIT-DONE.
 12959
 12960 1705-EXPENSE-ERROR.
 12961     MOVE ER-0573                TO EMI-ERROR.
 12962     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12963
 12964     IF EMI-MESSAGE-FORMATTED
 12965        MOVE AL-UABON            TO ETYPEA
 12966        MOVE -1                  TO ETYPEL.
 12967
 12968     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 247
* EL156.cbl
 12970 1950-NOT-FOUND.
 12971     IF FILE-SWITCH = 'MSTR'
 12972        MOVE ER-0204             TO EMI-ERROR.
 12973
 12974     IF FILE-SWITCH = 'CARR'
 12975        MOVE ER-0252             TO EMI-ERROR.
 12976
 12977     IF FILE-SWITCH = 'COMP'
 12978        MOVE ER-0254             TO EMI-ERROR.
 12979
 12980     IF FILE-SWITCH = 'STAT'
 12981        MOVE ER-0149             TO EMI-ERROR.
 12982
 12983     IF FILE-SWITCH = 'PROC'
 12984        MOVE ER-0019             TO EMI-ERROR.
 12985
 12986     IF FILE-SWITCH = 'ACCT'
 12987        MOVE ER-0198             TO EMI-ERROR.
 12988
 12989     IF FILE-SWITCH = 'BENE'
 12990        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 12991           MOVE ER-0282          TO EMI-ERROR
 12992        ELSE
 12993           MOVE ER-0283          TO EMI-ERROR.
 12994
 12995     MOVE -1                     TO PMTTYPEL.
 12996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12997
 12998     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12999                                     WS-FORCE-CTR.
 13000
 13001     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 13002                                     WS-FATAL-CTR.
 13003
 13004     GO TO 8200-SEND-DATAONLY.
 13005
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 248
* EL156.cbl
 13007 2000-EDIT-DONE.
 13008     perform 2210-dcc-max-benes thru 2210-exit
 13009     if pi-company-id not = 'DCC' and 'VPP'
 13010        IF (WS-SPECIAL-CALC-CD = 'C')
 13011           and (cl-critical-period > 0)
 13012           IF CM-AH-BENEFIT-AMT NOT = ZERO
 13013              IF PI-EPYAMT > ZEROS
 13014                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13015                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 13016              ELSE
 13017                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13018                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 13019              END-IF
 13020              if ws-benefits-paid > cl-critical-period
 13021                 MOVE ER-0657          TO EMI-ERROR
 13022                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13023              END-IF
 13024           END-IF
 13025        END-IF
 13026     end-if
 13027     IF PI-HOLDTIL NOT = ZEROS
 13028        MOVE PI-HOLDTIL          TO HOLDTILO
 13029        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'
 13030        MOVE ER-3272          TO EMI-ERROR
 13031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13032     END-IF
 13033
 13034     IF PI-EPYFROM NOT = ZEROS
 13035        MOVE PI-EPYFROM          TO EPYFROMO
 13036        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 13037
 13038     IF PI-EPYTHRU NOT = ZEROS
 13039        MOVE PI-EPYTHRU            TO EPYTHRUO
 13040        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 13041        IF PI-USES-PAID-TO
 13042           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13043           MOVE '4'                TO DC-OPTION-CODE
 13044           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13045           IF NO-CONVERSION-ERROR
 13046              MOVE +1              TO DC-ELAPSED-DAYS
 13047              MOVE +0              TO DC-ELAPSED-MONTHS
 13048              MOVE '6'             TO DC-OPTION-CODE
 13049              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13050              IF NO-CONVERSION-ERROR
 13051                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13052
 13053     MOVE PI-EDAYS               TO EDAYSO.
 13054
 13055     IF PI-AIGFROM NOT = ZEROS
 13056        MOVE PI-AIGFROM          TO AIGFROMO
 13057        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13058
 13059     MOVE PI-EPYAMT              TO EPYAMTO.
 13060     MOVE PI-ERESV               TO ERESVO.
 13061     MOVE PI-EEXPENS             TO EEXPENSO.
 13062
 13063     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13064     MOVE SPACES                 TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 249
* EL156.cbl
 13065     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13066
 13067     IF DATE-CONVERSION-ERROR
 13068        MOVE SPACES              TO CPYFROMI
 13069     ELSE
 13070        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13071        IF PI-EPYFROM = ZEROS
 13072           MOVE AL-UANON             TO EPYFROMA
 13073           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13074           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13075
 13076     IF PI-USES-PAID-TO
 13077        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13078        MOVE +1                            TO DC-ELAPSED-DAYS
 13079        MOVE +0                            TO DC-ELAPSED-MONTHS
 13080        MOVE '6'                           TO DC-OPTION-CODE
 13081        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13082        IF NO-CONVERSION-ERROR
 13083           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13084           IF PI-EPYTHRU = ZEROS
 13085              MOVE AL-UANON                TO EPYTHRUA
 13086              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13087              MOVE ' '                     TO DC-OPTION-CODE
 13088              MOVE +0                      TO DC-ELAPSED-DAYS
 13089                                              DC-ELAPSED-MONTHS
 13090              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13091              IF NO-CONVERSION-ERROR
 13092                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13093                  GO TO 2001-CONTINUE
 13094              ELSE
 13095                  GO TO 2001-CONTINUE
 13096           ELSE
 13097              GO TO 2001-CONTINUE.
 13098
 13099     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13100     MOVE SPACES                 TO DC-OPTION-CODE.
 13101     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13102
 13103     IF DATE-CONVERSION-ERROR
 13104        MOVE SPACES              TO CPYTHRUI
 13105     ELSE
 13106        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13107        IF PI-EPYTHRU = ZEROS
 13108           MOVE AL-UANON TO EPYTHRUA
 13109           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13110           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13111
 13112 2001-CONTINUE.
 13113
 13114     MOVE PI-CDAYS               TO CDAYSO.
 13115
 13116     IF PI-EDAYS = ZEROS
 13117        MOVE AL-UNNON TO EDAYSA
 13118        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13119
 13120     MOVE PI-CPYAMT              TO CPYAMTO.
 13121
 13122     IF PI-EPYAMT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 250
* EL156.cbl
 13123        MOVE AL-UNNON            TO EPYAMTA
 13124        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13125
 13126     MOVE PI-CRESV               TO CRESVO.
 13127     MOVE PI-CEXPENS             TO CEXPENSO.
 13128
 13129     IF PI-EEXPENS = ZEROS
 13130        MOVE AL-UNNON TO EEXPENSA
 13131        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13132
 13133     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13134        AND (CL-CLAIM-TYPE = 'L')
 13135        AND (PI-OFFLINE NOT EQUAL 'Y')
 13136        IF PI-PMTTYPE = '2' OR '4'
 13137           PERFORM 2200-CALC-INTEREST
 13138                                 THRU 2200-EXIT
 13139        END-IF
 13140     END-IF
 13141     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13142     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13143     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13144
 13145     IF EMI-FATAL-CTR = ZEROS
 13146        MOVE 'B'                 TO PI-PASS-SW.
 13147
 13148     IF NOT EMI-MESSAGE-FORMATTED
 13149         MOVE -1                 TO EPYFROML
 13150     ELSE
 13151         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13152            EMI-ERROR-NUMBER (2) = SPACES
 13153             MOVE -1             TO EPYFROML.
 13154
 13155     GO TO 8200-SEND-DATAONLY.
 13156
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 251
* EL156.cbl
 13158 2200-CALC-INTEREST.
 13159     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13160        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13161        MOVE '4'                 TO DC-OPTION-CODE
 13162        PERFORM 9700-LINK-DATE-CONVERT
 13163        IF DATE-CONVERSION-ERROR
 13164            MOVE LOW-VALUES      TO CP-PRF-DT
 13165        ELSE
 13166           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13167        END-IF
 13168     END-IF
 13169     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13170        if pi-rb-joint-coverage
 13171           move 'Y'              to pi-int-to-rem-borr
 13172        end-if
 13173     end-if
 13174     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13175        IN CLAIM-INT-PASS-AREA
 13176     MOVE CL-CERT-STATE          TO CP-STATE
 13177        IN CLAIM-INT-PASS-AREA
 13178     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13179     MOVE 'LF'                   TO CP-COVERAGE
 13180     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13181     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13182     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13183     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13184     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13185     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13186
 13187* EXEC CICS LINK
 13188*       PROGRAM   ('ELCLMI')
 13189*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13190*       LENGTH    (CP-CLAIM-LENGTH)
 13191*    END-EXEC
 13192     MOVE 'ELCLMI' TO DFHEIV1
 13193*    MOVE '."C                   (   #00012599' TO DFHEIV0
 13194     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13195     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13196     MOVE X'2020233030303132353939' TO DFHEIV0(25:11)
 13197     CALL 'kxdfhei1' USING DFHEIV0,
 13198           DFHEIV1,
 13199           CLAIM-INT-PASS-AREA,
 13200           CP-CLAIM-LENGTH,
 13201           DFHEIV99,
 13202           DFHEIV99,
 13203           DFHEIV99,
 13204           DFHEIV99
 13205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13206     MOVE AL-PANOF               TO PINTHA
 13207                                    PINTA
 13208     if cp-clm-int-amt = zeros
 13209        move ' ' to pi-int-to-rem-borr
 13210     end-if
 13211     IF NO-CI-ERROR
 13212        MOVE CP-CLM-INT-AMT      TO PINTO
 13213                                    PI-INT-AMT
 13214        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13215        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 252
* EL156.cbl
 13216        MOVE AL-PANOF            TO PINTHA
 13217                                    PINTA
 13218        if pi-rb-joint-coverage
 13219           and pi-int-amt > zeros
 13220           move '  INT TO'       to itrb1o
 13221           move ' REM BORR?'     to itrb2o
 13222           move pi-int-to-rem-borr
 13223                                 to itrbyno
 13224           move al-uanon         to itrbyna
 13225           move +1               to itrbynl
 13226        else
 13227           move ' '              to pi-int-to-rem-borr
 13228        end-if
 13229     ELSE
 13230        IF CI-RETURN-CODE = '8'
 13231           MOVE ER-3818          TO EMI-ERROR
 13232           MOVE -1               TO ZINTL
 13233           PERFORM 9900-ERROR-FORMAT
 13234                                 THRU 9900-EXIT
 13235           GO TO 2200-EXIT
 13236        ELSE
 13237           MOVE ZEROS            TO PINTO
 13238                                    PI-INT-AMT
 13239                                    PI-INT-DAYS
 13240                                    PI-INT-RATE-USED
 13241        END-IF
 13242     END-IF
 13243     IF PI-INT-AMT NOT = ZEROS
 13244        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13245           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13246           CONTINUE
 13247        ELSE
 13248           MOVE CL-SOC-SEC-NO (1:3)
 13249                                 TO WS-SSN (1:3)
 13250           MOVE CL-SOC-SEC-NO (5:2)
 13251                                 TO WS-SSN (4:2)
 13252           MOVE CL-SOC-SEC-NO (8:4)
 13253                                 TO WS-SSN (6:4)
 13254           IF (WS-SSN NUMERIC)
 13255              AND (WS-SSN NOT = ZEROS)
 13256              CONTINUE
 13257           ELSE
 13258              MOVE ER-2044       TO EMI-ERROR
 13259              PERFORM 9900-ERROR-FORMAT
 13260                                 THRU 9900-EXIT
 13261           END-IF
 13262        END-IF
 13263        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13264        if pi-int-to-rem-borr = 'Y'
 13265           move +61              to trlr-seq-no
 13266        else
 13267           MOVE +51              TO TRLR-SEQ-NO
 13268        end-if
 13269
 13270* EXEC CICS READ
 13271*          DATASET  ('ELTRLR')
 13272*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13273*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 253
* EL156.cbl
 13274*          RESP     (WS-RESPONSE)
 13275*       END-EXEC
 13276     MOVE 'ELTRLR' TO DFHEIV1
 13277*    MOVE '&"S        E          (  N#00012667' TO DFHEIV0
 13278     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13279     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13280     MOVE X'204E233030303132363637' TO DFHEIV0(25:11)
 13281     CALL 'kxdfhei1' USING DFHEIV0,
 13282           DFHEIV1,
 13283           DFHEIV20,
 13284           DFHEIV99,
 13285           ELTRLR-KEY,
 13286           DFHEIV99,
 13287           DFHEIV99,
 13288           DFHEIV99
 13289     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13290         DFHEIV20
 13291     MOVE EIBRESP  TO WS-RESPONSE
 13292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13293        IF (NOT WS-RESP-NORMAL)
 13294                    OR
 13295           ((WS-RESP-NORMAL)
 13296           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13297           OR (AT-CITY-STATE = SPACES)))
 13298           MOVE ER-0874          TO EMI-ERROR
 13299           if pi-rb-joint-coverage
 13300              move -1            to itrbynl
 13301           end-if
 13302           PERFORM 9900-ERROR-FORMAT
 13303                                 THRU 9900-EXIT
 13304        else
 13305           move at-mail-to-name  to pi-int-payees-name
 13306        END-IF
 13307     END-IF
 13308     .
 13309 2200-EXIT.
 13310     EXIT.
 13311 2210-dcc-max-benes.
 13312
 13313     move pi-ah-term             to ws-max-bens
 13314     if cl-critical-period not = zeros and spaces
 13315        move cl-critical-period  to ws-max-bens
 13316     end-if
 13317     move cm-ah-benefit-amt      to ws-monthly-benefit
 13318     if pdef-found
 13319        and (pd-max-amt (p1) not = zeros)
 13320        if pd-ben-pct (p1) not numeric
 13321           move zeros            to pd-ben-pct (p1)
 13322        end-if
 13323        if pd-ben-pct (p1) = zeros
 13324           move +1               to ws-work-ben-pct
 13325        else
 13326           move pd-ben-pct (p1)  to ws-work-ben-pct
 13327        end-if
 13328*       compute ws-monthly-benefit =
 13329*          ws-monthly-benefit * ws-work-ben-pct
 13330*       if ws-monthly-benefit > pd-max-amt (p1)
 13331*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 254
* EL156.cbl
 13332*       end-if
 13333     end-if
 13334
 13335     move cl-cert-key-data       to elcrtt-key (2:21)
 13336     move cl-company-cd          to ctrlr-comp-cd
 13337     move cl-cert-no             to ctrlr-cert-no
 13338     move 'B'                    to ctrlr-rec-type
 13339
 13340
 13341* EXEC CICS READ
 13342*       DATASET  ('ELCRTT')
 13343*       set      (address of CERTIFICATE-TRAILERS)
 13344*       RIDFLD   (ELCRTT-KEY)
 13345*       RESP     (WS-RESPONSE)
 13346*    END-EXEC
 13347     MOVE 'ELCRTT' TO DFHEIV1
 13348*    MOVE '&"S        E          (  N#00012720' TO DFHEIV0
 13349     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13351     MOVE X'204E233030303132373230' TO DFHEIV0(25:11)
 13352     CALL 'kxdfhei1' USING DFHEIV0,
 13353           DFHEIV1,
 13354           DFHEIV20,
 13355           DFHEIV99,
 13356           ELCRTT-KEY,
 13357           DFHEIV99,
 13358           DFHEIV99,
 13359           DFHEIV99
 13360     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13361         DFHEIV20
 13362     MOVE EIBRESP  TO WS-RESPONSE
 13363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13364     IF not WS-RESP-NORMAL
 13365        go to 2210-exit
 13366     end-if
 13367
 13368*    if instypei = 'P'
 13369*       move +1 to s1
 13370*    else
 13371*       MOVE +2 to s1
 13372*    end-if
 13373
 13374*    move +1 to s1
 13375*    evaluate cl-claim-type
 13376*       when 'A'
 13377*          move +1 to s2
 13378*       when 'I'
 13379*          move +2 to s2
 13380*       when 'G'
 13381*          move +3 to s2
 13382*       when 'L'
 13383*          move +4 to s2
 13384*       when 'P'
 13385*          move +5 to s2
 13386*    end-evaluate
 13387
 13388     move zeros                  to ws-prev-days-paid
 13389                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 255
* EL156.cbl
 13390                                    ws-prev-amt-paid
 13391     perform varying s1 from +1 by +1 until
 13392        (s1 > +24)
 13393        or (cs-claim-type (s1) = spaces)
 13394        if pi-company-id not = 'DCC' and 'VPP'
 13395           if cs-claim-type (s1) = cl-claim-type
 13396              compute ws-prev-days-paid =
 13397                 ws-prev-days-paid + cs-days-paid (s1)
 13398              compute ws-prev-amt-paid =
 13399                 ws-prev-amt-paid + cs-total-paid (s1)
 13400           end-if
 13401        else
 13402           if (cs-claim-type (s1) = cl-claim-type)
 13403              and (cs-benefit-period (s1) = cl-benefit-period)
 13404              and (cs-insured-type (s1) = cl-insured-type)
 13405              compute ws-prev-days-paid =
 13406                 ws-prev-days-paid + cs-days-paid (s1)
 13407              compute ws-prev-amt-paid =
 13408                 ws-prev-amt-paid + cs-total-paid (s1)
 13409           end-if
 13410        end-if
 13411     end-perform
 13412     if pi-epyamt > zeros
 13413        compute ws-benefits-paid =
 13414           (ws-prev-amt-paid + pi-epyamt)
 13415           / ws-monthly-benefit
 13416     else
 13417        compute ws-benefits-paid =
 13418           (ws-prev-amt-paid + pi-cpyamt)
 13419           / ws-monthly-benefit
 13420     end-if
 13421*    if pi-company-id = 'DCC'
 13422     if cl-claim-type not = 'L' and 'O' and 'P'
 13423        if ws-benefits-paid > ws-max-bens
 13424           move er-1658          to emi-error
 13425           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13426        end-if
 13427     end-if
 13428*    end-if
 13429*     if s1 < +25
 13430*        if pi-epyamt > zeros
 13431*           compute ws-benefits-paid =
 13432*              (cs-total-paid (s1) + PI-EPYAMT)
 13433*              / ws-monthly-benefit
 13434*        else
 13435*           compute ws-benefits-paid =
 13436*              (cs-total-paid (s1) + PI-CPYAMT)
 13437*              / ws-monthly-benefit
 13438*        end-if
 13439
 13440*       if ws-benefits-paid > pd-crit-period (p1)
 13441*        if ws-benefits-paid > ws-max-bens
 13442*           move er-1658          to emi-error
 13443*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13444*        end-if
 13445*     end-if
 13446     .
 13447 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 256
* EL156.cbl
 13448     exit.
 13449
 13450 2220-update-elcrtt.
 13451
 13452
 13453* EXEC CICS GETMAIN
 13454*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13455*       LENGTH   (ELCRTT-LENGTH)
 13456*       INITIMG  (GETMAIN-SPACE)
 13457*    END-EXEC
 13458*    MOVE ',"IL                  $   #00012814' TO DFHEIV0
 13459     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13460     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13461     MOVE X'2020233030303132383134' TO DFHEIV0(25:11)
 13462     CALL 'kxdfhei1' USING DFHEIV0,
 13463           DFHEIV20,
 13464           ELCRTT-LENGTH,
 13465           GETMAIN-SPACE
 13466     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13467         DFHEIV20
 13468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13469
 13470     move cl-cert-key-data       to elcrtt-key (2:21)
 13471     move cl-company-cd          to ctrlr-comp-cd
 13472     move cl-cert-no             to ctrlr-cert-no
 13473     move 'B'                    to ctrlr-rec-type
 13474
 13475
 13476* EXEC CICS READ
 13477*       UPDATE
 13478*       DATASET  (ELCRTT-DSID)
 13479*       into     (CERTIFICATE-TRAILERS)
 13480*       RIDFLD   (ELCRTT-KEY)
 13481*       RESP     (WS-RESPONSE)
 13482*    END-EXEC
 13483     MOVE LENGTH OF
 13484      CERTIFICATE-TRAILERS
 13485       TO DFHEIV11
 13486*    MOVE '&"IL       EU         (  N#00012825' TO DFHEIV0
 13487     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13488     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13489     MOVE X'204E233030303132383235' TO DFHEIV0(25:11)
 13490     CALL 'kxdfhei1' USING DFHEIV0,
 13491           ELCRTT-DSID,
 13492           CERTIFICATE-TRAILERS,
 13493           DFHEIV11,
 13494           ELCRTT-KEY,
 13495           DFHEIV99,
 13496           DFHEIV99,
 13497           DFHEIV99
 13498     MOVE EIBRESP  TO WS-RESPONSE
 13499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13500
 13501     IF WS-RESP-NORMAL
 13502        perform 2225-upd-crt-trlr thru 2225-exit
 13503
 13504* EXEC CICS REWRITE
 13505*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 257
* EL156.cbl
 13506*          from     (CERTIFICATE-TRAILERS)
 13507*          RESP     (WS-RESPONSE)
 13508*       END-EXEC
 13509     MOVE LENGTH OF
 13510      CERTIFICATE-TRAILERS
 13511       TO DFHEIV11
 13512*    MOVE '&& L                  %  N#00012835' TO DFHEIV0
 13513     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13514     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13515     MOVE X'204E233030303132383335' TO DFHEIV0(25:11)
 13516     CALL 'kxdfhei1' USING DFHEIV0,
 13517           ELCRTT-DSID,
 13518           CERTIFICATE-TRAILERS,
 13519           DFHEIV11,
 13520           DFHEIV99
 13521     MOVE EIBRESP  TO WS-RESPONSE
 13522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13523     else
 13524        if ws-resp-notfnd
 13525           move 'CS'             to certificate-trailers
 13526           move cl-company-cd    to cs-company-cd
 13527           move cl-cert-key-data to cs-control-primary (2:21)
 13528           move cl-cert-no       to cs-cert-no
 13529           move 'B'              to cs-trailer-type
 13530           perform varying s1 from +1 by +1 until s1 > +24
 13531              move zeros         to cs-benefit-period (s1)
 13532                                    cs-days-paid (s1)
 13533                                    cs-total-paid (s1)
 13534                                    cs-remaining-bens (s1)
 13535           end-perform
 13536           perform 2225-upd-crt-trlr
 13537                                 thru 2225-exit
 13538
 13539* EXEC CICS WRITE
 13540*             DATASET  (ELCRTT-DSID)
 13541*             from     (CERTIFICATE-TRAILERS)
 13542*             RIDFLD   (cs-control-primary)
 13543*             RESP     (WS-RESPONSE)
 13544*          END-EXEC
 13545     MOVE LENGTH OF
 13546      CERTIFICATE-TRAILERS
 13547       TO DFHEIV11
 13548*    MOVE '&$ L                  ''  N#00012855' TO DFHEIV0
 13549     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13550     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13551     MOVE X'204E233030303132383535' TO DFHEIV0(25:11)
 13552     CALL 'kxdfhei1' USING DFHEIV0,
 13553           ELCRTT-DSID,
 13554           CERTIFICATE-TRAILERS,
 13555           DFHEIV11,
 13556           cs-control-primary,
 13557           DFHEIV99,
 13558           DFHEIV99
 13559     MOVE EIBRESP  TO WS-RESPONSE
 13560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13561        end-if
 13562     END-IF
 13563
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 258
* EL156.cbl
 13564     .
 13565 2220-exit.
 13566     exit.
 13567
 13568 2225-upd-crt-trlr.
 13569
 13570*    if instypei = 'P'
 13571*       move +1 to s1
 13572*    else
 13573*       MOVE +2 to s1
 13574*    end-if
 13575
 13576*    move +1 to s1
 13577*    evaluate cl-claim-type
 13578*       when 'A'
 13579*          move +1 to s2
 13580*       when 'I'
 13581*          move +2 to s2
 13582*       when 'G'
 13583*          move +3 to s2
 13584*       when 'L'
 13585*          move +4 to s2
 13586*       when 'P'
 13587*          move +5 to s2
 13588*    end-evaluate
 13589     perform varying s1 from +1 by +1 until
 13590        (s1 > +24)
 13591        or (cl-claim-no = cs-claim-no (s1))
 13592     end-perform
 13593     if s1 < +25
 13594        compute cs-total-paid (s1) =
 13595           cs-total-paid (s1) + at-amount-paid
 13596        compute cs-days-paid (s1) =
 13597           cs-days-paid (s1) +  at-days-in-period
 13598*       compute cs-remaining-bens (s1) =
 13599*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13600        perform 2230-accum-bens-paid thru 2230-exit
 13601     end-if
 13602
 13603     .
 13604 2225-exit.
 13605     exit.
 13606 2230-accum-bens-paid.
 13607     if cl-claim-type not = 'L' and 'O' and 'P'
 13608        move pi-ah-term          to ws-max-bens
 13609        if cl-critical-period not = zeros and spaces
 13610           move cl-critical-period
 13611                                 to ws-max-bens
 13612        end-if
 13613     else
 13614        move 01                  to ws-max-bens
 13615     end-if
 13616     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13617     perform varying s2 from +1 by +1 until
 13618        (s2 > +24)
 13619        or (cs-claim-no (s2) = spaces)
 13620        if pi-company-id not = 'DCC' and 'VPP'
 13621           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 259
* EL156.cbl
 13622              compute ws-tot-days-paid =
 13623                 ws-tot-days-paid + cs-days-paid (s2)
 13624              compute ws-tot-amt-paid =
 13625                 ws-tot-amt-paid + cs-total-paid (s2)
 13626           end-if
 13627        else
 13628           if (cs-benefit-period (s2) = cl-benefit-period)
 13629              and (cs-claim-type (s2) = cl-claim-type)
 13630              and (cs-insured-type (s2) = cl-insured-type)
 13631              compute ws-tot-days-paid =
 13632                 ws-tot-days-paid + cs-days-paid (s2)
 13633              compute ws-tot-amt-paid =
 13634                 ws-tot-amt-paid + cs-total-paid (s2)
 13635           end-if
 13636        end-if
 13637     end-perform
 13638     if cl-claim-type = 'L' or 'P' or 'O'
 13639        if ws-tot-amt-paid > zeros
 13640           move zeros            to cs-remaining-bens (s1)
 13641        else
 13642           move 01               to cs-remaining-bens (s1)
 13643        end-if
 13644     else
 13645        compute ws-pd-bens rounded =
 13646           ws-tot-amt-paid / pi-ah-benefit-amt
 13647        compute cs-remaining-bens (s1) =
 13648           ws-max-bens - ws-pd-bens
 13649        if cs-remaining-bens (s1) < zeros
 13650           move zeros            to cs-remaining-bens (s1)
 13651        end-if
 13652     end-if
 13653     .
 13654 2230-exit.
 13655     exit.
 13656 3000-MOVE-INPUT-TO-SAVE-AREA.
 13657     IF PMTTYPEL > 0
 13658         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13659
 13660     if ws-pmttype = '4'
 13661        if pi-rb-joint-coverage
 13662           if payeel = +0
 13663              move +2            to payeel
 13664              move al-uanon      to payeea
 13665              move 'Q1'          to payeeo
 13666           else
 13667              if payeei not = 'Q1' and 'q1'
 13668                 move er-1582    to emi-error
 13669                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13670              end-if
 13671           end-if
 13672        end-if
 13673     end-if
 13674     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13675
 13676     IF WS-PMTTYPE = '9'
 13677         MOVE 'P'                TO PI-PROVISIONAL-IND
 13678         MOVE '1'                TO WS-PMTTYPE.
 13679
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 260
* EL156.cbl
 13680     IF PAYEEL > 0
 13681         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13682         MOVE PAYEEI             TO WS-PAYEE.
 13683
 13684     IF NOTE1L > +0
 13685         MOVE NOTE1I             TO WS-PMTNOTE1
 13686                                    WS-FLI-PMTNOTE
 13687                                    WS-HAN-PMTNOTE.
 13688
 13689     IF NOTE2L > +0
 13690         MOVE NOTE2I             TO WS-PMTNOTE2.
 13691
 13692     IF OFFLINEL > 0
 13693         MOVE OFFLINEI           TO WS-OFFLINE.
 13694
 13695     IF PROOFDTL > 0
 13696         MOVE PROOFDTI            TO DATE-WORK
 13697         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13698         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13699         MOVE '4'                 TO DC-OPTION-CODE
 13700         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13701         IF NO-CONVERSION-ERROR
 13702            MOVE NUM-WORK         TO PROOFDTO
 13703            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13704            MOVE NUM-WORK         TO WS-PROOF-DATE
 13705         ELSE
 13706            MOVE ZEROS            TO WS-PROOF-DATE
 13707         END-IF
 13708     END-IF.
 13709
 13710     IF EOBYNL > +0
 13711         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13712         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13713     END-IF
 13714
 13715     IF CLMFMYNL > +0
 13716         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13717         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13718     END-IF
 13719
 13720     IF SURVYYNL > +0
 13721         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13722         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13723     END-IF
 13724
 13725     IF SPRELYNL > +0
 13726         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13727         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13728     END-IF
 13729     if itrbynl <> +0
 13730        move function upper-case(itrbyni) to itrbyni
 13731        move itrbyni             to ws-int-to-rem-borr
 13732     end-if
 13733*    IF GROUPEDL > +0
 13734*        MOVE GROUPEDI           TO WS-GROUPED.
 13735*
 13736*    IF CASHL > +0
 13737*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 261
* EL156.cbl
 13738     IF LOANNOL > +0
 13739         MOVE LOANNOI            TO WS-LOAN-NO.
 13740
 13741     IF CHECKNOL > 0
 13742         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13743
 13744     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13745         IF WS-AIG-CREDIT-ENTERED
 13746             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13747             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13748             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13749             MOVE AL-UANON         TO CHECKNOA.
 13750
 13751     IF HOLDTILL > 0
 13752         MOVE HOLDTILI           TO DATE-WORK
 13753         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13754         MOVE NUM-WORK           TO WS-HOLDTIL.
 13755
 13756     IF ZINTL > +0
 13757
 13758* EXEC CICS BIF DEEDIT
 13759*           FIELD   (ZINTI)
 13760*           LENGTH  (07)
 13761*       END-EXEC
 13762     MOVE 07
 13763       TO DFHEIV11
 13764*    MOVE '@"L                   #   #00013057' TO DFHEIV0
 13765     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13766     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13767     MOVE X'2020233030303133303537' TO DFHEIV0(25:11)
 13768     CALL 'kxdfhei1' USING DFHEIV0,
 13769           ZINTI,
 13770           DFHEIV11
 13771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13772        IF ZINTI NOT NUMERIC
 13773           MOVE ER-0419          TO EMI-ERROR
 13774           PERFORM 9900-ERROR-FORMAT
 13775           MOVE AL-UABON         TO ZINTA
 13776           MOVE -1               TO ZINTL
 13777        ELSE
 13778           MOVE ZINTI            TO CP-INT-RATE
 13779                                    WS-INT-RATE
 13780           MOVE CP-INT-RATE      TO ZINTO
 13781           MOVE AL-UNNON         TO ZINTA
 13782        END-IF
 13783     ELSE
 13784        MOVE ZEROS               TO CP-INT-RATE
 13785     END-IF
 13786     IF EPYFROML > 0
 13787         MOVE EPYFROMI           TO DATE-WORK
 13788         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13789         MOVE NUM-WORK           TO WS-EPYFROM.
 13790
 13791     IF AIGFROML > 0
 13792         MOVE AIGFROMI           TO DATE-WORK
 13793         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13794         MOVE NUM-WORK           TO WS-AIGFROM
 13795     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 262
* EL156.cbl
 13796         IF (AIGFROMI = LOW-VALUES) AND
 13797            (PI-AIGFROM NOT = ZEROS)
 13798              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13799
 13800     IF EPYTHRUL > +0
 13801        MOVE EPYTHRUI           TO DATE-WORK
 13802        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13803        MOVE NUM-WORK           TO WS-EPYTHRU
 13804        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13805        MOVE '4'                TO DC-OPTION-CODE
 13806        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13807        IF NO-CONVERSION-ERROR
 13808           IF PI-USES-PAID-TO
 13809              MOVE '6'                TO DC-OPTION-CODE
 13810              MOVE -1                 TO DC-ELAPSED-DAYS
 13811              MOVE +0                 TO DC-ELAPSED-MONTHS
 13812              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13813              IF NO-CONVERSION-ERROR
 13814                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13815                 MOVE ' '             TO DC-OPTION-CODE
 13816                 MOVE +0              TO DC-ELAPSED-DAYS
 13817                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13818              IF NO-CONVERSION-ERROR
 13819                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13820
 13821*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13822*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13823     IF EDAYSL > 0
 13824
 13825* EXEC CICS BIF DEEDIT
 13826*            FIELD(EDAYSI)
 13827*            LENGTH(6)
 13828*        END-EXEC
 13829     MOVE 6
 13830       TO DFHEIV11
 13831*    MOVE '@"L                   #   #00013113' TO DFHEIV0
 13832     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13833     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13834     MOVE X'2020233030303133313133' TO DFHEIV0(25:11)
 13835     CALL 'kxdfhei1' USING DFHEIV0,
 13836           EDAYSI,
 13837           DFHEIV11
 13838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13839         MOVE EDAYSI             TO WS-DY-WORK
 13840         IF WS-DY-SIGN = SPACES
 13841            MOVE WS-DY-NUM       TO WS-EDAYS
 13842            ADD 0                TO WS-EDAYS
 13843         ELSE
 13844            MOVE EDAYSI          TO WS-EDAYS
 13845            ADD 0                TO WS-EDAYS.
 13846
 13847*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13848*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13849     IF EPYAMTL > 0
 13850
 13851* EXEC CICS BIF DEEDIT
 13852*            FIELD(EPYAMTI)
 13853*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 263
* EL156.cbl
 13854*        END-EXEC
 13855     MOVE 10
 13856       TO DFHEIV11
 13857*    MOVE '@"L                   #   #00013128' TO DFHEIV0
 13858     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13859     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13860     MOVE X'2020233030303133313238' TO DFHEIV0(25:11)
 13861     CALL 'kxdfhei1' USING DFHEIV0,
 13862           EPYAMTI,
 13863           DFHEIV11
 13864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13865         MOVE EPYAMTI            TO WS-PY-WORK
 13866         IF WS-PY-SIGN = SPACES
 13867            MOVE WS-PY-NUM       TO WS-EPYAMT
 13868            ADD 0                TO WS-EPYAMT
 13869         ELSE
 13870            MOVE EPYAMTI         TO WS-EPYAMT
 13871            ADD 0                TO WS-EPYAMT.
 13872
 13873     IF ERESVL > 0
 13874
 13875* EXEC CICS BIF DEEDIT
 13876*            FIELD(ERESVI)
 13877*            LENGTH(9)
 13878*        END-EXEC
 13879     MOVE 9
 13880       TO DFHEIV11
 13881*    MOVE '@"L                   #   #00013141' TO DFHEIV0
 13882     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13883     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13884     MOVE X'2020233030303133313431' TO DFHEIV0(25:11)
 13885     CALL 'kxdfhei1' USING DFHEIV0,
 13886           ERESVI,
 13887           DFHEIV11
 13888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13889         MOVE ERESVI TO WS-ERESV.
 13890
 13891     IF EEXPENSL > 0
 13892
 13893* EXEC CICS BIF DEEDIT
 13894*            FIELD(EEXPENSI)
 13895*            LENGTH(8)
 13896*        END-EXEC
 13897     MOVE 8
 13898       TO DFHEIV11
 13899*    MOVE '@"L                   #   #00013148' TO DFHEIV0
 13900     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13901     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13902     MOVE X'2020233030303133313438' TO DFHEIV0(25:11)
 13903     CALL 'kxdfhei1' USING DFHEIV0,
 13904           EEXPENSI,
 13905           DFHEIV11
 13906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13907         MOVE EEXPENSI           TO WS-EEXPENS.
 13908
 13909     IF ETYPEL > ZEROS
 13910         MOVE ETYPEI             TO WS-ETYPE.
 13911
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 264
* EL156.cbl
 13912     IF PI-COMPANY-ID = 'BOA'
 13913        IF PINTL > ZEROS
 13914
 13915* EXEC CICS BIF DEEDIT
 13916*            FIELD (PINTI)
 13917*            LENGTH(05)
 13918*          END-EXEC
 13919     MOVE 05
 13920       TO DFHEIV11
 13921*    MOVE '@"L                   #   #00013159' TO DFHEIV0
 13922     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13923     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13924     MOVE X'2020233030303133313539' TO DFHEIV0(25:11)
 13925     CALL 'kxdfhei1' USING DFHEIV0,
 13926           PINTI,
 13927           DFHEIV11
 13928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13929           IF PINTI NUMERIC
 13930               MOVE AL-UNNON     TO PINTA
 13931               MOVE PINTI        TO WS-INT-RATE
 13932               MOVE WS-INT-RATE  TO PINTO.
 13933
 13934 3000-EXIT.
 13935     EXIT.
 13936
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 265
* EL156.cbl
 13938 3050-REBUILD-ENTERED.
 13939
 13940     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13941
 13942     IF PI-PROV-PMT
 13943         MOVE '9'           TO PMTTYPEO
 13944     ELSE
 13945         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13946
 13947     MOVE PI-PAYEE          TO PAYEEO.
 13948     MOVE PI-PMTNOTE1       TO NOTE1O.
 13949     MOVE PI-PMTNOTE2       TO NOTE2O.
 13950     MOVE PI-OFFLINE        TO OFFLINEO.
 13951     IF PI-PROOF-DATE NOT = ZEROS
 13952         MOVE PI-PROOF-DATE TO PROOFDTO
 13953         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13954     END-IF.
 13955*    MOVE PI-GROUPED        TO GROUPEDO.
 13956
 13957*    MOVE PI-CASH           TO CASHO.
 13958
 13959     IF PI-INT-RATE > ZEROS
 13960        MOVE PI-INT-RATE         TO PINTO
 13961     end-if
 13962     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13963        IF PI-INT-AMT > ZEROS
 13964           MOVE PI-INT-AMT       TO PINTO
 13965           MOVE AL-PANOF         TO PINTA
 13966                                    PINTHA
 13967           if pi-rb-joint-coverage
 13968              move '  INT TO'    to itrb1o
 13969              move ' REM BORR?'  to itrb2o
 13970              move 'Y'           to itrbyno
 13971              move al-uanon      to itrbyna
 13972              move +1            to itrbynl
 13973           end-if
 13974        END-IF
 13975     END-IF
 13976     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13977     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13978     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13979     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13980     IF PI-HOLDTIL NOT = ZEROS
 13981        MOVE PI-HOLDTIL          TO HOLDTILO
 13982        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13983
 13984     IF PI-EPYFROM NOT = ZEROS
 13985        MOVE PI-EPYFROM          TO EPYFROMO
 13986        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13987
 13988     IF PI-AIGFROM NOT = ZEROS
 13989        MOVE PI-AIGFROM          TO AIGFROMO
 13990        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13991
 13992     IF PI-EPYTHRU NOT = ZEROS
 13993        MOVE PI-EPYTHRU          TO EPYTHRUO
 13994        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13995        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 266
* EL156.cbl
 13996           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13997           MOVE '4'                TO DC-OPTION-CODE
 13998           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13999           IF NO-CONVERSION-ERROR
 14000              MOVE +1 TO DC-ELAPSED-DAYS
 14001              MOVE +0 TO DC-ELAPSED-MONTHS
 14002              MOVE '6' TO DC-OPTION-CODE
 14003              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14004              IF NO-CONVERSION-ERROR
 14005                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 14006
 14007     IF PI-EDAYS NOT = ZEROS
 14008        MOVE PI-EDAYS TO EDAYSO.
 14009
 14010     IF PI-EPYAMT NOT = ZEROS
 14011        MOVE PI-EPYAMT TO EPYAMTO.
 14012
 14013     IF PI-ERESV NOT = ZEROS
 14014        MOVE PI-ERESV TO ERESVO.
 14015
 14016     IF PI-EEXPENS NOT = ZEROS
 14017        MOVE PI-EEXPENS TO EEXPENSO.
 14018
 14019     MOVE PI-ETYPE TO ETYPEO.
 14020
 14021     IF PI-ECHECKNO NOT = SPACES
 14022        MOVE PI-ECHECKNO         TO CHECKNOO
 14023     ELSE
 14024        MOVE PI-CCHECKNO         TO CHECKNOO.
 14025
 14026     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 14027     MOVE SPACES                 TO DC-OPTION-CODE.
 14028     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14029
 14030     IF DATE-CONVERSION-ERROR
 14031        MOVE SPACES              TO CPYFROMI
 14032     ELSE
 14033        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 14034
 14035     IF PI-USES-PAID-TO
 14036        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 14037        MOVE +1                  TO DC-ELAPSED-DAYS
 14038        MOVE +0                  TO DC-ELAPSED-MONTHS
 14039        MOVE '6'                 TO DC-OPTION-CODE
 14040        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14041        IF NO-CONVERSION-ERROR
 14042           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 14043           GO TO 3051-CONTINUE.
 14044
 14045     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 14046     MOVE SPACES                 TO DC-OPTION-CODE.
 14047     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14048
 14049     IF DATE-CONVERSION-ERROR
 14050        MOVE SPACES              TO CPYTHRUI
 14051     ELSE
 14052        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14053
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 267
* EL156.cbl
 14054 3051-CONTINUE.
 14055
 14056     IF PI-CDAYS NOT = ZEROS
 14057        MOVE PI-CDAYS TO CDAYSO.
 14058
 14059     IF PI-CPYAMT NOT = ZEROS
 14060        MOVE PI-CPYAMT TO CPYAMTO.
 14061
 14062     IF PI-CRESV NOT = ZEROS
 14063        MOVE PI-CRESV TO CRESVO.
 14064
 14065     IF PI-CEXPENS NOT = ZEROS
 14066        MOVE PI-CEXPENS TO CEXPENSO.
 14067
 14068 3059-EXIT.
 14069     EXIT.
 14070
 14071 3100-DEEDIT-DATE.
 14072
 14073* EXEC CICS BIF DEEDIT
 14074*        FIELD(DATE-WORK)
 14075*        LENGTH(8)
 14076*    END-EXEC.
 14077     MOVE 8
 14078       TO DFHEIV11
 14079*    MOVE '@"L                   #   #00013306' TO DFHEIV0
 14080     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14081     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14082     MOVE X'2020233030303133333036' TO DFHEIV0(25:11)
 14083     CALL 'kxdfhei1' USING DFHEIV0,
 14084           DATE-WORK,
 14085           DFHEIV11
 14086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14087
 14088
 14089 3100-EXIT.
 14090     EXIT.
 14091
 14092 3200-CALC-AIG-DAYS.
 14093
 14094     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14095
 14096     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14097     MOVE ' '                    TO DC-OPTION-CODE.
 14098     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14099     IF NO-CONVERSION-ERROR
 14100         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14101     ELSE
 14102         GO TO 3290-ERROR.
 14103
 14104     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14105         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14106                                WS-BIN-FROM-DT
 14107     ELSE
 14108         IF CL-TOTAL-PAID-AMT > ZEROS
 14109             IF WS-SV-EPYFROM = LOW-VALUES
 14110                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14111                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 268
* EL156.cbl
 14112             ELSE
 14113                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14114                                        WS-BIN-FROM-DT
 14115         ELSE
 14116             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14117                                        WS-BIN-FROM-DT.
 14118
 14119 3210-CONTINUE.
 14120
 14121     MOVE ' '                    TO DC-OPTION-CODE.
 14122     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14123     IF DATE-CONVERSION-ERROR
 14124         GO TO 3290-ERROR.
 14125
 14126     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14127
 14128     IF PI-LOAN-DUE-DAY = 31
 14129         MOVE 30              TO WS-PMT-DUE-DA
 14130                                 WS-SAVE-DUE-DA
 14131     ELSE
 14132         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14133                                 WS-SAVE-DUE-DA.
 14134
 14135     IF (PI-LOAN-DUE-DAY > 28) AND
 14136        (WS-PMT-DUE-MO = 2)
 14137         MOVE 'Y'                TO WS-DUE-DAY-SW
 14138         MOVE 28                 TO WS-PMT-DUE-DA.
 14139
 14140     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14141     MOVE '4'                    TO DC-OPTION-CODE.
 14142     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14143     IF NO-CONVERSION-ERROR
 14144         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14145     ELSE
 14146         GO TO 3290-ERROR.
 14147
 14148*--------------------------------------------------------------*
 14149*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14150*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14151*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14152*                                                              *
 14153*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14154*             INCURRED DATE      - 04/15/91                    *
 14155*             PMT DUE DATE       - 04/03/91                    *
 14156*             PMT DUE DATE       - 05/03/91                    *
 14157*--------------------------------------------------------------*
 14158
 14159     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14160        (WS-SV-AIGFROM = LOW-VALUES)
 14161         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14162            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14163             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14164             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14165             IF NO-CONVERSION-ERROR
 14166                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14167                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14168             ELSE
 14169                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 269
* EL156.cbl
 14170
 14171     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14172        (WS-SV-AIGFROM = LOW-VALUES)
 14173         GO TO 3205-CONT-CALC-PMT.
 14174
 14175     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14176     MOVE ' '                    TO DC-OPTION-CODE.
 14177     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14178     IF NO-CONVERSION-ERROR
 14179         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14180     ELSE
 14181         GO TO 3290-ERROR.
 14182
 14183     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14184        (WS-PMT-DUE-DA < WS-FROM-DA)
 14185          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14186          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14187          IF NO-CONVERSION-ERROR
 14188              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14189              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14190          ELSE
 14191              GO TO 3290-ERROR.
 14192
 14193 3205-CONT-CALC-PMT.
 14194
 14195*--------------------------------------------------------------*
 14196*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14197*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14198*--------------------------------------------------------------*
 14199
 14200     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14201        PI-PMTTYPE = '2'
 14202          NEXT SENTENCE
 14203     ELSE
 14204        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14205           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14206             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14207             MOVE ER-3527            TO EMI-ERROR
 14208             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14209             MOVE -1                 TO EPYTHRUL
 14210             MOVE AL-UNBON           TO EPYTHRUA
 14211                                        EPYFROMA
 14212             GO TO 3299-EXIT.
 14213
 14214*--------------------------------------------------------------*
 14215*    CALCULATE RETRO ELIMINATION DATE                          *
 14216*--------------------------------------------------------------*
 14217
 14218     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14219         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14220     ELSE
 14221         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14222
 14223     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14224     MOVE +0             TO DC-ELAPSED-MONTHS.
 14225     MOVE '6'            TO DC-OPTION-CODE.
 14226     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14227     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 270
* EL156.cbl
 14228         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14229     ELSE
 14230         GO TO 3290-ERROR.
 14231
 14232 3210-CHECK-PMT-DATE.
 14233
 14234*--------------------------------------------------------------*
 14235*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14236*    THE ENTERED PAY FROM DATE                                 *
 14237*--------------------------------------------------------------*
 14238
 14239     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14240         NEXT SENTENCE
 14241     ELSE
 14242         GO TO 3220-COMPUTE-DAYS.
 14243
 14244     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14245     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14246     IF NO-CONVERSION-ERROR
 14247         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14248         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14249         GO TO 3210-CHECK-PMT-DATE
 14250     ELSE
 14251         GO TO 3290-ERROR.
 14252
 14253 3220-COMPUTE-DAYS.
 14254
 14255     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14256     MOVE ZEROS         TO WS-CDAYS.
 14257     MOVE 'N'           TO WS-ELIMINATION-SW.
 14258
 14259*--------------------------------------------------------------*
 14260*    COMPUTE CALIFORNIA DUE DAYS                               *
 14261*--------------------------------------------------------------*
 14262
 14263     IF CL-TOTAL-PAID-AMT > ZEROS
 14264         MOVE 'Y' TO WS-ELIMINATION-SW
 14265         GO TO 3240-FIRST-PMT-DUE
 14266     ELSE
 14267        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14268            NEXT SENTENCE
 14269        ELSE
 14270            GO TO 3240-FIRST-PMT-DUE.
 14271
 14272 3230-NEXT-PMT-DUE.
 14273
 14274     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14275     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14276     IF NO-CONVERSION-ERROR
 14277         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14278         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14279     ELSE
 14280         GO TO 3290-ERROR.
 14281
 14282 3240-FIRST-PMT-DUE.
 14283
 14284     IF CL-TOTAL-PAID-AMT > ZEROS
 14285         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 271
* EL156.cbl
 14286     ELSE
 14287        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14288            GO TO 3230-NEXT-PMT-DUE.
 14289
 14290     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14291         GO TO 3250-VERIFY-ELIMINATION.
 14292
 14293     ADD +30 TO WS-CDAYS.
 14294     MOVE 'Y' TO WS-ELIMINATION-SW.
 14295     GO TO 3230-NEXT-PMT-DUE.
 14296
 14297 3250-VERIFY-ELIMINATION.
 14298
 14299     IF ELIM-SATISFIED
 14300         GO TO 3260-END-CALC.
 14301
 14302     IF PI-PMTTYPE = '1'
 14303         MOVE ZEROS TO WS-CDAYS
 14304         GO TO 3260-END-CALC.
 14305
 14306     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14307         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14308     ELSE
 14309         IF CL-TOTAL-PAID-AMT > ZEROS
 14310             IF WS-SV-EPYFROM = LOW-VALUES
 14311                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14312             ELSE
 14313                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14314         ELSE
 14315             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14316
 14317     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14318     MOVE '1'                    TO DC-OPTION-CODE.
 14319     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14320     IF NO-CONVERSION-ERROR
 14321         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14322     ELSE
 14323         GO TO 3290-ERROR.
 14324
 14325     IF CL-TOTAL-PAID-AMT > ZEROS
 14326         MOVE WS-DAYS-OFF TO WS-CDAYS
 14327     ELSE
 14328         IF PI-BEN-DAYS > WS-DAYS-OFF
 14329             MOVE ZEROS TO WS-CDAYS
 14330         ELSE
 14331             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14332
 14333 3260-END-CALC.
 14334
 14335     MOVE WS-CDAYS TO PI-CDAYS.
 14336
 14337     IF PI-EDAYS = ZEROS
 14338         MOVE PI-CDAYS TO PI-EDAYS
 14339         MOVE AL-UNNON TO EDAYSA.
 14340
 14341     GO TO 3299-EXIT.
 14342
 14343 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 272
* EL156.cbl
 14344
 14345     MOVE ER-3528            TO EMI-ERROR.
 14346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14347     MOVE -1                 TO CDAYSL.
 14348     MOVE AL-UNBON           TO CDAYSA.
 14349
 14350 3299-EXIT.
 14351     EXIT.
 14352
 14353 3300-BUMP-DATE.
 14354
 14355     IF WS-RESTORE-DUE-DAY
 14356         MOVE 'N'              TO WS-DUE-DAY-SW
 14357         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14358         ADD 1                 TO WS-PMT-DUE-MO
 14359         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14360         MOVE '4'              TO DC-OPTION-CODE
 14361         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14362         IF NO-CONVERSION-ERROR
 14363             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14364             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14365             GO TO 3399-EXIT
 14366         ELSE
 14367             MOVE '9'          TO DC-ERROR-CODE
 14368             GO TO 3399-EXIT.
 14369
 14370     IF (WS-PMT-DUE-MO = 1) AND
 14371        (WS-SAVE-DUE-DA > 28)
 14372           MOVE 'Y' TO WS-DUE-DAY-SW.
 14373
 14374     MOVE +0                 TO DC-ELAPSED-DAYS.
 14375     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14376     MOVE '6'                TO DC-OPTION-CODE.
 14377     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14378
 14379 3399-EXIT.
 14380     EXIT.
 14381
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 273
* EL156.cbl
 14383 3400-COMPUTE-EXPIRY.
 14384
 14385     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14386     MOVE +0                    TO DC-ELAPSED-DAYS
 14387                                   DC-ODD-DAYS-OVER.
 14388     MOVE '1'                   TO DC-END-OF-MONTH.
 14389     MOVE '6'                   TO DC-OPTION-CODE.
 14390
 14391     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 14392         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14393     ELSE
 14394         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14395
 14396     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14397     IF NO-CONVERSION-ERROR
 14398         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14399     ELSE
 14400         GO TO 3390-CONTINUE.
 14401
 14402     IF CL-CLAIM-TYPE NOT = (PI-LIFE-OVERRIDE-L1 OR 'O')
 14403         GO TO 3390-CONTINUE.
 14404
 14405     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14406     MOVE '4'                    TO CNTL-REC-TYPE.
 14407     MOVE +0                     TO CNTL-SEQ-NO.
 14408     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14409     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14410     MOVE 'BENE'                 TO FILE-SWITCH.
 14411
 14412     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14413
 14414     IF NO-BENEFIT-FOUND
 14415         GO TO 3390-CONTINUE.
 14416
 14417     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14418        IF (PI-OFFLINE = 'Y') OR
 14419           (PI-PMTTYPE = '7')
 14420           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14421                                     THRU 9870-EXIT
 14422           IF ERROR-ON-OUTPUT
 14423             MOVE -1                 TO ENTERPFL
 14424             MOVE AL-UANON           TO ENTERPFA
 14425             MOVE MAP-NAMEA          TO MAP-NAME
 14426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14427             GO TO 8200-SEND-DATAONLY.
 14428
 14429     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')  AND
 14430        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14431        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14432          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14433          MOVE +0        TO DC-ELAPSED-DAYS
 14434          MOVE +1        TO DC-ELAPSED-MONTHS
 14435          MOVE 6         TO DC-OPTION-CODE
 14436          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14437          IF NO-CONVERSION-ERROR
 14438              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14439
 14440 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 274
* EL156.cbl
 14441
 14442      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14443         MOVE CM-AH-LOAN-EXPIRE-DT
 14444                                 TO DC-BIN-DATE-1
 14445      ELSE
 14446         MOVE CM-LF-LOAN-EXPIRE-DT
 14447                                 TO DC-BIN-DATE-1
 14448      END-IF
 14449
 14450      MOVE ' '                    TO DC-OPTION-CODE.
 14451      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14452      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14453      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14454
 14455 3499-EXIT.
 14456     EXIT.
 14457
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 275
* EL156.cbl
 14459
 14460 3600-CHECK-VERIFICATION.
 14461
 14462     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14463
 14464     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14465
 14466     IF PI-PAYEE-TYPE = 'I'
 14467        GO TO 3600-READ-TRAILER.
 14468
 14469     IF PI-PAYEE-TYPE = 'B'
 14470        ADD +10                  TO TRLR-SEQ-NO
 14471        GO TO 3600-READ-TRAILER.
 14472
 14473     IF PI-PAYEE-TYPE = 'A'
 14474        ADD +20                  TO TRLR-SEQ-NO
 14475        GO TO 3600-READ-TRAILER.
 14476
 14477     IF PI-PAYEE-TYPE = 'O'
 14478        ADD +50                  TO TRLR-SEQ-NO
 14479        GO TO 3600-READ-TRAILER.
 14480
 14481     IF PI-PAYEE-TYPE = 'Q'
 14482        ADD +60                  TO TRLR-SEQ-NO
 14483        GO TO 3600-READ-TRAILER.
 14484
 14485     IF PI-PAYEE-TYPE = 'P'
 14486        ADD +30                  TO TRLR-SEQ-NO
 14487        GO TO 3600-READ-TRAILER.
 14488
 14489     IF PI-PAYEE-TYPE = 'E'
 14490        ADD +40                  TO TRLR-SEQ-NO.
 14491
 14492 3600-READ-TRAILER.
 14493
 14494
 14495* EXEC CICS HANDLE CONDITION
 14496*         NOTFND(3600-CONTINUE)
 14497*    END-EXEC.
 14498*    MOVE '"$I                   ! - #00013716' TO DFHEIV0
 14499     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14501     MOVE X'2D20233030303133373136' TO DFHEIV0(25:11)
 14502     CALL 'kxdfhei1' USING DFHEIV0
 14503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14504
 14505
 14506     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14507
 14508 3600-CONTINUE.
 14509
 14510     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 14511         GO TO 3600-AH-VERIFY
 14512     END-IF.
 14513
 14514     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14515       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14516         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 276
* EL156.cbl
 14517           MOVE ER-7576            TO EMI-ERROR
 14518           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14519           MOVE -1                 TO PAYEEL
 14520           MOVE AL-UABON           TO PAYEEA
 14521           GO TO 3600-EXIT
 14522         END-IF
 14523       END-IF
 14524     END-IF.
 14525
 14526     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14527     MOVE 1 TO WS-SUB2
 14528     MOVE SPACES TO WS-PAYEE-NAME
 14529     PERFORM VARYING WS-SUB FROM 1 BY 1
 14530             UNTIL WS-SUB > 30
 14531         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14532            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14533                 WS-PAYEE-NAME-X (WS-SUB2)
 14534            ADD +1 TO WS-SUB2
 14535         END-IF
 14536     END-PERFORM.
 14537
 14538     STRING CL-INSURED-1ST-NAME
 14539            CL-INSURED-MID-INIT
 14540            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14541     MOVE 1 TO WS-SUB2
 14542     MOVE SPACES TO WS-INSURED-NAME
 14543     PERFORM VARYING WS-SUB FROM 1 BY 1
 14544             UNTIL WS-SUB > 30
 14545         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14546            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14547                 WS-INSURED-NAME-X (WS-SUB2)
 14548            ADD +1 TO WS-SUB2
 14549         END-IF
 14550     END-PERFORM.
 14551
 14552     IF CL-CLAIM-TYPE = 'O'
 14553        IF WS-PAYEE-NAME (1:6) = 'ESTATE'
 14554           MOVE ER-7585            TO EMI-ERROR
 14555           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14556           MOVE -1                 TO PAYEEL
 14557           MOVE AL-UABON           TO PAYEEA
 14558        ELSE
 14559           GO TO 3600-EXIT
 14560        END-IF
 14561     END-IF.
 14562     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14563        MOVE ER-7579            TO EMI-ERROR
 14564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14565        MOVE -1                 TO PAYEEL
 14566        MOVE AL-UABON           TO PAYEEA
 14567     END-IF.
 14568
 14569     IF PI-PMTTYPE = '4'  AND
 14570        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14571        PI-PAYEE-TYPE <> 'I'
 14572          MOVE ER-7580          TO EMI-ERROR
 14573          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14574          MOVE -1               TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 277
* EL156.cbl
 14575          MOVE AL-UABON         TO PAYEEA
 14576     END-IF.
 14577
 14578     GO TO 3600-EXIT.
 14579
 14580 3600-AH-VERIFY.
 14581
 14582     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14583        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14584           MOVE ER-7583            TO EMI-ERROR
 14585           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14586           MOVE -1                 TO PAYEEL
 14587           MOVE AL-UABON           TO PAYEEA
 14588        END-IF
 14589     END-IF.
 14590
 14591
 14592 3600-EXIT.
 14593     EXIT.
 14594
 14595 5000-UPDATE.
 14596
 14597     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14598
 14599     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14600
 14601     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14602        PI-OFFLINE = 'Y'
 14603        NEXT SENTENCE
 14604     ELSE
 14605        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14606
 14607*    IF PI-COMPANY-ID = 'CRI'
 14608*       IF PI-PMTTYPE = '1' OR  '2'
 14609*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14610*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14611*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14612
 14613*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14614*       IF PI-PMTTYPE = '1'
 14615*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14616*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14617
 14618     IF PI-PMTTYPE      = '2' AND
 14619        PI-SPLIT-PMT-SW = 'Y' AND
 14620        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 14621          MOVE ER-3530                TO EMI-ERROR
 14622          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14623
 14624     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14625        AND (CL-CLAIM-TYPE = 'L' OR 'O')
 14626        IF PI-PMTTYPE = '2' OR '4'
 14627           IF PI-INT-AMT NOT = ZEROS
 14628              PERFORM 7110-BUILD-PMT-TRLR
 14629                                 THRU 7130-EXIT
 14630           ELSE
 14631              IF PI-PMTTYPE = '2'
 14632                 PERFORM 7140-BUILD-NOTE-TRLR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 278
* EL156.cbl
 14633                                 THRU 7170-EXIT
 14634              END-IF
 14635           END-IF
 14636        END-IF
 14637     END-IF
 14638*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14639*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14640*            MOVE 'N'                 TO  WS-LETTER-SW.
 14641
 14642*    IF PI-COMPANY-ID = 'DMD'
 14643*        IF CL-NO-OF-PMTS-MADE = +1
 14644*                OR
 14645*           PI-PMTTYPE = '2'
 14646*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14647
 14648     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14649
 14650*    IF PI-COMPANY-ID = 'DMD'
 14651*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14652*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14653
 14654
 14655* EXEC CICS REWRITE
 14656*         DATASET('ELMSTR')
 14657*         FROM(CLAIM-MASTER)
 14658*     END-EXEC.
 14659     MOVE LENGTH OF
 14660      CLAIM-MASTER
 14661       TO DFHEIV11
 14662     MOVE 'ELMSTR' TO DFHEIV1
 14663*    MOVE '&& L                  %   #00013868' TO DFHEIV0
 14664     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14665     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14666     MOVE X'2020233030303133383638' TO DFHEIV0(25:11)
 14667     CALL 'kxdfhei1' USING DFHEIV0,
 14668           DFHEIV1,
 14669           CLAIM-MASTER,
 14670           DFHEIV11,
 14671           DFHEIV99
 14672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14673
 14674
 14675     IF WS-LETTER-SW = 'N'
 14676         GO TO 5000-END-UPDATE.
 14677
 14678 5000-GENERATE-AUTO-LETTER.
 14679
 14680
 14681* EXEC CICS LINK
 14682*        PROGRAM    (LINK-1523)
 14683*        COMMAREA   (W-1523-LINKDATA)
 14684*        LENGTH     (W-1523-COMM-LENGTH)
 14685*    END-EXEC.
 14686*    MOVE '."C                   (   #00013878' TO DFHEIV0
 14687     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14689     MOVE X'2020233030303133383738' TO DFHEIV0(25:11)
 14690     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 279
* EL156.cbl
 14691           LINK-1523,
 14692           W-1523-LINKDATA,
 14693           W-1523-COMM-LENGTH,
 14694           DFHEIV99,
 14695           DFHEIV99,
 14696           DFHEIV99,
 14697           DFHEIV99
 14698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14699
 14700
 14701     IF W-1523-FATAL-ERROR
 14702         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14704         MOVE ER-0802                TO  EMI-ERROR
 14705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14706
 14707     IF W-1523-ERROR-CODE = 0191
 14708         MOVE ER-0803                TO  EMI-ERROR
 14709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14710
 14711     IF PI-COMPANY-ID      = 'HAN' AND
 14712        PI-PMTTYPE         = '1'   AND
 14713        PI-3RD-PARTY-SW    = 'Y'   AND
 14714        W-1523-FORM-NUMBER = 'EOB1'
 14715           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14716           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14717           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14718           GO TO 5000-GENERATE-AUTO-LETTER.
 14719
 14720 5000-END-UPDATE.
 14721
 14722     MOVE ER-0000                TO EMI-ERROR.
 14723     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14724     GO TO 7000-SHOW-CLAIM.
 14725
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 280
* EL156.cbl
 14727 5000-MOVE-NAME.
 14728     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14729     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14730     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14731
 14732 5000-EXIT.
 14733     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 281
* EL156.cbl
 14735 5300-CREATE-DMO.
 14736
 14737     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14738     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14739     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14740
 14741
 14742* EXEC CICS HANDLE CONDITION
 14743*         NOTFND   (5300-NOTE-NOT-FOUND)
 14744*    END-EXEC.
 14745*    MOVE '"$I                   ! . #00013924' TO DFHEIV0
 14746     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14748     MOVE X'2E20233030303133393234' TO DFHEIV0(25:11)
 14749     CALL 'kxdfhei1' USING DFHEIV0
 14750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14751
 14752
 14753
 14754* EXEC CICS READ
 14755*         DATASET('ERNOTE')
 14756*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14757*         RIDFLD (W-NOTE-KEY)
 14758*    END-EXEC.
 14759     MOVE 'ERNOTE' TO DFHEIV1
 14760*    MOVE '&"S        E          (   #00013928' TO DFHEIV0
 14761     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14763     MOVE X'2020233030303133393238' TO DFHEIV0(25:11)
 14764     CALL 'kxdfhei1' USING DFHEIV0,
 14765           DFHEIV1,
 14766           DFHEIV20,
 14767           DFHEIV99,
 14768           W-NOTE-KEY,
 14769           DFHEIV99,
 14770           DFHEIV99,
 14771           DFHEIV99
 14772     SET ADDRESS OF CERTIFICATE-NOTE TO
 14773         DFHEIV20
 14774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14775
 14776
 14777     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14778     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14779     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14780
 14781     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14782         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14783     ELSE
 14784         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14785
 14786     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14787     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14788     MOVE 'DLO006'               TO PGM-NAME.
 14789
 14790
 14791* EXEC CICS LINK
 14792*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 282
* EL156.cbl
 14793*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14794*        LENGTH     (DCT-RCRD-LENGTH)
 14795*    END-EXEC.
 14796*    MOVE '."C                   (   #00013947' TO DFHEIV0
 14797     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14799     MOVE X'2020233030303133393437' TO DFHEIV0(25:11)
 14800     CALL 'kxdfhei1' USING DFHEIV0,
 14801           PGM-NAME,
 14802           DCT-COMMUNICATION-AREA,
 14803           DCT-RCRD-LENGTH,
 14804           DFHEIV99,
 14805           DFHEIV99,
 14806           DFHEIV99,
 14807           DFHEIV99
 14808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14809
 14810
 14811     IF DCT-RETURN-CODE = 'OK'
 14812         GO TO 5300-CONT.
 14813
 14814     IF DCT-RETURN-CODE = '01' OR '02'
 14815         GO TO 5300-EXIT.
 14816
 14817     IF DCT-RETURN-CODE = '03'
 14818         MOVE ER-0951            TO EMI-ERROR
 14819         GO TO 5300-BAD-EXIT.
 14820
 14821     IF DCT-RETURN-CODE = '04'
 14822         MOVE ER-0946            TO EMI-ERROR
 14823         GO TO 5300-BAD-EXIT.
 14824
 14825     IF DCT-RETURN-CODE = '05'
 14826         MOVE ER-0947            TO EMI-ERROR
 14827         GO TO 5300-BAD-EXIT.
 14828
 14829     IF DCT-RETURN-CODE = '06'
 14830         MOVE ER-0921            TO EMI-ERROR
 14831         GO TO 5300-BAD-EXIT.
 14832
 14833     IF DCT-RETURN-CODE = '07'
 14834         MOVE ER-0849            TO EMI-ERROR
 14835         GO TO 5300-BAD-EXIT.
 14836
 14837     IF DCT-RETURN-CODE = '08'
 14838         MOVE ER-0948            TO EMI-ERROR
 14839         GO TO 5300-BAD-EXIT.
 14840
 14841     IF DCT-RETURN-CODE = 'N1'
 14842         MOVE ER-0950            TO EMI-ERROR
 14843         GO TO 5300-BAD-EXIT.
 14844
 14845     IF DCT-RETURN-CODE = 'E1'
 14846         MOVE ER-0974            TO EMI-ERROR
 14847         GO TO 5300-BAD-EXIT.
 14848
 14849     IF DCT-RETURN-CODE = 'E2'
 14850         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 283
* EL156.cbl
 14851         GO TO 5300-BAD-EXIT.
 14852
 14853     IF DCT-RETURN-CODE NOT = 'OK'
 14854         MOVE ER-0949            TO EMI-ERROR
 14855         GO TO 5300-BAD-EXIT.
 14856
 14857 5300-CONT.
 14858
 14859     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14860     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14861     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14862     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14863     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14864     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14865     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14866     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14867
 14868     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14869     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14870     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14871     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14872     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14873
 14874     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14875
 14876     IF PI-PMTTYPE = '2'
 14877         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14878         MOVE '4'                TO DM-CLAIM-STATUS
 14879     ELSE
 14880         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14881         MOVE '2'                TO DM-CLAIM-STATUS.
 14882
 14883     MOVE 'DLO025'               TO PGM-NAME.
 14884
 14885
 14886* EXEC CICS LINK
 14887*        PROGRAM    (PGM-NAME)
 14888*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14889*        LENGTH     (DM-DMO-LENGTH)
 14890*    END-EXEC.
 14891*    MOVE '."C                   (   #00014027' TO DFHEIV0
 14892     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14894     MOVE X'2020233030303134303237' TO DFHEIV0(25:11)
 14895     CALL 'kxdfhei1' USING DFHEIV0,
 14896           PGM-NAME,
 14897           DMO-COMMUNICATION-AREA,
 14898           DM-DMO-LENGTH,
 14899           DFHEIV99,
 14900           DFHEIV99,
 14901           DFHEIV99,
 14902           DFHEIV99
 14903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14904
 14905
 14906     IF DM-RETURN-CODE = 'OK'
 14907         GO TO 5300-EXIT.
 14908
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 284
* EL156.cbl
 14909     IF DM-RETURN-CODE = '01'
 14910         MOVE ER-8051            TO EMI-ERROR
 14911         GO TO 5300-BAD-EXIT.
 14912
 14913     IF DM-RETURN-CODE = '02'
 14914         MOVE ER-8052            TO EMI-ERROR
 14915         GO TO 5300-BAD-EXIT.
 14916
 14917     IF DM-RETURN-CODE = '03'
 14918         MOVE ER-8053            TO EMI-ERROR
 14919         GO TO 5300-BAD-EXIT.
 14920
 14921     IF DM-RETURN-CODE = '04'
 14922         MOVE ER-8054            TO EMI-ERROR
 14923         GO TO 5300-BAD-EXIT.
 14924
 14925     IF DM-RETURN-CODE = '05'
 14926         MOVE ER-8055            TO EMI-ERROR
 14927         GO TO 5300-BAD-EXIT.
 14928
 14929     IF DM-RETURN-CODE = '06'
 14930         MOVE ER-8056            TO EMI-ERROR
 14931         GO TO 5300-BAD-EXIT.
 14932
 14933     IF DM-RETURN-CODE = '07'
 14934         MOVE ER-8057            TO EMI-ERROR
 14935         GO TO 5300-BAD-EXIT.
 14936
 14937     IF DM-RETURN-CODE = '08'
 14938         MOVE ER-8058            TO EMI-ERROR
 14939         GO TO 5300-BAD-EXIT.
 14940
 14941     IF DM-RETURN-CODE = '09'
 14942         MOVE ER-8059            TO EMI-ERROR
 14943         GO TO 5300-BAD-EXIT.
 14944
 14945     IF DM-RETURN-CODE = '10'
 14946         MOVE ER-8060            TO EMI-ERROR
 14947         GO TO 5300-BAD-EXIT.
 14948
 14949     IF DM-RETURN-CODE = '11'
 14950         MOVE ER-8061            TO EMI-ERROR
 14951         GO TO 5300-BAD-EXIT.
 14952
 14953     IF DM-RETURN-CODE = '12'
 14954         MOVE ER-8062            TO EMI-ERROR
 14955         GO TO 5300-BAD-EXIT.
 14956
 14957     IF DM-RETURN-CODE = '13'
 14958         MOVE ER-8063            TO EMI-ERROR
 14959         GO TO 5300-BAD-EXIT.
 14960
 14961     IF DM-RETURN-CODE = '14'
 14962         MOVE ER-8064            TO EMI-ERROR
 14963         GO TO 5300-BAD-EXIT.
 14964
 14965     IF DM-RETURN-CODE = '15'
 14966         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 285
* EL156.cbl
 14967         GO TO 5300-BAD-EXIT.
 14968
 14969     IF DM-RETURN-CODE = '16'
 14970         MOVE ER-8154            TO EMI-ERROR
 14971         GO TO 5300-BAD-EXIT.
 14972
 14973     IF DM-RETURN-CODE = '17'
 14974         MOVE ER-8155            TO EMI-ERROR
 14975         GO TO 5300-BAD-EXIT.
 14976
 14977     IF DM-RETURN-CODE = 'N1'
 14978         MOVE ER-8152            TO EMI-ERROR
 14979         GO TO 5300-BAD-EXIT.
 14980
 14981     IF DM-RETURN-CODE = 'E1'
 14982         MOVE ER-8153            TO EMI-ERROR
 14983         GO TO 5300-BAD-EXIT.
 14984
 14985     MOVE ER-8066            TO EMI-ERROR.
 14986     GO TO 5300-BAD-EXIT.
 14987
 14988 5300-NOTE-NOT-FOUND.
 14989
 14990     MOVE ER-0954                TO EMI-ERROR.
 14991     GO TO 5300-BAD-EXIT.
 14992
 14993 5300-BAD-EXIT.
 14994
 14995* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14996*    MOVE '6"R                   !   #00014121' TO DFHEIV0
 14997     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14998     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14999     MOVE X'2020233030303134313231' TO DFHEIV0(25:11)
 15000     CALL 'kxdfhei1' USING DFHEIV0
 15001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15002
 15003     IF MAP-NAME = 'EL156A'
 15004         MOVE -1             TO ENTERPFL
 15005       ELSE
 15006         MOVE LOW-VALUES     TO EL156BI
 15007         MOVE -1             TO ENTPFBL.
 15008
 15009     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15010     GO TO 8200-SEND-DATAONLY.
 15011
 15012 5300-EXIT.
 15013     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 286
* EL156.cbl
 15015 5350-FORMAT-LAST-NAME-1ST.
 15016*****************************************************************
 15017*             M O V E   N A M E   R O U T I N E                 *
 15018*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15019*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15020*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15021*                  FIELD                   VALUE                *
 15022*           W-NAME-LAST    (CL15)      SMITH                    *
 15023*           W-NAME-FIRST   (CL15)      JOHN                     *
 15024*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 15025*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15026*     CONTAIN                                                   *
 15027*                SMITH, JOHN ALLEN                              *
 15028*     OR                                                        *
 15029*                SMITH, JOHN A.                                 *
 15030*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15031*     COPYBOOK, ELCNWA.                                         *
 15032*****************************************************************.
 15033
 15034     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 15035     MOVE ZERO                   TO  WS-NAME-SW.
 15036     SET NWA-INDEX               TO +1.
 15037
 15038     IF W-NAME-LAST   = SPACES AND
 15039        W-NAME-MIDDLE = SPACES
 15040         MOVE +1                 TO WS-NAME-SW.
 15041
 15042     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15043     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15044
 15045     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15046     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15047
 15048     SET NWA-INDEX UP BY +1.
 15049
 15050     IF W-NAME-MIDDLE NOT = SPACES
 15051         IF W-NAME-MIDDLE-2 = SPACES
 15052             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15053             SET NWA-INDEX UP BY +1
 15054             MOVE '.'            TO WS-NW (NWA-INDEX)
 15055             SET NWA-INDEX UP BY +2
 15056         ELSE
 15057             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15058             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15059
 15060 5350-EXIT.
 15061     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 287
* EL156.cbl
 15063 5360-MOVE-NAME.
 15064
 15065     IF WS-NAME-SW > +1
 15066         GO TO 5360-EXIT.
 15067
 15068     IF WS-NAME-WORK2 = SPACES
 15069         GO TO 5360-EXIT.
 15070
 15071     SET NWA-INDEX2            TO +1.
 15072     SET NWA-INDEX3            TO +2.
 15073
 15074 5360-MOVE-NAME-CYCLE.
 15075
 15076     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15077
 15078     IF NWA-INDEX < +30
 15079         SET NWA-INDEX UP BY +1
 15080     ELSE
 15081         ADD +2                TO  WS-NAME-SW
 15082         GO TO 5360-EXIT.
 15083
 15084     IF NWA-INDEX2 < +20
 15085         SET NWA-INDEX3 UP BY +1
 15086         SET NWA-INDEX2 UP BY +1.
 15087
 15088     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15089        WS-NW2 (NWA-INDEX3) = SPACES
 15090         IF WS-NAME-SW = ZERO
 15091             MOVE ','            TO  WS-NW (NWA-INDEX)
 15092             SET NWA-INDEX UP BY +2
 15093             MOVE +1             TO  WS-NAME-SW
 15094             GO TO 5360-EXIT
 15095         ELSE
 15096             GO TO 5360-EXIT.
 15097
 15098     GO TO 5360-MOVE-NAME-CYCLE.
 15099
 15100 5360-EXIT.
 15101     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 288
* EL156.cbl
 15103 6000-BUILD-SCREEN-B.
 15104     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15105     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15106     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15107     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15108
 15109     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15110
 15111 6050-BUILD-SCREEN.
 15112     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15113     MOVE LOW-VALUES             TO EL156BI.
 15114     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15115
 15116     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15117
 15118     IF PI-PAYEE-TYPE = 'I'
 15119        GO TO 6060-READ-TRAILER.
 15120
 15121     IF PI-PAYEE-TYPE = 'B'
 15122        ADD +10                  TO TRLR-SEQ-NO
 15123        GO TO 6060-READ-TRAILER.
 15124
 15125     IF PI-PAYEE-TYPE = 'A'
 15126        ADD +20                  TO TRLR-SEQ-NO
 15127        GO TO 6060-READ-TRAILER.
 15128
 15129     IF PI-PAYEE-TYPE = 'O'
 15130        ADD +50                  TO TRLR-SEQ-NO
 15131        GO TO 6060-READ-TRAILER.
 15132
 15133     IF PI-PAYEE-TYPE = 'Q'
 15134        ADD +60                  TO TRLR-SEQ-NO
 15135        GO TO 6060-READ-TRAILER.
 15136
 15137     IF PI-PAYEE-TYPE = 'P'
 15138        ADD +30                  TO TRLR-SEQ-NO
 15139        GO TO 6060-READ-TRAILER.
 15140
 15141     IF PI-PAYEE-TYPE = 'E'
 15142        ADD +40                  TO TRLR-SEQ-NO.
 15143
 15144 6060-READ-TRAILER.
 15145
 15146     IF PI-PAYEE-TYPE    = 'A' AND
 15147        PI-PAYEE-SEQ-NUM = 0
 15148          GO TO 6061-READ-ACCOUNT.
 15149
 15150     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15151        (PI-PAYEE-TYPE    = 'B')             AND
 15152        (PI-PAYEE-SEQ-NUM = 9)
 15153          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15154          IF BENE-FOUND-SW = 'N'
 15155            GO TO 6065-NOT-FOUND
 15156          ELSE
 15157            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15158            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15159            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15160*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 289
* EL156.cbl
 15161            STRING BE-CITY ' ' BE-STATE
 15162               DELIMITED BY '  ' INTO CITYSTBO
 15163            END-STRING
 15164            MOVE BE-ZIP-CODE       TO ZIPBO
 15165            GO TO 6061-READ-ACCOUNT.
 15166
 15167     IF PI-PAYEE-TYPE    = 'B' AND
 15168        PI-PAYEE-SEQ-NUM = 0
 15169          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15170          IF BENE-FOUND-SW = 'N'
 15171            GO TO 6065-NOT-FOUND
 15172          ELSE
 15173            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15174            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15175            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15176*           MOVE BE-CITY-STATE     TO CITYSTBO
 15177            STRING BE-CITY ' ' BE-STATE
 15178               DELIMITED BY '  ' INTO CITYSTBO
 15179            END-STRING
 15180            MOVE BE-ZIP-CODE       TO ZIPBO
 15181            if be-ach-yes-or-no = 'Y'
 15182               move 'Y'          to pi-ach-payment
 15183            else
 15184               move 'N'          to pi-ach-payment
 15185            end-if
 15186            GO TO 6061-READ-ACCOUNT.
 15187
 15188
 15189* EXEC CICS HANDLE CONDITION
 15190*         NOTFND(6065-NOT-FOUND)
 15191*     END-EXEC.
 15192*    MOVE '"$I                   ! / #00014307' TO DFHEIV0
 15193     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15195     MOVE X'2F20233030303134333037' TO DFHEIV0(25:11)
 15196     CALL 'kxdfhei1' USING DFHEIV0
 15197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15198
 15199
 15200     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15201
 15202     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15203     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15204     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15205     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15206*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15207     STRING AT-CITY ' ' AT-STATE
 15208        DELIMITED BY '  ' INTO CITYSTBO
 15209     END-STRING
 15210     MOVE AT-ZIP-CODE            TO ZIPBO.
 15211
 15212 6061-READ-ACCOUNT.
 15213
 15214* EXEC CICS HANDLE CONDITION
 15215*         NOTFND(6068-ACCT-NOT-FND)
 15216*     END-EXEC.
 15217*    MOVE '"$I                   ! 0 #00014324' TO DFHEIV0
 15218     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 290
* EL156.cbl
 15219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15220     MOVE X'3020233030303134333234' TO DFHEIV0(25:11)
 15221     CALL 'kxdfhei1' USING DFHEIV0
 15222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15223
 15224
 15225
 15226* EXEC CICS READ
 15227*         DATASET('ERACCT')
 15228*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15229*         RIDFLD (PI-ACCT-KEY)
 15230*     END-EXEC.
 15231     MOVE 'ERACCT' TO DFHEIV1
 15232*    MOVE '&"S        E          (   #00014328' TO DFHEIV0
 15233     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15235     MOVE X'2020233030303134333238' TO DFHEIV0(25:11)
 15236     CALL 'kxdfhei1' USING DFHEIV0,
 15237           DFHEIV1,
 15238           DFHEIV20,
 15239           DFHEIV99,
 15240           PI-ACCT-KEY,
 15241           DFHEIV99,
 15242           DFHEIV99,
 15243           DFHEIV99
 15244     SET ADDRESS OF ACCOUNT-MASTER TO
 15245         DFHEIV20
 15246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15247
 15248
 15249     MOVE AM-CARRIER             TO ACARRBO.
 15250     MOVE AM-GROUPING            TO GROUPBO.
 15251     MOVE AM-STATE               TO STATEBO.
 15252     MOVE AM-ACCOUNT             TO ACCTBO.
 15253     MOVE AM-NAME                TO ACCTNMBO.
 15254
 15255     IF PI-PAYEE-TYPE = 'A' AND
 15256        PI-PAYEE-SEQ-NUM = 0
 15257          MOVE AM-NAME             TO NAMEBO
 15258                                      PI-PAYEE-NAME
 15259          MOVE AM-ADDRS            TO ADDR1BO
 15260          MOVE SPACES              TO ADDR2BO
 15261*         MOVE AM-CITY             TO CITYSTBO
 15262          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15263             DELIMITED BY '  ' INTO CITYSTBO
 15264          END-STRING
 15265          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15266          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15267          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15268          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15269
 15270***  We don't really need the code below because we don't do the
 15271***  AK thing anymore.  However, we may have a state special
 15272***  of some sort in the future so why not just leave it??
 15273     IF CITYSTBO EQUAL SPACES
 15274         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15275         GO TO 6070-FORMAT-DATA
 15276     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 291
* EL156.cbl
 15277
 15278     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15279     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15280     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15281     PERFORM VARYING WS-SUB FROM 30 BY -1
 15282          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15283        IF WS-END-SUB = 0  AND
 15284           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15285              OR LOW-VALUES  OR '.')
 15286            CONTINUE
 15287        ELSE
 15288            IF WS-END-SUB = 0
 15289                MOVE WS-SUB TO WS-END-SUB
 15290            ELSE
 15291                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15292                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15293                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15294                END-IF
 15295            END-IF
 15296        END-IF
 15297        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15298            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15299            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15300        END-IF
 15301     END-PERFORM.
 15302
 15303     IF WS-BEG-SUB > 0
 15304         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15305         IF WS-STATE-LENGTH = 2
 15306             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15307                  TO PI-CHECK-STATE-FOR-AK
 15308         ELSE
 15309             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15310                'ALASKA'
 15311                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15312             ELSE
 15313                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15314             END-IF
 15315         END-IF
 15316     ELSE
 15317         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15318     END-IF.
 15319
 15320     GO TO 6070-FORMAT-DATA.
 15321
 15322 6065-NOT-FOUND.
 15323     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15324     GO TO 6061-READ-ACCOUNT.
 15325
 15326 6068-ACCT-NOT-FND.
 15327     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15328
 15329 6070-FORMAT-DATA.
 15330     IF PI-HOLDTIL = ZEROS
 15331        MOVE SAVE-DATE           TO PAYDTBI
 15332       ELSE
 15333        MOVE PI-HOLDTIL          TO PAYDTBO
 15334        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 292
* EL156.cbl
 15335
 15336     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15337     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15338
 15339     IF EIBAID = DFHPF3 OR DFHPF4
 15340        NEXT SENTENCE
 15341     ELSE
 15342       GO TO 6071-CONTINUE.
 15343
 15344     MOVE PI-EPYFROM          TO PYFROMBO.
 15345     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15346
 15347     IF NOT PI-USES-PAID-TO
 15348        MOVE PI-EPYTHRU          TO PYTHRUBO
 15349        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15350     ELSE
 15351        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15352        MOVE '4'              TO DC-OPTION-CODE
 15353        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15354        IF NO-CONVERSION-ERROR
 15355           MOVE +1            TO DC-ELAPSED-DAYS
 15356           MOVE +0            TO DC-ELAPSED-MONTHS
 15357           MOVE '6'           TO DC-OPTION-CODE
 15358           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15359           IF NO-CONVERSION-ERROR
 15360              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15361
 15362     MOVE PI-EDAYS            TO DAYSBO.
 15363     MOVE PI-EPYAMT           TO PAYAMTBO.
 15364     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15365        IF PI-INT-AMT > ZEROS
 15366           MOVE PI-INT-AMT       TO INTAMTBO
 15367        END-IF
 15368     END-IF
 15369     GO TO 6072-SET-TYPE.
 15370
 15371 6071-CONTINUE.
 15372
 15373     IF PI-CPYFROM NOT = LOW-VALUES
 15374        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15375        MOVE SPACES              TO DC-OPTION-CODE
 15376        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15377        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15378
 15379     IF PI-CPYTHRU NOT = LOW-VALUES
 15380        IF NOT PI-USES-PAID-TO
 15381           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15382           MOVE SPACES             TO DC-OPTION-CODE
 15383           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15384           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15385        ELSE
 15386           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15387           MOVE '6'                TO DC-OPTION-CODE
 15388           MOVE +1                 TO DC-ELAPSED-DAYS
 15389           MOVE +0                 TO DC-ELAPSED-MONTHS
 15390           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15391           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15392
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 293
* EL156.cbl
 15393     MOVE PI-CDAYS               TO DAYSBO.
 15394     MOVE PI-CPYAMT              TO PAYAMTBO.
 15395     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15396        IF PI-INT-AMT > ZEROS
 15397           MOVE PI-INT-AMT       TO INTAMTBO
 15398        END-IF
 15399     END-IF
 15400     .
 15401 6072-SET-TYPE.
 15402     IF PI-PMTTYPE = '1'
 15403        MOVE 'PARTIAL'           TO PAYTYPBO.
 15404
 15405     IF PI-PMTTYPE = '2'
 15406        MOVE 'FINAL'             TO PAYTYPBO.
 15407
 15408     IF PI-PMTTYPE = '3'
 15409        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15410
 15411     IF PI-PMTTYPE = '4'
 15412        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15413
 15414     IF PI-PMTTYPE = '5'
 15415        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15416
 15417     IF PI-PMTTYPE = '6'
 15418        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15419
 15420     IF PI-PROV-PMT
 15421        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15422
 15423     IF PI-ECHECKNO NOT = SPACES
 15424        MOVE PI-ECHECKNO         TO CKNUMBO
 15425     ELSE
 15426        MOVE PI-CCHECKNO         TO CKNUMBO.
 15427
 15428     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15429        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15430        MOVE +91                 TO  TRLR-SEQ-NO
 15431
 15432* EXEC CICS READ
 15433*           DATASET  ('ELTRLR')
 15434*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15435*           RIDFLD   (ELTRLR-KEY)
 15436*           RESP     (WS-RESPONSE)
 15437*       END-EXEC
 15438     MOVE 'ELTRLR' TO DFHEIV1
 15439*    MOVE '&"S        E          (  N#00014516' TO DFHEIV0
 15440     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15442     MOVE X'204E233030303134353136' TO DFHEIV0(25:11)
 15443     CALL 'kxdfhei1' USING DFHEIV0,
 15444           DFHEIV1,
 15445           DFHEIV20,
 15446           DFHEIV99,
 15447           ELTRLR-KEY,
 15448           DFHEIV99,
 15449           DFHEIV99,
 15450           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 294
* EL156.cbl
 15451     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15452         DFHEIV20
 15453     MOVE EIBRESP  TO WS-RESPONSE
 15454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15455
 15456        IF WS-RESP-NORMAL
 15457           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15458        ELSE
 15459           MOVE SPACES           TO  LOANNBO
 15460        END-IF
 15461     END-IF
 15462
 15463*       MOVE PI-LOAN-NO          TO LOANNBO
 15464
 15465     IF CKNUMBO = SPACES
 15466         MOVE SPACES             TO CKNUMHDO.
 15467
 15468     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15469     MOVE CL-CARRIER             TO CARRBO.
 15470     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15471     MOVE CL-CERT-SFX            TO SUFXBO.
 15472
 15473     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15474        EVALUATE CL-CLAIM-TYPE
 15475           WHEN 'I'
 15476              MOVE '  IU  '      TO CLMTYPBO
 15477           WHEN 'G'
 15478              MOVE ' GAP  '      TO CLMTYPBO
 15479           WHEN 'F'
 15480              MOVE ' FMLA '      TO CLMTYPBO
 15481           WHEN OTHER
 15482              MOVE PI-AH-OVERRIDE-L6
 15483                                 TO CLMTYPBO
 15484        END-EVALUATE
 15485        MOVE ZEROS               TO UNDISBO
 15486*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15487        IF PI-PMTTYPE = '5' OR '6'
 15488           GO TO 6073-GET-NOTIFY-DATA
 15489        ELSE
 15490           MOVE PI-DAILY-RATE    TO RATEBO
 15491           GO TO 6073-GET-NOTIFY-DATA.
 15492
 15493     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15494
 15495     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15496        MOVE ZEROS               TO UNDISBO
 15497     ELSE
 15498        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15499
 15500 6073-GET-NOTIFY-DATA.
 15501
 15502     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15503
 15504     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15505         MOVE SPACES             TO  NAMEB2O
 15506                                     ADDR1B2O
 15507                                     ADDR2B2O
 15508                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 295
* EL156.cbl
 15509                                     AGTHDGO
 15510         MOVE ZEROS              TO  ZIPB2O
 15511         GO TO 6080-SET-INCURRED.
 15512
 15513     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15514     MOVE +29                    TO  TRLR-SEQ-NO.
 15515
 15516
 15517* EXEC CICS HANDLE CONDITION
 15518*        NOTFND   (6074-GET-COMP-DATA)
 15519*    END-EXEC.
 15520*    MOVE '"$I                   ! 1 #00014583' TO DFHEIV0
 15521     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15523     MOVE X'3120233030303134353833' TO DFHEIV0(25:11)
 15524     CALL 'kxdfhei1' USING DFHEIV0
 15525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15526
 15527
 15528     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15529
 15530     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15531     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15532     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15533*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15534     STRING AT-CITY ' ' AT-STATE
 15535        DELIMITED BY '  ' INTO CITYST2O
 15536     END-STRING
 15537     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15538     GO TO 6080-SET-INCURRED.
 15539
 15540 6074-GET-COMP-DATA.
 15541
 15542     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15543         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15544
 15545     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15546         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15547                                         ADDR1B2O
 15548                                         ADDR2B2O
 15549                                         CITYST2O
 15550         MOVE ZEROS                  TO  ZIPB2O
 15551         GO TO 6080-SET-INCURRED.
 15552
 15553     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15554     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15555     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15556     MOVE AM-GROUPING            TO  COMP-GROUP.
 15557     MOVE 'A'                    TO  COMP-TYPE.
 15558     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15559                                 TO  COMP-FIN-RESP.
 15560
 15561     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15562         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15563                                       'G' OR 'B' or 'S'
 15564             MOVE 'G'            TO  COMP-TYPE
 15565             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15566         ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 296
* EL156.cbl
 15567             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15568                                 TO  COMP-ACCOUNT
 15569     ELSE
 15570         MOVE 'G'                TO  COMP-TYPE
 15571         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15572
 15573     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15574
 15575     IF COMP-REC-FOUND
 15576         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15577         MOVE CO-ADDR-1          TO  ADDR1B2O
 15578         MOVE CO-ADDR-2          TO  ADDR2B2O
 15579*        MOVE CO-ADDR-3          TO  CITYST2O
 15580         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15581            DELIMITED BY '  ' INTO CITYST2O
 15582         END-STRING
 15583         MOVE CO-ZIP             TO  ZIPB2O
 15584     ELSE
 15585         MOVE 'NO COMP ADDRESS AVAILABLE'
 15586                                 TO  NAMEB2O
 15587                                     ADDR1B2O
 15588                                     ADDR2B2O
 15589                                     CITYST2O
 15590         MOVE ZEROS               TO ZIPB2O.
 15591
 15592 6080-SET-INCURRED.
 15593     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15594     MOVE SPACES                 TO DC-OPTION-CODE.
 15595     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15596     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15597     MOVE PI-PROCESSOR-ID        TO BYBO.
 15598     MOVE MAP-NAMEB              TO MAP-NAME.
 15599     MOVE 'C'                    TO PI-PASS-SW.
 15600     MOVE EIBAID                 TO PI-PFKEY-USED.
 15601     MOVE -1                     TO ENTPFBL.
 15602     GO TO 8100-SEND-INITIAL-MAP.
 15603
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 297
* EL156.cbl
 15605 6100-BUILD-PAYMENT-TRAILER.
 15606
 15607     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15608     MOVE '6'                    TO CNTL-REC-TYPE.
 15609
 15610     IF CONTROL-IS-ACTUAL-CARRIER
 15611         MOVE PI-CARRIER         TO WS-CARR
 15612     ELSE
 15613         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15614
 15615     IF PI-COMPANY-ID = 'FIA'
 15616         MOVE PI-CARRIER         TO  WS-CARR.
 15617
 15618     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15619     MOVE 0                      TO CNTL-SEQ-NO.
 15620     MOVE 'CARR'                 TO FILE-SWITCH.
 15621
 15622     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15623
 15624     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15625         IF PI-OFFLINE     = 'Y' AND
 15626            PI-ECHECKNO-CR = 'CR'
 15627              GO TO 6110-READ-CONTROL
 15628         ELSE
 15629            IF PI-CASH = 'N'
 15630                GO TO 6110-READ-CONTROL.
 15631
 15632     IF CHECK-NO-MANUAL    OR
 15633        CHECK-NO-AT-PRINT  OR
 15634        PI-OFFLINE = 'Y'
 15635          GO TO 6130-BUILD-TRAILER.
 15636     IF PI-COMPANY-ID = 'FIA'
 15637         NEXT SENTENCE
 15638     ELSE
 15639         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15640             GO TO 6110-READ-CONTROL.
 15641
 15642     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15643
 15644     IF CHECK-CNT-RESET-VALUE
 15645        MOVE +1                  TO CF-CHECK-COUNTER
 15646     ELSE
 15647        ADD +1                   TO CF-CHECK-COUNTER.
 15648
 15649     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15650
 15651     IF CHECK-NO-CARR-SEQ
 15652        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15653
 15654     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15655
 15656     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15657     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15658        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15659         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15660         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15661            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15662         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 298
* EL156.cbl
 15663                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15664     END-IF.
 15665
 15666     GO TO 6120-REWRITE.
 15667
 15668 6105-STATE-CHECK-NUMBER.
 15669     IF CHECK-NO-MANUAL    OR
 15670        CHECK-NO-AT-PRINT  OR
 15671        PI-OFFLINE = 'Y'
 15672           GO TO 6130-BUILD-TRAILER
 15673     END-IF.
 15674
 15675     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15676     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15677     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15678     MOVE '3'                TO CNTL-REC-TYPE.
 15679     MOVE +0                 TO CNTL-SEQ-NO.
 15680     MOVE 'STAT'             TO FILE-SWITCH.
 15681     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15682
 15683     IF CF-ST-CHECK-CNT-RESET
 15684         MOVE +1             TO CF-ST-CHECK-COUNTER
 15685     ELSE
 15686         ADD +1              TO CF-ST-CHECK-COUNTER
 15687     END-IF.
 15688
 15689     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15690     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15691     GO TO 6120-REWRITE.
 15692
 15693 6110-READ-CONTROL.
 15694     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15695     MOVE '1'                    TO CNTL-REC-TYPE.
 15696     MOVE SPACES                 TO CNTL-ACCESS.
 15697     MOVE 0                      TO CNTL-SEQ-NO.
 15698
 15699     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15700
 15701     IF CO-CHECK-COUNT-RESET
 15702        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15703     ELSE
 15704        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15705
 15706     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15707
 15708     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15709         IF PI-OFFLINE     = 'Y'  AND
 15710            PI-ECHECKNO-CR = 'CR'
 15711              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15712              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15713              MOVE AL-UANON           TO CHECKNOA
 15714              GO TO 6120-REWRITE
 15715         ELSE
 15716         IF PI-CASH = 'N'
 15717             MOVE 'N'                TO PI-ECHECKNO-N
 15718             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15719             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15720             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 299
* EL156.cbl
 15721             GO TO 6120-REWRITE.
 15722
 15723     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15724
 15725 6120-REWRITE.
 15726
 15727* EXEC CICS REWRITE
 15728*         DATASET('ELCNTL')
 15729*         FROM(CONTROL-FILE)
 15730*     END-EXEC.
 15731     MOVE LENGTH OF
 15732      CONTROL-FILE
 15733       TO DFHEIV11
 15734     MOVE 'ELCNTL' TO DFHEIV1
 15735*    MOVE '&& L                  %   #00014785' TO DFHEIV0
 15736     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15738     MOVE X'2020233030303134373835' TO DFHEIV0(25:11)
 15739     CALL 'kxdfhei1' USING DFHEIV0,
 15740           DFHEIV1,
 15741           CONTROL-FILE,
 15742           DFHEIV11,
 15743           DFHEIV99
 15744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15745
 15746
 15747     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15748
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 300
* EL156.cbl
 15750 6130-BUILD-TRAILER.
 15751
 15752
 15753* EXEC CICS GETMAIN
 15754*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15755*         LENGTH    (200)
 15756*         INITIMG   (GETMAIN-SPACE)
 15757*     END-EXEC.
 15758     MOVE 200
 15759       TO DFHEIV11
 15760*    MOVE ',"IL                  $   #00014795' TO DFHEIV0
 15761     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15762     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15763     MOVE X'2020233030303134373935' TO DFHEIV0(25:11)
 15764     CALL 'kxdfhei1' USING DFHEIV0,
 15765           DFHEIV20,
 15766           DFHEIV11,
 15767           GETMAIN-SPACE
 15768     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15769         DFHEIV20
 15770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15771
 15772
 15773     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15774                                    AT-PREV-PAID-THRU-DT.
 15775     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15776     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15777     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15778     MOVE 'AT'                   TO AT-RECORD-ID.
 15779     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15780
 15781     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15782        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15783           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15784     ELSE
 15785           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15786           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15787
 15788     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15789         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15790             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15791             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15792           ELSE
 15793             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15794             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15795
 15796     MOVE '2'                    TO AT-TRAILER-TYPE.
 15797     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15798                                    AT-PAYMENT-LAST-MAINT-DT.
 15799     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15800                                    AT-PAYMENT-LAST-UPDATED-BY.
 15801     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15802     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15803     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15804     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15805
 15806     IF PI-PMT-APPROVED
 15807        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 301
* EL156.cbl
 15808           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15809
 15810     IF PI-PFKEY-USED = DFHPF5
 15811        GO TO 6140-PF5-ENTERED.
 15812
 15813     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15814     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15815
 15816     IF PI-AIG-SPECIAL-BENEFIT
 15817         IF WS-1ST-SPECIAL-PMT
 15818             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15819             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15820                                        AT-AMOUNT-PAID
 15821         ELSE
 15822             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15823
 15824     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15825
 15826     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15827     MOVE '4'                    TO DC-OPTION-CODE.
 15828     PERFORM 9700-LINK-DATE-CONVERT.
 15829
 15830     IF DATE-CONVERSION-ERROR
 15831        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15832     ELSE
 15833        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15834
 15835     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15836     MOVE '4'                    TO DC-OPTION-CODE.
 15837     PERFORM 9700-LINK-DATE-CONVERT.
 15838
 15839     IF DATE-CONVERSION-ERROR
 15840        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15841     ELSE
 15842        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15843
 15844     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15845     move pi-ach-payment         to at-ach-payment
 15846     GO TO 6150-FINISH-MOVE.
 15847
 15848 6140-PF5-ENTERED.
 15849     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15850     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15851
 15852     IF PI-AIG-SPECIAL-BENEFIT
 15853         IF WS-1ST-SPECIAL-PMT
 15854             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15855             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15856                                        AT-AMOUNT-PAID
 15857         ELSE
 15858             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15859
 15860     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15861     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15862     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15863
 15864 6150-FINISH-MOVE.
 15865
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 302
* EL156.cbl
 15866     IF PI-ECHECKNO = SPACES
 15867         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15868     ELSE
 15869         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15870
 15871     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15872     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15873
 15874*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15875*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15876
 15877     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15878         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15879
 15880     IF PI-OFFLINE = 'N'
 15881        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15882        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15883     ELSE
 15884        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15885        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15886
 15887     move pi-ach-payment         to at-ach-payment
 15888     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15889
 15890     IF WS-2ND-SPECIAL-PMT
 15891         MOVE 'Y'                TO AT-CASH-PAYMENT
 15892         MOVE SPACES             TO AT-CHECK-NO
 15893         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15894         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15895         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15896         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15897
 15898     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15899                                    AT-TO-BE-WRITTEN-DT.
 15900
 15901     IF PI-HOLDTIL NOT = ZEROS
 15902        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15903        MOVE '4'                 TO DC-OPTION-CODE
 15904        PERFORM 9700-LINK-DATE-CONVERT
 15905        IF PI-OFFLINE = 'N'
 15906           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15907           MOVE 'P'              TO WS-HOLD-UNTIL-SW
 15908        ELSE
 15909           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15910
 15911     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15912     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15913                                    AT-CHECK-QUE-SEQUENCE.
 15914
 15915     IF PI-PFKEY-USED = DFHPF4
 15916        MOVE '1'                 TO AT-FORCE-CONTROL.
 15917
 15918     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15919        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15920        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15921        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15922
 15923     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 303
* EL156.cbl
 15924                                    AT-VOID-SELECT-DT
 15925                                    AT-VOID-ACCEPT-DT
 15926                                    AT-VOID-DT.
 15927     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15928        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15929        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15930        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15931        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15932     ELSE
 15933        MOVE ZEROS               TO AT-DAILY-RATE
 15934                                    AT-ELIMINATION-DAYS
 15935        MOVE SPACES              TO AT-BENEFIT-TYPE
 15936     END-IF
 15937     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15938     MOVE '4'                    TO DC-OPTION-CODE.
 15939     PERFORM 9700-LINK-DATE-CONVERT.
 15940     IF DATE-CONVERSION-ERROR
 15941         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15942     ELSE
 15943         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15944     END-IF.
 15945     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15946     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15947     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15948     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15949     IF (PI-REAUDIT-NEEDED = 'Y')
 15950        or (pi-max-ext-used = 'Y')
 15951        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15952         PERFORM 6155-READ-CONTROL
 15953         PERFORM 6157-SET-APP-LEVEL
 15954         IF AT-APPROVAL-LEVEL-REQD < '4'
 15955            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15956         END-IF
 15957         MOVE 'Y' TO WS-NEED-APPROVAL
 15958         GO TO 6170-WRITE
 15959     END-IF.
 15960*******************************************************
 15961     IF NOT PI-PMT-GRADUATED
 15962         GO TO 6170-WRITE.
 15963     PERFORM 6155-READ-CONTROL.
 15964
 15965     IF PAID-FOR-LIFE
 15966         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15967             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15968                                     WS-PMT-APPROVAL-SW
 15969             GO TO 6170-WRITE.
 15970
 15971*05999      IF PAID-FOR-AH
 15972     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15973         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15974             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15975                                     WS-PMT-APPROVAL-SW
 15976             GO TO 6170-WRITE.
 15977
 15978     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15979
 15980     PERFORM 6157-SET-APP-LEVEL.
 15981
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 304
* EL156.cbl
 15982     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15983
 15984     IF NOT PI-PMT-GRADUATED
 15985         GO TO 6170-WRITE.
 15986
 15987
 15988* EXEC CICS HANDLE CONDITION
 15989*        NOTFND   (6170-WRITE)
 15990*    END-EXEC.
 15991*    MOVE '"$I                   ! 2 #00015015' TO DFHEIV0
 15992     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15994     MOVE X'3220233030303135303135' TO DFHEIV0(25:11)
 15995     CALL 'kxdfhei1' USING DFHEIV0
 15996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15997
 15998
 15999     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16000     MOVE '2'                    TO CNTL-REC-TYPE.
 16001     MOVE +0                     TO CNTL-SEQ-NO.
 16002     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16003
 16004
 16005* EXEC CICS READ
 16006*         DATASET  ('ELCNTL')
 16007*         SET      (ADDRESS OF CONTROL-FILE)
 16008*         RIDFLD   (ELCNTL-KEY)
 16009*    END-EXEC.
 16010     MOVE 'ELCNTL' TO DFHEIV1
 16011*    MOVE '&"S        E          (   #00015024' TO DFHEIV0
 16012     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16014     MOVE X'2020233030303135303234' TO DFHEIV0(25:11)
 16015     CALL 'kxdfhei1' USING DFHEIV0,
 16016           DFHEIV1,
 16017           DFHEIV20,
 16018           DFHEIV99,
 16019           ELCNTL-KEY,
 16020           DFHEIV99,
 16021           DFHEIV99,
 16022           DFHEIV99
 16023     SET ADDRESS OF CONTROL-FILE TO
 16024         DFHEIV20
 16025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16026
 16027
 16028     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 16029
 16030     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 16031                         OR '4' OR '5'
 16032         NEXT SENTENCE
 16033     ELSE
 16034         MOVE 'Y' TO WS-NEED-APPROVAL
 16035         GO TO 6170-WRITE.
 16036
 16037     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 16038         MOVE 'Y' TO WS-NEED-APPROVAL
 16039         IF WS-APPROVAL-LEVEL = '1'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 305
* EL156.cbl
 16040             MOVE '2'        TO  AT-APPROVED-LEVEL
 16041                            WS-SAVE-APPROVED-LEVEL
 16042             GO TO 6170-WRITE
 16043         ELSE
 16044             IF WS-APPROVAL-LEVEL = '2'
 16045                 MOVE '3'        TO  AT-APPROVED-LEVEL
 16046                                WS-SAVE-APPROVED-LEVEL
 16047                 GO TO 6170-WRITE
 16048             ELSE IF WS-APPROVAL-LEVEL = '3'
 16049                 MOVE '4'        TO  AT-APPROVED-LEVEL
 16050                                WS-SAVE-APPROVED-LEVEL
 16051                 GO TO 6170-WRITE
 16052             ELSE IF WS-APPROVAL-LEVEL = '4'
 16053                 MOVE '5'        TO  AT-APPROVED-LEVEL
 16054                                WS-SAVE-APPROVED-LEVEL
 16055                 GO TO 6170-WRITE.
 16056
 16057     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16058                             WS-PMT-APPROVAL-SW.
 16059     MOVE SPACES         TO  AT-APPROVED-LEVEL
 16060                             AT-APPROVAL-LEVEL-REQD.
 16061
 16062*******************************************************
 16063 6155-READ-CONTROL.
 16064     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16065     MOVE '1'                    TO CNTL-REC-TYPE.
 16066     MOVE SPACES                 TO CNTL-ACCESS.
 16067     MOVE +0                     TO CNTL-SEQ-NO.
 16068     MOVE 'COMP'                 TO FILE-SWITCH.
 16069
 16070     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16071 6157-SET-APP-LEVEL.
 16072******A&H Limits are set as a monthly payment.  Calculate the mont
 16073******equivalent of the amount paid today
 16074     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16075        PI-SAVE-ODD-DAYS-OVER > 0
 16076           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16077                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16078           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16079                                  WS-CALC-PMT-MONTHS
 16080     ELSE
 16081           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16082     END-IF.
 16083*06007      IF ((PAID-FOR-AH) AND
 16084     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16085           OR PAID-FOR-FAM) AND
 16086*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16087        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16088              OR
 16089        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16090        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16091            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16092       ELSE
 16093*06014      IF ((PAID-FOR-AH)  AND
 16094         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16095           OR PAID-FOR-FAM) AND
 16096*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16097           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 306
* EL156.cbl
 16098              OR
 16099        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16100        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16101            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16102         ELSE
 16103*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16104           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16105                OR PAID-FOR-FAM) AND
 16106               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16107              OR
 16108          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16109          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16110            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16111       ELSE
 16112           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16113                OR PAID-FOR-FAM) AND
 16114               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16115              OR
 16116          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16117          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16118            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16119       ELSE
 16120            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16121
 16122     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16123           OR PAID-FOR-FAM) AND
 16124        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16125        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16126            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16127        END-IF
 16128     ELSE
 16129     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16130           OR PAID-FOR-FAM) AND
 16131        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16132        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16133            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16134        END-IF
 16135     ELSE
 16136     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16137           OR PAID-FOR-FAM) AND
 16138        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16139        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16140            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16141        END-IF
 16142     ELSE
 16143     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16144           OR PAID-FOR-FAM) AND
 16145        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16146        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16147            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16148        END-IF
 16149     ELSE
 16150     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16151           OR PAID-FOR-FAM)
 16152            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16153
 16154 6170-WRITE.
 16155
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 307
* EL156.cbl
 16156     if pi-company-id = 'DCC' or 'VPP'
 16157        PERFORM 0900-GET-DDF-limits
 16158                                 THRU 0900-EXIT
 16159     end-if
 16160     perform 2220-update-elcrtt  thru 2220-exit
 16161     IF PI-COMPANY-ID = 'DMD'
 16162        IF PI-AT-EOB-CODES NOT = SPACES
 16163           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16164           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16165           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16166           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16167           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16168
 16169
 16170* EXEC CICS HANDLE CONDITION
 16171*        DUPREC    (6180-DUPREC)
 16172*    END-EXEC.
 16173*    MOVE '"$%                   ! 3 #00015171' TO DFHEIV0
 16174     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16176     MOVE X'3320233030303135313731' TO DFHEIV0(25:11)
 16177     CALL 'kxdfhei1' USING DFHEIV0
 16178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16179
 16180
 16181
 16182* EXEC CICS WRITE
 16183*         DATASET       ('ELTRLR')
 16184*         FROM          (ACTIVITY-TRAILERS)
 16185*         RIDFLD        (AT-CONTROL-PRIMARY)
 16186*     END-EXEC.
 16187     MOVE LENGTH OF
 16188      ACTIVITY-TRAILERS
 16189       TO DFHEIV11
 16190     MOVE 'ELTRLR' TO DFHEIV1
 16191*    MOVE '&$ L                  ''   #00015175' TO DFHEIV0
 16192     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16193     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16194     MOVE X'2020233030303135313735' TO DFHEIV0(25:11)
 16195     CALL 'kxdfhei1' USING DFHEIV0,
 16196           DFHEIV1,
 16197           ACTIVITY-TRAILERS,
 16198           DFHEIV11,
 16199           AT-CONTROL-PRIMARY,
 16200           DFHEIV99,
 16201           DFHEIV99
 16202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16203
 16204
 16205     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16206        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16207*06088           GO TO 6199-EXIT.
 16208           GO TO 6176-APPROVAL-NOTE.
 16209
 16210
 16211* EXEC CICS GETMAIN
 16212*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16213*         LENGTH    (200)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 308
* EL156.cbl
 16214*         INITIMG   (GETMAIN-SPACE)
 16215*     END-EXEC.
 16216     MOVE 200
 16217       TO DFHEIV11
 16218*    MOVE ',"IL                  $   #00015186' TO DFHEIV0
 16219     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16221     MOVE X'2020233030303135313836' TO DFHEIV0(25:11)
 16222     CALL 'kxdfhei1' USING DFHEIV0,
 16223           DFHEIV20,
 16224           DFHEIV11,
 16225           GETMAIN-SPACE
 16226     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16227         DFHEIV20
 16228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16229
 16230
 16231     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16232
 16233     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16234     MOVE 'AT'                   TO AT-RECORD-ID.
 16235     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16236     MOVE '6'                    TO AT-TRAILER-TYPE.
 16237     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16238                                    AT-GEN-INFO-LAST-MAINT-DT
 16239     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16240                                    AT-GEN-INFO-LAST-UPDATED-BY
 16241     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16242
 16243     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16244     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16245     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16246
 16247     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16248
 16249 6175-WRITE.
 16250
 16251
 16252* EXEC CICS HANDLE CONDITION
 16253*        DUPREC    (6190-DUPREC)
 16254*    END-EXEC.
 16255*    MOVE '"$%                   ! 4 #00015212' TO DFHEIV0
 16256     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16258     MOVE X'3420233030303135323132' TO DFHEIV0(25:11)
 16259     CALL 'kxdfhei1' USING DFHEIV0
 16260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16261
 16262
 16263
 16264* EXEC CICS WRITE
 16265*         DATASET     ('ELTRLR')
 16266*         FROM        (ACTIVITY-TRAILERS)
 16267*         RIDFLD      (AT-CONTROL-PRIMARY)
 16268*     END-EXEC.
 16269     MOVE LENGTH OF
 16270      ACTIVITY-TRAILERS
 16271       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 309
* EL156.cbl
 16272     MOVE 'ELTRLR' TO DFHEIV1
 16273*    MOVE '&$ L                  ''   #00015216' TO DFHEIV0
 16274     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16275     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16276     MOVE X'2020233030303135323136' TO DFHEIV0(25:11)
 16277     CALL 'kxdfhei1' USING DFHEIV0,
 16278           DFHEIV1,
 16279           ACTIVITY-TRAILERS,
 16280           DFHEIV11,
 16281           AT-CONTROL-PRIMARY,
 16282           DFHEIV99,
 16283           DFHEIV99
 16284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16285
 16286
 16287 6176-APPROVAL-NOTE.
 16288
 16289     IF NOT APPROVAL-NEEDED
 16290         GO TO 6199-EXIT.
 16291
 16292
 16293* EXEC CICS GETMAIN
 16294*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16295*        LENGTH    (200)
 16296*        INITIMG   (GETMAIN-SPACE)
 16297*    END-EXEC.
 16298     MOVE 200
 16299       TO DFHEIV11
 16300*    MOVE ',"IL                  $   #00015227' TO DFHEIV0
 16301     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16302     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16303     MOVE X'2020233030303135323237' TO DFHEIV0(25:11)
 16304     CALL 'kxdfhei1' USING DFHEIV0,
 16305           DFHEIV20,
 16306           DFHEIV11,
 16307           GETMAIN-SPACE
 16308     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16309         DFHEIV20
 16310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16311
 16312
 16313     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16314
 16315     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16316     MOVE 'AT'               TO AT-RECORD-ID
 16317     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16318     MOVE '6'                TO AT-TRAILER-TYPE
 16319     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16320                                AT-GEN-INFO-LAST-MAINT-DT
 16321     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16322                                AT-GEN-INFO-LAST-UPDATED-BY
 16323     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16324
 16325     IF PI-REAUDIT-NEEDED = 'Y'
 16326         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16327     ELSE
 16328         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16329     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 310
* EL156.cbl
 16330     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16331         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16332     END-IF
 16333     MOVE SPACES             TO AT-INFO-LINE-2
 16334
 16335     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16336 6177-WRITE.
 16337
 16338
 16339* EXEC CICS HANDLE CONDITION
 16340*        DUPREC    (6185-DUPREC)
 16341*    END-EXEC.
 16342*    MOVE '"$%                   ! 5 #00015258' TO DFHEIV0
 16343     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16345     MOVE X'3520233030303135323538' TO DFHEIV0(25:11)
 16346     CALL 'kxdfhei1' USING DFHEIV0
 16347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16348
 16349
 16350
 16351* EXEC CICS WRITE
 16352*         DATASET     ('ELTRLR')
 16353*         FROM        (ACTIVITY-TRAILERS)
 16354*         RIDFLD      (AT-CONTROL-PRIMARY)
 16355*     END-EXEC.
 16356     MOVE LENGTH OF
 16357      ACTIVITY-TRAILERS
 16358       TO DFHEIV11
 16359     MOVE 'ELTRLR' TO DFHEIV1
 16360*    MOVE '&$ L                  ''   #00015262' TO DFHEIV0
 16361     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16362     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16363     MOVE X'2020233030303135323632' TO DFHEIV0(25:11)
 16364     CALL 'kxdfhei1' USING DFHEIV0,
 16365           DFHEIV1,
 16366           ACTIVITY-TRAILERS,
 16367           DFHEIV11,
 16368           AT-CONTROL-PRIMARY,
 16369           DFHEIV99,
 16370           DFHEIV99
 16371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16372
 16373
 16374
 16375     GO TO 6199-EXIT.
 16376
 16377 6180-DUPREC.
 16378
 16379     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16380     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16381     GO TO 6170-WRITE.
 16382
 16383 6185-DUPREC.
 16384     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16385     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16386     GO TO 6177-WRITE.
 16387
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 311
* EL156.cbl
 16388 6190-DUPREC.
 16389     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16390     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16391     GO TO 6175-WRITE.
 16392
 16393 6199-EXIT.
 16394      EXIT.
 16395
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 312
* EL156.cbl
 16397 6200-UPDATE-CLAIM-MSTR.
 16398     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16399     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16400     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16401     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16402
 16403     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16404
 16405     MOVE ZEROS                  TO W-INTEREST.
 16406
 16407     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16408        IF (PI-OFFLINE = 'Y') OR
 16409           (PI-PMTTYPE = '7')
 16410           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16411                                 THRU 9870-EXIT
 16412        END-IF
 16413     END-IF
 16414     IF NOT ERROR-ON-OUTPUT
 16415        CONTINUE
 16416     ELSE
 16417
 16418* EXEC CICS REWRITE
 16419*          DATASET('ELMSTR')
 16420*          FROM(CLAIM-MASTER)
 16421*       END-EXEC
 16422     MOVE LENGTH OF
 16423      CLAIM-MASTER
 16424       TO DFHEIV11
 16425     MOVE 'ELMSTR' TO DFHEIV1
 16426*    MOVE '&& L                  %   #00015311' TO DFHEIV0
 16427     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16428     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16429     MOVE X'2020233030303135333131' TO DFHEIV0(25:11)
 16430     CALL 'kxdfhei1' USING DFHEIV0,
 16431           DFHEIV1,
 16432           CLAIM-MASTER,
 16433           DFHEIV11,
 16434           DFHEIV99
 16435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16436
 16437        MOVE -1                  TO ENTPFBL
 16438        MOVE AL-UANON            TO ENTPFBA
 16439        MOVE MAP-NAMEB           TO MAP-NAME
 16440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16441        GO TO 8200-SEND-DATAONLY
 16442     END-IF
 16443
 16444     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16445
 16446     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16447
 16448     IF PI-AIG-SPECIAL-BENEFIT
 16449         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16450
 16451     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16452
 16453     IF PI-SPECIAL-BEN-SW = 'Y'
 16454         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 313
* EL156.cbl
 16455         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16456
 16457     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16458         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16459     ELSE
 16460         IF PI-PMTTYPE NOT = '4'
 16461            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16462
 16463     IF PI-PMTTYPE = '5' OR '6'
 16464        GO TO  6250-SET-MAINT.
 16465
 16466     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16467                                         CL-LAG-REPORT-CODE.
 16468
 16469     IF CL-ACTIVITY-CODE = 09
 16470         GO TO 6200-CONT-UPDATE.
 16471
 16472     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16473         IF CL-ACTIVITY-CODE = 11
 16474             GO TO 6200-CONT-UPDATE.
 16475
 16476     IF WS-ACT-REC-FOUND-SW = 'N'
 16477         GO TO 6200-CONT-UPDATE.
 16478
 16479     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16480         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16481         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16482         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16483
 16484     IF WS-UPDATE-SW = 'Y'
 16485         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16486                                         CL-NEXT-FOLLOWUP-DT.
 16487
 16488 6200-CONT-UPDATE.
 16489
 16490     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16491       IF CLAIM-IS-CLOSED
 16492         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16493           IF WS-OPEN-CLOSE-SW = '2'
 16494             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16495                                        CL-LAST-CLOSE-DT.
 16496
 16497     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16498        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16499        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16500
 16501     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16502        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16503        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16504        MOVE 'C'                 TO CL-CLAIM-STATUS
 16505        IF PI-PMTTYPE = '2'
 16506           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16507              or 'F')
 16508           CONTINUE
 16509        ELSE
 16510           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16511        END-IF
 16512     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 314
* EL156.cbl
 16513        IF PI-PMTTYPE = '2' OR '3'
 16514           IF PI-PMTTYPE = '2' AND
 16515              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16516                 or 'F')
 16517              CONTINUE
 16518           ELSE
 16519              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16520           END-IF
 16521        END-IF
 16522     END-IF
 16523
 16524     IF PI-PMTTYPE = '4'
 16525        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16526
 16527     IF PI-COMPANY-ID = 'CVL'
 16528         IF PI-LOAN-UPDATE-SW = 'Y'
 16529             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16530             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16531             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16532             MOVE CL-CERT-STATE      TO  CERT-STATE
 16533             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16534             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16535             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16536             MOVE 'CERT'             TO  FILE-SWITCH
 16537             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16538             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16539             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16540
 16541     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16542        GO TO 6220-USE-COMPUTED.
 16543
 16544     IF (PI-PMTTYPE = '4')  AND
 16545        (PI-EPYAMT < ZEROS)
 16546          COMPUTE CL-NO-OF-DAYS-PAID =
 16547                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16548          IF CL-NO-OF-DAYS-PAID < +0
 16549              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16550          ELSE
 16551              NEXT SENTENCE
 16552     ELSE
 16553          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16554
 16555     IF HOLD-UNTIL-PMT
 16556        CONTINUE
 16557     ELSE
 16558     IF PI-PROCESSOR-ID = 'FIX '
 16559        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16560           NEXT SENTENCE
 16561        ELSE
 16562           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16563     ELSE
 16564        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16565
 16566     IF PI-PMTTYPE = '4'
 16567        GO TO 6250-SET-MAINT.
 16568
 16569     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16570     MOVE '4'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 315
* EL156.cbl
 16571     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16572     IF HOLD-UNTIL-PMT
 16573        CONTINUE
 16574     ELSE
 16575     IF DATE-CONVERSION-ERROR
 16576        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16577     ELSE
 16578        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16579        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16580           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16581           IF PI-AIG-SPECIAL-BENEFIT
 16582               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16583           ELSE
 16584               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16585
 16586     GO TO 6250-SET-MAINT.
 16587
 16588 6220-USE-COMPUTED.
 16589
 16590     IF (PI-PMTTYPE = '4')  AND
 16591        (PI-CPYAMT < ZEROS)
 16592          COMPUTE CL-NO-OF-DAYS-PAID =
 16593                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16594          IF CL-NO-OF-DAYS-PAID < +0
 16595              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16596          ELSE
 16597              NEXT SENTENCE
 16598     ELSE
 16599          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16600
 16601     IF NOT HOLD-UNTIL-PMT
 16602        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16603        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16604
 16605     IF PI-PMTTYPE = '4'
 16606        GO TO 6250-SET-MAINT.
 16607
 16608     IF PI-AIG-SPECIAL-BENEFIT
 16609         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16610     ELSE
 16611         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16612
 16613     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16614       AND NOT HOLD-UNTIL-PMT
 16615        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16616
 16617 6250-SET-MAINT.
 16618     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16619
 16620     IF PI-PROCESSOR-ID = 'FIX '
 16621        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16622           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16623        ELSE
 16624           NEXT SENTENCE
 16625     ELSE
 16626        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16627
 16628     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 316
* EL156.cbl
 16629     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16630     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16631
 16632 6299-EXIT.
 16633      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 317
* EL156.cbl
 16635 6300-UPDATE-CERT.
 16636
 16637*  ADD CERTNOTE FOR SC NP+6
 16638     IF PI-COMPANY-ID = 'CID' AND
 16639       (PI-PMTTYPE = '2' OR '3') AND
 16640        CL-CERT-STATE = 'SC'  AND
 16641        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16642           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16643     END-IF.
 16644
 16645     IF PI-COMPANY-ID = 'AHL' AND
 16646       (PI-PMTTYPE = '2' OR '3') AND
 16647        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16648           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16649           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16650     END-IF.
 16651
 16652     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16653     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16654     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16655     MOVE CL-CERT-STATE    TO CERT-STATE.
 16656     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16657     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16658     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16659     MOVE 'CERT'           TO FILE-SWITCH.
 16660
 16661     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16662
 16663     IF CERT-NOTE-ADDED
 16664        IF CM-NOTE-SW = ' '
 16665           MOVE '4'             TO CM-NOTE-SW
 16666        ELSE
 16667           IF CM-NOTE-SW = '1'
 16668               MOVE '5'           TO CM-NOTE-SW
 16669           ELSE
 16670              IF CM-NOTE-SW = '2'
 16671                 MOVE '6'         TO CM-NOTE-SW
 16672              ELSE
 16673                 IF CM-NOTE-SW = '3'
 16674                    MOVE '7'      TO CM-NOTE-SW
 16675                 END-IF
 16676              END-IF
 16677           END-IF
 16678        END-IF
 16679     END-IF.
 16680
 16681     IF PI-COMPANY-ID = 'CVL'
 16682         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16683         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16684
 16685     IF PI-PMTTYPE NOT = '4'
 16686        GO TO 6340-UPDATE-CERT.
 16687
 16688     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16689        IF PI-PFKEY-USED = DFHPF5
 16690           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16691        ELSE
 16692           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 318
* EL156.cbl
 16693
 16694*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16695*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16696*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16697*               PI-LF-COVERAGE-TYPE = 'P'
 16698*                GO TO 6350-REWRITE-CERT.
 16699
 16700     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16701       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16702          PI-LF-COVERAGE-TYPE = 'P'
 16703           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16704                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16705                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16706                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16707                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16708                GO TO 6350-REWRITE-CERT
 16709            ELSE
 16710                GO TO 6350-REWRITE-CERT.
 16711
 16712     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16713         GO TO 6350-REWRITE-CERT.
 16714
 16715     IF NOT CM-AH-LUMP-SUM-DISAB
 16716        GO TO 6380-UNLOCK-CERT.
 16717
 16718     IF PI-PFKEY-USED = DFHPF5
 16719        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16720                                    CM-AH-ITD-AH-PMT
 16721        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16722        GO TO 6350-REWRITE-CERT
 16723     ELSE
 16724        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16725                                    CM-AH-ITD-AH-PMT
 16726        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16727        GO TO 6350-REWRITE-CERT.
 16728
 16729 6340-UPDATE-CERT.
 16730
 16731     IF CL-CLAIM-TYPE = 'L' OR 'O'
 16732         IF PI-PFKEY-USED = DFHPF5
 16733             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16734         ELSE
 16735             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16736
 16737     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16738         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16739             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16740                PI-LF-COVERAGE-TYPE = 'P'
 16741                 GO TO 6350-REWRITE-CERT.
 16742
 16743     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16744       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16745          PI-LF-COVERAGE-TYPE = 'P'
 16746           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16747                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16748                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16749                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16750                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 319
* EL156.cbl
 16751                GO TO 6350-REWRITE-CERT.
 16752
 16753     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16754         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16755            PI-LF-COVERAGE-TYPE NOT = 'P'
 16756             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16757             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16758             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16759             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16760             GO TO 6350-REWRITE-CERT.
 16761
 16762     IF CL-CLAIM-TYPE = 'O'
 16763         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16764            PI-LF-COVERAGE-TYPE NOT = 'P'
 16765             MOVE CL-INCURRED-DT         TO CM-LF-CANCEL-DT
 16766             MOVE PI-MONTH-END-SAVE      TO CM-LF-CANCEL-EXIT-DT
 16767             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-CANCEL
 16768             MOVE '6'            TO CM-LF-CURRENT-STATUS
 16769             GO TO 6350-REWRITE-CERT.
 16770
 16771     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16772         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16773         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16774         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16775         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16776         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16777         IF PI-PFKEY-USED = DFHPF5
 16778             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16779                                        CM-AH-ITD-AH-PMT
 16780             GO TO 6350-REWRITE-CERT
 16781         ELSE
 16782             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16783                                        CM-AH-ITD-AH-PMT
 16784             GO TO 6350-REWRITE-CERT.
 16785
 16786 6350-REWRITE-CERT.
 16787
 16788
 16789* EXEC CICS REWRITE
 16790*         DATASET  ('ELCERT')
 16791*         FROM(CERTIFICATE-MASTER)
 16792*     END-EXEC.
 16793     MOVE LENGTH OF
 16794      CERTIFICATE-MASTER
 16795       TO DFHEIV11
 16796     MOVE 'ELCERT' TO DFHEIV1
 16797*    MOVE '&& L                  %   #00015667' TO DFHEIV0
 16798     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16799     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16800     MOVE X'2020233030303135363637' TO DFHEIV0(25:11)
 16801     CALL 'kxdfhei1' USING DFHEIV0,
 16802           DFHEIV1,
 16803           CERTIFICATE-MASTER,
 16804           DFHEIV11,
 16805           DFHEIV99
 16806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16807
 16808
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 320
* EL156.cbl
 16809     GO TO 6399-EXIT.
 16810
 16811 6380-UNLOCK-CERT.
 16812
 16813* EXEC CICS UNLOCK
 16814*         DATASET  ('ELCERT')
 16815*     END-EXEC.
 16816     MOVE 'ELCERT' TO DFHEIV1
 16817*    MOVE '&*                    #   #00015675' TO DFHEIV0
 16818     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16819     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16820     MOVE X'2020233030303135363735' TO DFHEIV0(25:11)
 16821     CALL 'kxdfhei1' USING DFHEIV0,
 16822           DFHEIV1,
 16823           DFHEIV99
 16824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16825
 16826
 16827 6399-EXIT.
 16828      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 321
* EL156.cbl
 16830 6400-UPDATE-ZERO-TRAILER.
 16831     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16832     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16833
 16834     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16835
 16836     IF PI-EPYAMT NOT = ZEROS
 16837         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16838     ELSE
 16839         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16840
 16841     IF PI-ERESV NOT = ZEROS
 16842        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16843
 16844     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16845        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16846
 16847     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16848        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16849     ELSE
 16850        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16851
 16852     IF PI-PMTTYPE = '5'
 16853        IF PI-EPYAMT = ZEROS
 16854           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16855        ELSE
 16856           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16857
 16858     IF PI-PMTTYPE = '6'
 16859        IF PI-EPYAMT = ZEROS
 16860           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16861        ELSE
 16862           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16863
 16864 6420-CHECK-OPEN-CLOSE.
 16865     IF PI-PMTTYPE = '5' OR '6'
 16866        GO TO 6450-REWRITE.
 16867
 16868     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16869         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16870             IF CLAIM-IS-CLOSED
 16871                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16872                 MOVE 1          TO  SUB-1
 16873                 GO TO 6440-AIG-LOOP.
 16874
 16875     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16876        GO TO 6450-REWRITE.
 16877
 16878     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16879        GO TO 6450-REWRITE.
 16880
 16881     MOVE 1                      TO SUB-1.
 16882
 16883 6430-LOOP.
 16884     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16885        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16886        IF PI-PMTTYPE = '1' OR '4'
 16887           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 322
* EL156.cbl
 16888           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16889           GO TO 6450-REWRITE
 16890        ELSE
 16891           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16892           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16893           GO TO 6450-REWRITE.
 16894
 16895     IF SUB-1 = 6
 16896      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16897      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16898      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16899      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16900      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16901      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16902      GO TO 6430-LOOP.
 16903
 16904     ADD 1                       TO SUB-1.
 16905     GO TO 6430-LOOP.
 16906
 16907
 16908 6440-AIG-LOOP.
 16909
 16910     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16911       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16912       IF WS-OPEN-CLOSE-SW = '1'
 16913         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16914         IF PI-PMTTYPE = '2'
 16915           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16916           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16917         ELSE
 16918           IF PI-PMTTYPE = '3'
 16919             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16920             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16921           ELSE
 16922             IF PI-PMTTYPE = '4'
 16923               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16924               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16925             ELSE
 16926               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16927               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16928       ELSE
 16929         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16930         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16931         GO TO 6450-REWRITE.
 16932
 16933     IF SUB-1 = 6
 16934      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16935      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16936      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16937      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16938      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16939      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16940      GO TO 6440-AIG-LOOP.
 16941
 16942     ADD 1                       TO SUB-1.
 16943     GO TO 6440-AIG-LOOP.
 16944
 16945 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 323
* EL156.cbl
 16946     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16947     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16948     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16949
 16950     IF PI-COMPANY-ID = 'DMD'
 16951         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16952         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16953         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16954         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16955         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16956
 16957
 16958* EXEC CICS REWRITE
 16959*         DATASET  ('ELTRLR')
 16960*         FROM     (ACTIVITY-TRAILERS)
 16961*     END-EXEC.
 16962     MOVE LENGTH OF
 16963      ACTIVITY-TRAILERS
 16964       TO DFHEIV11
 16965     MOVE 'ELTRLR' TO DFHEIV1
 16966*    MOVE '&& L                  %   #00015809' TO DFHEIV0
 16967     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16968     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16969     MOVE X'2020233030303135383039' TO DFHEIV0(25:11)
 16970     CALL 'kxdfhei1' USING DFHEIV0,
 16971           DFHEIV1,
 16972           ACTIVITY-TRAILERS,
 16973           DFHEIV11,
 16974           DFHEIV99
 16975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16976
 16977
 16978 6499-EXIT.
 16979      EXIT.
 16980
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 324
* EL156.cbl
 16982 6500-READ-DLO035.
 16983     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16984     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16985     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16986     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16987
 16988
 16989* EXEC CICS LINK
 16990*        PROGRAM    ('DLO035')
 16991*        COMMAREA   (DLO035-KEY)
 16992*        LENGTH     (DL35-LENGTH)
 16993*    END-EXEC.
 16994     MOVE 'DLO035' TO DFHEIV1
 16995*    MOVE '."C                   (   #00015824' TO DFHEIV0
 16996     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16998     MOVE X'2020233030303135383234' TO DFHEIV0(25:11)
 16999     CALL 'kxdfhei1' USING DFHEIV0,
 17000           DFHEIV1,
 17001           DLO035-KEY,
 17002           DL35-LENGTH,
 17003           DFHEIV99,
 17004           DFHEIV99,
 17005           DFHEIV99,
 17006           DFHEIV99
 17007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17008
 17009
 17010     IF DL35-RETURN-CODE = 'OK'
 17011         GO TO 6500-EXIT.
 17012
 17013     IF DL35-RETURN-CODE = '01'
 17014         MOVE ER-7830            TO EMI-ERROR
 17015         GO TO 6500-BAD-EXIT.
 17016
 17017     IF DL35-RETURN-CODE = '02'
 17018         MOVE ER-7831            TO EMI-ERROR
 17019         GO TO 6500-BAD-EXIT.
 17020
 17021     IF DL35-RETURN-CODE = '03'
 17022         MOVE ER-7832            TO EMI-ERROR
 17023         GO TO 6500-BAD-EXIT.
 17024
 17025     IF DL35-RETURN-CODE = '04'
 17026         MOVE ER-7833            TO EMI-ERROR
 17027         GO TO 6500-BAD-EXIT.
 17028
 17029     IF DL35-RETURN-CODE = '05'
 17030         MOVE ER-7834            TO EMI-ERROR
 17031         GO TO 6500-BAD-EXIT.
 17032
 17033     IF DL35-RETURN-CODE = '06'
 17034         MOVE ER-7835            TO EMI-ERROR
 17035         GO TO 6500-BAD-EXIT.
 17036
 17037     IF DL35-RETURN-CODE = '07'
 17038         MOVE ER-7836            TO EMI-ERROR
 17039         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 325
* EL156.cbl
 17040
 17041     IF DL35-RETURN-CODE = 'E1'
 17042         MOVE ER-7837            TO EMI-ERROR
 17043         GO TO 6500-BAD-EXIT.
 17044
 17045     IF DL35-RETURN-CODE NOT = 'OK'
 17046         MOVE ER-7838            TO EMI-ERROR
 17047         GO TO 6500-BAD-EXIT.
 17048
 17049 6500-EXIT.
 17050      EXIT.
 17051
 17052 6500-BAD-EXIT.
 17053
 17054* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17055*    MOVE '6"R                   !   #00015873' TO DFHEIV0
 17056     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17058     MOVE X'2020233030303135383733' TO DFHEIV0(25:11)
 17059     CALL 'kxdfhei1' USING DFHEIV0
 17060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17061
 17062     MOVE -1                 TO PMTTYPEL.
 17063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17064     GO TO 8200-SEND-DATAONLY.
 17065
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 326
* EL156.cbl
 17067 6600-UPDATE-DLO035.
 17068     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 17069     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17070     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17071     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17072
 17073
 17074* EXEC CICS LINK
 17075*        PROGRAM    ('DLO035')
 17076*        COMMAREA   (DLO035-KEY)
 17077*        LENGTH     (DL35-LENGTH)
 17078*    END-EXEC.
 17079     MOVE 'DLO035' TO DFHEIV1
 17080*    MOVE '."C                   (   #00015885' TO DFHEIV0
 17081     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17083     MOVE X'2020233030303135383835' TO DFHEIV0(25:11)
 17084     CALL 'kxdfhei1' USING DFHEIV0,
 17085           DFHEIV1,
 17086           DLO035-KEY,
 17087           DL35-LENGTH,
 17088           DFHEIV99,
 17089           DFHEIV99,
 17090           DFHEIV99,
 17091           DFHEIV99
 17092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17093
 17094
 17095     IF DL35-RETURN-CODE = 'OK'
 17096         GO TO 6600-EXIT.
 17097
 17098     IF DL35-RETURN-CODE = '01'
 17099         MOVE ER-7830            TO EMI-ERROR
 17100         GO TO 6500-BAD-EXIT.
 17101
 17102     IF DL35-RETURN-CODE = '02'
 17103         MOVE ER-7831            TO EMI-ERROR
 17104         GO TO 6500-BAD-EXIT.
 17105
 17106     IF DL35-RETURN-CODE = '03'
 17107         MOVE ER-7832            TO EMI-ERROR
 17108         GO TO 6500-BAD-EXIT.
 17109
 17110     IF DL35-RETURN-CODE = '04'
 17111         MOVE ER-7833            TO EMI-ERROR
 17112         GO TO 6500-BAD-EXIT.
 17113
 17114     IF DL35-RETURN-CODE = '05'
 17115         MOVE ER-7834            TO EMI-ERROR
 17116         GO TO 6500-BAD-EXIT.
 17117
 17118     IF DL35-RETURN-CODE = '06'
 17119         MOVE ER-7835            TO EMI-ERROR
 17120         GO TO 6500-BAD-EXIT.
 17121
 17122     IF DL35-RETURN-CODE = '07'
 17123         MOVE ER-7836            TO EMI-ERROR
 17124         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 327
* EL156.cbl
 17125
 17126     IF DL35-RETURN-CODE = 'E1'
 17127         MOVE ER-7837            TO EMI-ERROR
 17128         GO TO 6500-BAD-EXIT.
 17129
 17130     IF DL35-RETURN-CODE NOT = 'OK'
 17131         MOVE ER-7838            TO EMI-ERROR
 17132         GO TO 6500-BAD-EXIT.
 17133
 17134 6600-EXIT.
 17135      EXIT.
 17136
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 328
* EL156.cbl
 17138 6700-UPDATE-ACTQ.
 17139***************************************************************
 17140*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17141*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17142*    ONE ALREADY THERE.                                       *
 17143***************************************************************
 17144
 17145
 17146* EXEC CICS HANDLE CONDITION
 17147*         NOTFND(6720-BUILD-NEW-RECORD)
 17148*     END-EXEC.
 17149*    MOVE '"$I                   ! 6 #00015941' TO DFHEIV0
 17150     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17152     MOVE X'3620233030303135393431' TO DFHEIV0(25:11)
 17153     CALL 'kxdfhei1' USING DFHEIV0
 17154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17155
 17156
 17157
 17158* EXEC CICS READ
 17159*         DATASET('ELACTQ')
 17160*         RIDFLD (ELMSTR-KEY)
 17161*         SET    (ADDRESS OF ACTIVITY-QUE)
 17162*         UPDATE
 17163*     END-EXEC.
 17164     MOVE 'ELACTQ' TO DFHEIV1
 17165*    MOVE '&"S        EU         (   #00015945' TO DFHEIV0
 17166     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17168     MOVE X'2020233030303135393435' TO DFHEIV0(25:11)
 17169     CALL 'kxdfhei1' USING DFHEIV0,
 17170           DFHEIV1,
 17171           DFHEIV20,
 17172           DFHEIV99,
 17173           ELMSTR-KEY,
 17174           DFHEIV99,
 17175           DFHEIV99,
 17176           DFHEIV99
 17177     SET ADDRESS OF ACTIVITY-QUE TO
 17178         DFHEIV20
 17179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17180
 17181
 17182     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17183
 17184     IF PI-AIG-SPECIAL-BENEFIT AND
 17185        PI-CASH = 'Y'
 17186         ADD 2                   TO AQ-PAYMENT-COUNTER
 17187     ELSE
 17188         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17189
 17190     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17191         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17192
 17193     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17194
 17195     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 329
* EL156.cbl
 17196         IF WS-PMT-APPROVAL-SW = 'A'
 17197             NEXT SENTENCE
 17198         ELSE
 17199            IF PI-AIG-SPECIAL-BENEFIT AND
 17200               PI-CASH = 'Y'
 17201                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17202                                     WS-PMT-UNAPPROVED-CNT
 17203            ELSE
 17204                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17205                                     WS-PMT-UNAPPROVED-CNT
 17206     ELSE
 17207         IF PI-PMT-APPR-SW = 'Y'
 17208            IF PI-AIG-SPECIAL-BENEFIT AND
 17209               PI-CASH = 'Y'
 17210                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17211                                     WS-PMT-UNAPPROVED-CNT
 17212            ELSE
 17213                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17214                                     WS-PMT-UNAPPROVED-CNT.
 17215
 17216     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17217         MOVE ER-3536 TO EMI-ERROR
 17218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17219
 17220     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17221
 17222
 17223* EXEC CICS REWRITE
 17224*         DATASET('ELACTQ')
 17225*         FROM   (ACTIVITY-QUE)
 17226*     END-EXEC.
 17227     MOVE LENGTH OF
 17228      ACTIVITY-QUE
 17229       TO DFHEIV11
 17230     MOVE 'ELACTQ' TO DFHEIV1
 17231*    MOVE '&& L                  %   #00015992' TO DFHEIV0
 17232     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17233     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17234     MOVE X'2020233030303135393932' TO DFHEIV0(25:11)
 17235     CALL 'kxdfhei1' USING DFHEIV0,
 17236           DFHEIV1,
 17237           ACTIVITY-QUE,
 17238           DFHEIV11,
 17239           DFHEIV99
 17240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17241
 17242
 17243     GO TO 6799-EXIT.
 17244
 17245 6720-BUILD-NEW-RECORD.
 17246
 17247* EXEC CICS GETMAIN
 17248*         SET    (ADDRESS OF ACTIVITY-QUE)
 17249*         LENGTH (60)
 17250*         INITIMG(GETMAIN-SPACE)
 17251*     END-EXEC.
 17252     MOVE 60
 17253       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 330
* EL156.cbl
 17254*    MOVE ',"IL                  $   #00016000' TO DFHEIV0
 17255     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17256     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17257     MOVE X'2020233030303136303030' TO DFHEIV0(25:11)
 17258     CALL 'kxdfhei1' USING DFHEIV0,
 17259           DFHEIV20,
 17260           DFHEIV11,
 17261           GETMAIN-SPACE
 17262     SET ADDRESS OF ACTIVITY-QUE TO
 17263         DFHEIV20
 17264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17265
 17266
 17267     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17268
 17269     IF PI-AIG-SPECIAL-BENEFIT AND
 17270        PI-CASH = 'Y'
 17271         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17272     ELSE
 17273         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17274
 17275     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17276     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17277     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17278     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17279                                    AQ-FOLLOWUP-DATE.
 17280     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17281     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17282
 17283     IF PI-PMT-GRADUATED
 17284         IF WS-PMT-APPROVAL-SW = 'A'
 17285             NEXT SENTENCE
 17286         ELSE
 17287            IF PI-AIG-SPECIAL-BENEFIT AND
 17288               PI-CASH = 'Y'
 17289                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17290            ELSE
 17291                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17292     ELSE
 17293         IF PI-PMT-APPR-SW = 'Y'
 17294            IF PI-AIG-SPECIAL-BENEFIT AND
 17295               PI-CASH = 'Y'
 17296                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17297            ELSE
 17298                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17299
 17300     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17301         MOVE ER-3536 TO EMI-ERROR
 17302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17303
 17304
 17305* EXEC CICS WRITE
 17306*         DATASET('ELACTQ')
 17307*         RIDFLD (ELMSTR-KEY)
 17308*         FROM   (ACTIVITY-QUE)
 17309*     END-EXEC.
 17310     MOVE LENGTH OF
 17311      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 331
* EL156.cbl
 17312       TO DFHEIV11
 17313     MOVE 'ELACTQ' TO DFHEIV1
 17314*    MOVE '&$ L                  ''   #00016043' TO DFHEIV0
 17315     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17316     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17317     MOVE X'2020233030303136303433' TO DFHEIV0(25:11)
 17318     CALL 'kxdfhei1' USING DFHEIV0,
 17319           DFHEIV1,
 17320           ACTIVITY-QUE,
 17321           DFHEIV11,
 17322           ELMSTR-KEY,
 17323           DFHEIV99,
 17324           DFHEIV99
 17325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17326
 17327
 17328 6799-EXIT.
 17329      EXIT.
 17330
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 332
* EL156.cbl
 17332 6800-BUILD-FORM-TRAILER.
 17333
 17334
 17335* EXEC CICS GETMAIN
 17336*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17337*         LENGTH   (200)
 17338*         INITIMG  (GETMAIN-SPACE)
 17339*    END-EXEC.
 17340     MOVE 200
 17341       TO DFHEIV11
 17342*    MOVE ',"IL                  $   #00016055' TO DFHEIV0
 17343     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17344     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17345     MOVE X'2020233030303136303535' TO DFHEIV0(25:11)
 17346     CALL 'kxdfhei1' USING DFHEIV0,
 17347           DFHEIV20,
 17348           DFHEIV11,
 17349           GETMAIN-SPACE
 17350     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17351         DFHEIV20
 17352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17353
 17354
 17355     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17356
 17357     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17358     MOVE 'AT'                   TO AT-RECORD-ID.
 17359     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17360
 17361     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17362     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17363                                    AT-FORM-LAST-MAINT-DT
 17364                                    AT-FORM-SEND-ON-DT.
 17365     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17366                                    AT-FORM-LAST-UPDATED-BY.
 17367     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17368     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17369     MOVE '6'                    TO DC-OPTION-CODE.
 17370     MOVE +29                    TO DC-ELAPSED-DAYS.
 17371     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17372     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17373     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17374
 17375     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17376         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17377
 17378     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17379                                    AT-FORM-RE-SEND-DT
 17380                                    AT-EMP-FORM-ANSWERED-DT
 17381                                    AT-PHY-FORM-ANSWERED-DT
 17382                                    AT-EMP-FORM-SEND-ON-DT
 17383                                    AT-PHY-FORM-SEND-ON-DT
 17384                                    AT-FORM-PRINTED-DT
 17385                                    AT-FORM-REPRINT-DT.
 17386     MOVE '2'                    TO AT-FORM-TYPE.
 17387
 17388     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17389     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 333
* EL156.cbl
 17390
 17391     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17392         NEXT SENTENCE
 17393     ELSE
 17394         IF CL-PROG-FORM-TYPE NOT = 'S'
 17395            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17396
 17397
 17398* EXEC CICS WRITE
 17399*         DATASET  ('ELTRLR')
 17400*         FROM     (ACTIVITY-TRAILERS)
 17401*         RIDFLD   (AT-CONTROL-PRIMARY)
 17402*     END-EXEC.
 17403     MOVE LENGTH OF
 17404      ACTIVITY-TRAILERS
 17405       TO DFHEIV11
 17406     MOVE 'ELTRLR' TO DFHEIV1
 17407*    MOVE '&$ L                  ''   #00016103' TO DFHEIV0
 17408     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17409     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17410     MOVE X'2020233030303136313033' TO DFHEIV0(25:11)
 17411     CALL 'kxdfhei1' USING DFHEIV0,
 17412           DFHEIV1,
 17413           ACTIVITY-TRAILERS,
 17414           DFHEIV11,
 17415           AT-CONTROL-PRIMARY,
 17416           DFHEIV99,
 17417           DFHEIV99
 17418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17419
 17420
 17421 6899-EXIT.
 17422      EXIT.
 17423
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 334
* EL156.cbl
 17425 6900-BUILD-ARCHIVE-HEADER.
 17426
 17427     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17428     MOVE '1'                    TO CNTL-REC-TYPE.
 17429     MOVE +0                     TO CNTL-SEQ-NO.
 17430     MOVE SPACES                 TO CNTL-ACCESS.
 17431
 17432
 17433* EXEC CICS READ
 17434*         DATASET  ('ELCNTL')
 17435*         SET      (ADDRESS OF CONTROL-FILE)
 17436*         RIDFLD   (ELCNTL-KEY)
 17437*         UPDATE
 17438*    END-EXEC.
 17439     MOVE 'ELCNTL' TO DFHEIV1
 17440*    MOVE '&"S        EU         (   #00016120' TO DFHEIV0
 17441     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17442     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17443     MOVE X'2020233030303136313230' TO DFHEIV0(25:11)
 17444     CALL 'kxdfhei1' USING DFHEIV0,
 17445           DFHEIV1,
 17446           DFHEIV20,
 17447           DFHEIV99,
 17448           ELCNTL-KEY,
 17449           DFHEIV99,
 17450           DFHEIV99,
 17451           DFHEIV99
 17452     SET ADDRESS OF CONTROL-FILE TO
 17453         DFHEIV20
 17454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17455
 17456
 17457     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17458     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17459
 17460
 17461* EXEC CICS REWRITE
 17462*         FROM     (CONTROL-FILE)
 17463*         DATASET  ('ELCNTL')
 17464*    END-EXEC.
 17465     MOVE LENGTH OF
 17466      CONTROL-FILE
 17467       TO DFHEIV11
 17468     MOVE 'ELCNTL' TO DFHEIV1
 17469*    MOVE '&& L                  %   #00016130' TO DFHEIV0
 17470     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17471     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17472     MOVE X'2020233030303136313330' TO DFHEIV0(25:11)
 17473     CALL 'kxdfhei1' USING DFHEIV0,
 17474           DFHEIV1,
 17475           CONTROL-FILE,
 17476           DFHEIV11,
 17477           DFHEIV99
 17478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17479
 17480
 17481
 17482* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 335
* EL156.cbl
 17483*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17484*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17485*    END-EXEC.
 17486*    MOVE '"$$%                  ! 7 #00016135' TO DFHEIV0
 17487     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17489     MOVE X'3720233030303136313335' TO DFHEIV0(25:11)
 17490     CALL 'kxdfhei1' USING DFHEIV0
 17491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17492
 17493
 17494
 17495* EXEC CICS GETMAIN
 17496*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17497*         LENGTH  (ELARCH-LENGTH)
 17498*         INITIMG (GETMAIN-SPACE)
 17499*    END-EXEC.
 17500*    MOVE ',"IL                  $   #00016140' TO DFHEIV0
 17501     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17502     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17503     MOVE X'2020233030303136313430' TO DFHEIV0(25:11)
 17504     CALL 'kxdfhei1' USING DFHEIV0,
 17505           DFHEIV20,
 17506           ELARCH-LENGTH,
 17507           GETMAIN-SPACE
 17508     SET ADDRESS OF LETTER-ARCHIVE TO
 17509         DFHEIV20
 17510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17511
 17512
 17513     MOVE 'LA'                   TO LA-RECORD-ID.
 17514     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17515                                    LA-ARCHIVE-NO-A1.
 17516     MOVE '4'                    TO LA-RECORD-TYPE
 17517                                    LA-RECORD-TYPE-A1.
 17518     MOVE +0                     TO LA-LINE-SEQ-NO
 17519                                    LA-LINE-SEQ-NO-A1.
 17520     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17521                                    LA-COMPANY-CD-A1.
 17522     MOVE CL-CARRIER             TO LA4-CARRIER.
 17523     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17524     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17525     MOVE CL-CERT-STATE          TO LA4-STATE.
 17526     MOVE +0                     TO LA4-NO-OF-COPIES.
 17527     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17528     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17529     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17530                                    LA4-INITIAL-PRINT-DATE
 17531                                    LA4-RESEND-PRINT-DATE
 17532                                    LA4-FORM-REM-PRINT-DT.
 17533     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17534     MOVE '2'                    TO LA4-FORM-TYPE.
 17535
 17536
 17537* EXEC CICS WRITE
 17538*         DATASET  ('ELARCH')
 17539*         FROM     (LETTER-ARCHIVE)
 17540*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 336
* EL156.cbl
 17541*    END-EXEC.
 17542     MOVE LENGTH OF
 17543      LETTER-ARCHIVE
 17544       TO DFHEIV11
 17545     MOVE 'ELARCH' TO DFHEIV1
 17546*    MOVE '&$ L                  ''   #00016169' TO DFHEIV0
 17547     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17548     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17549     MOVE X'2020233030303136313639' TO DFHEIV0(25:11)
 17550     CALL 'kxdfhei1' USING DFHEIV0,
 17551           DFHEIV1,
 17552           LETTER-ARCHIVE,
 17553           DFHEIV11,
 17554           LA-CONTROL-PRIMARY,
 17555           DFHEIV99,
 17556           DFHEIV99
 17557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17558
 17559
 17560 6999-EXIT.
 17561      EXIT.
 17562
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 337
* EL156.cbl
 17564 7000-SHOW-CLAIM.
 17565     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17566     MOVE 'A'                    TO PI-PASS-SW.
 17567     MOVE LOW-VALUES             TO PI-CPYFROM
 17568                                    PI-MONTH-END-SAVE
 17569                                    PI-CPYTHRU.
 17570
 17571     MOVE ZEROS                  TO PI-FATAL-COUNT
 17572                                    PI-DAILY-RATE
 17573                                    PI-BEN-DAYS
 17574                                    PI-MANUAL-SW
 17575                                    PI-SAVE-CURSOR
 17576                                    PI-FORCE-COUNT
 17577                                    PI-HOLDTIL
 17578                                    PI-EPYFROM
 17579                                    PI-EPYTHRU
 17580                                    PI-EDAYS
 17581                                    PI-EPYAMT
 17582                                    PI-ERESV
 17583                                    PI-EEXPENS
 17584                                    PI-CDAYS
 17585                                    PI-CPYAMT
 17586                                    PI-CRESV
 17587                                    PI-CEXPENS
 17588                                    PI-INT-RATE
 17589                                    PI-AIGFROM.
 17590     MOVE ZEROS                  TO PI-PROOF-DATE.
 17591     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17592                                    PI-REM-BEN-AMT
 17593                                    PI-MO-BEN-AMT
 17594                                    pi-ah-term.
 17595
 17596     MOVE LOW-VALUES             TO EL156AI.
 17597     MOVE MAP-NAMEA              TO MAP-NAME.
 17598
 17599* EXEC CICS HANDLE CONDITION
 17600*        NOTFND   (7010-BUILD-MAP)
 17601*    END-EXEC.
 17602*    MOVE '"$I                   ! 8 #00016213' TO DFHEIV0
 17603     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17605     MOVE X'3820233030303136323133' TO DFHEIV0(25:11)
 17606     CALL 'kxdfhei1' USING DFHEIV0
 17607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17608
 17609
 17610     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17611     MOVE '2'                    TO CNTL-REC-TYPE.
 17612     MOVE +0                     TO CNTL-SEQ-NO.
 17613     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17614
 17615
 17616* EXEC CICS READ
 17617*         DATASET  ('ELCNTL')
 17618*         SET      (ADDRESS OF CONTROL-FILE)
 17619*         RIDFLD   (ELCNTL-KEY)
 17620*    END-EXEC.
 17621     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 338
* EL156.cbl
 17622*    MOVE '&"S        E          (   #00016222' TO DFHEIV0
 17623     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17625     MOVE X'2020233030303136323232' TO DFHEIV0(25:11)
 17626     CALL 'kxdfhei1' USING DFHEIV0,
 17627           DFHEIV1,
 17628           DFHEIV20,
 17629           DFHEIV99,
 17630           ELCNTL-KEY,
 17631           DFHEIV99,
 17632           DFHEIV99,
 17633           DFHEIV99
 17634     SET ADDRESS OF CONTROL-FILE TO
 17635         DFHEIV20
 17636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17637
 17638
 17639     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17640
 17641     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17642         MOVE AL-UANON      TO SURVYYNA
 17643     END-IF.
 17644
 17645
 17646     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17647     MOVE '1'                    TO CNTL-REC-TYPE.
 17648     MOVE SPACES                 TO CNTL-ACCESS.
 17649     MOVE +0                     TO CNTL-SEQ-NO.
 17650
 17651
 17652* EXEC CICS READ
 17653*         DATASET  ('ELCNTL')
 17654*         SET      (ADDRESS OF CONTROL-FILE)
 17655*         RIDFLD   (ELCNTL-KEY)
 17656*    END-EXEC.
 17657     MOVE 'ELCNTL' TO DFHEIV1
 17658*    MOVE '&"S        E          (   #00016240' TO DFHEIV0
 17659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17661     MOVE X'2020233030303136323430' TO DFHEIV0(25:11)
 17662     CALL 'kxdfhei1' USING DFHEIV0,
 17663           DFHEIV1,
 17664           DFHEIV20,
 17665           DFHEIV99,
 17666           ELCNTL-KEY,
 17667           DFHEIV99,
 17668           DFHEIV99,
 17669           DFHEIV99
 17670     SET ADDRESS OF CONTROL-FILE TO
 17671         DFHEIV20
 17672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17673
 17674
 17675     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17676
 17677 7010-BUILD-MAP.
 17678
 17679
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 339
* EL156.cbl
 17680* EXEC CICS HANDLE CONDITION
 17681*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17682*    END-EXEC.
 17683*    MOVE '"$I                   ! 9 #00016250' TO DFHEIV0
 17684     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17686     MOVE X'3920233030303136323530' TO DFHEIV0(25:11)
 17687     CALL 'kxdfhei1' USING DFHEIV0
 17688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17689
 17690
 17691     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17692     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17693     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17694     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17695     MOVE 'MSTR'                 TO FILE-SWITCH.
 17696
 17697     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17698
 17699     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17700     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17701     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17702     MOVE CL-CCN                 TO PI-SV-CCN.
 17703
 17704     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17705     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17706     MOVE CL-CLAIM-NO            TO CLMNOO.
 17707     MOVE CL-CARRIER             TO CARRO.
 17708     MOVE CL-CERT-PRIME          TO CERTNOO.
 17709     MOVE CL-CERT-SFX            TO SUFXO.
 17710
 17711     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17712        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 17713        CONTINUE
 17714     ELSE
 17715        MOVE AL-SADOF            TO ZINTHA
 17716                                    ZINTA
 17717                                    PINTHA
 17718                                    PINTA
 17719     END-IF
 17720     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17721     EVALUATE TRUE
 17722     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17723         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17724     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17725         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17726
 17727     WHEN CL-CLAIM-TYPE = 'I'
 17728         MOVE '  IU  '           TO CLMTYPO
 17729     WHEN CL-CLAIM-TYPE = 'G'
 17730         MOVE ' GAP  '           TO CLMTYPO
 17731     WHEN CL-CLAIM-TYPE = 'F'
 17732         MOVE ' FMLA '           TO CLMTYPO
 17733     WHEN CL-CLAIM-TYPE = 'O'
 17734         MOVE ' OTH '           TO CLMTYPO
 17735     END-EVALUATE.
 17736     IF CL-CLAIM-TYPE = 'O'
 17737        MOVE 'S' TO EOBYNO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 340
* EL156.cbl
 17738                    PI-PRINT-EOB-YN
 17739                    WS-PRINT-EOB-YN
 17740     END-IF
 17741     IF CLAIM-IS-OPEN
 17742         MOVE ' OPEN'            TO CLMSTATO
 17743     ELSE
 17744         MOVE 'CLOSED'           TO CLMSTATO.
 17745
 17746     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17747
 17748     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17749         MOVE SPACES             TO  PCERTNOO
 17750                                     PSUFXO
 17751                                     PRIMHDGO
 17752                                     SEQUO
 17753         MOVE AL-SADOF           TO  PCERTNOA
 17754                                     PSUFXA
 17755                                     PRIMHDGA
 17756                                     SEQUA
 17757     ELSE
 17758         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17759         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17760         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17761         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17762         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17763         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17764         MOVE AL-SANON               TO  PCERTNOA
 17765                                         PSUFXA
 17766                                         PRIMHDGA
 17767         MOVE AL-SABON               TO  SEQUA.
 17768
 17769     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17770
 17771     IF CL-NO-OF-PMTS-MADE = 0 AND
 17772        CL-TOTAL-PAID-AMT = 0
 17773         NEXT SENTENCE
 17774     ELSE
 17775         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17776             IF NOT PI-USES-PAID-TO
 17777                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17778                 MOVE ' '                 TO DC-OPTION-CODE
 17779                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17780                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17781             ELSE
 17782                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17783                 MOVE '6'                 TO DC-OPTION-CODE
 17784                 MOVE +1                  TO DC-ELAPSED-DAYS
 17785                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17786                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17787                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17788
 17789     IF MAP-NAME = 'EL156A'
 17790        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17791           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17792             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17793           end-if
 17794        end-if
 17795     end-if
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 341
* EL156.cbl
 17796     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17797         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17798         MOVE ' '                TO DC-OPTION-CODE
 17799         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17800         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17801
 17802     IF CL-INCURRED-DT NOT = LOW-VALUES
 17803         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17804         MOVE ' '                TO DC-OPTION-CODE
 17805         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17806         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17807
 17808     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17809
 17810     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17811         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17812         MOVE ' '                TO DC-OPTION-CODE
 17813         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17814         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17815
 17816     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17817         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17818         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17819     ELSE
 17820         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17821         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17822
 17823     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17824     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17825     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17826     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17827                                    PI-GROUPING.
 17828     MOVE CL-CERT-STATE          TO CERT-STATE
 17829                                    PI-STATE.
 17830     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17831                                    PI-ACCOUNT.
 17832     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17833     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17834     MOVE 'CERT'                 TO FILE-SWITCH.
 17835
 17836     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17837     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17838        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17839        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17840            MOVE 'N' TO PI-JOINT-INSURED-IND
 17841     ELSE
 17842            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17843     END-IF.
 17844
 17845     perform 7975-read-acct      thru 7975-exit
 17846     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17847     MOVE PI-STATE               TO WS-ST-ACCESS.
 17848     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17849     MOVE '3'                    TO CNTL-REC-TYPE.
 17850     MOVE +0                     TO CNTL-SEQ-NO.
 17851     MOVE 'STAT'                 TO FILE-SWITCH.
 17852
 17853     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 342
* EL156.cbl
 17854
 17855     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17856     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17857
 17858     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17859        GO TO 7020-BYPASS-BENEFIT.
 17860
 17861     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17862     MOVE '4'                    TO CNTL-REC-TYPE.
 17863     MOVE +0                     TO CNTL-SEQ-NO.
 17864     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17865     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17866     MOVE 'BENE'                 TO FILE-SWITCH.
 17867
 17868     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17869
 17870     IF NO-BENEFIT-FOUND
 17871        GO TO 7020-BYPASS-BENEFIT.
 17872
 17873     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17874     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17875     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17876
 17877 7020-BYPASS-BENEFIT.
 17878
 17879*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17880*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17881*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17882
 17883     move zeros                  to PI-MAX-BENEFIT-AMT
 17884     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17885     move cm-ah-orig-term        to pi-ah-term
 17886     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17887     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17888          'G' and 'F'
 17889         GO TO 7021-GO-TO-LIFE.
 17890
 17891     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17892        and (acct-found)
 17893        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17894        PERFORM 0900-GET-DDF-limits
 17895                                 THRU 0900-EXIT
 17896        IF PDEF-FOUND
 17897           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17898              (P1 > +8)
 17899              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17900           END-PERFORM
 17901           IF P1 < +9
 17902              if pd-ben-pct (p1) not numeric
 17903                 move zeros      to pd-ben-pct (p1)
 17904              end-if
 17905              if pd-ben-pct (p1) = zeros
 17906                 move +1         to ws-work-ben-pct
 17907              else
 17908                 move pd-ben-pct (p1)
 17909                                 to ws-work-ben-pct
 17910              end-if
 17911              compute cm-ah-benefit-amt =
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 343
* EL156.cbl
 17912                 cm-ah-benefit-amt * ws-work-ben-pct
 17913              move pd-max-amt (p1) to pi-max-benefit-amt
 17914           END-IF
 17915        END-IF
 17916     end-if
 17917     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17918     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17919     if (pi-max-benefit-amt not = zeros)
 17920        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17921        move pi-max-benefit-amt  to beneo
 17922     else
 17923        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17924     end-if
 17925     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17926     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17927                                    CP-ORIGINAL-TERM.
 17928     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17929
 17930*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17931*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17932*    ELSE
 17933         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17934
 17935     MOVE ' '                    TO DC-OPTION-CODE.
 17936     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17937     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17938
 17939     IF PI-COMPANY-ID = 'DMD'
 17940         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17941         GO TO 7023-BYPASS-REMAINING-TERM.
 17942
 17943     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17944     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17945     GO TO 7022-AROUND-LIFE.
 17946
 17947 7021-GO-TO-LIFE.
 17948
 17949     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17950     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17951     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17952                                    CP-ORIGINAL-TERM.
 17953     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17954     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17955     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17956     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17957
 17958     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17959         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17960     ELSE
 17961         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17962
 17963     MOVE ' '                    TO DC-OPTION-CODE.
 17964     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17965     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17966
 17967 7022-AROUND-LIFE.
 17968
 17969     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 344
* EL156.cbl
 17970     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17971     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17972     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17973     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17974     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17975     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17976
 17977     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17978
 17979     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17980        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17981           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17982
 17983     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 17984        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17985           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17986
 17987 7023-BYPASS-REMAINING-TERM.
 17988     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 17989       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17990          MOVE ZEROS                  TO BENEO
 17991       ELSE
 17992          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17993          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17994          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17995          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17996          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17997          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17998          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17999          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 18000          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 18001          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 18002          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 18003          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 18004          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18005             AND (PI-DCC-PRODUCT-CODE not = '   ')
 18006             PERFORM 0900-GET-DDF-limits
 18007                                 THRU 0900-EXIT
 18008             IF PDEF-FOUND
 18009                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18010                   (P1 > +8)
 18011                   OR (PD-PROD-CODE (P1) = 'L')
 18012                END-PERFORM
 18013                IF P1 < +9
 18014                   MOVE PD-MAX-AMT (P1)
 18015                                 TO CP-R-MAX-TOT-BEN
 18016                END-IF
 18017             END-IF
 18018          END-IF
 18019
 18020* EXEC CICS LINK
 18021*            PROGRAM  (LINK-REMAMT)
 18022*            COMMAREA (CALCULATION-PASS-AREA)
 18023*            LENGTH   (CP-COMM-LENGTH)
 18024*         END-EXEC
 18025*    MOVE '."C                   (   #00016582' TO DFHEIV0
 18026     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 345
* EL156.cbl
 18028     MOVE X'2020233030303136353832' TO DFHEIV0(25:11)
 18029     CALL 'kxdfhei1' USING DFHEIV0,
 18030           LINK-REMAMT,
 18031           CALCULATION-PASS-AREA,
 18032           CP-COMM-LENGTH,
 18033           DFHEIV99,
 18034           DFHEIV99,
 18035           DFHEIV99,
 18036           DFHEIV99
 18037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18038          MOVE CP-REMAINING-AMT       TO BENEO
 18039       end-if
 18040     end-if
 18041     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18042     MOVE +95                    TO TRLR-SEQ-NO
 18043
 18044* EXEC CICS READ
 18045*       DATASET  ('ELTRLR')
 18046*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18047*       RIDFLD   (ELTRLR-KEY)
 18048*       RESP     (WS-RESPONSE)
 18049*    END-EXEC
 18050     MOVE 'ELTRLR' TO DFHEIV1
 18051*    MOVE '&"S        E          (  N#00016592' TO DFHEIV0
 18052     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18054     MOVE X'204E233030303136353932' TO DFHEIV0(25:11)
 18055     CALL 'kxdfhei1' USING DFHEIV0,
 18056           DFHEIV1,
 18057           DFHEIV20,
 18058           DFHEIV99,
 18059           ELTRLR-KEY,
 18060           DFHEIV99,
 18061           DFHEIV99,
 18062           DFHEIV99
 18063     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18064         DFHEIV20
 18065     MOVE EIBRESP  TO WS-RESPONSE
 18066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18067
 18068     if ws-resp-normal
 18069        perform varying s1 from +1 by +1 until
 18070           at-note-error-no (s1) = spaces
 18071           move at-note-error-no (s1)
 18072                                 to emi-error
 18073           if at-note-error-no (s1) = '1653'
 18074              evaluate true
 18075                 when cl-claim-type = 'L'
 18076                    move '  LF  '
 18077                                 to emi-claim-type
 18078                 when cl-claim-type = 'I'
 18079                    move '  IU  '
 18080                                 to emi-claim-type
 18081                 when cl-claim-type = 'F'
 18082                    move ' FMLA '
 18083                                 to emi-claim-type
 18084                 when cl-claim-type = 'O'
 18085                    move ' OTH '
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 346
* EL156.cbl
 18086                                 to emi-claim-type
 18087                 when other
 18088                    move '  AH  '
 18089                                 to emi-claim-type
 18090              end-evaluate
 18091           end-if
 18092           PERFORM 9900-ERROR-FORMAT
 18093                                 THRU 9900-EXIT
 18094        end-perform
 18095     end-if
 18096    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18097         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18098            WS-LF-COVERAGE-TYPE = 'P'
 18099             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18100                                        CM-LF-ITD-DEATH-AMT
 18101             MOVE WS-REMAINING-AMT  TO  BENEO.
 18102
 18103     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18104     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18105     MOVE WS-TERMS               TO TERMSO.
 18106
 18107     IF WS-STATUS = '6' OR '7' OR '8'
 18108         MOVE AL-SABOF           TO CRTSTATA.
 18109
 18110     IF WS-STATUS = '1' OR '4'
 18111        IF CP-REMAINING-TERM-3 = ZEROS
 18112           MOVE 'EXPIRED'        TO CRTSTATO
 18113        ELSE
 18114           MOVE 'ACTIVE  '       TO CRTSTATO.
 18115
 18116     IF WS-STATUS = '2'
 18117         MOVE 'PEND    '         TO CRTSTATO.
 18118
 18119     IF WS-STATUS = '3'
 18120         MOVE 'RESTORE '         TO CRTSTATO.
 18121
 18122     IF WS-STATUS = '5'
 18123         MOVE 'REISSUE '         TO CRTSTATO.
 18124
 18125     IF WS-STATUS = '6'
 18126         MOVE 'LMP DIS'          TO CRTSTATO.
 18127
 18128     IF WS-STATUS = '7'
 18129         MOVE 'DEATH'            TO CRTSTATO.
 18130
 18131     IF WS-STATUS = '8'
 18132         MOVE 'CANCEL'           TO CRTSTATO.
 18133
 18134     IF WS-STATUS = '9'
 18135         MOVE 'RE-ONLY '         TO CRTSTATO.
 18136
 18137     IF WS-STATUS = 'V'
 18138         MOVE 'VOID  '           TO CRTSTATO.
 18139
 18140     IF WS-STATUS = 'D'
 18141         MOVE 'DECLINE '         TO CRTSTATO.
 18142
 18143     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 347
* EL156.cbl
 18144         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18145         MOVE '5'                TO CNTL-REC-TYPE
 18146     ELSE
 18147         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18148         MOVE '4'                TO CNTL-REC-TYPE.
 18149
 18150     MOVE '** NONE **'           TO COVERO.
 18151     MOVE AL-SABON               TO COVERA.
 18152
 18153     IF PI-COMPANY-ID = 'CVL'
 18154         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18155             MOVE CM-BENEFICIARY TO LOANNOO
 18156             MOVE AL-UANON       TO LOANNOA.
 18157
 18158     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18159        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18160        MOVE +91                 TO  TRLR-SEQ-NO
 18161
 18162* EXEC CICS READ
 18163*           DATASET  ('ELTRLR')
 18164*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18165*           RIDFLD   (ELTRLR-KEY)
 18166*           RESP     (WS-RESPONSE)
 18167*       END-EXEC
 18168     MOVE 'ELTRLR' TO DFHEIV1
 18169*    MOVE '&"S        E          (  N#00016692' TO DFHEIV0
 18170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18172     MOVE X'204E233030303136363932' TO DFHEIV0(25:11)
 18173     CALL 'kxdfhei1' USING DFHEIV0,
 18174           DFHEIV1,
 18175           DFHEIV20,
 18176           DFHEIV99,
 18177           ELTRLR-KEY,
 18178           DFHEIV99,
 18179           DFHEIV99,
 18180           DFHEIV99
 18181     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18182         DFHEIV20
 18183     MOVE EIBRESP  TO WS-RESPONSE
 18184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18185
 18186        IF WS-RESP-NORMAL
 18187           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18188        ELSE
 18189           MOVE SPACES           TO  LOANNOO
 18190        END-IF
 18191*052506
 18192*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18193*052506
 18194     END-IF
 18195
 18196     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18197        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18198
 18199     IF WS-BEN-CD = ZEROS
 18200         GO TO 7050-SHOW-CONTINUE.
 18201
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 348
* EL156.cbl
 18202     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18203     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18204     MOVE +0                     TO CNTL-SEQ-NO.
 18205     MOVE 'BENE'                 TO FILE-SWITCH.
 18206
 18207     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18208     IF BENEFIT-FOUND
 18209        MOVE CF-JOINT-INDICATOR (SUB-1)
 18210                                 TO PI-JOINT-COV-IND
 18211                                    PI-RB-JOINT-COV-IND
 18212        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18213                                 TO COVERO
 18214        MOVE AL-SANON            TO COVERA
 18215     END-IF
 18216     if (cntl-rec-type = '4')   *> Life claim
 18217        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18218        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18219        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18220        MOVE '5'              TO CNTL-REC-TYPE
 18221        MOVE WS-ACCESS        TO CNTL-ACCESS
 18222        MOVE +0               TO CNTL-SEQ-NO
 18223        MOVE 'BENE'           TO FILE-SWITCH
 18224        PERFORM 7200-FIND-BENEFIT
 18225                              THRU 7200-EXIT
 18226        IF (BENEFIT-FOUND)
 18227           and (pi-rb-joint-cov-ind) not = 'J'
 18228           MOVE CF-JOINT-INDICATOR (SUB-1)
 18229                              TO PI-rb-JOINT-COV-IND
 18230        end-if
 18231     end-if
 18232     .
 18233 7050-SHOW-CONTINUE.
 18234
 18235     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18236        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18237            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18238     END-IF
 18239
 18240     IF PI-COMPANY-ID = 'DMD'
 18241         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18242
 18243     MOVE -1                     TO PMTTYPEL.
 18244     GO TO 8100-SEND-INITIAL-MAP.
 18245
 18246 7100-SHOW-RECORD-NOT-FOUND.
 18247     IF FILE-SWITCH = 'MSTR'
 18248         MOVE ER-0204            TO EMI-ERROR.
 18249
 18250     IF FILE-SWITCH = 'CERT'
 18251         MOVE ER-0206            TO EMI-ERROR.
 18252
 18253     IF FILE-SWITCH = 'STAT'
 18254         MOVE ER-0149            TO EMI-ERROR.
 18255
 18256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18257
 18258     MOVE -1                     TO PMTTYPEL.
 18259     GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 349
* EL156.cbl
 18260
 18261     .
 18262 7110-BUILD-PMT-TRLR.
 18263     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18264     MOVE +51                    TO TRLR-SEQ-NO
 18265
 18266* EXEC CICS READ
 18267*        DATASET  ('ELTRLR')
 18268*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18269*        RIDFLD   (ELTRLR-KEY)
 18270*        RESP     (WS-RESPONSE)
 18271*    END-EXEC
 18272     MOVE 'ELTRLR' TO DFHEIV1
 18273*    MOVE '&"S        E          (  N#00016778' TO DFHEIV0
 18274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18275     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18276     MOVE X'204E233030303136373738' TO DFHEIV0(25:11)
 18277     CALL 'kxdfhei1' USING DFHEIV0,
 18278           DFHEIV1,
 18279           DFHEIV20,
 18280           DFHEIV99,
 18281           ELTRLR-KEY,
 18282           DFHEIV99,
 18283           DFHEIV99,
 18284           DFHEIV99
 18285     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18286         DFHEIV20
 18287     MOVE EIBRESP  TO WS-RESPONSE
 18288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18289     IF WS-RESP-NORMAL
 18290        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18291     END-IF
 18292     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18293
 18294* EXEC CICS GETMAIN
 18295*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18296*         LENGTH    (200)
 18297*         INITIMG   (GETMAIN-SPACE)
 18298*     END-EXEC
 18299     MOVE 200
 18300       TO DFHEIV11
 18301*    MOVE ',"IL                  $   #00016788' TO DFHEIV0
 18302     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18303     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18304     MOVE X'2020233030303136373838' TO DFHEIV0(25:11)
 18305     CALL 'kxdfhei1' USING DFHEIV0,
 18306           DFHEIV20,
 18307           DFHEIV11,
 18308           GETMAIN-SPACE
 18309     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18310         DFHEIV20
 18311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18312     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18313                                    AT-PREV-PAID-THRU-DT
 18314     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18315     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18316     MOVE 'AT'                   TO AT-RECORD-ID
 18317     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 350
* EL156.cbl
 18318     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18319     MOVE '2'                    TO AT-TRAILER-TYPE
 18320     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18321                                    AT-PAYMENT-LAST-MAINT-DT
 18322     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18323                                    AT-PAYMENT-LAST-UPDATED-BY
 18324     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18325     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18326     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18327     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 18328     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18329     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18330     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18331     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18332     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18333     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18334     if pi-int-to-rem-borr = 'Y'
 18335        move 'Q1'                to at-payee-type-cd
 18336     else
 18337        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18338     end-if
 18339     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18340     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18341     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18342     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18343     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18344                                    AT-TO-BE-WRITTEN-DT
 18345     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18346                                    AT-CHECK-QUE-SEQUENCE
 18347                                    AT-ADDL-RESERVE
 18348     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18349                                    AT-VOID-SELECT-DT
 18350                                    AT-VOID-ACCEPT-DT
 18351                                    AT-VOID-DT
 18352                                    AT-PMT-PROOF-DT
 18353                                    AT-INT-PMT-SELECT-DT
 18354     MOVE ZEROS                  TO AT-DAILY-RATE
 18355                                    AT-ELIMINATION-DAYS
 18356     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18357*    EXEC CICS HANDLE CONDITION
 18358*        DUPREC    (7120-DUPREC)
 18359*    END-EXEC
 18360     .
 18361 7115-WRITE-INT-TRLR.
 18362
 18363* EXEC CICS WRITE
 18364*         DATASET       ('ELTRLR')
 18365*         FROM          (ACTIVITY-TRAILERS)
 18366*         RIDFLD        (AT-CONTROL-PRIMARY)
 18367*         RESP          (WS-RESPONSE)
 18368*     END-EXEC
 18369     MOVE LENGTH OF
 18370      ACTIVITY-TRAILERS
 18371       TO DFHEIV11
 18372     MOVE 'ELTRLR' TO DFHEIV1
 18373*    MOVE '&$ L                  ''  N#00016843' TO DFHEIV0
 18374     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18375     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 351
* EL156.cbl
 18376     MOVE X'204E233030303136383433' TO DFHEIV0(25:11)
 18377     CALL 'kxdfhei1' USING DFHEIV0,
 18378           DFHEIV1,
 18379           ACTIVITY-TRAILERS,
 18380           DFHEIV11,
 18381           AT-CONTROL-PRIMARY,
 18382           DFHEIV99,
 18383           DFHEIV99
 18384     MOVE EIBRESP  TO WS-RESPONSE
 18385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18386      IF WS-RESP-DUPREC
 18387         GO TO 7120-DUPREC
 18388      END-IF
 18389     GO TO 7130-EXIT
 18390     .
 18391 7120-DUPREC.
 18392     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18393     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18394     GO TO 7115-WRITE-INT-TRLR
 18395     .
 18396 7130-EXIT.
 18397      EXIT.
 18398 7140-BUILD-NOTE-TRLR.
 18399
 18400
 18401* EXEC CICS GETMAIN
 18402*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18403*         LENGTH    (200)
 18404*         INITIMG   (GETMAIN-SPACE)
 18405*     END-EXEC
 18406     MOVE 200
 18407       TO DFHEIV11
 18408*    MOVE ',"IL                  $   #00016863' TO DFHEIV0
 18409     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18411     MOVE X'2020233030303136383633' TO DFHEIV0(25:11)
 18412     CALL 'kxdfhei1' USING DFHEIV0,
 18413           DFHEIV20,
 18414           DFHEIV11,
 18415           GETMAIN-SPACE
 18416     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18417         DFHEIV20
 18418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18419     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18420     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18421     MOVE 'AT'                   TO AT-RECORD-ID
 18422     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18423     MOVE '6'                    TO AT-TRAILER-TYPE
 18424     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18425                                    AT-GEN-INFO-LAST-MAINT-DT
 18426     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18427                                    AT-GEN-INFO-LAST-UPDATED-BY
 18428     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18429     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18430     .
 18431 7150-WRITE.
 18432
 18433* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 352
* EL156.cbl
 18434*        DUPREC    (7160-DUPREC)
 18435*    END-EXEC
 18436*    MOVE '"$%                   ! : #00016881' TO DFHEIV0
 18437     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18439     MOVE X'3A20233030303136383831' TO DFHEIV0(25:11)
 18440     CALL 'kxdfhei1' USING DFHEIV0
 18441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18442
 18443* EXEC CICS WRITE
 18444*         DATASET     ('ELTRLR')
 18445*         FROM        (ACTIVITY-TRAILERS)
 18446*         RIDFLD      (AT-CONTROL-PRIMARY)
 18447*         RESP        (WS-RESPONSE)
 18448*     END-EXEC
 18449     MOVE LENGTH OF
 18450      ACTIVITY-TRAILERS
 18451       TO DFHEIV11
 18452     MOVE 'ELTRLR' TO DFHEIV1
 18453*    MOVE '&$ L                  ''  N#00016884' TO DFHEIV0
 18454     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18455     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18456     MOVE X'204E233030303136383834' TO DFHEIV0(25:11)
 18457     CALL 'kxdfhei1' USING DFHEIV0,
 18458           DFHEIV1,
 18459           ACTIVITY-TRAILERS,
 18460           DFHEIV11,
 18461           AT-CONTROL-PRIMARY,
 18462           DFHEIV99,
 18463           DFHEIV99
 18464     MOVE EIBRESP  TO WS-RESPONSE
 18465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18466      IF WS-RESP-DUPREC
 18467         GO TO 7160-DUPREC
 18468      END-IF
 18469     GO TO 7170-EXIT
 18470     .
 18471 7160-DUPREC.
 18472     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18473     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18474     GO TO 7150-WRITE
 18475     .
 18476 7170-EXIT.
 18477      EXIT.
 18478
 18479 7180-ADD-CERT-NOTE.
 18480*ADD CERT NOTE FOR SC NP+6
 18481
 18482
 18483* EXEC CICS GETMAIN
 18484*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18485*         LENGTH    (150)
 18486*         INITIMG   (GETMAIN-SPACE)
 18487*     END-EXEC.
 18488     MOVE 150
 18489       TO DFHEIV11
 18490*    MOVE ',"IL                  $   #00016906' TO DFHEIV0
 18491     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 353
* EL156.cbl
 18492     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18493     MOVE X'2020233030303136393036' TO DFHEIV0(25:11)
 18494     CALL 'kxdfhei1' USING DFHEIV0,
 18495           DFHEIV20,
 18496           DFHEIV11,
 18497           GETMAIN-SPACE
 18498     SET ADDRESS OF CERT-NOTE-FILE TO
 18499         DFHEIV20
 18500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18501
 18502
 18503     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18504     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18505     MOVE +1                     TO WRK-NOTE-SEQ.
 18506     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18507     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18508     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18509     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18510     MOVE CL-CERT-STATE          TO CZ-STATE.
 18511     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18512     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18513     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18514     MOVE '2'                    TO CZ-RECORD-TYPE.
 18515     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18516     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18517     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18518     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18519     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18520     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18521     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18522     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18523     IF PI-COMPANY-ID = 'AHL'
 18524        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18525           CONTINUE
 18526        ELSE
 18527           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18528              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18529           ELSE
 18530              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18531           END-IF
 18532        END-IF
 18533     END-IF
 18534     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18535     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18536
 18537 7181-WRITE.
 18538
 18539
 18540* EXEC CICS WRITE
 18541*         DATASET     ('ERCNOT')
 18542*         FROM        (CERT-NOTE-FILE)
 18543*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18544*         RESP        (WS-RESPONSE)
 18545*    END-EXEC.
 18546     MOVE LENGTH OF
 18547      CERT-NOTE-FILE
 18548       TO DFHEIV11
 18549     MOVE 'ERCNOT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 354
* EL156.cbl
 18550*    MOVE '&$ L                  ''  N#00016948' TO DFHEIV0
 18551     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18552     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18553     MOVE X'204E233030303136393438' TO DFHEIV0(25:11)
 18554     CALL 'kxdfhei1' USING DFHEIV0,
 18555           DFHEIV1,
 18556           CERT-NOTE-FILE,
 18557           DFHEIV11,
 18558           CZ-CONTROL-PRIMARY,
 18559           DFHEIV99,
 18560           DFHEIV99
 18561     MOVE EIBRESP  TO WS-RESPONSE
 18562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18563
 18564
 18565     IF WS-RESP-DUPREC
 18566         GO TO 7182-DUPREC
 18567     END-IF.
 18568
 18569     SET CERT-NOTE-ADDED TO TRUE.
 18570
 18571     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18572         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18573     END-IF.
 18574
 18575     GO TO 7189-EXIT.
 18576
 18577 7182-DUPREC.
 18578
 18579     ADD +1                      TO  WRK-NOTE-SEQ.
 18580     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18581     GO TO 7181-WRITE.
 18582
 18583 7189-EXIT.
 18584      EXIT.
 18585
 18586 7190-ADD-ORIG-NOTE.
 18587
 18588
 18589* EXEC CICS GETMAIN
 18590*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18591*         LENGTH    (150)
 18592*         INITIMG   (GETMAIN-SPACE)
 18593*     END-EXEC.
 18594     MOVE 150
 18595       TO DFHEIV11
 18596*    MOVE ',"IL                  $   #00016978' TO DFHEIV0
 18597     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18598     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18599     MOVE X'2020233030303136393738' TO DFHEIV0(25:11)
 18600     CALL 'kxdfhei1' USING DFHEIV0,
 18601           DFHEIV20,
 18602           DFHEIV11,
 18603           GETMAIN-SPACE
 18604     SET ADDRESS OF CERT-NOTE-FILE TO
 18605         DFHEIV20
 18606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18607
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 355
* EL156.cbl
 18608
 18609     ADD +1                      TO WRK-NOTE-SEQ.
 18610     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18611     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18612     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18613     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18614     MOVE CL-CERT-STATE          TO CZ-STATE.
 18615     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18616     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18617     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18618     MOVE '2'                    TO CZ-RECORD-TYPE.
 18619     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18620     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18621     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18622     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18623     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18624     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18625
 18626 7191-WRITE.
 18627
 18628
 18629* EXEC CICS WRITE
 18630*         DATASET     ('ERCNOT')
 18631*         FROM        (CERT-NOTE-FILE)
 18632*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18633*         RESP        (WS-RESPONSE)
 18634*    END-EXEC.
 18635     MOVE LENGTH OF
 18636      CERT-NOTE-FILE
 18637       TO DFHEIV11
 18638     MOVE 'ERCNOT' TO DFHEIV1
 18639*    MOVE '&$ L                  ''  N#00017003' TO DFHEIV0
 18640     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18641     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18642     MOVE X'204E233030303137303033' TO DFHEIV0(25:11)
 18643     CALL 'kxdfhei1' USING DFHEIV0,
 18644           DFHEIV1,
 18645           CERT-NOTE-FILE,
 18646           DFHEIV11,
 18647           CZ-CONTROL-PRIMARY,
 18648           DFHEIV99,
 18649           DFHEIV99
 18650     MOVE EIBRESP  TO WS-RESPONSE
 18651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18652
 18653
 18654     IF WS-RESP-DUPREC
 18655         GO TO 7192-DUPREC
 18656     END-IF.
 18657
 18658     GO TO 7199-EXIT.
 18659
 18660 7192-DUPREC.
 18661
 18662     ADD +1                      TO  WRK-NOTE-SEQ.
 18663     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18664     GO TO 7191-WRITE.
 18665
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 356
* EL156.cbl
 18666 7199-EXIT.
 18667      EXIT.
 18668 7200-FIND-BENEFIT.
 18669     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18670
 18671
 18672* EXEC CICS HANDLE CONDITION
 18673*        ENDFILE(7200-EXIT)
 18674*        NOTFND(7200-EXIT)
 18675*    END-EXEC.
 18676*    MOVE '"$''I                  ! ; #00017027' TO DFHEIV0
 18677     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18679     MOVE X'3B20233030303137303237' TO DFHEIV0(25:11)
 18680     CALL 'kxdfhei1' USING DFHEIV0
 18681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18682
 18683
 18684
 18685* EXEC CICS READ
 18686*        DATASET('ELCNTL')
 18687*        SET(ADDRESS OF CONTROL-FILE)
 18688*        RIDFLD(ELCNTL-KEY)
 18689*        GTEQ
 18690*    END-EXEC.
 18691     MOVE 'ELCNTL' TO DFHEIV1
 18692*    MOVE '&"S        G          (   #00017032' TO DFHEIV0
 18693     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18695     MOVE X'2020233030303137303332' TO DFHEIV0(25:11)
 18696     CALL 'kxdfhei1' USING DFHEIV0,
 18697           DFHEIV1,
 18698           DFHEIV20,
 18699           DFHEIV99,
 18700           ELCNTL-KEY,
 18701           DFHEIV99,
 18702           DFHEIV99,
 18703           DFHEIV99
 18704     SET ADDRESS OF CONTROL-FILE TO
 18705         DFHEIV20
 18706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18707
 18708
 18709     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18710        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18711           GO TO 7200-EXIT.
 18712
 18713     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18714         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18715            ((SUB-1 > 8) OR
 18716            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18717
 18718     IF SUB-1 NOT = 9
 18719         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18720
 18721     GO TO 7200-EXIT.
 18722
 18723 7200-BENEFIT-DUMMY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 357
* EL156.cbl
 18724
 18725 7200-DUMMY-EXIT.
 18726     EXIT.
 18727
 18728 7200-EXIT.
 18729     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 358
* EL156.cbl
 18731*052506
 18732*052506 7250-FIND-LETTER-TRLR.
 18733*052506     EXEC CICS HANDLE CONDITION
 18734*052506         ENDFILE  (7250-END)
 18735*052506         NOTFND   (7250-END)
 18736*052506     END-EXEC.
 18737*052506
 18738*052506     EXEC CICS STARTBR
 18739*052506         DATASET   ('ELTRLR')
 18740*052506         RIDFLD    (ELTRLR-KEY)
 18741*052506         GTEQ
 18742*052506     END-EXEC.
 18743*052506
 18744*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18745*052506
 18746*052506 7250-FIND-LOOP.
 18747*052506     EXEC CICS READNEXT
 18748*052506         DATASET   ('ELTRLR')
 18749*052506         RIDFLD    (ELTRLR-KEY)
 18750*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18751*052506     END-EXEC.
 18752*052506
 18753*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18754*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18755*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18756*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18757*052506        GO TO 7250-END
 18758*052506     END-IF.
 18759*052506
 18760*052506     IF AT-TRAILER-TYPE NOT = '4'
 18761*052506         GO TO 7250-FIND-LOOP
 18762*052506     END-IF.
 18763*052506
 18764*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18765*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18766*052506     END-IF.
 18767*052506
 18768*052506     GO TO 7250-FIND-LOOP.
 18769*052506
 18770*052506 7250-END.
 18771*052506
 18772*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18773*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18774*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18775*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18776*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18777*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18778*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18779*052506     END-IF.
 18780*052506
 18781*052506     EXEC CICS ENDBR
 18782*052506          DATASET    ('ELTRLR')
 18783*052506     END-EXEC.
 18784*052506
 18785*052506 7250-EXIT.
 18786*052506     EXIT.
 18787*052506     EJECT
 18788*052506
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 359
* EL156.cbl
 18789 7300-CHECK-AUTO-ACTIVITY.
 18790
 18791     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18792         NEXT SENTENCE
 18793     ELSE
 18794         GO TO 7399-EXIT.
 18795
 18796     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18797
 18798     IF WS-ACT-REC-FOUND-SW = 'N'
 18799         GO TO 7399-EXIT.
 18800
 18801     IF PI-ACTIVITY-CODE = 09
 18802         GO TO 7300-CONT-AUTO-ACTIVITY.
 18803
 18804     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18805        (PI-ACTIVITY-CODE = 11)
 18806         GO TO 7300-CONT-AUTO-ACTIVITY.
 18807
 18808     IF PI-PROVISIONAL-IND = 'P'
 18809         IF PI-PMTTYPE = '1'
 18810             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18811                 MOVE 'N'    TO  PI-RESET-SW
 18812                 GO TO 7399-EXIT.
 18813
 18814     IF PI-PMTTYPE = '1'
 18815         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18816             MOVE 'N'        TO  PI-RESET-SW
 18817             GO TO 7399-EXIT.
 18818
 18819     IF PI-PMTTYPE = '2' OR '3'
 18820         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18821             MOVE 'N'        TO  PI-RESET-SW
 18822             GO TO 7399-EXIT.
 18823
 18824     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18825         IF PI-PROVISIONAL-IND = 'P'
 18826             NEXT SENTENCE
 18827         ELSE
 18828             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18829
 18830 7300-CONT-AUTO-ACTIVITY.
 18831
 18832     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18833         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18834         MOVE '4'            TO DC-OPTION-CODE
 18835         MOVE +0             TO DC-ELAPSED-DAYS
 18836                                DC-ELAPSED-MONTHS
 18837         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18838         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18839         IF PI-USES-PAID-TO
 18840             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18841             IF NO-CONVERSION-ERROR
 18842                 MOVE +1     TO DC-ELAPSED-DAYS
 18843                 MOVE +0     TO DC-ELAPSED-MONTHS
 18844                 MOVE '6'    TO DC-OPTION-CODE
 18845                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18846                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 360
* EL156.cbl
 18847                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18848
 18849     IF PI-PFKEY-USED = DFHPF5
 18850         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18851         IF PI-USES-PAID-TO
 18852             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18853             MOVE +1                  TO DC-ELAPSED-DAYS
 18854             MOVE +0                  TO DC-ELAPSED-MONTHS
 18855             MOVE '6'                 TO DC-OPTION-CODE
 18856             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18857             IF NO-CONVERSION-ERROR
 18858                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18859
 18860     IF WS-CHK-THRU-DT < PI-EXP-DT
 18861         NEXT SENTENCE
 18862     ELSE
 18863         MOVE 03                     TO  WS-ACTIVITY-CODE
 18864         GO TO 7390-PROCESS-ACTIVITY.
 18865
 18866     IF PI-PROV-PMT
 18867         MOVE 09                     TO  WS-ACTIVITY-CODE
 18868     ELSE
 18869        IF PI-PMTTYPE = '1'
 18870            MOVE 02                  TO  WS-ACTIVITY-CODE
 18871        ELSE
 18872        IF PI-PMTTYPE = '2' OR '3'
 18873            MOVE 07                  TO  WS-ACTIVITY-CODE
 18874        ELSE
 18875        IF PI-PMTTYPE = '4'
 18876            MOVE 00                  TO  WS-ACTIVITY-CODE
 18877        ELSE
 18878            MOVE 'N'                 TO  PI-RESET-SW
 18879            GO TO 7399-EXIT.
 18880
 18881 7390-PROCESS-ACTIVITY.
 18882
 18883     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18884
 18885 7399-EXIT.
 18886     EXIT.
 18887
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 361
* EL156.cbl
 18889 7400-CHECK-AUTO-ACTIVITY.
 18890
 18891
 18892* EXEC CICS HANDLE CONDITION
 18893*        NOTFND   (7400-NOT-FOUND)
 18894*    END-EXEC.
 18895*    MOVE '"$I                   ! < #00017221' TO DFHEIV0
 18896     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18898     MOVE X'3C20233030303137323231' TO DFHEIV0(25:11)
 18899     CALL 'kxdfhei1' USING DFHEIV0
 18900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18901
 18902
 18903     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18904     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18905     MOVE SPACES                 TO  CNTL-ACCESS.
 18906     MOVE +0                     TO  CNTL-SEQ-NO.
 18907
 18908
 18909* EXEC CICS READ
 18910*        DATASET   ('ELCNTL')
 18911*        RIDFLD    (ELCNTL-KEY)
 18912*        SET       (ADDRESS OF CONTROL-FILE)
 18913*    END-EXEC.
 18914     MOVE 'ELCNTL' TO DFHEIV1
 18915*    MOVE '&"S        E          (   #00017230' TO DFHEIV0
 18916     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18917     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18918     MOVE X'2020233030303137323330' TO DFHEIV0(25:11)
 18919     CALL 'kxdfhei1' USING DFHEIV0,
 18920           DFHEIV1,
 18921           DFHEIV20,
 18922           DFHEIV99,
 18923           ELCNTL-KEY,
 18924           DFHEIV99,
 18925           DFHEIV99,
 18926           DFHEIV99
 18927     SET ADDRESS OF CONTROL-FILE TO
 18928         DFHEIV20
 18929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18930
 18931
 18932     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18933     GO TO 7400-EXIT.
 18934
 18935 7400-NOT-FOUND.
 18936     MOVE 'N'                        TO  PI-RESET-SW
 18937                                         WS-LETTER-SW
 18938                                         WS-ACT-REC-FOUND-SW.
 18939
 18940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18941
 18942 7400-EXIT.
 18943     EXIT.
 18944
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 362
* EL156.cbl
 18946 7450-FORMAT-AUTO-LETTER.
 18947
 18948     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18949         MOVE 'Y'                    TO PI-RESET-SW
 18950         GO TO 7450-CONTINUE-PROCESS.
 18951
 18952     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18953
 18954     IF SUB > 9
 18955         SUBTRACT 9 FROM SUB
 18956         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18957     ELSE
 18958         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18959
 18960 7450-CONTINUE-PROCESS.
 18961
 18962     IF WS-ACTIVITY-CODE = ZEROS
 18963         MOVE 'N'                    TO  WS-LETTER-SW
 18964         GO TO 7450-EXIT.
 18965
 18966     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18967
 18968     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18969         MOVE 'N'                    TO  PI-RESET-SW
 18970                                         WS-LETTER-SW
 18971         GO TO 7450-EXIT.
 18972
 18973     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18974         MOVE 'N'                    TO  WS-LETTER-SW
 18975         GO TO 7450-EXIT.
 18976
 18977     MOVE 'Y'                        TO  WS-LETTER-SW.
 18978     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18979     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18980
 18981     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18982
 18983     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18984         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18985         MOVE '6'                    TO  DC-OPTION-CODE
 18986         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18987         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18988         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18989         IF NO-CONVERSION-ERROR
 18990             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18991         ELSE
 18992              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18993
 18994     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18995         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18996         MOVE '6'                    TO  DC-OPTION-CODE
 18997         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18998         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18999         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19000         IF NO-CONVERSION-ERROR
 19001             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 19002         ELSE
 19003             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 363
* EL156.cbl
 19004
 19005 7450-EXIT.
 19006     EXIT.
 19007
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 364
* EL156.cbl
 19009 7500-RESET-AUTO-ACTIVITY.
 19010
 19011     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 19012     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 19013     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 19014     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 19015     MOVE +100                   TO  TRLR-SEQ-NO.
 19016
 19017 7500-STARTBR-TRLR.
 19018
 19019
 19020* EXEC CICS HANDLE CONDITION
 19021*        ENDFILE  (7590-END)
 19022*        NOTFND   (7590-END)
 19023*    END-EXEC.
 19024*    MOVE '"$''I                  ! = #00017323' TO DFHEIV0
 19025     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19027     MOVE X'3D20233030303137333233' TO DFHEIV0(25:11)
 19028     CALL 'kxdfhei1' USING DFHEIV0
 19029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19030
 19031
 19032
 19033* EXEC CICS STARTBR
 19034*        DATASET   ('ELTRLR')
 19035*        RIDFLD    (ELTRLR-KEY)
 19036*        GTEQ
 19037*    END-EXEC.
 19038     MOVE 'ELTRLR' TO DFHEIV1
 19039     MOVE 0
 19040       TO DFHEIV11
 19041*    MOVE '&,         G          &   #00017328' TO DFHEIV0
 19042     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19043     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19044     MOVE X'2020233030303137333238' TO DFHEIV0(25:11)
 19045     CALL 'kxdfhei1' USING DFHEIV0,
 19046           DFHEIV1,
 19047           ELTRLR-KEY,
 19048           DFHEIV99,
 19049           DFHEIV11,
 19050           DFHEIV99
 19051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19052
 19053
 19054     MOVE 'Y'                        TO  WS-BROWSE-SW.
 19055
 19056 7500-READ-NEXT.
 19057
 19058
 19059* EXEC CICS READNEXT
 19060*        DATASET   ('ELTRLR')
 19061*        RIDFLD    (ELTRLR-KEY)
 19062*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19063*    END-EXEC.
 19064     MOVE 'ELTRLR' TO DFHEIV1
 19065     MOVE 0
 19066       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 365
* EL156.cbl
 19067*    MOVE '&.S                   )   #00017338' TO DFHEIV0
 19068     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19069     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19070     MOVE X'2020233030303137333338' TO DFHEIV0(25:11)
 19071     CALL 'kxdfhei1' USING DFHEIV0,
 19072           DFHEIV1,
 19073           DFHEIV20,
 19074           DFHEIV99,
 19075           ELTRLR-KEY,
 19076           DFHEIV99,
 19077           DFHEIV11,
 19078           DFHEIV99,
 19079           DFHEIV99
 19080     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19081         DFHEIV20
 19082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19083
 19084
 19085     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19086        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19087        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19088        PI-CERT-NO    NOT = TRLR-CERT-NO
 19089         GO TO 7590-END.
 19090
 19091     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19092         GO TO 7500-READ-NEXT.
 19093
 19094     IF AT-TRAILER-TYPE NOT = '4'
 19095         GO TO 7500-READ-NEXT.
 19096
 19097     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19098         GO TO 7500-READ-NEXT.
 19099
 19100     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19101        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19102         GO TO 7500-READ-NEXT.
 19103
 19104     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19105        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19106        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19107         GO TO 7500-READ-NEXT.
 19108
 19109     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19110                         AND
 19111        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19112                         AND
 19113        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19114            GO TO 7500-READ-NEXT.
 19115
 19116     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19117
 19118
 19119* EXEC CICS ENDBR
 19120*        DATASET   ('ELTRLR')
 19121*    END-EXEC.
 19122     MOVE 'ELTRLR' TO DFHEIV1
 19123     MOVE 0
 19124       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 366
* EL156.cbl
 19125*    MOVE '&2                    $   #00017377' TO DFHEIV0
 19126     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19127     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19128     MOVE X'2020233030303137333737' TO DFHEIV0(25:11)
 19129     CALL 'kxdfhei1' USING DFHEIV0,
 19130           DFHEIV1,
 19131           DFHEIV11,
 19132           DFHEIV99
 19133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19134
 19135
 19136     MOVE 'N'                        TO  WS-BROWSE-SW.
 19137
 19138
 19139* EXEC CICS READ
 19140*        DATASET   ('ELTRLR')
 19141*        RIDFLD    (ELTRLR-KEY)
 19142*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19143*        UPDATE
 19144*    END-EXEC.
 19145     MOVE 'ELTRLR' TO DFHEIV1
 19146*    MOVE '&"S        EU         (   #00017383' TO DFHEIV0
 19147     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19148     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19149     MOVE X'2020233030303137333833' TO DFHEIV0(25:11)
 19150     CALL 'kxdfhei1' USING DFHEIV0,
 19151           DFHEIV1,
 19152           DFHEIV20,
 19153           DFHEIV99,
 19154           ELTRLR-KEY,
 19155           DFHEIV99,
 19156           DFHEIV99,
 19157           DFHEIV99
 19158     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19159         DFHEIV20
 19160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19161
 19162
 19163     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19164
 19165     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19166         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19167     ELSE
 19168         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19169             NEXT SENTENCE
 19170         ELSE
 19171             GO TO 7500-REWRITE-TRLR.
 19172
 19173     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19174
 19175     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19176     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19177     MOVE '1'                        TO  ARCH-REC-TYPE.
 19178     MOVE +0                         TO  ARCH-SEQ.
 19179
 19180     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19181
 19182 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 367
* EL156.cbl
 19183
 19184
 19185* EXEC CICS REWRITE
 19186*        DATASET   ('ELTRLR')
 19187*        FROM      (ACTIVITY-TRAILERS)
 19188*    END-EXEC.
 19189     MOVE LENGTH OF
 19190      ACTIVITY-TRAILERS
 19191       TO DFHEIV11
 19192     MOVE 'ELTRLR' TO DFHEIV1
 19193*    MOVE '&& L                  %   #00017411' TO DFHEIV0
 19194     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19195     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19196     MOVE X'2020233030303137343131' TO DFHEIV0(25:11)
 19197     CALL 'kxdfhei1' USING DFHEIV0,
 19198           DFHEIV1,
 19199           ACTIVITY-TRAILERS,
 19200           DFHEIV11,
 19201           DFHEIV99
 19202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19203
 19204
 19205     GO TO 7500-STARTBR-TRLR.
 19206
 19207 7590-END.
 19208
 19209     IF WS-BROWSE-SW = 'Y'
 19210         MOVE 'N'                    TO  WS-BROWSE-SW
 19211
 19212* EXEC CICS ENDBR
 19213*            DATASET   ('ELTRLR')
 19214*        END-EXEC.
 19215     MOVE 'ELTRLR' TO DFHEIV1
 19216     MOVE 0
 19217       TO DFHEIV11
 19218*    MOVE '&2                    $   #00017422' TO DFHEIV0
 19219     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19221     MOVE X'2020233030303137343232' TO DFHEIV0(25:11)
 19222     CALL 'kxdfhei1' USING DFHEIV0,
 19223           DFHEIV1,
 19224           DFHEIV11,
 19225           DFHEIV99
 19226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19227
 19228
 19229 7599-EXIT.
 19230     EXIT.
 19231
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 368
* EL156.cbl
 19233 7600-READ-ARCH-UPDATE.
 19234
 19235
 19236* EXEC CICS HANDLE CONDITION
 19237*        NOTFND   (7699-EXIT)
 19238*    END-EXEC.
 19239*    MOVE '"$I                   ! > #00017432' TO DFHEIV0
 19240     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19242     MOVE X'3E20233030303137343332' TO DFHEIV0(25:11)
 19243     CALL 'kxdfhei1' USING DFHEIV0
 19244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19245
 19246
 19247
 19248* EXEC CICS READ
 19249*        DATASET   ('ELARCH')
 19250*        RIDFLD    (ELARCH-KEY)
 19251*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19252*        UPDATE
 19253*    END-EXEC.
 19254     MOVE 'ELARCH' TO DFHEIV1
 19255*    MOVE '&"S        EU         (   #00017436' TO DFHEIV0
 19256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19257     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19258     MOVE X'2020233030303137343336' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0,
 19260           DFHEIV1,
 19261           DFHEIV20,
 19262           DFHEIV99,
 19263           ELARCH-KEY,
 19264           DFHEIV99,
 19265           DFHEIV99,
 19266           DFHEIV99
 19267     SET ADDRESS OF LETTER-ARCHIVE TO
 19268         DFHEIV20
 19269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19270
 19271
 19272     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19273
 19274
 19275* EXEC CICS REWRITE
 19276*        DATASET   ('ELARCH')
 19277*        FROM      (LETTER-ARCHIVE)
 19278*    END-EXEC.
 19279     MOVE LENGTH OF
 19280      LETTER-ARCHIVE
 19281       TO DFHEIV11
 19282     MOVE 'ELARCH' TO DFHEIV1
 19283*    MOVE '&& L                  %   #00017445' TO DFHEIV0
 19284     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19285     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19286     MOVE X'2020233030303137343435' TO DFHEIV0(25:11)
 19287     CALL 'kxdfhei1' USING DFHEIV0,
 19288           DFHEIV1,
 19289           LETTER-ARCHIVE,
 19290           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 369
* EL156.cbl
 19291           DFHEIV99
 19292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19293
 19294
 19295 7699-EXIT.
 19296     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 370
* EL156.cbl
 19298 7700-GET-DCT.
 19299
 19300     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19301     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19302     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19303     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19304                                    PI-MAX-BENEFIT-AMT
 19305                                    PI-MAX-BENEFIT-PYMT
 19306                                    PI-MIN-PAYMENT-AMT
 19307                                    PI-TIME-OF-LOSS-BAL.
 19308
 19309
 19310* EXEC CICS HANDLE CONDITION
 19311*         NOTFND (5300-NOTE-NOT-FOUND)
 19312*     END-EXEC.
 19313*    MOVE '"$I                   ! ? #00017464' TO DFHEIV0
 19314     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19316     MOVE X'3F20233030303137343634' TO DFHEIV0(25:11)
 19317     CALL 'kxdfhei1' USING DFHEIV0
 19318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19319
 19320
 19321
 19322* EXEC CICS READ
 19323*         DATASET('ERNOTE')
 19324*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19325*         RIDFLD (W-NOTE-KEY)
 19326*     END-EXEC.
 19327     MOVE 'ERNOTE' TO DFHEIV1
 19328*    MOVE '&"S        E          (   #00017468' TO DFHEIV0
 19329     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19331     MOVE X'2020233030303137343638' TO DFHEIV0(25:11)
 19332     CALL 'kxdfhei1' USING DFHEIV0,
 19333           DFHEIV1,
 19334           DFHEIV20,
 19335           DFHEIV99,
 19336           W-NOTE-KEY,
 19337           DFHEIV99,
 19338           DFHEIV99,
 19339           DFHEIV99
 19340     SET ADDRESS OF CERTIFICATE-NOTE TO
 19341         DFHEIV20
 19342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19343
 19344
 19345     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19346     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19347     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19348     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19349     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19350
 19351     IF PI-PAYEE-TYPE NOT = 'B'
 19352         GO TO 7700-EXIT.
 19353
 19354     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19355     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 371
* EL156.cbl
 19356     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19357
 19358     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19359         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19360     ELSE
 19361         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19362
 19363     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19364     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19365     MOVE 'DLO006'               TO PGM-NAME.
 19366
 19367
 19368* EXEC CICS LINK
 19369*        PROGRAM    (PGM-NAME)
 19370*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19371*        LENGTH     (DCT-RCRD-LENGTH)
 19372*    END-EXEC.
 19373*    MOVE '."C                   (   #00017496' TO DFHEIV0
 19374     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19376     MOVE X'2020233030303137343936' TO DFHEIV0(25:11)
 19377     CALL 'kxdfhei1' USING DFHEIV0,
 19378           PGM-NAME,
 19379           DCT-COMMUNICATION-AREA,
 19380           DCT-RCRD-LENGTH,
 19381           DFHEIV99,
 19382           DFHEIV99,
 19383           DFHEIV99,
 19384           DFHEIV99
 19385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19386
 19387
 19388     IF DCT-RETURN-CODE = 'OK'
 19389         GO TO 7700-CONT.
 19390
 19391     IF DCT-RETURN-CODE = '01' OR '02'
 19392         GO TO 7700-SET-TO-YES.
 19393
 19394     IF DCT-RETURN-CODE = '03'
 19395
 19396* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19397*    MOVE '6"R                   !   #00017509' TO DFHEIV0
 19398     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19400     MOVE X'2020233030303137353039' TO DFHEIV0(25:11)
 19401     CALL 'kxdfhei1' USING DFHEIV0
 19402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19403         MOVE ER-0951            TO EMI-ERROR
 19404         MOVE -1                 TO PMTTYPEL
 19405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19406         GO TO 8200-SEND-DATAONLY.
 19407
 19408     IF DCT-RETURN-CODE = '04'
 19409
 19410* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19411*    MOVE '6"R                   !   #00017516' TO DFHEIV0
 19412     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 372
* EL156.cbl
 19414     MOVE X'2020233030303137353136' TO DFHEIV0(25:11)
 19415     CALL 'kxdfhei1' USING DFHEIV0
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19417         MOVE ER-0946            TO EMI-ERROR
 19418         MOVE -1                 TO PMTTYPEL
 19419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19420         GO TO 8200-SEND-DATAONLY.
 19421
 19422     IF DCT-RETURN-CODE = '05'
 19423
 19424* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19425*    MOVE '6"R                   !   #00017523' TO DFHEIV0
 19426     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19428     MOVE X'2020233030303137353233' TO DFHEIV0(25:11)
 19429     CALL 'kxdfhei1' USING DFHEIV0
 19430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19431         MOVE ER-0947            TO EMI-ERROR
 19432         MOVE -1                 TO PMTTYPEL
 19433         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19434         GO TO 8200-SEND-DATAONLY.
 19435
 19436     IF DCT-RETURN-CODE = '06'
 19437
 19438* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19439*    MOVE '6"R                   !   #00017530' TO DFHEIV0
 19440     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19442     MOVE X'2020233030303137353330' TO DFHEIV0(25:11)
 19443     CALL 'kxdfhei1' USING DFHEIV0
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19445         MOVE ER-0921            TO EMI-ERROR
 19446         MOVE -1                 TO PMTTYPEL
 19447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19448         GO TO 8200-SEND-DATAONLY.
 19449
 19450     IF DCT-RETURN-CODE = '07'
 19451
 19452* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19453*    MOVE '6"R                   !   #00017537' TO DFHEIV0
 19454     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19456     MOVE X'2020233030303137353337' TO DFHEIV0(25:11)
 19457     CALL 'kxdfhei1' USING DFHEIV0
 19458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19459         MOVE ER-0919            TO EMI-ERROR
 19460         MOVE -1                 TO PMTTYPEL
 19461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19462         GO TO 8200-SEND-DATAONLY.
 19463
 19464     IF DCT-RETURN-CODE = '08'
 19465
 19466* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19467*    MOVE '6"R                   !   #00017544' TO DFHEIV0
 19468     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19470     MOVE X'2020233030303137353434' TO DFHEIV0(25:11)
 19471     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 373
* EL156.cbl
 19472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19473         MOVE ER-0948            TO EMI-ERROR
 19474         MOVE -1                 TO PMTTYPEL
 19475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19476         GO TO 8200-SEND-DATAONLY.
 19477
 19478     IF DCT-RETURN-CODE = 'N1'
 19479
 19480* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19481*    MOVE '6"R                   !   #00017551' TO DFHEIV0
 19482     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19484     MOVE X'2020233030303137353531' TO DFHEIV0(25:11)
 19485     CALL 'kxdfhei1' USING DFHEIV0
 19486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19487         MOVE ER-0950            TO EMI-ERROR
 19488         MOVE -1                 TO PMTTYPEL
 19489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19490         GO TO 8200-SEND-DATAONLY.
 19491
 19492     IF DCT-RETURN-CODE = 'E1'
 19493
 19494* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19495*    MOVE '6"R                   !   #00017558' TO DFHEIV0
 19496     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19498     MOVE X'2020233030303137353538' TO DFHEIV0(25:11)
 19499     CALL 'kxdfhei1' USING DFHEIV0
 19500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19501         MOVE ER-0974            TO EMI-ERROR
 19502         MOVE -1                 TO PMTTYPEL
 19503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19504         GO TO 8200-SEND-DATAONLY.
 19505
 19506     IF DCT-RETURN-CODE = 'E2'
 19507
 19508* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19509*    MOVE '6"R                   !   #00017565' TO DFHEIV0
 19510     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19512     MOVE X'2020233030303137353635' TO DFHEIV0(25:11)
 19513     CALL 'kxdfhei1' USING DFHEIV0
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19515         MOVE ER-0975            TO EMI-ERROR
 19516         MOVE -1                 TO PMTTYPEL
 19517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19518         GO TO 8200-SEND-DATAONLY.
 19519
 19520     IF DCT-RETURN-CODE NOT = 'OK'
 19521
 19522* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19523*    MOVE '6"R                   !   #00017572' TO DFHEIV0
 19524     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19526     MOVE X'2020233030303137353732' TO DFHEIV0(25:11)
 19527     CALL 'kxdfhei1' USING DFHEIV0
 19528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19529         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 374
* EL156.cbl
 19530         MOVE -1                 TO PMTTYPEL
 19531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19532         GO TO 8200-SEND-DATAONLY.
 19533
 19534 7700-CONT.
 19535
 19536*    MOVE 'N'                    TO CASHO.
 19537*    MOVE +1                     TO CASHL.
 19538*    MOVE AL-UANON               TO CASHA.
 19539
 19540     IF PI-OFFLINE = 'Y'
 19541         GO TO 7700-EXIT.
 19542
 19543     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19544     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19545     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19546     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19547     MOVE +7                     TO CHECKNOL.
 19548     MOVE AL-UANON               TO CHECKNOA.
 19549     GO TO 7700-EXIT.
 19550
 19551 7700-SET-TO-YES.
 19552
 19553*    MOVE 'Y'                    TO CASHO.
 19554*    MOVE +1                     TO CASHL.
 19555*    MOVE AL-UANON               TO CASHA.
 19556
 19557 7700-EXIT.
 19558     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 375
* EL156.cbl
 19560 7800-READ-COMP-MSTR.
 19561
 19562
 19563* EXEC CICS HANDLE CONDITION
 19564*        NOTFND   (7800-COMP-NOTFND)
 19565*    END-EXEC.
 19566*    MOVE '"$I                   ! @ #00017606' TO DFHEIV0
 19567     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19569     MOVE X'4020233030303137363036' TO DFHEIV0(25:11)
 19570     CALL 'kxdfhei1' USING DFHEIV0
 19571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19572
 19573
 19574
 19575* EXEC CICS READ
 19576*        DATASET   ('ERCOMP')
 19577*        RIDFLD    (ERCOMP-KEY)
 19578*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19579*    END-EXEC.
 19580     MOVE 'ERCOMP' TO DFHEIV1
 19581*    MOVE '&"S        E          (   #00017610' TO DFHEIV0
 19582     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19584     MOVE X'2020233030303137363130' TO DFHEIV0(25:11)
 19585     CALL 'kxdfhei1' USING DFHEIV0,
 19586           DFHEIV1,
 19587           DFHEIV20,
 19588           DFHEIV99,
 19589           ERCOMP-KEY,
 19590           DFHEIV99,
 19591           DFHEIV99,
 19592           DFHEIV99
 19593     SET ADDRESS OF COMPENSATION-MASTER TO
 19594         DFHEIV20
 19595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19596
 19597
 19598     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19599     GO TO 7800-COMP-EXIT.
 19600
 19601 7800-COMP-NOTFND.
 19602     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19603
 19604 7800-COMP-EXIT.
 19605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 376
* EL156.cbl
 19607 7900-READ-CLAIM.
 19608
 19609* EXEC CICS READ
 19610*        DATASET  ('ELMSTR')
 19611*        SET      (ADDRESS OF CLAIM-MASTER)
 19612*        RIDFLD   (ELMSTR-KEY)
 19613*    END-EXEC.
 19614     MOVE 'ELMSTR' TO DFHEIV1
 19615*    MOVE '&"S        E          (   #00017626' TO DFHEIV0
 19616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19618     MOVE X'2020233030303137363236' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0,
 19620           DFHEIV1,
 19621           DFHEIV20,
 19622           DFHEIV99,
 19623           ELMSTR-KEY,
 19624           DFHEIV99,
 19625           DFHEIV99,
 19626           DFHEIV99
 19627     SET ADDRESS OF CLAIM-MASTER TO
 19628         DFHEIV20
 19629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19630
 19631
 19632 7900-EXIT.
 19633      EXIT.
 19634
 19635 7910-READ-CLAIM-UPDATE.
 19636
 19637* EXEC CICS READ
 19638*        DATASET  ('ELMSTR')
 19639*        SET      (ADDRESS OF CLAIM-MASTER)
 19640*        RIDFLD   (ELMSTR-KEY)
 19641*        UPDATE
 19642*    END-EXEC.
 19643     MOVE 'ELMSTR' TO DFHEIV1
 19644*    MOVE '&"S        EU         (   #00017636' TO DFHEIV0
 19645     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19646     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19647     MOVE X'2020233030303137363336' TO DFHEIV0(25:11)
 19648     CALL 'kxdfhei1' USING DFHEIV0,
 19649           DFHEIV1,
 19650           DFHEIV20,
 19651           DFHEIV99,
 19652           ELMSTR-KEY,
 19653           DFHEIV99,
 19654           DFHEIV99,
 19655           DFHEIV99
 19656     SET ADDRESS OF CLAIM-MASTER TO
 19657         DFHEIV20
 19658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19659
 19660
 19661 7910-EXIT.
 19662      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 377
* EL156.cbl
 19664 7920-READ-BENE.
 19665     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19666     MOVE 'B'                TO BENE-RECORD-TYPE.
 19667     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19668
 19669     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19670        IF PI-PAYEE-TYPE    = 'B' AND
 19671           PI-PAYEE-SEQ-NUM = 9
 19672             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19673             MOVE WS-A-BENE           TO BENE-NUMBER.
 19674
 19675
 19676* EXEC CICS HANDLE CONDITION
 19677*        NOTFND   (7920-NOT-FOUND)
 19678*    END-EXEC.
 19679*    MOVE '"$I                   ! A #00017657' TO DFHEIV0
 19680     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19682     MOVE X'4120233030303137363537' TO DFHEIV0(25:11)
 19683     CALL 'kxdfhei1' USING DFHEIV0
 19684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19685
 19686
 19687
 19688* EXEC CICS READ
 19689*        DATASET  ('ELBENE')
 19690*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19691*        RIDFLD   (ELBENE-KEY)
 19692*    END-EXEC.
 19693     MOVE 'ELBENE' TO DFHEIV1
 19694*    MOVE '&"S        E          (   #00017661' TO DFHEIV0
 19695     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19696     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19697     MOVE X'2020233030303137363631' TO DFHEIV0(25:11)
 19698     CALL 'kxdfhei1' USING DFHEIV0,
 19699           DFHEIV1,
 19700           DFHEIV20,
 19701           DFHEIV99,
 19702           ELBENE-KEY,
 19703           DFHEIV99,
 19704           DFHEIV99,
 19705           DFHEIV99
 19706     SET ADDRESS OF BENEFICIARY-MASTER TO
 19707         DFHEIV20
 19708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19709
 19710
 19711     MOVE 'Y' TO BENE-FOUND-SW.
 19712     GO TO 7920-EXIT.
 19713
 19714 7920-NOT-FOUND.
 19715     MOVE 'N'                    TO BENE-FOUND-SW.
 19716
 19717 7920-EXIT.
 19718      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 378
* EL156.cbl
 19720 7930-READ-CONTROL.
 19721
 19722* EXEC CICS READ
 19723*        DATASET  ('ELCNTL')
 19724*        SET      (ADDRESS OF CONTROL-FILE)
 19725*        RIDFLD   (ELCNTL-KEY)
 19726*    END-EXEC.
 19727     MOVE 'ELCNTL' TO DFHEIV1
 19728*    MOVE '&"S        E          (   #00017677' TO DFHEIV0
 19729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19731     MOVE X'2020233030303137363737' TO DFHEIV0(25:11)
 19732     CALL 'kxdfhei1' USING DFHEIV0,
 19733           DFHEIV1,
 19734           DFHEIV20,
 19735           DFHEIV99,
 19736           ELCNTL-KEY,
 19737           DFHEIV99,
 19738           DFHEIV99,
 19739           DFHEIV99
 19740     SET ADDRESS OF CONTROL-FILE TO
 19741         DFHEIV20
 19742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19743
 19744
 19745 7930-EXIT.
 19746      EXIT.
 19747
 19748 7940-READ-CONTROL-UPDATE.
 19749
 19750* EXEC CICS READ
 19751*        DATASET  ('ELCNTL')
 19752*        SET      (ADDRESS OF CONTROL-FILE)
 19753*        RIDFLD   (ELCNTL-KEY)
 19754*        UPDATE
 19755*    END-EXEC.
 19756     MOVE 'ELCNTL' TO DFHEIV1
 19757*    MOVE '&"S        EU         (   #00017687' TO DFHEIV0
 19758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19759     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19760     MOVE X'2020233030303137363837' TO DFHEIV0(25:11)
 19761     CALL 'kxdfhei1' USING DFHEIV0,
 19762           DFHEIV1,
 19763           DFHEIV20,
 19764           DFHEIV99,
 19765           ELCNTL-KEY,
 19766           DFHEIV99,
 19767           DFHEIV99,
 19768           DFHEIV99
 19769     SET ADDRESS OF CONTROL-FILE TO
 19770         DFHEIV20
 19771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19772
 19773
 19774 7940-EXIT.
 19775      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 379
* EL156.cbl
 19777 7950-READ-TRAILER.
 19778
 19779* EXEC CICS READ
 19780*        DATASET  ('ELTRLR')
 19781*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19782*        RIDFLD   (ELTRLR-KEY)
 19783*    END-EXEC.
 19784     MOVE 'ELTRLR' TO DFHEIV1
 19785*    MOVE '&"S        E          (   #00017698' TO DFHEIV0
 19786     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19787     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19788     MOVE X'2020233030303137363938' TO DFHEIV0(25:11)
 19789     CALL 'kxdfhei1' USING DFHEIV0,
 19790           DFHEIV1,
 19791           DFHEIV20,
 19792           DFHEIV99,
 19793           ELTRLR-KEY,
 19794           DFHEIV99,
 19795           DFHEIV99,
 19796           DFHEIV99
 19797     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19798         DFHEIV20
 19799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19800
 19801
 19802 7950-EXIT.
 19803      EXIT.
 19804
 19805 7960-READ-TRAILER-UPDATE.
 19806
 19807* EXEC CICS READ
 19808*        DATASET  ('ELTRLR')
 19809*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19810*        RIDFLD   (ELTRLR-KEY)
 19811*        UPDATE
 19812*    END-EXEC.
 19813     MOVE 'ELTRLR' TO DFHEIV1
 19814*    MOVE '&"S        EU         (   #00017708' TO DFHEIV0
 19815     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19816     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19817     MOVE X'2020233030303137373038' TO DFHEIV0(25:11)
 19818     CALL 'kxdfhei1' USING DFHEIV0,
 19819           DFHEIV1,
 19820           DFHEIV20,
 19821           DFHEIV99,
 19822           ELTRLR-KEY,
 19823           DFHEIV99,
 19824           DFHEIV99,
 19825           DFHEIV99
 19826     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19827         DFHEIV20
 19828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19829
 19830
 19831 7960-EXIT.
 19832      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 380
* EL156.cbl
 19834 7970-READ-CERT.
 19835
 19836* EXEC CICS READ
 19837*        DATASET  ('ELCERT')
 19838*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19839*        RIDFLD   (ELCERT-KEY)
 19840*    END-EXEC.
 19841     MOVE 'ELCERT' TO DFHEIV1
 19842*    MOVE '&"S        E          (   #00017719' TO DFHEIV0
 19843     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19844     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19845     MOVE X'2020233030303137373139' TO DFHEIV0(25:11)
 19846     CALL 'kxdfhei1' USING DFHEIV0,
 19847           DFHEIV1,
 19848           DFHEIV20,
 19849           DFHEIV99,
 19850           ELCERT-KEY,
 19851           DFHEIV99,
 19852           DFHEIV99,
 19853           DFHEIV99
 19854     SET ADDRESS OF CERTIFICATE-MASTER TO
 19855         DFHEIV20
 19856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19857
 19858
 19859 7970-EXIT.
 19860      EXIT.
 19861 7975-read-acct.
 19862
 19863     move spaces              to WS-ACCT-RECORD-SW
 19864                                 pi-dcc-product-code
 19865
 19866     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19867     MOVE PI-CARRIER          TO ACCT-CARRIER
 19868     MOVE PI-GROUPING         TO ACCT-GROUPING
 19869     MOVE PI-STATE            TO ACCT-STATE
 19870     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19871     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19872     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19873     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19874
 19875
 19876* EXEC CICS READ
 19877*       DATASET ('ERACCT')
 19878*       RIDFLD  (ERACCT-KEY)
 19879*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19880*       GTEQ
 19881*       resp    (WS-RESPONSE)
 19882*    END-EXEC
 19883     MOVE 'ERACCT' TO DFHEIV1
 19884*    MOVE '&"S        G          (  N#00017741' TO DFHEIV0
 19885     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19886     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19887     MOVE X'204E233030303137373431' TO DFHEIV0(25:11)
 19888     CALL 'kxdfhei1' USING DFHEIV0,
 19889           DFHEIV1,
 19890           DFHEIV20,
 19891           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 381
* EL156.cbl
 19892           ERACCT-KEY,
 19893           DFHEIV99,
 19894           DFHEIV99,
 19895           DFHEIV99
 19896     SET ADDRESS OF ACCOUNT-MASTER TO
 19897         DFHEIV20
 19898     MOVE EIBRESP  TO WS-RESPONSE
 19899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19900     IF WS-RESP-NORMAL
 19901        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19902        and pi-cert-eff-dt < am-expiration-dt
 19903        and pi-cert-eff-dt >= am-effective-dt
 19904        move am-dcc-product-code to pi-dcc-product-code
 19905        set acct-found to true
 19906     end-if
 19907
 19908     .
 19909 7975-exit.
 19910     exit.
 19911 7980-READ-CERT-UPDATE.
 19912
 19913* EXEC CICS READ
 19914*        DATASET  ('ELCERT')
 19915*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19916*        RIDFLD   (ELCERT-KEY)
 19917*        UPDATE
 19918*    END-EXEC.
 19919     MOVE 'ELCERT' TO DFHEIV1
 19920*    MOVE '&"S        EU         (   #00017760' TO DFHEIV0
 19921     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19922     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19923     MOVE X'2020233030303137373630' TO DFHEIV0(25:11)
 19924     CALL 'kxdfhei1' USING DFHEIV0,
 19925           DFHEIV1,
 19926           DFHEIV20,
 19927           DFHEIV99,
 19928           ELCERT-KEY,
 19929           DFHEIV99,
 19930           DFHEIV99,
 19931           DFHEIV99
 19932     SET ADDRESS OF CERTIFICATE-MASTER TO
 19933         DFHEIV20
 19934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19935
 19936
 19937 7980-EXIT.
 19938      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 382
* EL156.cbl
 19940 8000-LOAD-ERROR-MESSAGES.
 19941     IF PI-PASS-SW = 'C'
 19942        MOVE EMI-LINE1           TO ERMSG1BO
 19943     ELSE
 19944        MOVE EMI-LINE1           TO ERRMSG1O
 19945        MOVE EMI-LINE2           TO ERRMSG2O.
 19946
 19947 8000-EXIT.
 19948     EXIT.
 19949
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 383
* EL156.cbl
 19951
 19952 8010-DMD-ERROR-CHECKS.
 19953     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19954
 19955     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19956         GO TO 8051-ISSUE-ERROR.
 19957
 19958     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19959     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19960     MOVE '3'                    TO DC-OPTION-CODE.
 19961     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19962     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19963         GO TO 8051-ISSUE-ERROR.
 19964
 19965     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19966       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19967                           OR
 19968          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19969           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19970             MOVE ER-0851         TO EMI-ERROR
 19971             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19972       END-IF
 19973       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19974             MOVE ER-8147         TO EMI-ERROR
 19975             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19976
 19977     GO TO 8090-EXIT.
 19978
 19979 8051-ISSUE-ERROR.
 19980     MOVE ER-8146            TO EMI-ERROR.
 19981     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19982     GO TO 8090-EXIT.
 19983
 19984 8090-EXIT.
 19985      EXIT.
 19986
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 384
* EL156.cbl
 19988 8100-SEND-INITIAL-MAP.
 19989
 19990     MOVE SAVE-DATE              TO RUNDTEAO.
 19991     MOVE EIBTIME                TO TIME-IN.
 19992     MOVE TIME-OUT               TO RUNTIMAO.
 19993     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19994
 19995     IF MAP-NAME = 'EL156A'
 19996        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 19997           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19998        END-IF
 19999        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 20000           MOVE 'N'     TO SURVYYNO
 20001        END-IF
 20002     END-IF
 20003*    IF MAP-NAME = 'EL156A'
 20004*       IF PI-COMPANY-ID = 'CRI'
 20005*          NEXT SENTENCE
 20006*       ELSE
 20007*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 20008
 20009     IF MAP-NAME = 'EL156A'
 20010        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 20011           NEXT SENTENCE
 20012        ELSE
 20013           MOVE AL-SADOF TO  PINTA    PINTHA.
 20014
 20015     IF MAP-NAME = 'EL156A'
 20016        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 20017            NEXT SENTENCE
 20018        ELSE
 20019           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 20020
 20021*    IF MAP-NAME = 'EL156A'
 20022*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 20023*          NEXT SENTENCE
 20024*       ELSE
 20025*          MOVE AL-SADOF TO CASHHA CASHA.
 20026
 20027     IF MAP-NAME = 'EL156A'
 20028        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 20029                        or 'VPP'
 20030           NEXT SENTENCE
 20031        ELSE
 20032           MOVE AL-SADOF        TO  LOANHA
 20033                                    LOANNOA.
 20034
 20035     IF MAP-NAME = 'EL156A'
 20036        MOVE -1                 TO  ENTERPFL
 20037        IF PI-USES-PAID-TO
 20038           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20039           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20040           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20041        ELSE
 20042           NEXT SENTENCE
 20043     ELSE
 20044        IF MAP-NAME = 'EL156B'
 20045           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 385
* EL156.cbl
 20046              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20047              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20048
 20049
 20050* EXEC CICS SEND
 20051*        MAP   (MAP-NAME)
 20052*        MAPSET(MAPSET-NAME)
 20053*        FROM  (EL156AI)
 20054*        ERASE
 20055*        CURSOR
 20056*    END-EXEC.
 20057     MOVE LENGTH OF
 20058      EL156AI
 20059       TO DFHEIV12
 20060     MOVE -1
 20061       TO DFHEIV11
 20062*    MOVE '8$     CT  E    H L F ,   #00017879' TO DFHEIV0
 20063     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 20064     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20065     MOVE X'2020233030303137383739' TO DFHEIV0(25:11)
 20066     CALL 'kxdfhei1' USING DFHEIV0,
 20067           MAP-NAME,
 20068           EL156AI,
 20069           DFHEIV12,
 20070           MAPSET-NAME,
 20071           DFHEIV99,
 20072           DFHEIV99,
 20073           DFHEIV99,
 20074           DFHEIV11,
 20075           DFHEIV99,
 20076           DFHEIV99,
 20077           DFHEIV99
 20078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20079
 20080
 20081     GO TO 9100-RETURN-TRAN.
 20082
 20083 8200-SEND-DATAONLY.
 20084
 20085     IF FIRST-ENTRY = 'Y'
 20086         GO TO 8100-SEND-INITIAL-MAP.
 20087
 20088     IF RETURNED-FROM-B = 'Y'
 20089         GO TO 8100-SEND-INITIAL-MAP.
 20090
 20091     MOVE SAVE-DATE              TO RUNDTEAO.
 20092     MOVE EIBTIME                TO TIME-IN.
 20093     MOVE TIME-OUT               TO RUNTIMAO.
 20094
 20095     IF EIBAID = DFHPF11
 20096        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20098        MOVE 'EL001   '          TO RETURNED-FROM
 20099        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20100        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20101        GO TO 8100-SEND-INITIAL-MAP.
 20102
 20103     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 386
* EL156.cbl
 20104
 20105     IF MAP-NAME =  'EL156A'
 20106        MOVE -1                 TO  ENTERPFL
 20107        IF PI-USES-PAID-TO
 20108           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20109           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20110           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20111        ELSE
 20112           NEXT SENTENCE
 20113     ELSE
 20114        IF MAP-NAME = 'EL156B'
 20115           IF PI-USES-PAID-TO
 20116              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20117              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20118
 20119     IF MAP-NAME =  'EL156A'
 20120        IF PI-COMPANY-ID = 'BOA'
 20121            IF PI-INT-RATE NUMERIC
 20122                MOVE PI-INT-RATE TO PINTO.
 20123     IF MAP-NAME = 'EL156A'
 20124        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20125           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20126*          MOVE 'Y'              TO EOBYNO
 20127        END-IF
 20128     END-IF
 20129
 20130
 20131* EXEC CICS SEND
 20132*        MAP   (MAP-NAME)
 20133*        MAPSET(MAPSET-NAME)
 20134*        FROM  (EL156AI)
 20135*        DATAONLY
 20136*        CURSOR
 20137*    END-EXEC.
 20138     MOVE LENGTH OF
 20139      EL156AI
 20140       TO DFHEIV12
 20141     MOVE -1
 20142       TO DFHEIV11
 20143*    MOVE '8$D    CT       H L F ,   #00017936' TO DFHEIV0
 20144     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20145     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20146     MOVE X'2020233030303137393336' TO DFHEIV0(25:11)
 20147     CALL 'kxdfhei1' USING DFHEIV0,
 20148           MAP-NAME,
 20149           EL156AI,
 20150           DFHEIV12,
 20151           MAPSET-NAME,
 20152           DFHEIV99,
 20153           DFHEIV99,
 20154           DFHEIV99,
 20155           DFHEIV11,
 20156           DFHEIV99,
 20157           DFHEIV99,
 20158           DFHEIV99
 20159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20160
 20161
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 387
* EL156.cbl
 20162     GO TO 9100-RETURN-TRAN.
 20163
 20164 8300-SEND-TEXT.
 20165
 20166* EXEC CICS SEND TEXT
 20167*        FROM(LOGOFF-TEXT)
 20168*        LENGTH(LOGOFF-LENGTH)
 20169*        ERASE
 20170*        FREEKB
 20171*    END-EXEC.
 20172*    MOVE '8&      T  E F  H   F -   #00017947' TO DFHEIV0
 20173     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20174     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20175     MOVE X'2020233030303137393437' TO DFHEIV0(25:11)
 20176     CALL 'kxdfhei1' USING DFHEIV0,
 20177           LOGOFF-TEXT,
 20178           LOGOFF-LENGTH,
 20179           DFHEIV99,
 20180           DFHEIV99,
 20181           DFHEIV99,
 20182           DFHEIV99,
 20183           DFHEIV99,
 20184           DFHEIV99,
 20185           DFHEIV99,
 20186           DFHEIV99,
 20187           DFHEIV99,
 20188           DFHEIV99
 20189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20190
 20191
 20192
 20193* EXEC CICS RETURN
 20194*    END-EXEC.
 20195*    MOVE '.(                    ''   #00017954' TO DFHEIV0
 20196     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20197     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20198     MOVE X'2020233030303137393534' TO DFHEIV0(25:11)
 20199     CALL 'kxdfhei1' USING DFHEIV0,
 20200           DFHEIV99,
 20201           DFHEIV99,
 20202           DFHEIV99,
 20203           DFHEIV99,
 20204           DFHEIV99,
 20205           DFHEIV99
 20206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20207
 20208
 20209 8500-FILE-NOTOPEN.
 20210     IF FILE-SWITCH = 'MSTR'
 20211         MOVE ER-0154            TO EMI-ERROR.
 20212     IF FILE-SWITCH = 'TRLR'
 20213         MOVE ER-0172            TO EMI-ERROR.
 20214     IF FILE-SWITCH = 'CERT'
 20215         MOVE ER-0169            TO EMI-ERROR.
 20216     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20217                      'PROC' OR 'STAT'
 20218         MOVE ER-0042            TO EMI-ERROR.
 20219     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 388
* EL156.cbl
 20220         MOVE ER-0338            TO EMI-ERROR.
 20221     IF FILE-SWITCH = 'ACCT'
 20222         MOVE ER-0168            TO EMI-ERROR.
 20223
 20224     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20225     MOVE -1                     TO PMTTYPEL.
 20226
 20227     IF FIRST-ENTRY = 'Y'
 20228         GO TO 8100-SEND-INITIAL-MAP.
 20229
 20230     GO TO 8200-SEND-DATAONLY.
 20231
 20232 8600-PGRM-NOT-FOUND.
 20233
 20234     MOVE ER-0923                TO EMI-ERROR.
 20235     MOVE -1                     TO ENTPFBL.
 20236     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20237
 20238     IF FIRST-ENTRY = 'Y'
 20239         GO TO 8100-SEND-INITIAL-MAP
 20240     ELSE
 20241         GO TO 8200-SEND-DATAONLY.
 20242
 20243 8800-UNAUTHORIZED-ACCESS.
 20244     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20245     GO TO 8300-SEND-TEXT.
 20246
 20247 8810-PF23.
 20248     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20249     MOVE XCTL-005               TO PGM-NAME.
 20250     GO TO 9300-XCTL.
 20251
 20252 8820-PF7-8.
 20253     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20254     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20255                                    PI-SAVED-PROGRAM-2
 20256                                    PI-SAVED-PROGRAM-3
 20257                                    PI-SAVED-PROGRAM-4
 20258                                    PI-SAVED-PROGRAM-5
 20259                                    PI-SAVED-PROGRAM-6
 20260                                    PI-RETURN-TO-PROGRAM.
 20261     IF EIBAID = DFHPF8
 20262        MOVE XCTL-132            TO PGM-NAME
 20263     ELSE
 20264        MOVE XCTL-130            TO PGM-NAME.
 20265
 20266     GO TO 9300-XCTL.
 20267
 20268 9100-RETURN-TRAN.
 20269     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20270     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20271
 20272
 20273* EXEC CICS RETURN
 20274*        TRANSID(TRANS-ID)
 20275*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20276*        LENGTH(PI-COMM-LENGTH)
 20277*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 389
* EL156.cbl
 20278*    MOVE '.(CT                  ''   #00018020' TO DFHEIV0
 20279     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20280     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20281     MOVE X'2020233030303138303230' TO DFHEIV0(25:11)
 20282     CALL 'kxdfhei1' USING DFHEIV0,
 20283           TRANS-ID,
 20284           PROGRAM-INTERFACE-BLOCK,
 20285           PI-COMM-LENGTH,
 20286           DFHEIV99,
 20287           DFHEIV99,
 20288           DFHEIV99
 20289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20290
 20291
 20292 9200-RETURN-MAIN-MENU.
 20293     MOVE XCTL-126               TO PGM-NAME.
 20294     GO TO 9300-XCTL.
 20295
 20296 9300-XCTL.
 20297
 20298* EXEC CICS XCTL
 20299*        PROGRAM(PGM-NAME)
 20300*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20301*        LENGTH(PI-COMM-LENGTH)
 20302*    END-EXEC.
 20303*    MOVE '.$C                   %   #00018031' TO DFHEIV0
 20304     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20306     MOVE X'2020233030303138303331' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0,
 20308           PGM-NAME,
 20309           PROGRAM-INTERFACE-BLOCK,
 20310           PI-COMM-LENGTH,
 20311           DFHEIV99
 20312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20313
 20314
 20315 9400-CLEAR.
 20316     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20317     GO TO 9300-XCTL.
 20318
 20319 9500-PF12.
 20320     MOVE XCTL-010               TO PGM-NAME.
 20321     GO TO 9300-XCTL.
 20322
 20323 9700-LINK-DATE-CONVERT.
 20324     MOVE LINK-ELDATCV           TO PGM-NAME.
 20325
 20326* EXEC CICS LINK
 20327*        PROGRAM   (PGM-NAME)
 20328*        COMMAREA  (DATE-CONVERSION-DATA)
 20329*        LENGTH    (DC-COMM-LENGTH)
 20330*    END-EXEC.
 20331*    MOVE '."C                   (   #00018047' TO DFHEIV0
 20332     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20334     MOVE X'2020233030303138303437' TO DFHEIV0(25:11)
 20335     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 390
* EL156.cbl
 20336           PGM-NAME,
 20337           DATE-CONVERSION-DATA,
 20338           DC-COMM-LENGTH,
 20339           DFHEIV99,
 20340           DFHEIV99,
 20341           DFHEIV99,
 20342           DFHEIV99
 20343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20344
 20345
 20346 9700-EXIT.
 20347     EXIT.
 20348
 20349 9800-LINK-REM-TERM.
 20350     MOVE LINK-REMTERM TO PGM-NAME.
 20351
 20352
 20353* EXEC CICS LINK
 20354*        PROGRAM   (PGM-NAME)
 20355*        COMMAREA  (CALCULATION-PASS-AREA)
 20356*        LENGTH    (CP-COMM-LENGTH)
 20357*    END-EXEC.
 20358*    MOVE '."C                   (   #00018059' TO DFHEIV0
 20359     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20361     MOVE X'2020233030303138303539' TO DFHEIV0(25:11)
 20362     CALL 'kxdfhei1' USING DFHEIV0,
 20363           PGM-NAME,
 20364           CALCULATION-PASS-AREA,
 20365           CP-COMM-LENGTH,
 20366           DFHEIV99,
 20367           DFHEIV99,
 20368           DFHEIV99,
 20369           DFHEIV99
 20370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20371
 20372
 20373 9800-EXIT.
 20374     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 391
* EL156.cbl
 20376 9830-DMD-REMAINING-TERM.
 20377
 20378     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20379         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20380
 20381     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20382                              CM-PMT-EXTENSION-DAYS.
 20383
 20384     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20385                                  CL-NO-OF-DAYS-PAID.
 20386
 20387     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20388         GIVING W-REM REMAINDER W-REM-DAYS.
 20389
 20390     MOVE W-REM                  TO WST-REM.
 20391
 20392     IF W-REM-DAYS > ZEROS
 20393         MOVE '/'                TO WST-SLASH
 20394         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20395     ELSE
 20396         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20397
 20398 9830-EXIT.
 20399     EXIT.
 20400
 20401 9870-OUTPUT-ACTIVITY-RECORD.
 20402
 20403
 20404* EXEC CICS GETMAIN
 20405*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20406*         LENGTH(25)
 20407*         INITIMG(WS-BLANK)
 20408*    END-EXEC.
 20409     MOVE 25
 20410       TO DFHEIV11
 20411*    MOVE ',"IL                  $   #00018095' TO DFHEIV0
 20412     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20414     MOVE X'2020233030303138303935' TO DFHEIV0(25:11)
 20415     CALL 'kxdfhei1' USING DFHEIV0,
 20416           DFHEIV20,
 20417           DFHEIV11,
 20418           WS-BLANK
 20419     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20420         DFHEIV20
 20421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20422
 20423
 20424     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20425     MOVE ELMSTR-KEY             TO DA-KEY.
 20426     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20427
 20428     IF PI-PMTTYPE EQUAL '7'
 20429         MOVE 'V'                TO DA-RECORD-TYPE
 20430     ELSE
 20431         MOVE 'P'                TO DA-RECORD-TYPE.
 20432
 20433
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 392
* EL156.cbl
 20434* EXEC CICS HANDLE CONDITION
 20435*         NOTOPEN(9870-NOTOPEN)
 20436*         DUPREC(9870-EXIT)
 20437*    END-EXEC.
 20438*    MOVE '"$J%                  ! B #00018110' TO DFHEIV0
 20439     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20441     MOVE X'4220233030303138313130' TO DFHEIV0(25:11)
 20442     CALL 'kxdfhei1' USING DFHEIV0
 20443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20444
 20445
 20446
 20447* EXEC CICS WRITE
 20448*         DATASET('DLYACTV')
 20449*         RIDFLD(DA-KEY)
 20450*         FROM(DAILY-ACTIVITY-RECORD)
 20451*         LENGTH(25)
 20452*    END-EXEC.
 20453     MOVE 'DLYACTV' TO DFHEIV1
 20454     MOVE 25
 20455       TO DFHEIV11
 20456*    MOVE '&$ L                  ''   #00018115' TO DFHEIV0
 20457     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20458     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20459     MOVE X'2020233030303138313135' TO DFHEIV0(25:11)
 20460     CALL 'kxdfhei1' USING DFHEIV0,
 20461           DFHEIV1,
 20462           DAILY-ACTIVITY-RECORD,
 20463           DFHEIV11,
 20464           DA-KEY,
 20465           DFHEIV99,
 20466           DFHEIV99
 20467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20468
 20469     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20470     GO TO 9870-EXIT.
 20471
 20472 9870-NOTOPEN.
 20473
 20474     MOVE '2955'                 TO EMI-ERROR.
 20475     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20476
 20477 9870-EXIT.
 20478     EXIT.
 20479
 20480 9900-ERROR-FORMAT.
 20481
 20482     IF EMI-ERROR = ER-0923
 20483         MOVE PGM-NAME           TO W-CALLED-NAME.
 20484
 20485     MOVE LINK-001      TO PGM-NAME.
 20486     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20487
 20488
 20489* EXEC CICS LINK
 20490*        PROGRAM (PGM-NAME)
 20491*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 393
* EL156.cbl
 20492*        LENGTH  (EMI-COMM-LENGTH)
 20493*    END-EXEC.
 20494*    MOVE '."C                   (   #00018140' TO DFHEIV0
 20495     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20497     MOVE X'2020233030303138313430' TO DFHEIV0(25:11)
 20498     CALL 'kxdfhei1' USING DFHEIV0,
 20499           PGM-NAME,
 20500           ERROR-MESSAGE-INTERFACE-BLOCK,
 20501           EMI-COMM-LENGTH,
 20502           DFHEIV99,
 20503           DFHEIV99,
 20504           DFHEIV99,
 20505           DFHEIV99
 20506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20507
 20508
 20509     IF EMI-ERROR = ER-0923
 20510         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20511
 20512 9900-EXIT.
 20513     EXIT.
 20514
 20515 9990-ABEND.
 20516     MOVE LINK-004               TO PGM-NAME.
 20517     MOVE DFHEIBLK               TO EMI-LINE1.
 20518
 20519* EXEC CICS LINK
 20520*        PROGRAM   (PGM-NAME)
 20521*        COMMAREA  (EMI-LINE1)
 20522*        LENGTH    (64)
 20523*    END-EXEC.
 20524     MOVE 64
 20525       TO DFHEIV11
 20526*    MOVE '."C                   (   #00018155' TO DFHEIV0
 20527     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20529     MOVE X'2020233030303138313535' TO DFHEIV0(25:11)
 20530     CALL 'kxdfhei1' USING DFHEIV0,
 20531           PGM-NAME,
 20532           EMI-LINE1,
 20533           DFHEIV11,
 20534           DFHEIV99,
 20535           DFHEIV99,
 20536           DFHEIV99,
 20537           DFHEIV99
 20538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20539
 20540
 20541     MOVE 'EL156A'               TO  MAP-NAME.
 20542     MOVE LOW-VALUES             TO  EL156AO.
 20543     GO TO 8100-SEND-INITIAL-MAP.
 20544
 20545 9995-SECURITY-VIOLATION.
 20546*    COPY ELCSCTP.
 20547******************************************************************
 20548*                                                                *
 20549*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 394
* EL156.cbl
 20550*                            VMOD=2.001                          *
 20551*                                                                *
 20552*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20553******************************************************************
 20554
 20555
 20556     MOVE EIBDATE          TO SM-JUL-DATE.
 20557     MOVE EIBTRMID         TO SM-TERMID.
 20558     MOVE THIS-PGM         TO SM-PGM.
 20559     MOVE EIBTIME          TO TIME-IN.
 20560     MOVE TIME-OUT         TO SM-TIME.
 20561     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20562
 20563
 20564* EXEC CICS LINK
 20565*         PROGRAM  ('EL003')
 20566*         COMMAREA (SECURITY-MESSAGE)
 20567*         LENGTH   (80)
 20568*    END-EXEC.
 20569     MOVE 'EL003' TO DFHEIV1
 20570     MOVE 80
 20571       TO DFHEIV11
 20572*    MOVE '."C                   (   #00018183' TO DFHEIV0
 20573     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20574     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20575     MOVE X'2020233030303138313833' TO DFHEIV0(25:11)
 20576     CALL 'kxdfhei1' USING DFHEIV0,
 20577           DFHEIV1,
 20578           SECURITY-MESSAGE,
 20579           DFHEIV11,
 20580           DFHEIV99,
 20581           DFHEIV99,
 20582           DFHEIV99,
 20583           DFHEIV99
 20584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20585
 20586
 20587******************************************************************
 20588
 20589
 20590
 20591 9999-DFHBACK SECTION.
 20592     MOVE '9%                    "   ' TO DFHEIV0
 20593     MOVE 'EL156' TO DFHEIV1
 20594     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20595     GOBACK.
 20596 9999-DFHEXIT.
 20597     IF DFHEIGDJ EQUAL 0001
 20598         NEXT SENTENCE
 20599     ELSE IF DFHEIGDJ EQUAL 2
 20600         GO TO 9990-ABEND,
 20601               8600-PGRM-NOT-FOUND,
 20602               0400-FIRST-TIME,
 20603               6180-DUPREC,
 20604               9990-ABEND
 20605         DEPENDING ON DFHEIGDI
 20606     ELSE IF DFHEIGDJ EQUAL 3
 20607         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 395
* EL156.cbl
 20608               0380-CLAIM-END-FILE
 20609         DEPENDING ON DFHEIGDI
 20610     ELSE IF DFHEIGDJ EQUAL 4
 20611         GO TO 0380-CLAIM-END-FILE,
 20612               0380-CLAIM-END-FILE
 20613         DEPENDING ON DFHEIGDI
 20614     ELSE IF DFHEIGDJ EQUAL 5
 20615         GO TO 0800-EXIT
 20616         DEPENDING ON DFHEIGDI
 20617     ELSE IF DFHEIGDJ EQUAL 6
 20618         GO TO 1950-NOT-FOUND,
 20619               1950-NOT-FOUND
 20620         DEPENDING ON DFHEIGDI
 20621     ELSE IF DFHEIGDJ EQUAL 7
 20622         GO TO 1950-NOT-FOUND
 20623         DEPENDING ON DFHEIGDI
 20624     ELSE IF DFHEIGDJ EQUAL 8
 20625         GO TO 1950-NOT-FOUND,
 20626               1950-NOT-FOUND
 20627         DEPENDING ON DFHEIGDI
 20628     ELSE IF DFHEIGDJ EQUAL 9
 20629         GO TO 1166-END-CHECK,
 20630               1166-END-CHECK
 20631         DEPENDING ON DFHEIGDI
 20632     ELSE IF DFHEIGDJ EQUAL 10
 20633         GO TO 1950-NOT-FOUND,
 20634               1950-NOT-FOUND
 20635         DEPENDING ON DFHEIGDI
 20636     ELSE IF DFHEIGDJ EQUAL 11
 20637         GO TO 1950-NOT-FOUND,
 20638               1950-NOT-FOUND
 20639         DEPENDING ON DFHEIGDI
 20640     ELSE IF DFHEIGDJ EQUAL 12
 20641         GO TO 1950-NOT-FOUND
 20642         DEPENDING ON DFHEIGDI
 20643     ELSE IF DFHEIGDJ EQUAL 13
 20644         GO TO 3600-CONTINUE
 20645         DEPENDING ON DFHEIGDI
 20646     ELSE IF DFHEIGDJ EQUAL 14
 20647         GO TO 5300-NOTE-NOT-FOUND
 20648         DEPENDING ON DFHEIGDI
 20649     ELSE IF DFHEIGDJ EQUAL 15
 20650         GO TO 6065-NOT-FOUND
 20651         DEPENDING ON DFHEIGDI
 20652     ELSE IF DFHEIGDJ EQUAL 16
 20653         GO TO 6068-ACCT-NOT-FND
 20654         DEPENDING ON DFHEIGDI
 20655     ELSE IF DFHEIGDJ EQUAL 17
 20656         GO TO 6074-GET-COMP-DATA
 20657         DEPENDING ON DFHEIGDI
 20658     ELSE IF DFHEIGDJ EQUAL 18
 20659         GO TO 6170-WRITE
 20660         DEPENDING ON DFHEIGDI
 20661     ELSE IF DFHEIGDJ EQUAL 19
 20662         GO TO 6180-DUPREC
 20663         DEPENDING ON DFHEIGDI
 20664     ELSE IF DFHEIGDJ EQUAL 20
 20665         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:34 Page 396
* EL156.cbl
 20666         DEPENDING ON DFHEIGDI
 20667     ELSE IF DFHEIGDJ EQUAL 21
 20668         GO TO 6185-DUPREC
 20669         DEPENDING ON DFHEIGDI
 20670     ELSE IF DFHEIGDJ EQUAL 22
 20671         GO TO 6720-BUILD-NEW-RECORD
 20672         DEPENDING ON DFHEIGDI
 20673     ELSE IF DFHEIGDJ EQUAL 23
 20674         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20675               6900-BUILD-ARCHIVE-HEADER
 20676         DEPENDING ON DFHEIGDI
 20677     ELSE IF DFHEIGDJ EQUAL 24
 20678         GO TO 7010-BUILD-MAP
 20679         DEPENDING ON DFHEIGDI
 20680     ELSE IF DFHEIGDJ EQUAL 25
 20681         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20682         DEPENDING ON DFHEIGDI
 20683     ELSE IF DFHEIGDJ EQUAL 26
 20684         GO TO 7160-DUPREC
 20685         DEPENDING ON DFHEIGDI
 20686     ELSE IF DFHEIGDJ EQUAL 27
 20687         GO TO 7200-EXIT,
 20688               7200-EXIT
 20689         DEPENDING ON DFHEIGDI
 20690     ELSE IF DFHEIGDJ EQUAL 28
 20691         GO TO 7400-NOT-FOUND
 20692         DEPENDING ON DFHEIGDI
 20693     ELSE IF DFHEIGDJ EQUAL 29
 20694         GO TO 7590-END,
 20695               7590-END
 20696         DEPENDING ON DFHEIGDI
 20697     ELSE IF DFHEIGDJ EQUAL 30
 20698         GO TO 7699-EXIT
 20699         DEPENDING ON DFHEIGDI
 20700     ELSE IF DFHEIGDJ EQUAL 31
 20701         GO TO 5300-NOTE-NOT-FOUND
 20702         DEPENDING ON DFHEIGDI
 20703     ELSE IF DFHEIGDJ EQUAL 32
 20704         GO TO 7800-COMP-NOTFND
 20705         DEPENDING ON DFHEIGDI
 20706     ELSE IF DFHEIGDJ EQUAL 33
 20707         GO TO 7920-NOT-FOUND
 20708         DEPENDING ON DFHEIGDI
 20709     ELSE IF DFHEIGDJ EQUAL 34
 20710         GO TO 9870-NOTOPEN,
 20711               9870-EXIT
 20712         DEPENDING ON DFHEIGDI.
 20713     MOVE '9%                    "   ' TO DFHEIV0
 20714     MOVE 'EL156' TO DFHEIV1
 20715     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20716     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12780     Code:       77293
